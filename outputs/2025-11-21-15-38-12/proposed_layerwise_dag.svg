<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_layerwise_partitioning Pages: 1 -->
<svg width="584pt" height="5547pt"
 viewBox="0.00 0.00 583.58 5546.83" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 5542.83)">
<title>proposed_layerwise_partitioning</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-5542.83 579.58,-5542.83 579.58,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="287.79" cy="-5490.75" rx="287.59" ry="48.17"/>
<text text-anchor="middle" x="287.79" y="-5509.55" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="287.79" y="-5494.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=8, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-5479.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=8, seq_len=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-5464.55" font-family="Times,serif" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- layer0_mha -->
<g id="node2" class="node">
<title>layer0_mha</title>
<polygon fill="none" stroke="black" points="483.29,-5406.66 92.29,-5406.66 92.29,-5338.66 483.29,-5338.66 483.29,-5406.66"/>
<text text-anchor="middle" x="287.79" y="-5391.46" font-family="Times,serif" font-size="14.00">Layer 0 MHA</text>
<text text-anchor="middle" x="287.79" y="-5376.46" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-5361.46" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-5346.46" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;layer0_mha -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_mha</title>
<path fill="none" stroke="black" d="M287.79,-5442.53C287.79,-5434.15 287.79,-5425.45 287.79,-5417.17"/>
<polygon fill="black" stroke="black" points="291.29,-5416.97 287.79,-5406.97 284.29,-5416.97 291.29,-5416.97"/>
</g>
<!-- layer0_ffn -->
<g id="node3" class="node">
<title>layer0_ffn</title>
<polygon fill="none" stroke="black" points="459.79,-5302.66 115.79,-5302.66 115.79,-5234.66 459.79,-5234.66 459.79,-5302.66"/>
<text text-anchor="middle" x="287.79" y="-5287.46" font-family="Times,serif" font-size="14.00">Layer 0 FFN</text>
<text text-anchor="middle" x="287.79" y="-5272.46" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-5257.46" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-5242.46" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_mha&#45;&gt;layer0_ffn -->
<g id="edge2" class="edge">
<title>layer0_mha&#45;&gt;layer0_ffn</title>
<path fill="none" stroke="black" d="M287.79,-5338.55C287.79,-5330.44 287.79,-5321.65 287.79,-5313.14"/>
<polygon fill="black" stroke="black" points="291.29,-5312.96 287.79,-5302.96 284.29,-5312.96 291.29,-5312.96"/>
</g>
<!-- comm0_1 -->
<g id="node4" class="node">
<title>comm0_1</title>
<ellipse fill="none" stroke="black" cx="287.79" cy="-5150.58" rx="243.49" ry="48.17"/>
<text text-anchor="middle" x="287.79" y="-5169.38" font-family="Times,serif" font-size="14.00">Communication</text>
<text text-anchor="middle" x="287.79" y="-5154.38" font-family="Times,serif" font-size="14.00">GPU 0 → GPU 1</text>
<text text-anchor="middle" x="287.79" y="-5139.38" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-5124.38" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
</g>
<!-- layer0_ffn&#45;&gt;comm0_1 -->
<g id="edge3" class="edge">
<title>layer0_ffn&#45;&gt;comm0_1</title>
<path fill="none" stroke="black" d="M287.79,-5234.4C287.79,-5226.41 287.79,-5217.64 287.79,-5208.9"/>
<polygon fill="black" stroke="black" points="291.29,-5208.69 287.79,-5198.69 284.29,-5208.69 291.29,-5208.69"/>
</g>
<!-- layer1_mha -->
<g id="node5" class="node">
<title>layer1_mha</title>
<polygon fill="none" stroke="black" points="483.29,-5066.5 92.29,-5066.5 92.29,-4998.5 483.29,-4998.5 483.29,-5066.5"/>
<text text-anchor="middle" x="287.79" y="-5051.3" font-family="Times,serif" font-size="14.00">Layer 1 MHA</text>
<text text-anchor="middle" x="287.79" y="-5036.3" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-5021.3" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-5006.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- comm0_1&#45;&gt;layer1_mha -->
<g id="edge4" class="edge">
<title>comm0_1&#45;&gt;layer1_mha</title>
<path fill="none" stroke="black" d="M287.79,-5102.37C287.79,-5093.98 287.79,-5085.28 287.79,-5077"/>
<polygon fill="black" stroke="black" points="291.29,-5076.8 287.79,-5066.8 284.29,-5076.8 291.29,-5076.8"/>
</g>
<!-- layer1_ffn -->
<g id="node6" class="node">
<title>layer1_ffn</title>
<polygon fill="none" stroke="black" points="459.79,-4962.5 115.79,-4962.5 115.79,-4894.5 459.79,-4894.5 459.79,-4962.5"/>
<text text-anchor="middle" x="287.79" y="-4947.3" font-family="Times,serif" font-size="14.00">Layer 1 FFN</text>
<text text-anchor="middle" x="287.79" y="-4932.3" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-4917.3" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-4902.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_mha&#45;&gt;layer1_ffn -->
<g id="edge5" class="edge">
<title>layer1_mha&#45;&gt;layer1_ffn</title>
<path fill="none" stroke="black" d="M287.79,-4998.38C287.79,-4990.28 287.79,-4981.48 287.79,-4972.97"/>
<polygon fill="black" stroke="black" points="291.29,-4972.8 287.79,-4962.8 284.29,-4972.8 291.29,-4972.8"/>
</g>
<!-- comm1_2 -->
<g id="node7" class="node">
<title>comm1_2</title>
<ellipse fill="none" stroke="black" cx="287.79" cy="-4810.41" rx="243.49" ry="48.17"/>
<text text-anchor="middle" x="287.79" y="-4829.21" font-family="Times,serif" font-size="14.00">Communication</text>
<text text-anchor="middle" x="287.79" y="-4814.21" font-family="Times,serif" font-size="14.00">GPU 1 → GPU 2</text>
<text text-anchor="middle" x="287.79" y="-4799.21" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-4784.21" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
</g>
<!-- layer1_ffn&#45;&gt;comm1_2 -->
<g id="edge6" class="edge">
<title>layer1_ffn&#45;&gt;comm1_2</title>
<path fill="none" stroke="black" d="M287.79,-4894.23C287.79,-4886.24 287.79,-4877.47 287.79,-4868.73"/>
<polygon fill="black" stroke="black" points="291.29,-4868.52 287.79,-4858.52 284.29,-4868.52 291.29,-4868.52"/>
</g>
<!-- layer2_mha -->
<g id="node8" class="node">
<title>layer2_mha</title>
<polygon fill="none" stroke="black" points="483.29,-4726.33 92.29,-4726.33 92.29,-4658.33 483.29,-4658.33 483.29,-4726.33"/>
<text text-anchor="middle" x="287.79" y="-4711.13" font-family="Times,serif" font-size="14.00">Layer 2 MHA</text>
<text text-anchor="middle" x="287.79" y="-4696.13" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-4681.13" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-4666.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- comm1_2&#45;&gt;layer2_mha -->
<g id="edge7" class="edge">
<title>comm1_2&#45;&gt;layer2_mha</title>
<path fill="none" stroke="black" d="M287.79,-4762.2C287.79,-4753.81 287.79,-4745.12 287.79,-4736.84"/>
<polygon fill="black" stroke="black" points="291.29,-4736.63 287.79,-4726.63 284.29,-4736.64 291.29,-4736.63"/>
</g>
<!-- layer2_ffn -->
<g id="node9" class="node">
<title>layer2_ffn</title>
<polygon fill="none" stroke="black" points="459.79,-4622.33 115.79,-4622.33 115.79,-4554.33 459.79,-4554.33 459.79,-4622.33"/>
<text text-anchor="middle" x="287.79" y="-4607.13" font-family="Times,serif" font-size="14.00">Layer 2 FFN</text>
<text text-anchor="middle" x="287.79" y="-4592.13" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-4577.13" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-4562.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_mha&#45;&gt;layer2_ffn -->
<g id="edge8" class="edge">
<title>layer2_mha&#45;&gt;layer2_ffn</title>
<path fill="none" stroke="black" d="M287.79,-4658.21C287.79,-4650.11 287.79,-4641.31 287.79,-4632.8"/>
<polygon fill="black" stroke="black" points="291.29,-4632.63 287.79,-4622.63 284.29,-4632.63 291.29,-4632.63"/>
</g>
<!-- comm2_3 -->
<g id="node10" class="node">
<title>comm2_3</title>
<ellipse fill="none" stroke="black" cx="287.79" cy="-4470.25" rx="243.49" ry="48.17"/>
<text text-anchor="middle" x="287.79" y="-4489.05" font-family="Times,serif" font-size="14.00">Communication</text>
<text text-anchor="middle" x="287.79" y="-4474.05" font-family="Times,serif" font-size="14.00">GPU 2 → GPU 3</text>
<text text-anchor="middle" x="287.79" y="-4459.05" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-4444.05" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
</g>
<!-- layer2_ffn&#45;&gt;comm2_3 -->
<g id="edge9" class="edge">
<title>layer2_ffn&#45;&gt;comm2_3</title>
<path fill="none" stroke="black" d="M287.79,-4554.07C287.79,-4546.07 287.79,-4537.31 287.79,-4528.56"/>
<polygon fill="black" stroke="black" points="291.29,-4528.36 287.79,-4518.36 284.29,-4528.36 291.29,-4528.36"/>
</g>
<!-- layer3_mha -->
<g id="node11" class="node">
<title>layer3_mha</title>
<polygon fill="none" stroke="black" points="483.29,-4386.16 92.29,-4386.16 92.29,-4318.16 483.29,-4318.16 483.29,-4386.16"/>
<text text-anchor="middle" x="287.79" y="-4370.96" font-family="Times,serif" font-size="14.00">Layer 3 MHA</text>
<text text-anchor="middle" x="287.79" y="-4355.96" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-4340.96" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-4325.96" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- comm2_3&#45;&gt;layer3_mha -->
<g id="edge10" class="edge">
<title>comm2_3&#45;&gt;layer3_mha</title>
<path fill="none" stroke="black" d="M287.79,-4422.03C287.79,-4413.65 287.79,-4404.95 287.79,-4396.67"/>
<polygon fill="black" stroke="black" points="291.29,-4396.47 287.79,-4386.47 284.29,-4396.47 291.29,-4396.47"/>
</g>
<!-- layer3_ffn -->
<g id="node12" class="node">
<title>layer3_ffn</title>
<polygon fill="none" stroke="black" points="459.79,-4282.16 115.79,-4282.16 115.79,-4214.16 459.79,-4214.16 459.79,-4282.16"/>
<text text-anchor="middle" x="287.79" y="-4266.96" font-family="Times,serif" font-size="14.00">Layer 3 FFN</text>
<text text-anchor="middle" x="287.79" y="-4251.96" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-4236.96" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-4221.96" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_mha&#45;&gt;layer3_ffn -->
<g id="edge11" class="edge">
<title>layer3_mha&#45;&gt;layer3_ffn</title>
<path fill="none" stroke="black" d="M287.79,-4318.05C287.79,-4309.94 287.79,-4301.15 287.79,-4292.64"/>
<polygon fill="black" stroke="black" points="291.29,-4292.46 287.79,-4282.46 284.29,-4292.46 291.29,-4292.46"/>
</g>
<!-- comm3_4 -->
<g id="node13" class="node">
<title>comm3_4</title>
<ellipse fill="none" stroke="black" cx="287.79" cy="-4130.08" rx="243.49" ry="48.17"/>
<text text-anchor="middle" x="287.79" y="-4148.88" font-family="Times,serif" font-size="14.00">Communication</text>
<text text-anchor="middle" x="287.79" y="-4133.88" font-family="Times,serif" font-size="14.00">GPU 3 → GPU 4</text>
<text text-anchor="middle" x="287.79" y="-4118.88" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-4103.88" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
</g>
<!-- layer3_ffn&#45;&gt;comm3_4 -->
<g id="edge12" class="edge">
<title>layer3_ffn&#45;&gt;comm3_4</title>
<path fill="none" stroke="black" d="M287.79,-4213.9C287.79,-4205.91 287.79,-4197.14 287.79,-4188.4"/>
<polygon fill="black" stroke="black" points="291.29,-4188.19 287.79,-4178.19 284.29,-4188.19 291.29,-4188.19"/>
</g>
<!-- layer4_mha -->
<g id="node14" class="node">
<title>layer4_mha</title>
<polygon fill="none" stroke="black" points="483.29,-4046 92.29,-4046 92.29,-3978 483.29,-3978 483.29,-4046"/>
<text text-anchor="middle" x="287.79" y="-4030.8" font-family="Times,serif" font-size="14.00">Layer 4 MHA</text>
<text text-anchor="middle" x="287.79" y="-4015.8" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-4000.8" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-3985.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- comm3_4&#45;&gt;layer4_mha -->
<g id="edge13" class="edge">
<title>comm3_4&#45;&gt;layer4_mha</title>
<path fill="none" stroke="black" d="M287.79,-4081.87C287.79,-4073.48 287.79,-4064.78 287.79,-4056.51"/>
<polygon fill="black" stroke="black" points="291.29,-4056.3 287.79,-4046.3 284.29,-4056.3 291.29,-4056.3"/>
</g>
<!-- layer4_ffn -->
<g id="node15" class="node">
<title>layer4_ffn</title>
<polygon fill="none" stroke="black" points="459.79,-3942 115.79,-3942 115.79,-3874 459.79,-3874 459.79,-3942"/>
<text text-anchor="middle" x="287.79" y="-3926.8" font-family="Times,serif" font-size="14.00">Layer 4 FFN</text>
<text text-anchor="middle" x="287.79" y="-3911.8" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-3896.8" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-3881.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_mha&#45;&gt;layer4_ffn -->
<g id="edge14" class="edge">
<title>layer4_mha&#45;&gt;layer4_ffn</title>
<path fill="none" stroke="black" d="M287.79,-3977.88C287.79,-3969.78 287.79,-3960.98 287.79,-3952.47"/>
<polygon fill="black" stroke="black" points="291.29,-3952.3 287.79,-3942.3 284.29,-3952.3 291.29,-3952.3"/>
</g>
<!-- comm4_5 -->
<g id="node16" class="node">
<title>comm4_5</title>
<ellipse fill="none" stroke="black" cx="287.79" cy="-3789.92" rx="243.49" ry="48.17"/>
<text text-anchor="middle" x="287.79" y="-3808.72" font-family="Times,serif" font-size="14.00">Communication</text>
<text text-anchor="middle" x="287.79" y="-3793.72" font-family="Times,serif" font-size="14.00">GPU 4 → GPU 5</text>
<text text-anchor="middle" x="287.79" y="-3778.72" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-3763.72" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
</g>
<!-- layer4_ffn&#45;&gt;comm4_5 -->
<g id="edge15" class="edge">
<title>layer4_ffn&#45;&gt;comm4_5</title>
<path fill="none" stroke="black" d="M287.79,-3873.73C287.79,-3865.74 287.79,-3856.97 287.79,-3848.23"/>
<polygon fill="black" stroke="black" points="291.29,-3848.02 287.79,-3838.02 284.29,-3848.02 291.29,-3848.02"/>
</g>
<!-- layer5_mha -->
<g id="node17" class="node">
<title>layer5_mha</title>
<polygon fill="none" stroke="black" points="483.29,-3705.83 92.29,-3705.83 92.29,-3637.83 483.29,-3637.83 483.29,-3705.83"/>
<text text-anchor="middle" x="287.79" y="-3690.63" font-family="Times,serif" font-size="14.00">Layer 5 MHA</text>
<text text-anchor="middle" x="287.79" y="-3675.63" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-3660.63" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-3645.63" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- comm4_5&#45;&gt;layer5_mha -->
<g id="edge16" class="edge">
<title>comm4_5&#45;&gt;layer5_mha</title>
<path fill="none" stroke="black" d="M287.79,-3741.7C287.79,-3733.31 287.79,-3724.62 287.79,-3716.34"/>
<polygon fill="black" stroke="black" points="291.29,-3716.14 287.79,-3706.14 284.29,-3716.14 291.29,-3716.14"/>
</g>
<!-- layer5_ffn -->
<g id="node18" class="node">
<title>layer5_ffn</title>
<polygon fill="none" stroke="black" points="459.79,-3601.83 115.79,-3601.83 115.79,-3533.83 459.79,-3533.83 459.79,-3601.83"/>
<text text-anchor="middle" x="287.79" y="-3586.63" font-family="Times,serif" font-size="14.00">Layer 5 FFN</text>
<text text-anchor="middle" x="287.79" y="-3571.63" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-3556.63" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-3541.63" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_mha&#45;&gt;layer5_ffn -->
<g id="edge17" class="edge">
<title>layer5_mha&#45;&gt;layer5_ffn</title>
<path fill="none" stroke="black" d="M287.79,-3637.72C287.79,-3629.61 287.79,-3620.81 287.79,-3612.3"/>
<polygon fill="black" stroke="black" points="291.29,-3612.13 287.79,-3602.13 284.29,-3612.13 291.29,-3612.13"/>
</g>
<!-- comm5_6 -->
<g id="node19" class="node">
<title>comm5_6</title>
<ellipse fill="none" stroke="black" cx="287.79" cy="-3449.75" rx="243.49" ry="48.17"/>
<text text-anchor="middle" x="287.79" y="-3468.55" font-family="Times,serif" font-size="14.00">Communication</text>
<text text-anchor="middle" x="287.79" y="-3453.55" font-family="Times,serif" font-size="14.00">GPU 5 → GPU 6</text>
<text text-anchor="middle" x="287.79" y="-3438.55" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-3423.55" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
</g>
<!-- layer5_ffn&#45;&gt;comm5_6 -->
<g id="edge18" class="edge">
<title>layer5_ffn&#45;&gt;comm5_6</title>
<path fill="none" stroke="black" d="M287.79,-3533.57C287.79,-3525.57 287.79,-3516.81 287.79,-3508.06"/>
<polygon fill="black" stroke="black" points="291.29,-3507.86 287.79,-3497.86 284.29,-3507.86 291.29,-3507.86"/>
</g>
<!-- layer6_mha -->
<g id="node20" class="node">
<title>layer6_mha</title>
<polygon fill="none" stroke="black" points="483.29,-3365.67 92.29,-3365.67 92.29,-3297.67 483.29,-3297.67 483.29,-3365.67"/>
<text text-anchor="middle" x="287.79" y="-3350.47" font-family="Times,serif" font-size="14.00">Layer 6 MHA</text>
<text text-anchor="middle" x="287.79" y="-3335.47" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-3320.47" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-3305.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- comm5_6&#45;&gt;layer6_mha -->
<g id="edge19" class="edge">
<title>comm5_6&#45;&gt;layer6_mha</title>
<path fill="none" stroke="black" d="M287.79,-3401.53C287.79,-3393.15 287.79,-3384.45 287.79,-3376.17"/>
<polygon fill="black" stroke="black" points="291.29,-3375.97 287.79,-3365.97 284.29,-3375.97 291.29,-3375.97"/>
</g>
<!-- layer6_ffn -->
<g id="node21" class="node">
<title>layer6_ffn</title>
<polygon fill="none" stroke="black" points="459.79,-3261.67 115.79,-3261.67 115.79,-3193.67 459.79,-3193.67 459.79,-3261.67"/>
<text text-anchor="middle" x="287.79" y="-3246.47" font-family="Times,serif" font-size="14.00">Layer 6 FFN</text>
<text text-anchor="middle" x="287.79" y="-3231.47" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-3216.47" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-3201.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_mha&#45;&gt;layer6_ffn -->
<g id="edge20" class="edge">
<title>layer6_mha&#45;&gt;layer6_ffn</title>
<path fill="none" stroke="black" d="M287.79,-3297.55C287.79,-3289.44 287.79,-3280.65 287.79,-3272.14"/>
<polygon fill="black" stroke="black" points="291.29,-3271.96 287.79,-3261.96 284.29,-3271.96 291.29,-3271.96"/>
</g>
<!-- comm6_7 -->
<g id="node22" class="node">
<title>comm6_7</title>
<ellipse fill="none" stroke="black" cx="287.79" cy="-3109.58" rx="243.49" ry="48.17"/>
<text text-anchor="middle" x="287.79" y="-3128.38" font-family="Times,serif" font-size="14.00">Communication</text>
<text text-anchor="middle" x="287.79" y="-3113.38" font-family="Times,serif" font-size="14.00">GPU 6 → GPU 7</text>
<text text-anchor="middle" x="287.79" y="-3098.38" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-3083.38" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
</g>
<!-- layer6_ffn&#45;&gt;comm6_7 -->
<g id="edge21" class="edge">
<title>layer6_ffn&#45;&gt;comm6_7</title>
<path fill="none" stroke="black" d="M287.79,-3193.4C287.79,-3185.41 287.79,-3176.64 287.79,-3167.9"/>
<polygon fill="black" stroke="black" points="291.29,-3167.69 287.79,-3157.69 284.29,-3167.69 291.29,-3167.69"/>
</g>
<!-- layer7_mha -->
<g id="node23" class="node">
<title>layer7_mha</title>
<polygon fill="none" stroke="black" points="483.29,-3025.5 92.29,-3025.5 92.29,-2957.5 483.29,-2957.5 483.29,-3025.5"/>
<text text-anchor="middle" x="287.79" y="-3010.3" font-family="Times,serif" font-size="14.00">Layer 7 MHA</text>
<text text-anchor="middle" x="287.79" y="-2995.3" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-2980.3" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-2965.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- comm6_7&#45;&gt;layer7_mha -->
<g id="edge22" class="edge">
<title>comm6_7&#45;&gt;layer7_mha</title>
<path fill="none" stroke="black" d="M287.79,-3061.37C287.79,-3052.98 287.79,-3044.28 287.79,-3036.01"/>
<polygon fill="black" stroke="black" points="291.29,-3035.8 287.79,-3025.8 284.29,-3035.8 291.29,-3035.8"/>
</g>
<!-- layer7_ffn -->
<g id="node24" class="node">
<title>layer7_ffn</title>
<polygon fill="none" stroke="black" points="459.79,-2921.5 115.79,-2921.5 115.79,-2853.5 459.79,-2853.5 459.79,-2921.5"/>
<text text-anchor="middle" x="287.79" y="-2906.3" font-family="Times,serif" font-size="14.00">Layer 7 FFN</text>
<text text-anchor="middle" x="287.79" y="-2891.3" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-2876.3" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-2861.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_mha&#45;&gt;layer7_ffn -->
<g id="edge23" class="edge">
<title>layer7_mha&#45;&gt;layer7_ffn</title>
<path fill="none" stroke="black" d="M287.79,-2957.38C287.79,-2949.28 287.79,-2940.48 287.79,-2931.97"/>
<polygon fill="black" stroke="black" points="291.29,-2931.8 287.79,-2921.8 284.29,-2931.8 291.29,-2931.8"/>
</g>
<!-- comm7_8 -->
<g id="node25" class="node">
<title>comm7_8</title>
<ellipse fill="none" stroke="black" cx="287.79" cy="-2769.42" rx="243.49" ry="48.17"/>
<text text-anchor="middle" x="287.79" y="-2788.22" font-family="Times,serif" font-size="14.00">Communication</text>
<text text-anchor="middle" x="287.79" y="-2773.22" font-family="Times,serif" font-size="14.00">GPU 7 → GPU 8</text>
<text text-anchor="middle" x="287.79" y="-2758.22" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-2743.22" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
</g>
<!-- layer7_ffn&#45;&gt;comm7_8 -->
<g id="edge24" class="edge">
<title>layer7_ffn&#45;&gt;comm7_8</title>
<path fill="none" stroke="black" d="M287.79,-2853.23C287.79,-2845.24 287.79,-2836.47 287.79,-2827.73"/>
<polygon fill="black" stroke="black" points="291.29,-2827.53 287.79,-2817.53 284.29,-2827.53 291.29,-2827.53"/>
</g>
<!-- layer8_mha -->
<g id="node26" class="node">
<title>layer8_mha</title>
<polygon fill="none" stroke="black" points="483.29,-2685.33 92.29,-2685.33 92.29,-2617.33 483.29,-2617.33 483.29,-2685.33"/>
<text text-anchor="middle" x="287.79" y="-2670.13" font-family="Times,serif" font-size="14.00">Layer 8 MHA</text>
<text text-anchor="middle" x="287.79" y="-2655.13" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-2640.13" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-2625.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- comm7_8&#45;&gt;layer8_mha -->
<g id="edge25" class="edge">
<title>comm7_8&#45;&gt;layer8_mha</title>
<path fill="none" stroke="black" d="M287.79,-2721.2C287.79,-2712.81 287.79,-2704.12 287.79,-2695.84"/>
<polygon fill="black" stroke="black" points="291.29,-2695.64 287.79,-2685.64 284.29,-2695.64 291.29,-2695.64"/>
</g>
<!-- layer8_ffn -->
<g id="node27" class="node">
<title>layer8_ffn</title>
<polygon fill="none" stroke="black" points="459.79,-2581.33 115.79,-2581.33 115.79,-2513.33 459.79,-2513.33 459.79,-2581.33"/>
<text text-anchor="middle" x="287.79" y="-2566.13" font-family="Times,serif" font-size="14.00">Layer 8 FFN</text>
<text text-anchor="middle" x="287.79" y="-2551.13" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-2536.13" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-2521.13" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_mha&#45;&gt;layer8_ffn -->
<g id="edge26" class="edge">
<title>layer8_mha&#45;&gt;layer8_ffn</title>
<path fill="none" stroke="black" d="M287.79,-2617.22C287.79,-2609.11 287.79,-2600.31 287.79,-2591.8"/>
<polygon fill="black" stroke="black" points="291.29,-2591.63 287.79,-2581.63 284.29,-2591.63 291.29,-2591.63"/>
</g>
<!-- comm8_9 -->
<g id="node28" class="node">
<title>comm8_9</title>
<ellipse fill="none" stroke="black" cx="287.79" cy="-2429.25" rx="243.49" ry="48.17"/>
<text text-anchor="middle" x="287.79" y="-2448.05" font-family="Times,serif" font-size="14.00">Communication</text>
<text text-anchor="middle" x="287.79" y="-2433.05" font-family="Times,serif" font-size="14.00">GPU 8 → GPU 9</text>
<text text-anchor="middle" x="287.79" y="-2418.05" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-2403.05" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
</g>
<!-- layer8_ffn&#45;&gt;comm8_9 -->
<g id="edge27" class="edge">
<title>layer8_ffn&#45;&gt;comm8_9</title>
<path fill="none" stroke="black" d="M287.79,-2513.07C287.79,-2505.07 287.79,-2496.31 287.79,-2487.56"/>
<polygon fill="black" stroke="black" points="291.29,-2487.36 287.79,-2477.36 284.29,-2487.36 291.29,-2487.36"/>
</g>
<!-- layer9_mha -->
<g id="node29" class="node">
<title>layer9_mha</title>
<polygon fill="none" stroke="black" points="483.29,-2345.17 92.29,-2345.17 92.29,-2277.17 483.29,-2277.17 483.29,-2345.17"/>
<text text-anchor="middle" x="287.79" y="-2329.97" font-family="Times,serif" font-size="14.00">Layer 9 MHA</text>
<text text-anchor="middle" x="287.79" y="-2314.97" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-2299.97" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-2284.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- comm8_9&#45;&gt;layer9_mha -->
<g id="edge28" class="edge">
<title>comm8_9&#45;&gt;layer9_mha</title>
<path fill="none" stroke="black" d="M287.79,-2381.03C287.79,-2372.65 287.79,-2363.95 287.79,-2355.67"/>
<polygon fill="black" stroke="black" points="291.29,-2355.47 287.79,-2345.47 284.29,-2355.47 291.29,-2355.47"/>
</g>
<!-- layer9_ffn -->
<g id="node30" class="node">
<title>layer9_ffn</title>
<polygon fill="none" stroke="black" points="459.79,-2241.17 115.79,-2241.17 115.79,-2173.17 459.79,-2173.17 459.79,-2241.17"/>
<text text-anchor="middle" x="287.79" y="-2225.97" font-family="Times,serif" font-size="14.00">Layer 9 FFN</text>
<text text-anchor="middle" x="287.79" y="-2210.97" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-2195.97" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-2180.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_mha&#45;&gt;layer9_ffn -->
<g id="edge29" class="edge">
<title>layer9_mha&#45;&gt;layer9_ffn</title>
<path fill="none" stroke="black" d="M287.79,-2277.05C287.79,-2268.94 287.79,-2260.15 287.79,-2251.64"/>
<polygon fill="black" stroke="black" points="291.29,-2251.46 287.79,-2241.47 284.29,-2251.47 291.29,-2251.46"/>
</g>
<!-- comm9_10 -->
<g id="node31" class="node">
<title>comm9_10</title>
<ellipse fill="none" stroke="black" cx="287.79" cy="-2089.08" rx="243.49" ry="48.17"/>
<text text-anchor="middle" x="287.79" y="-2107.88" font-family="Times,serif" font-size="14.00">Communication</text>
<text text-anchor="middle" x="287.79" y="-2092.88" font-family="Times,serif" font-size="14.00">GPU 9 → GPU 10</text>
<text text-anchor="middle" x="287.79" y="-2077.88" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-2062.88" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
</g>
<!-- layer9_ffn&#45;&gt;comm9_10 -->
<g id="edge30" class="edge">
<title>layer9_ffn&#45;&gt;comm9_10</title>
<path fill="none" stroke="black" d="M287.79,-2172.9C287.79,-2164.91 287.79,-2156.14 287.79,-2147.4"/>
<polygon fill="black" stroke="black" points="291.29,-2147.19 287.79,-2137.19 284.29,-2147.19 291.29,-2147.19"/>
</g>
<!-- layer10_mha -->
<g id="node32" class="node">
<title>layer10_mha</title>
<polygon fill="none" stroke="black" points="483.29,-2005 92.29,-2005 92.29,-1937 483.29,-1937 483.29,-2005"/>
<text text-anchor="middle" x="287.79" y="-1989.8" font-family="Times,serif" font-size="14.00">Layer 10 MHA</text>
<text text-anchor="middle" x="287.79" y="-1974.8" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-1959.8" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-1944.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- comm9_10&#45;&gt;layer10_mha -->
<g id="edge31" class="edge">
<title>comm9_10&#45;&gt;layer10_mha</title>
<path fill="none" stroke="black" d="M287.79,-2040.87C287.79,-2032.48 287.79,-2023.78 287.79,-2015.51"/>
<polygon fill="black" stroke="black" points="291.29,-2015.3 287.79,-2005.3 284.29,-2015.3 291.29,-2015.3"/>
</g>
<!-- layer10_ffn -->
<g id="node33" class="node">
<title>layer10_ffn</title>
<polygon fill="none" stroke="black" points="459.79,-1901 115.79,-1901 115.79,-1833 459.79,-1833 459.79,-1901"/>
<text text-anchor="middle" x="287.79" y="-1885.8" font-family="Times,serif" font-size="14.00">Layer 10 FFN</text>
<text text-anchor="middle" x="287.79" y="-1870.8" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-1855.8" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-1840.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_mha&#45;&gt;layer10_ffn -->
<g id="edge32" class="edge">
<title>layer10_mha&#45;&gt;layer10_ffn</title>
<path fill="none" stroke="black" d="M287.79,-1936.88C287.79,-1928.78 287.79,-1919.98 287.79,-1911.47"/>
<polygon fill="black" stroke="black" points="291.29,-1911.3 287.79,-1901.3 284.29,-1911.3 291.29,-1911.3"/>
</g>
<!-- comm10_11 -->
<g id="node34" class="node">
<title>comm10_11</title>
<ellipse fill="none" stroke="black" cx="287.79" cy="-1748.92" rx="243.49" ry="48.17"/>
<text text-anchor="middle" x="287.79" y="-1767.72" font-family="Times,serif" font-size="14.00">Communication</text>
<text text-anchor="middle" x="287.79" y="-1752.72" font-family="Times,serif" font-size="14.00">GPU 10 → GPU 11</text>
<text text-anchor="middle" x="287.79" y="-1737.72" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-1722.72" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
</g>
<!-- layer10_ffn&#45;&gt;comm10_11 -->
<g id="edge33" class="edge">
<title>layer10_ffn&#45;&gt;comm10_11</title>
<path fill="none" stroke="black" d="M287.79,-1832.73C287.79,-1824.74 287.79,-1815.98 287.79,-1807.23"/>
<polygon fill="black" stroke="black" points="291.29,-1807.03 287.79,-1797.03 284.29,-1807.03 291.29,-1807.03"/>
</g>
<!-- layer11_mha -->
<g id="node35" class="node">
<title>layer11_mha</title>
<polygon fill="none" stroke="black" points="483.29,-1664.83 92.29,-1664.83 92.29,-1596.83 483.29,-1596.83 483.29,-1664.83"/>
<text text-anchor="middle" x="287.79" y="-1649.63" font-family="Times,serif" font-size="14.00">Layer 11 MHA</text>
<text text-anchor="middle" x="287.79" y="-1634.63" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-1619.63" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-1604.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- comm10_11&#45;&gt;layer11_mha -->
<g id="edge34" class="edge">
<title>comm10_11&#45;&gt;layer11_mha</title>
<path fill="none" stroke="black" d="M287.79,-1700.7C287.79,-1692.31 287.79,-1683.62 287.79,-1675.34"/>
<polygon fill="black" stroke="black" points="291.29,-1675.14 287.79,-1665.14 284.29,-1675.14 291.29,-1675.14"/>
</g>
<!-- layer11_ffn -->
<g id="node36" class="node">
<title>layer11_ffn</title>
<polygon fill="none" stroke="black" points="459.79,-1560.83 115.79,-1560.83 115.79,-1492.83 459.79,-1492.83 459.79,-1560.83"/>
<text text-anchor="middle" x="287.79" y="-1545.63" font-family="Times,serif" font-size="14.00">Layer 11 FFN</text>
<text text-anchor="middle" x="287.79" y="-1530.63" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-1515.63" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-1500.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_mha&#45;&gt;layer11_ffn -->
<g id="edge35" class="edge">
<title>layer11_mha&#45;&gt;layer11_ffn</title>
<path fill="none" stroke="black" d="M287.79,-1596.72C287.79,-1588.61 287.79,-1579.81 287.79,-1571.3"/>
<polygon fill="black" stroke="black" points="291.29,-1571.13 287.79,-1561.13 284.29,-1571.13 291.29,-1571.13"/>
</g>
<!-- comm11_12 -->
<g id="node37" class="node">
<title>comm11_12</title>
<ellipse fill="none" stroke="black" cx="287.79" cy="-1408.75" rx="243.49" ry="48.17"/>
<text text-anchor="middle" x="287.79" y="-1427.55" font-family="Times,serif" font-size="14.00">Communication</text>
<text text-anchor="middle" x="287.79" y="-1412.55" font-family="Times,serif" font-size="14.00">GPU 11 → GPU 12</text>
<text text-anchor="middle" x="287.79" y="-1397.55" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-1382.55" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
</g>
<!-- layer11_ffn&#45;&gt;comm11_12 -->
<g id="edge36" class="edge">
<title>layer11_ffn&#45;&gt;comm11_12</title>
<path fill="none" stroke="black" d="M287.79,-1492.57C287.79,-1484.57 287.79,-1475.81 287.79,-1467.07"/>
<polygon fill="black" stroke="black" points="291.29,-1466.86 287.79,-1456.86 284.29,-1466.86 291.29,-1466.86"/>
</g>
<!-- layer12_mha -->
<g id="node38" class="node">
<title>layer12_mha</title>
<polygon fill="none" stroke="black" points="483.29,-1324.67 92.29,-1324.67 92.29,-1256.67 483.29,-1256.67 483.29,-1324.67"/>
<text text-anchor="middle" x="287.79" y="-1309.47" font-family="Times,serif" font-size="14.00">Layer 12 MHA</text>
<text text-anchor="middle" x="287.79" y="-1294.47" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-1279.47" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-1264.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- comm11_12&#45;&gt;layer12_mha -->
<g id="edge37" class="edge">
<title>comm11_12&#45;&gt;layer12_mha</title>
<path fill="none" stroke="black" d="M287.79,-1360.53C287.79,-1352.15 287.79,-1343.45 287.79,-1335.17"/>
<polygon fill="black" stroke="black" points="291.29,-1334.97 287.79,-1324.97 284.29,-1334.97 291.29,-1334.97"/>
</g>
<!-- layer12_ffn -->
<g id="node39" class="node">
<title>layer12_ffn</title>
<polygon fill="none" stroke="black" points="459.79,-1220.67 115.79,-1220.67 115.79,-1152.67 459.79,-1152.67 459.79,-1220.67"/>
<text text-anchor="middle" x="287.79" y="-1205.47" font-family="Times,serif" font-size="14.00">Layer 12 FFN</text>
<text text-anchor="middle" x="287.79" y="-1190.47" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-1175.47" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-1160.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_mha&#45;&gt;layer12_ffn -->
<g id="edge38" class="edge">
<title>layer12_mha&#45;&gt;layer12_ffn</title>
<path fill="none" stroke="black" d="M287.79,-1256.55C287.79,-1248.44 287.79,-1239.65 287.79,-1231.14"/>
<polygon fill="black" stroke="black" points="291.29,-1230.97 287.79,-1220.97 284.29,-1230.97 291.29,-1230.97"/>
</g>
<!-- comm12_13 -->
<g id="node40" class="node">
<title>comm12_13</title>
<ellipse fill="none" stroke="black" cx="287.79" cy="-1068.58" rx="243.49" ry="48.17"/>
<text text-anchor="middle" x="287.79" y="-1087.38" font-family="Times,serif" font-size="14.00">Communication</text>
<text text-anchor="middle" x="287.79" y="-1072.38" font-family="Times,serif" font-size="14.00">GPU 12 → GPU 13</text>
<text text-anchor="middle" x="287.79" y="-1057.38" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-1042.38" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
</g>
<!-- layer12_ffn&#45;&gt;comm12_13 -->
<g id="edge39" class="edge">
<title>layer12_ffn&#45;&gt;comm12_13</title>
<path fill="none" stroke="black" d="M287.79,-1152.4C287.79,-1144.41 287.79,-1135.64 287.79,-1126.9"/>
<polygon fill="black" stroke="black" points="291.29,-1126.69 287.79,-1116.69 284.29,-1126.69 291.29,-1126.69"/>
</g>
<!-- layer13_mha -->
<g id="node41" class="node">
<title>layer13_mha</title>
<polygon fill="none" stroke="black" points="483.29,-984.5 92.29,-984.5 92.29,-916.5 483.29,-916.5 483.29,-984.5"/>
<text text-anchor="middle" x="287.79" y="-969.3" font-family="Times,serif" font-size="14.00">Layer 13 MHA</text>
<text text-anchor="middle" x="287.79" y="-954.3" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-939.3" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-924.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- comm12_13&#45;&gt;layer13_mha -->
<g id="edge40" class="edge">
<title>comm12_13&#45;&gt;layer13_mha</title>
<path fill="none" stroke="black" d="M287.79,-1020.37C287.79,-1011.98 287.79,-1003.28 287.79,-995.01"/>
<polygon fill="black" stroke="black" points="291.29,-994.8 287.79,-984.8 284.29,-994.8 291.29,-994.8"/>
</g>
<!-- layer13_ffn -->
<g id="node42" class="node">
<title>layer13_ffn</title>
<polygon fill="none" stroke="black" points="459.79,-880.5 115.79,-880.5 115.79,-812.5 459.79,-812.5 459.79,-880.5"/>
<text text-anchor="middle" x="287.79" y="-865.3" font-family="Times,serif" font-size="14.00">Layer 13 FFN</text>
<text text-anchor="middle" x="287.79" y="-850.3" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-835.3" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-820.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_mha&#45;&gt;layer13_ffn -->
<g id="edge41" class="edge">
<title>layer13_mha&#45;&gt;layer13_ffn</title>
<path fill="none" stroke="black" d="M287.79,-916.38C287.79,-908.28 287.79,-899.48 287.79,-890.97"/>
<polygon fill="black" stroke="black" points="291.29,-890.8 287.79,-880.8 284.29,-890.8 291.29,-890.8"/>
</g>
<!-- comm13_14 -->
<g id="node43" class="node">
<title>comm13_14</title>
<ellipse fill="none" stroke="black" cx="287.79" cy="-728.42" rx="243.49" ry="48.17"/>
<text text-anchor="middle" x="287.79" y="-747.22" font-family="Times,serif" font-size="14.00">Communication</text>
<text text-anchor="middle" x="287.79" y="-732.22" font-family="Times,serif" font-size="14.00">GPU 13 → GPU 14</text>
<text text-anchor="middle" x="287.79" y="-717.22" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-702.22" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
</g>
<!-- layer13_ffn&#45;&gt;comm13_14 -->
<g id="edge42" class="edge">
<title>layer13_ffn&#45;&gt;comm13_14</title>
<path fill="none" stroke="black" d="M287.79,-812.23C287.79,-804.24 287.79,-795.48 287.79,-786.73"/>
<polygon fill="black" stroke="black" points="291.29,-786.53 287.79,-776.53 284.29,-786.53 291.29,-786.53"/>
</g>
<!-- layer14_mha -->
<g id="node44" class="node">
<title>layer14_mha</title>
<polygon fill="none" stroke="black" points="483.29,-644.33 92.29,-644.33 92.29,-576.33 483.29,-576.33 483.29,-644.33"/>
<text text-anchor="middle" x="287.79" y="-629.13" font-family="Times,serif" font-size="14.00">Layer 14 MHA</text>
<text text-anchor="middle" x="287.79" y="-614.13" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-599.13" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-584.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- comm13_14&#45;&gt;layer14_mha -->
<g id="edge43" class="edge">
<title>comm13_14&#45;&gt;layer14_mha</title>
<path fill="none" stroke="black" d="M287.79,-680.2C287.79,-671.82 287.79,-663.12 287.79,-654.84"/>
<polygon fill="black" stroke="black" points="291.29,-654.64 287.79,-644.64 284.29,-654.64 291.29,-654.64"/>
</g>
<!-- layer14_ffn -->
<g id="node45" class="node">
<title>layer14_ffn</title>
<polygon fill="none" stroke="black" points="459.79,-540.33 115.79,-540.33 115.79,-472.33 459.79,-472.33 459.79,-540.33"/>
<text text-anchor="middle" x="287.79" y="-525.13" font-family="Times,serif" font-size="14.00">Layer 14 FFN</text>
<text text-anchor="middle" x="287.79" y="-510.13" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-495.13" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-480.13" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_mha&#45;&gt;layer14_ffn -->
<g id="edge44" class="edge">
<title>layer14_mha&#45;&gt;layer14_ffn</title>
<path fill="none" stroke="black" d="M287.79,-576.22C287.79,-568.11 287.79,-559.32 287.79,-550.81"/>
<polygon fill="black" stroke="black" points="291.29,-550.63 287.79,-540.63 284.29,-550.63 291.29,-550.63"/>
</g>
<!-- comm14_15 -->
<g id="node46" class="node">
<title>comm14_15</title>
<ellipse fill="none" stroke="black" cx="287.79" cy="-388.25" rx="243.49" ry="48.17"/>
<text text-anchor="middle" x="287.79" y="-407.05" font-family="Times,serif" font-size="14.00">Communication</text>
<text text-anchor="middle" x="287.79" y="-392.05" font-family="Times,serif" font-size="14.00">GPU 14 → GPU 15</text>
<text text-anchor="middle" x="287.79" y="-377.05" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-362.05" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
</g>
<!-- layer14_ffn&#45;&gt;comm14_15 -->
<g id="edge45" class="edge">
<title>layer14_ffn&#45;&gt;comm14_15</title>
<path fill="none" stroke="black" d="M287.79,-472.07C287.79,-464.07 287.79,-455.31 287.79,-446.57"/>
<polygon fill="black" stroke="black" points="291.29,-446.36 287.79,-436.36 284.29,-446.36 291.29,-446.36"/>
</g>
<!-- layer15_mha -->
<g id="node47" class="node">
<title>layer15_mha</title>
<polygon fill="none" stroke="black" points="483.29,-304.17 92.29,-304.17 92.29,-236.17 483.29,-236.17 483.29,-304.17"/>
<text text-anchor="middle" x="287.79" y="-288.97" font-family="Times,serif" font-size="14.00">Layer 15 MHA</text>
<text text-anchor="middle" x="287.79" y="-273.97" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-258.97" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, heads=32, d_k=128]</text>
<text text-anchor="middle" x="287.79" y="-243.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- comm14_15&#45;&gt;layer15_mha -->
<g id="edge46" class="edge">
<title>comm14_15&#45;&gt;layer15_mha</title>
<path fill="none" stroke="black" d="M287.79,-340.03C287.79,-331.65 287.79,-322.95 287.79,-314.67"/>
<polygon fill="black" stroke="black" points="291.29,-314.47 287.79,-304.47 284.29,-314.47 291.29,-314.47"/>
</g>
<!-- layer15_ffn -->
<g id="node48" class="node">
<title>layer15_ffn</title>
<polygon fill="none" stroke="black" points="459.79,-200.17 115.79,-200.17 115.79,-132.17 459.79,-132.17 459.79,-200.17"/>
<text text-anchor="middle" x="287.79" y="-184.97" font-family="Times,serif" font-size="14.00">Layer 15 FFN</text>
<text text-anchor="middle" x="287.79" y="-169.97" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-154.97" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-139.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_mha&#45;&gt;layer15_ffn -->
<g id="edge47" class="edge">
<title>layer15_mha&#45;&gt;layer15_ffn</title>
<path fill="none" stroke="black" d="M287.79,-236.05C287.79,-227.94 287.79,-219.15 287.79,-210.64"/>
<polygon fill="black" stroke="black" points="291.29,-210.47 287.79,-200.47 284.29,-210.47 291.29,-210.47"/>
</g>
<!-- output -->
<g id="node49" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="287.79" cy="-48.08" rx="243.49" ry="48.17"/>
<text text-anchor="middle" x="287.79" y="-66.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="287.79" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch=8, seq=10000, hidden=4096]</text>
<text text-anchor="middle" x="287.79" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_ffn&#45;&gt;output -->
<g id="edge48" class="edge">
<title>layer15_ffn&#45;&gt;output</title>
<path fill="none" stroke="black" d="M287.79,-131.9C287.79,-123.91 287.79,-115.14 287.79,-106.4"/>
<polygon fill="black" stroke="black" points="291.29,-106.19 287.79,-96.19 284.29,-106.19 291.29,-106.19"/>
</g>
</g>
</svg>
