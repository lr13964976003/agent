<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_deployment Pages: 1 -->
<svg width="646pt" height="3685pt"
 viewBox="0.00 0.00 646.00 3684.98" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3680.98)">
<title>proposed_deployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3680.98 642,-3680.98 642,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_gpu0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-2578.03 8,-3594.03 630,-3594.03 630,-2578.03 8,-2578.03"/>
<text text-anchor="middle" x="319" y="-3578.83" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="319" y="-3563.83" font-family="Times,serif" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="319" y="-3548.83" font-family="Times,serif" font-size="14.00">Cache&#45;fitting: 9.5GB &lt; 50MB*</text>
<text text-anchor="middle" x="319" y="-3533.83" font-family="Times,serif" font-size="14.00">*with optimization</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-1466.07 8,-2467.07 630,-2467.07 630,-1466.07 8,-1466.07"/>
<text text-anchor="middle" x="319" y="-2451.87" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="319" y="-2436.87" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="319" y="-2421.87" font-family="Times,serif" font-size="14.00">Cache&#45;fitting: 9.5GB &lt; 50MB*</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu15</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-124.17 8,-1125.17 630,-1125.17 630,-124.17 8,-124.17"/>
<text text-anchor="middle" x="319" y="-1109.97" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="319" y="-1094.97" font-family="Times,serif" font-size="14.00">Layer 15</text>
<text text-anchor="middle" x="319" y="-1079.97" font-family="Times,serif" font-size="14.00">Final Layer</text>
</g>
<!-- Input -->
<g id="node1" class="node">
<title>Input</title>
<ellipse fill="lightblue" stroke="black" cx="319" cy="-3639.5" rx="303.2" ry="37.45"/>
<text text-anchor="middle" x="319" y="-3650.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="319" y="-3635.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="319" y="-3620.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=8, seq_len=10000, hidden_size=4096]</text>
</g>
<!-- Layer0_Attn_QKV -->
<g id="node2" class="node">
<title>Layer0_Attn_QKV</title>
<polygon fill="lightgreen" stroke="black" points="411.5,-3518.03 226.5,-3518.03 226.5,-3450.03 411.5,-3450.03 411.5,-3518.03"/>
<text text-anchor="middle" x="319" y="-3502.83" font-family="Times,serif" font-size="14.00">Layer 0: QKV Linear</text>
<text text-anchor="middle" x="319" y="-3487.83" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="319" y="-3472.83" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-3457.83" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Input&#45;&gt;Layer0_Attn_QKV -->
<g id="edge1" class="edge">
<title>Input&#45;&gt;Layer0_Attn_QKV</title>
<path fill="none" stroke="black" d="M319,-3601.74C319,-3579.67 319,-3551.48 319,-3528.33"/>
<polygon fill="black" stroke="black" points="322.5,-3528.09 319,-3518.09 315.5,-3528.09 322.5,-3528.09"/>
</g>
<!-- Layer0_Attn_Score -->
<g id="node3" class="node">
<title>Layer0_Attn_Score</title>
<polygon fill="lightgreen" stroke="black" points="414.5,-3414.03 223.5,-3414.03 223.5,-3346.03 414.5,-3346.03 414.5,-3414.03"/>
<text text-anchor="middle" x="319" y="-3398.83" font-family="Times,serif" font-size="14.00">Layer 0: Attention Score</text>
<text text-anchor="middle" x="319" y="-3383.83" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="319" y="-3368.83" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-3353.83" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Layer0_Attn_QKV&#45;&gt;Layer0_Attn_Score -->
<g id="edge2" class="edge">
<title>Layer0_Attn_QKV&#45;&gt;Layer0_Attn_Score</title>
<path fill="none" stroke="black" d="M319,-3449.91C319,-3441.8 319,-3433.01 319,-3424.5"/>
<polygon fill="black" stroke="black" points="322.5,-3424.33 319,-3414.33 315.5,-3424.33 322.5,-3424.33"/>
</g>
<!-- Layer0_Attn_Out -->
<g id="node4" class="node">
<title>Layer0_Attn_Out</title>
<polygon fill="lightgreen" stroke="black" points="411.5,-3310.03 226.5,-3310.03 226.5,-3242.03 411.5,-3242.03 411.5,-3310.03"/>
<text text-anchor="middle" x="319" y="-3294.83" font-family="Times,serif" font-size="14.00">Layer 0: Output Linear</text>
<text text-anchor="middle" x="319" y="-3279.83" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="319" y="-3264.83" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-3249.83" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Layer0_Attn_Score&#45;&gt;Layer0_Attn_Out -->
<g id="edge3" class="edge">
<title>Layer0_Attn_Score&#45;&gt;Layer0_Attn_Out</title>
<path fill="none" stroke="black" d="M319,-3345.91C319,-3337.8 319,-3329.01 319,-3320.5"/>
<polygon fill="black" stroke="black" points="322.5,-3320.33 319,-3310.33 315.5,-3320.33 322.5,-3320.33"/>
</g>
<!-- Layer0_Add1 -->
<g id="node5" class="node">
<title>Layer0_Add1</title>
<polygon fill="orange" stroke="black" points="621.96,-3206.03 140.02,-3206.03 16.04,-3070.03 497.98,-3070.03 621.96,-3206.03"/>
<text text-anchor="middle" x="319" y="-3156.83" font-family="Times,serif" font-size="14.00">Layer 0: Residual Add</text>
<text text-anchor="middle" x="319" y="-3141.83" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="319" y="-3126.83" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096], [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-3111.83" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Layer0_Attn_Out&#45;&gt;Layer0_Add1 -->
<g id="edge4" class="edge">
<title>Layer0_Attn_Out&#45;&gt;Layer0_Add1</title>
<path fill="none" stroke="black" d="M319,-3241.76C319,-3233.93 319,-3225.26 319,-3216.38"/>
<polygon fill="black" stroke="black" points="322.5,-3216.29 319,-3206.29 315.5,-3216.29 322.5,-3216.29"/>
</g>
<!-- Layer0_MLP_Dense1 -->
<g id="node6" class="node">
<title>Layer0_MLP_Dense1</title>
<polygon fill="lightgreen" stroke="black" points="416,-3034.03 222,-3034.03 222,-2966.03 416,-2966.03 416,-3034.03"/>
<text text-anchor="middle" x="319" y="-3018.83" font-family="Times,serif" font-size="14.00">Layer 0: MLP Dense 1</text>
<text text-anchor="middle" x="319" y="-3003.83" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="319" y="-2988.83" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-2973.83" font-family="Times,serif" font-size="14.00">Output: [8,10000,16384]</text>
</g>
<!-- Layer0_Add1&#45;&gt;Layer0_MLP_Dense1 -->
<g id="edge5" class="edge">
<title>Layer0_Add1&#45;&gt;Layer0_MLP_Dense1</title>
<path fill="none" stroke="black" d="M319,-3069.82C319,-3061.07 319,-3052.3 319,-3044.09"/>
<polygon fill="black" stroke="black" points="322.5,-3044.04 319,-3034.04 315.5,-3044.04 322.5,-3044.04"/>
</g>
<!-- Layer0_MLP_Activation -->
<g id="node7" class="node">
<title>Layer0_MLP_Activation</title>
<polygon fill="lightgreen" stroke="black" points="416,-2930.03 222,-2930.03 222,-2862.03 416,-2862.03 416,-2930.03"/>
<text text-anchor="middle" x="319" y="-2914.83" font-family="Times,serif" font-size="14.00">Layer 0: MLP GELU</text>
<text text-anchor="middle" x="319" y="-2899.83" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="319" y="-2884.83" font-family="Times,serif" font-size="14.00">Input: [8,10000,16384]</text>
<text text-anchor="middle" x="319" y="-2869.83" font-family="Times,serif" font-size="14.00">Output: [8,10000,16384]</text>
</g>
<!-- Layer0_MLP_Dense1&#45;&gt;Layer0_MLP_Activation -->
<g id="edge6" class="edge">
<title>Layer0_MLP_Dense1&#45;&gt;Layer0_MLP_Activation</title>
<path fill="none" stroke="black" d="M319,-2965.91C319,-2957.8 319,-2949.01 319,-2940.5"/>
<polygon fill="black" stroke="black" points="322.5,-2940.33 319,-2930.33 315.5,-2940.33 322.5,-2940.33"/>
</g>
<!-- Layer0_MLP_Dense2 -->
<g id="node8" class="node">
<title>Layer0_MLP_Dense2</title>
<polygon fill="lightgreen" stroke="black" points="411.5,-2826.03 226.5,-2826.03 226.5,-2758.03 411.5,-2758.03 411.5,-2826.03"/>
<text text-anchor="middle" x="319" y="-2810.83" font-family="Times,serif" font-size="14.00">Layer 0: MLP Dense 2</text>
<text text-anchor="middle" x="319" y="-2795.83" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="319" y="-2780.83" font-family="Times,serif" font-size="14.00">Input: [8,10000,16384]</text>
<text text-anchor="middle" x="319" y="-2765.83" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Layer0_MLP_Activation&#45;&gt;Layer0_MLP_Dense2 -->
<g id="edge7" class="edge">
<title>Layer0_MLP_Activation&#45;&gt;Layer0_MLP_Dense2</title>
<path fill="none" stroke="black" d="M319,-2861.91C319,-2853.8 319,-2845.01 319,-2836.5"/>
<polygon fill="black" stroke="black" points="322.5,-2836.33 319,-2826.33 315.5,-2836.33 322.5,-2836.33"/>
</g>
<!-- Layer0_Add2 -->
<g id="node9" class="node">
<title>Layer0_Add2</title>
<polygon fill="orange" stroke="black" points="621.96,-2722.03 140.02,-2722.03 16.04,-2586.03 497.98,-2586.03 621.96,-2722.03"/>
<text text-anchor="middle" x="319" y="-2672.83" font-family="Times,serif" font-size="14.00">Layer 0: Residual Add</text>
<text text-anchor="middle" x="319" y="-2657.83" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="319" y="-2642.83" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096], [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-2627.83" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Layer0_MLP_Dense2&#45;&gt;Layer0_Add2 -->
<g id="edge8" class="edge">
<title>Layer0_MLP_Dense2&#45;&gt;Layer0_Add2</title>
<path fill="none" stroke="black" d="M319,-2757.76C319,-2749.93 319,-2741.26 319,-2732.38"/>
<polygon fill="black" stroke="black" points="322.5,-2732.29 319,-2722.29 315.5,-2732.29 322.5,-2732.29"/>
</g>
<!-- Comm0to1 -->
<g id="node10" class="node">
<title>Comm0to1</title>
<ellipse fill="red" stroke="black" cx="319" cy="-2512.55" rx="138.69" ry="37.45"/>
<text text-anchor="middle" x="319" y="-2523.85" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="319" y="-2508.85" font-family="Times,serif" font-size="14.00">GPU 0 &#45;&gt; GPU 1</text>
<text text-anchor="middle" x="319" y="-2493.85" font-family="Times,serif" font-size="14.00">Transfer: [8,10000,4096]</text>
</g>
<!-- Layer0_Add2&#45;&gt;Comm0to1 -->
<g id="edge9" class="edge">
<title>Layer0_Add2&#45;&gt;Comm0to1</title>
<path fill="none" stroke="black" d="M319,-2585.74C319,-2577.12 319,-2568.45 319,-2560.26"/>
<polygon fill="black" stroke="black" points="322.5,-2560.17 319,-2550.17 315.5,-2560.17 322.5,-2560.17"/>
</g>
<!-- Layer1_Attn_QKV -->
<g id="node11" class="node">
<title>Layer1_Attn_QKV</title>
<polygon fill="lightgreen" stroke="black" points="411.5,-2406.07 226.5,-2406.07 226.5,-2338.07 411.5,-2338.07 411.5,-2406.07"/>
<text text-anchor="middle" x="319" y="-2390.87" font-family="Times,serif" font-size="14.00">Layer 1: QKV Linear</text>
<text text-anchor="middle" x="319" y="-2375.87" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="319" y="-2360.87" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-2345.87" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Comm0to1&#45;&gt;Layer1_Attn_QKV -->
<g id="edge10" class="edge">
<title>Comm0to1&#45;&gt;Layer1_Attn_QKV</title>
<path fill="none" stroke="black" d="M319,-2474.8C319,-2456.82 319,-2435.06 319,-2416.28"/>
<polygon fill="black" stroke="black" points="322.5,-2416.2 319,-2406.2 315.5,-2416.2 322.5,-2416.2"/>
</g>
<!-- Layer1_Attn_Score -->
<g id="node12" class="node">
<title>Layer1_Attn_Score</title>
<polygon fill="lightgreen" stroke="black" points="414.5,-2302.07 223.5,-2302.07 223.5,-2234.07 414.5,-2234.07 414.5,-2302.07"/>
<text text-anchor="middle" x="319" y="-2286.87" font-family="Times,serif" font-size="14.00">Layer 1: Attention Score</text>
<text text-anchor="middle" x="319" y="-2271.87" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="319" y="-2256.87" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-2241.87" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Layer1_Attn_QKV&#45;&gt;Layer1_Attn_Score -->
<g id="edge11" class="edge">
<title>Layer1_Attn_QKV&#45;&gt;Layer1_Attn_Score</title>
<path fill="none" stroke="black" d="M319,-2337.96C319,-2329.85 319,-2321.06 319,-2312.55"/>
<polygon fill="black" stroke="black" points="322.5,-2312.37 319,-2302.37 315.5,-2312.37 322.5,-2312.37"/>
</g>
<!-- Layer1_Attn_Out -->
<g id="node13" class="node">
<title>Layer1_Attn_Out</title>
<polygon fill="lightgreen" stroke="black" points="411.5,-2198.07 226.5,-2198.07 226.5,-2130.07 411.5,-2130.07 411.5,-2198.07"/>
<text text-anchor="middle" x="319" y="-2182.87" font-family="Times,serif" font-size="14.00">Layer 1: Output Linear</text>
<text text-anchor="middle" x="319" y="-2167.87" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="319" y="-2152.87" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-2137.87" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Layer1_Attn_Score&#45;&gt;Layer1_Attn_Out -->
<g id="edge12" class="edge">
<title>Layer1_Attn_Score&#45;&gt;Layer1_Attn_Out</title>
<path fill="none" stroke="black" d="M319,-2233.96C319,-2225.85 319,-2217.06 319,-2208.55"/>
<polygon fill="black" stroke="black" points="322.5,-2208.37 319,-2198.37 315.5,-2208.37 322.5,-2208.37"/>
</g>
<!-- Layer1_Add1 -->
<g id="node14" class="node">
<title>Layer1_Add1</title>
<polygon fill="orange" stroke="black" points="621.96,-2094.07 140.02,-2094.07 16.04,-1958.07 497.98,-1958.07 621.96,-2094.07"/>
<text text-anchor="middle" x="319" y="-2044.87" font-family="Times,serif" font-size="14.00">Layer 1: Residual Add</text>
<text text-anchor="middle" x="319" y="-2029.87" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="319" y="-2014.87" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096], [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-1999.87" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Layer1_Attn_Out&#45;&gt;Layer1_Add1 -->
<g id="edge13" class="edge">
<title>Layer1_Attn_Out&#45;&gt;Layer1_Add1</title>
<path fill="none" stroke="black" d="M319,-2129.8C319,-2121.98 319,-2113.31 319,-2104.43"/>
<polygon fill="black" stroke="black" points="322.5,-2104.34 319,-2094.34 315.5,-2104.34 322.5,-2104.34"/>
</g>
<!-- Layer1_MLP_Dense1 -->
<g id="node15" class="node">
<title>Layer1_MLP_Dense1</title>
<polygon fill="lightgreen" stroke="black" points="416,-1922.07 222,-1922.07 222,-1854.07 416,-1854.07 416,-1922.07"/>
<text text-anchor="middle" x="319" y="-1906.87" font-family="Times,serif" font-size="14.00">Layer 1: MLP Dense 1</text>
<text text-anchor="middle" x="319" y="-1891.87" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="319" y="-1876.87" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-1861.87" font-family="Times,serif" font-size="14.00">Output: [8,10000,16384]</text>
</g>
<!-- Layer1_Add1&#45;&gt;Layer1_MLP_Dense1 -->
<g id="edge14" class="edge">
<title>Layer1_Add1&#45;&gt;Layer1_MLP_Dense1</title>
<path fill="none" stroke="black" d="M319,-1957.87C319,-1949.12 319,-1940.35 319,-1932.14"/>
<polygon fill="black" stroke="black" points="322.5,-1932.09 319,-1922.09 315.5,-1932.09 322.5,-1932.09"/>
</g>
<!-- Layer1_MLP_Activation -->
<g id="node16" class="node">
<title>Layer1_MLP_Activation</title>
<polygon fill="lightgreen" stroke="black" points="416,-1818.07 222,-1818.07 222,-1750.07 416,-1750.07 416,-1818.07"/>
<text text-anchor="middle" x="319" y="-1802.87" font-family="Times,serif" font-size="14.00">Layer 1: MLP GELU</text>
<text text-anchor="middle" x="319" y="-1787.87" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="319" y="-1772.87" font-family="Times,serif" font-size="14.00">Input: [8,10000,16384]</text>
<text text-anchor="middle" x="319" y="-1757.87" font-family="Times,serif" font-size="14.00">Output: [8,10000,16384]</text>
</g>
<!-- Layer1_MLP_Dense1&#45;&gt;Layer1_MLP_Activation -->
<g id="edge15" class="edge">
<title>Layer1_MLP_Dense1&#45;&gt;Layer1_MLP_Activation</title>
<path fill="none" stroke="black" d="M319,-1853.96C319,-1845.85 319,-1837.06 319,-1828.55"/>
<polygon fill="black" stroke="black" points="322.5,-1828.37 319,-1818.37 315.5,-1828.37 322.5,-1828.37"/>
</g>
<!-- Layer1_MLP_Dense2 -->
<g id="node17" class="node">
<title>Layer1_MLP_Dense2</title>
<polygon fill="lightgreen" stroke="black" points="411.5,-1714.07 226.5,-1714.07 226.5,-1646.07 411.5,-1646.07 411.5,-1714.07"/>
<text text-anchor="middle" x="319" y="-1698.87" font-family="Times,serif" font-size="14.00">Layer 1: MLP Dense 2</text>
<text text-anchor="middle" x="319" y="-1683.87" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="319" y="-1668.87" font-family="Times,serif" font-size="14.00">Input: [8,10000,16384]</text>
<text text-anchor="middle" x="319" y="-1653.87" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Layer1_MLP_Activation&#45;&gt;Layer1_MLP_Dense2 -->
<g id="edge16" class="edge">
<title>Layer1_MLP_Activation&#45;&gt;Layer1_MLP_Dense2</title>
<path fill="none" stroke="black" d="M319,-1749.96C319,-1741.85 319,-1733.06 319,-1724.55"/>
<polygon fill="black" stroke="black" points="322.5,-1724.37 319,-1714.37 315.5,-1724.37 322.5,-1724.37"/>
</g>
<!-- Layer1_Add2 -->
<g id="node18" class="node">
<title>Layer1_Add2</title>
<polygon fill="orange" stroke="black" points="621.96,-1610.07 140.02,-1610.07 16.04,-1474.07 497.98,-1474.07 621.96,-1610.07"/>
<text text-anchor="middle" x="319" y="-1560.87" font-family="Times,serif" font-size="14.00">Layer 1: Residual Add</text>
<text text-anchor="middle" x="319" y="-1545.87" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="319" y="-1530.87" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096], [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-1515.87" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Layer1_MLP_Dense2&#45;&gt;Layer1_Add2 -->
<g id="edge17" class="edge">
<title>Layer1_MLP_Dense2&#45;&gt;Layer1_Add2</title>
<path fill="none" stroke="black" d="M319,-1645.8C319,-1637.98 319,-1629.31 319,-1620.43"/>
<polygon fill="black" stroke="black" points="322.5,-1620.34 319,-1610.34 315.5,-1620.34 322.5,-1620.34"/>
</g>
<!-- Comm1to2 -->
<g id="node19" class="node">
<title>Comm1to2</title>
<ellipse fill="red" stroke="black" cx="319" cy="-1400.6" rx="138.69" ry="37.45"/>
<text text-anchor="middle" x="319" y="-1411.9" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="319" y="-1396.9" font-family="Times,serif" font-size="14.00">GPU 1 &#45;&gt; GPU 2</text>
<text text-anchor="middle" x="319" y="-1381.9" font-family="Times,serif" font-size="14.00">Transfer: [8,10000,4096]</text>
</g>
<!-- Layer1_Add2&#45;&gt;Comm1to2 -->
<g id="edge18" class="edge">
<title>Layer1_Add2&#45;&gt;Comm1to2</title>
<path fill="none" stroke="black" d="M319,-1473.79C319,-1465.17 319,-1456.49 319,-1448.3"/>
<polygon fill="black" stroke="black" points="322.5,-1448.22 319,-1438.22 315.5,-1448.22 322.5,-1448.22"/>
</g>
<!-- Layer2to14 -->
<g id="node20" class="node">
<title>Layer2to14</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="471.5,-1327.12 166.5,-1327.12 166.5,-1244.12 471.5,-1244.12 471.5,-1327.12"/>
<text text-anchor="middle" x="319" y="-1311.92" font-family="Times,serif" font-size="14.00">Layers 2&#45;14</text>
<text text-anchor="middle" x="319" y="-1296.92" font-family="Times,serif" font-size="14.00">(13x Transformer Layers)</text>
<text text-anchor="middle" x="319" y="-1281.92" font-family="Times,serif" font-size="14.00">Distributed across GPUs 2&#45;14</text>
<text text-anchor="middle" x="319" y="-1266.92" font-family="Times,serif" font-size="14.00">Each layer cached locally</text>
<text text-anchor="middle" x="319" y="-1251.92" font-family="Times,serif" font-size="14.00">Transfer: [8,10000,4096] between GPUs</text>
</g>
<!-- Comm1to2&#45;&gt;Layer2to14 -->
<g id="edge19" class="edge">
<title>Comm1to2&#45;&gt;Layer2to14</title>
<path fill="none" stroke="black" d="M319,-1362.92C319,-1354.85 319,-1346.18 319,-1337.66"/>
<polygon fill="black" stroke="black" points="322.5,-1337.42 319,-1327.42 315.5,-1337.42 322.5,-1337.42"/>
</g>
<!-- Comm14to15 -->
<g id="node21" class="node">
<title>Comm14to15</title>
<ellipse fill="red" stroke="black" cx="319" cy="-1170.64" rx="138.69" ry="37.45"/>
<text text-anchor="middle" x="319" y="-1181.94" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="319" y="-1166.94" font-family="Times,serif" font-size="14.00">GPU 14 &#45;&gt; GPU 15</text>
<text text-anchor="middle" x="319" y="-1151.94" font-family="Times,serif" font-size="14.00">Transfer: [8,10000,4096]</text>
</g>
<!-- Layer2to14&#45;&gt;Comm14to15 -->
<g id="edge20" class="edge">
<title>Layer2to14&#45;&gt;Comm14to15</title>
<path fill="none" stroke="black" d="M319,-1243.83C319,-1235.56 319,-1226.81 319,-1218.36"/>
<polygon fill="black" stroke="black" points="322.5,-1218.25 319,-1208.25 315.5,-1218.25 322.5,-1218.25"/>
</g>
<!-- Layer15_Attn_QKV -->
<g id="node22" class="node">
<title>Layer15_Attn_QKV</title>
<polygon fill="lightgreen" stroke="black" points="411.5,-1064.17 226.5,-1064.17 226.5,-996.17 411.5,-996.17 411.5,-1064.17"/>
<text text-anchor="middle" x="319" y="-1048.97" font-family="Times,serif" font-size="14.00">Layer 15: QKV Linear</text>
<text text-anchor="middle" x="319" y="-1033.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="319" y="-1018.97" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-1003.97" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Comm14to15&#45;&gt;Layer15_Attn_QKV -->
<g id="edge21" class="edge">
<title>Comm14to15&#45;&gt;Layer15_Attn_QKV</title>
<path fill="none" stroke="black" d="M319,-1132.9C319,-1114.91 319,-1093.15 319,-1074.37"/>
<polygon fill="black" stroke="black" points="322.5,-1074.29 319,-1064.29 315.5,-1074.29 322.5,-1074.29"/>
</g>
<!-- Layer15_Attn_Score -->
<g id="node23" class="node">
<title>Layer15_Attn_Score</title>
<polygon fill="lightgreen" stroke="black" points="419,-960.17 219,-960.17 219,-892.17 419,-892.17 419,-960.17"/>
<text text-anchor="middle" x="319" y="-944.97" font-family="Times,serif" font-size="14.00">Layer 15: Attention Score</text>
<text text-anchor="middle" x="319" y="-929.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="319" y="-914.97" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-899.97" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Layer15_Attn_QKV&#45;&gt;Layer15_Attn_Score -->
<g id="edge22" class="edge">
<title>Layer15_Attn_QKV&#45;&gt;Layer15_Attn_Score</title>
<path fill="none" stroke="black" d="M319,-996.05C319,-987.94 319,-979.15 319,-970.64"/>
<polygon fill="black" stroke="black" points="322.5,-970.47 319,-960.47 315.5,-970.47 322.5,-970.47"/>
</g>
<!-- Layer15_Attn_Out -->
<g id="node24" class="node">
<title>Layer15_Attn_Out</title>
<polygon fill="lightgreen" stroke="black" points="413.5,-856.17 224.5,-856.17 224.5,-788.17 413.5,-788.17 413.5,-856.17"/>
<text text-anchor="middle" x="319" y="-840.97" font-family="Times,serif" font-size="14.00">Layer 15: Output Linear</text>
<text text-anchor="middle" x="319" y="-825.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="319" y="-810.97" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-795.97" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Layer15_Attn_Score&#45;&gt;Layer15_Attn_Out -->
<g id="edge23" class="edge">
<title>Layer15_Attn_Score&#45;&gt;Layer15_Attn_Out</title>
<path fill="none" stroke="black" d="M319,-892.05C319,-883.94 319,-875.15 319,-866.64"/>
<polygon fill="black" stroke="black" points="322.5,-866.47 319,-856.47 315.5,-866.47 322.5,-866.47"/>
</g>
<!-- Layer15_Add1 -->
<g id="node25" class="node">
<title>Layer15_Add1</title>
<polygon fill="orange" stroke="black" points="621.96,-752.17 140.02,-752.17 16.04,-616.17 497.98,-616.17 621.96,-752.17"/>
<text text-anchor="middle" x="319" y="-702.97" font-family="Times,serif" font-size="14.00">Layer 15: Residual Add</text>
<text text-anchor="middle" x="319" y="-687.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="319" y="-672.97" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096], [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-657.97" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Layer15_Attn_Out&#45;&gt;Layer15_Add1 -->
<g id="edge24" class="edge">
<title>Layer15_Attn_Out&#45;&gt;Layer15_Add1</title>
<path fill="none" stroke="black" d="M319,-787.9C319,-780.07 319,-771.4 319,-762.52"/>
<polygon fill="black" stroke="black" points="322.5,-762.43 319,-752.43 315.5,-762.43 322.5,-762.43"/>
</g>
<!-- Layer15_MLP_Dense1 -->
<g id="node26" class="node">
<title>Layer15_MLP_Dense1</title>
<polygon fill="lightgreen" stroke="black" points="416,-580.17 222,-580.17 222,-512.17 416,-512.17 416,-580.17"/>
<text text-anchor="middle" x="319" y="-564.97" font-family="Times,serif" font-size="14.00">Layer 15: MLP Dense 1</text>
<text text-anchor="middle" x="319" y="-549.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="319" y="-534.97" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-519.97" font-family="Times,serif" font-size="14.00">Output: [8,10000,16384]</text>
</g>
<!-- Layer15_Add1&#45;&gt;Layer15_MLP_Dense1 -->
<g id="edge25" class="edge">
<title>Layer15_Add1&#45;&gt;Layer15_MLP_Dense1</title>
<path fill="none" stroke="black" d="M319,-615.96C319,-607.21 319,-598.44 319,-590.23"/>
<polygon fill="black" stroke="black" points="322.5,-590.18 319,-580.18 315.5,-590.18 322.5,-590.18"/>
</g>
<!-- Layer15_MLP_Activation -->
<g id="node27" class="node">
<title>Layer15_MLP_Activation</title>
<polygon fill="lightgreen" stroke="black" points="416,-476.17 222,-476.17 222,-408.17 416,-408.17 416,-476.17"/>
<text text-anchor="middle" x="319" y="-460.97" font-family="Times,serif" font-size="14.00">Layer 15: MLP GELU</text>
<text text-anchor="middle" x="319" y="-445.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="319" y="-430.97" font-family="Times,serif" font-size="14.00">Input: [8,10000,16384]</text>
<text text-anchor="middle" x="319" y="-415.97" font-family="Times,serif" font-size="14.00">Output: [8,10000,16384]</text>
</g>
<!-- Layer15_MLP_Dense1&#45;&gt;Layer15_MLP_Activation -->
<g id="edge26" class="edge">
<title>Layer15_MLP_Dense1&#45;&gt;Layer15_MLP_Activation</title>
<path fill="none" stroke="black" d="M319,-512.05C319,-503.94 319,-495.15 319,-486.64"/>
<polygon fill="black" stroke="black" points="322.5,-486.47 319,-476.47 315.5,-486.47 322.5,-486.47"/>
</g>
<!-- Layer15_MLP_Dense2 -->
<g id="node28" class="node">
<title>Layer15_MLP_Dense2</title>
<polygon fill="lightgreen" stroke="black" points="411.5,-372.17 226.5,-372.17 226.5,-304.17 411.5,-304.17 411.5,-372.17"/>
<text text-anchor="middle" x="319" y="-356.97" font-family="Times,serif" font-size="14.00">Layer 15: MLP Dense 2</text>
<text text-anchor="middle" x="319" y="-341.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="319" y="-326.97" font-family="Times,serif" font-size="14.00">Input: [8,10000,16384]</text>
<text text-anchor="middle" x="319" y="-311.97" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Layer15_MLP_Activation&#45;&gt;Layer15_MLP_Dense2 -->
<g id="edge27" class="edge">
<title>Layer15_MLP_Activation&#45;&gt;Layer15_MLP_Dense2</title>
<path fill="none" stroke="black" d="M319,-408.05C319,-399.94 319,-391.15 319,-382.64"/>
<polygon fill="black" stroke="black" points="322.5,-382.47 319,-372.47 315.5,-382.47 322.5,-382.47"/>
</g>
<!-- Layer15_Add2 -->
<g id="node29" class="node">
<title>Layer15_Add2</title>
<polygon fill="orange" stroke="black" points="621.96,-268.17 140.02,-268.17 16.04,-132.17 497.98,-132.17 621.96,-268.17"/>
<text text-anchor="middle" x="319" y="-218.97" font-family="Times,serif" font-size="14.00">Layer 15: Residual Add</text>
<text text-anchor="middle" x="319" y="-203.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="319" y="-188.97" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096], [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-173.97" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Layer15_MLP_Dense2&#45;&gt;Layer15_Add2 -->
<g id="edge28" class="edge">
<title>Layer15_MLP_Dense2&#45;&gt;Layer15_Add2</title>
<path fill="none" stroke="black" d="M319,-303.9C319,-296.07 319,-287.4 319,-278.52"/>
<polygon fill="black" stroke="black" points="322.5,-278.43 319,-268.43 315.5,-278.43 322.5,-278.43"/>
</g>
<!-- Output -->
<g id="node30" class="node">
<title>Output</title>
<ellipse fill="lightblue" stroke="black" cx="319" cy="-48.08" rx="130.63" ry="48.17"/>
<text text-anchor="middle" x="319" y="-66.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="319" y="-51.88" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="319" y="-36.88" font-family="Times,serif" font-size="14.00">Input: [8,10000,4096]</text>
<text text-anchor="middle" x="319" y="-21.88" font-family="Times,serif" font-size="14.00">Output: [8,10000,4096]</text>
</g>
<!-- Layer15_Add2&#45;&gt;Output -->
<g id="edge29" class="edge">
<title>Layer15_Add2&#45;&gt;Output</title>
<path fill="none" stroke="black" d="M319,-132.03C319,-123.48 319,-114.8 319,-106.43"/>
<polygon fill="black" stroke="black" points="322.5,-106.4 319,-96.4 315.5,-106.4 322.5,-106.4"/>
</g>
</g>
</svg>
