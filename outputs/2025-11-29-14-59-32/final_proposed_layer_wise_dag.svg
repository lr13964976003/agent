<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_layer_wise_fixed Pages: 1 -->
<svg width="237pt" height="19753pt"
 viewBox="0.00 0.00 237.20 19753.48" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 19749.48)">
<title>proposed_layer_wise_fixed</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-19749.48 233.2,-19749.48 233.2,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="207.54,-19745.48 85.15,-19745.48 53.66,-19641.48 176.06,-19641.48 207.54,-19745.48"/>
<text text-anchor="middle" x="130.6" y="-19707.48" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="130.6" y="-19696.48" font-family="Arial" font-size="10.00">Batch: 128</text>
<text text-anchor="middle" x="130.6" y="-19685.48" font-family="Arial" font-size="10.00">Seq: 10000</text>
<text text-anchor="middle" x="130.6" y="-19674.48" font-family="Arial" font-size="10.00">Hidden: 4096</text>
</g>
<!-- layer_0_input_dist -->
<g id="node3" class="node">
<title>layer_0_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="224.79,-19605.48 74.96,-19605.48 36.41,-19523.48 186.25,-19523.48 224.79,-19605.48"/>
<text text-anchor="middle" x="130.6" y="-19572.98" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="130.6" y="-19561.98" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="130.6" y="-19550.98" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- input&#45;&gt;layer_0_input_dist -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_0_input_dist</title>
<path fill="none" stroke="black" d="M130.6,-19641.19C130.6,-19632.77 130.6,-19624.06 130.6,-19615.67"/>
<polygon fill="black" stroke="black" points="134.1,-19615.64 130.6,-19605.64 127.1,-19615.64 134.1,-19615.64"/>
</g>
<!-- output -->
<g id="node2" class="node">
<title>output</title>
<polygon fill="lightgreen" stroke="black" points="179.54,-104 57.15,-104 25.66,0 148.06,0 179.54,-104"/>
<text text-anchor="middle" x="102.6" y="-66" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="102.6" y="-55" font-family="Arial" font-size="10.00">Batch: 128</text>
<text text-anchor="middle" x="102.6" y="-44" font-family="Arial" font-size="10.00">Seq: 10000</text>
<text text-anchor="middle" x="102.6" y="-33" font-family="Arial" font-size="10.00">Hidden: 4096</text>
</g>
<!-- layer_0_qkv_gpu0 -->
<g id="node4" class="node">
<title>layer_0_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="140.1,-19487.48 47.1,-19487.48 47.1,-19446.48 140.1,-19446.48 140.1,-19487.48"/>
<text text-anchor="middle" x="93.6" y="-19475.48" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="93.6" y="-19464.48" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="93.6" y="-19453.48" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu0 -->
<g id="edge2" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu0</title>
<path fill="none" stroke="black" d="M115.02,-19523.26C111.62,-19514.49 108.09,-19505.37 104.89,-19497.13"/>
<polygon fill="black" stroke="black" points="108.08,-19495.65 101.2,-19487.59 101.55,-19498.18 108.08,-19495.65"/>
</g>
<!-- layer_0_residual1 -->
<g id="node7" class="node">
<title>layer_0_residual1</title>
<polygon fill="lightyellow" stroke="black" points="208.54,-19245.48 86.15,-19245.48 54.66,-19185.48 177.06,-19185.48 208.54,-19245.48"/>
<text text-anchor="middle" x="131.6" y="-19218.48" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="131.6" y="-19207.48" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_residual1 -->
<g id="edge6" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M141.99,-19523.17C144.72,-19511.73 147.23,-19499.2 148.6,-19487.48 159.22,-19396.55 160.28,-19372.29 148.6,-19281.48 147.5,-19272.92 145.61,-19263.87 143.49,-19255.34"/>
<polygon fill="black" stroke="black" points="146.86,-19254.39 140.92,-19245.61 140.09,-19256.18 146.86,-19254.39"/>
</g>
<!-- layer_0_attention -->
<g id="node5" class="node">
<title>layer_0_attention</title>
<polygon fill="lightblue" stroke="black" points="128.6,-19410.48 60.6,-19410.48 60.6,-19358.48 128.6,-19358.48 128.6,-19410.48"/>
<text text-anchor="middle" x="94.6" y="-19398.48" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="94.6" y="-19387.48" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="94.6" y="-19376.48" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="94.6" y="-19365.48" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_0_qkv_gpu0&#45;&gt;layer_0_attention -->
<g id="edge3" class="edge">
<title>layer_0_qkv_gpu0&#45;&gt;layer_0_attention</title>
<path fill="none" stroke="black" d="M93.85,-19446.08C93.94,-19438.47 94.05,-19429.54 94.16,-19420.91"/>
<polygon fill="black" stroke="black" points="97.66,-19420.68 94.29,-19410.64 90.67,-19420.59 97.66,-19420.68"/>
</g>
<!-- layer_0_attn_out_gpu0 -->
<g id="node6" class="node">
<title>layer_0_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="139.6,-19322.48 51.6,-19322.48 51.6,-19281.48 139.6,-19281.48 139.6,-19322.48"/>
<text text-anchor="middle" x="95.6" y="-19310.48" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="95.6" y="-19299.48" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="95.6" y="-19288.48" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attention&#45;&gt;layer_0_attn_out_gpu0 -->
<g id="edge4" class="edge">
<title>layer_0_attention&#45;&gt;layer_0_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M94.91,-19358.45C95.01,-19350.34 95.13,-19341.26 95.23,-19332.83"/>
<polygon fill="black" stroke="black" points="98.73,-19332.67 95.36,-19322.63 91.73,-19332.58 98.73,-19332.67"/>
</g>
<!-- layer_0_attn_out_gpu0&#45;&gt;layer_0_residual1 -->
<g id="edge5" class="edge">
<title>layer_0_attn_out_gpu0&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M103.95,-19281.38C107.31,-19273.5 111.31,-19264.11 115.21,-19254.97"/>
<polygon fill="black" stroke="black" points="118.5,-19256.16 119.2,-19245.59 112.06,-19253.42 118.5,-19256.16"/>
</g>
<!-- layer_0_ln1 -->
<g id="node8" class="node">
<title>layer_0_ln1</title>
<polygon fill="lightblue" stroke="black" points="131.1,-19149.48 58.1,-19149.48 58.1,-19108.48 131.1,-19108.48 131.1,-19149.48"/>
<text text-anchor="middle" x="94.6" y="-19137.48" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="94.6" y="-19126.48" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="94.6" y="-19115.48" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_0_residual1&#45;&gt;layer_0_ln1 -->
<g id="edge7" class="edge">
<title>layer_0_residual1&#45;&gt;layer_0_ln1</title>
<path fill="none" stroke="black" d="M118.87,-19185.4C115.1,-19176.8 110.98,-19167.39 107.22,-19158.8"/>
<polygon fill="black" stroke="black" points="110.39,-19157.3 103.17,-19149.55 103.97,-19160.11 110.39,-19157.3"/>
</g>
<!-- layer_0_residual2 -->
<g id="node12" class="node">
<title>layer_0_residual2</title>
<polygon fill="lightyellow" stroke="black" points="203.54,-18846.48 81.15,-18846.48 49.66,-18786.48 172.06,-18786.48 203.54,-18846.48"/>
<text text-anchor="middle" x="126.6" y="-18819.48" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="126.6" y="-18808.48" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_0_residual1&#45;&gt;layer_0_residual2 -->
<g id="edge12" class="edge">
<title>layer_0_residual1&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M141.24,-19185.38C150.98,-19153.32 164.6,-19100.06 164.6,-19052.98 164.6,-19052.98 164.6,-19052.98 164.6,-18976.48 164.6,-18934.61 151.98,-18888.19 141.29,-18856.38"/>
<polygon fill="black" stroke="black" points="144.48,-18854.89 137.9,-18846.58 137.86,-18857.18 144.48,-18854.89"/>
</g>
<!-- layer_0_mlp_fc1_gpu0 -->
<g id="node9" class="node">
<title>layer_0_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="136.6,-19072.48 42.6,-19072.48 42.6,-19031.48 136.6,-19031.48 136.6,-19072.48"/>
<text text-anchor="middle" x="89.6" y="-19060.48" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="89.6" y="-19049.48" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="89.6" y="-19038.48" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu0 -->
<g id="edge8" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M93.29,-19108.28C92.77,-19100.44 92.15,-19091.25 91.58,-19082.64"/>
<polygon fill="black" stroke="black" points="95.06,-19082.3 90.91,-19072.56 88.08,-19082.77 95.06,-19082.3"/>
</g>
<!-- layer_0_gelu -->
<g id="node10" class="node">
<title>layer_0_gelu</title>
<polygon fill="lightblue" stroke="black" points="134.1,-18995.48 45.1,-18995.48 45.1,-18959.48 134.1,-18959.48 134.1,-18995.48"/>
<text text-anchor="middle" x="89.6" y="-18980.48" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="89.6" y="-18969.48" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_0_mlp_fc1_gpu0&#45;&gt;layer_0_gelu -->
<g id="edge9" class="edge">
<title>layer_0_mlp_fc1_gpu0&#45;&gt;layer_0_gelu</title>
<path fill="none" stroke="black" d="M89.6,-19031.17C89.6,-19023.39 89.6,-19014.32 89.6,-19005.93"/>
<polygon fill="black" stroke="black" points="93.1,-19005.8 89.6,-18995.8 86.1,-19005.8 93.1,-19005.8"/>
</g>
<!-- layer_0_mlp_fc2_gpu0 -->
<g id="node11" class="node">
<title>layer_0_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="136.6,-18923.48 42.6,-18923.48 42.6,-18882.48 136.6,-18882.48 136.6,-18923.48"/>
<text text-anchor="middle" x="89.6" y="-18911.48" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="89.6" y="-18900.48" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="89.6" y="-18889.48" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu0 -->
<g id="edge10" class="edge">
<title>layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu0</title>
<path fill="none" stroke="black" d="M89.6,-18959.3C89.6,-18951.68 89.6,-18942.49 89.6,-18933.8"/>
<polygon fill="black" stroke="black" points="93.1,-18933.6 89.6,-18923.6 86.1,-18933.6 93.1,-18933.6"/>
</g>
<!-- layer_0_mlp_fc2_gpu0&#45;&gt;layer_0_residual2 -->
<g id="edge11" class="edge">
<title>layer_0_mlp_fc2_gpu0&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M98.18,-18882.38C101.64,-18874.5 105.75,-18865.11 109.75,-18855.97"/>
<polygon fill="black" stroke="black" points="113.05,-18857.16 113.86,-18846.59 106.64,-18854.35 113.05,-18857.16"/>
</g>
<!-- layer_0_ln2 -->
<g id="node13" class="node">
<title>layer_0_ln2</title>
<polygon fill="lightblue" stroke="black" points="163.1,-18750.48 90.1,-18750.48 90.1,-18709.48 163.1,-18709.48 163.1,-18750.48"/>
<text text-anchor="middle" x="126.6" y="-18738.48" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="126.6" y="-18727.48" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="126.6" y="-18716.48" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_0_residual2&#45;&gt;layer_0_ln2 -->
<g id="edge13" class="edge">
<title>layer_0_residual2&#45;&gt;layer_0_ln2</title>
<path fill="none" stroke="black" d="M126.6,-18786.4C126.6,-18778.08 126.6,-18769 126.6,-18760.64"/>
<polygon fill="black" stroke="black" points="130.1,-18760.55 126.6,-18750.55 123.1,-18760.55 130.1,-18760.55"/>
</g>
<!-- layer_0_output_dist -->
<g id="node14" class="node">
<title>layer_0_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="228.31,-18673.48 66.52,-18673.48 24.9,-18591.48 186.69,-18591.48 228.31,-18673.48"/>
<text text-anchor="middle" x="126.6" y="-18640.98" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="126.6" y="-18629.98" font-family="Arial" font-size="10.00">Output Distribution</text>
<text text-anchor="middle" x="126.6" y="-18618.98" font-family="Arial" font-size="10.00">GPU 0→0</text>
</g>
<!-- layer_0_ln2&#45;&gt;layer_0_output_dist -->
<g id="edge14" class="edge">
<title>layer_0_ln2&#45;&gt;layer_0_output_dist</title>
<path fill="none" stroke="black" d="M126.6,-18709.2C126.6,-18701.73 126.6,-18692.86 126.6,-18683.87"/>
<polygon fill="black" stroke="black" points="130.1,-18683.73 126.6,-18673.73 123.1,-18683.73 130.1,-18683.73"/>
</g>
<!-- layer_0_pipeline_send -->
<g id="node15" class="node">
<title>layer_0_pipeline_send</title>
<ellipse fill="red" stroke="black" cx="126.6" cy="-18526.49" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="126.6" y="-18534.99" font-family="Arial" font-size="10.00">Layer 0→1</text>
<text text-anchor="middle" x="126.6" y="-18523.99" font-family="Arial" font-size="10.00">Pipeline Send</text>
<text text-anchor="middle" x="126.6" y="-18512.99" font-family="Arial" font-size="10.00">GPU 0→0</text>
</g>
<!-- layer_0_output_dist&#45;&gt;layer_0_pipeline_send -->
<g id="edge15" class="edge">
<title>layer_0_output_dist&#45;&gt;layer_0_pipeline_send</title>
<path fill="none" stroke="black" d="M126.6,-18591.28C126.6,-18582.92 126.6,-18574.13 126.6,-18565.84"/>
<polygon fill="black" stroke="black" points="130.1,-18565.68 126.6,-18555.68 123.1,-18565.68 130.1,-18565.68"/>
</g>
<!-- layer_1_pipeline_recv -->
<g id="node16" class="node">
<title>layer_1_pipeline_recv</title>
<ellipse fill="red" stroke="black" cx="126.6" cy="-18432.51" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="126.6" y="-18441.01" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="126.6" y="-18430.01" font-family="Arial" font-size="10.00">Pipeline Recv</text>
<text text-anchor="middle" x="126.6" y="-18419.01" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_0_pipeline_send&#45;&gt;layer_1_pipeline_recv -->
<g id="edge16" class="edge">
<title>layer_0_pipeline_send&#45;&gt;layer_1_pipeline_recv</title>
<path fill="none" stroke="black" d="M126.6,-18497.39C126.6,-18489.36 126.6,-18480.45 126.6,-18471.91"/>
<polygon fill="black" stroke="black" points="130.1,-18471.75 126.6,-18461.75 123.1,-18471.75 130.1,-18471.75"/>
</g>
<!-- layer_1_input_dist -->
<g id="node17" class="node">
<title>layer_1_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="220.79,-18367.52 70.96,-18367.52 32.41,-18285.52 182.25,-18285.52 220.79,-18367.52"/>
<text text-anchor="middle" x="126.6" y="-18335.02" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="126.6" y="-18324.02" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="126.6" y="-18313.02" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_1_pipeline_recv&#45;&gt;layer_1_input_dist -->
<g id="edge17" class="edge">
<title>layer_1_pipeline_recv&#45;&gt;layer_1_input_dist</title>
<path fill="none" stroke="black" d="M126.6,-18403.37C126.6,-18395.5 126.6,-18386.7 126.6,-18377.96"/>
<polygon fill="black" stroke="black" points="130.1,-18377.78 126.6,-18367.78 123.1,-18377.78 130.1,-18377.78"/>
</g>
<!-- layer_1_qkv_gpu0 -->
<g id="node18" class="node">
<title>layer_1_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="136.1,-18249.52 43.1,-18249.52 43.1,-18208.52 136.1,-18208.52 136.1,-18249.52"/>
<text text-anchor="middle" x="89.6" y="-18237.52" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="89.6" y="-18226.52" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="89.6" y="-18215.52" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu0 -->
<g id="edge18" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu0</title>
<path fill="none" stroke="black" d="M111.02,-18285.29C107.62,-18276.52 104.09,-18267.41 100.89,-18259.16"/>
<polygon fill="black" stroke="black" points="104.08,-18257.69 97.2,-18249.63 97.55,-18260.22 104.08,-18257.69"/>
</g>
<!-- layer_1_residual1 -->
<g id="node21" class="node">
<title>layer_1_residual1</title>
<polygon fill="lightyellow" stroke="black" points="204.54,-18007.52 82.15,-18007.52 50.66,-17947.52 173.06,-17947.52 204.54,-18007.52"/>
<text text-anchor="middle" x="127.6" y="-17980.52" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="127.6" y="-17969.52" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_residual1 -->
<g id="edge22" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M137.99,-18285.2C140.72,-18273.76 143.23,-18261.23 144.6,-18249.52 155.22,-18158.58 156.28,-18134.32 144.6,-18043.52 143.5,-18034.95 141.61,-18025.91 139.49,-18017.37"/>
<polygon fill="black" stroke="black" points="142.86,-18016.42 136.92,-18007.65 136.09,-18018.21 142.86,-18016.42"/>
</g>
<!-- layer_1_attention -->
<g id="node19" class="node">
<title>layer_1_attention</title>
<polygon fill="lightblue" stroke="black" points="124.6,-18172.52 56.6,-18172.52 56.6,-18120.52 124.6,-18120.52 124.6,-18172.52"/>
<text text-anchor="middle" x="90.6" y="-18160.52" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="90.6" y="-18149.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="90.6" y="-18138.52" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="90.6" y="-18127.52" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_1_qkv_gpu0&#45;&gt;layer_1_attention -->
<g id="edge19" class="edge">
<title>layer_1_qkv_gpu0&#45;&gt;layer_1_attention</title>
<path fill="none" stroke="black" d="M89.85,-18208.12C89.94,-18200.51 90.05,-18191.57 90.16,-18182.94"/>
<polygon fill="black" stroke="black" points="93.66,-18182.71 90.29,-18172.67 86.67,-18182.63 93.66,-18182.71"/>
</g>
<!-- layer_1_attn_out_gpu0 -->
<g id="node20" class="node">
<title>layer_1_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="135.6,-18084.52 47.6,-18084.52 47.6,-18043.52 135.6,-18043.52 135.6,-18084.52"/>
<text text-anchor="middle" x="91.6" y="-18072.52" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="91.6" y="-18061.52" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="91.6" y="-18050.52" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attention&#45;&gt;layer_1_attn_out_gpu0 -->
<g id="edge20" class="edge">
<title>layer_1_attention&#45;&gt;layer_1_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M90.91,-18120.49C91.01,-18112.37 91.13,-18103.29 91.23,-18094.87"/>
<polygon fill="black" stroke="black" points="94.73,-18094.71 91.36,-18084.66 87.73,-18094.62 94.73,-18094.71"/>
</g>
<!-- layer_1_attn_out_gpu0&#45;&gt;layer_1_residual1 -->
<g id="edge21" class="edge">
<title>layer_1_attn_out_gpu0&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M99.95,-18043.42C103.31,-18035.53 107.31,-18026.15 111.21,-18017"/>
<polygon fill="black" stroke="black" points="114.5,-18018.2 115.2,-18007.63 108.06,-18015.45 114.5,-18018.2"/>
</g>
<!-- layer_1_ln1 -->
<g id="node22" class="node">
<title>layer_1_ln1</title>
<polygon fill="lightblue" stroke="black" points="132.1,-17911.52 59.1,-17911.52 59.1,-17870.52 132.1,-17870.52 132.1,-17911.52"/>
<text text-anchor="middle" x="95.6" y="-17899.52" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="95.6" y="-17888.52" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="95.6" y="-17877.52" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_1_residual1&#45;&gt;layer_1_ln1 -->
<g id="edge23" class="edge">
<title>layer_1_residual1&#45;&gt;layer_1_ln1</title>
<path fill="none" stroke="black" d="M116.59,-17947.44C113.37,-17938.93 109.84,-17929.63 106.62,-17921.12"/>
<polygon fill="black" stroke="black" points="109.83,-17919.69 103.01,-17911.58 103.28,-17922.17 109.83,-17919.69"/>
</g>
<!-- layer_1_residual2 -->
<g id="node26" class="node">
<title>layer_1_residual2</title>
<polygon fill="lightyellow" stroke="black" points="204.54,-17608.52 82.15,-17608.52 50.66,-17548.52 173.06,-17548.52 204.54,-17608.52"/>
<text text-anchor="middle" x="127.6" y="-17581.52" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="127.6" y="-17570.52" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_1_residual1&#45;&gt;layer_1_residual2 -->
<g id="edge28" class="edge">
<title>layer_1_residual1&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M138.8,-17947.24C150.01,-17915.25 165.6,-17862.26 165.6,-17815.02 165.6,-17815.02 165.6,-17815.02 165.6,-17738.52 165.6,-17696.64 152.98,-17650.23 142.29,-17618.41"/>
<polygon fill="black" stroke="black" points="145.48,-17616.92 138.9,-17608.62 138.86,-17619.21 145.48,-17616.92"/>
</g>
<!-- layer_1_mlp_fc1_gpu0 -->
<g id="node23" class="node">
<title>layer_1_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="137.6,-17834.52 43.6,-17834.52 43.6,-17793.52 137.6,-17793.52 137.6,-17834.52"/>
<text text-anchor="middle" x="90.6" y="-17822.52" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="90.6" y="-17811.52" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="90.6" y="-17800.52" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu0 -->
<g id="edge24" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M94.29,-17870.31C93.77,-17862.47 93.15,-17853.29 92.58,-17844.68"/>
<polygon fill="black" stroke="black" points="96.06,-17844.34 91.91,-17834.59 89.08,-17844.8 96.06,-17844.34"/>
</g>
<!-- layer_1_gelu -->
<g id="node24" class="node">
<title>layer_1_gelu</title>
<polygon fill="lightblue" stroke="black" points="135.1,-17757.52 46.1,-17757.52 46.1,-17721.52 135.1,-17721.52 135.1,-17757.52"/>
<text text-anchor="middle" x="90.6" y="-17742.52" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="90.6" y="-17731.52" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_1_mlp_fc1_gpu0&#45;&gt;layer_1_gelu -->
<g id="edge25" class="edge">
<title>layer_1_mlp_fc1_gpu0&#45;&gt;layer_1_gelu</title>
<path fill="none" stroke="black" d="M90.6,-17793.21C90.6,-17785.42 90.6,-17776.36 90.6,-17767.96"/>
<polygon fill="black" stroke="black" points="94.1,-17767.84 90.6,-17757.84 87.1,-17767.84 94.1,-17767.84"/>
</g>
<!-- layer_1_mlp_fc2_gpu0 -->
<g id="node25" class="node">
<title>layer_1_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="137.6,-17685.52 43.6,-17685.52 43.6,-17644.52 137.6,-17644.52 137.6,-17685.52"/>
<text text-anchor="middle" x="90.6" y="-17673.52" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="90.6" y="-17662.52" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="90.6" y="-17651.52" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu0 -->
<g id="edge26" class="edge">
<title>layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu0</title>
<path fill="none" stroke="black" d="M90.6,-17721.34C90.6,-17713.71 90.6,-17704.52 90.6,-17695.84"/>
<polygon fill="black" stroke="black" points="94.1,-17695.64 90.6,-17685.64 87.1,-17695.64 94.1,-17695.64"/>
</g>
<!-- layer_1_mlp_fc2_gpu0&#45;&gt;layer_1_residual2 -->
<g id="edge27" class="edge">
<title>layer_1_mlp_fc2_gpu0&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M99.18,-17644.42C102.64,-17636.53 106.75,-17627.15 110.75,-17618"/>
<polygon fill="black" stroke="black" points="114.05,-17619.19 114.86,-17608.63 107.64,-17616.38 114.05,-17619.19"/>
</g>
<!-- layer_1_ln2 -->
<g id="node27" class="node">
<title>layer_1_ln2</title>
<polygon fill="lightblue" stroke="black" points="164.1,-17512.52 91.1,-17512.52 91.1,-17471.52 164.1,-17471.52 164.1,-17512.52"/>
<text text-anchor="middle" x="127.6" y="-17500.52" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="127.6" y="-17489.52" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="127.6" y="-17478.52" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_1_residual2&#45;&gt;layer_1_ln2 -->
<g id="edge29" class="edge">
<title>layer_1_residual2&#45;&gt;layer_1_ln2</title>
<path fill="none" stroke="black" d="M127.6,-17548.44C127.6,-17540.11 127.6,-17531.03 127.6,-17522.67"/>
<polygon fill="black" stroke="black" points="131.1,-17522.58 127.6,-17512.58 124.1,-17522.58 131.1,-17522.58"/>
</g>
<!-- layer_1_output_dist -->
<g id="node28" class="node">
<title>layer_1_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="229.31,-17435.52 67.52,-17435.52 25.9,-17353.52 187.69,-17353.52 229.31,-17435.52"/>
<text text-anchor="middle" x="127.6" y="-17403.02" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="127.6" y="-17392.02" font-family="Arial" font-size="10.00">Output Distribution</text>
<text text-anchor="middle" x="127.6" y="-17381.02" font-family="Arial" font-size="10.00">GPU 0→1</text>
</g>
<!-- layer_1_ln2&#45;&gt;layer_1_output_dist -->
<g id="edge30" class="edge">
<title>layer_1_ln2&#45;&gt;layer_1_output_dist</title>
<path fill="none" stroke="black" d="M127.6,-17471.23C127.6,-17463.77 127.6,-17454.9 127.6,-17445.9"/>
<polygon fill="black" stroke="black" points="131.1,-17445.76 127.6,-17435.76 124.1,-17445.76 131.1,-17445.76"/>
</g>
<!-- layer_1_pipeline_send -->
<g id="node29" class="node">
<title>layer_1_pipeline_send</title>
<ellipse fill="red" stroke="black" cx="127.6" cy="-17288.53" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="127.6" y="-17297.03" font-family="Arial" font-size="10.00">Layer 1→2</text>
<text text-anchor="middle" x="127.6" y="-17286.03" font-family="Arial" font-size="10.00">Pipeline Send</text>
<text text-anchor="middle" x="127.6" y="-17275.03" font-family="Arial" font-size="10.00">GPU 0→1</text>
</g>
<!-- layer_1_output_dist&#45;&gt;layer_1_pipeline_send -->
<g id="edge31" class="edge">
<title>layer_1_output_dist&#45;&gt;layer_1_pipeline_send</title>
<path fill="none" stroke="black" d="M127.6,-17353.31C127.6,-17344.95 127.6,-17336.16 127.6,-17327.87"/>
<polygon fill="black" stroke="black" points="131.1,-17327.71 127.6,-17317.71 124.1,-17327.71 131.1,-17327.71"/>
</g>
<!-- layer_2_pipeline_recv -->
<g id="node30" class="node">
<title>layer_2_pipeline_recv</title>
<ellipse fill="red" stroke="black" cx="127.6" cy="-17194.54" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="127.6" y="-17203.04" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="127.6" y="-17192.04" font-family="Arial" font-size="10.00">Pipeline Recv</text>
<text text-anchor="middle" x="127.6" y="-17181.04" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_1_pipeline_send&#45;&gt;layer_2_pipeline_recv -->
<g id="edge32" class="edge">
<title>layer_1_pipeline_send&#45;&gt;layer_2_pipeline_recv</title>
<path fill="none" stroke="black" d="M127.6,-17259.43C127.6,-17251.39 127.6,-17242.49 127.6,-17233.95"/>
<polygon fill="black" stroke="black" points="131.1,-17233.79 127.6,-17223.79 124.1,-17233.79 131.1,-17233.79"/>
</g>
<!-- layer_2_input_dist -->
<g id="node31" class="node">
<title>layer_2_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="221.79,-17129.55 71.96,-17129.55 33.41,-17047.55 183.25,-17047.55 221.79,-17129.55"/>
<text text-anchor="middle" x="127.6" y="-17097.05" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="127.6" y="-17086.05" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="127.6" y="-17075.05" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_2_pipeline_recv&#45;&gt;layer_2_input_dist -->
<g id="edge33" class="edge">
<title>layer_2_pipeline_recv&#45;&gt;layer_2_input_dist</title>
<path fill="none" stroke="black" d="M127.6,-17165.4C127.6,-17157.53 127.6,-17148.73 127.6,-17139.99"/>
<polygon fill="black" stroke="black" points="131.1,-17139.82 127.6,-17129.82 124.1,-17139.82 131.1,-17139.82"/>
</g>
<!-- layer_2_qkv_gpu1 -->
<g id="node32" class="node">
<title>layer_2_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="137.1,-17011.55 44.1,-17011.55 44.1,-16970.55 137.1,-16970.55 137.1,-17011.55"/>
<text text-anchor="middle" x="90.6" y="-16999.55" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="90.6" y="-16988.55" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="90.6" y="-16977.55" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu1 -->
<g id="edge34" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu1</title>
<path fill="none" stroke="black" d="M112.02,-17047.33C108.62,-17038.56 105.09,-17029.44 101.89,-17021.2"/>
<polygon fill="black" stroke="black" points="105.08,-17019.72 98.2,-17011.66 98.55,-17022.25 105.08,-17019.72"/>
</g>
<!-- layer_2_residual1 -->
<g id="node35" class="node">
<title>layer_2_residual1</title>
<polygon fill="lightyellow" stroke="black" points="205.54,-16769.55 83.15,-16769.55 51.66,-16709.55 174.06,-16709.55 205.54,-16769.55"/>
<text text-anchor="middle" x="128.6" y="-16742.55" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="128.6" y="-16731.55" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_residual1 -->
<g id="edge38" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M138.99,-17047.24C141.72,-17035.8 144.23,-17023.27 145.6,-17011.55 156.22,-16920.61 157.28,-16896.36 145.6,-16805.55 144.5,-16796.99 142.61,-16787.94 140.49,-16779.41"/>
<polygon fill="black" stroke="black" points="143.86,-16778.46 137.92,-16769.68 137.09,-16780.25 143.86,-16778.46"/>
</g>
<!-- layer_2_attention -->
<g id="node33" class="node">
<title>layer_2_attention</title>
<polygon fill="lightblue" stroke="black" points="125.6,-16934.55 57.6,-16934.55 57.6,-16882.55 125.6,-16882.55 125.6,-16934.55"/>
<text text-anchor="middle" x="91.6" y="-16922.55" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="91.6" y="-16911.55" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="91.6" y="-16900.55" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="91.6" y="-16889.55" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_2_qkv_gpu1&#45;&gt;layer_2_attention -->
<g id="edge35" class="edge">
<title>layer_2_qkv_gpu1&#45;&gt;layer_2_attention</title>
<path fill="none" stroke="black" d="M90.85,-16970.15C90.94,-16962.54 91.05,-16953.61 91.16,-16944.98"/>
<polygon fill="black" stroke="black" points="94.66,-16944.75 91.29,-16934.71 87.67,-16944.66 94.66,-16944.75"/>
</g>
<!-- layer_2_attn_out_gpu1 -->
<g id="node34" class="node">
<title>layer_2_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="136.6,-16846.55 48.6,-16846.55 48.6,-16805.55 136.6,-16805.55 136.6,-16846.55"/>
<text text-anchor="middle" x="92.6" y="-16834.55" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="92.6" y="-16823.55" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="92.6" y="-16812.55" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attention&#45;&gt;layer_2_attn_out_gpu1 -->
<g id="edge36" class="edge">
<title>layer_2_attention&#45;&gt;layer_2_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M91.91,-16882.52C92.01,-16874.41 92.13,-16865.33 92.23,-16856.9"/>
<polygon fill="black" stroke="black" points="95.73,-16856.74 92.36,-16846.7 88.73,-16856.65 95.73,-16856.74"/>
</g>
<!-- layer_2_attn_out_gpu1&#45;&gt;layer_2_residual1 -->
<g id="edge37" class="edge">
<title>layer_2_attn_out_gpu1&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M100.95,-16805.45C104.31,-16797.56 108.31,-16788.18 112.21,-16779.03"/>
<polygon fill="black" stroke="black" points="115.5,-16780.23 116.2,-16769.66 109.06,-16777.49 115.5,-16780.23"/>
</g>
<!-- layer_2_ln1 -->
<g id="node36" class="node">
<title>layer_2_ln1</title>
<polygon fill="lightblue" stroke="black" points="128.1,-16673.55 55.1,-16673.55 55.1,-16632.55 128.1,-16632.55 128.1,-16673.55"/>
<text text-anchor="middle" x="91.6" y="-16661.55" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="91.6" y="-16650.55" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="91.6" y="-16639.55" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_2_residual1&#45;&gt;layer_2_ln1 -->
<g id="edge39" class="edge">
<title>layer_2_residual1&#45;&gt;layer_2_ln1</title>
<path fill="none" stroke="black" d="M115.87,-16709.47C112.1,-16700.87 107.98,-16691.46 104.22,-16682.87"/>
<polygon fill="black" stroke="black" points="107.39,-16681.37 100.17,-16673.62 100.97,-16684.18 107.39,-16681.37"/>
</g>
<!-- layer_2_residual2 -->
<g id="node40" class="node">
<title>layer_2_residual2</title>
<polygon fill="lightyellow" stroke="black" points="200.54,-16370.55 78.15,-16370.55 46.66,-16310.55 169.06,-16310.55 200.54,-16370.55"/>
<text text-anchor="middle" x="123.6" y="-16343.55" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="123.6" y="-16332.55" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_2_residual1&#45;&gt;layer_2_residual2 -->
<g id="edge44" class="edge">
<title>layer_2_residual1&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M138.24,-16709.45C147.98,-16677.39 161.6,-16624.13 161.6,-16577.05 161.6,-16577.05 161.6,-16577.05 161.6,-16500.55 161.6,-16458.68 148.98,-16412.26 138.29,-16380.44"/>
<polygon fill="black" stroke="black" points="141.48,-16378.96 134.9,-16370.65 134.86,-16381.25 141.48,-16378.96"/>
</g>
<!-- layer_2_mlp_fc1_gpu1 -->
<g id="node37" class="node">
<title>layer_2_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="133.6,-16596.55 39.6,-16596.55 39.6,-16555.55 133.6,-16555.55 133.6,-16596.55"/>
<text text-anchor="middle" x="86.6" y="-16584.55" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="86.6" y="-16573.55" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="86.6" y="-16562.55" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu1 -->
<g id="edge40" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M90.29,-16632.35C89.77,-16624.51 89.15,-16615.32 88.58,-16606.71"/>
<polygon fill="black" stroke="black" points="92.06,-16606.37 87.91,-16596.63 85.08,-16606.84 92.06,-16606.37"/>
</g>
<!-- layer_2_gelu -->
<g id="node38" class="node">
<title>layer_2_gelu</title>
<polygon fill="lightblue" stroke="black" points="131.1,-16519.55 42.1,-16519.55 42.1,-16483.55 131.1,-16483.55 131.1,-16519.55"/>
<text text-anchor="middle" x="86.6" y="-16504.55" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="86.6" y="-16493.55" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_2_mlp_fc1_gpu1&#45;&gt;layer_2_gelu -->
<g id="edge41" class="edge">
<title>layer_2_mlp_fc1_gpu1&#45;&gt;layer_2_gelu</title>
<path fill="none" stroke="black" d="M86.6,-16555.24C86.6,-16547.46 86.6,-16538.39 86.6,-16530"/>
<polygon fill="black" stroke="black" points="90.1,-16529.87 86.6,-16519.87 83.1,-16529.87 90.1,-16529.87"/>
</g>
<!-- layer_2_mlp_fc2_gpu1 -->
<g id="node39" class="node">
<title>layer_2_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="133.6,-16447.55 39.6,-16447.55 39.6,-16406.55 133.6,-16406.55 133.6,-16447.55"/>
<text text-anchor="middle" x="86.6" y="-16435.55" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="86.6" y="-16424.55" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="86.6" y="-16413.55" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu1 -->
<g id="edge42" class="edge">
<title>layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu1</title>
<path fill="none" stroke="black" d="M86.6,-16483.37C86.6,-16475.75 86.6,-16466.56 86.6,-16457.87"/>
<polygon fill="black" stroke="black" points="90.1,-16457.67 86.6,-16447.67 83.1,-16457.67 90.1,-16457.67"/>
</g>
<!-- layer_2_mlp_fc2_gpu1&#45;&gt;layer_2_residual2 -->
<g id="edge43" class="edge">
<title>layer_2_mlp_fc2_gpu1&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M95.18,-16406.45C98.64,-16398.56 102.75,-16389.18 106.75,-16380.03"/>
<polygon fill="black" stroke="black" points="110.05,-16381.23 110.86,-16370.66 103.64,-16378.42 110.05,-16381.23"/>
</g>
<!-- layer_2_ln2 -->
<g id="node41" class="node">
<title>layer_2_ln2</title>
<polygon fill="lightblue" stroke="black" points="160.1,-16274.55 87.1,-16274.55 87.1,-16233.55 160.1,-16233.55 160.1,-16274.55"/>
<text text-anchor="middle" x="123.6" y="-16262.55" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="123.6" y="-16251.55" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="123.6" y="-16240.55" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_2_residual2&#45;&gt;layer_2_ln2 -->
<g id="edge45" class="edge">
<title>layer_2_residual2&#45;&gt;layer_2_ln2</title>
<path fill="none" stroke="black" d="M123.6,-16310.47C123.6,-16302.15 123.6,-16293.06 123.6,-16284.71"/>
<polygon fill="black" stroke="black" points="127.1,-16284.62 123.6,-16274.62 120.1,-16284.62 127.1,-16284.62"/>
</g>
<!-- layer_2_output_dist -->
<g id="node42" class="node">
<title>layer_2_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="225.31,-16197.55 63.52,-16197.55 21.9,-16115.55 183.69,-16115.55 225.31,-16197.55"/>
<text text-anchor="middle" x="123.6" y="-16165.05" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="123.6" y="-16154.05" font-family="Arial" font-size="10.00">Output Distribution</text>
<text text-anchor="middle" x="123.6" y="-16143.05" font-family="Arial" font-size="10.00">GPU 1→1</text>
</g>
<!-- layer_2_ln2&#45;&gt;layer_2_output_dist -->
<g id="edge46" class="edge">
<title>layer_2_ln2&#45;&gt;layer_2_output_dist</title>
<path fill="none" stroke="black" d="M123.6,-16233.26C123.6,-16225.8 123.6,-16216.93 123.6,-16207.94"/>
<polygon fill="black" stroke="black" points="127.1,-16207.8 123.6,-16197.8 120.1,-16207.8 127.1,-16207.8"/>
</g>
<!-- layer_2_pipeline_send -->
<g id="node43" class="node">
<title>layer_2_pipeline_send</title>
<ellipse fill="red" stroke="black" cx="123.6" cy="-16050.56" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="123.6" y="-16059.06" font-family="Arial" font-size="10.00">Layer 2→3</text>
<text text-anchor="middle" x="123.6" y="-16048.06" font-family="Arial" font-size="10.00">Pipeline Send</text>
<text text-anchor="middle" x="123.6" y="-16037.06" font-family="Arial" font-size="10.00">GPU 1→1</text>
</g>
<!-- layer_2_output_dist&#45;&gt;layer_2_pipeline_send -->
<g id="edge47" class="edge">
<title>layer_2_output_dist&#45;&gt;layer_2_pipeline_send</title>
<path fill="none" stroke="black" d="M123.6,-16115.35C123.6,-16106.99 123.6,-16098.2 123.6,-16089.91"/>
<polygon fill="black" stroke="black" points="127.1,-16089.74 123.6,-16079.74 120.1,-16089.74 127.1,-16089.74"/>
</g>
<!-- layer_3_pipeline_recv -->
<g id="node44" class="node">
<title>layer_3_pipeline_recv</title>
<ellipse fill="red" stroke="black" cx="123.6" cy="-15956.58" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="123.6" y="-15965.08" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="123.6" y="-15954.08" font-family="Arial" font-size="10.00">Pipeline Recv</text>
<text text-anchor="middle" x="123.6" y="-15943.08" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_2_pipeline_send&#45;&gt;layer_3_pipeline_recv -->
<g id="edge48" class="edge">
<title>layer_2_pipeline_send&#45;&gt;layer_3_pipeline_recv</title>
<path fill="none" stroke="black" d="M123.6,-16021.46C123.6,-16013.42 123.6,-16004.52 123.6,-15995.98"/>
<polygon fill="black" stroke="black" points="127.1,-15995.82 123.6,-15985.82 120.1,-15995.82 127.1,-15995.82"/>
</g>
<!-- layer_3_input_dist -->
<g id="node45" class="node">
<title>layer_3_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="217.79,-15891.59 67.96,-15891.59 29.41,-15809.59 179.25,-15809.59 217.79,-15891.59"/>
<text text-anchor="middle" x="123.6" y="-15859.09" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="123.6" y="-15848.09" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="123.6" y="-15837.09" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_3_pipeline_recv&#45;&gt;layer_3_input_dist -->
<g id="edge49" class="edge">
<title>layer_3_pipeline_recv&#45;&gt;layer_3_input_dist</title>
<path fill="none" stroke="black" d="M123.6,-15927.44C123.6,-15919.57 123.6,-15910.77 123.6,-15902.03"/>
<polygon fill="black" stroke="black" points="127.1,-15901.85 123.6,-15891.85 120.1,-15901.85 127.1,-15901.85"/>
</g>
<!-- layer_3_qkv_gpu1 -->
<g id="node46" class="node">
<title>layer_3_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="133.1,-15773.59 40.1,-15773.59 40.1,-15732.59 133.1,-15732.59 133.1,-15773.59"/>
<text text-anchor="middle" x="86.6" y="-15761.59" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="86.6" y="-15750.59" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="86.6" y="-15739.59" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu1 -->
<g id="edge50" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu1</title>
<path fill="none" stroke="black" d="M108.02,-15809.36C104.62,-15800.59 101.09,-15791.47 97.89,-15783.23"/>
<polygon fill="black" stroke="black" points="101.08,-15781.76 94.2,-15773.7 94.55,-15784.29 101.08,-15781.76"/>
</g>
<!-- layer_3_residual1 -->
<g id="node49" class="node">
<title>layer_3_residual1</title>
<polygon fill="lightyellow" stroke="black" points="201.54,-15531.59 79.15,-15531.59 47.66,-15471.59 170.06,-15471.59 201.54,-15531.59"/>
<text text-anchor="middle" x="124.6" y="-15504.59" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="124.6" y="-15493.59" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_residual1 -->
<g id="edge54" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M134.99,-15809.27C137.72,-15797.83 140.23,-15785.3 141.6,-15773.59 152.22,-15682.65 153.28,-15658.39 141.6,-15567.59 140.5,-15559.02 138.61,-15549.97 136.49,-15541.44"/>
<polygon fill="black" stroke="black" points="139.86,-15540.49 133.92,-15531.72 133.09,-15542.28 139.86,-15540.49"/>
</g>
<!-- layer_3_attention -->
<g id="node47" class="node">
<title>layer_3_attention</title>
<polygon fill="lightblue" stroke="black" points="121.6,-15696.59 53.6,-15696.59 53.6,-15644.59 121.6,-15644.59 121.6,-15696.59"/>
<text text-anchor="middle" x="87.6" y="-15684.59" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="87.6" y="-15673.59" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="87.6" y="-15662.59" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="87.6" y="-15651.59" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_3_qkv_gpu1&#45;&gt;layer_3_attention -->
<g id="edge51" class="edge">
<title>layer_3_qkv_gpu1&#45;&gt;layer_3_attention</title>
<path fill="none" stroke="black" d="M86.85,-15732.19C86.94,-15724.57 87.05,-15715.64 87.16,-15707.01"/>
<polygon fill="black" stroke="black" points="90.66,-15706.78 87.29,-15696.74 83.67,-15706.7 90.66,-15706.78"/>
</g>
<!-- layer_3_attn_out_gpu1 -->
<g id="node48" class="node">
<title>layer_3_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="132.6,-15608.59 44.6,-15608.59 44.6,-15567.59 132.6,-15567.59 132.6,-15608.59"/>
<text text-anchor="middle" x="88.6" y="-15596.59" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="88.6" y="-15585.59" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="88.6" y="-15574.59" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attention&#45;&gt;layer_3_attn_out_gpu1 -->
<g id="edge52" class="edge">
<title>layer_3_attention&#45;&gt;layer_3_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M87.91,-15644.56C88.01,-15636.44 88.13,-15627.36 88.23,-15618.94"/>
<polygon fill="black" stroke="black" points="91.73,-15618.77 88.36,-15608.73 84.73,-15618.69 91.73,-15618.77"/>
</g>
<!-- layer_3_attn_out_gpu1&#45;&gt;layer_3_residual1 -->
<g id="edge53" class="edge">
<title>layer_3_attn_out_gpu1&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M96.95,-15567.49C100.31,-15559.6 104.31,-15550.22 108.21,-15541.07"/>
<polygon fill="black" stroke="black" points="111.5,-15542.27 112.2,-15531.7 105.06,-15539.52 111.5,-15542.27"/>
</g>
<!-- layer_3_ln1 -->
<g id="node50" class="node">
<title>layer_3_ln1</title>
<polygon fill="lightblue" stroke="black" points="129.1,-15435.59 56.1,-15435.59 56.1,-15394.59 129.1,-15394.59 129.1,-15435.59"/>
<text text-anchor="middle" x="92.6" y="-15423.59" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="92.6" y="-15412.59" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="92.6" y="-15401.59" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_3_residual1&#45;&gt;layer_3_ln1 -->
<g id="edge55" class="edge">
<title>layer_3_residual1&#45;&gt;layer_3_ln1</title>
<path fill="none" stroke="black" d="M113.59,-15471.51C110.37,-15463 106.84,-15453.69 103.62,-15445.18"/>
<polygon fill="black" stroke="black" points="106.83,-15443.76 100.01,-15435.65 100.28,-15446.24 106.83,-15443.76"/>
</g>
<!-- layer_3_residual2 -->
<g id="node54" class="node">
<title>layer_3_residual2</title>
<polygon fill="lightyellow" stroke="black" points="201.54,-15132.59 79.15,-15132.59 47.66,-15072.59 170.06,-15072.59 201.54,-15132.59"/>
<text text-anchor="middle" x="124.6" y="-15105.59" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="124.6" y="-15094.59" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_3_residual1&#45;&gt;layer_3_residual2 -->
<g id="edge60" class="edge">
<title>layer_3_residual1&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M135.8,-15471.31C147.01,-15439.32 162.6,-15386.32 162.6,-15339.09 162.6,-15339.09 162.6,-15339.09 162.6,-15262.59 162.6,-15220.71 149.98,-15174.3 139.29,-15142.48"/>
<polygon fill="black" stroke="black" points="142.48,-15140.99 135.9,-15132.69 135.86,-15143.28 142.48,-15140.99"/>
</g>
<!-- layer_3_mlp_fc1_gpu1 -->
<g id="node51" class="node">
<title>layer_3_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="134.6,-15358.59 40.6,-15358.59 40.6,-15317.59 134.6,-15317.59 134.6,-15358.59"/>
<text text-anchor="middle" x="87.6" y="-15346.59" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="87.6" y="-15335.59" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="87.6" y="-15324.59" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu1 -->
<g id="edge56" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M91.29,-15394.38C90.77,-15386.54 90.15,-15377.36 89.58,-15368.75"/>
<polygon fill="black" stroke="black" points="93.06,-15368.4 88.91,-15358.66 86.08,-15368.87 93.06,-15368.4"/>
</g>
<!-- layer_3_gelu -->
<g id="node52" class="node">
<title>layer_3_gelu</title>
<polygon fill="lightblue" stroke="black" points="132.1,-15281.59 43.1,-15281.59 43.1,-15245.59 132.1,-15245.59 132.1,-15281.59"/>
<text text-anchor="middle" x="87.6" y="-15266.59" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="87.6" y="-15255.59" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_3_mlp_fc1_gpu1&#45;&gt;layer_3_gelu -->
<g id="edge57" class="edge">
<title>layer_3_mlp_fc1_gpu1&#45;&gt;layer_3_gelu</title>
<path fill="none" stroke="black" d="M87.6,-15317.28C87.6,-15309.49 87.6,-15300.43 87.6,-15292.03"/>
<polygon fill="black" stroke="black" points="91.1,-15291.91 87.6,-15281.91 84.1,-15291.91 91.1,-15291.91"/>
</g>
<!-- layer_3_mlp_fc2_gpu1 -->
<g id="node53" class="node">
<title>layer_3_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="134.6,-15209.59 40.6,-15209.59 40.6,-15168.59 134.6,-15168.59 134.6,-15209.59"/>
<text text-anchor="middle" x="87.6" y="-15197.59" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="87.6" y="-15186.59" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="87.6" y="-15175.59" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu1 -->
<g id="edge58" class="edge">
<title>layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu1</title>
<path fill="none" stroke="black" d="M87.6,-15245.4C87.6,-15237.78 87.6,-15228.59 87.6,-15219.91"/>
<polygon fill="black" stroke="black" points="91.1,-15219.71 87.6,-15209.71 84.1,-15219.71 91.1,-15219.71"/>
</g>
<!-- layer_3_mlp_fc2_gpu1&#45;&gt;layer_3_residual2 -->
<g id="edge59" class="edge">
<title>layer_3_mlp_fc2_gpu1&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M96.18,-15168.49C99.64,-15160.6 103.75,-15151.22 107.75,-15142.07"/>
<polygon fill="black" stroke="black" points="111.05,-15143.26 111.86,-15132.7 104.64,-15140.45 111.05,-15143.26"/>
</g>
<!-- layer_3_ln2 -->
<g id="node55" class="node">
<title>layer_3_ln2</title>
<polygon fill="lightblue" stroke="black" points="161.1,-15036.59 88.1,-15036.59 88.1,-14995.59 161.1,-14995.59 161.1,-15036.59"/>
<text text-anchor="middle" x="124.6" y="-15024.59" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="124.6" y="-15013.59" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="124.6" y="-15002.59" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_3_residual2&#45;&gt;layer_3_ln2 -->
<g id="edge61" class="edge">
<title>layer_3_residual2&#45;&gt;layer_3_ln2</title>
<path fill="none" stroke="black" d="M124.6,-15072.51C124.6,-15064.18 124.6,-15055.1 124.6,-15046.74"/>
<polygon fill="black" stroke="black" points="128.1,-15046.65 124.6,-15036.65 121.1,-15046.65 128.1,-15046.65"/>
</g>
<!-- layer_3_output_dist -->
<g id="node56" class="node">
<title>layer_3_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="226.31,-14959.59 64.52,-14959.59 22.9,-14877.59 184.69,-14877.59 226.31,-14959.59"/>
<text text-anchor="middle" x="124.6" y="-14927.09" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="124.6" y="-14916.09" font-family="Arial" font-size="10.00">Output Distribution</text>
<text text-anchor="middle" x="124.6" y="-14905.09" font-family="Arial" font-size="10.00">GPU 1→2</text>
</g>
<!-- layer_3_ln2&#45;&gt;layer_3_output_dist -->
<g id="edge62" class="edge">
<title>layer_3_ln2&#45;&gt;layer_3_output_dist</title>
<path fill="none" stroke="black" d="M124.6,-14995.3C124.6,-14987.84 124.6,-14978.97 124.6,-14969.97"/>
<polygon fill="black" stroke="black" points="128.1,-14969.83 124.6,-14959.83 121.1,-14969.83 128.1,-14969.83"/>
</g>
<!-- layer_3_pipeline_send -->
<g id="node57" class="node">
<title>layer_3_pipeline_send</title>
<ellipse fill="red" stroke="black" cx="124.6" cy="-14812.59" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="124.6" y="-14821.09" font-family="Arial" font-size="10.00">Layer 3→4</text>
<text text-anchor="middle" x="124.6" y="-14810.09" font-family="Arial" font-size="10.00">Pipeline Send</text>
<text text-anchor="middle" x="124.6" y="-14799.09" font-family="Arial" font-size="10.00">GPU 1→2</text>
</g>
<!-- layer_3_output_dist&#45;&gt;layer_3_pipeline_send -->
<g id="edge63" class="edge">
<title>layer_3_output_dist&#45;&gt;layer_3_pipeline_send</title>
<path fill="none" stroke="black" d="M124.6,-14877.38C124.6,-14869.02 124.6,-14860.23 124.6,-14851.94"/>
<polygon fill="black" stroke="black" points="128.1,-14851.78 124.6,-14841.78 121.1,-14851.78 128.1,-14851.78"/>
</g>
<!-- layer_4_pipeline_recv -->
<g id="node58" class="node">
<title>layer_4_pipeline_recv</title>
<ellipse fill="red" stroke="black" cx="124.6" cy="-14718.61" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="124.6" y="-14727.11" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="124.6" y="-14716.11" font-family="Arial" font-size="10.00">Pipeline Recv</text>
<text text-anchor="middle" x="124.6" y="-14705.11" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_3_pipeline_send&#45;&gt;layer_4_pipeline_recv -->
<g id="edge64" class="edge">
<title>layer_3_pipeline_send&#45;&gt;layer_4_pipeline_recv</title>
<path fill="none" stroke="black" d="M124.6,-14783.5C124.6,-14775.46 124.6,-14766.56 124.6,-14758.01"/>
<polygon fill="black" stroke="black" points="128.1,-14757.85 124.6,-14747.85 121.1,-14757.85 128.1,-14757.85"/>
</g>
<!-- layer_4_input_dist -->
<g id="node59" class="node">
<title>layer_4_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="218.79,-14653.62 68.96,-14653.62 30.41,-14571.62 180.25,-14571.62 218.79,-14653.62"/>
<text text-anchor="middle" x="124.6" y="-14621.12" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="124.6" y="-14610.12" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="124.6" y="-14599.12" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_4_pipeline_recv&#45;&gt;layer_4_input_dist -->
<g id="edge65" class="edge">
<title>layer_4_pipeline_recv&#45;&gt;layer_4_input_dist</title>
<path fill="none" stroke="black" d="M124.6,-14689.47C124.6,-14681.6 124.6,-14672.8 124.6,-14664.06"/>
<polygon fill="black" stroke="black" points="128.1,-14663.89 124.6,-14653.89 121.1,-14663.89 128.1,-14663.89"/>
</g>
<!-- layer_4_qkv_gpu2 -->
<g id="node60" class="node">
<title>layer_4_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="134.1,-14535.62 41.1,-14535.62 41.1,-14494.62 134.1,-14494.62 134.1,-14535.62"/>
<text text-anchor="middle" x="87.6" y="-14523.62" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="87.6" y="-14512.62" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="87.6" y="-14501.62" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu2 -->
<g id="edge66" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu2</title>
<path fill="none" stroke="black" d="M109.02,-14571.4C105.62,-14562.63 102.09,-14553.51 98.89,-14545.27"/>
<polygon fill="black" stroke="black" points="102.08,-14543.79 95.2,-14535.73 95.55,-14546.32 102.08,-14543.79"/>
</g>
<!-- layer_4_residual1 -->
<g id="node63" class="node">
<title>layer_4_residual1</title>
<polygon fill="lightyellow" stroke="black" points="202.54,-14293.62 80.15,-14293.62 48.66,-14233.62 171.06,-14233.62 202.54,-14293.62"/>
<text text-anchor="middle" x="125.6" y="-14266.62" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="125.6" y="-14255.62" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_residual1 -->
<g id="edge70" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_residual1</title>
<path fill="none" stroke="black" d="M135.99,-14571.31C138.72,-14559.87 141.23,-14547.34 142.6,-14535.62 153.22,-14444.68 154.28,-14420.43 142.6,-14329.62 141.5,-14321.06 139.61,-14312.01 137.49,-14303.47"/>
<polygon fill="black" stroke="black" points="140.86,-14302.52 134.92,-14293.75 134.09,-14304.31 140.86,-14302.52"/>
</g>
<!-- layer_4_attention -->
<g id="node61" class="node">
<title>layer_4_attention</title>
<polygon fill="lightblue" stroke="black" points="122.6,-14458.62 54.6,-14458.62 54.6,-14406.62 122.6,-14406.62 122.6,-14458.62"/>
<text text-anchor="middle" x="88.6" y="-14446.62" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="88.6" y="-14435.62" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="88.6" y="-14424.62" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="88.6" y="-14413.62" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_4_qkv_gpu2&#45;&gt;layer_4_attention -->
<g id="edge67" class="edge">
<title>layer_4_qkv_gpu2&#45;&gt;layer_4_attention</title>
<path fill="none" stroke="black" d="M87.85,-14494.22C87.94,-14486.61 88.05,-14477.68 88.16,-14469.05"/>
<polygon fill="black" stroke="black" points="91.66,-14468.82 88.29,-14458.78 84.67,-14468.73 91.66,-14468.82"/>
</g>
<!-- layer_4_attn_out_gpu2 -->
<g id="node62" class="node">
<title>layer_4_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="133.6,-14370.62 45.6,-14370.62 45.6,-14329.62 133.6,-14329.62 133.6,-14370.62"/>
<text text-anchor="middle" x="89.6" y="-14358.62" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="89.6" y="-14347.62" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="89.6" y="-14336.62" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attention&#45;&gt;layer_4_attn_out_gpu2 -->
<g id="edge68" class="edge">
<title>layer_4_attention&#45;&gt;layer_4_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M88.91,-14406.59C89.01,-14398.48 89.13,-14389.4 89.23,-14380.97"/>
<polygon fill="black" stroke="black" points="92.73,-14380.81 89.36,-14370.77 85.73,-14380.72 92.73,-14380.81"/>
</g>
<!-- layer_4_attn_out_gpu2&#45;&gt;layer_4_residual1 -->
<g id="edge69" class="edge">
<title>layer_4_attn_out_gpu2&#45;&gt;layer_4_residual1</title>
<path fill="none" stroke="black" d="M97.95,-14329.52C101.31,-14321.63 105.31,-14312.25 109.21,-14303.1"/>
<polygon fill="black" stroke="black" points="112.5,-14304.3 113.2,-14293.73 106.06,-14301.56 112.5,-14304.3"/>
</g>
<!-- layer_4_ln1 -->
<g id="node64" class="node">
<title>layer_4_ln1</title>
<polygon fill="lightblue" stroke="black" points="125.1,-14197.62 52.1,-14197.62 52.1,-14156.62 125.1,-14156.62 125.1,-14197.62"/>
<text text-anchor="middle" x="88.6" y="-14185.62" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="88.6" y="-14174.62" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="88.6" y="-14163.62" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_4_residual1&#45;&gt;layer_4_ln1 -->
<g id="edge71" class="edge">
<title>layer_4_residual1&#45;&gt;layer_4_ln1</title>
<path fill="none" stroke="black" d="M112.87,-14233.54C109.1,-14224.94 104.98,-14215.53 101.22,-14206.94"/>
<polygon fill="black" stroke="black" points="104.39,-14205.44 97.17,-14197.69 97.97,-14208.25 104.39,-14205.44"/>
</g>
<!-- layer_4_residual2 -->
<g id="node68" class="node">
<title>layer_4_residual2</title>
<polygon fill="lightyellow" stroke="black" points="197.54,-13894.62 75.15,-13894.62 43.66,-13834.62 166.06,-13834.62 197.54,-13894.62"/>
<text text-anchor="middle" x="120.6" y="-13867.62" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="120.6" y="-13856.62" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_4_residual1&#45;&gt;layer_4_residual2 -->
<g id="edge76" class="edge">
<title>layer_4_residual1&#45;&gt;layer_4_residual2</title>
<path fill="none" stroke="black" d="M135.24,-14233.52C144.98,-14201.46 158.6,-14148.2 158.6,-14101.12 158.6,-14101.12 158.6,-14101.12 158.6,-14024.62 158.6,-13982.75 145.98,-13936.33 135.29,-13904.51"/>
<polygon fill="black" stroke="black" points="138.48,-13903.03 131.9,-13894.72 131.86,-13905.31 138.48,-13903.03"/>
</g>
<!-- layer_4_mlp_fc1_gpu2 -->
<g id="node65" class="node">
<title>layer_4_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="130.6,-14120.62 36.6,-14120.62 36.6,-14079.62 130.6,-14079.62 130.6,-14120.62"/>
<text text-anchor="middle" x="83.6" y="-14108.62" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="83.6" y="-14097.62" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="83.6" y="-14086.62" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu2 -->
<g id="edge72" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M87.29,-14156.42C86.77,-14148.58 86.15,-14139.39 85.58,-14130.78"/>
<polygon fill="black" stroke="black" points="89.06,-14130.44 84.91,-14120.69 82.08,-14130.91 89.06,-14130.44"/>
</g>
<!-- layer_4_gelu -->
<g id="node66" class="node">
<title>layer_4_gelu</title>
<polygon fill="lightblue" stroke="black" points="128.1,-14043.62 39.1,-14043.62 39.1,-14007.62 128.1,-14007.62 128.1,-14043.62"/>
<text text-anchor="middle" x="83.6" y="-14028.62" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="83.6" y="-14017.62" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_4_mlp_fc1_gpu2&#45;&gt;layer_4_gelu -->
<g id="edge73" class="edge">
<title>layer_4_mlp_fc1_gpu2&#45;&gt;layer_4_gelu</title>
<path fill="none" stroke="black" d="M83.6,-14079.31C83.6,-14071.53 83.6,-14062.46 83.6,-14054.07"/>
<polygon fill="black" stroke="black" points="87.1,-14053.94 83.6,-14043.94 80.1,-14053.94 87.1,-14053.94"/>
</g>
<!-- layer_4_mlp_fc2_gpu2 -->
<g id="node67" class="node">
<title>layer_4_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="130.6,-13971.62 36.6,-13971.62 36.6,-13930.62 130.6,-13930.62 130.6,-13971.62"/>
<text text-anchor="middle" x="83.6" y="-13959.62" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="83.6" y="-13948.62" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="83.6" y="-13937.62" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu2 -->
<g id="edge74" class="edge">
<title>layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu2</title>
<path fill="none" stroke="black" d="M83.6,-14007.44C83.6,-13999.82 83.6,-13990.63 83.6,-13981.94"/>
<polygon fill="black" stroke="black" points="87.1,-13981.74 83.6,-13971.74 80.1,-13981.74 87.1,-13981.74"/>
</g>
<!-- layer_4_mlp_fc2_gpu2&#45;&gt;layer_4_residual2 -->
<g id="edge75" class="edge">
<title>layer_4_mlp_fc2_gpu2&#45;&gt;layer_4_residual2</title>
<path fill="none" stroke="black" d="M92.18,-13930.52C95.64,-13922.63 99.75,-13913.25 103.75,-13904.1"/>
<polygon fill="black" stroke="black" points="107.05,-13905.29 107.86,-13894.73 100.64,-13902.49 107.05,-13905.29"/>
</g>
<!-- layer_4_ln2 -->
<g id="node69" class="node">
<title>layer_4_ln2</title>
<polygon fill="lightblue" stroke="black" points="157.1,-13798.62 84.1,-13798.62 84.1,-13757.62 157.1,-13757.62 157.1,-13798.62"/>
<text text-anchor="middle" x="120.6" y="-13786.62" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="120.6" y="-13775.62" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="120.6" y="-13764.62" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_4_residual2&#45;&gt;layer_4_ln2 -->
<g id="edge77" class="edge">
<title>layer_4_residual2&#45;&gt;layer_4_ln2</title>
<path fill="none" stroke="black" d="M120.6,-13834.54C120.6,-13826.22 120.6,-13817.13 120.6,-13808.77"/>
<polygon fill="black" stroke="black" points="124.1,-13808.69 120.6,-13798.69 117.1,-13808.69 124.1,-13808.69"/>
</g>
<!-- layer_4_output_dist -->
<g id="node70" class="node">
<title>layer_4_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="222.31,-13721.62 60.52,-13721.62 18.9,-13639.62 180.69,-13639.62 222.31,-13721.62"/>
<text text-anchor="middle" x="120.6" y="-13689.12" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="120.6" y="-13678.12" font-family="Arial" font-size="10.00">Output Distribution</text>
<text text-anchor="middle" x="120.6" y="-13667.12" font-family="Arial" font-size="10.00">GPU 2→2</text>
</g>
<!-- layer_4_ln2&#45;&gt;layer_4_output_dist -->
<g id="edge78" class="edge">
<title>layer_4_ln2&#45;&gt;layer_4_output_dist</title>
<path fill="none" stroke="black" d="M120.6,-13757.33C120.6,-13749.87 120.6,-13741 120.6,-13732.01"/>
<polygon fill="black" stroke="black" points="124.1,-13731.87 120.6,-13721.87 117.1,-13731.87 124.1,-13731.87"/>
</g>
<!-- layer_4_pipeline_send -->
<g id="node71" class="node">
<title>layer_4_pipeline_send</title>
<ellipse fill="red" stroke="black" cx="120.6" cy="-13574.63" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="120.6" y="-13583.13" font-family="Arial" font-size="10.00">Layer 4→5</text>
<text text-anchor="middle" x="120.6" y="-13572.13" font-family="Arial" font-size="10.00">Pipeline Send</text>
<text text-anchor="middle" x="120.6" y="-13561.13" font-family="Arial" font-size="10.00">GPU 2→2</text>
</g>
<!-- layer_4_output_dist&#45;&gt;layer_4_pipeline_send -->
<g id="edge79" class="edge">
<title>layer_4_output_dist&#45;&gt;layer_4_pipeline_send</title>
<path fill="none" stroke="black" d="M120.6,-13639.41C120.6,-13631.06 120.6,-13622.27 120.6,-13613.98"/>
<polygon fill="black" stroke="black" points="124.1,-13613.81 120.6,-13603.81 117.1,-13613.81 124.1,-13613.81"/>
</g>
<!-- layer_5_pipeline_recv -->
<g id="node72" class="node">
<title>layer_5_pipeline_recv</title>
<ellipse fill="red" stroke="black" cx="120.6" cy="-13480.65" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="120.6" y="-13489.15" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="120.6" y="-13478.15" font-family="Arial" font-size="10.00">Pipeline Recv</text>
<text text-anchor="middle" x="120.6" y="-13467.15" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_4_pipeline_send&#45;&gt;layer_5_pipeline_recv -->
<g id="edge80" class="edge">
<title>layer_4_pipeline_send&#45;&gt;layer_5_pipeline_recv</title>
<path fill="none" stroke="black" d="M120.6,-13545.53C120.6,-13537.49 120.6,-13528.59 120.6,-13520.05"/>
<polygon fill="black" stroke="black" points="124.1,-13519.89 120.6,-13509.89 117.1,-13519.89 124.1,-13519.89"/>
</g>
<!-- layer_5_input_dist -->
<g id="node73" class="node">
<title>layer_5_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="214.79,-13415.66 64.96,-13415.66 26.41,-13333.66 176.25,-13333.66 214.79,-13415.66"/>
<text text-anchor="middle" x="120.6" y="-13383.16" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="120.6" y="-13372.16" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="120.6" y="-13361.16" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_5_pipeline_recv&#45;&gt;layer_5_input_dist -->
<g id="edge81" class="edge">
<title>layer_5_pipeline_recv&#45;&gt;layer_5_input_dist</title>
<path fill="none" stroke="black" d="M120.6,-13451.5C120.6,-13443.64 120.6,-13434.84 120.6,-13426.1"/>
<polygon fill="black" stroke="black" points="124.1,-13425.92 120.6,-13415.92 117.1,-13425.92 124.1,-13425.92"/>
</g>
<!-- layer_5_qkv_gpu2 -->
<g id="node74" class="node">
<title>layer_5_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="130.1,-13297.66 37.1,-13297.66 37.1,-13256.66 130.1,-13256.66 130.1,-13297.66"/>
<text text-anchor="middle" x="83.6" y="-13285.66" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="83.6" y="-13274.66" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="83.6" y="-13263.66" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu2 -->
<g id="edge82" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu2</title>
<path fill="none" stroke="black" d="M105.02,-13333.43C101.62,-13324.66 98.09,-13315.54 94.89,-13307.3"/>
<polygon fill="black" stroke="black" points="98.08,-13305.83 91.2,-13297.77 91.55,-13308.36 98.08,-13305.83"/>
</g>
<!-- layer_5_residual1 -->
<g id="node77" class="node">
<title>layer_5_residual1</title>
<polygon fill="lightyellow" stroke="black" points="198.54,-13055.66 76.15,-13055.66 44.66,-12995.66 167.06,-12995.66 198.54,-13055.66"/>
<text text-anchor="middle" x="121.6" y="-13028.66" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="121.6" y="-13017.66" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_residual1 -->
<g id="edge86" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_residual1</title>
<path fill="none" stroke="black" d="M131.99,-13333.34C134.72,-13321.9 137.23,-13309.37 138.6,-13297.66 149.22,-13206.72 150.28,-13182.46 138.6,-13091.66 137.5,-13083.09 135.61,-13074.04 133.49,-13065.51"/>
<polygon fill="black" stroke="black" points="136.86,-13064.56 130.92,-13055.79 130.09,-13066.35 136.86,-13064.56"/>
</g>
<!-- layer_5_attention -->
<g id="node75" class="node">
<title>layer_5_attention</title>
<polygon fill="lightblue" stroke="black" points="118.6,-13220.66 50.6,-13220.66 50.6,-13168.66 118.6,-13168.66 118.6,-13220.66"/>
<text text-anchor="middle" x="84.6" y="-13208.66" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="84.6" y="-13197.66" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="84.6" y="-13186.66" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="84.6" y="-13175.66" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_5_qkv_gpu2&#45;&gt;layer_5_attention -->
<g id="edge83" class="edge">
<title>layer_5_qkv_gpu2&#45;&gt;layer_5_attention</title>
<path fill="none" stroke="black" d="M83.85,-13256.26C83.94,-13248.64 84.05,-13239.71 84.16,-13231.08"/>
<polygon fill="black" stroke="black" points="87.66,-13230.85 84.29,-13220.81 80.67,-13230.77 87.66,-13230.85"/>
</g>
<!-- layer_5_attn_out_gpu2 -->
<g id="node76" class="node">
<title>layer_5_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="129.6,-13132.66 41.6,-13132.66 41.6,-13091.66 129.6,-13091.66 129.6,-13132.66"/>
<text text-anchor="middle" x="85.6" y="-13120.66" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="85.6" y="-13109.66" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="85.6" y="-13098.66" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attention&#45;&gt;layer_5_attn_out_gpu2 -->
<g id="edge84" class="edge">
<title>layer_5_attention&#45;&gt;layer_5_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M84.91,-13168.63C85.01,-13160.51 85.13,-13151.43 85.23,-13143"/>
<polygon fill="black" stroke="black" points="88.73,-13142.84 85.36,-13132.8 81.73,-13142.76 88.73,-13142.84"/>
</g>
<!-- layer_5_attn_out_gpu2&#45;&gt;layer_5_residual1 -->
<g id="edge85" class="edge">
<title>layer_5_attn_out_gpu2&#45;&gt;layer_5_residual1</title>
<path fill="none" stroke="black" d="M93.95,-13091.56C97.31,-13083.67 101.31,-13074.28 105.21,-13065.14"/>
<polygon fill="black" stroke="black" points="108.5,-13066.34 109.2,-13055.76 102.06,-13063.59 108.5,-13066.34"/>
</g>
<!-- layer_5_ln1 -->
<g id="node78" class="node">
<title>layer_5_ln1</title>
<polygon fill="lightblue" stroke="black" points="126.1,-12959.66 53.1,-12959.66 53.1,-12918.66 126.1,-12918.66 126.1,-12959.66"/>
<text text-anchor="middle" x="89.6" y="-12947.66" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="89.6" y="-12936.66" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="89.6" y="-12925.66" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_5_residual1&#45;&gt;layer_5_ln1 -->
<g id="edge87" class="edge">
<title>layer_5_residual1&#45;&gt;layer_5_ln1</title>
<path fill="none" stroke="black" d="M110.59,-12995.58C107.37,-12987.07 103.84,-12977.76 100.62,-12969.25"/>
<polygon fill="black" stroke="black" points="103.83,-12967.83 97.01,-12959.72 97.28,-12970.31 103.83,-12967.83"/>
</g>
<!-- layer_5_residual2 -->
<g id="node82" class="node">
<title>layer_5_residual2</title>
<polygon fill="lightyellow" stroke="black" points="198.54,-12656.66 76.15,-12656.66 44.66,-12596.66 167.06,-12596.66 198.54,-12656.66"/>
<text text-anchor="middle" x="121.6" y="-12629.66" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="121.6" y="-12618.66" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_5_residual1&#45;&gt;layer_5_residual2 -->
<g id="edge92" class="edge">
<title>layer_5_residual1&#45;&gt;layer_5_residual2</title>
<path fill="none" stroke="black" d="M132.8,-12995.38C144.01,-12963.39 159.6,-12910.39 159.6,-12863.16 159.6,-12863.16 159.6,-12863.16 159.6,-12786.66 159.6,-12744.78 146.98,-12698.37 136.29,-12666.55"/>
<polygon fill="black" stroke="black" points="139.48,-12665.06 132.9,-12656.75 132.86,-12667.35 139.48,-12665.06"/>
</g>
<!-- layer_5_mlp_fc1_gpu2 -->
<g id="node79" class="node">
<title>layer_5_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="131.6,-12882.66 37.6,-12882.66 37.6,-12841.66 131.6,-12841.66 131.6,-12882.66"/>
<text text-anchor="middle" x="84.6" y="-12870.66" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="84.6" y="-12859.66" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="84.6" y="-12848.66" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu2 -->
<g id="edge88" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M88.29,-12918.45C87.77,-12910.61 87.15,-12901.43 86.58,-12892.82"/>
<polygon fill="black" stroke="black" points="90.06,-12892.47 85.91,-12882.73 83.08,-12892.94 90.06,-12892.47"/>
</g>
<!-- layer_5_gelu -->
<g id="node80" class="node">
<title>layer_5_gelu</title>
<polygon fill="lightblue" stroke="black" points="129.1,-12805.66 40.1,-12805.66 40.1,-12769.66 129.1,-12769.66 129.1,-12805.66"/>
<text text-anchor="middle" x="84.6" y="-12790.66" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="84.6" y="-12779.66" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_5_mlp_fc1_gpu2&#45;&gt;layer_5_gelu -->
<g id="edge89" class="edge">
<title>layer_5_mlp_fc1_gpu2&#45;&gt;layer_5_gelu</title>
<path fill="none" stroke="black" d="M84.6,-12841.34C84.6,-12833.56 84.6,-12824.5 84.6,-12816.1"/>
<polygon fill="black" stroke="black" points="88.1,-12815.97 84.6,-12805.97 81.1,-12815.97 88.1,-12815.97"/>
</g>
<!-- layer_5_mlp_fc2_gpu2 -->
<g id="node81" class="node">
<title>layer_5_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="131.6,-12733.66 37.6,-12733.66 37.6,-12692.66 131.6,-12692.66 131.6,-12733.66"/>
<text text-anchor="middle" x="84.6" y="-12721.66" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="84.6" y="-12710.66" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="84.6" y="-12699.66" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu2 -->
<g id="edge90" class="edge">
<title>layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu2</title>
<path fill="none" stroke="black" d="M84.6,-12769.47C84.6,-12761.85 84.6,-12752.66 84.6,-12743.98"/>
<polygon fill="black" stroke="black" points="88.1,-12743.77 84.6,-12733.77 81.1,-12743.77 88.1,-12743.77"/>
</g>
<!-- layer_5_mlp_fc2_gpu2&#45;&gt;layer_5_residual2 -->
<g id="edge91" class="edge">
<title>layer_5_mlp_fc2_gpu2&#45;&gt;layer_5_residual2</title>
<path fill="none" stroke="black" d="M93.18,-12692.56C96.64,-12684.67 100.75,-12675.28 104.75,-12666.14"/>
<polygon fill="black" stroke="black" points="108.05,-12667.33 108.86,-12656.76 101.64,-12664.52 108.05,-12667.33"/>
</g>
<!-- layer_5_ln2 -->
<g id="node83" class="node">
<title>layer_5_ln2</title>
<polygon fill="lightblue" stroke="black" points="158.1,-12560.66 85.1,-12560.66 85.1,-12519.66 158.1,-12519.66 158.1,-12560.66"/>
<text text-anchor="middle" x="121.6" y="-12548.66" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="121.6" y="-12537.66" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="121.6" y="-12526.66" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_5_residual2&#45;&gt;layer_5_ln2 -->
<g id="edge93" class="edge">
<title>layer_5_residual2&#45;&gt;layer_5_ln2</title>
<path fill="none" stroke="black" d="M121.6,-12596.58C121.6,-12588.25 121.6,-12579.17 121.6,-12570.81"/>
<polygon fill="black" stroke="black" points="125.1,-12570.72 121.6,-12560.72 118.1,-12570.72 125.1,-12570.72"/>
</g>
<!-- layer_5_output_dist -->
<g id="node84" class="node">
<title>layer_5_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="223.31,-12483.66 61.52,-12483.66 19.9,-12401.66 181.69,-12401.66 223.31,-12483.66"/>
<text text-anchor="middle" x="121.6" y="-12451.16" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="121.6" y="-12440.16" font-family="Arial" font-size="10.00">Output Distribution</text>
<text text-anchor="middle" x="121.6" y="-12429.16" font-family="Arial" font-size="10.00">GPU 2→3</text>
</g>
<!-- layer_5_ln2&#45;&gt;layer_5_output_dist -->
<g id="edge94" class="edge">
<title>layer_5_ln2&#45;&gt;layer_5_output_dist</title>
<path fill="none" stroke="black" d="M121.6,-12519.37C121.6,-12511.9 121.6,-12503.04 121.6,-12494.04"/>
<polygon fill="black" stroke="black" points="125.1,-12493.9 121.6,-12483.9 118.1,-12493.9 125.1,-12493.9"/>
</g>
<!-- layer_5_pipeline_send -->
<g id="node85" class="node">
<title>layer_5_pipeline_send</title>
<ellipse fill="red" stroke="black" cx="121.6" cy="-12336.66" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="121.6" y="-12345.16" font-family="Arial" font-size="10.00">Layer 5→6</text>
<text text-anchor="middle" x="121.6" y="-12334.16" font-family="Arial" font-size="10.00">Pipeline Send</text>
<text text-anchor="middle" x="121.6" y="-12323.16" font-family="Arial" font-size="10.00">GPU 2→3</text>
</g>
<!-- layer_5_output_dist&#45;&gt;layer_5_pipeline_send -->
<g id="edge95" class="edge">
<title>layer_5_output_dist&#45;&gt;layer_5_pipeline_send</title>
<path fill="none" stroke="black" d="M121.6,-12401.45C121.6,-12393.09 121.6,-12384.3 121.6,-12376.01"/>
<polygon fill="black" stroke="black" points="125.1,-12375.85 121.6,-12365.85 118.1,-12375.85 125.1,-12375.85"/>
</g>
<!-- layer_6_pipeline_recv -->
<g id="node86" class="node">
<title>layer_6_pipeline_recv</title>
<ellipse fill="red" stroke="black" cx="121.6" cy="-12242.68" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="121.6" y="-12251.18" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="121.6" y="-12240.18" font-family="Arial" font-size="10.00">Pipeline Recv</text>
<text text-anchor="middle" x="121.6" y="-12229.18" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_5_pipeline_send&#45;&gt;layer_6_pipeline_recv -->
<g id="edge96" class="edge">
<title>layer_5_pipeline_send&#45;&gt;layer_6_pipeline_recv</title>
<path fill="none" stroke="black" d="M121.6,-12307.57C121.6,-12299.53 121.6,-12290.63 121.6,-12282.08"/>
<polygon fill="black" stroke="black" points="125.1,-12281.92 121.6,-12271.92 118.1,-12281.92 125.1,-12281.92"/>
</g>
<!-- layer_6_input_dist -->
<g id="node87" class="node">
<title>layer_6_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="215.79,-12177.69 65.96,-12177.69 27.41,-12095.69 177.25,-12095.69 215.79,-12177.69"/>
<text text-anchor="middle" x="121.6" y="-12145.19" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="121.6" y="-12134.19" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="121.6" y="-12123.19" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_6_pipeline_recv&#45;&gt;layer_6_input_dist -->
<g id="edge97" class="edge">
<title>layer_6_pipeline_recv&#45;&gt;layer_6_input_dist</title>
<path fill="none" stroke="black" d="M121.6,-12213.54C121.6,-12205.67 121.6,-12196.87 121.6,-12188.13"/>
<polygon fill="black" stroke="black" points="125.1,-12187.96 121.6,-12177.96 118.1,-12187.96 125.1,-12187.96"/>
</g>
<!-- layer_6_qkv_gpu3 -->
<g id="node88" class="node">
<title>layer_6_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="131.1,-12059.69 38.1,-12059.69 38.1,-12018.69 131.1,-12018.69 131.1,-12059.69"/>
<text text-anchor="middle" x="84.6" y="-12047.69" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="84.6" y="-12036.69" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="84.6" y="-12025.69" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu3 -->
<g id="edge98" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu3</title>
<path fill="none" stroke="black" d="M106.02,-12095.47C102.62,-12086.7 99.09,-12077.58 95.89,-12069.34"/>
<polygon fill="black" stroke="black" points="99.08,-12067.86 92.2,-12059.8 92.55,-12070.39 99.08,-12067.86"/>
</g>
<!-- layer_6_residual1 -->
<g id="node91" class="node">
<title>layer_6_residual1</title>
<polygon fill="lightyellow" stroke="black" points="199.54,-11817.69 77.15,-11817.69 45.66,-11757.69 168.06,-11757.69 199.54,-11817.69"/>
<text text-anchor="middle" x="122.6" y="-11790.69" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="122.6" y="-11779.69" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_residual1 -->
<g id="edge102" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_residual1</title>
<path fill="none" stroke="black" d="M132.99,-12095.38C135.72,-12083.94 138.23,-12071.41 139.6,-12059.69 150.22,-11968.75 151.28,-11944.5 139.6,-11853.69 138.5,-11845.12 136.61,-11836.08 134.49,-11827.54"/>
<polygon fill="black" stroke="black" points="137.86,-11826.59 131.92,-11817.82 131.09,-11828.38 137.86,-11826.59"/>
</g>
<!-- layer_6_attention -->
<g id="node89" class="node">
<title>layer_6_attention</title>
<polygon fill="lightblue" stroke="black" points="119.6,-11982.69 51.6,-11982.69 51.6,-11930.69 119.6,-11930.69 119.6,-11982.69"/>
<text text-anchor="middle" x="85.6" y="-11970.69" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="85.6" y="-11959.69" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="85.6" y="-11948.69" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="85.6" y="-11937.69" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_6_qkv_gpu3&#45;&gt;layer_6_attention -->
<g id="edge99" class="edge">
<title>layer_6_qkv_gpu3&#45;&gt;layer_6_attention</title>
<path fill="none" stroke="black" d="M84.85,-12018.29C84.94,-12010.68 85.05,-12001.75 85.16,-11993.12"/>
<polygon fill="black" stroke="black" points="88.66,-11992.89 85.29,-11982.84 81.67,-11992.8 88.66,-11992.89"/>
</g>
<!-- layer_6_attn_out_gpu3 -->
<g id="node90" class="node">
<title>layer_6_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="130.6,-11894.69 42.6,-11894.69 42.6,-11853.69 130.6,-11853.69 130.6,-11894.69"/>
<text text-anchor="middle" x="86.6" y="-11882.69" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="86.6" y="-11871.69" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="86.6" y="-11860.69" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attention&#45;&gt;layer_6_attn_out_gpu3 -->
<g id="edge100" class="edge">
<title>layer_6_attention&#45;&gt;layer_6_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M85.91,-11930.66C86.01,-11922.55 86.13,-11913.47 86.23,-11905.04"/>
<polygon fill="black" stroke="black" points="89.73,-11904.88 86.36,-11894.84 82.73,-11904.79 89.73,-11904.88"/>
</g>
<!-- layer_6_attn_out_gpu3&#45;&gt;layer_6_residual1 -->
<g id="edge101" class="edge">
<title>layer_6_attn_out_gpu3&#45;&gt;layer_6_residual1</title>
<path fill="none" stroke="black" d="M94.95,-11853.59C98.31,-11845.7 102.31,-11836.32 106.21,-11827.17"/>
<polygon fill="black" stroke="black" points="109.5,-11828.37 110.2,-11817.8 103.06,-11825.63 109.5,-11828.37"/>
</g>
<!-- layer_6_ln1 -->
<g id="node92" class="node">
<title>layer_6_ln1</title>
<polygon fill="lightblue" stroke="black" points="122.1,-11721.69 49.1,-11721.69 49.1,-11680.69 122.1,-11680.69 122.1,-11721.69"/>
<text text-anchor="middle" x="85.6" y="-11709.69" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="85.6" y="-11698.69" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="85.6" y="-11687.69" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_6_residual1&#45;&gt;layer_6_ln1 -->
<g id="edge103" class="edge">
<title>layer_6_residual1&#45;&gt;layer_6_ln1</title>
<path fill="none" stroke="black" d="M109.87,-11757.61C106.1,-11749.01 101.98,-11739.6 98.22,-11731.01"/>
<polygon fill="black" stroke="black" points="101.39,-11729.51 94.17,-11721.75 94.97,-11732.32 101.39,-11729.51"/>
</g>
<!-- layer_6_residual2 -->
<g id="node96" class="node">
<title>layer_6_residual2</title>
<polygon fill="lightyellow" stroke="black" points="194.54,-11418.69 72.15,-11418.69 40.66,-11358.69 163.06,-11358.69 194.54,-11418.69"/>
<text text-anchor="middle" x="117.6" y="-11391.69" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="117.6" y="-11380.69" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_6_residual1&#45;&gt;layer_6_residual2 -->
<g id="edge108" class="edge">
<title>layer_6_residual1&#45;&gt;layer_6_residual2</title>
<path fill="none" stroke="black" d="M132.24,-11757.58C141.98,-11725.53 155.6,-11672.27 155.6,-11625.19 155.6,-11625.19 155.6,-11625.19 155.6,-11548.69 155.6,-11506.82 142.98,-11460.4 132.29,-11428.58"/>
<polygon fill="black" stroke="black" points="135.48,-11427.1 128.9,-11418.79 128.86,-11429.38 135.48,-11427.1"/>
</g>
<!-- layer_6_mlp_fc1_gpu3 -->
<g id="node93" class="node">
<title>layer_6_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="127.6,-11644.69 33.6,-11644.69 33.6,-11603.69 127.6,-11603.69 127.6,-11644.69"/>
<text text-anchor="middle" x="80.6" y="-11632.69" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="80.6" y="-11621.69" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="80.6" y="-11610.69" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu3 -->
<g id="edge104" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M84.29,-11680.48C83.77,-11672.65 83.15,-11663.46 82.58,-11654.85"/>
<polygon fill="black" stroke="black" points="86.06,-11654.51 81.91,-11644.76 79.08,-11654.97 86.06,-11654.51"/>
</g>
<!-- layer_6_gelu -->
<g id="node94" class="node">
<title>layer_6_gelu</title>
<polygon fill="lightblue" stroke="black" points="125.1,-11567.69 36.1,-11567.69 36.1,-11531.69 125.1,-11531.69 125.1,-11567.69"/>
<text text-anchor="middle" x="80.6" y="-11552.69" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="80.6" y="-11541.69" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_6_mlp_fc1_gpu3&#45;&gt;layer_6_gelu -->
<g id="edge105" class="edge">
<title>layer_6_mlp_fc1_gpu3&#45;&gt;layer_6_gelu</title>
<path fill="none" stroke="black" d="M80.6,-11603.38C80.6,-11595.6 80.6,-11586.53 80.6,-11578.14"/>
<polygon fill="black" stroke="black" points="84.1,-11578.01 80.6,-11568.01 77.1,-11578.01 84.1,-11578.01"/>
</g>
<!-- layer_6_mlp_fc2_gpu3 -->
<g id="node95" class="node">
<title>layer_6_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="127.6,-11495.69 33.6,-11495.69 33.6,-11454.69 127.6,-11454.69 127.6,-11495.69"/>
<text text-anchor="middle" x="80.6" y="-11483.69" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="80.6" y="-11472.69" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="80.6" y="-11461.69" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu3 -->
<g id="edge106" class="edge">
<title>layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu3</title>
<path fill="none" stroke="black" d="M80.6,-11531.51C80.6,-11523.89 80.6,-11514.69 80.6,-11506.01"/>
<polygon fill="black" stroke="black" points="84.1,-11505.81 80.6,-11495.81 77.1,-11505.81 84.1,-11505.81"/>
</g>
<!-- layer_6_mlp_fc2_gpu3&#45;&gt;layer_6_residual2 -->
<g id="edge107" class="edge">
<title>layer_6_mlp_fc2_gpu3&#45;&gt;layer_6_residual2</title>
<path fill="none" stroke="black" d="M89.18,-11454.59C92.64,-11446.7 96.75,-11437.32 100.75,-11428.17"/>
<polygon fill="black" stroke="black" points="104.05,-11429.36 104.86,-11418.8 97.64,-11426.56 104.05,-11429.36"/>
</g>
<!-- layer_6_ln2 -->
<g id="node97" class="node">
<title>layer_6_ln2</title>
<polygon fill="lightblue" stroke="black" points="154.1,-11322.69 81.1,-11322.69 81.1,-11281.69 154.1,-11281.69 154.1,-11322.69"/>
<text text-anchor="middle" x="117.6" y="-11310.69" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="117.6" y="-11299.69" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="117.6" y="-11288.69" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_6_residual2&#45;&gt;layer_6_ln2 -->
<g id="edge109" class="edge">
<title>layer_6_residual2&#45;&gt;layer_6_ln2</title>
<path fill="none" stroke="black" d="M117.6,-11358.61C117.6,-11350.28 117.6,-11341.2 117.6,-11332.84"/>
<polygon fill="black" stroke="black" points="121.1,-11332.75 117.6,-11322.75 114.1,-11332.75 121.1,-11332.75"/>
</g>
<!-- layer_6_output_dist -->
<g id="node98" class="node">
<title>layer_6_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="219.31,-11245.69 57.52,-11245.69 15.9,-11163.69 177.69,-11163.69 219.31,-11245.69"/>
<text text-anchor="middle" x="117.6" y="-11213.19" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="117.6" y="-11202.19" font-family="Arial" font-size="10.00">Output Distribution</text>
<text text-anchor="middle" x="117.6" y="-11191.19" font-family="Arial" font-size="10.00">GPU 3→3</text>
</g>
<!-- layer_6_ln2&#45;&gt;layer_6_output_dist -->
<g id="edge110" class="edge">
<title>layer_6_ln2&#45;&gt;layer_6_output_dist</title>
<path fill="none" stroke="black" d="M117.6,-11281.4C117.6,-11273.94 117.6,-11265.07 117.6,-11256.08"/>
<polygon fill="black" stroke="black" points="121.1,-11255.94 117.6,-11245.94 114.1,-11255.94 121.1,-11255.94"/>
</g>
<!-- layer_6_pipeline_send -->
<g id="node99" class="node">
<title>layer_6_pipeline_send</title>
<ellipse fill="red" stroke="black" cx="117.6" cy="-11098.7" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="117.6" y="-11107.2" font-family="Arial" font-size="10.00">Layer 6→7</text>
<text text-anchor="middle" x="117.6" y="-11096.2" font-family="Arial" font-size="10.00">Pipeline Send</text>
<text text-anchor="middle" x="117.6" y="-11085.2" font-family="Arial" font-size="10.00">GPU 3→3</text>
</g>
<!-- layer_6_output_dist&#45;&gt;layer_6_pipeline_send -->
<g id="edge111" class="edge">
<title>layer_6_output_dist&#45;&gt;layer_6_pipeline_send</title>
<path fill="none" stroke="black" d="M117.6,-11163.48C117.6,-11155.12 117.6,-11146.34 117.6,-11138.05"/>
<polygon fill="black" stroke="black" points="121.1,-11137.88 117.6,-11127.88 114.1,-11137.88 121.1,-11137.88"/>
</g>
<!-- layer_7_pipeline_recv -->
<g id="node100" class="node">
<title>layer_7_pipeline_recv</title>
<ellipse fill="red" stroke="black" cx="117.6" cy="-11004.72" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="117.6" y="-11013.22" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="117.6" y="-11002.22" font-family="Arial" font-size="10.00">Pipeline Recv</text>
<text text-anchor="middle" x="117.6" y="-10991.22" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_6_pipeline_send&#45;&gt;layer_7_pipeline_recv -->
<g id="edge112" class="edge">
<title>layer_6_pipeline_send&#45;&gt;layer_7_pipeline_recv</title>
<path fill="none" stroke="black" d="M117.6,-11069.6C117.6,-11061.56 117.6,-11052.66 117.6,-11044.12"/>
<polygon fill="black" stroke="black" points="121.1,-11043.96 117.6,-11033.96 114.1,-11043.96 121.1,-11043.96"/>
</g>
<!-- layer_7_input_dist -->
<g id="node101" class="node">
<title>layer_7_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="211.79,-10939.72 61.96,-10939.72 23.41,-10857.72 173.25,-10857.72 211.79,-10939.72"/>
<text text-anchor="middle" x="117.6" y="-10907.22" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="117.6" y="-10896.22" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="117.6" y="-10885.22" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_7_pipeline_recv&#45;&gt;layer_7_input_dist -->
<g id="edge113" class="edge">
<title>layer_7_pipeline_recv&#45;&gt;layer_7_input_dist</title>
<path fill="none" stroke="black" d="M117.6,-10975.57C117.6,-10967.71 117.6,-10958.91 117.6,-10950.17"/>
<polygon fill="black" stroke="black" points="121.1,-10949.99 117.6,-10939.99 114.1,-10949.99 121.1,-10949.99"/>
</g>
<!-- layer_7_qkv_gpu3 -->
<g id="node102" class="node">
<title>layer_7_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="127.1,-10821.72 34.1,-10821.72 34.1,-10780.72 127.1,-10780.72 127.1,-10821.72"/>
<text text-anchor="middle" x="80.6" y="-10809.72" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="80.6" y="-10798.72" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="80.6" y="-10787.72" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu3 -->
<g id="edge114" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu3</title>
<path fill="none" stroke="black" d="M102.02,-10857.5C98.62,-10848.73 95.09,-10839.61 91.89,-10831.37"/>
<polygon fill="black" stroke="black" points="95.08,-10829.9 88.2,-10821.84 88.55,-10832.42 95.08,-10829.9"/>
</g>
<!-- layer_7_residual1 -->
<g id="node105" class="node">
<title>layer_7_residual1</title>
<polygon fill="lightyellow" stroke="black" points="195.54,-10579.72 73.15,-10579.72 41.66,-10519.72 164.06,-10519.72 195.54,-10579.72"/>
<text text-anchor="middle" x="118.6" y="-10552.72" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="118.6" y="-10541.72" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_residual1 -->
<g id="edge118" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_residual1</title>
<path fill="none" stroke="black" d="M128.99,-10857.41C131.72,-10845.97 134.23,-10833.44 135.6,-10821.72 146.22,-10730.79 147.28,-10706.53 135.6,-10615.72 134.5,-10607.16 132.61,-10598.11 130.49,-10589.58"/>
<polygon fill="black" stroke="black" points="133.86,-10588.63 127.92,-10579.86 127.09,-10590.42 133.86,-10588.63"/>
</g>
<!-- layer_7_attention -->
<g id="node103" class="node">
<title>layer_7_attention</title>
<polygon fill="lightblue" stroke="black" points="115.6,-10744.72 47.6,-10744.72 47.6,-10692.72 115.6,-10692.72 115.6,-10744.72"/>
<text text-anchor="middle" x="81.6" y="-10732.72" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="81.6" y="-10721.72" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="81.6" y="-10710.72" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="81.6" y="-10699.72" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_7_qkv_gpu3&#45;&gt;layer_7_attention -->
<g id="edge115" class="edge">
<title>layer_7_qkv_gpu3&#45;&gt;layer_7_attention</title>
<path fill="none" stroke="black" d="M80.85,-10780.33C80.94,-10772.71 81.05,-10763.78 81.16,-10755.15"/>
<polygon fill="black" stroke="black" points="84.66,-10754.92 81.29,-10744.88 77.67,-10754.83 84.66,-10754.92"/>
</g>
<!-- layer_7_attn_out_gpu3 -->
<g id="node104" class="node">
<title>layer_7_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="126.6,-10656.72 38.6,-10656.72 38.6,-10615.72 126.6,-10615.72 126.6,-10656.72"/>
<text text-anchor="middle" x="82.6" y="-10644.72" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="82.6" y="-10633.72" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="82.6" y="-10622.72" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attention&#45;&gt;layer_7_attn_out_gpu3 -->
<g id="edge116" class="edge">
<title>layer_7_attention&#45;&gt;layer_7_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M81.91,-10692.69C82.01,-10684.58 82.13,-10675.5 82.23,-10667.07"/>
<polygon fill="black" stroke="black" points="85.73,-10666.91 82.36,-10656.87 78.73,-10666.83 85.73,-10666.91"/>
</g>
<!-- layer_7_attn_out_gpu3&#45;&gt;layer_7_residual1 -->
<g id="edge117" class="edge">
<title>layer_7_attn_out_gpu3&#45;&gt;layer_7_residual1</title>
<path fill="none" stroke="black" d="M90.95,-10615.63C94.31,-10607.74 98.31,-10598.35 102.21,-10589.21"/>
<polygon fill="black" stroke="black" points="105.5,-10590.41 106.2,-10579.83 99.06,-10587.66 105.5,-10590.41"/>
</g>
<!-- layer_7_ln1 -->
<g id="node106" class="node">
<title>layer_7_ln1</title>
<polygon fill="lightblue" stroke="black" points="123.1,-10483.72 50.1,-10483.72 50.1,-10442.72 123.1,-10442.72 123.1,-10483.72"/>
<text text-anchor="middle" x="86.6" y="-10471.72" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="86.6" y="-10460.72" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="86.6" y="-10449.72" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_7_residual1&#45;&gt;layer_7_ln1 -->
<g id="edge119" class="edge">
<title>layer_7_residual1&#45;&gt;layer_7_ln1</title>
<path fill="none" stroke="black" d="M107.59,-10519.64C104.37,-10511.13 100.84,-10501.83 97.62,-10493.32"/>
<polygon fill="black" stroke="black" points="100.83,-10491.9 94.01,-10483.79 94.28,-10494.38 100.83,-10491.9"/>
</g>
<!-- layer_7_residual2 -->
<g id="node110" class="node">
<title>layer_7_residual2</title>
<polygon fill="lightyellow" stroke="black" points="195.54,-10180.72 73.15,-10180.72 41.66,-10120.72 164.06,-10120.72 195.54,-10180.72"/>
<text text-anchor="middle" x="118.6" y="-10153.72" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="118.6" y="-10142.72" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_7_residual1&#45;&gt;layer_7_residual2 -->
<g id="edge124" class="edge">
<title>layer_7_residual1&#45;&gt;layer_7_residual2</title>
<path fill="none" stroke="black" d="M129.8,-10519.44C141.01,-10487.46 156.6,-10434.46 156.6,-10387.22 156.6,-10387.22 156.6,-10387.22 156.6,-10310.72 156.6,-10268.85 143.98,-10222.43 133.29,-10190.62"/>
<polygon fill="black" stroke="black" points="136.48,-10189.13 129.9,-10180.82 129.86,-10191.42 136.48,-10189.13"/>
</g>
<!-- layer_7_mlp_fc1_gpu3 -->
<g id="node107" class="node">
<title>layer_7_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="128.6,-10406.72 34.6,-10406.72 34.6,-10365.72 128.6,-10365.72 128.6,-10406.72"/>
<text text-anchor="middle" x="81.6" y="-10394.72" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="81.6" y="-10383.72" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="81.6" y="-10372.72" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu3 -->
<g id="edge120" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M85.29,-10442.52C84.77,-10434.68 84.15,-10425.49 83.58,-10416.88"/>
<polygon fill="black" stroke="black" points="87.06,-10416.54 82.91,-10406.8 80.08,-10417.01 87.06,-10416.54"/>
</g>
<!-- layer_7_gelu -->
<g id="node108" class="node">
<title>layer_7_gelu</title>
<polygon fill="lightblue" stroke="black" points="126.1,-10329.72 37.1,-10329.72 37.1,-10293.72 126.1,-10293.72 126.1,-10329.72"/>
<text text-anchor="middle" x="81.6" y="-10314.72" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="81.6" y="-10303.72" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_7_mlp_fc1_gpu3&#45;&gt;layer_7_gelu -->
<g id="edge121" class="edge">
<title>layer_7_mlp_fc1_gpu3&#45;&gt;layer_7_gelu</title>
<path fill="none" stroke="black" d="M81.6,-10365.41C81.6,-10357.63 81.6,-10348.57 81.6,-10340.17"/>
<polygon fill="black" stroke="black" points="85.1,-10340.04 81.6,-10330.04 78.1,-10340.04 85.1,-10340.04"/>
</g>
<!-- layer_7_mlp_fc2_gpu3 -->
<g id="node109" class="node">
<title>layer_7_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="128.6,-10257.72 34.6,-10257.72 34.6,-10216.72 128.6,-10216.72 128.6,-10257.72"/>
<text text-anchor="middle" x="81.6" y="-10245.72" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="81.6" y="-10234.72" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="81.6" y="-10223.72" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu3 -->
<g id="edge122" class="edge">
<title>layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu3</title>
<path fill="none" stroke="black" d="M81.6,-10293.54C81.6,-10285.92 81.6,-10276.73 81.6,-10268.04"/>
<polygon fill="black" stroke="black" points="85.1,-10267.84 81.6,-10257.84 78.1,-10267.84 85.1,-10267.84"/>
</g>
<!-- layer_7_mlp_fc2_gpu3&#45;&gt;layer_7_residual2 -->
<g id="edge123" class="edge">
<title>layer_7_mlp_fc2_gpu3&#45;&gt;layer_7_residual2</title>
<path fill="none" stroke="black" d="M90.18,-10216.63C93.64,-10208.74 97.75,-10199.35 101.75,-10190.21"/>
<polygon fill="black" stroke="black" points="105.05,-10191.4 105.86,-10180.83 98.64,-10188.59 105.05,-10191.4"/>
</g>
<!-- layer_7_ln2 -->
<g id="node111" class="node">
<title>layer_7_ln2</title>
<polygon fill="lightblue" stroke="black" points="155.1,-10084.72 82.1,-10084.72 82.1,-10043.72 155.1,-10043.72 155.1,-10084.72"/>
<text text-anchor="middle" x="118.6" y="-10072.72" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="118.6" y="-10061.72" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="118.6" y="-10050.72" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_7_residual2&#45;&gt;layer_7_ln2 -->
<g id="edge125" class="edge">
<title>layer_7_residual2&#45;&gt;layer_7_ln2</title>
<path fill="none" stroke="black" d="M118.6,-10120.64C118.6,-10112.32 118.6,-10103.24 118.6,-10094.88"/>
<polygon fill="black" stroke="black" points="122.1,-10094.79 118.6,-10084.79 115.1,-10094.79 122.1,-10094.79"/>
</g>
<!-- layer_7_output_dist -->
<g id="node112" class="node">
<title>layer_7_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="220.31,-10007.72 58.52,-10007.72 16.9,-9925.72 178.69,-9925.72 220.31,-10007.72"/>
<text text-anchor="middle" x="118.6" y="-9975.22" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="118.6" y="-9964.22" font-family="Arial" font-size="10.00">Output Distribution</text>
<text text-anchor="middle" x="118.6" y="-9953.22" font-family="Arial" font-size="10.00">GPU 3→4</text>
</g>
<!-- layer_7_ln2&#45;&gt;layer_7_output_dist -->
<g id="edge126" class="edge">
<title>layer_7_ln2&#45;&gt;layer_7_output_dist</title>
<path fill="none" stroke="black" d="M118.6,-10043.44C118.6,-10035.97 118.6,-10027.1 118.6,-10018.11"/>
<polygon fill="black" stroke="black" points="122.1,-10017.97 118.6,-10007.97 115.1,-10017.97 122.1,-10017.97"/>
</g>
<!-- layer_7_pipeline_send -->
<g id="node113" class="node">
<title>layer_7_pipeline_send</title>
<ellipse fill="red" stroke="black" cx="118.6" cy="-9860.73" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="118.6" y="-9869.23" font-family="Arial" font-size="10.00">Layer 7→8</text>
<text text-anchor="middle" x="118.6" y="-9858.23" font-family="Arial" font-size="10.00">Pipeline Send</text>
<text text-anchor="middle" x="118.6" y="-9847.23" font-family="Arial" font-size="10.00">GPU 3→4</text>
</g>
<!-- layer_7_output_dist&#45;&gt;layer_7_pipeline_send -->
<g id="edge127" class="edge">
<title>layer_7_output_dist&#45;&gt;layer_7_pipeline_send</title>
<path fill="none" stroke="black" d="M118.6,-9925.52C118.6,-9917.16 118.6,-9908.37 118.6,-9900.08"/>
<polygon fill="black" stroke="black" points="122.1,-9899.92 118.6,-9889.92 115.1,-9899.92 122.1,-9899.92"/>
</g>
<!-- layer_8_pipeline_recv -->
<g id="node114" class="node">
<title>layer_8_pipeline_recv</title>
<ellipse fill="red" stroke="black" cx="118.6" cy="-9766.75" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="118.6" y="-9775.25" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="118.6" y="-9764.25" font-family="Arial" font-size="10.00">Pipeline Recv</text>
<text text-anchor="middle" x="118.6" y="-9753.25" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_7_pipeline_send&#45;&gt;layer_8_pipeline_recv -->
<g id="edge128" class="edge">
<title>layer_7_pipeline_send&#45;&gt;layer_8_pipeline_recv</title>
<path fill="none" stroke="black" d="M118.6,-9831.64C118.6,-9823.6 118.6,-9814.7 118.6,-9806.15"/>
<polygon fill="black" stroke="black" points="122.1,-9805.99 118.6,-9795.99 115.1,-9805.99 122.1,-9805.99"/>
</g>
<!-- layer_8_input_dist -->
<g id="node115" class="node">
<title>layer_8_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="212.79,-9701.76 62.96,-9701.76 24.41,-9619.76 174.25,-9619.76 212.79,-9701.76"/>
<text text-anchor="middle" x="118.6" y="-9669.26" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="118.6" y="-9658.26" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="118.6" y="-9647.26" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_8_pipeline_recv&#45;&gt;layer_8_input_dist -->
<g id="edge129" class="edge">
<title>layer_8_pipeline_recv&#45;&gt;layer_8_input_dist</title>
<path fill="none" stroke="black" d="M118.6,-9737.61C118.6,-9729.74 118.6,-9720.94 118.6,-9712.2"/>
<polygon fill="black" stroke="black" points="122.1,-9712.03 118.6,-9702.03 115.1,-9712.03 122.1,-9712.03"/>
</g>
<!-- layer_8_qkv_gpu4 -->
<g id="node116" class="node">
<title>layer_8_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="128.1,-9583.76 35.1,-9583.76 35.1,-9542.76 128.1,-9542.76 128.1,-9583.76"/>
<text text-anchor="middle" x="81.6" y="-9571.76" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="81.6" y="-9560.76" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="81.6" y="-9549.76" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu4 -->
<g id="edge130" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu4</title>
<path fill="none" stroke="black" d="M103.02,-9619.53C99.62,-9610.76 96.09,-9601.65 92.89,-9593.41"/>
<polygon fill="black" stroke="black" points="96.08,-9591.93 89.2,-9583.87 89.55,-9594.46 96.08,-9591.93"/>
</g>
<!-- layer_8_residual1 -->
<g id="node119" class="node">
<title>layer_8_residual1</title>
<polygon fill="lightyellow" stroke="black" points="196.54,-9341.76 74.15,-9341.76 42.66,-9281.76 165.06,-9281.76 196.54,-9341.76"/>
<text text-anchor="middle" x="119.6" y="-9314.76" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="119.6" y="-9303.76" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_residual1 -->
<g id="edge134" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_residual1</title>
<path fill="none" stroke="black" d="M129.99,-9619.44C132.72,-9608.01 135.23,-9595.48 136.6,-9583.76 147.22,-9492.82 148.28,-9468.57 136.6,-9377.76 135.5,-9369.19 133.61,-9360.15 131.49,-9351.61"/>
<polygon fill="black" stroke="black" points="134.86,-9350.66 128.92,-9341.89 128.09,-9352.45 134.86,-9350.66"/>
</g>
<!-- layer_8_attention -->
<g id="node117" class="node">
<title>layer_8_attention</title>
<polygon fill="lightblue" stroke="black" points="116.6,-9506.76 48.6,-9506.76 48.6,-9454.76 116.6,-9454.76 116.6,-9506.76"/>
<text text-anchor="middle" x="82.6" y="-9494.76" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="82.6" y="-9483.76" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="82.6" y="-9472.76" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="82.6" y="-9461.76" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_8_qkv_gpu4&#45;&gt;layer_8_attention -->
<g id="edge131" class="edge">
<title>layer_8_qkv_gpu4&#45;&gt;layer_8_attention</title>
<path fill="none" stroke="black" d="M81.85,-9542.36C81.94,-9534.75 82.05,-9525.82 82.16,-9517.18"/>
<polygon fill="black" stroke="black" points="85.66,-9516.96 82.29,-9506.91 78.67,-9516.87 85.66,-9516.96"/>
</g>
<!-- layer_8_attn_out_gpu4 -->
<g id="node118" class="node">
<title>layer_8_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="127.6,-9418.76 39.6,-9418.76 39.6,-9377.76 127.6,-9377.76 127.6,-9418.76"/>
<text text-anchor="middle" x="83.6" y="-9406.76" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="83.6" y="-9395.76" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="83.6" y="-9384.76" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attention&#45;&gt;layer_8_attn_out_gpu4 -->
<g id="edge132" class="edge">
<title>layer_8_attention&#45;&gt;layer_8_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M82.91,-9454.73C83.01,-9446.62 83.13,-9437.54 83.23,-9429.11"/>
<polygon fill="black" stroke="black" points="86.73,-9428.95 83.36,-9418.9 79.73,-9428.86 86.73,-9428.95"/>
</g>
<!-- layer_8_attn_out_gpu4&#45;&gt;layer_8_residual1 -->
<g id="edge133" class="edge">
<title>layer_8_attn_out_gpu4&#45;&gt;layer_8_residual1</title>
<path fill="none" stroke="black" d="M91.95,-9377.66C95.31,-9369.77 99.31,-9360.39 103.21,-9351.24"/>
<polygon fill="black" stroke="black" points="106.5,-9352.44 107.2,-9341.87 100.06,-9349.7 106.5,-9352.44"/>
</g>
<!-- layer_8_ln1 -->
<g id="node120" class="node">
<title>layer_8_ln1</title>
<polygon fill="lightblue" stroke="black" points="124.1,-9245.76 51.1,-9245.76 51.1,-9204.76 124.1,-9204.76 124.1,-9245.76"/>
<text text-anchor="middle" x="87.6" y="-9233.76" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="87.6" y="-9222.76" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="87.6" y="-9211.76" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_8_residual1&#45;&gt;layer_8_ln1 -->
<g id="edge135" class="edge">
<title>layer_8_residual1&#45;&gt;layer_8_ln1</title>
<path fill="none" stroke="black" d="M108.59,-9281.68C105.37,-9273.17 101.84,-9263.87 98.62,-9255.36"/>
<polygon fill="black" stroke="black" points="101.83,-9253.94 95.01,-9245.82 95.28,-9256.42 101.83,-9253.94"/>
</g>
<!-- layer_8_residual2 -->
<g id="node124" class="node">
<title>layer_8_residual2</title>
<polygon fill="lightyellow" stroke="black" points="196.54,-8942.76 74.15,-8942.76 42.66,-8882.76 165.06,-8882.76 196.54,-8942.76"/>
<text text-anchor="middle" x="119.6" y="-8915.76" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="119.6" y="-8904.76" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_8_residual1&#45;&gt;layer_8_residual2 -->
<g id="edge140" class="edge">
<title>layer_8_residual1&#45;&gt;layer_8_residual2</title>
<path fill="none" stroke="black" d="M130.8,-9281.48C142.01,-9249.49 157.6,-9196.5 157.6,-9149.26 157.6,-9149.26 157.6,-9149.26 157.6,-9072.76 157.6,-9030.89 144.98,-8984.47 134.29,-8952.65"/>
<polygon fill="black" stroke="black" points="137.48,-8951.17 130.9,-8942.86 130.86,-8953.45 137.48,-8951.17"/>
</g>
<!-- layer_8_mlp_fc1_gpu4 -->
<g id="node121" class="node">
<title>layer_8_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="129.6,-9168.76 35.6,-9168.76 35.6,-9127.76 129.6,-9127.76 129.6,-9168.76"/>
<text text-anchor="middle" x="82.6" y="-9156.76" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="82.6" y="-9145.76" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="82.6" y="-9134.76" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu4 -->
<g id="edge136" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M86.29,-9204.55C85.77,-9196.72 85.15,-9187.53 84.58,-9178.92"/>
<polygon fill="black" stroke="black" points="88.06,-9178.58 83.91,-9168.83 81.08,-9179.04 88.06,-9178.58"/>
</g>
<!-- layer_8_gelu -->
<g id="node122" class="node">
<title>layer_8_gelu</title>
<polygon fill="lightblue" stroke="black" points="127.1,-9091.76 38.1,-9091.76 38.1,-9055.76 127.1,-9055.76 127.1,-9091.76"/>
<text text-anchor="middle" x="82.6" y="-9076.76" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="82.6" y="-9065.76" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_8_mlp_fc1_gpu4&#45;&gt;layer_8_gelu -->
<g id="edge137" class="edge">
<title>layer_8_mlp_fc1_gpu4&#45;&gt;layer_8_gelu</title>
<path fill="none" stroke="black" d="M82.6,-9127.45C82.6,-9119.67 82.6,-9110.6 82.6,-9102.21"/>
<polygon fill="black" stroke="black" points="86.1,-9102.08 82.6,-9092.08 79.1,-9102.08 86.1,-9102.08"/>
</g>
<!-- layer_8_mlp_fc2_gpu4 -->
<g id="node123" class="node">
<title>layer_8_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="129.6,-9019.76 35.6,-9019.76 35.6,-8978.76 129.6,-8978.76 129.6,-9019.76"/>
<text text-anchor="middle" x="82.6" y="-9007.76" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="82.6" y="-8996.76" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="82.6" y="-8985.76" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu4 -->
<g id="edge138" class="edge">
<title>layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu4</title>
<path fill="none" stroke="black" d="M82.6,-9055.58C82.6,-9047.96 82.6,-9038.76 82.6,-9030.08"/>
<polygon fill="black" stroke="black" points="86.1,-9029.88 82.6,-9019.88 79.1,-9029.88 86.1,-9029.88"/>
</g>
<!-- layer_8_mlp_fc2_gpu4&#45;&gt;layer_8_residual2 -->
<g id="edge139" class="edge">
<title>layer_8_mlp_fc2_gpu4&#45;&gt;layer_8_residual2</title>
<path fill="none" stroke="black" d="M91.18,-8978.66C94.64,-8970.77 98.75,-8961.39 102.75,-8952.24"/>
<polygon fill="black" stroke="black" points="106.05,-8953.43 106.86,-8942.87 99.64,-8950.62 106.05,-8953.43"/>
</g>
<!-- layer_8_ln2 -->
<g id="node125" class="node">
<title>layer_8_ln2</title>
<polygon fill="lightblue" stroke="black" points="156.1,-8846.76 83.1,-8846.76 83.1,-8805.76 156.1,-8805.76 156.1,-8846.76"/>
<text text-anchor="middle" x="119.6" y="-8834.76" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="119.6" y="-8823.76" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="119.6" y="-8812.76" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_8_residual2&#45;&gt;layer_8_ln2 -->
<g id="edge141" class="edge">
<title>layer_8_residual2&#45;&gt;layer_8_ln2</title>
<path fill="none" stroke="black" d="M119.6,-8882.68C119.6,-8874.35 119.6,-8865.27 119.6,-8856.91"/>
<polygon fill="black" stroke="black" points="123.1,-8856.82 119.6,-8846.82 116.1,-8856.82 123.1,-8856.82"/>
</g>
<!-- layer_8_output_dist -->
<g id="node126" class="node">
<title>layer_8_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="221.31,-8769.76 59.52,-8769.76 17.9,-8687.76 179.69,-8687.76 221.31,-8769.76"/>
<text text-anchor="middle" x="119.6" y="-8737.26" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="119.6" y="-8726.26" font-family="Arial" font-size="10.00">Output Distribution</text>
<text text-anchor="middle" x="119.6" y="-8715.26" font-family="Arial" font-size="10.00">GPU 4→4</text>
</g>
<!-- layer_8_ln2&#45;&gt;layer_8_output_dist -->
<g id="edge142" class="edge">
<title>layer_8_ln2&#45;&gt;layer_8_output_dist</title>
<path fill="none" stroke="black" d="M119.6,-8805.47C119.6,-8798.01 119.6,-8789.14 119.6,-8780.14"/>
<polygon fill="black" stroke="black" points="123.1,-8780 119.6,-8770 116.1,-8780 123.1,-8780"/>
</g>
<!-- layer_8_pipeline_send -->
<g id="node127" class="node">
<title>layer_8_pipeline_send</title>
<ellipse fill="red" stroke="black" cx="119.6" cy="-8622.77" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="119.6" y="-8631.27" font-family="Arial" font-size="10.00">Layer 8→9</text>
<text text-anchor="middle" x="119.6" y="-8620.27" font-family="Arial" font-size="10.00">Pipeline Send</text>
<text text-anchor="middle" x="119.6" y="-8609.27" font-family="Arial" font-size="10.00">GPU 4→4</text>
</g>
<!-- layer_8_output_dist&#45;&gt;layer_8_pipeline_send -->
<g id="edge143" class="edge">
<title>layer_8_output_dist&#45;&gt;layer_8_pipeline_send</title>
<path fill="none" stroke="black" d="M119.6,-8687.55C119.6,-8679.19 119.6,-8670.41 119.6,-8662.12"/>
<polygon fill="black" stroke="black" points="123.1,-8661.95 119.6,-8651.95 116.1,-8661.95 123.1,-8661.95"/>
</g>
<!-- layer_9_pipeline_recv -->
<g id="node128" class="node">
<title>layer_9_pipeline_recv</title>
<ellipse fill="red" stroke="black" cx="119.6" cy="-8528.78" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="119.6" y="-8537.28" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="119.6" y="-8526.28" font-family="Arial" font-size="10.00">Pipeline Recv</text>
<text text-anchor="middle" x="119.6" y="-8515.28" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_8_pipeline_send&#45;&gt;layer_9_pipeline_recv -->
<g id="edge144" class="edge">
<title>layer_8_pipeline_send&#45;&gt;layer_9_pipeline_recv</title>
<path fill="none" stroke="black" d="M119.6,-8593.67C119.6,-8585.63 119.6,-8576.73 119.6,-8568.19"/>
<polygon fill="black" stroke="black" points="123.1,-8568.03 119.6,-8558.03 116.1,-8568.03 123.1,-8568.03"/>
</g>
<!-- layer_9_input_dist -->
<g id="node129" class="node">
<title>layer_9_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="213.79,-8463.79 63.96,-8463.79 25.41,-8381.79 175.25,-8381.79 213.79,-8463.79"/>
<text text-anchor="middle" x="119.6" y="-8431.29" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="119.6" y="-8420.29" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="119.6" y="-8409.29" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_9_pipeline_recv&#45;&gt;layer_9_input_dist -->
<g id="edge145" class="edge">
<title>layer_9_pipeline_recv&#45;&gt;layer_9_input_dist</title>
<path fill="none" stroke="black" d="M119.6,-8499.64C119.6,-8491.77 119.6,-8482.98 119.6,-8474.23"/>
<polygon fill="black" stroke="black" points="123.1,-8474.06 119.6,-8464.06 116.1,-8474.06 123.1,-8474.06"/>
</g>
<!-- layer_9_qkv_gpu4 -->
<g id="node130" class="node">
<title>layer_9_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="129.1,-8345.79 36.1,-8345.79 36.1,-8304.79 129.1,-8304.79 129.1,-8345.79"/>
<text text-anchor="middle" x="82.6" y="-8333.79" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="82.6" y="-8322.79" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="82.6" y="-8311.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu4 -->
<g id="edge146" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu4</title>
<path fill="none" stroke="black" d="M104.02,-8381.57C100.62,-8372.8 97.09,-8363.68 93.89,-8355.44"/>
<polygon fill="black" stroke="black" points="97.08,-8353.96 90.2,-8345.9 90.55,-8356.49 97.08,-8353.96"/>
</g>
<!-- layer_9_residual1 -->
<g id="node133" class="node">
<title>layer_9_residual1</title>
<polygon fill="lightyellow" stroke="black" points="197.54,-8103.79 75.15,-8103.79 43.66,-8043.79 166.06,-8043.79 197.54,-8103.79"/>
<text text-anchor="middle" x="120.6" y="-8076.79" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="120.6" y="-8065.79" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_residual1 -->
<g id="edge150" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_residual1</title>
<path fill="none" stroke="black" d="M130.99,-8381.48C133.72,-8370.04 136.23,-8357.51 137.6,-8345.79 148.22,-8254.86 149.28,-8230.6 137.6,-8139.79 136.5,-8131.23 134.61,-8122.18 132.49,-8113.65"/>
<polygon fill="black" stroke="black" points="135.86,-8112.7 129.92,-8103.92 129.09,-8114.49 135.86,-8112.7"/>
</g>
<!-- layer_9_attention -->
<g id="node131" class="node">
<title>layer_9_attention</title>
<polygon fill="lightblue" stroke="black" points="117.6,-8268.79 49.6,-8268.79 49.6,-8216.79 117.6,-8216.79 117.6,-8268.79"/>
<text text-anchor="middle" x="83.6" y="-8256.79" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="83.6" y="-8245.79" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="83.6" y="-8234.79" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="83.6" y="-8223.79" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_9_qkv_gpu4&#45;&gt;layer_9_attention -->
<g id="edge147" class="edge">
<title>layer_9_qkv_gpu4&#45;&gt;layer_9_attention</title>
<path fill="none" stroke="black" d="M82.85,-8304.39C82.94,-8296.78 83.05,-8287.85 83.16,-8279.22"/>
<polygon fill="black" stroke="black" points="86.66,-8278.99 83.29,-8268.95 79.67,-8278.9 86.66,-8278.99"/>
</g>
<!-- layer_9_attn_out_gpu4 -->
<g id="node132" class="node">
<title>layer_9_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="128.6,-8180.79 40.6,-8180.79 40.6,-8139.79 128.6,-8139.79 128.6,-8180.79"/>
<text text-anchor="middle" x="84.6" y="-8168.79" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="84.6" y="-8157.79" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="84.6" y="-8146.79" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attention&#45;&gt;layer_9_attn_out_gpu4 -->
<g id="edge148" class="edge">
<title>layer_9_attention&#45;&gt;layer_9_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M83.91,-8216.76C84.01,-8208.65 84.13,-8199.57 84.23,-8191.14"/>
<polygon fill="black" stroke="black" points="87.73,-8190.98 84.36,-8180.94 80.73,-8190.89 87.73,-8190.98"/>
</g>
<!-- layer_9_attn_out_gpu4&#45;&gt;layer_9_residual1 -->
<g id="edge149" class="edge">
<title>layer_9_attn_out_gpu4&#45;&gt;layer_9_residual1</title>
<path fill="none" stroke="black" d="M92.95,-8139.69C96.31,-8131.81 100.31,-8122.42 104.21,-8113.28"/>
<polygon fill="black" stroke="black" points="107.5,-8114.47 108.2,-8103.9 101.06,-8111.73 107.5,-8114.47"/>
</g>
<!-- layer_9_ln1 -->
<g id="node134" class="node">
<title>layer_9_ln1</title>
<polygon fill="lightblue" stroke="black" points="125.1,-8007.79 52.1,-8007.79 52.1,-7966.79 125.1,-7966.79 125.1,-8007.79"/>
<text text-anchor="middle" x="88.6" y="-7995.79" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="88.6" y="-7984.79" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="88.6" y="-7973.79" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_9_residual1&#45;&gt;layer_9_ln1 -->
<g id="edge151" class="edge">
<title>layer_9_residual1&#45;&gt;layer_9_ln1</title>
<path fill="none" stroke="black" d="M109.59,-8043.71C106.37,-8035.2 102.84,-8025.9 99.62,-8017.39"/>
<polygon fill="black" stroke="black" points="102.83,-8015.97 96.01,-8007.86 96.28,-8018.45 102.83,-8015.97"/>
</g>
<!-- layer_9_residual2 -->
<g id="node138" class="node">
<title>layer_9_residual2</title>
<polygon fill="lightyellow" stroke="black" points="197.54,-7704.79 75.15,-7704.79 43.66,-7644.79 166.06,-7644.79 197.54,-7704.79"/>
<text text-anchor="middle" x="120.6" y="-7677.79" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="120.6" y="-7666.79" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_9_residual1&#45;&gt;layer_9_residual2 -->
<g id="edge156" class="edge">
<title>layer_9_residual1&#45;&gt;layer_9_residual2</title>
<path fill="none" stroke="black" d="M131.8,-8043.51C143.01,-8011.53 158.6,-7958.53 158.6,-7911.29 158.6,-7911.29 158.6,-7911.29 158.6,-7834.79 158.6,-7792.92 145.98,-7746.5 135.29,-7714.69"/>
<polygon fill="black" stroke="black" points="138.48,-7713.2 131.9,-7704.89 131.86,-7715.49 138.48,-7713.2"/>
</g>
<!-- layer_9_mlp_fc1_gpu4 -->
<g id="node135" class="node">
<title>layer_9_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="130.6,-7930.79 36.6,-7930.79 36.6,-7889.79 130.6,-7889.79 130.6,-7930.79"/>
<text text-anchor="middle" x="83.6" y="-7918.79" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="83.6" y="-7907.79" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="83.6" y="-7896.79" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu4 -->
<g id="edge152" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M87.29,-7966.59C86.77,-7958.75 86.15,-7949.56 85.58,-7940.95"/>
<polygon fill="black" stroke="black" points="89.06,-7940.61 84.91,-7930.87 82.08,-7941.08 89.06,-7940.61"/>
</g>
<!-- layer_9_gelu -->
<g id="node136" class="node">
<title>layer_9_gelu</title>
<polygon fill="lightblue" stroke="black" points="128.1,-7853.79 39.1,-7853.79 39.1,-7817.79 128.1,-7817.79 128.1,-7853.79"/>
<text text-anchor="middle" x="83.6" y="-7838.79" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="83.6" y="-7827.79" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_9_mlp_fc1_gpu4&#45;&gt;layer_9_gelu -->
<g id="edge153" class="edge">
<title>layer_9_mlp_fc1_gpu4&#45;&gt;layer_9_gelu</title>
<path fill="none" stroke="black" d="M83.6,-7889.48C83.6,-7881.7 83.6,-7872.63 83.6,-7864.24"/>
<polygon fill="black" stroke="black" points="87.1,-7864.11 83.6,-7854.11 80.1,-7864.11 87.1,-7864.11"/>
</g>
<!-- layer_9_mlp_fc2_gpu4 -->
<g id="node137" class="node">
<title>layer_9_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="130.6,-7781.79 36.6,-7781.79 36.6,-7740.79 130.6,-7740.79 130.6,-7781.79"/>
<text text-anchor="middle" x="83.6" y="-7769.79" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="83.6" y="-7758.79" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="83.6" y="-7747.79" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu4 -->
<g id="edge154" class="edge">
<title>layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu4</title>
<path fill="none" stroke="black" d="M83.6,-7817.61C83.6,-7809.99 83.6,-7800.8 83.6,-7792.11"/>
<polygon fill="black" stroke="black" points="87.1,-7791.91 83.6,-7781.91 80.1,-7791.91 87.1,-7791.91"/>
</g>
<!-- layer_9_mlp_fc2_gpu4&#45;&gt;layer_9_residual2 -->
<g id="edge155" class="edge">
<title>layer_9_mlp_fc2_gpu4&#45;&gt;layer_9_residual2</title>
<path fill="none" stroke="black" d="M92.18,-7740.69C95.64,-7732.81 99.75,-7723.42 103.75,-7714.28"/>
<polygon fill="black" stroke="black" points="107.05,-7715.47 107.86,-7704.9 100.64,-7712.66 107.05,-7715.47"/>
</g>
<!-- layer_9_ln2 -->
<g id="node139" class="node">
<title>layer_9_ln2</title>
<polygon fill="lightblue" stroke="black" points="157.1,-7608.79 84.1,-7608.79 84.1,-7567.79 157.1,-7567.79 157.1,-7608.79"/>
<text text-anchor="middle" x="120.6" y="-7596.79" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="120.6" y="-7585.79" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="120.6" y="-7574.79" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_9_residual2&#45;&gt;layer_9_ln2 -->
<g id="edge157" class="edge">
<title>layer_9_residual2&#45;&gt;layer_9_ln2</title>
<path fill="none" stroke="black" d="M120.6,-7644.71C120.6,-7636.39 120.6,-7627.31 120.6,-7618.95"/>
<polygon fill="black" stroke="black" points="124.1,-7618.86 120.6,-7608.86 117.1,-7618.86 124.1,-7618.86"/>
</g>
<!-- layer_9_output_dist -->
<g id="node140" class="node">
<title>layer_9_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="222.31,-7531.79 60.52,-7531.79 18.9,-7449.79 180.69,-7449.79 222.31,-7531.79"/>
<text text-anchor="middle" x="120.6" y="-7499.29" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="120.6" y="-7488.29" font-family="Arial" font-size="10.00">Output Distribution</text>
<text text-anchor="middle" x="120.6" y="-7477.29" font-family="Arial" font-size="10.00">GPU 4→5</text>
</g>
<!-- layer_9_ln2&#45;&gt;layer_9_output_dist -->
<g id="edge158" class="edge">
<title>layer_9_ln2&#45;&gt;layer_9_output_dist</title>
<path fill="none" stroke="black" d="M120.6,-7567.51C120.6,-7560.04 120.6,-7551.17 120.6,-7542.18"/>
<polygon fill="black" stroke="black" points="124.1,-7542.04 120.6,-7532.04 117.1,-7542.04 124.1,-7542.04"/>
</g>
<!-- layer_9_pipeline_send -->
<g id="node141" class="node">
<title>layer_9_pipeline_send</title>
<ellipse fill="red" stroke="black" cx="120.6" cy="-7384.8" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="120.6" y="-7393.3" font-family="Arial" font-size="10.00">Layer 9→10</text>
<text text-anchor="middle" x="120.6" y="-7382.3" font-family="Arial" font-size="10.00">Pipeline Send</text>
<text text-anchor="middle" x="120.6" y="-7371.3" font-family="Arial" font-size="10.00">GPU 4→5</text>
</g>
<!-- layer_9_output_dist&#45;&gt;layer_9_pipeline_send -->
<g id="edge159" class="edge">
<title>layer_9_output_dist&#45;&gt;layer_9_pipeline_send</title>
<path fill="none" stroke="black" d="M120.6,-7449.59C120.6,-7441.23 120.6,-7432.44 120.6,-7424.15"/>
<polygon fill="black" stroke="black" points="124.1,-7423.99 120.6,-7413.99 117.1,-7423.99 124.1,-7423.99"/>
</g>
<!-- layer_10_pipeline_recv -->
<g id="node142" class="node">
<title>layer_10_pipeline_recv</title>
<ellipse fill="red" stroke="black" cx="120.6" cy="-7290.82" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="120.6" y="-7299.32" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="120.6" y="-7288.32" font-family="Arial" font-size="10.00">Pipeline Recv</text>
<text text-anchor="middle" x="120.6" y="-7277.32" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_9_pipeline_send&#45;&gt;layer_10_pipeline_recv -->
<g id="edge160" class="edge">
<title>layer_9_pipeline_send&#45;&gt;layer_10_pipeline_recv</title>
<path fill="none" stroke="black" d="M120.6,-7355.7C120.6,-7347.67 120.6,-7338.76 120.6,-7330.22"/>
<polygon fill="black" stroke="black" points="124.1,-7330.06 120.6,-7320.06 117.1,-7330.06 124.1,-7330.06"/>
</g>
<!-- layer_10_input_dist -->
<g id="node143" class="node">
<title>layer_10_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="214.79,-7225.83 64.96,-7225.83 26.41,-7143.83 176.25,-7143.83 214.79,-7225.83"/>
<text text-anchor="middle" x="120.6" y="-7193.33" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="120.6" y="-7182.33" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="120.6" y="-7171.33" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_10_pipeline_recv&#45;&gt;layer_10_input_dist -->
<g id="edge161" class="edge">
<title>layer_10_pipeline_recv&#45;&gt;layer_10_input_dist</title>
<path fill="none" stroke="black" d="M120.6,-7261.68C120.6,-7253.81 120.6,-7245.01 120.6,-7236.27"/>
<polygon fill="black" stroke="black" points="124.1,-7236.09 120.6,-7226.09 117.1,-7236.09 124.1,-7236.09"/>
</g>
<!-- layer_10_qkv_gpu5 -->
<g id="node144" class="node">
<title>layer_10_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="131.6,-7107.83 33.6,-7107.83 33.6,-7066.83 131.6,-7066.83 131.6,-7107.83"/>
<text text-anchor="middle" x="82.6" y="-7095.83" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="82.6" y="-7084.83" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="82.6" y="-7073.83" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu5 -->
<g id="edge162" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu5</title>
<path fill="none" stroke="black" d="M104.6,-7143.6C101.11,-7134.83 97.48,-7125.72 94.2,-7117.47"/>
<polygon fill="black" stroke="black" points="97.35,-7115.94 90.41,-7107.94 90.85,-7118.52 97.35,-7115.94"/>
</g>
<!-- layer_10_residual1 -->
<g id="node147" class="node">
<title>layer_10_residual1</title>
<polygon fill="lightyellow" stroke="black" points="198.54,-6865.83 76.15,-6865.83 44.66,-6805.83 167.06,-6805.83 198.54,-6865.83"/>
<text text-anchor="middle" x="121.6" y="-6838.83" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="121.6" y="-6827.83" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_residual1 -->
<g id="edge166" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_residual1</title>
<path fill="none" stroke="black" d="M133.25,-7143.58C136.28,-7132.15 139.08,-7119.6 140.6,-7107.83 145.39,-7070.85 157.41,-7029.94 139.6,-6901.83 138.41,-6893.24 136.4,-6884.19 134.15,-6875.65"/>
<polygon fill="black" stroke="black" points="137.49,-6874.61 131.43,-6865.93 130.75,-6876.5 137.49,-6874.61"/>
</g>
<!-- layer_10_attention -->
<g id="node145" class="node">
<title>layer_10_attention</title>
<polygon fill="lightblue" stroke="black" points="117.6,-7030.83 49.6,-7030.83 49.6,-6978.83 117.6,-6978.83 117.6,-7030.83"/>
<text text-anchor="middle" x="83.6" y="-7018.83" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="83.6" y="-7007.83" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="83.6" y="-6996.83" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="83.6" y="-6985.83" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_10_qkv_gpu5&#45;&gt;layer_10_attention -->
<g id="edge163" class="edge">
<title>layer_10_qkv_gpu5&#45;&gt;layer_10_attention</title>
<path fill="none" stroke="black" d="M82.85,-7066.43C82.94,-7058.82 83.05,-7049.88 83.16,-7041.25"/>
<polygon fill="black" stroke="black" points="86.66,-7041.03 83.29,-7030.98 79.67,-7040.94 86.66,-7041.03"/>
</g>
<!-- layer_10_attn_out_gpu5 -->
<g id="node146" class="node">
<title>layer_10_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="131.1,-6942.83 38.1,-6942.83 38.1,-6901.83 131.1,-6901.83 131.1,-6942.83"/>
<text text-anchor="middle" x="84.6" y="-6930.83" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="84.6" y="-6919.83" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="84.6" y="-6908.83" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attention&#45;&gt;layer_10_attn_out_gpu5 -->
<g id="edge164" class="edge">
<title>layer_10_attention&#45;&gt;layer_10_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M83.91,-6978.8C84.01,-6970.69 84.13,-6961.6 84.23,-6953.18"/>
<polygon fill="black" stroke="black" points="87.73,-6953.02 84.36,-6942.97 80.73,-6952.93 87.73,-6953.02"/>
</g>
<!-- layer_10_attn_out_gpu5&#45;&gt;layer_10_residual1 -->
<g id="edge165" class="edge">
<title>layer_10_attn_out_gpu5&#45;&gt;layer_10_residual1</title>
<path fill="none" stroke="black" d="M93.18,-6901.73C96.64,-6893.84 100.75,-6884.46 104.75,-6875.31"/>
<polygon fill="black" stroke="black" points="108.05,-6876.5 108.86,-6865.94 101.64,-6873.69 108.05,-6876.5"/>
</g>
<!-- layer_10_ln1 -->
<g id="node148" class="node">
<title>layer_10_ln1</title>
<polygon fill="lightblue" stroke="black" points="119.1,-6769.83 46.1,-6769.83 46.1,-6728.83 119.1,-6728.83 119.1,-6769.83"/>
<text text-anchor="middle" x="82.6" y="-6757.83" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="82.6" y="-6746.83" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="82.6" y="-6735.83" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_10_residual1&#45;&gt;layer_10_ln1 -->
<g id="edge167" class="edge">
<title>layer_10_residual1&#45;&gt;layer_10_ln1</title>
<path fill="none" stroke="black" d="M108.18,-6805.75C104.21,-6797.15 99.87,-6787.73 95.9,-6779.15"/>
<polygon fill="black" stroke="black" points="99,-6777.51 91.63,-6769.89 92.64,-6780.44 99,-6777.51"/>
</g>
<!-- layer_10_residual2 -->
<g id="node152" class="node">
<title>layer_10_residual2</title>
<polygon fill="lightyellow" stroke="black" points="192.54,-6466.83 70.15,-6466.83 38.66,-6406.83 161.06,-6406.83 192.54,-6466.83"/>
<text text-anchor="middle" x="115.6" y="-6439.83" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="115.6" y="-6428.83" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_10_residual1&#45;&gt;layer_10_residual2 -->
<g id="edge172" class="edge">
<title>layer_10_residual1&#45;&gt;layer_10_residual2</title>
<path fill="none" stroke="black" d="M131.24,-6805.72C140.98,-6773.66 154.6,-6720.4 154.6,-6673.33 154.6,-6673.33 154.6,-6673.33 154.6,-6596.83 154.6,-6554.9 141.65,-6508.49 130.67,-6476.69"/>
<polygon fill="black" stroke="black" points="133.84,-6475.15 127.2,-6466.9 127.25,-6477.5 133.84,-6475.15"/>
</g>
<!-- layer_10_mlp_fc1_gpu5 -->
<g id="node149" class="node">
<title>layer_10_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="126.1,-6692.83 27.1,-6692.83 27.1,-6651.83 126.1,-6651.83 126.1,-6692.83"/>
<text text-anchor="middle" x="76.6" y="-6680.83" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="76.6" y="-6669.83" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="76.6" y="-6658.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu5 -->
<g id="edge168" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M81.03,-6728.62C80.4,-6720.78 79.66,-6711.6 78.97,-6702.99"/>
<polygon fill="black" stroke="black" points="82.45,-6702.59 78.17,-6692.9 75.48,-6703.15 82.45,-6702.59"/>
</g>
<!-- layer_10_gelu -->
<g id="node150" class="node">
<title>layer_10_gelu</title>
<polygon fill="lightblue" stroke="black" points="121.1,-6615.83 32.1,-6615.83 32.1,-6579.83 121.1,-6579.83 121.1,-6615.83"/>
<text text-anchor="middle" x="76.6" y="-6600.83" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="76.6" y="-6589.83" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_10_mlp_fc1_gpu5&#45;&gt;layer_10_gelu -->
<g id="edge169" class="edge">
<title>layer_10_mlp_fc1_gpu5&#45;&gt;layer_10_gelu</title>
<path fill="none" stroke="black" d="M76.6,-6651.52C76.6,-6643.73 76.6,-6634.67 76.6,-6626.27"/>
<polygon fill="black" stroke="black" points="80.1,-6626.15 76.6,-6616.15 73.1,-6626.15 80.1,-6626.15"/>
</g>
<!-- layer_10_mlp_fc2_gpu5 -->
<g id="node151" class="node">
<title>layer_10_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="126.1,-6543.83 27.1,-6543.83 27.1,-6502.83 126.1,-6502.83 126.1,-6543.83"/>
<text text-anchor="middle" x="76.6" y="-6531.83" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="76.6" y="-6520.83" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="76.6" y="-6509.83" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu5 -->
<g id="edge170" class="edge">
<title>layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu5</title>
<path fill="none" stroke="black" d="M76.6,-6579.65C76.6,-6572.03 76.6,-6562.83 76.6,-6554.15"/>
<polygon fill="black" stroke="black" points="80.1,-6553.95 76.6,-6543.95 73.1,-6553.95 80.1,-6553.95"/>
</g>
<!-- layer_10_mlp_fc2_gpu5&#45;&gt;layer_10_residual2 -->
<g id="edge171" class="edge">
<title>layer_10_mlp_fc2_gpu5&#45;&gt;layer_10_residual2</title>
<path fill="none" stroke="black" d="M85.65,-6502.73C89.33,-6494.76 93.71,-6485.26 97.97,-6476.02"/>
<polygon fill="black" stroke="black" points="101.15,-6477.48 102.17,-6466.94 94.8,-6474.55 101.15,-6477.48"/>
</g>
<!-- layer_10_ln2 -->
<g id="node153" class="node">
<title>layer_10_ln2</title>
<polygon fill="lightblue" stroke="black" points="152.1,-6370.83 79.1,-6370.83 79.1,-6329.83 152.1,-6329.83 152.1,-6370.83"/>
<text text-anchor="middle" x="115.6" y="-6358.83" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="115.6" y="-6347.83" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="115.6" y="-6336.83" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_10_residual2&#45;&gt;layer_10_ln2 -->
<g id="edge173" class="edge">
<title>layer_10_residual2&#45;&gt;layer_10_ln2</title>
<path fill="none" stroke="black" d="M115.6,-6406.75C115.6,-6398.42 115.6,-6389.34 115.6,-6380.98"/>
<polygon fill="black" stroke="black" points="119.1,-6380.89 115.6,-6370.89 112.1,-6380.89 119.1,-6380.89"/>
</g>
<!-- layer_10_output_dist -->
<g id="node154" class="node">
<title>layer_10_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="217.31,-6293.83 55.52,-6293.83 13.9,-6211.83 175.69,-6211.83 217.31,-6293.83"/>
<text text-anchor="middle" x="115.6" y="-6261.33" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="115.6" y="-6250.33" font-family="Arial" font-size="10.00">Output Distribution</text>
<text text-anchor="middle" x="115.6" y="-6239.33" font-family="Arial" font-size="10.00">GPU 5→5</text>
</g>
<!-- layer_10_ln2&#45;&gt;layer_10_output_dist -->
<g id="edge174" class="edge">
<title>layer_10_ln2&#45;&gt;layer_10_output_dist</title>
<path fill="none" stroke="black" d="M115.6,-6329.54C115.6,-6322.08 115.6,-6313.21 115.6,-6304.21"/>
<polygon fill="black" stroke="black" points="119.1,-6304.07 115.6,-6294.07 112.1,-6304.07 119.1,-6304.07"/>
</g>
<!-- layer_10_pipeline_send -->
<g id="node155" class="node">
<title>layer_10_pipeline_send</title>
<ellipse fill="red" stroke="black" cx="115.6" cy="-6146.84" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="115.6" y="-6155.34" font-family="Arial" font-size="10.00">Layer 10→11</text>
<text text-anchor="middle" x="115.6" y="-6144.34" font-family="Arial" font-size="10.00">Pipeline Send</text>
<text text-anchor="middle" x="115.6" y="-6133.34" font-family="Arial" font-size="10.00">GPU 5→5</text>
</g>
<!-- layer_10_output_dist&#45;&gt;layer_10_pipeline_send -->
<g id="edge175" class="edge">
<title>layer_10_output_dist&#45;&gt;layer_10_pipeline_send</title>
<path fill="none" stroke="black" d="M115.6,-6211.62C115.6,-6203.26 115.6,-6194.47 115.6,-6186.19"/>
<polygon fill="black" stroke="black" points="119.1,-6186.02 115.6,-6176.02 112.1,-6186.02 119.1,-6186.02"/>
</g>
<!-- layer_11_pipeline_recv -->
<g id="node156" class="node">
<title>layer_11_pipeline_recv</title>
<ellipse fill="red" stroke="black" cx="115.6" cy="-6052.85" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="115.6" y="-6061.35" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="115.6" y="-6050.35" font-family="Arial" font-size="10.00">Pipeline Recv</text>
<text text-anchor="middle" x="115.6" y="-6039.35" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_10_pipeline_send&#45;&gt;layer_11_pipeline_recv -->
<g id="edge176" class="edge">
<title>layer_10_pipeline_send&#45;&gt;layer_11_pipeline_recv</title>
<path fill="none" stroke="black" d="M115.6,-6117.74C115.6,-6109.7 115.6,-6100.8 115.6,-6092.26"/>
<polygon fill="black" stroke="black" points="119.1,-6092.1 115.6,-6082.1 112.1,-6092.1 119.1,-6092.1"/>
</g>
<!-- layer_11_input_dist -->
<g id="node157" class="node">
<title>layer_11_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="209.79,-5987.86 59.96,-5987.86 21.41,-5905.86 171.25,-5905.86 209.79,-5987.86"/>
<text text-anchor="middle" x="115.6" y="-5955.36" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="115.6" y="-5944.36" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="115.6" y="-5933.36" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_11_pipeline_recv&#45;&gt;layer_11_input_dist -->
<g id="edge177" class="edge">
<title>layer_11_pipeline_recv&#45;&gt;layer_11_input_dist</title>
<path fill="none" stroke="black" d="M115.6,-6023.71C115.6,-6015.84 115.6,-6007.04 115.6,-5998.3"/>
<polygon fill="black" stroke="black" points="119.1,-5998.13 115.6,-5988.13 112.1,-5998.13 119.1,-5998.13"/>
</g>
<!-- layer_11_qkv_gpu5 -->
<g id="node158" class="node">
<title>layer_11_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="126.6,-5869.86 28.6,-5869.86 28.6,-5828.86 126.6,-5828.86 126.6,-5869.86"/>
<text text-anchor="middle" x="77.6" y="-5857.86" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="77.6" y="-5846.86" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="77.6" y="-5835.86" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu5 -->
<g id="edge178" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu5</title>
<path fill="none" stroke="black" d="M99.6,-5905.64C96.11,-5896.87 92.48,-5887.75 89.2,-5879.51"/>
<polygon fill="black" stroke="black" points="92.35,-5877.97 85.41,-5869.97 85.85,-5880.56 92.35,-5877.97"/>
</g>
<!-- layer_11_residual1 -->
<g id="node161" class="node">
<title>layer_11_residual1</title>
<polygon fill="lightyellow" stroke="black" points="193.54,-5627.86 71.15,-5627.86 39.66,-5567.86 162.06,-5567.86 193.54,-5627.86"/>
<text text-anchor="middle" x="116.6" y="-5600.86" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="116.6" y="-5589.86" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_residual1 -->
<g id="edge182" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_residual1</title>
<path fill="none" stroke="black" d="M128.25,-5905.62C131.28,-5894.18 134.08,-5881.63 135.6,-5869.86 140.39,-5832.89 152.41,-5791.98 134.6,-5663.86 133.41,-5655.28 131.4,-5646.22 129.15,-5637.68"/>
<polygon fill="black" stroke="black" points="132.49,-5636.65 126.43,-5627.96 125.75,-5638.53 132.49,-5636.65"/>
</g>
<!-- layer_11_attention -->
<g id="node159" class="node">
<title>layer_11_attention</title>
<polygon fill="lightblue" stroke="black" points="112.6,-5792.86 44.6,-5792.86 44.6,-5740.86 112.6,-5740.86 112.6,-5792.86"/>
<text text-anchor="middle" x="78.6" y="-5780.86" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="78.6" y="-5769.86" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="78.6" y="-5758.86" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="78.6" y="-5747.86" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_11_qkv_gpu5&#45;&gt;layer_11_attention -->
<g id="edge179" class="edge">
<title>layer_11_qkv_gpu5&#45;&gt;layer_11_attention</title>
<path fill="none" stroke="black" d="M77.85,-5828.46C77.94,-5820.85 78.05,-5811.92 78.16,-5803.29"/>
<polygon fill="black" stroke="black" points="81.66,-5803.06 78.29,-5793.02 74.67,-5802.97 81.66,-5803.06"/>
</g>
<!-- layer_11_attn_out_gpu5 -->
<g id="node160" class="node">
<title>layer_11_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="126.1,-5704.86 33.1,-5704.86 33.1,-5663.86 126.1,-5663.86 126.1,-5704.86"/>
<text text-anchor="middle" x="79.6" y="-5692.86" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="79.6" y="-5681.86" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="79.6" y="-5670.86" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attention&#45;&gt;layer_11_attn_out_gpu5 -->
<g id="edge180" class="edge">
<title>layer_11_attention&#45;&gt;layer_11_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M78.91,-5740.83C79.01,-5732.72 79.13,-5723.64 79.23,-5715.21"/>
<polygon fill="black" stroke="black" points="82.73,-5715.05 79.36,-5705.01 75.73,-5714.96 82.73,-5715.05"/>
</g>
<!-- layer_11_attn_out_gpu5&#45;&gt;layer_11_residual1 -->
<g id="edge181" class="edge">
<title>layer_11_attn_out_gpu5&#45;&gt;layer_11_residual1</title>
<path fill="none" stroke="black" d="M88.18,-5663.76C91.64,-5655.88 95.75,-5646.49 99.75,-5637.34"/>
<polygon fill="black" stroke="black" points="103.05,-5638.54 103.86,-5627.97 96.64,-5635.73 103.05,-5638.54"/>
</g>
<!-- layer_11_ln1 -->
<g id="node162" class="node">
<title>layer_11_ln1</title>
<polygon fill="lightblue" stroke="black" points="114.1,-5531.86 41.1,-5531.86 41.1,-5490.86 114.1,-5490.86 114.1,-5531.86"/>
<text text-anchor="middle" x="77.6" y="-5519.86" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="77.6" y="-5508.86" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="77.6" y="-5497.86" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_11_residual1&#45;&gt;layer_11_ln1 -->
<g id="edge183" class="edge">
<title>layer_11_residual1&#45;&gt;layer_11_ln1</title>
<path fill="none" stroke="black" d="M103.18,-5567.78C99.21,-5559.18 94.87,-5549.77 90.9,-5541.18"/>
<polygon fill="black" stroke="black" points="94,-5539.54 86.63,-5531.93 87.64,-5542.47 94,-5539.54"/>
</g>
<!-- layer_11_residual2 -->
<g id="node166" class="node">
<title>layer_11_residual2</title>
<polygon fill="lightyellow" stroke="black" points="187.54,-5228.86 65.15,-5228.86 33.66,-5168.86 156.06,-5168.86 187.54,-5228.86"/>
<text text-anchor="middle" x="110.6" y="-5201.86" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="110.6" y="-5190.86" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_11_residual1&#45;&gt;layer_11_residual2 -->
<g id="edge188" class="edge">
<title>layer_11_residual1&#45;&gt;layer_11_residual2</title>
<path fill="none" stroke="black" d="M126.24,-5567.76C135.98,-5535.7 149.6,-5482.44 149.6,-5435.36 149.6,-5435.36 149.6,-5435.36 149.6,-5358.86 149.6,-5316.93 136.65,-5270.52 125.67,-5238.72"/>
<polygon fill="black" stroke="black" points="128.84,-5237.19 122.2,-5228.94 122.25,-5239.53 128.84,-5237.19"/>
</g>
<!-- layer_11_mlp_fc1_gpu5 -->
<g id="node163" class="node">
<title>layer_11_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="121.1,-5454.86 22.1,-5454.86 22.1,-5413.86 121.1,-5413.86 121.1,-5454.86"/>
<text text-anchor="middle" x="71.6" y="-5442.86" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="71.6" y="-5431.86" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="71.6" y="-5420.86" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu5 -->
<g id="edge184" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M76.03,-5490.66C75.4,-5482.82 74.66,-5473.63 73.97,-5465.02"/>
<polygon fill="black" stroke="black" points="77.45,-5464.62 73.17,-5454.94 70.48,-5465.18 77.45,-5464.62"/>
</g>
<!-- layer_11_gelu -->
<g id="node164" class="node">
<title>layer_11_gelu</title>
<polygon fill="lightblue" stroke="black" points="116.1,-5377.86 27.1,-5377.86 27.1,-5341.86 116.1,-5341.86 116.1,-5377.86"/>
<text text-anchor="middle" x="71.6" y="-5362.86" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="71.6" y="-5351.86" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_11_mlp_fc1_gpu5&#45;&gt;layer_11_gelu -->
<g id="edge185" class="edge">
<title>layer_11_mlp_fc1_gpu5&#45;&gt;layer_11_gelu</title>
<path fill="none" stroke="black" d="M71.6,-5413.55C71.6,-5405.77 71.6,-5396.7 71.6,-5388.31"/>
<polygon fill="black" stroke="black" points="75.1,-5388.18 71.6,-5378.18 68.1,-5388.18 75.1,-5388.18"/>
</g>
<!-- layer_11_mlp_fc2_gpu5 -->
<g id="node165" class="node">
<title>layer_11_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="121.1,-5305.86 22.1,-5305.86 22.1,-5264.86 121.1,-5264.86 121.1,-5305.86"/>
<text text-anchor="middle" x="71.6" y="-5293.86" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="71.6" y="-5282.86" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="71.6" y="-5271.86" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu5 -->
<g id="edge186" class="edge">
<title>layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu5</title>
<path fill="none" stroke="black" d="M71.6,-5341.68C71.6,-5334.06 71.6,-5324.87 71.6,-5316.18"/>
<polygon fill="black" stroke="black" points="75.1,-5315.98 71.6,-5305.98 68.1,-5315.98 75.1,-5315.98"/>
</g>
<!-- layer_11_mlp_fc2_gpu5&#45;&gt;layer_11_residual2 -->
<g id="edge187" class="edge">
<title>layer_11_mlp_fc2_gpu5&#45;&gt;layer_11_residual2</title>
<path fill="none" stroke="black" d="M80.65,-5264.76C84.33,-5256.79 88.71,-5247.29 92.97,-5238.06"/>
<polygon fill="black" stroke="black" points="96.15,-5239.52 97.17,-5228.97 89.8,-5236.58 96.15,-5239.52"/>
</g>
<!-- layer_11_ln2 -->
<g id="node167" class="node">
<title>layer_11_ln2</title>
<polygon fill="lightblue" stroke="black" points="147.1,-5132.86 74.1,-5132.86 74.1,-5091.86 147.1,-5091.86 147.1,-5132.86"/>
<text text-anchor="middle" x="110.6" y="-5120.86" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="110.6" y="-5109.86" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="110.6" y="-5098.86" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_11_residual2&#45;&gt;layer_11_ln2 -->
<g id="edge189" class="edge">
<title>layer_11_residual2&#45;&gt;layer_11_ln2</title>
<path fill="none" stroke="black" d="M110.6,-5168.78C110.6,-5160.46 110.6,-5151.37 110.6,-5143.02"/>
<polygon fill="black" stroke="black" points="114.1,-5142.93 110.6,-5132.93 107.1,-5142.93 114.1,-5142.93"/>
</g>
<!-- layer_11_output_dist -->
<g id="node168" class="node">
<title>layer_11_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="212.31,-5055.86 50.52,-5055.86 8.9,-4973.86 170.69,-4973.86 212.31,-5055.86"/>
<text text-anchor="middle" x="110.6" y="-5023.36" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="110.6" y="-5012.36" font-family="Arial" font-size="10.00">Output Distribution</text>
<text text-anchor="middle" x="110.6" y="-5001.36" font-family="Arial" font-size="10.00">GPU 5→6</text>
</g>
<!-- layer_11_ln2&#45;&gt;layer_11_output_dist -->
<g id="edge190" class="edge">
<title>layer_11_ln2&#45;&gt;layer_11_output_dist</title>
<path fill="none" stroke="black" d="M110.6,-5091.57C110.6,-5084.11 110.6,-5075.24 110.6,-5066.25"/>
<polygon fill="black" stroke="black" points="114.1,-5066.11 110.6,-5056.11 107.1,-5066.11 114.1,-5066.11"/>
</g>
<!-- layer_11_pipeline_send -->
<g id="node169" class="node">
<title>layer_11_pipeline_send</title>
<ellipse fill="red" stroke="black" cx="110.6" cy="-4908.87" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="110.6" y="-4917.37" font-family="Arial" font-size="10.00">Layer 11→12</text>
<text text-anchor="middle" x="110.6" y="-4906.37" font-family="Arial" font-size="10.00">Pipeline Send</text>
<text text-anchor="middle" x="110.6" y="-4895.37" font-family="Arial" font-size="10.00">GPU 5→6</text>
</g>
<!-- layer_11_output_dist&#45;&gt;layer_11_pipeline_send -->
<g id="edge191" class="edge">
<title>layer_11_output_dist&#45;&gt;layer_11_pipeline_send</title>
<path fill="none" stroke="black" d="M110.6,-4973.66C110.6,-4965.3 110.6,-4956.51 110.6,-4948.22"/>
<polygon fill="black" stroke="black" points="114.1,-4948.06 110.6,-4938.06 107.1,-4948.06 114.1,-4948.06"/>
</g>
<!-- layer_12_pipeline_recv -->
<g id="node170" class="node">
<title>layer_12_pipeline_recv</title>
<ellipse fill="red" stroke="black" cx="110.6" cy="-4814.89" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="110.6" y="-4823.39" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="110.6" y="-4812.39" font-family="Arial" font-size="10.00">Pipeline Recv</text>
<text text-anchor="middle" x="110.6" y="-4801.39" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_11_pipeline_send&#45;&gt;layer_12_pipeline_recv -->
<g id="edge192" class="edge">
<title>layer_11_pipeline_send&#45;&gt;layer_12_pipeline_recv</title>
<path fill="none" stroke="black" d="M110.6,-4879.77C110.6,-4871.73 110.6,-4862.83 110.6,-4854.29"/>
<polygon fill="black" stroke="black" points="114.1,-4854.13 110.6,-4844.13 107.1,-4854.13 114.1,-4854.13"/>
</g>
<!-- layer_12_input_dist -->
<g id="node171" class="node">
<title>layer_12_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="204.79,-4749.9 54.96,-4749.9 16.41,-4667.9 166.25,-4667.9 204.79,-4749.9"/>
<text text-anchor="middle" x="110.6" y="-4717.4" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="110.6" y="-4706.4" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="110.6" y="-4695.4" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_12_pipeline_recv&#45;&gt;layer_12_input_dist -->
<g id="edge193" class="edge">
<title>layer_12_pipeline_recv&#45;&gt;layer_12_input_dist</title>
<path fill="none" stroke="black" d="M110.6,-4785.75C110.6,-4777.88 110.6,-4769.08 110.6,-4760.34"/>
<polygon fill="black" stroke="black" points="114.1,-4760.16 110.6,-4750.16 107.1,-4760.16 114.1,-4760.16"/>
</g>
<!-- layer_12_qkv_gpu6 -->
<g id="node172" class="node">
<title>layer_12_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="121.6,-4631.9 23.6,-4631.9 23.6,-4590.9 121.6,-4590.9 121.6,-4631.9"/>
<text text-anchor="middle" x="72.6" y="-4619.9" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="72.6" y="-4608.9" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="72.6" y="-4597.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu6 -->
<g id="edge194" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu6</title>
<path fill="none" stroke="black" d="M94.6,-4667.67C91.11,-4658.9 87.48,-4649.78 84.2,-4641.54"/>
<polygon fill="black" stroke="black" points="87.35,-4640.01 80.41,-4632.01 80.85,-4642.59 87.35,-4640.01"/>
</g>
<!-- layer_12_residual1 -->
<g id="node175" class="node">
<title>layer_12_residual1</title>
<polygon fill="lightyellow" stroke="black" points="188.54,-4389.9 66.15,-4389.9 34.66,-4329.9 157.06,-4329.9 188.54,-4389.9"/>
<text text-anchor="middle" x="111.6" y="-4362.9" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="111.6" y="-4351.9" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_residual1 -->
<g id="edge198" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_residual1</title>
<path fill="none" stroke="black" d="M123.25,-4667.65C126.28,-4656.22 129.08,-4643.67 130.6,-4631.9 135.39,-4594.92 147.41,-4554.01 129.6,-4425.9 128.41,-4417.31 126.4,-4408.25 124.15,-4399.72"/>
<polygon fill="black" stroke="black" points="127.49,-4398.68 121.43,-4390 120.75,-4400.57 127.49,-4398.68"/>
</g>
<!-- layer_12_attention -->
<g id="node173" class="node">
<title>layer_12_attention</title>
<polygon fill="lightblue" stroke="black" points="107.6,-4554.9 39.6,-4554.9 39.6,-4502.9 107.6,-4502.9 107.6,-4554.9"/>
<text text-anchor="middle" x="73.6" y="-4542.9" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="73.6" y="-4531.9" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="73.6" y="-4520.9" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="73.6" y="-4509.9" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_12_qkv_gpu6&#45;&gt;layer_12_attention -->
<g id="edge195" class="edge">
<title>layer_12_qkv_gpu6&#45;&gt;layer_12_attention</title>
<path fill="none" stroke="black" d="M72.85,-4590.5C72.94,-4582.88 73.05,-4573.95 73.16,-4565.32"/>
<polygon fill="black" stroke="black" points="76.66,-4565.09 73.29,-4555.05 69.67,-4565.01 76.66,-4565.09"/>
</g>
<!-- layer_12_attn_out_gpu6 -->
<g id="node174" class="node">
<title>layer_12_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="121.1,-4466.9 28.1,-4466.9 28.1,-4425.9 121.1,-4425.9 121.1,-4466.9"/>
<text text-anchor="middle" x="74.6" y="-4454.9" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="74.6" y="-4443.9" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="74.6" y="-4432.9" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attention&#45;&gt;layer_12_attn_out_gpu6 -->
<g id="edge196" class="edge">
<title>layer_12_attention&#45;&gt;layer_12_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M73.91,-4502.87C74.01,-4494.75 74.13,-4485.67 74.23,-4477.25"/>
<polygon fill="black" stroke="black" points="77.73,-4477.09 74.36,-4467.04 70.73,-4477 77.73,-4477.09"/>
</g>
<!-- layer_12_attn_out_gpu6&#45;&gt;layer_12_residual1 -->
<g id="edge197" class="edge">
<title>layer_12_attn_out_gpu6&#45;&gt;layer_12_residual1</title>
<path fill="none" stroke="black" d="M83.18,-4425.8C86.64,-4417.91 90.75,-4408.53 94.75,-4399.38"/>
<polygon fill="black" stroke="black" points="98.05,-4400.57 98.86,-4390.01 91.64,-4397.76 98.05,-4400.57"/>
</g>
<!-- layer_12_ln1 -->
<g id="node176" class="node">
<title>layer_12_ln1</title>
<polygon fill="lightblue" stroke="black" points="109.1,-4293.9 36.1,-4293.9 36.1,-4252.9 109.1,-4252.9 109.1,-4293.9"/>
<text text-anchor="middle" x="72.6" y="-4281.9" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="72.6" y="-4270.9" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="72.6" y="-4259.9" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_12_residual1&#45;&gt;layer_12_ln1 -->
<g id="edge199" class="edge">
<title>layer_12_residual1&#45;&gt;layer_12_ln1</title>
<path fill="none" stroke="black" d="M98.18,-4329.82C94.21,-4321.21 89.87,-4311.8 85.9,-4303.22"/>
<polygon fill="black" stroke="black" points="89,-4301.57 81.63,-4293.96 82.64,-4304.51 89,-4301.57"/>
</g>
<!-- layer_12_residual2 -->
<g id="node180" class="node">
<title>layer_12_residual2</title>
<polygon fill="lightyellow" stroke="black" points="182.54,-3990.9 60.15,-3990.9 28.66,-3930.9 151.06,-3930.9 182.54,-3990.9"/>
<text text-anchor="middle" x="105.6" y="-3963.9" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="105.6" y="-3952.9" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_12_residual1&#45;&gt;layer_12_residual2 -->
<g id="edge204" class="edge">
<title>layer_12_residual1&#45;&gt;layer_12_residual2</title>
<path fill="none" stroke="black" d="M121.24,-4329.79C130.98,-4297.73 144.6,-4244.47 144.6,-4197.4 144.6,-4197.4 144.6,-4197.4 144.6,-4120.9 144.6,-4078.96 131.65,-4032.56 120.67,-4000.76"/>
<polygon fill="black" stroke="black" points="123.84,-3999.22 117.2,-3990.97 117.25,-4001.56 123.84,-3999.22"/>
</g>
<!-- layer_12_mlp_fc1_gpu6 -->
<g id="node177" class="node">
<title>layer_12_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="116.1,-4216.9 17.1,-4216.9 17.1,-4175.9 116.1,-4175.9 116.1,-4216.9"/>
<text text-anchor="middle" x="66.6" y="-4204.9" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="66.6" y="-4193.9" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="66.6" y="-4182.9" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu6 -->
<g id="edge200" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M71.03,-4252.69C70.4,-4244.85 69.66,-4235.67 68.97,-4227.06"/>
<polygon fill="black" stroke="black" points="72.45,-4226.66 68.17,-4216.97 65.48,-4227.22 72.45,-4226.66"/>
</g>
<!-- layer_12_gelu -->
<g id="node178" class="node">
<title>layer_12_gelu</title>
<polygon fill="lightblue" stroke="black" points="111.1,-4139.9 22.1,-4139.9 22.1,-4103.9 111.1,-4103.9 111.1,-4139.9"/>
<text text-anchor="middle" x="66.6" y="-4124.9" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="66.6" y="-4113.9" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_12_mlp_fc1_gpu6&#45;&gt;layer_12_gelu -->
<g id="edge201" class="edge">
<title>layer_12_mlp_fc1_gpu6&#45;&gt;layer_12_gelu</title>
<path fill="none" stroke="black" d="M66.6,-4175.59C66.6,-4167.8 66.6,-4158.74 66.6,-4150.34"/>
<polygon fill="black" stroke="black" points="70.1,-4150.22 66.6,-4140.22 63.1,-4150.22 70.1,-4150.22"/>
</g>
<!-- layer_12_mlp_fc2_gpu6 -->
<g id="node179" class="node">
<title>layer_12_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="116.1,-4067.9 17.1,-4067.9 17.1,-4026.9 116.1,-4026.9 116.1,-4067.9"/>
<text text-anchor="middle" x="66.6" y="-4055.9" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="66.6" y="-4044.9" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="66.6" y="-4033.9" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu6 -->
<g id="edge202" class="edge">
<title>layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu6</title>
<path fill="none" stroke="black" d="M66.6,-4103.72C66.6,-4096.09 66.6,-4086.9 66.6,-4078.22"/>
<polygon fill="black" stroke="black" points="70.1,-4078.02 66.6,-4068.02 63.1,-4078.02 70.1,-4078.02"/>
</g>
<!-- layer_12_mlp_fc2_gpu6&#45;&gt;layer_12_residual2 -->
<g id="edge203" class="edge">
<title>layer_12_mlp_fc2_gpu6&#45;&gt;layer_12_residual2</title>
<path fill="none" stroke="black" d="M75.65,-4026.8C79.33,-4018.83 83.71,-4009.33 87.97,-4000.09"/>
<polygon fill="black" stroke="black" points="91.15,-4001.55 92.17,-3991.01 84.8,-3998.62 91.15,-4001.55"/>
</g>
<!-- layer_12_ln2 -->
<g id="node181" class="node">
<title>layer_12_ln2</title>
<polygon fill="lightblue" stroke="black" points="142.1,-3894.9 69.1,-3894.9 69.1,-3853.9 142.1,-3853.9 142.1,-3894.9"/>
<text text-anchor="middle" x="105.6" y="-3882.9" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="105.6" y="-3871.9" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="105.6" y="-3860.9" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_12_residual2&#45;&gt;layer_12_ln2 -->
<g id="edge205" class="edge">
<title>layer_12_residual2&#45;&gt;layer_12_ln2</title>
<path fill="none" stroke="black" d="M105.6,-3930.82C105.6,-3922.49 105.6,-3913.41 105.6,-3905.05"/>
<polygon fill="black" stroke="black" points="109.1,-3904.96 105.6,-3894.96 102.1,-3904.96 109.1,-3904.96"/>
</g>
<!-- layer_12_output_dist -->
<g id="node182" class="node">
<title>layer_12_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="207.31,-3817.9 45.52,-3817.9 3.9,-3735.9 165.69,-3735.9 207.31,-3817.9"/>
<text text-anchor="middle" x="105.6" y="-3785.4" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="105.6" y="-3774.4" font-family="Arial" font-size="10.00">Output Distribution</text>
<text text-anchor="middle" x="105.6" y="-3763.4" font-family="Arial" font-size="10.00">GPU 6→6</text>
</g>
<!-- layer_12_ln2&#45;&gt;layer_12_output_dist -->
<g id="edge206" class="edge">
<title>layer_12_ln2&#45;&gt;layer_12_output_dist</title>
<path fill="none" stroke="black" d="M105.6,-3853.61C105.6,-3846.15 105.6,-3837.28 105.6,-3828.28"/>
<polygon fill="black" stroke="black" points="109.1,-3828.14 105.6,-3818.14 102.1,-3828.14 109.1,-3828.14"/>
</g>
<!-- layer_12_pipeline_send -->
<g id="node183" class="node">
<title>layer_12_pipeline_send</title>
<ellipse fill="red" stroke="black" cx="105.6" cy="-3670.91" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="105.6" y="-3679.41" font-family="Arial" font-size="10.00">Layer 12→13</text>
<text text-anchor="middle" x="105.6" y="-3668.41" font-family="Arial" font-size="10.00">Pipeline Send</text>
<text text-anchor="middle" x="105.6" y="-3657.41" font-family="Arial" font-size="10.00">GPU 6→6</text>
</g>
<!-- layer_12_output_dist&#45;&gt;layer_12_pipeline_send -->
<g id="edge207" class="edge">
<title>layer_12_output_dist&#45;&gt;layer_12_pipeline_send</title>
<path fill="none" stroke="black" d="M105.6,-3735.69C105.6,-3727.33 105.6,-3718.54 105.6,-3710.25"/>
<polygon fill="black" stroke="black" points="109.1,-3710.09 105.6,-3700.09 102.1,-3710.09 109.1,-3710.09"/>
</g>
<!-- layer_13_pipeline_recv -->
<g id="node184" class="node">
<title>layer_13_pipeline_recv</title>
<ellipse fill="red" stroke="black" cx="105.6" cy="-3576.92" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="105.6" y="-3585.42" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="105.6" y="-3574.42" font-family="Arial" font-size="10.00">Pipeline Recv</text>
<text text-anchor="middle" x="105.6" y="-3563.42" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_12_pipeline_send&#45;&gt;layer_13_pipeline_recv -->
<g id="edge208" class="edge">
<title>layer_12_pipeline_send&#45;&gt;layer_13_pipeline_recv</title>
<path fill="none" stroke="black" d="M105.6,-3641.81C105.6,-3633.77 105.6,-3624.87 105.6,-3616.32"/>
<polygon fill="black" stroke="black" points="109.1,-3616.16 105.6,-3606.16 102.1,-3616.16 109.1,-3616.16"/>
</g>
<!-- layer_13_input_dist -->
<g id="node185" class="node">
<title>layer_13_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="199.79,-3511.93 49.96,-3511.93 11.41,-3429.93 161.25,-3429.93 199.79,-3511.93"/>
<text text-anchor="middle" x="105.6" y="-3479.43" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="105.6" y="-3468.43" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="105.6" y="-3457.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_13_pipeline_recv&#45;&gt;layer_13_input_dist -->
<g id="edge209" class="edge">
<title>layer_13_pipeline_recv&#45;&gt;layer_13_input_dist</title>
<path fill="none" stroke="black" d="M105.6,-3547.78C105.6,-3539.91 105.6,-3531.11 105.6,-3522.37"/>
<polygon fill="black" stroke="black" points="109.1,-3522.2 105.6,-3512.2 102.1,-3522.2 109.1,-3522.2"/>
</g>
<!-- layer_13_qkv_gpu6 -->
<g id="node186" class="node">
<title>layer_13_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="116.6,-3393.93 18.6,-3393.93 18.6,-3352.93 116.6,-3352.93 116.6,-3393.93"/>
<text text-anchor="middle" x="67.6" y="-3381.93" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="67.6" y="-3370.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="67.6" y="-3359.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu6 -->
<g id="edge210" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu6</title>
<path fill="none" stroke="black" d="M89.6,-3429.71C86.11,-3420.94 82.48,-3411.82 79.2,-3403.58"/>
<polygon fill="black" stroke="black" points="82.35,-3402.04 75.41,-3394.04 75.85,-3404.63 82.35,-3402.04"/>
</g>
<!-- layer_13_residual1 -->
<g id="node189" class="node">
<title>layer_13_residual1</title>
<polygon fill="lightyellow" stroke="black" points="183.54,-3151.93 61.15,-3151.93 29.66,-3091.93 152.06,-3091.93 183.54,-3151.93"/>
<text text-anchor="middle" x="106.6" y="-3124.93" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="106.6" y="-3113.93" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_residual1 -->
<g id="edge214" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_residual1</title>
<path fill="none" stroke="black" d="M118.25,-3429.69C121.28,-3418.25 124.08,-3405.7 125.6,-3393.93 130.5,-3356.1 140.41,-3312.65 123.6,-3187.93 122.45,-3179.37 120.54,-3170.33 118.41,-3161.8"/>
<polygon fill="black" stroke="black" points="121.78,-3160.85 115.84,-3152.07 115.01,-3162.64 121.78,-3160.85"/>
</g>
<!-- layer_13_attention -->
<g id="node187" class="node">
<title>layer_13_attention</title>
<polygon fill="lightblue" stroke="black" points="102.6,-3316.93 34.6,-3316.93 34.6,-3264.93 102.6,-3264.93 102.6,-3316.93"/>
<text text-anchor="middle" x="68.6" y="-3304.93" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="68.6" y="-3293.93" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="68.6" y="-3282.93" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="68.6" y="-3271.93" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_13_qkv_gpu6&#45;&gt;layer_13_attention -->
<g id="edge211" class="edge">
<title>layer_13_qkv_gpu6&#45;&gt;layer_13_attention</title>
<path fill="none" stroke="black" d="M67.85,-3352.53C67.94,-3344.92 68.05,-3335.99 68.16,-3327.36"/>
<polygon fill="black" stroke="black" points="71.66,-3327.13 68.29,-3317.09 64.67,-3327.04 71.66,-3327.13"/>
</g>
<!-- layer_13_attn_out_gpu6 -->
<g id="node188" class="node">
<title>layer_13_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="115.1,-3228.93 22.1,-3228.93 22.1,-3187.93 115.1,-3187.93 115.1,-3228.93"/>
<text text-anchor="middle" x="68.6" y="-3216.93" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="68.6" y="-3205.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="68.6" y="-3194.93" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attention&#45;&gt;layer_13_attn_out_gpu6 -->
<g id="edge212" class="edge">
<title>layer_13_attention&#45;&gt;layer_13_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M68.6,-3264.9C68.6,-3256.79 68.6,-3247.71 68.6,-3239.28"/>
<polygon fill="black" stroke="black" points="72.1,-3239.08 68.6,-3229.08 65.1,-3239.08 72.1,-3239.08"/>
</g>
<!-- layer_13_attn_out_gpu6&#45;&gt;layer_13_residual1 -->
<g id="edge213" class="edge">
<title>layer_13_attn_out_gpu6&#45;&gt;layer_13_residual1</title>
<path fill="none" stroke="black" d="M77.42,-3187.83C80.96,-3179.94 85.18,-3170.56 89.3,-3161.41"/>
<polygon fill="black" stroke="black" points="92.6,-3162.6 93.51,-3152.04 86.22,-3159.73 92.6,-3162.6"/>
</g>
<!-- layer_13_ln1 -->
<g id="node190" class="node">
<title>layer_13_ln1</title>
<polygon fill="lightblue" stroke="black" points="111.1,-3055.93 38.1,-3055.93 38.1,-3014.93 111.1,-3014.93 111.1,-3055.93"/>
<text text-anchor="middle" x="74.6" y="-3043.93" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="74.6" y="-3032.93" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="74.6" y="-3021.93" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_13_residual1&#45;&gt;layer_13_ln1 -->
<g id="edge215" class="edge">
<title>layer_13_residual1&#45;&gt;layer_13_ln1</title>
<path fill="none" stroke="black" d="M95.59,-3091.85C92.37,-3083.34 88.84,-3074.04 85.62,-3065.53"/>
<polygon fill="black" stroke="black" points="88.83,-3064.11 82.01,-3056 82.28,-3066.59 88.83,-3064.11"/>
</g>
<!-- layer_13_residual2 -->
<g id="node194" class="node">
<title>layer_13_residual2</title>
<polygon fill="lightyellow" stroke="black" points="183.54,-2752.93 61.15,-2752.93 29.66,-2692.93 152.06,-2692.93 183.54,-2752.93"/>
<text text-anchor="middle" x="106.6" y="-2725.93" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="106.6" y="-2714.93" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_13_residual1&#45;&gt;layer_13_residual2 -->
<g id="edge220" class="edge">
<title>layer_13_residual1&#45;&gt;layer_13_residual2</title>
<path fill="none" stroke="black" d="M118.09,-3091.68C129.6,-3059.71 145.6,-3006.74 145.6,-2959.43 145.6,-2959.43 145.6,-2959.43 145.6,-2882.93 145.6,-2841 132.65,-2794.59 121.67,-2762.79"/>
<polygon fill="black" stroke="black" points="124.84,-2761.26 118.2,-2753 118.25,-2763.6 124.84,-2761.26"/>
</g>
<!-- layer_13_mlp_fc1_gpu6 -->
<g id="node191" class="node">
<title>layer_13_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="117.1,-2978.93 18.1,-2978.93 18.1,-2937.93 117.1,-2937.93 117.1,-2978.93"/>
<text text-anchor="middle" x="67.6" y="-2966.93" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="67.6" y="-2955.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="67.6" y="-2944.93" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu6 -->
<g id="edge216" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M72.76,-3014.73C72.03,-3006.89 71.17,-2997.7 70.37,-2989.09"/>
<polygon fill="black" stroke="black" points="73.84,-2988.64 69.43,-2979 66.87,-2989.29 73.84,-2988.64"/>
</g>
<!-- layer_13_gelu -->
<g id="node192" class="node">
<title>layer_13_gelu</title>
<polygon fill="lightblue" stroke="black" points="112.1,-2901.93 23.1,-2901.93 23.1,-2865.93 112.1,-2865.93 112.1,-2901.93"/>
<text text-anchor="middle" x="67.6" y="-2886.93" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="67.6" y="-2875.93" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_13_mlp_fc1_gpu6&#45;&gt;layer_13_gelu -->
<g id="edge217" class="edge">
<title>layer_13_mlp_fc1_gpu6&#45;&gt;layer_13_gelu</title>
<path fill="none" stroke="black" d="M67.6,-2937.62C67.6,-2929.84 67.6,-2920.77 67.6,-2912.38"/>
<polygon fill="black" stroke="black" points="71.1,-2912.25 67.6,-2902.25 64.1,-2912.25 71.1,-2912.25"/>
</g>
<!-- layer_13_mlp_fc2_gpu6 -->
<g id="node193" class="node">
<title>layer_13_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="117.1,-2829.93 18.1,-2829.93 18.1,-2788.93 117.1,-2788.93 117.1,-2829.93"/>
<text text-anchor="middle" x="67.6" y="-2817.93" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="67.6" y="-2806.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="67.6" y="-2795.93" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu6 -->
<g id="edge218" class="edge">
<title>layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu6</title>
<path fill="none" stroke="black" d="M67.6,-2865.75C67.6,-2858.13 67.6,-2848.94 67.6,-2840.25"/>
<polygon fill="black" stroke="black" points="71.1,-2840.05 67.6,-2830.05 64.1,-2840.05 71.1,-2840.05"/>
</g>
<!-- layer_13_mlp_fc2_gpu6&#45;&gt;layer_13_residual2 -->
<g id="edge219" class="edge">
<title>layer_13_mlp_fc2_gpu6&#45;&gt;layer_13_residual2</title>
<path fill="none" stroke="black" d="M76.65,-2788.83C80.33,-2780.86 84.71,-2771.36 88.97,-2762.13"/>
<polygon fill="black" stroke="black" points="92.15,-2763.59 93.17,-2753.04 85.8,-2760.65 92.15,-2763.59"/>
</g>
<!-- layer_13_ln2 -->
<g id="node195" class="node">
<title>layer_13_ln2</title>
<polygon fill="lightblue" stroke="black" points="143.1,-2656.93 70.1,-2656.93 70.1,-2615.93 143.1,-2615.93 143.1,-2656.93"/>
<text text-anchor="middle" x="106.6" y="-2644.93" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="106.6" y="-2633.93" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="106.6" y="-2622.93" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_13_residual2&#45;&gt;layer_13_ln2 -->
<g id="edge221" class="edge">
<title>layer_13_residual2&#45;&gt;layer_13_ln2</title>
<path fill="none" stroke="black" d="M106.6,-2692.85C106.6,-2684.53 106.6,-2675.44 106.6,-2667.09"/>
<polygon fill="black" stroke="black" points="110.1,-2667 106.6,-2657 103.1,-2667 110.1,-2667"/>
</g>
<!-- layer_13_output_dist -->
<g id="node196" class="node">
<title>layer_13_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="208.31,-2579.93 46.52,-2579.93 4.9,-2497.93 166.69,-2497.93 208.31,-2579.93"/>
<text text-anchor="middle" x="106.6" y="-2547.43" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="106.6" y="-2536.43" font-family="Arial" font-size="10.00">Output Distribution</text>
<text text-anchor="middle" x="106.6" y="-2525.43" font-family="Arial" font-size="10.00">GPU 6→7</text>
</g>
<!-- layer_13_ln2&#45;&gt;layer_13_output_dist -->
<g id="edge222" class="edge">
<title>layer_13_ln2&#45;&gt;layer_13_output_dist</title>
<path fill="none" stroke="black" d="M106.6,-2615.64C106.6,-2608.18 106.6,-2599.31 106.6,-2590.32"/>
<polygon fill="black" stroke="black" points="110.1,-2590.18 106.6,-2580.18 103.1,-2590.18 110.1,-2590.18"/>
</g>
<!-- layer_13_pipeline_send -->
<g id="node197" class="node">
<title>layer_13_pipeline_send</title>
<ellipse fill="red" stroke="black" cx="106.6" cy="-2432.94" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="106.6" y="-2441.44" font-family="Arial" font-size="10.00">Layer 13→14</text>
<text text-anchor="middle" x="106.6" y="-2430.44" font-family="Arial" font-size="10.00">Pipeline Send</text>
<text text-anchor="middle" x="106.6" y="-2419.44" font-family="Arial" font-size="10.00">GPU 6→7</text>
</g>
<!-- layer_13_output_dist&#45;&gt;layer_13_pipeline_send -->
<g id="edge223" class="edge">
<title>layer_13_output_dist&#45;&gt;layer_13_pipeline_send</title>
<path fill="none" stroke="black" d="M106.6,-2497.73C106.6,-2489.37 106.6,-2480.58 106.6,-2472.29"/>
<polygon fill="black" stroke="black" points="110.1,-2472.12 106.6,-2462.12 103.1,-2472.12 110.1,-2472.12"/>
</g>
<!-- layer_14_pipeline_recv -->
<g id="node198" class="node">
<title>layer_14_pipeline_recv</title>
<ellipse fill="red" stroke="black" cx="106.6" cy="-2338.96" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="106.6" y="-2347.46" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="106.6" y="-2336.46" font-family="Arial" font-size="10.00">Pipeline Recv</text>
<text text-anchor="middle" x="106.6" y="-2325.46" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_13_pipeline_send&#45;&gt;layer_14_pipeline_recv -->
<g id="edge224" class="edge">
<title>layer_13_pipeline_send&#45;&gt;layer_14_pipeline_recv</title>
<path fill="none" stroke="black" d="M106.6,-2403.84C106.6,-2395.8 106.6,-2386.9 106.6,-2378.36"/>
<polygon fill="black" stroke="black" points="110.1,-2378.2 106.6,-2368.2 103.1,-2378.2 110.1,-2378.2"/>
</g>
<!-- layer_14_input_dist -->
<g id="node199" class="node">
<title>layer_14_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="200.79,-2273.97 50.96,-2273.97 12.41,-2191.97 162.25,-2191.97 200.79,-2273.97"/>
<text text-anchor="middle" x="106.6" y="-2241.47" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="106.6" y="-2230.47" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="106.6" y="-2219.47" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_14_pipeline_recv&#45;&gt;layer_14_input_dist -->
<g id="edge225" class="edge">
<title>layer_14_pipeline_recv&#45;&gt;layer_14_input_dist</title>
<path fill="none" stroke="black" d="M106.6,-2309.82C106.6,-2301.95 106.6,-2293.15 106.6,-2284.41"/>
<polygon fill="black" stroke="black" points="110.1,-2284.23 106.6,-2274.23 103.1,-2284.23 110.1,-2284.23"/>
</g>
<!-- layer_14_qkv_gpu7 -->
<g id="node200" class="node">
<title>layer_14_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="117.6,-2155.97 19.6,-2155.97 19.6,-2114.97 117.6,-2114.97 117.6,-2155.97"/>
<text text-anchor="middle" x="68.6" y="-2143.97" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="68.6" y="-2132.97" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="68.6" y="-2121.97" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu7 -->
<g id="edge226" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu7</title>
<path fill="none" stroke="black" d="M90.6,-2191.74C87.11,-2182.97 83.48,-2173.85 80.2,-2165.61"/>
<polygon fill="black" stroke="black" points="83.35,-2164.07 76.41,-2156.08 76.85,-2166.66 83.35,-2164.07"/>
</g>
<!-- layer_14_residual1 -->
<g id="node203" class="node">
<title>layer_14_residual1</title>
<polygon fill="lightyellow" stroke="black" points="184.54,-1913.97 62.15,-1913.97 30.66,-1853.97 153.06,-1853.97 184.54,-1913.97"/>
<text text-anchor="middle" x="107.6" y="-1886.97" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="107.6" y="-1875.97" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_residual1 -->
<g id="edge230" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_residual1</title>
<path fill="none" stroke="black" d="M119.25,-2191.72C122.28,-2180.29 125.08,-2167.74 126.6,-2155.97 131.5,-2118.14 141.41,-2074.69 124.6,-1949.97 123.45,-1941.41 121.54,-1932.36 119.41,-1923.83"/>
<polygon fill="black" stroke="black" points="122.78,-1922.88 116.84,-1914.11 116.01,-1924.67 122.78,-1922.88"/>
</g>
<!-- layer_14_attention -->
<g id="node201" class="node">
<title>layer_14_attention</title>
<polygon fill="lightblue" stroke="black" points="103.6,-2078.97 35.6,-2078.97 35.6,-2026.97 103.6,-2026.97 103.6,-2078.97"/>
<text text-anchor="middle" x="69.6" y="-2066.97" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="69.6" y="-2055.97" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="69.6" y="-2044.97" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="69.6" y="-2033.97" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_14_qkv_gpu7&#45;&gt;layer_14_attention -->
<g id="edge227" class="edge">
<title>layer_14_qkv_gpu7&#45;&gt;layer_14_attention</title>
<path fill="none" stroke="black" d="M68.85,-2114.57C68.94,-2106.95 69.05,-2098.02 69.16,-2089.39"/>
<polygon fill="black" stroke="black" points="72.66,-2089.16 69.29,-2079.12 65.67,-2089.08 72.66,-2089.16"/>
</g>
<!-- layer_14_attn_out_gpu7 -->
<g id="node202" class="node">
<title>layer_14_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="116.1,-1990.97 23.1,-1990.97 23.1,-1949.97 116.1,-1949.97 116.1,-1990.97"/>
<text text-anchor="middle" x="69.6" y="-1978.97" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="69.6" y="-1967.97" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="69.6" y="-1956.97" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attention&#45;&gt;layer_14_attn_out_gpu7 -->
<g id="edge228" class="edge">
<title>layer_14_attention&#45;&gt;layer_14_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M69.6,-2026.94C69.6,-2018.82 69.6,-2009.74 69.6,-2001.31"/>
<polygon fill="black" stroke="black" points="73.1,-2001.11 69.6,-1991.11 66.1,-2001.11 73.1,-2001.11"/>
</g>
<!-- layer_14_attn_out_gpu7&#45;&gt;layer_14_residual1 -->
<g id="edge229" class="edge">
<title>layer_14_attn_out_gpu7&#45;&gt;layer_14_residual1</title>
<path fill="none" stroke="black" d="M78.42,-1949.87C81.96,-1941.98 86.18,-1932.59 90.3,-1923.45"/>
<polygon fill="black" stroke="black" points="93.6,-1924.63 94.51,-1914.08 87.22,-1921.76 93.6,-1924.63"/>
</g>
<!-- layer_14_ln1 -->
<g id="node204" class="node">
<title>layer_14_ln1</title>
<polygon fill="lightblue" stroke="black" points="105.1,-1817.97 32.1,-1817.97 32.1,-1776.97 105.1,-1776.97 105.1,-1817.97"/>
<text text-anchor="middle" x="68.6" y="-1805.97" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="68.6" y="-1794.97" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="68.6" y="-1783.97" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_14_residual1&#45;&gt;layer_14_ln1 -->
<g id="edge231" class="edge">
<title>layer_14_residual1&#45;&gt;layer_14_ln1</title>
<path fill="none" stroke="black" d="M94.18,-1853.89C90.21,-1845.28 85.87,-1835.87 81.9,-1827.29"/>
<polygon fill="black" stroke="black" points="85,-1825.64 77.63,-1818.03 78.64,-1828.58 85,-1825.64"/>
</g>
<!-- layer_14_residual2 -->
<g id="node208" class="node">
<title>layer_14_residual2</title>
<polygon fill="lightyellow" stroke="black" points="178.54,-1514.97 56.15,-1514.97 24.66,-1454.97 147.06,-1454.97 178.54,-1514.97"/>
<text text-anchor="middle" x="101.6" y="-1487.97" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="101.6" y="-1476.97" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_14_residual1&#45;&gt;layer_14_residual2 -->
<g id="edge236" class="edge">
<title>layer_14_residual1&#45;&gt;layer_14_residual2</title>
<path fill="none" stroke="black" d="M117.24,-1853.86C126.98,-1821.8 140.6,-1768.54 140.6,-1721.47 140.6,-1721.47 140.6,-1721.47 140.6,-1644.97 140.6,-1603.03 127.65,-1556.62 116.67,-1524.83"/>
<polygon fill="black" stroke="black" points="119.84,-1523.29 113.2,-1515.04 113.25,-1525.63 119.84,-1523.29"/>
</g>
<!-- layer_14_mlp_fc1_gpu7 -->
<g id="node205" class="node">
<title>layer_14_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="112.1,-1740.97 13.1,-1740.97 13.1,-1699.97 112.1,-1699.97 112.1,-1740.97"/>
<text text-anchor="middle" x="62.6" y="-1728.97" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="62.6" y="-1717.97" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="62.6" y="-1706.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu7 -->
<g id="edge232" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M67.03,-1776.76C66.4,-1768.92 65.66,-1759.74 64.97,-1751.13"/>
<polygon fill="black" stroke="black" points="68.45,-1750.73 64.17,-1741.04 61.48,-1751.29 68.45,-1750.73"/>
</g>
<!-- layer_14_gelu -->
<g id="node206" class="node">
<title>layer_14_gelu</title>
<polygon fill="lightblue" stroke="black" points="107.1,-1663.97 18.1,-1663.97 18.1,-1627.97 107.1,-1627.97 107.1,-1663.97"/>
<text text-anchor="middle" x="62.6" y="-1648.97" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="62.6" y="-1637.97" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_14_mlp_fc1_gpu7&#45;&gt;layer_14_gelu -->
<g id="edge233" class="edge">
<title>layer_14_mlp_fc1_gpu7&#45;&gt;layer_14_gelu</title>
<path fill="none" stroke="black" d="M62.6,-1699.65C62.6,-1691.87 62.6,-1682.81 62.6,-1674.41"/>
<polygon fill="black" stroke="black" points="66.1,-1674.28 62.6,-1664.28 59.1,-1674.29 66.1,-1674.28"/>
</g>
<!-- layer_14_mlp_fc2_gpu7 -->
<g id="node207" class="node">
<title>layer_14_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="112.1,-1591.97 13.1,-1591.97 13.1,-1550.97 112.1,-1550.97 112.1,-1591.97"/>
<text text-anchor="middle" x="62.6" y="-1579.97" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="62.6" y="-1568.97" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="62.6" y="-1557.97" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu7 -->
<g id="edge234" class="edge">
<title>layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu7</title>
<path fill="none" stroke="black" d="M62.6,-1627.78C62.6,-1620.16 62.6,-1610.97 62.6,-1602.29"/>
<polygon fill="black" stroke="black" points="66.1,-1602.09 62.6,-1592.09 59.1,-1602.09 66.1,-1602.09"/>
</g>
<!-- layer_14_mlp_fc2_gpu7&#45;&gt;layer_14_residual2 -->
<g id="edge235" class="edge">
<title>layer_14_mlp_fc2_gpu7&#45;&gt;layer_14_residual2</title>
<path fill="none" stroke="black" d="M71.65,-1550.87C75.33,-1542.9 79.71,-1533.4 83.97,-1524.16"/>
<polygon fill="black" stroke="black" points="87.15,-1525.62 88.17,-1515.08 80.8,-1522.69 87.15,-1525.62"/>
</g>
<!-- layer_14_ln2 -->
<g id="node209" class="node">
<title>layer_14_ln2</title>
<polygon fill="lightblue" stroke="black" points="138.1,-1418.97 65.1,-1418.97 65.1,-1377.97 138.1,-1377.97 138.1,-1418.97"/>
<text text-anchor="middle" x="101.6" y="-1406.97" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="101.6" y="-1395.97" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="101.6" y="-1384.97" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_14_residual2&#45;&gt;layer_14_ln2 -->
<g id="edge237" class="edge">
<title>layer_14_residual2&#45;&gt;layer_14_ln2</title>
<path fill="none" stroke="black" d="M101.6,-1454.89C101.6,-1446.56 101.6,-1437.48 101.6,-1429.12"/>
<polygon fill="black" stroke="black" points="105.1,-1429.03 101.6,-1419.03 98.1,-1429.03 105.1,-1429.03"/>
</g>
<!-- layer_14_output_dist -->
<g id="node210" class="node">
<title>layer_14_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="203.31,-1341.97 41.52,-1341.97 -0.1,-1259.97 161.69,-1259.97 203.31,-1341.97"/>
<text text-anchor="middle" x="101.6" y="-1309.47" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="101.6" y="-1298.47" font-family="Arial" font-size="10.00">Output Distribution</text>
<text text-anchor="middle" x="101.6" y="-1287.47" font-family="Arial" font-size="10.00">GPU 7→7</text>
</g>
<!-- layer_14_ln2&#45;&gt;layer_14_output_dist -->
<g id="edge238" class="edge">
<title>layer_14_ln2&#45;&gt;layer_14_output_dist</title>
<path fill="none" stroke="black" d="M101.6,-1377.68C101.6,-1370.22 101.6,-1361.35 101.6,-1352.35"/>
<polygon fill="black" stroke="black" points="105.1,-1352.21 101.6,-1342.21 98.1,-1352.21 105.1,-1352.21"/>
</g>
<!-- layer_14_pipeline_send -->
<g id="node211" class="node">
<title>layer_14_pipeline_send</title>
<ellipse fill="red" stroke="black" cx="101.6" cy="-1194.97" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="101.6" y="-1203.47" font-family="Arial" font-size="10.00">Layer 14→15</text>
<text text-anchor="middle" x="101.6" y="-1192.47" font-family="Arial" font-size="10.00">Pipeline Send</text>
<text text-anchor="middle" x="101.6" y="-1181.47" font-family="Arial" font-size="10.00">GPU 7→7</text>
</g>
<!-- layer_14_output_dist&#45;&gt;layer_14_pipeline_send -->
<g id="edge239" class="edge">
<title>layer_14_output_dist&#45;&gt;layer_14_pipeline_send</title>
<path fill="none" stroke="black" d="M101.6,-1259.76C101.6,-1251.4 101.6,-1242.61 101.6,-1234.32"/>
<polygon fill="black" stroke="black" points="105.1,-1234.16 101.6,-1224.16 98.1,-1234.16 105.1,-1234.16"/>
</g>
<!-- layer_15_pipeline_recv -->
<g id="node212" class="node">
<title>layer_15_pipeline_recv</title>
<ellipse fill="red" stroke="black" cx="101.6" cy="-1100.99" rx="54.39" ry="28.98"/>
<text text-anchor="middle" x="101.6" y="-1109.49" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="101.6" y="-1098.49" font-family="Arial" font-size="10.00">Pipeline Recv</text>
<text text-anchor="middle" x="101.6" y="-1087.49" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_14_pipeline_send&#45;&gt;layer_15_pipeline_recv -->
<g id="edge240" class="edge">
<title>layer_14_pipeline_send&#45;&gt;layer_15_pipeline_recv</title>
<path fill="none" stroke="black" d="M101.6,-1165.88C101.6,-1157.84 101.6,-1148.94 101.6,-1140.39"/>
<polygon fill="black" stroke="black" points="105.1,-1140.23 101.6,-1130.23 98.1,-1140.23 105.1,-1140.23"/>
</g>
<!-- layer_15_input_dist -->
<g id="node213" class="node">
<title>layer_15_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="195.79,-1036 45.96,-1036 7.41,-954 157.25,-954 195.79,-1036"/>
<text text-anchor="middle" x="101.6" y="-1003.5" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="101.6" y="-992.5" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="101.6" y="-981.5" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_15_pipeline_recv&#45;&gt;layer_15_input_dist -->
<g id="edge241" class="edge">
<title>layer_15_pipeline_recv&#45;&gt;layer_15_input_dist</title>
<path fill="none" stroke="black" d="M101.6,-1071.85C101.6,-1063.98 101.6,-1055.18 101.6,-1046.44"/>
<polygon fill="black" stroke="black" points="105.1,-1046.27 101.6,-1036.27 98.1,-1046.27 105.1,-1046.27"/>
</g>
<!-- layer_15_qkv_gpu7 -->
<g id="node214" class="node">
<title>layer_15_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="112.6,-918 14.6,-918 14.6,-877 112.6,-877 112.6,-918"/>
<text text-anchor="middle" x="63.6" y="-906" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="63.6" y="-895" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="63.6" y="-884" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu7 -->
<g id="edge242" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu7</title>
<path fill="none" stroke="black" d="M85.6,-953.78C82.11,-945.01 78.48,-935.89 75.2,-927.65"/>
<polygon fill="black" stroke="black" points="78.35,-926.11 71.41,-918.11 71.85,-928.7 78.35,-926.11"/>
</g>
<!-- layer_15_residual1 -->
<g id="node217" class="node">
<title>layer_15_residual1</title>
<polygon fill="lightyellow" stroke="black" points="179.54,-676 57.15,-676 25.66,-616 148.06,-616 179.54,-676"/>
<text text-anchor="middle" x="102.6" y="-649" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="102.6" y="-638" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_residual1 -->
<g id="edge246" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_residual1</title>
<path fill="none" stroke="black" d="M114.25,-953.76C117.28,-942.32 120.08,-929.77 121.6,-918 126.39,-881.03 138.41,-840.12 120.6,-712 119.41,-703.41 117.4,-694.36 115.15,-685.82"/>
<polygon fill="black" stroke="black" points="118.49,-684.79 112.43,-676.1 111.75,-686.67 118.49,-684.79"/>
</g>
<!-- layer_15_attention -->
<g id="node215" class="node">
<title>layer_15_attention</title>
<polygon fill="lightblue" stroke="black" points="98.6,-841 30.6,-841 30.6,-789 98.6,-789 98.6,-841"/>
<text text-anchor="middle" x="64.6" y="-829" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="64.6" y="-818" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="64.6" y="-807" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="64.6" y="-796" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_15_qkv_gpu7&#45;&gt;layer_15_attention -->
<g id="edge243" class="edge">
<title>layer_15_qkv_gpu7&#45;&gt;layer_15_attention</title>
<path fill="none" stroke="black" d="M63.85,-876.6C63.94,-868.99 64.05,-860.06 64.16,-851.43"/>
<polygon fill="black" stroke="black" points="67.66,-851.2 64.29,-841.16 60.67,-851.11 67.66,-851.2"/>
</g>
<!-- layer_15_attn_out_gpu7 -->
<g id="node216" class="node">
<title>layer_15_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="112.1,-753 19.1,-753 19.1,-712 112.1,-712 112.1,-753"/>
<text text-anchor="middle" x="65.6" y="-741" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="65.6" y="-730" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="65.6" y="-719" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attention&#45;&gt;layer_15_attn_out_gpu7 -->
<g id="edge244" class="edge">
<title>layer_15_attention&#45;&gt;layer_15_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M64.91,-788.97C65.01,-780.86 65.13,-771.78 65.23,-763.35"/>
<polygon fill="black" stroke="black" points="68.73,-763.19 65.36,-753.15 61.73,-763.1 68.73,-763.19"/>
</g>
<!-- layer_15_attn_out_gpu7&#45;&gt;layer_15_residual1 -->
<g id="edge245" class="edge">
<title>layer_15_attn_out_gpu7&#45;&gt;layer_15_residual1</title>
<path fill="none" stroke="black" d="M74.18,-711.9C77.64,-704.01 81.75,-694.63 85.75,-685.48"/>
<polygon fill="black" stroke="black" points="89.05,-686.67 89.86,-676.11 82.64,-683.87 89.05,-686.67"/>
</g>
<!-- layer_15_ln1 -->
<g id="node218" class="node">
<title>layer_15_ln1</title>
<polygon fill="lightblue" stroke="black" points="107.1,-580 34.1,-580 34.1,-539 107.1,-539 107.1,-580"/>
<text text-anchor="middle" x="70.6" y="-568" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="70.6" y="-557" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="70.6" y="-546" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_15_residual1&#45;&gt;layer_15_ln1 -->
<g id="edge247" class="edge">
<title>layer_15_residual1&#45;&gt;layer_15_ln1</title>
<path fill="none" stroke="black" d="M91.59,-615.92C88.37,-607.41 84.84,-598.11 81.62,-589.6"/>
<polygon fill="black" stroke="black" points="84.83,-588.18 78.01,-580.07 78.28,-590.66 84.83,-588.18"/>
</g>
<!-- layer_15_residual2 -->
<g id="node222" class="node">
<title>layer_15_residual2</title>
<polygon fill="lightyellow" stroke="black" points="179.54,-277 57.15,-277 25.66,-217 148.06,-217 179.54,-277"/>
<text text-anchor="middle" x="102.6" y="-250" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="102.6" y="-239" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_15_residual1&#45;&gt;layer_15_residual2 -->
<g id="edge252" class="edge">
<title>layer_15_residual1&#45;&gt;layer_15_residual2</title>
<path fill="none" stroke="black" d="M114.09,-615.75C125.6,-583.78 141.6,-530.8 141.6,-483.5 141.6,-483.5 141.6,-483.5 141.6,-407 141.6,-365.07 128.65,-318.66 117.67,-286.86"/>
<polygon fill="black" stroke="black" points="120.84,-285.33 114.2,-277.07 114.25,-287.67 120.84,-285.33"/>
</g>
<!-- layer_15_mlp_fc1_gpu7 -->
<g id="node219" class="node">
<title>layer_15_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="113.1,-503 14.1,-503 14.1,-462 113.1,-462 113.1,-503"/>
<text text-anchor="middle" x="63.6" y="-491" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="63.6" y="-480" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="63.6" y="-469" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu7 -->
<g id="edge248" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M68.76,-538.79C68.03,-530.96 67.17,-521.77 66.37,-513.16"/>
<polygon fill="black" stroke="black" points="69.84,-512.71 65.43,-503.07 62.87,-513.36 69.84,-512.71"/>
</g>
<!-- layer_15_gelu -->
<g id="node220" class="node">
<title>layer_15_gelu</title>
<polygon fill="lightblue" stroke="black" points="108.1,-426 19.1,-426 19.1,-390 108.1,-390 108.1,-426"/>
<text text-anchor="middle" x="63.6" y="-411" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="63.6" y="-400" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_15_mlp_fc1_gpu7&#45;&gt;layer_15_gelu -->
<g id="edge249" class="edge">
<title>layer_15_mlp_fc1_gpu7&#45;&gt;layer_15_gelu</title>
<path fill="none" stroke="black" d="M63.6,-461.69C63.6,-453.91 63.6,-444.84 63.6,-436.45"/>
<polygon fill="black" stroke="black" points="67.1,-436.32 63.6,-426.32 60.1,-436.32 67.1,-436.32"/>
</g>
<!-- layer_15_mlp_fc2_gpu7 -->
<g id="node221" class="node">
<title>layer_15_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="113.1,-354 14.1,-354 14.1,-313 113.1,-313 113.1,-354"/>
<text text-anchor="middle" x="63.6" y="-342" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="63.6" y="-331" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="63.6" y="-320" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu7 -->
<g id="edge250" class="edge">
<title>layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu7</title>
<path fill="none" stroke="black" d="M63.6,-389.82C63.6,-382.2 63.6,-373 63.6,-364.32"/>
<polygon fill="black" stroke="black" points="67.1,-364.12 63.6,-354.12 60.1,-364.12 67.1,-364.12"/>
</g>
<!-- layer_15_mlp_fc2_gpu7&#45;&gt;layer_15_residual2 -->
<g id="edge251" class="edge">
<title>layer_15_mlp_fc2_gpu7&#45;&gt;layer_15_residual2</title>
<path fill="none" stroke="black" d="M72.65,-312.9C76.33,-304.93 80.71,-295.43 84.97,-286.19"/>
<polygon fill="black" stroke="black" points="88.15,-287.66 89.17,-277.11 81.8,-284.72 88.15,-287.66"/>
</g>
<!-- layer_15_ln2 -->
<g id="node223" class="node">
<title>layer_15_ln2</title>
<polygon fill="lightblue" stroke="black" points="139.1,-181 66.1,-181 66.1,-140 139.1,-140 139.1,-181"/>
<text text-anchor="middle" x="102.6" y="-169" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="102.6" y="-158" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="102.6" y="-147" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_15_residual2&#45;&gt;layer_15_ln2 -->
<g id="edge253" class="edge">
<title>layer_15_residual2&#45;&gt;layer_15_ln2</title>
<path fill="none" stroke="black" d="M102.6,-216.92C102.6,-208.6 102.6,-199.51 102.6,-191.15"/>
<polygon fill="black" stroke="black" points="106.1,-191.07 102.6,-181.07 99.1,-191.07 106.1,-191.07"/>
</g>
<!-- layer_15_ln2&#45;&gt;output -->
<g id="edge254" class="edge">
<title>layer_15_ln2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M102.6,-139.97C102.6,-132.56 102.6,-123.67 102.6,-114.45"/>
<polygon fill="black" stroke="black" points="106.1,-114.36 102.6,-104.36 99.1,-114.36 106.1,-114.36"/>
</g>
</g>
</svg>
