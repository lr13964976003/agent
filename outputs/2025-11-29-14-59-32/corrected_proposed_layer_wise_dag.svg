<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_layer_wise_tensor_pipeline_dag Pages: 1 -->
<svg width="2781pt" height="24672pt"
 viewBox="0.00 0.00 2780.50 24672.38" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 24668.38)">
<title>proposed_layer_wise_tensor_pipeline_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-24668.38 2776.5,-24668.38 2776.5,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="345.44,-24664.38 223.05,-24664.38 191.56,-24560.38 313.95,-24560.38 345.44,-24664.38"/>
<text text-anchor="middle" x="268.5" y="-24626.38" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="268.5" y="-24615.38" font-family="Arial" font-size="10.00">Batch: 128</text>
<text text-anchor="middle" x="268.5" y="-24604.38" font-family="Arial" font-size="10.00">Seq: 10000</text>
<text text-anchor="middle" x="268.5" y="-24593.38" font-family="Arial" font-size="10.00">Hidden: 4096</text>
</g>
<!-- layer_0_input_dist -->
<g id="node2" class="node">
<title>layer_0_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="362.69,-24524.38 212.86,-24524.38 174.31,-24442.38 324.14,-24442.38 362.69,-24524.38"/>
<text text-anchor="middle" x="268.5" y="-24491.88" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="268.5" y="-24480.88" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="268.5" y="-24469.88" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- input&#45;&gt;layer_0_input_dist -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_0_input_dist</title>
<path fill="none" stroke="black" d="M261.86,-24560.09C261.71,-24551.67 261.71,-24542.96 261.88,-24534.57"/>
<polygon fill="black" stroke="black" points="265.38,-24534.63 262.17,-24524.54 258.39,-24534.43 265.38,-24534.63"/>
</g>
<!-- input&#45;&gt;layer_0_input_dist -->
<g id="edge2" class="edge">
<title>input&#45;&gt;layer_0_input_dist</title>
<path fill="none" stroke="black" d="M275.14,-24560.09C275.29,-24551.67 275.29,-24542.96 275.12,-24534.57"/>
<polygon fill="black" stroke="black" points="278.61,-24534.43 274.83,-24524.54 271.62,-24534.63 278.61,-24534.43"/>
</g>
<!-- layer_0_qkv_gpu0 -->
<g id="node3" class="node">
<title>layer_0_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="93,-24406.38 0,-24406.38 0,-24354.38 93,-24354.38 93,-24406.38"/>
<text text-anchor="middle" x="46.5" y="-24394.38" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="46.5" y="-24383.38" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="46.5" y="-24372.38" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="46.5" y="-24361.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu0 -->
<g id="edge3" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu0</title>
<path fill="none" stroke="black" d="M180.44,-24442.32C154.15,-24430.36 126.07,-24417.58 102.44,-24406.83"/>
<polygon fill="black" stroke="black" points="103.83,-24403.62 93.28,-24402.66 100.93,-24409.99 103.83,-24403.62"/>
</g>
<!-- layer_0_qkv_gpu1 -->
<g id="node4" class="node">
<title>layer_0_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="204,-24406.38 111,-24406.38 111,-24354.38 204,-24354.38 204,-24406.38"/>
<text text-anchor="middle" x="157.5" y="-24394.38" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="157.5" y="-24383.38" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="157.5" y="-24372.38" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="157.5" y="-24361.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu1 -->
<g id="edge4" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu1</title>
<path fill="none" stroke="black" d="M224.31,-24442.17C213.81,-24432.62 202.74,-24422.55 192.7,-24413.41"/>
<polygon fill="black" stroke="black" points="195,-24410.77 185.25,-24406.63 190.29,-24415.95 195,-24410.77"/>
</g>
<!-- layer_0_qkv_gpu2 -->
<g id="node5" class="node">
<title>layer_0_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="315,-24406.38 222,-24406.38 222,-24354.38 315,-24354.38 315,-24406.38"/>
<text text-anchor="middle" x="268.5" y="-24394.38" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="268.5" y="-24383.38" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="268.5" y="-24372.38" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="268.5" y="-24361.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu2 -->
<g id="edge5" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu2</title>
<path fill="none" stroke="black" d="M268.5,-24442.17C268.5,-24433.74 268.5,-24424.91 268.5,-24416.67"/>
<polygon fill="black" stroke="black" points="272,-24416.63 268.5,-24406.63 265,-24416.63 272,-24416.63"/>
</g>
<!-- layer_0_qkv_gpu3 -->
<g id="node6" class="node">
<title>layer_0_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="426,-24406.38 333,-24406.38 333,-24354.38 426,-24354.38 426,-24406.38"/>
<text text-anchor="middle" x="379.5" y="-24394.38" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="379.5" y="-24383.38" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="379.5" y="-24372.38" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="379.5" y="-24361.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu3 -->
<g id="edge6" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu3</title>
<path fill="none" stroke="black" d="M312.69,-24442.17C323.19,-24432.62 334.26,-24422.55 344.3,-24413.41"/>
<polygon fill="black" stroke="black" points="346.71,-24415.95 351.75,-24406.63 342,-24410.77 346.71,-24415.95"/>
</g>
<!-- layer_0_residual1 -->
<g id="node14" class="node">
<title>layer_0_residual1</title>
<polygon fill="lightyellow" stroke="black" points="466.44,-23923.3 344.05,-23923.3 312.56,-23841.3 434.95,-23841.3 466.44,-23923.3"/>
<text text-anchor="middle" x="389.5" y="-23890.8" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="389.5" y="-23879.8" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="389.5" y="-23868.8" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_residual1 -->
<g id="edge18" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M335.52,-24465.61C369.53,-24454.02 409.11,-24435.34 435.5,-24406.38 474.73,-24363.34 478.5,-24340.85 478.5,-24282.61 478.5,-24282.61 478.5,-24282.61 478.5,-24093.84 478.5,-24034.87 448.51,-23973.43 423.35,-23932.25"/>
<polygon fill="black" stroke="black" points="426.17,-23930.15 417.9,-23923.52 420.23,-23933.85 426.17,-23930.15"/>
</g>
<!-- layer_0_allgather_qkv -->
<g id="node7" class="node">
<title>layer_0_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="157.5" cy="-24281.61" rx="57.05" ry="36.54"/>
<text text-anchor="middle" x="157.5" y="-24295.61" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="157.5" y="-24284.61" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="157.5" y="-24273.61" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="157.5" y="-24262.61" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_0_qkv_gpu0&#45;&gt;layer_0_allgather_qkv -->
<g id="edge7" class="edge">
<title>layer_0_qkv_gpu0&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M75.37,-24354.21C87.83,-24343.35 102.64,-24330.44 116.22,-24318.6"/>
<polygon fill="black" stroke="black" points="118.81,-24320.98 124.05,-24311.77 114.21,-24315.71 118.81,-24320.98"/>
</g>
<!-- layer_0_qkv_gpu1&#45;&gt;layer_0_allgather_qkv -->
<g id="edge8" class="edge">
<title>layer_0_qkv_gpu1&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M157.5,-24354.21C157.5,-24346.4 157.5,-24337.54 157.5,-24328.77"/>
<polygon fill="black" stroke="black" points="161,-24328.59 157.5,-24318.59 154,-24328.59 161,-24328.59"/>
</g>
<!-- layer_0_qkv_gpu2&#45;&gt;layer_0_allgather_qkv -->
<g id="edge9" class="edge">
<title>layer_0_qkv_gpu2&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M239.63,-24354.21C227.17,-24343.35 212.36,-24330.44 198.78,-24318.6"/>
<polygon fill="black" stroke="black" points="200.79,-24315.71 190.95,-24311.77 196.19,-24320.98 200.79,-24315.71"/>
</g>
<!-- layer_0_qkv_gpu3&#45;&gt;layer_0_allgather_qkv -->
<g id="edge10" class="edge">
<title>layer_0_qkv_gpu3&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M332.72,-24358.04C329.94,-24356.8 327.19,-24355.57 324.5,-24354.38 287.85,-24338.18 246.48,-24320.4 214.08,-24306.58"/>
<polygon fill="black" stroke="black" points="215.33,-24303.31 204.76,-24302.62 212.59,-24309.75 215.33,-24303.31"/>
</g>
<!-- layer_0_attention -->
<g id="node8" class="node">
<title>layer_0_attention</title>
<polygon fill="lightblue" stroke="black" points="145.5,-24208.84 77.5,-24208.84 77.5,-24156.84 145.5,-24156.84 145.5,-24208.84"/>
<text text-anchor="middle" x="111.5" y="-24196.84" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="111.5" y="-24185.84" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="111.5" y="-24174.84" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="111.5" y="-24163.84" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_0_allgather_qkv&#45;&gt;layer_0_attention -->
<g id="edge11" class="edge">
<title>layer_0_allgather_qkv&#45;&gt;layer_0_attention</title>
<path fill="none" stroke="black" d="M141.15,-24246.22C136.82,-24237.11 132.15,-24227.27 127.82,-24218.17"/>
<polygon fill="black" stroke="black" points="130.91,-24216.53 123.46,-24209 124.59,-24219.53 130.91,-24216.53"/>
</g>
<!-- layer_0_attn_out_gpu0 -->
<g id="node9" class="node">
<title>layer_0_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="132.5,-24120.84 44.5,-24120.84 44.5,-24068.84 132.5,-24068.84 132.5,-24120.84"/>
<text text-anchor="middle" x="88.5" y="-24108.84" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="88.5" y="-24097.84" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="88.5" y="-24086.84" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="88.5" y="-24075.84" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attention&#45;&gt;layer_0_attn_out_gpu0 -->
<g id="edge12" class="edge">
<title>layer_0_attention&#45;&gt;layer_0_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M104.72,-24156.51C102.57,-24148.46 100.15,-24139.41 97.85,-24130.81"/>
<polygon fill="black" stroke="black" points="101.19,-24129.76 95.23,-24121 94.43,-24131.56 101.19,-24129.76"/>
</g>
<!-- layer_0_allreduce_attn -->
<g id="node13" class="node">
<title>layer_0_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="300.5" cy="-23996.07" rx="57.97" ry="36.54"/>
<text text-anchor="middle" x="300.5" y="-24010.07" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="300.5" y="-23999.07" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="300.5" y="-23988.07" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="300.5" y="-23977.07" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_0_attn_out_gpu0&#45;&gt;layer_0_allreduce_attn -->
<g id="edge13" class="edge">
<title>layer_0_attn_out_gpu0&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M132.72,-24072.92C135.69,-24071.53 138.64,-24070.16 141.5,-24068.84 175.64,-24053.09 214.07,-24035.73 244.59,-24022.04"/>
<polygon fill="black" stroke="black" points="246.1,-24025.19 253.79,-24017.91 243.24,-24018.81 246.1,-24025.19"/>
</g>
<!-- layer_0_attn_out_gpu1 -->
<g id="node10" class="node">
<title>layer_0_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="238.5,-24120.84 150.5,-24120.84 150.5,-24068.84 238.5,-24068.84 238.5,-24120.84"/>
<text text-anchor="middle" x="194.5" y="-24108.84" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="194.5" y="-24097.84" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="194.5" y="-24086.84" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="194.5" y="-24075.84" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attn_out_gpu1&#45;&gt;layer_0_allreduce_attn -->
<g id="edge14" class="edge">
<title>layer_0_attn_out_gpu1&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M222.07,-24068.67C233.66,-24058.1 247.36,-24045.58 260.05,-24034"/>
<polygon fill="black" stroke="black" points="262.76,-24036.26 267.79,-24026.94 258.04,-24031.09 262.76,-24036.26"/>
</g>
<!-- layer_0_attn_out_gpu2 -->
<g id="node11" class="node">
<title>layer_0_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="344.5,-24120.84 256.5,-24120.84 256.5,-24068.84 344.5,-24068.84 344.5,-24120.84"/>
<text text-anchor="middle" x="300.5" y="-24108.84" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="300.5" y="-24097.84" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="300.5" y="-24086.84" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="300.5" y="-24075.84" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attn_out_gpu2&#45;&gt;layer_0_allreduce_attn -->
<g id="edge15" class="edge">
<title>layer_0_attn_out_gpu2&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M300.5,-24068.67C300.5,-24060.86 300.5,-24052 300.5,-24043.23"/>
<polygon fill="black" stroke="black" points="304,-24043.05 300.5,-24033.05 297,-24043.05 304,-24043.05"/>
</g>
<!-- layer_0_attn_out_gpu3 -->
<g id="node12" class="node">
<title>layer_0_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="450.5,-24120.84 362.5,-24120.84 362.5,-24068.84 450.5,-24068.84 450.5,-24120.84"/>
<text text-anchor="middle" x="406.5" y="-24108.84" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="406.5" y="-24097.84" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="406.5" y="-24086.84" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="406.5" y="-24075.84" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attn_out_gpu3&#45;&gt;layer_0_allreduce_attn -->
<g id="edge16" class="edge">
<title>layer_0_attn_out_gpu3&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M378.93,-24068.67C367.34,-24058.1 353.64,-24045.58 340.95,-24034"/>
<polygon fill="black" stroke="black" points="342.96,-24031.09 333.21,-24026.94 338.24,-24036.26 342.96,-24031.09"/>
</g>
<!-- layer_0_allreduce_attn&#45;&gt;layer_0_residual1 -->
<g id="edge17" class="edge">
<title>layer_0_allreduce_attn&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M326,-23963.04C333.78,-23953.28 342.51,-23942.31 350.95,-23931.72"/>
<polygon fill="black" stroke="black" points="353.84,-23933.71 357.33,-23923.71 348.36,-23929.35 353.84,-23933.71"/>
</g>
<!-- layer_0_ln1 -->
<g id="node15" class="node">
<title>layer_0_ln1</title>
<polygon fill="lightblue" stroke="black" points="333,-23805.3 260,-23805.3 260,-23753.3 333,-23753.3 333,-23805.3"/>
<text text-anchor="middle" x="296.5" y="-23793.3" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="296.5" y="-23782.3" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="296.5" y="-23771.3" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="296.5" y="-23760.3" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_0_residual1&#45;&gt;layer_0_ln1 -->
<g id="edge19" class="edge">
<title>layer_0_residual1&#45;&gt;layer_0_ln1</title>
<path fill="none" stroke="black" d="M352.48,-23841.1C343.94,-23831.82 334.95,-23822.06 326.74,-23813.14"/>
<polygon fill="black" stroke="black" points="329.1,-23810.54 319.75,-23805.56 323.95,-23815.28 329.1,-23810.54"/>
</g>
<!-- layer_0_residual2 -->
<g id="node27" class="node">
<title>layer_0_residual2</title>
<polygon fill="lightyellow" stroke="black" points="494.44,-23245.23 372.05,-23245.23 340.56,-23163.23 462.95,-23163.23 494.44,-23245.23"/>
<text text-anchor="middle" x="417.5" y="-23212.73" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="417.5" y="-23201.73" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="417.5" y="-23190.73" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_0_residual1&#45;&gt;layer_0_residual2 -->
<g id="edge35" class="edge">
<title>layer_0_residual1&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M434.93,-23841.06C469.61,-23805.71 511.5,-23750.89 511.5,-23692.3 511.5,-23692.3 511.5,-23692.3 511.5,-23415.76 511.5,-23356.34 479.89,-23295.05 453.34,-23254.02"/>
<polygon fill="black" stroke="black" points="456.19,-23252 447.76,-23245.59 450.35,-23255.86 456.19,-23252"/>
</g>
<!-- layer_0_mlp_fc1_gpu0 -->
<g id="node16" class="node">
<title>layer_0_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="119.5,-23717.3 25.5,-23717.3 25.5,-23665.3 119.5,-23665.3 119.5,-23717.3"/>
<text text-anchor="middle" x="72.5" y="-23705.3" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="72.5" y="-23694.3" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="72.5" y="-23683.3" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="72.5" y="-23672.3" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu0 -->
<g id="edge20" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M259.84,-23765.84C227.62,-23754.7 179.31,-23737.54 129.14,-23717.47"/>
<polygon fill="black" stroke="black" points="130.34,-23714.18 119.75,-23713.68 127.72,-23720.67 130.34,-23714.18"/>
</g>
<!-- layer_0_mlp_fc1_gpu1 -->
<g id="node17" class="node">
<title>layer_0_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="231.5,-23717.3 137.5,-23717.3 137.5,-23665.3 231.5,-23665.3 231.5,-23717.3"/>
<text text-anchor="middle" x="184.5" y="-23705.3" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="184.5" y="-23694.3" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="184.5" y="-23683.3" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="184.5" y="-23672.3" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu1 -->
<g id="edge21" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M263.8,-23753.2C251.83,-23744.01 238.13,-23733.49 225.53,-23723.81"/>
<polygon fill="black" stroke="black" points="227.49,-23720.9 217.43,-23717.59 223.23,-23726.46 227.49,-23720.9"/>
</g>
<!-- layer_0_mlp_fc1_gpu2 -->
<g id="node18" class="node">
<title>layer_0_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="343.5,-23717.3 249.5,-23717.3 249.5,-23665.3 343.5,-23665.3 343.5,-23717.3"/>
<text text-anchor="middle" x="296.5" y="-23705.3" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="296.5" y="-23694.3" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="296.5" y="-23683.3" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="296.5" y="-23672.3" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu2 -->
<g id="edge22" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M296.5,-23752.97C296.5,-23745.01 296.5,-23736.07 296.5,-23727.55"/>
<polygon fill="black" stroke="black" points="300,-23727.46 296.5,-23717.46 293,-23727.46 300,-23727.46"/>
</g>
<!-- layer_0_mlp_fc1_gpu3 -->
<g id="node19" class="node">
<title>layer_0_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="455.5,-23717.3 361.5,-23717.3 361.5,-23665.3 455.5,-23665.3 455.5,-23717.3"/>
<text text-anchor="middle" x="408.5" y="-23705.3" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="408.5" y="-23694.3" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="408.5" y="-23683.3" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="408.5" y="-23672.3" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu3 -->
<g id="edge23" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M329.2,-23753.2C341.17,-23744.01 354.87,-23733.49 367.47,-23723.81"/>
<polygon fill="black" stroke="black" points="369.77,-23726.46 375.57,-23717.59 365.51,-23720.9 369.77,-23726.46"/>
</g>
<!-- layer_0_allgather_mlp -->
<g id="node20" class="node">
<title>layer_0_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="184.5" cy="-23592.53" rx="56.64" ry="36.54"/>
<text text-anchor="middle" x="184.5" y="-23606.53" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="184.5" y="-23595.53" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="184.5" y="-23584.53" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="184.5" y="-23573.53" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_0_mlp_fc1_gpu0&#45;&gt;layer_0_allgather_mlp -->
<g id="edge24" class="edge">
<title>layer_0_mlp_fc1_gpu0&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M101.63,-23665.13C114.31,-23654.18 129.4,-23641.14 143.2,-23629.22"/>
<polygon fill="black" stroke="black" points="145.87,-23631.53 151.15,-23622.35 141.3,-23626.24 145.87,-23631.53"/>
</g>
<!-- layer_0_mlp_fc1_gpu1&#45;&gt;layer_0_allgather_mlp -->
<g id="edge25" class="edge">
<title>layer_0_mlp_fc1_gpu1&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M184.5,-23665.13C184.5,-23657.32 184.5,-23648.46 184.5,-23639.69"/>
<polygon fill="black" stroke="black" points="188,-23639.51 184.5,-23629.51 181,-23639.51 188,-23639.51"/>
</g>
<!-- layer_0_mlp_fc1_gpu2&#45;&gt;layer_0_allgather_mlp -->
<g id="edge26" class="edge">
<title>layer_0_mlp_fc1_gpu2&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M267.37,-23665.13C254.69,-23654.18 239.6,-23641.14 225.8,-23629.22"/>
<polygon fill="black" stroke="black" points="227.7,-23626.24 217.85,-23622.35 223.13,-23631.53 227.7,-23626.24"/>
</g>
<!-- layer_0_mlp_fc1_gpu3&#45;&gt;layer_0_allgather_mlp -->
<g id="edge27" class="edge">
<title>layer_0_mlp_fc1_gpu3&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M361.47,-23669.24C358.44,-23667.9 355.43,-23666.58 352.5,-23665.3 315.33,-23649.07 273.38,-23631.15 240.69,-23617.27"/>
<polygon fill="black" stroke="black" points="241.87,-23613.97 231.3,-23613.29 239.14,-23620.41 241.87,-23613.97"/>
</g>
<!-- layer_0_gelu -->
<g id="node21" class="node">
<title>layer_0_gelu</title>
<polygon fill="lightblue" stroke="black" points="201,-23519.76 112,-23519.76 112,-23478.76 201,-23478.76 201,-23519.76"/>
<text text-anchor="middle" x="156.5" y="-23507.76" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="156.5" y="-23496.76" font-family="Arial" font-size="10.00">GELU Activation</text>
<text text-anchor="middle" x="156.5" y="-23485.76" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_0_allgather_mlp&#45;&gt;layer_0_gelu -->
<g id="edge28" class="edge">
<title>layer_0_allgather_mlp&#45;&gt;layer_0_gelu</title>
<path fill="none" stroke="black" d="M173.67,-23556.25C170.98,-23547.47 168.13,-23538.16 165.53,-23529.7"/>
<polygon fill="black" stroke="black" points="168.8,-23528.44 162.52,-23519.9 162.11,-23530.49 168.8,-23528.44"/>
</g>
<!-- layer_0_mlp_fc2_gpu0 -->
<g id="node22" class="node">
<title>layer_0_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="147.5,-23442.76 53.5,-23442.76 53.5,-23390.76 147.5,-23390.76 147.5,-23442.76"/>
<text text-anchor="middle" x="100.5" y="-23430.76" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="100.5" y="-23419.76" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="100.5" y="-23408.76" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="100.5" y="-23397.76" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu0 -->
<g id="edge29" class="edge">
<title>layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu0</title>
<path fill="none" stroke="black" d="M142.66,-23478.37C136.95,-23470.17 130.19,-23460.44 123.76,-23451.2"/>
<polygon fill="black" stroke="black" points="126.58,-23449.13 118,-23442.92 120.84,-23453.13 126.58,-23449.13"/>
</g>
<!-- layer_0_allreduce_mlp -->
<g id="node26" class="node">
<title>layer_0_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="324.5" cy="-23318" rx="60.21" ry="36.54"/>
<text text-anchor="middle" x="324.5" y="-23332" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="324.5" y="-23321" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="324.5" y="-23310" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="324.5" y="-23299" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_0_mlp_fc2_gpu0&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge30" class="edge">
<title>layer_0_mlp_fc2_gpu0&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M147.53,-23394.7C150.56,-23393.37 153.57,-23392.04 156.5,-23390.76 192.87,-23374.88 233.83,-23357.37 266.2,-23343.63"/>
<polygon fill="black" stroke="black" points="267.69,-23346.8 275.52,-23339.67 264.95,-23340.36 267.69,-23346.8"/>
</g>
<!-- layer_0_mlp_fc2_gpu1 -->
<g id="node23" class="node">
<title>layer_0_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="259.5,-23442.76 165.5,-23442.76 165.5,-23390.76 259.5,-23390.76 259.5,-23442.76"/>
<text text-anchor="middle" x="212.5" y="-23430.76" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="212.5" y="-23419.76" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="212.5" y="-23408.76" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="212.5" y="-23397.76" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_mlp_fc2_gpu1&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge31" class="edge">
<title>layer_0_mlp_fc2_gpu1&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M241.63,-23390.59C254.1,-23379.83 268.88,-23367.05 282.49,-23355.29"/>
<polygon fill="black" stroke="black" points="285.07,-23357.69 290.34,-23348.51 280.49,-23352.4 285.07,-23357.69"/>
</g>
<!-- layer_0_mlp_fc2_gpu2 -->
<g id="node24" class="node">
<title>layer_0_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="371.5,-23442.76 277.5,-23442.76 277.5,-23390.76 371.5,-23390.76 371.5,-23442.76"/>
<text text-anchor="middle" x="324.5" y="-23430.76" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="324.5" y="-23419.76" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="324.5" y="-23408.76" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="324.5" y="-23397.76" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_mlp_fc2_gpu2&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge32" class="edge">
<title>layer_0_mlp_fc2_gpu2&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M324.5,-23390.59C324.5,-23382.78 324.5,-23373.92 324.5,-23365.15"/>
<polygon fill="black" stroke="black" points="328,-23364.97 324.5,-23354.97 321,-23364.97 328,-23364.97"/>
</g>
<!-- layer_0_mlp_fc2_gpu3 -->
<g id="node25" class="node">
<title>layer_0_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="483.5,-23442.76 389.5,-23442.76 389.5,-23390.76 483.5,-23390.76 483.5,-23442.76"/>
<text text-anchor="middle" x="436.5" y="-23430.76" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="436.5" y="-23419.76" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="436.5" y="-23408.76" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="436.5" y="-23397.76" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_mlp_fc2_gpu3&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge33" class="edge">
<title>layer_0_mlp_fc2_gpu3&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M407.37,-23390.59C394.9,-23379.83 380.12,-23367.05 366.51,-23355.29"/>
<polygon fill="black" stroke="black" points="368.51,-23352.4 358.66,-23348.51 363.93,-23357.69 368.51,-23352.4"/>
</g>
<!-- layer_0_allreduce_mlp&#45;&gt;layer_0_residual2 -->
<g id="edge34" class="edge">
<title>layer_0_allreduce_mlp&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M351.15,-23284.97C359.36,-23275.1 368.58,-23264.02 377.48,-23253.33"/>
<polygon fill="black" stroke="black" points="380.18,-23255.56 383.88,-23245.63 374.79,-23251.08 380.18,-23255.56"/>
</g>
<!-- layer_0_ln2 -->
<g id="node28" class="node">
<title>layer_0_ln2</title>
<polygon fill="lightblue" stroke="black" points="454,-23127.23 381,-23127.23 381,-23075.23 454,-23075.23 454,-23127.23"/>
<text text-anchor="middle" x="417.5" y="-23115.23" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="417.5" y="-23104.23" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="417.5" y="-23093.23" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="417.5" y="-23082.23" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_0_residual2&#45;&gt;layer_0_ln2 -->
<g id="edge36" class="edge">
<title>layer_0_residual2&#45;&gt;layer_0_ln2</title>
<path fill="none" stroke="black" d="M417.5,-23163.02C417.5,-23154.59 417.5,-23145.75 417.5,-23137.52"/>
<polygon fill="black" stroke="black" points="421,-23137.48 417.5,-23127.48 414,-23137.48 421,-23137.48"/>
</g>
<!-- layer_1_input_dist -->
<g id="node29" class="node">
<title>layer_1_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="511.69,-23039.23 361.86,-23039.23 323.31,-22957.23 473.14,-22957.23 511.69,-23039.23"/>
<text text-anchor="middle" x="417.5" y="-23006.73" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="417.5" y="-22995.73" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="417.5" y="-22984.73" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_0_ln2&#45;&gt;layer_1_input_dist -->
<g id="edge37" class="edge">
<title>layer_0_ln2&#45;&gt;layer_1_input_dist</title>
<path fill="none" stroke="black" d="M417.5,-23075C417.5,-23067.27 417.5,-23058.48 417.5,-23049.69"/>
<polygon fill="black" stroke="black" points="421,-23049.44 417.5,-23039.44 414,-23049.44 421,-23049.44"/>
</g>
<!-- layer_1_qkv_gpu0 -->
<g id="node30" class="node">
<title>layer_1_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="242,-22921.23 149,-22921.23 149,-22869.23 242,-22869.23 242,-22921.23"/>
<text text-anchor="middle" x="195.5" y="-22909.23" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="195.5" y="-22898.23" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="195.5" y="-22887.23" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="195.5" y="-22876.23" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu0 -->
<g id="edge38" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu0</title>
<path fill="none" stroke="black" d="M329.44,-22957.16C303.15,-22945.2 275.07,-22932.42 251.44,-22921.67"/>
<polygon fill="black" stroke="black" points="252.83,-22918.46 242.28,-22917.51 249.93,-22924.83 252.83,-22918.46"/>
</g>
<!-- layer_1_qkv_gpu1 -->
<g id="node31" class="node">
<title>layer_1_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="353,-22921.23 260,-22921.23 260,-22869.23 353,-22869.23 353,-22921.23"/>
<text text-anchor="middle" x="306.5" y="-22909.23" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="306.5" y="-22898.23" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="306.5" y="-22887.23" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="306.5" y="-22876.23" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu1 -->
<g id="edge39" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu1</title>
<path fill="none" stroke="black" d="M373.31,-22957.02C362.81,-22947.46 351.74,-22937.39 341.7,-22928.26"/>
<polygon fill="black" stroke="black" points="344,-22925.62 334.25,-22921.48 339.29,-22930.8 344,-22925.62"/>
</g>
<!-- layer_1_qkv_gpu2 -->
<g id="node32" class="node">
<title>layer_1_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="464,-22921.23 371,-22921.23 371,-22869.23 464,-22869.23 464,-22921.23"/>
<text text-anchor="middle" x="417.5" y="-22909.23" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="417.5" y="-22898.23" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="417.5" y="-22887.23" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="417.5" y="-22876.23" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu2 -->
<g id="edge40" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu2</title>
<path fill="none" stroke="black" d="M417.5,-22957.02C417.5,-22948.59 417.5,-22939.75 417.5,-22931.52"/>
<polygon fill="black" stroke="black" points="421,-22931.48 417.5,-22921.48 414,-22931.48 421,-22931.48"/>
</g>
<!-- layer_1_qkv_gpu3 -->
<g id="node33" class="node">
<title>layer_1_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="575,-22921.23 482,-22921.23 482,-22869.23 575,-22869.23 575,-22921.23"/>
<text text-anchor="middle" x="528.5" y="-22909.23" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="528.5" y="-22898.23" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="528.5" y="-22887.23" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="528.5" y="-22876.23" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu3 -->
<g id="edge41" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu3</title>
<path fill="none" stroke="black" d="M461.69,-22957.02C472.19,-22947.46 483.26,-22937.39 493.3,-22928.26"/>
<polygon fill="black" stroke="black" points="495.71,-22930.8 500.75,-22921.48 491,-22925.62 495.71,-22930.8"/>
</g>
<!-- layer_1_residual1 -->
<g id="node41" class="node">
<title>layer_1_residual1</title>
<polygon fill="lightyellow" stroke="black" points="614.44,-22438.15 492.05,-22438.15 460.56,-22356.15 582.95,-22356.15 614.44,-22438.15"/>
<text text-anchor="middle" x="537.5" y="-22405.65" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="537.5" y="-22394.65" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="537.5" y="-22383.65" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_residual1 -->
<g id="edge53" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M484.19,-22980.67C518.31,-22969.11 558.11,-22950.4 584.5,-22921.23 623.47,-22878.15 626.5,-22855.55 626.5,-22797.46 626.5,-22797.46 626.5,-22797.46 626.5,-22608.69 626.5,-22549.72 596.51,-22488.27 571.35,-22447.09"/>
<polygon fill="black" stroke="black" points="574.17,-22444.99 565.9,-22438.36 568.23,-22448.7 574.17,-22444.99"/>
</g>
<!-- layer_1_allgather_qkv -->
<g id="node34" class="node">
<title>layer_1_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="306.5" cy="-22796.46" rx="57.05" ry="36.54"/>
<text text-anchor="middle" x="306.5" y="-22810.46" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="306.5" y="-22799.46" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="306.5" y="-22788.46" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="306.5" y="-22777.46" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_1_qkv_gpu0&#45;&gt;layer_1_allgather_qkv -->
<g id="edge42" class="edge">
<title>layer_1_qkv_gpu0&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M224.37,-22869.05C236.83,-22858.19 251.64,-22845.29 265.22,-22833.44"/>
<polygon fill="black" stroke="black" points="267.81,-22835.83 273.05,-22826.62 263.21,-22830.55 267.81,-22835.83"/>
</g>
<!-- layer_1_qkv_gpu1&#45;&gt;layer_1_allgather_qkv -->
<g id="edge43" class="edge">
<title>layer_1_qkv_gpu1&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M306.5,-22869.05C306.5,-22861.24 306.5,-22852.38 306.5,-22843.61"/>
<polygon fill="black" stroke="black" points="310,-22843.43 306.5,-22833.43 303,-22843.43 310,-22843.43"/>
</g>
<!-- layer_1_qkv_gpu2&#45;&gt;layer_1_allgather_qkv -->
<g id="edge44" class="edge">
<title>layer_1_qkv_gpu2&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M388.63,-22869.05C376.17,-22858.19 361.36,-22845.29 347.78,-22833.44"/>
<polygon fill="black" stroke="black" points="349.79,-22830.55 339.95,-22826.62 345.19,-22835.83 349.79,-22830.55"/>
</g>
<!-- layer_1_qkv_gpu3&#45;&gt;layer_1_allgather_qkv -->
<g id="edge45" class="edge">
<title>layer_1_qkv_gpu3&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M481.72,-22872.88C478.94,-22871.64 476.19,-22870.41 473.5,-22869.23 436.85,-22853.02 395.48,-22835.24 363.08,-22821.43"/>
<polygon fill="black" stroke="black" points="364.33,-22818.16 353.76,-22817.46 361.59,-22824.6 364.33,-22818.16"/>
</g>
<!-- layer_1_attention -->
<g id="node35" class="node">
<title>layer_1_attention</title>
<polygon fill="lightblue" stroke="black" points="316.5,-22723.69 248.5,-22723.69 248.5,-22671.69 316.5,-22671.69 316.5,-22723.69"/>
<text text-anchor="middle" x="282.5" y="-22711.69" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="282.5" y="-22700.69" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="282.5" y="-22689.69" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="282.5" y="-22678.69" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_1_allgather_qkv&#45;&gt;layer_1_attention -->
<g id="edge46" class="edge">
<title>layer_1_allgather_qkv&#45;&gt;layer_1_attention</title>
<path fill="none" stroke="black" d="M297.7,-22759.97C295.56,-22751.37 293.28,-22742.17 291.16,-22733.59"/>
<polygon fill="black" stroke="black" points="294.55,-22732.74 288.75,-22723.87 287.76,-22734.42 294.55,-22732.74"/>
</g>
<!-- layer_1_attn_out_gpu0 -->
<g id="node36" class="node">
<title>layer_1_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="280.5,-22635.69 192.5,-22635.69 192.5,-22583.69 280.5,-22583.69 280.5,-22635.69"/>
<text text-anchor="middle" x="236.5" y="-22623.69" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="236.5" y="-22612.69" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="236.5" y="-22601.69" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="236.5" y="-22590.69" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attention&#45;&gt;layer_1_attn_out_gpu0 -->
<g id="edge47" class="edge">
<title>layer_1_attention&#45;&gt;layer_1_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M268.95,-22671.35C264.5,-22663.04 259.49,-22653.66 254.75,-22644.81"/>
<polygon fill="black" stroke="black" points="257.76,-22643.01 249.96,-22635.84 251.59,-22646.31 257.76,-22643.01"/>
</g>
<!-- layer_1_allreduce_attn -->
<g id="node40" class="node">
<title>layer_1_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="448.5" cy="-22510.92" rx="57.97" ry="36.54"/>
<text text-anchor="middle" x="448.5" y="-22524.92" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="448.5" y="-22513.92" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="448.5" y="-22502.92" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="448.5" y="-22491.92" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_1_attn_out_gpu0&#45;&gt;layer_1_allreduce_attn -->
<g id="edge48" class="edge">
<title>layer_1_attn_out_gpu0&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M280.72,-22587.76C283.69,-22586.38 286.64,-22585.01 289.5,-22583.69 323.64,-22567.93 362.07,-22550.58 392.59,-22536.88"/>
<polygon fill="black" stroke="black" points="394.1,-22540.04 401.79,-22532.75 391.24,-22533.65 394.1,-22540.04"/>
</g>
<!-- layer_1_attn_out_gpu1 -->
<g id="node37" class="node">
<title>layer_1_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="386.5,-22635.69 298.5,-22635.69 298.5,-22583.69 386.5,-22583.69 386.5,-22635.69"/>
<text text-anchor="middle" x="342.5" y="-22623.69" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="342.5" y="-22612.69" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="342.5" y="-22601.69" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="342.5" y="-22590.69" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attn_out_gpu1&#45;&gt;layer_1_allreduce_attn -->
<g id="edge49" class="edge">
<title>layer_1_attn_out_gpu1&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M370.07,-22583.51C381.66,-22572.94 395.36,-22560.43 408.05,-22548.85"/>
<polygon fill="black" stroke="black" points="410.76,-22551.11 415.79,-22541.78 406.04,-22545.94 410.76,-22551.11"/>
</g>
<!-- layer_1_attn_out_gpu2 -->
<g id="node38" class="node">
<title>layer_1_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="492.5,-22635.69 404.5,-22635.69 404.5,-22583.69 492.5,-22583.69 492.5,-22635.69"/>
<text text-anchor="middle" x="448.5" y="-22623.69" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="448.5" y="-22612.69" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="448.5" y="-22601.69" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="448.5" y="-22590.69" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attn_out_gpu2&#45;&gt;layer_1_allreduce_attn -->
<g id="edge50" class="edge">
<title>layer_1_attn_out_gpu2&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M448.5,-22583.51C448.5,-22575.71 448.5,-22566.84 448.5,-22558.07"/>
<polygon fill="black" stroke="black" points="452,-22557.89 448.5,-22547.89 445,-22557.89 452,-22557.89"/>
</g>
<!-- layer_1_attn_out_gpu3 -->
<g id="node39" class="node">
<title>layer_1_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="598.5,-22635.69 510.5,-22635.69 510.5,-22583.69 598.5,-22583.69 598.5,-22635.69"/>
<text text-anchor="middle" x="554.5" y="-22623.69" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="554.5" y="-22612.69" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="554.5" y="-22601.69" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="554.5" y="-22590.69" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attn_out_gpu3&#45;&gt;layer_1_allreduce_attn -->
<g id="edge51" class="edge">
<title>layer_1_attn_out_gpu3&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M526.93,-22583.51C515.34,-22572.94 501.64,-22560.43 488.95,-22548.85"/>
<polygon fill="black" stroke="black" points="490.96,-22545.94 481.21,-22541.78 486.24,-22551.11 490.96,-22545.94"/>
</g>
<!-- layer_1_allreduce_attn&#45;&gt;layer_1_residual1 -->
<g id="edge52" class="edge">
<title>layer_1_allreduce_attn&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M474,-22477.89C481.78,-22468.12 490.51,-22457.16 498.95,-22446.56"/>
<polygon fill="black" stroke="black" points="501.84,-22448.55 505.33,-22438.55 496.36,-22444.19 501.84,-22448.55"/>
</g>
<!-- layer_1_ln1 -->
<g id="node42" class="node">
<title>layer_1_ln1</title>
<polygon fill="lightblue" stroke="black" points="481,-22320.15 408,-22320.15 408,-22268.15 481,-22268.15 481,-22320.15"/>
<text text-anchor="middle" x="444.5" y="-22308.15" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="444.5" y="-22297.15" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="444.5" y="-22286.15" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="444.5" y="-22275.15" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_1_residual1&#45;&gt;layer_1_ln1 -->
<g id="edge54" class="edge">
<title>layer_1_residual1&#45;&gt;layer_1_ln1</title>
<path fill="none" stroke="black" d="M500.48,-22355.94C491.94,-22346.66 482.95,-22336.9 474.74,-22327.99"/>
<polygon fill="black" stroke="black" points="477.1,-22325.38 467.75,-22320.4 471.95,-22330.13 477.1,-22325.38"/>
</g>
<!-- layer_1_residual2 -->
<g id="node54" class="node">
<title>layer_1_residual2</title>
<polygon fill="lightyellow" stroke="black" points="642.44,-21760.07 520.05,-21760.07 488.56,-21678.07 610.95,-21678.07 642.44,-21760.07"/>
<text text-anchor="middle" x="565.5" y="-21727.57" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="565.5" y="-21716.57" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="565.5" y="-21705.57" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_1_residual1&#45;&gt;layer_1_residual2 -->
<g id="edge70" class="edge">
<title>layer_1_residual1&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M582.93,-22355.9C617.61,-22320.55 659.5,-22265.73 659.5,-22207.15 659.5,-22207.15 659.5,-22207.15 659.5,-21930.61 659.5,-21871.19 627.89,-21809.89 601.34,-21768.87"/>
<polygon fill="black" stroke="black" points="604.19,-21766.84 595.76,-21760.43 598.35,-21770.7 604.19,-21766.84"/>
</g>
<!-- layer_1_mlp_fc1_gpu0 -->
<g id="node43" class="node">
<title>layer_1_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="267.5,-22232.15 173.5,-22232.15 173.5,-22180.15 267.5,-22180.15 267.5,-22232.15"/>
<text text-anchor="middle" x="220.5" y="-22220.15" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="220.5" y="-22209.15" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="220.5" y="-22198.15" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="220.5" y="-22187.15" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu0 -->
<g id="edge55" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M407.84,-22280.68C375.62,-22269.54 327.31,-22252.39 277.14,-22232.31"/>
<polygon fill="black" stroke="black" points="278.34,-22229.02 267.75,-22228.53 275.72,-22235.51 278.34,-22229.02"/>
</g>
<!-- layer_1_mlp_fc1_gpu1 -->
<g id="node44" class="node">
<title>layer_1_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="379.5,-22232.15 285.5,-22232.15 285.5,-22180.15 379.5,-22180.15 379.5,-22232.15"/>
<text text-anchor="middle" x="332.5" y="-22220.15" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="332.5" y="-22209.15" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="332.5" y="-22198.15" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="332.5" y="-22187.15" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu1 -->
<g id="edge56" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M411.8,-22268.04C399.83,-22258.85 386.13,-22248.33 373.53,-22238.65"/>
<polygon fill="black" stroke="black" points="375.49,-22235.75 365.43,-22232.43 371.23,-22241.3 375.49,-22235.75"/>
</g>
<!-- layer_1_mlp_fc1_gpu2 -->
<g id="node45" class="node">
<title>layer_1_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="491.5,-22232.15 397.5,-22232.15 397.5,-22180.15 491.5,-22180.15 491.5,-22232.15"/>
<text text-anchor="middle" x="444.5" y="-22220.15" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="444.5" y="-22209.15" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="444.5" y="-22198.15" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="444.5" y="-22187.15" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu2 -->
<g id="edge57" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M444.5,-22267.81C444.5,-22259.85 444.5,-22250.91 444.5,-22242.39"/>
<polygon fill="black" stroke="black" points="448,-22242.3 444.5,-22232.3 441,-22242.3 448,-22242.3"/>
</g>
<!-- layer_1_mlp_fc1_gpu3 -->
<g id="node46" class="node">
<title>layer_1_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="603.5,-22232.15 509.5,-22232.15 509.5,-22180.15 603.5,-22180.15 603.5,-22232.15"/>
<text text-anchor="middle" x="556.5" y="-22220.15" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="556.5" y="-22209.15" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="556.5" y="-22198.15" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="556.5" y="-22187.15" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu3 -->
<g id="edge58" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M477.2,-22268.04C489.17,-22258.85 502.87,-22248.33 515.47,-22238.65"/>
<polygon fill="black" stroke="black" points="517.77,-22241.3 523.57,-22232.43 513.51,-22235.75 517.77,-22241.3"/>
</g>
<!-- layer_1_allgather_mlp -->
<g id="node47" class="node">
<title>layer_1_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="332.5" cy="-22107.38" rx="56.64" ry="36.54"/>
<text text-anchor="middle" x="332.5" y="-22121.38" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="332.5" y="-22110.38" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="332.5" y="-22099.38" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="332.5" y="-22088.38" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_1_mlp_fc1_gpu0&#45;&gt;layer_1_allgather_mlp -->
<g id="edge59" class="edge">
<title>layer_1_mlp_fc1_gpu0&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M249.63,-22179.97C262.31,-22169.02 277.4,-22155.99 291.2,-22144.06"/>
<polygon fill="black" stroke="black" points="293.87,-22146.38 299.15,-22137.19 289.3,-22141.08 293.87,-22146.38"/>
</g>
<!-- layer_1_mlp_fc1_gpu1&#45;&gt;layer_1_allgather_mlp -->
<g id="edge60" class="edge">
<title>layer_1_mlp_fc1_gpu1&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M332.5,-22179.97C332.5,-22172.17 332.5,-22163.3 332.5,-22154.53"/>
<polygon fill="black" stroke="black" points="336,-22154.35 332.5,-22144.35 329,-22154.35 336,-22154.35"/>
</g>
<!-- layer_1_mlp_fc1_gpu2&#45;&gt;layer_1_allgather_mlp -->
<g id="edge61" class="edge">
<title>layer_1_mlp_fc1_gpu2&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M415.37,-22179.97C402.69,-22169.02 387.6,-22155.99 373.8,-22144.06"/>
<polygon fill="black" stroke="black" points="375.7,-22141.08 365.85,-22137.19 371.13,-22146.38 375.7,-22141.08"/>
</g>
<!-- layer_1_mlp_fc1_gpu3&#45;&gt;layer_1_allgather_mlp -->
<g id="edge62" class="edge">
<title>layer_1_mlp_fc1_gpu3&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M509.47,-22184.09C506.44,-22182.75 503.43,-22181.43 500.5,-22180.15 463.33,-22163.91 421.38,-22145.99 388.69,-22132.12"/>
<polygon fill="black" stroke="black" points="389.87,-22128.81 379.3,-22128.13 387.14,-22135.26 389.87,-22128.81"/>
</g>
<!-- layer_1_gelu -->
<g id="node48" class="node">
<title>layer_1_gelu</title>
<polygon fill="lightblue" stroke="black" points="349,-22034.61 260,-22034.61 260,-21993.61 349,-21993.61 349,-22034.61"/>
<text text-anchor="middle" x="304.5" y="-22022.61" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="304.5" y="-22011.61" font-family="Arial" font-size="10.00">GELU Activation</text>
<text text-anchor="middle" x="304.5" y="-22000.61" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_1_allgather_mlp&#45;&gt;layer_1_gelu -->
<g id="edge63" class="edge">
<title>layer_1_allgather_mlp&#45;&gt;layer_1_gelu</title>
<path fill="none" stroke="black" d="M321.67,-22071.09C318.98,-22062.32 316.13,-22053.01 313.53,-22044.55"/>
<polygon fill="black" stroke="black" points="316.8,-22043.28 310.52,-22034.75 310.11,-22045.33 316.8,-22043.28"/>
</g>
<!-- layer_1_mlp_fc2_gpu0 -->
<g id="node49" class="node">
<title>layer_1_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="295.5,-21957.61 201.5,-21957.61 201.5,-21905.61 295.5,-21905.61 295.5,-21957.61"/>
<text text-anchor="middle" x="248.5" y="-21945.61" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="248.5" y="-21934.61" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="248.5" y="-21923.61" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="248.5" y="-21912.61" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu0 -->
<g id="edge64" class="edge">
<title>layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu0</title>
<path fill="none" stroke="black" d="M290.66,-21993.21C284.95,-21985.01 278.19,-21975.28 271.76,-21966.05"/>
<polygon fill="black" stroke="black" points="274.58,-21963.97 266,-21957.76 268.84,-21967.97 274.58,-21963.97"/>
</g>
<!-- layer_1_allreduce_mlp -->
<g id="node53" class="node">
<title>layer_1_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="472.5" cy="-21832.84" rx="60.21" ry="36.54"/>
<text text-anchor="middle" x="472.5" y="-21846.84" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="472.5" y="-21835.84" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="472.5" y="-21824.84" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="472.5" y="-21813.84" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_1_mlp_fc2_gpu0&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge65" class="edge">
<title>layer_1_mlp_fc2_gpu0&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M295.53,-21909.55C298.56,-21908.21 301.57,-21906.89 304.5,-21905.61 340.87,-21889.72 381.83,-21872.22 414.2,-21858.47"/>
<polygon fill="black" stroke="black" points="415.69,-21861.64 423.52,-21854.52 412.95,-21855.2 415.69,-21861.64"/>
</g>
<!-- layer_1_mlp_fc2_gpu1 -->
<g id="node50" class="node">
<title>layer_1_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="407.5,-21957.61 313.5,-21957.61 313.5,-21905.61 407.5,-21905.61 407.5,-21957.61"/>
<text text-anchor="middle" x="360.5" y="-21945.61" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="360.5" y="-21934.61" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="360.5" y="-21923.61" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="360.5" y="-21912.61" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_mlp_fc2_gpu1&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge66" class="edge">
<title>layer_1_mlp_fc2_gpu1&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M389.63,-21905.44C402.1,-21894.67 416.88,-21881.89 430.49,-21870.13"/>
<polygon fill="black" stroke="black" points="433.07,-21872.54 438.34,-21863.35 428.49,-21867.24 433.07,-21872.54"/>
</g>
<!-- layer_1_mlp_fc2_gpu2 -->
<g id="node51" class="node">
<title>layer_1_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="519.5,-21957.61 425.5,-21957.61 425.5,-21905.61 519.5,-21905.61 519.5,-21957.61"/>
<text text-anchor="middle" x="472.5" y="-21945.61" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="472.5" y="-21934.61" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="472.5" y="-21923.61" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="472.5" y="-21912.61" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_mlp_fc2_gpu2&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge67" class="edge">
<title>layer_1_mlp_fc2_gpu2&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M472.5,-21905.44C472.5,-21897.63 472.5,-21888.76 472.5,-21879.99"/>
<polygon fill="black" stroke="black" points="476,-21879.82 472.5,-21869.82 469,-21879.82 476,-21879.82"/>
</g>
<!-- layer_1_mlp_fc2_gpu3 -->
<g id="node52" class="node">
<title>layer_1_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="631.5,-21957.61 537.5,-21957.61 537.5,-21905.61 631.5,-21905.61 631.5,-21957.61"/>
<text text-anchor="middle" x="584.5" y="-21945.61" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="584.5" y="-21934.61" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="584.5" y="-21923.61" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="584.5" y="-21912.61" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_mlp_fc2_gpu3&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge68" class="edge">
<title>layer_1_mlp_fc2_gpu3&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M555.37,-21905.44C542.9,-21894.67 528.12,-21881.89 514.51,-21870.13"/>
<polygon fill="black" stroke="black" points="516.51,-21867.24 506.66,-21863.35 511.93,-21872.54 516.51,-21867.24"/>
</g>
<!-- layer_1_allreduce_mlp&#45;&gt;layer_1_residual2 -->
<g id="edge69" class="edge">
<title>layer_1_allreduce_mlp&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M499.15,-21799.81C507.36,-21789.95 516.58,-21778.86 525.48,-21768.17"/>
<polygon fill="black" stroke="black" points="528.18,-21770.4 531.88,-21760.47 522.79,-21765.92 528.18,-21770.4"/>
</g>
<!-- layer_1_ln2 -->
<g id="node55" class="node">
<title>layer_1_ln2</title>
<polygon fill="lightblue" stroke="black" points="602,-21642.07 529,-21642.07 529,-21590.07 602,-21590.07 602,-21642.07"/>
<text text-anchor="middle" x="565.5" y="-21630.07" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="565.5" y="-21619.07" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="565.5" y="-21608.07" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="565.5" y="-21597.07" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- layer_1_residual2&#45;&gt;layer_1_ln2 -->
<g id="edge71" class="edge">
<title>layer_1_residual2&#45;&gt;layer_1_ln2</title>
<path fill="none" stroke="black" d="M565.5,-21677.86C565.5,-21669.43 565.5,-21660.6 565.5,-21652.36"/>
<polygon fill="black" stroke="black" points="569,-21652.32 565.5,-21642.32 562,-21652.32 569,-21652.32"/>
</g>
<!-- layer_1_to_gpu1 -->
<g id="node56" class="node">
<title>layer_1_to_gpu1</title>
<ellipse fill="purple" stroke="black" cx="565.5" cy="-21525.08" rx="58.88" ry="28.98"/>
<text text-anchor="middle" x="565.5" y="-21533.58" font-family="Arial" font-size="10.00">Layer 1→2</text>
<text text-anchor="middle" x="565.5" y="-21522.58" font-family="Arial" font-size="10.00">Pipeline Comm</text>
<text text-anchor="middle" x="565.5" y="-21511.58" font-family="Arial" font-size="10.00">GPU 0→1</text>
</g>
<!-- layer_1_ln2&#45;&gt;layer_1_to_gpu1 -->
<g id="edge72" class="edge">
<title>layer_1_ln2&#45;&gt;layer_1_to_gpu1</title>
<path fill="none" stroke="black" d="M565.5,-21589.81C565.5,-21581.91 565.5,-21573.02 565.5,-21564.44"/>
<polygon fill="black" stroke="black" points="569,-21564.22 565.5,-21554.22 562,-21564.22 569,-21564.22"/>
</g>
<!-- layer_2_input_dist -->
<g id="node57" class="node">
<title>layer_2_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="659.69,-21460.09 509.86,-21460.09 471.31,-21378.09 621.14,-21378.09 659.69,-21460.09"/>
<text text-anchor="middle" x="565.5" y="-21427.59" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="565.5" y="-21416.59" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="565.5" y="-21405.59" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_1_to_gpu1&#45;&gt;layer_2_input_dist -->
<g id="edge73" class="edge">
<title>layer_1_to_gpu1&#45;&gt;layer_2_input_dist</title>
<path fill="none" stroke="black" d="M565.5,-21495.94C565.5,-21488.07 565.5,-21479.27 565.5,-21470.53"/>
<polygon fill="black" stroke="black" points="569,-21470.35 565.5,-21460.35 562,-21470.35 569,-21470.35"/>
</g>
<!-- layer_2_qkv_gpu4 -->
<g id="node58" class="node">
<title>layer_2_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="390,-21342.09 297,-21342.09 297,-21290.09 390,-21290.09 390,-21342.09"/>
<text text-anchor="middle" x="343.5" y="-21330.09" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="343.5" y="-21319.09" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="343.5" y="-21308.09" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="343.5" y="-21297.09" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu4 -->
<g id="edge74" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu4</title>
<path fill="none" stroke="black" d="M477.44,-21378.02C451.15,-21366.06 423.07,-21353.29 399.44,-21342.54"/>
<polygon fill="black" stroke="black" points="400.83,-21339.32 390.28,-21338.37 397.93,-21345.7 400.83,-21339.32"/>
</g>
<!-- layer_2_qkv_gpu5 -->
<g id="node59" class="node">
<title>layer_2_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="501,-21342.09 408,-21342.09 408,-21290.09 501,-21290.09 501,-21342.09"/>
<text text-anchor="middle" x="454.5" y="-21330.09" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="454.5" y="-21319.09" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="454.5" y="-21308.09" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="454.5" y="-21297.09" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu5 -->
<g id="edge75" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu5</title>
<path fill="none" stroke="black" d="M521.31,-21377.88C510.81,-21368.32 499.74,-21358.25 489.7,-21349.12"/>
<polygon fill="black" stroke="black" points="492,-21346.48 482.25,-21342.34 487.29,-21351.66 492,-21346.48"/>
</g>
<!-- layer_2_qkv_gpu6 -->
<g id="node60" class="node">
<title>layer_2_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="612,-21342.09 519,-21342.09 519,-21290.09 612,-21290.09 612,-21342.09"/>
<text text-anchor="middle" x="565.5" y="-21330.09" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="565.5" y="-21319.09" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="565.5" y="-21308.09" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="565.5" y="-21297.09" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu6 -->
<g id="edge76" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu6</title>
<path fill="none" stroke="black" d="M565.5,-21377.88C565.5,-21369.45 565.5,-21360.61 565.5,-21352.38"/>
<polygon fill="black" stroke="black" points="569,-21352.34 565.5,-21342.34 562,-21352.34 569,-21352.34"/>
</g>
<!-- layer_2_qkv_gpu7 -->
<g id="node61" class="node">
<title>layer_2_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="723,-21342.09 630,-21342.09 630,-21290.09 723,-21290.09 723,-21342.09"/>
<text text-anchor="middle" x="676.5" y="-21330.09" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="676.5" y="-21319.09" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="676.5" y="-21308.09" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="676.5" y="-21297.09" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu7 -->
<g id="edge77" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu7</title>
<path fill="none" stroke="black" d="M609.69,-21377.88C620.19,-21368.32 631.26,-21358.25 641.3,-21349.12"/>
<polygon fill="black" stroke="black" points="643.71,-21351.66 648.75,-21342.34 639,-21346.48 643.71,-21351.66"/>
</g>
<!-- layer_2_residual1 -->
<g id="node69" class="node">
<title>layer_2_residual1</title>
<polygon fill="lightyellow" stroke="black" points="763.44,-20859.01 641.05,-20859.01 609.56,-20777.01 731.95,-20777.01 763.44,-20859.01"/>
<text text-anchor="middle" x="686.5" y="-20826.51" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="686.5" y="-20815.51" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="686.5" y="-20804.51" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_residual1 -->
<g id="edge89" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M632.52,-21401.31C666.53,-21389.72 706.11,-21371.05 732.5,-21342.09 771.73,-21299.05 775.5,-21276.55 775.5,-21218.32 775.5,-21218.32 775.5,-21218.32 775.5,-21029.55 775.5,-20970.58 745.51,-20909.13 720.35,-20867.95"/>
<polygon fill="black" stroke="black" points="723.17,-20865.85 714.9,-20859.22 717.23,-20869.56 723.17,-20865.85"/>
</g>
<!-- layer_2_allgather_qkv -->
<g id="node62" class="node">
<title>layer_2_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="454.5" cy="-21217.32" rx="57.05" ry="36.54"/>
<text text-anchor="middle" x="454.5" y="-21231.32" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="454.5" y="-21220.32" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="454.5" y="-21209.32" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="454.5" y="-21198.32" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_2_qkv_gpu4&#45;&gt;layer_2_allgather_qkv -->
<g id="edge78" class="edge">
<title>layer_2_qkv_gpu4&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M372.37,-21289.91C384.83,-21279.05 399.64,-21266.15 413.22,-21254.3"/>
<polygon fill="black" stroke="black" points="415.81,-21256.69 421.05,-21247.48 411.21,-21251.41 415.81,-21256.69"/>
</g>
<!-- layer_2_qkv_gpu5&#45;&gt;layer_2_allgather_qkv -->
<g id="edge79" class="edge">
<title>layer_2_qkv_gpu5&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M454.5,-21289.91C454.5,-21282.11 454.5,-21273.24 454.5,-21264.47"/>
<polygon fill="black" stroke="black" points="458,-21264.29 454.5,-21254.29 451,-21264.29 458,-21264.29"/>
</g>
<!-- layer_2_qkv_gpu6&#45;&gt;layer_2_allgather_qkv -->
<g id="edge80" class="edge">
<title>layer_2_qkv_gpu6&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M536.63,-21289.91C524.17,-21279.05 509.36,-21266.15 495.78,-21254.3"/>
<polygon fill="black" stroke="black" points="497.79,-21251.41 487.95,-21247.48 493.19,-21256.69 497.79,-21251.41"/>
</g>
<!-- layer_2_qkv_gpu7&#45;&gt;layer_2_allgather_qkv -->
<g id="edge81" class="edge">
<title>layer_2_qkv_gpu7&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M629.72,-21293.74C626.94,-21292.5 624.19,-21291.27 621.5,-21290.09 584.85,-21273.89 543.48,-21256.1 511.08,-21242.29"/>
<polygon fill="black" stroke="black" points="512.33,-21239.02 501.76,-21238.32 509.59,-21245.46 512.33,-21239.02"/>
</g>
<!-- layer_2_attention -->
<g id="node63" class="node">
<title>layer_2_attention</title>
<polygon fill="lightblue" stroke="black" points="442.5,-21144.55 374.5,-21144.55 374.5,-21092.55 442.5,-21092.55 442.5,-21144.55"/>
<text text-anchor="middle" x="408.5" y="-21132.55" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="408.5" y="-21121.55" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="408.5" y="-21110.55" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="408.5" y="-21099.55" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_2_allgather_qkv&#45;&gt;layer_2_attention -->
<g id="edge82" class="edge">
<title>layer_2_allgather_qkv&#45;&gt;layer_2_attention</title>
<path fill="none" stroke="black" d="M438.15,-21181.93C433.82,-21172.81 429.15,-21162.98 424.82,-21153.87"/>
<polygon fill="black" stroke="black" points="427.91,-21152.23 420.46,-21144.7 421.59,-21155.24 427.91,-21152.23"/>
</g>
<!-- layer_2_attn_out_gpu4 -->
<g id="node64" class="node">
<title>layer_2_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="429.5,-21056.55 341.5,-21056.55 341.5,-21004.55 429.5,-21004.55 429.5,-21056.55"/>
<text text-anchor="middle" x="385.5" y="-21044.55" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="385.5" y="-21033.55" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="385.5" y="-21022.55" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="385.5" y="-21011.55" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attention&#45;&gt;layer_2_attn_out_gpu4 -->
<g id="edge83" class="edge">
<title>layer_2_attention&#45;&gt;layer_2_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M401.72,-21092.21C399.57,-21084.16 397.15,-21075.11 394.85,-21066.51"/>
<polygon fill="black" stroke="black" points="398.19,-21065.46 392.23,-21056.7 391.43,-21067.27 398.19,-21065.46"/>
</g>
<!-- layer_2_allreduce_attn -->
<g id="node68" class="node">
<title>layer_2_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="597.5" cy="-20931.78" rx="57.97" ry="36.54"/>
<text text-anchor="middle" x="597.5" y="-20945.78" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="597.5" y="-20934.78" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="597.5" y="-20923.78" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="597.5" y="-20912.78" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_2_attn_out_gpu4&#45;&gt;layer_2_allreduce_attn -->
<g id="edge84" class="edge">
<title>layer_2_attn_out_gpu4&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M429.72,-21008.62C432.69,-21007.24 435.64,-21005.87 438.5,-21004.55 472.64,-20988.79 511.07,-20971.44 541.59,-20957.74"/>
<polygon fill="black" stroke="black" points="543.1,-20960.9 550.79,-20953.61 540.24,-20954.51 543.1,-20960.9"/>
</g>
<!-- layer_2_attn_out_gpu5 -->
<g id="node65" class="node">
<title>layer_2_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="535.5,-21056.55 447.5,-21056.55 447.5,-21004.55 535.5,-21004.55 535.5,-21056.55"/>
<text text-anchor="middle" x="491.5" y="-21044.55" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="491.5" y="-21033.55" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="491.5" y="-21022.55" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="491.5" y="-21011.55" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attn_out_gpu5&#45;&gt;layer_2_allreduce_attn -->
<g id="edge85" class="edge">
<title>layer_2_attn_out_gpu5&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M519.07,-21004.37C530.66,-20993.8 544.36,-20981.29 557.05,-20969.71"/>
<polygon fill="black" stroke="black" points="559.76,-20971.97 564.79,-20962.64 555.04,-20966.8 559.76,-20971.97"/>
</g>
<!-- layer_2_attn_out_gpu6 -->
<g id="node66" class="node">
<title>layer_2_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="641.5,-21056.55 553.5,-21056.55 553.5,-21004.55 641.5,-21004.55 641.5,-21056.55"/>
<text text-anchor="middle" x="597.5" y="-21044.55" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="597.5" y="-21033.55" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="597.5" y="-21022.55" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="597.5" y="-21011.55" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attn_out_gpu6&#45;&gt;layer_2_allreduce_attn -->
<g id="edge86" class="edge">
<title>layer_2_attn_out_gpu6&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M597.5,-21004.37C597.5,-20996.57 597.5,-20987.7 597.5,-20978.93"/>
<polygon fill="black" stroke="black" points="601,-20978.75 597.5,-20968.75 594,-20978.75 601,-20978.75"/>
</g>
<!-- layer_2_attn_out_gpu7 -->
<g id="node67" class="node">
<title>layer_2_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="747.5,-21056.55 659.5,-21056.55 659.5,-21004.55 747.5,-21004.55 747.5,-21056.55"/>
<text text-anchor="middle" x="703.5" y="-21044.55" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="703.5" y="-21033.55" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="703.5" y="-21022.55" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="703.5" y="-21011.55" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attn_out_gpu7&#45;&gt;layer_2_allreduce_attn -->
<g id="edge87" class="edge">
<title>layer_2_attn_out_gpu7&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M675.93,-21004.37C664.34,-20993.8 650.64,-20981.29 637.95,-20969.71"/>
<polygon fill="black" stroke="black" points="639.96,-20966.8 630.21,-20962.64 635.24,-20971.97 639.96,-20966.8"/>
</g>
<!-- layer_2_allreduce_attn&#45;&gt;layer_2_residual1 -->
<g id="edge88" class="edge">
<title>layer_2_allreduce_attn&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M623,-20898.75C630.78,-20888.98 639.51,-20878.02 647.95,-20867.42"/>
<polygon fill="black" stroke="black" points="650.84,-20869.42 654.33,-20859.41 645.36,-20865.06 650.84,-20869.42"/>
</g>
<!-- layer_2_ln1 -->
<g id="node70" class="node">
<title>layer_2_ln1</title>
<polygon fill="lightblue" stroke="black" points="630,-20741.01 557,-20741.01 557,-20689.01 630,-20689.01 630,-20741.01"/>
<text text-anchor="middle" x="593.5" y="-20729.01" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="593.5" y="-20718.01" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="593.5" y="-20707.01" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="593.5" y="-20696.01" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_2_residual1&#45;&gt;layer_2_ln1 -->
<g id="edge90" class="edge">
<title>layer_2_residual1&#45;&gt;layer_2_ln1</title>
<path fill="none" stroke="black" d="M649.48,-20776.8C640.94,-20767.52 631.95,-20757.77 623.74,-20748.85"/>
<polygon fill="black" stroke="black" points="626.1,-20746.25 616.75,-20741.26 620.95,-20750.99 626.1,-20746.25"/>
</g>
<!-- layer_2_residual2 -->
<g id="node82" class="node">
<title>layer_2_residual2</title>
<polygon fill="lightyellow" stroke="black" points="791.44,-20180.93 669.05,-20180.93 637.56,-20098.93 759.95,-20098.93 791.44,-20180.93"/>
<text text-anchor="middle" x="714.5" y="-20148.43" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="714.5" y="-20137.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="714.5" y="-20126.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_2_residual1&#45;&gt;layer_2_residual2 -->
<g id="edge106" class="edge">
<title>layer_2_residual1&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M731.93,-20776.76C766.61,-20741.41 808.5,-20686.59 808.5,-20628.01 808.5,-20628.01 808.5,-20628.01 808.5,-20351.47 808.5,-20292.05 776.89,-20230.75 750.34,-20189.73"/>
<polygon fill="black" stroke="black" points="753.19,-20187.7 744.76,-20181.29 747.35,-20191.56 753.19,-20187.7"/>
</g>
<!-- layer_2_mlp_fc1_gpu4 -->
<g id="node71" class="node">
<title>layer_2_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="416.5,-20653.01 322.5,-20653.01 322.5,-20601.01 416.5,-20601.01 416.5,-20653.01"/>
<text text-anchor="middle" x="369.5" y="-20641.01" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="369.5" y="-20630.01" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="369.5" y="-20619.01" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="369.5" y="-20608.01" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu4 -->
<g id="edge91" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M556.84,-20701.55C524.62,-20690.4 476.31,-20673.25 426.14,-20653.17"/>
<polygon fill="black" stroke="black" points="427.34,-20649.88 416.75,-20649.39 424.72,-20656.37 427.34,-20649.88"/>
</g>
<!-- layer_2_mlp_fc1_gpu5 -->
<g id="node72" class="node">
<title>layer_2_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="528.5,-20653.01 434.5,-20653.01 434.5,-20601.01 528.5,-20601.01 528.5,-20653.01"/>
<text text-anchor="middle" x="481.5" y="-20641.01" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="481.5" y="-20630.01" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="481.5" y="-20619.01" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="481.5" y="-20608.01" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu5 -->
<g id="edge92" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M560.8,-20688.9C548.83,-20679.71 535.13,-20669.19 522.53,-20659.51"/>
<polygon fill="black" stroke="black" points="524.49,-20656.61 514.43,-20653.29 520.23,-20662.16 524.49,-20656.61"/>
</g>
<!-- layer_2_mlp_fc1_gpu6 -->
<g id="node73" class="node">
<title>layer_2_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="640.5,-20653.01 546.5,-20653.01 546.5,-20601.01 640.5,-20601.01 640.5,-20653.01"/>
<text text-anchor="middle" x="593.5" y="-20641.01" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="593.5" y="-20630.01" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="593.5" y="-20619.01" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="593.5" y="-20608.01" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu6 -->
<g id="edge93" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M593.5,-20688.67C593.5,-20680.71 593.5,-20671.77 593.5,-20663.25"/>
<polygon fill="black" stroke="black" points="597,-20663.16 593.5,-20653.16 590,-20663.16 597,-20663.16"/>
</g>
<!-- layer_2_mlp_fc1_gpu7 -->
<g id="node74" class="node">
<title>layer_2_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="752.5,-20653.01 658.5,-20653.01 658.5,-20601.01 752.5,-20601.01 752.5,-20653.01"/>
<text text-anchor="middle" x="705.5" y="-20641.01" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="705.5" y="-20630.01" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="705.5" y="-20619.01" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="705.5" y="-20608.01" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu7 -->
<g id="edge94" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M626.2,-20688.9C638.17,-20679.71 651.87,-20669.19 664.47,-20659.51"/>
<polygon fill="black" stroke="black" points="666.77,-20662.16 672.57,-20653.29 662.51,-20656.61 666.77,-20662.16"/>
</g>
<!-- layer_2_allgather_mlp -->
<g id="node75" class="node">
<title>layer_2_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="481.5" cy="-20528.24" rx="56.64" ry="36.54"/>
<text text-anchor="middle" x="481.5" y="-20542.24" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="481.5" y="-20531.24" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="481.5" y="-20520.24" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="481.5" y="-20509.24" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_2_mlp_fc1_gpu4&#45;&gt;layer_2_allgather_mlp -->
<g id="edge95" class="edge">
<title>layer_2_mlp_fc1_gpu4&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M398.63,-20600.84C411.31,-20589.88 426.4,-20576.85 440.2,-20564.92"/>
<polygon fill="black" stroke="black" points="442.87,-20567.24 448.15,-20558.05 438.3,-20561.94 442.87,-20567.24"/>
</g>
<!-- layer_2_mlp_fc1_gpu5&#45;&gt;layer_2_allgather_mlp -->
<g id="edge96" class="edge">
<title>layer_2_mlp_fc1_gpu5&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M481.5,-20600.84C481.5,-20593.03 481.5,-20584.16 481.5,-20575.39"/>
<polygon fill="black" stroke="black" points="485,-20575.22 481.5,-20565.22 478,-20575.22 485,-20575.22"/>
</g>
<!-- layer_2_mlp_fc1_gpu6&#45;&gt;layer_2_allgather_mlp -->
<g id="edge97" class="edge">
<title>layer_2_mlp_fc1_gpu6&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M564.37,-20600.84C551.69,-20589.88 536.6,-20576.85 522.8,-20564.92"/>
<polygon fill="black" stroke="black" points="524.7,-20561.94 514.85,-20558.05 520.13,-20567.24 524.7,-20561.94"/>
</g>
<!-- layer_2_mlp_fc1_gpu7&#45;&gt;layer_2_allgather_mlp -->
<g id="edge98" class="edge">
<title>layer_2_mlp_fc1_gpu7&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M658.47,-20604.95C655.44,-20603.61 652.43,-20602.29 649.5,-20601.01 612.33,-20584.77 570.38,-20566.85 537.69,-20552.98"/>
<polygon fill="black" stroke="black" points="538.87,-20549.67 528.3,-20548.99 536.14,-20556.12 538.87,-20549.67"/>
</g>
<!-- layer_2_gelu -->
<g id="node76" class="node">
<title>layer_2_gelu</title>
<polygon fill="lightblue" stroke="black" points="470,-20455.47 381,-20455.47 381,-20414.47 470,-20414.47 470,-20455.47"/>
<text text-anchor="middle" x="425.5" y="-20443.47" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="425.5" y="-20432.47" font-family="Arial" font-size="10.00">GELU Activation</text>
<text text-anchor="middle" x="425.5" y="-20421.47" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_2_allgather_mlp&#45;&gt;layer_2_gelu -->
<g id="edge99" class="edge">
<title>layer_2_allgather_mlp&#45;&gt;layer_2_gelu</title>
<path fill="none" stroke="black" d="M460.97,-20493.77C455,-20484.06 448.56,-20473.55 442.81,-20464.19"/>
<polygon fill="black" stroke="black" points="445.78,-20462.32 437.56,-20455.63 439.81,-20465.98 445.78,-20462.32"/>
</g>
<!-- layer_2_mlp_fc2_gpu4 -->
<g id="node77" class="node">
<title>layer_2_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="444.5,-20378.47 350.5,-20378.47 350.5,-20326.47 444.5,-20326.47 444.5,-20378.47"/>
<text text-anchor="middle" x="397.5" y="-20366.47" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="397.5" y="-20355.47" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="397.5" y="-20344.47" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="397.5" y="-20333.47" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu4 -->
<g id="edge100" class="edge">
<title>layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu4</title>
<path fill="none" stroke="black" d="M418.58,-20414.07C415.87,-20406.29 412.69,-20397.13 409.62,-20388.33"/>
<polygon fill="black" stroke="black" points="412.84,-20386.92 406.25,-20378.62 406.23,-20389.22 412.84,-20386.92"/>
</g>
<!-- layer_2_allreduce_mlp -->
<g id="node81" class="node">
<title>layer_2_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="621.5" cy="-20253.7" rx="60.21" ry="36.54"/>
<text text-anchor="middle" x="621.5" y="-20267.7" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="621.5" y="-20256.7" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="621.5" y="-20245.7" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="621.5" y="-20234.7" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_2_mlp_fc2_gpu4&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge101" class="edge">
<title>layer_2_mlp_fc2_gpu4&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M444.53,-20330.41C447.56,-20329.07 450.57,-20327.75 453.5,-20326.47 489.87,-20310.58 530.83,-20293.08 563.2,-20279.33"/>
<polygon fill="black" stroke="black" points="564.69,-20282.5 572.52,-20275.38 561.95,-20276.06 564.69,-20282.5"/>
</g>
<!-- layer_2_mlp_fc2_gpu5 -->
<g id="node78" class="node">
<title>layer_2_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="556.5,-20378.47 462.5,-20378.47 462.5,-20326.47 556.5,-20326.47 556.5,-20378.47"/>
<text text-anchor="middle" x="509.5" y="-20366.47" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="509.5" y="-20355.47" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="509.5" y="-20344.47" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="509.5" y="-20333.47" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_mlp_fc2_gpu5&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge102" class="edge">
<title>layer_2_mlp_fc2_gpu5&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M538.63,-20326.3C551.1,-20315.53 565.88,-20302.75 579.49,-20290.99"/>
<polygon fill="black" stroke="black" points="582.07,-20293.4 587.34,-20284.21 577.49,-20288.1 582.07,-20293.4"/>
</g>
<!-- layer_2_mlp_fc2_gpu6 -->
<g id="node79" class="node">
<title>layer_2_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="668.5,-20378.47 574.5,-20378.47 574.5,-20326.47 668.5,-20326.47 668.5,-20378.47"/>
<text text-anchor="middle" x="621.5" y="-20366.47" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="621.5" y="-20355.47" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="621.5" y="-20344.47" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="621.5" y="-20333.47" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_mlp_fc2_gpu6&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge103" class="edge">
<title>layer_2_mlp_fc2_gpu6&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M621.5,-20326.3C621.5,-20318.49 621.5,-20309.62 621.5,-20300.85"/>
<polygon fill="black" stroke="black" points="625,-20300.68 621.5,-20290.68 618,-20300.68 625,-20300.68"/>
</g>
<!-- layer_2_mlp_fc2_gpu7 -->
<g id="node80" class="node">
<title>layer_2_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="780.5,-20378.47 686.5,-20378.47 686.5,-20326.47 780.5,-20326.47 780.5,-20378.47"/>
<text text-anchor="middle" x="733.5" y="-20366.47" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="733.5" y="-20355.47" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="733.5" y="-20344.47" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="733.5" y="-20333.47" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_mlp_fc2_gpu7&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge104" class="edge">
<title>layer_2_mlp_fc2_gpu7&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M704.37,-20326.3C691.9,-20315.53 677.12,-20302.75 663.51,-20290.99"/>
<polygon fill="black" stroke="black" points="665.51,-20288.1 655.66,-20284.21 660.93,-20293.4 665.51,-20288.1"/>
</g>
<!-- layer_2_allreduce_mlp&#45;&gt;layer_2_residual2 -->
<g id="edge105" class="edge">
<title>layer_2_allreduce_mlp&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M648.15,-20220.67C656.36,-20210.81 665.58,-20199.73 674.48,-20189.03"/>
<polygon fill="black" stroke="black" points="677.18,-20191.26 680.88,-20181.33 671.79,-20186.78 677.18,-20191.26"/>
</g>
<!-- layer_2_ln2 -->
<g id="node83" class="node">
<title>layer_2_ln2</title>
<polygon fill="lightblue" stroke="black" points="751,-20062.93 678,-20062.93 678,-20010.93 751,-20010.93 751,-20062.93"/>
<text text-anchor="middle" x="714.5" y="-20050.93" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="714.5" y="-20039.93" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="714.5" y="-20028.93" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="714.5" y="-20017.93" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_2_residual2&#45;&gt;layer_2_ln2 -->
<g id="edge107" class="edge">
<title>layer_2_residual2&#45;&gt;layer_2_ln2</title>
<path fill="none" stroke="black" d="M714.5,-20098.72C714.5,-20090.29 714.5,-20081.46 714.5,-20073.22"/>
<polygon fill="black" stroke="black" points="718,-20073.18 714.5,-20063.18 711,-20073.18 718,-20073.18"/>
</g>
<!-- layer_3_input_dist -->
<g id="node84" class="node">
<title>layer_3_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="808.69,-19974.93 658.86,-19974.93 620.31,-19892.93 770.14,-19892.93 808.69,-19974.93"/>
<text text-anchor="middle" x="714.5" y="-19942.43" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="714.5" y="-19931.43" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="714.5" y="-19920.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_2_ln2&#45;&gt;layer_3_input_dist -->
<g id="edge108" class="edge">
<title>layer_2_ln2&#45;&gt;layer_3_input_dist</title>
<path fill="none" stroke="black" d="M714.5,-20010.7C714.5,-20002.98 714.5,-19994.19 714.5,-19985.4"/>
<polygon fill="black" stroke="black" points="718,-19985.14 714.5,-19975.14 711,-19985.14 718,-19985.14"/>
</g>
<!-- layer_3_qkv_gpu4 -->
<g id="node85" class="node">
<title>layer_3_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="539,-19856.93 446,-19856.93 446,-19804.93 539,-19804.93 539,-19856.93"/>
<text text-anchor="middle" x="492.5" y="-19844.93" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="492.5" y="-19833.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="492.5" y="-19822.93" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="492.5" y="-19811.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu4 -->
<g id="edge109" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu4</title>
<path fill="none" stroke="black" d="M626.44,-19892.87C600.15,-19880.91 572.07,-19868.13 548.44,-19857.38"/>
<polygon fill="black" stroke="black" points="549.83,-19854.17 539.28,-19853.21 546.93,-19860.54 549.83,-19854.17"/>
</g>
<!-- layer_3_qkv_gpu5 -->
<g id="node86" class="node">
<title>layer_3_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="650,-19856.93 557,-19856.93 557,-19804.93 650,-19804.93 650,-19856.93"/>
<text text-anchor="middle" x="603.5" y="-19844.93" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="603.5" y="-19833.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="603.5" y="-19822.93" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="603.5" y="-19811.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu5 -->
<g id="edge110" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu5</title>
<path fill="none" stroke="black" d="M670.31,-19892.72C659.81,-19883.17 648.74,-19873.1 638.7,-19863.96"/>
<polygon fill="black" stroke="black" points="641,-19861.32 631.25,-19857.18 636.29,-19866.5 641,-19861.32"/>
</g>
<!-- layer_3_qkv_gpu6 -->
<g id="node87" class="node">
<title>layer_3_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="761,-19856.93 668,-19856.93 668,-19804.93 761,-19804.93 761,-19856.93"/>
<text text-anchor="middle" x="714.5" y="-19844.93" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="714.5" y="-19833.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="714.5" y="-19822.93" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="714.5" y="-19811.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu6 -->
<g id="edge111" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu6</title>
<path fill="none" stroke="black" d="M714.5,-19892.72C714.5,-19884.29 714.5,-19875.46 714.5,-19867.22"/>
<polygon fill="black" stroke="black" points="718,-19867.18 714.5,-19857.18 711,-19867.18 718,-19867.18"/>
</g>
<!-- layer_3_qkv_gpu7 -->
<g id="node88" class="node">
<title>layer_3_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="872,-19856.93 779,-19856.93 779,-19804.93 872,-19804.93 872,-19856.93"/>
<text text-anchor="middle" x="825.5" y="-19844.93" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="825.5" y="-19833.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="825.5" y="-19822.93" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="825.5" y="-19811.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu7 -->
<g id="edge112" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu7</title>
<path fill="none" stroke="black" d="M758.69,-19892.72C769.19,-19883.17 780.26,-19873.1 790.3,-19863.96"/>
<polygon fill="black" stroke="black" points="792.71,-19866.5 797.75,-19857.18 788,-19861.32 792.71,-19866.5"/>
</g>
<!-- layer_3_residual1 -->
<g id="node96" class="node">
<title>layer_3_residual1</title>
<polygon fill="lightyellow" stroke="black" points="911.44,-19373.85 789.05,-19373.85 757.56,-19291.85 879.95,-19291.85 911.44,-19373.85"/>
<text text-anchor="middle" x="834.5" y="-19341.35" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="834.5" y="-19330.35" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="834.5" y="-19319.35" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_residual1 -->
<g id="edge124" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M781.19,-19916.37C815.31,-19904.82 855.11,-19886.1 881.5,-19856.93 920.47,-19813.85 923.5,-19791.25 923.5,-19733.16 923.5,-19733.16 923.5,-19733.16 923.5,-19544.39 923.5,-19485.42 893.51,-19423.97 868.35,-19382.79"/>
<polygon fill="black" stroke="black" points="871.17,-19380.7 862.9,-19374.06 865.23,-19384.4 871.17,-19380.7"/>
</g>
<!-- layer_3_allgather_qkv -->
<g id="node89" class="node">
<title>layer_3_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="603.5" cy="-19732.16" rx="57.05" ry="36.54"/>
<text text-anchor="middle" x="603.5" y="-19746.16" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="603.5" y="-19735.16" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="603.5" y="-19724.16" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="603.5" y="-19713.16" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_3_qkv_gpu4&#45;&gt;layer_3_allgather_qkv -->
<g id="edge113" class="edge">
<title>layer_3_qkv_gpu4&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M521.37,-19804.76C533.83,-19793.9 548.64,-19780.99 562.22,-19769.15"/>
<polygon fill="black" stroke="black" points="564.81,-19771.53 570.05,-19762.32 560.21,-19766.25 564.81,-19771.53"/>
</g>
<!-- layer_3_qkv_gpu5&#45;&gt;layer_3_allgather_qkv -->
<g id="edge114" class="edge">
<title>layer_3_qkv_gpu5&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M603.5,-19804.76C603.5,-19796.95 603.5,-19788.08 603.5,-19779.32"/>
<polygon fill="black" stroke="black" points="607,-19779.14 603.5,-19769.14 600,-19779.14 607,-19779.14"/>
</g>
<!-- layer_3_qkv_gpu6&#45;&gt;layer_3_allgather_qkv -->
<g id="edge115" class="edge">
<title>layer_3_qkv_gpu6&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M685.63,-19804.76C673.17,-19793.9 658.36,-19780.99 644.78,-19769.15"/>
<polygon fill="black" stroke="black" points="646.79,-19766.25 636.95,-19762.32 642.19,-19771.53 646.79,-19766.25"/>
</g>
<!-- layer_3_qkv_gpu7&#45;&gt;layer_3_allgather_qkv -->
<g id="edge116" class="edge">
<title>layer_3_qkv_gpu7&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M778.72,-19808.59C775.94,-19807.34 773.19,-19806.12 770.5,-19804.93 733.85,-19788.73 692.48,-19770.94 660.08,-19757.13"/>
<polygon fill="black" stroke="black" points="661.33,-19753.86 650.76,-19753.16 658.59,-19760.3 661.33,-19753.86"/>
</g>
<!-- layer_3_attention -->
<g id="node90" class="node">
<title>layer_3_attention</title>
<polygon fill="lightblue" stroke="black" points="613.5,-19659.39 545.5,-19659.39 545.5,-19607.39 613.5,-19607.39 613.5,-19659.39"/>
<text text-anchor="middle" x="579.5" y="-19647.39" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="579.5" y="-19636.39" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="579.5" y="-19625.39" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="579.5" y="-19614.39" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_3_allgather_qkv&#45;&gt;layer_3_attention -->
<g id="edge117" class="edge">
<title>layer_3_allgather_qkv&#45;&gt;layer_3_attention</title>
<path fill="none" stroke="black" d="M594.7,-19695.68C592.56,-19687.07 590.28,-19677.87 588.16,-19669.29"/>
<polygon fill="black" stroke="black" points="591.55,-19668.44 585.75,-19659.58 584.76,-19670.13 591.55,-19668.44"/>
</g>
<!-- layer_3_attn_out_gpu4 -->
<g id="node91" class="node">
<title>layer_3_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="577.5,-19571.39 489.5,-19571.39 489.5,-19519.39 577.5,-19519.39 577.5,-19571.39"/>
<text text-anchor="middle" x="533.5" y="-19559.39" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="533.5" y="-19548.39" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="533.5" y="-19537.39" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="533.5" y="-19526.39" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attention&#45;&gt;layer_3_attn_out_gpu4 -->
<g id="edge118" class="edge">
<title>layer_3_attention&#45;&gt;layer_3_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M565.95,-19607.05C561.5,-19598.74 556.49,-19589.37 551.75,-19580.52"/>
<polygon fill="black" stroke="black" points="554.76,-19578.71 546.96,-19571.55 548.59,-19582.02 554.76,-19578.71"/>
</g>
<!-- layer_3_allreduce_attn -->
<g id="node95" class="node">
<title>layer_3_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="745.5" cy="-19446.62" rx="57.97" ry="36.54"/>
<text text-anchor="middle" x="745.5" y="-19460.62" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="745.5" y="-19449.62" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="745.5" y="-19438.62" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="745.5" y="-19427.62" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_3_attn_out_gpu4&#45;&gt;layer_3_allreduce_attn -->
<g id="edge119" class="edge">
<title>layer_3_attn_out_gpu4&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M577.72,-19523.46C580.69,-19522.08 583.64,-19520.71 586.5,-19519.39 620.64,-19503.63 659.07,-19486.28 689.59,-19472.58"/>
<polygon fill="black" stroke="black" points="691.1,-19475.74 698.79,-19468.46 688.24,-19469.35 691.1,-19475.74"/>
</g>
<!-- layer_3_attn_out_gpu5 -->
<g id="node92" class="node">
<title>layer_3_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="683.5,-19571.39 595.5,-19571.39 595.5,-19519.39 683.5,-19519.39 683.5,-19571.39"/>
<text text-anchor="middle" x="639.5" y="-19559.39" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="639.5" y="-19548.39" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="639.5" y="-19537.39" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="639.5" y="-19526.39" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attn_out_gpu5&#45;&gt;layer_3_allreduce_attn -->
<g id="edge120" class="edge">
<title>layer_3_attn_out_gpu5&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M667.07,-19519.22C678.66,-19508.64 692.36,-19496.13 705.05,-19484.55"/>
<polygon fill="black" stroke="black" points="707.76,-19486.81 712.79,-19477.48 703.04,-19481.64 707.76,-19486.81"/>
</g>
<!-- layer_3_attn_out_gpu6 -->
<g id="node93" class="node">
<title>layer_3_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="789.5,-19571.39 701.5,-19571.39 701.5,-19519.39 789.5,-19519.39 789.5,-19571.39"/>
<text text-anchor="middle" x="745.5" y="-19559.39" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="745.5" y="-19548.39" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="745.5" y="-19537.39" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="745.5" y="-19526.39" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attn_out_gpu6&#45;&gt;layer_3_allreduce_attn -->
<g id="edge121" class="edge">
<title>layer_3_attn_out_gpu6&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M745.5,-19519.22C745.5,-19511.41 745.5,-19502.54 745.5,-19493.78"/>
<polygon fill="black" stroke="black" points="749,-19493.6 745.5,-19483.6 742,-19493.6 749,-19493.6"/>
</g>
<!-- layer_3_attn_out_gpu7 -->
<g id="node94" class="node">
<title>layer_3_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="895.5,-19571.39 807.5,-19571.39 807.5,-19519.39 895.5,-19519.39 895.5,-19571.39"/>
<text text-anchor="middle" x="851.5" y="-19559.39" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="851.5" y="-19548.39" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="851.5" y="-19537.39" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="851.5" y="-19526.39" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attn_out_gpu7&#45;&gt;layer_3_allreduce_attn -->
<g id="edge122" class="edge">
<title>layer_3_attn_out_gpu7&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M823.93,-19519.22C812.34,-19508.64 798.64,-19496.13 785.95,-19484.55"/>
<polygon fill="black" stroke="black" points="787.96,-19481.64 778.21,-19477.48 783.24,-19486.81 787.96,-19481.64"/>
</g>
<!-- layer_3_allreduce_attn&#45;&gt;layer_3_residual1 -->
<g id="edge123" class="edge">
<title>layer_3_allreduce_attn&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M771,-19413.59C778.78,-19403.83 787.51,-19392.86 795.95,-19382.26"/>
<polygon fill="black" stroke="black" points="798.84,-19384.26 802.33,-19374.26 793.36,-19379.9 798.84,-19384.26"/>
</g>
<!-- layer_3_ln1 -->
<g id="node97" class="node">
<title>layer_3_ln1</title>
<polygon fill="lightblue" stroke="black" points="778,-19255.85 705,-19255.85 705,-19203.85 778,-19203.85 778,-19255.85"/>
<text text-anchor="middle" x="741.5" y="-19243.85" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="741.5" y="-19232.85" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="741.5" y="-19221.85" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="741.5" y="-19210.85" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_3_residual1&#45;&gt;layer_3_ln1 -->
<g id="edge125" class="edge">
<title>layer_3_residual1&#45;&gt;layer_3_ln1</title>
<path fill="none" stroke="black" d="M797.48,-19291.64C788.94,-19282.37 779.95,-19272.61 771.74,-19263.69"/>
<polygon fill="black" stroke="black" points="774.1,-19261.09 764.75,-19256.1 768.95,-19265.83 774.1,-19261.09"/>
</g>
<!-- layer_3_residual2 -->
<g id="node109" class="node">
<title>layer_3_residual2</title>
<polygon fill="lightyellow" stroke="black" points="939.44,-18695.77 817.05,-18695.77 785.56,-18613.77 907.95,-18613.77 939.44,-18695.77"/>
<text text-anchor="middle" x="862.5" y="-18663.27" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="862.5" y="-18652.27" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="862.5" y="-18641.27" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_3_residual1&#45;&gt;layer_3_residual2 -->
<g id="edge141" class="edge">
<title>layer_3_residual1&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M879.93,-19291.61C914.61,-19256.25 956.5,-19201.43 956.5,-19142.85 956.5,-19142.85 956.5,-19142.85 956.5,-18866.31 956.5,-18806.89 924.89,-18745.59 898.34,-18704.57"/>
<polygon fill="black" stroke="black" points="901.19,-18702.55 892.76,-18696.13 895.35,-18706.41 901.19,-18702.55"/>
</g>
<!-- layer_3_mlp_fc1_gpu4 -->
<g id="node98" class="node">
<title>layer_3_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="564.5,-19167.85 470.5,-19167.85 470.5,-19115.85 564.5,-19115.85 564.5,-19167.85"/>
<text text-anchor="middle" x="517.5" y="-19155.85" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="517.5" y="-19144.85" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="517.5" y="-19133.85" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="517.5" y="-19122.85" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu4 -->
<g id="edge126" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M704.84,-19216.39C672.62,-19205.25 624.31,-19188.09 574.14,-19168.01"/>
<polygon fill="black" stroke="black" points="575.34,-19164.72 564.75,-19164.23 572.72,-19171.22 575.34,-19164.72"/>
</g>
<!-- layer_3_mlp_fc1_gpu5 -->
<g id="node99" class="node">
<title>layer_3_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="676.5,-19167.85 582.5,-19167.85 582.5,-19115.85 676.5,-19115.85 676.5,-19167.85"/>
<text text-anchor="middle" x="629.5" y="-19155.85" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="629.5" y="-19144.85" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="629.5" y="-19133.85" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="629.5" y="-19122.85" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu5 -->
<g id="edge127" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M708.8,-19203.75C696.83,-19194.55 683.13,-19184.04 670.53,-19174.36"/>
<polygon fill="black" stroke="black" points="672.49,-19171.45 662.43,-19168.14 668.23,-19177 672.49,-19171.45"/>
</g>
<!-- layer_3_mlp_fc1_gpu6 -->
<g id="node100" class="node">
<title>layer_3_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="788.5,-19167.85 694.5,-19167.85 694.5,-19115.85 788.5,-19115.85 788.5,-19167.85"/>
<text text-anchor="middle" x="741.5" y="-19155.85" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="741.5" y="-19144.85" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="741.5" y="-19133.85" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="741.5" y="-19122.85" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu6 -->
<g id="edge128" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M741.5,-19203.51C741.5,-19195.55 741.5,-19186.62 741.5,-19178.1"/>
<polygon fill="black" stroke="black" points="745,-19178.01 741.5,-19168.01 738,-19178.01 745,-19178.01"/>
</g>
<!-- layer_3_mlp_fc1_gpu7 -->
<g id="node101" class="node">
<title>layer_3_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="900.5,-19167.85 806.5,-19167.85 806.5,-19115.85 900.5,-19115.85 900.5,-19167.85"/>
<text text-anchor="middle" x="853.5" y="-19155.85" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="853.5" y="-19144.85" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="853.5" y="-19133.85" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="853.5" y="-19122.85" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu7 -->
<g id="edge129" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M774.2,-19203.75C786.17,-19194.55 799.87,-19184.04 812.47,-19174.36"/>
<polygon fill="black" stroke="black" points="814.77,-19177 820.57,-19168.14 810.51,-19171.45 814.77,-19177"/>
</g>
<!-- layer_3_allgather_mlp -->
<g id="node102" class="node">
<title>layer_3_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="629.5" cy="-19043.08" rx="56.64" ry="36.54"/>
<text text-anchor="middle" x="629.5" y="-19057.08" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="629.5" y="-19046.08" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="629.5" y="-19035.08" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="629.5" y="-19024.08" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_3_mlp_fc1_gpu4&#45;&gt;layer_3_allgather_mlp -->
<g id="edge130" class="edge">
<title>layer_3_mlp_fc1_gpu4&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M546.63,-19115.68C559.31,-19104.73 574.4,-19091.69 588.2,-19079.76"/>
<polygon fill="black" stroke="black" points="590.87,-19082.08 596.15,-19072.89 586.3,-19076.78 590.87,-19082.08"/>
</g>
<!-- layer_3_mlp_fc1_gpu5&#45;&gt;layer_3_allgather_mlp -->
<g id="edge131" class="edge">
<title>layer_3_mlp_fc1_gpu5&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M629.5,-19115.68C629.5,-19107.87 629.5,-19099.01 629.5,-19090.24"/>
<polygon fill="black" stroke="black" points="633,-19090.06 629.5,-19080.06 626,-19090.06 633,-19090.06"/>
</g>
<!-- layer_3_mlp_fc1_gpu6&#45;&gt;layer_3_allgather_mlp -->
<g id="edge132" class="edge">
<title>layer_3_mlp_fc1_gpu6&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M712.37,-19115.68C699.69,-19104.73 684.6,-19091.69 670.8,-19079.76"/>
<polygon fill="black" stroke="black" points="672.7,-19076.78 662.85,-19072.89 668.13,-19082.08 672.7,-19076.78"/>
</g>
<!-- layer_3_mlp_fc1_gpu7&#45;&gt;layer_3_allgather_mlp -->
<g id="edge133" class="edge">
<title>layer_3_mlp_fc1_gpu7&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M806.47,-19119.79C803.44,-19118.45 800.43,-19117.13 797.5,-19115.85 760.33,-19099.62 718.38,-19081.69 685.69,-19067.82"/>
<polygon fill="black" stroke="black" points="686.87,-19064.52 676.3,-19063.83 684.14,-19070.96 686.87,-19064.52"/>
</g>
<!-- layer_3_gelu -->
<g id="node103" class="node">
<title>layer_3_gelu</title>
<polygon fill="lightblue" stroke="black" points="618,-18970.31 529,-18970.31 529,-18929.31 618,-18929.31 618,-18970.31"/>
<text text-anchor="middle" x="573.5" y="-18958.31" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="573.5" y="-18947.31" font-family="Arial" font-size="10.00">GELU Activation</text>
<text text-anchor="middle" x="573.5" y="-18936.31" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_3_allgather_mlp&#45;&gt;layer_3_gelu -->
<g id="edge134" class="edge">
<title>layer_3_allgather_mlp&#45;&gt;layer_3_gelu</title>
<path fill="none" stroke="black" d="M608.97,-19008.62C603,-18998.9 596.56,-18988.39 590.81,-18979.03"/>
<polygon fill="black" stroke="black" points="593.78,-18977.17 585.56,-18970.47 587.81,-18980.83 593.78,-18977.17"/>
</g>
<!-- layer_3_mlp_fc2_gpu4 -->
<g id="node104" class="node">
<title>layer_3_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="592.5,-18893.31 498.5,-18893.31 498.5,-18841.31 592.5,-18841.31 592.5,-18893.31"/>
<text text-anchor="middle" x="545.5" y="-18881.31" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="545.5" y="-18870.31" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="545.5" y="-18859.31" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="545.5" y="-18848.31" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu4 -->
<g id="edge135" class="edge">
<title>layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu4</title>
<path fill="none" stroke="black" d="M566.58,-18928.91C563.87,-18921.13 560.69,-18911.98 557.62,-18903.17"/>
<polygon fill="black" stroke="black" points="560.84,-18901.76 554.25,-18893.47 554.23,-18904.06 560.84,-18901.76"/>
</g>
<!-- layer_3_allreduce_mlp -->
<g id="node108" class="node">
<title>layer_3_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="769.5" cy="-18768.54" rx="60.21" ry="36.54"/>
<text text-anchor="middle" x="769.5" y="-18782.54" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="769.5" y="-18771.54" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="769.5" y="-18760.54" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="769.5" y="-18749.54" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_3_mlp_fc2_gpu4&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge136" class="edge">
<title>layer_3_mlp_fc2_gpu4&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M592.53,-18845.25C595.56,-18843.91 598.57,-18842.59 601.5,-18841.31 637.87,-18825.43 678.83,-18807.92 711.2,-18794.17"/>
<polygon fill="black" stroke="black" points="712.69,-18797.35 720.52,-18790.22 709.95,-18790.9 712.69,-18797.35"/>
</g>
<!-- layer_3_mlp_fc2_gpu5 -->
<g id="node105" class="node">
<title>layer_3_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="704.5,-18893.31 610.5,-18893.31 610.5,-18841.31 704.5,-18841.31 704.5,-18893.31"/>
<text text-anchor="middle" x="657.5" y="-18881.31" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="657.5" y="-18870.31" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="657.5" y="-18859.31" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="657.5" y="-18848.31" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_mlp_fc2_gpu5&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge137" class="edge">
<title>layer_3_mlp_fc2_gpu5&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M686.63,-18841.14C699.1,-18830.37 713.88,-18817.6 727.49,-18805.84"/>
<polygon fill="black" stroke="black" points="730.07,-18808.24 735.34,-18799.05 725.49,-18802.94 730.07,-18808.24"/>
</g>
<!-- layer_3_mlp_fc2_gpu6 -->
<g id="node106" class="node">
<title>layer_3_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="816.5,-18893.31 722.5,-18893.31 722.5,-18841.31 816.5,-18841.31 816.5,-18893.31"/>
<text text-anchor="middle" x="769.5" y="-18881.31" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="769.5" y="-18870.31" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="769.5" y="-18859.31" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="769.5" y="-18848.31" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_mlp_fc2_gpu6&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge138" class="edge">
<title>layer_3_mlp_fc2_gpu6&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M769.5,-18841.14C769.5,-18833.33 769.5,-18824.47 769.5,-18815.7"/>
<polygon fill="black" stroke="black" points="773,-18815.52 769.5,-18805.52 766,-18815.52 773,-18815.52"/>
</g>
<!-- layer_3_mlp_fc2_gpu7 -->
<g id="node107" class="node">
<title>layer_3_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="928.5,-18893.31 834.5,-18893.31 834.5,-18841.31 928.5,-18841.31 928.5,-18893.31"/>
<text text-anchor="middle" x="881.5" y="-18881.31" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="881.5" y="-18870.31" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="881.5" y="-18859.31" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="881.5" y="-18848.31" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_mlp_fc2_gpu7&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge139" class="edge">
<title>layer_3_mlp_fc2_gpu7&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M852.37,-18841.14C839.9,-18830.37 825.12,-18817.6 811.51,-18805.84"/>
<polygon fill="black" stroke="black" points="813.51,-18802.94 803.66,-18799.05 808.93,-18808.24 813.51,-18802.94"/>
</g>
<!-- layer_3_allreduce_mlp&#45;&gt;layer_3_residual2 -->
<g id="edge140" class="edge">
<title>layer_3_allreduce_mlp&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M796.15,-18735.51C804.36,-18725.65 813.58,-18714.57 822.48,-18703.87"/>
<polygon fill="black" stroke="black" points="825.18,-18706.1 828.88,-18696.18 819.79,-18701.63 825.18,-18706.1"/>
</g>
<!-- layer_3_ln2 -->
<g id="node110" class="node">
<title>layer_3_ln2</title>
<polygon fill="lightblue" stroke="black" points="899,-18577.77 826,-18577.77 826,-18525.77 899,-18525.77 899,-18577.77"/>
<text text-anchor="middle" x="862.5" y="-18565.77" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="862.5" y="-18554.77" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="862.5" y="-18543.77" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="862.5" y="-18532.77" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- layer_3_residual2&#45;&gt;layer_3_ln2 -->
<g id="edge142" class="edge">
<title>layer_3_residual2&#45;&gt;layer_3_ln2</title>
<path fill="none" stroke="black" d="M862.5,-18613.57C862.5,-18605.13 862.5,-18596.3 862.5,-18588.06"/>
<polygon fill="black" stroke="black" points="866,-18588.02 862.5,-18578.03 859,-18588.03 866,-18588.02"/>
</g>
<!-- layer_3_to_gpu2 -->
<g id="node111" class="node">
<title>layer_3_to_gpu2</title>
<ellipse fill="purple" stroke="black" cx="862.5" cy="-18460.78" rx="58.88" ry="28.98"/>
<text text-anchor="middle" x="862.5" y="-18469.28" font-family="Arial" font-size="10.00">Layer 3→4</text>
<text text-anchor="middle" x="862.5" y="-18458.28" font-family="Arial" font-size="10.00">Pipeline Comm</text>
<text text-anchor="middle" x="862.5" y="-18447.28" font-family="Arial" font-size="10.00">GPU 1→2</text>
</g>
<!-- layer_3_ln2&#45;&gt;layer_3_to_gpu2 -->
<g id="edge143" class="edge">
<title>layer_3_ln2&#45;&gt;layer_3_to_gpu2</title>
<path fill="none" stroke="black" d="M862.5,-18525.51C862.5,-18517.62 862.5,-18508.73 862.5,-18500.15"/>
<polygon fill="black" stroke="black" points="866,-18499.92 862.5,-18489.92 859,-18499.92 866,-18499.92"/>
</g>
<!-- layer_4_input_dist -->
<g id="node112" class="node">
<title>layer_4_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="956.69,-18395.79 806.86,-18395.79 768.31,-18313.79 918.14,-18313.79 956.69,-18395.79"/>
<text text-anchor="middle" x="862.5" y="-18363.29" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="862.5" y="-18352.29" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="862.5" y="-18341.29" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_3_to_gpu2&#45;&gt;layer_4_input_dist -->
<g id="edge144" class="edge">
<title>layer_3_to_gpu2&#45;&gt;layer_4_input_dist</title>
<path fill="none" stroke="black" d="M862.5,-18431.64C862.5,-18423.77 862.5,-18414.97 862.5,-18406.23"/>
<polygon fill="black" stroke="black" points="866,-18406.06 862.5,-18396.06 859,-18406.06 866,-18406.06"/>
</g>
<!-- layer_4_qkv_gpu8 -->
<g id="node113" class="node">
<title>layer_4_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="687,-18277.79 594,-18277.79 594,-18225.79 687,-18225.79 687,-18277.79"/>
<text text-anchor="middle" x="640.5" y="-18265.79" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="640.5" y="-18254.79" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="640.5" y="-18243.79" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="640.5" y="-18232.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu8 -->
<g id="edge145" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu8</title>
<path fill="none" stroke="black" d="M774.44,-18313.73C748.15,-18301.77 720.07,-18288.99 696.44,-18278.24"/>
<polygon fill="black" stroke="black" points="697.83,-18275.03 687.28,-18274.07 694.93,-18281.4 697.83,-18275.03"/>
</g>
<!-- layer_4_qkv_gpu9 -->
<g id="node114" class="node">
<title>layer_4_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="798,-18277.79 705,-18277.79 705,-18225.79 798,-18225.79 798,-18277.79"/>
<text text-anchor="middle" x="751.5" y="-18265.79" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="751.5" y="-18254.79" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="751.5" y="-18243.79" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="751.5" y="-18232.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu9 -->
<g id="edge146" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu9</title>
<path fill="none" stroke="black" d="M818.31,-18313.58C807.81,-18304.03 796.74,-18293.96 786.7,-18284.82"/>
<polygon fill="black" stroke="black" points="789,-18282.18 779.25,-18278.04 784.29,-18287.36 789,-18282.18"/>
</g>
<!-- layer_4_qkv_gpu10 -->
<g id="node115" class="node">
<title>layer_4_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="909,-18277.79 816,-18277.79 816,-18225.79 909,-18225.79 909,-18277.79"/>
<text text-anchor="middle" x="862.5" y="-18265.79" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="862.5" y="-18254.79" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="862.5" y="-18243.79" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="862.5" y="-18232.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu10 -->
<g id="edge147" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu10</title>
<path fill="none" stroke="black" d="M862.5,-18313.58C862.5,-18305.15 862.5,-18296.32 862.5,-18288.08"/>
<polygon fill="black" stroke="black" points="866,-18288.04 862.5,-18278.04 859,-18288.04 866,-18288.04"/>
</g>
<!-- layer_4_qkv_gpu11 -->
<g id="node116" class="node">
<title>layer_4_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="1020,-18277.79 927,-18277.79 927,-18225.79 1020,-18225.79 1020,-18277.79"/>
<text text-anchor="middle" x="973.5" y="-18265.79" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="973.5" y="-18254.79" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="973.5" y="-18243.79" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="973.5" y="-18232.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu11 -->
<g id="edge148" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu11</title>
<path fill="none" stroke="black" d="M906.69,-18313.58C917.19,-18304.03 928.26,-18293.96 938.3,-18284.82"/>
<polygon fill="black" stroke="black" points="940.71,-18287.36 945.75,-18278.04 936,-18282.18 940.71,-18287.36"/>
</g>
<!-- layer_4_residual1 -->
<g id="node124" class="node">
<title>layer_4_residual1</title>
<polygon fill="lightyellow" stroke="black" points="1059.44,-17794.71 937.05,-17794.71 905.56,-17712.71 1027.95,-17712.71 1059.44,-17794.71"/>
<text text-anchor="middle" x="982.5" y="-17762.21" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="982.5" y="-17751.21" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="982.5" y="-17740.21" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_residual1 -->
<g id="edge160" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_residual1</title>
<path fill="none" stroke="black" d="M929.19,-18337.23C963.31,-18325.68 1003.11,-18306.96 1029.5,-18277.79 1068.47,-18234.72 1071.5,-18212.11 1071.5,-18154.02 1071.5,-18154.02 1071.5,-18154.02 1071.5,-17965.25 1071.5,-17906.28 1041.51,-17844.84 1016.35,-17803.65"/>
<polygon fill="black" stroke="black" points="1019.17,-17801.56 1010.9,-17794.93 1013.23,-17805.26 1019.17,-17801.56"/>
</g>
<!-- layer_4_allgather_qkv -->
<g id="node117" class="node">
<title>layer_4_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="751.5" cy="-18153.02" rx="57.05" ry="36.54"/>
<text text-anchor="middle" x="751.5" y="-18167.02" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="751.5" y="-18156.02" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="751.5" y="-18145.02" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="751.5" y="-18134.02" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_4_qkv_gpu8&#45;&gt;layer_4_allgather_qkv -->
<g id="edge149" class="edge">
<title>layer_4_qkv_gpu8&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M669.37,-18225.62C681.83,-18214.76 696.64,-18201.85 710.22,-18190.01"/>
<polygon fill="black" stroke="black" points="712.81,-18192.39 718.05,-18183.18 708.21,-18187.12 712.81,-18192.39"/>
</g>
<!-- layer_4_qkv_gpu9&#45;&gt;layer_4_allgather_qkv -->
<g id="edge150" class="edge">
<title>layer_4_qkv_gpu9&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M751.5,-18225.62C751.5,-18217.81 751.5,-18208.94 751.5,-18200.18"/>
<polygon fill="black" stroke="black" points="755,-18200 751.5,-18190 748,-18200 755,-18200"/>
</g>
<!-- layer_4_qkv_gpu10&#45;&gt;layer_4_allgather_qkv -->
<g id="edge151" class="edge">
<title>layer_4_qkv_gpu10&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M833.63,-18225.62C821.17,-18214.76 806.36,-18201.85 792.78,-18190.01"/>
<polygon fill="black" stroke="black" points="794.79,-18187.12 784.95,-18183.18 790.19,-18192.39 794.79,-18187.12"/>
</g>
<!-- layer_4_qkv_gpu11&#45;&gt;layer_4_allgather_qkv -->
<g id="edge152" class="edge">
<title>layer_4_qkv_gpu11&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M926.72,-18229.45C923.94,-18228.21 921.19,-18226.98 918.5,-18225.79 881.85,-18209.59 840.48,-18191.81 808.08,-18177.99"/>
<polygon fill="black" stroke="black" points="809.33,-18174.72 798.76,-18174.02 806.59,-18181.16 809.33,-18174.72"/>
</g>
<!-- layer_4_attention -->
<g id="node118" class="node">
<title>layer_4_attention</title>
<polygon fill="lightblue" stroke="black" points="761.5,-18080.25 693.5,-18080.25 693.5,-18028.25 761.5,-18028.25 761.5,-18080.25"/>
<text text-anchor="middle" x="727.5" y="-18068.25" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="727.5" y="-18057.25" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="727.5" y="-18046.25" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="727.5" y="-18035.25" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_4_allgather_qkv&#45;&gt;layer_4_attention -->
<g id="edge153" class="edge">
<title>layer_4_allgather_qkv&#45;&gt;layer_4_attention</title>
<path fill="none" stroke="black" d="M742.7,-18116.54C740.56,-18107.93 738.28,-18098.74 736.16,-18090.16"/>
<polygon fill="black" stroke="black" points="739.55,-18089.3 733.75,-18080.44 732.76,-18090.99 739.55,-18089.3"/>
</g>
<!-- layer_4_attn_out_gpu8 -->
<g id="node119" class="node">
<title>layer_4_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="725.5,-17992.25 637.5,-17992.25 637.5,-17940.25 725.5,-17940.25 725.5,-17992.25"/>
<text text-anchor="middle" x="681.5" y="-17980.25" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="681.5" y="-17969.25" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="681.5" y="-17958.25" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="681.5" y="-17947.25" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attention&#45;&gt;layer_4_attn_out_gpu8 -->
<g id="edge154" class="edge">
<title>layer_4_attention&#45;&gt;layer_4_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M713.95,-18027.91C709.5,-18019.6 704.49,-18010.23 699.75,-18001.38"/>
<polygon fill="black" stroke="black" points="702.76,-17999.58 694.96,-17992.41 696.59,-18002.88 702.76,-17999.58"/>
</g>
<!-- layer_4_allreduce_attn -->
<g id="node123" class="node">
<title>layer_4_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="893.5" cy="-17867.48" rx="57.97" ry="36.54"/>
<text text-anchor="middle" x="893.5" y="-17881.48" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="893.5" y="-17870.48" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="893.5" y="-17859.48" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="893.5" y="-17848.48" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_4_attn_out_gpu8&#45;&gt;layer_4_allreduce_attn -->
<g id="edge155" class="edge">
<title>layer_4_attn_out_gpu8&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M725.72,-17944.33C728.69,-17942.94 731.64,-17941.57 734.5,-17940.25 768.64,-17924.5 807.07,-17907.14 837.59,-17893.45"/>
<polygon fill="black" stroke="black" points="839.1,-17896.6 846.79,-17889.32 836.24,-17890.22 839.1,-17896.6"/>
</g>
<!-- layer_4_attn_out_gpu9 -->
<g id="node120" class="node">
<title>layer_4_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="831.5,-17992.25 743.5,-17992.25 743.5,-17940.25 831.5,-17940.25 831.5,-17992.25"/>
<text text-anchor="middle" x="787.5" y="-17980.25" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="787.5" y="-17969.25" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="787.5" y="-17958.25" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="787.5" y="-17947.25" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attn_out_gpu9&#45;&gt;layer_4_allreduce_attn -->
<g id="edge156" class="edge">
<title>layer_4_attn_out_gpu9&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M815.07,-17940.08C826.66,-17929.51 840.36,-17916.99 853.05,-17905.41"/>
<polygon fill="black" stroke="black" points="855.76,-17907.67 860.79,-17898.35 851.04,-17902.5 855.76,-17907.67"/>
</g>
<!-- layer_4_attn_out_gpu10 -->
<g id="node121" class="node">
<title>layer_4_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="937.5,-17992.25 849.5,-17992.25 849.5,-17940.25 937.5,-17940.25 937.5,-17992.25"/>
<text text-anchor="middle" x="893.5" y="-17980.25" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="893.5" y="-17969.25" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="893.5" y="-17958.25" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="893.5" y="-17947.25" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attn_out_gpu10&#45;&gt;layer_4_allreduce_attn -->
<g id="edge157" class="edge">
<title>layer_4_attn_out_gpu10&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M893.5,-17940.08C893.5,-17932.27 893.5,-17923.41 893.5,-17914.64"/>
<polygon fill="black" stroke="black" points="897,-17914.46 893.5,-17904.46 890,-17914.46 897,-17914.46"/>
</g>
<!-- layer_4_attn_out_gpu11 -->
<g id="node122" class="node">
<title>layer_4_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="1043.5,-17992.25 955.5,-17992.25 955.5,-17940.25 1043.5,-17940.25 1043.5,-17992.25"/>
<text text-anchor="middle" x="999.5" y="-17980.25" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="999.5" y="-17969.25" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="999.5" y="-17958.25" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="999.5" y="-17947.25" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attn_out_gpu11&#45;&gt;layer_4_allreduce_attn -->
<g id="edge158" class="edge">
<title>layer_4_attn_out_gpu11&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M971.93,-17940.08C960.34,-17929.51 946.64,-17916.99 933.95,-17905.41"/>
<polygon fill="black" stroke="black" points="935.96,-17902.5 926.21,-17898.35 931.24,-17907.67 935.96,-17902.5"/>
</g>
<!-- layer_4_allreduce_attn&#45;&gt;layer_4_residual1 -->
<g id="edge159" class="edge">
<title>layer_4_allreduce_attn&#45;&gt;layer_4_residual1</title>
<path fill="none" stroke="black" d="M919,-17834.45C926.78,-17824.69 935.51,-17813.72 943.95,-17803.12"/>
<polygon fill="black" stroke="black" points="946.84,-17805.12 950.33,-17795.12 941.36,-17800.76 946.84,-17805.12"/>
</g>
<!-- layer_4_ln1 -->
<g id="node125" class="node">
<title>layer_4_ln1</title>
<polygon fill="lightblue" stroke="black" points="926,-17676.71 853,-17676.71 853,-17624.71 926,-17624.71 926,-17676.71"/>
<text text-anchor="middle" x="889.5" y="-17664.71" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="889.5" y="-17653.71" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="889.5" y="-17642.71" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="889.5" y="-17631.71" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_4_residual1&#45;&gt;layer_4_ln1 -->
<g id="edge161" class="edge">
<title>layer_4_residual1&#45;&gt;layer_4_ln1</title>
<path fill="none" stroke="black" d="M945.48,-17712.5C936.94,-17703.23 927.95,-17693.47 919.74,-17684.55"/>
<polygon fill="black" stroke="black" points="922.1,-17681.95 912.75,-17676.96 916.95,-17686.69 922.1,-17681.95"/>
</g>
<!-- layer_4_residual2 -->
<g id="node137" class="node">
<title>layer_4_residual2</title>
<polygon fill="lightyellow" stroke="black" points="1087.44,-17116.63 965.05,-17116.63 933.56,-17034.63 1055.95,-17034.63 1087.44,-17116.63"/>
<text text-anchor="middle" x="1010.5" y="-17084.13" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1010.5" y="-17073.13" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1010.5" y="-17062.13" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_4_residual1&#45;&gt;layer_4_residual2 -->
<g id="edge177" class="edge">
<title>layer_4_residual1&#45;&gt;layer_4_residual2</title>
<path fill="none" stroke="black" d="M1027.93,-17712.47C1062.61,-17677.11 1104.5,-17622.29 1104.5,-17563.71 1104.5,-17563.71 1104.5,-17563.71 1104.5,-17287.17 1104.5,-17227.75 1072.89,-17166.45 1046.34,-17125.43"/>
<polygon fill="black" stroke="black" points="1049.19,-17123.41 1040.76,-17117 1043.35,-17127.27 1049.19,-17123.41"/>
</g>
<!-- layer_4_mlp_fc1_gpu8 -->
<g id="node126" class="node">
<title>layer_4_mlp_fc1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="712.5,-17588.71 618.5,-17588.71 618.5,-17536.71 712.5,-17536.71 712.5,-17588.71"/>
<text text-anchor="middle" x="665.5" y="-17576.71" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="665.5" y="-17565.71" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="665.5" y="-17554.71" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="665.5" y="-17543.71" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu8 -->
<g id="edge162" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu8</title>
<path fill="none" stroke="black" d="M852.84,-17637.25C820.62,-17626.11 772.31,-17608.95 722.14,-17588.88"/>
<polygon fill="black" stroke="black" points="723.34,-17585.58 712.75,-17585.09 720.72,-17592.08 723.34,-17585.58"/>
</g>
<!-- layer_4_mlp_fc1_gpu9 -->
<g id="node127" class="node">
<title>layer_4_mlp_fc1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="824.5,-17588.71 730.5,-17588.71 730.5,-17536.71 824.5,-17536.71 824.5,-17588.71"/>
<text text-anchor="middle" x="777.5" y="-17576.71" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="777.5" y="-17565.71" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="777.5" y="-17554.71" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="777.5" y="-17543.71" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu9 -->
<g id="edge163" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu9</title>
<path fill="none" stroke="black" d="M856.8,-17624.61C844.83,-17615.42 831.13,-17604.9 818.53,-17595.22"/>
<polygon fill="black" stroke="black" points="820.49,-17592.31 810.43,-17589 816.23,-17597.86 820.49,-17592.31"/>
</g>
<!-- layer_4_mlp_fc1_gpu10 -->
<g id="node128" class="node">
<title>layer_4_mlp_fc1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="936.5,-17588.71 842.5,-17588.71 842.5,-17536.71 936.5,-17536.71 936.5,-17588.71"/>
<text text-anchor="middle" x="889.5" y="-17576.71" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="889.5" y="-17565.71" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="889.5" y="-17554.71" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="889.5" y="-17543.71" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu10 -->
<g id="edge164" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu10</title>
<path fill="none" stroke="black" d="M889.5,-17624.37C889.5,-17616.41 889.5,-17607.48 889.5,-17598.96"/>
<polygon fill="black" stroke="black" points="893,-17598.87 889.5,-17588.87 886,-17598.87 893,-17598.87"/>
</g>
<!-- layer_4_mlp_fc1_gpu11 -->
<g id="node129" class="node">
<title>layer_4_mlp_fc1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="1048.5,-17588.71 954.5,-17588.71 954.5,-17536.71 1048.5,-17536.71 1048.5,-17588.71"/>
<text text-anchor="middle" x="1001.5" y="-17576.71" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="1001.5" y="-17565.71" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="1001.5" y="-17554.71" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1001.5" y="-17543.71" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu11 -->
<g id="edge165" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu11</title>
<path fill="none" stroke="black" d="M922.2,-17624.61C934.17,-17615.42 947.87,-17604.9 960.47,-17595.22"/>
<polygon fill="black" stroke="black" points="962.77,-17597.86 968.57,-17589 958.51,-17592.31 962.77,-17597.86"/>
</g>
<!-- layer_4_allgather_mlp -->
<g id="node130" class="node">
<title>layer_4_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="777.5" cy="-17463.94" rx="56.64" ry="36.54"/>
<text text-anchor="middle" x="777.5" y="-17477.94" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="777.5" y="-17466.94" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="777.5" y="-17455.94" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="777.5" y="-17444.94" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_4_mlp_fc1_gpu8&#45;&gt;layer_4_allgather_mlp -->
<g id="edge166" class="edge">
<title>layer_4_mlp_fc1_gpu8&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M694.63,-17536.54C707.31,-17525.59 722.4,-17512.55 736.2,-17500.62"/>
<polygon fill="black" stroke="black" points="738.87,-17502.94 744.15,-17493.75 734.3,-17497.64 738.87,-17502.94"/>
</g>
<!-- layer_4_mlp_fc1_gpu9&#45;&gt;layer_4_allgather_mlp -->
<g id="edge167" class="edge">
<title>layer_4_mlp_fc1_gpu9&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M777.5,-17536.54C777.5,-17528.73 777.5,-17519.87 777.5,-17511.1"/>
<polygon fill="black" stroke="black" points="781,-17510.92 777.5,-17500.92 774,-17510.92 781,-17510.92"/>
</g>
<!-- layer_4_mlp_fc1_gpu10&#45;&gt;layer_4_allgather_mlp -->
<g id="edge168" class="edge">
<title>layer_4_mlp_fc1_gpu10&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M860.37,-17536.54C847.69,-17525.59 832.6,-17512.55 818.8,-17500.62"/>
<polygon fill="black" stroke="black" points="820.7,-17497.64 810.85,-17493.75 816.13,-17502.94 820.7,-17497.64"/>
</g>
<!-- layer_4_mlp_fc1_gpu11&#45;&gt;layer_4_allgather_mlp -->
<g id="edge169" class="edge">
<title>layer_4_mlp_fc1_gpu11&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M954.47,-17540.65C951.44,-17539.31 948.43,-17537.99 945.5,-17536.71 908.33,-17520.48 866.38,-17502.56 833.69,-17488.68"/>
<polygon fill="black" stroke="black" points="834.87,-17485.38 824.3,-17484.7 832.14,-17491.82 834.87,-17485.38"/>
</g>
<!-- layer_4_gelu -->
<g id="node131" class="node">
<title>layer_4_gelu</title>
<polygon fill="lightblue" stroke="black" points="794,-17391.17 705,-17391.17 705,-17350.17 794,-17350.17 794,-17391.17"/>
<text text-anchor="middle" x="749.5" y="-17379.17" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="749.5" y="-17368.17" font-family="Arial" font-size="10.00">GELU Activation</text>
<text text-anchor="middle" x="749.5" y="-17357.17" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_4_allgather_mlp&#45;&gt;layer_4_gelu -->
<g id="edge170" class="edge">
<title>layer_4_allgather_mlp&#45;&gt;layer_4_gelu</title>
<path fill="none" stroke="black" d="M766.67,-17427.66C763.98,-17418.88 761.13,-17409.57 758.53,-17401.11"/>
<polygon fill="black" stroke="black" points="761.8,-17399.85 755.52,-17391.31 755.11,-17401.9 761.8,-17399.85"/>
</g>
<!-- layer_4_mlp_fc2_gpu8 -->
<g id="node132" class="node">
<title>layer_4_mlp_fc2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="740.5,-17314.17 646.5,-17314.17 646.5,-17262.17 740.5,-17262.17 740.5,-17314.17"/>
<text text-anchor="middle" x="693.5" y="-17302.17" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="693.5" y="-17291.17" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="693.5" y="-17280.17" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="693.5" y="-17269.17" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu8 -->
<g id="edge171" class="edge">
<title>layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu8</title>
<path fill="none" stroke="black" d="M735.66,-17349.77C729.95,-17341.58 723.19,-17331.85 716.76,-17322.61"/>
<polygon fill="black" stroke="black" points="719.58,-17320.54 711,-17314.33 713.84,-17324.54 719.58,-17320.54"/>
</g>
<!-- layer_4_allreduce_mlp -->
<g id="node136" class="node">
<title>layer_4_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="917.5" cy="-17189.4" rx="60.21" ry="36.54"/>
<text text-anchor="middle" x="917.5" y="-17203.4" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="917.5" y="-17192.4" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="917.5" y="-17181.4" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="917.5" y="-17170.4" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_4_mlp_fc2_gpu8&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge172" class="edge">
<title>layer_4_mlp_fc2_gpu8&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M740.53,-17266.11C743.56,-17264.77 746.57,-17263.45 749.5,-17262.17 785.87,-17246.29 826.83,-17228.78 859.2,-17215.04"/>
<polygon fill="black" stroke="black" points="860.69,-17218.21 868.52,-17211.08 857.95,-17211.76 860.69,-17218.21"/>
</g>
<!-- layer_4_mlp_fc2_gpu9 -->
<g id="node133" class="node">
<title>layer_4_mlp_fc2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="852.5,-17314.17 758.5,-17314.17 758.5,-17262.17 852.5,-17262.17 852.5,-17314.17"/>
<text text-anchor="middle" x="805.5" y="-17302.17" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="805.5" y="-17291.17" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="805.5" y="-17280.17" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="805.5" y="-17269.17" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_mlp_fc2_gpu9&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge173" class="edge">
<title>layer_4_mlp_fc2_gpu9&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M834.63,-17262C847.1,-17251.23 861.88,-17238.46 875.49,-17226.7"/>
<polygon fill="black" stroke="black" points="878.07,-17229.1 883.34,-17219.92 873.49,-17223.8 878.07,-17229.1"/>
</g>
<!-- layer_4_mlp_fc2_gpu10 -->
<g id="node134" class="node">
<title>layer_4_mlp_fc2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="964.5,-17314.17 870.5,-17314.17 870.5,-17262.17 964.5,-17262.17 964.5,-17314.17"/>
<text text-anchor="middle" x="917.5" y="-17302.17" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="917.5" y="-17291.17" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="917.5" y="-17280.17" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="917.5" y="-17269.17" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_mlp_fc2_gpu10&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge174" class="edge">
<title>layer_4_mlp_fc2_gpu10&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M917.5,-17262C917.5,-17254.19 917.5,-17245.33 917.5,-17236.56"/>
<polygon fill="black" stroke="black" points="921,-17236.38 917.5,-17226.38 914,-17236.38 921,-17236.38"/>
</g>
<!-- layer_4_mlp_fc2_gpu11 -->
<g id="node135" class="node">
<title>layer_4_mlp_fc2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="1076.5,-17314.17 982.5,-17314.17 982.5,-17262.17 1076.5,-17262.17 1076.5,-17314.17"/>
<text text-anchor="middle" x="1029.5" y="-17302.17" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="1029.5" y="-17291.17" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="1029.5" y="-17280.17" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1029.5" y="-17269.17" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_mlp_fc2_gpu11&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge175" class="edge">
<title>layer_4_mlp_fc2_gpu11&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1000.37,-17262C987.9,-17251.23 973.12,-17238.46 959.51,-17226.7"/>
<polygon fill="black" stroke="black" points="961.51,-17223.8 951.66,-17219.92 956.93,-17229.1 961.51,-17223.8"/>
</g>
<!-- layer_4_allreduce_mlp&#45;&gt;layer_4_residual2 -->
<g id="edge176" class="edge">
<title>layer_4_allreduce_mlp&#45;&gt;layer_4_residual2</title>
<path fill="none" stroke="black" d="M944.15,-17156.38C952.36,-17146.51 961.58,-17135.43 970.48,-17124.73"/>
<polygon fill="black" stroke="black" points="973.18,-17126.96 976.88,-17117.04 967.79,-17122.49 973.18,-17126.96"/>
</g>
<!-- layer_4_ln2 -->
<g id="node138" class="node">
<title>layer_4_ln2</title>
<polygon fill="lightblue" stroke="black" points="1047,-16998.63 974,-16998.63 974,-16946.63 1047,-16946.63 1047,-16998.63"/>
<text text-anchor="middle" x="1010.5" y="-16986.63" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1010.5" y="-16975.63" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="1010.5" y="-16964.63" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="1010.5" y="-16953.63" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_4_residual2&#45;&gt;layer_4_ln2 -->
<g id="edge178" class="edge">
<title>layer_4_residual2&#45;&gt;layer_4_ln2</title>
<path fill="none" stroke="black" d="M1010.5,-17034.43C1010.5,-17025.99 1010.5,-17017.16 1010.5,-17008.93"/>
<polygon fill="black" stroke="black" points="1014,-17008.89 1010.5,-16998.89 1007,-17008.89 1014,-17008.89"/>
</g>
<!-- layer_5_input_dist -->
<g id="node139" class="node">
<title>layer_5_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="1104.69,-16910.63 954.86,-16910.63 916.31,-16828.63 1066.14,-16828.63 1104.69,-16910.63"/>
<text text-anchor="middle" x="1010.5" y="-16878.13" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1010.5" y="-16867.13" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="1010.5" y="-16856.13" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_4_ln2&#45;&gt;layer_5_input_dist -->
<g id="edge179" class="edge">
<title>layer_4_ln2&#45;&gt;layer_5_input_dist</title>
<path fill="none" stroke="black" d="M1010.5,-16946.41C1010.5,-16938.68 1010.5,-16929.89 1010.5,-16921.1"/>
<polygon fill="black" stroke="black" points="1014,-16920.85 1010.5,-16910.85 1007,-16920.85 1014,-16920.85"/>
</g>
<!-- layer_5_qkv_gpu8 -->
<g id="node140" class="node">
<title>layer_5_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="835,-16792.63 742,-16792.63 742,-16740.63 835,-16740.63 835,-16792.63"/>
<text text-anchor="middle" x="788.5" y="-16780.63" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="788.5" y="-16769.63" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="788.5" y="-16758.63" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="788.5" y="-16747.63" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu8 -->
<g id="edge180" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu8</title>
<path fill="none" stroke="black" d="M922.44,-16828.57C896.15,-16816.61 868.07,-16803.83 844.44,-16793.08"/>
<polygon fill="black" stroke="black" points="845.83,-16789.87 835.28,-16788.92 842.93,-16796.24 845.83,-16789.87"/>
</g>
<!-- layer_5_qkv_gpu9 -->
<g id="node141" class="node">
<title>layer_5_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="946,-16792.63 853,-16792.63 853,-16740.63 946,-16740.63 946,-16792.63"/>
<text text-anchor="middle" x="899.5" y="-16780.63" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="899.5" y="-16769.63" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="899.5" y="-16758.63" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="899.5" y="-16747.63" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu9 -->
<g id="edge181" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu9</title>
<path fill="none" stroke="black" d="M966.31,-16828.43C955.81,-16818.87 944.74,-16808.8 934.7,-16799.67"/>
<polygon fill="black" stroke="black" points="937,-16797.03 927.25,-16792.89 932.29,-16802.2 937,-16797.03"/>
</g>
<!-- layer_5_qkv_gpu10 -->
<g id="node142" class="node">
<title>layer_5_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1057,-16792.63 964,-16792.63 964,-16740.63 1057,-16740.63 1057,-16792.63"/>
<text text-anchor="middle" x="1010.5" y="-16780.63" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="1010.5" y="-16769.63" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="1010.5" y="-16758.63" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1010.5" y="-16747.63" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu10 -->
<g id="edge182" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu10</title>
<path fill="none" stroke="black" d="M1010.5,-16828.43C1010.5,-16819.99 1010.5,-16811.16 1010.5,-16802.93"/>
<polygon fill="black" stroke="black" points="1014,-16802.89 1010.5,-16792.89 1007,-16802.89 1014,-16802.89"/>
</g>
<!-- layer_5_qkv_gpu11 -->
<g id="node143" class="node">
<title>layer_5_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="1168,-16792.63 1075,-16792.63 1075,-16740.63 1168,-16740.63 1168,-16792.63"/>
<text text-anchor="middle" x="1121.5" y="-16780.63" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="1121.5" y="-16769.63" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="1121.5" y="-16758.63" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1121.5" y="-16747.63" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu11 -->
<g id="edge183" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu11</title>
<path fill="none" stroke="black" d="M1054.69,-16828.43C1065.19,-16818.87 1076.26,-16808.8 1086.3,-16799.67"/>
<polygon fill="black" stroke="black" points="1088.71,-16802.2 1093.75,-16792.89 1084,-16797.03 1088.71,-16802.2"/>
</g>
<!-- layer_5_residual1 -->
<g id="node151" class="node">
<title>layer_5_residual1</title>
<polygon fill="lightyellow" stroke="black" points="1207.44,-16309.56 1085.05,-16309.56 1053.56,-16227.56 1175.95,-16227.56 1207.44,-16309.56"/>
<text text-anchor="middle" x="1130.5" y="-16277.06" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1130.5" y="-16266.06" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1130.5" y="-16255.06" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_residual1 -->
<g id="edge195" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_residual1</title>
<path fill="none" stroke="black" d="M1077.19,-16852.08C1111.31,-16840.52 1151.11,-16821.81 1177.5,-16792.63 1216.47,-16749.56 1219.5,-16726.95 1219.5,-16668.86 1219.5,-16668.86 1219.5,-16668.86 1219.5,-16480.1 1219.5,-16421.13 1189.51,-16359.68 1164.35,-16318.5"/>
<polygon fill="black" stroke="black" points="1167.17,-16316.4 1158.9,-16309.77 1161.23,-16320.11 1167.17,-16316.4"/>
</g>
<!-- layer_5_allgather_qkv -->
<g id="node144" class="node">
<title>layer_5_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="899.5" cy="-16667.86" rx="57.05" ry="36.54"/>
<text text-anchor="middle" x="899.5" y="-16681.86" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="899.5" y="-16670.86" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="899.5" y="-16659.86" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="899.5" y="-16648.86" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_5_qkv_gpu8&#45;&gt;layer_5_allgather_qkv -->
<g id="edge184" class="edge">
<title>layer_5_qkv_gpu8&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M817.37,-16740.46C829.83,-16729.6 844.64,-16716.7 858.22,-16704.85"/>
<polygon fill="black" stroke="black" points="860.81,-16707.24 866.05,-16698.03 856.21,-16701.96 860.81,-16707.24"/>
</g>
<!-- layer_5_qkv_gpu9&#45;&gt;layer_5_allgather_qkv -->
<g id="edge185" class="edge">
<title>layer_5_qkv_gpu9&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M899.5,-16740.46C899.5,-16732.65 899.5,-16723.79 899.5,-16715.02"/>
<polygon fill="black" stroke="black" points="903,-16714.84 899.5,-16704.84 896,-16714.84 903,-16714.84"/>
</g>
<!-- layer_5_qkv_gpu10&#45;&gt;layer_5_allgather_qkv -->
<g id="edge186" class="edge">
<title>layer_5_qkv_gpu10&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M981.63,-16740.46C969.17,-16729.6 954.36,-16716.7 940.78,-16704.85"/>
<polygon fill="black" stroke="black" points="942.79,-16701.96 932.95,-16698.03 938.19,-16707.24 942.79,-16701.96"/>
</g>
<!-- layer_5_qkv_gpu11&#45;&gt;layer_5_allgather_qkv -->
<g id="edge187" class="edge">
<title>layer_5_qkv_gpu11&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M1074.72,-16744.29C1071.94,-16743.05 1069.19,-16741.82 1066.5,-16740.63 1029.85,-16724.43 988.48,-16706.65 956.08,-16692.84"/>
<polygon fill="black" stroke="black" points="957.33,-16689.57 946.76,-16688.87 954.59,-16696.01 957.33,-16689.57"/>
</g>
<!-- layer_5_attention -->
<g id="node145" class="node">
<title>layer_5_attention</title>
<polygon fill="lightblue" stroke="black" points="909.5,-16595.1 841.5,-16595.1 841.5,-16543.1 909.5,-16543.1 909.5,-16595.1"/>
<text text-anchor="middle" x="875.5" y="-16583.1" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="875.5" y="-16572.1" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="875.5" y="-16561.1" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="875.5" y="-16550.1" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_5_allgather_qkv&#45;&gt;layer_5_attention -->
<g id="edge188" class="edge">
<title>layer_5_allgather_qkv&#45;&gt;layer_5_attention</title>
<path fill="none" stroke="black" d="M890.7,-16631.38C888.56,-16622.77 886.28,-16613.58 884.16,-16605"/>
<polygon fill="black" stroke="black" points="887.55,-16604.14 881.75,-16595.28 880.76,-16605.83 887.55,-16604.14"/>
</g>
<!-- layer_5_attn_out_gpu8 -->
<g id="node146" class="node">
<title>layer_5_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="873.5,-16507.1 785.5,-16507.1 785.5,-16455.1 873.5,-16455.1 873.5,-16507.1"/>
<text text-anchor="middle" x="829.5" y="-16495.1" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="829.5" y="-16484.1" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="829.5" y="-16473.1" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="829.5" y="-16462.1" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attention&#45;&gt;layer_5_attn_out_gpu8 -->
<g id="edge189" class="edge">
<title>layer_5_attention&#45;&gt;layer_5_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M861.95,-16542.76C857.5,-16534.45 852.49,-16525.07 847.75,-16516.22"/>
<polygon fill="black" stroke="black" points="850.76,-16514.42 842.96,-16507.25 844.59,-16517.72 850.76,-16514.42"/>
</g>
<!-- layer_5_allreduce_attn -->
<g id="node150" class="node">
<title>layer_5_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="1041.5" cy="-16382.33" rx="57.97" ry="36.54"/>
<text text-anchor="middle" x="1041.5" y="-16396.33" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1041.5" y="-16385.33" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="1041.5" y="-16374.33" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1041.5" y="-16363.33" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_5_attn_out_gpu8&#45;&gt;layer_5_allreduce_attn -->
<g id="edge190" class="edge">
<title>layer_5_attn_out_gpu8&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M873.72,-16459.17C876.69,-16457.78 879.64,-16456.42 882.5,-16455.1 916.64,-16439.34 955.07,-16421.98 985.59,-16408.29"/>
<polygon fill="black" stroke="black" points="987.1,-16411.45 994.79,-16404.16 984.24,-16405.06 987.1,-16411.45"/>
</g>
<!-- layer_5_attn_out_gpu9 -->
<g id="node147" class="node">
<title>layer_5_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="979.5,-16507.1 891.5,-16507.1 891.5,-16455.1 979.5,-16455.1 979.5,-16507.1"/>
<text text-anchor="middle" x="935.5" y="-16495.1" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="935.5" y="-16484.1" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="935.5" y="-16473.1" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="935.5" y="-16462.1" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attn_out_gpu9&#45;&gt;layer_5_allreduce_attn -->
<g id="edge191" class="edge">
<title>layer_5_attn_out_gpu9&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M963.07,-16454.92C974.66,-16444.35 988.36,-16431.84 1001.05,-16420.25"/>
<polygon fill="black" stroke="black" points="1003.76,-16422.52 1008.79,-16413.19 999.04,-16417.35 1003.76,-16422.52"/>
</g>
<!-- layer_5_attn_out_gpu10 -->
<g id="node148" class="node">
<title>layer_5_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1085.5,-16507.1 997.5,-16507.1 997.5,-16455.1 1085.5,-16455.1 1085.5,-16507.1"/>
<text text-anchor="middle" x="1041.5" y="-16495.1" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="1041.5" y="-16484.1" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="1041.5" y="-16473.1" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1041.5" y="-16462.1" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attn_out_gpu10&#45;&gt;layer_5_allreduce_attn -->
<g id="edge192" class="edge">
<title>layer_5_attn_out_gpu10&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M1041.5,-16454.92C1041.5,-16447.11 1041.5,-16438.25 1041.5,-16429.48"/>
<polygon fill="black" stroke="black" points="1045,-16429.3 1041.5,-16419.3 1038,-16429.3 1045,-16429.3"/>
</g>
<!-- layer_5_attn_out_gpu11 -->
<g id="node149" class="node">
<title>layer_5_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="1191.5,-16507.1 1103.5,-16507.1 1103.5,-16455.1 1191.5,-16455.1 1191.5,-16507.1"/>
<text text-anchor="middle" x="1147.5" y="-16495.1" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="1147.5" y="-16484.1" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="1147.5" y="-16473.1" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1147.5" y="-16462.1" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attn_out_gpu11&#45;&gt;layer_5_allreduce_attn -->
<g id="edge193" class="edge">
<title>layer_5_attn_out_gpu11&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M1119.93,-16454.92C1108.34,-16444.35 1094.64,-16431.84 1081.95,-16420.25"/>
<polygon fill="black" stroke="black" points="1083.96,-16417.35 1074.21,-16413.19 1079.24,-16422.52 1083.96,-16417.35"/>
</g>
<!-- layer_5_allreduce_attn&#45;&gt;layer_5_residual1 -->
<g id="edge194" class="edge">
<title>layer_5_allreduce_attn&#45;&gt;layer_5_residual1</title>
<path fill="none" stroke="black" d="M1067,-16349.3C1074.78,-16339.53 1083.51,-16328.57 1091.95,-16317.97"/>
<polygon fill="black" stroke="black" points="1094.84,-16319.96 1098.33,-16309.96 1089.36,-16315.6 1094.84,-16319.96"/>
</g>
<!-- layer_5_ln1 -->
<g id="node152" class="node">
<title>layer_5_ln1</title>
<polygon fill="lightblue" stroke="black" points="1074,-16191.56 1001,-16191.56 1001,-16139.56 1074,-16139.56 1074,-16191.56"/>
<text text-anchor="middle" x="1037.5" y="-16179.56" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1037.5" y="-16168.56" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="1037.5" y="-16157.56" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="1037.5" y="-16146.56" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_5_residual1&#45;&gt;layer_5_ln1 -->
<g id="edge196" class="edge">
<title>layer_5_residual1&#45;&gt;layer_5_ln1</title>
<path fill="none" stroke="black" d="M1093.48,-16227.35C1084.94,-16218.07 1075.95,-16208.31 1067.74,-16199.4"/>
<polygon fill="black" stroke="black" points="1070.1,-16196.79 1060.75,-16191.81 1064.95,-16201.53 1070.1,-16196.79"/>
</g>
<!-- layer_5_residual2 -->
<g id="node164" class="node">
<title>layer_5_residual2</title>
<polygon fill="lightyellow" stroke="black" points="1235.44,-15631.48 1113.05,-15631.48 1081.56,-15549.48 1203.95,-15549.48 1235.44,-15631.48"/>
<text text-anchor="middle" x="1158.5" y="-15598.98" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1158.5" y="-15587.98" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1158.5" y="-15576.98" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_5_residual1&#45;&gt;layer_5_residual2 -->
<g id="edge212" class="edge">
<title>layer_5_residual1&#45;&gt;layer_5_residual2</title>
<path fill="none" stroke="black" d="M1175.93,-16227.31C1210.61,-16191.96 1252.5,-16137.14 1252.5,-16078.56 1252.5,-16078.56 1252.5,-16078.56 1252.5,-15802.02 1252.5,-15742.6 1220.89,-15681.3 1194.34,-15640.28"/>
<polygon fill="black" stroke="black" points="1197.19,-15638.25 1188.76,-15631.84 1191.35,-15642.11 1197.19,-15638.25"/>
</g>
<!-- layer_5_mlp_fc1_gpu8 -->
<g id="node153" class="node">
<title>layer_5_mlp_fc1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="860.5,-16103.56 766.5,-16103.56 766.5,-16051.56 860.5,-16051.56 860.5,-16103.56"/>
<text text-anchor="middle" x="813.5" y="-16091.56" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="813.5" y="-16080.56" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="813.5" y="-16069.56" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="813.5" y="-16058.56" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu8 -->
<g id="edge197" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu8</title>
<path fill="none" stroke="black" d="M1000.84,-16152.09C968.62,-16140.95 920.31,-16123.8 870.14,-16103.72"/>
<polygon fill="black" stroke="black" points="871.34,-16100.43 860.75,-16099.94 868.72,-16106.92 871.34,-16100.43"/>
</g>
<!-- layer_5_mlp_fc1_gpu9 -->
<g id="node154" class="node">
<title>layer_5_mlp_fc1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="972.5,-16103.56 878.5,-16103.56 878.5,-16051.56 972.5,-16051.56 972.5,-16103.56"/>
<text text-anchor="middle" x="925.5" y="-16091.56" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="925.5" y="-16080.56" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="925.5" y="-16069.56" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="925.5" y="-16058.56" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu9 -->
<g id="edge198" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu9</title>
<path fill="none" stroke="black" d="M1004.8,-16139.45C992.83,-16130.26 979.13,-16119.74 966.53,-16110.06"/>
<polygon fill="black" stroke="black" points="968.49,-16107.16 958.43,-16103.84 964.23,-16112.71 968.49,-16107.16"/>
</g>
<!-- layer_5_mlp_fc1_gpu10 -->
<g id="node155" class="node">
<title>layer_5_mlp_fc1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1084.5,-16103.56 990.5,-16103.56 990.5,-16051.56 1084.5,-16051.56 1084.5,-16103.56"/>
<text text-anchor="middle" x="1037.5" y="-16091.56" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="1037.5" y="-16080.56" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="1037.5" y="-16069.56" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1037.5" y="-16058.56" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu10 -->
<g id="edge199" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu10</title>
<path fill="none" stroke="black" d="M1037.5,-16139.22C1037.5,-16131.26 1037.5,-16122.32 1037.5,-16113.8"/>
<polygon fill="black" stroke="black" points="1041,-16113.71 1037.5,-16103.71 1034,-16113.71 1041,-16113.71"/>
</g>
<!-- layer_5_mlp_fc1_gpu11 -->
<g id="node156" class="node">
<title>layer_5_mlp_fc1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="1196.5,-16103.56 1102.5,-16103.56 1102.5,-16051.56 1196.5,-16051.56 1196.5,-16103.56"/>
<text text-anchor="middle" x="1149.5" y="-16091.56" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="1149.5" y="-16080.56" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="1149.5" y="-16069.56" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1149.5" y="-16058.56" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu11 -->
<g id="edge200" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu11</title>
<path fill="none" stroke="black" d="M1070.2,-16139.45C1082.17,-16130.26 1095.87,-16119.74 1108.47,-16110.06"/>
<polygon fill="black" stroke="black" points="1110.77,-16112.71 1116.57,-16103.84 1106.51,-16107.16 1110.77,-16112.71"/>
</g>
<!-- layer_5_allgather_mlp -->
<g id="node157" class="node">
<title>layer_5_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="925.5" cy="-15978.79" rx="56.64" ry="36.54"/>
<text text-anchor="middle" x="925.5" y="-15992.79" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="925.5" y="-15981.79" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="925.5" y="-15970.79" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="925.5" y="-15959.79" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_5_mlp_fc1_gpu8&#45;&gt;layer_5_allgather_mlp -->
<g id="edge201" class="edge">
<title>layer_5_mlp_fc1_gpu8&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M842.63,-16051.38C855.31,-16040.43 870.4,-16027.39 884.2,-16015.47"/>
<polygon fill="black" stroke="black" points="886.87,-16017.78 892.15,-16008.6 882.3,-16012.49 886.87,-16017.78"/>
</g>
<!-- layer_5_mlp_fc1_gpu9&#45;&gt;layer_5_allgather_mlp -->
<g id="edge202" class="edge">
<title>layer_5_mlp_fc1_gpu9&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M925.5,-16051.38C925.5,-16043.58 925.5,-16034.71 925.5,-16025.94"/>
<polygon fill="black" stroke="black" points="929,-16025.76 925.5,-16015.76 922,-16025.76 929,-16025.76"/>
</g>
<!-- layer_5_mlp_fc1_gpu10&#45;&gt;layer_5_allgather_mlp -->
<g id="edge203" class="edge">
<title>layer_5_mlp_fc1_gpu10&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M1008.37,-16051.38C995.69,-16040.43 980.6,-16027.39 966.8,-16015.47"/>
<polygon fill="black" stroke="black" points="968.7,-16012.49 958.85,-16008.6 964.13,-16017.78 968.7,-16012.49"/>
</g>
<!-- layer_5_mlp_fc1_gpu11&#45;&gt;layer_5_allgather_mlp -->
<g id="edge204" class="edge">
<title>layer_5_mlp_fc1_gpu11&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M1102.47,-16055.49C1099.44,-16054.16 1096.43,-16052.83 1093.5,-16051.56 1056.33,-16035.32 1014.38,-16017.4 981.69,-16003.52"/>
<polygon fill="black" stroke="black" points="982.87,-16000.22 972.3,-15999.54 980.14,-16006.67 982.87,-16000.22"/>
</g>
<!-- layer_5_gelu -->
<g id="node158" class="node">
<title>layer_5_gelu</title>
<polygon fill="lightblue" stroke="black" points="942,-15906.02 853,-15906.02 853,-15865.02 942,-15865.02 942,-15906.02"/>
<text text-anchor="middle" x="897.5" y="-15894.02" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="897.5" y="-15883.02" font-family="Arial" font-size="10.00">GELU Activation</text>
<text text-anchor="middle" x="897.5" y="-15872.02" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_5_allgather_mlp&#45;&gt;layer_5_gelu -->
<g id="edge205" class="edge">
<title>layer_5_allgather_mlp&#45;&gt;layer_5_gelu</title>
<path fill="none" stroke="black" d="M914.67,-15942.5C911.98,-15933.73 909.13,-15924.41 906.53,-15915.96"/>
<polygon fill="black" stroke="black" points="909.8,-15914.69 903.52,-15906.16 903.11,-15916.74 909.8,-15914.69"/>
</g>
<!-- layer_5_mlp_fc2_gpu8 -->
<g id="node159" class="node">
<title>layer_5_mlp_fc2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="888.5,-15829.02 794.5,-15829.02 794.5,-15777.02 888.5,-15777.02 888.5,-15829.02"/>
<text text-anchor="middle" x="841.5" y="-15817.02" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="841.5" y="-15806.02" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="841.5" y="-15795.02" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="841.5" y="-15784.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu8 -->
<g id="edge206" class="edge">
<title>layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu8</title>
<path fill="none" stroke="black" d="M883.66,-15864.62C877.95,-15856.42 871.19,-15846.69 864.76,-15837.46"/>
<polygon fill="black" stroke="black" points="867.58,-15835.38 859,-15829.17 861.84,-15839.38 867.58,-15835.38"/>
</g>
<!-- layer_5_allreduce_mlp -->
<g id="node163" class="node">
<title>layer_5_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="1065.5" cy="-15704.25" rx="60.21" ry="36.54"/>
<text text-anchor="middle" x="1065.5" y="-15718.25" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1065.5" y="-15707.25" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="1065.5" y="-15696.25" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1065.5" y="-15685.25" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_5_mlp_fc2_gpu8&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge207" class="edge">
<title>layer_5_mlp_fc2_gpu8&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M888.53,-15780.96C891.56,-15779.62 894.57,-15778.3 897.5,-15777.02 933.87,-15761.13 974.83,-15743.62 1007.2,-15729.88"/>
<polygon fill="black" stroke="black" points="1008.69,-15733.05 1016.52,-15725.92 1005.95,-15726.61 1008.69,-15733.05"/>
</g>
<!-- layer_5_mlp_fc2_gpu9 -->
<g id="node160" class="node">
<title>layer_5_mlp_fc2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="1000.5,-15829.02 906.5,-15829.02 906.5,-15777.02 1000.5,-15777.02 1000.5,-15829.02"/>
<text text-anchor="middle" x="953.5" y="-15817.02" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="953.5" y="-15806.02" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="953.5" y="-15795.02" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="953.5" y="-15784.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_mlp_fc2_gpu9&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge208" class="edge">
<title>layer_5_mlp_fc2_gpu9&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M982.63,-15776.84C995.1,-15766.08 1009.88,-15753.3 1023.49,-15741.54"/>
<polygon fill="black" stroke="black" points="1026.07,-15743.95 1031.34,-15734.76 1021.49,-15738.65 1026.07,-15743.95"/>
</g>
<!-- layer_5_mlp_fc2_gpu10 -->
<g id="node161" class="node">
<title>layer_5_mlp_fc2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1112.5,-15829.02 1018.5,-15829.02 1018.5,-15777.02 1112.5,-15777.02 1112.5,-15829.02"/>
<text text-anchor="middle" x="1065.5" y="-15817.02" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="1065.5" y="-15806.02" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="1065.5" y="-15795.02" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1065.5" y="-15784.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_mlp_fc2_gpu10&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge209" class="edge">
<title>layer_5_mlp_fc2_gpu10&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1065.5,-15776.84C1065.5,-15769.04 1065.5,-15760.17 1065.5,-15751.4"/>
<polygon fill="black" stroke="black" points="1069,-15751.22 1065.5,-15741.22 1062,-15751.22 1069,-15751.22"/>
</g>
<!-- layer_5_mlp_fc2_gpu11 -->
<g id="node162" class="node">
<title>layer_5_mlp_fc2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="1224.5,-15829.02 1130.5,-15829.02 1130.5,-15777.02 1224.5,-15777.02 1224.5,-15829.02"/>
<text text-anchor="middle" x="1177.5" y="-15817.02" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="1177.5" y="-15806.02" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="1177.5" y="-15795.02" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1177.5" y="-15784.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_mlp_fc2_gpu11&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge210" class="edge">
<title>layer_5_mlp_fc2_gpu11&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1148.37,-15776.84C1135.9,-15766.08 1121.12,-15753.3 1107.51,-15741.54"/>
<polygon fill="black" stroke="black" points="1109.51,-15738.65 1099.66,-15734.76 1104.93,-15743.95 1109.51,-15738.65"/>
</g>
<!-- layer_5_allreduce_mlp&#45;&gt;layer_5_residual2 -->
<g id="edge211" class="edge">
<title>layer_5_allreduce_mlp&#45;&gt;layer_5_residual2</title>
<path fill="none" stroke="black" d="M1092.15,-15671.22C1100.36,-15661.36 1109.58,-15650.27 1118.48,-15639.58"/>
<polygon fill="black" stroke="black" points="1121.18,-15641.81 1124.88,-15631.88 1115.79,-15637.33 1121.18,-15641.81"/>
</g>
<!-- layer_5_ln2 -->
<g id="node165" class="node">
<title>layer_5_ln2</title>
<polygon fill="lightblue" stroke="black" points="1195,-15513.48 1122,-15513.48 1122,-15461.48 1195,-15461.48 1195,-15513.48"/>
<text text-anchor="middle" x="1158.5" y="-15501.48" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1158.5" y="-15490.48" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="1158.5" y="-15479.48" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="1158.5" y="-15468.48" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- layer_5_residual2&#45;&gt;layer_5_ln2 -->
<g id="edge213" class="edge">
<title>layer_5_residual2&#45;&gt;layer_5_ln2</title>
<path fill="none" stroke="black" d="M1158.5,-15549.27C1158.5,-15540.84 1158.5,-15532.01 1158.5,-15523.77"/>
<polygon fill="black" stroke="black" points="1162,-15523.73 1158.5,-15513.73 1155,-15523.73 1162,-15523.73"/>
</g>
<!-- layer_5_to_gpu3 -->
<g id="node166" class="node">
<title>layer_5_to_gpu3</title>
<ellipse fill="purple" stroke="black" cx="1158.5" cy="-15396.49" rx="58.88" ry="28.98"/>
<text text-anchor="middle" x="1158.5" y="-15404.99" font-family="Arial" font-size="10.00">Layer 5→6</text>
<text text-anchor="middle" x="1158.5" y="-15393.99" font-family="Arial" font-size="10.00">Pipeline Comm</text>
<text text-anchor="middle" x="1158.5" y="-15382.99" font-family="Arial" font-size="10.00">GPU 2→3</text>
</g>
<!-- layer_5_ln2&#45;&gt;layer_5_to_gpu3 -->
<g id="edge214" class="edge">
<title>layer_5_ln2&#45;&gt;layer_5_to_gpu3</title>
<path fill="none" stroke="black" d="M1158.5,-15461.21C1158.5,-15453.32 1158.5,-15444.43 1158.5,-15435.85"/>
<polygon fill="black" stroke="black" points="1162,-15435.63 1158.5,-15425.63 1155,-15435.63 1162,-15435.63"/>
</g>
<!-- layer_6_input_dist -->
<g id="node167" class="node">
<title>layer_6_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="1252.69,-15331.5 1102.86,-15331.5 1064.31,-15249.5 1214.14,-15249.5 1252.69,-15331.5"/>
<text text-anchor="middle" x="1158.5" y="-15299" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1158.5" y="-15288" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="1158.5" y="-15277" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_5_to_gpu3&#45;&gt;layer_6_input_dist -->
<g id="edge215" class="edge">
<title>layer_5_to_gpu3&#45;&gt;layer_6_input_dist</title>
<path fill="none" stroke="black" d="M1158.5,-15367.35C1158.5,-15359.48 1158.5,-15350.68 1158.5,-15341.94"/>
<polygon fill="black" stroke="black" points="1162,-15341.76 1158.5,-15331.76 1155,-15341.76 1162,-15341.76"/>
</g>
<!-- layer_6_qkv_gpu12 -->
<g id="node168" class="node">
<title>layer_6_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="983,-15213.5 890,-15213.5 890,-15161.5 983,-15161.5 983,-15213.5"/>
<text text-anchor="middle" x="936.5" y="-15201.5" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="936.5" y="-15190.5" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="936.5" y="-15179.5" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="936.5" y="-15168.5" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu12 -->
<g id="edge216" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu12</title>
<path fill="none" stroke="black" d="M1070.44,-15249.43C1044.15,-15237.47 1016.07,-15224.69 992.44,-15213.94"/>
<polygon fill="black" stroke="black" points="993.83,-15210.73 983.28,-15209.78 990.93,-15217.1 993.83,-15210.73"/>
</g>
<!-- layer_6_qkv_gpu13 -->
<g id="node169" class="node">
<title>layer_6_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="1094,-15213.5 1001,-15213.5 1001,-15161.5 1094,-15161.5 1094,-15213.5"/>
<text text-anchor="middle" x="1047.5" y="-15201.5" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="1047.5" y="-15190.5" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="1047.5" y="-15179.5" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1047.5" y="-15168.5" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu13 -->
<g id="edge217" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu13</title>
<path fill="none" stroke="black" d="M1114.31,-15249.29C1103.81,-15239.73 1092.74,-15229.66 1082.7,-15220.53"/>
<polygon fill="black" stroke="black" points="1085,-15217.89 1075.25,-15213.75 1080.29,-15223.07 1085,-15217.89"/>
</g>
<!-- layer_6_qkv_gpu14 -->
<g id="node170" class="node">
<title>layer_6_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="1205,-15213.5 1112,-15213.5 1112,-15161.5 1205,-15161.5 1205,-15213.5"/>
<text text-anchor="middle" x="1158.5" y="-15201.5" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="1158.5" y="-15190.5" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="1158.5" y="-15179.5" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1158.5" y="-15168.5" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu14 -->
<g id="edge218" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu14</title>
<path fill="none" stroke="black" d="M1158.5,-15249.29C1158.5,-15240.85 1158.5,-15232.02 1158.5,-15223.79"/>
<polygon fill="black" stroke="black" points="1162,-15223.75 1158.5,-15213.75 1155,-15223.75 1162,-15223.75"/>
</g>
<!-- layer_6_qkv_gpu15 -->
<g id="node171" class="node">
<title>layer_6_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="1316,-15213.5 1223,-15213.5 1223,-15161.5 1316,-15161.5 1316,-15213.5"/>
<text text-anchor="middle" x="1269.5" y="-15201.5" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="1269.5" y="-15190.5" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="1269.5" y="-15179.5" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1269.5" y="-15168.5" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu15 -->
<g id="edge219" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu15</title>
<path fill="none" stroke="black" d="M1202.69,-15249.29C1213.19,-15239.73 1224.26,-15229.66 1234.3,-15220.53"/>
<polygon fill="black" stroke="black" points="1236.71,-15223.07 1241.75,-15213.75 1232,-15217.89 1236.71,-15223.07"/>
</g>
<!-- layer_6_residual1 -->
<g id="node179" class="node">
<title>layer_6_residual1</title>
<polygon fill="lightyellow" stroke="black" points="1355.44,-14730.42 1233.05,-14730.42 1201.56,-14648.42 1323.95,-14648.42 1355.44,-14730.42"/>
<text text-anchor="middle" x="1278.5" y="-14697.92" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1278.5" y="-14686.92" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1278.5" y="-14675.92" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_residual1 -->
<g id="edge231" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_residual1</title>
<path fill="none" stroke="black" d="M1225.19,-15272.94C1259.31,-15261.38 1299.11,-15242.67 1325.5,-15213.5 1364.47,-15170.42 1367.5,-15147.82 1367.5,-15089.73 1367.5,-15089.73 1367.5,-15089.73 1367.5,-14900.96 1367.5,-14841.99 1337.51,-14780.54 1312.35,-14739.36"/>
<polygon fill="black" stroke="black" points="1315.17,-14737.26 1306.9,-14730.63 1309.23,-14740.97 1315.17,-14737.26"/>
</g>
<!-- layer_6_allgather_qkv -->
<g id="node172" class="node">
<title>layer_6_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="1047.5" cy="-15088.73" rx="57.05" ry="36.54"/>
<text text-anchor="middle" x="1047.5" y="-15102.73" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1047.5" y="-15091.73" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="1047.5" y="-15080.73" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1047.5" y="-15069.73" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_6_qkv_gpu12&#45;&gt;layer_6_allgather_qkv -->
<g id="edge220" class="edge">
<title>layer_6_qkv_gpu12&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M965.37,-15161.32C977.83,-15150.46 992.64,-15137.56 1006.22,-15125.71"/>
<polygon fill="black" stroke="black" points="1008.81,-15128.1 1014.05,-15118.89 1004.21,-15122.82 1008.81,-15128.1"/>
</g>
<!-- layer_6_qkv_gpu13&#45;&gt;layer_6_allgather_qkv -->
<g id="edge221" class="edge">
<title>layer_6_qkv_gpu13&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M1047.5,-15161.32C1047.5,-15153.51 1047.5,-15144.65 1047.5,-15135.88"/>
<polygon fill="black" stroke="black" points="1051,-15135.7 1047.5,-15125.7 1044,-15135.7 1051,-15135.7"/>
</g>
<!-- layer_6_qkv_gpu14&#45;&gt;layer_6_allgather_qkv -->
<g id="edge222" class="edge">
<title>layer_6_qkv_gpu14&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M1129.63,-15161.32C1117.17,-15150.46 1102.36,-15137.56 1088.78,-15125.71"/>
<polygon fill="black" stroke="black" points="1090.79,-15122.82 1080.95,-15118.89 1086.19,-15128.1 1090.79,-15122.82"/>
</g>
<!-- layer_6_qkv_gpu15&#45;&gt;layer_6_allgather_qkv -->
<g id="edge223" class="edge">
<title>layer_6_qkv_gpu15&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M1222.72,-15165.15C1219.94,-15163.91 1217.19,-15162.68 1214.5,-15161.5 1177.85,-15145.29 1136.48,-15127.51 1104.08,-15113.7"/>
<polygon fill="black" stroke="black" points="1105.33,-15110.43 1094.76,-15109.73 1102.59,-15116.87 1105.33,-15110.43"/>
</g>
<!-- layer_6_attention -->
<g id="node173" class="node">
<title>layer_6_attention</title>
<polygon fill="lightblue" stroke="black" points="1057.5,-15015.96 989.5,-15015.96 989.5,-14963.96 1057.5,-14963.96 1057.5,-15015.96"/>
<text text-anchor="middle" x="1023.5" y="-15003.96" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1023.5" y="-14992.96" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1023.5" y="-14981.96" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="1023.5" y="-14970.96" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_6_allgather_qkv&#45;&gt;layer_6_attention -->
<g id="edge224" class="edge">
<title>layer_6_allgather_qkv&#45;&gt;layer_6_attention</title>
<path fill="none" stroke="black" d="M1038.7,-15052.24C1036.56,-15043.63 1034.28,-15034.44 1032.16,-15025.86"/>
<polygon fill="black" stroke="black" points="1035.55,-15025.01 1029.75,-15016.14 1028.76,-15026.69 1035.55,-15025.01"/>
</g>
<!-- layer_6_attn_out_gpu12 -->
<g id="node174" class="node">
<title>layer_6_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="1021.5,-14927.96 933.5,-14927.96 933.5,-14875.96 1021.5,-14875.96 1021.5,-14927.96"/>
<text text-anchor="middle" x="977.5" y="-14915.96" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="977.5" y="-14904.96" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="977.5" y="-14893.96" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="977.5" y="-14882.96" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attention&#45;&gt;layer_6_attn_out_gpu12 -->
<g id="edge225" class="edge">
<title>layer_6_attention&#45;&gt;layer_6_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M1009.95,-14963.62C1005.5,-14955.31 1000.49,-14945.93 995.75,-14937.08"/>
<polygon fill="black" stroke="black" points="998.76,-14935.28 990.96,-14928.11 992.59,-14938.58 998.76,-14935.28"/>
</g>
<!-- layer_6_allreduce_attn -->
<g id="node178" class="node">
<title>layer_6_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="1189.5" cy="-14803.19" rx="57.97" ry="36.54"/>
<text text-anchor="middle" x="1189.5" y="-14817.19" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1189.5" y="-14806.19" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="1189.5" y="-14795.19" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1189.5" y="-14784.19" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_6_attn_out_gpu12&#45;&gt;layer_6_allreduce_attn -->
<g id="edge226" class="edge">
<title>layer_6_attn_out_gpu12&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M1021.72,-14880.03C1024.69,-14878.65 1027.64,-14877.28 1030.5,-14875.96 1064.64,-14860.2 1103.07,-14842.85 1133.59,-14829.15"/>
<polygon fill="black" stroke="black" points="1135.1,-14832.31 1142.79,-14825.02 1132.24,-14825.92 1135.1,-14832.31"/>
</g>
<!-- layer_6_attn_out_gpu13 -->
<g id="node175" class="node">
<title>layer_6_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="1127.5,-14927.96 1039.5,-14927.96 1039.5,-14875.96 1127.5,-14875.96 1127.5,-14927.96"/>
<text text-anchor="middle" x="1083.5" y="-14915.96" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="1083.5" y="-14904.96" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="1083.5" y="-14893.96" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1083.5" y="-14882.96" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attn_out_gpu13&#45;&gt;layer_6_allreduce_attn -->
<g id="edge227" class="edge">
<title>layer_6_attn_out_gpu13&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M1111.07,-14875.78C1122.66,-14865.21 1136.36,-14852.7 1149.05,-14841.12"/>
<polygon fill="black" stroke="black" points="1151.76,-14843.38 1156.79,-14834.05 1147.04,-14838.21 1151.76,-14843.38"/>
</g>
<!-- layer_6_attn_out_gpu14 -->
<g id="node176" class="node">
<title>layer_6_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="1233.5,-14927.96 1145.5,-14927.96 1145.5,-14875.96 1233.5,-14875.96 1233.5,-14927.96"/>
<text text-anchor="middle" x="1189.5" y="-14915.96" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="1189.5" y="-14904.96" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="1189.5" y="-14893.96" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1189.5" y="-14882.96" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attn_out_gpu14&#45;&gt;layer_6_allreduce_attn -->
<g id="edge228" class="edge">
<title>layer_6_attn_out_gpu14&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M1189.5,-14875.78C1189.5,-14867.98 1189.5,-14859.11 1189.5,-14850.34"/>
<polygon fill="black" stroke="black" points="1193,-14850.16 1189.5,-14840.16 1186,-14850.16 1193,-14850.16"/>
</g>
<!-- layer_6_attn_out_gpu15 -->
<g id="node177" class="node">
<title>layer_6_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="1339.5,-14927.96 1251.5,-14927.96 1251.5,-14875.96 1339.5,-14875.96 1339.5,-14927.96"/>
<text text-anchor="middle" x="1295.5" y="-14915.96" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="1295.5" y="-14904.96" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="1295.5" y="-14893.96" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1295.5" y="-14882.96" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attn_out_gpu15&#45;&gt;layer_6_allreduce_attn -->
<g id="edge229" class="edge">
<title>layer_6_attn_out_gpu15&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M1267.93,-14875.78C1256.34,-14865.21 1242.64,-14852.7 1229.95,-14841.12"/>
<polygon fill="black" stroke="black" points="1231.96,-14838.21 1222.21,-14834.05 1227.24,-14843.38 1231.96,-14838.21"/>
</g>
<!-- layer_6_allreduce_attn&#45;&gt;layer_6_residual1 -->
<g id="edge230" class="edge">
<title>layer_6_allreduce_attn&#45;&gt;layer_6_residual1</title>
<path fill="none" stroke="black" d="M1215,-14770.16C1222.78,-14760.39 1231.51,-14749.43 1239.95,-14738.83"/>
<polygon fill="black" stroke="black" points="1242.84,-14740.82 1246.33,-14730.82 1237.36,-14736.46 1242.84,-14740.82"/>
</g>
<!-- layer_6_ln1 -->
<g id="node180" class="node">
<title>layer_6_ln1</title>
<polygon fill="lightblue" stroke="black" points="1222,-14612.42 1149,-14612.42 1149,-14560.42 1222,-14560.42 1222,-14612.42"/>
<text text-anchor="middle" x="1185.5" y="-14600.42" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1185.5" y="-14589.42" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="1185.5" y="-14578.42" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="1185.5" y="-14567.42" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_6_residual1&#45;&gt;layer_6_ln1 -->
<g id="edge232" class="edge">
<title>layer_6_residual1&#45;&gt;layer_6_ln1</title>
<path fill="none" stroke="black" d="M1241.48,-14648.21C1232.94,-14638.93 1223.95,-14629.17 1215.74,-14620.26"/>
<polygon fill="black" stroke="black" points="1218.1,-14617.65 1208.75,-14612.67 1212.95,-14622.4 1218.1,-14617.65"/>
</g>
<!-- layer_6_residual2 -->
<g id="node192" class="node">
<title>layer_6_residual2</title>
<polygon fill="lightyellow" stroke="black" points="1383.44,-14052.34 1261.05,-14052.34 1229.56,-13970.34 1351.95,-13970.34 1383.44,-14052.34"/>
<text text-anchor="middle" x="1306.5" y="-14019.84" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1306.5" y="-14008.84" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1306.5" y="-13997.84" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_6_residual1&#45;&gt;layer_6_residual2 -->
<g id="edge248" class="edge">
<title>layer_6_residual1&#45;&gt;layer_6_residual2</title>
<path fill="none" stroke="black" d="M1323.93,-14648.17C1358.61,-14612.82 1400.5,-14558 1400.5,-14499.42 1400.5,-14499.42 1400.5,-14499.42 1400.5,-14222.88 1400.5,-14163.46 1368.89,-14102.16 1342.34,-14061.14"/>
<polygon fill="black" stroke="black" points="1345.19,-14059.11 1336.76,-14052.7 1339.35,-14062.97 1345.19,-14059.11"/>
</g>
<!-- layer_6_mlp_fc1_gpu12 -->
<g id="node181" class="node">
<title>layer_6_mlp_fc1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="1008.5,-14524.42 914.5,-14524.42 914.5,-14472.42 1008.5,-14472.42 1008.5,-14524.42"/>
<text text-anchor="middle" x="961.5" y="-14512.42" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="961.5" y="-14501.42" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="961.5" y="-14490.42" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="961.5" y="-14479.42" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu12 -->
<g id="edge233" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu12</title>
<path fill="none" stroke="black" d="M1148.84,-14572.95C1116.62,-14561.81 1068.31,-14544.66 1018.14,-14524.58"/>
<polygon fill="black" stroke="black" points="1019.34,-14521.29 1008.75,-14520.8 1016.72,-14527.78 1019.34,-14521.29"/>
</g>
<!-- layer_6_mlp_fc1_gpu13 -->
<g id="node182" class="node">
<title>layer_6_mlp_fc1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="1120.5,-14524.42 1026.5,-14524.42 1026.5,-14472.42 1120.5,-14472.42 1120.5,-14524.42"/>
<text text-anchor="middle" x="1073.5" y="-14512.42" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="1073.5" y="-14501.42" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="1073.5" y="-14490.42" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1073.5" y="-14479.42" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu13 -->
<g id="edge234" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu13</title>
<path fill="none" stroke="black" d="M1152.8,-14560.31C1140.83,-14551.12 1127.13,-14540.6 1114.53,-14530.92"/>
<polygon fill="black" stroke="black" points="1116.49,-14528.02 1106.43,-14524.7 1112.23,-14533.57 1116.49,-14528.02"/>
</g>
<!-- layer_6_mlp_fc1_gpu14 -->
<g id="node183" class="node">
<title>layer_6_mlp_fc1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="1232.5,-14524.42 1138.5,-14524.42 1138.5,-14472.42 1232.5,-14472.42 1232.5,-14524.42"/>
<text text-anchor="middle" x="1185.5" y="-14512.42" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="1185.5" y="-14501.42" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="1185.5" y="-14490.42" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1185.5" y="-14479.42" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu14 -->
<g id="edge235" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu14</title>
<path fill="none" stroke="black" d="M1185.5,-14560.08C1185.5,-14552.12 1185.5,-14543.18 1185.5,-14534.66"/>
<polygon fill="black" stroke="black" points="1189,-14534.57 1185.5,-14524.57 1182,-14534.57 1189,-14534.57"/>
</g>
<!-- layer_6_mlp_fc1_gpu15 -->
<g id="node184" class="node">
<title>layer_6_mlp_fc1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="1344.5,-14524.42 1250.5,-14524.42 1250.5,-14472.42 1344.5,-14472.42 1344.5,-14524.42"/>
<text text-anchor="middle" x="1297.5" y="-14512.42" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="1297.5" y="-14501.42" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="1297.5" y="-14490.42" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1297.5" y="-14479.42" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu15 -->
<g id="edge236" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu15</title>
<path fill="none" stroke="black" d="M1218.2,-14560.31C1230.17,-14551.12 1243.87,-14540.6 1256.47,-14530.92"/>
<polygon fill="black" stroke="black" points="1258.77,-14533.57 1264.57,-14524.7 1254.51,-14528.02 1258.77,-14533.57"/>
</g>
<!-- layer_6_allgather_mlp -->
<g id="node185" class="node">
<title>layer_6_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="1073.5" cy="-14399.65" rx="56.64" ry="36.54"/>
<text text-anchor="middle" x="1073.5" y="-14413.65" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1073.5" y="-14402.65" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="1073.5" y="-14391.65" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1073.5" y="-14380.65" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_6_mlp_fc1_gpu12&#45;&gt;layer_6_allgather_mlp -->
<g id="edge237" class="edge">
<title>layer_6_mlp_fc1_gpu12&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M990.63,-14472.24C1003.31,-14461.29 1018.4,-14448.26 1032.2,-14436.33"/>
<polygon fill="black" stroke="black" points="1034.87,-14438.65 1040.15,-14429.46 1030.3,-14433.35 1034.87,-14438.65"/>
</g>
<!-- layer_6_mlp_fc1_gpu13&#45;&gt;layer_6_allgather_mlp -->
<g id="edge238" class="edge">
<title>layer_6_mlp_fc1_gpu13&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M1073.5,-14472.24C1073.5,-14464.44 1073.5,-14455.57 1073.5,-14446.8"/>
<polygon fill="black" stroke="black" points="1077,-14446.62 1073.5,-14436.62 1070,-14446.62 1077,-14446.62"/>
</g>
<!-- layer_6_mlp_fc1_gpu14&#45;&gt;layer_6_allgather_mlp -->
<g id="edge239" class="edge">
<title>layer_6_mlp_fc1_gpu14&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M1156.37,-14472.24C1143.69,-14461.29 1128.6,-14448.26 1114.8,-14436.33"/>
<polygon fill="black" stroke="black" points="1116.7,-14433.35 1106.85,-14429.46 1112.13,-14438.65 1116.7,-14433.35"/>
</g>
<!-- layer_6_mlp_fc1_gpu15&#45;&gt;layer_6_allgather_mlp -->
<g id="edge240" class="edge">
<title>layer_6_mlp_fc1_gpu15&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M1250.47,-14476.36C1247.44,-14475.02 1244.43,-14473.7 1241.5,-14472.42 1204.33,-14456.18 1162.38,-14438.26 1129.69,-14424.39"/>
<polygon fill="black" stroke="black" points="1130.87,-14421.08 1120.3,-14420.4 1128.14,-14427.53 1130.87,-14421.08"/>
</g>
<!-- layer_6_gelu -->
<g id="node186" class="node">
<title>layer_6_gelu</title>
<polygon fill="lightblue" stroke="black" points="1090,-14326.88 1001,-14326.88 1001,-14285.88 1090,-14285.88 1090,-14326.88"/>
<text text-anchor="middle" x="1045.5" y="-14314.88" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1045.5" y="-14303.88" font-family="Arial" font-size="10.00">GELU Activation</text>
<text text-anchor="middle" x="1045.5" y="-14292.88" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_6_allgather_mlp&#45;&gt;layer_6_gelu -->
<g id="edge241" class="edge">
<title>layer_6_allgather_mlp&#45;&gt;layer_6_gelu</title>
<path fill="none" stroke="black" d="M1062.67,-14363.36C1059.98,-14354.59 1057.13,-14345.28 1054.53,-14336.82"/>
<polygon fill="black" stroke="black" points="1057.8,-14335.55 1051.52,-14327.02 1051.11,-14337.6 1057.8,-14335.55"/>
</g>
<!-- layer_6_mlp_fc2_gpu12 -->
<g id="node187" class="node">
<title>layer_6_mlp_fc2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="1036.5,-14249.88 942.5,-14249.88 942.5,-14197.88 1036.5,-14197.88 1036.5,-14249.88"/>
<text text-anchor="middle" x="989.5" y="-14237.88" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="989.5" y="-14226.88" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="989.5" y="-14215.88" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="989.5" y="-14204.88" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu12 -->
<g id="edge242" class="edge">
<title>layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu12</title>
<path fill="none" stroke="black" d="M1031.66,-14285.48C1025.95,-14277.28 1019.19,-14267.55 1012.76,-14258.32"/>
<polygon fill="black" stroke="black" points="1015.58,-14256.24 1007,-14250.03 1009.84,-14260.24 1015.58,-14256.24"/>
</g>
<!-- layer_6_allreduce_mlp -->
<g id="node191" class="node">
<title>layer_6_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="1213.5" cy="-14125.11" rx="60.21" ry="36.54"/>
<text text-anchor="middle" x="1213.5" y="-14139.11" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1213.5" y="-14128.11" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="1213.5" y="-14117.11" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1213.5" y="-14106.11" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_6_mlp_fc2_gpu12&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge243" class="edge">
<title>layer_6_mlp_fc2_gpu12&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1036.53,-14201.82C1039.56,-14200.48 1042.57,-14199.16 1045.5,-14197.88 1081.87,-14181.99 1122.83,-14164.48 1155.2,-14150.74"/>
<polygon fill="black" stroke="black" points="1156.69,-14153.91 1164.52,-14146.78 1153.95,-14147.47 1156.69,-14153.91"/>
</g>
<!-- layer_6_mlp_fc2_gpu13 -->
<g id="node188" class="node">
<title>layer_6_mlp_fc2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="1148.5,-14249.88 1054.5,-14249.88 1054.5,-14197.88 1148.5,-14197.88 1148.5,-14249.88"/>
<text text-anchor="middle" x="1101.5" y="-14237.88" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="1101.5" y="-14226.88" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="1101.5" y="-14215.88" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1101.5" y="-14204.88" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_mlp_fc2_gpu13&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge244" class="edge">
<title>layer_6_mlp_fc2_gpu13&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1130.63,-14197.71C1143.1,-14186.94 1157.88,-14174.16 1171.49,-14162.4"/>
<polygon fill="black" stroke="black" points="1174.07,-14164.81 1179.34,-14155.62 1169.49,-14159.51 1174.07,-14164.81"/>
</g>
<!-- layer_6_mlp_fc2_gpu14 -->
<g id="node189" class="node">
<title>layer_6_mlp_fc2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="1260.5,-14249.88 1166.5,-14249.88 1166.5,-14197.88 1260.5,-14197.88 1260.5,-14249.88"/>
<text text-anchor="middle" x="1213.5" y="-14237.88" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="1213.5" y="-14226.88" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="1213.5" y="-14215.88" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1213.5" y="-14204.88" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_mlp_fc2_gpu14&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge245" class="edge">
<title>layer_6_mlp_fc2_gpu14&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1213.5,-14197.71C1213.5,-14189.9 1213.5,-14181.03 1213.5,-14172.26"/>
<polygon fill="black" stroke="black" points="1217,-14172.08 1213.5,-14162.08 1210,-14172.08 1217,-14172.08"/>
</g>
<!-- layer_6_mlp_fc2_gpu15 -->
<g id="node190" class="node">
<title>layer_6_mlp_fc2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="1372.5,-14249.88 1278.5,-14249.88 1278.5,-14197.88 1372.5,-14197.88 1372.5,-14249.88"/>
<text text-anchor="middle" x="1325.5" y="-14237.88" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="1325.5" y="-14226.88" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="1325.5" y="-14215.88" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1325.5" y="-14204.88" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_mlp_fc2_gpu15&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge246" class="edge">
<title>layer_6_mlp_fc2_gpu15&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1296.37,-14197.71C1283.9,-14186.94 1269.12,-14174.16 1255.51,-14162.4"/>
<polygon fill="black" stroke="black" points="1257.51,-14159.51 1247.66,-14155.62 1252.93,-14164.81 1257.51,-14159.51"/>
</g>
<!-- layer_6_allreduce_mlp&#45;&gt;layer_6_residual2 -->
<g id="edge247" class="edge">
<title>layer_6_allreduce_mlp&#45;&gt;layer_6_residual2</title>
<path fill="none" stroke="black" d="M1240.15,-14092.08C1248.36,-14082.22 1257.58,-14071.13 1266.48,-14060.44"/>
<polygon fill="black" stroke="black" points="1269.18,-14062.67 1272.88,-14052.74 1263.79,-14058.19 1269.18,-14062.67"/>
</g>
<!-- layer_6_ln2 -->
<g id="node193" class="node">
<title>layer_6_ln2</title>
<polygon fill="lightblue" stroke="black" points="1343,-13934.34 1270,-13934.34 1270,-13882.34 1343,-13882.34 1343,-13934.34"/>
<text text-anchor="middle" x="1306.5" y="-13922.34" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1306.5" y="-13911.34" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="1306.5" y="-13900.34" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="1306.5" y="-13889.34" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_6_residual2&#45;&gt;layer_6_ln2 -->
<g id="edge249" class="edge">
<title>layer_6_residual2&#45;&gt;layer_6_ln2</title>
<path fill="none" stroke="black" d="M1306.5,-13970.13C1306.5,-13961.7 1306.5,-13952.87 1306.5,-13944.63"/>
<polygon fill="black" stroke="black" points="1310,-13944.59 1306.5,-13934.59 1303,-13944.59 1310,-13944.59"/>
</g>
<!-- layer_7_input_dist -->
<g id="node194" class="node">
<title>layer_7_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="1400.69,-13846.34 1250.86,-13846.34 1212.31,-13764.34 1362.14,-13764.34 1400.69,-13846.34"/>
<text text-anchor="middle" x="1306.5" y="-13813.84" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1306.5" y="-13802.84" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="1306.5" y="-13791.84" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_6_ln2&#45;&gt;layer_7_input_dist -->
<g id="edge250" class="edge">
<title>layer_6_ln2&#45;&gt;layer_7_input_dist</title>
<path fill="none" stroke="black" d="M1306.5,-13882.11C1306.5,-13874.39 1306.5,-13865.59 1306.5,-13856.81"/>
<polygon fill="black" stroke="black" points="1310,-13856.55 1306.5,-13846.55 1303,-13856.55 1310,-13856.55"/>
</g>
<!-- layer_7_qkv_gpu12 -->
<g id="node195" class="node">
<title>layer_7_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="1131,-13728.34 1038,-13728.34 1038,-13676.34 1131,-13676.34 1131,-13728.34"/>
<text text-anchor="middle" x="1084.5" y="-13716.34" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="1084.5" y="-13705.34" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="1084.5" y="-13694.34" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1084.5" y="-13683.34" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu12 -->
<g id="edge251" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu12</title>
<path fill="none" stroke="black" d="M1218.44,-13764.28C1192.15,-13752.32 1164.07,-13739.54 1140.44,-13728.79"/>
<polygon fill="black" stroke="black" points="1141.83,-13725.58 1131.28,-13724.62 1138.93,-13731.95 1141.83,-13725.58"/>
</g>
<!-- layer_7_qkv_gpu13 -->
<g id="node196" class="node">
<title>layer_7_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="1242,-13728.34 1149,-13728.34 1149,-13676.34 1242,-13676.34 1242,-13728.34"/>
<text text-anchor="middle" x="1195.5" y="-13716.34" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="1195.5" y="-13705.34" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="1195.5" y="-13694.34" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1195.5" y="-13683.34" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu13 -->
<g id="edge252" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu13</title>
<path fill="none" stroke="black" d="M1262.31,-13764.13C1251.81,-13754.57 1240.74,-13744.5 1230.7,-13735.37"/>
<polygon fill="black" stroke="black" points="1233,-13732.73 1223.25,-13728.59 1228.29,-13737.91 1233,-13732.73"/>
</g>
<!-- layer_7_qkv_gpu14 -->
<g id="node197" class="node">
<title>layer_7_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="1353,-13728.34 1260,-13728.34 1260,-13676.34 1353,-13676.34 1353,-13728.34"/>
<text text-anchor="middle" x="1306.5" y="-13716.34" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="1306.5" y="-13705.34" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="1306.5" y="-13694.34" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1306.5" y="-13683.34" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu14 -->
<g id="edge253" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu14</title>
<path fill="none" stroke="black" d="M1306.5,-13764.13C1306.5,-13755.7 1306.5,-13746.87 1306.5,-13738.63"/>
<polygon fill="black" stroke="black" points="1310,-13738.59 1306.5,-13728.59 1303,-13738.59 1310,-13738.59"/>
</g>
<!-- layer_7_qkv_gpu15 -->
<g id="node198" class="node">
<title>layer_7_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="1464,-13728.34 1371,-13728.34 1371,-13676.34 1464,-13676.34 1464,-13728.34"/>
<text text-anchor="middle" x="1417.5" y="-13716.34" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="1417.5" y="-13705.34" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="1417.5" y="-13694.34" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1417.5" y="-13683.34" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu15 -->
<g id="edge254" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu15</title>
<path fill="none" stroke="black" d="M1350.69,-13764.13C1361.19,-13754.57 1372.26,-13744.5 1382.3,-13735.37"/>
<polygon fill="black" stroke="black" points="1384.71,-13737.91 1389.75,-13728.59 1380,-13732.73 1384.71,-13737.91"/>
</g>
<!-- layer_7_residual1 -->
<g id="node206" class="node">
<title>layer_7_residual1</title>
<polygon fill="lightyellow" stroke="black" points="1503.44,-13245.26 1381.05,-13245.26 1349.56,-13163.26 1471.95,-13163.26 1503.44,-13245.26"/>
<text text-anchor="middle" x="1426.5" y="-13212.76" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1426.5" y="-13201.76" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1426.5" y="-13190.76" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_residual1 -->
<g id="edge266" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_residual1</title>
<path fill="none" stroke="black" d="M1373.19,-13787.78C1407.31,-13776.22 1447.11,-13757.51 1473.5,-13728.34 1512.47,-13685.26 1515.5,-13662.66 1515.5,-13604.57 1515.5,-13604.57 1515.5,-13604.57 1515.5,-13415.8 1515.5,-13356.83 1485.51,-13295.38 1460.35,-13254.2"/>
<polygon fill="black" stroke="black" points="1463.17,-13252.1 1454.9,-13245.47 1457.23,-13255.81 1463.17,-13252.1"/>
</g>
<!-- layer_7_allgather_qkv -->
<g id="node199" class="node">
<title>layer_7_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="1195.5" cy="-13603.57" rx="57.05" ry="36.54"/>
<text text-anchor="middle" x="1195.5" y="-13617.57" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1195.5" y="-13606.57" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="1195.5" y="-13595.57" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1195.5" y="-13584.57" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_7_qkv_gpu12&#45;&gt;layer_7_allgather_qkv -->
<g id="edge255" class="edge">
<title>layer_7_qkv_gpu12&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M1113.37,-13676.17C1125.83,-13665.31 1140.64,-13652.4 1154.22,-13640.56"/>
<polygon fill="black" stroke="black" points="1156.81,-13642.94 1162.05,-13633.73 1152.21,-13637.66 1156.81,-13642.94"/>
</g>
<!-- layer_7_qkv_gpu13&#45;&gt;layer_7_allgather_qkv -->
<g id="edge256" class="edge">
<title>layer_7_qkv_gpu13&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M1195.5,-13676.17C1195.5,-13668.36 1195.5,-13659.49 1195.5,-13650.72"/>
<polygon fill="black" stroke="black" points="1199,-13650.55 1195.5,-13640.55 1192,-13650.55 1199,-13650.55"/>
</g>
<!-- layer_7_qkv_gpu14&#45;&gt;layer_7_allgather_qkv -->
<g id="edge257" class="edge">
<title>layer_7_qkv_gpu14&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M1277.63,-13676.17C1265.17,-13665.31 1250.36,-13652.4 1236.78,-13640.56"/>
<polygon fill="black" stroke="black" points="1238.79,-13637.66 1228.95,-13633.73 1234.19,-13642.94 1238.79,-13637.66"/>
</g>
<!-- layer_7_qkv_gpu15&#45;&gt;layer_7_allgather_qkv -->
<g id="edge258" class="edge">
<title>layer_7_qkv_gpu15&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M1370.72,-13680C1367.94,-13678.75 1365.19,-13677.53 1362.5,-13676.34 1325.85,-13660.14 1284.48,-13642.35 1252.08,-13628.54"/>
<polygon fill="black" stroke="black" points="1253.33,-13625.27 1242.76,-13624.57 1250.59,-13631.71 1253.33,-13625.27"/>
</g>
<!-- layer_7_attention -->
<g id="node200" class="node">
<title>layer_7_attention</title>
<polygon fill="lightblue" stroke="black" points="1205.5,-13530.8 1137.5,-13530.8 1137.5,-13478.8 1205.5,-13478.8 1205.5,-13530.8"/>
<text text-anchor="middle" x="1171.5" y="-13518.8" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1171.5" y="-13507.8" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1171.5" y="-13496.8" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="1171.5" y="-13485.8" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_7_allgather_qkv&#45;&gt;layer_7_attention -->
<g id="edge259" class="edge">
<title>layer_7_allgather_qkv&#45;&gt;layer_7_attention</title>
<path fill="none" stroke="black" d="M1186.7,-13567.09C1184.56,-13558.48 1182.28,-13549.28 1180.16,-13540.7"/>
<polygon fill="black" stroke="black" points="1183.55,-13539.85 1177.75,-13530.99 1176.76,-13541.53 1183.55,-13539.85"/>
</g>
<!-- layer_7_attn_out_gpu12 -->
<g id="node201" class="node">
<title>layer_7_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="1169.5,-13442.8 1081.5,-13442.8 1081.5,-13390.8 1169.5,-13390.8 1169.5,-13442.8"/>
<text text-anchor="middle" x="1125.5" y="-13430.8" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="1125.5" y="-13419.8" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="1125.5" y="-13408.8" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1125.5" y="-13397.8" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attention&#45;&gt;layer_7_attn_out_gpu12 -->
<g id="edge260" class="edge">
<title>layer_7_attention&#45;&gt;layer_7_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M1157.95,-13478.46C1153.5,-13470.15 1148.49,-13460.78 1143.75,-13451.92"/>
<polygon fill="black" stroke="black" points="1146.76,-13450.12 1138.96,-13442.96 1140.59,-13453.42 1146.76,-13450.12"/>
</g>
<!-- layer_7_allreduce_attn -->
<g id="node205" class="node">
<title>layer_7_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="1337.5" cy="-13318.03" rx="57.97" ry="36.54"/>
<text text-anchor="middle" x="1337.5" y="-13332.03" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1337.5" y="-13321.03" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="1337.5" y="-13310.03" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1337.5" y="-13299.03" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_7_attn_out_gpu12&#45;&gt;layer_7_allreduce_attn -->
<g id="edge261" class="edge">
<title>layer_7_attn_out_gpu12&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M1169.72,-13394.87C1172.69,-13393.49 1175.64,-13392.12 1178.5,-13390.8 1212.64,-13375.04 1251.07,-13357.69 1281.59,-13343.99"/>
<polygon fill="black" stroke="black" points="1283.1,-13347.15 1290.79,-13339.87 1280.24,-13340.76 1283.1,-13347.15"/>
</g>
<!-- layer_7_attn_out_gpu13 -->
<g id="node202" class="node">
<title>layer_7_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="1275.5,-13442.8 1187.5,-13442.8 1187.5,-13390.8 1275.5,-13390.8 1275.5,-13442.8"/>
<text text-anchor="middle" x="1231.5" y="-13430.8" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="1231.5" y="-13419.8" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="1231.5" y="-13408.8" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1231.5" y="-13397.8" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attn_out_gpu13&#45;&gt;layer_7_allreduce_attn -->
<g id="edge262" class="edge">
<title>layer_7_attn_out_gpu13&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M1259.07,-13390.63C1270.66,-13380.05 1284.36,-13367.54 1297.05,-13355.96"/>
<polygon fill="black" stroke="black" points="1299.76,-13358.22 1304.79,-13348.89 1295.04,-13353.05 1299.76,-13358.22"/>
</g>
<!-- layer_7_attn_out_gpu14 -->
<g id="node203" class="node">
<title>layer_7_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="1381.5,-13442.8 1293.5,-13442.8 1293.5,-13390.8 1381.5,-13390.8 1381.5,-13442.8"/>
<text text-anchor="middle" x="1337.5" y="-13430.8" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="1337.5" y="-13419.8" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="1337.5" y="-13408.8" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1337.5" y="-13397.8" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attn_out_gpu14&#45;&gt;layer_7_allreduce_attn -->
<g id="edge263" class="edge">
<title>layer_7_attn_out_gpu14&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M1337.5,-13390.63C1337.5,-13382.82 1337.5,-13373.95 1337.5,-13365.19"/>
<polygon fill="black" stroke="black" points="1341,-13365.01 1337.5,-13355.01 1334,-13365.01 1341,-13365.01"/>
</g>
<!-- layer_7_attn_out_gpu15 -->
<g id="node204" class="node">
<title>layer_7_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="1487.5,-13442.8 1399.5,-13442.8 1399.5,-13390.8 1487.5,-13390.8 1487.5,-13442.8"/>
<text text-anchor="middle" x="1443.5" y="-13430.8" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="1443.5" y="-13419.8" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="1443.5" y="-13408.8" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1443.5" y="-13397.8" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attn_out_gpu15&#45;&gt;layer_7_allreduce_attn -->
<g id="edge264" class="edge">
<title>layer_7_attn_out_gpu15&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M1415.93,-13390.63C1404.34,-13380.05 1390.64,-13367.54 1377.95,-13355.96"/>
<polygon fill="black" stroke="black" points="1379.96,-13353.05 1370.21,-13348.89 1375.24,-13358.22 1379.96,-13353.05"/>
</g>
<!-- layer_7_allreduce_attn&#45;&gt;layer_7_residual1 -->
<g id="edge265" class="edge">
<title>layer_7_allreduce_attn&#45;&gt;layer_7_residual1</title>
<path fill="none" stroke="black" d="M1363,-13285C1370.78,-13275.23 1379.51,-13264.27 1387.95,-13253.67"/>
<polygon fill="black" stroke="black" points="1390.84,-13255.67 1394.33,-13245.67 1385.36,-13251.31 1390.84,-13255.67"/>
</g>
<!-- layer_7_ln1 -->
<g id="node207" class="node">
<title>layer_7_ln1</title>
<polygon fill="lightblue" stroke="black" points="1370,-13127.26 1297,-13127.26 1297,-13075.26 1370,-13075.26 1370,-13127.26"/>
<text text-anchor="middle" x="1333.5" y="-13115.26" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1333.5" y="-13104.26" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="1333.5" y="-13093.26" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="1333.5" y="-13082.26" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_7_residual1&#45;&gt;layer_7_ln1 -->
<g id="edge267" class="edge">
<title>layer_7_residual1&#45;&gt;layer_7_ln1</title>
<path fill="none" stroke="black" d="M1389.48,-13163.05C1380.94,-13153.78 1371.95,-13144.02 1363.74,-13135.1"/>
<polygon fill="black" stroke="black" points="1366.1,-13132.5 1356.75,-13127.51 1360.95,-13137.24 1366.1,-13132.5"/>
</g>
<!-- layer_7_residual2 -->
<g id="node219" class="node">
<title>layer_7_residual2</title>
<polygon fill="lightyellow" stroke="black" points="1531.44,-12567.18 1409.05,-12567.18 1377.56,-12485.18 1499.95,-12485.18 1531.44,-12567.18"/>
<text text-anchor="middle" x="1454.5" y="-12534.68" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1454.5" y="-12523.68" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1454.5" y="-12512.68" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_7_residual1&#45;&gt;layer_7_residual2 -->
<g id="edge283" class="edge">
<title>layer_7_residual1&#45;&gt;layer_7_residual2</title>
<path fill="none" stroke="black" d="M1471.93,-13163.02C1506.61,-13127.66 1548.5,-13072.84 1548.5,-13014.26 1548.5,-13014.26 1548.5,-13014.26 1548.5,-12737.72 1548.5,-12678.3 1516.89,-12617 1490.34,-12575.98"/>
<polygon fill="black" stroke="black" points="1493.19,-12573.96 1484.76,-12567.54 1487.35,-12577.82 1493.19,-12573.96"/>
</g>
<!-- layer_7_mlp_fc1_gpu12 -->
<g id="node208" class="node">
<title>layer_7_mlp_fc1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="1156.5,-13039.26 1062.5,-13039.26 1062.5,-12987.26 1156.5,-12987.26 1156.5,-13039.26"/>
<text text-anchor="middle" x="1109.5" y="-13027.26" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="1109.5" y="-13016.26" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="1109.5" y="-13005.26" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1109.5" y="-12994.26" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu12 -->
<g id="edge268" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu12</title>
<path fill="none" stroke="black" d="M1296.84,-13087.8C1264.62,-13076.66 1216.31,-13059.5 1166.14,-13039.42"/>
<polygon fill="black" stroke="black" points="1167.34,-13036.13 1156.75,-13035.64 1164.72,-13042.63 1167.34,-13036.13"/>
</g>
<!-- layer_7_mlp_fc1_gpu13 -->
<g id="node209" class="node">
<title>layer_7_mlp_fc1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="1268.5,-13039.26 1174.5,-13039.26 1174.5,-12987.26 1268.5,-12987.26 1268.5,-13039.26"/>
<text text-anchor="middle" x="1221.5" y="-13027.26" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="1221.5" y="-13016.26" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="1221.5" y="-13005.26" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1221.5" y="-12994.26" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu13 -->
<g id="edge269" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu13</title>
<path fill="none" stroke="black" d="M1300.8,-13075.15C1288.83,-13065.96 1275.13,-13055.44 1262.53,-13045.76"/>
<polygon fill="black" stroke="black" points="1264.49,-13042.86 1254.43,-13039.55 1260.23,-13048.41 1264.49,-13042.86"/>
</g>
<!-- layer_7_mlp_fc1_gpu14 -->
<g id="node210" class="node">
<title>layer_7_mlp_fc1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="1380.5,-13039.26 1286.5,-13039.26 1286.5,-12987.26 1380.5,-12987.26 1380.5,-13039.26"/>
<text text-anchor="middle" x="1333.5" y="-13027.26" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="1333.5" y="-13016.26" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="1333.5" y="-13005.26" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1333.5" y="-12994.26" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu14 -->
<g id="edge270" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu14</title>
<path fill="none" stroke="black" d="M1333.5,-13074.92C1333.5,-13066.96 1333.5,-13058.02 1333.5,-13049.51"/>
<polygon fill="black" stroke="black" points="1337,-13049.42 1333.5,-13039.42 1330,-13049.42 1337,-13049.42"/>
</g>
<!-- layer_7_mlp_fc1_gpu15 -->
<g id="node211" class="node">
<title>layer_7_mlp_fc1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="1492.5,-13039.26 1398.5,-13039.26 1398.5,-12987.26 1492.5,-12987.26 1492.5,-13039.26"/>
<text text-anchor="middle" x="1445.5" y="-13027.26" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="1445.5" y="-13016.26" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="1445.5" y="-13005.26" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1445.5" y="-12994.26" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu15 -->
<g id="edge271" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu15</title>
<path fill="none" stroke="black" d="M1366.2,-13075.15C1378.17,-13065.96 1391.87,-13055.44 1404.47,-13045.76"/>
<polygon fill="black" stroke="black" points="1406.77,-13048.41 1412.57,-13039.55 1402.51,-13042.86 1406.77,-13048.41"/>
</g>
<!-- layer_7_allgather_mlp -->
<g id="node212" class="node">
<title>layer_7_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="1221.5" cy="-12914.49" rx="56.64" ry="36.54"/>
<text text-anchor="middle" x="1221.5" y="-12928.49" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1221.5" y="-12917.49" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="1221.5" y="-12906.49" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1221.5" y="-12895.49" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_7_mlp_fc1_gpu12&#45;&gt;layer_7_allgather_mlp -->
<g id="edge272" class="edge">
<title>layer_7_mlp_fc1_gpu12&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M1138.63,-12987.09C1151.31,-12976.13 1166.4,-12963.1 1180.2,-12951.17"/>
<polygon fill="black" stroke="black" points="1182.87,-12953.49 1188.15,-12944.3 1178.3,-12948.19 1182.87,-12953.49"/>
</g>
<!-- layer_7_mlp_fc1_gpu13&#45;&gt;layer_7_allgather_mlp -->
<g id="edge273" class="edge">
<title>layer_7_mlp_fc1_gpu13&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M1221.5,-12987.09C1221.5,-12979.28 1221.5,-12970.41 1221.5,-12961.65"/>
<polygon fill="black" stroke="black" points="1225,-12961.47 1221.5,-12951.47 1218,-12961.47 1225,-12961.47"/>
</g>
<!-- layer_7_mlp_fc1_gpu14&#45;&gt;layer_7_allgather_mlp -->
<g id="edge274" class="edge">
<title>layer_7_mlp_fc1_gpu14&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M1304.37,-12987.09C1291.69,-12976.13 1276.6,-12963.1 1262.8,-12951.17"/>
<polygon fill="black" stroke="black" points="1264.7,-12948.19 1254.85,-12944.3 1260.13,-12953.49 1264.7,-12948.19"/>
</g>
<!-- layer_7_mlp_fc1_gpu15&#45;&gt;layer_7_allgather_mlp -->
<g id="edge275" class="edge">
<title>layer_7_mlp_fc1_gpu15&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M1398.47,-12991.2C1395.44,-12989.86 1392.43,-12988.54 1389.5,-12987.26 1352.33,-12971.03 1310.38,-12953.1 1277.69,-12939.23"/>
<polygon fill="black" stroke="black" points="1278.87,-12935.93 1268.3,-12935.24 1276.14,-12942.37 1278.87,-12935.93"/>
</g>
<!-- layer_7_gelu -->
<g id="node213" class="node">
<title>layer_7_gelu</title>
<polygon fill="lightblue" stroke="black" points="1210,-12841.72 1121,-12841.72 1121,-12800.72 1210,-12800.72 1210,-12841.72"/>
<text text-anchor="middle" x="1165.5" y="-12829.72" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1165.5" y="-12818.72" font-family="Arial" font-size="10.00">GELU Activation</text>
<text text-anchor="middle" x="1165.5" y="-12807.72" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_7_allgather_mlp&#45;&gt;layer_7_gelu -->
<g id="edge276" class="edge">
<title>layer_7_allgather_mlp&#45;&gt;layer_7_gelu</title>
<path fill="none" stroke="black" d="M1200.97,-12880.02C1195,-12870.31 1188.56,-12859.8 1182.81,-12850.44"/>
<polygon fill="black" stroke="black" points="1185.78,-12848.57 1177.56,-12841.88 1179.81,-12852.24 1185.78,-12848.57"/>
</g>
<!-- layer_7_mlp_fc2_gpu12 -->
<g id="node214" class="node">
<title>layer_7_mlp_fc2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="1184.5,-12764.72 1090.5,-12764.72 1090.5,-12712.72 1184.5,-12712.72 1184.5,-12764.72"/>
<text text-anchor="middle" x="1137.5" y="-12752.72" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="1137.5" y="-12741.72" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="1137.5" y="-12730.72" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1137.5" y="-12719.72" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu12 -->
<g id="edge277" class="edge">
<title>layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu12</title>
<path fill="none" stroke="black" d="M1158.58,-12800.32C1155.87,-12792.54 1152.69,-12783.38 1149.62,-12774.58"/>
<polygon fill="black" stroke="black" points="1152.84,-12773.17 1146.25,-12764.88 1146.23,-12775.47 1152.84,-12773.17"/>
</g>
<!-- layer_7_allreduce_mlp -->
<g id="node218" class="node">
<title>layer_7_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="1361.5" cy="-12639.95" rx="60.21" ry="36.54"/>
<text text-anchor="middle" x="1361.5" y="-12653.95" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1361.5" y="-12642.95" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="1361.5" y="-12631.95" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1361.5" y="-12620.95" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_7_mlp_fc2_gpu12&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge278" class="edge">
<title>layer_7_mlp_fc2_gpu12&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1184.53,-12716.66C1187.56,-12715.32 1190.57,-12714 1193.5,-12712.72 1229.87,-12696.83 1270.83,-12679.33 1303.2,-12665.58"/>
<polygon fill="black" stroke="black" points="1304.69,-12668.76 1312.52,-12661.63 1301.95,-12662.31 1304.69,-12668.76"/>
</g>
<!-- layer_7_mlp_fc2_gpu13 -->
<g id="node215" class="node">
<title>layer_7_mlp_fc2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="1296.5,-12764.72 1202.5,-12764.72 1202.5,-12712.72 1296.5,-12712.72 1296.5,-12764.72"/>
<text text-anchor="middle" x="1249.5" y="-12752.72" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="1249.5" y="-12741.72" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="1249.5" y="-12730.72" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1249.5" y="-12719.72" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_mlp_fc2_gpu13&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge279" class="edge">
<title>layer_7_mlp_fc2_gpu13&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1278.63,-12712.55C1291.1,-12701.78 1305.88,-12689.01 1319.49,-12677.25"/>
<polygon fill="black" stroke="black" points="1322.07,-12679.65 1327.34,-12670.46 1317.49,-12674.35 1322.07,-12679.65"/>
</g>
<!-- layer_7_mlp_fc2_gpu14 -->
<g id="node216" class="node">
<title>layer_7_mlp_fc2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="1408.5,-12764.72 1314.5,-12764.72 1314.5,-12712.72 1408.5,-12712.72 1408.5,-12764.72"/>
<text text-anchor="middle" x="1361.5" y="-12752.72" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="1361.5" y="-12741.72" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="1361.5" y="-12730.72" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1361.5" y="-12719.72" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_mlp_fc2_gpu14&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge280" class="edge">
<title>layer_7_mlp_fc2_gpu14&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1361.5,-12712.55C1361.5,-12704.74 1361.5,-12695.87 1361.5,-12687.11"/>
<polygon fill="black" stroke="black" points="1365,-12686.93 1361.5,-12676.93 1358,-12686.93 1365,-12686.93"/>
</g>
<!-- layer_7_mlp_fc2_gpu15 -->
<g id="node217" class="node">
<title>layer_7_mlp_fc2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="1520.5,-12764.72 1426.5,-12764.72 1426.5,-12712.72 1520.5,-12712.72 1520.5,-12764.72"/>
<text text-anchor="middle" x="1473.5" y="-12752.72" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="1473.5" y="-12741.72" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="1473.5" y="-12730.72" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1473.5" y="-12719.72" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_mlp_fc2_gpu15&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge281" class="edge">
<title>layer_7_mlp_fc2_gpu15&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1444.37,-12712.55C1431.9,-12701.78 1417.12,-12689.01 1403.51,-12677.25"/>
<polygon fill="black" stroke="black" points="1405.51,-12674.35 1395.66,-12670.46 1400.93,-12679.65 1405.51,-12674.35"/>
</g>
<!-- layer_7_allreduce_mlp&#45;&gt;layer_7_residual2 -->
<g id="edge282" class="edge">
<title>layer_7_allreduce_mlp&#45;&gt;layer_7_residual2</title>
<path fill="none" stroke="black" d="M1388.15,-12606.92C1396.36,-12597.06 1405.58,-12585.98 1414.48,-12575.28"/>
<polygon fill="black" stroke="black" points="1417.18,-12577.51 1420.88,-12567.59 1411.79,-12573.04 1417.18,-12577.51"/>
</g>
<!-- layer_7_ln2 -->
<g id="node220" class="node">
<title>layer_7_ln2</title>
<polygon fill="lightblue" stroke="black" points="1491,-12449.18 1418,-12449.18 1418,-12397.18 1491,-12397.18 1491,-12449.18"/>
<text text-anchor="middle" x="1454.5" y="-12437.18" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1454.5" y="-12426.18" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="1454.5" y="-12415.18" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="1454.5" y="-12404.18" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- layer_7_residual2&#45;&gt;layer_7_ln2 -->
<g id="edge284" class="edge">
<title>layer_7_residual2&#45;&gt;layer_7_ln2</title>
<path fill="none" stroke="black" d="M1454.5,-12484.97C1454.5,-12476.54 1454.5,-12467.71 1454.5,-12459.47"/>
<polygon fill="black" stroke="black" points="1458,-12459.43 1454.5,-12449.43 1451,-12459.43 1458,-12459.43"/>
</g>
<!-- layer_7_to_gpu4 -->
<g id="node221" class="node">
<title>layer_7_to_gpu4</title>
<ellipse fill="purple" stroke="black" cx="1454.5" cy="-12332.19" rx="58.88" ry="28.98"/>
<text text-anchor="middle" x="1454.5" y="-12340.69" font-family="Arial" font-size="10.00">Layer 7→8</text>
<text text-anchor="middle" x="1454.5" y="-12329.69" font-family="Arial" font-size="10.00">Pipeline Comm</text>
<text text-anchor="middle" x="1454.5" y="-12318.69" font-family="Arial" font-size="10.00">GPU 3→4</text>
</g>
<!-- layer_7_ln2&#45;&gt;layer_7_to_gpu4 -->
<g id="edge285" class="edge">
<title>layer_7_ln2&#45;&gt;layer_7_to_gpu4</title>
<path fill="none" stroke="black" d="M1454.5,-12396.92C1454.5,-12389.03 1454.5,-12380.14 1454.5,-12371.56"/>
<polygon fill="black" stroke="black" points="1458,-12371.33 1454.5,-12361.33 1451,-12371.33 1458,-12371.33"/>
</g>
<!-- layer_8_input_dist -->
<g id="node222" class="node">
<title>layer_8_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="1548.69,-12267.2 1398.86,-12267.2 1360.31,-12185.2 1510.14,-12185.2 1548.69,-12267.2"/>
<text text-anchor="middle" x="1454.5" y="-12234.7" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="1454.5" y="-12223.7" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="1454.5" y="-12212.7" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_7_to_gpu4&#45;&gt;layer_8_input_dist -->
<g id="edge286" class="edge">
<title>layer_7_to_gpu4&#45;&gt;layer_8_input_dist</title>
<path fill="none" stroke="black" d="M1454.5,-12303.05C1454.5,-12295.18 1454.5,-12286.38 1454.5,-12277.64"/>
<polygon fill="black" stroke="black" points="1458,-12277.47 1454.5,-12267.47 1451,-12277.47 1458,-12277.47"/>
</g>
<!-- layer_8_qkv_gpu16 -->
<g id="node223" class="node">
<title>layer_8_qkv_gpu16</title>
<polygon fill="lightblue" stroke="black" points="1279,-12149.2 1186,-12149.2 1186,-12097.2 1279,-12097.2 1279,-12149.2"/>
<text text-anchor="middle" x="1232.5" y="-12137.2" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="1232.5" y="-12126.2" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="1232.5" y="-12115.2" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1232.5" y="-12104.2" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu16 -->
<g id="edge287" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu16</title>
<path fill="none" stroke="black" d="M1366.44,-12185.14C1340.15,-12173.18 1312.07,-12160.4 1288.44,-12149.65"/>
<polygon fill="black" stroke="black" points="1289.83,-12146.44 1279.28,-12145.48 1286.93,-12152.81 1289.83,-12146.44"/>
</g>
<!-- layer_8_qkv_gpu17 -->
<g id="node224" class="node">
<title>layer_8_qkv_gpu17</title>
<polygon fill="lightblue" stroke="black" points="1390,-12149.2 1297,-12149.2 1297,-12097.2 1390,-12097.2 1390,-12149.2"/>
<text text-anchor="middle" x="1343.5" y="-12137.2" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="1343.5" y="-12126.2" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="1343.5" y="-12115.2" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1343.5" y="-12104.2" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu17 -->
<g id="edge288" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu17</title>
<path fill="none" stroke="black" d="M1410.31,-12184.99C1399.81,-12175.44 1388.74,-12165.37 1378.7,-12156.23"/>
<polygon fill="black" stroke="black" points="1381,-12153.59 1371.25,-12149.45 1376.29,-12158.77 1381,-12153.59"/>
</g>
<!-- layer_8_qkv_gpu18 -->
<g id="node225" class="node">
<title>layer_8_qkv_gpu18</title>
<polygon fill="lightblue" stroke="black" points="1501,-12149.2 1408,-12149.2 1408,-12097.2 1501,-12097.2 1501,-12149.2"/>
<text text-anchor="middle" x="1454.5" y="-12137.2" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="1454.5" y="-12126.2" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="1454.5" y="-12115.2" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1454.5" y="-12104.2" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu18 -->
<g id="edge289" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu18</title>
<path fill="none" stroke="black" d="M1454.5,-12184.99C1454.5,-12176.56 1454.5,-12167.73 1454.5,-12159.49"/>
<polygon fill="black" stroke="black" points="1458,-12159.45 1454.5,-12149.45 1451,-12159.45 1458,-12159.45"/>
</g>
<!-- layer_8_qkv_gpu19 -->
<g id="node226" class="node">
<title>layer_8_qkv_gpu19</title>
<polygon fill="lightblue" stroke="black" points="1612,-12149.2 1519,-12149.2 1519,-12097.2 1612,-12097.2 1612,-12149.2"/>
<text text-anchor="middle" x="1565.5" y="-12137.2" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="1565.5" y="-12126.2" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="1565.5" y="-12115.2" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1565.5" y="-12104.2" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu19 -->
<g id="edge290" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu19</title>
<path fill="none" stroke="black" d="M1498.69,-12184.99C1509.19,-12175.44 1520.26,-12165.37 1530.3,-12156.23"/>
<polygon fill="black" stroke="black" points="1532.71,-12158.77 1537.75,-12149.45 1528,-12153.59 1532.71,-12158.77"/>
</g>
<!-- layer_8_residual1 -->
<g id="node234" class="node">
<title>layer_8_residual1</title>
<polygon fill="lightyellow" stroke="black" points="1651.44,-11666.12 1529.05,-11666.12 1497.56,-11584.12 1619.95,-11584.12 1651.44,-11666.12"/>
<text text-anchor="middle" x="1574.5" y="-11633.62" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="1574.5" y="-11622.62" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1574.5" y="-11611.62" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_residual1 -->
<g id="edge302" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_residual1</title>
<path fill="none" stroke="black" d="M1521.19,-12208.64C1555.31,-12197.08 1595.11,-12178.37 1621.5,-12149.2 1660.47,-12106.12 1663.5,-12083.52 1663.5,-12025.43 1663.5,-12025.43 1663.5,-12025.43 1663.5,-11836.66 1663.5,-11777.69 1633.51,-11716.24 1608.35,-11675.06"/>
<polygon fill="black" stroke="black" points="1611.17,-11672.97 1602.9,-11666.33 1605.23,-11676.67 1611.17,-11672.97"/>
</g>
<!-- layer_8_allgather_qkv -->
<g id="node227" class="node">
<title>layer_8_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="1343.5" cy="-12024.43" rx="57.05" ry="36.54"/>
<text text-anchor="middle" x="1343.5" y="-12038.43" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="1343.5" y="-12027.43" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="1343.5" y="-12016.43" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1343.5" y="-12005.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_8_qkv_gpu16&#45;&gt;layer_8_allgather_qkv -->
<g id="edge291" class="edge">
<title>layer_8_qkv_gpu16&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M1261.37,-12097.03C1273.83,-12086.17 1288.64,-12073.26 1302.22,-12061.42"/>
<polygon fill="black" stroke="black" points="1304.81,-12063.8 1310.05,-12054.59 1300.21,-12058.52 1304.81,-12063.8"/>
</g>
<!-- layer_8_qkv_gpu17&#45;&gt;layer_8_allgather_qkv -->
<g id="edge292" class="edge">
<title>layer_8_qkv_gpu17&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M1343.5,-12097.03C1343.5,-12089.22 1343.5,-12080.35 1343.5,-12071.59"/>
<polygon fill="black" stroke="black" points="1347,-12071.41 1343.5,-12061.41 1340,-12071.41 1347,-12071.41"/>
</g>
<!-- layer_8_qkv_gpu18&#45;&gt;layer_8_allgather_qkv -->
<g id="edge293" class="edge">
<title>layer_8_qkv_gpu18&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M1425.63,-12097.03C1413.17,-12086.17 1398.36,-12073.26 1384.78,-12061.42"/>
<polygon fill="black" stroke="black" points="1386.79,-12058.52 1376.95,-12054.59 1382.19,-12063.8 1386.79,-12058.52"/>
</g>
<!-- layer_8_qkv_gpu19&#45;&gt;layer_8_allgather_qkv -->
<g id="edge294" class="edge">
<title>layer_8_qkv_gpu19&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M1518.72,-12100.86C1515.94,-12099.61 1513.19,-12098.39 1510.5,-12097.2 1473.85,-12081 1432.48,-12063.21 1400.08,-12049.4"/>
<polygon fill="black" stroke="black" points="1401.33,-12046.13 1390.76,-12045.43 1398.59,-12052.57 1401.33,-12046.13"/>
</g>
<!-- layer_8_attention -->
<g id="node228" class="node">
<title>layer_8_attention</title>
<polygon fill="lightblue" stroke="black" points="1353.5,-11951.66 1285.5,-11951.66 1285.5,-11899.66 1353.5,-11899.66 1353.5,-11951.66"/>
<text text-anchor="middle" x="1319.5" y="-11939.66" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="1319.5" y="-11928.66" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1319.5" y="-11917.66" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="1319.5" y="-11906.66" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_8_allgather_qkv&#45;&gt;layer_8_attention -->
<g id="edge295" class="edge">
<title>layer_8_allgather_qkv&#45;&gt;layer_8_attention</title>
<path fill="none" stroke="black" d="M1334.7,-11987.95C1332.56,-11979.34 1330.28,-11970.14 1328.16,-11961.56"/>
<polygon fill="black" stroke="black" points="1331.55,-11960.71 1325.75,-11951.85 1324.76,-11962.4 1331.55,-11960.71"/>
</g>
<!-- layer_8_attn_out_gpu16 -->
<g id="node229" class="node">
<title>layer_8_attn_out_gpu16</title>
<polygon fill="lightblue" stroke="black" points="1317.5,-11863.66 1229.5,-11863.66 1229.5,-11811.66 1317.5,-11811.66 1317.5,-11863.66"/>
<text text-anchor="middle" x="1273.5" y="-11851.66" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="1273.5" y="-11840.66" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="1273.5" y="-11829.66" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1273.5" y="-11818.66" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attention&#45;&gt;layer_8_attn_out_gpu16 -->
<g id="edge296" class="edge">
<title>layer_8_attention&#45;&gt;layer_8_attn_out_gpu16</title>
<path fill="none" stroke="black" d="M1305.95,-11899.32C1301.5,-11891.01 1296.49,-11881.64 1291.75,-11872.78"/>
<polygon fill="black" stroke="black" points="1294.76,-11870.98 1286.96,-11863.82 1288.59,-11874.29 1294.76,-11870.98"/>
</g>
<!-- layer_8_allreduce_attn -->
<g id="node233" class="node">
<title>layer_8_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="1485.5" cy="-11738.89" rx="57.97" ry="36.54"/>
<text text-anchor="middle" x="1485.5" y="-11752.89" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="1485.5" y="-11741.89" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="1485.5" y="-11730.89" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1485.5" y="-11719.89" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_8_attn_out_gpu16&#45;&gt;layer_8_allreduce_attn -->
<g id="edge297" class="edge">
<title>layer_8_attn_out_gpu16&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M1317.72,-11815.73C1320.69,-11814.35 1323.64,-11812.98 1326.5,-11811.66 1360.64,-11795.9 1399.07,-11778.55 1429.59,-11764.85"/>
<polygon fill="black" stroke="black" points="1431.1,-11768.01 1438.79,-11760.73 1428.24,-11761.62 1431.1,-11768.01"/>
</g>
<!-- layer_8_attn_out_gpu17 -->
<g id="node230" class="node">
<title>layer_8_attn_out_gpu17</title>
<polygon fill="lightblue" stroke="black" points="1423.5,-11863.66 1335.5,-11863.66 1335.5,-11811.66 1423.5,-11811.66 1423.5,-11863.66"/>
<text text-anchor="middle" x="1379.5" y="-11851.66" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="1379.5" y="-11840.66" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="1379.5" y="-11829.66" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1379.5" y="-11818.66" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attn_out_gpu17&#45;&gt;layer_8_allreduce_attn -->
<g id="edge298" class="edge">
<title>layer_8_attn_out_gpu17&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M1407.07,-11811.49C1418.66,-11800.91 1432.36,-11788.4 1445.05,-11776.82"/>
<polygon fill="black" stroke="black" points="1447.76,-11779.08 1452.79,-11769.75 1443.04,-11773.91 1447.76,-11779.08"/>
</g>
<!-- layer_8_attn_out_gpu18 -->
<g id="node231" class="node">
<title>layer_8_attn_out_gpu18</title>
<polygon fill="lightblue" stroke="black" points="1529.5,-11863.66 1441.5,-11863.66 1441.5,-11811.66 1529.5,-11811.66 1529.5,-11863.66"/>
<text text-anchor="middle" x="1485.5" y="-11851.66" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="1485.5" y="-11840.66" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="1485.5" y="-11829.66" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1485.5" y="-11818.66" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attn_out_gpu18&#45;&gt;layer_8_allreduce_attn -->
<g id="edge299" class="edge">
<title>layer_8_attn_out_gpu18&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M1485.5,-11811.49C1485.5,-11803.68 1485.5,-11794.81 1485.5,-11786.05"/>
<polygon fill="black" stroke="black" points="1489,-11785.87 1485.5,-11775.87 1482,-11785.87 1489,-11785.87"/>
</g>
<!-- layer_8_attn_out_gpu19 -->
<g id="node232" class="node">
<title>layer_8_attn_out_gpu19</title>
<polygon fill="lightblue" stroke="black" points="1635.5,-11863.66 1547.5,-11863.66 1547.5,-11811.66 1635.5,-11811.66 1635.5,-11863.66"/>
<text text-anchor="middle" x="1591.5" y="-11851.66" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="1591.5" y="-11840.66" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="1591.5" y="-11829.66" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1591.5" y="-11818.66" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attn_out_gpu19&#45;&gt;layer_8_allreduce_attn -->
<g id="edge300" class="edge">
<title>layer_8_attn_out_gpu19&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M1563.93,-11811.49C1552.34,-11800.91 1538.64,-11788.4 1525.95,-11776.82"/>
<polygon fill="black" stroke="black" points="1527.96,-11773.91 1518.21,-11769.75 1523.24,-11779.08 1527.96,-11773.91"/>
</g>
<!-- layer_8_allreduce_attn&#45;&gt;layer_8_residual1 -->
<g id="edge301" class="edge">
<title>layer_8_allreduce_attn&#45;&gt;layer_8_residual1</title>
<path fill="none" stroke="black" d="M1511,-11705.86C1518.78,-11696.1 1527.51,-11685.13 1535.95,-11674.53"/>
<polygon fill="black" stroke="black" points="1538.84,-11676.53 1542.33,-11666.53 1533.36,-11672.17 1538.84,-11676.53"/>
</g>
<!-- layer_8_ln1 -->
<g id="node235" class="node">
<title>layer_8_ln1</title>
<polygon fill="lightblue" stroke="black" points="1518,-11548.12 1445,-11548.12 1445,-11496.12 1518,-11496.12 1518,-11548.12"/>
<text text-anchor="middle" x="1481.5" y="-11536.12" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="1481.5" y="-11525.12" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="1481.5" y="-11514.12" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="1481.5" y="-11503.12" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_8_residual1&#45;&gt;layer_8_ln1 -->
<g id="edge303" class="edge">
<title>layer_8_residual1&#45;&gt;layer_8_ln1</title>
<path fill="none" stroke="black" d="M1537.48,-11583.91C1528.94,-11574.64 1519.95,-11564.88 1511.74,-11555.96"/>
<polygon fill="black" stroke="black" points="1514.1,-11553.36 1504.75,-11548.37 1508.95,-11558.1 1514.1,-11553.36"/>
</g>
<!-- layer_8_residual2 -->
<g id="node247" class="node">
<title>layer_8_residual2</title>
<polygon fill="lightyellow" stroke="black" points="1679.44,-10988.04 1557.05,-10988.04 1525.56,-10906.04 1647.95,-10906.04 1679.44,-10988.04"/>
<text text-anchor="middle" x="1602.5" y="-10955.54" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="1602.5" y="-10944.54" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1602.5" y="-10933.54" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_8_residual1&#45;&gt;layer_8_residual2 -->
<g id="edge319" class="edge">
<title>layer_8_residual1&#45;&gt;layer_8_residual2</title>
<path fill="none" stroke="black" d="M1619.93,-11583.88C1654.61,-11548.52 1696.5,-11493.7 1696.5,-11435.12 1696.5,-11435.12 1696.5,-11435.12 1696.5,-11158.58 1696.5,-11099.16 1664.89,-11037.86 1638.34,-10996.84"/>
<polygon fill="black" stroke="black" points="1641.19,-10994.82 1632.76,-10988.4 1635.35,-10998.68 1641.19,-10994.82"/>
</g>
<!-- layer_8_mlp_fc1_gpu16 -->
<g id="node236" class="node">
<title>layer_8_mlp_fc1_gpu16</title>
<polygon fill="lightblue" stroke="black" points="1304.5,-11460.12 1210.5,-11460.12 1210.5,-11408.12 1304.5,-11408.12 1304.5,-11460.12"/>
<text text-anchor="middle" x="1257.5" y="-11448.12" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="1257.5" y="-11437.12" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="1257.5" y="-11426.12" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1257.5" y="-11415.12" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu16 -->
<g id="edge304" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu16</title>
<path fill="none" stroke="black" d="M1444.84,-11508.66C1412.62,-11497.52 1364.31,-11480.36 1314.14,-11460.28"/>
<polygon fill="black" stroke="black" points="1315.34,-11456.99 1304.75,-11456.5 1312.72,-11463.49 1315.34,-11456.99"/>
</g>
<!-- layer_8_mlp_fc1_gpu17 -->
<g id="node237" class="node">
<title>layer_8_mlp_fc1_gpu17</title>
<polygon fill="lightblue" stroke="black" points="1416.5,-11460.12 1322.5,-11460.12 1322.5,-11408.12 1416.5,-11408.12 1416.5,-11460.12"/>
<text text-anchor="middle" x="1369.5" y="-11448.12" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="1369.5" y="-11437.12" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="1369.5" y="-11426.12" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1369.5" y="-11415.12" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu17 -->
<g id="edge305" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu17</title>
<path fill="none" stroke="black" d="M1448.8,-11496.02C1436.83,-11486.82 1423.13,-11476.31 1410.53,-11466.63"/>
<polygon fill="black" stroke="black" points="1412.49,-11463.72 1402.43,-11460.41 1408.23,-11469.27 1412.49,-11463.72"/>
</g>
<!-- layer_8_mlp_fc1_gpu18 -->
<g id="node238" class="node">
<title>layer_8_mlp_fc1_gpu18</title>
<polygon fill="lightblue" stroke="black" points="1528.5,-11460.12 1434.5,-11460.12 1434.5,-11408.12 1528.5,-11408.12 1528.5,-11460.12"/>
<text text-anchor="middle" x="1481.5" y="-11448.12" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="1481.5" y="-11437.12" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="1481.5" y="-11426.12" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1481.5" y="-11415.12" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu18 -->
<g id="edge306" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu18</title>
<path fill="none" stroke="black" d="M1481.5,-11495.78C1481.5,-11487.82 1481.5,-11478.88 1481.5,-11470.37"/>
<polygon fill="black" stroke="black" points="1485,-11470.28 1481.5,-11460.28 1478,-11470.28 1485,-11470.28"/>
</g>
<!-- layer_8_mlp_fc1_gpu19 -->
<g id="node239" class="node">
<title>layer_8_mlp_fc1_gpu19</title>
<polygon fill="lightblue" stroke="black" points="1640.5,-11460.12 1546.5,-11460.12 1546.5,-11408.12 1640.5,-11408.12 1640.5,-11460.12"/>
<text text-anchor="middle" x="1593.5" y="-11448.12" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="1593.5" y="-11437.12" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="1593.5" y="-11426.12" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1593.5" y="-11415.12" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu19 -->
<g id="edge307" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu19</title>
<path fill="none" stroke="black" d="M1514.2,-11496.02C1526.17,-11486.82 1539.87,-11476.31 1552.47,-11466.63"/>
<polygon fill="black" stroke="black" points="1554.77,-11469.27 1560.57,-11460.41 1550.51,-11463.72 1554.77,-11469.27"/>
</g>
<!-- layer_8_allgather_mlp -->
<g id="node240" class="node">
<title>layer_8_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="1369.5" cy="-11335.35" rx="56.64" ry="36.54"/>
<text text-anchor="middle" x="1369.5" y="-11349.35" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="1369.5" y="-11338.35" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="1369.5" y="-11327.35" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1369.5" y="-11316.35" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_8_mlp_fc1_gpu16&#45;&gt;layer_8_allgather_mlp -->
<g id="edge308" class="edge">
<title>layer_8_mlp_fc1_gpu16&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M1286.63,-11407.95C1299.31,-11396.99 1314.4,-11383.96 1328.2,-11372.03"/>
<polygon fill="black" stroke="black" points="1330.87,-11374.35 1336.15,-11365.16 1326.3,-11369.05 1330.87,-11374.35"/>
</g>
<!-- layer_8_mlp_fc1_gpu17&#45;&gt;layer_8_allgather_mlp -->
<g id="edge309" class="edge">
<title>layer_8_mlp_fc1_gpu17&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M1369.5,-11407.95C1369.5,-11400.14 1369.5,-11391.27 1369.5,-11382.51"/>
<polygon fill="black" stroke="black" points="1373,-11382.33 1369.5,-11372.33 1366,-11382.33 1373,-11382.33"/>
</g>
<!-- layer_8_mlp_fc1_gpu18&#45;&gt;layer_8_allgather_mlp -->
<g id="edge310" class="edge">
<title>layer_8_mlp_fc1_gpu18&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M1452.37,-11407.95C1439.69,-11396.99 1424.6,-11383.96 1410.8,-11372.03"/>
<polygon fill="black" stroke="black" points="1412.7,-11369.05 1402.85,-11365.16 1408.13,-11374.35 1412.7,-11369.05"/>
</g>
<!-- layer_8_mlp_fc1_gpu19&#45;&gt;layer_8_allgather_mlp -->
<g id="edge311" class="edge">
<title>layer_8_mlp_fc1_gpu19&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M1546.47,-11412.06C1543.44,-11410.72 1540.43,-11409.4 1537.5,-11408.12 1500.33,-11391.89 1458.38,-11373.96 1425.69,-11360.09"/>
<polygon fill="black" stroke="black" points="1426.87,-11356.79 1416.3,-11356.1 1424.14,-11363.23 1426.87,-11356.79"/>
</g>
<!-- layer_8_gelu -->
<g id="node241" class="node">
<title>layer_8_gelu</title>
<polygon fill="lightblue" stroke="black" points="1386,-11262.58 1297,-11262.58 1297,-11221.58 1386,-11221.58 1386,-11262.58"/>
<text text-anchor="middle" x="1341.5" y="-11250.58" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="1341.5" y="-11239.58" font-family="Arial" font-size="10.00">GELU Activation</text>
<text text-anchor="middle" x="1341.5" y="-11228.58" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_8_allgather_mlp&#45;&gt;layer_8_gelu -->
<g id="edge312" class="edge">
<title>layer_8_allgather_mlp&#45;&gt;layer_8_gelu</title>
<path fill="none" stroke="black" d="M1358.67,-11299.06C1355.98,-11290.29 1353.13,-11280.98 1350.53,-11272.52"/>
<polygon fill="black" stroke="black" points="1353.8,-11271.25 1347.52,-11262.72 1347.11,-11273.31 1353.8,-11271.25"/>
</g>
<!-- layer_8_mlp_fc2_gpu16 -->
<g id="node242" class="node">
<title>layer_8_mlp_fc2_gpu16</title>
<polygon fill="lightblue" stroke="black" points="1332.5,-11185.58 1238.5,-11185.58 1238.5,-11133.58 1332.5,-11133.58 1332.5,-11185.58"/>
<text text-anchor="middle" x="1285.5" y="-11173.58" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="1285.5" y="-11162.58" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="1285.5" y="-11151.58" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1285.5" y="-11140.58" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu16 -->
<g id="edge313" class="edge">
<title>layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu16</title>
<path fill="none" stroke="black" d="M1327.66,-11221.18C1321.95,-11212.98 1315.19,-11203.26 1308.76,-11194.02"/>
<polygon fill="black" stroke="black" points="1311.58,-11191.95 1303,-11185.74 1305.84,-11195.95 1311.58,-11191.95"/>
</g>
<!-- layer_8_allreduce_mlp -->
<g id="node246" class="node">
<title>layer_8_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="1509.5" cy="-11060.81" rx="60.21" ry="36.54"/>
<text text-anchor="middle" x="1509.5" y="-11074.81" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="1509.5" y="-11063.81" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="1509.5" y="-11052.81" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1509.5" y="-11041.81" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_8_mlp_fc2_gpu16&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge314" class="edge">
<title>layer_8_mlp_fc2_gpu16&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1332.53,-11137.52C1335.56,-11136.18 1338.57,-11134.86 1341.5,-11133.58 1377.87,-11117.69 1418.83,-11100.19 1451.2,-11086.44"/>
<polygon fill="black" stroke="black" points="1452.69,-11089.62 1460.52,-11082.49 1449.95,-11083.17 1452.69,-11089.62"/>
</g>
<!-- layer_8_mlp_fc2_gpu17 -->
<g id="node243" class="node">
<title>layer_8_mlp_fc2_gpu17</title>
<polygon fill="lightblue" stroke="black" points="1444.5,-11185.58 1350.5,-11185.58 1350.5,-11133.58 1444.5,-11133.58 1444.5,-11185.58"/>
<text text-anchor="middle" x="1397.5" y="-11173.58" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="1397.5" y="-11162.58" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="1397.5" y="-11151.58" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1397.5" y="-11140.58" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_mlp_fc2_gpu17&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge315" class="edge">
<title>layer_8_mlp_fc2_gpu17&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1426.63,-11133.41C1439.1,-11122.64 1453.88,-11109.87 1467.49,-11098.11"/>
<polygon fill="black" stroke="black" points="1470.07,-11100.51 1475.34,-11091.32 1465.49,-11095.21 1470.07,-11100.51"/>
</g>
<!-- layer_8_mlp_fc2_gpu18 -->
<g id="node244" class="node">
<title>layer_8_mlp_fc2_gpu18</title>
<polygon fill="lightblue" stroke="black" points="1556.5,-11185.58 1462.5,-11185.58 1462.5,-11133.58 1556.5,-11133.58 1556.5,-11185.58"/>
<text text-anchor="middle" x="1509.5" y="-11173.58" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="1509.5" y="-11162.58" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="1509.5" y="-11151.58" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1509.5" y="-11140.58" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_mlp_fc2_gpu18&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge316" class="edge">
<title>layer_8_mlp_fc2_gpu18&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1509.5,-11133.41C1509.5,-11125.6 1509.5,-11116.74 1509.5,-11107.97"/>
<polygon fill="black" stroke="black" points="1513,-11107.79 1509.5,-11097.79 1506,-11107.79 1513,-11107.79"/>
</g>
<!-- layer_8_mlp_fc2_gpu19 -->
<g id="node245" class="node">
<title>layer_8_mlp_fc2_gpu19</title>
<polygon fill="lightblue" stroke="black" points="1668.5,-11185.58 1574.5,-11185.58 1574.5,-11133.58 1668.5,-11133.58 1668.5,-11185.58"/>
<text text-anchor="middle" x="1621.5" y="-11173.58" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="1621.5" y="-11162.58" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="1621.5" y="-11151.58" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1621.5" y="-11140.58" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_mlp_fc2_gpu19&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge317" class="edge">
<title>layer_8_mlp_fc2_gpu19&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1592.37,-11133.41C1579.9,-11122.64 1565.12,-11109.87 1551.51,-11098.11"/>
<polygon fill="black" stroke="black" points="1553.51,-11095.21 1543.66,-11091.32 1548.93,-11100.51 1553.51,-11095.21"/>
</g>
<!-- layer_8_allreduce_mlp&#45;&gt;layer_8_residual2 -->
<g id="edge318" class="edge">
<title>layer_8_allreduce_mlp&#45;&gt;layer_8_residual2</title>
<path fill="none" stroke="black" d="M1536.15,-11027.78C1544.36,-11017.92 1553.58,-11006.84 1562.48,-10996.14"/>
<polygon fill="black" stroke="black" points="1565.18,-10998.37 1568.88,-10988.45 1559.79,-10993.9 1565.18,-10998.37"/>
</g>
<!-- layer_8_ln2 -->
<g id="node248" class="node">
<title>layer_8_ln2</title>
<polygon fill="lightblue" stroke="black" points="1639,-10870.04 1566,-10870.04 1566,-10818.04 1639,-10818.04 1639,-10870.04"/>
<text text-anchor="middle" x="1602.5" y="-10858.04" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="1602.5" y="-10847.04" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="1602.5" y="-10836.04" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="1602.5" y="-10825.04" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_8_residual2&#45;&gt;layer_8_ln2 -->
<g id="edge320" class="edge">
<title>layer_8_residual2&#45;&gt;layer_8_ln2</title>
<path fill="none" stroke="black" d="M1602.5,-10905.84C1602.5,-10897.4 1602.5,-10888.57 1602.5,-10880.33"/>
<polygon fill="black" stroke="black" points="1606,-10880.29 1602.5,-10870.29 1599,-10880.29 1606,-10880.29"/>
</g>
<!-- layer_9_input_dist -->
<g id="node249" class="node">
<title>layer_9_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="1696.69,-10782.04 1546.86,-10782.04 1508.31,-10700.04 1658.14,-10700.04 1696.69,-10782.04"/>
<text text-anchor="middle" x="1602.5" y="-10749.54" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="1602.5" y="-10738.54" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="1602.5" y="-10727.54" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_8_ln2&#45;&gt;layer_9_input_dist -->
<g id="edge321" class="edge">
<title>layer_8_ln2&#45;&gt;layer_9_input_dist</title>
<path fill="none" stroke="black" d="M1602.5,-10817.82C1602.5,-10810.09 1602.5,-10801.3 1602.5,-10792.51"/>
<polygon fill="black" stroke="black" points="1606,-10792.26 1602.5,-10782.26 1599,-10792.26 1606,-10792.26"/>
</g>
<!-- layer_9_qkv_gpu16 -->
<g id="node250" class="node">
<title>layer_9_qkv_gpu16</title>
<polygon fill="lightblue" stroke="black" points="1427,-10664.04 1334,-10664.04 1334,-10612.04 1427,-10612.04 1427,-10664.04"/>
<text text-anchor="middle" x="1380.5" y="-10652.04" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="1380.5" y="-10641.04" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="1380.5" y="-10630.04" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1380.5" y="-10619.04" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu16 -->
<g id="edge322" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu16</title>
<path fill="none" stroke="black" d="M1514.44,-10699.98C1488.15,-10688.02 1460.07,-10675.24 1436.44,-10664.49"/>
<polygon fill="black" stroke="black" points="1437.83,-10661.28 1427.28,-10660.33 1434.93,-10667.65 1437.83,-10661.28"/>
</g>
<!-- layer_9_qkv_gpu17 -->
<g id="node251" class="node">
<title>layer_9_qkv_gpu17</title>
<polygon fill="lightblue" stroke="black" points="1538,-10664.04 1445,-10664.04 1445,-10612.04 1538,-10612.04 1538,-10664.04"/>
<text text-anchor="middle" x="1491.5" y="-10652.04" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="1491.5" y="-10641.04" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="1491.5" y="-10630.04" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1491.5" y="-10619.04" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu17 -->
<g id="edge323" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu17</title>
<path fill="none" stroke="black" d="M1558.31,-10699.84C1547.81,-10690.28 1536.74,-10680.21 1526.7,-10671.07"/>
<polygon fill="black" stroke="black" points="1529,-10668.44 1519.25,-10664.29 1524.29,-10673.61 1529,-10668.44"/>
</g>
<!-- layer_9_qkv_gpu18 -->
<g id="node252" class="node">
<title>layer_9_qkv_gpu18</title>
<polygon fill="lightblue" stroke="black" points="1649,-10664.04 1556,-10664.04 1556,-10612.04 1649,-10612.04 1649,-10664.04"/>
<text text-anchor="middle" x="1602.5" y="-10652.04" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="1602.5" y="-10641.04" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="1602.5" y="-10630.04" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1602.5" y="-10619.04" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu18 -->
<g id="edge324" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu18</title>
<path fill="none" stroke="black" d="M1602.5,-10699.84C1602.5,-10691.4 1602.5,-10682.57 1602.5,-10674.33"/>
<polygon fill="black" stroke="black" points="1606,-10674.29 1602.5,-10664.29 1599,-10674.29 1606,-10674.29"/>
</g>
<!-- layer_9_qkv_gpu19 -->
<g id="node253" class="node">
<title>layer_9_qkv_gpu19</title>
<polygon fill="lightblue" stroke="black" points="1760,-10664.04 1667,-10664.04 1667,-10612.04 1760,-10612.04 1760,-10664.04"/>
<text text-anchor="middle" x="1713.5" y="-10652.04" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="1713.5" y="-10641.04" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="1713.5" y="-10630.04" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1713.5" y="-10619.04" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu19 -->
<g id="edge325" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu19</title>
<path fill="none" stroke="black" d="M1646.69,-10699.84C1657.19,-10690.28 1668.26,-10680.21 1678.3,-10671.07"/>
<polygon fill="black" stroke="black" points="1680.71,-10673.61 1685.75,-10664.29 1676,-10668.44 1680.71,-10673.61"/>
</g>
<!-- layer_9_residual1 -->
<g id="node261" class="node">
<title>layer_9_residual1</title>
<polygon fill="lightyellow" stroke="black" points="1799.44,-10180.97 1677.05,-10180.97 1645.56,-10098.97 1767.95,-10098.97 1799.44,-10180.97"/>
<text text-anchor="middle" x="1722.5" y="-10148.47" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="1722.5" y="-10137.47" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1722.5" y="-10126.47" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_residual1 -->
<g id="edge337" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_residual1</title>
<path fill="none" stroke="black" d="M1669.19,-10723.48C1703.31,-10711.93 1743.11,-10693.22 1769.5,-10664.04 1808.47,-10620.97 1811.5,-10598.36 1811.5,-10540.27 1811.5,-10540.27 1811.5,-10540.27 1811.5,-10351.5 1811.5,-10292.54 1781.51,-10231.09 1756.35,-10189.91"/>
<polygon fill="black" stroke="black" points="1759.17,-10187.81 1750.9,-10181.18 1753.23,-10191.51 1759.17,-10187.81"/>
</g>
<!-- layer_9_allgather_qkv -->
<g id="node254" class="node">
<title>layer_9_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="1491.5" cy="-10539.27" rx="57.05" ry="36.54"/>
<text text-anchor="middle" x="1491.5" y="-10553.27" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="1491.5" y="-10542.27" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="1491.5" y="-10531.27" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1491.5" y="-10520.27" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_9_qkv_gpu16&#45;&gt;layer_9_allgather_qkv -->
<g id="edge326" class="edge">
<title>layer_9_qkv_gpu16&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M1409.37,-10611.87C1421.83,-10601.01 1436.64,-10588.1 1450.22,-10576.26"/>
<polygon fill="black" stroke="black" points="1452.81,-10578.64 1458.05,-10569.43 1448.21,-10573.37 1452.81,-10578.64"/>
</g>
<!-- layer_9_qkv_gpu17&#45;&gt;layer_9_allgather_qkv -->
<g id="edge327" class="edge">
<title>layer_9_qkv_gpu17&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M1491.5,-10611.87C1491.5,-10604.06 1491.5,-10595.2 1491.5,-10586.43"/>
<polygon fill="black" stroke="black" points="1495,-10586.25 1491.5,-10576.25 1488,-10586.25 1495,-10586.25"/>
</g>
<!-- layer_9_qkv_gpu18&#45;&gt;layer_9_allgather_qkv -->
<g id="edge328" class="edge">
<title>layer_9_qkv_gpu18&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M1573.63,-10611.87C1561.17,-10601.01 1546.36,-10588.1 1532.78,-10576.26"/>
<polygon fill="black" stroke="black" points="1534.79,-10573.37 1524.95,-10569.43 1530.19,-10578.64 1534.79,-10573.37"/>
</g>
<!-- layer_9_qkv_gpu19&#45;&gt;layer_9_allgather_qkv -->
<g id="edge329" class="edge">
<title>layer_9_qkv_gpu19&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M1666.72,-10615.7C1663.94,-10614.46 1661.19,-10613.23 1658.5,-10612.04 1621.85,-10595.84 1580.48,-10578.06 1548.08,-10564.25"/>
<polygon fill="black" stroke="black" points="1549.33,-10560.97 1538.76,-10560.28 1546.59,-10567.42 1549.33,-10560.97"/>
</g>
<!-- layer_9_attention -->
<g id="node255" class="node">
<title>layer_9_attention</title>
<polygon fill="lightblue" stroke="black" points="1501.5,-10466.5 1433.5,-10466.5 1433.5,-10414.5 1501.5,-10414.5 1501.5,-10466.5"/>
<text text-anchor="middle" x="1467.5" y="-10454.5" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="1467.5" y="-10443.5" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1467.5" y="-10432.5" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="1467.5" y="-10421.5" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_9_allgather_qkv&#45;&gt;layer_9_attention -->
<g id="edge330" class="edge">
<title>layer_9_allgather_qkv&#45;&gt;layer_9_attention</title>
<path fill="none" stroke="black" d="M1482.7,-10502.79C1480.56,-10494.18 1478.28,-10484.99 1476.16,-10476.41"/>
<polygon fill="black" stroke="black" points="1479.55,-10475.55 1473.75,-10466.69 1472.76,-10477.24 1479.55,-10475.55"/>
</g>
<!-- layer_9_attn_out_gpu16 -->
<g id="node256" class="node">
<title>layer_9_attn_out_gpu16</title>
<polygon fill="lightblue" stroke="black" points="1465.5,-10378.5 1377.5,-10378.5 1377.5,-10326.5 1465.5,-10326.5 1465.5,-10378.5"/>
<text text-anchor="middle" x="1421.5" y="-10366.5" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="1421.5" y="-10355.5" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="1421.5" y="-10344.5" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1421.5" y="-10333.5" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attention&#45;&gt;layer_9_attn_out_gpu16 -->
<g id="edge331" class="edge">
<title>layer_9_attention&#45;&gt;layer_9_attn_out_gpu16</title>
<path fill="none" stroke="black" d="M1453.95,-10414.17C1449.5,-10405.86 1444.49,-10396.48 1439.75,-10387.63"/>
<polygon fill="black" stroke="black" points="1442.76,-10385.83 1434.96,-10378.66 1436.59,-10389.13 1442.76,-10385.83"/>
</g>
<!-- layer_9_allreduce_attn -->
<g id="node260" class="node">
<title>layer_9_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="1633.5" cy="-10253.73" rx="57.97" ry="36.54"/>
<text text-anchor="middle" x="1633.5" y="-10267.73" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="1633.5" y="-10256.73" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="1633.5" y="-10245.73" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1633.5" y="-10234.73" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_9_attn_out_gpu16&#45;&gt;layer_9_allreduce_attn -->
<g id="edge332" class="edge">
<title>layer_9_attn_out_gpu16&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M1465.72,-10330.58C1468.69,-10329.19 1471.64,-10327.83 1474.5,-10326.5 1508.64,-10310.75 1547.07,-10293.39 1577.59,-10279.7"/>
<polygon fill="black" stroke="black" points="1579.1,-10282.86 1586.79,-10275.57 1576.24,-10276.47 1579.1,-10282.86"/>
</g>
<!-- layer_9_attn_out_gpu17 -->
<g id="node257" class="node">
<title>layer_9_attn_out_gpu17</title>
<polygon fill="lightblue" stroke="black" points="1571.5,-10378.5 1483.5,-10378.5 1483.5,-10326.5 1571.5,-10326.5 1571.5,-10378.5"/>
<text text-anchor="middle" x="1527.5" y="-10366.5" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="1527.5" y="-10355.5" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="1527.5" y="-10344.5" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1527.5" y="-10333.5" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attn_out_gpu17&#45;&gt;layer_9_allreduce_attn -->
<g id="edge333" class="edge">
<title>layer_9_attn_out_gpu17&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M1555.07,-10326.33C1566.66,-10315.76 1580.36,-10303.25 1593.05,-10291.66"/>
<polygon fill="black" stroke="black" points="1595.76,-10293.92 1600.79,-10284.6 1591.04,-10288.75 1595.76,-10293.92"/>
</g>
<!-- layer_9_attn_out_gpu18 -->
<g id="node258" class="node">
<title>layer_9_attn_out_gpu18</title>
<polygon fill="lightblue" stroke="black" points="1677.5,-10378.5 1589.5,-10378.5 1589.5,-10326.5 1677.5,-10326.5 1677.5,-10378.5"/>
<text text-anchor="middle" x="1633.5" y="-10366.5" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="1633.5" y="-10355.5" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="1633.5" y="-10344.5" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1633.5" y="-10333.5" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attn_out_gpu18&#45;&gt;layer_9_allreduce_attn -->
<g id="edge334" class="edge">
<title>layer_9_attn_out_gpu18&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M1633.5,-10326.33C1633.5,-10318.52 1633.5,-10309.66 1633.5,-10300.89"/>
<polygon fill="black" stroke="black" points="1637,-10300.71 1633.5,-10290.71 1630,-10300.71 1637,-10300.71"/>
</g>
<!-- layer_9_attn_out_gpu19 -->
<g id="node259" class="node">
<title>layer_9_attn_out_gpu19</title>
<polygon fill="lightblue" stroke="black" points="1783.5,-10378.5 1695.5,-10378.5 1695.5,-10326.5 1783.5,-10326.5 1783.5,-10378.5"/>
<text text-anchor="middle" x="1739.5" y="-10366.5" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="1739.5" y="-10355.5" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="1739.5" y="-10344.5" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1739.5" y="-10333.5" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attn_out_gpu19&#45;&gt;layer_9_allreduce_attn -->
<g id="edge335" class="edge">
<title>layer_9_attn_out_gpu19&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M1711.93,-10326.33C1700.34,-10315.76 1686.64,-10303.25 1673.95,-10291.66"/>
<polygon fill="black" stroke="black" points="1675.96,-10288.75 1666.21,-10284.6 1671.24,-10293.92 1675.96,-10288.75"/>
</g>
<!-- layer_9_allreduce_attn&#45;&gt;layer_9_residual1 -->
<g id="edge336" class="edge">
<title>layer_9_allreduce_attn&#45;&gt;layer_9_residual1</title>
<path fill="none" stroke="black" d="M1659,-10220.71C1666.78,-10210.94 1675.51,-10199.98 1683.95,-10189.38"/>
<polygon fill="black" stroke="black" points="1686.84,-10191.37 1690.33,-10181.37 1681.36,-10187.01 1686.84,-10191.37"/>
</g>
<!-- layer_9_ln1 -->
<g id="node262" class="node">
<title>layer_9_ln1</title>
<polygon fill="lightblue" stroke="black" points="1666,-10062.97 1593,-10062.97 1593,-10010.97 1666,-10010.97 1666,-10062.97"/>
<text text-anchor="middle" x="1629.5" y="-10050.97" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="1629.5" y="-10039.97" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="1629.5" y="-10028.97" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="1629.5" y="-10017.97" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_9_residual1&#45;&gt;layer_9_ln1 -->
<g id="edge338" class="edge">
<title>layer_9_residual1&#45;&gt;layer_9_ln1</title>
<path fill="none" stroke="black" d="M1685.48,-10098.76C1676.94,-10089.48 1667.95,-10079.72 1659.74,-10070.8"/>
<polygon fill="black" stroke="black" points="1662.1,-10068.2 1652.75,-10063.22 1656.95,-10072.94 1662.1,-10068.2"/>
</g>
<!-- layer_9_residual2 -->
<g id="node274" class="node">
<title>layer_9_residual2</title>
<polygon fill="lightyellow" stroke="black" points="1827.44,-9502.89 1705.05,-9502.89 1673.56,-9420.89 1795.95,-9420.89 1827.44,-9502.89"/>
<text text-anchor="middle" x="1750.5" y="-9470.39" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="1750.5" y="-9459.39" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1750.5" y="-9448.39" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_9_residual1&#45;&gt;layer_9_residual2 -->
<g id="edge354" class="edge">
<title>layer_9_residual1&#45;&gt;layer_9_residual2</title>
<path fill="none" stroke="black" d="M1767.93,-10098.72C1802.61,-10063.37 1844.5,-10008.55 1844.5,-9949.97 1844.5,-9949.97 1844.5,-9949.97 1844.5,-9673.43 1844.5,-9614.01 1812.89,-9552.71 1786.34,-9511.69"/>
<polygon fill="black" stroke="black" points="1789.19,-9509.66 1780.76,-9503.25 1783.35,-9513.52 1789.19,-9509.66"/>
</g>
<!-- layer_9_mlp_fc1_gpu16 -->
<g id="node263" class="node">
<title>layer_9_mlp_fc1_gpu16</title>
<polygon fill="lightblue" stroke="black" points="1452.5,-9974.97 1358.5,-9974.97 1358.5,-9922.97 1452.5,-9922.97 1452.5,-9974.97"/>
<text text-anchor="middle" x="1405.5" y="-9962.97" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="1405.5" y="-9951.97" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="1405.5" y="-9940.97" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1405.5" y="-9929.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu16 -->
<g id="edge339" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu16</title>
<path fill="none" stroke="black" d="M1592.84,-10023.5C1560.62,-10012.36 1512.31,-9995.2 1462.14,-9975.13"/>
<polygon fill="black" stroke="black" points="1463.34,-9971.84 1452.75,-9971.35 1460.72,-9978.33 1463.34,-9971.84"/>
</g>
<!-- layer_9_mlp_fc1_gpu17 -->
<g id="node264" class="node">
<title>layer_9_mlp_fc1_gpu17</title>
<polygon fill="lightblue" stroke="black" points="1564.5,-9974.97 1470.5,-9974.97 1470.5,-9922.97 1564.5,-9922.97 1564.5,-9974.97"/>
<text text-anchor="middle" x="1517.5" y="-9962.97" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="1517.5" y="-9951.97" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="1517.5" y="-9940.97" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1517.5" y="-9929.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu17 -->
<g id="edge340" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu17</title>
<path fill="none" stroke="black" d="M1596.8,-10010.86C1584.83,-10001.67 1571.13,-9991.15 1558.53,-9981.47"/>
<polygon fill="black" stroke="black" points="1560.49,-9978.57 1550.43,-9975.25 1556.23,-9984.12 1560.49,-9978.57"/>
</g>
<!-- layer_9_mlp_fc1_gpu18 -->
<g id="node265" class="node">
<title>layer_9_mlp_fc1_gpu18</title>
<polygon fill="lightblue" stroke="black" points="1676.5,-9974.97 1582.5,-9974.97 1582.5,-9922.97 1676.5,-9922.97 1676.5,-9974.97"/>
<text text-anchor="middle" x="1629.5" y="-9962.97" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="1629.5" y="-9951.97" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="1629.5" y="-9940.97" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1629.5" y="-9929.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu18 -->
<g id="edge341" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu18</title>
<path fill="none" stroke="black" d="M1629.5,-10010.63C1629.5,-10002.67 1629.5,-9993.73 1629.5,-9985.21"/>
<polygon fill="black" stroke="black" points="1633,-9985.12 1629.5,-9975.12 1626,-9985.12 1633,-9985.12"/>
</g>
<!-- layer_9_mlp_fc1_gpu19 -->
<g id="node266" class="node">
<title>layer_9_mlp_fc1_gpu19</title>
<polygon fill="lightblue" stroke="black" points="1788.5,-9974.97 1694.5,-9974.97 1694.5,-9922.97 1788.5,-9922.97 1788.5,-9974.97"/>
<text text-anchor="middle" x="1741.5" y="-9962.97" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="1741.5" y="-9951.97" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="1741.5" y="-9940.97" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1741.5" y="-9929.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu19 -->
<g id="edge342" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu19</title>
<path fill="none" stroke="black" d="M1662.2,-10010.86C1674.17,-10001.67 1687.87,-9991.15 1700.47,-9981.47"/>
<polygon fill="black" stroke="black" points="1702.77,-9984.12 1708.57,-9975.25 1698.51,-9978.57 1702.77,-9984.12"/>
</g>
<!-- layer_9_allgather_mlp -->
<g id="node267" class="node">
<title>layer_9_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="1517.5" cy="-9850.2" rx="56.64" ry="36.54"/>
<text text-anchor="middle" x="1517.5" y="-9864.2" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="1517.5" y="-9853.2" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="1517.5" y="-9842.2" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1517.5" y="-9831.2" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_9_mlp_fc1_gpu16&#45;&gt;layer_9_allgather_mlp -->
<g id="edge343" class="edge">
<title>layer_9_mlp_fc1_gpu16&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M1434.63,-9922.79C1447.31,-9911.84 1462.4,-9898.8 1476.2,-9886.88"/>
<polygon fill="black" stroke="black" points="1478.87,-9889.19 1484.15,-9880.01 1474.3,-9883.9 1478.87,-9889.19"/>
</g>
<!-- layer_9_mlp_fc1_gpu17&#45;&gt;layer_9_allgather_mlp -->
<g id="edge344" class="edge">
<title>layer_9_mlp_fc1_gpu17&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M1517.5,-9922.79C1517.5,-9914.98 1517.5,-9906.12 1517.5,-9897.35"/>
<polygon fill="black" stroke="black" points="1521,-9897.17 1517.5,-9887.17 1514,-9897.17 1521,-9897.17"/>
</g>
<!-- layer_9_mlp_fc1_gpu18&#45;&gt;layer_9_allgather_mlp -->
<g id="edge345" class="edge">
<title>layer_9_mlp_fc1_gpu18&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M1600.37,-9922.79C1587.69,-9911.84 1572.6,-9898.8 1558.8,-9886.88"/>
<polygon fill="black" stroke="black" points="1560.7,-9883.9 1550.85,-9880.01 1556.13,-9889.19 1560.7,-9883.9"/>
</g>
<!-- layer_9_mlp_fc1_gpu19&#45;&gt;layer_9_allgather_mlp -->
<g id="edge346" class="edge">
<title>layer_9_mlp_fc1_gpu19&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M1694.47,-9926.9C1691.44,-9925.57 1688.43,-9924.24 1685.5,-9922.97 1648.33,-9906.73 1606.38,-9888.81 1573.69,-9874.93"/>
<polygon fill="black" stroke="black" points="1574.87,-9871.63 1564.3,-9870.95 1572.14,-9878.08 1574.87,-9871.63"/>
</g>
<!-- layer_9_gelu -->
<g id="node268" class="node">
<title>layer_9_gelu</title>
<polygon fill="lightblue" stroke="black" points="1534,-9777.43 1445,-9777.43 1445,-9736.43 1534,-9736.43 1534,-9777.43"/>
<text text-anchor="middle" x="1489.5" y="-9765.43" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="1489.5" y="-9754.43" font-family="Arial" font-size="10.00">GELU Activation</text>
<text text-anchor="middle" x="1489.5" y="-9743.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_9_allgather_mlp&#45;&gt;layer_9_gelu -->
<g id="edge347" class="edge">
<title>layer_9_allgather_mlp&#45;&gt;layer_9_gelu</title>
<path fill="none" stroke="black" d="M1506.67,-9813.91C1503.98,-9805.14 1501.13,-9795.82 1498.53,-9787.37"/>
<polygon fill="black" stroke="black" points="1501.8,-9786.1 1495.52,-9777.56 1495.11,-9788.15 1501.8,-9786.1"/>
</g>
<!-- layer_9_mlp_fc2_gpu16 -->
<g id="node269" class="node">
<title>layer_9_mlp_fc2_gpu16</title>
<polygon fill="lightblue" stroke="black" points="1480.5,-9700.43 1386.5,-9700.43 1386.5,-9648.43 1480.5,-9648.43 1480.5,-9700.43"/>
<text text-anchor="middle" x="1433.5" y="-9688.43" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="1433.5" y="-9677.43" font-family="Arial" font-size="10.00">GPU 16</text>
<text text-anchor="middle" x="1433.5" y="-9666.43" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1433.5" y="-9655.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu16 -->
<g id="edge348" class="edge">
<title>layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu16</title>
<path fill="none" stroke="black" d="M1475.66,-9736.03C1469.95,-9727.83 1463.19,-9718.1 1456.76,-9708.87"/>
<polygon fill="black" stroke="black" points="1459.58,-9706.79 1451,-9700.58 1453.84,-9710.79 1459.58,-9706.79"/>
</g>
<!-- layer_9_allreduce_mlp -->
<g id="node273" class="node">
<title>layer_9_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="1657.5" cy="-9575.66" rx="60.21" ry="36.54"/>
<text text-anchor="middle" x="1657.5" y="-9589.66" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="1657.5" y="-9578.66" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="1657.5" y="-9567.66" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1657.5" y="-9556.66" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_9_mlp_fc2_gpu16&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge349" class="edge">
<title>layer_9_mlp_fc2_gpu16&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1480.53,-9652.36C1483.56,-9651.03 1486.57,-9649.7 1489.5,-9648.43 1525.87,-9632.54 1566.83,-9615.03 1599.2,-9601.29"/>
<polygon fill="black" stroke="black" points="1600.69,-9604.46 1608.52,-9597.33 1597.95,-9598.02 1600.69,-9604.46"/>
</g>
<!-- layer_9_mlp_fc2_gpu17 -->
<g id="node270" class="node">
<title>layer_9_mlp_fc2_gpu17</title>
<polygon fill="lightblue" stroke="black" points="1592.5,-9700.43 1498.5,-9700.43 1498.5,-9648.43 1592.5,-9648.43 1592.5,-9700.43"/>
<text text-anchor="middle" x="1545.5" y="-9688.43" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="1545.5" y="-9677.43" font-family="Arial" font-size="10.00">GPU 17</text>
<text text-anchor="middle" x="1545.5" y="-9666.43" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1545.5" y="-9655.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_mlp_fc2_gpu17&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge350" class="edge">
<title>layer_9_mlp_fc2_gpu17&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1574.63,-9648.25C1587.1,-9637.49 1601.88,-9624.71 1615.49,-9612.95"/>
<polygon fill="black" stroke="black" points="1618.07,-9615.35 1623.34,-9606.17 1613.49,-9610.06 1618.07,-9615.35"/>
</g>
<!-- layer_9_mlp_fc2_gpu18 -->
<g id="node271" class="node">
<title>layer_9_mlp_fc2_gpu18</title>
<polygon fill="lightblue" stroke="black" points="1704.5,-9700.43 1610.5,-9700.43 1610.5,-9648.43 1704.5,-9648.43 1704.5,-9700.43"/>
<text text-anchor="middle" x="1657.5" y="-9688.43" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="1657.5" y="-9677.43" font-family="Arial" font-size="10.00">GPU 18</text>
<text text-anchor="middle" x="1657.5" y="-9666.43" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1657.5" y="-9655.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_mlp_fc2_gpu18&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge351" class="edge">
<title>layer_9_mlp_fc2_gpu18&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1657.5,-9648.25C1657.5,-9640.44 1657.5,-9631.58 1657.5,-9622.81"/>
<polygon fill="black" stroke="black" points="1661,-9622.63 1657.5,-9612.63 1654,-9622.63 1661,-9622.63"/>
</g>
<!-- layer_9_mlp_fc2_gpu19 -->
<g id="node272" class="node">
<title>layer_9_mlp_fc2_gpu19</title>
<polygon fill="lightblue" stroke="black" points="1816.5,-9700.43 1722.5,-9700.43 1722.5,-9648.43 1816.5,-9648.43 1816.5,-9700.43"/>
<text text-anchor="middle" x="1769.5" y="-9688.43" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="1769.5" y="-9677.43" font-family="Arial" font-size="10.00">GPU 19</text>
<text text-anchor="middle" x="1769.5" y="-9666.43" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1769.5" y="-9655.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_mlp_fc2_gpu19&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge352" class="edge">
<title>layer_9_mlp_fc2_gpu19&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1740.37,-9648.25C1727.9,-9637.49 1713.12,-9624.71 1699.51,-9612.95"/>
<polygon fill="black" stroke="black" points="1701.51,-9610.06 1691.66,-9606.17 1696.93,-9615.35 1701.51,-9610.06"/>
</g>
<!-- layer_9_allreduce_mlp&#45;&gt;layer_9_residual2 -->
<g id="edge353" class="edge">
<title>layer_9_allreduce_mlp&#45;&gt;layer_9_residual2</title>
<path fill="none" stroke="black" d="M1684.15,-9542.63C1692.36,-9532.77 1701.58,-9521.68 1710.48,-9510.99"/>
<polygon fill="black" stroke="black" points="1713.18,-9513.22 1716.88,-9503.29 1707.79,-9508.74 1713.18,-9513.22"/>
</g>
<!-- layer_9_ln2 -->
<g id="node275" class="node">
<title>layer_9_ln2</title>
<polygon fill="lightblue" stroke="black" points="1787,-9384.89 1714,-9384.89 1714,-9332.89 1787,-9332.89 1787,-9384.89"/>
<text text-anchor="middle" x="1750.5" y="-9372.89" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="1750.5" y="-9361.89" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="1750.5" y="-9350.89" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="1750.5" y="-9339.89" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- layer_9_residual2&#45;&gt;layer_9_ln2 -->
<g id="edge355" class="edge">
<title>layer_9_residual2&#45;&gt;layer_9_ln2</title>
<path fill="none" stroke="black" d="M1750.5,-9420.68C1750.5,-9412.25 1750.5,-9403.41 1750.5,-9395.18"/>
<polygon fill="black" stroke="black" points="1754,-9395.14 1750.5,-9385.14 1747,-9395.14 1754,-9395.14"/>
</g>
<!-- layer_9_to_gpu5 -->
<g id="node276" class="node">
<title>layer_9_to_gpu5</title>
<ellipse fill="purple" stroke="black" cx="1750.5" cy="-9267.9" rx="58.88" ry="28.98"/>
<text text-anchor="middle" x="1750.5" y="-9276.4" font-family="Arial" font-size="10.00">Layer 9→10</text>
<text text-anchor="middle" x="1750.5" y="-9265.4" font-family="Arial" font-size="10.00">Pipeline Comm</text>
<text text-anchor="middle" x="1750.5" y="-9254.4" font-family="Arial" font-size="10.00">GPU 4→5</text>
</g>
<!-- layer_9_ln2&#45;&gt;layer_9_to_gpu5 -->
<g id="edge356" class="edge">
<title>layer_9_ln2&#45;&gt;layer_9_to_gpu5</title>
<path fill="none" stroke="black" d="M1750.5,-9332.62C1750.5,-9324.73 1750.5,-9315.84 1750.5,-9307.26"/>
<polygon fill="black" stroke="black" points="1754,-9307.04 1750.5,-9297.04 1747,-9307.04 1754,-9307.04"/>
</g>
<!-- layer_10_input_dist -->
<g id="node277" class="node">
<title>layer_10_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="1844.69,-9202.9 1694.86,-9202.9 1656.31,-9120.9 1806.14,-9120.9 1844.69,-9202.9"/>
<text text-anchor="middle" x="1750.5" y="-9170.4" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="1750.5" y="-9159.4" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="1750.5" y="-9148.4" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_9_to_gpu5&#45;&gt;layer_10_input_dist -->
<g id="edge357" class="edge">
<title>layer_9_to_gpu5&#45;&gt;layer_10_input_dist</title>
<path fill="none" stroke="black" d="M1750.5,-9238.75C1750.5,-9230.89 1750.5,-9222.09 1750.5,-9213.35"/>
<polygon fill="black" stroke="black" points="1754,-9213.17 1750.5,-9203.17 1747,-9213.17 1754,-9213.17"/>
</g>
<!-- layer_10_qkv_gpu20 -->
<g id="node278" class="node">
<title>layer_10_qkv_gpu20</title>
<polygon fill="lightblue" stroke="black" points="1567.5,-9084.9 1469.5,-9084.9 1469.5,-9032.9 1567.5,-9032.9 1567.5,-9084.9"/>
<text text-anchor="middle" x="1518.5" y="-9072.9" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="1518.5" y="-9061.9" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="1518.5" y="-9050.9" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1518.5" y="-9039.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu20 -->
<g id="edge358" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu20</title>
<path fill="none" stroke="black" d="M1658.47,-9120.84C1630.99,-9108.88 1601.63,-9096.09 1576.93,-9085.34"/>
<polygon fill="black" stroke="black" points="1578.27,-9082.11 1567.71,-9081.33 1575.48,-9088.53 1578.27,-9082.11"/>
</g>
<!-- layer_10_qkv_gpu21 -->
<g id="node279" class="node">
<title>layer_10_qkv_gpu21</title>
<polygon fill="lightblue" stroke="black" points="1683.5,-9084.9 1585.5,-9084.9 1585.5,-9032.9 1683.5,-9032.9 1683.5,-9084.9"/>
<text text-anchor="middle" x="1634.5" y="-9072.9" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="1634.5" y="-9061.9" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="1634.5" y="-9050.9" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1634.5" y="-9039.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu21 -->
<g id="edge359" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu21</title>
<path fill="none" stroke="black" d="M1704.32,-9120.7C1693.34,-9111.14 1681.78,-9101.07 1671.29,-9091.93"/>
<polygon fill="black" stroke="black" points="1673.34,-9089.08 1663.5,-9085.16 1668.75,-9094.36 1673.34,-9089.08"/>
</g>
<!-- layer_10_qkv_gpu22 -->
<g id="node280" class="node">
<title>layer_10_qkv_gpu22</title>
<polygon fill="lightblue" stroke="black" points="1799.5,-9084.9 1701.5,-9084.9 1701.5,-9032.9 1799.5,-9032.9 1799.5,-9084.9"/>
<text text-anchor="middle" x="1750.5" y="-9072.9" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="1750.5" y="-9061.9" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="1750.5" y="-9050.9" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1750.5" y="-9039.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu22 -->
<g id="edge360" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu22</title>
<path fill="none" stroke="black" d="M1750.5,-9120.7C1750.5,-9112.26 1750.5,-9103.43 1750.5,-9095.2"/>
<polygon fill="black" stroke="black" points="1754,-9095.16 1750.5,-9085.16 1747,-9095.16 1754,-9095.16"/>
</g>
<!-- layer_10_qkv_gpu23 -->
<g id="node281" class="node">
<title>layer_10_qkv_gpu23</title>
<polygon fill="lightblue" stroke="black" points="1915.5,-9084.9 1817.5,-9084.9 1817.5,-9032.9 1915.5,-9032.9 1915.5,-9084.9"/>
<text text-anchor="middle" x="1866.5" y="-9072.9" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="1866.5" y="-9061.9" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="1866.5" y="-9050.9" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1866.5" y="-9039.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu23 -->
<g id="edge361" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu23</title>
<path fill="none" stroke="black" d="M1796.68,-9120.7C1807.66,-9111.14 1819.22,-9101.07 1829.71,-9091.93"/>
<polygon fill="black" stroke="black" points="1832.25,-9094.36 1837.5,-9085.16 1827.66,-9089.08 1832.25,-9094.36"/>
</g>
<!-- layer_10_residual1 -->
<g id="node289" class="node">
<title>layer_10_residual1</title>
<polygon fill="lightyellow" stroke="black" points="1952.44,-8601.83 1830.05,-8601.83 1798.56,-8519.83 1920.95,-8519.83 1952.44,-8601.83"/>
<text text-anchor="middle" x="1875.5" y="-8569.33" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="1875.5" y="-8558.33" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1875.5" y="-8547.33" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_residual1 -->
<g id="edge373" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_residual1</title>
<path fill="none" stroke="black" d="M1818.06,-9145.38C1853.92,-9134.02 1896.29,-9115.17 1924.5,-9084.9 1964.31,-9042.2 1968.5,-9019.52 1968.5,-8961.13 1968.5,-8961.13 1968.5,-8961.13 1968.5,-8772.36 1968.5,-8712.86 1937.03,-8651.35 1910.71,-8610.29"/>
<polygon fill="black" stroke="black" points="1913.59,-8608.3 1905.18,-8601.85 1907.73,-8612.14 1913.59,-8608.3"/>
</g>
<!-- layer_10_allgather_qkv -->
<g id="node282" class="node">
<title>layer_10_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="1634.5" cy="-8960.13" rx="57.05" ry="36.54"/>
<text text-anchor="middle" x="1634.5" y="-8974.13" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="1634.5" y="-8963.13" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="1634.5" y="-8952.13" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1634.5" y="-8941.13" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_10_qkv_gpu20&#45;&gt;layer_10_allgather_qkv -->
<g id="edge362" class="edge">
<title>layer_10_qkv_gpu20&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M1548.67,-9032.73C1561.93,-9021.67 1577.72,-9008.5 1592.13,-8996.48"/>
<polygon fill="black" stroke="black" points="1594.53,-8999.04 1599.96,-8989.95 1590.04,-8993.66 1594.53,-8999.04"/>
</g>
<!-- layer_10_qkv_gpu21&#45;&gt;layer_10_allgather_qkv -->
<g id="edge363" class="edge">
<title>layer_10_qkv_gpu21&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M1634.5,-9032.73C1634.5,-9024.92 1634.5,-9016.06 1634.5,-9007.29"/>
<polygon fill="black" stroke="black" points="1638,-9007.11 1634.5,-8997.11 1631,-9007.11 1638,-9007.11"/>
</g>
<!-- layer_10_qkv_gpu22&#45;&gt;layer_10_allgather_qkv -->
<g id="edge364" class="edge">
<title>layer_10_qkv_gpu22&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M1720.33,-9032.73C1707.07,-9021.67 1691.28,-9008.5 1676.87,-8996.48"/>
<polygon fill="black" stroke="black" points="1678.96,-8993.66 1669.04,-8989.95 1674.47,-8999.04 1678.96,-8993.66"/>
</g>
<!-- layer_10_qkv_gpu23&#45;&gt;layer_10_allgather_qkv -->
<g id="edge365" class="edge">
<title>layer_10_qkv_gpu23&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M1817.48,-9036.71C1814.44,-9035.42 1811.43,-9034.14 1808.5,-9032.9 1769.56,-9016.48 1725.55,-8998.33 1691.53,-8984.39"/>
<polygon fill="black" stroke="black" points="1692.8,-8981.13 1682.22,-8980.58 1690.15,-8987.61 1692.8,-8981.13"/>
</g>
<!-- layer_10_attention -->
<g id="node283" class="node">
<title>layer_10_attention</title>
<polygon fill="lightblue" stroke="black" points="1619.5,-8887.36 1551.5,-8887.36 1551.5,-8835.36 1619.5,-8835.36 1619.5,-8887.36"/>
<text text-anchor="middle" x="1585.5" y="-8875.36" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="1585.5" y="-8864.36" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1585.5" y="-8853.36" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="1585.5" y="-8842.36" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_10_allgather_qkv&#45;&gt;layer_10_attention -->
<g id="edge366" class="edge">
<title>layer_10_allgather_qkv&#45;&gt;layer_10_attention</title>
<path fill="none" stroke="black" d="M1617.22,-8925.02C1612.6,-8915.89 1607.6,-8906.02 1602.97,-8896.87"/>
<polygon fill="black" stroke="black" points="1605.95,-8895 1598.31,-8887.66 1599.7,-8898.16 1605.95,-8895"/>
</g>
<!-- layer_10_attn_out_gpu20 -->
<g id="node284" class="node">
<title>layer_10_attn_out_gpu20</title>
<polygon fill="lightblue" stroke="black" points="1607,-8799.36 1514,-8799.36 1514,-8747.36 1607,-8747.36 1607,-8799.36"/>
<text text-anchor="middle" x="1560.5" y="-8787.36" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="1560.5" y="-8776.36" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="1560.5" y="-8765.36" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1560.5" y="-8754.36" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attention&#45;&gt;layer_10_attn_out_gpu20 -->
<g id="edge367" class="edge">
<title>layer_10_attention&#45;&gt;layer_10_attn_out_gpu20</title>
<path fill="none" stroke="black" d="M1578.13,-8835.03C1575.79,-8826.98 1573.16,-8817.93 1570.66,-8809.33"/>
<polygon fill="black" stroke="black" points="1573.97,-8808.15 1567.81,-8799.52 1567.24,-8810.1 1573.97,-8808.15"/>
</g>
<!-- layer_10_allreduce_attn -->
<g id="node288" class="node">
<title>layer_10_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="1782.5" cy="-8674.6" rx="57.97" ry="36.54"/>
<text text-anchor="middle" x="1782.5" y="-8688.6" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="1782.5" y="-8677.6" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="1782.5" y="-8666.6" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1782.5" y="-8655.6" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_10_attn_out_gpu20&#45;&gt;layer_10_allreduce_attn -->
<g id="edge368" class="edge">
<title>layer_10_attn_out_gpu20&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M1607.23,-8751.45C1610.37,-8750.07 1613.48,-8748.69 1616.5,-8747.36 1652.74,-8731.44 1693.54,-8713.8 1725.62,-8699.99"/>
<polygon fill="black" stroke="black" points="1727.05,-8703.19 1734.85,-8696.02 1724.28,-8696.76 1727.05,-8703.19"/>
</g>
<!-- layer_10_attn_out_gpu21 -->
<g id="node285" class="node">
<title>layer_10_attn_out_gpu21</title>
<polygon fill="lightblue" stroke="black" points="1718,-8799.36 1625,-8799.36 1625,-8747.36 1718,-8747.36 1718,-8799.36"/>
<text text-anchor="middle" x="1671.5" y="-8787.36" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="1671.5" y="-8776.36" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="1671.5" y="-8765.36" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1671.5" y="-8754.36" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attn_out_gpu21&#45;&gt;layer_10_allreduce_attn -->
<g id="edge369" class="edge">
<title>layer_10_attn_out_gpu21&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M1700.37,-8747.19C1712.83,-8736.33 1727.64,-8723.43 1741.22,-8711.58"/>
<polygon fill="black" stroke="black" points="1743.81,-8713.97 1749.05,-8704.76 1739.21,-8708.69 1743.81,-8713.97"/>
</g>
<!-- layer_10_attn_out_gpu22 -->
<g id="node286" class="node">
<title>layer_10_attn_out_gpu22</title>
<polygon fill="lightblue" stroke="black" points="1829,-8799.36 1736,-8799.36 1736,-8747.36 1829,-8747.36 1829,-8799.36"/>
<text text-anchor="middle" x="1782.5" y="-8787.36" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="1782.5" y="-8776.36" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="1782.5" y="-8765.36" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1782.5" y="-8754.36" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attn_out_gpu22&#45;&gt;layer_10_allreduce_attn -->
<g id="edge370" class="edge">
<title>layer_10_attn_out_gpu22&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M1782.5,-8747.19C1782.5,-8739.38 1782.5,-8730.52 1782.5,-8721.75"/>
<polygon fill="black" stroke="black" points="1786,-8721.57 1782.5,-8711.57 1779,-8721.57 1786,-8721.57"/>
</g>
<!-- layer_10_attn_out_gpu23 -->
<g id="node287" class="node">
<title>layer_10_attn_out_gpu23</title>
<polygon fill="lightblue" stroke="black" points="1940,-8799.36 1847,-8799.36 1847,-8747.36 1940,-8747.36 1940,-8799.36"/>
<text text-anchor="middle" x="1893.5" y="-8787.36" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="1893.5" y="-8776.36" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="1893.5" y="-8765.36" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1893.5" y="-8754.36" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attn_out_gpu23&#45;&gt;layer_10_allreduce_attn -->
<g id="edge371" class="edge">
<title>layer_10_attn_out_gpu23&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M1864.63,-8747.19C1852.17,-8736.33 1837.36,-8723.43 1823.78,-8711.58"/>
<polygon fill="black" stroke="black" points="1825.79,-8708.69 1815.95,-8704.76 1821.19,-8713.97 1825.79,-8708.69"/>
</g>
<!-- layer_10_allreduce_attn&#45;&gt;layer_10_residual1 -->
<g id="edge372" class="edge">
<title>layer_10_allreduce_attn&#45;&gt;layer_10_residual1</title>
<path fill="none" stroke="black" d="M1809.15,-8641.57C1817.36,-8631.7 1826.58,-8620.62 1835.48,-8609.93"/>
<polygon fill="black" stroke="black" points="1838.18,-8612.16 1841.88,-8602.23 1832.79,-8607.68 1838.18,-8612.16"/>
</g>
<!-- layer_10_ln1 -->
<g id="node290" class="node">
<title>layer_10_ln1</title>
<polygon fill="lightblue" stroke="black" points="1815,-8483.83 1742,-8483.83 1742,-8431.83 1815,-8431.83 1815,-8483.83"/>
<text text-anchor="middle" x="1778.5" y="-8471.83" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="1778.5" y="-8460.83" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="1778.5" y="-8449.83" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="1778.5" y="-8438.83" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_10_residual1&#45;&gt;layer_10_ln1 -->
<g id="edge374" class="edge">
<title>layer_10_residual1&#45;&gt;layer_10_ln1</title>
<path fill="none" stroke="black" d="M1836.88,-8519.62C1827.89,-8510.25 1818.41,-8500.39 1809.78,-8491.39"/>
<polygon fill="black" stroke="black" points="1812.2,-8488.87 1802.75,-8484.08 1807.15,-8493.71 1812.2,-8488.87"/>
</g>
<!-- layer_10_residual2 -->
<g id="node302" class="node">
<title>layer_10_residual2</title>
<polygon fill="lightyellow" stroke="black" points="1981.44,-7923.75 1859.05,-7923.75 1827.56,-7841.75 1949.95,-7841.75 1981.44,-7923.75"/>
<text text-anchor="middle" x="1904.5" y="-7891.25" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="1904.5" y="-7880.25" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1904.5" y="-7869.25" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_10_residual1&#45;&gt;layer_10_residual2 -->
<g id="edge390" class="edge">
<title>layer_10_residual1&#45;&gt;layer_10_residual2</title>
<path fill="none" stroke="black" d="M1921.71,-8521C1958.02,-8485.91 2002.5,-8430.72 2002.5,-8370.83 2002.5,-8370.83 2002.5,-8370.83 2002.5,-8094.29 2002.5,-8034.44 1969.55,-7973.21 1941.86,-7932.32"/>
<polygon fill="black" stroke="black" points="1944.61,-7930.15 1936.05,-7923.91 1938.86,-7934.13 1944.61,-7930.15"/>
</g>
<!-- layer_10_mlp_fc1_gpu20 -->
<g id="node291" class="node">
<title>layer_10_mlp_fc1_gpu20</title>
<polygon fill="lightblue" stroke="black" points="1594,-8395.83 1495,-8395.83 1495,-8343.83 1594,-8343.83 1594,-8395.83"/>
<text text-anchor="middle" x="1544.5" y="-8383.83" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="1544.5" y="-8372.83" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="1544.5" y="-8361.83" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1544.5" y="-8350.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu20 -->
<g id="edge375" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu20</title>
<path fill="none" stroke="black" d="M1741.71,-8444.78C1708.14,-8433.62 1656.99,-8416.18 1603.88,-8395.88"/>
<polygon fill="black" stroke="black" points="1604.89,-8392.52 1594.3,-8392.2 1602.38,-8399.05 1604.89,-8392.52"/>
</g>
<!-- layer_10_mlp_fc1_gpu21 -->
<g id="node292" class="node">
<title>layer_10_mlp_fc1_gpu21</title>
<polygon fill="lightblue" stroke="black" points="1711,-8395.83 1612,-8395.83 1612,-8343.83 1711,-8343.83 1711,-8395.83"/>
<text text-anchor="middle" x="1661.5" y="-8383.83" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="1661.5" y="-8372.83" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="1661.5" y="-8361.83" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1661.5" y="-8350.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu21 -->
<g id="edge376" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu21</title>
<path fill="none" stroke="black" d="M1744.34,-8431.72C1731.72,-8422.44 1717.26,-8411.81 1703.98,-8402.05"/>
<polygon fill="black" stroke="black" points="1706.03,-8399.21 1695.9,-8396.11 1701.89,-8404.85 1706.03,-8399.21"/>
</g>
<!-- layer_10_mlp_fc1_gpu22 -->
<g id="node293" class="node">
<title>layer_10_mlp_fc1_gpu22</title>
<polygon fill="lightblue" stroke="black" points="1828,-8395.83 1729,-8395.83 1729,-8343.83 1828,-8343.83 1828,-8395.83"/>
<text text-anchor="middle" x="1778.5" y="-8383.83" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="1778.5" y="-8372.83" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="1778.5" y="-8361.83" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1778.5" y="-8350.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu22 -->
<g id="edge377" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu22</title>
<path fill="none" stroke="black" d="M1778.5,-8431.49C1778.5,-8423.53 1778.5,-8414.59 1778.5,-8406.07"/>
<polygon fill="black" stroke="black" points="1782,-8405.98 1778.5,-8395.98 1775,-8405.98 1782,-8405.98"/>
</g>
<!-- layer_10_mlp_fc1_gpu23 -->
<g id="node294" class="node">
<title>layer_10_mlp_fc1_gpu23</title>
<polygon fill="lightblue" stroke="black" points="1945,-8395.83 1846,-8395.83 1846,-8343.83 1945,-8343.83 1945,-8395.83"/>
<text text-anchor="middle" x="1895.5" y="-8383.83" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="1895.5" y="-8372.83" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="1895.5" y="-8361.83" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1895.5" y="-8350.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu23 -->
<g id="edge378" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu23</title>
<path fill="none" stroke="black" d="M1812.66,-8431.72C1825.28,-8422.44 1839.74,-8411.81 1853.02,-8402.05"/>
<polygon fill="black" stroke="black" points="1855.11,-8404.85 1861.1,-8396.11 1850.97,-8399.21 1855.11,-8404.85"/>
</g>
<!-- layer_10_allgather_mlp -->
<g id="node295" class="node">
<title>layer_10_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="1661.5" cy="-8271.06" rx="56.64" ry="36.54"/>
<text text-anchor="middle" x="1661.5" y="-8285.06" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="1661.5" y="-8274.06" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="1661.5" y="-8263.06" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1661.5" y="-8252.06" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_10_mlp_fc1_gpu20&#45;&gt;layer_10_allgather_mlp -->
<g id="edge379" class="edge">
<title>layer_10_mlp_fc1_gpu20&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M1574.93,-8343.65C1588.42,-8332.5 1604.51,-8319.2 1619.13,-8307.1"/>
<polygon fill="black" stroke="black" points="1621.61,-8309.59 1627.09,-8300.52 1617.15,-8304.2 1621.61,-8309.59"/>
</g>
<!-- layer_10_mlp_fc1_gpu21&#45;&gt;layer_10_allgather_mlp -->
<g id="edge380" class="edge">
<title>layer_10_mlp_fc1_gpu21&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M1661.5,-8343.65C1661.5,-8335.84 1661.5,-8326.98 1661.5,-8318.21"/>
<polygon fill="black" stroke="black" points="1665,-8318.03 1661.5,-8308.03 1658,-8318.03 1665,-8318.03"/>
</g>
<!-- layer_10_mlp_fc1_gpu22&#45;&gt;layer_10_allgather_mlp -->
<g id="edge381" class="edge">
<title>layer_10_mlp_fc1_gpu22&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M1748.07,-8343.65C1734.58,-8332.5 1718.49,-8319.2 1703.87,-8307.1"/>
<polygon fill="black" stroke="black" points="1705.85,-8304.2 1695.91,-8300.52 1701.39,-8309.59 1705.85,-8304.2"/>
</g>
<!-- layer_10_mlp_fc1_gpu23&#45;&gt;layer_10_allgather_mlp -->
<g id="edge382" class="edge">
<title>layer_10_mlp_fc1_gpu23&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M1845.85,-8347.35C1843.03,-8346.15 1840.23,-8344.97 1837.5,-8343.83 1797.86,-8327.2 1753,-8308.92 1718.49,-8294.96"/>
<polygon fill="black" stroke="black" points="1719.62,-8291.65 1709.04,-8291.15 1717,-8298.14 1719.62,-8291.65"/>
</g>
<!-- layer_10_gelu -->
<g id="node296" class="node">
<title>layer_10_gelu</title>
<polygon fill="lightblue" stroke="black" points="1648,-8198.29 1559,-8198.29 1559,-8157.29 1648,-8157.29 1648,-8198.29"/>
<text text-anchor="middle" x="1603.5" y="-8186.29" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="1603.5" y="-8175.29" font-family="Arial" font-size="10.00">GELU Activation</text>
<text text-anchor="middle" x="1603.5" y="-8164.29" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_10_allgather_mlp&#45;&gt;layer_10_gelu -->
<g id="edge383" class="edge">
<title>layer_10_allgather_mlp&#45;&gt;layer_10_gelu</title>
<path fill="none" stroke="black" d="M1640.4,-8236.85C1634.16,-8227.04 1627.4,-8216.4 1621.39,-8206.94"/>
<polygon fill="black" stroke="black" points="1624.21,-8204.86 1615.9,-8198.3 1618.31,-8208.61 1624.21,-8204.86"/>
</g>
<!-- layer_10_mlp_fc2_gpu20 -->
<g id="node297" class="node">
<title>layer_10_mlp_fc2_gpu20</title>
<polygon fill="lightblue" stroke="black" points="1623,-8121.29 1524,-8121.29 1524,-8069.29 1623,-8069.29 1623,-8121.29"/>
<text text-anchor="middle" x="1573.5" y="-8109.29" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="1573.5" y="-8098.29" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="1573.5" y="-8087.29" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1573.5" y="-8076.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu20 -->
<g id="edge384" class="edge">
<title>layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu20</title>
<path fill="none" stroke="black" d="M1596.08,-8156.89C1593.15,-8149.02 1589.7,-8139.75 1586.38,-8130.86"/>
<polygon fill="black" stroke="black" points="1589.65,-8129.59 1582.87,-8121.44 1583.09,-8132.03 1589.65,-8129.59"/>
</g>
<!-- layer_10_allreduce_mlp -->
<g id="node301" class="node">
<title>layer_10_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="1807.5" cy="-7996.52" rx="60.21" ry="36.54"/>
<text text-anchor="middle" x="1807.5" y="-8010.52" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="1807.5" y="-7999.52" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="1807.5" y="-7988.52" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1807.5" y="-7977.52" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_10_mlp_fc2_gpu20&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge385" class="edge">
<title>layer_10_mlp_fc2_gpu20&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1623.06,-8073.24C1626.25,-8071.9 1629.42,-8070.57 1632.5,-8069.29 1671.15,-8053.17 1714.71,-8035.31 1748.71,-8021.43"/>
<polygon fill="black" stroke="black" points="1750.09,-8024.65 1758.03,-8017.63 1747.45,-8018.16 1750.09,-8024.65"/>
</g>
<!-- layer_10_mlp_fc2_gpu21 -->
<g id="node298" class="node">
<title>layer_10_mlp_fc2_gpu21</title>
<polygon fill="lightblue" stroke="black" points="1740,-8121.29 1641,-8121.29 1641,-8069.29 1740,-8069.29 1740,-8121.29"/>
<text text-anchor="middle" x="1690.5" y="-8109.29" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="1690.5" y="-8098.29" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="1690.5" y="-8087.29" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1690.5" y="-8076.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_mlp_fc2_gpu21&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge386" class="edge">
<title>layer_10_mlp_fc2_gpu21&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1720.93,-8069.11C1734.19,-8058.15 1749.96,-8045.11 1764.39,-8033.17"/>
<polygon fill="black" stroke="black" points="1766.77,-8035.75 1772.24,-8026.68 1762.31,-8030.35 1766.77,-8035.75"/>
</g>
<!-- layer_10_mlp_fc2_gpu22 -->
<g id="node299" class="node">
<title>layer_10_mlp_fc2_gpu22</title>
<polygon fill="lightblue" stroke="black" points="1857,-8121.29 1758,-8121.29 1758,-8069.29 1857,-8069.29 1857,-8121.29"/>
<text text-anchor="middle" x="1807.5" y="-8109.29" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="1807.5" y="-8098.29" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="1807.5" y="-8087.29" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1807.5" y="-8076.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_mlp_fc2_gpu22&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge387" class="edge">
<title>layer_10_mlp_fc2_gpu22&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1807.5,-8069.11C1807.5,-8061.31 1807.5,-8052.44 1807.5,-8043.67"/>
<polygon fill="black" stroke="black" points="1811,-8043.49 1807.5,-8033.49 1804,-8043.49 1811,-8043.49"/>
</g>
<!-- layer_10_mlp_fc2_gpu23 -->
<g id="node300" class="node">
<title>layer_10_mlp_fc2_gpu23</title>
<polygon fill="lightblue" stroke="black" points="1974,-8121.29 1875,-8121.29 1875,-8069.29 1974,-8069.29 1974,-8121.29"/>
<text text-anchor="middle" x="1924.5" y="-8109.29" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="1924.5" y="-8098.29" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="1924.5" y="-8087.29" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1924.5" y="-8076.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_mlp_fc2_gpu23&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge388" class="edge">
<title>layer_10_mlp_fc2_gpu23&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1894.07,-8069.11C1880.81,-8058.15 1865.04,-8045.11 1850.61,-8033.17"/>
<polygon fill="black" stroke="black" points="1852.69,-8030.35 1842.76,-8026.68 1848.23,-8035.75 1852.69,-8030.35"/>
</g>
<!-- layer_10_allreduce_mlp&#45;&gt;layer_10_residual2 -->
<g id="edge389" class="edge">
<title>layer_10_allreduce_mlp&#45;&gt;layer_10_residual2</title>
<path fill="none" stroke="black" d="M1835.04,-7963.79C1843.69,-7953.82 1853.45,-7942.57 1862.85,-7931.74"/>
<polygon fill="black" stroke="black" points="1865.71,-7933.79 1869.62,-7923.94 1860.42,-7929.2 1865.71,-7933.79"/>
</g>
<!-- layer_10_ln2 -->
<g id="node303" class="node">
<title>layer_10_ln2</title>
<polygon fill="lightblue" stroke="black" points="1941,-7805.75 1868,-7805.75 1868,-7753.75 1941,-7753.75 1941,-7805.75"/>
<text text-anchor="middle" x="1904.5" y="-7793.75" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="1904.5" y="-7782.75" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="1904.5" y="-7771.75" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="1904.5" y="-7760.75" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_10_residual2&#45;&gt;layer_10_ln2 -->
<g id="edge391" class="edge">
<title>layer_10_residual2&#45;&gt;layer_10_ln2</title>
<path fill="none" stroke="black" d="M1904.5,-7841.54C1904.5,-7833.11 1904.5,-7824.28 1904.5,-7816.04"/>
<polygon fill="black" stroke="black" points="1908,-7816 1904.5,-7806 1901,-7816 1908,-7816"/>
</g>
<!-- layer_11_input_dist -->
<g id="node304" class="node">
<title>layer_11_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="1998.69,-7717.75 1848.86,-7717.75 1810.31,-7635.75 1960.14,-7635.75 1998.69,-7717.75"/>
<text text-anchor="middle" x="1904.5" y="-7685.25" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="1904.5" y="-7674.25" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="1904.5" y="-7663.25" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_10_ln2&#45;&gt;layer_11_input_dist -->
<g id="edge392" class="edge">
<title>layer_10_ln2&#45;&gt;layer_11_input_dist</title>
<path fill="none" stroke="black" d="M1904.5,-7753.52C1904.5,-7745.79 1904.5,-7737 1904.5,-7728.21"/>
<polygon fill="black" stroke="black" points="1908,-7727.96 1904.5,-7717.96 1901,-7727.96 1908,-7727.96"/>
</g>
<!-- layer_11_qkv_gpu20 -->
<g id="node305" class="node">
<title>layer_11_qkv_gpu20</title>
<polygon fill="lightblue" stroke="black" points="1721.5,-7599.75 1623.5,-7599.75 1623.5,-7547.75 1721.5,-7547.75 1721.5,-7599.75"/>
<text text-anchor="middle" x="1672.5" y="-7587.75" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="1672.5" y="-7576.75" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="1672.5" y="-7565.75" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1672.5" y="-7554.75" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu20 -->
<g id="edge393" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu20</title>
<path fill="none" stroke="black" d="M1812.47,-7635.68C1784.99,-7623.72 1755.63,-7610.94 1730.93,-7600.19"/>
<polygon fill="black" stroke="black" points="1732.27,-7596.95 1721.71,-7596.17 1729.48,-7603.37 1732.27,-7596.95"/>
</g>
<!-- layer_11_qkv_gpu21 -->
<g id="node306" class="node">
<title>layer_11_qkv_gpu21</title>
<polygon fill="lightblue" stroke="black" points="1837.5,-7599.75 1739.5,-7599.75 1739.5,-7547.75 1837.5,-7547.75 1837.5,-7599.75"/>
<text text-anchor="middle" x="1788.5" y="-7587.75" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="1788.5" y="-7576.75" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="1788.5" y="-7565.75" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1788.5" y="-7554.75" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu21 -->
<g id="edge394" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu21</title>
<path fill="none" stroke="black" d="M1858.32,-7635.54C1847.34,-7625.98 1835.78,-7615.91 1825.29,-7606.78"/>
<polygon fill="black" stroke="black" points="1827.34,-7603.93 1817.5,-7600 1822.75,-7609.21 1827.34,-7603.93"/>
</g>
<!-- layer_11_qkv_gpu22 -->
<g id="node307" class="node">
<title>layer_11_qkv_gpu22</title>
<polygon fill="lightblue" stroke="black" points="1953.5,-7599.75 1855.5,-7599.75 1855.5,-7547.75 1953.5,-7547.75 1953.5,-7599.75"/>
<text text-anchor="middle" x="1904.5" y="-7587.75" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="1904.5" y="-7576.75" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="1904.5" y="-7565.75" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1904.5" y="-7554.75" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu22 -->
<g id="edge395" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu22</title>
<path fill="none" stroke="black" d="M1904.5,-7635.54C1904.5,-7627.11 1904.5,-7618.28 1904.5,-7610.04"/>
<polygon fill="black" stroke="black" points="1908,-7610 1904.5,-7600 1901,-7610 1908,-7610"/>
</g>
<!-- layer_11_qkv_gpu23 -->
<g id="node308" class="node">
<title>layer_11_qkv_gpu23</title>
<polygon fill="lightblue" stroke="black" points="2069.5,-7599.75 1971.5,-7599.75 1971.5,-7547.75 2069.5,-7547.75 2069.5,-7599.75"/>
<text text-anchor="middle" x="2020.5" y="-7587.75" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="2020.5" y="-7576.75" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="2020.5" y="-7565.75" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2020.5" y="-7554.75" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu23 -->
<g id="edge396" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu23</title>
<path fill="none" stroke="black" d="M1950.68,-7635.54C1961.66,-7625.98 1973.22,-7615.91 1983.71,-7606.78"/>
<polygon fill="black" stroke="black" points="1986.25,-7609.21 1991.5,-7600 1981.66,-7603.93 1986.25,-7609.21"/>
</g>
<!-- layer_11_residual1 -->
<g id="node316" class="node">
<title>layer_11_residual1</title>
<polygon fill="lightyellow" stroke="black" points="2106.44,-7116.67 1984.05,-7116.67 1952.56,-7034.67 2074.95,-7034.67 2106.44,-7116.67"/>
<text text-anchor="middle" x="2029.5" y="-7084.17" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="2029.5" y="-7073.17" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2029.5" y="-7062.17" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_residual1 -->
<g id="edge408" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_residual1</title>
<path fill="none" stroke="black" d="M1972.06,-7660.23C2007.92,-7648.87 2050.29,-7630.01 2078.5,-7599.75 2118.31,-7557.04 2122.5,-7534.36 2122.5,-7475.98 2122.5,-7475.98 2122.5,-7475.98 2122.5,-7287.21 2122.5,-7227.71 2091.03,-7166.19 2064.71,-7125.14"/>
<polygon fill="black" stroke="black" points="2067.59,-7123.14 2059.18,-7116.7 2061.73,-7126.98 2067.59,-7123.14"/>
</g>
<!-- layer_11_allgather_qkv -->
<g id="node309" class="node">
<title>layer_11_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="1788.5" cy="-7474.98" rx="57.05" ry="36.54"/>
<text text-anchor="middle" x="1788.5" y="-7488.98" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="1788.5" y="-7477.98" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="1788.5" y="-7466.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1788.5" y="-7455.98" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_11_qkv_gpu20&#45;&gt;layer_11_allgather_qkv -->
<g id="edge397" class="edge">
<title>layer_11_qkv_gpu20&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M1702.67,-7547.58C1715.93,-7536.52 1731.72,-7523.34 1746.13,-7511.33"/>
<polygon fill="black" stroke="black" points="1748.53,-7513.88 1753.96,-7504.79 1744.04,-7508.51 1748.53,-7513.88"/>
</g>
<!-- layer_11_qkv_gpu21&#45;&gt;layer_11_allgather_qkv -->
<g id="edge398" class="edge">
<title>layer_11_qkv_gpu21&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M1788.5,-7547.58C1788.5,-7539.77 1788.5,-7530.9 1788.5,-7522.13"/>
<polygon fill="black" stroke="black" points="1792,-7521.95 1788.5,-7511.95 1785,-7521.95 1792,-7521.95"/>
</g>
<!-- layer_11_qkv_gpu22&#45;&gt;layer_11_allgather_qkv -->
<g id="edge399" class="edge">
<title>layer_11_qkv_gpu22&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M1874.33,-7547.58C1861.07,-7536.52 1845.28,-7523.34 1830.87,-7511.33"/>
<polygon fill="black" stroke="black" points="1832.96,-7508.51 1823.04,-7504.79 1828.47,-7513.88 1832.96,-7508.51"/>
</g>
<!-- layer_11_qkv_gpu23&#45;&gt;layer_11_allgather_qkv -->
<g id="edge400" class="edge">
<title>layer_11_qkv_gpu23&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M1971.48,-7551.55C1968.44,-7550.26 1965.43,-7548.98 1962.5,-7547.75 1923.56,-7531.32 1879.55,-7513.18 1845.53,-7499.24"/>
<polygon fill="black" stroke="black" points="1846.8,-7495.97 1836.22,-7495.42 1844.15,-7502.45 1846.8,-7495.97"/>
</g>
<!-- layer_11_attention -->
<g id="node310" class="node">
<title>layer_11_attention</title>
<polygon fill="lightblue" stroke="black" points="1797.5,-7402.21 1729.5,-7402.21 1729.5,-7350.21 1797.5,-7350.21 1797.5,-7402.21"/>
<text text-anchor="middle" x="1763.5" y="-7390.21" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="1763.5" y="-7379.21" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1763.5" y="-7368.21" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="1763.5" y="-7357.21" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_11_allgather_qkv&#45;&gt;layer_11_attention -->
<g id="edge401" class="edge">
<title>layer_11_allgather_qkv&#45;&gt;layer_11_attention</title>
<path fill="none" stroke="black" d="M1779.33,-7438.49C1777.11,-7429.89 1774.73,-7420.69 1772.52,-7412.11"/>
<polygon fill="black" stroke="black" points="1775.9,-7411.2 1770.01,-7402.39 1769.12,-7412.95 1775.9,-7411.2"/>
</g>
<!-- layer_11_attn_out_gpu20 -->
<g id="node311" class="node">
<title>layer_11_attn_out_gpu20</title>
<polygon fill="lightblue" stroke="black" points="1761,-7314.21 1668,-7314.21 1668,-7262.21 1761,-7262.21 1761,-7314.21"/>
<text text-anchor="middle" x="1714.5" y="-7302.21" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="1714.5" y="-7291.21" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="1714.5" y="-7280.21" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1714.5" y="-7269.21" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attention&#45;&gt;layer_11_attn_out_gpu20 -->
<g id="edge402" class="edge">
<title>layer_11_attention&#45;&gt;layer_11_attn_out_gpu20</title>
<path fill="none" stroke="black" d="M1749.06,-7349.87C1744.33,-7341.56 1738.99,-7332.18 1733.94,-7323.33"/>
<polygon fill="black" stroke="black" points="1736.82,-7321.32 1728.83,-7314.37 1730.74,-7324.79 1736.82,-7321.32"/>
</g>
<!-- layer_11_allreduce_attn -->
<g id="node315" class="node">
<title>layer_11_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="1936.5" cy="-7189.44" rx="57.97" ry="36.54"/>
<text text-anchor="middle" x="1936.5" y="-7203.44" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="1936.5" y="-7192.44" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="1936.5" y="-7181.44" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1936.5" y="-7170.44" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_11_attn_out_gpu20&#45;&gt;layer_11_allreduce_attn -->
<g id="edge403" class="edge">
<title>layer_11_attn_out_gpu20&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M1761.23,-7266.3C1764.37,-7264.91 1767.48,-7263.54 1770.5,-7262.21 1806.74,-7246.29 1847.54,-7228.64 1879.62,-7214.83"/>
<polygon fill="black" stroke="black" points="1881.05,-7218.03 1888.85,-7210.86 1878.28,-7211.6 1881.05,-7218.03"/>
</g>
<!-- layer_11_attn_out_gpu21 -->
<g id="node312" class="node">
<title>layer_11_attn_out_gpu21</title>
<polygon fill="lightblue" stroke="black" points="1872,-7314.21 1779,-7314.21 1779,-7262.21 1872,-7262.21 1872,-7314.21"/>
<text text-anchor="middle" x="1825.5" y="-7302.21" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="1825.5" y="-7291.21" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="1825.5" y="-7280.21" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1825.5" y="-7269.21" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attn_out_gpu21&#45;&gt;layer_11_allreduce_attn -->
<g id="edge404" class="edge">
<title>layer_11_attn_out_gpu21&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M1854.37,-7262.04C1866.83,-7251.18 1881.64,-7238.27 1895.22,-7226.43"/>
<polygon fill="black" stroke="black" points="1897.81,-7228.81 1903.05,-7219.6 1893.21,-7223.53 1897.81,-7228.81"/>
</g>
<!-- layer_11_attn_out_gpu22 -->
<g id="node313" class="node">
<title>layer_11_attn_out_gpu22</title>
<polygon fill="lightblue" stroke="black" points="1983,-7314.21 1890,-7314.21 1890,-7262.21 1983,-7262.21 1983,-7314.21"/>
<text text-anchor="middle" x="1936.5" y="-7302.21" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="1936.5" y="-7291.21" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="1936.5" y="-7280.21" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1936.5" y="-7269.21" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attn_out_gpu22&#45;&gt;layer_11_allreduce_attn -->
<g id="edge405" class="edge">
<title>layer_11_attn_out_gpu22&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M1936.5,-7262.04C1936.5,-7254.23 1936.5,-7245.36 1936.5,-7236.59"/>
<polygon fill="black" stroke="black" points="1940,-7236.42 1936.5,-7226.42 1933,-7236.42 1940,-7236.42"/>
</g>
<!-- layer_11_attn_out_gpu23 -->
<g id="node314" class="node">
<title>layer_11_attn_out_gpu23</title>
<polygon fill="lightblue" stroke="black" points="2094,-7314.21 2001,-7314.21 2001,-7262.21 2094,-7262.21 2094,-7314.21"/>
<text text-anchor="middle" x="2047.5" y="-7302.21" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="2047.5" y="-7291.21" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="2047.5" y="-7280.21" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2047.5" y="-7269.21" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attn_out_gpu23&#45;&gt;layer_11_allreduce_attn -->
<g id="edge406" class="edge">
<title>layer_11_attn_out_gpu23&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M2018.63,-7262.04C2006.17,-7251.18 1991.36,-7238.27 1977.78,-7226.43"/>
<polygon fill="black" stroke="black" points="1979.79,-7223.53 1969.95,-7219.6 1975.19,-7228.81 1979.79,-7223.53"/>
</g>
<!-- layer_11_allreduce_attn&#45;&gt;layer_11_residual1 -->
<g id="edge407" class="edge">
<title>layer_11_allreduce_attn&#45;&gt;layer_11_residual1</title>
<path fill="none" stroke="black" d="M1963.15,-7156.41C1971.36,-7146.55 1980.58,-7135.46 1989.48,-7124.77"/>
<polygon fill="black" stroke="black" points="1992.18,-7127 1995.88,-7117.07 1986.79,-7122.52 1992.18,-7127"/>
</g>
<!-- layer_11_ln1 -->
<g id="node317" class="node">
<title>layer_11_ln1</title>
<polygon fill="lightblue" stroke="black" points="1969,-6998.67 1896,-6998.67 1896,-6946.67 1969,-6946.67 1969,-6998.67"/>
<text text-anchor="middle" x="1932.5" y="-6986.67" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="1932.5" y="-6975.67" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="1932.5" y="-6964.67" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="1932.5" y="-6953.67" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_11_residual1&#45;&gt;layer_11_ln1 -->
<g id="edge409" class="edge">
<title>layer_11_residual1&#45;&gt;layer_11_ln1</title>
<path fill="none" stroke="black" d="M1990.88,-7034.46C1981.89,-7025.09 1972.41,-7015.23 1963.78,-7006.24"/>
<polygon fill="black" stroke="black" points="1966.2,-7003.71 1956.75,-6998.92 1961.15,-7008.56 1966.2,-7003.71"/>
</g>
<!-- layer_11_residual2 -->
<g id="node329" class="node">
<title>layer_11_residual2</title>
<polygon fill="lightyellow" stroke="black" points="2135.44,-6438.59 2013.05,-6438.59 1981.56,-6356.59 2103.95,-6356.59 2135.44,-6438.59"/>
<text text-anchor="middle" x="2058.5" y="-6406.09" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="2058.5" y="-6395.09" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2058.5" y="-6384.09" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_11_residual1&#45;&gt;layer_11_residual2 -->
<g id="edge425" class="edge">
<title>layer_11_residual1&#45;&gt;layer_11_residual2</title>
<path fill="none" stroke="black" d="M2075.71,-7035.84C2112.02,-7000.76 2156.5,-6945.56 2156.5,-6885.67 2156.5,-6885.67 2156.5,-6885.67 2156.5,-6609.13 2156.5,-6549.28 2123.55,-6488.05 2095.86,-6447.16"/>
<polygon fill="black" stroke="black" points="2098.61,-6444.99 2090.05,-6438.76 2092.86,-6448.97 2098.61,-6444.99"/>
</g>
<!-- layer_11_mlp_fc1_gpu20 -->
<g id="node318" class="node">
<title>layer_11_mlp_fc1_gpu20</title>
<polygon fill="lightblue" stroke="black" points="1748,-6910.67 1649,-6910.67 1649,-6858.67 1748,-6858.67 1748,-6910.67"/>
<text text-anchor="middle" x="1698.5" y="-6898.67" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="1698.5" y="-6887.67" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="1698.5" y="-6876.67" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1698.5" y="-6865.67" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu20 -->
<g id="edge410" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu20</title>
<path fill="none" stroke="black" d="M1895.71,-6959.63C1862.14,-6948.46 1810.99,-6931.02 1757.88,-6910.73"/>
<polygon fill="black" stroke="black" points="1758.89,-6907.36 1748.3,-6907.04 1756.38,-6913.9 1758.89,-6907.36"/>
</g>
<!-- layer_11_mlp_fc1_gpu21 -->
<g id="node319" class="node">
<title>layer_11_mlp_fc1_gpu21</title>
<polygon fill="lightblue" stroke="black" points="1865,-6910.67 1766,-6910.67 1766,-6858.67 1865,-6858.67 1865,-6910.67"/>
<text text-anchor="middle" x="1815.5" y="-6898.67" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="1815.5" y="-6887.67" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="1815.5" y="-6876.67" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1815.5" y="-6865.67" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu21 -->
<g id="edge411" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu21</title>
<path fill="none" stroke="black" d="M1898.34,-6946.56C1885.72,-6937.28 1871.26,-6926.65 1857.98,-6916.9"/>
<polygon fill="black" stroke="black" points="1860.03,-6914.06 1849.9,-6910.96 1855.89,-6919.7 1860.03,-6914.06"/>
</g>
<!-- layer_11_mlp_fc1_gpu22 -->
<g id="node320" class="node">
<title>layer_11_mlp_fc1_gpu22</title>
<polygon fill="lightblue" stroke="black" points="1982,-6910.67 1883,-6910.67 1883,-6858.67 1982,-6858.67 1982,-6910.67"/>
<text text-anchor="middle" x="1932.5" y="-6898.67" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="1932.5" y="-6887.67" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="1932.5" y="-6876.67" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1932.5" y="-6865.67" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu22 -->
<g id="edge412" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu22</title>
<path fill="none" stroke="black" d="M1932.5,-6946.33C1932.5,-6938.37 1932.5,-6929.43 1932.5,-6920.91"/>
<polygon fill="black" stroke="black" points="1936,-6920.83 1932.5,-6910.83 1929,-6920.83 1936,-6920.83"/>
</g>
<!-- layer_11_mlp_fc1_gpu23 -->
<g id="node321" class="node">
<title>layer_11_mlp_fc1_gpu23</title>
<polygon fill="lightblue" stroke="black" points="2099,-6910.67 2000,-6910.67 2000,-6858.67 2099,-6858.67 2099,-6910.67"/>
<text text-anchor="middle" x="2049.5" y="-6898.67" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="2049.5" y="-6887.67" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="2049.5" y="-6876.67" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2049.5" y="-6865.67" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu23 -->
<g id="edge413" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu23</title>
<path fill="none" stroke="black" d="M1966.66,-6946.56C1979.28,-6937.28 1993.74,-6926.65 2007.02,-6916.9"/>
<polygon fill="black" stroke="black" points="2009.11,-6919.7 2015.1,-6910.96 2004.97,-6914.06 2009.11,-6919.7"/>
</g>
<!-- layer_11_allgather_mlp -->
<g id="node322" class="node">
<title>layer_11_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="1815.5" cy="-6785.9" rx="56.64" ry="36.54"/>
<text text-anchor="middle" x="1815.5" y="-6799.9" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="1815.5" y="-6788.9" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="1815.5" y="-6777.9" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1815.5" y="-6766.9" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_11_mlp_fc1_gpu20&#45;&gt;layer_11_allgather_mlp -->
<g id="edge414" class="edge">
<title>layer_11_mlp_fc1_gpu20&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M1728.93,-6858.5C1742.42,-6847.35 1758.51,-6834.04 1773.13,-6821.94"/>
<polygon fill="black" stroke="black" points="1775.61,-6824.43 1781.09,-6815.36 1771.15,-6819.04 1775.61,-6824.43"/>
</g>
<!-- layer_11_mlp_fc1_gpu21&#45;&gt;layer_11_allgather_mlp -->
<g id="edge415" class="edge">
<title>layer_11_mlp_fc1_gpu21&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M1815.5,-6858.5C1815.5,-6850.69 1815.5,-6841.82 1815.5,-6833.05"/>
<polygon fill="black" stroke="black" points="1819,-6832.88 1815.5,-6822.88 1812,-6832.88 1819,-6832.88"/>
</g>
<!-- layer_11_mlp_fc1_gpu22&#45;&gt;layer_11_allgather_mlp -->
<g id="edge416" class="edge">
<title>layer_11_mlp_fc1_gpu22&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M1902.07,-6858.5C1888.58,-6847.35 1872.49,-6834.04 1857.87,-6821.94"/>
<polygon fill="black" stroke="black" points="1859.85,-6819.04 1849.91,-6815.36 1855.39,-6824.43 1859.85,-6819.04"/>
</g>
<!-- layer_11_mlp_fc1_gpu23&#45;&gt;layer_11_allgather_mlp -->
<g id="edge417" class="edge">
<title>layer_11_mlp_fc1_gpu23&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M1999.85,-6862.19C1997.03,-6861 1994.23,-6859.81 1991.5,-6858.67 1951.86,-6842.05 1907,-6823.76 1872.49,-6809.81"/>
<polygon fill="black" stroke="black" points="1873.62,-6806.49 1863.04,-6805.99 1871,-6812.98 1873.62,-6806.49"/>
</g>
<!-- layer_11_gelu -->
<g id="node323" class="node">
<title>layer_11_gelu</title>
<polygon fill="lightblue" stroke="black" points="1830,-6713.13 1741,-6713.13 1741,-6672.13 1830,-6672.13 1830,-6713.13"/>
<text text-anchor="middle" x="1785.5" y="-6701.13" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="1785.5" y="-6690.13" font-family="Arial" font-size="10.00">GELU Activation</text>
<text text-anchor="middle" x="1785.5" y="-6679.13" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_11_allgather_mlp&#45;&gt;layer_11_gelu -->
<g id="edge418" class="edge">
<title>layer_11_allgather_mlp&#45;&gt;layer_11_gelu</title>
<path fill="none" stroke="black" d="M1803.99,-6749.87C1801.07,-6740.99 1797.96,-6731.53 1795.14,-6722.96"/>
<polygon fill="black" stroke="black" points="1798.44,-6721.79 1791.99,-6713.39 1791.79,-6723.98 1798.44,-6721.79"/>
</g>
<!-- layer_11_mlp_fc2_gpu20 -->
<g id="node324" class="node">
<title>layer_11_mlp_fc2_gpu20</title>
<polygon fill="lightblue" stroke="black" points="1777,-6636.13 1678,-6636.13 1678,-6584.13 1777,-6584.13 1777,-6636.13"/>
<text text-anchor="middle" x="1727.5" y="-6624.13" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="1727.5" y="-6613.13" font-family="Arial" font-size="10.00">GPU 20</text>
<text text-anchor="middle" x="1727.5" y="-6602.13" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1727.5" y="-6591.13" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu20 -->
<g id="edge419" class="edge">
<title>layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu20</title>
<path fill="none" stroke="black" d="M1771.16,-6671.73C1765.26,-6663.53 1758.25,-6653.8 1751.59,-6644.57"/>
<polygon fill="black" stroke="black" points="1754.31,-6642.35 1745.62,-6636.29 1748.63,-6646.44 1754.31,-6642.35"/>
</g>
<!-- layer_11_allreduce_mlp -->
<g id="node328" class="node">
<title>layer_11_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="1961.5" cy="-6511.36" rx="60.21" ry="36.54"/>
<text text-anchor="middle" x="1961.5" y="-6525.36" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="1961.5" y="-6514.36" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="1961.5" y="-6503.36" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1961.5" y="-6492.36" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_11_mlp_fc2_gpu20&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge420" class="edge">
<title>layer_11_mlp_fc2_gpu20&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1777.06,-6588.08C1780.25,-6586.74 1783.42,-6585.41 1786.5,-6584.13 1825.15,-6568.02 1868.71,-6550.15 1902.71,-6536.27"/>
<polygon fill="black" stroke="black" points="1904.09,-6539.49 1912.03,-6532.47 1901.45,-6533.01 1904.09,-6539.49"/>
</g>
<!-- layer_11_mlp_fc2_gpu21 -->
<g id="node325" class="node">
<title>layer_11_mlp_fc2_gpu21</title>
<polygon fill="lightblue" stroke="black" points="1894,-6636.13 1795,-6636.13 1795,-6584.13 1894,-6584.13 1894,-6636.13"/>
<text text-anchor="middle" x="1844.5" y="-6624.13" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="1844.5" y="-6613.13" font-family="Arial" font-size="10.00">GPU 21</text>
<text text-anchor="middle" x="1844.5" y="-6602.13" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1844.5" y="-6591.13" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_mlp_fc2_gpu21&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge421" class="edge">
<title>layer_11_mlp_fc2_gpu21&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1874.93,-6583.96C1888.19,-6573 1903.96,-6559.95 1918.39,-6548.02"/>
<polygon fill="black" stroke="black" points="1920.77,-6550.59 1926.24,-6541.52 1916.31,-6545.2 1920.77,-6550.59"/>
</g>
<!-- layer_11_mlp_fc2_gpu22 -->
<g id="node326" class="node">
<title>layer_11_mlp_fc2_gpu22</title>
<polygon fill="lightblue" stroke="black" points="2011,-6636.13 1912,-6636.13 1912,-6584.13 2011,-6584.13 2011,-6636.13"/>
<text text-anchor="middle" x="1961.5" y="-6624.13" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="1961.5" y="-6613.13" font-family="Arial" font-size="10.00">GPU 22</text>
<text text-anchor="middle" x="1961.5" y="-6602.13" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1961.5" y="-6591.13" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_mlp_fc2_gpu22&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge422" class="edge">
<title>layer_11_mlp_fc2_gpu22&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1961.5,-6583.96C1961.5,-6576.15 1961.5,-6567.28 1961.5,-6558.52"/>
<polygon fill="black" stroke="black" points="1965,-6558.34 1961.5,-6548.34 1958,-6558.34 1965,-6558.34"/>
</g>
<!-- layer_11_mlp_fc2_gpu23 -->
<g id="node327" class="node">
<title>layer_11_mlp_fc2_gpu23</title>
<polygon fill="lightblue" stroke="black" points="2128,-6636.13 2029,-6636.13 2029,-6584.13 2128,-6584.13 2128,-6636.13"/>
<text text-anchor="middle" x="2078.5" y="-6624.13" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="2078.5" y="-6613.13" font-family="Arial" font-size="10.00">GPU 23</text>
<text text-anchor="middle" x="2078.5" y="-6602.13" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2078.5" y="-6591.13" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_mlp_fc2_gpu23&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge423" class="edge">
<title>layer_11_mlp_fc2_gpu23&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2048.07,-6583.96C2034.81,-6573 2019.04,-6559.95 2004.61,-6548.02"/>
<polygon fill="black" stroke="black" points="2006.69,-6545.2 1996.76,-6541.52 2002.23,-6550.59 2006.69,-6545.2"/>
</g>
<!-- layer_11_allreduce_mlp&#45;&gt;layer_11_residual2 -->
<g id="edge424" class="edge">
<title>layer_11_allreduce_mlp&#45;&gt;layer_11_residual2</title>
<path fill="none" stroke="black" d="M1989.04,-6478.63C1997.69,-6468.66 2007.45,-6457.42 2016.85,-6446.58"/>
<polygon fill="black" stroke="black" points="2019.71,-6448.63 2023.62,-6438.78 2014.42,-6444.04 2019.71,-6448.63"/>
</g>
<!-- layer_11_ln2 -->
<g id="node330" class="node">
<title>layer_11_ln2</title>
<polygon fill="lightblue" stroke="black" points="2095,-6320.59 2022,-6320.59 2022,-6268.59 2095,-6268.59 2095,-6320.59"/>
<text text-anchor="middle" x="2058.5" y="-6308.59" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="2058.5" y="-6297.59" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="2058.5" y="-6286.59" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="2058.5" y="-6275.59" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- layer_11_residual2&#45;&gt;layer_11_ln2 -->
<g id="edge426" class="edge">
<title>layer_11_residual2&#45;&gt;layer_11_ln2</title>
<path fill="none" stroke="black" d="M2058.5,-6356.38C2058.5,-6347.95 2058.5,-6339.12 2058.5,-6330.88"/>
<polygon fill="black" stroke="black" points="2062,-6330.84 2058.5,-6320.84 2055,-6330.84 2062,-6330.84"/>
</g>
<!-- layer_11_to_gpu6 -->
<g id="node331" class="node">
<title>layer_11_to_gpu6</title>
<ellipse fill="purple" stroke="black" cx="2058.5" cy="-6203.6" rx="58.88" ry="28.98"/>
<text text-anchor="middle" x="2058.5" y="-6212.1" font-family="Arial" font-size="10.00">Layer 11→12</text>
<text text-anchor="middle" x="2058.5" y="-6201.1" font-family="Arial" font-size="10.00">Pipeline Comm</text>
<text text-anchor="middle" x="2058.5" y="-6190.1" font-family="Arial" font-size="10.00">GPU 5→6</text>
</g>
<!-- layer_11_ln2&#45;&gt;layer_11_to_gpu6 -->
<g id="edge427" class="edge">
<title>layer_11_ln2&#45;&gt;layer_11_to_gpu6</title>
<path fill="none" stroke="black" d="M2058.5,-6268.33C2058.5,-6260.44 2058.5,-6251.55 2058.5,-6242.97"/>
<polygon fill="black" stroke="black" points="2062,-6242.74 2058.5,-6232.74 2055,-6242.74 2062,-6242.74"/>
</g>
<!-- layer_12_input_dist -->
<g id="node332" class="node">
<title>layer_12_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="2152.69,-6138.61 2002.86,-6138.61 1964.31,-6056.61 2114.14,-6056.61 2152.69,-6138.61"/>
<text text-anchor="middle" x="2058.5" y="-6106.11" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="2058.5" y="-6095.11" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="2058.5" y="-6084.11" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_11_to_gpu6&#45;&gt;layer_12_input_dist -->
<g id="edge428" class="edge">
<title>layer_11_to_gpu6&#45;&gt;layer_12_input_dist</title>
<path fill="none" stroke="black" d="M2058.5,-6174.46C2058.5,-6166.59 2058.5,-6157.79 2058.5,-6149.05"/>
<polygon fill="black" stroke="black" points="2062,-6148.88 2058.5,-6138.88 2055,-6148.88 2062,-6148.88"/>
</g>
<!-- layer_12_qkv_gpu24 -->
<g id="node333" class="node">
<title>layer_12_qkv_gpu24</title>
<polygon fill="lightblue" stroke="black" points="1875.5,-6020.61 1777.5,-6020.61 1777.5,-5968.61 1875.5,-5968.61 1875.5,-6020.61"/>
<text text-anchor="middle" x="1826.5" y="-6008.61" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="1826.5" y="-5997.61" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="1826.5" y="-5986.61" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1826.5" y="-5975.61" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu24 -->
<g id="edge429" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu24</title>
<path fill="none" stroke="black" d="M1966.47,-6056.55C1938.99,-6044.58 1909.63,-6031.8 1884.93,-6021.05"/>
<polygon fill="black" stroke="black" points="1886.27,-6017.81 1875.71,-6017.03 1883.48,-6024.23 1886.27,-6017.81"/>
</g>
<!-- layer_12_qkv_gpu25 -->
<g id="node334" class="node">
<title>layer_12_qkv_gpu25</title>
<polygon fill="lightblue" stroke="black" points="1991.5,-6020.61 1893.5,-6020.61 1893.5,-5968.61 1991.5,-5968.61 1991.5,-6020.61"/>
<text text-anchor="middle" x="1942.5" y="-6008.61" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="1942.5" y="-5997.61" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="1942.5" y="-5986.61" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1942.5" y="-5975.61" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu25 -->
<g id="edge430" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu25</title>
<path fill="none" stroke="black" d="M2012.32,-6056.4C2001.34,-6046.84 1989.78,-6036.77 1979.29,-6027.64"/>
<polygon fill="black" stroke="black" points="1981.34,-6024.79 1971.5,-6020.86 1976.75,-6030.07 1981.34,-6024.79"/>
</g>
<!-- layer_12_qkv_gpu26 -->
<g id="node335" class="node">
<title>layer_12_qkv_gpu26</title>
<polygon fill="lightblue" stroke="black" points="2107.5,-6020.61 2009.5,-6020.61 2009.5,-5968.61 2107.5,-5968.61 2107.5,-6020.61"/>
<text text-anchor="middle" x="2058.5" y="-6008.61" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="2058.5" y="-5997.61" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="2058.5" y="-5986.61" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2058.5" y="-5975.61" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu26 -->
<g id="edge431" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu26</title>
<path fill="none" stroke="black" d="M2058.5,-6056.4C2058.5,-6047.97 2058.5,-6039.14 2058.5,-6030.9"/>
<polygon fill="black" stroke="black" points="2062,-6030.86 2058.5,-6020.86 2055,-6030.86 2062,-6030.86"/>
</g>
<!-- layer_12_qkv_gpu27 -->
<g id="node336" class="node">
<title>layer_12_qkv_gpu27</title>
<polygon fill="lightblue" stroke="black" points="2223.5,-6020.61 2125.5,-6020.61 2125.5,-5968.61 2223.5,-5968.61 2223.5,-6020.61"/>
<text text-anchor="middle" x="2174.5" y="-6008.61" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="2174.5" y="-5997.61" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="2174.5" y="-5986.61" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2174.5" y="-5975.61" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu27 -->
<g id="edge432" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu27</title>
<path fill="none" stroke="black" d="M2104.68,-6056.4C2115.66,-6046.84 2127.22,-6036.77 2137.71,-6027.64"/>
<polygon fill="black" stroke="black" points="2140.25,-6030.07 2145.5,-6020.86 2135.66,-6024.79 2140.25,-6030.07"/>
</g>
<!-- layer_12_residual1 -->
<g id="node344" class="node">
<title>layer_12_residual1</title>
<polygon fill="lightyellow" stroke="black" points="2260.44,-5537.53 2138.05,-5537.53 2106.56,-5455.53 2228.95,-5455.53 2260.44,-5537.53"/>
<text text-anchor="middle" x="2183.5" y="-5505.03" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="2183.5" y="-5494.03" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2183.5" y="-5483.03" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_residual1 -->
<g id="edge444" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_residual1</title>
<path fill="none" stroke="black" d="M2126.06,-6081.09C2161.92,-6069.73 2204.29,-6050.87 2232.5,-6020.61 2272.31,-5977.9 2276.5,-5955.22 2276.5,-5896.84 2276.5,-5896.84 2276.5,-5896.84 2276.5,-5708.07 2276.5,-5648.57 2245.03,-5587.05 2218.71,-5546"/>
<polygon fill="black" stroke="black" points="2221.59,-5544.01 2213.18,-5537.56 2215.73,-5547.84 2221.59,-5544.01"/>
</g>
<!-- layer_12_allgather_qkv -->
<g id="node337" class="node">
<title>layer_12_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="1942.5" cy="-5895.84" rx="57.05" ry="36.54"/>
<text text-anchor="middle" x="1942.5" y="-5909.84" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="1942.5" y="-5898.84" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="1942.5" y="-5887.84" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1942.5" y="-5876.84" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_12_qkv_gpu24&#45;&gt;layer_12_allgather_qkv -->
<g id="edge433" class="edge">
<title>layer_12_qkv_gpu24&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M1856.67,-5968.44C1869.93,-5957.38 1885.72,-5944.2 1900.13,-5932.19"/>
<polygon fill="black" stroke="black" points="1902.53,-5934.74 1907.96,-5925.65 1898.04,-5929.37 1902.53,-5934.74"/>
</g>
<!-- layer_12_qkv_gpu25&#45;&gt;layer_12_allgather_qkv -->
<g id="edge434" class="edge">
<title>layer_12_qkv_gpu25&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M1942.5,-5968.44C1942.5,-5960.63 1942.5,-5951.76 1942.5,-5942.99"/>
<polygon fill="black" stroke="black" points="1946,-5942.82 1942.5,-5932.82 1939,-5942.82 1946,-5942.82"/>
</g>
<!-- layer_12_qkv_gpu26&#45;&gt;layer_12_allgather_qkv -->
<g id="edge435" class="edge">
<title>layer_12_qkv_gpu26&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M2028.33,-5968.44C2015.07,-5957.38 1999.28,-5944.2 1984.87,-5932.19"/>
<polygon fill="black" stroke="black" points="1986.96,-5929.37 1977.04,-5925.65 1982.47,-5934.74 1986.96,-5929.37"/>
</g>
<!-- layer_12_qkv_gpu27&#45;&gt;layer_12_allgather_qkv -->
<g id="edge436" class="edge">
<title>layer_12_qkv_gpu27&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M2125.48,-5972.41C2122.44,-5971.12 2119.43,-5969.84 2116.5,-5968.61 2077.56,-5952.19 2033.55,-5934.04 1999.53,-5920.1"/>
<polygon fill="black" stroke="black" points="2000.8,-5916.84 1990.22,-5916.28 1998.15,-5923.31 2000.8,-5916.84"/>
</g>
<!-- layer_12_attention -->
<g id="node338" class="node">
<title>layer_12_attention</title>
<polygon fill="lightblue" stroke="black" points="1927.5,-5823.07 1859.5,-5823.07 1859.5,-5771.07 1927.5,-5771.07 1927.5,-5823.07"/>
<text text-anchor="middle" x="1893.5" y="-5811.07" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="1893.5" y="-5800.07" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1893.5" y="-5789.07" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="1893.5" y="-5778.07" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_12_allgather_qkv&#45;&gt;layer_12_attention -->
<g id="edge437" class="edge">
<title>layer_12_allgather_qkv&#45;&gt;layer_12_attention</title>
<path fill="none" stroke="black" d="M1925.22,-5860.72C1920.6,-5851.59 1915.6,-5841.72 1910.97,-5832.58"/>
<polygon fill="black" stroke="black" points="1913.95,-5830.71 1906.31,-5823.37 1907.7,-5833.87 1913.95,-5830.71"/>
</g>
<!-- layer_12_attn_out_gpu24 -->
<g id="node339" class="node">
<title>layer_12_attn_out_gpu24</title>
<polygon fill="lightblue" stroke="black" points="1915,-5735.07 1822,-5735.07 1822,-5683.07 1915,-5683.07 1915,-5735.07"/>
<text text-anchor="middle" x="1868.5" y="-5723.07" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="1868.5" y="-5712.07" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="1868.5" y="-5701.07" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1868.5" y="-5690.07" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attention&#45;&gt;layer_12_attn_out_gpu24 -->
<g id="edge438" class="edge">
<title>layer_12_attention&#45;&gt;layer_12_attn_out_gpu24</title>
<path fill="none" stroke="black" d="M1886.13,-5770.73C1883.79,-5762.68 1881.16,-5753.64 1878.66,-5745.03"/>
<polygon fill="black" stroke="black" points="1881.97,-5743.85 1875.81,-5735.23 1875.24,-5745.81 1881.97,-5743.85"/>
</g>
<!-- layer_12_allreduce_attn -->
<g id="node343" class="node">
<title>layer_12_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="2090.5" cy="-5610.3" rx="57.97" ry="36.54"/>
<text text-anchor="middle" x="2090.5" y="-5624.3" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="2090.5" y="-5613.3" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="2090.5" y="-5602.3" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2090.5" y="-5591.3" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_12_attn_out_gpu24&#45;&gt;layer_12_allreduce_attn -->
<g id="edge439" class="edge">
<title>layer_12_attn_out_gpu24&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M1915.23,-5687.16C1918.37,-5685.77 1921.48,-5684.4 1924.5,-5683.07 1960.74,-5667.15 2001.54,-5649.51 2033.62,-5635.7"/>
<polygon fill="black" stroke="black" points="2035.05,-5638.89 2042.85,-5631.72 2032.28,-5632.46 2035.05,-5638.89"/>
</g>
<!-- layer_12_attn_out_gpu25 -->
<g id="node340" class="node">
<title>layer_12_attn_out_gpu25</title>
<polygon fill="lightblue" stroke="black" points="2026,-5735.07 1933,-5735.07 1933,-5683.07 2026,-5683.07 2026,-5735.07"/>
<text text-anchor="middle" x="1979.5" y="-5723.07" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="1979.5" y="-5712.07" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="1979.5" y="-5701.07" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1979.5" y="-5690.07" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attn_out_gpu25&#45;&gt;layer_12_allreduce_attn -->
<g id="edge440" class="edge">
<title>layer_12_attn_out_gpu25&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M2008.37,-5682.9C2020.83,-5672.04 2035.64,-5659.13 2049.22,-5647.29"/>
<polygon fill="black" stroke="black" points="2051.81,-5649.67 2057.05,-5640.46 2047.21,-5644.39 2051.81,-5649.67"/>
</g>
<!-- layer_12_attn_out_gpu26 -->
<g id="node341" class="node">
<title>layer_12_attn_out_gpu26</title>
<polygon fill="lightblue" stroke="black" points="2137,-5735.07 2044,-5735.07 2044,-5683.07 2137,-5683.07 2137,-5735.07"/>
<text text-anchor="middle" x="2090.5" y="-5723.07" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="2090.5" y="-5712.07" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="2090.5" y="-5701.07" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2090.5" y="-5690.07" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attn_out_gpu26&#45;&gt;layer_12_allreduce_attn -->
<g id="edge441" class="edge">
<title>layer_12_attn_out_gpu26&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M2090.5,-5682.9C2090.5,-5675.09 2090.5,-5666.22 2090.5,-5657.45"/>
<polygon fill="black" stroke="black" points="2094,-5657.28 2090.5,-5647.28 2087,-5657.28 2094,-5657.28"/>
</g>
<!-- layer_12_attn_out_gpu27 -->
<g id="node342" class="node">
<title>layer_12_attn_out_gpu27</title>
<polygon fill="lightblue" stroke="black" points="2248,-5735.07 2155,-5735.07 2155,-5683.07 2248,-5683.07 2248,-5735.07"/>
<text text-anchor="middle" x="2201.5" y="-5723.07" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="2201.5" y="-5712.07" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="2201.5" y="-5701.07" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2201.5" y="-5690.07" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attn_out_gpu27&#45;&gt;layer_12_allreduce_attn -->
<g id="edge442" class="edge">
<title>layer_12_attn_out_gpu27&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M2172.63,-5682.9C2160.17,-5672.04 2145.36,-5659.13 2131.78,-5647.29"/>
<polygon fill="black" stroke="black" points="2133.79,-5644.39 2123.95,-5640.46 2129.19,-5649.67 2133.79,-5644.39"/>
</g>
<!-- layer_12_allreduce_attn&#45;&gt;layer_12_residual1 -->
<g id="edge443" class="edge">
<title>layer_12_allreduce_attn&#45;&gt;layer_12_residual1</title>
<path fill="none" stroke="black" d="M2117.15,-5577.27C2125.36,-5567.41 2134.58,-5556.33 2143.48,-5545.63"/>
<polygon fill="black" stroke="black" points="2146.18,-5547.86 2149.88,-5537.93 2140.79,-5543.38 2146.18,-5547.86"/>
</g>
<!-- layer_12_ln1 -->
<g id="node345" class="node">
<title>layer_12_ln1</title>
<polygon fill="lightblue" stroke="black" points="2123,-5419.53 2050,-5419.53 2050,-5367.53 2123,-5367.53 2123,-5419.53"/>
<text text-anchor="middle" x="2086.5" y="-5407.53" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="2086.5" y="-5396.53" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="2086.5" y="-5385.53" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="2086.5" y="-5374.53" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_12_residual1&#45;&gt;layer_12_ln1 -->
<g id="edge445" class="edge">
<title>layer_12_residual1&#45;&gt;layer_12_ln1</title>
<path fill="none" stroke="black" d="M2144.88,-5455.32C2135.89,-5445.95 2126.41,-5436.09 2117.78,-5427.1"/>
<polygon fill="black" stroke="black" points="2120.2,-5424.57 2110.75,-5419.78 2115.15,-5429.42 2120.2,-5424.57"/>
</g>
<!-- layer_12_residual2 -->
<g id="node357" class="node">
<title>layer_12_residual2</title>
<polygon fill="lightyellow" stroke="black" points="2289.44,-4859.45 2167.05,-4859.45 2135.56,-4777.45 2257.95,-4777.45 2289.44,-4859.45"/>
<text text-anchor="middle" x="2212.5" y="-4826.95" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="2212.5" y="-4815.95" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2212.5" y="-4804.95" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_12_residual1&#45;&gt;layer_12_residual2 -->
<g id="edge461" class="edge">
<title>layer_12_residual1&#45;&gt;layer_12_residual2</title>
<path fill="none" stroke="black" d="M2229.71,-5456.7C2266.02,-5421.62 2310.5,-5366.42 2310.5,-5306.53 2310.5,-5306.53 2310.5,-5306.53 2310.5,-5029.99 2310.5,-4970.14 2277.55,-4908.91 2249.86,-4868.02"/>
<polygon fill="black" stroke="black" points="2252.61,-4865.85 2244.05,-4859.62 2246.86,-4869.83 2252.61,-4865.85"/>
</g>
<!-- layer_12_mlp_fc1_gpu24 -->
<g id="node346" class="node">
<title>layer_12_mlp_fc1_gpu24</title>
<polygon fill="lightblue" stroke="black" points="1902,-5331.53 1803,-5331.53 1803,-5279.53 1902,-5279.53 1902,-5331.53"/>
<text text-anchor="middle" x="1852.5" y="-5319.53" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="1852.5" y="-5308.53" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="1852.5" y="-5297.53" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1852.5" y="-5286.53" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu24 -->
<g id="edge446" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu24</title>
<path fill="none" stroke="black" d="M2049.71,-5380.49C2016.14,-5369.32 1964.99,-5351.88 1911.88,-5331.59"/>
<polygon fill="black" stroke="black" points="1912.89,-5328.23 1902.3,-5327.9 1910.38,-5334.76 1912.89,-5328.23"/>
</g>
<!-- layer_12_mlp_fc1_gpu25 -->
<g id="node347" class="node">
<title>layer_12_mlp_fc1_gpu25</title>
<polygon fill="lightblue" stroke="black" points="2019,-5331.53 1920,-5331.53 1920,-5279.53 2019,-5279.53 2019,-5331.53"/>
<text text-anchor="middle" x="1969.5" y="-5319.53" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="1969.5" y="-5308.53" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="1969.5" y="-5297.53" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1969.5" y="-5286.53" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu25 -->
<g id="edge447" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu25</title>
<path fill="none" stroke="black" d="M2052.34,-5367.42C2039.72,-5358.15 2025.26,-5347.51 2011.98,-5337.76"/>
<polygon fill="black" stroke="black" points="2014.03,-5334.92 2003.9,-5331.82 2009.89,-5340.56 2014.03,-5334.92"/>
</g>
<!-- layer_12_mlp_fc1_gpu26 -->
<g id="node348" class="node">
<title>layer_12_mlp_fc1_gpu26</title>
<polygon fill="lightblue" stroke="black" points="2136,-5331.53 2037,-5331.53 2037,-5279.53 2136,-5279.53 2136,-5331.53"/>
<text text-anchor="middle" x="2086.5" y="-5319.53" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="2086.5" y="-5308.53" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="2086.5" y="-5297.53" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2086.5" y="-5286.53" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu26 -->
<g id="edge448" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu26</title>
<path fill="none" stroke="black" d="M2086.5,-5367.19C2086.5,-5359.23 2086.5,-5350.29 2086.5,-5341.78"/>
<polygon fill="black" stroke="black" points="2090,-5341.69 2086.5,-5331.69 2083,-5341.69 2090,-5341.69"/>
</g>
<!-- layer_12_mlp_fc1_gpu27 -->
<g id="node349" class="node">
<title>layer_12_mlp_fc1_gpu27</title>
<polygon fill="lightblue" stroke="black" points="2253,-5331.53 2154,-5331.53 2154,-5279.53 2253,-5279.53 2253,-5331.53"/>
<text text-anchor="middle" x="2203.5" y="-5319.53" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="2203.5" y="-5308.53" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="2203.5" y="-5297.53" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2203.5" y="-5286.53" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu27 -->
<g id="edge449" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu27</title>
<path fill="none" stroke="black" d="M2120.66,-5367.42C2133.28,-5358.15 2147.74,-5347.51 2161.02,-5337.76"/>
<polygon fill="black" stroke="black" points="2163.11,-5340.56 2169.1,-5331.82 2158.97,-5334.92 2163.11,-5340.56"/>
</g>
<!-- layer_12_allgather_mlp -->
<g id="node350" class="node">
<title>layer_12_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="1969.5" cy="-5206.76" rx="56.64" ry="36.54"/>
<text text-anchor="middle" x="1969.5" y="-5220.76" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="1969.5" y="-5209.76" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="1969.5" y="-5198.76" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1969.5" y="-5187.76" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_12_mlp_fc1_gpu24&#45;&gt;layer_12_allgather_mlp -->
<g id="edge450" class="edge">
<title>layer_12_mlp_fc1_gpu24&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M1882.93,-5279.36C1896.42,-5268.21 1912.51,-5254.9 1927.13,-5242.8"/>
<polygon fill="black" stroke="black" points="1929.61,-5245.29 1935.09,-5236.22 1925.15,-5239.9 1929.61,-5245.29"/>
</g>
<!-- layer_12_mlp_fc1_gpu25&#45;&gt;layer_12_allgather_mlp -->
<g id="edge451" class="edge">
<title>layer_12_mlp_fc1_gpu25&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M1969.5,-5279.36C1969.5,-5271.55 1969.5,-5262.68 1969.5,-5253.92"/>
<polygon fill="black" stroke="black" points="1973,-5253.74 1969.5,-5243.74 1966,-5253.74 1973,-5253.74"/>
</g>
<!-- layer_12_mlp_fc1_gpu26&#45;&gt;layer_12_allgather_mlp -->
<g id="edge452" class="edge">
<title>layer_12_mlp_fc1_gpu26&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M2056.07,-5279.36C2042.58,-5268.21 2026.49,-5254.9 2011.87,-5242.8"/>
<polygon fill="black" stroke="black" points="2013.85,-5239.9 2003.91,-5236.22 2009.39,-5245.29 2013.85,-5239.9"/>
</g>
<!-- layer_12_mlp_fc1_gpu27&#45;&gt;layer_12_allgather_mlp -->
<g id="edge453" class="edge">
<title>layer_12_mlp_fc1_gpu27&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M2153.85,-5283.05C2151.03,-5281.86 2148.23,-5280.68 2145.5,-5279.53 2105.86,-5262.91 2061,-5244.62 2026.49,-5230.67"/>
<polygon fill="black" stroke="black" points="2027.62,-5227.35 2017.04,-5226.85 2025,-5233.84 2027.62,-5227.35"/>
</g>
<!-- layer_12_gelu -->
<g id="node351" class="node">
<title>layer_12_gelu</title>
<polygon fill="lightblue" stroke="black" points="1984,-5133.99 1895,-5133.99 1895,-5092.99 1984,-5092.99 1984,-5133.99"/>
<text text-anchor="middle" x="1939.5" y="-5121.99" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="1939.5" y="-5110.99" font-family="Arial" font-size="10.00">GELU Activation</text>
<text text-anchor="middle" x="1939.5" y="-5099.99" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_12_allgather_mlp&#45;&gt;layer_12_gelu -->
<g id="edge454" class="edge">
<title>layer_12_allgather_mlp&#45;&gt;layer_12_gelu</title>
<path fill="none" stroke="black" d="M1957.99,-5170.73C1955.07,-5161.85 1951.96,-5152.39 1949.14,-5143.82"/>
<polygon fill="black" stroke="black" points="1952.44,-5142.65 1945.99,-5134.25 1945.79,-5144.84 1952.44,-5142.65"/>
</g>
<!-- layer_12_mlp_fc2_gpu24 -->
<g id="node352" class="node">
<title>layer_12_mlp_fc2_gpu24</title>
<polygon fill="lightblue" stroke="black" points="1931,-5056.99 1832,-5056.99 1832,-5004.99 1931,-5004.99 1931,-5056.99"/>
<text text-anchor="middle" x="1881.5" y="-5044.99" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="1881.5" y="-5033.99" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="1881.5" y="-5022.99" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1881.5" y="-5011.99" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu24 -->
<g id="edge455" class="edge">
<title>layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu24</title>
<path fill="none" stroke="black" d="M1925.16,-5092.59C1919.26,-5084.39 1912.25,-5074.67 1905.59,-5065.43"/>
<polygon fill="black" stroke="black" points="1908.31,-5063.21 1899.62,-5057.15 1902.63,-5067.31 1908.31,-5063.21"/>
</g>
<!-- layer_12_allreduce_mlp -->
<g id="node356" class="node">
<title>layer_12_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="2115.5" cy="-4932.22" rx="60.21" ry="36.54"/>
<text text-anchor="middle" x="2115.5" y="-4946.22" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="2115.5" y="-4935.22" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="2115.5" y="-4924.22" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2115.5" y="-4913.22" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_12_mlp_fc2_gpu24&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge456" class="edge">
<title>layer_12_mlp_fc2_gpu24&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1931.06,-5008.94C1934.25,-5007.6 1937.42,-5006.28 1940.5,-5004.99 1979.15,-4988.88 2022.71,-4971.01 2056.71,-4957.14"/>
<polygon fill="black" stroke="black" points="2058.09,-4960.35 2066.03,-4953.33 2055.45,-4953.87 2058.09,-4960.35"/>
</g>
<!-- layer_12_mlp_fc2_gpu25 -->
<g id="node353" class="node">
<title>layer_12_mlp_fc2_gpu25</title>
<polygon fill="lightblue" stroke="black" points="2048,-5056.99 1949,-5056.99 1949,-5004.99 2048,-5004.99 2048,-5056.99"/>
<text text-anchor="middle" x="1998.5" y="-5044.99" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="1998.5" y="-5033.99" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="1998.5" y="-5022.99" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1998.5" y="-5011.99" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_mlp_fc2_gpu25&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge457" class="edge">
<title>layer_12_mlp_fc2_gpu25&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2028.93,-5004.82C2042.19,-4993.86 2057.96,-4980.81 2072.39,-4968.88"/>
<polygon fill="black" stroke="black" points="2074.77,-4971.45 2080.24,-4962.38 2070.31,-4966.06 2074.77,-4971.45"/>
</g>
<!-- layer_12_mlp_fc2_gpu26 -->
<g id="node354" class="node">
<title>layer_12_mlp_fc2_gpu26</title>
<polygon fill="lightblue" stroke="black" points="2165,-5056.99 2066,-5056.99 2066,-5004.99 2165,-5004.99 2165,-5056.99"/>
<text text-anchor="middle" x="2115.5" y="-5044.99" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="2115.5" y="-5033.99" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="2115.5" y="-5022.99" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2115.5" y="-5011.99" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_mlp_fc2_gpu26&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge458" class="edge">
<title>layer_12_mlp_fc2_gpu26&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2115.5,-5004.82C2115.5,-4997.01 2115.5,-4988.14 2115.5,-4979.38"/>
<polygon fill="black" stroke="black" points="2119,-4979.2 2115.5,-4969.2 2112,-4979.2 2119,-4979.2"/>
</g>
<!-- layer_12_mlp_fc2_gpu27 -->
<g id="node355" class="node">
<title>layer_12_mlp_fc2_gpu27</title>
<polygon fill="lightblue" stroke="black" points="2282,-5056.99 2183,-5056.99 2183,-5004.99 2282,-5004.99 2282,-5056.99"/>
<text text-anchor="middle" x="2232.5" y="-5044.99" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="2232.5" y="-5033.99" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="2232.5" y="-5022.99" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2232.5" y="-5011.99" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_mlp_fc2_gpu27&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge459" class="edge">
<title>layer_12_mlp_fc2_gpu27&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2202.07,-5004.82C2188.81,-4993.86 2173.04,-4980.81 2158.61,-4968.88"/>
<polygon fill="black" stroke="black" points="2160.69,-4966.06 2150.76,-4962.38 2156.23,-4971.45 2160.69,-4966.06"/>
</g>
<!-- layer_12_allreduce_mlp&#45;&gt;layer_12_residual2 -->
<g id="edge460" class="edge">
<title>layer_12_allreduce_mlp&#45;&gt;layer_12_residual2</title>
<path fill="none" stroke="black" d="M2143.04,-4899.49C2151.69,-4889.52 2161.45,-4878.28 2170.85,-4867.44"/>
<polygon fill="black" stroke="black" points="2173.71,-4869.49 2177.62,-4859.65 2168.42,-4864.9 2173.71,-4869.49"/>
</g>
<!-- layer_12_ln2 -->
<g id="node358" class="node">
<title>layer_12_ln2</title>
<polygon fill="lightblue" stroke="black" points="2249,-4741.45 2176,-4741.45 2176,-4689.45 2249,-4689.45 2249,-4741.45"/>
<text text-anchor="middle" x="2212.5" y="-4729.45" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="2212.5" y="-4718.45" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="2212.5" y="-4707.45" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="2212.5" y="-4696.45" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_12_residual2&#45;&gt;layer_12_ln2 -->
<g id="edge462" class="edge">
<title>layer_12_residual2&#45;&gt;layer_12_ln2</title>
<path fill="none" stroke="black" d="M2212.5,-4777.24C2212.5,-4768.81 2212.5,-4759.98 2212.5,-4751.74"/>
<polygon fill="black" stroke="black" points="2216,-4751.7 2212.5,-4741.7 2209,-4751.7 2216,-4751.7"/>
</g>
<!-- layer_13_input_dist -->
<g id="node359" class="node">
<title>layer_13_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="2306.69,-4653.45 2156.86,-4653.45 2118.31,-4571.45 2268.14,-4571.45 2306.69,-4653.45"/>
<text text-anchor="middle" x="2212.5" y="-4620.95" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="2212.5" y="-4609.95" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="2212.5" y="-4598.95" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_12_ln2&#45;&gt;layer_13_input_dist -->
<g id="edge463" class="edge">
<title>layer_12_ln2&#45;&gt;layer_13_input_dist</title>
<path fill="none" stroke="black" d="M2212.5,-4689.23C2212.5,-4681.5 2212.5,-4672.71 2212.5,-4663.92"/>
<polygon fill="black" stroke="black" points="2216,-4663.66 2212.5,-4653.66 2209,-4663.66 2216,-4663.66"/>
</g>
<!-- layer_13_qkv_gpu24 -->
<g id="node360" class="node">
<title>layer_13_qkv_gpu24</title>
<polygon fill="lightblue" stroke="black" points="2029.5,-4535.45 1931.5,-4535.45 1931.5,-4483.45 2029.5,-4483.45 2029.5,-4535.45"/>
<text text-anchor="middle" x="1980.5" y="-4523.45" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="1980.5" y="-4512.45" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="1980.5" y="-4501.45" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1980.5" y="-4490.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu24 -->
<g id="edge464" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu24</title>
<path fill="none" stroke="black" d="M2120.47,-4571.39C2092.99,-4559.42 2063.63,-4546.64 2038.93,-4535.89"/>
<polygon fill="black" stroke="black" points="2040.27,-4532.66 2029.71,-4531.87 2037.48,-4539.08 2040.27,-4532.66"/>
</g>
<!-- layer_13_qkv_gpu25 -->
<g id="node361" class="node">
<title>layer_13_qkv_gpu25</title>
<polygon fill="lightblue" stroke="black" points="2145.5,-4535.45 2047.5,-4535.45 2047.5,-4483.45 2145.5,-4483.45 2145.5,-4535.45"/>
<text text-anchor="middle" x="2096.5" y="-4523.45" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="2096.5" y="-4512.45" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="2096.5" y="-4501.45" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2096.5" y="-4490.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu25 -->
<g id="edge465" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu25</title>
<path fill="none" stroke="black" d="M2166.32,-4571.24C2155.34,-4561.69 2143.78,-4551.62 2133.29,-4542.48"/>
<polygon fill="black" stroke="black" points="2135.34,-4539.63 2125.5,-4535.7 2130.75,-4544.91 2135.34,-4539.63"/>
</g>
<!-- layer_13_qkv_gpu26 -->
<g id="node362" class="node">
<title>layer_13_qkv_gpu26</title>
<polygon fill="lightblue" stroke="black" points="2261.5,-4535.45 2163.5,-4535.45 2163.5,-4483.45 2261.5,-4483.45 2261.5,-4535.45"/>
<text text-anchor="middle" x="2212.5" y="-4523.45" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="2212.5" y="-4512.45" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="2212.5" y="-4501.45" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2212.5" y="-4490.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu26 -->
<g id="edge466" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu26</title>
<path fill="none" stroke="black" d="M2212.5,-4571.24C2212.5,-4562.81 2212.5,-4553.98 2212.5,-4545.74"/>
<polygon fill="black" stroke="black" points="2216,-4545.7 2212.5,-4535.7 2209,-4545.7 2216,-4545.7"/>
</g>
<!-- layer_13_qkv_gpu27 -->
<g id="node363" class="node">
<title>layer_13_qkv_gpu27</title>
<polygon fill="lightblue" stroke="black" points="2377.5,-4535.45 2279.5,-4535.45 2279.5,-4483.45 2377.5,-4483.45 2377.5,-4535.45"/>
<text text-anchor="middle" x="2328.5" y="-4523.45" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="2328.5" y="-4512.45" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="2328.5" y="-4501.45" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2328.5" y="-4490.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu27 -->
<g id="edge467" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu27</title>
<path fill="none" stroke="black" d="M2258.68,-4571.24C2269.66,-4561.69 2281.22,-4551.62 2291.71,-4542.48"/>
<polygon fill="black" stroke="black" points="2294.25,-4544.91 2299.5,-4535.7 2289.66,-4539.63 2294.25,-4544.91"/>
</g>
<!-- layer_13_residual1 -->
<g id="node371" class="node">
<title>layer_13_residual1</title>
<polygon fill="lightyellow" stroke="black" points="2414.44,-4052.37 2292.05,-4052.37 2260.56,-3970.37 2382.95,-3970.37 2414.44,-4052.37"/>
<text text-anchor="middle" x="2337.5" y="-4019.87" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="2337.5" y="-4008.87" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2337.5" y="-3997.87" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_residual1 -->
<g id="edge479" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_residual1</title>
<path fill="none" stroke="black" d="M2280.06,-4595.93C2315.92,-4584.57 2358.29,-4565.71 2386.5,-4535.45 2426.31,-4492.75 2430.5,-4470.06 2430.5,-4411.68 2430.5,-4411.68 2430.5,-4411.68 2430.5,-4222.91 2430.5,-4163.41 2399.03,-4101.9 2372.71,-4060.84"/>
<polygon fill="black" stroke="black" points="2375.59,-4058.85 2367.18,-4052.4 2369.73,-4062.68 2375.59,-4058.85"/>
</g>
<!-- layer_13_allgather_qkv -->
<g id="node364" class="node">
<title>layer_13_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="2096.5" cy="-4410.68" rx="57.05" ry="36.54"/>
<text text-anchor="middle" x="2096.5" y="-4424.68" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="2096.5" y="-4413.68" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="2096.5" y="-4402.68" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2096.5" y="-4391.68" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_13_qkv_gpu24&#45;&gt;layer_13_allgather_qkv -->
<g id="edge468" class="edge">
<title>layer_13_qkv_gpu24&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M2010.67,-4483.28C2023.93,-4472.22 2039.72,-4459.05 2054.13,-4447.03"/>
<polygon fill="black" stroke="black" points="2056.53,-4449.59 2061.96,-4440.49 2052.04,-4444.21 2056.53,-4449.59"/>
</g>
<!-- layer_13_qkv_gpu25&#45;&gt;layer_13_allgather_qkv -->
<g id="edge469" class="edge">
<title>layer_13_qkv_gpu25&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M2096.5,-4483.28C2096.5,-4475.47 2096.5,-4466.61 2096.5,-4457.84"/>
<polygon fill="black" stroke="black" points="2100,-4457.66 2096.5,-4447.66 2093,-4457.66 2100,-4457.66"/>
</g>
<!-- layer_13_qkv_gpu26&#45;&gt;layer_13_allgather_qkv -->
<g id="edge470" class="edge">
<title>layer_13_qkv_gpu26&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M2182.33,-4483.28C2169.07,-4472.22 2153.28,-4459.05 2138.87,-4447.03"/>
<polygon fill="black" stroke="black" points="2140.96,-4444.21 2131.04,-4440.49 2136.47,-4449.59 2140.96,-4444.21"/>
</g>
<!-- layer_13_qkv_gpu27&#45;&gt;layer_13_allgather_qkv -->
<g id="edge471" class="edge">
<title>layer_13_qkv_gpu27&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M2279.48,-4487.26C2276.44,-4485.96 2273.43,-4484.69 2270.5,-4483.45 2231.56,-4467.03 2187.55,-4448.88 2153.53,-4434.94"/>
<polygon fill="black" stroke="black" points="2154.8,-4431.68 2144.22,-4431.13 2152.15,-4438.16 2154.8,-4431.68"/>
</g>
<!-- layer_13_attention -->
<g id="node365" class="node">
<title>layer_13_attention</title>
<polygon fill="lightblue" stroke="black" points="2081.5,-4337.91 2013.5,-4337.91 2013.5,-4285.91 2081.5,-4285.91 2081.5,-4337.91"/>
<text text-anchor="middle" x="2047.5" y="-4325.91" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="2047.5" y="-4314.91" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="2047.5" y="-4303.91" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="2047.5" y="-4292.91" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_13_allgather_qkv&#45;&gt;layer_13_attention -->
<g id="edge472" class="edge">
<title>layer_13_allgather_qkv&#45;&gt;layer_13_attention</title>
<path fill="none" stroke="black" d="M2079.22,-4375.57C2074.6,-4366.44 2069.6,-4356.57 2064.97,-4347.42"/>
<polygon fill="black" stroke="black" points="2067.95,-4345.55 2060.31,-4338.21 2061.7,-4348.71 2067.95,-4345.55"/>
</g>
<!-- layer_13_attn_out_gpu24 -->
<g id="node366" class="node">
<title>layer_13_attn_out_gpu24</title>
<polygon fill="lightblue" stroke="black" points="2069,-4249.91 1976,-4249.91 1976,-4197.91 2069,-4197.91 2069,-4249.91"/>
<text text-anchor="middle" x="2022.5" y="-4237.91" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="2022.5" y="-4226.91" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="2022.5" y="-4215.91" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2022.5" y="-4204.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attention&#45;&gt;layer_13_attn_out_gpu24 -->
<g id="edge473" class="edge">
<title>layer_13_attention&#45;&gt;layer_13_attn_out_gpu24</title>
<path fill="none" stroke="black" d="M2040.13,-4285.58C2037.79,-4277.53 2035.16,-4268.48 2032.66,-4259.88"/>
<polygon fill="black" stroke="black" points="2035.97,-4258.69 2029.81,-4250.07 2029.24,-4260.65 2035.97,-4258.69"/>
</g>
<!-- layer_13_allreduce_attn -->
<g id="node370" class="node">
<title>layer_13_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="2244.5" cy="-4125.14" rx="57.97" ry="36.54"/>
<text text-anchor="middle" x="2244.5" y="-4139.14" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="2244.5" y="-4128.14" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="2244.5" y="-4117.14" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2244.5" y="-4106.14" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_13_attn_out_gpu24&#45;&gt;layer_13_allreduce_attn -->
<g id="edge474" class="edge">
<title>layer_13_attn_out_gpu24&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M2069.23,-4202C2072.37,-4200.61 2075.48,-4199.24 2078.5,-4197.91 2114.74,-4181.99 2155.54,-4164.35 2187.62,-4150.54"/>
<polygon fill="black" stroke="black" points="2189.05,-4153.73 2196.85,-4146.57 2186.28,-4147.3 2189.05,-4153.73"/>
</g>
<!-- layer_13_attn_out_gpu25 -->
<g id="node367" class="node">
<title>layer_13_attn_out_gpu25</title>
<polygon fill="lightblue" stroke="black" points="2180,-4249.91 2087,-4249.91 2087,-4197.91 2180,-4197.91 2180,-4249.91"/>
<text text-anchor="middle" x="2133.5" y="-4237.91" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="2133.5" y="-4226.91" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="2133.5" y="-4215.91" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2133.5" y="-4204.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attn_out_gpu25&#45;&gt;layer_13_allreduce_attn -->
<g id="edge475" class="edge">
<title>layer_13_attn_out_gpu25&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M2162.37,-4197.74C2174.83,-4186.88 2189.64,-4173.97 2203.22,-4162.13"/>
<polygon fill="black" stroke="black" points="2205.81,-4164.51 2211.05,-4155.3 2201.21,-4159.24 2205.81,-4164.51"/>
</g>
<!-- layer_13_attn_out_gpu26 -->
<g id="node368" class="node">
<title>layer_13_attn_out_gpu26</title>
<polygon fill="lightblue" stroke="black" points="2291,-4249.91 2198,-4249.91 2198,-4197.91 2291,-4197.91 2291,-4249.91"/>
<text text-anchor="middle" x="2244.5" y="-4237.91" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="2244.5" y="-4226.91" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="2244.5" y="-4215.91" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2244.5" y="-4204.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attn_out_gpu26&#45;&gt;layer_13_allreduce_attn -->
<g id="edge476" class="edge">
<title>layer_13_attn_out_gpu26&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M2244.5,-4197.74C2244.5,-4189.93 2244.5,-4181.07 2244.5,-4172.3"/>
<polygon fill="black" stroke="black" points="2248,-4172.12 2244.5,-4162.12 2241,-4172.12 2248,-4172.12"/>
</g>
<!-- layer_13_attn_out_gpu27 -->
<g id="node369" class="node">
<title>layer_13_attn_out_gpu27</title>
<polygon fill="lightblue" stroke="black" points="2402,-4249.91 2309,-4249.91 2309,-4197.91 2402,-4197.91 2402,-4249.91"/>
<text text-anchor="middle" x="2355.5" y="-4237.91" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="2355.5" y="-4226.91" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="2355.5" y="-4215.91" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2355.5" y="-4204.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attn_out_gpu27&#45;&gt;layer_13_allreduce_attn -->
<g id="edge477" class="edge">
<title>layer_13_attn_out_gpu27&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M2326.63,-4197.74C2314.17,-4186.88 2299.36,-4173.97 2285.78,-4162.13"/>
<polygon fill="black" stroke="black" points="2287.79,-4159.24 2277.95,-4155.3 2283.19,-4164.51 2287.79,-4159.24"/>
</g>
<!-- layer_13_allreduce_attn&#45;&gt;layer_13_residual1 -->
<g id="edge478" class="edge">
<title>layer_13_allreduce_attn&#45;&gt;layer_13_residual1</title>
<path fill="none" stroke="black" d="M2271.15,-4092.11C2279.36,-4082.25 2288.58,-4071.17 2297.48,-4060.47"/>
<polygon fill="black" stroke="black" points="2300.18,-4062.7 2303.88,-4052.78 2294.79,-4058.23 2300.18,-4062.7"/>
</g>
<!-- layer_13_ln1 -->
<g id="node372" class="node">
<title>layer_13_ln1</title>
<polygon fill="lightblue" stroke="black" points="2277,-3934.37 2204,-3934.37 2204,-3882.37 2277,-3882.37 2277,-3934.37"/>
<text text-anchor="middle" x="2240.5" y="-3922.37" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="2240.5" y="-3911.37" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="2240.5" y="-3900.37" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="2240.5" y="-3889.37" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_13_residual1&#45;&gt;layer_13_ln1 -->
<g id="edge480" class="edge">
<title>layer_13_residual1&#45;&gt;layer_13_ln1</title>
<path fill="none" stroke="black" d="M2298.88,-3970.17C2289.89,-3960.8 2280.41,-3950.93 2271.78,-3941.94"/>
<polygon fill="black" stroke="black" points="2274.2,-3939.41 2264.75,-3934.63 2269.15,-3944.26 2274.2,-3939.41"/>
</g>
<!-- layer_13_residual2 -->
<g id="node384" class="node">
<title>layer_13_residual2</title>
<polygon fill="lightyellow" stroke="black" points="2443.44,-3374.3 2321.05,-3374.3 2289.56,-3292.3 2411.95,-3292.3 2443.44,-3374.3"/>
<text text-anchor="middle" x="2366.5" y="-3341.8" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="2366.5" y="-3330.8" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2366.5" y="-3319.8" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_13_residual1&#45;&gt;layer_13_residual2 -->
<g id="edge496" class="edge">
<title>layer_13_residual1&#45;&gt;layer_13_residual2</title>
<path fill="none" stroke="black" d="M2383.71,-3971.54C2420.02,-3936.46 2464.5,-3881.27 2464.5,-3821.37 2464.5,-3821.37 2464.5,-3821.37 2464.5,-3544.83 2464.5,-3484.99 2431.55,-3423.76 2403.86,-3382.87"/>
<polygon fill="black" stroke="black" points="2406.61,-3380.69 2398.05,-3374.46 2400.86,-3384.68 2406.61,-3380.69"/>
</g>
<!-- layer_13_mlp_fc1_gpu24 -->
<g id="node373" class="node">
<title>layer_13_mlp_fc1_gpu24</title>
<polygon fill="lightblue" stroke="black" points="2056,-3846.37 1957,-3846.37 1957,-3794.37 2056,-3794.37 2056,-3846.37"/>
<text text-anchor="middle" x="2006.5" y="-3834.37" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="2006.5" y="-3823.37" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="2006.5" y="-3812.37" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2006.5" y="-3801.37" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu24 -->
<g id="edge481" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu24</title>
<path fill="none" stroke="black" d="M2203.71,-3895.33C2170.14,-3884.17 2118.99,-3866.73 2065.88,-3846.43"/>
<polygon fill="black" stroke="black" points="2066.89,-3843.07 2056.3,-3842.75 2064.38,-3849.6 2066.89,-3843.07"/>
</g>
<!-- layer_13_mlp_fc1_gpu25 -->
<g id="node374" class="node">
<title>layer_13_mlp_fc1_gpu25</title>
<polygon fill="lightblue" stroke="black" points="2173,-3846.37 2074,-3846.37 2074,-3794.37 2173,-3794.37 2173,-3846.37"/>
<text text-anchor="middle" x="2123.5" y="-3834.37" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="2123.5" y="-3823.37" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="2123.5" y="-3812.37" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2123.5" y="-3801.37" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu25 -->
<g id="edge482" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu25</title>
<path fill="none" stroke="black" d="M2206.34,-3882.27C2193.72,-3872.99 2179.26,-3862.36 2165.98,-3852.6"/>
<polygon fill="black" stroke="black" points="2168.03,-3849.76 2157.9,-3846.66 2163.89,-3855.4 2168.03,-3849.76"/>
</g>
<!-- layer_13_mlp_fc1_gpu26 -->
<g id="node375" class="node">
<title>layer_13_mlp_fc1_gpu26</title>
<polygon fill="lightblue" stroke="black" points="2290,-3846.37 2191,-3846.37 2191,-3794.37 2290,-3794.37 2290,-3846.37"/>
<text text-anchor="middle" x="2240.5" y="-3834.37" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="2240.5" y="-3823.37" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="2240.5" y="-3812.37" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2240.5" y="-3801.37" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu26 -->
<g id="edge483" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu26</title>
<path fill="none" stroke="black" d="M2240.5,-3882.04C2240.5,-3874.08 2240.5,-3865.14 2240.5,-3856.62"/>
<polygon fill="black" stroke="black" points="2244,-3856.53 2240.5,-3846.53 2237,-3856.53 2244,-3856.53"/>
</g>
<!-- layer_13_mlp_fc1_gpu27 -->
<g id="node376" class="node">
<title>layer_13_mlp_fc1_gpu27</title>
<polygon fill="lightblue" stroke="black" points="2407,-3846.37 2308,-3846.37 2308,-3794.37 2407,-3794.37 2407,-3846.37"/>
<text text-anchor="middle" x="2357.5" y="-3834.37" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="2357.5" y="-3823.37" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="2357.5" y="-3812.37" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2357.5" y="-3801.37" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu27 -->
<g id="edge484" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu27</title>
<path fill="none" stroke="black" d="M2274.66,-3882.27C2287.28,-3872.99 2301.74,-3862.36 2315.02,-3852.6"/>
<polygon fill="black" stroke="black" points="2317.11,-3855.4 2323.1,-3846.66 2312.97,-3849.76 2317.11,-3855.4"/>
</g>
<!-- layer_13_allgather_mlp -->
<g id="node377" class="node">
<title>layer_13_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="2123.5" cy="-3721.6" rx="56.64" ry="36.54"/>
<text text-anchor="middle" x="2123.5" y="-3735.6" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="2123.5" y="-3724.6" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="2123.5" y="-3713.6" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2123.5" y="-3702.6" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_13_mlp_fc1_gpu24&#45;&gt;layer_13_allgather_mlp -->
<g id="edge485" class="edge">
<title>layer_13_mlp_fc1_gpu24&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M2036.93,-3794.2C2050.42,-3783.05 2066.51,-3769.74 2081.13,-3757.64"/>
<polygon fill="black" stroke="black" points="2083.61,-3760.14 2089.09,-3751.07 2079.15,-3754.74 2083.61,-3760.14"/>
</g>
<!-- layer_13_mlp_fc1_gpu25&#45;&gt;layer_13_allgather_mlp -->
<g id="edge486" class="edge">
<title>layer_13_mlp_fc1_gpu25&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M2123.5,-3794.2C2123.5,-3786.39 2123.5,-3777.53 2123.5,-3768.76"/>
<polygon fill="black" stroke="black" points="2127,-3768.58 2123.5,-3758.58 2120,-3768.58 2127,-3768.58"/>
</g>
<!-- layer_13_mlp_fc1_gpu26&#45;&gt;layer_13_allgather_mlp -->
<g id="edge487" class="edge">
<title>layer_13_mlp_fc1_gpu26&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M2210.07,-3794.2C2196.58,-3783.05 2180.49,-3769.74 2165.87,-3757.64"/>
<polygon fill="black" stroke="black" points="2167.85,-3754.74 2157.91,-3751.07 2163.39,-3760.14 2167.85,-3754.74"/>
</g>
<!-- layer_13_mlp_fc1_gpu27&#45;&gt;layer_13_allgather_mlp -->
<g id="edge488" class="edge">
<title>layer_13_mlp_fc1_gpu27&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M2307.85,-3797.9C2305.03,-3796.7 2302.23,-3795.52 2299.5,-3794.37 2259.86,-3777.75 2215,-3759.46 2180.49,-3745.51"/>
<polygon fill="black" stroke="black" points="2181.62,-3742.19 2171.04,-3741.69 2179,-3748.68 2181.62,-3742.19"/>
</g>
<!-- layer_13_gelu -->
<g id="node378" class="node">
<title>layer_13_gelu</title>
<polygon fill="lightblue" stroke="black" points="2110,-3648.83 2021,-3648.83 2021,-3607.83 2110,-3607.83 2110,-3648.83"/>
<text text-anchor="middle" x="2065.5" y="-3636.83" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="2065.5" y="-3625.83" font-family="Arial" font-size="10.00">GELU Activation</text>
<text text-anchor="middle" x="2065.5" y="-3614.83" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_13_allgather_mlp&#45;&gt;layer_13_gelu -->
<g id="edge489" class="edge">
<title>layer_13_allgather_mlp&#45;&gt;layer_13_gelu</title>
<path fill="none" stroke="black" d="M2102.4,-3687.4C2096.16,-3677.58 2089.4,-3666.94 2083.39,-3657.49"/>
<polygon fill="black" stroke="black" points="2086.21,-3655.41 2077.9,-3648.84 2080.31,-3659.16 2086.21,-3655.41"/>
</g>
<!-- layer_13_mlp_fc2_gpu24 -->
<g id="node379" class="node">
<title>layer_13_mlp_fc2_gpu24</title>
<polygon fill="lightblue" stroke="black" points="2085,-3571.83 1986,-3571.83 1986,-3519.83 2085,-3519.83 2085,-3571.83"/>
<text text-anchor="middle" x="2035.5" y="-3559.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="2035.5" y="-3548.83" font-family="Arial" font-size="10.00">GPU 24</text>
<text text-anchor="middle" x="2035.5" y="-3537.83" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2035.5" y="-3526.83" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu24 -->
<g id="edge490" class="edge">
<title>layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu24</title>
<path fill="none" stroke="black" d="M2058.08,-3607.44C2055.15,-3599.57 2051.7,-3590.3 2048.38,-3581.41"/>
<polygon fill="black" stroke="black" points="2051.65,-3580.14 2044.87,-3571.99 2045.09,-3582.58 2051.65,-3580.14"/>
</g>
<!-- layer_13_allreduce_mlp -->
<g id="node383" class="node">
<title>layer_13_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="2269.5" cy="-3447.07" rx="60.21" ry="36.54"/>
<text text-anchor="middle" x="2269.5" y="-3461.07" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="2269.5" y="-3450.07" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="2269.5" y="-3439.07" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2269.5" y="-3428.07" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_13_mlp_fc2_gpu24&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge491" class="edge">
<title>layer_13_mlp_fc2_gpu24&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2085.06,-3523.79C2088.25,-3522.45 2091.42,-3521.12 2094.5,-3519.83 2133.15,-3503.72 2176.71,-3485.86 2210.71,-3471.98"/>
<polygon fill="black" stroke="black" points="2212.09,-3475.19 2220.03,-3468.18 2209.45,-3468.71 2212.09,-3475.19"/>
</g>
<!-- layer_13_mlp_fc2_gpu25 -->
<g id="node380" class="node">
<title>layer_13_mlp_fc2_gpu25</title>
<polygon fill="lightblue" stroke="black" points="2202,-3571.83 2103,-3571.83 2103,-3519.83 2202,-3519.83 2202,-3571.83"/>
<text text-anchor="middle" x="2152.5" y="-3559.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="2152.5" y="-3548.83" font-family="Arial" font-size="10.00">GPU 25</text>
<text text-anchor="middle" x="2152.5" y="-3537.83" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2152.5" y="-3526.83" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_mlp_fc2_gpu25&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge492" class="edge">
<title>layer_13_mlp_fc2_gpu25&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2182.93,-3519.66C2196.19,-3508.7 2211.96,-3495.65 2226.39,-3483.72"/>
<polygon fill="black" stroke="black" points="2228.77,-3486.3 2234.24,-3477.23 2224.31,-3480.9 2228.77,-3486.3"/>
</g>
<!-- layer_13_mlp_fc2_gpu26 -->
<g id="node381" class="node">
<title>layer_13_mlp_fc2_gpu26</title>
<polygon fill="lightblue" stroke="black" points="2319,-3571.83 2220,-3571.83 2220,-3519.83 2319,-3519.83 2319,-3571.83"/>
<text text-anchor="middle" x="2269.5" y="-3559.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="2269.5" y="-3548.83" font-family="Arial" font-size="10.00">GPU 26</text>
<text text-anchor="middle" x="2269.5" y="-3537.83" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2269.5" y="-3526.83" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_mlp_fc2_gpu26&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge493" class="edge">
<title>layer_13_mlp_fc2_gpu26&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2269.5,-3519.66C2269.5,-3511.85 2269.5,-3502.99 2269.5,-3494.22"/>
<polygon fill="black" stroke="black" points="2273,-3494.04 2269.5,-3484.04 2266,-3494.04 2273,-3494.04"/>
</g>
<!-- layer_13_mlp_fc2_gpu27 -->
<g id="node382" class="node">
<title>layer_13_mlp_fc2_gpu27</title>
<polygon fill="lightblue" stroke="black" points="2436,-3571.83 2337,-3571.83 2337,-3519.83 2436,-3519.83 2436,-3571.83"/>
<text text-anchor="middle" x="2386.5" y="-3559.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="2386.5" y="-3548.83" font-family="Arial" font-size="10.00">GPU 27</text>
<text text-anchor="middle" x="2386.5" y="-3537.83" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2386.5" y="-3526.83" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_mlp_fc2_gpu27&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge494" class="edge">
<title>layer_13_mlp_fc2_gpu27&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2356.07,-3519.66C2342.81,-3508.7 2327.04,-3495.65 2312.61,-3483.72"/>
<polygon fill="black" stroke="black" points="2314.69,-3480.9 2304.76,-3477.23 2310.23,-3486.3 2314.69,-3480.9"/>
</g>
<!-- layer_13_allreduce_mlp&#45;&gt;layer_13_residual2 -->
<g id="edge495" class="edge">
<title>layer_13_allreduce_mlp&#45;&gt;layer_13_residual2</title>
<path fill="none" stroke="black" d="M2297.04,-3414.34C2305.69,-3404.36 2315.45,-3393.12 2324.85,-3382.29"/>
<polygon fill="black" stroke="black" points="2327.71,-3384.34 2331.62,-3374.49 2322.42,-3379.75 2327.71,-3384.34"/>
</g>
<!-- layer_13_ln2 -->
<g id="node385" class="node">
<title>layer_13_ln2</title>
<polygon fill="lightblue" stroke="black" points="2403,-3256.3 2330,-3256.3 2330,-3204.3 2403,-3204.3 2403,-3256.3"/>
<text text-anchor="middle" x="2366.5" y="-3244.3" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="2366.5" y="-3233.3" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="2366.5" y="-3222.3" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="2366.5" y="-3211.3" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- layer_13_residual2&#45;&gt;layer_13_ln2 -->
<g id="edge497" class="edge">
<title>layer_13_residual2&#45;&gt;layer_13_ln2</title>
<path fill="none" stroke="black" d="M2366.5,-3292.09C2366.5,-3283.66 2366.5,-3274.82 2366.5,-3266.59"/>
<polygon fill="black" stroke="black" points="2370,-3266.55 2366.5,-3256.55 2363,-3266.55 2370,-3266.55"/>
</g>
<!-- layer_13_to_gpu7 -->
<g id="node386" class="node">
<title>layer_13_to_gpu7</title>
<ellipse fill="purple" stroke="black" cx="2366.5" cy="-3139.3" rx="58.88" ry="28.98"/>
<text text-anchor="middle" x="2366.5" y="-3147.8" font-family="Arial" font-size="10.00">Layer 13→14</text>
<text text-anchor="middle" x="2366.5" y="-3136.8" font-family="Arial" font-size="10.00">Pipeline Comm</text>
<text text-anchor="middle" x="2366.5" y="-3125.8" font-family="Arial" font-size="10.00">GPU 6→7</text>
</g>
<!-- layer_13_ln2&#45;&gt;layer_13_to_gpu7 -->
<g id="edge498" class="edge">
<title>layer_13_ln2&#45;&gt;layer_13_to_gpu7</title>
<path fill="none" stroke="black" d="M2366.5,-3204.03C2366.5,-3196.14 2366.5,-3187.25 2366.5,-3178.67"/>
<polygon fill="black" stroke="black" points="2370,-3178.45 2366.5,-3168.45 2363,-3178.45 2370,-3178.45"/>
</g>
<!-- layer_14_input_dist -->
<g id="node387" class="node">
<title>layer_14_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="2460.69,-3074.31 2310.86,-3074.31 2272.31,-2992.31 2422.14,-2992.31 2460.69,-3074.31"/>
<text text-anchor="middle" x="2366.5" y="-3041.81" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="2366.5" y="-3030.81" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="2366.5" y="-3019.81" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_13_to_gpu7&#45;&gt;layer_14_input_dist -->
<g id="edge499" class="edge">
<title>layer_13_to_gpu7&#45;&gt;layer_14_input_dist</title>
<path fill="none" stroke="black" d="M2366.5,-3110.16C2366.5,-3102.29 2366.5,-3093.5 2366.5,-3084.75"/>
<polygon fill="black" stroke="black" points="2370,-3084.58 2366.5,-3074.58 2363,-3084.58 2370,-3084.58"/>
</g>
<!-- layer_14_qkv_gpu28 -->
<g id="node388" class="node">
<title>layer_14_qkv_gpu28</title>
<polygon fill="lightblue" stroke="black" points="2183.5,-2956.31 2085.5,-2956.31 2085.5,-2904.31 2183.5,-2904.31 2183.5,-2956.31"/>
<text text-anchor="middle" x="2134.5" y="-2944.31" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="2134.5" y="-2933.31" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="2134.5" y="-2922.31" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2134.5" y="-2911.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu28 -->
<g id="edge500" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu28</title>
<path fill="none" stroke="black" d="M2274.47,-2992.25C2246.99,-2980.28 2217.63,-2967.5 2192.93,-2956.75"/>
<polygon fill="black" stroke="black" points="2194.27,-2953.52 2183.71,-2952.74 2191.48,-2959.94 2194.27,-2953.52"/>
</g>
<!-- layer_14_qkv_gpu29 -->
<g id="node389" class="node">
<title>layer_14_qkv_gpu29</title>
<polygon fill="lightblue" stroke="black" points="2299.5,-2956.31 2201.5,-2956.31 2201.5,-2904.31 2299.5,-2904.31 2299.5,-2956.31"/>
<text text-anchor="middle" x="2250.5" y="-2944.31" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="2250.5" y="-2933.31" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="2250.5" y="-2922.31" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2250.5" y="-2911.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu29 -->
<g id="edge501" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu29</title>
<path fill="none" stroke="black" d="M2320.32,-2992.1C2309.34,-2982.55 2297.78,-2972.48 2287.29,-2963.34"/>
<polygon fill="black" stroke="black" points="2289.34,-2960.49 2279.5,-2956.56 2284.75,-2965.77 2289.34,-2960.49"/>
</g>
<!-- layer_14_qkv_gpu30 -->
<g id="node390" class="node">
<title>layer_14_qkv_gpu30</title>
<polygon fill="lightblue" stroke="black" points="2415.5,-2956.31 2317.5,-2956.31 2317.5,-2904.31 2415.5,-2904.31 2415.5,-2956.31"/>
<text text-anchor="middle" x="2366.5" y="-2944.31" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="2366.5" y="-2933.31" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="2366.5" y="-2922.31" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2366.5" y="-2911.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu30 -->
<g id="edge502" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu30</title>
<path fill="none" stroke="black" d="M2366.5,-2992.1C2366.5,-2983.67 2366.5,-2974.84 2366.5,-2966.6"/>
<polygon fill="black" stroke="black" points="2370,-2966.56 2366.5,-2956.56 2363,-2966.56 2370,-2966.56"/>
</g>
<!-- layer_14_qkv_gpu31 -->
<g id="node391" class="node">
<title>layer_14_qkv_gpu31</title>
<polygon fill="lightblue" stroke="black" points="2531.5,-2956.31 2433.5,-2956.31 2433.5,-2904.31 2531.5,-2904.31 2531.5,-2956.31"/>
<text text-anchor="middle" x="2482.5" y="-2944.31" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="2482.5" y="-2933.31" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="2482.5" y="-2922.31" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2482.5" y="-2911.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu31 -->
<g id="edge503" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu31</title>
<path fill="none" stroke="black" d="M2412.68,-2992.1C2423.66,-2982.55 2435.22,-2972.48 2445.71,-2963.34"/>
<polygon fill="black" stroke="black" points="2448.25,-2965.77 2453.5,-2956.56 2443.66,-2960.49 2448.25,-2965.77"/>
</g>
<!-- layer_14_residual1 -->
<g id="node399" class="node">
<title>layer_14_residual1</title>
<polygon fill="lightyellow" stroke="black" points="2568.44,-2473.23 2446.05,-2473.23 2414.56,-2391.23 2536.95,-2391.23 2568.44,-2473.23"/>
<text text-anchor="middle" x="2491.5" y="-2440.73" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="2491.5" y="-2429.73" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2491.5" y="-2418.73" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_residual1 -->
<g id="edge515" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_residual1</title>
<path fill="none" stroke="black" d="M2434.06,-3016.79C2469.92,-3005.43 2512.29,-2986.58 2540.5,-2956.31 2580.31,-2913.61 2584.5,-2890.92 2584.5,-2832.54 2584.5,-2832.54 2584.5,-2832.54 2584.5,-2643.77 2584.5,-2584.27 2553.03,-2522.76 2526.71,-2481.7"/>
<polygon fill="black" stroke="black" points="2529.59,-2479.71 2521.18,-2473.26 2523.73,-2483.54 2529.59,-2479.71"/>
</g>
<!-- layer_14_allgather_qkv -->
<g id="node392" class="node">
<title>layer_14_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="2250.5" cy="-2831.54" rx="57.05" ry="36.54"/>
<text text-anchor="middle" x="2250.5" y="-2845.54" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="2250.5" y="-2834.54" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="2250.5" y="-2823.54" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2250.5" y="-2812.54" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_14_qkv_gpu28&#45;&gt;layer_14_allgather_qkv -->
<g id="edge504" class="edge">
<title>layer_14_qkv_gpu28&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M2164.67,-2904.14C2177.93,-2893.08 2193.72,-2879.91 2208.13,-2867.89"/>
<polygon fill="black" stroke="black" points="2210.53,-2870.45 2215.96,-2861.36 2206.04,-2865.07 2210.53,-2870.45"/>
</g>
<!-- layer_14_qkv_gpu29&#45;&gt;layer_14_allgather_qkv -->
<g id="edge505" class="edge">
<title>layer_14_qkv_gpu29&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M2250.5,-2904.14C2250.5,-2896.33 2250.5,-2887.47 2250.5,-2878.7"/>
<polygon fill="black" stroke="black" points="2254,-2878.52 2250.5,-2868.52 2247,-2878.52 2254,-2878.52"/>
</g>
<!-- layer_14_qkv_gpu30&#45;&gt;layer_14_allgather_qkv -->
<g id="edge506" class="edge">
<title>layer_14_qkv_gpu30&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M2336.33,-2904.14C2323.07,-2893.08 2307.28,-2879.91 2292.87,-2867.89"/>
<polygon fill="black" stroke="black" points="2294.96,-2865.07 2285.04,-2861.36 2290.47,-2870.45 2294.96,-2865.07"/>
</g>
<!-- layer_14_qkv_gpu31&#45;&gt;layer_14_allgather_qkv -->
<g id="edge507" class="edge">
<title>layer_14_qkv_gpu31&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M2433.48,-2908.12C2430.44,-2906.82 2427.43,-2905.55 2424.5,-2904.31 2385.56,-2887.89 2341.55,-2869.74 2307.53,-2855.8"/>
<polygon fill="black" stroke="black" points="2308.8,-2852.54 2298.22,-2851.99 2306.15,-2859.02 2308.8,-2852.54"/>
</g>
<!-- layer_14_attention -->
<g id="node393" class="node">
<title>layer_14_attention</title>
<polygon fill="lightblue" stroke="black" points="2235.5,-2758.77 2167.5,-2758.77 2167.5,-2706.77 2235.5,-2706.77 2235.5,-2758.77"/>
<text text-anchor="middle" x="2201.5" y="-2746.77" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="2201.5" y="-2735.77" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="2201.5" y="-2724.77" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="2201.5" y="-2713.77" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_14_allgather_qkv&#45;&gt;layer_14_attention -->
<g id="edge508" class="edge">
<title>layer_14_allgather_qkv&#45;&gt;layer_14_attention</title>
<path fill="none" stroke="black" d="M2233.22,-2796.43C2228.6,-2787.3 2223.6,-2777.43 2218.97,-2768.28"/>
<polygon fill="black" stroke="black" points="2221.95,-2766.41 2214.31,-2759.07 2215.7,-2769.57 2221.95,-2766.41"/>
</g>
<!-- layer_14_attn_out_gpu28 -->
<g id="node394" class="node">
<title>layer_14_attn_out_gpu28</title>
<polygon fill="lightblue" stroke="black" points="2223,-2670.77 2130,-2670.77 2130,-2618.77 2223,-2618.77 2223,-2670.77"/>
<text text-anchor="middle" x="2176.5" y="-2658.77" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="2176.5" y="-2647.77" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="2176.5" y="-2636.77" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2176.5" y="-2625.77" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attention&#45;&gt;layer_14_attn_out_gpu28 -->
<g id="edge509" class="edge">
<title>layer_14_attention&#45;&gt;layer_14_attn_out_gpu28</title>
<path fill="none" stroke="black" d="M2194.13,-2706.44C2191.79,-2698.39 2189.16,-2689.34 2186.66,-2680.74"/>
<polygon fill="black" stroke="black" points="2189.97,-2679.56 2183.81,-2670.93 2183.24,-2681.51 2189.97,-2679.56"/>
</g>
<!-- layer_14_allreduce_attn -->
<g id="node398" class="node">
<title>layer_14_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="2398.5" cy="-2546" rx="57.97" ry="36.54"/>
<text text-anchor="middle" x="2398.5" y="-2560" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="2398.5" y="-2549" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="2398.5" y="-2538" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2398.5" y="-2527" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_14_attn_out_gpu28&#45;&gt;layer_14_allreduce_attn -->
<g id="edge510" class="edge">
<title>layer_14_attn_out_gpu28&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M2223.23,-2622.86C2226.37,-2621.47 2229.48,-2620.1 2232.5,-2618.77 2268.74,-2602.85 2309.54,-2585.21 2341.62,-2571.4"/>
<polygon fill="black" stroke="black" points="2343.05,-2574.6 2350.85,-2567.43 2340.28,-2568.16 2343.05,-2574.6"/>
</g>
<!-- layer_14_attn_out_gpu29 -->
<g id="node395" class="node">
<title>layer_14_attn_out_gpu29</title>
<polygon fill="lightblue" stroke="black" points="2334,-2670.77 2241,-2670.77 2241,-2618.77 2334,-2618.77 2334,-2670.77"/>
<text text-anchor="middle" x="2287.5" y="-2658.77" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="2287.5" y="-2647.77" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="2287.5" y="-2636.77" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2287.5" y="-2625.77" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attn_out_gpu29&#45;&gt;layer_14_allreduce_attn -->
<g id="edge511" class="edge">
<title>layer_14_attn_out_gpu29&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M2316.37,-2618.6C2328.83,-2607.74 2343.64,-2594.84 2357.22,-2582.99"/>
<polygon fill="black" stroke="black" points="2359.81,-2585.37 2365.05,-2576.17 2355.21,-2580.1 2359.81,-2585.37"/>
</g>
<!-- layer_14_attn_out_gpu30 -->
<g id="node396" class="node">
<title>layer_14_attn_out_gpu30</title>
<polygon fill="lightblue" stroke="black" points="2445,-2670.77 2352,-2670.77 2352,-2618.77 2445,-2618.77 2445,-2670.77"/>
<text text-anchor="middle" x="2398.5" y="-2658.77" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="2398.5" y="-2647.77" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="2398.5" y="-2636.77" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2398.5" y="-2625.77" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attn_out_gpu30&#45;&gt;layer_14_allreduce_attn -->
<g id="edge512" class="edge">
<title>layer_14_attn_out_gpu30&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M2398.5,-2618.6C2398.5,-2610.79 2398.5,-2601.93 2398.5,-2593.16"/>
<polygon fill="black" stroke="black" points="2402,-2592.98 2398.5,-2582.98 2395,-2592.98 2402,-2592.98"/>
</g>
<!-- layer_14_attn_out_gpu31 -->
<g id="node397" class="node">
<title>layer_14_attn_out_gpu31</title>
<polygon fill="lightblue" stroke="black" points="2556,-2670.77 2463,-2670.77 2463,-2618.77 2556,-2618.77 2556,-2670.77"/>
<text text-anchor="middle" x="2509.5" y="-2658.77" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="2509.5" y="-2647.77" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="2509.5" y="-2636.77" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2509.5" y="-2625.77" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attn_out_gpu31&#45;&gt;layer_14_allreduce_attn -->
<g id="edge513" class="edge">
<title>layer_14_attn_out_gpu31&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M2480.63,-2618.6C2468.17,-2607.74 2453.36,-2594.84 2439.78,-2582.99"/>
<polygon fill="black" stroke="black" points="2441.79,-2580.1 2431.95,-2576.17 2437.19,-2585.37 2441.79,-2580.1"/>
</g>
<!-- layer_14_allreduce_attn&#45;&gt;layer_14_residual1 -->
<g id="edge514" class="edge">
<title>layer_14_allreduce_attn&#45;&gt;layer_14_residual1</title>
<path fill="none" stroke="black" d="M2425.15,-2512.98C2433.36,-2503.11 2442.58,-2492.03 2451.48,-2481.34"/>
<polygon fill="black" stroke="black" points="2454.18,-2483.56 2457.88,-2473.64 2448.79,-2479.09 2454.18,-2483.56"/>
</g>
<!-- layer_14_ln1 -->
<g id="node400" class="node">
<title>layer_14_ln1</title>
<polygon fill="lightblue" stroke="black" points="2431,-2355.23 2358,-2355.23 2358,-2303.23 2431,-2303.23 2431,-2355.23"/>
<text text-anchor="middle" x="2394.5" y="-2343.23" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="2394.5" y="-2332.23" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="2394.5" y="-2321.23" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="2394.5" y="-2310.23" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_14_residual1&#45;&gt;layer_14_ln1 -->
<g id="edge516" class="edge">
<title>layer_14_residual1&#45;&gt;layer_14_ln1</title>
<path fill="none" stroke="black" d="M2452.88,-2391.03C2443.89,-2381.66 2434.41,-2371.79 2425.78,-2362.8"/>
<polygon fill="black" stroke="black" points="2428.2,-2360.27 2418.75,-2355.49 2423.15,-2365.12 2428.2,-2360.27"/>
</g>
<!-- layer_14_residual2 -->
<g id="node412" class="node">
<title>layer_14_residual2</title>
<polygon fill="lightyellow" stroke="black" points="2597.44,-1795.16 2475.05,-1795.16 2443.56,-1713.16 2565.95,-1713.16 2597.44,-1795.16"/>
<text text-anchor="middle" x="2520.5" y="-1762.66" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="2520.5" y="-1751.66" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2520.5" y="-1740.66" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_14_residual1&#45;&gt;layer_14_residual2 -->
<g id="edge532" class="edge">
<title>layer_14_residual1&#45;&gt;layer_14_residual2</title>
<path fill="none" stroke="black" d="M2537.71,-2392.41C2574.02,-2357.32 2618.5,-2302.13 2618.5,-2242.23 2618.5,-2242.23 2618.5,-2242.23 2618.5,-1965.7 2618.5,-1905.85 2585.55,-1844.62 2557.86,-1803.73"/>
<polygon fill="black" stroke="black" points="2560.61,-1801.55 2552.05,-1795.32 2554.86,-1805.54 2560.61,-1801.55"/>
</g>
<!-- layer_14_mlp_fc1_gpu28 -->
<g id="node401" class="node">
<title>layer_14_mlp_fc1_gpu28</title>
<polygon fill="lightblue" stroke="black" points="2210,-2267.23 2111,-2267.23 2111,-2215.23 2210,-2215.23 2210,-2267.23"/>
<text text-anchor="middle" x="2160.5" y="-2255.23" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="2160.5" y="-2244.23" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="2160.5" y="-2233.23" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2160.5" y="-2222.23" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu28 -->
<g id="edge517" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu28</title>
<path fill="none" stroke="black" d="M2357.71,-2316.19C2324.14,-2305.03 2272.99,-2287.59 2219.88,-2267.29"/>
<polygon fill="black" stroke="black" points="2220.89,-2263.93 2210.3,-2263.61 2218.38,-2270.46 2220.89,-2263.93"/>
</g>
<!-- layer_14_mlp_fc1_gpu29 -->
<g id="node402" class="node">
<title>layer_14_mlp_fc1_gpu29</title>
<polygon fill="lightblue" stroke="black" points="2327,-2267.23 2228,-2267.23 2228,-2215.23 2327,-2215.23 2327,-2267.23"/>
<text text-anchor="middle" x="2277.5" y="-2255.23" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="2277.5" y="-2244.23" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="2277.5" y="-2233.23" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2277.5" y="-2222.23" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu29 -->
<g id="edge518" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu29</title>
<path fill="none" stroke="black" d="M2360.34,-2303.13C2347.72,-2293.85 2333.26,-2283.22 2319.98,-2273.46"/>
<polygon fill="black" stroke="black" points="2322.03,-2270.62 2311.9,-2267.52 2317.89,-2276.26 2322.03,-2270.62"/>
</g>
<!-- layer_14_mlp_fc1_gpu30 -->
<g id="node403" class="node">
<title>layer_14_mlp_fc1_gpu30</title>
<polygon fill="lightblue" stroke="black" points="2444,-2267.23 2345,-2267.23 2345,-2215.23 2444,-2215.23 2444,-2267.23"/>
<text text-anchor="middle" x="2394.5" y="-2255.23" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="2394.5" y="-2244.23" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="2394.5" y="-2233.23" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2394.5" y="-2222.23" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu30 -->
<g id="edge519" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu30</title>
<path fill="none" stroke="black" d="M2394.5,-2302.9C2394.5,-2294.94 2394.5,-2286 2394.5,-2277.48"/>
<polygon fill="black" stroke="black" points="2398,-2277.39 2394.5,-2267.39 2391,-2277.39 2398,-2277.39"/>
</g>
<!-- layer_14_mlp_fc1_gpu31 -->
<g id="node404" class="node">
<title>layer_14_mlp_fc1_gpu31</title>
<polygon fill="lightblue" stroke="black" points="2561,-2267.23 2462,-2267.23 2462,-2215.23 2561,-2215.23 2561,-2267.23"/>
<text text-anchor="middle" x="2511.5" y="-2255.23" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="2511.5" y="-2244.23" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="2511.5" y="-2233.23" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2511.5" y="-2222.23" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu31 -->
<g id="edge520" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu31</title>
<path fill="none" stroke="black" d="M2428.66,-2303.13C2441.28,-2293.85 2455.74,-2283.22 2469.02,-2273.46"/>
<polygon fill="black" stroke="black" points="2471.11,-2276.26 2477.1,-2267.52 2466.97,-2270.62 2471.11,-2276.26"/>
</g>
<!-- layer_14_allgather_mlp -->
<g id="node405" class="node">
<title>layer_14_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="2277.5" cy="-2142.47" rx="56.64" ry="36.54"/>
<text text-anchor="middle" x="2277.5" y="-2156.47" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="2277.5" y="-2145.47" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="2277.5" y="-2134.47" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2277.5" y="-2123.47" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_14_mlp_fc1_gpu28&#45;&gt;layer_14_allgather_mlp -->
<g id="edge521" class="edge">
<title>layer_14_mlp_fc1_gpu28&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M2190.93,-2215.06C2204.42,-2203.91 2220.51,-2190.6 2235.13,-2178.5"/>
<polygon fill="black" stroke="black" points="2237.61,-2181 2243.09,-2171.93 2233.15,-2175.61 2237.61,-2181"/>
</g>
<!-- layer_14_mlp_fc1_gpu29&#45;&gt;layer_14_allgather_mlp -->
<g id="edge522" class="edge">
<title>layer_14_mlp_fc1_gpu29&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M2277.5,-2215.06C2277.5,-2207.25 2277.5,-2198.39 2277.5,-2189.62"/>
<polygon fill="black" stroke="black" points="2281,-2189.44 2277.5,-2179.44 2274,-2189.44 2281,-2189.44"/>
</g>
<!-- layer_14_mlp_fc1_gpu30&#45;&gt;layer_14_allgather_mlp -->
<g id="edge523" class="edge">
<title>layer_14_mlp_fc1_gpu30&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M2364.07,-2215.06C2350.58,-2203.91 2334.49,-2190.6 2319.87,-2178.5"/>
<polygon fill="black" stroke="black" points="2321.85,-2175.61 2311.91,-2171.93 2317.39,-2181 2321.85,-2175.61"/>
</g>
<!-- layer_14_mlp_fc1_gpu31&#45;&gt;layer_14_allgather_mlp -->
<g id="edge524" class="edge">
<title>layer_14_mlp_fc1_gpu31&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M2461.85,-2218.76C2459.03,-2217.56 2456.23,-2216.38 2453.5,-2215.23 2413.86,-2198.61 2369,-2180.33 2334.49,-2166.37"/>
<polygon fill="black" stroke="black" points="2335.62,-2163.05 2325.04,-2162.55 2333,-2169.55 2335.62,-2163.05"/>
</g>
<!-- layer_14_gelu -->
<g id="node406" class="node">
<title>layer_14_gelu</title>
<polygon fill="lightblue" stroke="black" points="2292,-2069.7 2203,-2069.7 2203,-2028.7 2292,-2028.7 2292,-2069.7"/>
<text text-anchor="middle" x="2247.5" y="-2057.7" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="2247.5" y="-2046.7" font-family="Arial" font-size="10.00">GELU Activation</text>
<text text-anchor="middle" x="2247.5" y="-2035.7" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_14_allgather_mlp&#45;&gt;layer_14_gelu -->
<g id="edge525" class="edge">
<title>layer_14_allgather_mlp&#45;&gt;layer_14_gelu</title>
<path fill="none" stroke="black" d="M2265.99,-2106.44C2263.07,-2097.55 2259.96,-2088.09 2257.14,-2079.52"/>
<polygon fill="black" stroke="black" points="2260.44,-2078.36 2253.99,-2069.95 2253.79,-2080.54 2260.44,-2078.36"/>
</g>
<!-- layer_14_mlp_fc2_gpu28 -->
<g id="node407" class="node">
<title>layer_14_mlp_fc2_gpu28</title>
<polygon fill="lightblue" stroke="black" points="2239,-1992.7 2140,-1992.7 2140,-1940.7 2239,-1940.7 2239,-1992.7"/>
<text text-anchor="middle" x="2189.5" y="-1980.7" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="2189.5" y="-1969.7" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="2189.5" y="-1958.7" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2189.5" y="-1947.7" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu28 -->
<g id="edge526" class="edge">
<title>layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu28</title>
<path fill="none" stroke="black" d="M2233.16,-2028.3C2227.26,-2020.1 2220.25,-2010.37 2213.59,-2001.14"/>
<polygon fill="black" stroke="black" points="2216.31,-1998.92 2207.62,-1992.85 2210.63,-2003.01 2216.31,-1998.92"/>
</g>
<!-- layer_14_allreduce_mlp -->
<g id="node411" class="node">
<title>layer_14_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="2423.5" cy="-1867.93" rx="60.21" ry="36.54"/>
<text text-anchor="middle" x="2423.5" y="-1881.93" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="2423.5" y="-1870.93" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="2423.5" y="-1859.93" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2423.5" y="-1848.93" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_14_mlp_fc2_gpu28&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge527" class="edge">
<title>layer_14_mlp_fc2_gpu28&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2239.06,-1944.65C2242.25,-1943.31 2245.42,-1941.98 2248.5,-1940.7 2287.15,-1924.58 2330.71,-1906.72 2364.71,-1892.84"/>
<polygon fill="black" stroke="black" points="2366.09,-1896.05 2374.03,-1889.04 2363.45,-1889.57 2366.09,-1896.05"/>
</g>
<!-- layer_14_mlp_fc2_gpu29 -->
<g id="node408" class="node">
<title>layer_14_mlp_fc2_gpu29</title>
<polygon fill="lightblue" stroke="black" points="2356,-1992.7 2257,-1992.7 2257,-1940.7 2356,-1940.7 2356,-1992.7"/>
<text text-anchor="middle" x="2306.5" y="-1980.7" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="2306.5" y="-1969.7" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="2306.5" y="-1958.7" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2306.5" y="-1947.7" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_mlp_fc2_gpu29&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge528" class="edge">
<title>layer_14_mlp_fc2_gpu29&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2336.93,-1940.52C2350.19,-1929.56 2365.96,-1916.52 2380.39,-1904.58"/>
<polygon fill="black" stroke="black" points="2382.77,-1907.16 2388.24,-1898.09 2378.31,-1901.76 2382.77,-1907.16"/>
</g>
<!-- layer_14_mlp_fc2_gpu30 -->
<g id="node409" class="node">
<title>layer_14_mlp_fc2_gpu30</title>
<polygon fill="lightblue" stroke="black" points="2473,-1992.7 2374,-1992.7 2374,-1940.7 2473,-1940.7 2473,-1992.7"/>
<text text-anchor="middle" x="2423.5" y="-1980.7" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="2423.5" y="-1969.7" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="2423.5" y="-1958.7" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2423.5" y="-1947.7" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_mlp_fc2_gpu30&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge529" class="edge">
<title>layer_14_mlp_fc2_gpu30&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2423.5,-1940.52C2423.5,-1932.71 2423.5,-1923.85 2423.5,-1915.08"/>
<polygon fill="black" stroke="black" points="2427,-1914.9 2423.5,-1904.9 2420,-1914.9 2427,-1914.9"/>
</g>
<!-- layer_14_mlp_fc2_gpu31 -->
<g id="node410" class="node">
<title>layer_14_mlp_fc2_gpu31</title>
<polygon fill="lightblue" stroke="black" points="2590,-1992.7 2491,-1992.7 2491,-1940.7 2590,-1940.7 2590,-1992.7"/>
<text text-anchor="middle" x="2540.5" y="-1980.7" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="2540.5" y="-1969.7" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="2540.5" y="-1958.7" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2540.5" y="-1947.7" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_mlp_fc2_gpu31&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge530" class="edge">
<title>layer_14_mlp_fc2_gpu31&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2510.07,-1940.52C2496.81,-1929.56 2481.04,-1916.52 2466.61,-1904.58"/>
<polygon fill="black" stroke="black" points="2468.69,-1901.76 2458.76,-1898.09 2464.23,-1907.16 2468.69,-1901.76"/>
</g>
<!-- layer_14_allreduce_mlp&#45;&gt;layer_14_residual2 -->
<g id="edge531" class="edge">
<title>layer_14_allreduce_mlp&#45;&gt;layer_14_residual2</title>
<path fill="none" stroke="black" d="M2451.04,-1835.2C2459.69,-1825.22 2469.45,-1813.98 2478.85,-1803.15"/>
<polygon fill="black" stroke="black" points="2481.71,-1805.2 2485.62,-1795.35 2476.42,-1800.61 2481.71,-1805.2"/>
</g>
<!-- layer_14_ln2 -->
<g id="node413" class="node">
<title>layer_14_ln2</title>
<polygon fill="lightblue" stroke="black" points="2557,-1677.16 2484,-1677.16 2484,-1625.16 2557,-1625.16 2557,-1677.16"/>
<text text-anchor="middle" x="2520.5" y="-1665.16" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="2520.5" y="-1654.16" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="2520.5" y="-1643.16" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="2520.5" y="-1632.16" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_14_residual2&#45;&gt;layer_14_ln2 -->
<g id="edge533" class="edge">
<title>layer_14_residual2&#45;&gt;layer_14_ln2</title>
<path fill="none" stroke="black" d="M2520.5,-1712.95C2520.5,-1704.52 2520.5,-1695.68 2520.5,-1687.45"/>
<polygon fill="black" stroke="black" points="2524,-1687.41 2520.5,-1677.41 2517,-1687.41 2524,-1687.41"/>
</g>
<!-- layer_15_input_dist -->
<g id="node414" class="node">
<title>layer_15_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="2614.69,-1589.16 2464.86,-1589.16 2426.31,-1507.16 2576.14,-1507.16 2614.69,-1589.16"/>
<text text-anchor="middle" x="2520.5" y="-1556.66" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="2520.5" y="-1545.66" font-family="Arial" font-size="10.00">Input Distribution</text>
<text text-anchor="middle" x="2520.5" y="-1534.66" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_14_ln2&#45;&gt;layer_15_input_dist -->
<g id="edge534" class="edge">
<title>layer_14_ln2&#45;&gt;layer_15_input_dist</title>
<path fill="none" stroke="black" d="M2520.5,-1624.93C2520.5,-1617.2 2520.5,-1608.41 2520.5,-1599.62"/>
<polygon fill="black" stroke="black" points="2524,-1599.37 2520.5,-1589.37 2517,-1599.37 2524,-1599.37"/>
</g>
<!-- layer_15_qkv_gpu28 -->
<g id="node415" class="node">
<title>layer_15_qkv_gpu28</title>
<polygon fill="lightblue" stroke="black" points="2337.5,-1471.16 2239.5,-1471.16 2239.5,-1419.16 2337.5,-1419.16 2337.5,-1471.16"/>
<text text-anchor="middle" x="2288.5" y="-1459.16" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="2288.5" y="-1448.16" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="2288.5" y="-1437.16" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2288.5" y="-1426.16" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu28 -->
<g id="edge535" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu28</title>
<path fill="none" stroke="black" d="M2428.47,-1507.09C2400.99,-1495.13 2371.63,-1482.35 2346.93,-1471.59"/>
<polygon fill="black" stroke="black" points="2348.27,-1468.36 2337.71,-1467.58 2345.48,-1474.78 2348.27,-1468.36"/>
</g>
<!-- layer_15_qkv_gpu29 -->
<g id="node416" class="node">
<title>layer_15_qkv_gpu29</title>
<polygon fill="lightblue" stroke="black" points="2453.5,-1471.16 2355.5,-1471.16 2355.5,-1419.16 2453.5,-1419.16 2453.5,-1471.16"/>
<text text-anchor="middle" x="2404.5" y="-1459.16" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="2404.5" y="-1448.16" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="2404.5" y="-1437.16" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2404.5" y="-1426.16" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu29 -->
<g id="edge536" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu29</title>
<path fill="none" stroke="black" d="M2474.32,-1506.95C2463.34,-1497.39 2451.78,-1487.32 2441.29,-1478.19"/>
<polygon fill="black" stroke="black" points="2443.34,-1475.33 2433.5,-1471.41 2438.75,-1480.61 2443.34,-1475.33"/>
</g>
<!-- layer_15_qkv_gpu30 -->
<g id="node417" class="node">
<title>layer_15_qkv_gpu30</title>
<polygon fill="lightblue" stroke="black" points="2569.5,-1471.16 2471.5,-1471.16 2471.5,-1419.16 2569.5,-1419.16 2569.5,-1471.16"/>
<text text-anchor="middle" x="2520.5" y="-1459.16" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="2520.5" y="-1448.16" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="2520.5" y="-1437.16" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2520.5" y="-1426.16" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu30 -->
<g id="edge537" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu30</title>
<path fill="none" stroke="black" d="M2520.5,-1506.95C2520.5,-1498.52 2520.5,-1489.68 2520.5,-1481.45"/>
<polygon fill="black" stroke="black" points="2524,-1481.41 2520.5,-1471.41 2517,-1481.41 2524,-1481.41"/>
</g>
<!-- layer_15_qkv_gpu31 -->
<g id="node418" class="node">
<title>layer_15_qkv_gpu31</title>
<polygon fill="lightblue" stroke="black" points="2685.5,-1471.16 2587.5,-1471.16 2587.5,-1419.16 2685.5,-1419.16 2685.5,-1471.16"/>
<text text-anchor="middle" x="2636.5" y="-1459.16" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="2636.5" y="-1448.16" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="2636.5" y="-1437.16" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2636.5" y="-1426.16" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu31 -->
<g id="edge538" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu31</title>
<path fill="none" stroke="black" d="M2566.68,-1506.95C2577.66,-1497.39 2589.22,-1487.32 2599.71,-1478.19"/>
<polygon fill="black" stroke="black" points="2602.25,-1480.61 2607.5,-1471.41 2597.66,-1475.33 2602.25,-1480.61"/>
</g>
<!-- layer_15_residual1 -->
<g id="node426" class="node">
<title>layer_15_residual1</title>
<polygon fill="lightyellow" stroke="black" points="2722.44,-988.08 2600.05,-988.08 2568.56,-906.08 2690.95,-906.08 2722.44,-988.08"/>
<text text-anchor="middle" x="2645.5" y="-955.58" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="2645.5" y="-944.58" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2645.5" y="-933.58" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_residual1 -->
<g id="edge550" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_residual1</title>
<path fill="none" stroke="black" d="M2588.06,-1531.64C2623.92,-1520.27 2666.29,-1501.42 2694.5,-1471.16 2734.31,-1428.45 2738.5,-1405.77 2738.5,-1347.39 2738.5,-1347.39 2738.5,-1347.39 2738.5,-1158.62 2738.5,-1099.11 2707.03,-1037.6 2680.71,-996.55"/>
<polygon fill="black" stroke="black" points="2683.59,-994.55 2675.18,-988.1 2677.73,-998.39 2683.59,-994.55"/>
</g>
<!-- layer_15_allgather_qkv -->
<g id="node419" class="node">
<title>layer_15_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="2404.5" cy="-1346.39" rx="57.05" ry="36.54"/>
<text text-anchor="middle" x="2404.5" y="-1360.39" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="2404.5" y="-1349.39" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="2404.5" y="-1338.39" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2404.5" y="-1327.39" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_15_qkv_gpu28&#45;&gt;layer_15_allgather_qkv -->
<g id="edge539" class="edge">
<title>layer_15_qkv_gpu28&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M2318.67,-1418.98C2331.93,-1407.93 2347.72,-1394.75 2362.13,-1382.73"/>
<polygon fill="black" stroke="black" points="2364.53,-1385.29 2369.96,-1376.2 2360.04,-1379.92 2364.53,-1385.29"/>
</g>
<!-- layer_15_qkv_gpu29&#45;&gt;layer_15_allgather_qkv -->
<g id="edge540" class="edge">
<title>layer_15_qkv_gpu29&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M2404.5,-1418.98C2404.5,-1411.18 2404.5,-1402.31 2404.5,-1393.54"/>
<polygon fill="black" stroke="black" points="2408,-1393.36 2404.5,-1383.36 2401,-1393.36 2408,-1393.36"/>
</g>
<!-- layer_15_qkv_gpu30&#45;&gt;layer_15_allgather_qkv -->
<g id="edge541" class="edge">
<title>layer_15_qkv_gpu30&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M2490.33,-1418.98C2477.07,-1407.93 2461.28,-1394.75 2446.87,-1382.73"/>
<polygon fill="black" stroke="black" points="2448.96,-1379.92 2439.04,-1376.2 2444.47,-1385.29 2448.96,-1379.92"/>
</g>
<!-- layer_15_qkv_gpu31&#45;&gt;layer_15_allgather_qkv -->
<g id="edge542" class="edge">
<title>layer_15_qkv_gpu31&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M2587.48,-1422.96C2584.44,-1421.67 2581.43,-1420.39 2578.5,-1419.16 2539.56,-1402.73 2495.55,-1384.59 2461.53,-1370.65"/>
<polygon fill="black" stroke="black" points="2462.8,-1367.38 2452.22,-1366.83 2460.15,-1373.86 2462.8,-1367.38"/>
</g>
<!-- layer_15_attention -->
<g id="node420" class="node">
<title>layer_15_attention</title>
<polygon fill="lightblue" stroke="black" points="2413.5,-1273.62 2345.5,-1273.62 2345.5,-1221.62 2413.5,-1221.62 2413.5,-1273.62"/>
<text text-anchor="middle" x="2379.5" y="-1261.62" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="2379.5" y="-1250.62" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="2379.5" y="-1239.62" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="2379.5" y="-1228.62" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_15_allgather_qkv&#45;&gt;layer_15_attention -->
<g id="edge543" class="edge">
<title>layer_15_allgather_qkv&#45;&gt;layer_15_attention</title>
<path fill="none" stroke="black" d="M2395.33,-1309.9C2393.11,-1301.3 2390.73,-1292.1 2388.52,-1283.52"/>
<polygon fill="black" stroke="black" points="2391.9,-1282.61 2386.01,-1273.8 2385.12,-1284.36 2391.9,-1282.61"/>
</g>
<!-- layer_15_attn_out_gpu28 -->
<g id="node421" class="node">
<title>layer_15_attn_out_gpu28</title>
<polygon fill="lightblue" stroke="black" points="2377,-1185.62 2284,-1185.62 2284,-1133.62 2377,-1133.62 2377,-1185.62"/>
<text text-anchor="middle" x="2330.5" y="-1173.62" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="2330.5" y="-1162.62" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="2330.5" y="-1151.62" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2330.5" y="-1140.62" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attention&#45;&gt;layer_15_attn_out_gpu28 -->
<g id="edge544" class="edge">
<title>layer_15_attention&#45;&gt;layer_15_attn_out_gpu28</title>
<path fill="none" stroke="black" d="M2365.06,-1221.28C2360.33,-1212.97 2354.99,-1203.59 2349.94,-1194.74"/>
<polygon fill="black" stroke="black" points="2352.82,-1192.73 2344.83,-1185.77 2346.74,-1196.2 2352.82,-1192.73"/>
</g>
<!-- layer_15_allreduce_attn -->
<g id="node425" class="node">
<title>layer_15_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="2552.5" cy="-1060.85" rx="57.97" ry="36.54"/>
<text text-anchor="middle" x="2552.5" y="-1074.85" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="2552.5" y="-1063.85" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="2552.5" y="-1052.85" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2552.5" y="-1041.85" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_15_attn_out_gpu28&#45;&gt;layer_15_allreduce_attn -->
<g id="edge545" class="edge">
<title>layer_15_attn_out_gpu28&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M2377.23,-1137.71C2380.37,-1136.32 2383.48,-1134.94 2386.5,-1133.62 2422.74,-1117.7 2463.54,-1100.05 2495.62,-1086.24"/>
<polygon fill="black" stroke="black" points="2497.05,-1089.44 2504.85,-1082.27 2494.28,-1083.01 2497.05,-1089.44"/>
</g>
<!-- layer_15_attn_out_gpu29 -->
<g id="node422" class="node">
<title>layer_15_attn_out_gpu29</title>
<polygon fill="lightblue" stroke="black" points="2488,-1185.62 2395,-1185.62 2395,-1133.62 2488,-1133.62 2488,-1185.62"/>
<text text-anchor="middle" x="2441.5" y="-1173.62" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="2441.5" y="-1162.62" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="2441.5" y="-1151.62" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2441.5" y="-1140.62" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attn_out_gpu29&#45;&gt;layer_15_allreduce_attn -->
<g id="edge546" class="edge">
<title>layer_15_attn_out_gpu29&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M2470.37,-1133.44C2482.83,-1122.58 2497.64,-1109.68 2511.22,-1097.84"/>
<polygon fill="black" stroke="black" points="2513.81,-1100.22 2519.05,-1091.01 2509.21,-1094.94 2513.81,-1100.22"/>
</g>
<!-- layer_15_attn_out_gpu30 -->
<g id="node423" class="node">
<title>layer_15_attn_out_gpu30</title>
<polygon fill="lightblue" stroke="black" points="2599,-1185.62 2506,-1185.62 2506,-1133.62 2599,-1133.62 2599,-1185.62"/>
<text text-anchor="middle" x="2552.5" y="-1173.62" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="2552.5" y="-1162.62" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="2552.5" y="-1151.62" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2552.5" y="-1140.62" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attn_out_gpu30&#45;&gt;layer_15_allreduce_attn -->
<g id="edge547" class="edge">
<title>layer_15_attn_out_gpu30&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M2552.5,-1133.44C2552.5,-1125.64 2552.5,-1116.77 2552.5,-1108"/>
<polygon fill="black" stroke="black" points="2556,-1107.82 2552.5,-1097.82 2549,-1107.82 2556,-1107.82"/>
</g>
<!-- layer_15_attn_out_gpu31 -->
<g id="node424" class="node">
<title>layer_15_attn_out_gpu31</title>
<polygon fill="lightblue" stroke="black" points="2710,-1185.62 2617,-1185.62 2617,-1133.62 2710,-1133.62 2710,-1185.62"/>
<text text-anchor="middle" x="2663.5" y="-1173.62" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="2663.5" y="-1162.62" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="2663.5" y="-1151.62" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2663.5" y="-1140.62" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attn_out_gpu31&#45;&gt;layer_15_allreduce_attn -->
<g id="edge548" class="edge">
<title>layer_15_attn_out_gpu31&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M2634.63,-1133.44C2622.17,-1122.58 2607.36,-1109.68 2593.78,-1097.84"/>
<polygon fill="black" stroke="black" points="2595.79,-1094.94 2585.95,-1091.01 2591.19,-1100.22 2595.79,-1094.94"/>
</g>
<!-- layer_15_allreduce_attn&#45;&gt;layer_15_residual1 -->
<g id="edge549" class="edge">
<title>layer_15_allreduce_attn&#45;&gt;layer_15_residual1</title>
<path fill="none" stroke="black" d="M2579.15,-1027.82C2587.36,-1017.96 2596.58,-1006.87 2605.48,-996.18"/>
<polygon fill="black" stroke="black" points="2608.18,-998.41 2611.88,-988.48 2602.79,-993.93 2608.18,-998.41"/>
</g>
<!-- layer_15_ln1 -->
<g id="node427" class="node">
<title>layer_15_ln1</title>
<polygon fill="lightblue" stroke="black" points="2585,-870.08 2512,-870.08 2512,-818.08 2585,-818.08 2585,-870.08"/>
<text text-anchor="middle" x="2548.5" y="-858.08" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="2548.5" y="-847.08" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="2548.5" y="-836.08" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="2548.5" y="-825.08" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_15_residual1&#45;&gt;layer_15_ln1 -->
<g id="edge551" class="edge">
<title>layer_15_residual1&#45;&gt;layer_15_ln1</title>
<path fill="none" stroke="black" d="M2606.88,-905.87C2597.89,-896.5 2588.41,-886.64 2579.78,-877.65"/>
<polygon fill="black" stroke="black" points="2582.2,-875.12 2572.75,-870.33 2577.15,-879.97 2582.2,-875.12"/>
</g>
<!-- layer_15_residual2 -->
<g id="node439" class="node">
<title>layer_15_residual2</title>
<polygon fill="lightyellow" stroke="black" points="2751.44,-310 2629.05,-310 2597.56,-228 2719.95,-228 2751.44,-310"/>
<text text-anchor="middle" x="2674.5" y="-277.5" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="2674.5" y="-266.5" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2674.5" y="-255.5" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_15_residual1&#45;&gt;layer_15_residual2 -->
<g id="edge567" class="edge">
<title>layer_15_residual1&#45;&gt;layer_15_residual2</title>
<path fill="none" stroke="black" d="M2691.71,-907.25C2728.02,-872.17 2772.5,-816.97 2772.5,-757.08 2772.5,-757.08 2772.5,-757.08 2772.5,-480.54 2772.5,-420.69 2739.55,-359.46 2711.86,-318.57"/>
<polygon fill="black" stroke="black" points="2714.61,-316.4 2706.05,-310.16 2708.86,-320.38 2714.61,-316.4"/>
</g>
<!-- layer_15_mlp_fc1_gpu28 -->
<g id="node428" class="node">
<title>layer_15_mlp_fc1_gpu28</title>
<polygon fill="lightblue" stroke="black" points="2364,-782.08 2265,-782.08 2265,-730.08 2364,-730.08 2364,-782.08"/>
<text text-anchor="middle" x="2314.5" y="-770.08" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="2314.5" y="-759.08" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="2314.5" y="-748.08" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2314.5" y="-737.08" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu28 -->
<g id="edge552" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu28</title>
<path fill="none" stroke="black" d="M2511.71,-831.03C2478.14,-819.87 2426.99,-802.43 2373.88,-782.14"/>
<polygon fill="black" stroke="black" points="2374.89,-778.77 2364.3,-778.45 2372.38,-785.31 2374.89,-778.77"/>
</g>
<!-- layer_15_mlp_fc1_gpu29 -->
<g id="node429" class="node">
<title>layer_15_mlp_fc1_gpu29</title>
<polygon fill="lightblue" stroke="black" points="2481,-782.08 2382,-782.08 2382,-730.08 2481,-730.08 2481,-782.08"/>
<text text-anchor="middle" x="2431.5" y="-770.08" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="2431.5" y="-759.08" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="2431.5" y="-748.08" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2431.5" y="-737.08" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu29 -->
<g id="edge553" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu29</title>
<path fill="none" stroke="black" d="M2514.34,-817.97C2501.72,-808.69 2487.26,-798.06 2473.98,-788.31"/>
<polygon fill="black" stroke="black" points="2476.03,-785.47 2465.9,-782.36 2471.89,-791.11 2476.03,-785.47"/>
</g>
<!-- layer_15_mlp_fc1_gpu30 -->
<g id="node430" class="node">
<title>layer_15_mlp_fc1_gpu30</title>
<polygon fill="lightblue" stroke="black" points="2598,-782.08 2499,-782.08 2499,-730.08 2598,-730.08 2598,-782.08"/>
<text text-anchor="middle" x="2548.5" y="-770.08" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="2548.5" y="-759.08" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="2548.5" y="-748.08" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2548.5" y="-737.08" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu30 -->
<g id="edge554" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu30</title>
<path fill="none" stroke="black" d="M2548.5,-817.74C2548.5,-809.78 2548.5,-800.84 2548.5,-792.32"/>
<polygon fill="black" stroke="black" points="2552,-792.23 2548.5,-782.23 2545,-792.23 2552,-792.23"/>
</g>
<!-- layer_15_mlp_fc1_gpu31 -->
<g id="node431" class="node">
<title>layer_15_mlp_fc1_gpu31</title>
<polygon fill="lightblue" stroke="black" points="2715,-782.08 2616,-782.08 2616,-730.08 2715,-730.08 2715,-782.08"/>
<text text-anchor="middle" x="2665.5" y="-770.08" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="2665.5" y="-759.08" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="2665.5" y="-748.08" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2665.5" y="-737.08" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu31 -->
<g id="edge555" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu31</title>
<path fill="none" stroke="black" d="M2582.66,-817.97C2595.28,-808.69 2609.74,-798.06 2623.02,-788.31"/>
<polygon fill="black" stroke="black" points="2625.11,-791.11 2631.1,-782.36 2620.97,-785.47 2625.11,-791.11"/>
</g>
<!-- layer_15_allgather_mlp -->
<g id="node432" class="node">
<title>layer_15_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="2431.5" cy="-657.31" rx="56.64" ry="36.54"/>
<text text-anchor="middle" x="2431.5" y="-671.31" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="2431.5" y="-660.31" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="2431.5" y="-649.31" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2431.5" y="-638.31" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_15_mlp_fc1_gpu28&#45;&gt;layer_15_allgather_mlp -->
<g id="edge556" class="edge">
<title>layer_15_mlp_fc1_gpu28&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M2344.93,-729.91C2358.42,-718.75 2374.51,-705.45 2389.13,-693.35"/>
<polygon fill="black" stroke="black" points="2391.61,-695.84 2397.09,-686.77 2387.15,-690.45 2391.61,-695.84"/>
</g>
<!-- layer_15_mlp_fc1_gpu29&#45;&gt;layer_15_allgather_mlp -->
<g id="edge557" class="edge">
<title>layer_15_mlp_fc1_gpu29&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M2431.5,-729.91C2431.5,-722.1 2431.5,-713.23 2431.5,-704.46"/>
<polygon fill="black" stroke="black" points="2435,-704.29 2431.5,-694.29 2428,-704.29 2435,-704.29"/>
</g>
<!-- layer_15_mlp_fc1_gpu30&#45;&gt;layer_15_allgather_mlp -->
<g id="edge558" class="edge">
<title>layer_15_mlp_fc1_gpu30&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M2518.07,-729.91C2504.58,-718.75 2488.49,-705.45 2473.87,-693.35"/>
<polygon fill="black" stroke="black" points="2475.85,-690.45 2465.91,-686.77 2471.39,-695.84 2475.85,-690.45"/>
</g>
<!-- layer_15_mlp_fc1_gpu31&#45;&gt;layer_15_allgather_mlp -->
<g id="edge559" class="edge">
<title>layer_15_mlp_fc1_gpu31&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M2615.85,-733.6C2613.03,-732.4 2610.23,-731.22 2607.5,-730.08 2567.86,-713.46 2523,-695.17 2488.49,-681.21"/>
<polygon fill="black" stroke="black" points="2489.62,-677.9 2479.04,-677.4 2487,-684.39 2489.62,-677.9"/>
</g>
<!-- layer_15_gelu -->
<g id="node433" class="node">
<title>layer_15_gelu</title>
<polygon fill="lightblue" stroke="black" points="2446,-584.54 2357,-584.54 2357,-543.54 2446,-543.54 2446,-584.54"/>
<text text-anchor="middle" x="2401.5" y="-572.54" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="2401.5" y="-561.54" font-family="Arial" font-size="10.00">GELU Activation</text>
<text text-anchor="middle" x="2401.5" y="-550.54" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_15_allgather_mlp&#45;&gt;layer_15_gelu -->
<g id="edge560" class="edge">
<title>layer_15_allgather_mlp&#45;&gt;layer_15_gelu</title>
<path fill="none" stroke="black" d="M2419.99,-621.28C2417.07,-612.39 2413.96,-602.94 2411.14,-594.36"/>
<polygon fill="black" stroke="black" points="2414.44,-593.2 2407.99,-584.79 2407.79,-595.39 2414.44,-593.2"/>
</g>
<!-- layer_15_mlp_fc2_gpu28 -->
<g id="node434" class="node">
<title>layer_15_mlp_fc2_gpu28</title>
<polygon fill="lightblue" stroke="black" points="2393,-507.54 2294,-507.54 2294,-455.54 2393,-455.54 2393,-507.54"/>
<text text-anchor="middle" x="2343.5" y="-495.54" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="2343.5" y="-484.54" font-family="Arial" font-size="10.00">GPU 28</text>
<text text-anchor="middle" x="2343.5" y="-473.54" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2343.5" y="-462.54" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu28 -->
<g id="edge561" class="edge">
<title>layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu28</title>
<path fill="none" stroke="black" d="M2387.16,-543.14C2381.26,-534.94 2374.25,-525.21 2367.59,-515.98"/>
<polygon fill="black" stroke="black" points="2370.31,-513.76 2361.62,-507.69 2364.63,-517.85 2370.31,-513.76"/>
</g>
<!-- layer_15_allreduce_mlp -->
<g id="node438" class="node">
<title>layer_15_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="2577.5" cy="-382.77" rx="60.21" ry="36.54"/>
<text text-anchor="middle" x="2577.5" y="-396.77" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="2577.5" y="-385.77" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="2577.5" y="-374.77" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2577.5" y="-363.77" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_15_mlp_fc2_gpu28&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge562" class="edge">
<title>layer_15_mlp_fc2_gpu28&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2393.06,-459.49C2396.25,-458.15 2399.42,-456.82 2402.5,-455.54 2441.15,-439.43 2484.71,-421.56 2518.71,-407.68"/>
<polygon fill="black" stroke="black" points="2520.09,-410.9 2528.03,-403.88 2517.45,-404.42 2520.09,-410.9"/>
</g>
<!-- layer_15_mlp_fc2_gpu29 -->
<g id="node435" class="node">
<title>layer_15_mlp_fc2_gpu29</title>
<polygon fill="lightblue" stroke="black" points="2510,-507.54 2411,-507.54 2411,-455.54 2510,-455.54 2510,-507.54"/>
<text text-anchor="middle" x="2460.5" y="-495.54" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="2460.5" y="-484.54" font-family="Arial" font-size="10.00">GPU 29</text>
<text text-anchor="middle" x="2460.5" y="-473.54" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2460.5" y="-462.54" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_mlp_fc2_gpu29&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge563" class="edge">
<title>layer_15_mlp_fc2_gpu29&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2490.93,-455.37C2504.19,-444.4 2519.96,-431.36 2534.39,-419.43"/>
<polygon fill="black" stroke="black" points="2536.77,-422 2542.24,-412.93 2532.31,-416.61 2536.77,-422"/>
</g>
<!-- layer_15_mlp_fc2_gpu30 -->
<g id="node436" class="node">
<title>layer_15_mlp_fc2_gpu30</title>
<polygon fill="lightblue" stroke="black" points="2627,-507.54 2528,-507.54 2528,-455.54 2627,-455.54 2627,-507.54"/>
<text text-anchor="middle" x="2577.5" y="-495.54" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="2577.5" y="-484.54" font-family="Arial" font-size="10.00">GPU 30</text>
<text text-anchor="middle" x="2577.5" y="-473.54" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2577.5" y="-462.54" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_mlp_fc2_gpu30&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge564" class="edge">
<title>layer_15_mlp_fc2_gpu30&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2577.5,-455.37C2577.5,-447.56 2577.5,-438.69 2577.5,-429.92"/>
<polygon fill="black" stroke="black" points="2581,-429.75 2577.5,-419.75 2574,-429.75 2581,-429.75"/>
</g>
<!-- layer_15_mlp_fc2_gpu31 -->
<g id="node437" class="node">
<title>layer_15_mlp_fc2_gpu31</title>
<polygon fill="lightblue" stroke="black" points="2744,-507.54 2645,-507.54 2645,-455.54 2744,-455.54 2744,-507.54"/>
<text text-anchor="middle" x="2694.5" y="-495.54" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="2694.5" y="-484.54" font-family="Arial" font-size="10.00">GPU 31</text>
<text text-anchor="middle" x="2694.5" y="-473.54" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2694.5" y="-462.54" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_mlp_fc2_gpu31&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge565" class="edge">
<title>layer_15_mlp_fc2_gpu31&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2664.07,-455.37C2650.81,-444.4 2635.04,-431.36 2620.61,-419.43"/>
<polygon fill="black" stroke="black" points="2622.69,-416.61 2612.76,-412.93 2618.23,-422 2622.69,-416.61"/>
</g>
<!-- layer_15_allreduce_mlp&#45;&gt;layer_15_residual2 -->
<g id="edge566" class="edge">
<title>layer_15_allreduce_mlp&#45;&gt;layer_15_residual2</title>
<path fill="none" stroke="black" d="M2605.04,-350.04C2613.69,-340.07 2623.45,-328.83 2632.85,-317.99"/>
<polygon fill="black" stroke="black" points="2635.71,-320.04 2639.62,-310.19 2630.42,-315.45 2635.71,-320.04"/>
</g>
<!-- layer_15_ln2 -->
<g id="node440" class="node">
<title>layer_15_ln2</title>
<polygon fill="lightblue" stroke="black" points="2711,-192 2638,-192 2638,-140 2711,-140 2711,-192"/>
<text text-anchor="middle" x="2674.5" y="-180" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="2674.5" y="-169" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="2674.5" y="-158" font-family="Arial" font-size="10.00">γ,β: 4096</text>
<text text-anchor="middle" x="2674.5" y="-147" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- layer_15_residual2&#45;&gt;layer_15_ln2 -->
<g id="edge568" class="edge">
<title>layer_15_residual2&#45;&gt;layer_15_ln2</title>
<path fill="none" stroke="black" d="M2674.5,-227.79C2674.5,-219.36 2674.5,-210.53 2674.5,-202.29"/>
<polygon fill="black" stroke="black" points="2678,-202.25 2674.5,-192.25 2671,-202.25 2678,-202.25"/>
</g>
<!-- output -->
<g id="node441" class="node">
<title>output</title>
<polygon fill="lightgreen" stroke="black" points="2751.44,-104 2629.05,-104 2597.56,0 2719.95,0 2751.44,-104"/>
<text text-anchor="middle" x="2674.5" y="-66" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="2674.5" y="-55" font-family="Arial" font-size="10.00">Batch: 128</text>
<text text-anchor="middle" x="2674.5" y="-44" font-family="Arial" font-size="10.00">Seq: 10000</text>
<text text-anchor="middle" x="2674.5" y="-33" font-family="Arial" font-size="10.00">Hidden: 4096</text>
</g>
<!-- layer_15_ln2&#45;&gt;output -->
<g id="edge569" class="edge">
<title>layer_15_ln2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2674.5,-139.87C2674.5,-132.18 2674.5,-123.37 2674.5,-114.37"/>
<polygon fill="black" stroke="black" points="2678,-114.18 2674.5,-104.18 2671,-114.18 2678,-114.18"/>
</g>
</g>
</svg>
