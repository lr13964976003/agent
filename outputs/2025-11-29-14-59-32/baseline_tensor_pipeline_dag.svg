<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="9000pt" height="4495pt"
 viewBox="0.00 0.00 2160.00 1078.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.46 0.46) rotate(0) translate(4 9808.87)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-9808.87 19645,-9808.87 19645,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer_0_attn</title>
<path fill="lightgray" stroke="black" d="M3607,-9199.15C3607,-9199.15 5309,-9199.15 5309,-9199.15 5315,-9199.15 5321,-9205.15 5321,-9211.15 5321,-9211.15 5321,-9648.87 5321,-9648.87 5321,-9654.87 5315,-9660.87 5309,-9660.87 5309,-9660.87 3607,-9660.87 3607,-9660.87 3601,-9660.87 3595,-9654.87 3595,-9648.87 3595,-9648.87 3595,-9211.15 3595,-9211.15 3595,-9205.15 3601,-9199.15 3607,-9199.15"/>
<text text-anchor="middle" x="4458" y="-9645.67" font-family="Times,serif" font-size="14.00">Layer 0 Attention (TP=8)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_0_mlp</title>
<path fill="lightgray" stroke="black" d="M3885,-8612.41C3885,-8612.41 5011,-8612.41 5011,-8612.41 5017,-8612.41 5023,-8618.41 5023,-8624.41 5023,-8624.41 5023,-8972.02 5023,-8972.02 5023,-8978.02 5017,-8984.02 5011,-8984.02 5011,-8984.02 3885,-8984.02 3885,-8984.02 3879,-8984.02 3873,-8978.02 3873,-8972.02 3873,-8972.02 3873,-8624.41 3873,-8624.41 3873,-8618.41 3879,-8612.41 3885,-8612.41"/>
<text text-anchor="middle" x="4448" y="-8968.82" font-family="Times,serif" font-size="14.00">Layer 0 MLP (TP=8)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_1_attn</title>
<path fill="lightgray" stroke="black" d="M3086,-7867.8C3086,-7867.8 4788,-7867.8 4788,-7867.8 4794,-7867.8 4800,-7873.8 4800,-7879.8 4800,-7879.8 4800,-8305.28 4800,-8305.28 4800,-8311.28 4794,-8317.28 4788,-8317.28 4788,-8317.28 3086,-8317.28 3086,-8317.28 3080,-8317.28 3074,-8311.28 3074,-8305.28 3074,-8305.28 3074,-7879.8 3074,-7879.8 3074,-7873.8 3080,-7867.8 3086,-7867.8"/>
<text text-anchor="middle" x="3937" y="-8302.08" font-family="Times,serif" font-size="14.00">Layer 1 Attention (TP=8)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_1_mlp</title>
<path fill="lightgray" stroke="black" d="M3374,-7337.06C3374,-7337.06 4500,-7337.06 4500,-7337.06 4506,-7337.06 4512,-7343.06 4512,-7349.06 4512,-7349.06 4512,-7669.8 4512,-7669.8 4512,-7675.8 4506,-7681.8 4500,-7681.8 4500,-7681.8 3374,-7681.8 3374,-7681.8 3368,-7681.8 3362,-7675.8 3362,-7669.8 3362,-7669.8 3362,-7349.06 3362,-7349.06 3362,-7343.06 3368,-7337.06 3374,-7337.06"/>
<text text-anchor="middle" x="3937" y="-7666.6" font-family="Times,serif" font-size="14.00">Layer 1 MLP (TP=8)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer_2_attn</title>
<path fill="lightgray" stroke="black" d="M2575,-6701.58C2575,-6701.58 4277,-6701.58 4277,-6701.58 4283,-6701.58 4289,-6707.58 4289,-6713.58 4289,-6713.58 4289,-7139.06 4289,-7139.06 4289,-7145.06 4283,-7151.06 4277,-7151.06 4277,-7151.06 2575,-7151.06 2575,-7151.06 2569,-7151.06 2563,-7145.06 2563,-7139.06 2563,-7139.06 2563,-6713.58 2563,-6713.58 2563,-6707.58 2569,-6701.58 2575,-6701.58"/>
<text text-anchor="middle" x="3426" y="-7135.86" font-family="Times,serif" font-size="14.00">Layer 2 Attention (TP=8)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer_2_mlp</title>
<path fill="lightgray" stroke="black" d="M2863,-6170.84C2863,-6170.84 3989,-6170.84 3989,-6170.84 3995,-6170.84 4001,-6176.84 4001,-6182.84 4001,-6182.84 4001,-6503.58 4001,-6503.58 4001,-6509.58 3995,-6515.58 3989,-6515.58 3989,-6515.58 2863,-6515.58 2863,-6515.58 2857,-6515.58 2851,-6509.58 2851,-6503.58 2851,-6503.58 2851,-6182.84 2851,-6182.84 2851,-6176.84 2857,-6170.84 2863,-6170.84"/>
<text text-anchor="middle" x="3426" y="-6500.38" font-family="Times,serif" font-size="14.00">Layer 2 MLP (TP=8)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer_3_attn</title>
<path fill="lightgray" stroke="black" d="M2064,-5535.36C2064,-5535.36 3766,-5535.36 3766,-5535.36 3772,-5535.36 3778,-5541.36 3778,-5547.36 3778,-5547.36 3778,-5972.84 3778,-5972.84 3778,-5978.84 3772,-5984.84 3766,-5984.84 3766,-5984.84 2064,-5984.84 2064,-5984.84 2058,-5984.84 2052,-5978.84 2052,-5972.84 2052,-5972.84 2052,-5547.36 2052,-5547.36 2052,-5541.36 2058,-5535.36 2064,-5535.36"/>
<text text-anchor="middle" x="2915" y="-5969.64" font-family="Times,serif" font-size="14.00">Layer 3 Attention (TP=8)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer_3_mlp</title>
<path fill="lightgray" stroke="black" d="M2352,-5004.62C2352,-5004.62 3478,-5004.62 3478,-5004.62 3484,-5004.62 3490,-5010.62 3490,-5016.62 3490,-5016.62 3490,-5337.36 3490,-5337.36 3490,-5343.36 3484,-5349.36 3478,-5349.36 3478,-5349.36 2352,-5349.36 2352,-5349.36 2346,-5349.36 2340,-5343.36 2340,-5337.36 2340,-5337.36 2340,-5016.62 2340,-5016.62 2340,-5010.62 2346,-5004.62 2352,-5004.62"/>
<text text-anchor="middle" x="2915" y="-5334.16" font-family="Times,serif" font-size="14.00">Layer 3 MLP (TP=8)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer_4_attn</title>
<path fill="lightgray" stroke="black" d="M1553,-4369.14C1553,-4369.14 3255,-4369.14 3255,-4369.14 3261,-4369.14 3267,-4375.14 3267,-4381.14 3267,-4381.14 3267,-4806.62 3267,-4806.62 3267,-4812.62 3261,-4818.62 3255,-4818.62 3255,-4818.62 1553,-4818.62 1553,-4818.62 1547,-4818.62 1541,-4812.62 1541,-4806.62 1541,-4806.62 1541,-4381.14 1541,-4381.14 1541,-4375.14 1547,-4369.14 1553,-4369.14"/>
<text text-anchor="middle" x="2404" y="-4803.42" font-family="Times,serif" font-size="14.00">Layer 4 Attention (TP=8)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_layer_4_mlp</title>
<path fill="lightgray" stroke="black" d="M1841,-3838.4C1841,-3838.4 2967,-3838.4 2967,-3838.4 2973,-3838.4 2979,-3844.4 2979,-3850.4 2979,-3850.4 2979,-4171.14 2979,-4171.14 2979,-4177.14 2973,-4183.14 2967,-4183.14 2967,-4183.14 1841,-4183.14 1841,-4183.14 1835,-4183.14 1829,-4177.14 1829,-4171.14 1829,-4171.14 1829,-3850.4 1829,-3850.4 1829,-3844.4 1835,-3838.4 1841,-3838.4"/>
<text text-anchor="middle" x="2404" y="-4167.94" font-family="Times,serif" font-size="14.00">Layer 4 MLP (TP=8)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer_5_attn</title>
<path fill="lightgray" stroke="black" d="M1042,-3202.92C1042,-3202.92 2744,-3202.92 2744,-3202.92 2750,-3202.92 2756,-3208.92 2756,-3214.92 2756,-3214.92 2756,-3640.4 2756,-3640.4 2756,-3646.4 2750,-3652.4 2744,-3652.4 2744,-3652.4 1042,-3652.4 1042,-3652.4 1036,-3652.4 1030,-3646.4 1030,-3640.4 1030,-3640.4 1030,-3214.92 1030,-3214.92 1030,-3208.92 1036,-3202.92 1042,-3202.92"/>
<text text-anchor="middle" x="1893" y="-3637.2" font-family="Times,serif" font-size="14.00">Layer 5 Attention (TP=8)</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_layer_5_mlp</title>
<path fill="lightgray" stroke="black" d="M1330,-2672.18C1330,-2672.18 2456,-2672.18 2456,-2672.18 2462,-2672.18 2468,-2678.18 2468,-2684.18 2468,-2684.18 2468,-3004.92 2468,-3004.92 2468,-3010.92 2462,-3016.92 2456,-3016.92 2456,-3016.92 1330,-3016.92 1330,-3016.92 1324,-3016.92 1318,-3010.92 1318,-3004.92 1318,-3004.92 1318,-2684.18 1318,-2684.18 1318,-2678.18 1324,-2672.18 1330,-2672.18"/>
<text text-anchor="middle" x="1893" y="-3001.72" font-family="Times,serif" font-size="14.00">Layer 5 MLP (TP=8)</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_layer_6_attn</title>
<path fill="lightgray" stroke="black" d="M531,-2036.7C531,-2036.7 2233,-2036.7 2233,-2036.7 2239,-2036.7 2245,-2042.7 2245,-2048.7 2245,-2048.7 2245,-2474.18 2245,-2474.18 2245,-2480.18 2239,-2486.18 2233,-2486.18 2233,-2486.18 531,-2486.18 531,-2486.18 525,-2486.18 519,-2480.18 519,-2474.18 519,-2474.18 519,-2048.7 519,-2048.7 519,-2042.7 525,-2036.7 531,-2036.7"/>
<text text-anchor="middle" x="1382" y="-2470.98" font-family="Times,serif" font-size="14.00">Layer 6 Attention (TP=8)</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_layer_6_mlp</title>
<path fill="lightgray" stroke="black" d="M819,-1505.96C819,-1505.96 1945,-1505.96 1945,-1505.96 1951,-1505.96 1957,-1511.96 1957,-1517.96 1957,-1517.96 1957,-1838.7 1957,-1838.7 1957,-1844.7 1951,-1850.7 1945,-1850.7 1945,-1850.7 819,-1850.7 819,-1850.7 813,-1850.7 807,-1844.7 807,-1838.7 807,-1838.7 807,-1517.96 807,-1517.96 807,-1511.96 813,-1505.96 819,-1505.96"/>
<text text-anchor="middle" x="1382" y="-1835.5" font-family="Times,serif" font-size="14.00">Layer 6 MLP (TP=8)</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_layer_7_attn</title>
<path fill="lightgray" stroke="black" d="M20,-870.48C20,-870.48 1722,-870.48 1722,-870.48 1728,-870.48 1734,-876.48 1734,-882.48 1734,-882.48 1734,-1307.96 1734,-1307.96 1734,-1313.96 1728,-1319.96 1722,-1319.96 1722,-1319.96 20,-1319.96 20,-1319.96 14,-1319.96 8,-1313.96 8,-1307.96 8,-1307.96 8,-882.48 8,-882.48 8,-876.48 14,-870.48 20,-870.48"/>
<text text-anchor="middle" x="871" y="-1304.76" font-family="Times,serif" font-size="14.00">Layer 7 Attention (TP=8)</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_layer_7_mlp</title>
<path fill="lightgray" stroke="black" d="M308,-339.74C308,-339.74 1434,-339.74 1434,-339.74 1440,-339.74 1446,-345.74 1446,-351.74 1446,-351.74 1446,-672.48 1446,-672.48 1446,-678.48 1440,-684.48 1434,-684.48 1434,-684.48 308,-684.48 308,-684.48 302,-684.48 296,-678.48 296,-672.48 296,-672.48 296,-351.74 296,-351.74 296,-345.74 302,-339.74 308,-339.74"/>
<text text-anchor="middle" x="871" y="-669.28" font-family="Times,serif" font-size="14.00">Layer 7 MLP (TP=8)</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_layer_8_attn</title>
<path fill="lightgray" stroke="black" d="M5341,-9300.02C5341,-9300.02 7098,-9300.02 7098,-9300.02 7104,-9300.02 7110,-9306.02 7110,-9312.02 7110,-9312.02 7110,-9782.37 7110,-9782.37 7110,-9788.37 7104,-9794.37 7098,-9794.37 7098,-9794.37 5341,-9794.37 5341,-9794.37 5335,-9794.37 5329,-9788.37 5329,-9782.37 5329,-9782.37 5329,-9312.02 5329,-9312.02 5329,-9306.02 5335,-9300.02 5341,-9300.02"/>
<text text-anchor="middle" x="6219.5" y="-9779.17" font-family="Times,serif" font-size="14.00">Layer 8 Attention (TP=8)</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_layer_8_mlp</title>
<path fill="lightgray" stroke="black" d="M5648,-8713.28C5648,-8713.28 6774,-8713.28 6774,-8713.28 6780,-8713.28 6786,-8719.28 6786,-8725.28 6786,-8725.28 6786,-9064.02 6786,-9064.02 6786,-9070.02 6780,-9076.02 6774,-9076.02 6774,-9076.02 5648,-9076.02 5648,-9076.02 5642,-9076.02 5636,-9070.02 5636,-9064.02 5636,-9064.02 5636,-8725.28 5636,-8725.28 5636,-8719.28 5642,-8713.28 5648,-8713.28"/>
<text text-anchor="middle" x="6211" y="-9060.82" font-family="Times,serif" font-size="14.00">Layer 8 MLP (TP=8)</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_layer_9_attn</title>
<path fill="lightgray" stroke="black" d="M7130,-9300.02C7130,-9300.02 8887,-9300.02 8887,-9300.02 8893,-9300.02 8899,-9306.02 8899,-9312.02 8899,-9312.02 8899,-9782.37 8899,-9782.37 8899,-9788.37 8893,-9794.37 8887,-9794.37 8887,-9794.37 7130,-9794.37 7130,-9794.37 7124,-9794.37 7118,-9788.37 7118,-9782.37 7118,-9782.37 7118,-9312.02 7118,-9312.02 7118,-9306.02 7124,-9300.02 7130,-9300.02"/>
<text text-anchor="middle" x="8008.5" y="-9779.17" font-family="Times,serif" font-size="14.00">Layer 9 Attention (TP=8)</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_layer_9_mlp</title>
<path fill="lightgray" stroke="black" d="M7436,-8713.28C7436,-8713.28 8562,-8713.28 8562,-8713.28 8568,-8713.28 8574,-8719.28 8574,-8725.28 8574,-8725.28 8574,-9064.02 8574,-9064.02 8574,-9070.02 8568,-9076.02 8562,-9076.02 8562,-9076.02 7436,-9076.02 7436,-9076.02 7430,-9076.02 7424,-9070.02 7424,-9064.02 7424,-9064.02 7424,-8725.28 7424,-8725.28 7424,-8719.28 7430,-8713.28 7436,-8713.28"/>
<text text-anchor="middle" x="7999" y="-9060.82" font-family="Times,serif" font-size="14.00">Layer 9 MLP (TP=8)</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_layer_10_attn</title>
<path fill="lightgray" stroke="black" d="M8919,-9300.02C8919,-9300.02 10676,-9300.02 10676,-9300.02 10682,-9300.02 10688,-9306.02 10688,-9312.02 10688,-9312.02 10688,-9782.37 10688,-9782.37 10688,-9788.37 10682,-9794.37 10676,-9794.37 10676,-9794.37 8919,-9794.37 8919,-9794.37 8913,-9794.37 8907,-9788.37 8907,-9782.37 8907,-9782.37 8907,-9312.02 8907,-9312.02 8907,-9306.02 8913,-9300.02 8919,-9300.02"/>
<text text-anchor="middle" x="9797.5" y="-9779.17" font-family="Times,serif" font-size="14.00">Layer 10 Attention (TP=8)</text>
</g>
<g id="clust22" class="cluster">
<title>cluster_layer_10_mlp</title>
<path fill="lightgray" stroke="black" d="M9226,-8713.28C9226,-8713.28 10352,-8713.28 10352,-8713.28 10358,-8713.28 10364,-8719.28 10364,-8725.28 10364,-8725.28 10364,-9064.02 10364,-9064.02 10364,-9070.02 10358,-9076.02 10352,-9076.02 10352,-9076.02 9226,-9076.02 9226,-9076.02 9220,-9076.02 9214,-9070.02 9214,-9064.02 9214,-9064.02 9214,-8725.28 9214,-8725.28 9214,-8719.28 9220,-8713.28 9226,-8713.28"/>
<text text-anchor="middle" x="9789" y="-9060.82" font-family="Times,serif" font-size="14.00">Layer 10 MLP (TP=8)</text>
</g>
<g id="clust23" class="cluster">
<title>cluster_layer_11_attn</title>
<path fill="lightgray" stroke="black" d="M10708,-9300.02C10708,-9300.02 12465,-9300.02 12465,-9300.02 12471,-9300.02 12477,-9306.02 12477,-9312.02 12477,-9312.02 12477,-9782.37 12477,-9782.37 12477,-9788.37 12471,-9794.37 12465,-9794.37 12465,-9794.37 10708,-9794.37 10708,-9794.37 10702,-9794.37 10696,-9788.37 10696,-9782.37 10696,-9782.37 10696,-9312.02 10696,-9312.02 10696,-9306.02 10702,-9300.02 10708,-9300.02"/>
<text text-anchor="middle" x="11586.5" y="-9779.17" font-family="Times,serif" font-size="14.00">Layer 11 Attention (TP=8)</text>
</g>
<g id="clust24" class="cluster">
<title>cluster_layer_11_mlp</title>
<path fill="lightgray" stroke="black" d="M11015,-8713.28C11015,-8713.28 12141,-8713.28 12141,-8713.28 12147,-8713.28 12153,-8719.28 12153,-8725.28 12153,-8725.28 12153,-9064.02 12153,-9064.02 12153,-9070.02 12147,-9076.02 12141,-9076.02 12141,-9076.02 11015,-9076.02 11015,-9076.02 11009,-9076.02 11003,-9070.02 11003,-9064.02 11003,-9064.02 11003,-8725.28 11003,-8725.28 11003,-8719.28 11009,-8713.28 11015,-8713.28"/>
<text text-anchor="middle" x="11578" y="-9060.82" font-family="Times,serif" font-size="14.00">Layer 11 MLP (TP=8)</text>
</g>
<g id="clust25" class="cluster">
<title>cluster_layer_12_attn</title>
<path fill="lightgray" stroke="black" d="M12497,-9300.02C12497,-9300.02 14254,-9300.02 14254,-9300.02 14260,-9300.02 14266,-9306.02 14266,-9312.02 14266,-9312.02 14266,-9782.37 14266,-9782.37 14266,-9788.37 14260,-9794.37 14254,-9794.37 14254,-9794.37 12497,-9794.37 12497,-9794.37 12491,-9794.37 12485,-9788.37 12485,-9782.37 12485,-9782.37 12485,-9312.02 12485,-9312.02 12485,-9306.02 12491,-9300.02 12497,-9300.02"/>
<text text-anchor="middle" x="13375.5" y="-9779.17" font-family="Times,serif" font-size="14.00">Layer 12 Attention (TP=8)</text>
</g>
<g id="clust26" class="cluster">
<title>cluster_layer_12_mlp</title>
<path fill="lightgray" stroke="black" d="M12794,-8713.28C12794,-8713.28 13920,-8713.28 13920,-8713.28 13926,-8713.28 13932,-8719.28 13932,-8725.28 13932,-8725.28 13932,-9064.02 13932,-9064.02 13932,-9070.02 13926,-9076.02 13920,-9076.02 13920,-9076.02 12794,-9076.02 12794,-9076.02 12788,-9076.02 12782,-9070.02 12782,-9064.02 12782,-9064.02 12782,-8725.28 12782,-8725.28 12782,-8719.28 12788,-8713.28 12794,-8713.28"/>
<text text-anchor="middle" x="13357" y="-9060.82" font-family="Times,serif" font-size="14.00">Layer 12 MLP (TP=8)</text>
</g>
<g id="clust27" class="cluster">
<title>cluster_layer_13_attn</title>
<path fill="lightgray" stroke="black" d="M14286,-9300.02C14286,-9300.02 16043,-9300.02 16043,-9300.02 16049,-9300.02 16055,-9306.02 16055,-9312.02 16055,-9312.02 16055,-9782.37 16055,-9782.37 16055,-9788.37 16049,-9794.37 16043,-9794.37 16043,-9794.37 14286,-9794.37 14286,-9794.37 14280,-9794.37 14274,-9788.37 14274,-9782.37 14274,-9782.37 14274,-9312.02 14274,-9312.02 14274,-9306.02 14280,-9300.02 14286,-9300.02"/>
<text text-anchor="middle" x="15164.5" y="-9779.17" font-family="Times,serif" font-size="14.00">Layer 13 Attention (TP=8)</text>
</g>
<g id="clust28" class="cluster">
<title>cluster_layer_13_mlp</title>
<path fill="lightgray" stroke="black" d="M14592,-8713.28C14592,-8713.28 15718,-8713.28 15718,-8713.28 15724,-8713.28 15730,-8719.28 15730,-8725.28 15730,-8725.28 15730,-9064.02 15730,-9064.02 15730,-9070.02 15724,-9076.02 15718,-9076.02 15718,-9076.02 14592,-9076.02 14592,-9076.02 14586,-9076.02 14580,-9070.02 14580,-9064.02 14580,-9064.02 14580,-8725.28 14580,-8725.28 14580,-8719.28 14586,-8713.28 14592,-8713.28"/>
<text text-anchor="middle" x="15155" y="-9060.82" font-family="Times,serif" font-size="14.00">Layer 13 MLP (TP=8)</text>
</g>
<g id="clust29" class="cluster">
<title>cluster_layer_14_attn</title>
<path fill="lightgray" stroke="black" d="M16075,-9300.02C16075,-9300.02 17832,-9300.02 17832,-9300.02 17838,-9300.02 17844,-9306.02 17844,-9312.02 17844,-9312.02 17844,-9782.37 17844,-9782.37 17844,-9788.37 17838,-9794.37 17832,-9794.37 17832,-9794.37 16075,-9794.37 16075,-9794.37 16069,-9794.37 16063,-9788.37 16063,-9782.37 16063,-9782.37 16063,-9312.02 16063,-9312.02 16063,-9306.02 16069,-9300.02 16075,-9300.02"/>
<text text-anchor="middle" x="16953.5" y="-9779.17" font-family="Times,serif" font-size="14.00">Layer 14 Attention (TP=8)</text>
</g>
<g id="clust30" class="cluster">
<title>cluster_layer_14_mlp</title>
<path fill="lightgray" stroke="black" d="M16381,-8713.28C16381,-8713.28 17507,-8713.28 17507,-8713.28 17513,-8713.28 17519,-8719.28 17519,-8725.28 17519,-8725.28 17519,-9064.02 17519,-9064.02 17519,-9070.02 17513,-9076.02 17507,-9076.02 17507,-9076.02 16381,-9076.02 16381,-9076.02 16375,-9076.02 16369,-9070.02 16369,-9064.02 16369,-9064.02 16369,-8725.28 16369,-8725.28 16369,-8719.28 16375,-8713.28 16381,-8713.28"/>
<text text-anchor="middle" x="16944" y="-9060.82" font-family="Times,serif" font-size="14.00">Layer 14 MLP (TP=8)</text>
</g>
<g id="clust31" class="cluster">
<title>cluster_layer_15_attn</title>
<path fill="lightgray" stroke="black" d="M17864,-9300.02C17864,-9300.02 19621,-9300.02 19621,-9300.02 19627,-9300.02 19633,-9306.02 19633,-9312.02 19633,-9312.02 19633,-9782.37 19633,-9782.37 19633,-9788.37 19627,-9794.37 19621,-9794.37 19621,-9794.37 17864,-9794.37 17864,-9794.37 17858,-9794.37 17852,-9788.37 17852,-9782.37 17852,-9782.37 17852,-9312.02 17852,-9312.02 17852,-9306.02 17858,-9300.02 17864,-9300.02"/>
<text text-anchor="middle" x="18742.5" y="-9779.17" font-family="Times,serif" font-size="14.00">Layer 15 Attention (TP=8)</text>
</g>
<g id="clust32" class="cluster">
<title>cluster_layer_15_mlp</title>
<path fill="lightgray" stroke="black" d="M18170,-8713.28C18170,-8713.28 19296,-8713.28 19296,-8713.28 19302,-8713.28 19308,-8719.28 19308,-8725.28 19308,-8725.28 19308,-9064.02 19308,-9064.02 19308,-9070.02 19302,-9076.02 19296,-9076.02 19296,-9076.02 18170,-9076.02 18170,-9076.02 18164,-9076.02 18158,-9070.02 18158,-9064.02 18158,-9064.02 18158,-8725.28 18158,-8725.28 18158,-8719.28 18164,-8713.28 18170,-8713.28"/>
<text text-anchor="middle" x="18733" y="-9060.82" font-family="Times,serif" font-size="14.00">Layer 15 MLP (TP=8)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightcoral" stroke="black" points="4969,-9804.87 4871,-9736.87 4969,-9668.87 5067,-9736.87 4969,-9804.87"/>
<text text-anchor="middle" x="4969" y="-9755.67" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="4969" y="-9740.67" font-family="Times,serif" font-size="14.00">Batch: 128</text>
<text text-anchor="middle" x="4969" y="-9725.67" font-family="Times,serif" font-size="14.00">Seq: 10000</text>
<text text-anchor="middle" x="4969" y="-9710.67" font-family="Times,serif" font-size="14.00">Dim: 4096</text>
</g>
<!-- layer_0_qkv_gpu0 -->
<g id="node2" class="node">
<title>layer_0_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="5033,-9629.87 4905,-9629.87 4905,-9576.87 5033,-9576.87 5033,-9629.87"/>
<text text-anchor="middle" x="4969" y="-9614.67" font-family="Times,serif" font-size="14.00">QKV Proj GPU0</text>
<text text-anchor="middle" x="4969" y="-9599.67" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4969" y="-9584.67" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- input&#45;&gt;layer_0_qkv_gpu0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_0_qkv_gpu0</title>
<path fill="none" stroke="black" d="M4969,-9668.58C4969,-9658.79 4969,-9649.04 4969,-9640.21"/>
<polygon fill="black" stroke="black" points="4972.5,-9639.95 4969,-9629.95 4965.5,-9639.95 4972.5,-9639.95"/>
</g>
<!-- layer_0_qkv_comm -->
<g id="node10" class="node">
<title>layer_0_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="4458" cy="-9513.63" rx="85.62" ry="26.74"/>
<text text-anchor="middle" x="4458" y="-9517.43" font-family="Times,serif" font-size="14.00">QKV AllGather</text>
<text text-anchor="middle" x="4458" y="-9502.43" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_0_qkv_gpu0&#45;&gt;layer_0_qkv_comm -->
<g id="edge2" class="edge">
<title>layer_0_qkv_gpu0&#45;&gt;layer_0_qkv_comm</title>
<path fill="none" stroke="black" d="M4904.73,-9578.81C4901.79,-9577.98 4898.87,-9577.21 4896,-9576.5 4778.4,-9547.67 4639.51,-9530.88 4550.16,-9522.24"/>
<polygon fill="black" stroke="black" points="4550.34,-9518.74 4540.06,-9521.28 4549.68,-9525.71 4550.34,-9518.74"/>
</g>
<!-- layer_0_qkv_gpu1 -->
<g id="node3" class="node">
<title>layer_0_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="4887,-9629.87 4759,-9629.87 4759,-9576.87 4887,-9576.87 4887,-9629.87"/>
<text text-anchor="middle" x="4823" y="-9614.67" font-family="Times,serif" font-size="14.00">QKV Proj GPU1</text>
<text text-anchor="middle" x="4823" y="-9599.67" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4823" y="-9584.67" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_0_qkv_gpu1&#45;&gt;layer_0_qkv_comm -->
<g id="edge3" class="edge">
<title>layer_0_qkv_gpu1&#45;&gt;layer_0_qkv_comm</title>
<path fill="none" stroke="black" d="M4758.66,-9579.05C4755.74,-9578.16 4752.85,-9577.31 4750,-9576.5 4680.57,-9556.94 4600.32,-9540.36 4541.53,-9529.3"/>
<polygon fill="black" stroke="black" points="4542.02,-9525.83 4531.55,-9527.44 4540.74,-9532.71 4542.02,-9525.83"/>
</g>
<!-- layer_0_qkv_gpu2 -->
<g id="node4" class="node">
<title>layer_0_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="4741,-9629.87 4613,-9629.87 4613,-9576.87 4741,-9576.87 4741,-9629.87"/>
<text text-anchor="middle" x="4677" y="-9614.67" font-family="Times,serif" font-size="14.00">QKV Proj GPU2</text>
<text text-anchor="middle" x="4677" y="-9599.67" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4677" y="-9584.67" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_0_qkv_gpu2&#45;&gt;layer_0_qkv_comm -->
<g id="edge4" class="edge">
<title>layer_0_qkv_gpu2&#45;&gt;layer_0_qkv_comm</title>
<path fill="none" stroke="black" d="M4613.07,-9576.76C4583.33,-9564.85 4548.14,-9550.75 4518.81,-9539"/>
<polygon fill="black" stroke="black" points="4520.09,-9535.74 4509.5,-9535.27 4517.49,-9542.24 4520.09,-9535.74"/>
</g>
<!-- layer_0_qkv_gpu3 -->
<g id="node5" class="node">
<title>layer_0_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="4595,-9629.87 4467,-9629.87 4467,-9576.87 4595,-9576.87 4595,-9629.87"/>
<text text-anchor="middle" x="4531" y="-9614.67" font-family="Times,serif" font-size="14.00">QKV Proj GPU3</text>
<text text-anchor="middle" x="4531" y="-9599.67" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4531" y="-9584.67" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_0_qkv_gpu3&#45;&gt;layer_0_qkv_comm -->
<g id="edge5" class="edge">
<title>layer_0_qkv_gpu3&#45;&gt;layer_0_qkv_comm</title>
<path fill="none" stroke="black" d="M4509.49,-9576.52C4501.94,-9567.44 4493.34,-9557.11 4485.37,-9547.53"/>
<polygon fill="black" stroke="black" points="4487.94,-9545.14 4478.85,-9539.69 4482.56,-9549.62 4487.94,-9545.14"/>
</g>
<!-- layer_0_qkv_gpu4 -->
<g id="node6" class="node">
<title>layer_0_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="4449,-9629.87 4321,-9629.87 4321,-9576.87 4449,-9576.87 4449,-9629.87"/>
<text text-anchor="middle" x="4385" y="-9614.67" font-family="Times,serif" font-size="14.00">QKV Proj GPU4</text>
<text text-anchor="middle" x="4385" y="-9599.67" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4385" y="-9584.67" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_0_qkv_gpu4&#45;&gt;layer_0_qkv_comm -->
<g id="edge6" class="edge">
<title>layer_0_qkv_gpu4&#45;&gt;layer_0_qkv_comm</title>
<path fill="none" stroke="black" d="M4406.51,-9576.52C4414.06,-9567.44 4422.66,-9557.11 4430.63,-9547.53"/>
<polygon fill="black" stroke="black" points="4433.44,-9549.62 4437.15,-9539.69 4428.06,-9545.14 4433.44,-9549.62"/>
</g>
<!-- layer_0_qkv_gpu5 -->
<g id="node7" class="node">
<title>layer_0_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="4303,-9629.87 4175,-9629.87 4175,-9576.87 4303,-9576.87 4303,-9629.87"/>
<text text-anchor="middle" x="4239" y="-9614.67" font-family="Times,serif" font-size="14.00">QKV Proj GPU5</text>
<text text-anchor="middle" x="4239" y="-9599.67" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4239" y="-9584.67" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_0_qkv_gpu5&#45;&gt;layer_0_qkv_comm -->
<g id="edge7" class="edge">
<title>layer_0_qkv_gpu5&#45;&gt;layer_0_qkv_comm</title>
<path fill="none" stroke="black" d="M4302.93,-9576.76C4332.67,-9564.85 4367.86,-9550.75 4397.19,-9539"/>
<polygon fill="black" stroke="black" points="4398.51,-9542.24 4406.5,-9535.27 4395.91,-9535.74 4398.51,-9542.24"/>
</g>
<!-- layer_0_qkv_gpu6 -->
<g id="node8" class="node">
<title>layer_0_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4157,-9629.87 4029,-9629.87 4029,-9576.87 4157,-9576.87 4157,-9629.87"/>
<text text-anchor="middle" x="4093" y="-9614.67" font-family="Times,serif" font-size="14.00">QKV Proj GPU6</text>
<text text-anchor="middle" x="4093" y="-9599.67" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4093" y="-9584.67" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_0_qkv_gpu6&#45;&gt;layer_0_qkv_comm -->
<g id="edge8" class="edge">
<title>layer_0_qkv_gpu6&#45;&gt;layer_0_qkv_comm</title>
<path fill="none" stroke="black" d="M4157.34,-9579.05C4160.26,-9578.16 4163.15,-9577.31 4166,-9576.5 4235.43,-9556.94 4315.68,-9540.36 4374.47,-9529.3"/>
<polygon fill="black" stroke="black" points="4375.26,-9532.71 4384.45,-9527.44 4373.98,-9525.83 4375.26,-9532.71"/>
</g>
<!-- layer_0_qkv_gpu7 -->
<g id="node9" class="node">
<title>layer_0_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="4011,-9629.87 3883,-9629.87 3883,-9576.87 4011,-9576.87 4011,-9629.87"/>
<text text-anchor="middle" x="3947" y="-9614.67" font-family="Times,serif" font-size="14.00">QKV Proj GPU7</text>
<text text-anchor="middle" x="3947" y="-9599.67" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3947" y="-9584.67" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_0_qkv_gpu7&#45;&gt;layer_0_qkv_comm -->
<g id="edge9" class="edge">
<title>layer_0_qkv_gpu7&#45;&gt;layer_0_qkv_comm</title>
<path fill="none" stroke="black" d="M4011.27,-9578.81C4014.21,-9577.98 4017.13,-9577.21 4020,-9576.5 4137.6,-9547.67 4276.49,-9530.88 4365.84,-9522.24"/>
<polygon fill="black" stroke="black" points="4366.32,-9525.71 4375.94,-9521.28 4365.66,-9518.74 4366.32,-9525.71"/>
</g>
<!-- layer_0_attn_comp_gpu0 -->
<g id="node11" class="node">
<title>layer_0_attn_comp_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3801,-9450.76 3603,-9450.76 3603,-9397.76 3801,-9397.76 3801,-9450.76"/>
<text text-anchor="middle" x="3702" y="-9435.56" font-family="Times,serif" font-size="14.00">Attention Compute GPU0</text>
<text text-anchor="middle" x="3702" y="-9420.56" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="3702" y="-9405.56" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_0_qkv_comm&#45;&gt;layer_0_attn_comp_gpu0 -->
<g id="edge10" class="edge">
<title>layer_0_qkv_comm&#45;&gt;layer_0_attn_comp_gpu0</title>
<path fill="none" stroke="black" d="M4373.9,-9508.28C4251.86,-9501.15 4018.52,-9484.45 3811.22,-9450.87"/>
<polygon fill="black" stroke="black" points="3811.49,-9447.37 3801.06,-9449.21 3810.36,-9454.28 3811.49,-9447.37"/>
</g>
<!-- layer_0_attn_comp_gpu1 -->
<g id="node12" class="node">
<title>layer_0_attn_comp_gpu1</title>
<polygon fill="lightblue" stroke="black" points="4017,-9450.76 3819,-9450.76 3819,-9397.76 4017,-9397.76 4017,-9450.76"/>
<text text-anchor="middle" x="3918" y="-9435.56" font-family="Times,serif" font-size="14.00">Attention Compute GPU1</text>
<text text-anchor="middle" x="3918" y="-9420.56" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="3918" y="-9405.56" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_0_qkv_comm&#45;&gt;layer_0_attn_comp_gpu1 -->
<g id="edge11" class="edge">
<title>layer_0_qkv_comm&#45;&gt;layer_0_attn_comp_gpu1</title>
<path fill="none" stroke="black" d="M4378.42,-9503.41C4293.69,-9493.09 4155.51,-9474.86 4027.11,-9450.91"/>
<polygon fill="black" stroke="black" points="4027.57,-9447.43 4017.09,-9449.02 4026.27,-9454.31 4027.57,-9447.43"/>
</g>
<!-- layer_0_attn_comp_gpu2 -->
<g id="node13" class="node">
<title>layer_0_attn_comp_gpu2</title>
<polygon fill="lightblue" stroke="black" points="4233,-9450.76 4035,-9450.76 4035,-9397.76 4233,-9397.76 4233,-9450.76"/>
<text text-anchor="middle" x="4134" y="-9435.56" font-family="Times,serif" font-size="14.00">Attention Compute GPU2</text>
<text text-anchor="middle" x="4134" y="-9420.56" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="4134" y="-9405.56" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_0_qkv_comm&#45;&gt;layer_0_attn_comp_gpu2 -->
<g id="edge12" class="edge">
<title>layer_0_qkv_comm&#45;&gt;layer_0_attn_comp_gpu2</title>
<path fill="none" stroke="black" d="M4394.37,-9495.48C4350.05,-9483.52 4289.92,-9467.31 4238.61,-9453.47"/>
<polygon fill="black" stroke="black" points="4239.37,-9450.05 4228.8,-9450.83 4237.55,-9456.81 4239.37,-9450.05"/>
</g>
<!-- layer_0_attn_comp_gpu3 -->
<g id="node14" class="node">
<title>layer_0_attn_comp_gpu3</title>
<polygon fill="lightblue" stroke="black" points="4449,-9450.76 4251,-9450.76 4251,-9397.76 4449,-9397.76 4449,-9450.76"/>
<text text-anchor="middle" x="4350" y="-9435.56" font-family="Times,serif" font-size="14.00">Attention Compute GPU3</text>
<text text-anchor="middle" x="4350" y="-9420.56" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="4350" y="-9405.56" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_0_qkv_comm&#45;&gt;layer_0_attn_comp_gpu3 -->
<g id="edge13" class="edge">
<title>layer_0_qkv_comm&#45;&gt;layer_0_attn_comp_gpu3</title>
<path fill="none" stroke="black" d="M4427.92,-9488.3C4416.14,-9478.77 4402.46,-9467.7 4389.88,-9457.53"/>
<polygon fill="black" stroke="black" points="4391.78,-9454.56 4381.81,-9450.99 4387.38,-9460.01 4391.78,-9454.56"/>
</g>
<!-- layer_0_attn_comp_gpu4 -->
<g id="node15" class="node">
<title>layer_0_attn_comp_gpu4</title>
<polygon fill="lightblue" stroke="black" points="4665,-9450.76 4467,-9450.76 4467,-9397.76 4665,-9397.76 4665,-9450.76"/>
<text text-anchor="middle" x="4566" y="-9435.56" font-family="Times,serif" font-size="14.00">Attention Compute GPU4</text>
<text text-anchor="middle" x="4566" y="-9420.56" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="4566" y="-9405.56" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_0_qkv_comm&#45;&gt;layer_0_attn_comp_gpu4 -->
<g id="edge14" class="edge">
<title>layer_0_qkv_comm&#45;&gt;layer_0_attn_comp_gpu4</title>
<path fill="none" stroke="black" d="M4488.08,-9488.3C4499.86,-9478.77 4513.54,-9467.7 4526.12,-9457.53"/>
<polygon fill="black" stroke="black" points="4528.62,-9460.01 4534.19,-9450.99 4524.22,-9454.56 4528.62,-9460.01"/>
</g>
<!-- layer_0_attn_comp_gpu5 -->
<g id="node16" class="node">
<title>layer_0_attn_comp_gpu5</title>
<polygon fill="lightblue" stroke="black" points="4881,-9450.76 4683,-9450.76 4683,-9397.76 4881,-9397.76 4881,-9450.76"/>
<text text-anchor="middle" x="4782" y="-9435.56" font-family="Times,serif" font-size="14.00">Attention Compute GPU5</text>
<text text-anchor="middle" x="4782" y="-9420.56" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="4782" y="-9405.56" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_0_qkv_comm&#45;&gt;layer_0_attn_comp_gpu5 -->
<g id="edge15" class="edge">
<title>layer_0_qkv_comm&#45;&gt;layer_0_attn_comp_gpu5</title>
<path fill="none" stroke="black" d="M4521.63,-9495.48C4565.95,-9483.52 4626.08,-9467.31 4677.39,-9453.47"/>
<polygon fill="black" stroke="black" points="4678.45,-9456.81 4687.2,-9450.83 4676.63,-9450.05 4678.45,-9456.81"/>
</g>
<!-- layer_0_attn_comp_gpu6 -->
<g id="node17" class="node">
<title>layer_0_attn_comp_gpu6</title>
<polygon fill="lightblue" stroke="black" points="5097,-9450.76 4899,-9450.76 4899,-9397.76 5097,-9397.76 5097,-9450.76"/>
<text text-anchor="middle" x="4998" y="-9435.56" font-family="Times,serif" font-size="14.00">Attention Compute GPU6</text>
<text text-anchor="middle" x="4998" y="-9420.56" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="4998" y="-9405.56" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_0_qkv_comm&#45;&gt;layer_0_attn_comp_gpu6 -->
<g id="edge16" class="edge">
<title>layer_0_qkv_comm&#45;&gt;layer_0_attn_comp_gpu6</title>
<path fill="none" stroke="black" d="M4537.58,-9503.41C4622.31,-9493.09 4760.49,-9474.86 4888.89,-9450.91"/>
<polygon fill="black" stroke="black" points="4889.73,-9454.31 4898.91,-9449.02 4888.43,-9447.43 4889.73,-9454.31"/>
</g>
<!-- layer_0_attn_comp_gpu7 -->
<g id="node18" class="node">
<title>layer_0_attn_comp_gpu7</title>
<polygon fill="lightblue" stroke="black" points="5313,-9450.76 5115,-9450.76 5115,-9397.76 5313,-9397.76 5313,-9450.76"/>
<text text-anchor="middle" x="5214" y="-9435.56" font-family="Times,serif" font-size="14.00">Attention Compute GPU7</text>
<text text-anchor="middle" x="5214" y="-9420.56" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="5214" y="-9405.56" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_0_qkv_comm&#45;&gt;layer_0_attn_comp_gpu7 -->
<g id="edge17" class="edge">
<title>layer_0_qkv_comm&#45;&gt;layer_0_attn_comp_gpu7</title>
<path fill="none" stroke="black" d="M4542.1,-9508.28C4664.14,-9501.15 4897.48,-9484.45 5104.78,-9450.87"/>
<polygon fill="black" stroke="black" points="5105.64,-9454.28 5114.94,-9449.21 5104.51,-9447.37 5105.64,-9454.28"/>
</g>
<!-- layer_0_attn_out_gpu0 -->
<g id="node19" class="node">
<title>layer_0_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3817,-9361.39 3659,-9361.39 3659,-9308.39 3817,-9308.39 3817,-9361.39"/>
<text text-anchor="middle" x="3738" y="-9346.19" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU0</text>
<text text-anchor="middle" x="3738" y="-9331.19" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3738" y="-9316.19" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_0_attn_comp_gpu0&#45;&gt;layer_0_attn_out_gpu0 -->
<g id="edge18" class="edge">
<title>layer_0_attn_comp_gpu0&#45;&gt;layer_0_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M3712.61,-9397.52C3716.05,-9389.17 3719.93,-9379.75 3723.6,-9370.84"/>
<polygon fill="black" stroke="black" points="3726.9,-9372.03 3727.47,-9361.45 3720.42,-9369.36 3726.9,-9372.03"/>
</g>
<!-- layer_0_attn_out_gpu1 -->
<g id="node20" class="node">
<title>layer_0_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="4029,-9361.39 3871,-9361.39 3871,-9308.39 4029,-9308.39 4029,-9361.39"/>
<text text-anchor="middle" x="3950" y="-9346.19" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU1</text>
<text text-anchor="middle" x="3950" y="-9331.19" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3950" y="-9316.19" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_0_attn_comp_gpu1&#45;&gt;layer_0_attn_out_gpu1 -->
<g id="edge19" class="edge">
<title>layer_0_attn_comp_gpu1&#45;&gt;layer_0_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M3927.43,-9397.52C3930.49,-9389.17 3933.94,-9379.75 3937.2,-9370.84"/>
<polygon fill="black" stroke="black" points="3940.49,-9372.04 3940.64,-9361.45 3933.91,-9369.64 3940.49,-9372.04"/>
</g>
<!-- layer_0_attn_out_gpu2 -->
<g id="node21" class="node">
<title>layer_0_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="4238,-9361.39 4080,-9361.39 4080,-9308.39 4238,-9308.39 4238,-9361.39"/>
<text text-anchor="middle" x="4159" y="-9346.19" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU2</text>
<text text-anchor="middle" x="4159" y="-9331.19" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4159" y="-9316.19" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_0_attn_comp_gpu2&#45;&gt;layer_0_attn_out_gpu2 -->
<g id="edge20" class="edge">
<title>layer_0_attn_comp_gpu2&#45;&gt;layer_0_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M4141.37,-9397.52C4143.73,-9389.26 4146.39,-9379.95 4148.92,-9371.13"/>
<polygon fill="black" stroke="black" points="4152.3,-9372.03 4151.69,-9361.45 4145.57,-9370.1 4152.3,-9372.03"/>
</g>
<!-- layer_0_attn_out_gpu3 -->
<g id="node22" class="node">
<title>layer_0_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="4439,-9361.39 4281,-9361.39 4281,-9308.39 4439,-9308.39 4439,-9361.39"/>
<text text-anchor="middle" x="4360" y="-9346.19" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU3</text>
<text text-anchor="middle" x="4360" y="-9331.19" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4360" y="-9316.19" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_0_attn_comp_gpu3&#45;&gt;layer_0_attn_out_gpu3 -->
<g id="edge21" class="edge">
<title>layer_0_attn_comp_gpu3&#45;&gt;layer_0_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M4352.95,-9397.52C4353.88,-9389.34 4354.93,-9380.15 4355.93,-9371.41"/>
<polygon fill="black" stroke="black" points="4359.41,-9371.78 4357.07,-9361.45 4352.46,-9370.99 4359.41,-9371.78"/>
</g>
<!-- layer_0_attn_out_gpu4 -->
<g id="node23" class="node">
<title>layer_0_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="4635,-9361.39 4477,-9361.39 4477,-9308.39 4635,-9308.39 4635,-9361.39"/>
<text text-anchor="middle" x="4556" y="-9346.19" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU4</text>
<text text-anchor="middle" x="4556" y="-9331.19" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4556" y="-9316.19" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_0_attn_comp_gpu4&#45;&gt;layer_0_attn_out_gpu4 -->
<g id="edge22" class="edge">
<title>layer_0_attn_comp_gpu4&#45;&gt;layer_0_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M4563.05,-9397.52C4562.12,-9389.34 4561.07,-9380.15 4560.07,-9371.41"/>
<polygon fill="black" stroke="black" points="4563.54,-9370.99 4558.93,-9361.45 4556.59,-9371.78 4563.54,-9370.99"/>
</g>
<!-- layer_0_attn_out_gpu5 -->
<g id="node24" class="node">
<title>layer_0_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="4831,-9361.39 4673,-9361.39 4673,-9308.39 4831,-9308.39 4831,-9361.39"/>
<text text-anchor="middle" x="4752" y="-9346.19" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU5</text>
<text text-anchor="middle" x="4752" y="-9331.19" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4752" y="-9316.19" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_0_attn_comp_gpu5&#45;&gt;layer_0_attn_out_gpu5 -->
<g id="edge23" class="edge">
<title>layer_0_attn_comp_gpu5&#45;&gt;layer_0_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M4773.16,-9397.52C4770.32,-9389.26 4767.13,-9379.95 4764.1,-9371.13"/>
<polygon fill="black" stroke="black" points="4767.33,-9369.77 4760.78,-9361.45 4760.71,-9372.04 4767.33,-9369.77"/>
</g>
<!-- layer_0_attn_out_gpu6 -->
<g id="node25" class="node">
<title>layer_0_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="5037,-9361.39 4879,-9361.39 4879,-9308.39 5037,-9308.39 5037,-9361.39"/>
<text text-anchor="middle" x="4958" y="-9346.19" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU6</text>
<text text-anchor="middle" x="4958" y="-9331.19" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4958" y="-9316.19" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_0_attn_comp_gpu6&#45;&gt;layer_0_attn_out_gpu6 -->
<g id="edge24" class="edge">
<title>layer_0_attn_comp_gpu6&#45;&gt;layer_0_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M4986.22,-9397.52C4982.35,-9389.08 4977.99,-9379.55 4973.87,-9370.56"/>
<polygon fill="black" stroke="black" points="4977.05,-9369.09 4969.7,-9361.45 4970.68,-9372 4977.05,-9369.09"/>
</g>
<!-- layer_0_attn_out_gpu7 -->
<g id="node26" class="node">
<title>layer_0_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="5248,-9361.39 5090,-9361.39 5090,-9308.39 5248,-9308.39 5248,-9361.39"/>
<text text-anchor="middle" x="5169" y="-9346.19" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU7</text>
<text text-anchor="middle" x="5169" y="-9331.19" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="5169" y="-9316.19" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_0_attn_comp_gpu7&#45;&gt;layer_0_attn_out_gpu7 -->
<g id="edge25" class="edge">
<title>layer_0_attn_comp_gpu7&#45;&gt;layer_0_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M5200.74,-9397.52C5196.39,-9389.08 5191.49,-9379.55 5186.86,-9370.56"/>
<polygon fill="black" stroke="black" points="5189.85,-9368.74 5182.16,-9361.45 5183.63,-9371.94 5189.85,-9368.74"/>
</g>
<!-- layer_0_attn_allreduce -->
<g id="node27" class="node">
<title>layer_0_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="4448" cy="-9234.02" rx="112.36" ry="26.74"/>
<text text-anchor="middle" x="4448" y="-9237.82" font-family="Times,serif" font-size="14.00">Attention AllReduce</text>
<text text-anchor="middle" x="4448" y="-9222.82" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_0_attn_out_gpu0&#45;&gt;layer_0_attn_allreduce -->
<g id="edge26" class="edge">
<title>layer_0_attn_out_gpu0&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M3817.28,-9310.26C3832.05,-9306.43 3847.42,-9302.8 3862,-9300.02 4022.71,-9269.35 4211.19,-9251.64 4330.1,-9242.66"/>
<polygon fill="black" stroke="black" points="4330.61,-9246.14 4340.32,-9241.9 4330.09,-9239.16 4330.61,-9246.14"/>
</g>
<!-- layer_0_attn_out_gpu1&#45;&gt;layer_0_attn_allreduce -->
<g id="edge27" class="edge">
<title>layer_0_attn_out_gpu1&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M4029.11,-9310.5C4043.01,-9306.75 4057.38,-9303.09 4071,-9300.02 4162.3,-9279.43 4267.33,-9261.81 4343.3,-9250.13"/>
<polygon fill="black" stroke="black" points="4343.99,-9253.57 4353.35,-9248.6 4342.94,-9246.65 4343.99,-9253.57"/>
</g>
<!-- layer_0_attn_out_gpu2&#45;&gt;layer_0_attn_allreduce -->
<g id="edge28" class="edge">
<title>layer_0_attn_out_gpu2&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M4233.8,-9308.3C4277.49,-9293.36 4332.36,-9274.58 4375.63,-9259.78"/>
<polygon fill="black" stroke="black" points="4376.91,-9263.04 4385.24,-9256.49 4374.64,-9256.42 4376.91,-9263.04"/>
</g>
<!-- layer_0_attn_out_gpu3&#45;&gt;layer_0_attn_allreduce -->
<g id="edge29" class="edge">
<title>layer_0_attn_out_gpu3&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M4382.89,-9308.17C4393.69,-9296.04 4406.71,-9281.42 4418.26,-9268.44"/>
<polygon fill="black" stroke="black" points="4421.19,-9270.41 4425.22,-9260.61 4415.96,-9265.76 4421.19,-9270.41"/>
</g>
<!-- layer_0_attn_out_gpu4&#45;&gt;layer_0_attn_allreduce -->
<g id="edge30" class="edge">
<title>layer_0_attn_out_gpu4&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M4527.91,-9308.17C4514.17,-9295.6 4497.51,-9280.35 4482.97,-9267.03"/>
<polygon fill="black" stroke="black" points="4485.32,-9264.44 4475.58,-9260.27 4480.59,-9269.6 4485.32,-9264.44"/>
</g>
<!-- layer_0_attn_out_gpu5&#45;&gt;layer_0_attn_allreduce -->
<g id="edge31" class="edge">
<title>layer_0_attn_out_gpu5&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M4673.32,-9308.3C4626.84,-9293.19 4568.33,-9274.16 4522.58,-9259.28"/>
<polygon fill="black" stroke="black" points="4523.61,-9255.93 4513.02,-9256.17 4521.45,-9262.59 4523.61,-9255.93"/>
</g>
<!-- layer_0_attn_out_gpu6&#45;&gt;layer_0_attn_allreduce -->
<g id="edge32" class="edge">
<title>layer_0_attn_out_gpu6&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M4878.98,-9309.86C4866.02,-9306.31 4852.68,-9302.88 4840,-9300.02 4744.17,-9278.4 4633.65,-9260.72 4554.44,-9249.29"/>
<polygon fill="black" stroke="black" points="4554.85,-9245.81 4544.45,-9247.85 4553.86,-9252.74 4554.85,-9245.81"/>
</g>
<!-- layer_0_attn_out_gpu7&#45;&gt;layer_0_attn_allreduce -->
<g id="edge33" class="edge">
<title>layer_0_attn_out_gpu7&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M5089.71,-9310.06C5075.26,-9306.29 5060.25,-9302.74 5046,-9300.02 4880.99,-9268.55 4687.25,-9250.96 4566.03,-9242.24"/>
<polygon fill="black" stroke="black" points="4566.21,-9238.74 4555.98,-9241.53 4565.71,-9245.73 4566.21,-9238.74"/>
</g>
<!-- layer_0_residual1 -->
<g id="node28" class="node">
<title>layer_0_residual1</title>
<polygon fill="lightyellow" stroke="black" points="4576.61,-9160.02 4372.02,-9160.02 4319.39,-9084.02 4523.98,-9084.02 4576.61,-9160.02"/>
<text text-anchor="middle" x="4448" y="-9125.82" font-family="Times,serif" font-size="14.00">Residual Add 0</text>
<text text-anchor="middle" x="4448" y="-9110.82" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_0_attn_allreduce&#45;&gt;layer_0_residual1 -->
<g id="edge34" class="edge">
<title>layer_0_attn_allreduce&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M4448,-9206.95C4448,-9196.03 4448,-9182.99 4448,-9170.47"/>
<polygon fill="black" stroke="black" points="4451.5,-9170.14 4448,-9160.14 4444.5,-9170.14 4451.5,-9170.14"/>
</g>
<!-- layer_0_ln1 -->
<g id="node29" class="node">
<title>layer_0_ln1</title>
<polygon fill="lightblue" stroke="black" points="4503.5,-9037.52 4392.5,-9037.52 4392.5,-8999.52 4503.5,-8999.52 4503.5,-9037.52"/>
<text text-anchor="middle" x="4448" y="-9022.32" font-family="Times,serif" font-size="14.00">LayerNorm 0</text>
<text text-anchor="middle" x="4448" y="-9007.32" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_0_residual1&#45;&gt;layer_0_ln1 -->
<g id="edge35" class="edge">
<title>layer_0_residual1&#45;&gt;layer_0_ln1</title>
<path fill="none" stroke="black" d="M4448,-9083.8C4448,-9071.88 4448,-9058.89 4448,-9047.73"/>
<polygon fill="black" stroke="black" points="4451.5,-9047.67 4448,-9037.67 4444.5,-9047.67 4451.5,-9047.67"/>
</g>
<!-- layer_0_mlp1_gpu0 -->
<g id="node30" class="node">
<title>layer_0_mlp1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="5015,-8953.02 4889,-8953.02 4889,-8900.02 5015,-8900.02 5015,-8953.02"/>
<text text-anchor="middle" x="4952" y="-8937.82" font-family="Times,serif" font-size="14.00">MLP1 GPU0</text>
<text text-anchor="middle" x="4952" y="-8922.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4952" y="-8907.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp1_gpu0 -->
<g id="edge36" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp1_gpu0</title>
<path fill="none" stroke="black" d="M4503.67,-9017.19C4604.44,-9015.94 4812.88,-9010.16 4880,-8984.02 4894.2,-8978.49 4907.86,-8969.18 4919.39,-8959.7"/>
<polygon fill="black" stroke="black" points="4921.71,-8962.32 4927.02,-8953.14 4917.15,-8957.01 4921.71,-8962.32"/>
</g>
<!-- layer_0_mlp1_gpu1 -->
<g id="node31" class="node">
<title>layer_0_mlp1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="4871,-8953.02 4745,-8953.02 4745,-8900.02 4871,-8900.02 4871,-8953.02"/>
<text text-anchor="middle" x="4808" y="-8937.82" font-family="Times,serif" font-size="14.00">MLP1 GPU1</text>
<text text-anchor="middle" x="4808" y="-8922.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4808" y="-8907.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp1_gpu1 -->
<g id="edge40" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp1_gpu1</title>
<path fill="none" stroke="black" d="M4503.71,-9014.64C4575.3,-9010.32 4695.21,-9000.82 4736,-8984.02 4749.83,-8978.33 4763.23,-8969.18 4774.64,-8959.89"/>
<polygon fill="black" stroke="black" points="4777.22,-8962.29 4782.57,-8953.15 4772.69,-8956.95 4777.22,-8962.29"/>
</g>
<!-- layer_0_mlp1_gpu2 -->
<g id="node32" class="node">
<title>layer_0_mlp1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="4727,-8953.02 4601,-8953.02 4601,-8900.02 4727,-8900.02 4727,-8953.02"/>
<text text-anchor="middle" x="4664" y="-8937.82" font-family="Times,serif" font-size="14.00">MLP1 GPU2</text>
<text text-anchor="middle" x="4664" y="-8922.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4664" y="-8907.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp1_gpu2 -->
<g id="edge44" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp1_gpu2</title>
<path fill="none" stroke="black" d="M4503.57,-9010.41C4531.13,-9005.46 4564.34,-8997.28 4592,-8984.02 4605.14,-8977.72 4618.11,-8968.68 4629.35,-8959.68"/>
<polygon fill="black" stroke="black" points="4631.73,-8962.24 4637.19,-8953.16 4627.26,-8956.85 4631.73,-8962.24"/>
</g>
<!-- layer_0_mlp1_gpu3 -->
<g id="node33" class="node">
<title>layer_0_mlp1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="4583,-8953.02 4457,-8953.02 4457,-8900.02 4583,-8900.02 4583,-8953.02"/>
<text text-anchor="middle" x="4520" y="-8937.82" font-family="Times,serif" font-size="14.00">MLP1 GPU3</text>
<text text-anchor="middle" x="4520" y="-8922.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4520" y="-8907.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp1_gpu3 -->
<g id="edge48" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp1_gpu3</title>
<path fill="none" stroke="black" d="M4462.57,-8999.31C4471.35,-8988.34 4482.8,-8974.02 4493.17,-8961.06"/>
<polygon fill="black" stroke="black" points="4495.94,-8963.21 4499.45,-8953.21 4490.47,-8958.83 4495.94,-8963.21"/>
</g>
<!-- layer_0_mlp1_gpu4 -->
<g id="node34" class="node">
<title>layer_0_mlp1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="4439,-8953.02 4313,-8953.02 4313,-8900.02 4439,-8900.02 4439,-8953.02"/>
<text text-anchor="middle" x="4376" y="-8937.82" font-family="Times,serif" font-size="14.00">MLP1 GPU4</text>
<text text-anchor="middle" x="4376" y="-8922.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4376" y="-8907.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp1_gpu4 -->
<g id="edge52" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp1_gpu4</title>
<path fill="none" stroke="black" d="M4433.43,-8999.31C4424.65,-8988.34 4413.2,-8974.02 4402.83,-8961.06"/>
<polygon fill="black" stroke="black" points="4405.53,-8958.83 4396.55,-8953.21 4400.06,-8963.21 4405.53,-8958.83"/>
</g>
<!-- layer_0_mlp1_gpu5 -->
<g id="node35" class="node">
<title>layer_0_mlp1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="4295,-8953.02 4169,-8953.02 4169,-8900.02 4295,-8900.02 4295,-8953.02"/>
<text text-anchor="middle" x="4232" y="-8937.82" font-family="Times,serif" font-size="14.00">MLP1 GPU5</text>
<text text-anchor="middle" x="4232" y="-8922.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4232" y="-8907.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp1_gpu5 -->
<g id="edge56" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp1_gpu5</title>
<path fill="none" stroke="black" d="M4392.43,-9010.41C4364.87,-9005.46 4331.66,-8997.28 4304,-8984.02 4290.86,-8977.72 4277.89,-8968.68 4266.65,-8959.68"/>
<polygon fill="black" stroke="black" points="4268.74,-8956.85 4258.81,-8953.16 4264.27,-8962.24 4268.74,-8956.85"/>
</g>
<!-- layer_0_mlp1_gpu6 -->
<g id="node36" class="node">
<title>layer_0_mlp1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4151,-8953.02 4025,-8953.02 4025,-8900.02 4151,-8900.02 4151,-8953.02"/>
<text text-anchor="middle" x="4088" y="-8937.82" font-family="Times,serif" font-size="14.00">MLP1 GPU6</text>
<text text-anchor="middle" x="4088" y="-8922.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4088" y="-8907.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp1_gpu6 -->
<g id="edge60" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp1_gpu6</title>
<path fill="none" stroke="black" d="M4392.29,-9014.64C4320.7,-9010.32 4200.79,-9000.82 4160,-8984.02 4146.17,-8978.33 4132.77,-8969.18 4121.36,-8959.89"/>
<polygon fill="black" stroke="black" points="4123.31,-8956.95 4113.43,-8953.15 4118.78,-8962.29 4123.31,-8956.95"/>
</g>
<!-- layer_0_mlp1_gpu7 -->
<g id="node37" class="node">
<title>layer_0_mlp1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="4007,-8953.02 3881,-8953.02 3881,-8900.02 4007,-8900.02 4007,-8953.02"/>
<text text-anchor="middle" x="3944" y="-8937.82" font-family="Times,serif" font-size="14.00">MLP1 GPU7</text>
<text text-anchor="middle" x="3944" y="-8922.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3944" y="-8907.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp1_gpu7 -->
<g id="edge64" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp1_gpu7</title>
<path fill="none" stroke="black" d="M4392.33,-9017.19C4291.56,-9015.94 4083.12,-9010.16 4016,-8984.02 4001.8,-8978.49 3988.14,-8969.18 3976.61,-8959.7"/>
<polygon fill="black" stroke="black" points="3978.85,-8957.01 3968.98,-8953.14 3974.29,-8962.32 3978.85,-8957.01"/>
</g>
<!-- layer_0_gelu_gpu0 -->
<g id="node38" class="node">
<title>layer_0_gelu_gpu0</title>
<polygon fill="lightblue" stroke="black" points="5004,-8856.52 4900,-8856.52 4900,-8818.52 5004,-8818.52 5004,-8856.52"/>
<text text-anchor="middle" x="4952" y="-8841.32" font-family="Times,serif" font-size="14.00">GELU GPU0</text>
<text text-anchor="middle" x="4952" y="-8826.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_0_mlp1_gpu0&#45;&gt;layer_0_gelu_gpu0 -->
<g id="edge37" class="edge">
<title>layer_0_mlp1_gpu0&#45;&gt;layer_0_gelu_gpu0</title>
<path fill="none" stroke="black" d="M4952,-8899.89C4952,-8889.44 4952,-8877.32 4952,-8866.63"/>
<polygon fill="black" stroke="black" points="4955.5,-8866.53 4952,-8856.53 4948.5,-8866.53 4955.5,-8866.53"/>
</g>
<!-- layer_0_gelu_gpu1 -->
<g id="node39" class="node">
<title>layer_0_gelu_gpu1</title>
<polygon fill="lightblue" stroke="black" points="4860,-8856.52 4756,-8856.52 4756,-8818.52 4860,-8818.52 4860,-8856.52"/>
<text text-anchor="middle" x="4808" y="-8841.32" font-family="Times,serif" font-size="14.00">GELU GPU1</text>
<text text-anchor="middle" x="4808" y="-8826.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_0_mlp1_gpu1&#45;&gt;layer_0_gelu_gpu1 -->
<g id="edge41" class="edge">
<title>layer_0_mlp1_gpu1&#45;&gt;layer_0_gelu_gpu1</title>
<path fill="none" stroke="black" d="M4808,-8899.89C4808,-8889.44 4808,-8877.32 4808,-8866.63"/>
<polygon fill="black" stroke="black" points="4811.5,-8866.53 4808,-8856.53 4804.5,-8866.53 4811.5,-8866.53"/>
</g>
<!-- layer_0_gelu_gpu2 -->
<g id="node40" class="node">
<title>layer_0_gelu_gpu2</title>
<polygon fill="lightblue" stroke="black" points="4716,-8856.52 4612,-8856.52 4612,-8818.52 4716,-8818.52 4716,-8856.52"/>
<text text-anchor="middle" x="4664" y="-8841.32" font-family="Times,serif" font-size="14.00">GELU GPU2</text>
<text text-anchor="middle" x="4664" y="-8826.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_0_mlp1_gpu2&#45;&gt;layer_0_gelu_gpu2 -->
<g id="edge45" class="edge">
<title>layer_0_mlp1_gpu2&#45;&gt;layer_0_gelu_gpu2</title>
<path fill="none" stroke="black" d="M4664,-8899.89C4664,-8889.44 4664,-8877.32 4664,-8866.63"/>
<polygon fill="black" stroke="black" points="4667.5,-8866.53 4664,-8856.53 4660.5,-8866.53 4667.5,-8866.53"/>
</g>
<!-- layer_0_gelu_gpu3 -->
<g id="node41" class="node">
<title>layer_0_gelu_gpu3</title>
<polygon fill="lightblue" stroke="black" points="4572,-8856.52 4468,-8856.52 4468,-8818.52 4572,-8818.52 4572,-8856.52"/>
<text text-anchor="middle" x="4520" y="-8841.32" font-family="Times,serif" font-size="14.00">GELU GPU3</text>
<text text-anchor="middle" x="4520" y="-8826.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_0_mlp1_gpu3&#45;&gt;layer_0_gelu_gpu3 -->
<g id="edge49" class="edge">
<title>layer_0_mlp1_gpu3&#45;&gt;layer_0_gelu_gpu3</title>
<path fill="none" stroke="black" d="M4520,-8899.89C4520,-8889.44 4520,-8877.32 4520,-8866.63"/>
<polygon fill="black" stroke="black" points="4523.5,-8866.53 4520,-8856.53 4516.5,-8866.53 4523.5,-8866.53"/>
</g>
<!-- layer_0_gelu_gpu4 -->
<g id="node42" class="node">
<title>layer_0_gelu_gpu4</title>
<polygon fill="lightblue" stroke="black" points="4428,-8856.52 4324,-8856.52 4324,-8818.52 4428,-8818.52 4428,-8856.52"/>
<text text-anchor="middle" x="4376" y="-8841.32" font-family="Times,serif" font-size="14.00">GELU GPU4</text>
<text text-anchor="middle" x="4376" y="-8826.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_0_mlp1_gpu4&#45;&gt;layer_0_gelu_gpu4 -->
<g id="edge53" class="edge">
<title>layer_0_mlp1_gpu4&#45;&gt;layer_0_gelu_gpu4</title>
<path fill="none" stroke="black" d="M4376,-8899.89C4376,-8889.44 4376,-8877.32 4376,-8866.63"/>
<polygon fill="black" stroke="black" points="4379.5,-8866.53 4376,-8856.53 4372.5,-8866.53 4379.5,-8866.53"/>
</g>
<!-- layer_0_gelu_gpu5 -->
<g id="node43" class="node">
<title>layer_0_gelu_gpu5</title>
<polygon fill="lightblue" stroke="black" points="4284,-8856.52 4180,-8856.52 4180,-8818.52 4284,-8818.52 4284,-8856.52"/>
<text text-anchor="middle" x="4232" y="-8841.32" font-family="Times,serif" font-size="14.00">GELU GPU5</text>
<text text-anchor="middle" x="4232" y="-8826.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_0_mlp1_gpu5&#45;&gt;layer_0_gelu_gpu5 -->
<g id="edge57" class="edge">
<title>layer_0_mlp1_gpu5&#45;&gt;layer_0_gelu_gpu5</title>
<path fill="none" stroke="black" d="M4232,-8899.89C4232,-8889.44 4232,-8877.32 4232,-8866.63"/>
<polygon fill="black" stroke="black" points="4235.5,-8866.53 4232,-8856.53 4228.5,-8866.53 4235.5,-8866.53"/>
</g>
<!-- layer_0_gelu_gpu6 -->
<g id="node44" class="node">
<title>layer_0_gelu_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4140,-8856.52 4036,-8856.52 4036,-8818.52 4140,-8818.52 4140,-8856.52"/>
<text text-anchor="middle" x="4088" y="-8841.32" font-family="Times,serif" font-size="14.00">GELU GPU6</text>
<text text-anchor="middle" x="4088" y="-8826.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_0_mlp1_gpu6&#45;&gt;layer_0_gelu_gpu6 -->
<g id="edge61" class="edge">
<title>layer_0_mlp1_gpu6&#45;&gt;layer_0_gelu_gpu6</title>
<path fill="none" stroke="black" d="M4088,-8899.89C4088,-8889.44 4088,-8877.32 4088,-8866.63"/>
<polygon fill="black" stroke="black" points="4091.5,-8866.53 4088,-8856.53 4084.5,-8866.53 4091.5,-8866.53"/>
</g>
<!-- layer_0_gelu_gpu7 -->
<g id="node45" class="node">
<title>layer_0_gelu_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3996,-8856.52 3892,-8856.52 3892,-8818.52 3996,-8818.52 3996,-8856.52"/>
<text text-anchor="middle" x="3944" y="-8841.32" font-family="Times,serif" font-size="14.00">GELU GPU7</text>
<text text-anchor="middle" x="3944" y="-8826.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_0_mlp1_gpu7&#45;&gt;layer_0_gelu_gpu7 -->
<g id="edge65" class="edge">
<title>layer_0_mlp1_gpu7&#45;&gt;layer_0_gelu_gpu7</title>
<path fill="none" stroke="black" d="M3944,-8899.89C3944,-8889.44 3944,-8877.32 3944,-8866.63"/>
<polygon fill="black" stroke="black" points="3947.5,-8866.53 3944,-8856.53 3940.5,-8866.53 3947.5,-8866.53"/>
</g>
<!-- layer_0_mlp2_gpu0 -->
<g id="node46" class="node">
<title>layer_0_mlp2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="5015,-8774.65 4889,-8774.65 4889,-8721.65 5015,-8721.65 5015,-8774.65"/>
<text text-anchor="middle" x="4952" y="-8759.45" font-family="Times,serif" font-size="14.00">MLP2 GPU0</text>
<text text-anchor="middle" x="4952" y="-8744.45" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4952" y="-8729.45" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_0_gelu_gpu0&#45;&gt;layer_0_mlp2_gpu0 -->
<g id="edge38" class="edge">
<title>layer_0_gelu_gpu0&#45;&gt;layer_0_mlp2_gpu0</title>
<path fill="none" stroke="black" d="M4952,-8818.42C4952,-8808.78 4952,-8796.56 4952,-8785.09"/>
<polygon fill="black" stroke="black" points="4955.5,-8784.85 4952,-8774.85 4948.5,-8784.85 4955.5,-8784.85"/>
</g>
<!-- layer_0_mlp2_gpu1 -->
<g id="node47" class="node">
<title>layer_0_mlp2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="4871,-8774.65 4745,-8774.65 4745,-8721.65 4871,-8721.65 4871,-8774.65"/>
<text text-anchor="middle" x="4808" y="-8759.45" font-family="Times,serif" font-size="14.00">MLP2 GPU1</text>
<text text-anchor="middle" x="4808" y="-8744.45" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4808" y="-8729.45" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_0_gelu_gpu1&#45;&gt;layer_0_mlp2_gpu1 -->
<g id="edge42" class="edge">
<title>layer_0_gelu_gpu1&#45;&gt;layer_0_mlp2_gpu1</title>
<path fill="none" stroke="black" d="M4808,-8818.42C4808,-8808.78 4808,-8796.56 4808,-8785.09"/>
<polygon fill="black" stroke="black" points="4811.5,-8784.85 4808,-8774.85 4804.5,-8784.85 4811.5,-8784.85"/>
</g>
<!-- layer_0_mlp2_gpu2 -->
<g id="node48" class="node">
<title>layer_0_mlp2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="4727,-8774.65 4601,-8774.65 4601,-8721.65 4727,-8721.65 4727,-8774.65"/>
<text text-anchor="middle" x="4664" y="-8759.45" font-family="Times,serif" font-size="14.00">MLP2 GPU2</text>
<text text-anchor="middle" x="4664" y="-8744.45" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4664" y="-8729.45" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_0_gelu_gpu2&#45;&gt;layer_0_mlp2_gpu2 -->
<g id="edge46" class="edge">
<title>layer_0_gelu_gpu2&#45;&gt;layer_0_mlp2_gpu2</title>
<path fill="none" stroke="black" d="M4664,-8818.42C4664,-8808.78 4664,-8796.56 4664,-8785.09"/>
<polygon fill="black" stroke="black" points="4667.5,-8784.85 4664,-8774.85 4660.5,-8784.85 4667.5,-8784.85"/>
</g>
<!-- layer_0_mlp2_gpu3 -->
<g id="node49" class="node">
<title>layer_0_mlp2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="4583,-8774.65 4457,-8774.65 4457,-8721.65 4583,-8721.65 4583,-8774.65"/>
<text text-anchor="middle" x="4520" y="-8759.45" font-family="Times,serif" font-size="14.00">MLP2 GPU3</text>
<text text-anchor="middle" x="4520" y="-8744.45" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4520" y="-8729.45" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_0_gelu_gpu3&#45;&gt;layer_0_mlp2_gpu3 -->
<g id="edge50" class="edge">
<title>layer_0_gelu_gpu3&#45;&gt;layer_0_mlp2_gpu3</title>
<path fill="none" stroke="black" d="M4520,-8818.42C4520,-8808.78 4520,-8796.56 4520,-8785.09"/>
<polygon fill="black" stroke="black" points="4523.5,-8784.85 4520,-8774.85 4516.5,-8784.85 4523.5,-8784.85"/>
</g>
<!-- layer_0_mlp2_gpu4 -->
<g id="node50" class="node">
<title>layer_0_mlp2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="4439,-8774.65 4313,-8774.65 4313,-8721.65 4439,-8721.65 4439,-8774.65"/>
<text text-anchor="middle" x="4376" y="-8759.45" font-family="Times,serif" font-size="14.00">MLP2 GPU4</text>
<text text-anchor="middle" x="4376" y="-8744.45" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4376" y="-8729.45" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_0_gelu_gpu4&#45;&gt;layer_0_mlp2_gpu4 -->
<g id="edge54" class="edge">
<title>layer_0_gelu_gpu4&#45;&gt;layer_0_mlp2_gpu4</title>
<path fill="none" stroke="black" d="M4376,-8818.42C4376,-8808.78 4376,-8796.56 4376,-8785.09"/>
<polygon fill="black" stroke="black" points="4379.5,-8784.85 4376,-8774.85 4372.5,-8784.85 4379.5,-8784.85"/>
</g>
<!-- layer_0_mlp2_gpu5 -->
<g id="node51" class="node">
<title>layer_0_mlp2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="4295,-8774.65 4169,-8774.65 4169,-8721.65 4295,-8721.65 4295,-8774.65"/>
<text text-anchor="middle" x="4232" y="-8759.45" font-family="Times,serif" font-size="14.00">MLP2 GPU5</text>
<text text-anchor="middle" x="4232" y="-8744.45" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4232" y="-8729.45" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_0_gelu_gpu5&#45;&gt;layer_0_mlp2_gpu5 -->
<g id="edge58" class="edge">
<title>layer_0_gelu_gpu5&#45;&gt;layer_0_mlp2_gpu5</title>
<path fill="none" stroke="black" d="M4232,-8818.42C4232,-8808.78 4232,-8796.56 4232,-8785.09"/>
<polygon fill="black" stroke="black" points="4235.5,-8784.85 4232,-8774.85 4228.5,-8784.85 4235.5,-8784.85"/>
</g>
<!-- layer_0_mlp2_gpu6 -->
<g id="node52" class="node">
<title>layer_0_mlp2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4151,-8774.65 4025,-8774.65 4025,-8721.65 4151,-8721.65 4151,-8774.65"/>
<text text-anchor="middle" x="4088" y="-8759.45" font-family="Times,serif" font-size="14.00">MLP2 GPU6</text>
<text text-anchor="middle" x="4088" y="-8744.45" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4088" y="-8729.45" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_0_gelu_gpu6&#45;&gt;layer_0_mlp2_gpu6 -->
<g id="edge62" class="edge">
<title>layer_0_gelu_gpu6&#45;&gt;layer_0_mlp2_gpu6</title>
<path fill="none" stroke="black" d="M4088,-8818.42C4088,-8808.78 4088,-8796.56 4088,-8785.09"/>
<polygon fill="black" stroke="black" points="4091.5,-8784.85 4088,-8774.85 4084.5,-8784.85 4091.5,-8784.85"/>
</g>
<!-- layer_0_mlp2_gpu7 -->
<g id="node53" class="node">
<title>layer_0_mlp2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="4007,-8774.65 3881,-8774.65 3881,-8721.65 4007,-8721.65 4007,-8774.65"/>
<text text-anchor="middle" x="3944" y="-8759.45" font-family="Times,serif" font-size="14.00">MLP2 GPU7</text>
<text text-anchor="middle" x="3944" y="-8744.45" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3944" y="-8729.45" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_0_gelu_gpu7&#45;&gt;layer_0_mlp2_gpu7 -->
<g id="edge66" class="edge">
<title>layer_0_gelu_gpu7&#45;&gt;layer_0_mlp2_gpu7</title>
<path fill="none" stroke="black" d="M3944,-8818.42C3944,-8808.78 3944,-8796.56 3944,-8785.09"/>
<polygon fill="black" stroke="black" points="3947.5,-8784.85 3944,-8774.85 3940.5,-8784.85 3947.5,-8784.85"/>
</g>
<!-- layer_0_mlp_allreduce -->
<g id="node54" class="node">
<title>layer_0_mlp_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="4448" cy="-8647.28" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="4448" y="-8651.08" font-family="Times,serif" font-size="14.00">MLP AllReduce</text>
<text text-anchor="middle" x="4448" y="-8636.08" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_0_mlp2_gpu0&#45;&gt;layer_0_mlp_allreduce -->
<g id="edge39" class="edge">
<title>layer_0_mlp2_gpu0&#45;&gt;layer_0_mlp_allreduce</title>
<path fill="none" stroke="black" d="M4902.38,-8721.55C4895.01,-8718.41 4887.4,-8715.53 4880,-8713.28 4767.49,-8679.15 4632.82,-8662.52 4544.09,-8654.71"/>
<polygon fill="black" stroke="black" points="4544.31,-8651.22 4534.04,-8653.85 4543.71,-8658.19 4544.31,-8651.22"/>
</g>
<!-- layer_0_mlp2_gpu1&#45;&gt;layer_0_mlp_allreduce -->
<g id="edge43" class="edge">
<title>layer_0_mlp2_gpu1&#45;&gt;layer_0_mlp_allreduce</title>
<path fill="none" stroke="black" d="M4757.04,-8721.52C4750.07,-8718.51 4742.92,-8715.66 4736,-8713.28 4669.78,-8690.54 4592.23,-8673.56 4534.3,-8662.67"/>
<polygon fill="black" stroke="black" points="4534.92,-8659.22 4524.44,-8660.84 4533.64,-8666.11 4534.92,-8659.22"/>
</g>
<!-- layer_0_mlp2_gpu2&#45;&gt;layer_0_mlp_allreduce -->
<g id="edge47" class="edge">
<title>layer_0_mlp2_gpu2&#45;&gt;layer_0_mlp_allreduce</title>
<path fill="none" stroke="black" d="M4609.79,-8721.54C4603.79,-8718.74 4597.77,-8715.94 4592,-8713.28 4563.71,-8700.25 4532.19,-8685.99 4505.86,-8674.15"/>
<polygon fill="black" stroke="black" points="4506.97,-8670.81 4496.41,-8669.91 4504.1,-8677.2 4506.97,-8670.81"/>
</g>
<!-- layer_0_mlp2_gpu3&#45;&gt;layer_0_mlp_allreduce -->
<g id="edge51" class="edge">
<title>layer_0_mlp2_gpu3&#45;&gt;layer_0_mlp_allreduce</title>
<path fill="none" stroke="black" d="M4501.27,-8721.43C4492.52,-8709.42 4481.99,-8694.95 4472.6,-8682.07"/>
<polygon fill="black" stroke="black" points="4475.35,-8679.9 4466.64,-8673.87 4469.69,-8684.02 4475.35,-8679.9"/>
</g>
<!-- layer_0_mlp2_gpu4&#45;&gt;layer_0_mlp_allreduce -->
<g id="edge55" class="edge">
<title>layer_0_mlp2_gpu4&#45;&gt;layer_0_mlp_allreduce</title>
<path fill="none" stroke="black" d="M4394.73,-8721.43C4403.48,-8709.42 4414.01,-8694.95 4423.4,-8682.07"/>
<polygon fill="black" stroke="black" points="4426.31,-8684.02 4429.36,-8673.87 4420.65,-8679.9 4426.31,-8684.02"/>
</g>
<!-- layer_0_mlp2_gpu5&#45;&gt;layer_0_mlp_allreduce -->
<g id="edge59" class="edge">
<title>layer_0_mlp2_gpu5&#45;&gt;layer_0_mlp_allreduce</title>
<path fill="none" stroke="black" d="M4286.21,-8721.54C4292.21,-8718.74 4298.23,-8715.94 4304,-8713.28 4332.29,-8700.25 4363.81,-8685.99 4390.14,-8674.15"/>
<polygon fill="black" stroke="black" points="4391.9,-8677.2 4399.59,-8669.91 4389.03,-8670.81 4391.9,-8677.2"/>
</g>
<!-- layer_0_mlp2_gpu6&#45;&gt;layer_0_mlp_allreduce -->
<g id="edge63" class="edge">
<title>layer_0_mlp2_gpu6&#45;&gt;layer_0_mlp_allreduce</title>
<path fill="none" stroke="black" d="M4138.96,-8721.52C4145.93,-8718.51 4153.08,-8715.66 4160,-8713.28 4226.22,-8690.54 4303.77,-8673.56 4361.7,-8662.67"/>
<polygon fill="black" stroke="black" points="4362.36,-8666.11 4371.56,-8660.84 4361.08,-8659.22 4362.36,-8666.11"/>
</g>
<!-- layer_0_mlp2_gpu7&#45;&gt;layer_0_mlp_allreduce -->
<g id="edge67" class="edge">
<title>layer_0_mlp2_gpu7&#45;&gt;layer_0_mlp_allreduce</title>
<path fill="none" stroke="black" d="M3993.62,-8721.55C4000.99,-8718.41 4008.6,-8715.53 4016,-8713.28 4128.51,-8679.15 4263.18,-8662.52 4351.91,-8654.71"/>
<polygon fill="black" stroke="black" points="4352.29,-8658.19 4361.96,-8653.85 4351.69,-8651.22 4352.29,-8658.19"/>
</g>
<!-- layer_0_residual2 -->
<g id="node55" class="node">
<title>layer_0_residual2</title>
<polygon fill="lightyellow" stroke="black" points="4576.61,-8573.28 4372.02,-8573.28 4319.39,-8497.28 4523.98,-8497.28 4576.61,-8573.28"/>
<text text-anchor="middle" x="4448" y="-8539.08" font-family="Times,serif" font-size="14.00">Residual Add 0</text>
<text text-anchor="middle" x="4448" y="-8524.08" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_0_mlp_allreduce&#45;&gt;layer_0_residual2 -->
<g id="edge68" class="edge">
<title>layer_0_mlp_allreduce&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M4448,-8620.21C4448,-8609.29 4448,-8596.25 4448,-8583.73"/>
<polygon fill="black" stroke="black" points="4451.5,-8583.4 4448,-8573.4 4444.5,-8583.4 4451.5,-8583.4"/>
</g>
<!-- layer_0_ln2 -->
<g id="node56" class="node">
<title>layer_0_ln2</title>
<polygon fill="lightblue" stroke="black" points="4503.5,-8412.28 4392.5,-8412.28 4392.5,-8374.28 4503.5,-8374.28 4503.5,-8412.28"/>
<text text-anchor="middle" x="4448" y="-8397.08" font-family="Times,serif" font-size="14.00">LayerNorm 0</text>
<text text-anchor="middle" x="4448" y="-8382.08" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_0_residual2&#45;&gt;layer_0_ln2 -->
<g id="edge69" class="edge">
<title>layer_0_residual2&#45;&gt;layer_0_ln2</title>
<path fill="none" stroke="black" d="M4448,-8497.13C4448,-8473.71 4448,-8443.94 4448,-8422.46"/>
<polygon fill="black" stroke="black" points="4451.5,-8422.36 4448,-8412.36 4444.5,-8422.36 4451.5,-8422.36"/>
</g>
<!-- layer_1_qkv_gpu0 -->
<g id="node57" class="node">
<title>layer_1_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="4512,-8286.28 4384,-8286.28 4384,-8233.28 4512,-8233.28 4512,-8286.28"/>
<text text-anchor="middle" x="4448" y="-8271.08" font-family="Times,serif" font-size="14.00">QKV Proj GPU0</text>
<text text-anchor="middle" x="4448" y="-8256.08" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4448" y="-8241.08" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_0_ln2&#45;&gt;layer_1_qkv_gpu0 -->
<g id="edge70" class="edge">
<title>layer_0_ln2&#45;&gt;layer_1_qkv_gpu0</title>
<path fill="none" stroke="black" d="M4448,-8374.27C4448,-8354.46 4448,-8322.08 4448,-8296.97"/>
<polygon fill="black" stroke="black" points="4451.5,-8296.71 4448,-8286.71 4444.5,-8296.71 4451.5,-8296.71"/>
</g>
<!-- layer_1_qkv_comm -->
<g id="node65" class="node">
<title>layer_1_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="3937" cy="-8170.41" rx="85.62" ry="26.74"/>
<text text-anchor="middle" x="3937" y="-8174.21" font-family="Times,serif" font-size="14.00">QKV AllGather</text>
<text text-anchor="middle" x="3937" y="-8159.21" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_1_qkv_gpu0&#45;&gt;layer_1_qkv_comm -->
<g id="edge71" class="edge">
<title>layer_1_qkv_gpu0&#45;&gt;layer_1_qkv_comm</title>
<path fill="none" stroke="black" d="M4383.72,-8235.56C4380.79,-8234.74 4377.87,-8233.98 4375,-8233.28 4257.33,-8204.71 4118.46,-8187.87 4029.13,-8179.14"/>
<polygon fill="black" stroke="black" points="4029.32,-8175.64 4019.03,-8178.17 4028.65,-8182.61 4029.32,-8175.64"/>
</g>
<!-- layer_1_qkv_gpu1 -->
<g id="node58" class="node">
<title>layer_1_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="4366,-8286.28 4238,-8286.28 4238,-8233.28 4366,-8233.28 4366,-8286.28"/>
<text text-anchor="middle" x="4302" y="-8271.08" font-family="Times,serif" font-size="14.00">QKV Proj GPU1</text>
<text text-anchor="middle" x="4302" y="-8256.08" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4302" y="-8241.08" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_1_qkv_gpu1&#45;&gt;layer_1_qkv_comm -->
<g id="edge72" class="edge">
<title>layer_1_qkv_gpu1&#45;&gt;layer_1_qkv_comm</title>
<path fill="none" stroke="black" d="M4237.65,-8235.81C4234.74,-8234.92 4231.84,-8234.08 4229,-8233.28 4159.53,-8213.87 4079.28,-8197.28 4020.5,-8186.18"/>
<polygon fill="black" stroke="black" points="4021,-8182.71 4010.53,-8184.31 4019.71,-8189.59 4021,-8182.71"/>
</g>
<!-- layer_1_qkv_gpu2 -->
<g id="node59" class="node">
<title>layer_1_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="4220,-8286.28 4092,-8286.28 4092,-8233.28 4220,-8233.28 4220,-8286.28"/>
<text text-anchor="middle" x="4156" y="-8271.08" font-family="Times,serif" font-size="14.00">QKV Proj GPU2</text>
<text text-anchor="middle" x="4156" y="-8256.08" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4156" y="-8241.08" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_1_qkv_gpu2&#45;&gt;layer_1_qkv_comm -->
<g id="edge73" class="edge">
<title>layer_1_qkv_gpu2&#45;&gt;layer_1_qkv_comm</title>
<path fill="none" stroke="black" d="M4092.07,-8233.28C4062.33,-8221.41 4027.14,-8207.38 3997.81,-8195.67"/>
<polygon fill="black" stroke="black" points="3999.09,-8192.41 3988.5,-8191.96 3996.5,-8198.92 3999.09,-8192.41"/>
</g>
<!-- layer_1_qkv_gpu3 -->
<g id="node60" class="node">
<title>layer_1_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="4074,-8286.28 3946,-8286.28 3946,-8233.28 4074,-8233.28 4074,-8286.28"/>
<text text-anchor="middle" x="4010" y="-8271.08" font-family="Times,serif" font-size="14.00">QKV Proj GPU3</text>
<text text-anchor="middle" x="4010" y="-8256.08" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4010" y="-8241.08" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_1_qkv_gpu3&#45;&gt;layer_1_qkv_comm -->
<g id="edge74" class="edge">
<title>layer_1_qkv_gpu3&#45;&gt;layer_1_qkv_comm</title>
<path fill="none" stroke="black" d="M3988.49,-8233.04C3981,-8224.08 3972.49,-8213.89 3964.58,-8204.42"/>
<polygon fill="black" stroke="black" points="3967.2,-8202.1 3958.1,-8196.67 3961.83,-8206.59 3967.2,-8202.1"/>
</g>
<!-- layer_1_qkv_gpu4 -->
<g id="node61" class="node">
<title>layer_1_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3928,-8286.28 3800,-8286.28 3800,-8233.28 3928,-8233.28 3928,-8286.28"/>
<text text-anchor="middle" x="3864" y="-8271.08" font-family="Times,serif" font-size="14.00">QKV Proj GPU4</text>
<text text-anchor="middle" x="3864" y="-8256.08" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3864" y="-8241.08" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_1_qkv_gpu4&#45;&gt;layer_1_qkv_comm -->
<g id="edge75" class="edge">
<title>layer_1_qkv_gpu4&#45;&gt;layer_1_qkv_comm</title>
<path fill="none" stroke="black" d="M3885.51,-8233.04C3893,-8224.08 3901.51,-8213.89 3909.42,-8204.42"/>
<polygon fill="black" stroke="black" points="3912.17,-8206.59 3915.9,-8196.67 3906.8,-8202.1 3912.17,-8206.59"/>
</g>
<!-- layer_1_qkv_gpu5 -->
<g id="node62" class="node">
<title>layer_1_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3782,-8286.28 3654,-8286.28 3654,-8233.28 3782,-8233.28 3782,-8286.28"/>
<text text-anchor="middle" x="3718" y="-8271.08" font-family="Times,serif" font-size="14.00">QKV Proj GPU5</text>
<text text-anchor="middle" x="3718" y="-8256.08" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3718" y="-8241.08" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_1_qkv_gpu5&#45;&gt;layer_1_qkv_comm -->
<g id="edge76" class="edge">
<title>layer_1_qkv_gpu5&#45;&gt;layer_1_qkv_comm</title>
<path fill="none" stroke="black" d="M3781.93,-8233.28C3811.67,-8221.41 3846.86,-8207.38 3876.19,-8195.67"/>
<polygon fill="black" stroke="black" points="3877.5,-8198.92 3885.5,-8191.96 3874.91,-8192.41 3877.5,-8198.92"/>
</g>
<!-- layer_1_qkv_gpu6 -->
<g id="node63" class="node">
<title>layer_1_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="3636,-8286.28 3508,-8286.28 3508,-8233.28 3636,-8233.28 3636,-8286.28"/>
<text text-anchor="middle" x="3572" y="-8271.08" font-family="Times,serif" font-size="14.00">QKV Proj GPU6</text>
<text text-anchor="middle" x="3572" y="-8256.08" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3572" y="-8241.08" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_1_qkv_gpu6&#45;&gt;layer_1_qkv_comm -->
<g id="edge77" class="edge">
<title>layer_1_qkv_gpu6&#45;&gt;layer_1_qkv_comm</title>
<path fill="none" stroke="black" d="M3636.35,-8235.81C3639.26,-8234.92 3642.16,-8234.08 3645,-8233.28 3714.47,-8213.87 3794.72,-8197.28 3853.5,-8186.18"/>
<polygon fill="black" stroke="black" points="3854.29,-8189.59 3863.47,-8184.31 3853,-8182.71 3854.29,-8189.59"/>
</g>
<!-- layer_1_qkv_gpu7 -->
<g id="node64" class="node">
<title>layer_1_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3490,-8286.28 3362,-8286.28 3362,-8233.28 3490,-8233.28 3490,-8286.28"/>
<text text-anchor="middle" x="3426" y="-8271.08" font-family="Times,serif" font-size="14.00">QKV Proj GPU7</text>
<text text-anchor="middle" x="3426" y="-8256.08" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3426" y="-8241.08" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_1_qkv_gpu7&#45;&gt;layer_1_qkv_comm -->
<g id="edge78" class="edge">
<title>layer_1_qkv_gpu7&#45;&gt;layer_1_qkv_comm</title>
<path fill="none" stroke="black" d="M3490.28,-8235.56C3493.21,-8234.74 3496.13,-8233.98 3499,-8233.28 3616.67,-8204.71 3755.54,-8187.87 3844.87,-8179.14"/>
<polygon fill="black" stroke="black" points="3845.35,-8182.61 3854.97,-8178.17 3844.68,-8175.64 3845.35,-8182.61"/>
</g>
<!-- layer_1_attn_comp_gpu0 -->
<g id="node66" class="node">
<title>layer_1_attn_comp_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3280,-8107.54 3082,-8107.54 3082,-8054.54 3280,-8054.54 3280,-8107.54"/>
<text text-anchor="middle" x="3181" y="-8092.34" font-family="Times,serif" font-size="14.00">Attention Compute GPU0</text>
<text text-anchor="middle" x="3181" y="-8077.34" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="3181" y="-8062.34" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_1_qkv_comm&#45;&gt;layer_1_attn_comp_gpu0 -->
<g id="edge79" class="edge">
<title>layer_1_qkv_comm&#45;&gt;layer_1_attn_comp_gpu0</title>
<path fill="none" stroke="black" d="M3852.9,-8165.06C3730.86,-8157.93 3497.52,-8141.23 3290.22,-8107.65"/>
<polygon fill="black" stroke="black" points="3290.49,-8104.15 3280.06,-8105.99 3289.36,-8111.06 3290.49,-8104.15"/>
</g>
<!-- layer_1_attn_comp_gpu1 -->
<g id="node67" class="node">
<title>layer_1_attn_comp_gpu1</title>
<polygon fill="lightblue" stroke="black" points="3496,-8107.54 3298,-8107.54 3298,-8054.54 3496,-8054.54 3496,-8107.54"/>
<text text-anchor="middle" x="3397" y="-8092.34" font-family="Times,serif" font-size="14.00">Attention Compute GPU1</text>
<text text-anchor="middle" x="3397" y="-8077.34" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="3397" y="-8062.34" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_1_qkv_comm&#45;&gt;layer_1_attn_comp_gpu1 -->
<g id="edge80" class="edge">
<title>layer_1_qkv_comm&#45;&gt;layer_1_attn_comp_gpu1</title>
<path fill="none" stroke="black" d="M3857.42,-8160.19C3772.69,-8149.87 3634.51,-8131.64 3506.11,-8107.69"/>
<polygon fill="black" stroke="black" points="3506.57,-8104.21 3496.09,-8105.8 3505.27,-8111.09 3506.57,-8104.21"/>
</g>
<!-- layer_1_attn_comp_gpu2 -->
<g id="node68" class="node">
<title>layer_1_attn_comp_gpu2</title>
<polygon fill="lightblue" stroke="black" points="3712,-8107.54 3514,-8107.54 3514,-8054.54 3712,-8054.54 3712,-8107.54"/>
<text text-anchor="middle" x="3613" y="-8092.34" font-family="Times,serif" font-size="14.00">Attention Compute GPU2</text>
<text text-anchor="middle" x="3613" y="-8077.34" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="3613" y="-8062.34" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_1_qkv_comm&#45;&gt;layer_1_attn_comp_gpu2 -->
<g id="edge81" class="edge">
<title>layer_1_qkv_comm&#45;&gt;layer_1_attn_comp_gpu2</title>
<path fill="none" stroke="black" d="M3873.37,-8152.26C3829.05,-8140.3 3768.92,-8124.09 3717.61,-8110.25"/>
<polygon fill="black" stroke="black" points="3718.37,-8106.83 3707.8,-8107.61 3716.55,-8113.59 3718.37,-8106.83"/>
</g>
<!-- layer_1_attn_comp_gpu3 -->
<g id="node69" class="node">
<title>layer_1_attn_comp_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3928,-8107.54 3730,-8107.54 3730,-8054.54 3928,-8054.54 3928,-8107.54"/>
<text text-anchor="middle" x="3829" y="-8092.34" font-family="Times,serif" font-size="14.00">Attention Compute GPU3</text>
<text text-anchor="middle" x="3829" y="-8077.34" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="3829" y="-8062.34" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_1_qkv_comm&#45;&gt;layer_1_attn_comp_gpu3 -->
<g id="edge82" class="edge">
<title>layer_1_qkv_comm&#45;&gt;layer_1_attn_comp_gpu3</title>
<path fill="none" stroke="black" d="M3906.92,-8145.08C3895.14,-8135.55 3881.46,-8124.48 3868.88,-8114.31"/>
<polygon fill="black" stroke="black" points="3870.78,-8111.34 3860.81,-8107.77 3866.38,-8116.79 3870.78,-8111.34"/>
</g>
<!-- layer_1_attn_comp_gpu4 -->
<g id="node70" class="node">
<title>layer_1_attn_comp_gpu4</title>
<polygon fill="lightblue" stroke="black" points="4144,-8107.54 3946,-8107.54 3946,-8054.54 4144,-8054.54 4144,-8107.54"/>
<text text-anchor="middle" x="4045" y="-8092.34" font-family="Times,serif" font-size="14.00">Attention Compute GPU4</text>
<text text-anchor="middle" x="4045" y="-8077.34" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="4045" y="-8062.34" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_1_qkv_comm&#45;&gt;layer_1_attn_comp_gpu4 -->
<g id="edge83" class="edge">
<title>layer_1_qkv_comm&#45;&gt;layer_1_attn_comp_gpu4</title>
<path fill="none" stroke="black" d="M3967.08,-8145.08C3978.86,-8135.55 3992.54,-8124.48 4005.12,-8114.31"/>
<polygon fill="black" stroke="black" points="4007.62,-8116.79 4013.19,-8107.77 4003.22,-8111.34 4007.62,-8116.79"/>
</g>
<!-- layer_1_attn_comp_gpu5 -->
<g id="node71" class="node">
<title>layer_1_attn_comp_gpu5</title>
<polygon fill="lightblue" stroke="black" points="4360,-8107.54 4162,-8107.54 4162,-8054.54 4360,-8054.54 4360,-8107.54"/>
<text text-anchor="middle" x="4261" y="-8092.34" font-family="Times,serif" font-size="14.00">Attention Compute GPU5</text>
<text text-anchor="middle" x="4261" y="-8077.34" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="4261" y="-8062.34" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_1_qkv_comm&#45;&gt;layer_1_attn_comp_gpu5 -->
<g id="edge84" class="edge">
<title>layer_1_qkv_comm&#45;&gt;layer_1_attn_comp_gpu5</title>
<path fill="none" stroke="black" d="M4000.63,-8152.26C4044.95,-8140.3 4105.08,-8124.09 4156.39,-8110.25"/>
<polygon fill="black" stroke="black" points="4157.45,-8113.59 4166.2,-8107.61 4155.63,-8106.83 4157.45,-8113.59"/>
</g>
<!-- layer_1_attn_comp_gpu6 -->
<g id="node72" class="node">
<title>layer_1_attn_comp_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4576,-8107.54 4378,-8107.54 4378,-8054.54 4576,-8054.54 4576,-8107.54"/>
<text text-anchor="middle" x="4477" y="-8092.34" font-family="Times,serif" font-size="14.00">Attention Compute GPU6</text>
<text text-anchor="middle" x="4477" y="-8077.34" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="4477" y="-8062.34" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_1_qkv_comm&#45;&gt;layer_1_attn_comp_gpu6 -->
<g id="edge85" class="edge">
<title>layer_1_qkv_comm&#45;&gt;layer_1_attn_comp_gpu6</title>
<path fill="none" stroke="black" d="M4016.58,-8160.19C4101.31,-8149.87 4239.49,-8131.64 4367.89,-8107.69"/>
<polygon fill="black" stroke="black" points="4368.73,-8111.09 4377.91,-8105.8 4367.43,-8104.21 4368.73,-8111.09"/>
</g>
<!-- layer_1_attn_comp_gpu7 -->
<g id="node73" class="node">
<title>layer_1_attn_comp_gpu7</title>
<polygon fill="lightblue" stroke="black" points="4792,-8107.54 4594,-8107.54 4594,-8054.54 4792,-8054.54 4792,-8107.54"/>
<text text-anchor="middle" x="4693" y="-8092.34" font-family="Times,serif" font-size="14.00">Attention Compute GPU7</text>
<text text-anchor="middle" x="4693" y="-8077.34" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="4693" y="-8062.34" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_1_qkv_comm&#45;&gt;layer_1_attn_comp_gpu7 -->
<g id="edge86" class="edge">
<title>layer_1_qkv_comm&#45;&gt;layer_1_attn_comp_gpu7</title>
<path fill="none" stroke="black" d="M4021.1,-8165.06C4143.14,-8157.93 4376.48,-8141.23 4583.78,-8107.65"/>
<polygon fill="black" stroke="black" points="4584.64,-8111.06 4593.94,-8105.99 4583.51,-8104.15 4584.64,-8111.06"/>
</g>
<!-- layer_1_attn_out_gpu0 -->
<g id="node74" class="node">
<title>layer_1_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3302,-8018.54 3144,-8018.54 3144,-7965.54 3302,-7965.54 3302,-8018.54"/>
<text text-anchor="middle" x="3223" y="-8003.34" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU0</text>
<text text-anchor="middle" x="3223" y="-7988.34" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3223" y="-7973.34" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_1_attn_comp_gpu0&#45;&gt;layer_1_attn_out_gpu0 -->
<g id="edge87" class="edge">
<title>layer_1_attn_comp_gpu0&#45;&gt;layer_1_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M3193.37,-8054.41C3197.4,-8046.08 3201.93,-8036.69 3206.22,-8027.8"/>
<polygon fill="black" stroke="black" points="3209.37,-8029.32 3210.57,-8018.79 3203.07,-8026.28 3209.37,-8029.32"/>
</g>
<!-- layer_1_attn_out_gpu1 -->
<g id="node75" class="node">
<title>layer_1_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="3521,-8018.54 3363,-8018.54 3363,-7965.54 3521,-7965.54 3521,-8018.54"/>
<text text-anchor="middle" x="3442" y="-8003.34" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU1</text>
<text text-anchor="middle" x="3442" y="-7988.34" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3442" y="-7973.34" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_1_attn_comp_gpu1&#45;&gt;layer_1_attn_out_gpu1 -->
<g id="edge88" class="edge">
<title>layer_1_attn_comp_gpu1&#45;&gt;layer_1_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M3410.26,-8054.41C3414.57,-8046.08 3419.43,-8036.69 3424.02,-8027.8"/>
<polygon fill="black" stroke="black" points="3427.2,-8029.28 3428.68,-8018.79 3420.98,-8026.07 3427.2,-8029.28"/>
</g>
<!-- layer_1_attn_out_gpu2 -->
<g id="node76" class="node">
<title>layer_1_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="3717,-8018.54 3559,-8018.54 3559,-7965.54 3717,-7965.54 3717,-8018.54"/>
<text text-anchor="middle" x="3638" y="-8003.34" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU2</text>
<text text-anchor="middle" x="3638" y="-7988.34" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3638" y="-7973.34" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_1_attn_comp_gpu2&#45;&gt;layer_1_attn_out_gpu2 -->
<g id="edge89" class="edge">
<title>layer_1_attn_comp_gpu2&#45;&gt;layer_1_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M3620.37,-8054.41C3622.68,-8046.34 3625.29,-8037.28 3627.77,-8028.64"/>
<polygon fill="black" stroke="black" points="3631.2,-8029.37 3630.6,-8018.79 3624.47,-8027.44 3631.2,-8029.37"/>
</g>
<!-- layer_1_attn_out_gpu3 -->
<g id="node77" class="node">
<title>layer_1_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3918,-8018.54 3760,-8018.54 3760,-7965.54 3918,-7965.54 3918,-8018.54"/>
<text text-anchor="middle" x="3839" y="-8003.34" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU3</text>
<text text-anchor="middle" x="3839" y="-7988.34" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3839" y="-7973.34" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_1_attn_comp_gpu3&#45;&gt;layer_1_attn_out_gpu3 -->
<g id="edge90" class="edge">
<title>layer_1_attn_comp_gpu3&#45;&gt;layer_1_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M3831.95,-8054.41C3832.86,-8046.43 3833.89,-8037.47 3834.88,-8028.93"/>
<polygon fill="black" stroke="black" points="3838.38,-8029.13 3836.04,-8018.79 3831.42,-8028.33 3838.38,-8029.13"/>
</g>
<!-- layer_1_attn_out_gpu4 -->
<g id="node78" class="node">
<title>layer_1_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="4114,-8018.54 3956,-8018.54 3956,-7965.54 4114,-7965.54 4114,-8018.54"/>
<text text-anchor="middle" x="4035" y="-8003.34" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU4</text>
<text text-anchor="middle" x="4035" y="-7988.34" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4035" y="-7973.34" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_1_attn_comp_gpu4&#45;&gt;layer_1_attn_out_gpu4 -->
<g id="edge91" class="edge">
<title>layer_1_attn_comp_gpu4&#45;&gt;layer_1_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M4042.05,-8054.41C4041.14,-8046.43 4040.11,-8037.47 4039.12,-8028.93"/>
<polygon fill="black" stroke="black" points="4042.58,-8028.33 4037.96,-8018.79 4035.62,-8029.13 4042.58,-8028.33"/>
</g>
<!-- layer_1_attn_out_gpu5 -->
<g id="node79" class="node">
<title>layer_1_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="4310,-8018.54 4152,-8018.54 4152,-7965.54 4310,-7965.54 4310,-8018.54"/>
<text text-anchor="middle" x="4231" y="-8003.34" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU5</text>
<text text-anchor="middle" x="4231" y="-7988.34" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4231" y="-7973.34" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_1_attn_comp_gpu5&#45;&gt;layer_1_attn_out_gpu5 -->
<g id="edge92" class="edge">
<title>layer_1_attn_comp_gpu5&#45;&gt;layer_1_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M4252.16,-8054.41C4249.35,-8046.25 4246.19,-8037.08 4243.18,-8028.36"/>
<polygon fill="black" stroke="black" points="4246.45,-8027.1 4239.88,-8018.79 4239.83,-8029.39 4246.45,-8027.1"/>
</g>
<!-- layer_1_attn_out_gpu6 -->
<g id="node80" class="node">
<title>layer_1_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4516,-8018.54 4358,-8018.54 4358,-7965.54 4516,-7965.54 4516,-8018.54"/>
<text text-anchor="middle" x="4437" y="-8003.34" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU6</text>
<text text-anchor="middle" x="4437" y="-7988.34" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4437" y="-7973.34" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_1_attn_comp_gpu6&#45;&gt;layer_1_attn_out_gpu6 -->
<g id="edge93" class="edge">
<title>layer_1_attn_comp_gpu6&#45;&gt;layer_1_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M4465.22,-8054.41C4461.42,-8046.16 4457.16,-8036.88 4453.11,-8028.08"/>
<polygon fill="black" stroke="black" points="4456.2,-8026.42 4448.84,-8018.79 4449.84,-8029.34 4456.2,-8026.42"/>
</g>
<!-- layer_1_attn_out_gpu7 -->
<g id="node81" class="node">
<title>layer_1_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="4727,-8018.54 4569,-8018.54 4569,-7965.54 4727,-7965.54 4727,-8018.54"/>
<text text-anchor="middle" x="4648" y="-8003.34" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU7</text>
<text text-anchor="middle" x="4648" y="-7988.34" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4648" y="-7973.34" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_1_attn_comp_gpu7&#45;&gt;layer_1_attn_out_gpu7 -->
<g id="edge94" class="edge">
<title>layer_1_attn_comp_gpu7&#45;&gt;layer_1_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M4679.74,-8054.41C4675.43,-8046.08 4670.57,-8036.69 4665.98,-8027.8"/>
<polygon fill="black" stroke="black" points="4669.02,-8026.07 4661.32,-8018.79 4662.8,-8029.28 4669.02,-8026.07"/>
</g>
<!-- layer_1_attn_allreduce -->
<g id="node82" class="node">
<title>layer_1_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="3937" cy="-7902.67" rx="112.36" ry="26.74"/>
<text text-anchor="middle" x="3937" y="-7906.47" font-family="Times,serif" font-size="14.00">Attention AllReduce</text>
<text text-anchor="middle" x="3937" y="-7891.47" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_1_attn_out_gpu0&#45;&gt;layer_1_attn_allreduce -->
<g id="edge95" class="edge">
<title>layer_1_attn_out_gpu0&#45;&gt;layer_1_attn_allreduce</title>
<path fill="none" stroke="black" d="M3302.13,-7974.5C3319.19,-7971.25 3337.16,-7968.07 3354,-7965.54 3515.5,-7941.3 3703.57,-7923.14 3821.47,-7912.96"/>
<polygon fill="black" stroke="black" points="3821.93,-7916.44 3831.6,-7912.09 3821.33,-7909.46 3821.93,-7916.44"/>
</g>
<!-- layer_1_attn_out_gpu1&#45;&gt;layer_1_attn_allreduce -->
<g id="edge96" class="edge">
<title>layer_1_attn_out_gpu1&#45;&gt;layer_1_attn_allreduce</title>
<path fill="none" stroke="black" d="M3521.19,-7971.64C3530.87,-7969.48 3540.64,-7967.39 3550,-7965.54 3644.7,-7946.82 3753.3,-7929.84 3831.31,-7918.43"/>
<polygon fill="black" stroke="black" points="3832.24,-7921.83 3841.63,-7916.93 3831.23,-7914.91 3832.24,-7921.83"/>
</g>
<!-- layer_1_attn_out_gpu2&#45;&gt;layer_1_attn_allreduce -->
<g id="edge97" class="edge">
<title>layer_1_attn_out_gpu2&#45;&gt;layer_1_attn_allreduce</title>
<path fill="none" stroke="black" d="M3717.34,-7967.86C3760.77,-7955.17 3814.41,-7939.49 3857.82,-7926.81"/>
<polygon fill="black" stroke="black" points="3858.86,-7930.15 3867.48,-7923.99 3856.9,-7923.43 3858.86,-7930.15"/>
</g>
<!-- layer_1_attn_out_gpu3&#45;&gt;layer_1_attn_allreduce -->
<g id="edge98" class="edge">
<title>layer_1_attn_out_gpu3&#45;&gt;layer_1_attn_allreduce</title>
<path fill="none" stroke="black" d="M3867.61,-7965.54C3878.17,-7956.12 3890.26,-7945.34 3901.37,-7935.44"/>
<polygon fill="black" stroke="black" points="3903.73,-7938.02 3908.86,-7928.76 3899.07,-7932.8 3903.73,-7938.02"/>
</g>
<!-- layer_1_attn_out_gpu4&#45;&gt;layer_1_attn_allreduce -->
<g id="edge99" class="edge">
<title>layer_1_attn_out_gpu4&#45;&gt;layer_1_attn_allreduce</title>
<path fill="none" stroke="black" d="M4006.39,-7965.54C3995.83,-7956.12 3983.74,-7945.34 3972.63,-7935.44"/>
<polygon fill="black" stroke="black" points="3974.93,-7932.8 3965.14,-7928.76 3970.27,-7938.02 3974.93,-7932.8"/>
</g>
<!-- layer_1_attn_out_gpu5&#45;&gt;layer_1_attn_allreduce -->
<g id="edge100" class="edge">
<title>layer_1_attn_out_gpu5&#45;&gt;layer_1_attn_allreduce</title>
<path fill="none" stroke="black" d="M4151.83,-7967.51C4109.54,-7954.95 4057.66,-7939.53 4015.48,-7927"/>
<polygon fill="black" stroke="black" points="4016.39,-7923.62 4005.81,-7924.12 4014.4,-7930.33 4016.39,-7923.62"/>
</g>
<!-- layer_1_attn_out_gpu6&#45;&gt;layer_1_attn_allreduce -->
<g id="edge101" class="edge">
<title>layer_1_attn_out_gpu6&#45;&gt;layer_1_attn_allreduce</title>
<path fill="none" stroke="black" d="M4357.77,-7973.33C4344.84,-7970.61 4331.56,-7967.92 4319,-7965.54 4225.34,-7947.85 4118.16,-7930.76 4041.22,-7919.05"/>
<polygon fill="black" stroke="black" points="4041.45,-7915.54 4031.04,-7917.5 4040.4,-7922.46 4041.45,-7915.54"/>
</g>
<!-- layer_1_attn_out_gpu7&#45;&gt;layer_1_attn_allreduce -->
<g id="edge102" class="edge">
<title>layer_1_attn_out_gpu7&#45;&gt;layer_1_attn_allreduce</title>
<path fill="none" stroke="black" d="M4568.81,-7973.42C4554.29,-7970.53 4539.22,-7967.76 4525,-7965.54 4362.15,-7940.16 4172.26,-7922.28 4053.32,-7912.47"/>
<polygon fill="black" stroke="black" points="4053.35,-7908.96 4043.1,-7911.64 4052.78,-7915.94 4053.35,-7908.96"/>
</g>
<!-- layer_1_residual1 -->
<g id="node83" class="node">
<title>layer_1_residual1</title>
<polygon fill="lightyellow" stroke="black" points="4065.61,-7839.8 3861.02,-7839.8 3808.39,-7763.8 4012.98,-7763.8 4065.61,-7839.8"/>
<text text-anchor="middle" x="3937" y="-7805.6" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="3937" y="-7790.6" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_1_attn_allreduce&#45;&gt;layer_1_residual1 -->
<g id="edge103" class="edge">
<title>layer_1_attn_allreduce&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M3937,-7875.7C3937,-7867.88 3937,-7859.05 3937,-7850.3"/>
<polygon fill="black" stroke="black" points="3940.5,-7850.13 3937,-7840.13 3933.5,-7850.13 3940.5,-7850.13"/>
</g>
<!-- layer_1_ln1 -->
<g id="node84" class="node">
<title>layer_1_ln1</title>
<polygon fill="lightblue" stroke="black" points="3992.5,-7727.8 3881.5,-7727.8 3881.5,-7689.8 3992.5,-7689.8 3992.5,-7727.8"/>
<text text-anchor="middle" x="3937" y="-7712.6" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="3937" y="-7697.6" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_1_residual1&#45;&gt;layer_1_ln1 -->
<g id="edge104" class="edge">
<title>layer_1_residual1&#45;&gt;layer_1_ln1</title>
<path fill="none" stroke="black" d="M3937,-7763.79C3937,-7755.17 3937,-7746.12 3937,-7737.96"/>
<polygon fill="black" stroke="black" points="3940.5,-7737.84 3937,-7727.84 3933.5,-7737.84 3940.5,-7737.84"/>
</g>
<!-- layer_1_mlp1_gpu0 -->
<g id="node85" class="node">
<title>layer_1_mlp1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="4504,-7650.8 4378,-7650.8 4378,-7597.8 4504,-7597.8 4504,-7650.8"/>
<text text-anchor="middle" x="4441" y="-7635.6" font-family="Times,serif" font-size="14.00">MLP1 GPU0</text>
<text text-anchor="middle" x="4441" y="-7620.6" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4441" y="-7605.6" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp1_gpu0 -->
<g id="edge105" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp1_gpu0</title>
<path fill="none" stroke="black" d="M3992.64,-7708.54C4093.37,-7709.21 4301.74,-7707.33 4369,-7681.8 4383.24,-7676.4 4396.92,-7667.12 4408.45,-7657.62"/>
<polygon fill="black" stroke="black" points="4410.78,-7660.23 4416.07,-7651.06 4406.21,-7654.93 4410.78,-7660.23"/>
</g>
<!-- layer_1_mlp1_gpu1 -->
<g id="node86" class="node">
<title>layer_1_mlp1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="4360,-7650.8 4234,-7650.8 4234,-7597.8 4360,-7597.8 4360,-7650.8"/>
<text text-anchor="middle" x="4297" y="-7635.6" font-family="Times,serif" font-size="14.00">MLP1 GPU1</text>
<text text-anchor="middle" x="4297" y="-7620.6" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4297" y="-7605.6" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp1_gpu1 -->
<g id="edge109" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp1_gpu1</title>
<path fill="none" stroke="black" d="M3992.68,-7706.52C4064.24,-7704.22 4184.11,-7698.03 4225,-7681.8 4239.16,-7676.18 4252.81,-7666.85 4264.35,-7657.37"/>
<polygon fill="black" stroke="black" points="4266.67,-7659.99 4271.98,-7650.83 4262.11,-7654.68 4266.67,-7659.99"/>
</g>
<!-- layer_1_mlp1_gpu2 -->
<g id="node87" class="node">
<title>layer_1_mlp1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="4216,-7650.8 4090,-7650.8 4090,-7597.8 4216,-7597.8 4216,-7650.8"/>
<text text-anchor="middle" x="4153" y="-7635.6" font-family="Times,serif" font-size="14.00">MLP1 GPU2</text>
<text text-anchor="middle" x="4153" y="-7620.6" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4153" y="-7605.6" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp1_gpu2 -->
<g id="edge113" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp1_gpu2</title>
<path fill="none" stroke="black" d="M3992.54,-7704.11C4020.09,-7700.73 4053.31,-7694.24 4081,-7681.8 4094.41,-7675.78 4107.54,-7666.73 4118.83,-7657.63"/>
<polygon fill="black" stroke="black" points="4121.29,-7660.13 4126.71,-7651.03 4116.79,-7654.77 4121.29,-7660.13"/>
</g>
<!-- layer_1_mlp1_gpu3 -->
<g id="node88" class="node">
<title>layer_1_mlp1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="4072,-7650.8 3946,-7650.8 3946,-7597.8 4072,-7597.8 4072,-7650.8"/>
<text text-anchor="middle" x="4009" y="-7635.6" font-family="Times,serif" font-size="14.00">MLP1 GPU3</text>
<text text-anchor="middle" x="4009" y="-7620.6" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4009" y="-7605.6" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp1_gpu3 -->
<g id="edge117" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp1_gpu3</title>
<path fill="none" stroke="black" d="M3952.98,-7689.49C3960.84,-7680.49 3970.56,-7669.35 3979.69,-7658.89"/>
<polygon fill="black" stroke="black" points="3982.57,-7660.91 3986.51,-7651.07 3977.3,-7656.3 3982.57,-7660.91"/>
</g>
<!-- layer_1_mlp1_gpu4 -->
<g id="node89" class="node">
<title>layer_1_mlp1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3928,-7650.8 3802,-7650.8 3802,-7597.8 3928,-7597.8 3928,-7650.8"/>
<text text-anchor="middle" x="3865" y="-7635.6" font-family="Times,serif" font-size="14.00">MLP1 GPU4</text>
<text text-anchor="middle" x="3865" y="-7620.6" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3865" y="-7605.6" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp1_gpu4 -->
<g id="edge121" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp1_gpu4</title>
<path fill="none" stroke="black" d="M3921.02,-7689.49C3913.16,-7680.49 3903.44,-7669.35 3894.31,-7658.89"/>
<polygon fill="black" stroke="black" points="3896.7,-7656.3 3887.49,-7651.07 3891.43,-7660.91 3896.7,-7656.3"/>
</g>
<!-- layer_1_mlp1_gpu5 -->
<g id="node90" class="node">
<title>layer_1_mlp1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3784,-7650.8 3658,-7650.8 3658,-7597.8 3784,-7597.8 3784,-7650.8"/>
<text text-anchor="middle" x="3721" y="-7635.6" font-family="Times,serif" font-size="14.00">MLP1 GPU5</text>
<text text-anchor="middle" x="3721" y="-7620.6" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3721" y="-7605.6" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp1_gpu5 -->
<g id="edge125" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp1_gpu5</title>
<path fill="none" stroke="black" d="M3881.46,-7704.11C3853.91,-7700.73 3820.69,-7694.24 3793,-7681.8 3779.59,-7675.78 3766.46,-7666.73 3755.17,-7657.63"/>
<polygon fill="black" stroke="black" points="3757.21,-7654.77 3747.29,-7651.03 3752.71,-7660.13 3757.21,-7654.77"/>
</g>
<!-- layer_1_mlp1_gpu6 -->
<g id="node91" class="node">
<title>layer_1_mlp1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="3640,-7650.8 3514,-7650.8 3514,-7597.8 3640,-7597.8 3640,-7650.8"/>
<text text-anchor="middle" x="3577" y="-7635.6" font-family="Times,serif" font-size="14.00">MLP1 GPU6</text>
<text text-anchor="middle" x="3577" y="-7620.6" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3577" y="-7605.6" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp1_gpu6 -->
<g id="edge129" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp1_gpu6</title>
<path fill="none" stroke="black" d="M3881.32,-7706.52C3809.76,-7704.22 3689.89,-7698.03 3649,-7681.8 3634.84,-7676.18 3621.19,-7666.85 3609.65,-7657.37"/>
<polygon fill="black" stroke="black" points="3611.89,-7654.68 3602.02,-7650.83 3607.33,-7659.99 3611.89,-7654.68"/>
</g>
<!-- layer_1_mlp1_gpu7 -->
<g id="node92" class="node">
<title>layer_1_mlp1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3496,-7650.8 3370,-7650.8 3370,-7597.8 3496,-7597.8 3496,-7650.8"/>
<text text-anchor="middle" x="3433" y="-7635.6" font-family="Times,serif" font-size="14.00">MLP1 GPU7</text>
<text text-anchor="middle" x="3433" y="-7620.6" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3433" y="-7605.6" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp1_gpu7 -->
<g id="edge133" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp1_gpu7</title>
<path fill="none" stroke="black" d="M3881.36,-7708.54C3780.63,-7709.21 3572.26,-7707.33 3505,-7681.8 3490.76,-7676.4 3477.08,-7667.12 3465.55,-7657.62"/>
<polygon fill="black" stroke="black" points="3467.79,-7654.93 3457.93,-7651.06 3463.22,-7660.23 3467.79,-7654.93"/>
</g>
<!-- layer_1_gelu_gpu0 -->
<g id="node93" class="node">
<title>layer_1_gelu_gpu0</title>
<polygon fill="lightblue" stroke="black" points="4493,-7561.8 4389,-7561.8 4389,-7523.8 4493,-7523.8 4493,-7561.8"/>
<text text-anchor="middle" x="4441" y="-7546.6" font-family="Times,serif" font-size="14.00">GELU GPU0</text>
<text text-anchor="middle" x="4441" y="-7531.6" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_1_mlp1_gpu0&#45;&gt;layer_1_gelu_gpu0 -->
<g id="edge106" class="edge">
<title>layer_1_mlp1_gpu0&#45;&gt;layer_1_gelu_gpu0</title>
<path fill="none" stroke="black" d="M4441,-7597.71C4441,-7589.54 4441,-7580.45 4441,-7572.1"/>
<polygon fill="black" stroke="black" points="4444.5,-7572.04 4441,-7562.04 4437.5,-7572.04 4444.5,-7572.04"/>
</g>
<!-- layer_1_gelu_gpu1 -->
<g id="node94" class="node">
<title>layer_1_gelu_gpu1</title>
<polygon fill="lightblue" stroke="black" points="4349,-7561.8 4245,-7561.8 4245,-7523.8 4349,-7523.8 4349,-7561.8"/>
<text text-anchor="middle" x="4297" y="-7546.6" font-family="Times,serif" font-size="14.00">GELU GPU1</text>
<text text-anchor="middle" x="4297" y="-7531.6" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_1_mlp1_gpu1&#45;&gt;layer_1_gelu_gpu1 -->
<g id="edge110" class="edge">
<title>layer_1_mlp1_gpu1&#45;&gt;layer_1_gelu_gpu1</title>
<path fill="none" stroke="black" d="M4297,-7597.71C4297,-7589.54 4297,-7580.45 4297,-7572.1"/>
<polygon fill="black" stroke="black" points="4300.5,-7572.04 4297,-7562.04 4293.5,-7572.04 4300.5,-7572.04"/>
</g>
<!-- layer_1_gelu_gpu2 -->
<g id="node95" class="node">
<title>layer_1_gelu_gpu2</title>
<polygon fill="lightblue" stroke="black" points="4205,-7561.8 4101,-7561.8 4101,-7523.8 4205,-7523.8 4205,-7561.8"/>
<text text-anchor="middle" x="4153" y="-7546.6" font-family="Times,serif" font-size="14.00">GELU GPU2</text>
<text text-anchor="middle" x="4153" y="-7531.6" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_1_mlp1_gpu2&#45;&gt;layer_1_gelu_gpu2 -->
<g id="edge114" class="edge">
<title>layer_1_mlp1_gpu2&#45;&gt;layer_1_gelu_gpu2</title>
<path fill="none" stroke="black" d="M4153,-7597.71C4153,-7589.54 4153,-7580.45 4153,-7572.1"/>
<polygon fill="black" stroke="black" points="4156.5,-7572.04 4153,-7562.04 4149.5,-7572.04 4156.5,-7572.04"/>
</g>
<!-- layer_1_gelu_gpu3 -->
<g id="node96" class="node">
<title>layer_1_gelu_gpu3</title>
<polygon fill="lightblue" stroke="black" points="4061,-7561.8 3957,-7561.8 3957,-7523.8 4061,-7523.8 4061,-7561.8"/>
<text text-anchor="middle" x="4009" y="-7546.6" font-family="Times,serif" font-size="14.00">GELU GPU3</text>
<text text-anchor="middle" x="4009" y="-7531.6" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_1_mlp1_gpu3&#45;&gt;layer_1_gelu_gpu3 -->
<g id="edge118" class="edge">
<title>layer_1_mlp1_gpu3&#45;&gt;layer_1_gelu_gpu3</title>
<path fill="none" stroke="black" d="M4009,-7597.71C4009,-7589.54 4009,-7580.45 4009,-7572.1"/>
<polygon fill="black" stroke="black" points="4012.5,-7572.04 4009,-7562.04 4005.5,-7572.04 4012.5,-7572.04"/>
</g>
<!-- layer_1_gelu_gpu4 -->
<g id="node97" class="node">
<title>layer_1_gelu_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3917,-7561.8 3813,-7561.8 3813,-7523.8 3917,-7523.8 3917,-7561.8"/>
<text text-anchor="middle" x="3865" y="-7546.6" font-family="Times,serif" font-size="14.00">GELU GPU4</text>
<text text-anchor="middle" x="3865" y="-7531.6" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_1_mlp1_gpu4&#45;&gt;layer_1_gelu_gpu4 -->
<g id="edge122" class="edge">
<title>layer_1_mlp1_gpu4&#45;&gt;layer_1_gelu_gpu4</title>
<path fill="none" stroke="black" d="M3865,-7597.71C3865,-7589.54 3865,-7580.45 3865,-7572.1"/>
<polygon fill="black" stroke="black" points="3868.5,-7572.04 3865,-7562.04 3861.5,-7572.04 3868.5,-7572.04"/>
</g>
<!-- layer_1_gelu_gpu5 -->
<g id="node98" class="node">
<title>layer_1_gelu_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3773,-7561.8 3669,-7561.8 3669,-7523.8 3773,-7523.8 3773,-7561.8"/>
<text text-anchor="middle" x="3721" y="-7546.6" font-family="Times,serif" font-size="14.00">GELU GPU5</text>
<text text-anchor="middle" x="3721" y="-7531.6" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_1_mlp1_gpu5&#45;&gt;layer_1_gelu_gpu5 -->
<g id="edge126" class="edge">
<title>layer_1_mlp1_gpu5&#45;&gt;layer_1_gelu_gpu5</title>
<path fill="none" stroke="black" d="M3721,-7597.71C3721,-7589.54 3721,-7580.45 3721,-7572.1"/>
<polygon fill="black" stroke="black" points="3724.5,-7572.04 3721,-7562.04 3717.5,-7572.04 3724.5,-7572.04"/>
</g>
<!-- layer_1_gelu_gpu6 -->
<g id="node99" class="node">
<title>layer_1_gelu_gpu6</title>
<polygon fill="lightblue" stroke="black" points="3629,-7561.8 3525,-7561.8 3525,-7523.8 3629,-7523.8 3629,-7561.8"/>
<text text-anchor="middle" x="3577" y="-7546.6" font-family="Times,serif" font-size="14.00">GELU GPU6</text>
<text text-anchor="middle" x="3577" y="-7531.6" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_1_mlp1_gpu6&#45;&gt;layer_1_gelu_gpu6 -->
<g id="edge130" class="edge">
<title>layer_1_mlp1_gpu6&#45;&gt;layer_1_gelu_gpu6</title>
<path fill="none" stroke="black" d="M3577,-7597.71C3577,-7589.54 3577,-7580.45 3577,-7572.1"/>
<polygon fill="black" stroke="black" points="3580.5,-7572.04 3577,-7562.04 3573.5,-7572.04 3580.5,-7572.04"/>
</g>
<!-- layer_1_gelu_gpu7 -->
<g id="node100" class="node">
<title>layer_1_gelu_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3485,-7561.8 3381,-7561.8 3381,-7523.8 3485,-7523.8 3485,-7561.8"/>
<text text-anchor="middle" x="3433" y="-7546.6" font-family="Times,serif" font-size="14.00">GELU GPU7</text>
<text text-anchor="middle" x="3433" y="-7531.6" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_1_mlp1_gpu7&#45;&gt;layer_1_gelu_gpu7 -->
<g id="edge134" class="edge">
<title>layer_1_mlp1_gpu7&#45;&gt;layer_1_gelu_gpu7</title>
<path fill="none" stroke="black" d="M3433,-7597.71C3433,-7589.54 3433,-7580.45 3433,-7572.1"/>
<polygon fill="black" stroke="black" points="3436.5,-7572.04 3433,-7562.04 3429.5,-7572.04 3436.5,-7572.04"/>
</g>
<!-- layer_1_mlp2_gpu0 -->
<g id="node101" class="node">
<title>layer_1_mlp2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="4504,-7487.8 4378,-7487.8 4378,-7434.8 4504,-7434.8 4504,-7487.8"/>
<text text-anchor="middle" x="4441" y="-7472.6" font-family="Times,serif" font-size="14.00">MLP2 GPU0</text>
<text text-anchor="middle" x="4441" y="-7457.6" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4441" y="-7442.6" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_1_gelu_gpu0&#45;&gt;layer_1_mlp2_gpu0 -->
<g id="edge107" class="edge">
<title>layer_1_gelu_gpu0&#45;&gt;layer_1_mlp2_gpu0</title>
<path fill="none" stroke="black" d="M4441,-7523.76C4441,-7516.12 4441,-7506.94 4441,-7498.03"/>
<polygon fill="black" stroke="black" points="4444.5,-7497.81 4441,-7487.81 4437.5,-7497.81 4444.5,-7497.81"/>
</g>
<!-- layer_1_mlp2_gpu1 -->
<g id="node102" class="node">
<title>layer_1_mlp2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="4360,-7487.8 4234,-7487.8 4234,-7434.8 4360,-7434.8 4360,-7487.8"/>
<text text-anchor="middle" x="4297" y="-7472.6" font-family="Times,serif" font-size="14.00">MLP2 GPU1</text>
<text text-anchor="middle" x="4297" y="-7457.6" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4297" y="-7442.6" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_1_gelu_gpu1&#45;&gt;layer_1_mlp2_gpu1 -->
<g id="edge111" class="edge">
<title>layer_1_gelu_gpu1&#45;&gt;layer_1_mlp2_gpu1</title>
<path fill="none" stroke="black" d="M4297,-7523.76C4297,-7516.12 4297,-7506.94 4297,-7498.03"/>
<polygon fill="black" stroke="black" points="4300.5,-7497.81 4297,-7487.81 4293.5,-7497.81 4300.5,-7497.81"/>
</g>
<!-- layer_1_mlp2_gpu2 -->
<g id="node103" class="node">
<title>layer_1_mlp2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="4216,-7487.8 4090,-7487.8 4090,-7434.8 4216,-7434.8 4216,-7487.8"/>
<text text-anchor="middle" x="4153" y="-7472.6" font-family="Times,serif" font-size="14.00">MLP2 GPU2</text>
<text text-anchor="middle" x="4153" y="-7457.6" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4153" y="-7442.6" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_1_gelu_gpu2&#45;&gt;layer_1_mlp2_gpu2 -->
<g id="edge115" class="edge">
<title>layer_1_gelu_gpu2&#45;&gt;layer_1_mlp2_gpu2</title>
<path fill="none" stroke="black" d="M4153,-7523.76C4153,-7516.12 4153,-7506.94 4153,-7498.03"/>
<polygon fill="black" stroke="black" points="4156.5,-7497.81 4153,-7487.81 4149.5,-7497.81 4156.5,-7497.81"/>
</g>
<!-- layer_1_mlp2_gpu3 -->
<g id="node104" class="node">
<title>layer_1_mlp2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="4072,-7487.8 3946,-7487.8 3946,-7434.8 4072,-7434.8 4072,-7487.8"/>
<text text-anchor="middle" x="4009" y="-7472.6" font-family="Times,serif" font-size="14.00">MLP2 GPU3</text>
<text text-anchor="middle" x="4009" y="-7457.6" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4009" y="-7442.6" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_1_gelu_gpu3&#45;&gt;layer_1_mlp2_gpu3 -->
<g id="edge119" class="edge">
<title>layer_1_gelu_gpu3&#45;&gt;layer_1_mlp2_gpu3</title>
<path fill="none" stroke="black" d="M4009,-7523.76C4009,-7516.12 4009,-7506.94 4009,-7498.03"/>
<polygon fill="black" stroke="black" points="4012.5,-7497.81 4009,-7487.81 4005.5,-7497.81 4012.5,-7497.81"/>
</g>
<!-- layer_1_mlp2_gpu4 -->
<g id="node105" class="node">
<title>layer_1_mlp2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3928,-7487.8 3802,-7487.8 3802,-7434.8 3928,-7434.8 3928,-7487.8"/>
<text text-anchor="middle" x="3865" y="-7472.6" font-family="Times,serif" font-size="14.00">MLP2 GPU4</text>
<text text-anchor="middle" x="3865" y="-7457.6" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3865" y="-7442.6" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_1_gelu_gpu4&#45;&gt;layer_1_mlp2_gpu4 -->
<g id="edge123" class="edge">
<title>layer_1_gelu_gpu4&#45;&gt;layer_1_mlp2_gpu4</title>
<path fill="none" stroke="black" d="M3865,-7523.76C3865,-7516.12 3865,-7506.94 3865,-7498.03"/>
<polygon fill="black" stroke="black" points="3868.5,-7497.81 3865,-7487.81 3861.5,-7497.81 3868.5,-7497.81"/>
</g>
<!-- layer_1_mlp2_gpu5 -->
<g id="node106" class="node">
<title>layer_1_mlp2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3784,-7487.8 3658,-7487.8 3658,-7434.8 3784,-7434.8 3784,-7487.8"/>
<text text-anchor="middle" x="3721" y="-7472.6" font-family="Times,serif" font-size="14.00">MLP2 GPU5</text>
<text text-anchor="middle" x="3721" y="-7457.6" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3721" y="-7442.6" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_1_gelu_gpu5&#45;&gt;layer_1_mlp2_gpu5 -->
<g id="edge127" class="edge">
<title>layer_1_gelu_gpu5&#45;&gt;layer_1_mlp2_gpu5</title>
<path fill="none" stroke="black" d="M3721,-7523.76C3721,-7516.12 3721,-7506.94 3721,-7498.03"/>
<polygon fill="black" stroke="black" points="3724.5,-7497.81 3721,-7487.81 3717.5,-7497.81 3724.5,-7497.81"/>
</g>
<!-- layer_1_mlp2_gpu6 -->
<g id="node107" class="node">
<title>layer_1_mlp2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="3640,-7487.8 3514,-7487.8 3514,-7434.8 3640,-7434.8 3640,-7487.8"/>
<text text-anchor="middle" x="3577" y="-7472.6" font-family="Times,serif" font-size="14.00">MLP2 GPU6</text>
<text text-anchor="middle" x="3577" y="-7457.6" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3577" y="-7442.6" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_1_gelu_gpu6&#45;&gt;layer_1_mlp2_gpu6 -->
<g id="edge131" class="edge">
<title>layer_1_gelu_gpu6&#45;&gt;layer_1_mlp2_gpu6</title>
<path fill="none" stroke="black" d="M3577,-7523.76C3577,-7516.12 3577,-7506.94 3577,-7498.03"/>
<polygon fill="black" stroke="black" points="3580.5,-7497.81 3577,-7487.81 3573.5,-7497.81 3580.5,-7497.81"/>
</g>
<!-- layer_1_mlp2_gpu7 -->
<g id="node108" class="node">
<title>layer_1_mlp2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3496,-7487.8 3370,-7487.8 3370,-7434.8 3496,-7434.8 3496,-7487.8"/>
<text text-anchor="middle" x="3433" y="-7472.6" font-family="Times,serif" font-size="14.00">MLP2 GPU7</text>
<text text-anchor="middle" x="3433" y="-7457.6" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3433" y="-7442.6" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_1_gelu_gpu7&#45;&gt;layer_1_mlp2_gpu7 -->
<g id="edge135" class="edge">
<title>layer_1_gelu_gpu7&#45;&gt;layer_1_mlp2_gpu7</title>
<path fill="none" stroke="black" d="M3433,-7523.76C3433,-7516.12 3433,-7506.94 3433,-7498.03"/>
<polygon fill="black" stroke="black" points="3436.5,-7497.81 3433,-7487.81 3429.5,-7497.81 3436.5,-7497.81"/>
</g>
<!-- layer_1_mlp_allreduce -->
<g id="node109" class="node">
<title>layer_1_mlp_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="3937" cy="-7371.93" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="3937" y="-7375.73" font-family="Times,serif" font-size="14.00">MLP AllReduce</text>
<text text-anchor="middle" x="3937" y="-7360.73" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_1_mlp2_gpu0&#45;&gt;layer_1_mlp_allreduce -->
<g id="edge108" class="edge">
<title>layer_1_mlp2_gpu0&#45;&gt;layer_1_mlp_allreduce</title>
<path fill="none" stroke="black" d="M4378,-7437.19C4374.97,-7436.33 4371.96,-7435.53 4369,-7434.8 4254.59,-7406.65 4119.77,-7389.87 4031.56,-7381.03"/>
<polygon fill="black" stroke="black" points="4031.86,-7377.55 4021.57,-7380.05 4031.18,-7384.51 4031.86,-7377.55"/>
</g>
<!-- layer_1_mlp2_gpu1&#45;&gt;layer_1_mlp_allreduce -->
<g id="edge112" class="edge">
<title>layer_1_mlp2_gpu1&#45;&gt;layer_1_mlp_allreduce</title>
<path fill="none" stroke="black" d="M4233.93,-7437.45C4230.92,-7436.52 4227.93,-7435.63 4225,-7434.8 4157.58,-7415.71 4079.82,-7399.33 4022.11,-7388.23"/>
<polygon fill="black" stroke="black" points="4022.42,-7384.72 4011.94,-7386.29 4021.1,-7391.6 4022.42,-7384.72"/>
</g>
<!-- layer_1_mlp2_gpu2&#45;&gt;layer_1_mlp_allreduce -->
<g id="edge116" class="edge">
<title>layer_1_mlp2_gpu2&#45;&gt;layer_1_mlp_allreduce</title>
<path fill="none" stroke="black" d="M4089.94,-7434.8C4061.08,-7423.12 4027,-7409.34 3998.35,-7397.75"/>
<polygon fill="black" stroke="black" points="3999.44,-7394.41 3988.86,-7393.91 3996.81,-7400.9 3999.44,-7394.41"/>
</g>
<!-- layer_1_mlp2_gpu3&#45;&gt;layer_1_mlp_allreduce -->
<g id="edge120" class="edge">
<title>layer_1_mlp2_gpu3&#45;&gt;layer_1_mlp_allreduce</title>
<path fill="none" stroke="black" d="M3987.79,-7434.56C3980.4,-7425.59 3972,-7415.41 3964.2,-7405.94"/>
<polygon fill="black" stroke="black" points="3966.87,-7403.68 3957.81,-7398.19 3961.47,-7408.13 3966.87,-7403.68"/>
</g>
<!-- layer_1_mlp2_gpu4&#45;&gt;layer_1_mlp_allreduce -->
<g id="edge124" class="edge">
<title>layer_1_mlp2_gpu4&#45;&gt;layer_1_mlp_allreduce</title>
<path fill="none" stroke="black" d="M3886.21,-7434.56C3893.6,-7425.59 3902,-7415.41 3909.8,-7405.94"/>
<polygon fill="black" stroke="black" points="3912.53,-7408.13 3916.19,-7398.19 3907.13,-7403.68 3912.53,-7408.13"/>
</g>
<!-- layer_1_mlp2_gpu5&#45;&gt;layer_1_mlp_allreduce -->
<g id="edge128" class="edge">
<title>layer_1_mlp2_gpu5&#45;&gt;layer_1_mlp_allreduce</title>
<path fill="none" stroke="black" d="M3784.06,-7434.8C3812.92,-7423.12 3847,-7409.34 3875.65,-7397.75"/>
<polygon fill="black" stroke="black" points="3877.19,-7400.9 3885.14,-7393.91 3874.56,-7394.41 3877.19,-7400.9"/>
</g>
<!-- layer_1_mlp2_gpu6&#45;&gt;layer_1_mlp_allreduce -->
<g id="edge132" class="edge">
<title>layer_1_mlp2_gpu6&#45;&gt;layer_1_mlp_allreduce</title>
<path fill="none" stroke="black" d="M3640.07,-7437.45C3643.08,-7436.52 3646.07,-7435.63 3649,-7434.8 3716.42,-7415.71 3794.18,-7399.33 3851.89,-7388.23"/>
<polygon fill="black" stroke="black" points="3852.9,-7391.6 3862.06,-7386.29 3851.58,-7384.72 3852.9,-7391.6"/>
</g>
<!-- layer_1_mlp2_gpu7&#45;&gt;layer_1_mlp_allreduce -->
<g id="edge136" class="edge">
<title>layer_1_mlp2_gpu7&#45;&gt;layer_1_mlp_allreduce</title>
<path fill="none" stroke="black" d="M3496,-7437.19C3499.03,-7436.33 3502.04,-7435.53 3505,-7434.8 3619.41,-7406.65 3754.23,-7389.87 3842.44,-7381.03"/>
<polygon fill="black" stroke="black" points="3842.82,-7384.51 3852.43,-7380.05 3842.14,-7377.55 3842.82,-7384.51"/>
</g>
<!-- layer_1_residual2 -->
<g id="node110" class="node">
<title>layer_1_residual2</title>
<polygon fill="lightyellow" stroke="black" points="4065.61,-7309.06 3861.02,-7309.06 3808.39,-7233.06 4012.98,-7233.06 4065.61,-7309.06"/>
<text text-anchor="middle" x="3937" y="-7274.86" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="3937" y="-7259.86" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_1_mlp_allreduce&#45;&gt;layer_1_residual2 -->
<g id="edge137" class="edge">
<title>layer_1_mlp_allreduce&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M3937,-7344.96C3937,-7337.14 3937,-7328.31 3937,-7319.56"/>
<polygon fill="black" stroke="black" points="3940.5,-7319.39 3937,-7309.39 3933.5,-7319.39 3940.5,-7319.39"/>
</g>
<!-- layer_1_ln2 -->
<g id="node111" class="node">
<title>layer_1_ln2</title>
<polygon fill="lightblue" stroke="black" points="3992.5,-7197.06 3881.5,-7197.06 3881.5,-7159.06 3992.5,-7159.06 3992.5,-7197.06"/>
<text text-anchor="middle" x="3937" y="-7181.86" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="3937" y="-7166.86" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_1_residual2&#45;&gt;layer_1_ln2 -->
<g id="edge138" class="edge">
<title>layer_1_residual2&#45;&gt;layer_1_ln2</title>
<path fill="none" stroke="black" d="M3937,-7233.05C3937,-7224.43 3937,-7215.38 3937,-7207.22"/>
<polygon fill="black" stroke="black" points="3940.5,-7207.1 3937,-7197.1 3933.5,-7207.1 3940.5,-7207.1"/>
</g>
<!-- layer_2_qkv_gpu0 -->
<g id="node112" class="node">
<title>layer_2_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="4001,-7120.06 3873,-7120.06 3873,-7067.06 4001,-7067.06 4001,-7120.06"/>
<text text-anchor="middle" x="3937" y="-7104.86" font-family="Times,serif" font-size="14.00">QKV Proj GPU0</text>
<text text-anchor="middle" x="3937" y="-7089.86" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3937" y="-7074.86" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_1_ln2&#45;&gt;layer_2_qkv_gpu0 -->
<g id="edge139" class="edge">
<title>layer_1_ln2&#45;&gt;layer_2_qkv_gpu0</title>
<path fill="none" stroke="black" d="M3937,-7158.75C3937,-7150.46 3937,-7140.34 3937,-7130.62"/>
<polygon fill="black" stroke="black" points="3940.5,-7130.33 3937,-7120.33 3933.5,-7130.33 3940.5,-7130.33"/>
</g>
<!-- layer_2_qkv_comm -->
<g id="node120" class="node">
<title>layer_2_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="3426" cy="-7004.19" rx="85.62" ry="26.74"/>
<text text-anchor="middle" x="3426" y="-7007.99" font-family="Times,serif" font-size="14.00">QKV AllGather</text>
<text text-anchor="middle" x="3426" y="-6992.99" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_2_qkv_gpu0&#45;&gt;layer_2_qkv_comm -->
<g id="edge140" class="edge">
<title>layer_2_qkv_gpu0&#45;&gt;layer_2_qkv_comm</title>
<path fill="none" stroke="black" d="M3872.72,-7069.34C3869.79,-7068.52 3866.87,-7067.76 3864,-7067.06 3746.33,-7038.49 3607.46,-7021.64 3518.13,-7012.92"/>
<polygon fill="black" stroke="black" points="3518.32,-7009.42 3508.03,-7011.95 3517.65,-7016.39 3518.32,-7009.42"/>
</g>
<!-- layer_2_qkv_gpu1 -->
<g id="node113" class="node">
<title>layer_2_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="3855,-7120.06 3727,-7120.06 3727,-7067.06 3855,-7067.06 3855,-7120.06"/>
<text text-anchor="middle" x="3791" y="-7104.86" font-family="Times,serif" font-size="14.00">QKV Proj GPU1</text>
<text text-anchor="middle" x="3791" y="-7089.86" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3791" y="-7074.86" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_2_qkv_gpu1&#45;&gt;layer_2_qkv_comm -->
<g id="edge141" class="edge">
<title>layer_2_qkv_gpu1&#45;&gt;layer_2_qkv_comm</title>
<path fill="none" stroke="black" d="M3726.65,-7069.59C3723.74,-7068.7 3720.84,-7067.86 3718,-7067.06 3648.53,-7047.65 3568.28,-7031.06 3509.5,-7019.96"/>
<polygon fill="black" stroke="black" points="3510,-7016.49 3499.53,-7018.09 3508.71,-7023.37 3510,-7016.49"/>
</g>
<!-- layer_2_qkv_gpu2 -->
<g id="node114" class="node">
<title>layer_2_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="3709,-7120.06 3581,-7120.06 3581,-7067.06 3709,-7067.06 3709,-7120.06"/>
<text text-anchor="middle" x="3645" y="-7104.86" font-family="Times,serif" font-size="14.00">QKV Proj GPU2</text>
<text text-anchor="middle" x="3645" y="-7089.86" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3645" y="-7074.86" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_2_qkv_gpu2&#45;&gt;layer_2_qkv_comm -->
<g id="edge142" class="edge">
<title>layer_2_qkv_gpu2&#45;&gt;layer_2_qkv_comm</title>
<path fill="none" stroke="black" d="M3581.07,-7067.06C3551.33,-7055.19 3516.14,-7041.16 3486.81,-7029.45"/>
<polygon fill="black" stroke="black" points="3488.09,-7026.19 3477.5,-7025.74 3485.5,-7032.7 3488.09,-7026.19"/>
</g>
<!-- layer_2_qkv_gpu3 -->
<g id="node115" class="node">
<title>layer_2_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3563,-7120.06 3435,-7120.06 3435,-7067.06 3563,-7067.06 3563,-7120.06"/>
<text text-anchor="middle" x="3499" y="-7104.86" font-family="Times,serif" font-size="14.00">QKV Proj GPU3</text>
<text text-anchor="middle" x="3499" y="-7089.86" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3499" y="-7074.86" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_2_qkv_gpu3&#45;&gt;layer_2_qkv_comm -->
<g id="edge143" class="edge">
<title>layer_2_qkv_gpu3&#45;&gt;layer_2_qkv_comm</title>
<path fill="none" stroke="black" d="M3477.49,-7066.82C3470,-7057.85 3461.49,-7047.67 3453.58,-7038.2"/>
<polygon fill="black" stroke="black" points="3456.2,-7035.88 3447.1,-7030.45 3450.83,-7040.37 3456.2,-7035.88"/>
</g>
<!-- layer_2_qkv_gpu4 -->
<g id="node116" class="node">
<title>layer_2_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3417,-7120.06 3289,-7120.06 3289,-7067.06 3417,-7067.06 3417,-7120.06"/>
<text text-anchor="middle" x="3353" y="-7104.86" font-family="Times,serif" font-size="14.00">QKV Proj GPU4</text>
<text text-anchor="middle" x="3353" y="-7089.86" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3353" y="-7074.86" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_2_qkv_gpu4&#45;&gt;layer_2_qkv_comm -->
<g id="edge144" class="edge">
<title>layer_2_qkv_gpu4&#45;&gt;layer_2_qkv_comm</title>
<path fill="none" stroke="black" d="M3374.51,-7066.82C3382,-7057.85 3390.51,-7047.67 3398.42,-7038.2"/>
<polygon fill="black" stroke="black" points="3401.17,-7040.37 3404.9,-7030.45 3395.8,-7035.88 3401.17,-7040.37"/>
</g>
<!-- layer_2_qkv_gpu5 -->
<g id="node117" class="node">
<title>layer_2_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3271,-7120.06 3143,-7120.06 3143,-7067.06 3271,-7067.06 3271,-7120.06"/>
<text text-anchor="middle" x="3207" y="-7104.86" font-family="Times,serif" font-size="14.00">QKV Proj GPU5</text>
<text text-anchor="middle" x="3207" y="-7089.86" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3207" y="-7074.86" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_2_qkv_gpu5&#45;&gt;layer_2_qkv_comm -->
<g id="edge145" class="edge">
<title>layer_2_qkv_gpu5&#45;&gt;layer_2_qkv_comm</title>
<path fill="none" stroke="black" d="M3270.93,-7067.06C3300.67,-7055.19 3335.86,-7041.16 3365.19,-7029.45"/>
<polygon fill="black" stroke="black" points="3366.5,-7032.7 3374.5,-7025.74 3363.91,-7026.19 3366.5,-7032.7"/>
</g>
<!-- layer_2_qkv_gpu6 -->
<g id="node118" class="node">
<title>layer_2_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="3125,-7120.06 2997,-7120.06 2997,-7067.06 3125,-7067.06 3125,-7120.06"/>
<text text-anchor="middle" x="3061" y="-7104.86" font-family="Times,serif" font-size="14.00">QKV Proj GPU6</text>
<text text-anchor="middle" x="3061" y="-7089.86" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3061" y="-7074.86" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_2_qkv_gpu6&#45;&gt;layer_2_qkv_comm -->
<g id="edge146" class="edge">
<title>layer_2_qkv_gpu6&#45;&gt;layer_2_qkv_comm</title>
<path fill="none" stroke="black" d="M3125.35,-7069.59C3128.26,-7068.7 3131.16,-7067.86 3134,-7067.06 3203.47,-7047.65 3283.72,-7031.06 3342.5,-7019.96"/>
<polygon fill="black" stroke="black" points="3343.29,-7023.37 3352.47,-7018.09 3342,-7016.49 3343.29,-7023.37"/>
</g>
<!-- layer_2_qkv_gpu7 -->
<g id="node119" class="node">
<title>layer_2_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2979,-7120.06 2851,-7120.06 2851,-7067.06 2979,-7067.06 2979,-7120.06"/>
<text text-anchor="middle" x="2915" y="-7104.86" font-family="Times,serif" font-size="14.00">QKV Proj GPU7</text>
<text text-anchor="middle" x="2915" y="-7089.86" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2915" y="-7074.86" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_2_qkv_gpu7&#45;&gt;layer_2_qkv_comm -->
<g id="edge147" class="edge">
<title>layer_2_qkv_gpu7&#45;&gt;layer_2_qkv_comm</title>
<path fill="none" stroke="black" d="M2979.28,-7069.34C2982.21,-7068.52 2985.13,-7067.76 2988,-7067.06 3105.67,-7038.49 3244.54,-7021.64 3333.87,-7012.92"/>
<polygon fill="black" stroke="black" points="3334.35,-7016.39 3343.97,-7011.95 3333.68,-7009.42 3334.35,-7016.39"/>
</g>
<!-- layer_2_attn_comp_gpu0 -->
<g id="node121" class="node">
<title>layer_2_attn_comp_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2769,-6941.32 2571,-6941.32 2571,-6888.32 2769,-6888.32 2769,-6941.32"/>
<text text-anchor="middle" x="2670" y="-6926.12" font-family="Times,serif" font-size="14.00">Attention Compute GPU0</text>
<text text-anchor="middle" x="2670" y="-6911.12" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="2670" y="-6896.12" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_2_qkv_comm&#45;&gt;layer_2_attn_comp_gpu0 -->
<g id="edge148" class="edge">
<title>layer_2_qkv_comm&#45;&gt;layer_2_attn_comp_gpu0</title>
<path fill="none" stroke="black" d="M3341.9,-6998.84C3219.86,-6991.71 2986.52,-6975.01 2779.22,-6941.43"/>
<polygon fill="black" stroke="black" points="2779.49,-6937.93 2769.06,-6939.77 2778.36,-6944.84 2779.49,-6937.93"/>
</g>
<!-- layer_2_attn_comp_gpu1 -->
<g id="node122" class="node">
<title>layer_2_attn_comp_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2985,-6941.32 2787,-6941.32 2787,-6888.32 2985,-6888.32 2985,-6941.32"/>
<text text-anchor="middle" x="2886" y="-6926.12" font-family="Times,serif" font-size="14.00">Attention Compute GPU1</text>
<text text-anchor="middle" x="2886" y="-6911.12" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="2886" y="-6896.12" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_2_qkv_comm&#45;&gt;layer_2_attn_comp_gpu1 -->
<g id="edge149" class="edge">
<title>layer_2_qkv_comm&#45;&gt;layer_2_attn_comp_gpu1</title>
<path fill="none" stroke="black" d="M3346.42,-6993.97C3261.69,-6983.65 3123.51,-6965.42 2995.11,-6941.47"/>
<polygon fill="black" stroke="black" points="2995.57,-6937.99 2985.09,-6939.58 2994.27,-6944.87 2995.57,-6937.99"/>
</g>
<!-- layer_2_attn_comp_gpu2 -->
<g id="node123" class="node">
<title>layer_2_attn_comp_gpu2</title>
<polygon fill="lightblue" stroke="black" points="3201,-6941.32 3003,-6941.32 3003,-6888.32 3201,-6888.32 3201,-6941.32"/>
<text text-anchor="middle" x="3102" y="-6926.12" font-family="Times,serif" font-size="14.00">Attention Compute GPU2</text>
<text text-anchor="middle" x="3102" y="-6911.12" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="3102" y="-6896.12" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_2_qkv_comm&#45;&gt;layer_2_attn_comp_gpu2 -->
<g id="edge150" class="edge">
<title>layer_2_qkv_comm&#45;&gt;layer_2_attn_comp_gpu2</title>
<path fill="none" stroke="black" d="M3362.37,-6986.03C3318.05,-6974.08 3257.92,-6957.87 3206.61,-6944.03"/>
<polygon fill="black" stroke="black" points="3207.37,-6940.61 3196.8,-6941.39 3205.55,-6947.37 3207.37,-6940.61"/>
</g>
<!-- layer_2_attn_comp_gpu3 -->
<g id="node124" class="node">
<title>layer_2_attn_comp_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3417,-6941.32 3219,-6941.32 3219,-6888.32 3417,-6888.32 3417,-6941.32"/>
<text text-anchor="middle" x="3318" y="-6926.12" font-family="Times,serif" font-size="14.00">Attention Compute GPU3</text>
<text text-anchor="middle" x="3318" y="-6911.12" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="3318" y="-6896.12" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_2_qkv_comm&#45;&gt;layer_2_attn_comp_gpu3 -->
<g id="edge151" class="edge">
<title>layer_2_qkv_comm&#45;&gt;layer_2_attn_comp_gpu3</title>
<path fill="none" stroke="black" d="M3395.92,-6978.85C3384.14,-6969.33 3370.46,-6958.26 3357.88,-6948.09"/>
<polygon fill="black" stroke="black" points="3359.78,-6945.12 3349.81,-6941.55 3355.38,-6950.56 3359.78,-6945.12"/>
</g>
<!-- layer_2_attn_comp_gpu4 -->
<g id="node125" class="node">
<title>layer_2_attn_comp_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3633,-6941.32 3435,-6941.32 3435,-6888.32 3633,-6888.32 3633,-6941.32"/>
<text text-anchor="middle" x="3534" y="-6926.12" font-family="Times,serif" font-size="14.00">Attention Compute GPU4</text>
<text text-anchor="middle" x="3534" y="-6911.12" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="3534" y="-6896.12" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_2_qkv_comm&#45;&gt;layer_2_attn_comp_gpu4 -->
<g id="edge152" class="edge">
<title>layer_2_qkv_comm&#45;&gt;layer_2_attn_comp_gpu4</title>
<path fill="none" stroke="black" d="M3456.08,-6978.85C3467.86,-6969.33 3481.54,-6958.26 3494.12,-6948.09"/>
<polygon fill="black" stroke="black" points="3496.62,-6950.56 3502.19,-6941.55 3492.22,-6945.12 3496.62,-6950.56"/>
</g>
<!-- layer_2_attn_comp_gpu5 -->
<g id="node126" class="node">
<title>layer_2_attn_comp_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3849,-6941.32 3651,-6941.32 3651,-6888.32 3849,-6888.32 3849,-6941.32"/>
<text text-anchor="middle" x="3750" y="-6926.12" font-family="Times,serif" font-size="14.00">Attention Compute GPU5</text>
<text text-anchor="middle" x="3750" y="-6911.12" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="3750" y="-6896.12" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_2_qkv_comm&#45;&gt;layer_2_attn_comp_gpu5 -->
<g id="edge153" class="edge">
<title>layer_2_qkv_comm&#45;&gt;layer_2_attn_comp_gpu5</title>
<path fill="none" stroke="black" d="M3489.63,-6986.03C3533.95,-6974.08 3594.08,-6957.87 3645.39,-6944.03"/>
<polygon fill="black" stroke="black" points="3646.45,-6947.37 3655.2,-6941.39 3644.63,-6940.61 3646.45,-6947.37"/>
</g>
<!-- layer_2_attn_comp_gpu6 -->
<g id="node127" class="node">
<title>layer_2_attn_comp_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4065,-6941.32 3867,-6941.32 3867,-6888.32 4065,-6888.32 4065,-6941.32"/>
<text text-anchor="middle" x="3966" y="-6926.12" font-family="Times,serif" font-size="14.00">Attention Compute GPU6</text>
<text text-anchor="middle" x="3966" y="-6911.12" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="3966" y="-6896.12" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_2_qkv_comm&#45;&gt;layer_2_attn_comp_gpu6 -->
<g id="edge154" class="edge">
<title>layer_2_qkv_comm&#45;&gt;layer_2_attn_comp_gpu6</title>
<path fill="none" stroke="black" d="M3505.58,-6993.97C3590.31,-6983.65 3728.49,-6965.42 3856.89,-6941.47"/>
<polygon fill="black" stroke="black" points="3857.73,-6944.87 3866.91,-6939.58 3856.43,-6937.99 3857.73,-6944.87"/>
</g>
<!-- layer_2_attn_comp_gpu7 -->
<g id="node128" class="node">
<title>layer_2_attn_comp_gpu7</title>
<polygon fill="lightblue" stroke="black" points="4281,-6941.32 4083,-6941.32 4083,-6888.32 4281,-6888.32 4281,-6941.32"/>
<text text-anchor="middle" x="4182" y="-6926.12" font-family="Times,serif" font-size="14.00">Attention Compute GPU7</text>
<text text-anchor="middle" x="4182" y="-6911.12" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="4182" y="-6896.12" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_2_qkv_comm&#45;&gt;layer_2_attn_comp_gpu7 -->
<g id="edge155" class="edge">
<title>layer_2_qkv_comm&#45;&gt;layer_2_attn_comp_gpu7</title>
<path fill="none" stroke="black" d="M3510.1,-6998.84C3632.14,-6991.71 3865.48,-6975.01 4072.78,-6941.43"/>
<polygon fill="black" stroke="black" points="4073.64,-6944.84 4082.94,-6939.77 4072.51,-6937.93 4073.64,-6944.84"/>
</g>
<!-- layer_2_attn_out_gpu0 -->
<g id="node129" class="node">
<title>layer_2_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2781,-6852.32 2623,-6852.32 2623,-6799.32 2781,-6799.32 2781,-6852.32"/>
<text text-anchor="middle" x="2702" y="-6837.12" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU0</text>
<text text-anchor="middle" x="2702" y="-6822.12" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2702" y="-6807.12" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_2_attn_comp_gpu0&#45;&gt;layer_2_attn_out_gpu0 -->
<g id="edge156" class="edge">
<title>layer_2_attn_comp_gpu0&#45;&gt;layer_2_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M2679.43,-6888.19C2682.43,-6880.03 2685.8,-6870.86 2689.01,-6862.14"/>
<polygon fill="black" stroke="black" points="2692.36,-6863.17 2692.53,-6852.57 2685.79,-6860.75 2692.36,-6863.17"/>
</g>
<!-- layer_2_attn_out_gpu1 -->
<g id="node130" class="node">
<title>layer_2_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2990,-6852.32 2832,-6852.32 2832,-6799.32 2990,-6799.32 2990,-6852.32"/>
<text text-anchor="middle" x="2911" y="-6837.12" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU1</text>
<text text-anchor="middle" x="2911" y="-6822.12" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2911" y="-6807.12" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_2_attn_comp_gpu1&#45;&gt;layer_2_attn_out_gpu1 -->
<g id="edge157" class="edge">
<title>layer_2_attn_comp_gpu1&#45;&gt;layer_2_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M2893.37,-6888.19C2895.68,-6880.12 2898.29,-6871.06 2900.77,-6862.42"/>
<polygon fill="black" stroke="black" points="2904.2,-6863.15 2903.6,-6852.57 2897.47,-6861.22 2904.2,-6863.15"/>
</g>
<!-- layer_2_attn_out_gpu2 -->
<g id="node131" class="node">
<title>layer_2_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="3191,-6852.32 3033,-6852.32 3033,-6799.32 3191,-6799.32 3191,-6852.32"/>
<text text-anchor="middle" x="3112" y="-6837.12" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU2</text>
<text text-anchor="middle" x="3112" y="-6822.12" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3112" y="-6807.12" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_2_attn_comp_gpu2&#45;&gt;layer_2_attn_out_gpu2 -->
<g id="edge158" class="edge">
<title>layer_2_attn_comp_gpu2&#45;&gt;layer_2_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M3104.95,-6888.19C3105.86,-6880.21 3106.89,-6871.25 3107.88,-6862.71"/>
<polygon fill="black" stroke="black" points="3111.38,-6862.91 3109.04,-6852.57 3104.42,-6862.11 3111.38,-6862.91"/>
</g>
<!-- layer_2_attn_out_gpu3 -->
<g id="node132" class="node">
<title>layer_2_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3407,-6852.32 3249,-6852.32 3249,-6799.32 3407,-6799.32 3407,-6852.32"/>
<text text-anchor="middle" x="3328" y="-6837.12" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU3</text>
<text text-anchor="middle" x="3328" y="-6822.12" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3328" y="-6807.12" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_2_attn_comp_gpu3&#45;&gt;layer_2_attn_out_gpu3 -->
<g id="edge159" class="edge">
<title>layer_2_attn_comp_gpu3&#45;&gt;layer_2_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M3320.95,-6888.19C3321.86,-6880.21 3322.89,-6871.25 3323.88,-6862.71"/>
<polygon fill="black" stroke="black" points="3327.38,-6862.91 3325.04,-6852.57 3320.42,-6862.11 3327.38,-6862.91"/>
</g>
<!-- layer_2_attn_out_gpu4 -->
<g id="node133" class="node">
<title>layer_2_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3603,-6852.32 3445,-6852.32 3445,-6799.32 3603,-6799.32 3603,-6852.32"/>
<text text-anchor="middle" x="3524" y="-6837.12" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU4</text>
<text text-anchor="middle" x="3524" y="-6822.12" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3524" y="-6807.12" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_2_attn_comp_gpu4&#45;&gt;layer_2_attn_out_gpu4 -->
<g id="edge160" class="edge">
<title>layer_2_attn_comp_gpu4&#45;&gt;layer_2_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M3531.05,-6888.19C3530.14,-6880.21 3529.11,-6871.25 3528.12,-6862.71"/>
<polygon fill="black" stroke="black" points="3531.58,-6862.11 3526.96,-6852.57 3524.62,-6862.91 3531.58,-6862.11"/>
</g>
<!-- layer_2_attn_out_gpu5 -->
<g id="node134" class="node">
<title>layer_2_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3799,-6852.32 3641,-6852.32 3641,-6799.32 3799,-6799.32 3799,-6852.32"/>
<text text-anchor="middle" x="3720" y="-6837.12" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU5</text>
<text text-anchor="middle" x="3720" y="-6822.12" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3720" y="-6807.12" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_2_attn_comp_gpu5&#45;&gt;layer_2_attn_out_gpu5 -->
<g id="edge161" class="edge">
<title>layer_2_attn_comp_gpu5&#45;&gt;layer_2_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M3741.16,-6888.19C3738.35,-6880.03 3735.19,-6870.86 3732.18,-6862.14"/>
<polygon fill="black" stroke="black" points="3735.45,-6860.88 3728.88,-6852.57 3728.83,-6863.17 3735.45,-6860.88"/>
</g>
<!-- layer_2_attn_out_gpu6 -->
<g id="node135" class="node">
<title>layer_2_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4005,-6852.32 3847,-6852.32 3847,-6799.32 4005,-6799.32 4005,-6852.32"/>
<text text-anchor="middle" x="3926" y="-6837.12" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU6</text>
<text text-anchor="middle" x="3926" y="-6822.12" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3926" y="-6807.12" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_2_attn_comp_gpu6&#45;&gt;layer_2_attn_out_gpu6 -->
<g id="edge162" class="edge">
<title>layer_2_attn_comp_gpu6&#45;&gt;layer_2_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M3954.22,-6888.19C3950.42,-6879.94 3946.16,-6870.66 3942.11,-6861.86"/>
<polygon fill="black" stroke="black" points="3945.2,-6860.2 3937.84,-6852.57 3938.84,-6863.12 3945.2,-6860.2"/>
</g>
<!-- layer_2_attn_out_gpu7 -->
<g id="node136" class="node">
<title>layer_2_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="4216,-6852.32 4058,-6852.32 4058,-6799.32 4216,-6799.32 4216,-6852.32"/>
<text text-anchor="middle" x="4137" y="-6837.12" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU7</text>
<text text-anchor="middle" x="4137" y="-6822.12" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4137" y="-6807.12" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_2_attn_comp_gpu7&#45;&gt;layer_2_attn_out_gpu7 -->
<g id="edge163" class="edge">
<title>layer_2_attn_comp_gpu7&#45;&gt;layer_2_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M4168.74,-6888.19C4164.43,-6879.86 4159.57,-6870.47 4154.98,-6861.58"/>
<polygon fill="black" stroke="black" points="4158.02,-6859.85 4150.32,-6852.57 4151.8,-6863.06 4158.02,-6859.85"/>
</g>
<!-- layer_2_attn_allreduce -->
<g id="node137" class="node">
<title>layer_2_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="3426" cy="-6736.45" rx="112.36" ry="26.74"/>
<text text-anchor="middle" x="3426" y="-6740.25" font-family="Times,serif" font-size="14.00">Attention AllReduce</text>
<text text-anchor="middle" x="3426" y="-6725.25" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_2_attn_out_gpu0&#45;&gt;layer_2_attn_allreduce -->
<g id="edge164" class="edge">
<title>layer_2_attn_out_gpu0&#45;&gt;layer_2_attn_allreduce</title>
<path fill="none" stroke="black" d="M2781.19,-6806.89C2795.07,-6804.1 2809.42,-6801.44 2823,-6799.32 2991.13,-6773.05 3187.45,-6755.29 3309.27,-6745.76"/>
<polygon fill="black" stroke="black" points="3309.66,-6749.24 3319.36,-6744.98 3309.12,-6742.26 3309.66,-6749.24"/>
</g>
<!-- layer_2_attn_out_gpu1&#45;&gt;layer_2_attn_allreduce -->
<g id="edge165" class="edge">
<title>layer_2_attn_out_gpu1&#45;&gt;layer_2_attn_allreduce</title>
<path fill="none" stroke="black" d="M2990.19,-6806.22C3001.51,-6803.78 3013.03,-6801.4 3024,-6799.32 3123.63,-6780.44 3237.99,-6763.27 3319.19,-6751.84"/>
<polygon fill="black" stroke="black" points="3320.01,-6755.26 3329.43,-6750.4 3319.04,-6748.32 3320.01,-6755.26"/>
</g>
<!-- layer_2_attn_out_gpu2&#45;&gt;layer_2_attn_allreduce -->
<g id="edge166" class="edge">
<title>layer_2_attn_out_gpu2&#45;&gt;layer_2_attn_allreduce</title>
<path fill="none" stroke="black" d="M3191.24,-6802.77C3238.13,-6789.73 3297.42,-6773.23 3344.68,-6760.08"/>
<polygon fill="black" stroke="black" points="3345.87,-6763.38 3354.57,-6757.33 3344,-6756.64 3345.87,-6763.38"/>
</g>
<!-- layer_2_attn_out_gpu3&#45;&gt;layer_2_attn_allreduce -->
<g id="edge167" class="edge">
<title>layer_2_attn_out_gpu3&#45;&gt;layer_2_attn_allreduce</title>
<path fill="none" stroke="black" d="M3356.61,-6799.32C3367.17,-6789.9 3379.26,-6779.12 3390.37,-6769.22"/>
<polygon fill="black" stroke="black" points="3392.73,-6771.8 3397.86,-6762.54 3388.07,-6766.58 3392.73,-6771.8"/>
</g>
<!-- layer_2_attn_out_gpu4&#45;&gt;layer_2_attn_allreduce -->
<g id="edge168" class="edge">
<title>layer_2_attn_out_gpu4&#45;&gt;layer_2_attn_allreduce</title>
<path fill="none" stroke="black" d="M3495.39,-6799.32C3484.83,-6789.9 3472.74,-6779.12 3461.63,-6769.22"/>
<polygon fill="black" stroke="black" points="3463.93,-6766.58 3454.14,-6762.54 3459.27,-6771.8 3463.93,-6766.58"/>
</g>
<!-- layer_2_attn_out_gpu5&#45;&gt;layer_2_attn_allreduce -->
<g id="edge169" class="edge">
<title>layer_2_attn_out_gpu5&#45;&gt;layer_2_attn_allreduce</title>
<path fill="none" stroke="black" d="M3640.83,-6801.29C3598.54,-6788.73 3546.66,-6773.31 3504.48,-6760.78"/>
<polygon fill="black" stroke="black" points="3505.39,-6757.39 3494.81,-6757.9 3503.4,-6764.1 3505.39,-6757.39"/>
</g>
<!-- layer_2_attn_out_gpu6&#45;&gt;layer_2_attn_allreduce -->
<g id="edge170" class="edge">
<title>layer_2_attn_out_gpu6&#45;&gt;layer_2_attn_allreduce</title>
<path fill="none" stroke="black" d="M3846.77,-6807.11C3833.84,-6804.39 3820.56,-6801.7 3808,-6799.32 3714.34,-6781.63 3607.16,-6764.54 3530.22,-6752.83"/>
<polygon fill="black" stroke="black" points="3530.45,-6749.32 3520.04,-6751.28 3529.4,-6756.24 3530.45,-6749.32"/>
</g>
<!-- layer_2_attn_out_gpu7&#45;&gt;layer_2_attn_allreduce -->
<g id="edge171" class="edge">
<title>layer_2_attn_out_gpu7&#45;&gt;layer_2_attn_allreduce</title>
<path fill="none" stroke="black" d="M4057.81,-6807.2C4043.29,-6804.31 4028.22,-6801.54 4014,-6799.32 3851.15,-6773.94 3661.26,-6756.06 3542.32,-6746.25"/>
<polygon fill="black" stroke="black" points="3542.35,-6742.74 3532.1,-6745.42 3541.78,-6749.72 3542.35,-6742.74"/>
</g>
<!-- layer_2_residual1 -->
<g id="node138" class="node">
<title>layer_2_residual1</title>
<polygon fill="lightyellow" stroke="black" points="3554.61,-6673.58 3350.02,-6673.58 3297.39,-6597.58 3501.98,-6597.58 3554.61,-6673.58"/>
<text text-anchor="middle" x="3426" y="-6639.38" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="3426" y="-6624.38" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_2_attn_allreduce&#45;&gt;layer_2_residual1 -->
<g id="edge172" class="edge">
<title>layer_2_attn_allreduce&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M3426,-6709.48C3426,-6701.66 3426,-6692.83 3426,-6684.08"/>
<polygon fill="black" stroke="black" points="3429.5,-6683.91 3426,-6673.91 3422.5,-6683.91 3429.5,-6683.91"/>
</g>
<!-- layer_2_ln1 -->
<g id="node139" class="node">
<title>layer_2_ln1</title>
<polygon fill="lightblue" stroke="black" points="3481.5,-6561.58 3370.5,-6561.58 3370.5,-6523.58 3481.5,-6523.58 3481.5,-6561.58"/>
<text text-anchor="middle" x="3426" y="-6546.38" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="3426" y="-6531.38" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_2_residual1&#45;&gt;layer_2_ln1 -->
<g id="edge173" class="edge">
<title>layer_2_residual1&#45;&gt;layer_2_ln1</title>
<path fill="none" stroke="black" d="M3426,-6597.57C3426,-6588.95 3426,-6579.9 3426,-6571.74"/>
<polygon fill="black" stroke="black" points="3429.5,-6571.61 3426,-6561.62 3422.5,-6571.62 3429.5,-6571.61"/>
</g>
<!-- layer_2_mlp1_gpu0 -->
<g id="node140" class="node">
<title>layer_2_mlp1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3993,-6484.58 3867,-6484.58 3867,-6431.58 3993,-6431.58 3993,-6484.58"/>
<text text-anchor="middle" x="3930" y="-6469.38" font-family="Times,serif" font-size="14.00">MLP1 GPU0</text>
<text text-anchor="middle" x="3930" y="-6454.38" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3930" y="-6439.38" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp1_gpu0 -->
<g id="edge174" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp1_gpu0</title>
<path fill="none" stroke="black" d="M3481.64,-6542.32C3582.37,-6542.99 3790.74,-6541.11 3858,-6515.58 3872.24,-6510.18 3885.92,-6500.9 3897.45,-6491.4"/>
<polygon fill="black" stroke="black" points="3899.78,-6494.01 3905.07,-6484.84 3895.21,-6488.71 3899.78,-6494.01"/>
</g>
<!-- layer_2_mlp1_gpu1 -->
<g id="node141" class="node">
<title>layer_2_mlp1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="3849,-6484.58 3723,-6484.58 3723,-6431.58 3849,-6431.58 3849,-6484.58"/>
<text text-anchor="middle" x="3786" y="-6469.38" font-family="Times,serif" font-size="14.00">MLP1 GPU1</text>
<text text-anchor="middle" x="3786" y="-6454.38" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3786" y="-6439.38" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp1_gpu1 -->
<g id="edge178" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp1_gpu1</title>
<path fill="none" stroke="black" d="M3481.68,-6540.3C3553.24,-6538 3673.11,-6531.8 3714,-6515.58 3728.16,-6509.96 3741.81,-6500.63 3753.35,-6491.15"/>
<polygon fill="black" stroke="black" points="3755.67,-6493.77 3760.98,-6484.61 3751.11,-6488.46 3755.67,-6493.77"/>
</g>
<!-- layer_2_mlp1_gpu2 -->
<g id="node142" class="node">
<title>layer_2_mlp1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="3705,-6484.58 3579,-6484.58 3579,-6431.58 3705,-6431.58 3705,-6484.58"/>
<text text-anchor="middle" x="3642" y="-6469.38" font-family="Times,serif" font-size="14.00">MLP1 GPU2</text>
<text text-anchor="middle" x="3642" y="-6454.38" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3642" y="-6439.38" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp1_gpu2 -->
<g id="edge182" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp1_gpu2</title>
<path fill="none" stroke="black" d="M3481.54,-6537.89C3509.09,-6534.51 3542.31,-6528.02 3570,-6515.58 3583.41,-6509.56 3596.54,-6500.51 3607.83,-6491.41"/>
<polygon fill="black" stroke="black" points="3610.29,-6493.91 3615.71,-6484.81 3605.79,-6488.55 3610.29,-6493.91"/>
</g>
<!-- layer_2_mlp1_gpu3 -->
<g id="node143" class="node">
<title>layer_2_mlp1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3561,-6484.58 3435,-6484.58 3435,-6431.58 3561,-6431.58 3561,-6484.58"/>
<text text-anchor="middle" x="3498" y="-6469.38" font-family="Times,serif" font-size="14.00">MLP1 GPU3</text>
<text text-anchor="middle" x="3498" y="-6454.38" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3498" y="-6439.38" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp1_gpu3 -->
<g id="edge186" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp1_gpu3</title>
<path fill="none" stroke="black" d="M3441.98,-6523.27C3449.84,-6514.27 3459.56,-6503.13 3468.69,-6492.67"/>
<polygon fill="black" stroke="black" points="3471.57,-6494.69 3475.51,-6484.85 3466.3,-6490.08 3471.57,-6494.69"/>
</g>
<!-- layer_2_mlp1_gpu4 -->
<g id="node144" class="node">
<title>layer_2_mlp1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3417,-6484.58 3291,-6484.58 3291,-6431.58 3417,-6431.58 3417,-6484.58"/>
<text text-anchor="middle" x="3354" y="-6469.38" font-family="Times,serif" font-size="14.00">MLP1 GPU4</text>
<text text-anchor="middle" x="3354" y="-6454.38" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3354" y="-6439.38" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp1_gpu4 -->
<g id="edge190" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp1_gpu4</title>
<path fill="none" stroke="black" d="M3410.02,-6523.27C3402.16,-6514.27 3392.44,-6503.13 3383.31,-6492.67"/>
<polygon fill="black" stroke="black" points="3385.7,-6490.08 3376.49,-6484.85 3380.43,-6494.69 3385.7,-6490.08"/>
</g>
<!-- layer_2_mlp1_gpu5 -->
<g id="node145" class="node">
<title>layer_2_mlp1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3273,-6484.58 3147,-6484.58 3147,-6431.58 3273,-6431.58 3273,-6484.58"/>
<text text-anchor="middle" x="3210" y="-6469.38" font-family="Times,serif" font-size="14.00">MLP1 GPU5</text>
<text text-anchor="middle" x="3210" y="-6454.38" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3210" y="-6439.38" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp1_gpu5 -->
<g id="edge194" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp1_gpu5</title>
<path fill="none" stroke="black" d="M3370.46,-6537.89C3342.91,-6534.51 3309.69,-6528.02 3282,-6515.58 3268.59,-6509.56 3255.46,-6500.51 3244.17,-6491.41"/>
<polygon fill="black" stroke="black" points="3246.21,-6488.55 3236.29,-6484.81 3241.71,-6493.91 3246.21,-6488.55"/>
</g>
<!-- layer_2_mlp1_gpu6 -->
<g id="node146" class="node">
<title>layer_2_mlp1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="3129,-6484.58 3003,-6484.58 3003,-6431.58 3129,-6431.58 3129,-6484.58"/>
<text text-anchor="middle" x="3066" y="-6469.38" font-family="Times,serif" font-size="14.00">MLP1 GPU6</text>
<text text-anchor="middle" x="3066" y="-6454.38" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3066" y="-6439.38" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp1_gpu6 -->
<g id="edge198" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp1_gpu6</title>
<path fill="none" stroke="black" d="M3370.32,-6540.3C3298.76,-6538 3178.89,-6531.8 3138,-6515.58 3123.84,-6509.96 3110.19,-6500.63 3098.65,-6491.15"/>
<polygon fill="black" stroke="black" points="3100.89,-6488.46 3091.02,-6484.61 3096.33,-6493.77 3100.89,-6488.46"/>
</g>
<!-- layer_2_mlp1_gpu7 -->
<g id="node147" class="node">
<title>layer_2_mlp1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2985,-6484.58 2859,-6484.58 2859,-6431.58 2985,-6431.58 2985,-6484.58"/>
<text text-anchor="middle" x="2922" y="-6469.38" font-family="Times,serif" font-size="14.00">MLP1 GPU7</text>
<text text-anchor="middle" x="2922" y="-6454.38" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2922" y="-6439.38" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp1_gpu7 -->
<g id="edge202" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp1_gpu7</title>
<path fill="none" stroke="black" d="M3370.36,-6542.32C3269.63,-6542.99 3061.26,-6541.11 2994,-6515.58 2979.76,-6510.18 2966.08,-6500.9 2954.55,-6491.4"/>
<polygon fill="black" stroke="black" points="2956.79,-6488.71 2946.93,-6484.84 2952.22,-6494.01 2956.79,-6488.71"/>
</g>
<!-- layer_2_gelu_gpu0 -->
<g id="node148" class="node">
<title>layer_2_gelu_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3982,-6395.58 3878,-6395.58 3878,-6357.58 3982,-6357.58 3982,-6395.58"/>
<text text-anchor="middle" x="3930" y="-6380.38" font-family="Times,serif" font-size="14.00">GELU GPU0</text>
<text text-anchor="middle" x="3930" y="-6365.38" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_2_mlp1_gpu0&#45;&gt;layer_2_gelu_gpu0 -->
<g id="edge175" class="edge">
<title>layer_2_mlp1_gpu0&#45;&gt;layer_2_gelu_gpu0</title>
<path fill="none" stroke="black" d="M3930,-6431.49C3930,-6423.32 3930,-6414.23 3930,-6405.88"/>
<polygon fill="black" stroke="black" points="3933.5,-6405.82 3930,-6395.82 3926.5,-6405.82 3933.5,-6405.82"/>
</g>
<!-- layer_2_gelu_gpu1 -->
<g id="node149" class="node">
<title>layer_2_gelu_gpu1</title>
<polygon fill="lightblue" stroke="black" points="3838,-6395.58 3734,-6395.58 3734,-6357.58 3838,-6357.58 3838,-6395.58"/>
<text text-anchor="middle" x="3786" y="-6380.38" font-family="Times,serif" font-size="14.00">GELU GPU1</text>
<text text-anchor="middle" x="3786" y="-6365.38" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_2_mlp1_gpu1&#45;&gt;layer_2_gelu_gpu1 -->
<g id="edge179" class="edge">
<title>layer_2_mlp1_gpu1&#45;&gt;layer_2_gelu_gpu1</title>
<path fill="none" stroke="black" d="M3786,-6431.49C3786,-6423.32 3786,-6414.23 3786,-6405.88"/>
<polygon fill="black" stroke="black" points="3789.5,-6405.82 3786,-6395.82 3782.5,-6405.82 3789.5,-6405.82"/>
</g>
<!-- layer_2_gelu_gpu2 -->
<g id="node150" class="node">
<title>layer_2_gelu_gpu2</title>
<polygon fill="lightblue" stroke="black" points="3694,-6395.58 3590,-6395.58 3590,-6357.58 3694,-6357.58 3694,-6395.58"/>
<text text-anchor="middle" x="3642" y="-6380.38" font-family="Times,serif" font-size="14.00">GELU GPU2</text>
<text text-anchor="middle" x="3642" y="-6365.38" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_2_mlp1_gpu2&#45;&gt;layer_2_gelu_gpu2 -->
<g id="edge183" class="edge">
<title>layer_2_mlp1_gpu2&#45;&gt;layer_2_gelu_gpu2</title>
<path fill="none" stroke="black" d="M3642,-6431.49C3642,-6423.32 3642,-6414.23 3642,-6405.88"/>
<polygon fill="black" stroke="black" points="3645.5,-6405.82 3642,-6395.82 3638.5,-6405.82 3645.5,-6405.82"/>
</g>
<!-- layer_2_gelu_gpu3 -->
<g id="node151" class="node">
<title>layer_2_gelu_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3550,-6395.58 3446,-6395.58 3446,-6357.58 3550,-6357.58 3550,-6395.58"/>
<text text-anchor="middle" x="3498" y="-6380.38" font-family="Times,serif" font-size="14.00">GELU GPU3</text>
<text text-anchor="middle" x="3498" y="-6365.38" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_2_mlp1_gpu3&#45;&gt;layer_2_gelu_gpu3 -->
<g id="edge187" class="edge">
<title>layer_2_mlp1_gpu3&#45;&gt;layer_2_gelu_gpu3</title>
<path fill="none" stroke="black" d="M3498,-6431.49C3498,-6423.32 3498,-6414.23 3498,-6405.88"/>
<polygon fill="black" stroke="black" points="3501.5,-6405.82 3498,-6395.82 3494.5,-6405.82 3501.5,-6405.82"/>
</g>
<!-- layer_2_gelu_gpu4 -->
<g id="node152" class="node">
<title>layer_2_gelu_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3406,-6395.58 3302,-6395.58 3302,-6357.58 3406,-6357.58 3406,-6395.58"/>
<text text-anchor="middle" x="3354" y="-6380.38" font-family="Times,serif" font-size="14.00">GELU GPU4</text>
<text text-anchor="middle" x="3354" y="-6365.38" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_2_mlp1_gpu4&#45;&gt;layer_2_gelu_gpu4 -->
<g id="edge191" class="edge">
<title>layer_2_mlp1_gpu4&#45;&gt;layer_2_gelu_gpu4</title>
<path fill="none" stroke="black" d="M3354,-6431.49C3354,-6423.32 3354,-6414.23 3354,-6405.88"/>
<polygon fill="black" stroke="black" points="3357.5,-6405.82 3354,-6395.82 3350.5,-6405.82 3357.5,-6405.82"/>
</g>
<!-- layer_2_gelu_gpu5 -->
<g id="node153" class="node">
<title>layer_2_gelu_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3262,-6395.58 3158,-6395.58 3158,-6357.58 3262,-6357.58 3262,-6395.58"/>
<text text-anchor="middle" x="3210" y="-6380.38" font-family="Times,serif" font-size="14.00">GELU GPU5</text>
<text text-anchor="middle" x="3210" y="-6365.38" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_2_mlp1_gpu5&#45;&gt;layer_2_gelu_gpu5 -->
<g id="edge195" class="edge">
<title>layer_2_mlp1_gpu5&#45;&gt;layer_2_gelu_gpu5</title>
<path fill="none" stroke="black" d="M3210,-6431.49C3210,-6423.32 3210,-6414.23 3210,-6405.88"/>
<polygon fill="black" stroke="black" points="3213.5,-6405.82 3210,-6395.82 3206.5,-6405.82 3213.5,-6405.82"/>
</g>
<!-- layer_2_gelu_gpu6 -->
<g id="node154" class="node">
<title>layer_2_gelu_gpu6</title>
<polygon fill="lightblue" stroke="black" points="3118,-6395.58 3014,-6395.58 3014,-6357.58 3118,-6357.58 3118,-6395.58"/>
<text text-anchor="middle" x="3066" y="-6380.38" font-family="Times,serif" font-size="14.00">GELU GPU6</text>
<text text-anchor="middle" x="3066" y="-6365.38" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_2_mlp1_gpu6&#45;&gt;layer_2_gelu_gpu6 -->
<g id="edge199" class="edge">
<title>layer_2_mlp1_gpu6&#45;&gt;layer_2_gelu_gpu6</title>
<path fill="none" stroke="black" d="M3066,-6431.49C3066,-6423.32 3066,-6414.23 3066,-6405.88"/>
<polygon fill="black" stroke="black" points="3069.5,-6405.82 3066,-6395.82 3062.5,-6405.82 3069.5,-6405.82"/>
</g>
<!-- layer_2_gelu_gpu7 -->
<g id="node155" class="node">
<title>layer_2_gelu_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2974,-6395.58 2870,-6395.58 2870,-6357.58 2974,-6357.58 2974,-6395.58"/>
<text text-anchor="middle" x="2922" y="-6380.38" font-family="Times,serif" font-size="14.00">GELU GPU7</text>
<text text-anchor="middle" x="2922" y="-6365.38" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_2_mlp1_gpu7&#45;&gt;layer_2_gelu_gpu7 -->
<g id="edge203" class="edge">
<title>layer_2_mlp1_gpu7&#45;&gt;layer_2_gelu_gpu7</title>
<path fill="none" stroke="black" d="M2922,-6431.49C2922,-6423.32 2922,-6414.23 2922,-6405.88"/>
<polygon fill="black" stroke="black" points="2925.5,-6405.82 2922,-6395.82 2918.5,-6405.82 2925.5,-6405.82"/>
</g>
<!-- layer_2_mlp2_gpu0 -->
<g id="node156" class="node">
<title>layer_2_mlp2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3993,-6321.58 3867,-6321.58 3867,-6268.58 3993,-6268.58 3993,-6321.58"/>
<text text-anchor="middle" x="3930" y="-6306.38" font-family="Times,serif" font-size="14.00">MLP2 GPU0</text>
<text text-anchor="middle" x="3930" y="-6291.38" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3930" y="-6276.38" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_2_gelu_gpu0&#45;&gt;layer_2_mlp2_gpu0 -->
<g id="edge176" class="edge">
<title>layer_2_gelu_gpu0&#45;&gt;layer_2_mlp2_gpu0</title>
<path fill="none" stroke="black" d="M3930,-6357.54C3930,-6349.9 3930,-6340.72 3930,-6331.81"/>
<polygon fill="black" stroke="black" points="3933.5,-6331.58 3930,-6321.58 3926.5,-6331.58 3933.5,-6331.58"/>
</g>
<!-- layer_2_mlp2_gpu1 -->
<g id="node157" class="node">
<title>layer_2_mlp2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="3849,-6321.58 3723,-6321.58 3723,-6268.58 3849,-6268.58 3849,-6321.58"/>
<text text-anchor="middle" x="3786" y="-6306.38" font-family="Times,serif" font-size="14.00">MLP2 GPU1</text>
<text text-anchor="middle" x="3786" y="-6291.38" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3786" y="-6276.38" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_2_gelu_gpu1&#45;&gt;layer_2_mlp2_gpu1 -->
<g id="edge180" class="edge">
<title>layer_2_gelu_gpu1&#45;&gt;layer_2_mlp2_gpu1</title>
<path fill="none" stroke="black" d="M3786,-6357.54C3786,-6349.9 3786,-6340.72 3786,-6331.81"/>
<polygon fill="black" stroke="black" points="3789.5,-6331.58 3786,-6321.58 3782.5,-6331.58 3789.5,-6331.58"/>
</g>
<!-- layer_2_mlp2_gpu2 -->
<g id="node158" class="node">
<title>layer_2_mlp2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="3705,-6321.58 3579,-6321.58 3579,-6268.58 3705,-6268.58 3705,-6321.58"/>
<text text-anchor="middle" x="3642" y="-6306.38" font-family="Times,serif" font-size="14.00">MLP2 GPU2</text>
<text text-anchor="middle" x="3642" y="-6291.38" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3642" y="-6276.38" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_2_gelu_gpu2&#45;&gt;layer_2_mlp2_gpu2 -->
<g id="edge184" class="edge">
<title>layer_2_gelu_gpu2&#45;&gt;layer_2_mlp2_gpu2</title>
<path fill="none" stroke="black" d="M3642,-6357.54C3642,-6349.9 3642,-6340.72 3642,-6331.81"/>
<polygon fill="black" stroke="black" points="3645.5,-6331.58 3642,-6321.58 3638.5,-6331.58 3645.5,-6331.58"/>
</g>
<!-- layer_2_mlp2_gpu3 -->
<g id="node159" class="node">
<title>layer_2_mlp2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3561,-6321.58 3435,-6321.58 3435,-6268.58 3561,-6268.58 3561,-6321.58"/>
<text text-anchor="middle" x="3498" y="-6306.38" font-family="Times,serif" font-size="14.00">MLP2 GPU3</text>
<text text-anchor="middle" x="3498" y="-6291.38" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3498" y="-6276.38" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_2_gelu_gpu3&#45;&gt;layer_2_mlp2_gpu3 -->
<g id="edge188" class="edge">
<title>layer_2_gelu_gpu3&#45;&gt;layer_2_mlp2_gpu3</title>
<path fill="none" stroke="black" d="M3498,-6357.54C3498,-6349.9 3498,-6340.72 3498,-6331.81"/>
<polygon fill="black" stroke="black" points="3501.5,-6331.58 3498,-6321.58 3494.5,-6331.58 3501.5,-6331.58"/>
</g>
<!-- layer_2_mlp2_gpu4 -->
<g id="node160" class="node">
<title>layer_2_mlp2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3417,-6321.58 3291,-6321.58 3291,-6268.58 3417,-6268.58 3417,-6321.58"/>
<text text-anchor="middle" x="3354" y="-6306.38" font-family="Times,serif" font-size="14.00">MLP2 GPU4</text>
<text text-anchor="middle" x="3354" y="-6291.38" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3354" y="-6276.38" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_2_gelu_gpu4&#45;&gt;layer_2_mlp2_gpu4 -->
<g id="edge192" class="edge">
<title>layer_2_gelu_gpu4&#45;&gt;layer_2_mlp2_gpu4</title>
<path fill="none" stroke="black" d="M3354,-6357.54C3354,-6349.9 3354,-6340.72 3354,-6331.81"/>
<polygon fill="black" stroke="black" points="3357.5,-6331.58 3354,-6321.58 3350.5,-6331.58 3357.5,-6331.58"/>
</g>
<!-- layer_2_mlp2_gpu5 -->
<g id="node161" class="node">
<title>layer_2_mlp2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3273,-6321.58 3147,-6321.58 3147,-6268.58 3273,-6268.58 3273,-6321.58"/>
<text text-anchor="middle" x="3210" y="-6306.38" font-family="Times,serif" font-size="14.00">MLP2 GPU5</text>
<text text-anchor="middle" x="3210" y="-6291.38" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3210" y="-6276.38" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_2_gelu_gpu5&#45;&gt;layer_2_mlp2_gpu5 -->
<g id="edge196" class="edge">
<title>layer_2_gelu_gpu5&#45;&gt;layer_2_mlp2_gpu5</title>
<path fill="none" stroke="black" d="M3210,-6357.54C3210,-6349.9 3210,-6340.72 3210,-6331.81"/>
<polygon fill="black" stroke="black" points="3213.5,-6331.58 3210,-6321.58 3206.5,-6331.58 3213.5,-6331.58"/>
</g>
<!-- layer_2_mlp2_gpu6 -->
<g id="node162" class="node">
<title>layer_2_mlp2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="3129,-6321.58 3003,-6321.58 3003,-6268.58 3129,-6268.58 3129,-6321.58"/>
<text text-anchor="middle" x="3066" y="-6306.38" font-family="Times,serif" font-size="14.00">MLP2 GPU6</text>
<text text-anchor="middle" x="3066" y="-6291.38" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3066" y="-6276.38" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_2_gelu_gpu6&#45;&gt;layer_2_mlp2_gpu6 -->
<g id="edge200" class="edge">
<title>layer_2_gelu_gpu6&#45;&gt;layer_2_mlp2_gpu6</title>
<path fill="none" stroke="black" d="M3066,-6357.54C3066,-6349.9 3066,-6340.72 3066,-6331.81"/>
<polygon fill="black" stroke="black" points="3069.5,-6331.58 3066,-6321.58 3062.5,-6331.58 3069.5,-6331.58"/>
</g>
<!-- layer_2_mlp2_gpu7 -->
<g id="node163" class="node">
<title>layer_2_mlp2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2985,-6321.58 2859,-6321.58 2859,-6268.58 2985,-6268.58 2985,-6321.58"/>
<text text-anchor="middle" x="2922" y="-6306.38" font-family="Times,serif" font-size="14.00">MLP2 GPU7</text>
<text text-anchor="middle" x="2922" y="-6291.38" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2922" y="-6276.38" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_2_gelu_gpu7&#45;&gt;layer_2_mlp2_gpu7 -->
<g id="edge204" class="edge">
<title>layer_2_gelu_gpu7&#45;&gt;layer_2_mlp2_gpu7</title>
<path fill="none" stroke="black" d="M2922,-6357.54C2922,-6349.9 2922,-6340.72 2922,-6331.81"/>
<polygon fill="black" stroke="black" points="2925.5,-6331.58 2922,-6321.58 2918.5,-6331.58 2925.5,-6331.58"/>
</g>
<!-- layer_2_mlp_allreduce -->
<g id="node164" class="node">
<title>layer_2_mlp_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="3426" cy="-6205.71" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="3426" y="-6209.51" font-family="Times,serif" font-size="14.00">MLP AllReduce</text>
<text text-anchor="middle" x="3426" y="-6194.51" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_2_mlp2_gpu0&#45;&gt;layer_2_mlp_allreduce -->
<g id="edge177" class="edge">
<title>layer_2_mlp2_gpu0&#45;&gt;layer_2_mlp_allreduce</title>
<path fill="none" stroke="black" d="M3867,-6270.97C3863.97,-6270.11 3860.96,-6269.31 3858,-6268.58 3743.59,-6240.43 3608.77,-6223.65 3520.56,-6214.81"/>
<polygon fill="black" stroke="black" points="3520.86,-6211.33 3510.57,-6213.83 3520.18,-6218.29 3520.86,-6211.33"/>
</g>
<!-- layer_2_mlp2_gpu1&#45;&gt;layer_2_mlp_allreduce -->
<g id="edge181" class="edge">
<title>layer_2_mlp2_gpu1&#45;&gt;layer_2_mlp_allreduce</title>
<path fill="none" stroke="black" d="M3722.93,-6271.23C3719.92,-6270.3 3716.93,-6269.41 3714,-6268.58 3646.58,-6249.49 3568.82,-6233.11 3511.11,-6222.01"/>
<polygon fill="black" stroke="black" points="3511.42,-6218.5 3500.94,-6220.07 3510.1,-6225.38 3511.42,-6218.5"/>
</g>
<!-- layer_2_mlp2_gpu2&#45;&gt;layer_2_mlp_allreduce -->
<g id="edge185" class="edge">
<title>layer_2_mlp2_gpu2&#45;&gt;layer_2_mlp_allreduce</title>
<path fill="none" stroke="black" d="M3578.94,-6268.58C3550.08,-6256.9 3516,-6243.12 3487.35,-6231.53"/>
<polygon fill="black" stroke="black" points="3488.44,-6228.19 3477.86,-6227.69 3485.81,-6234.68 3488.44,-6228.19"/>
</g>
<!-- layer_2_mlp2_gpu3&#45;&gt;layer_2_mlp_allreduce -->
<g id="edge189" class="edge">
<title>layer_2_mlp2_gpu3&#45;&gt;layer_2_mlp_allreduce</title>
<path fill="none" stroke="black" d="M3476.79,-6268.34C3469.4,-6259.37 3461,-6249.19 3453.2,-6239.72"/>
<polygon fill="black" stroke="black" points="3455.87,-6237.46 3446.81,-6231.97 3450.47,-6241.91 3455.87,-6237.46"/>
</g>
<!-- layer_2_mlp2_gpu4&#45;&gt;layer_2_mlp_allreduce -->
<g id="edge193" class="edge">
<title>layer_2_mlp2_gpu4&#45;&gt;layer_2_mlp_allreduce</title>
<path fill="none" stroke="black" d="M3375.21,-6268.34C3382.6,-6259.37 3391,-6249.19 3398.8,-6239.72"/>
<polygon fill="black" stroke="black" points="3401.53,-6241.91 3405.19,-6231.97 3396.13,-6237.46 3401.53,-6241.91"/>
</g>
<!-- layer_2_mlp2_gpu5&#45;&gt;layer_2_mlp_allreduce -->
<g id="edge197" class="edge">
<title>layer_2_mlp2_gpu5&#45;&gt;layer_2_mlp_allreduce</title>
<path fill="none" stroke="black" d="M3273.06,-6268.58C3301.92,-6256.9 3336,-6243.12 3364.65,-6231.53"/>
<polygon fill="black" stroke="black" points="3366.19,-6234.68 3374.14,-6227.69 3363.56,-6228.19 3366.19,-6234.68"/>
</g>
<!-- layer_2_mlp2_gpu6&#45;&gt;layer_2_mlp_allreduce -->
<g id="edge201" class="edge">
<title>layer_2_mlp2_gpu6&#45;&gt;layer_2_mlp_allreduce</title>
<path fill="none" stroke="black" d="M3129.07,-6271.23C3132.08,-6270.3 3135.07,-6269.41 3138,-6268.58 3205.42,-6249.49 3283.18,-6233.11 3340.89,-6222.01"/>
<polygon fill="black" stroke="black" points="3341.9,-6225.38 3351.06,-6220.07 3340.58,-6218.5 3341.9,-6225.38"/>
</g>
<!-- layer_2_mlp2_gpu7&#45;&gt;layer_2_mlp_allreduce -->
<g id="edge205" class="edge">
<title>layer_2_mlp2_gpu7&#45;&gt;layer_2_mlp_allreduce</title>
<path fill="none" stroke="black" d="M2985,-6270.97C2988.03,-6270.11 2991.04,-6269.31 2994,-6268.58 3108.41,-6240.43 3243.23,-6223.65 3331.44,-6214.81"/>
<polygon fill="black" stroke="black" points="3331.82,-6218.29 3341.43,-6213.83 3331.14,-6211.33 3331.82,-6218.29"/>
</g>
<!-- layer_2_residual2 -->
<g id="node165" class="node">
<title>layer_2_residual2</title>
<polygon fill="lightyellow" stroke="black" points="3554.61,-6142.84 3350.02,-6142.84 3297.39,-6066.84 3501.98,-6066.84 3554.61,-6142.84"/>
<text text-anchor="middle" x="3426" y="-6108.64" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="3426" y="-6093.64" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_2_mlp_allreduce&#45;&gt;layer_2_residual2 -->
<g id="edge206" class="edge">
<title>layer_2_mlp_allreduce&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M3426,-6178.73C3426,-6170.92 3426,-6162.09 3426,-6153.34"/>
<polygon fill="black" stroke="black" points="3429.5,-6153.17 3426,-6143.17 3422.5,-6153.17 3429.5,-6153.17"/>
</g>
<!-- layer_2_ln2 -->
<g id="node166" class="node">
<title>layer_2_ln2</title>
<polygon fill="lightblue" stroke="black" points="3481.5,-6030.84 3370.5,-6030.84 3370.5,-5992.84 3481.5,-5992.84 3481.5,-6030.84"/>
<text text-anchor="middle" x="3426" y="-6015.64" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="3426" y="-6000.64" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_2_residual2&#45;&gt;layer_2_ln2 -->
<g id="edge207" class="edge">
<title>layer_2_residual2&#45;&gt;layer_2_ln2</title>
<path fill="none" stroke="black" d="M3426,-6066.83C3426,-6058.21 3426,-6049.16 3426,-6041"/>
<polygon fill="black" stroke="black" points="3429.5,-6040.87 3426,-6030.87 3422.5,-6040.87 3429.5,-6040.87"/>
</g>
<!-- layer_3_qkv_gpu0 -->
<g id="node167" class="node">
<title>layer_3_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3490,-5953.84 3362,-5953.84 3362,-5900.84 3490,-5900.84 3490,-5953.84"/>
<text text-anchor="middle" x="3426" y="-5938.64" font-family="Times,serif" font-size="14.00">QKV Proj GPU0</text>
<text text-anchor="middle" x="3426" y="-5923.64" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3426" y="-5908.64" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_2_ln2&#45;&gt;layer_3_qkv_gpu0 -->
<g id="edge208" class="edge">
<title>layer_2_ln2&#45;&gt;layer_3_qkv_gpu0</title>
<path fill="none" stroke="black" d="M3426,-5992.53C3426,-5984.24 3426,-5974.12 3426,-5964.4"/>
<polygon fill="black" stroke="black" points="3429.5,-5964.11 3426,-5954.11 3422.5,-5964.11 3429.5,-5964.11"/>
</g>
<!-- layer_3_qkv_comm -->
<g id="node175" class="node">
<title>layer_3_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="2915" cy="-5837.97" rx="85.62" ry="26.74"/>
<text text-anchor="middle" x="2915" y="-5841.77" font-family="Times,serif" font-size="14.00">QKV AllGather</text>
<text text-anchor="middle" x="2915" y="-5826.77" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_3_qkv_gpu0&#45;&gt;layer_3_qkv_comm -->
<g id="edge209" class="edge">
<title>layer_3_qkv_gpu0&#45;&gt;layer_3_qkv_comm</title>
<path fill="none" stroke="black" d="M3361.72,-5903.12C3358.79,-5902.3 3355.87,-5901.54 3353,-5900.84 3235.33,-5872.27 3096.46,-5855.42 3007.13,-5846.7"/>
<polygon fill="black" stroke="black" points="3007.32,-5843.2 2997.03,-5845.72 3006.65,-5850.17 3007.32,-5843.2"/>
</g>
<!-- layer_3_qkv_gpu1 -->
<g id="node168" class="node">
<title>layer_3_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="3344,-5953.84 3216,-5953.84 3216,-5900.84 3344,-5900.84 3344,-5953.84"/>
<text text-anchor="middle" x="3280" y="-5938.64" font-family="Times,serif" font-size="14.00">QKV Proj GPU1</text>
<text text-anchor="middle" x="3280" y="-5923.64" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3280" y="-5908.64" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_3_qkv_gpu1&#45;&gt;layer_3_qkv_comm -->
<g id="edge210" class="edge">
<title>layer_3_qkv_gpu1&#45;&gt;layer_3_qkv_comm</title>
<path fill="none" stroke="black" d="M3215.65,-5903.37C3212.74,-5902.48 3209.84,-5901.64 3207,-5900.84 3137.53,-5881.43 3057.28,-5864.84 2998.5,-5853.74"/>
<polygon fill="black" stroke="black" points="2999,-5850.27 2988.53,-5851.87 2997.71,-5857.15 2999,-5850.27"/>
</g>
<!-- layer_3_qkv_gpu2 -->
<g id="node169" class="node">
<title>layer_3_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="3198,-5953.84 3070,-5953.84 3070,-5900.84 3198,-5900.84 3198,-5953.84"/>
<text text-anchor="middle" x="3134" y="-5938.64" font-family="Times,serif" font-size="14.00">QKV Proj GPU2</text>
<text text-anchor="middle" x="3134" y="-5923.64" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3134" y="-5908.64" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_3_qkv_gpu2&#45;&gt;layer_3_qkv_comm -->
<g id="edge211" class="edge">
<title>layer_3_qkv_gpu2&#45;&gt;layer_3_qkv_comm</title>
<path fill="none" stroke="black" d="M3070.07,-5900.84C3040.33,-5888.97 3005.14,-5874.93 2975.81,-5863.23"/>
<polygon fill="black" stroke="black" points="2977.09,-5859.97 2966.5,-5859.52 2974.5,-5866.48 2977.09,-5859.97"/>
</g>
<!-- layer_3_qkv_gpu3 -->
<g id="node170" class="node">
<title>layer_3_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3052,-5953.84 2924,-5953.84 2924,-5900.84 3052,-5900.84 3052,-5953.84"/>
<text text-anchor="middle" x="2988" y="-5938.64" font-family="Times,serif" font-size="14.00">QKV Proj GPU3</text>
<text text-anchor="middle" x="2988" y="-5923.64" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2988" y="-5908.64" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_3_qkv_gpu3&#45;&gt;layer_3_qkv_comm -->
<g id="edge212" class="edge">
<title>layer_3_qkv_gpu3&#45;&gt;layer_3_qkv_comm</title>
<path fill="none" stroke="black" d="M2966.49,-5900.6C2959,-5891.63 2950.49,-5881.45 2942.58,-5871.97"/>
<polygon fill="black" stroke="black" points="2945.2,-5869.66 2936.1,-5864.23 2939.83,-5874.15 2945.2,-5869.66"/>
</g>
<!-- layer_3_qkv_gpu4 -->
<g id="node171" class="node">
<title>layer_3_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2906,-5953.84 2778,-5953.84 2778,-5900.84 2906,-5900.84 2906,-5953.84"/>
<text text-anchor="middle" x="2842" y="-5938.64" font-family="Times,serif" font-size="14.00">QKV Proj GPU4</text>
<text text-anchor="middle" x="2842" y="-5923.64" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2842" y="-5908.64" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_3_qkv_gpu4&#45;&gt;layer_3_qkv_comm -->
<g id="edge213" class="edge">
<title>layer_3_qkv_gpu4&#45;&gt;layer_3_qkv_comm</title>
<path fill="none" stroke="black" d="M2863.51,-5900.6C2871,-5891.63 2879.51,-5881.45 2887.42,-5871.97"/>
<polygon fill="black" stroke="black" points="2890.17,-5874.15 2893.9,-5864.23 2884.8,-5869.66 2890.17,-5874.15"/>
</g>
<!-- layer_3_qkv_gpu5 -->
<g id="node172" class="node">
<title>layer_3_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2760,-5953.84 2632,-5953.84 2632,-5900.84 2760,-5900.84 2760,-5953.84"/>
<text text-anchor="middle" x="2696" y="-5938.64" font-family="Times,serif" font-size="14.00">QKV Proj GPU5</text>
<text text-anchor="middle" x="2696" y="-5923.64" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2696" y="-5908.64" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_3_qkv_gpu5&#45;&gt;layer_3_qkv_comm -->
<g id="edge214" class="edge">
<title>layer_3_qkv_gpu5&#45;&gt;layer_3_qkv_comm</title>
<path fill="none" stroke="black" d="M2759.93,-5900.84C2789.67,-5888.97 2824.86,-5874.93 2854.19,-5863.23"/>
<polygon fill="black" stroke="black" points="2855.5,-5866.48 2863.5,-5859.52 2852.91,-5859.97 2855.5,-5866.48"/>
</g>
<!-- layer_3_qkv_gpu6 -->
<g id="node173" class="node">
<title>layer_3_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2614,-5953.84 2486,-5953.84 2486,-5900.84 2614,-5900.84 2614,-5953.84"/>
<text text-anchor="middle" x="2550" y="-5938.64" font-family="Times,serif" font-size="14.00">QKV Proj GPU6</text>
<text text-anchor="middle" x="2550" y="-5923.64" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2550" y="-5908.64" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_3_qkv_gpu6&#45;&gt;layer_3_qkv_comm -->
<g id="edge215" class="edge">
<title>layer_3_qkv_gpu6&#45;&gt;layer_3_qkv_comm</title>
<path fill="none" stroke="black" d="M2614.35,-5903.37C2617.26,-5902.48 2620.16,-5901.64 2623,-5900.84 2692.47,-5881.43 2772.72,-5864.84 2831.5,-5853.74"/>
<polygon fill="black" stroke="black" points="2832.29,-5857.15 2841.47,-5851.87 2831,-5850.27 2832.29,-5857.15"/>
</g>
<!-- layer_3_qkv_gpu7 -->
<g id="node174" class="node">
<title>layer_3_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2468,-5953.84 2340,-5953.84 2340,-5900.84 2468,-5900.84 2468,-5953.84"/>
<text text-anchor="middle" x="2404" y="-5938.64" font-family="Times,serif" font-size="14.00">QKV Proj GPU7</text>
<text text-anchor="middle" x="2404" y="-5923.64" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2404" y="-5908.64" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_3_qkv_gpu7&#45;&gt;layer_3_qkv_comm -->
<g id="edge216" class="edge">
<title>layer_3_qkv_gpu7&#45;&gt;layer_3_qkv_comm</title>
<path fill="none" stroke="black" d="M2468.28,-5903.12C2471.21,-5902.3 2474.13,-5901.54 2477,-5900.84 2594.67,-5872.27 2733.54,-5855.42 2822.87,-5846.7"/>
<polygon fill="black" stroke="black" points="2823.35,-5850.17 2832.97,-5845.72 2822.68,-5843.2 2823.35,-5850.17"/>
</g>
<!-- layer_3_attn_comp_gpu0 -->
<g id="node176" class="node">
<title>layer_3_attn_comp_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2258,-5775.1 2060,-5775.1 2060,-5722.1 2258,-5722.1 2258,-5775.1"/>
<text text-anchor="middle" x="2159" y="-5759.9" font-family="Times,serif" font-size="14.00">Attention Compute GPU0</text>
<text text-anchor="middle" x="2159" y="-5744.9" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="2159" y="-5729.9" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_3_qkv_comm&#45;&gt;layer_3_attn_comp_gpu0 -->
<g id="edge217" class="edge">
<title>layer_3_qkv_comm&#45;&gt;layer_3_attn_comp_gpu0</title>
<path fill="none" stroke="black" d="M2830.9,-5832.62C2708.86,-5825.49 2475.52,-5808.79 2268.22,-5775.21"/>
<polygon fill="black" stroke="black" points="2268.49,-5771.71 2258.06,-5773.55 2267.36,-5778.61 2268.49,-5771.71"/>
</g>
<!-- layer_3_attn_comp_gpu1 -->
<g id="node177" class="node">
<title>layer_3_attn_comp_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2474,-5775.1 2276,-5775.1 2276,-5722.1 2474,-5722.1 2474,-5775.1"/>
<text text-anchor="middle" x="2375" y="-5759.9" font-family="Times,serif" font-size="14.00">Attention Compute GPU1</text>
<text text-anchor="middle" x="2375" y="-5744.9" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="2375" y="-5729.9" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_3_qkv_comm&#45;&gt;layer_3_attn_comp_gpu1 -->
<g id="edge218" class="edge">
<title>layer_3_qkv_comm&#45;&gt;layer_3_attn_comp_gpu1</title>
<path fill="none" stroke="black" d="M2835.42,-5827.74C2750.69,-5817.43 2612.51,-5799.2 2484.11,-5775.25"/>
<polygon fill="black" stroke="black" points="2484.57,-5771.77 2474.09,-5773.36 2483.27,-5778.65 2484.57,-5771.77"/>
</g>
<!-- layer_3_attn_comp_gpu2 -->
<g id="node178" class="node">
<title>layer_3_attn_comp_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2690,-5775.1 2492,-5775.1 2492,-5722.1 2690,-5722.1 2690,-5775.1"/>
<text text-anchor="middle" x="2591" y="-5759.9" font-family="Times,serif" font-size="14.00">Attention Compute GPU2</text>
<text text-anchor="middle" x="2591" y="-5744.9" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="2591" y="-5729.9" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_3_qkv_comm&#45;&gt;layer_3_attn_comp_gpu2 -->
<g id="edge219" class="edge">
<title>layer_3_qkv_comm&#45;&gt;layer_3_attn_comp_gpu2</title>
<path fill="none" stroke="black" d="M2851.37,-5819.81C2807.05,-5807.86 2746.92,-5791.65 2695.61,-5777.81"/>
<polygon fill="black" stroke="black" points="2696.37,-5774.39 2685.8,-5775.17 2694.55,-5781.15 2696.37,-5774.39"/>
</g>
<!-- layer_3_attn_comp_gpu3 -->
<g id="node179" class="node">
<title>layer_3_attn_comp_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2906,-5775.1 2708,-5775.1 2708,-5722.1 2906,-5722.1 2906,-5775.1"/>
<text text-anchor="middle" x="2807" y="-5759.9" font-family="Times,serif" font-size="14.00">Attention Compute GPU3</text>
<text text-anchor="middle" x="2807" y="-5744.9" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="2807" y="-5729.9" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_3_qkv_comm&#45;&gt;layer_3_attn_comp_gpu3 -->
<g id="edge220" class="edge">
<title>layer_3_qkv_comm&#45;&gt;layer_3_attn_comp_gpu3</title>
<path fill="none" stroke="black" d="M2884.92,-5812.63C2873.14,-5803.11 2859.46,-5792.04 2846.88,-5781.87"/>
<polygon fill="black" stroke="black" points="2848.78,-5778.9 2838.81,-5775.33 2844.38,-5784.34 2848.78,-5778.9"/>
</g>
<!-- layer_3_attn_comp_gpu4 -->
<g id="node180" class="node">
<title>layer_3_attn_comp_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3122,-5775.1 2924,-5775.1 2924,-5722.1 3122,-5722.1 3122,-5775.1"/>
<text text-anchor="middle" x="3023" y="-5759.9" font-family="Times,serif" font-size="14.00">Attention Compute GPU4</text>
<text text-anchor="middle" x="3023" y="-5744.9" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="3023" y="-5729.9" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_3_qkv_comm&#45;&gt;layer_3_attn_comp_gpu4 -->
<g id="edge221" class="edge">
<title>layer_3_qkv_comm&#45;&gt;layer_3_attn_comp_gpu4</title>
<path fill="none" stroke="black" d="M2945.08,-5812.63C2956.86,-5803.11 2970.54,-5792.04 2983.12,-5781.87"/>
<polygon fill="black" stroke="black" points="2985.62,-5784.34 2991.19,-5775.33 2981.22,-5778.9 2985.62,-5784.34"/>
</g>
<!-- layer_3_attn_comp_gpu5 -->
<g id="node181" class="node">
<title>layer_3_attn_comp_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3338,-5775.1 3140,-5775.1 3140,-5722.1 3338,-5722.1 3338,-5775.1"/>
<text text-anchor="middle" x="3239" y="-5759.9" font-family="Times,serif" font-size="14.00">Attention Compute GPU5</text>
<text text-anchor="middle" x="3239" y="-5744.9" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="3239" y="-5729.9" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_3_qkv_comm&#45;&gt;layer_3_attn_comp_gpu5 -->
<g id="edge222" class="edge">
<title>layer_3_qkv_comm&#45;&gt;layer_3_attn_comp_gpu5</title>
<path fill="none" stroke="black" d="M2978.63,-5819.81C3022.95,-5807.86 3083.08,-5791.65 3134.39,-5777.81"/>
<polygon fill="black" stroke="black" points="3135.45,-5781.15 3144.2,-5775.17 3133.63,-5774.39 3135.45,-5781.15"/>
</g>
<!-- layer_3_attn_comp_gpu6 -->
<g id="node182" class="node">
<title>layer_3_attn_comp_gpu6</title>
<polygon fill="lightblue" stroke="black" points="3554,-5775.1 3356,-5775.1 3356,-5722.1 3554,-5722.1 3554,-5775.1"/>
<text text-anchor="middle" x="3455" y="-5759.9" font-family="Times,serif" font-size="14.00">Attention Compute GPU6</text>
<text text-anchor="middle" x="3455" y="-5744.9" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="3455" y="-5729.9" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_3_qkv_comm&#45;&gt;layer_3_attn_comp_gpu6 -->
<g id="edge223" class="edge">
<title>layer_3_qkv_comm&#45;&gt;layer_3_attn_comp_gpu6</title>
<path fill="none" stroke="black" d="M2994.58,-5827.74C3079.31,-5817.43 3217.49,-5799.2 3345.89,-5775.25"/>
<polygon fill="black" stroke="black" points="3346.73,-5778.65 3355.91,-5773.36 3345.43,-5771.77 3346.73,-5778.65"/>
</g>
<!-- layer_3_attn_comp_gpu7 -->
<g id="node183" class="node">
<title>layer_3_attn_comp_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3770,-5775.1 3572,-5775.1 3572,-5722.1 3770,-5722.1 3770,-5775.1"/>
<text text-anchor="middle" x="3671" y="-5759.9" font-family="Times,serif" font-size="14.00">Attention Compute GPU7</text>
<text text-anchor="middle" x="3671" y="-5744.9" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="3671" y="-5729.9" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_3_qkv_comm&#45;&gt;layer_3_attn_comp_gpu7 -->
<g id="edge224" class="edge">
<title>layer_3_qkv_comm&#45;&gt;layer_3_attn_comp_gpu7</title>
<path fill="none" stroke="black" d="M2999.1,-5832.62C3121.14,-5825.49 3354.48,-5808.79 3561.78,-5775.21"/>
<polygon fill="black" stroke="black" points="3562.64,-5778.61 3571.94,-5773.55 3561.51,-5771.71 3562.64,-5778.61"/>
</g>
<!-- layer_3_attn_out_gpu0 -->
<g id="node184" class="node">
<title>layer_3_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2283,-5686.1 2125,-5686.1 2125,-5633.1 2283,-5633.1 2283,-5686.1"/>
<text text-anchor="middle" x="2204" y="-5670.9" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU0</text>
<text text-anchor="middle" x="2204" y="-5655.9" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2204" y="-5640.9" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_3_attn_comp_gpu0&#45;&gt;layer_3_attn_out_gpu0 -->
<g id="edge225" class="edge">
<title>layer_3_attn_comp_gpu0&#45;&gt;layer_3_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M2172.26,-5721.97C2176.57,-5713.64 2181.43,-5704.24 2186.02,-5695.36"/>
<polygon fill="black" stroke="black" points="2189.2,-5696.84 2190.68,-5686.35 2182.98,-5693.63 2189.2,-5696.84"/>
</g>
<!-- layer_3_attn_out_gpu1 -->
<g id="node185" class="node">
<title>layer_3_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2479,-5686.1 2321,-5686.1 2321,-5633.1 2479,-5633.1 2479,-5686.1"/>
<text text-anchor="middle" x="2400" y="-5670.9" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU1</text>
<text text-anchor="middle" x="2400" y="-5655.9" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2400" y="-5640.9" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_3_attn_comp_gpu1&#45;&gt;layer_3_attn_out_gpu1 -->
<g id="edge226" class="edge">
<title>layer_3_attn_comp_gpu1&#45;&gt;layer_3_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M2382.37,-5721.97C2384.68,-5713.9 2387.29,-5704.84 2389.77,-5696.2"/>
<polygon fill="black" stroke="black" points="2393.2,-5696.93 2392.6,-5686.35 2386.47,-5695 2393.2,-5696.93"/>
</g>
<!-- layer_3_attn_out_gpu2 -->
<g id="node186" class="node">
<title>layer_3_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2680,-5686.1 2522,-5686.1 2522,-5633.1 2680,-5633.1 2680,-5686.1"/>
<text text-anchor="middle" x="2601" y="-5670.9" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU2</text>
<text text-anchor="middle" x="2601" y="-5655.9" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2601" y="-5640.9" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_3_attn_comp_gpu2&#45;&gt;layer_3_attn_out_gpu2 -->
<g id="edge227" class="edge">
<title>layer_3_attn_comp_gpu2&#45;&gt;layer_3_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M2593.95,-5721.97C2594.86,-5713.99 2595.89,-5705.03 2596.88,-5696.49"/>
<polygon fill="black" stroke="black" points="2600.38,-5696.69 2598.04,-5686.35 2593.42,-5695.89 2600.38,-5696.69"/>
</g>
<!-- layer_3_attn_out_gpu3 -->
<g id="node187" class="node">
<title>layer_3_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2896,-5686.1 2738,-5686.1 2738,-5633.1 2896,-5633.1 2896,-5686.1"/>
<text text-anchor="middle" x="2817" y="-5670.9" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU3</text>
<text text-anchor="middle" x="2817" y="-5655.9" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2817" y="-5640.9" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_3_attn_comp_gpu3&#45;&gt;layer_3_attn_out_gpu3 -->
<g id="edge228" class="edge">
<title>layer_3_attn_comp_gpu3&#45;&gt;layer_3_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M2809.95,-5721.97C2810.86,-5713.99 2811.89,-5705.03 2812.88,-5696.49"/>
<polygon fill="black" stroke="black" points="2816.38,-5696.69 2814.04,-5686.35 2809.42,-5695.89 2816.38,-5696.69"/>
</g>
<!-- layer_3_attn_out_gpu4 -->
<g id="node188" class="node">
<title>layer_3_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3092,-5686.1 2934,-5686.1 2934,-5633.1 3092,-5633.1 3092,-5686.1"/>
<text text-anchor="middle" x="3013" y="-5670.9" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU4</text>
<text text-anchor="middle" x="3013" y="-5655.9" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3013" y="-5640.9" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_3_attn_comp_gpu4&#45;&gt;layer_3_attn_out_gpu4 -->
<g id="edge229" class="edge">
<title>layer_3_attn_comp_gpu4&#45;&gt;layer_3_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M3020.05,-5721.97C3019.14,-5713.99 3018.11,-5705.03 3017.12,-5696.49"/>
<polygon fill="black" stroke="black" points="3020.58,-5695.89 3015.96,-5686.35 3013.62,-5696.69 3020.58,-5695.89"/>
</g>
<!-- layer_3_attn_out_gpu5 -->
<g id="node189" class="node">
<title>layer_3_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3288,-5686.1 3130,-5686.1 3130,-5633.1 3288,-5633.1 3288,-5686.1"/>
<text text-anchor="middle" x="3209" y="-5670.9" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU5</text>
<text text-anchor="middle" x="3209" y="-5655.9" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3209" y="-5640.9" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_3_attn_comp_gpu5&#45;&gt;layer_3_attn_out_gpu5 -->
<g id="edge230" class="edge">
<title>layer_3_attn_comp_gpu5&#45;&gt;layer_3_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M3230.16,-5721.97C3227.35,-5713.81 3224.19,-5704.64 3221.18,-5695.92"/>
<polygon fill="black" stroke="black" points="3224.45,-5694.66 3217.88,-5686.35 3217.83,-5696.95 3224.45,-5694.66"/>
</g>
<!-- layer_3_attn_out_gpu6 -->
<g id="node190" class="node">
<title>layer_3_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="3494,-5686.1 3336,-5686.1 3336,-5633.1 3494,-5633.1 3494,-5686.1"/>
<text text-anchor="middle" x="3415" y="-5670.9" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU6</text>
<text text-anchor="middle" x="3415" y="-5655.9" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3415" y="-5640.9" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_3_attn_comp_gpu6&#45;&gt;layer_3_attn_out_gpu6 -->
<g id="edge231" class="edge">
<title>layer_3_attn_comp_gpu6&#45;&gt;layer_3_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M3443.22,-5721.97C3439.42,-5713.72 3435.16,-5704.44 3431.11,-5695.64"/>
<polygon fill="black" stroke="black" points="3434.2,-5693.98 3426.84,-5686.35 3427.84,-5696.9 3434.2,-5693.98"/>
</g>
<!-- layer_3_attn_out_gpu7 -->
<g id="node191" class="node">
<title>layer_3_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3705,-5686.1 3547,-5686.1 3547,-5633.1 3705,-5633.1 3705,-5686.1"/>
<text text-anchor="middle" x="3626" y="-5670.9" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU7</text>
<text text-anchor="middle" x="3626" y="-5655.9" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3626" y="-5640.9" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_3_attn_comp_gpu7&#45;&gt;layer_3_attn_out_gpu7 -->
<g id="edge232" class="edge">
<title>layer_3_attn_comp_gpu7&#45;&gt;layer_3_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M3657.74,-5721.97C3653.43,-5713.64 3648.57,-5704.24 3643.98,-5695.36"/>
<polygon fill="black" stroke="black" points="3647.02,-5693.63 3639.32,-5686.35 3640.8,-5696.84 3647.02,-5693.63"/>
</g>
<!-- layer_3_attn_allreduce -->
<g id="node192" class="node">
<title>layer_3_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2915" cy="-5570.23" rx="112.36" ry="26.74"/>
<text text-anchor="middle" x="2915" y="-5574.03" font-family="Times,serif" font-size="14.00">Attention AllReduce</text>
<text text-anchor="middle" x="2915" y="-5559.03" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_3_attn_out_gpu0&#45;&gt;layer_3_attn_allreduce -->
<g id="edge233" class="edge">
<title>layer_3_attn_out_gpu0&#45;&gt;layer_3_attn_allreduce</title>
<path fill="none" stroke="black" d="M2283.09,-5638.69C2292.79,-5636.61 2302.6,-5634.69 2312,-5633.1 2479.43,-5604.87 2675.32,-5587.65 2797.31,-5578.77"/>
<polygon fill="black" stroke="black" points="2797.69,-5582.25 2807.42,-5578.04 2797.19,-5575.27 2797.69,-5582.25"/>
</g>
<!-- layer_3_attn_out_gpu1&#45;&gt;layer_3_attn_allreduce -->
<g id="edge234" class="edge">
<title>layer_3_attn_out_gpu1&#45;&gt;layer_3_attn_allreduce</title>
<path fill="none" stroke="black" d="M2479.19,-5640C2490.51,-5637.56 2502.03,-5635.18 2513,-5633.1 2612.63,-5614.22 2726.99,-5597.05 2808.19,-5585.62"/>
<polygon fill="black" stroke="black" points="2809.01,-5589.04 2818.43,-5584.18 2808.04,-5582.1 2809.01,-5589.04"/>
</g>
<!-- layer_3_attn_out_gpu2&#45;&gt;layer_3_attn_allreduce -->
<g id="edge235" class="edge">
<title>layer_3_attn_out_gpu2&#45;&gt;layer_3_attn_allreduce</title>
<path fill="none" stroke="black" d="M2680.24,-5636.55C2727.13,-5623.51 2786.42,-5607.01 2833.68,-5593.86"/>
<polygon fill="black" stroke="black" points="2834.87,-5597.16 2843.57,-5591.11 2833,-5590.42 2834.87,-5597.16"/>
</g>
<!-- layer_3_attn_out_gpu3&#45;&gt;layer_3_attn_allreduce -->
<g id="edge236" class="edge">
<title>layer_3_attn_out_gpu3&#45;&gt;layer_3_attn_allreduce</title>
<path fill="none" stroke="black" d="M2845.61,-5633.1C2856.17,-5623.68 2868.26,-5612.9 2879.37,-5603"/>
<polygon fill="black" stroke="black" points="2881.73,-5605.58 2886.86,-5596.32 2877.07,-5600.36 2881.73,-5605.58"/>
</g>
<!-- layer_3_attn_out_gpu4&#45;&gt;layer_3_attn_allreduce -->
<g id="edge237" class="edge">
<title>layer_3_attn_out_gpu4&#45;&gt;layer_3_attn_allreduce</title>
<path fill="none" stroke="black" d="M2984.39,-5633.1C2973.83,-5623.68 2961.74,-5612.9 2950.63,-5603"/>
<polygon fill="black" stroke="black" points="2952.93,-5600.36 2943.14,-5596.32 2948.27,-5605.58 2952.93,-5600.36"/>
</g>
<!-- layer_3_attn_out_gpu5&#45;&gt;layer_3_attn_allreduce -->
<g id="edge238" class="edge">
<title>layer_3_attn_out_gpu5&#45;&gt;layer_3_attn_allreduce</title>
<path fill="none" stroke="black" d="M3129.83,-5635.07C3087.54,-5622.51 3035.66,-5607.09 2993.48,-5594.55"/>
<polygon fill="black" stroke="black" points="2994.39,-5591.17 2983.81,-5591.68 2992.4,-5597.88 2994.39,-5591.17"/>
</g>
<!-- layer_3_attn_out_gpu6&#45;&gt;layer_3_attn_allreduce -->
<g id="edge239" class="edge">
<title>layer_3_attn_out_gpu6&#45;&gt;layer_3_attn_allreduce</title>
<path fill="none" stroke="black" d="M3335.77,-5640.89C3322.84,-5638.16 3309.56,-5635.47 3297,-5633.1 3203.34,-5615.41 3096.16,-5598.32 3019.22,-5586.61"/>
<polygon fill="black" stroke="black" points="3019.45,-5583.1 3009.04,-5585.06 3018.4,-5590.02 3019.45,-5583.1"/>
</g>
<!-- layer_3_attn_out_gpu7&#45;&gt;layer_3_attn_allreduce -->
<g id="edge240" class="edge">
<title>layer_3_attn_out_gpu7&#45;&gt;layer_3_attn_allreduce</title>
<path fill="none" stroke="black" d="M3546.81,-5640.98C3532.29,-5638.09 3517.22,-5635.32 3503,-5633.1 3340.15,-5607.72 3150.26,-5589.84 3031.32,-5580.03"/>
<polygon fill="black" stroke="black" points="3031.35,-5576.52 3021.1,-5579.2 3030.78,-5583.5 3031.35,-5576.52"/>
</g>
<!-- layer_3_residual1 -->
<g id="node193" class="node">
<title>layer_3_residual1</title>
<polygon fill="lightyellow" stroke="black" points="3043.61,-5507.36 2839.02,-5507.36 2786.39,-5431.36 2990.98,-5431.36 3043.61,-5507.36"/>
<text text-anchor="middle" x="2915" y="-5473.16" font-family="Times,serif" font-size="14.00">Residual Add 3</text>
<text text-anchor="middle" x="2915" y="-5458.16" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_3_attn_allreduce&#45;&gt;layer_3_residual1 -->
<g id="edge241" class="edge">
<title>layer_3_attn_allreduce&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M2915,-5543.25C2915,-5535.44 2915,-5526.61 2915,-5517.86"/>
<polygon fill="black" stroke="black" points="2918.5,-5517.69 2915,-5507.69 2911.5,-5517.69 2918.5,-5517.69"/>
</g>
<!-- layer_3_ln1 -->
<g id="node194" class="node">
<title>layer_3_ln1</title>
<polygon fill="lightblue" stroke="black" points="2970.5,-5395.36 2859.5,-5395.36 2859.5,-5357.36 2970.5,-5357.36 2970.5,-5395.36"/>
<text text-anchor="middle" x="2915" y="-5380.16" font-family="Times,serif" font-size="14.00">LayerNorm 3</text>
<text text-anchor="middle" x="2915" y="-5365.16" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_3_residual1&#45;&gt;layer_3_ln1 -->
<g id="edge242" class="edge">
<title>layer_3_residual1&#45;&gt;layer_3_ln1</title>
<path fill="none" stroke="black" d="M2915,-5431.35C2915,-5422.73 2915,-5413.68 2915,-5405.52"/>
<polygon fill="black" stroke="black" points="2918.5,-5405.39 2915,-5395.39 2911.5,-5405.39 2918.5,-5405.39"/>
</g>
<!-- layer_3_mlp1_gpu0 -->
<g id="node195" class="node">
<title>layer_3_mlp1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3482,-5318.36 3356,-5318.36 3356,-5265.36 3482,-5265.36 3482,-5318.36"/>
<text text-anchor="middle" x="3419" y="-5303.16" font-family="Times,serif" font-size="14.00">MLP1 GPU0</text>
<text text-anchor="middle" x="3419" y="-5288.16" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3419" y="-5273.16" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp1_gpu0 -->
<g id="edge243" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp1_gpu0</title>
<path fill="none" stroke="black" d="M2970.64,-5376.1C3071.37,-5376.77 3279.74,-5374.89 3347,-5349.36 3361.24,-5343.96 3374.92,-5334.67 3386.45,-5325.18"/>
<polygon fill="black" stroke="black" points="3388.78,-5327.79 3394.07,-5318.62 3384.21,-5322.49 3388.78,-5327.79"/>
</g>
<!-- layer_3_mlp1_gpu1 -->
<g id="node196" class="node">
<title>layer_3_mlp1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="3338,-5318.36 3212,-5318.36 3212,-5265.36 3338,-5265.36 3338,-5318.36"/>
<text text-anchor="middle" x="3275" y="-5303.16" font-family="Times,serif" font-size="14.00">MLP1 GPU1</text>
<text text-anchor="middle" x="3275" y="-5288.16" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3275" y="-5273.16" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp1_gpu1 -->
<g id="edge247" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp1_gpu1</title>
<path fill="none" stroke="black" d="M2970.68,-5374.08C3042.24,-5371.78 3162.11,-5365.58 3203,-5349.36 3217.16,-5343.74 3230.81,-5334.41 3242.35,-5324.93"/>
<polygon fill="black" stroke="black" points="3244.67,-5327.55 3249.98,-5318.39 3240.11,-5322.24 3244.67,-5327.55"/>
</g>
<!-- layer_3_mlp1_gpu2 -->
<g id="node197" class="node">
<title>layer_3_mlp1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="3194,-5318.36 3068,-5318.36 3068,-5265.36 3194,-5265.36 3194,-5318.36"/>
<text text-anchor="middle" x="3131" y="-5303.16" font-family="Times,serif" font-size="14.00">MLP1 GPU2</text>
<text text-anchor="middle" x="3131" y="-5288.16" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3131" y="-5273.16" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp1_gpu2 -->
<g id="edge251" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp1_gpu2</title>
<path fill="none" stroke="black" d="M2970.54,-5371.67C2998.09,-5368.29 3031.31,-5361.8 3059,-5349.36 3072.41,-5343.34 3085.54,-5334.29 3096.83,-5325.18"/>
<polygon fill="black" stroke="black" points="3099.29,-5327.69 3104.71,-5318.59 3094.79,-5322.33 3099.29,-5327.69"/>
</g>
<!-- layer_3_mlp1_gpu3 -->
<g id="node198" class="node">
<title>layer_3_mlp1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3050,-5318.36 2924,-5318.36 2924,-5265.36 3050,-5265.36 3050,-5318.36"/>
<text text-anchor="middle" x="2987" y="-5303.16" font-family="Times,serif" font-size="14.00">MLP1 GPU3</text>
<text text-anchor="middle" x="2987" y="-5288.16" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2987" y="-5273.16" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp1_gpu3 -->
<g id="edge255" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp1_gpu3</title>
<path fill="none" stroke="black" d="M2930.98,-5357.05C2938.84,-5348.05 2948.56,-5336.91 2957.69,-5326.45"/>
<polygon fill="black" stroke="black" points="2960.57,-5328.46 2964.51,-5318.63 2955.3,-5323.86 2960.57,-5328.46"/>
</g>
<!-- layer_3_mlp1_gpu4 -->
<g id="node199" class="node">
<title>layer_3_mlp1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2906,-5318.36 2780,-5318.36 2780,-5265.36 2906,-5265.36 2906,-5318.36"/>
<text text-anchor="middle" x="2843" y="-5303.16" font-family="Times,serif" font-size="14.00">MLP1 GPU4</text>
<text text-anchor="middle" x="2843" y="-5288.16" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2843" y="-5273.16" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp1_gpu4 -->
<g id="edge259" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp1_gpu4</title>
<path fill="none" stroke="black" d="M2899.02,-5357.05C2891.16,-5348.05 2881.44,-5336.91 2872.31,-5326.45"/>
<polygon fill="black" stroke="black" points="2874.7,-5323.86 2865.49,-5318.63 2869.43,-5328.46 2874.7,-5323.86"/>
</g>
<!-- layer_3_mlp1_gpu5 -->
<g id="node200" class="node">
<title>layer_3_mlp1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2762,-5318.36 2636,-5318.36 2636,-5265.36 2762,-5265.36 2762,-5318.36"/>
<text text-anchor="middle" x="2699" y="-5303.16" font-family="Times,serif" font-size="14.00">MLP1 GPU5</text>
<text text-anchor="middle" x="2699" y="-5288.16" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2699" y="-5273.16" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp1_gpu5 -->
<g id="edge263" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp1_gpu5</title>
<path fill="none" stroke="black" d="M2859.46,-5371.67C2831.91,-5368.29 2798.69,-5361.8 2771,-5349.36 2757.59,-5343.34 2744.46,-5334.29 2733.17,-5325.18"/>
<polygon fill="black" stroke="black" points="2735.21,-5322.33 2725.29,-5318.59 2730.71,-5327.69 2735.21,-5322.33"/>
</g>
<!-- layer_3_mlp1_gpu6 -->
<g id="node201" class="node">
<title>layer_3_mlp1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2618,-5318.36 2492,-5318.36 2492,-5265.36 2618,-5265.36 2618,-5318.36"/>
<text text-anchor="middle" x="2555" y="-5303.16" font-family="Times,serif" font-size="14.00">MLP1 GPU6</text>
<text text-anchor="middle" x="2555" y="-5288.16" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2555" y="-5273.16" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp1_gpu6 -->
<g id="edge267" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp1_gpu6</title>
<path fill="none" stroke="black" d="M2859.32,-5374.08C2787.76,-5371.78 2667.89,-5365.58 2627,-5349.36 2612.84,-5343.74 2599.19,-5334.41 2587.65,-5324.93"/>
<polygon fill="black" stroke="black" points="2589.89,-5322.24 2580.02,-5318.39 2585.33,-5327.55 2589.89,-5322.24"/>
</g>
<!-- layer_3_mlp1_gpu7 -->
<g id="node202" class="node">
<title>layer_3_mlp1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2474,-5318.36 2348,-5318.36 2348,-5265.36 2474,-5265.36 2474,-5318.36"/>
<text text-anchor="middle" x="2411" y="-5303.16" font-family="Times,serif" font-size="14.00">MLP1 GPU7</text>
<text text-anchor="middle" x="2411" y="-5288.16" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2411" y="-5273.16" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp1_gpu7 -->
<g id="edge271" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp1_gpu7</title>
<path fill="none" stroke="black" d="M2859.36,-5376.1C2758.63,-5376.77 2550.26,-5374.89 2483,-5349.36 2468.76,-5343.96 2455.08,-5334.67 2443.55,-5325.18"/>
<polygon fill="black" stroke="black" points="2445.79,-5322.49 2435.93,-5318.62 2441.22,-5327.79 2445.79,-5322.49"/>
</g>
<!-- layer_3_gelu_gpu0 -->
<g id="node203" class="node">
<title>layer_3_gelu_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3471,-5229.36 3367,-5229.36 3367,-5191.36 3471,-5191.36 3471,-5229.36"/>
<text text-anchor="middle" x="3419" y="-5214.16" font-family="Times,serif" font-size="14.00">GELU GPU0</text>
<text text-anchor="middle" x="3419" y="-5199.16" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_3_mlp1_gpu0&#45;&gt;layer_3_gelu_gpu0 -->
<g id="edge244" class="edge">
<title>layer_3_mlp1_gpu0&#45;&gt;layer_3_gelu_gpu0</title>
<path fill="none" stroke="black" d="M3419,-5265.27C3419,-5257.1 3419,-5248.01 3419,-5239.66"/>
<polygon fill="black" stroke="black" points="3422.5,-5239.6 3419,-5229.6 3415.5,-5239.6 3422.5,-5239.6"/>
</g>
<!-- layer_3_gelu_gpu1 -->
<g id="node204" class="node">
<title>layer_3_gelu_gpu1</title>
<polygon fill="lightblue" stroke="black" points="3327,-5229.36 3223,-5229.36 3223,-5191.36 3327,-5191.36 3327,-5229.36"/>
<text text-anchor="middle" x="3275" y="-5214.16" font-family="Times,serif" font-size="14.00">GELU GPU1</text>
<text text-anchor="middle" x="3275" y="-5199.16" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_3_mlp1_gpu1&#45;&gt;layer_3_gelu_gpu1 -->
<g id="edge248" class="edge">
<title>layer_3_mlp1_gpu1&#45;&gt;layer_3_gelu_gpu1</title>
<path fill="none" stroke="black" d="M3275,-5265.27C3275,-5257.1 3275,-5248.01 3275,-5239.66"/>
<polygon fill="black" stroke="black" points="3278.5,-5239.6 3275,-5229.6 3271.5,-5239.6 3278.5,-5239.6"/>
</g>
<!-- layer_3_gelu_gpu2 -->
<g id="node205" class="node">
<title>layer_3_gelu_gpu2</title>
<polygon fill="lightblue" stroke="black" points="3183,-5229.36 3079,-5229.36 3079,-5191.36 3183,-5191.36 3183,-5229.36"/>
<text text-anchor="middle" x="3131" y="-5214.16" font-family="Times,serif" font-size="14.00">GELU GPU2</text>
<text text-anchor="middle" x="3131" y="-5199.16" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_3_mlp1_gpu2&#45;&gt;layer_3_gelu_gpu2 -->
<g id="edge252" class="edge">
<title>layer_3_mlp1_gpu2&#45;&gt;layer_3_gelu_gpu2</title>
<path fill="none" stroke="black" d="M3131,-5265.27C3131,-5257.1 3131,-5248.01 3131,-5239.66"/>
<polygon fill="black" stroke="black" points="3134.5,-5239.6 3131,-5229.6 3127.5,-5239.6 3134.5,-5239.6"/>
</g>
<!-- layer_3_gelu_gpu3 -->
<g id="node206" class="node">
<title>layer_3_gelu_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3039,-5229.36 2935,-5229.36 2935,-5191.36 3039,-5191.36 3039,-5229.36"/>
<text text-anchor="middle" x="2987" y="-5214.16" font-family="Times,serif" font-size="14.00">GELU GPU3</text>
<text text-anchor="middle" x="2987" y="-5199.16" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_3_mlp1_gpu3&#45;&gt;layer_3_gelu_gpu3 -->
<g id="edge256" class="edge">
<title>layer_3_mlp1_gpu3&#45;&gt;layer_3_gelu_gpu3</title>
<path fill="none" stroke="black" d="M2987,-5265.27C2987,-5257.1 2987,-5248.01 2987,-5239.66"/>
<polygon fill="black" stroke="black" points="2990.5,-5239.6 2987,-5229.6 2983.5,-5239.6 2990.5,-5239.6"/>
</g>
<!-- layer_3_gelu_gpu4 -->
<g id="node207" class="node">
<title>layer_3_gelu_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2895,-5229.36 2791,-5229.36 2791,-5191.36 2895,-5191.36 2895,-5229.36"/>
<text text-anchor="middle" x="2843" y="-5214.16" font-family="Times,serif" font-size="14.00">GELU GPU4</text>
<text text-anchor="middle" x="2843" y="-5199.16" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_3_mlp1_gpu4&#45;&gt;layer_3_gelu_gpu4 -->
<g id="edge260" class="edge">
<title>layer_3_mlp1_gpu4&#45;&gt;layer_3_gelu_gpu4</title>
<path fill="none" stroke="black" d="M2843,-5265.27C2843,-5257.1 2843,-5248.01 2843,-5239.66"/>
<polygon fill="black" stroke="black" points="2846.5,-5239.6 2843,-5229.6 2839.5,-5239.6 2846.5,-5239.6"/>
</g>
<!-- layer_3_gelu_gpu5 -->
<g id="node208" class="node">
<title>layer_3_gelu_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2751,-5229.36 2647,-5229.36 2647,-5191.36 2751,-5191.36 2751,-5229.36"/>
<text text-anchor="middle" x="2699" y="-5214.16" font-family="Times,serif" font-size="14.00">GELU GPU5</text>
<text text-anchor="middle" x="2699" y="-5199.16" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_3_mlp1_gpu5&#45;&gt;layer_3_gelu_gpu5 -->
<g id="edge264" class="edge">
<title>layer_3_mlp1_gpu5&#45;&gt;layer_3_gelu_gpu5</title>
<path fill="none" stroke="black" d="M2699,-5265.27C2699,-5257.1 2699,-5248.01 2699,-5239.66"/>
<polygon fill="black" stroke="black" points="2702.5,-5239.6 2699,-5229.6 2695.5,-5239.6 2702.5,-5239.6"/>
</g>
<!-- layer_3_gelu_gpu6 -->
<g id="node209" class="node">
<title>layer_3_gelu_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2607,-5229.36 2503,-5229.36 2503,-5191.36 2607,-5191.36 2607,-5229.36"/>
<text text-anchor="middle" x="2555" y="-5214.16" font-family="Times,serif" font-size="14.00">GELU GPU6</text>
<text text-anchor="middle" x="2555" y="-5199.16" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_3_mlp1_gpu6&#45;&gt;layer_3_gelu_gpu6 -->
<g id="edge268" class="edge">
<title>layer_3_mlp1_gpu6&#45;&gt;layer_3_gelu_gpu6</title>
<path fill="none" stroke="black" d="M2555,-5265.27C2555,-5257.1 2555,-5248.01 2555,-5239.66"/>
<polygon fill="black" stroke="black" points="2558.5,-5239.6 2555,-5229.6 2551.5,-5239.6 2558.5,-5239.6"/>
</g>
<!-- layer_3_gelu_gpu7 -->
<g id="node210" class="node">
<title>layer_3_gelu_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2463,-5229.36 2359,-5229.36 2359,-5191.36 2463,-5191.36 2463,-5229.36"/>
<text text-anchor="middle" x="2411" y="-5214.16" font-family="Times,serif" font-size="14.00">GELU GPU7</text>
<text text-anchor="middle" x="2411" y="-5199.16" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_3_mlp1_gpu7&#45;&gt;layer_3_gelu_gpu7 -->
<g id="edge272" class="edge">
<title>layer_3_mlp1_gpu7&#45;&gt;layer_3_gelu_gpu7</title>
<path fill="none" stroke="black" d="M2411,-5265.27C2411,-5257.1 2411,-5248.01 2411,-5239.66"/>
<polygon fill="black" stroke="black" points="2414.5,-5239.6 2411,-5229.6 2407.5,-5239.6 2414.5,-5239.6"/>
</g>
<!-- layer_3_mlp2_gpu0 -->
<g id="node211" class="node">
<title>layer_3_mlp2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3482,-5155.36 3356,-5155.36 3356,-5102.36 3482,-5102.36 3482,-5155.36"/>
<text text-anchor="middle" x="3419" y="-5140.16" font-family="Times,serif" font-size="14.00">MLP2 GPU0</text>
<text text-anchor="middle" x="3419" y="-5125.16" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3419" y="-5110.16" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_3_gelu_gpu0&#45;&gt;layer_3_mlp2_gpu0 -->
<g id="edge245" class="edge">
<title>layer_3_gelu_gpu0&#45;&gt;layer_3_mlp2_gpu0</title>
<path fill="none" stroke="black" d="M3419,-5191.32C3419,-5183.68 3419,-5174.5 3419,-5165.59"/>
<polygon fill="black" stroke="black" points="3422.5,-5165.36 3419,-5155.36 3415.5,-5165.36 3422.5,-5165.36"/>
</g>
<!-- layer_3_mlp2_gpu1 -->
<g id="node212" class="node">
<title>layer_3_mlp2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="3338,-5155.36 3212,-5155.36 3212,-5102.36 3338,-5102.36 3338,-5155.36"/>
<text text-anchor="middle" x="3275" y="-5140.16" font-family="Times,serif" font-size="14.00">MLP2 GPU1</text>
<text text-anchor="middle" x="3275" y="-5125.16" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3275" y="-5110.16" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_3_gelu_gpu1&#45;&gt;layer_3_mlp2_gpu1 -->
<g id="edge249" class="edge">
<title>layer_3_gelu_gpu1&#45;&gt;layer_3_mlp2_gpu1</title>
<path fill="none" stroke="black" d="M3275,-5191.32C3275,-5183.68 3275,-5174.5 3275,-5165.59"/>
<polygon fill="black" stroke="black" points="3278.5,-5165.36 3275,-5155.36 3271.5,-5165.36 3278.5,-5165.36"/>
</g>
<!-- layer_3_mlp2_gpu2 -->
<g id="node213" class="node">
<title>layer_3_mlp2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="3194,-5155.36 3068,-5155.36 3068,-5102.36 3194,-5102.36 3194,-5155.36"/>
<text text-anchor="middle" x="3131" y="-5140.16" font-family="Times,serif" font-size="14.00">MLP2 GPU2</text>
<text text-anchor="middle" x="3131" y="-5125.16" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3131" y="-5110.16" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_3_gelu_gpu2&#45;&gt;layer_3_mlp2_gpu2 -->
<g id="edge253" class="edge">
<title>layer_3_gelu_gpu2&#45;&gt;layer_3_mlp2_gpu2</title>
<path fill="none" stroke="black" d="M3131,-5191.32C3131,-5183.68 3131,-5174.5 3131,-5165.59"/>
<polygon fill="black" stroke="black" points="3134.5,-5165.36 3131,-5155.36 3127.5,-5165.36 3134.5,-5165.36"/>
</g>
<!-- layer_3_mlp2_gpu3 -->
<g id="node214" class="node">
<title>layer_3_mlp2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3050,-5155.36 2924,-5155.36 2924,-5102.36 3050,-5102.36 3050,-5155.36"/>
<text text-anchor="middle" x="2987" y="-5140.16" font-family="Times,serif" font-size="14.00">MLP2 GPU3</text>
<text text-anchor="middle" x="2987" y="-5125.16" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2987" y="-5110.16" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_3_gelu_gpu3&#45;&gt;layer_3_mlp2_gpu3 -->
<g id="edge257" class="edge">
<title>layer_3_gelu_gpu3&#45;&gt;layer_3_mlp2_gpu3</title>
<path fill="none" stroke="black" d="M2987,-5191.32C2987,-5183.68 2987,-5174.5 2987,-5165.59"/>
<polygon fill="black" stroke="black" points="2990.5,-5165.36 2987,-5155.36 2983.5,-5165.36 2990.5,-5165.36"/>
</g>
<!-- layer_3_mlp2_gpu4 -->
<g id="node215" class="node">
<title>layer_3_mlp2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2906,-5155.36 2780,-5155.36 2780,-5102.36 2906,-5102.36 2906,-5155.36"/>
<text text-anchor="middle" x="2843" y="-5140.16" font-family="Times,serif" font-size="14.00">MLP2 GPU4</text>
<text text-anchor="middle" x="2843" y="-5125.16" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2843" y="-5110.16" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_3_gelu_gpu4&#45;&gt;layer_3_mlp2_gpu4 -->
<g id="edge261" class="edge">
<title>layer_3_gelu_gpu4&#45;&gt;layer_3_mlp2_gpu4</title>
<path fill="none" stroke="black" d="M2843,-5191.32C2843,-5183.68 2843,-5174.5 2843,-5165.59"/>
<polygon fill="black" stroke="black" points="2846.5,-5165.36 2843,-5155.36 2839.5,-5165.36 2846.5,-5165.36"/>
</g>
<!-- layer_3_mlp2_gpu5 -->
<g id="node216" class="node">
<title>layer_3_mlp2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2762,-5155.36 2636,-5155.36 2636,-5102.36 2762,-5102.36 2762,-5155.36"/>
<text text-anchor="middle" x="2699" y="-5140.16" font-family="Times,serif" font-size="14.00">MLP2 GPU5</text>
<text text-anchor="middle" x="2699" y="-5125.16" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2699" y="-5110.16" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_3_gelu_gpu5&#45;&gt;layer_3_mlp2_gpu5 -->
<g id="edge265" class="edge">
<title>layer_3_gelu_gpu5&#45;&gt;layer_3_mlp2_gpu5</title>
<path fill="none" stroke="black" d="M2699,-5191.32C2699,-5183.68 2699,-5174.5 2699,-5165.59"/>
<polygon fill="black" stroke="black" points="2702.5,-5165.36 2699,-5155.36 2695.5,-5165.36 2702.5,-5165.36"/>
</g>
<!-- layer_3_mlp2_gpu6 -->
<g id="node217" class="node">
<title>layer_3_mlp2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2618,-5155.36 2492,-5155.36 2492,-5102.36 2618,-5102.36 2618,-5155.36"/>
<text text-anchor="middle" x="2555" y="-5140.16" font-family="Times,serif" font-size="14.00">MLP2 GPU6</text>
<text text-anchor="middle" x="2555" y="-5125.16" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2555" y="-5110.16" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_3_gelu_gpu6&#45;&gt;layer_3_mlp2_gpu6 -->
<g id="edge269" class="edge">
<title>layer_3_gelu_gpu6&#45;&gt;layer_3_mlp2_gpu6</title>
<path fill="none" stroke="black" d="M2555,-5191.32C2555,-5183.68 2555,-5174.5 2555,-5165.59"/>
<polygon fill="black" stroke="black" points="2558.5,-5165.36 2555,-5155.36 2551.5,-5165.36 2558.5,-5165.36"/>
</g>
<!-- layer_3_mlp2_gpu7 -->
<g id="node218" class="node">
<title>layer_3_mlp2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2474,-5155.36 2348,-5155.36 2348,-5102.36 2474,-5102.36 2474,-5155.36"/>
<text text-anchor="middle" x="2411" y="-5140.16" font-family="Times,serif" font-size="14.00">MLP2 GPU7</text>
<text text-anchor="middle" x="2411" y="-5125.16" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2411" y="-5110.16" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_3_gelu_gpu7&#45;&gt;layer_3_mlp2_gpu7 -->
<g id="edge273" class="edge">
<title>layer_3_gelu_gpu7&#45;&gt;layer_3_mlp2_gpu7</title>
<path fill="none" stroke="black" d="M2411,-5191.32C2411,-5183.68 2411,-5174.5 2411,-5165.59"/>
<polygon fill="black" stroke="black" points="2414.5,-5165.36 2411,-5155.36 2407.5,-5165.36 2414.5,-5165.36"/>
</g>
<!-- layer_3_mlp_allreduce -->
<g id="node219" class="node">
<title>layer_3_mlp_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2915" cy="-5039.49" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="2915" y="-5043.29" font-family="Times,serif" font-size="14.00">MLP AllReduce</text>
<text text-anchor="middle" x="2915" y="-5028.29" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_3_mlp2_gpu0&#45;&gt;layer_3_mlp_allreduce -->
<g id="edge246" class="edge">
<title>layer_3_mlp2_gpu0&#45;&gt;layer_3_mlp_allreduce</title>
<path fill="none" stroke="black" d="M3356,-5104.75C3352.97,-5103.89 3349.96,-5103.09 3347,-5102.36 3232.59,-5074.2 3097.77,-5057.43 3009.56,-5048.59"/>
<polygon fill="black" stroke="black" points="3009.86,-5045.11 2999.57,-5047.61 3009.18,-5052.07 3009.86,-5045.11"/>
</g>
<!-- layer_3_mlp2_gpu1&#45;&gt;layer_3_mlp_allreduce -->
<g id="edge250" class="edge">
<title>layer_3_mlp2_gpu1&#45;&gt;layer_3_mlp_allreduce</title>
<path fill="none" stroke="black" d="M3211.93,-5105.01C3208.92,-5104.08 3205.93,-5103.19 3203,-5102.36 3135.58,-5083.27 3057.82,-5066.89 3000.11,-5055.79"/>
<polygon fill="black" stroke="black" points="3000.42,-5052.28 2989.94,-5053.85 2999.1,-5059.16 3000.42,-5052.28"/>
</g>
<!-- layer_3_mlp2_gpu2&#45;&gt;layer_3_mlp_allreduce -->
<g id="edge254" class="edge">
<title>layer_3_mlp2_gpu2&#45;&gt;layer_3_mlp_allreduce</title>
<path fill="none" stroke="black" d="M3067.94,-5102.36C3039.08,-5090.68 3005,-5076.9 2976.35,-5065.31"/>
<polygon fill="black" stroke="black" points="2977.44,-5061.97 2966.86,-5061.47 2974.81,-5068.46 2977.44,-5061.97"/>
</g>
<!-- layer_3_mlp2_gpu3&#45;&gt;layer_3_mlp_allreduce -->
<g id="edge258" class="edge">
<title>layer_3_mlp2_gpu3&#45;&gt;layer_3_mlp_allreduce</title>
<path fill="none" stroke="black" d="M2965.79,-5102.12C2958.4,-5093.15 2950,-5082.97 2942.2,-5073.49"/>
<polygon fill="black" stroke="black" points="2944.87,-5071.24 2935.81,-5065.75 2939.47,-5075.69 2944.87,-5071.24"/>
</g>
<!-- layer_3_mlp2_gpu4&#45;&gt;layer_3_mlp_allreduce -->
<g id="edge262" class="edge">
<title>layer_3_mlp2_gpu4&#45;&gt;layer_3_mlp_allreduce</title>
<path fill="none" stroke="black" d="M2864.21,-5102.12C2871.6,-5093.15 2880,-5082.97 2887.8,-5073.49"/>
<polygon fill="black" stroke="black" points="2890.53,-5075.69 2894.19,-5065.75 2885.13,-5071.24 2890.53,-5075.69"/>
</g>
<!-- layer_3_mlp2_gpu5&#45;&gt;layer_3_mlp_allreduce -->
<g id="edge266" class="edge">
<title>layer_3_mlp2_gpu5&#45;&gt;layer_3_mlp_allreduce</title>
<path fill="none" stroke="black" d="M2762.06,-5102.36C2790.92,-5090.68 2825,-5076.9 2853.65,-5065.31"/>
<polygon fill="black" stroke="black" points="2855.19,-5068.46 2863.14,-5061.47 2852.56,-5061.97 2855.19,-5068.46"/>
</g>
<!-- layer_3_mlp2_gpu6&#45;&gt;layer_3_mlp_allreduce -->
<g id="edge270" class="edge">
<title>layer_3_mlp2_gpu6&#45;&gt;layer_3_mlp_allreduce</title>
<path fill="none" stroke="black" d="M2618.07,-5105.01C2621.08,-5104.08 2624.07,-5103.19 2627,-5102.36 2694.42,-5083.27 2772.18,-5066.89 2829.89,-5055.79"/>
<polygon fill="black" stroke="black" points="2830.9,-5059.16 2840.06,-5053.85 2829.58,-5052.28 2830.9,-5059.16"/>
</g>
<!-- layer_3_mlp2_gpu7&#45;&gt;layer_3_mlp_allreduce -->
<g id="edge274" class="edge">
<title>layer_3_mlp2_gpu7&#45;&gt;layer_3_mlp_allreduce</title>
<path fill="none" stroke="black" d="M2474,-5104.75C2477.03,-5103.89 2480.04,-5103.09 2483,-5102.36 2597.41,-5074.2 2732.23,-5057.43 2820.44,-5048.59"/>
<polygon fill="black" stroke="black" points="2820.82,-5052.07 2830.43,-5047.61 2820.14,-5045.11 2820.82,-5052.07"/>
</g>
<!-- layer_3_residual2 -->
<g id="node220" class="node">
<title>layer_3_residual2</title>
<polygon fill="lightyellow" stroke="black" points="3043.61,-4976.62 2839.02,-4976.62 2786.39,-4900.62 2990.98,-4900.62 3043.61,-4976.62"/>
<text text-anchor="middle" x="2915" y="-4942.42" font-family="Times,serif" font-size="14.00">Residual Add 3</text>
<text text-anchor="middle" x="2915" y="-4927.42" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_3_mlp_allreduce&#45;&gt;layer_3_residual2 -->
<g id="edge275" class="edge">
<title>layer_3_mlp_allreduce&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M2915,-5012.51C2915,-5004.7 2915,-4995.87 2915,-4987.12"/>
<polygon fill="black" stroke="black" points="2918.5,-4986.95 2915,-4976.95 2911.5,-4986.95 2918.5,-4986.95"/>
</g>
<!-- layer_3_ln2 -->
<g id="node221" class="node">
<title>layer_3_ln2</title>
<polygon fill="lightblue" stroke="black" points="2970.5,-4864.62 2859.5,-4864.62 2859.5,-4826.62 2970.5,-4826.62 2970.5,-4864.62"/>
<text text-anchor="middle" x="2915" y="-4849.42" font-family="Times,serif" font-size="14.00">LayerNorm 3</text>
<text text-anchor="middle" x="2915" y="-4834.42" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_3_residual2&#45;&gt;layer_3_ln2 -->
<g id="edge276" class="edge">
<title>layer_3_residual2&#45;&gt;layer_3_ln2</title>
<path fill="none" stroke="black" d="M2915,-4900.61C2915,-4891.99 2915,-4882.94 2915,-4874.78"/>
<polygon fill="black" stroke="black" points="2918.5,-4874.65 2915,-4864.65 2911.5,-4874.65 2918.5,-4874.65"/>
</g>
<!-- layer_4_qkv_gpu0 -->
<g id="node222" class="node">
<title>layer_4_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2979,-4787.62 2851,-4787.62 2851,-4734.62 2979,-4734.62 2979,-4787.62"/>
<text text-anchor="middle" x="2915" y="-4772.42" font-family="Times,serif" font-size="14.00">QKV Proj GPU0</text>
<text text-anchor="middle" x="2915" y="-4757.42" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2915" y="-4742.42" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_3_ln2&#45;&gt;layer_4_qkv_gpu0 -->
<g id="edge277" class="edge">
<title>layer_3_ln2&#45;&gt;layer_4_qkv_gpu0</title>
<path fill="none" stroke="black" d="M2915,-4826.31C2915,-4818.02 2915,-4807.9 2915,-4798.18"/>
<polygon fill="black" stroke="black" points="2918.5,-4797.89 2915,-4787.89 2911.5,-4797.89 2918.5,-4797.89"/>
</g>
<!-- layer_4_qkv_comm -->
<g id="node230" class="node">
<title>layer_4_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="2404" cy="-4671.75" rx="85.62" ry="26.74"/>
<text text-anchor="middle" x="2404" y="-4675.55" font-family="Times,serif" font-size="14.00">QKV AllGather</text>
<text text-anchor="middle" x="2404" y="-4660.55" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_4_qkv_gpu0&#45;&gt;layer_4_qkv_comm -->
<g id="edge278" class="edge">
<title>layer_4_qkv_gpu0&#45;&gt;layer_4_qkv_comm</title>
<path fill="none" stroke="black" d="M2850.72,-4736.9C2847.79,-4736.08 2844.87,-4735.32 2842,-4734.62 2724.33,-4706.05 2585.46,-4689.2 2496.13,-4680.48"/>
<polygon fill="black" stroke="black" points="2496.32,-4676.98 2486.03,-4679.5 2495.65,-4683.95 2496.32,-4676.98"/>
</g>
<!-- layer_4_qkv_gpu1 -->
<g id="node223" class="node">
<title>layer_4_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2833,-4787.62 2705,-4787.62 2705,-4734.62 2833,-4734.62 2833,-4787.62"/>
<text text-anchor="middle" x="2769" y="-4772.42" font-family="Times,serif" font-size="14.00">QKV Proj GPU1</text>
<text text-anchor="middle" x="2769" y="-4757.42" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2769" y="-4742.42" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_4_qkv_gpu1&#45;&gt;layer_4_qkv_comm -->
<g id="edge279" class="edge">
<title>layer_4_qkv_gpu1&#45;&gt;layer_4_qkv_comm</title>
<path fill="none" stroke="black" d="M2704.65,-4737.15C2701.74,-4736.26 2698.84,-4735.42 2696,-4734.62 2626.53,-4715.21 2546.28,-4698.62 2487.5,-4687.52"/>
<polygon fill="black" stroke="black" points="2488,-4684.05 2477.53,-4685.65 2486.71,-4690.93 2488,-4684.05"/>
</g>
<!-- layer_4_qkv_gpu2 -->
<g id="node224" class="node">
<title>layer_4_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2687,-4787.62 2559,-4787.62 2559,-4734.62 2687,-4734.62 2687,-4787.62"/>
<text text-anchor="middle" x="2623" y="-4772.42" font-family="Times,serif" font-size="14.00">QKV Proj GPU2</text>
<text text-anchor="middle" x="2623" y="-4757.42" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2623" y="-4742.42" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_4_qkv_gpu2&#45;&gt;layer_4_qkv_comm -->
<g id="edge280" class="edge">
<title>layer_4_qkv_gpu2&#45;&gt;layer_4_qkv_comm</title>
<path fill="none" stroke="black" d="M2559.07,-4734.62C2529.33,-4722.75 2494.14,-4708.71 2464.81,-4697.01"/>
<polygon fill="black" stroke="black" points="2466.09,-4693.75 2455.5,-4693.3 2463.5,-4700.26 2466.09,-4693.75"/>
</g>
<!-- layer_4_qkv_gpu3 -->
<g id="node225" class="node">
<title>layer_4_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2541,-4787.62 2413,-4787.62 2413,-4734.62 2541,-4734.62 2541,-4787.62"/>
<text text-anchor="middle" x="2477" y="-4772.42" font-family="Times,serif" font-size="14.00">QKV Proj GPU3</text>
<text text-anchor="middle" x="2477" y="-4757.42" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2477" y="-4742.42" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_4_qkv_gpu3&#45;&gt;layer_4_qkv_comm -->
<g id="edge281" class="edge">
<title>layer_4_qkv_gpu3&#45;&gt;layer_4_qkv_comm</title>
<path fill="none" stroke="black" d="M2455.49,-4734.38C2448,-4725.41 2439.49,-4715.23 2431.58,-4705.75"/>
<polygon fill="black" stroke="black" points="2434.2,-4703.44 2425.1,-4698.01 2428.83,-4707.93 2434.2,-4703.44"/>
</g>
<!-- layer_4_qkv_gpu4 -->
<g id="node226" class="node">
<title>layer_4_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2395,-4787.62 2267,-4787.62 2267,-4734.62 2395,-4734.62 2395,-4787.62"/>
<text text-anchor="middle" x="2331" y="-4772.42" font-family="Times,serif" font-size="14.00">QKV Proj GPU4</text>
<text text-anchor="middle" x="2331" y="-4757.42" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2331" y="-4742.42" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_4_qkv_gpu4&#45;&gt;layer_4_qkv_comm -->
<g id="edge282" class="edge">
<title>layer_4_qkv_gpu4&#45;&gt;layer_4_qkv_comm</title>
<path fill="none" stroke="black" d="M2352.51,-4734.38C2360,-4725.41 2368.51,-4715.23 2376.42,-4705.75"/>
<polygon fill="black" stroke="black" points="2379.17,-4707.93 2382.9,-4698.01 2373.8,-4703.44 2379.17,-4707.93"/>
</g>
<!-- layer_4_qkv_gpu5 -->
<g id="node227" class="node">
<title>layer_4_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2249,-4787.62 2121,-4787.62 2121,-4734.62 2249,-4734.62 2249,-4787.62"/>
<text text-anchor="middle" x="2185" y="-4772.42" font-family="Times,serif" font-size="14.00">QKV Proj GPU5</text>
<text text-anchor="middle" x="2185" y="-4757.42" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2185" y="-4742.42" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_4_qkv_gpu5&#45;&gt;layer_4_qkv_comm -->
<g id="edge283" class="edge">
<title>layer_4_qkv_gpu5&#45;&gt;layer_4_qkv_comm</title>
<path fill="none" stroke="black" d="M2248.93,-4734.62C2278.67,-4722.75 2313.86,-4708.71 2343.19,-4697.01"/>
<polygon fill="black" stroke="black" points="2344.5,-4700.26 2352.5,-4693.3 2341.91,-4693.75 2344.5,-4700.26"/>
</g>
<!-- layer_4_qkv_gpu6 -->
<g id="node228" class="node">
<title>layer_4_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2103,-4787.62 1975,-4787.62 1975,-4734.62 2103,-4734.62 2103,-4787.62"/>
<text text-anchor="middle" x="2039" y="-4772.42" font-family="Times,serif" font-size="14.00">QKV Proj GPU6</text>
<text text-anchor="middle" x="2039" y="-4757.42" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2039" y="-4742.42" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_4_qkv_gpu6&#45;&gt;layer_4_qkv_comm -->
<g id="edge284" class="edge">
<title>layer_4_qkv_gpu6&#45;&gt;layer_4_qkv_comm</title>
<path fill="none" stroke="black" d="M2103.35,-4737.15C2106.26,-4736.26 2109.16,-4735.42 2112,-4734.62 2181.47,-4715.21 2261.72,-4698.62 2320.5,-4687.52"/>
<polygon fill="black" stroke="black" points="2321.29,-4690.93 2330.47,-4685.65 2320,-4684.05 2321.29,-4690.93"/>
</g>
<!-- layer_4_qkv_gpu7 -->
<g id="node229" class="node">
<title>layer_4_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1957,-4787.62 1829,-4787.62 1829,-4734.62 1957,-4734.62 1957,-4787.62"/>
<text text-anchor="middle" x="1893" y="-4772.42" font-family="Times,serif" font-size="14.00">QKV Proj GPU7</text>
<text text-anchor="middle" x="1893" y="-4757.42" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1893" y="-4742.42" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_4_qkv_gpu7&#45;&gt;layer_4_qkv_comm -->
<g id="edge285" class="edge">
<title>layer_4_qkv_gpu7&#45;&gt;layer_4_qkv_comm</title>
<path fill="none" stroke="black" d="M1957.28,-4736.9C1960.21,-4736.08 1963.13,-4735.32 1966,-4734.62 2083.67,-4706.05 2222.54,-4689.2 2311.87,-4680.48"/>
<polygon fill="black" stroke="black" points="2312.35,-4683.95 2321.97,-4679.5 2311.68,-4676.98 2312.35,-4683.95"/>
</g>
<!-- layer_4_attn_comp_gpu0 -->
<g id="node231" class="node">
<title>layer_4_attn_comp_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1747,-4608.88 1549,-4608.88 1549,-4555.88 1747,-4555.88 1747,-4608.88"/>
<text text-anchor="middle" x="1648" y="-4593.68" font-family="Times,serif" font-size="14.00">Attention Compute GPU0</text>
<text text-anchor="middle" x="1648" y="-4578.68" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="1648" y="-4563.68" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_4_qkv_comm&#45;&gt;layer_4_attn_comp_gpu0 -->
<g id="edge286" class="edge">
<title>layer_4_qkv_comm&#45;&gt;layer_4_attn_comp_gpu0</title>
<path fill="none" stroke="black" d="M2319.9,-4666.4C2197.86,-4659.27 1964.52,-4642.57 1757.22,-4608.99"/>
<polygon fill="black" stroke="black" points="1757.49,-4605.49 1747.06,-4607.33 1756.36,-4612.39 1757.49,-4605.49"/>
</g>
<!-- layer_4_attn_comp_gpu1 -->
<g id="node232" class="node">
<title>layer_4_attn_comp_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1963,-4608.88 1765,-4608.88 1765,-4555.88 1963,-4555.88 1963,-4608.88"/>
<text text-anchor="middle" x="1864" y="-4593.68" font-family="Times,serif" font-size="14.00">Attention Compute GPU1</text>
<text text-anchor="middle" x="1864" y="-4578.68" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="1864" y="-4563.68" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_4_qkv_comm&#45;&gt;layer_4_attn_comp_gpu1 -->
<g id="edge287" class="edge">
<title>layer_4_qkv_comm&#45;&gt;layer_4_attn_comp_gpu1</title>
<path fill="none" stroke="black" d="M2324.42,-4661.52C2239.69,-4651.21 2101.51,-4632.98 1973.11,-4609.03"/>
<polygon fill="black" stroke="black" points="1973.57,-4605.55 1963.09,-4607.14 1972.27,-4612.43 1973.57,-4605.55"/>
</g>
<!-- layer_4_attn_comp_gpu2 -->
<g id="node233" class="node">
<title>layer_4_attn_comp_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2179,-4608.88 1981,-4608.88 1981,-4555.88 2179,-4555.88 2179,-4608.88"/>
<text text-anchor="middle" x="2080" y="-4593.68" font-family="Times,serif" font-size="14.00">Attention Compute GPU2</text>
<text text-anchor="middle" x="2080" y="-4578.68" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="2080" y="-4563.68" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_4_qkv_comm&#45;&gt;layer_4_attn_comp_gpu2 -->
<g id="edge288" class="edge">
<title>layer_4_qkv_comm&#45;&gt;layer_4_attn_comp_gpu2</title>
<path fill="none" stroke="black" d="M2340.37,-4653.59C2296.05,-4641.64 2235.92,-4625.43 2184.61,-4611.59"/>
<polygon fill="black" stroke="black" points="2185.37,-4608.17 2174.8,-4608.95 2183.55,-4614.93 2185.37,-4608.17"/>
</g>
<!-- layer_4_attn_comp_gpu3 -->
<g id="node234" class="node">
<title>layer_4_attn_comp_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2395,-4608.88 2197,-4608.88 2197,-4555.88 2395,-4555.88 2395,-4608.88"/>
<text text-anchor="middle" x="2296" y="-4593.68" font-family="Times,serif" font-size="14.00">Attention Compute GPU3</text>
<text text-anchor="middle" x="2296" y="-4578.68" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="2296" y="-4563.68" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_4_qkv_comm&#45;&gt;layer_4_attn_comp_gpu3 -->
<g id="edge289" class="edge">
<title>layer_4_qkv_comm&#45;&gt;layer_4_attn_comp_gpu3</title>
<path fill="none" stroke="black" d="M2373.92,-4646.41C2362.14,-4636.89 2348.46,-4625.82 2335.88,-4615.65"/>
<polygon fill="black" stroke="black" points="2337.78,-4612.68 2327.81,-4609.11 2333.38,-4618.12 2337.78,-4612.68"/>
</g>
<!-- layer_4_attn_comp_gpu4 -->
<g id="node235" class="node">
<title>layer_4_attn_comp_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2611,-4608.88 2413,-4608.88 2413,-4555.88 2611,-4555.88 2611,-4608.88"/>
<text text-anchor="middle" x="2512" y="-4593.68" font-family="Times,serif" font-size="14.00">Attention Compute GPU4</text>
<text text-anchor="middle" x="2512" y="-4578.68" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="2512" y="-4563.68" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_4_qkv_comm&#45;&gt;layer_4_attn_comp_gpu4 -->
<g id="edge290" class="edge">
<title>layer_4_qkv_comm&#45;&gt;layer_4_attn_comp_gpu4</title>
<path fill="none" stroke="black" d="M2434.08,-4646.41C2445.86,-4636.89 2459.54,-4625.82 2472.12,-4615.65"/>
<polygon fill="black" stroke="black" points="2474.62,-4618.12 2480.19,-4609.11 2470.22,-4612.68 2474.62,-4618.12"/>
</g>
<!-- layer_4_attn_comp_gpu5 -->
<g id="node236" class="node">
<title>layer_4_attn_comp_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2827,-4608.88 2629,-4608.88 2629,-4555.88 2827,-4555.88 2827,-4608.88"/>
<text text-anchor="middle" x="2728" y="-4593.68" font-family="Times,serif" font-size="14.00">Attention Compute GPU5</text>
<text text-anchor="middle" x="2728" y="-4578.68" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="2728" y="-4563.68" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_4_qkv_comm&#45;&gt;layer_4_attn_comp_gpu5 -->
<g id="edge291" class="edge">
<title>layer_4_qkv_comm&#45;&gt;layer_4_attn_comp_gpu5</title>
<path fill="none" stroke="black" d="M2467.63,-4653.59C2511.95,-4641.64 2572.08,-4625.43 2623.39,-4611.59"/>
<polygon fill="black" stroke="black" points="2624.45,-4614.93 2633.2,-4608.95 2622.63,-4608.17 2624.45,-4614.93"/>
</g>
<!-- layer_4_attn_comp_gpu6 -->
<g id="node237" class="node">
<title>layer_4_attn_comp_gpu6</title>
<polygon fill="lightblue" stroke="black" points="3043,-4608.88 2845,-4608.88 2845,-4555.88 3043,-4555.88 3043,-4608.88"/>
<text text-anchor="middle" x="2944" y="-4593.68" font-family="Times,serif" font-size="14.00">Attention Compute GPU6</text>
<text text-anchor="middle" x="2944" y="-4578.68" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="2944" y="-4563.68" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_4_qkv_comm&#45;&gt;layer_4_attn_comp_gpu6 -->
<g id="edge292" class="edge">
<title>layer_4_qkv_comm&#45;&gt;layer_4_attn_comp_gpu6</title>
<path fill="none" stroke="black" d="M2483.58,-4661.52C2568.31,-4651.21 2706.49,-4632.98 2834.89,-4609.03"/>
<polygon fill="black" stroke="black" points="2835.73,-4612.43 2844.91,-4607.14 2834.43,-4605.55 2835.73,-4612.43"/>
</g>
<!-- layer_4_attn_comp_gpu7 -->
<g id="node238" class="node">
<title>layer_4_attn_comp_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3259,-4608.88 3061,-4608.88 3061,-4555.88 3259,-4555.88 3259,-4608.88"/>
<text text-anchor="middle" x="3160" y="-4593.68" font-family="Times,serif" font-size="14.00">Attention Compute GPU7</text>
<text text-anchor="middle" x="3160" y="-4578.68" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="3160" y="-4563.68" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_4_qkv_comm&#45;&gt;layer_4_attn_comp_gpu7 -->
<g id="edge293" class="edge">
<title>layer_4_qkv_comm&#45;&gt;layer_4_attn_comp_gpu7</title>
<path fill="none" stroke="black" d="M2488.1,-4666.4C2610.14,-4659.27 2843.48,-4642.57 3050.78,-4608.99"/>
<polygon fill="black" stroke="black" points="3051.64,-4612.39 3060.94,-4607.33 3050.51,-4605.49 3051.64,-4612.39"/>
</g>
<!-- layer_4_attn_out_gpu0 -->
<g id="node239" class="node">
<title>layer_4_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1772,-4519.88 1614,-4519.88 1614,-4466.88 1772,-4466.88 1772,-4519.88"/>
<text text-anchor="middle" x="1693" y="-4504.68" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU0</text>
<text text-anchor="middle" x="1693" y="-4489.68" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1693" y="-4474.68" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_4_attn_comp_gpu0&#45;&gt;layer_4_attn_out_gpu0 -->
<g id="edge294" class="edge">
<title>layer_4_attn_comp_gpu0&#45;&gt;layer_4_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M1661.26,-4555.75C1665.57,-4547.42 1670.43,-4538.02 1675.02,-4529.14"/>
<polygon fill="black" stroke="black" points="1678.2,-4530.62 1679.68,-4520.13 1671.98,-4527.41 1678.2,-4530.62"/>
</g>
<!-- layer_4_attn_out_gpu1 -->
<g id="node240" class="node">
<title>layer_4_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1968,-4519.88 1810,-4519.88 1810,-4466.88 1968,-4466.88 1968,-4519.88"/>
<text text-anchor="middle" x="1889" y="-4504.68" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU1</text>
<text text-anchor="middle" x="1889" y="-4489.68" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1889" y="-4474.68" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_4_attn_comp_gpu1&#45;&gt;layer_4_attn_out_gpu1 -->
<g id="edge295" class="edge">
<title>layer_4_attn_comp_gpu1&#45;&gt;layer_4_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M1871.37,-4555.75C1873.68,-4547.68 1876.29,-4538.62 1878.77,-4529.98"/>
<polygon fill="black" stroke="black" points="1882.2,-4530.71 1881.6,-4520.13 1875.47,-4528.78 1882.2,-4530.71"/>
</g>
<!-- layer_4_attn_out_gpu2 -->
<g id="node241" class="node">
<title>layer_4_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2169,-4519.88 2011,-4519.88 2011,-4466.88 2169,-4466.88 2169,-4519.88"/>
<text text-anchor="middle" x="2090" y="-4504.68" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU2</text>
<text text-anchor="middle" x="2090" y="-4489.68" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2090" y="-4474.68" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_4_attn_comp_gpu2&#45;&gt;layer_4_attn_out_gpu2 -->
<g id="edge296" class="edge">
<title>layer_4_attn_comp_gpu2&#45;&gt;layer_4_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M2082.95,-4555.75C2083.86,-4547.77 2084.89,-4538.81 2085.88,-4530.26"/>
<polygon fill="black" stroke="black" points="2089.38,-4530.47 2087.04,-4520.13 2082.42,-4529.67 2089.38,-4530.47"/>
</g>
<!-- layer_4_attn_out_gpu3 -->
<g id="node242" class="node">
<title>layer_4_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2385,-4519.88 2227,-4519.88 2227,-4466.88 2385,-4466.88 2385,-4519.88"/>
<text text-anchor="middle" x="2306" y="-4504.68" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU3</text>
<text text-anchor="middle" x="2306" y="-4489.68" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2306" y="-4474.68" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_4_attn_comp_gpu3&#45;&gt;layer_4_attn_out_gpu3 -->
<g id="edge297" class="edge">
<title>layer_4_attn_comp_gpu3&#45;&gt;layer_4_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M2298.95,-4555.75C2299.86,-4547.77 2300.89,-4538.81 2301.88,-4530.26"/>
<polygon fill="black" stroke="black" points="2305.38,-4530.47 2303.04,-4520.13 2298.42,-4529.67 2305.38,-4530.47"/>
</g>
<!-- layer_4_attn_out_gpu4 -->
<g id="node243" class="node">
<title>layer_4_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2581,-4519.88 2423,-4519.88 2423,-4466.88 2581,-4466.88 2581,-4519.88"/>
<text text-anchor="middle" x="2502" y="-4504.68" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU4</text>
<text text-anchor="middle" x="2502" y="-4489.68" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2502" y="-4474.68" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_4_attn_comp_gpu4&#45;&gt;layer_4_attn_out_gpu4 -->
<g id="edge298" class="edge">
<title>layer_4_attn_comp_gpu4&#45;&gt;layer_4_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M2509.05,-4555.75C2508.14,-4547.77 2507.11,-4538.81 2506.12,-4530.26"/>
<polygon fill="black" stroke="black" points="2509.58,-4529.67 2504.96,-4520.13 2502.62,-4530.47 2509.58,-4529.67"/>
</g>
<!-- layer_4_attn_out_gpu5 -->
<g id="node244" class="node">
<title>layer_4_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2777,-4519.88 2619,-4519.88 2619,-4466.88 2777,-4466.88 2777,-4519.88"/>
<text text-anchor="middle" x="2698" y="-4504.68" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU5</text>
<text text-anchor="middle" x="2698" y="-4489.68" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2698" y="-4474.68" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_4_attn_comp_gpu5&#45;&gt;layer_4_attn_out_gpu5 -->
<g id="edge299" class="edge">
<title>layer_4_attn_comp_gpu5&#45;&gt;layer_4_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M2719.16,-4555.75C2716.35,-4547.59 2713.19,-4538.42 2710.18,-4529.7"/>
<polygon fill="black" stroke="black" points="2713.45,-4528.44 2706.88,-4520.13 2706.83,-4530.73 2713.45,-4528.44"/>
</g>
<!-- layer_4_attn_out_gpu6 -->
<g id="node245" class="node">
<title>layer_4_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2983,-4519.88 2825,-4519.88 2825,-4466.88 2983,-4466.88 2983,-4519.88"/>
<text text-anchor="middle" x="2904" y="-4504.68" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU6</text>
<text text-anchor="middle" x="2904" y="-4489.68" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2904" y="-4474.68" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_4_attn_comp_gpu6&#45;&gt;layer_4_attn_out_gpu6 -->
<g id="edge300" class="edge">
<title>layer_4_attn_comp_gpu6&#45;&gt;layer_4_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M2932.22,-4555.75C2928.42,-4547.5 2924.16,-4538.22 2920.11,-4529.42"/>
<polygon fill="black" stroke="black" points="2923.2,-4527.75 2915.84,-4520.13 2916.84,-4530.68 2923.2,-4527.75"/>
</g>
<!-- layer_4_attn_out_gpu7 -->
<g id="node246" class="node">
<title>layer_4_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3194,-4519.88 3036,-4519.88 3036,-4466.88 3194,-4466.88 3194,-4519.88"/>
<text text-anchor="middle" x="3115" y="-4504.68" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU7</text>
<text text-anchor="middle" x="3115" y="-4489.68" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3115" y="-4474.68" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_4_attn_comp_gpu7&#45;&gt;layer_4_attn_out_gpu7 -->
<g id="edge301" class="edge">
<title>layer_4_attn_comp_gpu7&#45;&gt;layer_4_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M3146.74,-4555.75C3142.43,-4547.42 3137.57,-4538.02 3132.98,-4529.14"/>
<polygon fill="black" stroke="black" points="3136.02,-4527.41 3128.32,-4520.13 3129.8,-4530.62 3136.02,-4527.41"/>
</g>
<!-- layer_4_attn_allreduce -->
<g id="node247" class="node">
<title>layer_4_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2404" cy="-4404.01" rx="112.36" ry="26.74"/>
<text text-anchor="middle" x="2404" y="-4407.81" font-family="Times,serif" font-size="14.00">Attention AllReduce</text>
<text text-anchor="middle" x="2404" y="-4392.81" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_4_attn_out_gpu0&#45;&gt;layer_4_attn_allreduce -->
<g id="edge302" class="edge">
<title>layer_4_attn_out_gpu0&#45;&gt;layer_4_attn_allreduce</title>
<path fill="none" stroke="black" d="M1772.09,-4472.47C1781.79,-4470.39 1791.6,-4468.47 1801,-4466.88 1968.43,-4438.65 2164.32,-4421.43 2286.31,-4412.55"/>
<polygon fill="black" stroke="black" points="2286.69,-4416.03 2296.42,-4411.82 2286.19,-4409.05 2286.69,-4416.03"/>
</g>
<!-- layer_4_attn_out_gpu1&#45;&gt;layer_4_attn_allreduce -->
<g id="edge303" class="edge">
<title>layer_4_attn_out_gpu1&#45;&gt;layer_4_attn_allreduce</title>
<path fill="none" stroke="black" d="M1968.19,-4473.78C1979.51,-4471.34 1991.03,-4468.96 2002,-4466.88 2101.63,-4448 2215.99,-4430.83 2297.19,-4419.4"/>
<polygon fill="black" stroke="black" points="2298.01,-4422.82 2307.43,-4417.96 2297.04,-4415.88 2298.01,-4422.82"/>
</g>
<!-- layer_4_attn_out_gpu2&#45;&gt;layer_4_attn_allreduce -->
<g id="edge304" class="edge">
<title>layer_4_attn_out_gpu2&#45;&gt;layer_4_attn_allreduce</title>
<path fill="none" stroke="black" d="M2169.24,-4470.33C2216.13,-4457.28 2275.42,-4440.79 2322.68,-4427.64"/>
<polygon fill="black" stroke="black" points="2323.87,-4430.94 2332.57,-4424.89 2322,-4424.2 2323.87,-4430.94"/>
</g>
<!-- layer_4_attn_out_gpu3&#45;&gt;layer_4_attn_allreduce -->
<g id="edge305" class="edge">
<title>layer_4_attn_out_gpu3&#45;&gt;layer_4_attn_allreduce</title>
<path fill="none" stroke="black" d="M2334.61,-4466.88C2345.17,-4457.46 2357.26,-4446.68 2368.37,-4436.78"/>
<polygon fill="black" stroke="black" points="2370.73,-4439.36 2375.86,-4430.1 2366.07,-4434.14 2370.73,-4439.36"/>
</g>
<!-- layer_4_attn_out_gpu4&#45;&gt;layer_4_attn_allreduce -->
<g id="edge306" class="edge">
<title>layer_4_attn_out_gpu4&#45;&gt;layer_4_attn_allreduce</title>
<path fill="none" stroke="black" d="M2473.39,-4466.88C2462.83,-4457.46 2450.74,-4446.68 2439.63,-4436.78"/>
<polygon fill="black" stroke="black" points="2441.93,-4434.14 2432.14,-4430.1 2437.27,-4439.36 2441.93,-4434.14"/>
</g>
<!-- layer_4_attn_out_gpu5&#45;&gt;layer_4_attn_allreduce -->
<g id="edge307" class="edge">
<title>layer_4_attn_out_gpu5&#45;&gt;layer_4_attn_allreduce</title>
<path fill="none" stroke="black" d="M2618.83,-4468.85C2576.54,-4456.29 2524.66,-4440.87 2482.48,-4428.33"/>
<polygon fill="black" stroke="black" points="2483.39,-4424.95 2472.81,-4425.46 2481.4,-4431.66 2483.39,-4424.95"/>
</g>
<!-- layer_4_attn_out_gpu6&#45;&gt;layer_4_attn_allreduce -->
<g id="edge308" class="edge">
<title>layer_4_attn_out_gpu6&#45;&gt;layer_4_attn_allreduce</title>
<path fill="none" stroke="black" d="M2824.77,-4474.67C2811.84,-4471.94 2798.56,-4469.25 2786,-4466.88 2692.34,-4449.19 2585.16,-4432.1 2508.22,-4420.39"/>
<polygon fill="black" stroke="black" points="2508.45,-4416.88 2498.04,-4418.84 2507.4,-4423.8 2508.45,-4416.88"/>
</g>
<!-- layer_4_attn_out_gpu7&#45;&gt;layer_4_attn_allreduce -->
<g id="edge309" class="edge">
<title>layer_4_attn_out_gpu7&#45;&gt;layer_4_attn_allreduce</title>
<path fill="none" stroke="black" d="M3035.81,-4474.76C3021.29,-4471.87 3006.22,-4469.1 2992,-4466.88 2829.15,-4441.5 2639.26,-4423.62 2520.32,-4413.81"/>
<polygon fill="black" stroke="black" points="2520.35,-4410.3 2510.1,-4412.98 2519.78,-4417.28 2520.35,-4410.3"/>
</g>
<!-- layer_4_residual1 -->
<g id="node248" class="node">
<title>layer_4_residual1</title>
<polygon fill="lightyellow" stroke="black" points="2532.61,-4341.14 2328.02,-4341.14 2275.39,-4265.14 2479.98,-4265.14 2532.61,-4341.14"/>
<text text-anchor="middle" x="2404" y="-4306.94" font-family="Times,serif" font-size="14.00">Residual Add 4</text>
<text text-anchor="middle" x="2404" y="-4291.94" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_4_attn_allreduce&#45;&gt;layer_4_residual1 -->
<g id="edge310" class="edge">
<title>layer_4_attn_allreduce&#45;&gt;layer_4_residual1</title>
<path fill="none" stroke="black" d="M2404,-4377.03C2404,-4369.22 2404,-4360.39 2404,-4351.64"/>
<polygon fill="black" stroke="black" points="2407.5,-4351.47 2404,-4341.47 2400.5,-4351.47 2407.5,-4351.47"/>
</g>
<!-- layer_4_ln1 -->
<g id="node249" class="node">
<title>layer_4_ln1</title>
<polygon fill="lightblue" stroke="black" points="2459.5,-4229.14 2348.5,-4229.14 2348.5,-4191.14 2459.5,-4191.14 2459.5,-4229.14"/>
<text text-anchor="middle" x="2404" y="-4213.94" font-family="Times,serif" font-size="14.00">LayerNorm 4</text>
<text text-anchor="middle" x="2404" y="-4198.94" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_4_residual1&#45;&gt;layer_4_ln1 -->
<g id="edge311" class="edge">
<title>layer_4_residual1&#45;&gt;layer_4_ln1</title>
<path fill="none" stroke="black" d="M2404,-4265.13C2404,-4256.51 2404,-4247.46 2404,-4239.3"/>
<polygon fill="black" stroke="black" points="2407.5,-4239.17 2404,-4229.17 2400.5,-4239.17 2407.5,-4239.17"/>
</g>
<!-- layer_4_mlp1_gpu0 -->
<g id="node250" class="node">
<title>layer_4_mlp1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2971,-4152.14 2845,-4152.14 2845,-4099.14 2971,-4099.14 2971,-4152.14"/>
<text text-anchor="middle" x="2908" y="-4136.94" font-family="Times,serif" font-size="14.00">MLP1 GPU0</text>
<text text-anchor="middle" x="2908" y="-4121.94" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2908" y="-4106.94" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp1_gpu0 -->
<g id="edge312" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp1_gpu0</title>
<path fill="none" stroke="black" d="M2459.64,-4209.88C2560.37,-4210.55 2768.74,-4208.67 2836,-4183.14 2850.24,-4177.74 2863.92,-4168.45 2875.45,-4158.96"/>
<polygon fill="black" stroke="black" points="2877.78,-4161.57 2883.07,-4152.4 2873.21,-4156.27 2877.78,-4161.57"/>
</g>
<!-- layer_4_mlp1_gpu1 -->
<g id="node251" class="node">
<title>layer_4_mlp1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2827,-4152.14 2701,-4152.14 2701,-4099.14 2827,-4099.14 2827,-4152.14"/>
<text text-anchor="middle" x="2764" y="-4136.94" font-family="Times,serif" font-size="14.00">MLP1 GPU1</text>
<text text-anchor="middle" x="2764" y="-4121.94" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2764" y="-4106.94" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp1_gpu1 -->
<g id="edge316" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp1_gpu1</title>
<path fill="none" stroke="black" d="M2459.68,-4207.85C2531.24,-4205.56 2651.11,-4199.36 2692,-4183.14 2706.16,-4177.52 2719.81,-4168.19 2731.35,-4158.71"/>
<polygon fill="black" stroke="black" points="2733.67,-4161.33 2738.98,-4152.17 2729.11,-4156.02 2733.67,-4161.33"/>
</g>
<!-- layer_4_mlp1_gpu2 -->
<g id="node252" class="node">
<title>layer_4_mlp1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2683,-4152.14 2557,-4152.14 2557,-4099.14 2683,-4099.14 2683,-4152.14"/>
<text text-anchor="middle" x="2620" y="-4136.94" font-family="Times,serif" font-size="14.00">MLP1 GPU2</text>
<text text-anchor="middle" x="2620" y="-4121.94" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2620" y="-4106.94" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp1_gpu2 -->
<g id="edge320" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp1_gpu2</title>
<path fill="none" stroke="black" d="M2459.54,-4205.45C2487.09,-4202.07 2520.31,-4195.58 2548,-4183.14 2561.41,-4177.12 2574.54,-4168.07 2585.83,-4158.96"/>
<polygon fill="black" stroke="black" points="2588.29,-4161.47 2593.71,-4152.37 2583.79,-4156.11 2588.29,-4161.47"/>
</g>
<!-- layer_4_mlp1_gpu3 -->
<g id="node253" class="node">
<title>layer_4_mlp1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2539,-4152.14 2413,-4152.14 2413,-4099.14 2539,-4099.14 2539,-4152.14"/>
<text text-anchor="middle" x="2476" y="-4136.94" font-family="Times,serif" font-size="14.00">MLP1 GPU3</text>
<text text-anchor="middle" x="2476" y="-4121.94" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2476" y="-4106.94" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp1_gpu3 -->
<g id="edge324" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp1_gpu3</title>
<path fill="none" stroke="black" d="M2419.98,-4190.83C2427.84,-4181.83 2437.56,-4170.69 2446.69,-4160.23"/>
<polygon fill="black" stroke="black" points="2449.57,-4162.24 2453.51,-4152.41 2444.3,-4157.64 2449.57,-4162.24"/>
</g>
<!-- layer_4_mlp1_gpu4 -->
<g id="node254" class="node">
<title>layer_4_mlp1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2395,-4152.14 2269,-4152.14 2269,-4099.14 2395,-4099.14 2395,-4152.14"/>
<text text-anchor="middle" x="2332" y="-4136.94" font-family="Times,serif" font-size="14.00">MLP1 GPU4</text>
<text text-anchor="middle" x="2332" y="-4121.94" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2332" y="-4106.94" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp1_gpu4 -->
<g id="edge328" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp1_gpu4</title>
<path fill="none" stroke="black" d="M2388.02,-4190.83C2380.16,-4181.83 2370.44,-4170.69 2361.31,-4160.23"/>
<polygon fill="black" stroke="black" points="2363.7,-4157.64 2354.49,-4152.41 2358.43,-4162.24 2363.7,-4157.64"/>
</g>
<!-- layer_4_mlp1_gpu5 -->
<g id="node255" class="node">
<title>layer_4_mlp1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2251,-4152.14 2125,-4152.14 2125,-4099.14 2251,-4099.14 2251,-4152.14"/>
<text text-anchor="middle" x="2188" y="-4136.94" font-family="Times,serif" font-size="14.00">MLP1 GPU5</text>
<text text-anchor="middle" x="2188" y="-4121.94" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2188" y="-4106.94" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp1_gpu5 -->
<g id="edge332" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp1_gpu5</title>
<path fill="none" stroke="black" d="M2348.46,-4205.45C2320.91,-4202.07 2287.69,-4195.58 2260,-4183.14 2246.59,-4177.12 2233.46,-4168.07 2222.17,-4158.96"/>
<polygon fill="black" stroke="black" points="2224.21,-4156.11 2214.29,-4152.37 2219.71,-4161.47 2224.21,-4156.11"/>
</g>
<!-- layer_4_mlp1_gpu6 -->
<g id="node256" class="node">
<title>layer_4_mlp1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2107,-4152.14 1981,-4152.14 1981,-4099.14 2107,-4099.14 2107,-4152.14"/>
<text text-anchor="middle" x="2044" y="-4136.94" font-family="Times,serif" font-size="14.00">MLP1 GPU6</text>
<text text-anchor="middle" x="2044" y="-4121.94" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2044" y="-4106.94" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp1_gpu6 -->
<g id="edge336" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp1_gpu6</title>
<path fill="none" stroke="black" d="M2348.32,-4207.85C2276.76,-4205.56 2156.89,-4199.36 2116,-4183.14 2101.84,-4177.52 2088.19,-4168.19 2076.65,-4158.71"/>
<polygon fill="black" stroke="black" points="2078.89,-4156.02 2069.02,-4152.17 2074.33,-4161.33 2078.89,-4156.02"/>
</g>
<!-- layer_4_mlp1_gpu7 -->
<g id="node257" class="node">
<title>layer_4_mlp1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1963,-4152.14 1837,-4152.14 1837,-4099.14 1963,-4099.14 1963,-4152.14"/>
<text text-anchor="middle" x="1900" y="-4136.94" font-family="Times,serif" font-size="14.00">MLP1 GPU7</text>
<text text-anchor="middle" x="1900" y="-4121.94" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1900" y="-4106.94" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp1_gpu7 -->
<g id="edge340" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp1_gpu7</title>
<path fill="none" stroke="black" d="M2348.36,-4209.88C2247.63,-4210.55 2039.26,-4208.67 1972,-4183.14 1957.76,-4177.74 1944.08,-4168.45 1932.55,-4158.96"/>
<polygon fill="black" stroke="black" points="1934.79,-4156.27 1924.93,-4152.4 1930.22,-4161.57 1934.79,-4156.27"/>
</g>
<!-- layer_4_gelu_gpu0 -->
<g id="node258" class="node">
<title>layer_4_gelu_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2960,-4063.14 2856,-4063.14 2856,-4025.14 2960,-4025.14 2960,-4063.14"/>
<text text-anchor="middle" x="2908" y="-4047.94" font-family="Times,serif" font-size="14.00">GELU GPU0</text>
<text text-anchor="middle" x="2908" y="-4032.94" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_4_mlp1_gpu0&#45;&gt;layer_4_gelu_gpu0 -->
<g id="edge313" class="edge">
<title>layer_4_mlp1_gpu0&#45;&gt;layer_4_gelu_gpu0</title>
<path fill="none" stroke="black" d="M2908,-4099.05C2908,-4090.88 2908,-4081.79 2908,-4073.44"/>
<polygon fill="black" stroke="black" points="2911.5,-4073.38 2908,-4063.38 2904.5,-4073.38 2911.5,-4073.38"/>
</g>
<!-- layer_4_gelu_gpu1 -->
<g id="node259" class="node">
<title>layer_4_gelu_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2816,-4063.14 2712,-4063.14 2712,-4025.14 2816,-4025.14 2816,-4063.14"/>
<text text-anchor="middle" x="2764" y="-4047.94" font-family="Times,serif" font-size="14.00">GELU GPU1</text>
<text text-anchor="middle" x="2764" y="-4032.94" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_4_mlp1_gpu1&#45;&gt;layer_4_gelu_gpu1 -->
<g id="edge317" class="edge">
<title>layer_4_mlp1_gpu1&#45;&gt;layer_4_gelu_gpu1</title>
<path fill="none" stroke="black" d="M2764,-4099.05C2764,-4090.88 2764,-4081.79 2764,-4073.44"/>
<polygon fill="black" stroke="black" points="2767.5,-4073.38 2764,-4063.38 2760.5,-4073.38 2767.5,-4073.38"/>
</g>
<!-- layer_4_gelu_gpu2 -->
<g id="node260" class="node">
<title>layer_4_gelu_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2672,-4063.14 2568,-4063.14 2568,-4025.14 2672,-4025.14 2672,-4063.14"/>
<text text-anchor="middle" x="2620" y="-4047.94" font-family="Times,serif" font-size="14.00">GELU GPU2</text>
<text text-anchor="middle" x="2620" y="-4032.94" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_4_mlp1_gpu2&#45;&gt;layer_4_gelu_gpu2 -->
<g id="edge321" class="edge">
<title>layer_4_mlp1_gpu2&#45;&gt;layer_4_gelu_gpu2</title>
<path fill="none" stroke="black" d="M2620,-4099.05C2620,-4090.88 2620,-4081.79 2620,-4073.44"/>
<polygon fill="black" stroke="black" points="2623.5,-4073.38 2620,-4063.38 2616.5,-4073.38 2623.5,-4073.38"/>
</g>
<!-- layer_4_gelu_gpu3 -->
<g id="node261" class="node">
<title>layer_4_gelu_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2528,-4063.14 2424,-4063.14 2424,-4025.14 2528,-4025.14 2528,-4063.14"/>
<text text-anchor="middle" x="2476" y="-4047.94" font-family="Times,serif" font-size="14.00">GELU GPU3</text>
<text text-anchor="middle" x="2476" y="-4032.94" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_4_mlp1_gpu3&#45;&gt;layer_4_gelu_gpu3 -->
<g id="edge325" class="edge">
<title>layer_4_mlp1_gpu3&#45;&gt;layer_4_gelu_gpu3</title>
<path fill="none" stroke="black" d="M2476,-4099.05C2476,-4090.88 2476,-4081.79 2476,-4073.44"/>
<polygon fill="black" stroke="black" points="2479.5,-4073.38 2476,-4063.38 2472.5,-4073.38 2479.5,-4073.38"/>
</g>
<!-- layer_4_gelu_gpu4 -->
<g id="node262" class="node">
<title>layer_4_gelu_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2384,-4063.14 2280,-4063.14 2280,-4025.14 2384,-4025.14 2384,-4063.14"/>
<text text-anchor="middle" x="2332" y="-4047.94" font-family="Times,serif" font-size="14.00">GELU GPU4</text>
<text text-anchor="middle" x="2332" y="-4032.94" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_4_mlp1_gpu4&#45;&gt;layer_4_gelu_gpu4 -->
<g id="edge329" class="edge">
<title>layer_4_mlp1_gpu4&#45;&gt;layer_4_gelu_gpu4</title>
<path fill="none" stroke="black" d="M2332,-4099.05C2332,-4090.88 2332,-4081.79 2332,-4073.44"/>
<polygon fill="black" stroke="black" points="2335.5,-4073.38 2332,-4063.38 2328.5,-4073.38 2335.5,-4073.38"/>
</g>
<!-- layer_4_gelu_gpu5 -->
<g id="node263" class="node">
<title>layer_4_gelu_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2240,-4063.14 2136,-4063.14 2136,-4025.14 2240,-4025.14 2240,-4063.14"/>
<text text-anchor="middle" x="2188" y="-4047.94" font-family="Times,serif" font-size="14.00">GELU GPU5</text>
<text text-anchor="middle" x="2188" y="-4032.94" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_4_mlp1_gpu5&#45;&gt;layer_4_gelu_gpu5 -->
<g id="edge333" class="edge">
<title>layer_4_mlp1_gpu5&#45;&gt;layer_4_gelu_gpu5</title>
<path fill="none" stroke="black" d="M2188,-4099.05C2188,-4090.88 2188,-4081.79 2188,-4073.44"/>
<polygon fill="black" stroke="black" points="2191.5,-4073.38 2188,-4063.38 2184.5,-4073.38 2191.5,-4073.38"/>
</g>
<!-- layer_4_gelu_gpu6 -->
<g id="node264" class="node">
<title>layer_4_gelu_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2096,-4063.14 1992,-4063.14 1992,-4025.14 2096,-4025.14 2096,-4063.14"/>
<text text-anchor="middle" x="2044" y="-4047.94" font-family="Times,serif" font-size="14.00">GELU GPU6</text>
<text text-anchor="middle" x="2044" y="-4032.94" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_4_mlp1_gpu6&#45;&gt;layer_4_gelu_gpu6 -->
<g id="edge337" class="edge">
<title>layer_4_mlp1_gpu6&#45;&gt;layer_4_gelu_gpu6</title>
<path fill="none" stroke="black" d="M2044,-4099.05C2044,-4090.88 2044,-4081.79 2044,-4073.44"/>
<polygon fill="black" stroke="black" points="2047.5,-4073.38 2044,-4063.38 2040.5,-4073.38 2047.5,-4073.38"/>
</g>
<!-- layer_4_gelu_gpu7 -->
<g id="node265" class="node">
<title>layer_4_gelu_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1952,-4063.14 1848,-4063.14 1848,-4025.14 1952,-4025.14 1952,-4063.14"/>
<text text-anchor="middle" x="1900" y="-4047.94" font-family="Times,serif" font-size="14.00">GELU GPU7</text>
<text text-anchor="middle" x="1900" y="-4032.94" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_4_mlp1_gpu7&#45;&gt;layer_4_gelu_gpu7 -->
<g id="edge341" class="edge">
<title>layer_4_mlp1_gpu7&#45;&gt;layer_4_gelu_gpu7</title>
<path fill="none" stroke="black" d="M1900,-4099.05C1900,-4090.88 1900,-4081.79 1900,-4073.44"/>
<polygon fill="black" stroke="black" points="1903.5,-4073.38 1900,-4063.38 1896.5,-4073.38 1903.5,-4073.38"/>
</g>
<!-- layer_4_mlp2_gpu0 -->
<g id="node266" class="node">
<title>layer_4_mlp2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2971,-3989.14 2845,-3989.14 2845,-3936.14 2971,-3936.14 2971,-3989.14"/>
<text text-anchor="middle" x="2908" y="-3973.94" font-family="Times,serif" font-size="14.00">MLP2 GPU0</text>
<text text-anchor="middle" x="2908" y="-3958.94" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2908" y="-3943.94" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_4_gelu_gpu0&#45;&gt;layer_4_mlp2_gpu0 -->
<g id="edge314" class="edge">
<title>layer_4_gelu_gpu0&#45;&gt;layer_4_mlp2_gpu0</title>
<path fill="none" stroke="black" d="M2908,-4025.1C2908,-4017.46 2908,-4008.28 2908,-3999.37"/>
<polygon fill="black" stroke="black" points="2911.5,-3999.14 2908,-3989.14 2904.5,-3999.14 2911.5,-3999.14"/>
</g>
<!-- layer_4_mlp2_gpu1 -->
<g id="node267" class="node">
<title>layer_4_mlp2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2827,-3989.14 2701,-3989.14 2701,-3936.14 2827,-3936.14 2827,-3989.14"/>
<text text-anchor="middle" x="2764" y="-3973.94" font-family="Times,serif" font-size="14.00">MLP2 GPU1</text>
<text text-anchor="middle" x="2764" y="-3958.94" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2764" y="-3943.94" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_4_gelu_gpu1&#45;&gt;layer_4_mlp2_gpu1 -->
<g id="edge318" class="edge">
<title>layer_4_gelu_gpu1&#45;&gt;layer_4_mlp2_gpu1</title>
<path fill="none" stroke="black" d="M2764,-4025.1C2764,-4017.46 2764,-4008.28 2764,-3999.37"/>
<polygon fill="black" stroke="black" points="2767.5,-3999.14 2764,-3989.14 2760.5,-3999.14 2767.5,-3999.14"/>
</g>
<!-- layer_4_mlp2_gpu2 -->
<g id="node268" class="node">
<title>layer_4_mlp2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2683,-3989.14 2557,-3989.14 2557,-3936.14 2683,-3936.14 2683,-3989.14"/>
<text text-anchor="middle" x="2620" y="-3973.94" font-family="Times,serif" font-size="14.00">MLP2 GPU2</text>
<text text-anchor="middle" x="2620" y="-3958.94" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2620" y="-3943.94" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_4_gelu_gpu2&#45;&gt;layer_4_mlp2_gpu2 -->
<g id="edge322" class="edge">
<title>layer_4_gelu_gpu2&#45;&gt;layer_4_mlp2_gpu2</title>
<path fill="none" stroke="black" d="M2620,-4025.1C2620,-4017.46 2620,-4008.28 2620,-3999.37"/>
<polygon fill="black" stroke="black" points="2623.5,-3999.14 2620,-3989.14 2616.5,-3999.14 2623.5,-3999.14"/>
</g>
<!-- layer_4_mlp2_gpu3 -->
<g id="node269" class="node">
<title>layer_4_mlp2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2539,-3989.14 2413,-3989.14 2413,-3936.14 2539,-3936.14 2539,-3989.14"/>
<text text-anchor="middle" x="2476" y="-3973.94" font-family="Times,serif" font-size="14.00">MLP2 GPU3</text>
<text text-anchor="middle" x="2476" y="-3958.94" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2476" y="-3943.94" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_4_gelu_gpu3&#45;&gt;layer_4_mlp2_gpu3 -->
<g id="edge326" class="edge">
<title>layer_4_gelu_gpu3&#45;&gt;layer_4_mlp2_gpu3</title>
<path fill="none" stroke="black" d="M2476,-4025.1C2476,-4017.46 2476,-4008.28 2476,-3999.37"/>
<polygon fill="black" stroke="black" points="2479.5,-3999.14 2476,-3989.14 2472.5,-3999.14 2479.5,-3999.14"/>
</g>
<!-- layer_4_mlp2_gpu4 -->
<g id="node270" class="node">
<title>layer_4_mlp2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2395,-3989.14 2269,-3989.14 2269,-3936.14 2395,-3936.14 2395,-3989.14"/>
<text text-anchor="middle" x="2332" y="-3973.94" font-family="Times,serif" font-size="14.00">MLP2 GPU4</text>
<text text-anchor="middle" x="2332" y="-3958.94" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2332" y="-3943.94" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_4_gelu_gpu4&#45;&gt;layer_4_mlp2_gpu4 -->
<g id="edge330" class="edge">
<title>layer_4_gelu_gpu4&#45;&gt;layer_4_mlp2_gpu4</title>
<path fill="none" stroke="black" d="M2332,-4025.1C2332,-4017.46 2332,-4008.28 2332,-3999.37"/>
<polygon fill="black" stroke="black" points="2335.5,-3999.14 2332,-3989.14 2328.5,-3999.14 2335.5,-3999.14"/>
</g>
<!-- layer_4_mlp2_gpu5 -->
<g id="node271" class="node">
<title>layer_4_mlp2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2251,-3989.14 2125,-3989.14 2125,-3936.14 2251,-3936.14 2251,-3989.14"/>
<text text-anchor="middle" x="2188" y="-3973.94" font-family="Times,serif" font-size="14.00">MLP2 GPU5</text>
<text text-anchor="middle" x="2188" y="-3958.94" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2188" y="-3943.94" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_4_gelu_gpu5&#45;&gt;layer_4_mlp2_gpu5 -->
<g id="edge334" class="edge">
<title>layer_4_gelu_gpu5&#45;&gt;layer_4_mlp2_gpu5</title>
<path fill="none" stroke="black" d="M2188,-4025.1C2188,-4017.46 2188,-4008.28 2188,-3999.37"/>
<polygon fill="black" stroke="black" points="2191.5,-3999.14 2188,-3989.14 2184.5,-3999.14 2191.5,-3999.14"/>
</g>
<!-- layer_4_mlp2_gpu6 -->
<g id="node272" class="node">
<title>layer_4_mlp2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2107,-3989.14 1981,-3989.14 1981,-3936.14 2107,-3936.14 2107,-3989.14"/>
<text text-anchor="middle" x="2044" y="-3973.94" font-family="Times,serif" font-size="14.00">MLP2 GPU6</text>
<text text-anchor="middle" x="2044" y="-3958.94" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2044" y="-3943.94" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_4_gelu_gpu6&#45;&gt;layer_4_mlp2_gpu6 -->
<g id="edge338" class="edge">
<title>layer_4_gelu_gpu6&#45;&gt;layer_4_mlp2_gpu6</title>
<path fill="none" stroke="black" d="M2044,-4025.1C2044,-4017.46 2044,-4008.28 2044,-3999.37"/>
<polygon fill="black" stroke="black" points="2047.5,-3999.14 2044,-3989.14 2040.5,-3999.14 2047.5,-3999.14"/>
</g>
<!-- layer_4_mlp2_gpu7 -->
<g id="node273" class="node">
<title>layer_4_mlp2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1963,-3989.14 1837,-3989.14 1837,-3936.14 1963,-3936.14 1963,-3989.14"/>
<text text-anchor="middle" x="1900" y="-3973.94" font-family="Times,serif" font-size="14.00">MLP2 GPU7</text>
<text text-anchor="middle" x="1900" y="-3958.94" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1900" y="-3943.94" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_4_gelu_gpu7&#45;&gt;layer_4_mlp2_gpu7 -->
<g id="edge342" class="edge">
<title>layer_4_gelu_gpu7&#45;&gt;layer_4_mlp2_gpu7</title>
<path fill="none" stroke="black" d="M1900,-4025.1C1900,-4017.46 1900,-4008.28 1900,-3999.37"/>
<polygon fill="black" stroke="black" points="1903.5,-3999.14 1900,-3989.14 1896.5,-3999.14 1903.5,-3999.14"/>
</g>
<!-- layer_4_mlp_allreduce -->
<g id="node274" class="node">
<title>layer_4_mlp_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2404" cy="-3873.27" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="2404" y="-3877.07" font-family="Times,serif" font-size="14.00">MLP AllReduce</text>
<text text-anchor="middle" x="2404" y="-3862.07" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_4_mlp2_gpu0&#45;&gt;layer_4_mlp_allreduce -->
<g id="edge315" class="edge">
<title>layer_4_mlp2_gpu0&#45;&gt;layer_4_mlp_allreduce</title>
<path fill="none" stroke="black" d="M2845,-3938.53C2841.97,-3937.67 2838.96,-3936.87 2836,-3936.14 2721.59,-3907.98 2586.77,-3891.21 2498.56,-3882.37"/>
<polygon fill="black" stroke="black" points="2498.86,-3878.88 2488.57,-3881.39 2498.18,-3885.85 2498.86,-3878.88"/>
</g>
<!-- layer_4_mlp2_gpu1&#45;&gt;layer_4_mlp_allreduce -->
<g id="edge319" class="edge">
<title>layer_4_mlp2_gpu1&#45;&gt;layer_4_mlp_allreduce</title>
<path fill="none" stroke="black" d="M2700.93,-3938.79C2697.92,-3937.86 2694.93,-3936.97 2692,-3936.14 2624.58,-3917.05 2546.82,-3900.67 2489.11,-3889.57"/>
<polygon fill="black" stroke="black" points="2489.42,-3886.06 2478.94,-3887.63 2488.1,-3892.94 2489.42,-3886.06"/>
</g>
<!-- layer_4_mlp2_gpu2&#45;&gt;layer_4_mlp_allreduce -->
<g id="edge323" class="edge">
<title>layer_4_mlp2_gpu2&#45;&gt;layer_4_mlp_allreduce</title>
<path fill="none" stroke="black" d="M2556.94,-3936.14C2528.08,-3924.46 2494,-3910.68 2465.35,-3899.09"/>
<polygon fill="black" stroke="black" points="2466.44,-3895.75 2455.86,-3895.25 2463.81,-3902.24 2466.44,-3895.75"/>
</g>
<!-- layer_4_mlp2_gpu3&#45;&gt;layer_4_mlp_allreduce -->
<g id="edge327" class="edge">
<title>layer_4_mlp2_gpu3&#45;&gt;layer_4_mlp_allreduce</title>
<path fill="none" stroke="black" d="M2454.79,-3935.9C2447.4,-3926.93 2439,-3916.75 2431.2,-3907.27"/>
<polygon fill="black" stroke="black" points="2433.87,-3905.02 2424.81,-3899.53 2428.47,-3909.47 2433.87,-3905.02"/>
</g>
<!-- layer_4_mlp2_gpu4&#45;&gt;layer_4_mlp_allreduce -->
<g id="edge331" class="edge">
<title>layer_4_mlp2_gpu4&#45;&gt;layer_4_mlp_allreduce</title>
<path fill="none" stroke="black" d="M2353.21,-3935.9C2360.6,-3926.93 2369,-3916.75 2376.8,-3907.27"/>
<polygon fill="black" stroke="black" points="2379.53,-3909.47 2383.19,-3899.53 2374.13,-3905.02 2379.53,-3909.47"/>
</g>
<!-- layer_4_mlp2_gpu5&#45;&gt;layer_4_mlp_allreduce -->
<g id="edge335" class="edge">
<title>layer_4_mlp2_gpu5&#45;&gt;layer_4_mlp_allreduce</title>
<path fill="none" stroke="black" d="M2251.06,-3936.14C2279.92,-3924.46 2314,-3910.68 2342.65,-3899.09"/>
<polygon fill="black" stroke="black" points="2344.19,-3902.24 2352.14,-3895.25 2341.56,-3895.75 2344.19,-3902.24"/>
</g>
<!-- layer_4_mlp2_gpu6&#45;&gt;layer_4_mlp_allreduce -->
<g id="edge339" class="edge">
<title>layer_4_mlp2_gpu6&#45;&gt;layer_4_mlp_allreduce</title>
<path fill="none" stroke="black" d="M2107.07,-3938.79C2110.08,-3937.86 2113.07,-3936.97 2116,-3936.14 2183.42,-3917.05 2261.18,-3900.67 2318.89,-3889.57"/>
<polygon fill="black" stroke="black" points="2319.9,-3892.94 2329.06,-3887.63 2318.58,-3886.06 2319.9,-3892.94"/>
</g>
<!-- layer_4_mlp2_gpu7&#45;&gt;layer_4_mlp_allreduce -->
<g id="edge343" class="edge">
<title>layer_4_mlp2_gpu7&#45;&gt;layer_4_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1963,-3938.53C1966.03,-3937.67 1969.04,-3936.87 1972,-3936.14 2086.41,-3907.98 2221.23,-3891.21 2309.44,-3882.37"/>
<polygon fill="black" stroke="black" points="2309.82,-3885.85 2319.43,-3881.39 2309.14,-3878.88 2309.82,-3885.85"/>
</g>
<!-- layer_4_residual2 -->
<g id="node275" class="node">
<title>layer_4_residual2</title>
<polygon fill="lightyellow" stroke="black" points="2532.61,-3810.4 2328.02,-3810.4 2275.39,-3734.4 2479.98,-3734.4 2532.61,-3810.4"/>
<text text-anchor="middle" x="2404" y="-3776.2" font-family="Times,serif" font-size="14.00">Residual Add 4</text>
<text text-anchor="middle" x="2404" y="-3761.2" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_4_mlp_allreduce&#45;&gt;layer_4_residual2 -->
<g id="edge344" class="edge">
<title>layer_4_mlp_allreduce&#45;&gt;layer_4_residual2</title>
<path fill="none" stroke="black" d="M2404,-3846.29C2404,-3838.48 2404,-3829.65 2404,-3820.9"/>
<polygon fill="black" stroke="black" points="2407.5,-3820.73 2404,-3810.73 2400.5,-3820.73 2407.5,-3820.73"/>
</g>
<!-- layer_4_ln2 -->
<g id="node276" class="node">
<title>layer_4_ln2</title>
<polygon fill="lightblue" stroke="black" points="2459.5,-3698.4 2348.5,-3698.4 2348.5,-3660.4 2459.5,-3660.4 2459.5,-3698.4"/>
<text text-anchor="middle" x="2404" y="-3683.2" font-family="Times,serif" font-size="14.00">LayerNorm 4</text>
<text text-anchor="middle" x="2404" y="-3668.2" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_4_residual2&#45;&gt;layer_4_ln2 -->
<g id="edge345" class="edge">
<title>layer_4_residual2&#45;&gt;layer_4_ln2</title>
<path fill="none" stroke="black" d="M2404,-3734.39C2404,-3725.77 2404,-3716.72 2404,-3708.56"/>
<polygon fill="black" stroke="black" points="2407.5,-3708.43 2404,-3698.43 2400.5,-3708.43 2407.5,-3708.43"/>
</g>
<!-- layer_5_qkv_gpu0 -->
<g id="node277" class="node">
<title>layer_5_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2468,-3621.4 2340,-3621.4 2340,-3568.4 2468,-3568.4 2468,-3621.4"/>
<text text-anchor="middle" x="2404" y="-3606.2" font-family="Times,serif" font-size="14.00">QKV Proj GPU0</text>
<text text-anchor="middle" x="2404" y="-3591.2" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2404" y="-3576.2" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_4_ln2&#45;&gt;layer_5_qkv_gpu0 -->
<g id="edge346" class="edge">
<title>layer_4_ln2&#45;&gt;layer_5_qkv_gpu0</title>
<path fill="none" stroke="black" d="M2404,-3660.09C2404,-3651.79 2404,-3641.68 2404,-3631.96"/>
<polygon fill="black" stroke="black" points="2407.5,-3631.67 2404,-3621.67 2400.5,-3631.67 2407.5,-3631.67"/>
</g>
<!-- layer_5_qkv_comm -->
<g id="node285" class="node">
<title>layer_5_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="1893" cy="-3505.53" rx="85.62" ry="26.74"/>
<text text-anchor="middle" x="1893" y="-3509.33" font-family="Times,serif" font-size="14.00">QKV AllGather</text>
<text text-anchor="middle" x="1893" y="-3494.33" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_5_qkv_gpu0&#45;&gt;layer_5_qkv_comm -->
<g id="edge347" class="edge">
<title>layer_5_qkv_gpu0&#45;&gt;layer_5_qkv_comm</title>
<path fill="none" stroke="black" d="M2339.72,-3570.68C2336.79,-3569.86 2333.87,-3569.1 2331,-3568.4 2213.33,-3539.83 2074.46,-3522.98 1985.13,-3514.26"/>
<polygon fill="black" stroke="black" points="1985.32,-3510.76 1975.03,-3513.28 1984.65,-3517.73 1985.32,-3510.76"/>
</g>
<!-- layer_5_qkv_gpu1 -->
<g id="node278" class="node">
<title>layer_5_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2322,-3621.4 2194,-3621.4 2194,-3568.4 2322,-3568.4 2322,-3621.4"/>
<text text-anchor="middle" x="2258" y="-3606.2" font-family="Times,serif" font-size="14.00">QKV Proj GPU1</text>
<text text-anchor="middle" x="2258" y="-3591.2" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2258" y="-3576.2" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_5_qkv_gpu1&#45;&gt;layer_5_qkv_comm -->
<g id="edge348" class="edge">
<title>layer_5_qkv_gpu1&#45;&gt;layer_5_qkv_comm</title>
<path fill="none" stroke="black" d="M2193.65,-3570.93C2190.74,-3570.04 2187.84,-3569.2 2185,-3568.4 2115.53,-3548.99 2035.28,-3532.4 1976.5,-3521.3"/>
<polygon fill="black" stroke="black" points="1977,-3517.83 1966.53,-3519.42 1975.71,-3524.71 1977,-3517.83"/>
</g>
<!-- layer_5_qkv_gpu2 -->
<g id="node279" class="node">
<title>layer_5_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2176,-3621.4 2048,-3621.4 2048,-3568.4 2176,-3568.4 2176,-3621.4"/>
<text text-anchor="middle" x="2112" y="-3606.2" font-family="Times,serif" font-size="14.00">QKV Proj GPU2</text>
<text text-anchor="middle" x="2112" y="-3591.2" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2112" y="-3576.2" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_5_qkv_gpu2&#45;&gt;layer_5_qkv_comm -->
<g id="edge349" class="edge">
<title>layer_5_qkv_gpu2&#45;&gt;layer_5_qkv_comm</title>
<path fill="none" stroke="black" d="M2048.07,-3568.4C2018.33,-3556.53 1983.14,-3542.49 1953.81,-3530.79"/>
<polygon fill="black" stroke="black" points="1955.09,-3527.53 1944.5,-3527.08 1952.5,-3534.04 1955.09,-3527.53"/>
</g>
<!-- layer_5_qkv_gpu3 -->
<g id="node280" class="node">
<title>layer_5_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2030,-3621.4 1902,-3621.4 1902,-3568.4 2030,-3568.4 2030,-3621.4"/>
<text text-anchor="middle" x="1966" y="-3606.2" font-family="Times,serif" font-size="14.00">QKV Proj GPU3</text>
<text text-anchor="middle" x="1966" y="-3591.2" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1966" y="-3576.2" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_5_qkv_gpu3&#45;&gt;layer_5_qkv_comm -->
<g id="edge350" class="edge">
<title>layer_5_qkv_gpu3&#45;&gt;layer_5_qkv_comm</title>
<path fill="none" stroke="black" d="M1944.49,-3568.16C1937,-3559.19 1928.49,-3549.01 1920.58,-3539.53"/>
<polygon fill="black" stroke="black" points="1923.2,-3537.22 1914.1,-3531.79 1917.83,-3541.71 1923.2,-3537.22"/>
</g>
<!-- layer_5_qkv_gpu4 -->
<g id="node281" class="node">
<title>layer_5_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1884,-3621.4 1756,-3621.4 1756,-3568.4 1884,-3568.4 1884,-3621.4"/>
<text text-anchor="middle" x="1820" y="-3606.2" font-family="Times,serif" font-size="14.00">QKV Proj GPU4</text>
<text text-anchor="middle" x="1820" y="-3591.2" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1820" y="-3576.2" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_5_qkv_gpu4&#45;&gt;layer_5_qkv_comm -->
<g id="edge351" class="edge">
<title>layer_5_qkv_gpu4&#45;&gt;layer_5_qkv_comm</title>
<path fill="none" stroke="black" d="M1841.51,-3568.16C1849,-3559.19 1857.51,-3549.01 1865.42,-3539.53"/>
<polygon fill="black" stroke="black" points="1868.17,-3541.71 1871.9,-3531.79 1862.8,-3537.22 1868.17,-3541.71"/>
</g>
<!-- layer_5_qkv_gpu5 -->
<g id="node282" class="node">
<title>layer_5_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1738,-3621.4 1610,-3621.4 1610,-3568.4 1738,-3568.4 1738,-3621.4"/>
<text text-anchor="middle" x="1674" y="-3606.2" font-family="Times,serif" font-size="14.00">QKV Proj GPU5</text>
<text text-anchor="middle" x="1674" y="-3591.2" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1674" y="-3576.2" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_5_qkv_gpu5&#45;&gt;layer_5_qkv_comm -->
<g id="edge352" class="edge">
<title>layer_5_qkv_gpu5&#45;&gt;layer_5_qkv_comm</title>
<path fill="none" stroke="black" d="M1737.93,-3568.4C1767.67,-3556.53 1802.86,-3542.49 1832.19,-3530.79"/>
<polygon fill="black" stroke="black" points="1833.5,-3534.04 1841.5,-3527.08 1830.91,-3527.53 1833.5,-3534.04"/>
</g>
<!-- layer_5_qkv_gpu6 -->
<g id="node283" class="node">
<title>layer_5_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1592,-3621.4 1464,-3621.4 1464,-3568.4 1592,-3568.4 1592,-3621.4"/>
<text text-anchor="middle" x="1528" y="-3606.2" font-family="Times,serif" font-size="14.00">QKV Proj GPU6</text>
<text text-anchor="middle" x="1528" y="-3591.2" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1528" y="-3576.2" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_5_qkv_gpu6&#45;&gt;layer_5_qkv_comm -->
<g id="edge353" class="edge">
<title>layer_5_qkv_gpu6&#45;&gt;layer_5_qkv_comm</title>
<path fill="none" stroke="black" d="M1592.35,-3570.93C1595.26,-3570.04 1598.16,-3569.2 1601,-3568.4 1670.47,-3548.99 1750.72,-3532.4 1809.5,-3521.3"/>
<polygon fill="black" stroke="black" points="1810.29,-3524.71 1819.47,-3519.42 1809,-3517.83 1810.29,-3524.71"/>
</g>
<!-- layer_5_qkv_gpu7 -->
<g id="node284" class="node">
<title>layer_5_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1446,-3621.4 1318,-3621.4 1318,-3568.4 1446,-3568.4 1446,-3621.4"/>
<text text-anchor="middle" x="1382" y="-3606.2" font-family="Times,serif" font-size="14.00">QKV Proj GPU7</text>
<text text-anchor="middle" x="1382" y="-3591.2" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1382" y="-3576.2" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_5_qkv_gpu7&#45;&gt;layer_5_qkv_comm -->
<g id="edge354" class="edge">
<title>layer_5_qkv_gpu7&#45;&gt;layer_5_qkv_comm</title>
<path fill="none" stroke="black" d="M1446.28,-3570.68C1449.21,-3569.86 1452.13,-3569.1 1455,-3568.4 1572.67,-3539.83 1711.54,-3522.98 1800.87,-3514.26"/>
<polygon fill="black" stroke="black" points="1801.35,-3517.73 1810.97,-3513.28 1800.68,-3510.76 1801.35,-3517.73"/>
</g>
<!-- layer_5_attn_comp_gpu0 -->
<g id="node286" class="node">
<title>layer_5_attn_comp_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1236,-3442.66 1038,-3442.66 1038,-3389.66 1236,-3389.66 1236,-3442.66"/>
<text text-anchor="middle" x="1137" y="-3427.46" font-family="Times,serif" font-size="14.00">Attention Compute GPU0</text>
<text text-anchor="middle" x="1137" y="-3412.46" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="1137" y="-3397.46" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_5_qkv_comm&#45;&gt;layer_5_attn_comp_gpu0 -->
<g id="edge355" class="edge">
<title>layer_5_qkv_comm&#45;&gt;layer_5_attn_comp_gpu0</title>
<path fill="none" stroke="black" d="M1808.9,-3500.18C1686.86,-3493.05 1453.52,-3476.35 1246.22,-3442.77"/>
<polygon fill="black" stroke="black" points="1246.49,-3439.27 1236.06,-3441.1 1245.36,-3446.17 1246.49,-3439.27"/>
</g>
<!-- layer_5_attn_comp_gpu1 -->
<g id="node287" class="node">
<title>layer_5_attn_comp_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1452,-3442.66 1254,-3442.66 1254,-3389.66 1452,-3389.66 1452,-3442.66"/>
<text text-anchor="middle" x="1353" y="-3427.46" font-family="Times,serif" font-size="14.00">Attention Compute GPU1</text>
<text text-anchor="middle" x="1353" y="-3412.46" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="1353" y="-3397.46" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_5_qkv_comm&#45;&gt;layer_5_attn_comp_gpu1 -->
<g id="edge356" class="edge">
<title>layer_5_qkv_comm&#45;&gt;layer_5_attn_comp_gpu1</title>
<path fill="none" stroke="black" d="M1813.42,-3495.3C1728.69,-3484.99 1590.51,-3466.76 1462.11,-3442.81"/>
<polygon fill="black" stroke="black" points="1462.57,-3439.33 1452.09,-3440.92 1461.27,-3446.21 1462.57,-3439.33"/>
</g>
<!-- layer_5_attn_comp_gpu2 -->
<g id="node288" class="node">
<title>layer_5_attn_comp_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1668,-3442.66 1470,-3442.66 1470,-3389.66 1668,-3389.66 1668,-3442.66"/>
<text text-anchor="middle" x="1569" y="-3427.46" font-family="Times,serif" font-size="14.00">Attention Compute GPU2</text>
<text text-anchor="middle" x="1569" y="-3412.46" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="1569" y="-3397.46" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_5_qkv_comm&#45;&gt;layer_5_attn_comp_gpu2 -->
<g id="edge357" class="edge">
<title>layer_5_qkv_comm&#45;&gt;layer_5_attn_comp_gpu2</title>
<path fill="none" stroke="black" d="M1829.37,-3487.37C1785.05,-3475.42 1724.92,-3459.21 1673.61,-3445.37"/>
<polygon fill="black" stroke="black" points="1674.37,-3441.95 1663.8,-3442.73 1672.55,-3448.71 1674.37,-3441.95"/>
</g>
<!-- layer_5_attn_comp_gpu3 -->
<g id="node289" class="node">
<title>layer_5_attn_comp_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1884,-3442.66 1686,-3442.66 1686,-3389.66 1884,-3389.66 1884,-3442.66"/>
<text text-anchor="middle" x="1785" y="-3427.46" font-family="Times,serif" font-size="14.00">Attention Compute GPU3</text>
<text text-anchor="middle" x="1785" y="-3412.46" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="1785" y="-3397.46" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_5_qkv_comm&#45;&gt;layer_5_attn_comp_gpu3 -->
<g id="edge358" class="edge">
<title>layer_5_qkv_comm&#45;&gt;layer_5_attn_comp_gpu3</title>
<path fill="none" stroke="black" d="M1862.92,-3480.19C1851.14,-3470.67 1837.46,-3459.6 1824.88,-3449.43"/>
<polygon fill="black" stroke="black" points="1826.78,-3446.46 1816.81,-3442.89 1822.38,-3451.9 1826.78,-3446.46"/>
</g>
<!-- layer_5_attn_comp_gpu4 -->
<g id="node290" class="node">
<title>layer_5_attn_comp_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2100,-3442.66 1902,-3442.66 1902,-3389.66 2100,-3389.66 2100,-3442.66"/>
<text text-anchor="middle" x="2001" y="-3427.46" font-family="Times,serif" font-size="14.00">Attention Compute GPU4</text>
<text text-anchor="middle" x="2001" y="-3412.46" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="2001" y="-3397.46" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_5_qkv_comm&#45;&gt;layer_5_attn_comp_gpu4 -->
<g id="edge359" class="edge">
<title>layer_5_qkv_comm&#45;&gt;layer_5_attn_comp_gpu4</title>
<path fill="none" stroke="black" d="M1923.08,-3480.19C1934.86,-3470.67 1948.54,-3459.6 1961.12,-3449.43"/>
<polygon fill="black" stroke="black" points="1963.62,-3451.9 1969.19,-3442.89 1959.22,-3446.46 1963.62,-3451.9"/>
</g>
<!-- layer_5_attn_comp_gpu5 -->
<g id="node291" class="node">
<title>layer_5_attn_comp_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2316,-3442.66 2118,-3442.66 2118,-3389.66 2316,-3389.66 2316,-3442.66"/>
<text text-anchor="middle" x="2217" y="-3427.46" font-family="Times,serif" font-size="14.00">Attention Compute GPU5</text>
<text text-anchor="middle" x="2217" y="-3412.46" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="2217" y="-3397.46" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_5_qkv_comm&#45;&gt;layer_5_attn_comp_gpu5 -->
<g id="edge360" class="edge">
<title>layer_5_qkv_comm&#45;&gt;layer_5_attn_comp_gpu5</title>
<path fill="none" stroke="black" d="M1956.63,-3487.37C2000.95,-3475.42 2061.08,-3459.21 2112.39,-3445.37"/>
<polygon fill="black" stroke="black" points="2113.45,-3448.71 2122.2,-3442.73 2111.63,-3441.95 2113.45,-3448.71"/>
</g>
<!-- layer_5_attn_comp_gpu6 -->
<g id="node292" class="node">
<title>layer_5_attn_comp_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2532,-3442.66 2334,-3442.66 2334,-3389.66 2532,-3389.66 2532,-3442.66"/>
<text text-anchor="middle" x="2433" y="-3427.46" font-family="Times,serif" font-size="14.00">Attention Compute GPU6</text>
<text text-anchor="middle" x="2433" y="-3412.46" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="2433" y="-3397.46" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_5_qkv_comm&#45;&gt;layer_5_attn_comp_gpu6 -->
<g id="edge361" class="edge">
<title>layer_5_qkv_comm&#45;&gt;layer_5_attn_comp_gpu6</title>
<path fill="none" stroke="black" d="M1972.58,-3495.3C2057.31,-3484.99 2195.49,-3466.76 2323.89,-3442.81"/>
<polygon fill="black" stroke="black" points="2324.73,-3446.21 2333.91,-3440.92 2323.43,-3439.33 2324.73,-3446.21"/>
</g>
<!-- layer_5_attn_comp_gpu7 -->
<g id="node293" class="node">
<title>layer_5_attn_comp_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2748,-3442.66 2550,-3442.66 2550,-3389.66 2748,-3389.66 2748,-3442.66"/>
<text text-anchor="middle" x="2649" y="-3427.46" font-family="Times,serif" font-size="14.00">Attention Compute GPU7</text>
<text text-anchor="middle" x="2649" y="-3412.46" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="2649" y="-3397.46" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_5_qkv_comm&#45;&gt;layer_5_attn_comp_gpu7 -->
<g id="edge362" class="edge">
<title>layer_5_qkv_comm&#45;&gt;layer_5_attn_comp_gpu7</title>
<path fill="none" stroke="black" d="M1977.1,-3500.18C2099.14,-3493.05 2332.48,-3476.35 2539.78,-3442.77"/>
<polygon fill="black" stroke="black" points="2540.64,-3446.17 2549.94,-3441.1 2539.51,-3439.27 2540.64,-3446.17"/>
</g>
<!-- layer_5_attn_out_gpu0 -->
<g id="node294" class="node">
<title>layer_5_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1252,-3353.66 1094,-3353.66 1094,-3300.66 1252,-3300.66 1252,-3353.66"/>
<text text-anchor="middle" x="1173" y="-3338.46" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU0</text>
<text text-anchor="middle" x="1173" y="-3323.46" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1173" y="-3308.46" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_5_attn_comp_gpu0&#45;&gt;layer_5_attn_out_gpu0 -->
<g id="edge363" class="edge">
<title>layer_5_attn_comp_gpu0&#45;&gt;layer_5_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M1147.61,-3389.53C1151.02,-3381.28 1154.86,-3372 1158.5,-3363.2"/>
<polygon fill="black" stroke="black" points="1161.76,-3364.49 1162.34,-3353.91 1155.29,-3361.81 1161.76,-3364.49"/>
</g>
<!-- layer_5_attn_out_gpu1 -->
<g id="node295" class="node">
<title>layer_5_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1464,-3353.66 1306,-3353.66 1306,-3300.66 1464,-3300.66 1464,-3353.66"/>
<text text-anchor="middle" x="1385" y="-3338.46" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU1</text>
<text text-anchor="middle" x="1385" y="-3323.46" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1385" y="-3308.46" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_5_attn_comp_gpu1&#45;&gt;layer_5_attn_out_gpu1 -->
<g id="edge364" class="edge">
<title>layer_5_attn_comp_gpu1&#45;&gt;layer_5_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M1362.43,-3389.53C1365.43,-3381.37 1368.8,-3372.2 1372.01,-3363.48"/>
<polygon fill="black" stroke="black" points="1375.36,-3364.5 1375.53,-3353.91 1368.79,-3362.09 1375.36,-3364.5"/>
</g>
<!-- layer_5_attn_out_gpu2 -->
<g id="node296" class="node">
<title>layer_5_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1673,-3353.66 1515,-3353.66 1515,-3300.66 1673,-3300.66 1673,-3353.66"/>
<text text-anchor="middle" x="1594" y="-3338.46" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU2</text>
<text text-anchor="middle" x="1594" y="-3323.46" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1594" y="-3308.46" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_5_attn_comp_gpu2&#45;&gt;layer_5_attn_out_gpu2 -->
<g id="edge365" class="edge">
<title>layer_5_attn_comp_gpu2&#45;&gt;layer_5_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M1576.37,-3389.53C1578.68,-3381.46 1581.29,-3372.4 1583.77,-3363.76"/>
<polygon fill="black" stroke="black" points="1587.2,-3364.49 1586.6,-3353.91 1580.47,-3362.56 1587.2,-3364.49"/>
</g>
<!-- layer_5_attn_out_gpu3 -->
<g id="node297" class="node">
<title>layer_5_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1874,-3353.66 1716,-3353.66 1716,-3300.66 1874,-3300.66 1874,-3353.66"/>
<text text-anchor="middle" x="1795" y="-3338.46" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU3</text>
<text text-anchor="middle" x="1795" y="-3323.46" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1795" y="-3308.46" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_5_attn_comp_gpu3&#45;&gt;layer_5_attn_out_gpu3 -->
<g id="edge366" class="edge">
<title>layer_5_attn_comp_gpu3&#45;&gt;layer_5_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M1787.95,-3389.53C1788.86,-3381.55 1789.89,-3372.59 1790.88,-3364.04"/>
<polygon fill="black" stroke="black" points="1794.38,-3364.25 1792.04,-3353.91 1787.42,-3363.45 1794.38,-3364.25"/>
</g>
<!-- layer_5_attn_out_gpu4 -->
<g id="node298" class="node">
<title>layer_5_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2070,-3353.66 1912,-3353.66 1912,-3300.66 2070,-3300.66 2070,-3353.66"/>
<text text-anchor="middle" x="1991" y="-3338.46" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU4</text>
<text text-anchor="middle" x="1991" y="-3323.46" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1991" y="-3308.46" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_5_attn_comp_gpu4&#45;&gt;layer_5_attn_out_gpu4 -->
<g id="edge367" class="edge">
<title>layer_5_attn_comp_gpu4&#45;&gt;layer_5_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M1998.05,-3389.53C1997.14,-3381.55 1996.11,-3372.59 1995.12,-3364.04"/>
<polygon fill="black" stroke="black" points="1998.58,-3363.45 1993.96,-3353.91 1991.62,-3364.25 1998.58,-3363.45"/>
</g>
<!-- layer_5_attn_out_gpu5 -->
<g id="node299" class="node">
<title>layer_5_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2266,-3353.66 2108,-3353.66 2108,-3300.66 2266,-3300.66 2266,-3353.66"/>
<text text-anchor="middle" x="2187" y="-3338.46" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU5</text>
<text text-anchor="middle" x="2187" y="-3323.46" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2187" y="-3308.46" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_5_attn_comp_gpu5&#45;&gt;layer_5_attn_out_gpu5 -->
<g id="edge368" class="edge">
<title>layer_5_attn_comp_gpu5&#45;&gt;layer_5_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M2208.16,-3389.53C2205.35,-3381.37 2202.19,-3372.2 2199.18,-3363.48"/>
<polygon fill="black" stroke="black" points="2202.45,-3362.22 2195.88,-3353.91 2195.83,-3364.51 2202.45,-3362.22"/>
</g>
<!-- layer_5_attn_out_gpu6 -->
<g id="node300" class="node">
<title>layer_5_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2472,-3353.66 2314,-3353.66 2314,-3300.66 2472,-3300.66 2472,-3353.66"/>
<text text-anchor="middle" x="2393" y="-3338.46" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU6</text>
<text text-anchor="middle" x="2393" y="-3323.46" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2393" y="-3308.46" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_5_attn_comp_gpu6&#45;&gt;layer_5_attn_out_gpu6 -->
<g id="edge369" class="edge">
<title>layer_5_attn_comp_gpu6&#45;&gt;layer_5_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M2421.22,-3389.53C2417.42,-3381.28 2413.16,-3372 2409.11,-3363.2"/>
<polygon fill="black" stroke="black" points="2412.2,-3361.53 2404.84,-3353.91 2405.84,-3364.46 2412.2,-3361.53"/>
</g>
<!-- layer_5_attn_out_gpu7 -->
<g id="node301" class="node">
<title>layer_5_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2683,-3353.66 2525,-3353.66 2525,-3300.66 2683,-3300.66 2683,-3353.66"/>
<text text-anchor="middle" x="2604" y="-3338.46" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU7</text>
<text text-anchor="middle" x="2604" y="-3323.46" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2604" y="-3308.46" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_5_attn_comp_gpu7&#45;&gt;layer_5_attn_out_gpu7 -->
<g id="edge370" class="edge">
<title>layer_5_attn_comp_gpu7&#45;&gt;layer_5_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M2635.74,-3389.53C2631.43,-3381.2 2626.57,-3371.8 2621.98,-3362.92"/>
<polygon fill="black" stroke="black" points="2625.02,-3361.18 2617.32,-3353.91 2618.8,-3364.4 2625.02,-3361.18"/>
</g>
<!-- layer_5_attn_allreduce -->
<g id="node302" class="node">
<title>layer_5_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="1893" cy="-3237.79" rx="112.36" ry="26.74"/>
<text text-anchor="middle" x="1893" y="-3241.59" font-family="Times,serif" font-size="14.00">Attention AllReduce</text>
<text text-anchor="middle" x="1893" y="-3226.59" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_5_attn_out_gpu0&#45;&gt;layer_5_attn_allreduce -->
<g id="edge371" class="edge">
<title>layer_5_attn_out_gpu0&#45;&gt;layer_5_attn_allreduce</title>
<path fill="none" stroke="black" d="M1252.17,-3308.66C1267.02,-3305.72 1282.45,-3302.91 1297,-3300.66 1462.75,-3275.08 1656.11,-3257.18 1776.56,-3247.43"/>
<polygon fill="black" stroke="black" points="1776.86,-3250.92 1786.55,-3246.63 1776.3,-3243.94 1776.86,-3250.92"/>
</g>
<!-- layer_5_attn_out_gpu1&#45;&gt;layer_5_attn_allreduce -->
<g id="edge372" class="edge">
<title>layer_5_attn_out_gpu1&#45;&gt;layer_5_attn_allreduce</title>
<path fill="none" stroke="black" d="M1464.3,-3308.87C1478.17,-3306.01 1492.49,-3303.16 1506,-3300.66 1601.24,-3283.02 1710.23,-3265.87 1788.23,-3254.12"/>
<polygon fill="black" stroke="black" points="1789.17,-3257.51 1798.54,-3252.57 1788.13,-3250.59 1789.17,-3257.51"/>
</g>
<!-- layer_5_attn_out_gpu2&#45;&gt;layer_5_attn_allreduce -->
<g id="edge373" class="edge">
<title>layer_5_attn_out_gpu2&#45;&gt;layer_5_attn_allreduce</title>
<path fill="none" stroke="black" d="M1673.34,-3302.98C1716.77,-3290.29 1770.41,-3274.61 1813.82,-3261.93"/>
<polygon fill="black" stroke="black" points="1814.86,-3265.27 1823.48,-3259.11 1812.9,-3258.55 1814.86,-3265.27"/>
</g>
<!-- layer_5_attn_out_gpu3&#45;&gt;layer_5_attn_allreduce -->
<g id="edge374" class="edge">
<title>layer_5_attn_out_gpu3&#45;&gt;layer_5_attn_allreduce</title>
<path fill="none" stroke="black" d="M1823.61,-3300.66C1834.17,-3291.24 1846.26,-3280.46 1857.37,-3270.56"/>
<polygon fill="black" stroke="black" points="1859.73,-3273.14 1864.86,-3263.88 1855.07,-3267.92 1859.73,-3273.14"/>
</g>
<!-- layer_5_attn_out_gpu4&#45;&gt;layer_5_attn_allreduce -->
<g id="edge375" class="edge">
<title>layer_5_attn_out_gpu4&#45;&gt;layer_5_attn_allreduce</title>
<path fill="none" stroke="black" d="M1962.39,-3300.66C1951.83,-3291.24 1939.74,-3280.46 1928.63,-3270.56"/>
<polygon fill="black" stroke="black" points="1930.93,-3267.92 1921.14,-3263.88 1926.27,-3273.14 1930.93,-3267.92"/>
</g>
<!-- layer_5_attn_out_gpu5&#45;&gt;layer_5_attn_allreduce -->
<g id="edge376" class="edge">
<title>layer_5_attn_out_gpu5&#45;&gt;layer_5_attn_allreduce</title>
<path fill="none" stroke="black" d="M2107.83,-3302.63C2065.54,-3290.07 2013.66,-3274.65 1971.48,-3262.11"/>
<polygon fill="black" stroke="black" points="1972.39,-3258.73 1961.81,-3259.24 1970.4,-3265.44 1972.39,-3258.73"/>
</g>
<!-- layer_5_attn_out_gpu6&#45;&gt;layer_5_attn_allreduce -->
<g id="edge377" class="edge">
<title>layer_5_attn_out_gpu6&#45;&gt;layer_5_attn_allreduce</title>
<path fill="none" stroke="black" d="M2313.77,-3308.45C2300.84,-3305.72 2287.56,-3303.03 2275,-3300.66 2181.34,-3282.97 2074.16,-3265.88 1997.22,-3254.17"/>
<polygon fill="black" stroke="black" points="1997.45,-3250.66 1987.04,-3252.62 1996.4,-3257.58 1997.45,-3250.66"/>
</g>
<!-- layer_5_attn_out_gpu7&#45;&gt;layer_5_attn_allreduce -->
<g id="edge378" class="edge">
<title>layer_5_attn_out_gpu7&#45;&gt;layer_5_attn_allreduce</title>
<path fill="none" stroke="black" d="M2524.81,-3308.54C2510.29,-3305.65 2495.22,-3302.88 2481,-3300.66 2318.15,-3275.28 2128.26,-3257.4 2009.32,-3247.59"/>
<polygon fill="black" stroke="black" points="2009.35,-3244.08 1999.1,-3246.75 2008.78,-3251.06 2009.35,-3244.08"/>
</g>
<!-- layer_5_residual1 -->
<g id="node303" class="node">
<title>layer_5_residual1</title>
<polygon fill="lightyellow" stroke="black" points="2021.61,-3174.92 1817.02,-3174.92 1764.39,-3098.92 1968.98,-3098.92 2021.61,-3174.92"/>
<text text-anchor="middle" x="1893" y="-3140.72" font-family="Times,serif" font-size="14.00">Residual Add 5</text>
<text text-anchor="middle" x="1893" y="-3125.72" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_5_attn_allreduce&#45;&gt;layer_5_residual1 -->
<g id="edge379" class="edge">
<title>layer_5_attn_allreduce&#45;&gt;layer_5_residual1</title>
<path fill="none" stroke="black" d="M1893,-3210.81C1893,-3203 1893,-3194.17 1893,-3185.42"/>
<polygon fill="black" stroke="black" points="1896.5,-3185.25 1893,-3175.25 1889.5,-3185.25 1896.5,-3185.25"/>
</g>
<!-- layer_5_ln1 -->
<g id="node304" class="node">
<title>layer_5_ln1</title>
<polygon fill="lightblue" stroke="black" points="1948.5,-3062.92 1837.5,-3062.92 1837.5,-3024.92 1948.5,-3024.92 1948.5,-3062.92"/>
<text text-anchor="middle" x="1893" y="-3047.72" font-family="Times,serif" font-size="14.00">LayerNorm 5</text>
<text text-anchor="middle" x="1893" y="-3032.72" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_5_residual1&#45;&gt;layer_5_ln1 -->
<g id="edge380" class="edge">
<title>layer_5_residual1&#45;&gt;layer_5_ln1</title>
<path fill="none" stroke="black" d="M1893,-3098.91C1893,-3090.29 1893,-3081.24 1893,-3073.08"/>
<polygon fill="black" stroke="black" points="1896.5,-3072.95 1893,-3062.95 1889.5,-3072.95 1896.5,-3072.95"/>
</g>
<!-- layer_5_mlp1_gpu0 -->
<g id="node305" class="node">
<title>layer_5_mlp1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2460,-2985.92 2334,-2985.92 2334,-2932.92 2460,-2932.92 2460,-2985.92"/>
<text text-anchor="middle" x="2397" y="-2970.72" font-family="Times,serif" font-size="14.00">MLP1 GPU0</text>
<text text-anchor="middle" x="2397" y="-2955.72" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2397" y="-2940.72" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp1_gpu0 -->
<g id="edge381" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp1_gpu0</title>
<path fill="none" stroke="black" d="M1948.64,-3043.66C2049.37,-3044.33 2257.74,-3042.45 2325,-3016.92 2339.24,-3011.52 2352.92,-3002.23 2364.45,-2992.74"/>
<polygon fill="black" stroke="black" points="2366.78,-2995.35 2372.07,-2986.18 2362.21,-2990.05 2366.78,-2995.35"/>
</g>
<!-- layer_5_mlp1_gpu1 -->
<g id="node306" class="node">
<title>layer_5_mlp1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2316,-2985.92 2190,-2985.92 2190,-2932.92 2316,-2932.92 2316,-2985.92"/>
<text text-anchor="middle" x="2253" y="-2970.72" font-family="Times,serif" font-size="14.00">MLP1 GPU1</text>
<text text-anchor="middle" x="2253" y="-2955.72" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2253" y="-2940.72" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp1_gpu1 -->
<g id="edge385" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp1_gpu1</title>
<path fill="none" stroke="black" d="M1948.68,-3041.63C2020.24,-3039.34 2140.11,-3033.14 2181,-3016.92 2195.16,-3011.3 2208.81,-3001.97 2220.35,-2992.49"/>
<polygon fill="black" stroke="black" points="2222.67,-2995.11 2227.98,-2985.95 2218.11,-2989.8 2222.67,-2995.11"/>
</g>
<!-- layer_5_mlp1_gpu2 -->
<g id="node307" class="node">
<title>layer_5_mlp1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2172,-2985.92 2046,-2985.92 2046,-2932.92 2172,-2932.92 2172,-2985.92"/>
<text text-anchor="middle" x="2109" y="-2970.72" font-family="Times,serif" font-size="14.00">MLP1 GPU2</text>
<text text-anchor="middle" x="2109" y="-2955.72" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2109" y="-2940.72" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp1_gpu2 -->
<g id="edge389" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp1_gpu2</title>
<path fill="none" stroke="black" d="M1948.54,-3039.23C1976.09,-3035.85 2009.31,-3029.35 2037,-3016.92 2050.41,-3010.9 2063.54,-3001.85 2074.83,-2992.74"/>
<polygon fill="black" stroke="black" points="2077.29,-2995.25 2082.71,-2986.15 2072.79,-2989.89 2077.29,-2995.25"/>
</g>
<!-- layer_5_mlp1_gpu3 -->
<g id="node308" class="node">
<title>layer_5_mlp1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2028,-2985.92 1902,-2985.92 1902,-2932.92 2028,-2932.92 2028,-2985.92"/>
<text text-anchor="middle" x="1965" y="-2970.72" font-family="Times,serif" font-size="14.00">MLP1 GPU3</text>
<text text-anchor="middle" x="1965" y="-2955.72" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1965" y="-2940.72" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp1_gpu3 -->
<g id="edge393" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp1_gpu3</title>
<path fill="none" stroke="black" d="M1908.98,-3024.61C1916.84,-3015.61 1926.56,-3004.47 1935.69,-2994.01"/>
<polygon fill="black" stroke="black" points="1938.57,-2996.02 1942.51,-2986.19 1933.3,-2991.42 1938.57,-2996.02"/>
</g>
<!-- layer_5_mlp1_gpu4 -->
<g id="node309" class="node">
<title>layer_5_mlp1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1884,-2985.92 1758,-2985.92 1758,-2932.92 1884,-2932.92 1884,-2985.92"/>
<text text-anchor="middle" x="1821" y="-2970.72" font-family="Times,serif" font-size="14.00">MLP1 GPU4</text>
<text text-anchor="middle" x="1821" y="-2955.72" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1821" y="-2940.72" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp1_gpu4 -->
<g id="edge397" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp1_gpu4</title>
<path fill="none" stroke="black" d="M1877.02,-3024.61C1869.16,-3015.61 1859.44,-3004.47 1850.31,-2994.01"/>
<polygon fill="black" stroke="black" points="1852.7,-2991.42 1843.49,-2986.19 1847.43,-2996.02 1852.7,-2991.42"/>
</g>
<!-- layer_5_mlp1_gpu5 -->
<g id="node310" class="node">
<title>layer_5_mlp1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1740,-2985.92 1614,-2985.92 1614,-2932.92 1740,-2932.92 1740,-2985.92"/>
<text text-anchor="middle" x="1677" y="-2970.72" font-family="Times,serif" font-size="14.00">MLP1 GPU5</text>
<text text-anchor="middle" x="1677" y="-2955.72" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1677" y="-2940.72" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp1_gpu5 -->
<g id="edge401" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp1_gpu5</title>
<path fill="none" stroke="black" d="M1837.46,-3039.23C1809.91,-3035.85 1776.69,-3029.35 1749,-3016.92 1735.59,-3010.9 1722.46,-3001.85 1711.17,-2992.74"/>
<polygon fill="black" stroke="black" points="1713.21,-2989.89 1703.29,-2986.15 1708.71,-2995.25 1713.21,-2989.89"/>
</g>
<!-- layer_5_mlp1_gpu6 -->
<g id="node311" class="node">
<title>layer_5_mlp1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1596,-2985.92 1470,-2985.92 1470,-2932.92 1596,-2932.92 1596,-2985.92"/>
<text text-anchor="middle" x="1533" y="-2970.72" font-family="Times,serif" font-size="14.00">MLP1 GPU6</text>
<text text-anchor="middle" x="1533" y="-2955.72" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1533" y="-2940.72" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp1_gpu6 -->
<g id="edge405" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp1_gpu6</title>
<path fill="none" stroke="black" d="M1837.32,-3041.63C1765.76,-3039.34 1645.89,-3033.14 1605,-3016.92 1590.84,-3011.3 1577.19,-3001.97 1565.65,-2992.49"/>
<polygon fill="black" stroke="black" points="1567.89,-2989.8 1558.02,-2985.95 1563.33,-2995.11 1567.89,-2989.8"/>
</g>
<!-- layer_5_mlp1_gpu7 -->
<g id="node312" class="node">
<title>layer_5_mlp1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1452,-2985.92 1326,-2985.92 1326,-2932.92 1452,-2932.92 1452,-2985.92"/>
<text text-anchor="middle" x="1389" y="-2970.72" font-family="Times,serif" font-size="14.00">MLP1 GPU7</text>
<text text-anchor="middle" x="1389" y="-2955.72" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1389" y="-2940.72" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp1_gpu7 -->
<g id="edge409" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp1_gpu7</title>
<path fill="none" stroke="black" d="M1837.36,-3043.66C1736.63,-3044.33 1528.26,-3042.45 1461,-3016.92 1446.76,-3011.52 1433.08,-3002.23 1421.55,-2992.74"/>
<polygon fill="black" stroke="black" points="1423.79,-2990.05 1413.93,-2986.18 1419.22,-2995.35 1423.79,-2990.05"/>
</g>
<!-- layer_5_gelu_gpu0 -->
<g id="node313" class="node">
<title>layer_5_gelu_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2449,-2896.92 2345,-2896.92 2345,-2858.92 2449,-2858.92 2449,-2896.92"/>
<text text-anchor="middle" x="2397" y="-2881.72" font-family="Times,serif" font-size="14.00">GELU GPU0</text>
<text text-anchor="middle" x="2397" y="-2866.72" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_5_mlp1_gpu0&#45;&gt;layer_5_gelu_gpu0 -->
<g id="edge382" class="edge">
<title>layer_5_mlp1_gpu0&#45;&gt;layer_5_gelu_gpu0</title>
<path fill="none" stroke="black" d="M2397,-2932.83C2397,-2924.66 2397,-2915.57 2397,-2907.22"/>
<polygon fill="black" stroke="black" points="2400.5,-2907.16 2397,-2897.16 2393.5,-2907.16 2400.5,-2907.16"/>
</g>
<!-- layer_5_gelu_gpu1 -->
<g id="node314" class="node">
<title>layer_5_gelu_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2305,-2896.92 2201,-2896.92 2201,-2858.92 2305,-2858.92 2305,-2896.92"/>
<text text-anchor="middle" x="2253" y="-2881.72" font-family="Times,serif" font-size="14.00">GELU GPU1</text>
<text text-anchor="middle" x="2253" y="-2866.72" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_5_mlp1_gpu1&#45;&gt;layer_5_gelu_gpu1 -->
<g id="edge386" class="edge">
<title>layer_5_mlp1_gpu1&#45;&gt;layer_5_gelu_gpu1</title>
<path fill="none" stroke="black" d="M2253,-2932.83C2253,-2924.66 2253,-2915.57 2253,-2907.22"/>
<polygon fill="black" stroke="black" points="2256.5,-2907.16 2253,-2897.16 2249.5,-2907.16 2256.5,-2907.16"/>
</g>
<!-- layer_5_gelu_gpu2 -->
<g id="node315" class="node">
<title>layer_5_gelu_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2161,-2896.92 2057,-2896.92 2057,-2858.92 2161,-2858.92 2161,-2896.92"/>
<text text-anchor="middle" x="2109" y="-2881.72" font-family="Times,serif" font-size="14.00">GELU GPU2</text>
<text text-anchor="middle" x="2109" y="-2866.72" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_5_mlp1_gpu2&#45;&gt;layer_5_gelu_gpu2 -->
<g id="edge390" class="edge">
<title>layer_5_mlp1_gpu2&#45;&gt;layer_5_gelu_gpu2</title>
<path fill="none" stroke="black" d="M2109,-2932.83C2109,-2924.66 2109,-2915.57 2109,-2907.22"/>
<polygon fill="black" stroke="black" points="2112.5,-2907.16 2109,-2897.16 2105.5,-2907.16 2112.5,-2907.16"/>
</g>
<!-- layer_5_gelu_gpu3 -->
<g id="node316" class="node">
<title>layer_5_gelu_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2017,-2896.92 1913,-2896.92 1913,-2858.92 2017,-2858.92 2017,-2896.92"/>
<text text-anchor="middle" x="1965" y="-2881.72" font-family="Times,serif" font-size="14.00">GELU GPU3</text>
<text text-anchor="middle" x="1965" y="-2866.72" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_5_mlp1_gpu3&#45;&gt;layer_5_gelu_gpu3 -->
<g id="edge394" class="edge">
<title>layer_5_mlp1_gpu3&#45;&gt;layer_5_gelu_gpu3</title>
<path fill="none" stroke="black" d="M1965,-2932.83C1965,-2924.66 1965,-2915.57 1965,-2907.22"/>
<polygon fill="black" stroke="black" points="1968.5,-2907.16 1965,-2897.16 1961.5,-2907.16 1968.5,-2907.16"/>
</g>
<!-- layer_5_gelu_gpu4 -->
<g id="node317" class="node">
<title>layer_5_gelu_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1873,-2896.92 1769,-2896.92 1769,-2858.92 1873,-2858.92 1873,-2896.92"/>
<text text-anchor="middle" x="1821" y="-2881.72" font-family="Times,serif" font-size="14.00">GELU GPU4</text>
<text text-anchor="middle" x="1821" y="-2866.72" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_5_mlp1_gpu4&#45;&gt;layer_5_gelu_gpu4 -->
<g id="edge398" class="edge">
<title>layer_5_mlp1_gpu4&#45;&gt;layer_5_gelu_gpu4</title>
<path fill="none" stroke="black" d="M1821,-2932.83C1821,-2924.66 1821,-2915.57 1821,-2907.22"/>
<polygon fill="black" stroke="black" points="1824.5,-2907.16 1821,-2897.16 1817.5,-2907.16 1824.5,-2907.16"/>
</g>
<!-- layer_5_gelu_gpu5 -->
<g id="node318" class="node">
<title>layer_5_gelu_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1729,-2896.92 1625,-2896.92 1625,-2858.92 1729,-2858.92 1729,-2896.92"/>
<text text-anchor="middle" x="1677" y="-2881.72" font-family="Times,serif" font-size="14.00">GELU GPU5</text>
<text text-anchor="middle" x="1677" y="-2866.72" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_5_mlp1_gpu5&#45;&gt;layer_5_gelu_gpu5 -->
<g id="edge402" class="edge">
<title>layer_5_mlp1_gpu5&#45;&gt;layer_5_gelu_gpu5</title>
<path fill="none" stroke="black" d="M1677,-2932.83C1677,-2924.66 1677,-2915.57 1677,-2907.22"/>
<polygon fill="black" stroke="black" points="1680.5,-2907.16 1677,-2897.16 1673.5,-2907.16 1680.5,-2907.16"/>
</g>
<!-- layer_5_gelu_gpu6 -->
<g id="node319" class="node">
<title>layer_5_gelu_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1585,-2896.92 1481,-2896.92 1481,-2858.92 1585,-2858.92 1585,-2896.92"/>
<text text-anchor="middle" x="1533" y="-2881.72" font-family="Times,serif" font-size="14.00">GELU GPU6</text>
<text text-anchor="middle" x="1533" y="-2866.72" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_5_mlp1_gpu6&#45;&gt;layer_5_gelu_gpu6 -->
<g id="edge406" class="edge">
<title>layer_5_mlp1_gpu6&#45;&gt;layer_5_gelu_gpu6</title>
<path fill="none" stroke="black" d="M1533,-2932.83C1533,-2924.66 1533,-2915.57 1533,-2907.22"/>
<polygon fill="black" stroke="black" points="1536.5,-2907.16 1533,-2897.16 1529.5,-2907.16 1536.5,-2907.16"/>
</g>
<!-- layer_5_gelu_gpu7 -->
<g id="node320" class="node">
<title>layer_5_gelu_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1441,-2896.92 1337,-2896.92 1337,-2858.92 1441,-2858.92 1441,-2896.92"/>
<text text-anchor="middle" x="1389" y="-2881.72" font-family="Times,serif" font-size="14.00">GELU GPU7</text>
<text text-anchor="middle" x="1389" y="-2866.72" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_5_mlp1_gpu7&#45;&gt;layer_5_gelu_gpu7 -->
<g id="edge410" class="edge">
<title>layer_5_mlp1_gpu7&#45;&gt;layer_5_gelu_gpu7</title>
<path fill="none" stroke="black" d="M1389,-2932.83C1389,-2924.66 1389,-2915.57 1389,-2907.22"/>
<polygon fill="black" stroke="black" points="1392.5,-2907.16 1389,-2897.16 1385.5,-2907.16 1392.5,-2907.16"/>
</g>
<!-- layer_5_mlp2_gpu0 -->
<g id="node321" class="node">
<title>layer_5_mlp2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2460,-2822.92 2334,-2822.92 2334,-2769.92 2460,-2769.92 2460,-2822.92"/>
<text text-anchor="middle" x="2397" y="-2807.72" font-family="Times,serif" font-size="14.00">MLP2 GPU0</text>
<text text-anchor="middle" x="2397" y="-2792.72" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2397" y="-2777.72" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_5_gelu_gpu0&#45;&gt;layer_5_mlp2_gpu0 -->
<g id="edge383" class="edge">
<title>layer_5_gelu_gpu0&#45;&gt;layer_5_mlp2_gpu0</title>
<path fill="none" stroke="black" d="M2397,-2858.88C2397,-2851.24 2397,-2842.06 2397,-2833.15"/>
<polygon fill="black" stroke="black" points="2400.5,-2832.92 2397,-2822.92 2393.5,-2832.92 2400.5,-2832.92"/>
</g>
<!-- layer_5_mlp2_gpu1 -->
<g id="node322" class="node">
<title>layer_5_mlp2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2316,-2822.92 2190,-2822.92 2190,-2769.92 2316,-2769.92 2316,-2822.92"/>
<text text-anchor="middle" x="2253" y="-2807.72" font-family="Times,serif" font-size="14.00">MLP2 GPU1</text>
<text text-anchor="middle" x="2253" y="-2792.72" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2253" y="-2777.72" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_5_gelu_gpu1&#45;&gt;layer_5_mlp2_gpu1 -->
<g id="edge387" class="edge">
<title>layer_5_gelu_gpu1&#45;&gt;layer_5_mlp2_gpu1</title>
<path fill="none" stroke="black" d="M2253,-2858.88C2253,-2851.24 2253,-2842.06 2253,-2833.15"/>
<polygon fill="black" stroke="black" points="2256.5,-2832.92 2253,-2822.92 2249.5,-2832.92 2256.5,-2832.92"/>
</g>
<!-- layer_5_mlp2_gpu2 -->
<g id="node323" class="node">
<title>layer_5_mlp2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2172,-2822.92 2046,-2822.92 2046,-2769.92 2172,-2769.92 2172,-2822.92"/>
<text text-anchor="middle" x="2109" y="-2807.72" font-family="Times,serif" font-size="14.00">MLP2 GPU2</text>
<text text-anchor="middle" x="2109" y="-2792.72" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2109" y="-2777.72" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_5_gelu_gpu2&#45;&gt;layer_5_mlp2_gpu2 -->
<g id="edge391" class="edge">
<title>layer_5_gelu_gpu2&#45;&gt;layer_5_mlp2_gpu2</title>
<path fill="none" stroke="black" d="M2109,-2858.88C2109,-2851.24 2109,-2842.06 2109,-2833.15"/>
<polygon fill="black" stroke="black" points="2112.5,-2832.92 2109,-2822.92 2105.5,-2832.92 2112.5,-2832.92"/>
</g>
<!-- layer_5_mlp2_gpu3 -->
<g id="node324" class="node">
<title>layer_5_mlp2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2028,-2822.92 1902,-2822.92 1902,-2769.92 2028,-2769.92 2028,-2822.92"/>
<text text-anchor="middle" x="1965" y="-2807.72" font-family="Times,serif" font-size="14.00">MLP2 GPU3</text>
<text text-anchor="middle" x="1965" y="-2792.72" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1965" y="-2777.72" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_5_gelu_gpu3&#45;&gt;layer_5_mlp2_gpu3 -->
<g id="edge395" class="edge">
<title>layer_5_gelu_gpu3&#45;&gt;layer_5_mlp2_gpu3</title>
<path fill="none" stroke="black" d="M1965,-2858.88C1965,-2851.24 1965,-2842.06 1965,-2833.15"/>
<polygon fill="black" stroke="black" points="1968.5,-2832.92 1965,-2822.92 1961.5,-2832.92 1968.5,-2832.92"/>
</g>
<!-- layer_5_mlp2_gpu4 -->
<g id="node325" class="node">
<title>layer_5_mlp2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1884,-2822.92 1758,-2822.92 1758,-2769.92 1884,-2769.92 1884,-2822.92"/>
<text text-anchor="middle" x="1821" y="-2807.72" font-family="Times,serif" font-size="14.00">MLP2 GPU4</text>
<text text-anchor="middle" x="1821" y="-2792.72" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1821" y="-2777.72" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_5_gelu_gpu4&#45;&gt;layer_5_mlp2_gpu4 -->
<g id="edge399" class="edge">
<title>layer_5_gelu_gpu4&#45;&gt;layer_5_mlp2_gpu4</title>
<path fill="none" stroke="black" d="M1821,-2858.88C1821,-2851.24 1821,-2842.06 1821,-2833.15"/>
<polygon fill="black" stroke="black" points="1824.5,-2832.92 1821,-2822.92 1817.5,-2832.92 1824.5,-2832.92"/>
</g>
<!-- layer_5_mlp2_gpu5 -->
<g id="node326" class="node">
<title>layer_5_mlp2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1740,-2822.92 1614,-2822.92 1614,-2769.92 1740,-2769.92 1740,-2822.92"/>
<text text-anchor="middle" x="1677" y="-2807.72" font-family="Times,serif" font-size="14.00">MLP2 GPU5</text>
<text text-anchor="middle" x="1677" y="-2792.72" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1677" y="-2777.72" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_5_gelu_gpu5&#45;&gt;layer_5_mlp2_gpu5 -->
<g id="edge403" class="edge">
<title>layer_5_gelu_gpu5&#45;&gt;layer_5_mlp2_gpu5</title>
<path fill="none" stroke="black" d="M1677,-2858.88C1677,-2851.24 1677,-2842.06 1677,-2833.15"/>
<polygon fill="black" stroke="black" points="1680.5,-2832.92 1677,-2822.92 1673.5,-2832.92 1680.5,-2832.92"/>
</g>
<!-- layer_5_mlp2_gpu6 -->
<g id="node327" class="node">
<title>layer_5_mlp2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1596,-2822.92 1470,-2822.92 1470,-2769.92 1596,-2769.92 1596,-2822.92"/>
<text text-anchor="middle" x="1533" y="-2807.72" font-family="Times,serif" font-size="14.00">MLP2 GPU6</text>
<text text-anchor="middle" x="1533" y="-2792.72" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1533" y="-2777.72" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_5_gelu_gpu6&#45;&gt;layer_5_mlp2_gpu6 -->
<g id="edge407" class="edge">
<title>layer_5_gelu_gpu6&#45;&gt;layer_5_mlp2_gpu6</title>
<path fill="none" stroke="black" d="M1533,-2858.88C1533,-2851.24 1533,-2842.06 1533,-2833.15"/>
<polygon fill="black" stroke="black" points="1536.5,-2832.92 1533,-2822.92 1529.5,-2832.92 1536.5,-2832.92"/>
</g>
<!-- layer_5_mlp2_gpu7 -->
<g id="node328" class="node">
<title>layer_5_mlp2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1452,-2822.92 1326,-2822.92 1326,-2769.92 1452,-2769.92 1452,-2822.92"/>
<text text-anchor="middle" x="1389" y="-2807.72" font-family="Times,serif" font-size="14.00">MLP2 GPU7</text>
<text text-anchor="middle" x="1389" y="-2792.72" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1389" y="-2777.72" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_5_gelu_gpu7&#45;&gt;layer_5_mlp2_gpu7 -->
<g id="edge411" class="edge">
<title>layer_5_gelu_gpu7&#45;&gt;layer_5_mlp2_gpu7</title>
<path fill="none" stroke="black" d="M1389,-2858.88C1389,-2851.24 1389,-2842.06 1389,-2833.15"/>
<polygon fill="black" stroke="black" points="1392.5,-2832.92 1389,-2822.92 1385.5,-2832.92 1392.5,-2832.92"/>
</g>
<!-- layer_5_mlp_allreduce -->
<g id="node329" class="node">
<title>layer_5_mlp_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="1893" cy="-2707.05" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="1893" y="-2710.85" font-family="Times,serif" font-size="14.00">MLP AllReduce</text>
<text text-anchor="middle" x="1893" y="-2695.85" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_5_mlp2_gpu0&#45;&gt;layer_5_mlp_allreduce -->
<g id="edge384" class="edge">
<title>layer_5_mlp2_gpu0&#45;&gt;layer_5_mlp_allreduce</title>
<path fill="none" stroke="black" d="M2334,-2772.31C2330.97,-2771.45 2327.96,-2770.65 2325,-2769.92 2210.59,-2741.76 2075.77,-2724.99 1987.56,-2716.15"/>
<polygon fill="black" stroke="black" points="1987.86,-2712.66 1977.57,-2715.16 1987.18,-2719.63 1987.86,-2712.66"/>
</g>
<!-- layer_5_mlp2_gpu1&#45;&gt;layer_5_mlp_allreduce -->
<g id="edge388" class="edge">
<title>layer_5_mlp2_gpu1&#45;&gt;layer_5_mlp_allreduce</title>
<path fill="none" stroke="black" d="M2189.93,-2772.57C2186.92,-2771.64 2183.93,-2770.75 2181,-2769.92 2113.58,-2750.83 2035.82,-2734.45 1978.11,-2723.35"/>
<polygon fill="black" stroke="black" points="1978.42,-2719.84 1967.94,-2721.4 1977.1,-2726.72 1978.42,-2719.84"/>
</g>
<!-- layer_5_mlp2_gpu2&#45;&gt;layer_5_mlp_allreduce -->
<g id="edge392" class="edge">
<title>layer_5_mlp2_gpu2&#45;&gt;layer_5_mlp_allreduce</title>
<path fill="none" stroke="black" d="M2045.94,-2769.92C2017.08,-2758.24 1983,-2744.46 1954.35,-2732.87"/>
<polygon fill="black" stroke="black" points="1955.44,-2729.53 1944.86,-2729.03 1952.81,-2736.02 1955.44,-2729.53"/>
</g>
<!-- layer_5_mlp2_gpu3&#45;&gt;layer_5_mlp_allreduce -->
<g id="edge396" class="edge">
<title>layer_5_mlp2_gpu3&#45;&gt;layer_5_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1943.79,-2769.68C1936.4,-2760.71 1928,-2750.53 1920.2,-2741.05"/>
<polygon fill="black" stroke="black" points="1922.87,-2738.8 1913.81,-2733.31 1917.47,-2743.25 1922.87,-2738.8"/>
</g>
<!-- layer_5_mlp2_gpu4&#45;&gt;layer_5_mlp_allreduce -->
<g id="edge400" class="edge">
<title>layer_5_mlp2_gpu4&#45;&gt;layer_5_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1842.21,-2769.68C1849.6,-2760.71 1858,-2750.53 1865.8,-2741.05"/>
<polygon fill="black" stroke="black" points="1868.53,-2743.25 1872.19,-2733.31 1863.13,-2738.8 1868.53,-2743.25"/>
</g>
<!-- layer_5_mlp2_gpu5&#45;&gt;layer_5_mlp_allreduce -->
<g id="edge404" class="edge">
<title>layer_5_mlp2_gpu5&#45;&gt;layer_5_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1740.06,-2769.92C1768.92,-2758.24 1803,-2744.46 1831.65,-2732.87"/>
<polygon fill="black" stroke="black" points="1833.19,-2736.02 1841.14,-2729.03 1830.56,-2729.53 1833.19,-2736.02"/>
</g>
<!-- layer_5_mlp2_gpu6&#45;&gt;layer_5_mlp_allreduce -->
<g id="edge408" class="edge">
<title>layer_5_mlp2_gpu6&#45;&gt;layer_5_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1596.07,-2772.57C1599.08,-2771.64 1602.07,-2770.75 1605,-2769.92 1672.42,-2750.83 1750.18,-2734.45 1807.89,-2723.35"/>
<polygon fill="black" stroke="black" points="1808.9,-2726.72 1818.06,-2721.4 1807.58,-2719.84 1808.9,-2726.72"/>
</g>
<!-- layer_5_mlp2_gpu7&#45;&gt;layer_5_mlp_allreduce -->
<g id="edge412" class="edge">
<title>layer_5_mlp2_gpu7&#45;&gt;layer_5_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1452,-2772.31C1455.03,-2771.45 1458.04,-2770.65 1461,-2769.92 1575.41,-2741.76 1710.23,-2724.99 1798.44,-2716.15"/>
<polygon fill="black" stroke="black" points="1798.82,-2719.63 1808.43,-2715.16 1798.14,-2712.66 1798.82,-2719.63"/>
</g>
<!-- layer_5_residual2 -->
<g id="node330" class="node">
<title>layer_5_residual2</title>
<polygon fill="lightyellow" stroke="black" points="2021.61,-2644.18 1817.02,-2644.18 1764.39,-2568.18 1968.98,-2568.18 2021.61,-2644.18"/>
<text text-anchor="middle" x="1893" y="-2609.98" font-family="Times,serif" font-size="14.00">Residual Add 5</text>
<text text-anchor="middle" x="1893" y="-2594.98" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_5_mlp_allreduce&#45;&gt;layer_5_residual2 -->
<g id="edge413" class="edge">
<title>layer_5_mlp_allreduce&#45;&gt;layer_5_residual2</title>
<path fill="none" stroke="black" d="M1893,-2680.07C1893,-2672.26 1893,-2663.43 1893,-2654.68"/>
<polygon fill="black" stroke="black" points="1896.5,-2654.51 1893,-2644.51 1889.5,-2654.51 1896.5,-2654.51"/>
</g>
<!-- layer_5_ln2 -->
<g id="node331" class="node">
<title>layer_5_ln2</title>
<polygon fill="lightblue" stroke="black" points="1948.5,-2532.18 1837.5,-2532.18 1837.5,-2494.18 1948.5,-2494.18 1948.5,-2532.18"/>
<text text-anchor="middle" x="1893" y="-2516.98" font-family="Times,serif" font-size="14.00">LayerNorm 5</text>
<text text-anchor="middle" x="1893" y="-2501.98" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_5_residual2&#45;&gt;layer_5_ln2 -->
<g id="edge414" class="edge">
<title>layer_5_residual2&#45;&gt;layer_5_ln2</title>
<path fill="none" stroke="black" d="M1893,-2568.17C1893,-2559.55 1893,-2550.5 1893,-2542.34"/>
<polygon fill="black" stroke="black" points="1896.5,-2542.21 1893,-2532.21 1889.5,-2542.21 1896.5,-2542.21"/>
</g>
<!-- layer_6_qkv_gpu0 -->
<g id="node332" class="node">
<title>layer_6_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1957,-2455.18 1829,-2455.18 1829,-2402.18 1957,-2402.18 1957,-2455.18"/>
<text text-anchor="middle" x="1893" y="-2439.98" font-family="Times,serif" font-size="14.00">QKV Proj GPU0</text>
<text text-anchor="middle" x="1893" y="-2424.98" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1893" y="-2409.98" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_5_ln2&#45;&gt;layer_6_qkv_gpu0 -->
<g id="edge415" class="edge">
<title>layer_5_ln2&#45;&gt;layer_6_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1893,-2493.87C1893,-2485.57 1893,-2475.46 1893,-2465.74"/>
<polygon fill="black" stroke="black" points="1896.5,-2465.45 1893,-2455.45 1889.5,-2465.45 1896.5,-2465.45"/>
</g>
<!-- layer_6_qkv_comm -->
<g id="node340" class="node">
<title>layer_6_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="1382" cy="-2339.31" rx="85.62" ry="26.74"/>
<text text-anchor="middle" x="1382" y="-2343.11" font-family="Times,serif" font-size="14.00">QKV AllGather</text>
<text text-anchor="middle" x="1382" y="-2328.11" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_6_qkv_gpu0&#45;&gt;layer_6_qkv_comm -->
<g id="edge416" class="edge">
<title>layer_6_qkv_gpu0&#45;&gt;layer_6_qkv_comm</title>
<path fill="none" stroke="black" d="M1828.72,-2404.46C1825.79,-2403.64 1822.87,-2402.88 1820,-2402.18 1702.33,-2373.61 1563.46,-2356.76 1474.13,-2348.04"/>
<polygon fill="black" stroke="black" points="1474.32,-2344.54 1464.03,-2347.06 1473.65,-2351.51 1474.32,-2344.54"/>
</g>
<!-- layer_6_qkv_gpu1 -->
<g id="node333" class="node">
<title>layer_6_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1811,-2455.18 1683,-2455.18 1683,-2402.18 1811,-2402.18 1811,-2455.18"/>
<text text-anchor="middle" x="1747" y="-2439.98" font-family="Times,serif" font-size="14.00">QKV Proj GPU1</text>
<text text-anchor="middle" x="1747" y="-2424.98" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1747" y="-2409.98" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_6_qkv_gpu1&#45;&gt;layer_6_qkv_comm -->
<g id="edge417" class="edge">
<title>layer_6_qkv_gpu1&#45;&gt;layer_6_qkv_comm</title>
<path fill="none" stroke="black" d="M1682.65,-2404.71C1679.74,-2403.82 1676.84,-2402.98 1674,-2402.18 1604.53,-2382.77 1524.28,-2366.18 1465.5,-2355.08"/>
<polygon fill="black" stroke="black" points="1466,-2351.61 1455.53,-2353.2 1464.71,-2358.49 1466,-2351.61"/>
</g>
<!-- layer_6_qkv_gpu2 -->
<g id="node334" class="node">
<title>layer_6_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1665,-2455.18 1537,-2455.18 1537,-2402.18 1665,-2402.18 1665,-2455.18"/>
<text text-anchor="middle" x="1601" y="-2439.98" font-family="Times,serif" font-size="14.00">QKV Proj GPU2</text>
<text text-anchor="middle" x="1601" y="-2424.98" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1601" y="-2409.98" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_6_qkv_gpu2&#45;&gt;layer_6_qkv_comm -->
<g id="edge418" class="edge">
<title>layer_6_qkv_gpu2&#45;&gt;layer_6_qkv_comm</title>
<path fill="none" stroke="black" d="M1537.07,-2402.17C1507.33,-2390.31 1472.14,-2376.27 1442.81,-2364.57"/>
<polygon fill="black" stroke="black" points="1444.09,-2361.31 1433.5,-2360.86 1441.5,-2367.81 1444.09,-2361.31"/>
</g>
<!-- layer_6_qkv_gpu3 -->
<g id="node335" class="node">
<title>layer_6_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1519,-2455.18 1391,-2455.18 1391,-2402.18 1519,-2402.18 1519,-2455.18"/>
<text text-anchor="middle" x="1455" y="-2439.98" font-family="Times,serif" font-size="14.00">QKV Proj GPU3</text>
<text text-anchor="middle" x="1455" y="-2424.98" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1455" y="-2409.98" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_6_qkv_gpu3&#45;&gt;layer_6_qkv_comm -->
<g id="edge419" class="edge">
<title>layer_6_qkv_gpu3&#45;&gt;layer_6_qkv_comm</title>
<path fill="none" stroke="black" d="M1433.49,-2401.94C1426,-2392.97 1417.49,-2382.79 1409.58,-2373.31"/>
<polygon fill="black" stroke="black" points="1412.2,-2371 1403.1,-2365.57 1406.83,-2375.49 1412.2,-2371"/>
</g>
<!-- layer_6_qkv_gpu4 -->
<g id="node336" class="node">
<title>layer_6_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1373,-2455.18 1245,-2455.18 1245,-2402.18 1373,-2402.18 1373,-2455.18"/>
<text text-anchor="middle" x="1309" y="-2439.98" font-family="Times,serif" font-size="14.00">QKV Proj GPU4</text>
<text text-anchor="middle" x="1309" y="-2424.98" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1309" y="-2409.98" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_6_qkv_gpu4&#45;&gt;layer_6_qkv_comm -->
<g id="edge420" class="edge">
<title>layer_6_qkv_gpu4&#45;&gt;layer_6_qkv_comm</title>
<path fill="none" stroke="black" d="M1330.51,-2401.94C1338,-2392.97 1346.51,-2382.79 1354.42,-2373.31"/>
<polygon fill="black" stroke="black" points="1357.17,-2375.49 1360.9,-2365.57 1351.8,-2371 1357.17,-2375.49"/>
</g>
<!-- layer_6_qkv_gpu5 -->
<g id="node337" class="node">
<title>layer_6_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1227,-2455.18 1099,-2455.18 1099,-2402.18 1227,-2402.18 1227,-2455.18"/>
<text text-anchor="middle" x="1163" y="-2439.98" font-family="Times,serif" font-size="14.00">QKV Proj GPU5</text>
<text text-anchor="middle" x="1163" y="-2424.98" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1163" y="-2409.98" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_6_qkv_gpu5&#45;&gt;layer_6_qkv_comm -->
<g id="edge421" class="edge">
<title>layer_6_qkv_gpu5&#45;&gt;layer_6_qkv_comm</title>
<path fill="none" stroke="black" d="M1226.93,-2402.17C1256.67,-2390.31 1291.86,-2376.27 1321.19,-2364.57"/>
<polygon fill="black" stroke="black" points="1322.5,-2367.81 1330.5,-2360.86 1319.91,-2361.31 1322.5,-2367.81"/>
</g>
<!-- layer_6_qkv_gpu6 -->
<g id="node338" class="node">
<title>layer_6_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1081,-2455.18 953,-2455.18 953,-2402.18 1081,-2402.18 1081,-2455.18"/>
<text text-anchor="middle" x="1017" y="-2439.98" font-family="Times,serif" font-size="14.00">QKV Proj GPU6</text>
<text text-anchor="middle" x="1017" y="-2424.98" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1017" y="-2409.98" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_6_qkv_gpu6&#45;&gt;layer_6_qkv_comm -->
<g id="edge422" class="edge">
<title>layer_6_qkv_gpu6&#45;&gt;layer_6_qkv_comm</title>
<path fill="none" stroke="black" d="M1081.35,-2404.71C1084.26,-2403.82 1087.16,-2402.98 1090,-2402.18 1159.47,-2382.77 1239.72,-2366.18 1298.5,-2355.08"/>
<polygon fill="black" stroke="black" points="1299.29,-2358.49 1308.47,-2353.2 1298,-2351.61 1299.29,-2358.49"/>
</g>
<!-- layer_6_qkv_gpu7 -->
<g id="node339" class="node">
<title>layer_6_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="935,-2455.18 807,-2455.18 807,-2402.18 935,-2402.18 935,-2455.18"/>
<text text-anchor="middle" x="871" y="-2439.98" font-family="Times,serif" font-size="14.00">QKV Proj GPU7</text>
<text text-anchor="middle" x="871" y="-2424.98" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="871" y="-2409.98" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_6_qkv_gpu7&#45;&gt;layer_6_qkv_comm -->
<g id="edge423" class="edge">
<title>layer_6_qkv_gpu7&#45;&gt;layer_6_qkv_comm</title>
<path fill="none" stroke="black" d="M935.28,-2404.46C938.21,-2403.64 941.13,-2402.88 944,-2402.18 1061.67,-2373.61 1200.54,-2356.76 1289.87,-2348.04"/>
<polygon fill="black" stroke="black" points="1290.35,-2351.51 1299.97,-2347.06 1289.68,-2344.54 1290.35,-2351.51"/>
</g>
<!-- layer_6_attn_comp_gpu0 -->
<g id="node341" class="node">
<title>layer_6_attn_comp_gpu0</title>
<polygon fill="lightblue" stroke="black" points="725,-2276.44 527,-2276.44 527,-2223.44 725,-2223.44 725,-2276.44"/>
<text text-anchor="middle" x="626" y="-2261.24" font-family="Times,serif" font-size="14.00">Attention Compute GPU0</text>
<text text-anchor="middle" x="626" y="-2246.24" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="626" y="-2231.24" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_6_qkv_comm&#45;&gt;layer_6_attn_comp_gpu0 -->
<g id="edge424" class="edge">
<title>layer_6_qkv_comm&#45;&gt;layer_6_attn_comp_gpu0</title>
<path fill="none" stroke="black" d="M1297.9,-2333.96C1175.86,-2326.83 942.52,-2310.13 735.22,-2276.55"/>
<polygon fill="black" stroke="black" points="735.49,-2273.05 725.06,-2274.88 734.36,-2279.95 735.49,-2273.05"/>
</g>
<!-- layer_6_attn_comp_gpu1 -->
<g id="node342" class="node">
<title>layer_6_attn_comp_gpu1</title>
<polygon fill="lightblue" stroke="black" points="941,-2276.44 743,-2276.44 743,-2223.44 941,-2223.44 941,-2276.44"/>
<text text-anchor="middle" x="842" y="-2261.24" font-family="Times,serif" font-size="14.00">Attention Compute GPU1</text>
<text text-anchor="middle" x="842" y="-2246.24" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="842" y="-2231.24" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_6_qkv_comm&#45;&gt;layer_6_attn_comp_gpu1 -->
<g id="edge425" class="edge">
<title>layer_6_qkv_comm&#45;&gt;layer_6_attn_comp_gpu1</title>
<path fill="none" stroke="black" d="M1302.42,-2329.08C1217.69,-2318.77 1079.51,-2300.54 951.11,-2276.58"/>
<polygon fill="black" stroke="black" points="951.57,-2273.11 941.09,-2274.7 950.27,-2279.99 951.57,-2273.11"/>
</g>
<!-- layer_6_attn_comp_gpu2 -->
<g id="node343" class="node">
<title>layer_6_attn_comp_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1157,-2276.44 959,-2276.44 959,-2223.44 1157,-2223.44 1157,-2276.44"/>
<text text-anchor="middle" x="1058" y="-2261.24" font-family="Times,serif" font-size="14.00">Attention Compute GPU2</text>
<text text-anchor="middle" x="1058" y="-2246.24" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="1058" y="-2231.24" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_6_qkv_comm&#45;&gt;layer_6_attn_comp_gpu2 -->
<g id="edge426" class="edge">
<title>layer_6_qkv_comm&#45;&gt;layer_6_attn_comp_gpu2</title>
<path fill="none" stroke="black" d="M1318.37,-2321.15C1274.05,-2309.2 1213.92,-2292.99 1162.61,-2279.15"/>
<polygon fill="black" stroke="black" points="1163.37,-2275.73 1152.8,-2276.51 1161.55,-2282.49 1163.37,-2275.73"/>
</g>
<!-- layer_6_attn_comp_gpu3 -->
<g id="node344" class="node">
<title>layer_6_attn_comp_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1373,-2276.44 1175,-2276.44 1175,-2223.44 1373,-2223.44 1373,-2276.44"/>
<text text-anchor="middle" x="1274" y="-2261.24" font-family="Times,serif" font-size="14.00">Attention Compute GPU3</text>
<text text-anchor="middle" x="1274" y="-2246.24" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="1274" y="-2231.24" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_6_qkv_comm&#45;&gt;layer_6_attn_comp_gpu3 -->
<g id="edge427" class="edge">
<title>layer_6_qkv_comm&#45;&gt;layer_6_attn_comp_gpu3</title>
<path fill="none" stroke="black" d="M1351.92,-2313.97C1340.14,-2304.45 1326.46,-2293.38 1313.88,-2283.21"/>
<polygon fill="black" stroke="black" points="1315.78,-2280.24 1305.81,-2276.67 1311.38,-2285.68 1315.78,-2280.24"/>
</g>
<!-- layer_6_attn_comp_gpu4 -->
<g id="node345" class="node">
<title>layer_6_attn_comp_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1589,-2276.44 1391,-2276.44 1391,-2223.44 1589,-2223.44 1589,-2276.44"/>
<text text-anchor="middle" x="1490" y="-2261.24" font-family="Times,serif" font-size="14.00">Attention Compute GPU4</text>
<text text-anchor="middle" x="1490" y="-2246.24" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="1490" y="-2231.24" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_6_qkv_comm&#45;&gt;layer_6_attn_comp_gpu4 -->
<g id="edge428" class="edge">
<title>layer_6_qkv_comm&#45;&gt;layer_6_attn_comp_gpu4</title>
<path fill="none" stroke="black" d="M1412.08,-2313.97C1423.86,-2304.45 1437.54,-2293.38 1450.12,-2283.21"/>
<polygon fill="black" stroke="black" points="1452.62,-2285.68 1458.19,-2276.67 1448.22,-2280.24 1452.62,-2285.68"/>
</g>
<!-- layer_6_attn_comp_gpu5 -->
<g id="node346" class="node">
<title>layer_6_attn_comp_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1805,-2276.44 1607,-2276.44 1607,-2223.44 1805,-2223.44 1805,-2276.44"/>
<text text-anchor="middle" x="1706" y="-2261.24" font-family="Times,serif" font-size="14.00">Attention Compute GPU5</text>
<text text-anchor="middle" x="1706" y="-2246.24" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="1706" y="-2231.24" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_6_qkv_comm&#45;&gt;layer_6_attn_comp_gpu5 -->
<g id="edge429" class="edge">
<title>layer_6_qkv_comm&#45;&gt;layer_6_attn_comp_gpu5</title>
<path fill="none" stroke="black" d="M1445.63,-2321.15C1489.95,-2309.2 1550.08,-2292.99 1601.39,-2279.15"/>
<polygon fill="black" stroke="black" points="1602.45,-2282.49 1611.2,-2276.51 1600.63,-2275.73 1602.45,-2282.49"/>
</g>
<!-- layer_6_attn_comp_gpu6 -->
<g id="node347" class="node">
<title>layer_6_attn_comp_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2021,-2276.44 1823,-2276.44 1823,-2223.44 2021,-2223.44 2021,-2276.44"/>
<text text-anchor="middle" x="1922" y="-2261.24" font-family="Times,serif" font-size="14.00">Attention Compute GPU6</text>
<text text-anchor="middle" x="1922" y="-2246.24" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="1922" y="-2231.24" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_6_qkv_comm&#45;&gt;layer_6_attn_comp_gpu6 -->
<g id="edge430" class="edge">
<title>layer_6_qkv_comm&#45;&gt;layer_6_attn_comp_gpu6</title>
<path fill="none" stroke="black" d="M1461.58,-2329.08C1546.31,-2318.77 1684.49,-2300.54 1812.89,-2276.58"/>
<polygon fill="black" stroke="black" points="1813.73,-2279.99 1822.91,-2274.7 1812.43,-2273.11 1813.73,-2279.99"/>
</g>
<!-- layer_6_attn_comp_gpu7 -->
<g id="node348" class="node">
<title>layer_6_attn_comp_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2237,-2276.44 2039,-2276.44 2039,-2223.44 2237,-2223.44 2237,-2276.44"/>
<text text-anchor="middle" x="2138" y="-2261.24" font-family="Times,serif" font-size="14.00">Attention Compute GPU7</text>
<text text-anchor="middle" x="2138" y="-2246.24" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="2138" y="-2231.24" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_6_qkv_comm&#45;&gt;layer_6_attn_comp_gpu7 -->
<g id="edge431" class="edge">
<title>layer_6_qkv_comm&#45;&gt;layer_6_attn_comp_gpu7</title>
<path fill="none" stroke="black" d="M1466.1,-2333.96C1588.14,-2326.83 1821.48,-2310.13 2028.78,-2276.55"/>
<polygon fill="black" stroke="black" points="2029.64,-2279.95 2038.94,-2274.88 2028.51,-2273.05 2029.64,-2279.95"/>
</g>
<!-- layer_6_attn_out_gpu0 -->
<g id="node349" class="node">
<title>layer_6_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="757,-2187.44 599,-2187.44 599,-2134.44 757,-2134.44 757,-2187.44"/>
<text text-anchor="middle" x="678" y="-2172.24" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU0</text>
<text text-anchor="middle" x="678" y="-2157.24" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="678" y="-2142.24" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_6_attn_comp_gpu0&#45;&gt;layer_6_attn_out_gpu0 -->
<g id="edge432" class="edge">
<title>layer_6_attn_comp_gpu0&#45;&gt;layer_6_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M641.32,-2223.31C646.35,-2214.89 652.03,-2205.39 657.39,-2196.42"/>
<polygon fill="black" stroke="black" points="660.48,-2198.07 662.61,-2187.69 654.47,-2194.48 660.48,-2198.07"/>
</g>
<!-- layer_6_attn_out_gpu1 -->
<g id="node350" class="node">
<title>layer_6_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="953,-2187.44 795,-2187.44 795,-2134.44 953,-2134.44 953,-2187.44"/>
<text text-anchor="middle" x="874" y="-2172.24" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU1</text>
<text text-anchor="middle" x="874" y="-2157.24" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="874" y="-2142.24" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_6_attn_comp_gpu1&#45;&gt;layer_6_attn_out_gpu1 -->
<g id="edge433" class="edge">
<title>layer_6_attn_comp_gpu1&#45;&gt;layer_6_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M851.43,-2223.31C854.43,-2215.15 857.8,-2205.98 861.01,-2197.26"/>
<polygon fill="black" stroke="black" points="864.36,-2198.28 864.53,-2187.69 857.79,-2195.87 864.36,-2198.28"/>
</g>
<!-- layer_6_attn_out_gpu2 -->
<g id="node351" class="node">
<title>layer_6_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1162,-2187.44 1004,-2187.44 1004,-2134.44 1162,-2134.44 1162,-2187.44"/>
<text text-anchor="middle" x="1083" y="-2172.24" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU2</text>
<text text-anchor="middle" x="1083" y="-2157.24" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1083" y="-2142.24" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_6_attn_comp_gpu2&#45;&gt;layer_6_attn_out_gpu2 -->
<g id="edge434" class="edge">
<title>layer_6_attn_comp_gpu2&#45;&gt;layer_6_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M1065.37,-2223.31C1067.68,-2215.24 1070.29,-2206.18 1072.77,-2197.54"/>
<polygon fill="black" stroke="black" points="1076.2,-2198.27 1075.6,-2187.69 1069.47,-2196.33 1076.2,-2198.27"/>
</g>
<!-- layer_6_attn_out_gpu3 -->
<g id="node352" class="node">
<title>layer_6_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1363,-2187.44 1205,-2187.44 1205,-2134.44 1363,-2134.44 1363,-2187.44"/>
<text text-anchor="middle" x="1284" y="-2172.24" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU3</text>
<text text-anchor="middle" x="1284" y="-2157.24" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1284" y="-2142.24" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_6_attn_comp_gpu3&#45;&gt;layer_6_attn_out_gpu3 -->
<g id="edge435" class="edge">
<title>layer_6_attn_comp_gpu3&#45;&gt;layer_6_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M1276.95,-2223.31C1277.86,-2215.33 1278.89,-2206.37 1279.88,-2197.82"/>
<polygon fill="black" stroke="black" points="1283.38,-2198.02 1281.04,-2187.69 1276.42,-2197.23 1283.38,-2198.02"/>
</g>
<!-- layer_6_attn_out_gpu4 -->
<g id="node353" class="node">
<title>layer_6_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1559,-2187.44 1401,-2187.44 1401,-2134.44 1559,-2134.44 1559,-2187.44"/>
<text text-anchor="middle" x="1480" y="-2172.24" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU4</text>
<text text-anchor="middle" x="1480" y="-2157.24" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1480" y="-2142.24" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_6_attn_comp_gpu4&#45;&gt;layer_6_attn_out_gpu4 -->
<g id="edge436" class="edge">
<title>layer_6_attn_comp_gpu4&#45;&gt;layer_6_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M1487.05,-2223.31C1486.14,-2215.33 1485.11,-2206.37 1484.12,-2197.82"/>
<polygon fill="black" stroke="black" points="1487.58,-2197.23 1482.96,-2187.69 1480.62,-2198.02 1487.58,-2197.23"/>
</g>
<!-- layer_6_attn_out_gpu5 -->
<g id="node354" class="node">
<title>layer_6_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1755,-2187.44 1597,-2187.44 1597,-2134.44 1755,-2134.44 1755,-2187.44"/>
<text text-anchor="middle" x="1676" y="-2172.24" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU5</text>
<text text-anchor="middle" x="1676" y="-2157.24" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1676" y="-2142.24" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_6_attn_comp_gpu5&#45;&gt;layer_6_attn_out_gpu5 -->
<g id="edge437" class="edge">
<title>layer_6_attn_comp_gpu5&#45;&gt;layer_6_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M1697.16,-2223.31C1694.35,-2215.15 1691.19,-2205.98 1688.18,-2197.26"/>
<polygon fill="black" stroke="black" points="1691.45,-2196 1684.88,-2187.69 1684.83,-2198.29 1691.45,-2196"/>
</g>
<!-- layer_6_attn_out_gpu6 -->
<g id="node355" class="node">
<title>layer_6_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1961,-2187.44 1803,-2187.44 1803,-2134.44 1961,-2134.44 1961,-2187.44"/>
<text text-anchor="middle" x="1882" y="-2172.24" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU6</text>
<text text-anchor="middle" x="1882" y="-2157.24" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1882" y="-2142.24" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_6_attn_comp_gpu6&#45;&gt;layer_6_attn_out_gpu6 -->
<g id="edge438" class="edge">
<title>layer_6_attn_comp_gpu6&#45;&gt;layer_6_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M1910.22,-2223.31C1906.42,-2215.06 1902.16,-2205.78 1898.11,-2196.98"/>
<polygon fill="black" stroke="black" points="1901.2,-2195.31 1893.84,-2187.69 1894.84,-2198.24 1901.2,-2195.31"/>
</g>
<!-- layer_6_attn_out_gpu7 -->
<g id="node356" class="node">
<title>layer_6_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2172,-2187.44 2014,-2187.44 2014,-2134.44 2172,-2134.44 2172,-2187.44"/>
<text text-anchor="middle" x="2093" y="-2172.24" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU7</text>
<text text-anchor="middle" x="2093" y="-2157.24" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2093" y="-2142.24" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_6_attn_comp_gpu7&#45;&gt;layer_6_attn_out_gpu7 -->
<g id="edge439" class="edge">
<title>layer_6_attn_comp_gpu7&#45;&gt;layer_6_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M2124.74,-2223.31C2120.43,-2214.98 2115.57,-2205.58 2110.98,-2196.7"/>
<polygon fill="black" stroke="black" points="2114.02,-2194.96 2106.32,-2187.69 2107.8,-2198.18 2114.02,-2194.96"/>
</g>
<!-- layer_6_attn_allreduce -->
<g id="node357" class="node">
<title>layer_6_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="1382" cy="-2071.57" rx="112.36" ry="26.74"/>
<text text-anchor="middle" x="1382" y="-2075.37" font-family="Times,serif" font-size="14.00">Attention AllReduce</text>
<text text-anchor="middle" x="1382" y="-2060.37" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_6_attn_out_gpu0&#45;&gt;layer_6_attn_allreduce -->
<g id="edge440" class="edge">
<title>layer_6_attn_out_gpu0&#45;&gt;layer_6_attn_allreduce</title>
<path fill="none" stroke="black" d="M757.09,-2140.04C766.79,-2137.96 776.6,-2136.03 786,-2134.44 950.99,-2106.52 1143.94,-2089.26 1264.58,-2080.29"/>
<polygon fill="black" stroke="black" points="1264.87,-2083.77 1274.58,-2079.55 1264.35,-2076.79 1264.87,-2083.77"/>
</g>
<!-- layer_6_attn_out_gpu1&#45;&gt;layer_6_attn_allreduce -->
<g id="edge441" class="edge">
<title>layer_6_attn_out_gpu1&#45;&gt;layer_6_attn_allreduce</title>
<path fill="none" stroke="black" d="M953.3,-2142.65C967.17,-2139.79 981.49,-2136.94 995,-2134.44 1090.24,-2116.8 1199.23,-2099.65 1277.23,-2087.9"/>
<polygon fill="black" stroke="black" points="1278.17,-2091.29 1287.54,-2086.35 1277.13,-2084.37 1278.17,-2091.29"/>
</g>
<!-- layer_6_attn_out_gpu2&#45;&gt;layer_6_attn_allreduce -->
<g id="edge442" class="edge">
<title>layer_6_attn_out_gpu2&#45;&gt;layer_6_attn_allreduce</title>
<path fill="none" stroke="black" d="M1162.34,-2136.76C1205.77,-2124.07 1259.41,-2108.39 1302.82,-2095.71"/>
<polygon fill="black" stroke="black" points="1303.86,-2099.05 1312.48,-2092.89 1301.9,-2092.33 1303.86,-2099.05"/>
</g>
<!-- layer_6_attn_out_gpu3&#45;&gt;layer_6_attn_allreduce -->
<g id="edge443" class="edge">
<title>layer_6_attn_out_gpu3&#45;&gt;layer_6_attn_allreduce</title>
<path fill="none" stroke="black" d="M1312.61,-2134.43C1323.17,-2125.02 1335.26,-2114.24 1346.37,-2104.34"/>
<polygon fill="black" stroke="black" points="1348.73,-2106.92 1353.86,-2097.66 1344.07,-2101.7 1348.73,-2106.92"/>
</g>
<!-- layer_6_attn_out_gpu4&#45;&gt;layer_6_attn_allreduce -->
<g id="edge444" class="edge">
<title>layer_6_attn_out_gpu4&#45;&gt;layer_6_attn_allreduce</title>
<path fill="none" stroke="black" d="M1451.39,-2134.43C1440.83,-2125.02 1428.74,-2114.24 1417.63,-2104.34"/>
<polygon fill="black" stroke="black" points="1419.93,-2101.7 1410.14,-2097.66 1415.27,-2106.92 1419.93,-2101.7"/>
</g>
<!-- layer_6_attn_out_gpu5&#45;&gt;layer_6_attn_allreduce -->
<g id="edge445" class="edge">
<title>layer_6_attn_out_gpu5&#45;&gt;layer_6_attn_allreduce</title>
<path fill="none" stroke="black" d="M1596.83,-2136.41C1554.54,-2123.85 1502.66,-2108.43 1460.48,-2095.89"/>
<polygon fill="black" stroke="black" points="1461.39,-2092.51 1450.81,-2093.02 1459.4,-2099.22 1461.39,-2092.51"/>
</g>
<!-- layer_6_attn_out_gpu6&#45;&gt;layer_6_attn_allreduce -->
<g id="edge446" class="edge">
<title>layer_6_attn_out_gpu6&#45;&gt;layer_6_attn_allreduce</title>
<path fill="none" stroke="black" d="M1802.77,-2142.22C1789.84,-2139.5 1776.56,-2136.81 1764,-2134.44 1670.34,-2116.75 1563.16,-2099.66 1486.22,-2087.95"/>
<polygon fill="black" stroke="black" points="1486.45,-2084.44 1476.04,-2086.4 1485.4,-2091.36 1486.45,-2084.44"/>
</g>
<!-- layer_6_attn_out_gpu7&#45;&gt;layer_6_attn_allreduce -->
<g id="edge447" class="edge">
<title>layer_6_attn_out_gpu7&#45;&gt;layer_6_attn_allreduce</title>
<path fill="none" stroke="black" d="M2013.81,-2142.31C1999.29,-2139.43 1984.22,-2136.66 1970,-2134.44 1807.15,-2109.06 1617.26,-2091.17 1498.32,-2081.37"/>
<polygon fill="black" stroke="black" points="1498.35,-2077.86 1488.1,-2080.53 1497.78,-2084.84 1498.35,-2077.86"/>
</g>
<!-- layer_6_residual1 -->
<g id="node358" class="node">
<title>layer_6_residual1</title>
<polygon fill="lightyellow" stroke="black" points="1510.61,-2008.7 1306.02,-2008.7 1253.39,-1932.7 1457.98,-1932.7 1510.61,-2008.7"/>
<text text-anchor="middle" x="1382" y="-1974.5" font-family="Times,serif" font-size="14.00">Residual Add 6</text>
<text text-anchor="middle" x="1382" y="-1959.5" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_6_attn_allreduce&#45;&gt;layer_6_residual1 -->
<g id="edge448" class="edge">
<title>layer_6_attn_allreduce&#45;&gt;layer_6_residual1</title>
<path fill="none" stroke="black" d="M1382,-2044.59C1382,-2036.78 1382,-2027.95 1382,-2019.2"/>
<polygon fill="black" stroke="black" points="1385.5,-2019.03 1382,-2009.03 1378.5,-2019.03 1385.5,-2019.03"/>
</g>
<!-- layer_6_ln1 -->
<g id="node359" class="node">
<title>layer_6_ln1</title>
<polygon fill="lightblue" stroke="black" points="1437.5,-1896.7 1326.5,-1896.7 1326.5,-1858.7 1437.5,-1858.7 1437.5,-1896.7"/>
<text text-anchor="middle" x="1382" y="-1881.5" font-family="Times,serif" font-size="14.00">LayerNorm 6</text>
<text text-anchor="middle" x="1382" y="-1866.5" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_6_residual1&#45;&gt;layer_6_ln1 -->
<g id="edge449" class="edge">
<title>layer_6_residual1&#45;&gt;layer_6_ln1</title>
<path fill="none" stroke="black" d="M1382,-1932.69C1382,-1924.07 1382,-1915.02 1382,-1906.86"/>
<polygon fill="black" stroke="black" points="1385.5,-1906.73 1382,-1896.73 1378.5,-1906.73 1385.5,-1906.73"/>
</g>
<!-- layer_6_mlp1_gpu0 -->
<g id="node360" class="node">
<title>layer_6_mlp1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1949,-1819.7 1823,-1819.7 1823,-1766.7 1949,-1766.7 1949,-1819.7"/>
<text text-anchor="middle" x="1886" y="-1804.5" font-family="Times,serif" font-size="14.00">MLP1 GPU0</text>
<text text-anchor="middle" x="1886" y="-1789.5" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1886" y="-1774.5" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp1_gpu0 -->
<g id="edge450" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp1_gpu0</title>
<path fill="none" stroke="black" d="M1437.64,-1877.44C1538.37,-1878.11 1746.74,-1876.23 1814,-1850.7 1828.24,-1845.3 1841.92,-1836.01 1853.45,-1826.52"/>
<polygon fill="black" stroke="black" points="1855.78,-1829.13 1861.07,-1819.95 1851.21,-1823.83 1855.78,-1829.13"/>
</g>
<!-- layer_6_mlp1_gpu1 -->
<g id="node361" class="node">
<title>layer_6_mlp1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1805,-1819.7 1679,-1819.7 1679,-1766.7 1805,-1766.7 1805,-1819.7"/>
<text text-anchor="middle" x="1742" y="-1804.5" font-family="Times,serif" font-size="14.00">MLP1 GPU1</text>
<text text-anchor="middle" x="1742" y="-1789.5" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1742" y="-1774.5" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp1_gpu1 -->
<g id="edge454" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp1_gpu1</title>
<path fill="none" stroke="black" d="M1437.68,-1875.41C1509.24,-1873.12 1629.11,-1866.92 1670,-1850.7 1684.16,-1845.08 1697.81,-1835.75 1709.35,-1826.27"/>
<polygon fill="black" stroke="black" points="1711.67,-1828.89 1716.98,-1819.73 1707.11,-1823.58 1711.67,-1828.89"/>
</g>
<!-- layer_6_mlp1_gpu2 -->
<g id="node362" class="node">
<title>layer_6_mlp1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1661,-1819.7 1535,-1819.7 1535,-1766.7 1661,-1766.7 1661,-1819.7"/>
<text text-anchor="middle" x="1598" y="-1804.5" font-family="Times,serif" font-size="14.00">MLP1 GPU2</text>
<text text-anchor="middle" x="1598" y="-1789.5" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1598" y="-1774.5" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp1_gpu2 -->
<g id="edge458" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp1_gpu2</title>
<path fill="none" stroke="black" d="M1437.54,-1873.01C1465.09,-1869.63 1498.31,-1863.13 1526,-1850.7 1539.41,-1844.68 1552.54,-1835.63 1563.83,-1826.52"/>
<polygon fill="black" stroke="black" points="1566.29,-1829.03 1571.71,-1819.93 1561.79,-1823.67 1566.29,-1829.03"/>
</g>
<!-- layer_6_mlp1_gpu3 -->
<g id="node363" class="node">
<title>layer_6_mlp1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1517,-1819.7 1391,-1819.7 1391,-1766.7 1517,-1766.7 1517,-1819.7"/>
<text text-anchor="middle" x="1454" y="-1804.5" font-family="Times,serif" font-size="14.00">MLP1 GPU3</text>
<text text-anchor="middle" x="1454" y="-1789.5" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1454" y="-1774.5" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp1_gpu3 -->
<g id="edge462" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp1_gpu3</title>
<path fill="none" stroke="black" d="M1397.98,-1858.39C1405.84,-1849.39 1415.56,-1838.25 1424.69,-1827.79"/>
<polygon fill="black" stroke="black" points="1427.57,-1829.8 1431.51,-1819.97 1422.3,-1825.2 1427.57,-1829.8"/>
</g>
<!-- layer_6_mlp1_gpu4 -->
<g id="node364" class="node">
<title>layer_6_mlp1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1373,-1819.7 1247,-1819.7 1247,-1766.7 1373,-1766.7 1373,-1819.7"/>
<text text-anchor="middle" x="1310" y="-1804.5" font-family="Times,serif" font-size="14.00">MLP1 GPU4</text>
<text text-anchor="middle" x="1310" y="-1789.5" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1310" y="-1774.5" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp1_gpu4 -->
<g id="edge466" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp1_gpu4</title>
<path fill="none" stroke="black" d="M1366.02,-1858.39C1358.16,-1849.39 1348.44,-1838.25 1339.31,-1827.79"/>
<polygon fill="black" stroke="black" points="1341.7,-1825.2 1332.49,-1819.97 1336.43,-1829.8 1341.7,-1825.2"/>
</g>
<!-- layer_6_mlp1_gpu5 -->
<g id="node365" class="node">
<title>layer_6_mlp1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1229,-1819.7 1103,-1819.7 1103,-1766.7 1229,-1766.7 1229,-1819.7"/>
<text text-anchor="middle" x="1166" y="-1804.5" font-family="Times,serif" font-size="14.00">MLP1 GPU5</text>
<text text-anchor="middle" x="1166" y="-1789.5" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1166" y="-1774.5" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp1_gpu5 -->
<g id="edge470" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp1_gpu5</title>
<path fill="none" stroke="black" d="M1326.46,-1873.01C1298.91,-1869.63 1265.69,-1863.13 1238,-1850.7 1224.59,-1844.68 1211.46,-1835.63 1200.17,-1826.52"/>
<polygon fill="black" stroke="black" points="1202.21,-1823.67 1192.29,-1819.93 1197.71,-1829.03 1202.21,-1823.67"/>
</g>
<!-- layer_6_mlp1_gpu6 -->
<g id="node366" class="node">
<title>layer_6_mlp1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1085,-1819.7 959,-1819.7 959,-1766.7 1085,-1766.7 1085,-1819.7"/>
<text text-anchor="middle" x="1022" y="-1804.5" font-family="Times,serif" font-size="14.00">MLP1 GPU6</text>
<text text-anchor="middle" x="1022" y="-1789.5" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1022" y="-1774.5" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp1_gpu6 -->
<g id="edge474" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp1_gpu6</title>
<path fill="none" stroke="black" d="M1326.32,-1875.41C1254.76,-1873.12 1134.89,-1866.92 1094,-1850.7 1079.84,-1845.08 1066.19,-1835.75 1054.65,-1826.27"/>
<polygon fill="black" stroke="black" points="1056.89,-1823.58 1047.02,-1819.73 1052.33,-1828.89 1056.89,-1823.58"/>
</g>
<!-- layer_6_mlp1_gpu7 -->
<g id="node367" class="node">
<title>layer_6_mlp1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="941,-1819.7 815,-1819.7 815,-1766.7 941,-1766.7 941,-1819.7"/>
<text text-anchor="middle" x="878" y="-1804.5" font-family="Times,serif" font-size="14.00">MLP1 GPU7</text>
<text text-anchor="middle" x="878" y="-1789.5" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="878" y="-1774.5" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp1_gpu7 -->
<g id="edge478" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp1_gpu7</title>
<path fill="none" stroke="black" d="M1326.36,-1877.44C1225.63,-1878.11 1017.26,-1876.23 950,-1850.7 935.76,-1845.3 922.08,-1836.01 910.55,-1826.52"/>
<polygon fill="black" stroke="black" points="912.79,-1823.83 902.93,-1819.95 908.22,-1829.13 912.79,-1823.83"/>
</g>
<!-- layer_6_gelu_gpu0 -->
<g id="node368" class="node">
<title>layer_6_gelu_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1938,-1730.7 1834,-1730.7 1834,-1692.7 1938,-1692.7 1938,-1730.7"/>
<text text-anchor="middle" x="1886" y="-1715.5" font-family="Times,serif" font-size="14.00">GELU GPU0</text>
<text text-anchor="middle" x="1886" y="-1700.5" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_6_mlp1_gpu0&#45;&gt;layer_6_gelu_gpu0 -->
<g id="edge451" class="edge">
<title>layer_6_mlp1_gpu0&#45;&gt;layer_6_gelu_gpu0</title>
<path fill="none" stroke="black" d="M1886,-1766.61C1886,-1758.44 1886,-1749.35 1886,-1741"/>
<polygon fill="black" stroke="black" points="1889.5,-1740.94 1886,-1730.94 1882.5,-1740.94 1889.5,-1740.94"/>
</g>
<!-- layer_6_gelu_gpu1 -->
<g id="node369" class="node">
<title>layer_6_gelu_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1794,-1730.7 1690,-1730.7 1690,-1692.7 1794,-1692.7 1794,-1730.7"/>
<text text-anchor="middle" x="1742" y="-1715.5" font-family="Times,serif" font-size="14.00">GELU GPU1</text>
<text text-anchor="middle" x="1742" y="-1700.5" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_6_mlp1_gpu1&#45;&gt;layer_6_gelu_gpu1 -->
<g id="edge455" class="edge">
<title>layer_6_mlp1_gpu1&#45;&gt;layer_6_gelu_gpu1</title>
<path fill="none" stroke="black" d="M1742,-1766.61C1742,-1758.44 1742,-1749.35 1742,-1741"/>
<polygon fill="black" stroke="black" points="1745.5,-1740.94 1742,-1730.94 1738.5,-1740.94 1745.5,-1740.94"/>
</g>
<!-- layer_6_gelu_gpu2 -->
<g id="node370" class="node">
<title>layer_6_gelu_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1650,-1730.7 1546,-1730.7 1546,-1692.7 1650,-1692.7 1650,-1730.7"/>
<text text-anchor="middle" x="1598" y="-1715.5" font-family="Times,serif" font-size="14.00">GELU GPU2</text>
<text text-anchor="middle" x="1598" y="-1700.5" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_6_mlp1_gpu2&#45;&gt;layer_6_gelu_gpu2 -->
<g id="edge459" class="edge">
<title>layer_6_mlp1_gpu2&#45;&gt;layer_6_gelu_gpu2</title>
<path fill="none" stroke="black" d="M1598,-1766.61C1598,-1758.44 1598,-1749.35 1598,-1741"/>
<polygon fill="black" stroke="black" points="1601.5,-1740.94 1598,-1730.94 1594.5,-1740.94 1601.5,-1740.94"/>
</g>
<!-- layer_6_gelu_gpu3 -->
<g id="node371" class="node">
<title>layer_6_gelu_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1506,-1730.7 1402,-1730.7 1402,-1692.7 1506,-1692.7 1506,-1730.7"/>
<text text-anchor="middle" x="1454" y="-1715.5" font-family="Times,serif" font-size="14.00">GELU GPU3</text>
<text text-anchor="middle" x="1454" y="-1700.5" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_6_mlp1_gpu3&#45;&gt;layer_6_gelu_gpu3 -->
<g id="edge463" class="edge">
<title>layer_6_mlp1_gpu3&#45;&gt;layer_6_gelu_gpu3</title>
<path fill="none" stroke="black" d="M1454,-1766.61C1454,-1758.44 1454,-1749.35 1454,-1741"/>
<polygon fill="black" stroke="black" points="1457.5,-1740.94 1454,-1730.94 1450.5,-1740.94 1457.5,-1740.94"/>
</g>
<!-- layer_6_gelu_gpu4 -->
<g id="node372" class="node">
<title>layer_6_gelu_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1362,-1730.7 1258,-1730.7 1258,-1692.7 1362,-1692.7 1362,-1730.7"/>
<text text-anchor="middle" x="1310" y="-1715.5" font-family="Times,serif" font-size="14.00">GELU GPU4</text>
<text text-anchor="middle" x="1310" y="-1700.5" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_6_mlp1_gpu4&#45;&gt;layer_6_gelu_gpu4 -->
<g id="edge467" class="edge">
<title>layer_6_mlp1_gpu4&#45;&gt;layer_6_gelu_gpu4</title>
<path fill="none" stroke="black" d="M1310,-1766.61C1310,-1758.44 1310,-1749.35 1310,-1741"/>
<polygon fill="black" stroke="black" points="1313.5,-1740.94 1310,-1730.94 1306.5,-1740.94 1313.5,-1740.94"/>
</g>
<!-- layer_6_gelu_gpu5 -->
<g id="node373" class="node">
<title>layer_6_gelu_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1218,-1730.7 1114,-1730.7 1114,-1692.7 1218,-1692.7 1218,-1730.7"/>
<text text-anchor="middle" x="1166" y="-1715.5" font-family="Times,serif" font-size="14.00">GELU GPU5</text>
<text text-anchor="middle" x="1166" y="-1700.5" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_6_mlp1_gpu5&#45;&gt;layer_6_gelu_gpu5 -->
<g id="edge471" class="edge">
<title>layer_6_mlp1_gpu5&#45;&gt;layer_6_gelu_gpu5</title>
<path fill="none" stroke="black" d="M1166,-1766.61C1166,-1758.44 1166,-1749.35 1166,-1741"/>
<polygon fill="black" stroke="black" points="1169.5,-1740.94 1166,-1730.94 1162.5,-1740.94 1169.5,-1740.94"/>
</g>
<!-- layer_6_gelu_gpu6 -->
<g id="node374" class="node">
<title>layer_6_gelu_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1074,-1730.7 970,-1730.7 970,-1692.7 1074,-1692.7 1074,-1730.7"/>
<text text-anchor="middle" x="1022" y="-1715.5" font-family="Times,serif" font-size="14.00">GELU GPU6</text>
<text text-anchor="middle" x="1022" y="-1700.5" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_6_mlp1_gpu6&#45;&gt;layer_6_gelu_gpu6 -->
<g id="edge475" class="edge">
<title>layer_6_mlp1_gpu6&#45;&gt;layer_6_gelu_gpu6</title>
<path fill="none" stroke="black" d="M1022,-1766.61C1022,-1758.44 1022,-1749.35 1022,-1741"/>
<polygon fill="black" stroke="black" points="1025.5,-1740.94 1022,-1730.94 1018.5,-1740.94 1025.5,-1740.94"/>
</g>
<!-- layer_6_gelu_gpu7 -->
<g id="node375" class="node">
<title>layer_6_gelu_gpu7</title>
<polygon fill="lightblue" stroke="black" points="930,-1730.7 826,-1730.7 826,-1692.7 930,-1692.7 930,-1730.7"/>
<text text-anchor="middle" x="878" y="-1715.5" font-family="Times,serif" font-size="14.00">GELU GPU7</text>
<text text-anchor="middle" x="878" y="-1700.5" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_6_mlp1_gpu7&#45;&gt;layer_6_gelu_gpu7 -->
<g id="edge479" class="edge">
<title>layer_6_mlp1_gpu7&#45;&gt;layer_6_gelu_gpu7</title>
<path fill="none" stroke="black" d="M878,-1766.61C878,-1758.44 878,-1749.35 878,-1741"/>
<polygon fill="black" stroke="black" points="881.5,-1740.94 878,-1730.94 874.5,-1740.94 881.5,-1740.94"/>
</g>
<!-- layer_6_mlp2_gpu0 -->
<g id="node376" class="node">
<title>layer_6_mlp2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1949,-1656.7 1823,-1656.7 1823,-1603.7 1949,-1603.7 1949,-1656.7"/>
<text text-anchor="middle" x="1886" y="-1641.5" font-family="Times,serif" font-size="14.00">MLP2 GPU0</text>
<text text-anchor="middle" x="1886" y="-1626.5" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1886" y="-1611.5" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_6_gelu_gpu0&#45;&gt;layer_6_mlp2_gpu0 -->
<g id="edge452" class="edge">
<title>layer_6_gelu_gpu0&#45;&gt;layer_6_mlp2_gpu0</title>
<path fill="none" stroke="black" d="M1886,-1692.66C1886,-1685.02 1886,-1675.84 1886,-1666.93"/>
<polygon fill="black" stroke="black" points="1889.5,-1666.7 1886,-1656.7 1882.5,-1666.7 1889.5,-1666.7"/>
</g>
<!-- layer_6_mlp2_gpu1 -->
<g id="node377" class="node">
<title>layer_6_mlp2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1805,-1656.7 1679,-1656.7 1679,-1603.7 1805,-1603.7 1805,-1656.7"/>
<text text-anchor="middle" x="1742" y="-1641.5" font-family="Times,serif" font-size="14.00">MLP2 GPU1</text>
<text text-anchor="middle" x="1742" y="-1626.5" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1742" y="-1611.5" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_6_gelu_gpu1&#45;&gt;layer_6_mlp2_gpu1 -->
<g id="edge456" class="edge">
<title>layer_6_gelu_gpu1&#45;&gt;layer_6_mlp2_gpu1</title>
<path fill="none" stroke="black" d="M1742,-1692.66C1742,-1685.02 1742,-1675.84 1742,-1666.93"/>
<polygon fill="black" stroke="black" points="1745.5,-1666.7 1742,-1656.7 1738.5,-1666.7 1745.5,-1666.7"/>
</g>
<!-- layer_6_mlp2_gpu2 -->
<g id="node378" class="node">
<title>layer_6_mlp2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1661,-1656.7 1535,-1656.7 1535,-1603.7 1661,-1603.7 1661,-1656.7"/>
<text text-anchor="middle" x="1598" y="-1641.5" font-family="Times,serif" font-size="14.00">MLP2 GPU2</text>
<text text-anchor="middle" x="1598" y="-1626.5" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1598" y="-1611.5" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_6_gelu_gpu2&#45;&gt;layer_6_mlp2_gpu2 -->
<g id="edge460" class="edge">
<title>layer_6_gelu_gpu2&#45;&gt;layer_6_mlp2_gpu2</title>
<path fill="none" stroke="black" d="M1598,-1692.66C1598,-1685.02 1598,-1675.84 1598,-1666.93"/>
<polygon fill="black" stroke="black" points="1601.5,-1666.7 1598,-1656.7 1594.5,-1666.7 1601.5,-1666.7"/>
</g>
<!-- layer_6_mlp2_gpu3 -->
<g id="node379" class="node">
<title>layer_6_mlp2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1517,-1656.7 1391,-1656.7 1391,-1603.7 1517,-1603.7 1517,-1656.7"/>
<text text-anchor="middle" x="1454" y="-1641.5" font-family="Times,serif" font-size="14.00">MLP2 GPU3</text>
<text text-anchor="middle" x="1454" y="-1626.5" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1454" y="-1611.5" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_6_gelu_gpu3&#45;&gt;layer_6_mlp2_gpu3 -->
<g id="edge464" class="edge">
<title>layer_6_gelu_gpu3&#45;&gt;layer_6_mlp2_gpu3</title>
<path fill="none" stroke="black" d="M1454,-1692.66C1454,-1685.02 1454,-1675.84 1454,-1666.93"/>
<polygon fill="black" stroke="black" points="1457.5,-1666.7 1454,-1656.7 1450.5,-1666.7 1457.5,-1666.7"/>
</g>
<!-- layer_6_mlp2_gpu4 -->
<g id="node380" class="node">
<title>layer_6_mlp2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1373,-1656.7 1247,-1656.7 1247,-1603.7 1373,-1603.7 1373,-1656.7"/>
<text text-anchor="middle" x="1310" y="-1641.5" font-family="Times,serif" font-size="14.00">MLP2 GPU4</text>
<text text-anchor="middle" x="1310" y="-1626.5" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1310" y="-1611.5" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_6_gelu_gpu4&#45;&gt;layer_6_mlp2_gpu4 -->
<g id="edge468" class="edge">
<title>layer_6_gelu_gpu4&#45;&gt;layer_6_mlp2_gpu4</title>
<path fill="none" stroke="black" d="M1310,-1692.66C1310,-1685.02 1310,-1675.84 1310,-1666.93"/>
<polygon fill="black" stroke="black" points="1313.5,-1666.7 1310,-1656.7 1306.5,-1666.7 1313.5,-1666.7"/>
</g>
<!-- layer_6_mlp2_gpu5 -->
<g id="node381" class="node">
<title>layer_6_mlp2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1229,-1656.7 1103,-1656.7 1103,-1603.7 1229,-1603.7 1229,-1656.7"/>
<text text-anchor="middle" x="1166" y="-1641.5" font-family="Times,serif" font-size="14.00">MLP2 GPU5</text>
<text text-anchor="middle" x="1166" y="-1626.5" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1166" y="-1611.5" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_6_gelu_gpu5&#45;&gt;layer_6_mlp2_gpu5 -->
<g id="edge472" class="edge">
<title>layer_6_gelu_gpu5&#45;&gt;layer_6_mlp2_gpu5</title>
<path fill="none" stroke="black" d="M1166,-1692.66C1166,-1685.02 1166,-1675.84 1166,-1666.93"/>
<polygon fill="black" stroke="black" points="1169.5,-1666.7 1166,-1656.7 1162.5,-1666.7 1169.5,-1666.7"/>
</g>
<!-- layer_6_mlp2_gpu6 -->
<g id="node382" class="node">
<title>layer_6_mlp2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1085,-1656.7 959,-1656.7 959,-1603.7 1085,-1603.7 1085,-1656.7"/>
<text text-anchor="middle" x="1022" y="-1641.5" font-family="Times,serif" font-size="14.00">MLP2 GPU6</text>
<text text-anchor="middle" x="1022" y="-1626.5" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1022" y="-1611.5" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_6_gelu_gpu6&#45;&gt;layer_6_mlp2_gpu6 -->
<g id="edge476" class="edge">
<title>layer_6_gelu_gpu6&#45;&gt;layer_6_mlp2_gpu6</title>
<path fill="none" stroke="black" d="M1022,-1692.66C1022,-1685.02 1022,-1675.84 1022,-1666.93"/>
<polygon fill="black" stroke="black" points="1025.5,-1666.7 1022,-1656.7 1018.5,-1666.7 1025.5,-1666.7"/>
</g>
<!-- layer_6_mlp2_gpu7 -->
<g id="node383" class="node">
<title>layer_6_mlp2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="941,-1656.7 815,-1656.7 815,-1603.7 941,-1603.7 941,-1656.7"/>
<text text-anchor="middle" x="878" y="-1641.5" font-family="Times,serif" font-size="14.00">MLP2 GPU7</text>
<text text-anchor="middle" x="878" y="-1626.5" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="878" y="-1611.5" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_6_gelu_gpu7&#45;&gt;layer_6_mlp2_gpu7 -->
<g id="edge480" class="edge">
<title>layer_6_gelu_gpu7&#45;&gt;layer_6_mlp2_gpu7</title>
<path fill="none" stroke="black" d="M878,-1692.66C878,-1685.02 878,-1675.84 878,-1666.93"/>
<polygon fill="black" stroke="black" points="881.5,-1666.7 878,-1656.7 874.5,-1666.7 881.5,-1666.7"/>
</g>
<!-- layer_6_mlp_allreduce -->
<g id="node384" class="node">
<title>layer_6_mlp_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="1382" cy="-1540.83" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="1382" y="-1544.63" font-family="Times,serif" font-size="14.00">MLP AllReduce</text>
<text text-anchor="middle" x="1382" y="-1529.63" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_6_mlp2_gpu0&#45;&gt;layer_6_mlp_allreduce -->
<g id="edge453" class="edge">
<title>layer_6_mlp2_gpu0&#45;&gt;layer_6_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1823,-1606.09C1819.97,-1605.23 1816.96,-1604.43 1814,-1603.7 1699.59,-1575.54 1564.77,-1558.76 1476.56,-1549.93"/>
<polygon fill="black" stroke="black" points="1476.86,-1546.44 1466.57,-1548.94 1476.18,-1553.41 1476.86,-1546.44"/>
</g>
<!-- layer_6_mlp2_gpu1&#45;&gt;layer_6_mlp_allreduce -->
<g id="edge457" class="edge">
<title>layer_6_mlp2_gpu1&#45;&gt;layer_6_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1678.93,-1606.35C1675.92,-1605.42 1672.93,-1604.53 1670,-1603.7 1602.58,-1584.6 1524.82,-1568.23 1467.11,-1557.13"/>
<polygon fill="black" stroke="black" points="1467.42,-1553.62 1456.94,-1555.18 1466.1,-1560.5 1467.42,-1553.62"/>
</g>
<!-- layer_6_mlp2_gpu2&#45;&gt;layer_6_mlp_allreduce -->
<g id="edge461" class="edge">
<title>layer_6_mlp2_gpu2&#45;&gt;layer_6_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1534.94,-1603.69C1506.08,-1592.02 1472,-1578.24 1443.35,-1566.65"/>
<polygon fill="black" stroke="black" points="1444.44,-1563.31 1433.86,-1562.81 1441.81,-1569.8 1444.44,-1563.31"/>
</g>
<!-- layer_6_mlp2_gpu3&#45;&gt;layer_6_mlp_allreduce -->
<g id="edge465" class="edge">
<title>layer_6_mlp2_gpu3&#45;&gt;layer_6_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1432.79,-1603.46C1425.4,-1594.49 1417,-1584.31 1409.2,-1574.83"/>
<polygon fill="black" stroke="black" points="1411.87,-1572.58 1402.81,-1567.09 1406.47,-1577.03 1411.87,-1572.58"/>
</g>
<!-- layer_6_mlp2_gpu4&#45;&gt;layer_6_mlp_allreduce -->
<g id="edge469" class="edge">
<title>layer_6_mlp2_gpu4&#45;&gt;layer_6_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1331.21,-1603.46C1338.6,-1594.49 1347,-1584.31 1354.8,-1574.83"/>
<polygon fill="black" stroke="black" points="1357.53,-1577.03 1361.19,-1567.09 1352.13,-1572.58 1357.53,-1577.03"/>
</g>
<!-- layer_6_mlp2_gpu5&#45;&gt;layer_6_mlp_allreduce -->
<g id="edge473" class="edge">
<title>layer_6_mlp2_gpu5&#45;&gt;layer_6_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1229.06,-1603.69C1257.92,-1592.02 1292,-1578.24 1320.65,-1566.65"/>
<polygon fill="black" stroke="black" points="1322.19,-1569.8 1330.14,-1562.81 1319.56,-1563.31 1322.19,-1569.8"/>
</g>
<!-- layer_6_mlp2_gpu6&#45;&gt;layer_6_mlp_allreduce -->
<g id="edge477" class="edge">
<title>layer_6_mlp2_gpu6&#45;&gt;layer_6_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1085.07,-1606.35C1088.08,-1605.42 1091.07,-1604.53 1094,-1603.7 1161.42,-1584.6 1239.18,-1568.23 1296.89,-1557.13"/>
<polygon fill="black" stroke="black" points="1297.9,-1560.5 1307.06,-1555.18 1296.58,-1553.62 1297.9,-1560.5"/>
</g>
<!-- layer_6_mlp2_gpu7&#45;&gt;layer_6_mlp_allreduce -->
<g id="edge481" class="edge">
<title>layer_6_mlp2_gpu7&#45;&gt;layer_6_mlp_allreduce</title>
<path fill="none" stroke="black" d="M941,-1606.09C944.03,-1605.23 947.04,-1604.43 950,-1603.7 1064.41,-1575.54 1199.23,-1558.76 1287.44,-1549.93"/>
<polygon fill="black" stroke="black" points="1287.82,-1553.41 1297.43,-1548.94 1287.14,-1546.44 1287.82,-1553.41"/>
</g>
<!-- layer_6_residual2 -->
<g id="node385" class="node">
<title>layer_6_residual2</title>
<polygon fill="lightyellow" stroke="black" points="1510.61,-1477.96 1306.02,-1477.96 1253.39,-1401.96 1457.98,-1401.96 1510.61,-1477.96"/>
<text text-anchor="middle" x="1382" y="-1443.76" font-family="Times,serif" font-size="14.00">Residual Add 6</text>
<text text-anchor="middle" x="1382" y="-1428.76" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_6_mlp_allreduce&#45;&gt;layer_6_residual2 -->
<g id="edge482" class="edge">
<title>layer_6_mlp_allreduce&#45;&gt;layer_6_residual2</title>
<path fill="none" stroke="black" d="M1382,-1513.85C1382,-1506.04 1382,-1497.21 1382,-1488.46"/>
<polygon fill="black" stroke="black" points="1385.5,-1488.29 1382,-1478.29 1378.5,-1488.29 1385.5,-1488.29"/>
</g>
<!-- layer_6_ln2 -->
<g id="node386" class="node">
<title>layer_6_ln2</title>
<polygon fill="lightblue" stroke="black" points="1437.5,-1365.96 1326.5,-1365.96 1326.5,-1327.96 1437.5,-1327.96 1437.5,-1365.96"/>
<text text-anchor="middle" x="1382" y="-1350.76" font-family="Times,serif" font-size="14.00">LayerNorm 6</text>
<text text-anchor="middle" x="1382" y="-1335.76" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_6_residual2&#45;&gt;layer_6_ln2 -->
<g id="edge483" class="edge">
<title>layer_6_residual2&#45;&gt;layer_6_ln2</title>
<path fill="none" stroke="black" d="M1382,-1401.95C1382,-1393.33 1382,-1384.28 1382,-1376.12"/>
<polygon fill="black" stroke="black" points="1385.5,-1375.99 1382,-1365.99 1378.5,-1375.99 1385.5,-1375.99"/>
</g>
<!-- layer_7_qkv_gpu0 -->
<g id="node387" class="node">
<title>layer_7_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1446,-1288.96 1318,-1288.96 1318,-1235.96 1446,-1235.96 1446,-1288.96"/>
<text text-anchor="middle" x="1382" y="-1273.76" font-family="Times,serif" font-size="14.00">QKV Proj GPU0</text>
<text text-anchor="middle" x="1382" y="-1258.76" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1382" y="-1243.76" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_6_ln2&#45;&gt;layer_7_qkv_gpu0 -->
<g id="edge484" class="edge">
<title>layer_6_ln2&#45;&gt;layer_7_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1382,-1327.65C1382,-1319.35 1382,-1309.24 1382,-1299.52"/>
<polygon fill="black" stroke="black" points="1385.5,-1299.23 1382,-1289.23 1378.5,-1299.23 1385.5,-1299.23"/>
</g>
<!-- layer_7_qkv_comm -->
<g id="node395" class="node">
<title>layer_7_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="871" cy="-1173.09" rx="85.62" ry="26.74"/>
<text text-anchor="middle" x="871" y="-1176.89" font-family="Times,serif" font-size="14.00">QKV AllGather</text>
<text text-anchor="middle" x="871" y="-1161.89" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_7_qkv_gpu0&#45;&gt;layer_7_qkv_comm -->
<g id="edge485" class="edge">
<title>layer_7_qkv_gpu0&#45;&gt;layer_7_qkv_comm</title>
<path fill="none" stroke="black" d="M1317.72,-1238.24C1314.79,-1237.42 1311.87,-1236.66 1309,-1235.96 1191.33,-1207.39 1052.46,-1190.54 963.13,-1181.82"/>
<polygon fill="black" stroke="black" points="963.32,-1178.32 953.03,-1180.84 962.65,-1185.29 963.32,-1178.32"/>
</g>
<!-- layer_7_qkv_gpu1 -->
<g id="node388" class="node">
<title>layer_7_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1300,-1288.96 1172,-1288.96 1172,-1235.96 1300,-1235.96 1300,-1288.96"/>
<text text-anchor="middle" x="1236" y="-1273.76" font-family="Times,serif" font-size="14.00">QKV Proj GPU1</text>
<text text-anchor="middle" x="1236" y="-1258.76" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1236" y="-1243.76" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_7_qkv_gpu1&#45;&gt;layer_7_qkv_comm -->
<g id="edge486" class="edge">
<title>layer_7_qkv_gpu1&#45;&gt;layer_7_qkv_comm</title>
<path fill="none" stroke="black" d="M1171.65,-1238.48C1168.74,-1237.6 1165.84,-1236.76 1163,-1235.96 1093.53,-1216.55 1013.28,-1199.96 954.5,-1188.86"/>
<polygon fill="black" stroke="black" points="955,-1185.39 944.53,-1186.98 953.71,-1192.27 955,-1185.39"/>
</g>
<!-- layer_7_qkv_gpu2 -->
<g id="node389" class="node">
<title>layer_7_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1154,-1288.96 1026,-1288.96 1026,-1235.96 1154,-1235.96 1154,-1288.96"/>
<text text-anchor="middle" x="1090" y="-1273.76" font-family="Times,serif" font-size="14.00">QKV Proj GPU2</text>
<text text-anchor="middle" x="1090" y="-1258.76" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1090" y="-1243.76" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_7_qkv_gpu2&#45;&gt;layer_7_qkv_comm -->
<g id="edge487" class="edge">
<title>layer_7_qkv_gpu2&#45;&gt;layer_7_qkv_comm</title>
<path fill="none" stroke="black" d="M1026.07,-1235.95C996.33,-1224.09 961.14,-1210.05 931.81,-1198.35"/>
<polygon fill="black" stroke="black" points="933.09,-1195.09 922.5,-1194.64 930.5,-1201.59 933.09,-1195.09"/>
</g>
<!-- layer_7_qkv_gpu3 -->
<g id="node390" class="node">
<title>layer_7_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1008,-1288.96 880,-1288.96 880,-1235.96 1008,-1235.96 1008,-1288.96"/>
<text text-anchor="middle" x="944" y="-1273.76" font-family="Times,serif" font-size="14.00">QKV Proj GPU3</text>
<text text-anchor="middle" x="944" y="-1258.76" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="944" y="-1243.76" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_7_qkv_gpu3&#45;&gt;layer_7_qkv_comm -->
<g id="edge488" class="edge">
<title>layer_7_qkv_gpu3&#45;&gt;layer_7_qkv_comm</title>
<path fill="none" stroke="black" d="M922.49,-1235.72C915,-1226.75 906.49,-1216.57 898.58,-1207.09"/>
<polygon fill="black" stroke="black" points="901.2,-1204.78 892.1,-1199.35 895.83,-1209.26 901.2,-1204.78"/>
</g>
<!-- layer_7_qkv_gpu4 -->
<g id="node391" class="node">
<title>layer_7_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="862,-1288.96 734,-1288.96 734,-1235.96 862,-1235.96 862,-1288.96"/>
<text text-anchor="middle" x="798" y="-1273.76" font-family="Times,serif" font-size="14.00">QKV Proj GPU4</text>
<text text-anchor="middle" x="798" y="-1258.76" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="798" y="-1243.76" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_7_qkv_gpu4&#45;&gt;layer_7_qkv_comm -->
<g id="edge489" class="edge">
<title>layer_7_qkv_gpu4&#45;&gt;layer_7_qkv_comm</title>
<path fill="none" stroke="black" d="M819.51,-1235.72C827,-1226.75 835.51,-1216.57 843.42,-1207.09"/>
<polygon fill="black" stroke="black" points="846.17,-1209.26 849.9,-1199.35 840.8,-1204.78 846.17,-1209.26"/>
</g>
<!-- layer_7_qkv_gpu5 -->
<g id="node392" class="node">
<title>layer_7_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="716,-1288.96 588,-1288.96 588,-1235.96 716,-1235.96 716,-1288.96"/>
<text text-anchor="middle" x="652" y="-1273.76" font-family="Times,serif" font-size="14.00">QKV Proj GPU5</text>
<text text-anchor="middle" x="652" y="-1258.76" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="652" y="-1243.76" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_7_qkv_gpu5&#45;&gt;layer_7_qkv_comm -->
<g id="edge490" class="edge">
<title>layer_7_qkv_gpu5&#45;&gt;layer_7_qkv_comm</title>
<path fill="none" stroke="black" d="M715.93,-1235.95C745.67,-1224.09 780.86,-1210.05 810.19,-1198.35"/>
<polygon fill="black" stroke="black" points="811.5,-1201.59 819.5,-1194.64 808.91,-1195.09 811.5,-1201.59"/>
</g>
<!-- layer_7_qkv_gpu6 -->
<g id="node393" class="node">
<title>layer_7_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="570,-1288.96 442,-1288.96 442,-1235.96 570,-1235.96 570,-1288.96"/>
<text text-anchor="middle" x="506" y="-1273.76" font-family="Times,serif" font-size="14.00">QKV Proj GPU6</text>
<text text-anchor="middle" x="506" y="-1258.76" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="506" y="-1243.76" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_7_qkv_gpu6&#45;&gt;layer_7_qkv_comm -->
<g id="edge491" class="edge">
<title>layer_7_qkv_gpu6&#45;&gt;layer_7_qkv_comm</title>
<path fill="none" stroke="black" d="M570.35,-1238.48C573.26,-1237.6 576.16,-1236.76 579,-1235.96 648.47,-1216.55 728.72,-1199.96 787.5,-1188.86"/>
<polygon fill="black" stroke="black" points="788.29,-1192.27 797.47,-1186.98 787,-1185.39 788.29,-1192.27"/>
</g>
<!-- layer_7_qkv_gpu7 -->
<g id="node394" class="node">
<title>layer_7_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="424,-1288.96 296,-1288.96 296,-1235.96 424,-1235.96 424,-1288.96"/>
<text text-anchor="middle" x="360" y="-1273.76" font-family="Times,serif" font-size="14.00">QKV Proj GPU7</text>
<text text-anchor="middle" x="360" y="-1258.76" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="360" y="-1243.76" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_7_qkv_gpu7&#45;&gt;layer_7_qkv_comm -->
<g id="edge492" class="edge">
<title>layer_7_qkv_gpu7&#45;&gt;layer_7_qkv_comm</title>
<path fill="none" stroke="black" d="M424.28,-1238.24C427.21,-1237.42 430.13,-1236.66 433,-1235.96 550.67,-1207.39 689.54,-1190.54 778.87,-1181.82"/>
<polygon fill="black" stroke="black" points="779.35,-1185.29 788.97,-1180.84 778.68,-1178.32 779.35,-1185.29"/>
</g>
<!-- layer_7_attn_comp_gpu0 -->
<g id="node396" class="node">
<title>layer_7_attn_comp_gpu0</title>
<polygon fill="lightblue" stroke="black" points="214,-1110.22 16,-1110.22 16,-1057.22 214,-1057.22 214,-1110.22"/>
<text text-anchor="middle" x="115" y="-1095.02" font-family="Times,serif" font-size="14.00">Attention Compute GPU0</text>
<text text-anchor="middle" x="115" y="-1080.02" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="115" y="-1065.02" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_7_qkv_comm&#45;&gt;layer_7_attn_comp_gpu0 -->
<g id="edge493" class="edge">
<title>layer_7_qkv_comm&#45;&gt;layer_7_attn_comp_gpu0</title>
<path fill="none" stroke="black" d="M786.9,-1167.74C664.86,-1160.61 431.52,-1143.91 224.22,-1110.33"/>
<polygon fill="black" stroke="black" points="224.49,-1106.83 214.06,-1108.66 223.36,-1113.73 224.49,-1106.83"/>
</g>
<!-- layer_7_attn_comp_gpu1 -->
<g id="node397" class="node">
<title>layer_7_attn_comp_gpu1</title>
<polygon fill="lightblue" stroke="black" points="430,-1110.22 232,-1110.22 232,-1057.22 430,-1057.22 430,-1110.22"/>
<text text-anchor="middle" x="331" y="-1095.02" font-family="Times,serif" font-size="14.00">Attention Compute GPU1</text>
<text text-anchor="middle" x="331" y="-1080.02" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="331" y="-1065.02" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_7_qkv_comm&#45;&gt;layer_7_attn_comp_gpu1 -->
<g id="edge494" class="edge">
<title>layer_7_qkv_comm&#45;&gt;layer_7_attn_comp_gpu1</title>
<path fill="none" stroke="black" d="M791.42,-1162.86C706.69,-1152.55 568.51,-1134.32 440.11,-1110.36"/>
<polygon fill="black" stroke="black" points="440.57,-1106.89 430.09,-1108.48 439.27,-1113.77 440.57,-1106.89"/>
</g>
<!-- layer_7_attn_comp_gpu2 -->
<g id="node398" class="node">
<title>layer_7_attn_comp_gpu2</title>
<polygon fill="lightblue" stroke="black" points="646,-1110.22 448,-1110.22 448,-1057.22 646,-1057.22 646,-1110.22"/>
<text text-anchor="middle" x="547" y="-1095.02" font-family="Times,serif" font-size="14.00">Attention Compute GPU2</text>
<text text-anchor="middle" x="547" y="-1080.02" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="547" y="-1065.02" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_7_qkv_comm&#45;&gt;layer_7_attn_comp_gpu2 -->
<g id="edge495" class="edge">
<title>layer_7_qkv_comm&#45;&gt;layer_7_attn_comp_gpu2</title>
<path fill="none" stroke="black" d="M807.37,-1154.93C763.05,-1142.98 702.92,-1126.77 651.61,-1112.93"/>
<polygon fill="black" stroke="black" points="652.37,-1109.51 641.8,-1110.29 650.55,-1116.27 652.37,-1109.51"/>
</g>
<!-- layer_7_attn_comp_gpu3 -->
<g id="node399" class="node">
<title>layer_7_attn_comp_gpu3</title>
<polygon fill="lightblue" stroke="black" points="862,-1110.22 664,-1110.22 664,-1057.22 862,-1057.22 862,-1110.22"/>
<text text-anchor="middle" x="763" y="-1095.02" font-family="Times,serif" font-size="14.00">Attention Compute GPU3</text>
<text text-anchor="middle" x="763" y="-1080.02" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="763" y="-1065.02" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_7_qkv_comm&#45;&gt;layer_7_attn_comp_gpu3 -->
<g id="edge496" class="edge">
<title>layer_7_qkv_comm&#45;&gt;layer_7_attn_comp_gpu3</title>
<path fill="none" stroke="black" d="M840.92,-1147.75C829.14,-1138.23 815.46,-1127.16 802.88,-1116.99"/>
<polygon fill="black" stroke="black" points="804.78,-1114.02 794.81,-1110.45 800.38,-1119.46 804.78,-1114.02"/>
</g>
<!-- layer_7_attn_comp_gpu4 -->
<g id="node400" class="node">
<title>layer_7_attn_comp_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1078,-1110.22 880,-1110.22 880,-1057.22 1078,-1057.22 1078,-1110.22"/>
<text text-anchor="middle" x="979" y="-1095.02" font-family="Times,serif" font-size="14.00">Attention Compute GPU4</text>
<text text-anchor="middle" x="979" y="-1080.02" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="979" y="-1065.02" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_7_qkv_comm&#45;&gt;layer_7_attn_comp_gpu4 -->
<g id="edge497" class="edge">
<title>layer_7_qkv_comm&#45;&gt;layer_7_attn_comp_gpu4</title>
<path fill="none" stroke="black" d="M901.08,-1147.75C912.86,-1138.23 926.54,-1127.16 939.12,-1116.99"/>
<polygon fill="black" stroke="black" points="941.62,-1119.46 947.19,-1110.45 937.22,-1114.02 941.62,-1119.46"/>
</g>
<!-- layer_7_attn_comp_gpu5 -->
<g id="node401" class="node">
<title>layer_7_attn_comp_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1294,-1110.22 1096,-1110.22 1096,-1057.22 1294,-1057.22 1294,-1110.22"/>
<text text-anchor="middle" x="1195" y="-1095.02" font-family="Times,serif" font-size="14.00">Attention Compute GPU5</text>
<text text-anchor="middle" x="1195" y="-1080.02" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="1195" y="-1065.02" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_7_qkv_comm&#45;&gt;layer_7_attn_comp_gpu5 -->
<g id="edge498" class="edge">
<title>layer_7_qkv_comm&#45;&gt;layer_7_attn_comp_gpu5</title>
<path fill="none" stroke="black" d="M934.63,-1154.93C978.95,-1142.98 1039.08,-1126.77 1090.39,-1112.93"/>
<polygon fill="black" stroke="black" points="1091.45,-1116.27 1100.2,-1110.29 1089.63,-1109.51 1091.45,-1116.27"/>
</g>
<!-- layer_7_attn_comp_gpu6 -->
<g id="node402" class="node">
<title>layer_7_attn_comp_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1510,-1110.22 1312,-1110.22 1312,-1057.22 1510,-1057.22 1510,-1110.22"/>
<text text-anchor="middle" x="1411" y="-1095.02" font-family="Times,serif" font-size="14.00">Attention Compute GPU6</text>
<text text-anchor="middle" x="1411" y="-1080.02" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="1411" y="-1065.02" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_7_qkv_comm&#45;&gt;layer_7_attn_comp_gpu6 -->
<g id="edge499" class="edge">
<title>layer_7_qkv_comm&#45;&gt;layer_7_attn_comp_gpu6</title>
<path fill="none" stroke="black" d="M950.58,-1162.86C1035.31,-1152.55 1173.49,-1134.32 1301.89,-1110.36"/>
<polygon fill="black" stroke="black" points="1302.73,-1113.77 1311.91,-1108.48 1301.43,-1106.89 1302.73,-1113.77"/>
</g>
<!-- layer_7_attn_comp_gpu7 -->
<g id="node403" class="node">
<title>layer_7_attn_comp_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1726,-1110.22 1528,-1110.22 1528,-1057.22 1726,-1057.22 1726,-1110.22"/>
<text text-anchor="middle" x="1627" y="-1095.02" font-family="Times,serif" font-size="14.00">Attention Compute GPU7</text>
<text text-anchor="middle" x="1627" y="-1080.02" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="1627" y="-1065.02" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_7_qkv_comm&#45;&gt;layer_7_attn_comp_gpu7 -->
<g id="edge500" class="edge">
<title>layer_7_qkv_comm&#45;&gt;layer_7_attn_comp_gpu7</title>
<path fill="none" stroke="black" d="M955.1,-1167.74C1077.14,-1160.61 1310.48,-1143.91 1517.78,-1110.33"/>
<polygon fill="black" stroke="black" points="1518.64,-1113.73 1527.94,-1108.66 1517.51,-1106.83 1518.64,-1113.73"/>
</g>
<!-- layer_7_attn_out_gpu0 -->
<g id="node404" class="node">
<title>layer_7_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="231,-1021.22 73,-1021.22 73,-968.22 231,-968.22 231,-1021.22"/>
<text text-anchor="middle" x="152" y="-1006.02" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU0</text>
<text text-anchor="middle" x="152" y="-991.02" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="152" y="-976.02" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_7_attn_comp_gpu0&#45;&gt;layer_7_attn_out_gpu0 -->
<g id="edge501" class="edge">
<title>layer_7_attn_comp_gpu0&#45;&gt;layer_7_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M125.9,-1057.09C129.41,-1048.84 133.36,-1039.56 137.1,-1030.76"/>
<polygon fill="black" stroke="black" points="140.36,-1032.04 141.05,-1021.47 133.91,-1029.3 140.36,-1032.04"/>
</g>
<!-- layer_7_attn_out_gpu1 -->
<g id="node405" class="node">
<title>layer_7_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="445,-1021.22 287,-1021.22 287,-968.22 445,-968.22 445,-1021.22"/>
<text text-anchor="middle" x="366" y="-1006.02" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU1</text>
<text text-anchor="middle" x="366" y="-991.02" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="366" y="-976.02" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_7_attn_comp_gpu1&#45;&gt;layer_7_attn_out_gpu1 -->
<g id="edge502" class="edge">
<title>layer_7_attn_comp_gpu1&#45;&gt;layer_7_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M341.31,-1057.09C344.63,-1048.84 348.36,-1039.56 351.9,-1030.76"/>
<polygon fill="black" stroke="black" points="355.16,-1032.05 355.64,-1021.47 348.66,-1029.44 355.16,-1032.05"/>
</g>
<!-- layer_7_attn_out_gpu2 -->
<g id="node406" class="node">
<title>layer_7_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="656,-1021.22 498,-1021.22 498,-968.22 656,-968.22 656,-1021.22"/>
<text text-anchor="middle" x="577" y="-1006.02" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU2</text>
<text text-anchor="middle" x="577" y="-991.02" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="577" y="-976.02" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_7_attn_comp_gpu2&#45;&gt;layer_7_attn_out_gpu2 -->
<g id="edge503" class="edge">
<title>layer_7_attn_comp_gpu2&#45;&gt;layer_7_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M555.84,-1057.09C558.65,-1048.93 561.81,-1039.76 564.82,-1031.04"/>
<polygon fill="black" stroke="black" points="568.17,-1032.06 568.12,-1021.47 561.55,-1029.78 568.17,-1032.06"/>
</g>
<!-- layer_7_attn_out_gpu3 -->
<g id="node407" class="node">
<title>layer_7_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="852,-1021.22 694,-1021.22 694,-968.22 852,-968.22 852,-1021.22"/>
<text text-anchor="middle" x="773" y="-1006.02" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU3</text>
<text text-anchor="middle" x="773" y="-991.02" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="773" y="-976.02" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_7_attn_comp_gpu3&#45;&gt;layer_7_attn_out_gpu3 -->
<g id="edge504" class="edge">
<title>layer_7_attn_comp_gpu3&#45;&gt;layer_7_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M765.95,-1057.09C766.86,-1049.11 767.89,-1040.15 768.88,-1031.6"/>
<polygon fill="black" stroke="black" points="772.38,-1031.8 770.04,-1021.47 765.42,-1031 772.38,-1031.8"/>
</g>
<!-- layer_7_attn_out_gpu4 -->
<g id="node408" class="node">
<title>layer_7_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1048,-1021.22 890,-1021.22 890,-968.22 1048,-968.22 1048,-1021.22"/>
<text text-anchor="middle" x="969" y="-1006.02" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU4</text>
<text text-anchor="middle" x="969" y="-991.02" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="969" y="-976.02" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_7_attn_comp_gpu4&#45;&gt;layer_7_attn_out_gpu4 -->
<g id="edge505" class="edge">
<title>layer_7_attn_comp_gpu4&#45;&gt;layer_7_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M976.05,-1057.09C975.14,-1049.11 974.11,-1040.15 973.12,-1031.6"/>
<polygon fill="black" stroke="black" points="976.58,-1031 971.96,-1021.47 969.62,-1031.8 976.58,-1031"/>
</g>
<!-- layer_7_attn_out_gpu5 -->
<g id="node409" class="node">
<title>layer_7_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1254,-1021.22 1096,-1021.22 1096,-968.22 1254,-968.22 1254,-1021.22"/>
<text text-anchor="middle" x="1175" y="-1006.02" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU5</text>
<text text-anchor="middle" x="1175" y="-991.02" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1175" y="-976.02" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_7_attn_comp_gpu5&#45;&gt;layer_7_attn_out_gpu5 -->
<g id="edge506" class="edge">
<title>layer_7_attn_comp_gpu5&#45;&gt;layer_7_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M1189.11,-1057.09C1187.25,-1049.02 1185.17,-1039.96 1183.18,-1031.32"/>
<polygon fill="black" stroke="black" points="1186.57,-1030.43 1180.92,-1021.47 1179.75,-1032 1186.57,-1030.43"/>
</g>
<!-- layer_7_attn_out_gpu6 -->
<g id="node410" class="node">
<title>layer_7_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1465,-1021.22 1307,-1021.22 1307,-968.22 1465,-968.22 1465,-1021.22"/>
<text text-anchor="middle" x="1386" y="-1006.02" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU6</text>
<text text-anchor="middle" x="1386" y="-991.02" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1386" y="-976.02" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_7_attn_comp_gpu6&#45;&gt;layer_7_attn_out_gpu6 -->
<g id="edge507" class="edge">
<title>layer_7_attn_comp_gpu6&#45;&gt;layer_7_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M1403.63,-1057.09C1401.32,-1049.02 1398.71,-1039.96 1396.23,-1031.32"/>
<polygon fill="black" stroke="black" points="1399.53,-1030.11 1393.4,-1021.47 1392.8,-1032.05 1399.53,-1030.11"/>
</g>
<!-- layer_7_attn_out_gpu7 -->
<g id="node411" class="node">
<title>layer_7_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1678,-1021.22 1520,-1021.22 1520,-968.22 1678,-968.22 1678,-1021.22"/>
<text text-anchor="middle" x="1599" y="-1006.02" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU7</text>
<text text-anchor="middle" x="1599" y="-991.02" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1599" y="-976.02" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_7_attn_comp_gpu7&#45;&gt;layer_7_attn_out_gpu7 -->
<g id="edge508" class="edge">
<title>layer_7_attn_comp_gpu7&#45;&gt;layer_7_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M1618.75,-1057.09C1616.13,-1048.93 1613.17,-1039.76 1610.37,-1031.04"/>
<polygon fill="black" stroke="black" points="1613.68,-1029.92 1607.29,-1021.47 1607.02,-1032.06 1613.68,-1029.92"/>
</g>
<!-- layer_7_attn_allreduce -->
<g id="node412" class="node">
<title>layer_7_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="871" cy="-905.35" rx="112.36" ry="26.74"/>
<text text-anchor="middle" x="871" y="-909.15" font-family="Times,serif" font-size="14.00">Attention AllReduce</text>
<text text-anchor="middle" x="871" y="-894.15" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_7_attn_out_gpu0&#45;&gt;layer_7_attn_allreduce -->
<g id="edge509" class="edge">
<title>layer_7_attn_out_gpu0&#45;&gt;layer_7_attn_allreduce</title>
<path fill="none" stroke="black" d="M231.11,-976.51C246.61,-973.48 262.78,-970.55 278,-968.22 442.67,-943.03 634.65,-925.06 754.53,-915.19"/>
<polygon fill="black" stroke="black" points="755.15,-918.65 764.83,-914.34 754.58,-911.67 755.15,-918.65"/>
</g>
<!-- layer_7_attn_out_gpu1&#45;&gt;layer_7_attn_allreduce -->
<g id="edge510" class="edge">
<title>layer_7_attn_out_gpu1&#45;&gt;layer_7_attn_allreduce</title>
<path fill="none" stroke="black" d="M445.3,-976.75C459.81,-973.79 474.85,-970.83 489,-968.22 582.9,-950.89 690.27,-933.74 767.22,-921.9"/>
<polygon fill="black" stroke="black" points="768.04,-925.32 777.39,-920.34 766.98,-918.4 768.04,-925.32"/>
</g>
<!-- layer_7_attn_out_gpu2&#45;&gt;layer_7_attn_allreduce -->
<g id="edge511" class="edge">
<title>layer_7_attn_out_gpu2&#45;&gt;layer_7_attn_allreduce</title>
<path fill="none" stroke="black" d="M656.17,-970.19C698.46,-957.63 750.34,-942.21 792.52,-929.67"/>
<polygon fill="black" stroke="black" points="793.6,-933 802.19,-926.8 791.61,-926.29 793.6,-933"/>
</g>
<!-- layer_7_attn_out_gpu3&#45;&gt;layer_7_attn_allreduce -->
<g id="edge512" class="edge">
<title>layer_7_attn_out_gpu3&#45;&gt;layer_7_attn_allreduce</title>
<path fill="none" stroke="black" d="M801.61,-968.21C812.17,-958.8 824.26,-948.02 835.37,-938.12"/>
<polygon fill="black" stroke="black" points="837.73,-940.7 842.86,-931.44 833.07,-935.48 837.73,-940.7"/>
</g>
<!-- layer_7_attn_out_gpu4&#45;&gt;layer_7_attn_allreduce -->
<g id="edge513" class="edge">
<title>layer_7_attn_out_gpu4&#45;&gt;layer_7_attn_allreduce</title>
<path fill="none" stroke="black" d="M940.39,-968.21C929.83,-958.8 917.74,-948.02 906.63,-938.12"/>
<polygon fill="black" stroke="black" points="908.93,-935.48 899.14,-931.44 904.27,-940.7 908.93,-935.48"/>
</g>
<!-- layer_7_attn_out_gpu5&#45;&gt;layer_7_attn_allreduce -->
<g id="edge514" class="edge">
<title>layer_7_attn_out_gpu5&#45;&gt;layer_7_attn_allreduce</title>
<path fill="none" stroke="black" d="M1095.92,-970.99C1051.18,-958.13 995.38,-942.1 950.56,-929.22"/>
<polygon fill="black" stroke="black" points="951.46,-925.83 940.88,-926.43 949.52,-932.56 951.46,-925.83"/>
</g>
<!-- layer_7_attn_out_gpu6&#45;&gt;layer_7_attn_allreduce -->
<g id="edge515" class="edge">
<title>layer_7_attn_out_gpu6&#45;&gt;layer_7_attn_allreduce</title>
<path fill="none" stroke="black" d="M1306.71,-976.7C1292.19,-973.75 1277.16,-970.8 1263,-968.22 1165.83,-950.49 1054.55,-933.21 975.44,-921.44"/>
<polygon fill="black" stroke="black" points="975.88,-917.97 965.47,-919.96 974.85,-924.89 975.88,-917.97"/>
</g>
<!-- layer_7_attn_out_gpu7&#45;&gt;layer_7_attn_allreduce -->
<g id="edge516" class="edge">
<title>layer_7_attn_out_gpu7&#45;&gt;layer_7_attn_allreduce</title>
<path fill="none" stroke="black" d="M1519.86,-976.35C1504.69,-973.36 1488.89,-970.5 1474,-968.22 1305.78,-942.5 1109.49,-924.58 987.7,-914.88"/>
<polygon fill="black" stroke="black" points="987.85,-911.38 977.61,-914.08 987.3,-918.36 987.85,-911.38"/>
</g>
<!-- layer_7_residual1 -->
<g id="node413" class="node">
<title>layer_7_residual1</title>
<polygon fill="lightyellow" stroke="black" points="999.61,-842.48 795.02,-842.48 742.39,-766.48 946.98,-766.48 999.61,-842.48"/>
<text text-anchor="middle" x="871" y="-808.28" font-family="Times,serif" font-size="14.00">Residual Add 7</text>
<text text-anchor="middle" x="871" y="-793.28" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_7_attn_allreduce&#45;&gt;layer_7_residual1 -->
<g id="edge517" class="edge">
<title>layer_7_attn_allreduce&#45;&gt;layer_7_residual1</title>
<path fill="none" stroke="black" d="M871,-878.37C871,-870.56 871,-861.73 871,-852.98"/>
<polygon fill="black" stroke="black" points="874.5,-852.81 871,-842.81 867.5,-852.81 874.5,-852.81"/>
</g>
<!-- layer_7_ln1 -->
<g id="node414" class="node">
<title>layer_7_ln1</title>
<polygon fill="lightblue" stroke="black" points="926.5,-730.48 815.5,-730.48 815.5,-692.48 926.5,-692.48 926.5,-730.48"/>
<text text-anchor="middle" x="871" y="-715.28" font-family="Times,serif" font-size="14.00">LayerNorm 7</text>
<text text-anchor="middle" x="871" y="-700.28" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_7_residual1&#45;&gt;layer_7_ln1 -->
<g id="edge518" class="edge">
<title>layer_7_residual1&#45;&gt;layer_7_ln1</title>
<path fill="none" stroke="black" d="M871,-766.47C871,-757.85 871,-748.8 871,-740.63"/>
<polygon fill="black" stroke="black" points="874.5,-740.51 871,-730.51 867.5,-740.51 874.5,-740.51"/>
</g>
<!-- layer_7_mlp1_gpu0 -->
<g id="node415" class="node">
<title>layer_7_mlp1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1438,-653.48 1312,-653.48 1312,-600.48 1438,-600.48 1438,-653.48"/>
<text text-anchor="middle" x="1375" y="-638.28" font-family="Times,serif" font-size="14.00">MLP1 GPU0</text>
<text text-anchor="middle" x="1375" y="-623.28" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1375" y="-608.28" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp1_gpu0 -->
<g id="edge519" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp1_gpu0</title>
<path fill="none" stroke="black" d="M926.64,-711.22C1027.37,-711.89 1235.74,-710.01 1303,-684.48 1317.24,-679.07 1330.92,-669.79 1342.45,-660.3"/>
<polygon fill="black" stroke="black" points="1344.78,-662.91 1350.07,-653.73 1340.21,-657.61 1344.78,-662.91"/>
</g>
<!-- layer_7_mlp1_gpu1 -->
<g id="node416" class="node">
<title>layer_7_mlp1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1294,-653.48 1168,-653.48 1168,-600.48 1294,-600.48 1294,-653.48"/>
<text text-anchor="middle" x="1231" y="-638.28" font-family="Times,serif" font-size="14.00">MLP1 GPU1</text>
<text text-anchor="middle" x="1231" y="-623.28" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1231" y="-608.28" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp1_gpu1 -->
<g id="edge523" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp1_gpu1</title>
<path fill="none" stroke="black" d="M926.68,-709.19C998.24,-706.9 1118.11,-700.7 1159,-684.48 1173.16,-678.86 1186.81,-669.53 1198.35,-660.05"/>
<polygon fill="black" stroke="black" points="1200.67,-662.67 1205.98,-653.51 1196.11,-657.36 1200.67,-662.67"/>
</g>
<!-- layer_7_mlp1_gpu2 -->
<g id="node417" class="node">
<title>layer_7_mlp1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1150,-653.48 1024,-653.48 1024,-600.48 1150,-600.48 1150,-653.48"/>
<text text-anchor="middle" x="1087" y="-638.28" font-family="Times,serif" font-size="14.00">MLP1 GPU2</text>
<text text-anchor="middle" x="1087" y="-623.28" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1087" y="-608.28" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp1_gpu2 -->
<g id="edge527" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp1_gpu2</title>
<path fill="none" stroke="black" d="M926.54,-706.79C954.09,-703.41 987.31,-696.91 1015,-684.48 1028.41,-678.46 1041.54,-669.41 1052.83,-660.3"/>
<polygon fill="black" stroke="black" points="1055.29,-662.81 1060.71,-653.71 1050.79,-657.44 1055.29,-662.81"/>
</g>
<!-- layer_7_mlp1_gpu3 -->
<g id="node418" class="node">
<title>layer_7_mlp1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1006,-653.48 880,-653.48 880,-600.48 1006,-600.48 1006,-653.48"/>
<text text-anchor="middle" x="943" y="-638.28" font-family="Times,serif" font-size="14.00">MLP1 GPU3</text>
<text text-anchor="middle" x="943" y="-623.28" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="943" y="-608.28" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp1_gpu3 -->
<g id="edge531" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp1_gpu3</title>
<path fill="none" stroke="black" d="M886.98,-692.17C894.84,-683.17 904.56,-672.03 913.69,-661.57"/>
<polygon fill="black" stroke="black" points="916.57,-663.58 920.51,-653.75 911.3,-658.98 916.57,-663.58"/>
</g>
<!-- layer_7_mlp1_gpu4 -->
<g id="node419" class="node">
<title>layer_7_mlp1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="862,-653.48 736,-653.48 736,-600.48 862,-600.48 862,-653.48"/>
<text text-anchor="middle" x="799" y="-638.28" font-family="Times,serif" font-size="14.00">MLP1 GPU4</text>
<text text-anchor="middle" x="799" y="-623.28" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="799" y="-608.28" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp1_gpu4 -->
<g id="edge535" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp1_gpu4</title>
<path fill="none" stroke="black" d="M855.02,-692.17C847.16,-683.17 837.44,-672.03 828.31,-661.57"/>
<polygon fill="black" stroke="black" points="830.7,-658.98 821.49,-653.75 825.43,-663.58 830.7,-658.98"/>
</g>
<!-- layer_7_mlp1_gpu5 -->
<g id="node420" class="node">
<title>layer_7_mlp1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="718,-653.48 592,-653.48 592,-600.48 718,-600.48 718,-653.48"/>
<text text-anchor="middle" x="655" y="-638.28" font-family="Times,serif" font-size="14.00">MLP1 GPU5</text>
<text text-anchor="middle" x="655" y="-623.28" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="655" y="-608.28" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp1_gpu5 -->
<g id="edge539" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp1_gpu5</title>
<path fill="none" stroke="black" d="M815.46,-706.79C787.91,-703.41 754.69,-696.91 727,-684.48 713.59,-678.46 700.46,-669.41 689.17,-660.3"/>
<polygon fill="black" stroke="black" points="691.21,-657.44 681.29,-653.71 686.71,-662.81 691.21,-657.44"/>
</g>
<!-- layer_7_mlp1_gpu6 -->
<g id="node421" class="node">
<title>layer_7_mlp1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="574,-653.48 448,-653.48 448,-600.48 574,-600.48 574,-653.48"/>
<text text-anchor="middle" x="511" y="-638.28" font-family="Times,serif" font-size="14.00">MLP1 GPU6</text>
<text text-anchor="middle" x="511" y="-623.28" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="511" y="-608.28" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp1_gpu6 -->
<g id="edge543" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp1_gpu6</title>
<path fill="none" stroke="black" d="M815.32,-709.19C743.76,-706.9 623.89,-700.7 583,-684.48 568.84,-678.86 555.19,-669.53 543.65,-660.05"/>
<polygon fill="black" stroke="black" points="545.89,-657.36 536.02,-653.51 541.33,-662.67 545.89,-657.36"/>
</g>
<!-- layer_7_mlp1_gpu7 -->
<g id="node422" class="node">
<title>layer_7_mlp1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="430,-653.48 304,-653.48 304,-600.48 430,-600.48 430,-653.48"/>
<text text-anchor="middle" x="367" y="-638.28" font-family="Times,serif" font-size="14.00">MLP1 GPU7</text>
<text text-anchor="middle" x="367" y="-623.28" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="367" y="-608.28" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp1_gpu7 -->
<g id="edge547" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp1_gpu7</title>
<path fill="none" stroke="black" d="M815.36,-711.22C714.63,-711.89 506.26,-710.01 439,-684.48 424.76,-679.07 411.08,-669.79 399.55,-660.3"/>
<polygon fill="black" stroke="black" points="401.79,-657.61 391.93,-653.73 397.22,-662.91 401.79,-657.61"/>
</g>
<!-- layer_7_gelu_gpu0 -->
<g id="node423" class="node">
<title>layer_7_gelu_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1427,-564.48 1323,-564.48 1323,-526.48 1427,-526.48 1427,-564.48"/>
<text text-anchor="middle" x="1375" y="-549.28" font-family="Times,serif" font-size="14.00">GELU GPU0</text>
<text text-anchor="middle" x="1375" y="-534.28" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_7_mlp1_gpu0&#45;&gt;layer_7_gelu_gpu0 -->
<g id="edge520" class="edge">
<title>layer_7_mlp1_gpu0&#45;&gt;layer_7_gelu_gpu0</title>
<path fill="none" stroke="black" d="M1375,-600.39C1375,-592.22 1375,-583.13 1375,-574.78"/>
<polygon fill="black" stroke="black" points="1378.5,-574.72 1375,-564.72 1371.5,-574.72 1378.5,-574.72"/>
</g>
<!-- layer_7_gelu_gpu1 -->
<g id="node424" class="node">
<title>layer_7_gelu_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1283,-564.48 1179,-564.48 1179,-526.48 1283,-526.48 1283,-564.48"/>
<text text-anchor="middle" x="1231" y="-549.28" font-family="Times,serif" font-size="14.00">GELU GPU1</text>
<text text-anchor="middle" x="1231" y="-534.28" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_7_mlp1_gpu1&#45;&gt;layer_7_gelu_gpu1 -->
<g id="edge524" class="edge">
<title>layer_7_mlp1_gpu1&#45;&gt;layer_7_gelu_gpu1</title>
<path fill="none" stroke="black" d="M1231,-600.39C1231,-592.22 1231,-583.13 1231,-574.78"/>
<polygon fill="black" stroke="black" points="1234.5,-574.72 1231,-564.72 1227.5,-574.72 1234.5,-574.72"/>
</g>
<!-- layer_7_gelu_gpu2 -->
<g id="node425" class="node">
<title>layer_7_gelu_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1139,-564.48 1035,-564.48 1035,-526.48 1139,-526.48 1139,-564.48"/>
<text text-anchor="middle" x="1087" y="-549.28" font-family="Times,serif" font-size="14.00">GELU GPU2</text>
<text text-anchor="middle" x="1087" y="-534.28" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_7_mlp1_gpu2&#45;&gt;layer_7_gelu_gpu2 -->
<g id="edge528" class="edge">
<title>layer_7_mlp1_gpu2&#45;&gt;layer_7_gelu_gpu2</title>
<path fill="none" stroke="black" d="M1087,-600.39C1087,-592.22 1087,-583.13 1087,-574.78"/>
<polygon fill="black" stroke="black" points="1090.5,-574.72 1087,-564.72 1083.5,-574.72 1090.5,-574.72"/>
</g>
<!-- layer_7_gelu_gpu3 -->
<g id="node426" class="node">
<title>layer_7_gelu_gpu3</title>
<polygon fill="lightblue" stroke="black" points="995,-564.48 891,-564.48 891,-526.48 995,-526.48 995,-564.48"/>
<text text-anchor="middle" x="943" y="-549.28" font-family="Times,serif" font-size="14.00">GELU GPU3</text>
<text text-anchor="middle" x="943" y="-534.28" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_7_mlp1_gpu3&#45;&gt;layer_7_gelu_gpu3 -->
<g id="edge532" class="edge">
<title>layer_7_mlp1_gpu3&#45;&gt;layer_7_gelu_gpu3</title>
<path fill="none" stroke="black" d="M943,-600.39C943,-592.22 943,-583.13 943,-574.78"/>
<polygon fill="black" stroke="black" points="946.5,-574.72 943,-564.72 939.5,-574.72 946.5,-574.72"/>
</g>
<!-- layer_7_gelu_gpu4 -->
<g id="node427" class="node">
<title>layer_7_gelu_gpu4</title>
<polygon fill="lightblue" stroke="black" points="851,-564.48 747,-564.48 747,-526.48 851,-526.48 851,-564.48"/>
<text text-anchor="middle" x="799" y="-549.28" font-family="Times,serif" font-size="14.00">GELU GPU4</text>
<text text-anchor="middle" x="799" y="-534.28" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_7_mlp1_gpu4&#45;&gt;layer_7_gelu_gpu4 -->
<g id="edge536" class="edge">
<title>layer_7_mlp1_gpu4&#45;&gt;layer_7_gelu_gpu4</title>
<path fill="none" stroke="black" d="M799,-600.39C799,-592.22 799,-583.13 799,-574.78"/>
<polygon fill="black" stroke="black" points="802.5,-574.72 799,-564.72 795.5,-574.72 802.5,-574.72"/>
</g>
<!-- layer_7_gelu_gpu5 -->
<g id="node428" class="node">
<title>layer_7_gelu_gpu5</title>
<polygon fill="lightblue" stroke="black" points="707,-564.48 603,-564.48 603,-526.48 707,-526.48 707,-564.48"/>
<text text-anchor="middle" x="655" y="-549.28" font-family="Times,serif" font-size="14.00">GELU GPU5</text>
<text text-anchor="middle" x="655" y="-534.28" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_7_mlp1_gpu5&#45;&gt;layer_7_gelu_gpu5 -->
<g id="edge540" class="edge">
<title>layer_7_mlp1_gpu5&#45;&gt;layer_7_gelu_gpu5</title>
<path fill="none" stroke="black" d="M655,-600.39C655,-592.22 655,-583.13 655,-574.78"/>
<polygon fill="black" stroke="black" points="658.5,-574.72 655,-564.72 651.5,-574.72 658.5,-574.72"/>
</g>
<!-- layer_7_gelu_gpu6 -->
<g id="node429" class="node">
<title>layer_7_gelu_gpu6</title>
<polygon fill="lightblue" stroke="black" points="563,-564.48 459,-564.48 459,-526.48 563,-526.48 563,-564.48"/>
<text text-anchor="middle" x="511" y="-549.28" font-family="Times,serif" font-size="14.00">GELU GPU6</text>
<text text-anchor="middle" x="511" y="-534.28" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_7_mlp1_gpu6&#45;&gt;layer_7_gelu_gpu6 -->
<g id="edge544" class="edge">
<title>layer_7_mlp1_gpu6&#45;&gt;layer_7_gelu_gpu6</title>
<path fill="none" stroke="black" d="M511,-600.39C511,-592.22 511,-583.13 511,-574.78"/>
<polygon fill="black" stroke="black" points="514.5,-574.72 511,-564.72 507.5,-574.72 514.5,-574.72"/>
</g>
<!-- layer_7_gelu_gpu7 -->
<g id="node430" class="node">
<title>layer_7_gelu_gpu7</title>
<polygon fill="lightblue" stroke="black" points="419,-564.48 315,-564.48 315,-526.48 419,-526.48 419,-564.48"/>
<text text-anchor="middle" x="367" y="-549.28" font-family="Times,serif" font-size="14.00">GELU GPU7</text>
<text text-anchor="middle" x="367" y="-534.28" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_7_mlp1_gpu7&#45;&gt;layer_7_gelu_gpu7 -->
<g id="edge548" class="edge">
<title>layer_7_mlp1_gpu7&#45;&gt;layer_7_gelu_gpu7</title>
<path fill="none" stroke="black" d="M367,-600.39C367,-592.22 367,-583.13 367,-574.78"/>
<polygon fill="black" stroke="black" points="370.5,-574.72 367,-564.72 363.5,-574.72 370.5,-574.72"/>
</g>
<!-- layer_7_mlp2_gpu0 -->
<g id="node431" class="node">
<title>layer_7_mlp2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1438,-490.48 1312,-490.48 1312,-437.48 1438,-437.48 1438,-490.48"/>
<text text-anchor="middle" x="1375" y="-475.28" font-family="Times,serif" font-size="14.00">MLP2 GPU0</text>
<text text-anchor="middle" x="1375" y="-460.28" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1375" y="-445.28" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_7_gelu_gpu0&#45;&gt;layer_7_mlp2_gpu0 -->
<g id="edge521" class="edge">
<title>layer_7_gelu_gpu0&#45;&gt;layer_7_mlp2_gpu0</title>
<path fill="none" stroke="black" d="M1375,-526.44C1375,-518.8 1375,-509.62 1375,-500.71"/>
<polygon fill="black" stroke="black" points="1378.5,-500.48 1375,-490.48 1371.5,-500.48 1378.5,-500.48"/>
</g>
<!-- layer_7_mlp2_gpu1 -->
<g id="node432" class="node">
<title>layer_7_mlp2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1294,-490.48 1168,-490.48 1168,-437.48 1294,-437.48 1294,-490.48"/>
<text text-anchor="middle" x="1231" y="-475.28" font-family="Times,serif" font-size="14.00">MLP2 GPU1</text>
<text text-anchor="middle" x="1231" y="-460.28" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1231" y="-445.28" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_7_gelu_gpu1&#45;&gt;layer_7_mlp2_gpu1 -->
<g id="edge525" class="edge">
<title>layer_7_gelu_gpu1&#45;&gt;layer_7_mlp2_gpu1</title>
<path fill="none" stroke="black" d="M1231,-526.44C1231,-518.8 1231,-509.62 1231,-500.71"/>
<polygon fill="black" stroke="black" points="1234.5,-500.48 1231,-490.48 1227.5,-500.48 1234.5,-500.48"/>
</g>
<!-- layer_7_mlp2_gpu2 -->
<g id="node433" class="node">
<title>layer_7_mlp2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1150,-490.48 1024,-490.48 1024,-437.48 1150,-437.48 1150,-490.48"/>
<text text-anchor="middle" x="1087" y="-475.28" font-family="Times,serif" font-size="14.00">MLP2 GPU2</text>
<text text-anchor="middle" x="1087" y="-460.28" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1087" y="-445.28" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_7_gelu_gpu2&#45;&gt;layer_7_mlp2_gpu2 -->
<g id="edge529" class="edge">
<title>layer_7_gelu_gpu2&#45;&gt;layer_7_mlp2_gpu2</title>
<path fill="none" stroke="black" d="M1087,-526.44C1087,-518.8 1087,-509.62 1087,-500.71"/>
<polygon fill="black" stroke="black" points="1090.5,-500.48 1087,-490.48 1083.5,-500.48 1090.5,-500.48"/>
</g>
<!-- layer_7_mlp2_gpu3 -->
<g id="node434" class="node">
<title>layer_7_mlp2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1006,-490.48 880,-490.48 880,-437.48 1006,-437.48 1006,-490.48"/>
<text text-anchor="middle" x="943" y="-475.28" font-family="Times,serif" font-size="14.00">MLP2 GPU3</text>
<text text-anchor="middle" x="943" y="-460.28" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="943" y="-445.28" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_7_gelu_gpu3&#45;&gt;layer_7_mlp2_gpu3 -->
<g id="edge533" class="edge">
<title>layer_7_gelu_gpu3&#45;&gt;layer_7_mlp2_gpu3</title>
<path fill="none" stroke="black" d="M943,-526.44C943,-518.8 943,-509.62 943,-500.71"/>
<polygon fill="black" stroke="black" points="946.5,-500.48 943,-490.48 939.5,-500.48 946.5,-500.48"/>
</g>
<!-- layer_7_mlp2_gpu4 -->
<g id="node435" class="node">
<title>layer_7_mlp2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="862,-490.48 736,-490.48 736,-437.48 862,-437.48 862,-490.48"/>
<text text-anchor="middle" x="799" y="-475.28" font-family="Times,serif" font-size="14.00">MLP2 GPU4</text>
<text text-anchor="middle" x="799" y="-460.28" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="799" y="-445.28" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_7_gelu_gpu4&#45;&gt;layer_7_mlp2_gpu4 -->
<g id="edge537" class="edge">
<title>layer_7_gelu_gpu4&#45;&gt;layer_7_mlp2_gpu4</title>
<path fill="none" stroke="black" d="M799,-526.44C799,-518.8 799,-509.62 799,-500.71"/>
<polygon fill="black" stroke="black" points="802.5,-500.48 799,-490.48 795.5,-500.48 802.5,-500.48"/>
</g>
<!-- layer_7_mlp2_gpu5 -->
<g id="node436" class="node">
<title>layer_7_mlp2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="718,-490.48 592,-490.48 592,-437.48 718,-437.48 718,-490.48"/>
<text text-anchor="middle" x="655" y="-475.28" font-family="Times,serif" font-size="14.00">MLP2 GPU5</text>
<text text-anchor="middle" x="655" y="-460.28" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="655" y="-445.28" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_7_gelu_gpu5&#45;&gt;layer_7_mlp2_gpu5 -->
<g id="edge541" class="edge">
<title>layer_7_gelu_gpu5&#45;&gt;layer_7_mlp2_gpu5</title>
<path fill="none" stroke="black" d="M655,-526.44C655,-518.8 655,-509.62 655,-500.71"/>
<polygon fill="black" stroke="black" points="658.5,-500.48 655,-490.48 651.5,-500.48 658.5,-500.48"/>
</g>
<!-- layer_7_mlp2_gpu6 -->
<g id="node437" class="node">
<title>layer_7_mlp2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="574,-490.48 448,-490.48 448,-437.48 574,-437.48 574,-490.48"/>
<text text-anchor="middle" x="511" y="-475.28" font-family="Times,serif" font-size="14.00">MLP2 GPU6</text>
<text text-anchor="middle" x="511" y="-460.28" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="511" y="-445.28" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_7_gelu_gpu6&#45;&gt;layer_7_mlp2_gpu6 -->
<g id="edge545" class="edge">
<title>layer_7_gelu_gpu6&#45;&gt;layer_7_mlp2_gpu6</title>
<path fill="none" stroke="black" d="M511,-526.44C511,-518.8 511,-509.62 511,-500.71"/>
<polygon fill="black" stroke="black" points="514.5,-500.48 511,-490.48 507.5,-500.48 514.5,-500.48"/>
</g>
<!-- layer_7_mlp2_gpu7 -->
<g id="node438" class="node">
<title>layer_7_mlp2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="430,-490.48 304,-490.48 304,-437.48 430,-437.48 430,-490.48"/>
<text text-anchor="middle" x="367" y="-475.28" font-family="Times,serif" font-size="14.00">MLP2 GPU7</text>
<text text-anchor="middle" x="367" y="-460.28" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="367" y="-445.28" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_7_gelu_gpu7&#45;&gt;layer_7_mlp2_gpu7 -->
<g id="edge549" class="edge">
<title>layer_7_gelu_gpu7&#45;&gt;layer_7_mlp2_gpu7</title>
<path fill="none" stroke="black" d="M367,-526.44C367,-518.8 367,-509.62 367,-500.71"/>
<polygon fill="black" stroke="black" points="370.5,-500.48 367,-490.48 363.5,-500.48 370.5,-500.48"/>
</g>
<!-- layer_7_mlp_allreduce -->
<g id="node439" class="node">
<title>layer_7_mlp_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="871" cy="-374.61" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="871" y="-378.41" font-family="Times,serif" font-size="14.00">MLP AllReduce</text>
<text text-anchor="middle" x="871" y="-363.41" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_7_mlp2_gpu0&#45;&gt;layer_7_mlp_allreduce -->
<g id="edge522" class="edge">
<title>layer_7_mlp2_gpu0&#45;&gt;layer_7_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1312,-439.87C1308.97,-439.01 1305.96,-438.21 1303,-437.48 1188.59,-409.32 1053.77,-392.54 965.56,-383.71"/>
<polygon fill="black" stroke="black" points="965.86,-380.22 955.57,-382.72 965.18,-387.19 965.86,-380.22"/>
</g>
<!-- layer_7_mlp2_gpu1&#45;&gt;layer_7_mlp_allreduce -->
<g id="edge526" class="edge">
<title>layer_7_mlp2_gpu1&#45;&gt;layer_7_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1167.93,-440.13C1164.92,-439.2 1161.93,-438.31 1159,-437.48 1091.58,-418.38 1013.82,-402.01 956.11,-390.91"/>
<polygon fill="black" stroke="black" points="956.42,-387.4 945.94,-388.96 955.1,-394.28 956.42,-387.4"/>
</g>
<!-- layer_7_mlp2_gpu2&#45;&gt;layer_7_mlp_allreduce -->
<g id="edge530" class="edge">
<title>layer_7_mlp2_gpu2&#45;&gt;layer_7_mlp_allreduce</title>
<path fill="none" stroke="black" d="M1023.94,-437.47C995.08,-425.8 961,-412.02 932.35,-400.43"/>
<polygon fill="black" stroke="black" points="933.44,-397.09 922.86,-396.59 930.81,-403.58 933.44,-397.09"/>
</g>
<!-- layer_7_mlp2_gpu3&#45;&gt;layer_7_mlp_allreduce -->
<g id="edge534" class="edge">
<title>layer_7_mlp2_gpu3&#45;&gt;layer_7_mlp_allreduce</title>
<path fill="none" stroke="black" d="M921.79,-437.24C914.4,-428.27 906,-418.09 898.2,-408.61"/>
<polygon fill="black" stroke="black" points="900.87,-406.36 891.81,-400.87 895.47,-410.81 900.87,-406.36"/>
</g>
<!-- layer_7_mlp2_gpu4&#45;&gt;layer_7_mlp_allreduce -->
<g id="edge538" class="edge">
<title>layer_7_mlp2_gpu4&#45;&gt;layer_7_mlp_allreduce</title>
<path fill="none" stroke="black" d="M820.21,-437.24C827.6,-428.27 836,-418.09 843.8,-408.61"/>
<polygon fill="black" stroke="black" points="846.53,-410.81 850.19,-400.87 841.13,-406.36 846.53,-410.81"/>
</g>
<!-- layer_7_mlp2_gpu5&#45;&gt;layer_7_mlp_allreduce -->
<g id="edge542" class="edge">
<title>layer_7_mlp2_gpu5&#45;&gt;layer_7_mlp_allreduce</title>
<path fill="none" stroke="black" d="M718.06,-437.47C746.92,-425.8 781,-412.02 809.65,-400.43"/>
<polygon fill="black" stroke="black" points="811.19,-403.58 819.14,-396.59 808.56,-397.09 811.19,-403.58"/>
</g>
<!-- layer_7_mlp2_gpu6&#45;&gt;layer_7_mlp_allreduce -->
<g id="edge546" class="edge">
<title>layer_7_mlp2_gpu6&#45;&gt;layer_7_mlp_allreduce</title>
<path fill="none" stroke="black" d="M574.07,-440.13C577.08,-439.2 580.07,-438.31 583,-437.48 650.42,-418.38 728.18,-402.01 785.89,-390.91"/>
<polygon fill="black" stroke="black" points="786.9,-394.28 796.06,-388.96 785.58,-387.4 786.9,-394.28"/>
</g>
<!-- layer_7_mlp2_gpu7&#45;&gt;layer_7_mlp_allreduce -->
<g id="edge550" class="edge">
<title>layer_7_mlp2_gpu7&#45;&gt;layer_7_mlp_allreduce</title>
<path fill="none" stroke="black" d="M430,-439.87C433.03,-439.01 436.04,-438.21 439,-437.48 553.41,-409.32 688.23,-392.54 776.44,-383.71"/>
<polygon fill="black" stroke="black" points="776.82,-387.19 786.43,-382.72 776.14,-380.22 776.82,-387.19"/>
</g>
<!-- layer_7_residual2 -->
<g id="node440" class="node">
<title>layer_7_residual2</title>
<polygon fill="lightyellow" stroke="black" points="999.61,-311.74 795.02,-311.74 742.39,-235.74 946.98,-235.74 999.61,-311.74"/>
<text text-anchor="middle" x="871" y="-277.54" font-family="Times,serif" font-size="14.00">Residual Add 7</text>
<text text-anchor="middle" x="871" y="-262.54" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_7_mlp_allreduce&#45;&gt;layer_7_residual2 -->
<g id="edge551" class="edge">
<title>layer_7_mlp_allreduce&#45;&gt;layer_7_residual2</title>
<path fill="none" stroke="black" d="M871,-347.63C871,-339.82 871,-330.99 871,-322.24"/>
<polygon fill="black" stroke="black" points="874.5,-322.07 871,-312.07 867.5,-322.07 874.5,-322.07"/>
</g>
<!-- layer_7_ln2 -->
<g id="node441" class="node">
<title>layer_7_ln2</title>
<polygon fill="lightblue" stroke="black" points="926.5,-199.74 815.5,-199.74 815.5,-161.74 926.5,-161.74 926.5,-199.74"/>
<text text-anchor="middle" x="871" y="-184.54" font-family="Times,serif" font-size="14.00">LayerNorm 7</text>
<text text-anchor="middle" x="871" y="-169.54" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_7_residual2&#45;&gt;layer_7_ln2 -->
<g id="edge552" class="edge">
<title>layer_7_residual2&#45;&gt;layer_7_ln2</title>
<path fill="none" stroke="black" d="M871,-235.73C871,-227.1 871,-218.06 871,-209.89"/>
<polygon fill="black" stroke="black" points="874.5,-209.77 871,-199.77 867.5,-209.77 874.5,-209.77"/>
</g>
<!-- pipeline_comm_7_to_8 -->
<g id="node883" class="node">
<title>pipeline_comm_7_to_8</title>
<ellipse fill="orange" stroke="black" cx="871" cy="-98.87" rx="108.79" ry="26.74"/>
<text text-anchor="middle" x="871" y="-102.67" font-family="Times,serif" font-size="14.00">Pipeline Send/Recv</text>
<text text-anchor="middle" x="871" y="-87.67" font-family="Times,serif" font-size="14.00">Layer 7  8</text>
</g>
<!-- layer_7_ln2&#45;&gt;pipeline_comm_7_to_8 -->
<g id="edge553" class="edge">
<title>layer_7_ln2&#45;&gt;pipeline_comm_7_to_8</title>
<path fill="none" stroke="black" d="M871,-161.62C871,-154.01 871,-144.88 871,-136"/>
<polygon fill="black" stroke="black" points="874.5,-135.8 871,-125.8 867.5,-135.8 874.5,-135.8"/>
</g>
<!-- layer_8_qkv_gpu8 -->
<g id="node442" class="node">
<title>layer_8_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="6804,-9763.37 6676,-9763.37 6676,-9710.37 6804,-9710.37 6804,-9763.37"/>
<text text-anchor="middle" x="6740" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU8</text>
<text text-anchor="middle" x="6740" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6740" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_8_qkv_comm -->
<g id="node450" class="node">
<title>layer_8_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="6210" cy="-9603.37" rx="85.62" ry="26.74"/>
<text text-anchor="middle" x="6210" y="-9607.17" font-family="Times,serif" font-size="14.00">QKV AllGather</text>
<text text-anchor="middle" x="6210" y="-9592.17" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_8_qkv_gpu8&#45;&gt;layer_8_qkv_comm -->
<g id="edge555" class="edge">
<title>layer_8_qkv_gpu8&#45;&gt;layer_8_qkv_comm</title>
<path fill="none" stroke="black" d="M6719.05,-9710.1C6705.73,-9695.55 6687.22,-9678.43 6667,-9668.87 6604.32,-9639.26 6417.6,-9620.21 6303.15,-9610.98"/>
<polygon fill="black" stroke="black" points="6303.24,-9607.47 6292.99,-9610.17 6302.68,-9614.45 6303.24,-9607.47"/>
</g>
<!-- layer_8_qkv_gpu9 -->
<g id="node443" class="node">
<title>layer_8_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="6658,-9763.37 6530,-9763.37 6530,-9710.37 6658,-9710.37 6658,-9763.37"/>
<text text-anchor="middle" x="6594" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU9</text>
<text text-anchor="middle" x="6594" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6594" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_8_qkv_gpu9&#45;&gt;layer_8_qkv_comm -->
<g id="edge556" class="edge">
<title>layer_8_qkv_gpu9&#45;&gt;layer_8_qkv_comm</title>
<path fill="none" stroke="black" d="M6572.51,-9710.24C6559.13,-9695.93 6540.75,-9678.99 6521,-9668.87 6453.11,-9634.08 6367.77,-9618.06 6303.66,-9610.68"/>
<polygon fill="black" stroke="black" points="6303.89,-9607.18 6293.56,-9609.56 6303.12,-9614.14 6303.89,-9607.18"/>
</g>
<!-- layer_8_qkv_gpu10 -->
<g id="node444" class="node">
<title>layer_8_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="6511.5,-9763.37 6374.5,-9763.37 6374.5,-9710.37 6511.5,-9710.37 6511.5,-9763.37"/>
<text text-anchor="middle" x="6443" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU10</text>
<text text-anchor="middle" x="6443" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6443" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_8_qkv_gpu10&#45;&gt;layer_8_qkv_comm -->
<g id="edge557" class="edge">
<title>layer_8_qkv_gpu10&#45;&gt;layer_8_qkv_comm</title>
<path fill="none" stroke="black" d="M6417.94,-9710.35C6403.64,-9696.77 6384.84,-9680.53 6366,-9668.87 6338.57,-9651.9 6305.89,-9637.6 6277.55,-9626.81"/>
<polygon fill="black" stroke="black" points="6278.71,-9623.51 6268.12,-9623.29 6276.26,-9630.07 6278.71,-9623.51"/>
</g>
<!-- layer_8_qkv_gpu11 -->
<g id="node445" class="node">
<title>layer_8_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="6356.5,-9763.37 6219.5,-9763.37 6219.5,-9710.37 6356.5,-9710.37 6356.5,-9763.37"/>
<text text-anchor="middle" x="6288" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU11</text>
<text text-anchor="middle" x="6288" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6288" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_8_qkv_gpu11&#45;&gt;layer_8_qkv_comm -->
<g id="edge558" class="edge">
<title>layer_8_qkv_gpu11&#45;&gt;layer_8_qkv_comm</title>
<path fill="none" stroke="black" d="M6272.78,-9710.21C6260.7,-9689.84 6243.7,-9661.18 6230.43,-9638.82"/>
<polygon fill="black" stroke="black" points="6233.3,-9636.79 6225.19,-9629.97 6227.28,-9640.36 6233.3,-9636.79"/>
</g>
<!-- layer_8_qkv_gpu12 -->
<g id="node446" class="node">
<title>layer_8_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="6201.5,-9763.37 6064.5,-9763.37 6064.5,-9710.37 6201.5,-9710.37 6201.5,-9763.37"/>
<text text-anchor="middle" x="6133" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU12</text>
<text text-anchor="middle" x="6133" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6133" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_8_qkv_gpu12&#45;&gt;layer_8_qkv_comm -->
<g id="edge559" class="edge">
<title>layer_8_qkv_gpu12&#45;&gt;layer_8_qkv_comm</title>
<path fill="none" stroke="black" d="M6148.03,-9710.21C6159.95,-9689.84 6176.74,-9661.18 6189.83,-9638.82"/>
<polygon fill="black" stroke="black" points="6192.98,-9640.37 6195.01,-9629.97 6186.94,-9636.84 6192.98,-9640.37"/>
</g>
<!-- layer_8_qkv_gpu13 -->
<g id="node447" class="node">
<title>layer_8_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="6046.5,-9763.37 5909.5,-9763.37 5909.5,-9710.37 6046.5,-9710.37 6046.5,-9763.37"/>
<text text-anchor="middle" x="5978" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU13</text>
<text text-anchor="middle" x="5978" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5978" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_8_qkv_gpu13&#45;&gt;layer_8_qkv_comm -->
<g id="edge560" class="edge">
<title>layer_8_qkv_gpu13&#45;&gt;layer_8_qkv_comm</title>
<path fill="none" stroke="black" d="M6003.8,-9710.08C6018.28,-9696.59 6037.17,-9680.5 6056,-9668.87 6083.03,-9652.19 6115.13,-9637.97 6143.02,-9627.16"/>
<polygon fill="black" stroke="black" points="6144.59,-9630.31 6152.69,-9623.48 6142.1,-9623.76 6144.59,-9630.31"/>
</g>
<!-- layer_8_qkv_gpu14 -->
<g id="node448" class="node">
<title>layer_8_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="5891.5,-9763.37 5754.5,-9763.37 5754.5,-9710.37 5891.5,-9710.37 5891.5,-9763.37"/>
<text text-anchor="middle" x="5823" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU14</text>
<text text-anchor="middle" x="5823" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5823" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_8_qkv_gpu14&#45;&gt;layer_8_qkv_comm -->
<g id="edge561" class="edge">
<title>layer_8_qkv_gpu14&#45;&gt;layer_8_qkv_comm</title>
<path fill="none" stroke="black" d="M5846.29,-9710.28C5860.7,-9695.98 5880.34,-9679.05 5901,-9668.87 5969.01,-9635.37 6053.76,-9619.24 6117.29,-9611.49"/>
<polygon fill="black" stroke="black" points="6117.77,-9614.96 6127.3,-9610.32 6116.96,-9608.01 6117.77,-9614.96"/>
</g>
<!-- layer_8_qkv_gpu15 -->
<g id="node449" class="node">
<title>layer_8_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5736.5,-9763.37 5599.5,-9763.37 5599.5,-9710.37 5736.5,-9710.37 5736.5,-9763.37"/>
<text text-anchor="middle" x="5668" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU15</text>
<text text-anchor="middle" x="5668" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5668" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_8_qkv_gpu15&#45;&gt;layer_8_qkv_comm -->
<g id="edge562" class="edge">
<title>layer_8_qkv_gpu15&#45;&gt;layer_8_qkv_comm</title>
<path fill="none" stroke="black" d="M5690.71,-9710.1C5705.06,-9695.55 5724.85,-9678.42 5746,-9668.87 5810.31,-9639.85 6000.6,-9620.54 6116.56,-9611.11"/>
<polygon fill="black" stroke="black" points="6117.16,-9614.57 6126.85,-9610.28 6116.6,-9607.59 6117.16,-9614.57"/>
</g>
<!-- layer_8_attn_comp_gpu8 -->
<g id="node451" class="node">
<title>layer_8_attn_comp_gpu8</title>
<polygon fill="lightblue" stroke="black" points="5535,-9540.13 5337,-9540.13 5337,-9487.13 5535,-9487.13 5535,-9540.13"/>
<text text-anchor="middle" x="5436" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU8</text>
<text text-anchor="middle" x="5436" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="5436" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_8_qkv_comm&#45;&gt;layer_8_attn_comp_gpu8 -->
<g id="edge563" class="edge">
<title>layer_8_qkv_comm&#45;&gt;layer_8_attn_comp_gpu8</title>
<path fill="none" stroke="black" d="M6125.66,-9598.4C6000.76,-9591.65 5759.21,-9575.34 5545.22,-9540.61"/>
<polygon fill="black" stroke="black" points="5545.49,-9537.1 5535.05,-9538.94 5544.36,-9544.01 5545.49,-9537.1"/>
</g>
<!-- layer_8_attn_comp_gpu9 -->
<g id="node452" class="node">
<title>layer_8_attn_comp_gpu9</title>
<polygon fill="lightblue" stroke="black" points="5751,-9540.13 5553,-9540.13 5553,-9487.13 5751,-9487.13 5751,-9540.13"/>
<text text-anchor="middle" x="5652" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU9</text>
<text text-anchor="middle" x="5652" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="5652" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_8_qkv_comm&#45;&gt;layer_8_attn_comp_gpu9 -->
<g id="edge564" class="edge">
<title>layer_8_qkv_comm&#45;&gt;layer_8_attn_comp_gpu9</title>
<path fill="none" stroke="black" d="M6130.14,-9593.72C6040.07,-9583.41 5889.39,-9564.53 5761,-9540.5 5760.9,-9540.48 5760.8,-9540.46 5760.7,-9540.45"/>
<polygon fill="black" stroke="black" points="5761.61,-9537.06 5751.12,-9538.59 5760.27,-9543.93 5761.61,-9537.06"/>
</g>
<!-- layer_8_attn_comp_gpu10 -->
<g id="node453" class="node">
<title>layer_8_attn_comp_gpu10</title>
<polygon fill="lightblue" stroke="black" points="5976.5,-9540.13 5769.5,-9540.13 5769.5,-9487.13 5976.5,-9487.13 5976.5,-9540.13"/>
<text text-anchor="middle" x="5873" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU10</text>
<text text-anchor="middle" x="5873" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="5873" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_8_qkv_comm&#45;&gt;layer_8_attn_comp_gpu10 -->
<g id="edge565" class="edge">
<title>layer_8_qkv_comm&#45;&gt;layer_8_attn_comp_gpu10</title>
<path fill="none" stroke="black" d="M6145.42,-9585.56C6099,-9573.47 6035.32,-9556.89 5981.2,-9542.8"/>
<polygon fill="black" stroke="black" points="5981.77,-9539.33 5971.21,-9540.2 5980,-9546.11 5981.77,-9539.33"/>
</g>
<!-- layer_8_attn_comp_gpu11 -->
<g id="node454" class="node">
<title>layer_8_attn_comp_gpu11</title>
<polygon fill="lightblue" stroke="black" points="6201.5,-9540.13 5994.5,-9540.13 5994.5,-9487.13 6201.5,-9487.13 6201.5,-9540.13"/>
<text text-anchor="middle" x="6098" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU11</text>
<text text-anchor="middle" x="6098" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="6098" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_8_qkv_comm&#45;&gt;layer_8_attn_comp_gpu11 -->
<g id="edge566" class="edge">
<title>layer_8_qkv_comm&#45;&gt;layer_8_attn_comp_gpu11</title>
<path fill="none" stroke="black" d="M6179.1,-9578.17C6166.66,-9568.42 6152.14,-9557.04 6138.84,-9546.63"/>
<polygon fill="black" stroke="black" points="6140.79,-9543.71 6130.76,-9540.29 6136.47,-9549.22 6140.79,-9543.71"/>
</g>
<!-- layer_8_attn_comp_gpu12 -->
<g id="node455" class="node">
<title>layer_8_attn_comp_gpu12</title>
<polygon fill="lightblue" stroke="black" points="6426.5,-9540.13 6219.5,-9540.13 6219.5,-9487.13 6426.5,-9487.13 6426.5,-9540.13"/>
<text text-anchor="middle" x="6323" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU12</text>
<text text-anchor="middle" x="6323" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="6323" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_8_qkv_comm&#45;&gt;layer_8_attn_comp_gpu12 -->
<g id="edge567" class="edge">
<title>layer_8_qkv_comm&#45;&gt;layer_8_attn_comp_gpu12</title>
<path fill="none" stroke="black" d="M6241.18,-9578.17C6253.73,-9568.42 6268.38,-9557.04 6281.79,-9546.63"/>
<polygon fill="black" stroke="black" points="6284.2,-9549.19 6289.95,-9540.29 6279.91,-9543.66 6284.2,-9549.19"/>
</g>
<!-- layer_8_attn_comp_gpu13 -->
<g id="node456" class="node">
<title>layer_8_attn_comp_gpu13</title>
<polygon fill="lightblue" stroke="black" points="6651.5,-9540.13 6444.5,-9540.13 6444.5,-9487.13 6651.5,-9487.13 6651.5,-9540.13"/>
<text text-anchor="middle" x="6548" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU13</text>
<text text-anchor="middle" x="6548" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="6548" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_8_qkv_comm&#45;&gt;layer_8_attn_comp_gpu13 -->
<g id="edge568" class="edge">
<title>layer_8_qkv_comm&#45;&gt;layer_8_attn_comp_gpu13</title>
<path fill="none" stroke="black" d="M6274.37,-9585.66C6321.08,-9573.54 6385.37,-9556.85 6439.89,-9542.7"/>
<polygon fill="black" stroke="black" points="6440.8,-9546.08 6449.6,-9540.18 6439.04,-9539.3 6440.8,-9546.08"/>
</g>
<!-- layer_8_attn_comp_gpu14 -->
<g id="node457" class="node">
<title>layer_8_attn_comp_gpu14</title>
<polygon fill="lightblue" stroke="black" points="6876.5,-9540.13 6669.5,-9540.13 6669.5,-9487.13 6876.5,-9487.13 6876.5,-9540.13"/>
<text text-anchor="middle" x="6773" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU14</text>
<text text-anchor="middle" x="6773" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="6773" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_8_qkv_comm&#45;&gt;layer_8_attn_comp_gpu14 -->
<g id="edge569" class="edge">
<title>layer_8_qkv_comm&#45;&gt;layer_8_attn_comp_gpu14</title>
<path fill="none" stroke="black" d="M6289.78,-9593.64C6377.98,-9583.49 6524.41,-9565.16 6659.24,-9540.77"/>
<polygon fill="black" stroke="black" points="6660.13,-9544.16 6669.34,-9538.93 6658.87,-9537.28 6660.13,-9544.16"/>
</g>
<!-- layer_8_attn_comp_gpu15 -->
<g id="node458" class="node">
<title>layer_8_attn_comp_gpu15</title>
<polygon fill="lightblue" stroke="black" points="7101.5,-9540.13 6894.5,-9540.13 6894.5,-9487.13 7101.5,-9487.13 7101.5,-9540.13"/>
<text text-anchor="middle" x="6998" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU15</text>
<text text-anchor="middle" x="6998" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="6998" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_8_qkv_comm&#45;&gt;layer_8_attn_comp_gpu15 -->
<g id="edge570" class="edge">
<title>layer_8_qkv_comm&#45;&gt;layer_8_attn_comp_gpu15</title>
<path fill="none" stroke="black" d="M6294.24,-9598.34C6420.64,-9591.48 6666.91,-9574.96 6884.36,-9540.69"/>
<polygon fill="black" stroke="black" points="6885.04,-9544.12 6894.36,-9539.09 6883.94,-9537.21 6885.04,-9544.12"/>
</g>
<!-- layer_8_attn_out_gpu8 -->
<g id="node459" class="node">
<title>layer_8_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="5570,-9450.76 5412,-9450.76 5412,-9397.76 5570,-9397.76 5570,-9450.76"/>
<text text-anchor="middle" x="5491" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU8</text>
<text text-anchor="middle" x="5491" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="5491" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_8_attn_comp_gpu8&#45;&gt;layer_8_attn_out_gpu8 -->
<g id="edge571" class="edge">
<title>layer_8_attn_comp_gpu8&#45;&gt;layer_8_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M5452.2,-9486.89C5457.63,-9478.27 5463.77,-9468.52 5469.53,-9459.36"/>
<polygon fill="black" stroke="black" points="5472.55,-9461.15 5474.91,-9450.82 5466.62,-9457.42 5472.55,-9461.15"/>
</g>
<!-- layer_8_attn_out_gpu9 -->
<g id="node460" class="node">
<title>layer_8_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="5766,-9450.76 5608,-9450.76 5608,-9397.76 5766,-9397.76 5766,-9450.76"/>
<text text-anchor="middle" x="5687" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU9</text>
<text text-anchor="middle" x="5687" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="5687" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_8_attn_comp_gpu9&#45;&gt;layer_8_attn_out_gpu9 -->
<g id="edge572" class="edge">
<title>layer_8_attn_comp_gpu9&#45;&gt;layer_8_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M5662.31,-9486.89C5665.66,-9478.54 5669.43,-9469.12 5673,-9460.21"/>
<polygon fill="black" stroke="black" points="5676.29,-9461.4 5676.76,-9450.82 5669.79,-9458.8 5676.29,-9461.4"/>
</g>
<!-- layer_8_attn_out_gpu10 -->
<g id="node461" class="node">
<title>layer_8_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="5986.5,-9450.76 5819.5,-9450.76 5819.5,-9397.76 5986.5,-9397.76 5986.5,-9450.76"/>
<text text-anchor="middle" x="5903" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU10</text>
<text text-anchor="middle" x="5903" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="5903" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_8_attn_comp_gpu10&#45;&gt;layer_8_attn_out_gpu10 -->
<g id="edge573" class="edge">
<title>layer_8_attn_comp_gpu10&#45;&gt;layer_8_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M5881.84,-9486.89C5884.68,-9478.63 5887.87,-9469.32 5890.9,-9460.5"/>
<polygon fill="black" stroke="black" points="5894.29,-9461.41 5894.22,-9450.82 5887.67,-9459.14 5894.29,-9461.41"/>
</g>
<!-- layer_8_attn_out_gpu11 -->
<g id="node462" class="node">
<title>layer_8_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="6191.5,-9450.76 6024.5,-9450.76 6024.5,-9397.76 6191.5,-9397.76 6191.5,-9450.76"/>
<text text-anchor="middle" x="6108" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU11</text>
<text text-anchor="middle" x="6108" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6108" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_8_attn_comp_gpu11&#45;&gt;layer_8_attn_out_gpu11 -->
<g id="edge574" class="edge">
<title>layer_8_attn_comp_gpu11&#45;&gt;layer_8_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M6100.95,-9486.89C6101.88,-9478.72 6102.93,-9469.52 6103.93,-9460.78"/>
<polygon fill="black" stroke="black" points="6107.41,-9461.15 6105.07,-9450.82 6100.46,-9460.36 6107.41,-9461.15"/>
</g>
<!-- layer_8_attn_out_gpu12 -->
<g id="node463" class="node">
<title>layer_8_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="6396.5,-9450.76 6229.5,-9450.76 6229.5,-9397.76 6396.5,-9397.76 6396.5,-9450.76"/>
<text text-anchor="middle" x="6313" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU12</text>
<text text-anchor="middle" x="6313" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6313" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_8_attn_comp_gpu12&#45;&gt;layer_8_attn_out_gpu12 -->
<g id="edge575" class="edge">
<title>layer_8_attn_comp_gpu12&#45;&gt;layer_8_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M6320.05,-9486.89C6319.12,-9478.72 6318.07,-9469.52 6317.07,-9460.78"/>
<polygon fill="black" stroke="black" points="6320.54,-9460.36 6315.93,-9450.82 6313.59,-9461.15 6320.54,-9460.36"/>
</g>
<!-- layer_8_attn_out_gpu13 -->
<g id="node464" class="node">
<title>layer_8_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="6611.5,-9450.76 6444.5,-9450.76 6444.5,-9397.76 6611.5,-9397.76 6611.5,-9450.76"/>
<text text-anchor="middle" x="6528" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU13</text>
<text text-anchor="middle" x="6528" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6528" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_8_attn_comp_gpu13&#45;&gt;layer_8_attn_out_gpu13 -->
<g id="edge576" class="edge">
<title>layer_8_attn_comp_gpu13&#45;&gt;layer_8_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M6542.11,-9486.89C6540.24,-9478.72 6538.13,-9469.52 6536.13,-9460.78"/>
<polygon fill="black" stroke="black" points="6539.49,-9459.79 6533.85,-9450.82 6532.67,-9461.35 6539.49,-9459.79"/>
</g>
<!-- layer_8_attn_out_gpu14 -->
<g id="node465" class="node">
<title>layer_8_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="6831.5,-9450.76 6664.5,-9450.76 6664.5,-9397.76 6831.5,-9397.76 6831.5,-9450.76"/>
<text text-anchor="middle" x="6748" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU14</text>
<text text-anchor="middle" x="6748" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6748" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_8_attn_comp_gpu14&#45;&gt;layer_8_attn_out_gpu14 -->
<g id="edge577" class="edge">
<title>layer_8_attn_comp_gpu14&#45;&gt;layer_8_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M6765.63,-9486.89C6763.27,-9478.63 6760.61,-9469.32 6758.08,-9460.5"/>
<polygon fill="black" stroke="black" points="6761.43,-9459.47 6755.31,-9450.82 6754.7,-9461.4 6761.43,-9459.47"/>
</g>
<!-- layer_8_attn_out_gpu15 -->
<g id="node466" class="node">
<title>layer_8_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="7053.5,-9450.76 6886.5,-9450.76 6886.5,-9397.76 7053.5,-9397.76 7053.5,-9450.76"/>
<text text-anchor="middle" x="6970" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU15</text>
<text text-anchor="middle" x="6970" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6970" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_8_attn_comp_gpu15&#45;&gt;layer_8_attn_out_gpu15 -->
<g id="edge578" class="edge">
<title>layer_8_attn_comp_gpu15&#45;&gt;layer_8_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M6989.75,-9486.89C6987.1,-9478.63 6984.12,-9469.32 6981.29,-9460.5"/>
<polygon fill="black" stroke="black" points="6984.58,-9459.27 6978.19,-9450.82 6977.91,-9461.41 6984.58,-9459.27"/>
</g>
<!-- layer_8_attn_allreduce -->
<g id="node467" class="node">
<title>layer_8_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="6211" cy="-9334.89" rx="112.36" ry="26.74"/>
<text text-anchor="middle" x="6211" y="-9338.69" font-family="Times,serif" font-size="14.00">Attention AllReduce</text>
<text text-anchor="middle" x="6211" y="-9323.69" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_8_attn_out_gpu8&#45;&gt;layer_8_attn_allreduce -->
<g id="edge579" class="edge">
<title>layer_8_attn_out_gpu8&#45;&gt;layer_8_attn_allreduce</title>
<path fill="none" stroke="black" d="M5570.09,-9403.34C5579.79,-9401.26 5589.6,-9399.34 5599,-9397.76 5769.43,-9369.15 5968.94,-9351.99 6092.67,-9343.24"/>
<polygon fill="black" stroke="black" points="6093.19,-9346.71 6102.92,-9342.52 6092.7,-9339.73 6093.19,-9346.71"/>
</g>
<!-- layer_8_attn_out_gpu9&#45;&gt;layer_8_attn_allreduce -->
<g id="edge580" class="edge">
<title>layer_8_attn_out_gpu9&#45;&gt;layer_8_attn_allreduce</title>
<path fill="none" stroke="black" d="M5766.27,-9406.36C5781.11,-9403.36 5796.51,-9400.37 5811,-9397.76 5910.65,-9379.82 6024.84,-9362.48 6105.64,-9350.74"/>
<polygon fill="black" stroke="black" points="6106.42,-9354.16 6115.82,-9349.27 6105.42,-9347.24 6106.42,-9354.16"/>
</g>
<!-- layer_8_attn_out_gpu10&#45;&gt;layer_8_attn_allreduce -->
<g id="edge581" class="edge">
<title>layer_8_attn_out_gpu10&#45;&gt;layer_8_attn_allreduce</title>
<path fill="none" stroke="black" d="M5986.76,-9399.5C6031.55,-9386.8 6086.44,-9371.23 6130.7,-9358.67"/>
<polygon fill="black" stroke="black" points="6131.89,-9361.97 6140.55,-9355.88 6129.98,-9355.24 6131.89,-9361.97"/>
</g>
<!-- layer_8_attn_out_gpu11&#45;&gt;layer_8_attn_allreduce -->
<g id="edge582" class="edge">
<title>layer_8_attn_out_gpu11&#45;&gt;layer_8_attn_allreduce</title>
<path fill="none" stroke="black" d="M6138.07,-9397.76C6149.17,-9388.34 6161.88,-9377.56 6173.55,-9367.66"/>
<polygon fill="black" stroke="black" points="6176.07,-9370.12 6181.43,-9360.98 6171.54,-9364.78 6176.07,-9370.12"/>
</g>
<!-- layer_8_attn_out_gpu12&#45;&gt;layer_8_attn_allreduce -->
<g id="edge583" class="edge">
<title>layer_8_attn_out_gpu12&#45;&gt;layer_8_attn_allreduce</title>
<path fill="none" stroke="black" d="M6283.22,-9397.76C6272.23,-9388.34 6259.65,-9377.56 6248.09,-9367.66"/>
<polygon fill="black" stroke="black" points="6250.16,-9364.83 6240.29,-9360.98 6245.6,-9370.14 6250.16,-9364.83"/>
</g>
<!-- layer_8_attn_out_gpu13&#45;&gt;layer_8_attn_allreduce -->
<g id="edge584" class="edge">
<title>layer_8_attn_out_gpu13&#45;&gt;layer_8_attn_allreduce</title>
<path fill="none" stroke="black" d="M6444.3,-9400.19C6397.37,-9387.26 6339.1,-9371.2 6292.54,-9358.37"/>
<polygon fill="black" stroke="black" points="6293.36,-9354.96 6282.79,-9355.68 6291.5,-9361.71 6293.36,-9354.96"/>
</g>
<!-- layer_8_attn_out_gpu14&#45;&gt;layer_8_attn_allreduce -->
<g id="edge585" class="edge">
<title>layer_8_attn_out_gpu14&#45;&gt;layer_8_attn_allreduce</title>
<path fill="none" stroke="black" d="M6664.42,-9405.88C6649.97,-9403.05 6635.06,-9400.23 6621,-9397.76 6517.95,-9379.65 6399.76,-9362.16 6316.83,-9350.43"/>
<polygon fill="black" stroke="black" points="6317.29,-9346.96 6306.9,-9349.03 6316.31,-9353.89 6317.29,-9346.96"/>
</g>
<!-- layer_8_attn_out_gpu15&#45;&gt;layer_8_attn_allreduce -->
<g id="edge586" class="edge">
<title>layer_8_attn_out_gpu15&#45;&gt;layer_8_attn_allreduce</title>
<path fill="none" stroke="black" d="M6886.24,-9405.48C6871.22,-9402.64 6855.68,-9399.93 6841,-9397.76 6663.03,-9371.5 6455.07,-9353.52 6328.24,-9343.98"/>
<polygon fill="black" stroke="black" points="6328.35,-9340.48 6318.12,-9343.22 6327.83,-9347.46 6328.35,-9340.48"/>
</g>
<!-- layer_8_residual1 -->
<g id="node468" class="node">
<title>layer_8_residual1</title>
<polygon fill="lightyellow" stroke="black" points="6339.61,-9272.02 6135.02,-9272.02 6082.39,-9196.02 6286.98,-9196.02 6339.61,-9272.02"/>
<text text-anchor="middle" x="6211" y="-9237.82" font-family="Times,serif" font-size="14.00">Residual Add 8</text>
<text text-anchor="middle" x="6211" y="-9222.82" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_8_attn_allreduce&#45;&gt;layer_8_residual1 -->
<g id="edge587" class="edge">
<title>layer_8_attn_allreduce&#45;&gt;layer_8_residual1</title>
<path fill="none" stroke="black" d="M6211,-9307.92C6211,-9300.1 6211,-9291.27 6211,-9282.52"/>
<polygon fill="black" stroke="black" points="6214.5,-9282.35 6211,-9272.35 6207.5,-9282.35 6214.5,-9282.35"/>
</g>
<!-- layer_8_ln1 -->
<g id="node469" class="node">
<title>layer_8_ln1</title>
<polygon fill="lightblue" stroke="black" points="6266.5,-9141.02 6155.5,-9141.02 6155.5,-9103.02 6266.5,-9103.02 6266.5,-9141.02"/>
<text text-anchor="middle" x="6211" y="-9125.82" font-family="Times,serif" font-size="14.00">LayerNorm 8</text>
<text text-anchor="middle" x="6211" y="-9110.82" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_8_residual1&#45;&gt;layer_8_ln1 -->
<g id="edge588" class="edge">
<title>layer_8_residual1&#45;&gt;layer_8_ln1</title>
<path fill="none" stroke="black" d="M6211,-9195.78C6211,-9181.22 6211,-9164.81 6211,-9151.26"/>
<polygon fill="black" stroke="black" points="6214.5,-9151.09 6211,-9141.09 6207.5,-9151.09 6214.5,-9151.09"/>
</g>
<!-- layer_8_mlp1_gpu8 -->
<g id="node470" class="node">
<title>layer_8_mlp1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="6778,-9045.02 6652,-9045.02 6652,-8992.02 6778,-8992.02 6778,-9045.02"/>
<text text-anchor="middle" x="6715" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU8</text>
<text text-anchor="middle" x="6715" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6715" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp1_gpu8 -->
<g id="edge589" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp1_gpu8</title>
<path fill="none" stroke="black" d="M6266.71,-9119.05C6367.54,-9114.85 6576.07,-9103.11 6643,-9076.02 6656.87,-9070.41 6670.27,-9061.28 6681.68,-9051.99"/>
<polygon fill="black" stroke="black" points="6684.27,-9054.38 6689.61,-9045.24 6679.73,-9049.05 6684.27,-9054.38"/>
</g>
<!-- layer_8_mlp1_gpu9 -->
<g id="node471" class="node">
<title>layer_8_mlp1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="6634,-9045.02 6508,-9045.02 6508,-8992.02 6634,-8992.02 6634,-9045.02"/>
<text text-anchor="middle" x="6571" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU9</text>
<text text-anchor="middle" x="6571" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6571" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp1_gpu9 -->
<g id="edge593" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp1_gpu9</title>
<path fill="none" stroke="black" d="M6266.64,-9120.58C6326.4,-9118.25 6423.01,-9109.07 6499,-9076.02 6512.6,-9070.11 6525.86,-9061 6537.21,-9051.8"/>
<polygon fill="black" stroke="black" points="6539.73,-9054.26 6545.12,-9045.14 6535.22,-9048.91 6539.73,-9054.26"/>
</g>
<!-- layer_8_mlp1_gpu10 -->
<g id="node472" class="node">
<title>layer_8_mlp1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="6490,-9045.02 6364,-9045.02 6364,-8992.02 6490,-8992.02 6490,-9045.02"/>
<text text-anchor="middle" x="6427" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU10</text>
<text text-anchor="middle" x="6427" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6427" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp1_gpu10 -->
<g id="edge597" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp1_gpu10</title>
<path fill="none" stroke="black" d="M6266.53,-9108.71C6294.08,-9101.36 6327.3,-9090.59 6355,-9076.02 6367.67,-9069.36 6380.35,-9060.38 6391.45,-9051.55"/>
<polygon fill="black" stroke="black" points="6393.71,-9054.22 6399.24,-9045.18 6389.28,-9048.8 6393.71,-9054.22"/>
</g>
<!-- layer_8_mlp1_gpu11 -->
<g id="node473" class="node">
<title>layer_8_mlp1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="6346,-9045.02 6220,-9045.02 6220,-8992.02 6346,-8992.02 6346,-9045.02"/>
<text text-anchor="middle" x="6283" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU11</text>
<text text-anchor="middle" x="6283" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6283" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp1_gpu11 -->
<g id="edge601" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp1_gpu11</title>
<path fill="none" stroke="black" d="M6223.87,-9102.88C6233.59,-9089.18 6247.19,-9070 6258.91,-9053.49"/>
<polygon fill="black" stroke="black" points="6261.9,-9055.32 6264.83,-9045.14 6256.19,-9051.27 6261.9,-9055.32"/>
</g>
<!-- layer_8_mlp1_gpu12 -->
<g id="node474" class="node">
<title>layer_8_mlp1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="6202,-9045.02 6076,-9045.02 6076,-8992.02 6202,-8992.02 6202,-9045.02"/>
<text text-anchor="middle" x="6139" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU12</text>
<text text-anchor="middle" x="6139" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6139" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp1_gpu12 -->
<g id="edge605" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp1_gpu12</title>
<path fill="none" stroke="black" d="M6198.13,-9102.88C6188.41,-9089.18 6174.81,-9070 6163.09,-9053.49"/>
<polygon fill="black" stroke="black" points="6165.81,-9051.27 6157.17,-9045.14 6160.1,-9055.32 6165.81,-9051.27"/>
</g>
<!-- layer_8_mlp1_gpu13 -->
<g id="node475" class="node">
<title>layer_8_mlp1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="6058,-9045.02 5932,-9045.02 5932,-8992.02 6058,-8992.02 6058,-9045.02"/>
<text text-anchor="middle" x="5995" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU13</text>
<text text-anchor="middle" x="5995" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5995" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp1_gpu13 -->
<g id="edge609" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp1_gpu13</title>
<path fill="none" stroke="black" d="M6155.47,-9108.71C6127.92,-9101.36 6094.7,-9090.59 6067,-9076.02 6054.33,-9069.36 6041.65,-9060.38 6030.55,-9051.55"/>
<polygon fill="black" stroke="black" points="6032.72,-9048.8 6022.76,-9045.18 6028.29,-9054.22 6032.72,-9048.8"/>
</g>
<!-- layer_8_mlp1_gpu14 -->
<g id="node476" class="node">
<title>layer_8_mlp1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="5914,-9045.02 5788,-9045.02 5788,-8992.02 5914,-8992.02 5914,-9045.02"/>
<text text-anchor="middle" x="5851" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU14</text>
<text text-anchor="middle" x="5851" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5851" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp1_gpu14 -->
<g id="edge613" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp1_gpu14</title>
<path fill="none" stroke="black" d="M6155.36,-9120.58C6095.6,-9118.25 5998.99,-9109.07 5923,-9076.02 5909.4,-9070.11 5896.14,-9061 5884.79,-9051.8"/>
<polygon fill="black" stroke="black" points="5886.78,-9048.91 5876.88,-9045.14 5882.27,-9054.26 5886.78,-9048.91"/>
</g>
<!-- layer_8_mlp1_gpu15 -->
<g id="node477" class="node">
<title>layer_8_mlp1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5770,-9045.02 5644,-9045.02 5644,-8992.02 5770,-8992.02 5770,-9045.02"/>
<text text-anchor="middle" x="5707" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU15</text>
<text text-anchor="middle" x="5707" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5707" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp1_gpu15 -->
<g id="edge617" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp1_gpu15</title>
<path fill="none" stroke="black" d="M6155.29,-9119.05C6054.46,-9114.85 5845.93,-9103.11 5779,-9076.02 5765.13,-9070.41 5751.73,-9061.28 5740.32,-9051.99"/>
<polygon fill="black" stroke="black" points="5742.27,-9049.05 5732.39,-9045.24 5737.73,-9054.38 5742.27,-9049.05"/>
</g>
<!-- layer_8_gelu_gpu8 -->
<g id="node478" class="node">
<title>layer_8_gelu_gpu8</title>
<polygon fill="lightblue" stroke="black" points="6767,-8945.52 6663,-8945.52 6663,-8907.52 6767,-8907.52 6767,-8945.52"/>
<text text-anchor="middle" x="6715" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU8</text>
<text text-anchor="middle" x="6715" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_8_mlp1_gpu8&#45;&gt;layer_8_gelu_gpu8 -->
<g id="edge590" class="edge">
<title>layer_8_mlp1_gpu8&#45;&gt;layer_8_gelu_gpu8</title>
<path fill="none" stroke="black" d="M6715,-8991.97C6715,-8980.67 6715,-8967.35 6715,-8955.75"/>
<polygon fill="black" stroke="black" points="6718.5,-8955.7 6715,-8945.7 6711.5,-8955.7 6718.5,-8955.7"/>
</g>
<!-- layer_8_gelu_gpu9 -->
<g id="node479" class="node">
<title>layer_8_gelu_gpu9</title>
<polygon fill="lightblue" stroke="black" points="6623,-8945.52 6519,-8945.52 6519,-8907.52 6623,-8907.52 6623,-8945.52"/>
<text text-anchor="middle" x="6571" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU9</text>
<text text-anchor="middle" x="6571" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_8_mlp1_gpu9&#45;&gt;layer_8_gelu_gpu9 -->
<g id="edge594" class="edge">
<title>layer_8_mlp1_gpu9&#45;&gt;layer_8_gelu_gpu9</title>
<path fill="none" stroke="black" d="M6571,-8991.97C6571,-8980.67 6571,-8967.35 6571,-8955.75"/>
<polygon fill="black" stroke="black" points="6574.5,-8955.7 6571,-8945.7 6567.5,-8955.7 6574.5,-8955.7"/>
</g>
<!-- layer_8_gelu_gpu10 -->
<g id="node480" class="node">
<title>layer_8_gelu_gpu10</title>
<polygon fill="lightblue" stroke="black" points="6483.5,-8945.52 6370.5,-8945.52 6370.5,-8907.52 6483.5,-8907.52 6483.5,-8945.52"/>
<text text-anchor="middle" x="6427" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU10</text>
<text text-anchor="middle" x="6427" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_8_mlp1_gpu10&#45;&gt;layer_8_gelu_gpu10 -->
<g id="edge598" class="edge">
<title>layer_8_mlp1_gpu10&#45;&gt;layer_8_gelu_gpu10</title>
<path fill="none" stroke="black" d="M6427,-8991.97C6427,-8980.67 6427,-8967.35 6427,-8955.75"/>
<polygon fill="black" stroke="black" points="6430.5,-8955.7 6427,-8945.7 6423.5,-8955.7 6430.5,-8955.7"/>
</g>
<!-- layer_8_gelu_gpu11 -->
<g id="node481" class="node">
<title>layer_8_gelu_gpu11</title>
<polygon fill="lightblue" stroke="black" points="6339.5,-8945.52 6226.5,-8945.52 6226.5,-8907.52 6339.5,-8907.52 6339.5,-8945.52"/>
<text text-anchor="middle" x="6283" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU11</text>
<text text-anchor="middle" x="6283" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_8_mlp1_gpu11&#45;&gt;layer_8_gelu_gpu11 -->
<g id="edge602" class="edge">
<title>layer_8_mlp1_gpu11&#45;&gt;layer_8_gelu_gpu11</title>
<path fill="none" stroke="black" d="M6283,-8991.97C6283,-8980.67 6283,-8967.35 6283,-8955.75"/>
<polygon fill="black" stroke="black" points="6286.5,-8955.7 6283,-8945.7 6279.5,-8955.7 6286.5,-8955.7"/>
</g>
<!-- layer_8_gelu_gpu12 -->
<g id="node482" class="node">
<title>layer_8_gelu_gpu12</title>
<polygon fill="lightblue" stroke="black" points="6195.5,-8945.52 6082.5,-8945.52 6082.5,-8907.52 6195.5,-8907.52 6195.5,-8945.52"/>
<text text-anchor="middle" x="6139" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU12</text>
<text text-anchor="middle" x="6139" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_8_mlp1_gpu12&#45;&gt;layer_8_gelu_gpu12 -->
<g id="edge606" class="edge">
<title>layer_8_mlp1_gpu12&#45;&gt;layer_8_gelu_gpu12</title>
<path fill="none" stroke="black" d="M6139,-8991.97C6139,-8980.67 6139,-8967.35 6139,-8955.75"/>
<polygon fill="black" stroke="black" points="6142.5,-8955.7 6139,-8945.7 6135.5,-8955.7 6142.5,-8955.7"/>
</g>
<!-- layer_8_gelu_gpu13 -->
<g id="node483" class="node">
<title>layer_8_gelu_gpu13</title>
<polygon fill="lightblue" stroke="black" points="6051.5,-8945.52 5938.5,-8945.52 5938.5,-8907.52 6051.5,-8907.52 6051.5,-8945.52"/>
<text text-anchor="middle" x="5995" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU13</text>
<text text-anchor="middle" x="5995" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_8_mlp1_gpu13&#45;&gt;layer_8_gelu_gpu13 -->
<g id="edge610" class="edge">
<title>layer_8_mlp1_gpu13&#45;&gt;layer_8_gelu_gpu13</title>
<path fill="none" stroke="black" d="M5995,-8991.97C5995,-8980.67 5995,-8967.35 5995,-8955.75"/>
<polygon fill="black" stroke="black" points="5998.5,-8955.7 5995,-8945.7 5991.5,-8955.7 5998.5,-8955.7"/>
</g>
<!-- layer_8_gelu_gpu14 -->
<g id="node484" class="node">
<title>layer_8_gelu_gpu14</title>
<polygon fill="lightblue" stroke="black" points="5907.5,-8945.52 5794.5,-8945.52 5794.5,-8907.52 5907.5,-8907.52 5907.5,-8945.52"/>
<text text-anchor="middle" x="5851" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU14</text>
<text text-anchor="middle" x="5851" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_8_mlp1_gpu14&#45;&gt;layer_8_gelu_gpu14 -->
<g id="edge614" class="edge">
<title>layer_8_mlp1_gpu14&#45;&gt;layer_8_gelu_gpu14</title>
<path fill="none" stroke="black" d="M5851,-8991.97C5851,-8980.67 5851,-8967.35 5851,-8955.75"/>
<polygon fill="black" stroke="black" points="5854.5,-8955.7 5851,-8945.7 5847.5,-8955.7 5854.5,-8955.7"/>
</g>
<!-- layer_8_gelu_gpu15 -->
<g id="node485" class="node">
<title>layer_8_gelu_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5763.5,-8945.52 5650.5,-8945.52 5650.5,-8907.52 5763.5,-8907.52 5763.5,-8945.52"/>
<text text-anchor="middle" x="5707" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU15</text>
<text text-anchor="middle" x="5707" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_8_mlp1_gpu15&#45;&gt;layer_8_gelu_gpu15 -->
<g id="edge618" class="edge">
<title>layer_8_mlp1_gpu15&#45;&gt;layer_8_gelu_gpu15</title>
<path fill="none" stroke="black" d="M5707,-8991.97C5707,-8980.67 5707,-8967.35 5707,-8955.75"/>
<polygon fill="black" stroke="black" points="5710.5,-8955.7 5707,-8945.7 5703.5,-8955.7 5710.5,-8955.7"/>
</g>
<!-- layer_8_mlp2_gpu8 -->
<g id="node486" class="node">
<title>layer_8_mlp2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="6778,-8864.02 6652,-8864.02 6652,-8811.02 6778,-8811.02 6778,-8864.02"/>
<text text-anchor="middle" x="6715" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU8</text>
<text text-anchor="middle" x="6715" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6715" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_8_gelu_gpu8&#45;&gt;layer_8_mlp2_gpu8 -->
<g id="edge591" class="edge">
<title>layer_8_gelu_gpu8&#45;&gt;layer_8_mlp2_gpu8</title>
<path fill="none" stroke="black" d="M6715,-8907.5C6715,-8897.89 6715,-8885.73 6715,-8874.31"/>
<polygon fill="black" stroke="black" points="6718.5,-8874.11 6715,-8864.11 6711.5,-8874.11 6718.5,-8874.11"/>
</g>
<!-- layer_8_mlp2_gpu9 -->
<g id="node487" class="node">
<title>layer_8_mlp2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="6634,-8864.02 6508,-8864.02 6508,-8811.02 6634,-8811.02 6634,-8864.02"/>
<text text-anchor="middle" x="6571" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU9</text>
<text text-anchor="middle" x="6571" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6571" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_8_gelu_gpu9&#45;&gt;layer_8_mlp2_gpu9 -->
<g id="edge595" class="edge">
<title>layer_8_gelu_gpu9&#45;&gt;layer_8_mlp2_gpu9</title>
<path fill="none" stroke="black" d="M6571,-8907.5C6571,-8897.89 6571,-8885.73 6571,-8874.31"/>
<polygon fill="black" stroke="black" points="6574.5,-8874.11 6571,-8864.11 6567.5,-8874.11 6574.5,-8874.11"/>
</g>
<!-- layer_8_mlp2_gpu10 -->
<g id="node488" class="node">
<title>layer_8_mlp2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="6490,-8864.02 6364,-8864.02 6364,-8811.02 6490,-8811.02 6490,-8864.02"/>
<text text-anchor="middle" x="6427" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU10</text>
<text text-anchor="middle" x="6427" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6427" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_8_gelu_gpu10&#45;&gt;layer_8_mlp2_gpu10 -->
<g id="edge599" class="edge">
<title>layer_8_gelu_gpu10&#45;&gt;layer_8_mlp2_gpu10</title>
<path fill="none" stroke="black" d="M6427,-8907.5C6427,-8897.89 6427,-8885.73 6427,-8874.31"/>
<polygon fill="black" stroke="black" points="6430.5,-8874.11 6427,-8864.11 6423.5,-8874.11 6430.5,-8874.11"/>
</g>
<!-- layer_8_mlp2_gpu11 -->
<g id="node489" class="node">
<title>layer_8_mlp2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="6346,-8864.02 6220,-8864.02 6220,-8811.02 6346,-8811.02 6346,-8864.02"/>
<text text-anchor="middle" x="6283" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU11</text>
<text text-anchor="middle" x="6283" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6283" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_8_gelu_gpu11&#45;&gt;layer_8_mlp2_gpu11 -->
<g id="edge603" class="edge">
<title>layer_8_gelu_gpu11&#45;&gt;layer_8_mlp2_gpu11</title>
<path fill="none" stroke="black" d="M6283,-8907.5C6283,-8897.89 6283,-8885.73 6283,-8874.31"/>
<polygon fill="black" stroke="black" points="6286.5,-8874.11 6283,-8864.11 6279.5,-8874.11 6286.5,-8874.11"/>
</g>
<!-- layer_8_mlp2_gpu12 -->
<g id="node490" class="node">
<title>layer_8_mlp2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="6202,-8864.02 6076,-8864.02 6076,-8811.02 6202,-8811.02 6202,-8864.02"/>
<text text-anchor="middle" x="6139" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU12</text>
<text text-anchor="middle" x="6139" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6139" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_8_gelu_gpu12&#45;&gt;layer_8_mlp2_gpu12 -->
<g id="edge607" class="edge">
<title>layer_8_gelu_gpu12&#45;&gt;layer_8_mlp2_gpu12</title>
<path fill="none" stroke="black" d="M6139,-8907.5C6139,-8897.89 6139,-8885.73 6139,-8874.31"/>
<polygon fill="black" stroke="black" points="6142.5,-8874.11 6139,-8864.11 6135.5,-8874.11 6142.5,-8874.11"/>
</g>
<!-- layer_8_mlp2_gpu13 -->
<g id="node491" class="node">
<title>layer_8_mlp2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="6058,-8864.02 5932,-8864.02 5932,-8811.02 6058,-8811.02 6058,-8864.02"/>
<text text-anchor="middle" x="5995" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU13</text>
<text text-anchor="middle" x="5995" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="5995" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_8_gelu_gpu13&#45;&gt;layer_8_mlp2_gpu13 -->
<g id="edge611" class="edge">
<title>layer_8_gelu_gpu13&#45;&gt;layer_8_mlp2_gpu13</title>
<path fill="none" stroke="black" d="M5995,-8907.5C5995,-8897.89 5995,-8885.73 5995,-8874.31"/>
<polygon fill="black" stroke="black" points="5998.5,-8874.11 5995,-8864.11 5991.5,-8874.11 5998.5,-8874.11"/>
</g>
<!-- layer_8_mlp2_gpu14 -->
<g id="node492" class="node">
<title>layer_8_mlp2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="5914,-8864.02 5788,-8864.02 5788,-8811.02 5914,-8811.02 5914,-8864.02"/>
<text text-anchor="middle" x="5851" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU14</text>
<text text-anchor="middle" x="5851" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="5851" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_8_gelu_gpu14&#45;&gt;layer_8_mlp2_gpu14 -->
<g id="edge615" class="edge">
<title>layer_8_gelu_gpu14&#45;&gt;layer_8_mlp2_gpu14</title>
<path fill="none" stroke="black" d="M5851,-8907.5C5851,-8897.89 5851,-8885.73 5851,-8874.31"/>
<polygon fill="black" stroke="black" points="5854.5,-8874.11 5851,-8864.11 5847.5,-8874.11 5854.5,-8874.11"/>
</g>
<!-- layer_8_mlp2_gpu15 -->
<g id="node493" class="node">
<title>layer_8_mlp2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5770,-8864.02 5644,-8864.02 5644,-8811.02 5770,-8811.02 5770,-8864.02"/>
<text text-anchor="middle" x="5707" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU15</text>
<text text-anchor="middle" x="5707" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="5707" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_8_gelu_gpu15&#45;&gt;layer_8_mlp2_gpu15 -->
<g id="edge619" class="edge">
<title>layer_8_gelu_gpu15&#45;&gt;layer_8_mlp2_gpu15</title>
<path fill="none" stroke="black" d="M5707,-8907.5C5707,-8897.89 5707,-8885.73 5707,-8874.31"/>
<polygon fill="black" stroke="black" points="5710.5,-8874.11 5707,-8864.11 5703.5,-8874.11 5710.5,-8874.11"/>
</g>
<!-- layer_8_mlp_allreduce -->
<g id="node494" class="node">
<title>layer_8_mlp_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="6211" cy="-8748.15" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="6211" y="-8751.95" font-family="Times,serif" font-size="14.00">MLP AllReduce</text>
<text text-anchor="middle" x="6211" y="-8736.95" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_8_mlp2_gpu8&#45;&gt;layer_8_mlp_allreduce -->
<g id="edge592" class="edge">
<title>layer_8_mlp2_gpu8&#45;&gt;layer_8_mlp_allreduce</title>
<path fill="none" stroke="black" d="M6652,-8813.41C6648.97,-8812.56 6645.96,-8811.75 6643,-8811.02 6528.59,-8782.87 6393.77,-8766.09 6305.56,-8757.25"/>
<polygon fill="black" stroke="black" points="6305.86,-8753.77 6295.57,-8756.27 6305.18,-8760.73 6305.86,-8753.77"/>
</g>
<!-- layer_8_mlp2_gpu9&#45;&gt;layer_8_mlp_allreduce -->
<g id="edge596" class="edge">
<title>layer_8_mlp2_gpu9&#45;&gt;layer_8_mlp_allreduce</title>
<path fill="none" stroke="black" d="M6507.93,-8813.67C6504.92,-8812.74 6501.93,-8811.85 6499,-8811.02 6431.58,-8791.93 6353.82,-8775.55 6296.11,-8764.45"/>
<polygon fill="black" stroke="black" points="6296.42,-8760.94 6285.94,-8762.51 6295.1,-8767.82 6296.42,-8760.94"/>
</g>
<!-- layer_8_mlp2_gpu10&#45;&gt;layer_8_mlp_allreduce -->
<g id="edge600" class="edge">
<title>layer_8_mlp2_gpu10&#45;&gt;layer_8_mlp_allreduce</title>
<path fill="none" stroke="black" d="M6363.94,-8811.02C6335.08,-8799.34 6301,-8785.56 6272.35,-8773.97"/>
<polygon fill="black" stroke="black" points="6273.44,-8770.63 6262.86,-8770.13 6270.81,-8777.12 6273.44,-8770.63"/>
</g>
<!-- layer_8_mlp2_gpu11&#45;&gt;layer_8_mlp_allreduce -->
<g id="edge604" class="edge">
<title>layer_8_mlp2_gpu11&#45;&gt;layer_8_mlp_allreduce</title>
<path fill="none" stroke="black" d="M6261.79,-8810.78C6254.4,-8801.82 6246,-8791.63 6238.2,-8782.16"/>
<polygon fill="black" stroke="black" points="6240.87,-8779.9 6231.81,-8774.41 6235.47,-8784.35 6240.87,-8779.9"/>
</g>
<!-- layer_8_mlp2_gpu12&#45;&gt;layer_8_mlp_allreduce -->
<g id="edge608" class="edge">
<title>layer_8_mlp2_gpu12&#45;&gt;layer_8_mlp_allreduce</title>
<path fill="none" stroke="black" d="M6160.21,-8810.78C6167.6,-8801.82 6176,-8791.63 6183.8,-8782.16"/>
<polygon fill="black" stroke="black" points="6186.53,-8784.35 6190.19,-8774.41 6181.13,-8779.9 6186.53,-8784.35"/>
</g>
<!-- layer_8_mlp2_gpu13&#45;&gt;layer_8_mlp_allreduce -->
<g id="edge612" class="edge">
<title>layer_8_mlp2_gpu13&#45;&gt;layer_8_mlp_allreduce</title>
<path fill="none" stroke="black" d="M6058.06,-8811.02C6086.92,-8799.34 6121,-8785.56 6149.65,-8773.97"/>
<polygon fill="black" stroke="black" points="6151.19,-8777.12 6159.14,-8770.13 6148.56,-8770.63 6151.19,-8777.12"/>
</g>
<!-- layer_8_mlp2_gpu14&#45;&gt;layer_8_mlp_allreduce -->
<g id="edge616" class="edge">
<title>layer_8_mlp2_gpu14&#45;&gt;layer_8_mlp_allreduce</title>
<path fill="none" stroke="black" d="M5914.07,-8813.67C5917.08,-8812.74 5920.07,-8811.85 5923,-8811.02 5990.42,-8791.93 6068.18,-8775.55 6125.89,-8764.45"/>
<polygon fill="black" stroke="black" points="6126.9,-8767.82 6136.06,-8762.51 6125.58,-8760.94 6126.9,-8767.82"/>
</g>
<!-- layer_8_mlp2_gpu15&#45;&gt;layer_8_mlp_allreduce -->
<g id="edge620" class="edge">
<title>layer_8_mlp2_gpu15&#45;&gt;layer_8_mlp_allreduce</title>
<path fill="none" stroke="black" d="M5770,-8813.41C5773.03,-8812.56 5776.04,-8811.75 5779,-8811.02 5893.41,-8782.87 6028.23,-8766.09 6116.44,-8757.25"/>
<polygon fill="black" stroke="black" points="6116.82,-8760.73 6126.43,-8756.27 6116.14,-8753.77 6116.82,-8760.73"/>
</g>
<!-- layer_8_residual2 -->
<g id="node495" class="node">
<title>layer_8_residual2</title>
<polygon fill="lightyellow" stroke="black" points="6339.61,-8685.28 6135.02,-8685.28 6082.39,-8609.28 6286.98,-8609.28 6339.61,-8685.28"/>
<text text-anchor="middle" x="6211" y="-8651.08" font-family="Times,serif" font-size="14.00">Residual Add 8</text>
<text text-anchor="middle" x="6211" y="-8636.08" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_8_mlp_allreduce&#45;&gt;layer_8_residual2 -->
<g id="edge621" class="edge">
<title>layer_8_mlp_allreduce&#45;&gt;layer_8_residual2</title>
<path fill="none" stroke="black" d="M6211,-8721.18C6211,-8713.36 6211,-8704.53 6211,-8695.78"/>
<polygon fill="black" stroke="black" points="6214.5,-8695.61 6211,-8685.61 6207.5,-8695.61 6214.5,-8695.61"/>
</g>
<!-- layer_8_ln2 -->
<g id="node496" class="node">
<title>layer_8_ln2</title>
<polygon fill="lightblue" stroke="black" points="6266.5,-8554.28 6155.5,-8554.28 6155.5,-8516.28 6266.5,-8516.28 6266.5,-8554.28"/>
<text text-anchor="middle" x="6211" y="-8539.08" font-family="Times,serif" font-size="14.00">LayerNorm 8</text>
<text text-anchor="middle" x="6211" y="-8524.08" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_8_residual2&#45;&gt;layer_8_ln2 -->
<g id="edge622" class="edge">
<title>layer_8_residual2&#45;&gt;layer_8_ln2</title>
<path fill="none" stroke="black" d="M6211,-8609.04C6211,-8594.48 6211,-8578.07 6211,-8564.52"/>
<polygon fill="black" stroke="black" points="6214.5,-8564.35 6211,-8554.35 6207.5,-8564.35 6214.5,-8564.35"/>
</g>
<!-- layer_9_qkv_gpu0 -->
<g id="node885" class="node">
<title>layer_9_qkv_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="6347.04,-8411.28 6130.63,-8411.28 6074.96,-8375.28 6291.37,-8375.28 6347.04,-8411.28"/>
<text text-anchor="middle" x="6211" y="-8389.58" font-family="Times,serif" font-size="14.00">layer_9_qkv_gpu0</text>
</g>
<!-- layer_8_ln2&#45;&gt;layer_9_qkv_gpu0 -->
<g id="edge623" class="edge">
<title>layer_8_ln2&#45;&gt;layer_9_qkv_gpu0</title>
<path fill="none" stroke="black" d="M6211,-8516.27C6211,-8492.27 6211,-8449.62 6211,-8421.64"/>
<polygon fill="black" stroke="black" points="6214.5,-8421.35 6211,-8411.35 6207.5,-8421.35 6214.5,-8421.35"/>
</g>
<!-- layer_9_qkv_gpu8 -->
<g id="node497" class="node">
<title>layer_9_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="8593,-9763.37 8465,-9763.37 8465,-9710.37 8593,-9710.37 8593,-9763.37"/>
<text text-anchor="middle" x="8529" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU8</text>
<text text-anchor="middle" x="8529" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8529" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_9_qkv_comm -->
<g id="node505" class="node">
<title>layer_9_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="7999" cy="-9603.37" rx="85.62" ry="26.74"/>
<text text-anchor="middle" x="7999" y="-9607.17" font-family="Times,serif" font-size="14.00">QKV AllGather</text>
<text text-anchor="middle" x="7999" y="-9592.17" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_9_qkv_gpu8&#45;&gt;layer_9_qkv_comm -->
<g id="edge624" class="edge">
<title>layer_9_qkv_gpu8&#45;&gt;layer_9_qkv_comm</title>
<path fill="none" stroke="black" d="M8508.05,-9710.1C8494.73,-9695.55 8476.22,-9678.43 8456,-9668.87 8393.32,-9639.26 8206.6,-9620.21 8092.15,-9610.98"/>
<polygon fill="black" stroke="black" points="8092.24,-9607.47 8081.99,-9610.17 8091.68,-9614.45 8092.24,-9607.47"/>
</g>
<!-- layer_9_qkv_gpu9 -->
<g id="node498" class="node">
<title>layer_9_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="8447,-9763.37 8319,-9763.37 8319,-9710.37 8447,-9710.37 8447,-9763.37"/>
<text text-anchor="middle" x="8383" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU9</text>
<text text-anchor="middle" x="8383" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8383" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_9_qkv_gpu9&#45;&gt;layer_9_qkv_comm -->
<g id="edge625" class="edge">
<title>layer_9_qkv_gpu9&#45;&gt;layer_9_qkv_comm</title>
<path fill="none" stroke="black" d="M8361.51,-9710.24C8348.13,-9695.93 8329.75,-9678.99 8310,-9668.87 8242.11,-9634.08 8156.77,-9618.06 8092.66,-9610.68"/>
<polygon fill="black" stroke="black" points="8092.89,-9607.18 8082.56,-9609.56 8092.12,-9614.14 8092.89,-9607.18"/>
</g>
<!-- layer_9_qkv_gpu10 -->
<g id="node499" class="node">
<title>layer_9_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="8300.5,-9763.37 8163.5,-9763.37 8163.5,-9710.37 8300.5,-9710.37 8300.5,-9763.37"/>
<text text-anchor="middle" x="8232" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU10</text>
<text text-anchor="middle" x="8232" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8232" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_9_qkv_gpu10&#45;&gt;layer_9_qkv_comm -->
<g id="edge626" class="edge">
<title>layer_9_qkv_gpu10&#45;&gt;layer_9_qkv_comm</title>
<path fill="none" stroke="black" d="M8206.94,-9710.35C8192.64,-9696.77 8173.84,-9680.53 8155,-9668.87 8127.57,-9651.9 8094.89,-9637.6 8066.55,-9626.81"/>
<polygon fill="black" stroke="black" points="8067.71,-9623.51 8057.12,-9623.29 8065.26,-9630.07 8067.71,-9623.51"/>
</g>
<!-- layer_9_qkv_gpu11 -->
<g id="node500" class="node">
<title>layer_9_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="8145.5,-9763.37 8008.5,-9763.37 8008.5,-9710.37 8145.5,-9710.37 8145.5,-9763.37"/>
<text text-anchor="middle" x="8077" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU11</text>
<text text-anchor="middle" x="8077" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8077" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_9_qkv_gpu11&#45;&gt;layer_9_qkv_comm -->
<g id="edge627" class="edge">
<title>layer_9_qkv_gpu11&#45;&gt;layer_9_qkv_comm</title>
<path fill="none" stroke="black" d="M8061.78,-9710.21C8049.7,-9689.84 8032.7,-9661.18 8019.43,-9638.82"/>
<polygon fill="black" stroke="black" points="8022.3,-9636.79 8014.19,-9629.97 8016.28,-9640.36 8022.3,-9636.79"/>
</g>
<!-- layer_9_qkv_gpu12 -->
<g id="node501" class="node">
<title>layer_9_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="7990.5,-9763.37 7853.5,-9763.37 7853.5,-9710.37 7990.5,-9710.37 7990.5,-9763.37"/>
<text text-anchor="middle" x="7922" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU12</text>
<text text-anchor="middle" x="7922" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7922" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_9_qkv_gpu12&#45;&gt;layer_9_qkv_comm -->
<g id="edge628" class="edge">
<title>layer_9_qkv_gpu12&#45;&gt;layer_9_qkv_comm</title>
<path fill="none" stroke="black" d="M7937.03,-9710.21C7948.95,-9689.84 7965.74,-9661.18 7978.83,-9638.82"/>
<polygon fill="black" stroke="black" points="7981.98,-9640.37 7984.01,-9629.97 7975.94,-9636.84 7981.98,-9640.37"/>
</g>
<!-- layer_9_qkv_gpu13 -->
<g id="node502" class="node">
<title>layer_9_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="7835.5,-9763.37 7698.5,-9763.37 7698.5,-9710.37 7835.5,-9710.37 7835.5,-9763.37"/>
<text text-anchor="middle" x="7767" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU13</text>
<text text-anchor="middle" x="7767" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7767" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_9_qkv_gpu13&#45;&gt;layer_9_qkv_comm -->
<g id="edge629" class="edge">
<title>layer_9_qkv_gpu13&#45;&gt;layer_9_qkv_comm</title>
<path fill="none" stroke="black" d="M7792.8,-9710.08C7807.28,-9696.59 7826.17,-9680.5 7845,-9668.87 7872.03,-9652.19 7904.13,-9637.97 7932.02,-9627.16"/>
<polygon fill="black" stroke="black" points="7933.59,-9630.31 7941.69,-9623.48 7931.1,-9623.76 7933.59,-9630.31"/>
</g>
<!-- layer_9_qkv_gpu14 -->
<g id="node503" class="node">
<title>layer_9_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="7680.5,-9763.37 7543.5,-9763.37 7543.5,-9710.37 7680.5,-9710.37 7680.5,-9763.37"/>
<text text-anchor="middle" x="7612" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU14</text>
<text text-anchor="middle" x="7612" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7612" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_9_qkv_gpu14&#45;&gt;layer_9_qkv_comm -->
<g id="edge630" class="edge">
<title>layer_9_qkv_gpu14&#45;&gt;layer_9_qkv_comm</title>
<path fill="none" stroke="black" d="M7635.29,-9710.28C7649.7,-9695.98 7669.34,-9679.05 7690,-9668.87 7758.01,-9635.37 7842.76,-9619.24 7906.29,-9611.49"/>
<polygon fill="black" stroke="black" points="7906.77,-9614.96 7916.3,-9610.32 7905.96,-9608.01 7906.77,-9614.96"/>
</g>
<!-- layer_9_qkv_gpu15 -->
<g id="node504" class="node">
<title>layer_9_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="7525.5,-9763.37 7388.5,-9763.37 7388.5,-9710.37 7525.5,-9710.37 7525.5,-9763.37"/>
<text text-anchor="middle" x="7457" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU15</text>
<text text-anchor="middle" x="7457" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7457" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_9_qkv_gpu15&#45;&gt;layer_9_qkv_comm -->
<g id="edge631" class="edge">
<title>layer_9_qkv_gpu15&#45;&gt;layer_9_qkv_comm</title>
<path fill="none" stroke="black" d="M7479.71,-9710.1C7494.06,-9695.55 7513.85,-9678.42 7535,-9668.87 7599.31,-9639.85 7789.6,-9620.54 7905.56,-9611.11"/>
<polygon fill="black" stroke="black" points="7906.16,-9614.57 7915.85,-9610.28 7905.6,-9607.59 7906.16,-9614.57"/>
</g>
<!-- layer_9_attn_comp_gpu8 -->
<g id="node506" class="node">
<title>layer_9_attn_comp_gpu8</title>
<polygon fill="lightblue" stroke="black" points="7324,-9540.13 7126,-9540.13 7126,-9487.13 7324,-9487.13 7324,-9540.13"/>
<text text-anchor="middle" x="7225" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU8</text>
<text text-anchor="middle" x="7225" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="7225" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_9_qkv_comm&#45;&gt;layer_9_attn_comp_gpu8 -->
<g id="edge632" class="edge">
<title>layer_9_qkv_comm&#45;&gt;layer_9_attn_comp_gpu8</title>
<path fill="none" stroke="black" d="M7914.66,-9598.4C7789.76,-9591.65 7548.21,-9575.34 7334.22,-9540.61"/>
<polygon fill="black" stroke="black" points="7334.49,-9537.1 7324.05,-9538.94 7333.36,-9544.01 7334.49,-9537.1"/>
</g>
<!-- layer_9_attn_comp_gpu9 -->
<g id="node507" class="node">
<title>layer_9_attn_comp_gpu9</title>
<polygon fill="lightblue" stroke="black" points="7540,-9540.13 7342,-9540.13 7342,-9487.13 7540,-9487.13 7540,-9540.13"/>
<text text-anchor="middle" x="7441" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU9</text>
<text text-anchor="middle" x="7441" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="7441" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_9_qkv_comm&#45;&gt;layer_9_attn_comp_gpu9 -->
<g id="edge633" class="edge">
<title>layer_9_qkv_comm&#45;&gt;layer_9_attn_comp_gpu9</title>
<path fill="none" stroke="black" d="M7919.14,-9593.72C7829.07,-9583.41 7678.39,-9564.53 7550,-9540.5 7549.9,-9540.48 7549.8,-9540.46 7549.7,-9540.45"/>
<polygon fill="black" stroke="black" points="7550.61,-9537.06 7540.12,-9538.59 7549.27,-9543.93 7550.61,-9537.06"/>
</g>
<!-- layer_9_attn_comp_gpu10 -->
<g id="node508" class="node">
<title>layer_9_attn_comp_gpu10</title>
<polygon fill="lightblue" stroke="black" points="7765.5,-9540.13 7558.5,-9540.13 7558.5,-9487.13 7765.5,-9487.13 7765.5,-9540.13"/>
<text text-anchor="middle" x="7662" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU10</text>
<text text-anchor="middle" x="7662" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="7662" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_9_qkv_comm&#45;&gt;layer_9_attn_comp_gpu10 -->
<g id="edge634" class="edge">
<title>layer_9_qkv_comm&#45;&gt;layer_9_attn_comp_gpu10</title>
<path fill="none" stroke="black" d="M7934.42,-9585.56C7888,-9573.47 7824.32,-9556.89 7770.2,-9542.8"/>
<polygon fill="black" stroke="black" points="7770.77,-9539.33 7760.21,-9540.2 7769,-9546.11 7770.77,-9539.33"/>
</g>
<!-- layer_9_attn_comp_gpu11 -->
<g id="node509" class="node">
<title>layer_9_attn_comp_gpu11</title>
<polygon fill="lightblue" stroke="black" points="7990.5,-9540.13 7783.5,-9540.13 7783.5,-9487.13 7990.5,-9487.13 7990.5,-9540.13"/>
<text text-anchor="middle" x="7887" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU11</text>
<text text-anchor="middle" x="7887" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="7887" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_9_qkv_comm&#45;&gt;layer_9_attn_comp_gpu11 -->
<g id="edge635" class="edge">
<title>layer_9_qkv_comm&#45;&gt;layer_9_attn_comp_gpu11</title>
<path fill="none" stroke="black" d="M7968.1,-9578.17C7955.66,-9568.42 7941.14,-9557.04 7927.84,-9546.63"/>
<polygon fill="black" stroke="black" points="7929.79,-9543.71 7919.76,-9540.29 7925.47,-9549.22 7929.79,-9543.71"/>
</g>
<!-- layer_9_attn_comp_gpu12 -->
<g id="node510" class="node">
<title>layer_9_attn_comp_gpu12</title>
<polygon fill="lightblue" stroke="black" points="8215.5,-9540.13 8008.5,-9540.13 8008.5,-9487.13 8215.5,-9487.13 8215.5,-9540.13"/>
<text text-anchor="middle" x="8112" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU12</text>
<text text-anchor="middle" x="8112" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="8112" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_9_qkv_comm&#45;&gt;layer_9_attn_comp_gpu12 -->
<g id="edge636" class="edge">
<title>layer_9_qkv_comm&#45;&gt;layer_9_attn_comp_gpu12</title>
<path fill="none" stroke="black" d="M8030.18,-9578.17C8042.73,-9568.42 8057.38,-9557.04 8070.79,-9546.63"/>
<polygon fill="black" stroke="black" points="8073.2,-9549.19 8078.95,-9540.29 8068.91,-9543.66 8073.2,-9549.19"/>
</g>
<!-- layer_9_attn_comp_gpu13 -->
<g id="node511" class="node">
<title>layer_9_attn_comp_gpu13</title>
<polygon fill="lightblue" stroke="black" points="8440.5,-9540.13 8233.5,-9540.13 8233.5,-9487.13 8440.5,-9487.13 8440.5,-9540.13"/>
<text text-anchor="middle" x="8337" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU13</text>
<text text-anchor="middle" x="8337" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="8337" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_9_qkv_comm&#45;&gt;layer_9_attn_comp_gpu13 -->
<g id="edge637" class="edge">
<title>layer_9_qkv_comm&#45;&gt;layer_9_attn_comp_gpu13</title>
<path fill="none" stroke="black" d="M8063.37,-9585.66C8110.08,-9573.54 8174.37,-9556.85 8228.89,-9542.7"/>
<polygon fill="black" stroke="black" points="8229.8,-9546.08 8238.6,-9540.18 8228.04,-9539.3 8229.8,-9546.08"/>
</g>
<!-- layer_9_attn_comp_gpu14 -->
<g id="node512" class="node">
<title>layer_9_attn_comp_gpu14</title>
<polygon fill="lightblue" stroke="black" points="8665.5,-9540.13 8458.5,-9540.13 8458.5,-9487.13 8665.5,-9487.13 8665.5,-9540.13"/>
<text text-anchor="middle" x="8562" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU14</text>
<text text-anchor="middle" x="8562" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="8562" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_9_qkv_comm&#45;&gt;layer_9_attn_comp_gpu14 -->
<g id="edge638" class="edge">
<title>layer_9_qkv_comm&#45;&gt;layer_9_attn_comp_gpu14</title>
<path fill="none" stroke="black" d="M8078.78,-9593.64C8166.98,-9583.49 8313.41,-9565.16 8448.24,-9540.77"/>
<polygon fill="black" stroke="black" points="8449.13,-9544.16 8458.34,-9538.93 8447.87,-9537.28 8449.13,-9544.16"/>
</g>
<!-- layer_9_attn_comp_gpu15 -->
<g id="node513" class="node">
<title>layer_9_attn_comp_gpu15</title>
<polygon fill="lightblue" stroke="black" points="8890.5,-9540.13 8683.5,-9540.13 8683.5,-9487.13 8890.5,-9487.13 8890.5,-9540.13"/>
<text text-anchor="middle" x="8787" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU15</text>
<text text-anchor="middle" x="8787" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="8787" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_9_qkv_comm&#45;&gt;layer_9_attn_comp_gpu15 -->
<g id="edge639" class="edge">
<title>layer_9_qkv_comm&#45;&gt;layer_9_attn_comp_gpu15</title>
<path fill="none" stroke="black" d="M8083.24,-9598.34C8209.64,-9591.48 8455.91,-9574.96 8673.36,-9540.69"/>
<polygon fill="black" stroke="black" points="8674.04,-9544.12 8683.36,-9539.09 8672.94,-9537.21 8674.04,-9544.12"/>
</g>
<!-- layer_9_attn_out_gpu8 -->
<g id="node514" class="node">
<title>layer_9_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="7350,-9450.76 7192,-9450.76 7192,-9397.76 7350,-9397.76 7350,-9450.76"/>
<text text-anchor="middle" x="7271" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU8</text>
<text text-anchor="middle" x="7271" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="7271" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_9_attn_comp_gpu8&#45;&gt;layer_9_attn_out_gpu8 -->
<g id="edge640" class="edge">
<title>layer_9_attn_comp_gpu8&#45;&gt;layer_9_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M7238.55,-9486.89C7243,-9478.45 7248.01,-9468.92 7252.75,-9459.93"/>
<polygon fill="black" stroke="black" points="7255.98,-9461.3 7257.54,-9450.82 7249.79,-9458.04 7255.98,-9461.3"/>
</g>
<!-- layer_9_attn_out_gpu9 -->
<g id="node515" class="node">
<title>layer_9_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="7566,-9450.76 7408,-9450.76 7408,-9397.76 7566,-9397.76 7566,-9450.76"/>
<text text-anchor="middle" x="7487" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU9</text>
<text text-anchor="middle" x="7487" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="7487" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_9_attn_comp_gpu9&#45;&gt;layer_9_attn_out_gpu9 -->
<g id="edge641" class="edge">
<title>layer_9_attn_comp_gpu9&#45;&gt;layer_9_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M7454.55,-9486.89C7459,-9478.45 7464.01,-9468.92 7468.75,-9459.93"/>
<polygon fill="black" stroke="black" points="7471.98,-9461.3 7473.54,-9450.82 7465.79,-9458.04 7471.98,-9461.3"/>
</g>
<!-- layer_9_attn_out_gpu10 -->
<g id="node516" class="node">
<title>layer_9_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="7770.5,-9450.76 7603.5,-9450.76 7603.5,-9397.76 7770.5,-9397.76 7770.5,-9450.76"/>
<text text-anchor="middle" x="7687" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU10</text>
<text text-anchor="middle" x="7687" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="7687" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_9_attn_comp_gpu10&#45;&gt;layer_9_attn_out_gpu10 -->
<g id="edge642" class="edge">
<title>layer_9_attn_comp_gpu10&#45;&gt;layer_9_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M7669.37,-9486.89C7671.73,-9478.63 7674.39,-9469.32 7676.92,-9460.5"/>
<polygon fill="black" stroke="black" points="7680.3,-9461.4 7679.69,-9450.82 7673.57,-9459.47 7680.3,-9461.4"/>
</g>
<!-- layer_9_attn_out_gpu11 -->
<g id="node517" class="node">
<title>layer_9_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="7980.5,-9450.76 7813.5,-9450.76 7813.5,-9397.76 7980.5,-9397.76 7980.5,-9450.76"/>
<text text-anchor="middle" x="7897" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU11</text>
<text text-anchor="middle" x="7897" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="7897" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_9_attn_comp_gpu11&#45;&gt;layer_9_attn_out_gpu11 -->
<g id="edge643" class="edge">
<title>layer_9_attn_comp_gpu11&#45;&gt;layer_9_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M7889.95,-9486.89C7890.88,-9478.72 7891.93,-9469.52 7892.93,-9460.78"/>
<polygon fill="black" stroke="black" points="7896.41,-9461.15 7894.07,-9450.82 7889.46,-9460.36 7896.41,-9461.15"/>
</g>
<!-- layer_9_attn_out_gpu12 -->
<g id="node518" class="node">
<title>layer_9_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="8185.5,-9450.76 8018.5,-9450.76 8018.5,-9397.76 8185.5,-9397.76 8185.5,-9450.76"/>
<text text-anchor="middle" x="8102" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU12</text>
<text text-anchor="middle" x="8102" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="8102" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_9_attn_comp_gpu12&#45;&gt;layer_9_attn_out_gpu12 -->
<g id="edge644" class="edge">
<title>layer_9_attn_comp_gpu12&#45;&gt;layer_9_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M8109.05,-9486.89C8108.12,-9478.72 8107.07,-9469.52 8106.07,-9460.78"/>
<polygon fill="black" stroke="black" points="8109.54,-9460.36 8104.93,-9450.82 8102.59,-9461.15 8109.54,-9460.36"/>
</g>
<!-- layer_9_attn_out_gpu13 -->
<g id="node519" class="node">
<title>layer_9_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="8400.5,-9450.76 8233.5,-9450.76 8233.5,-9397.76 8400.5,-9397.76 8400.5,-9450.76"/>
<text text-anchor="middle" x="8317" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU13</text>
<text text-anchor="middle" x="8317" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="8317" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_9_attn_comp_gpu13&#45;&gt;layer_9_attn_out_gpu13 -->
<g id="edge645" class="edge">
<title>layer_9_attn_comp_gpu13&#45;&gt;layer_9_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M8331.11,-9486.89C8329.24,-9478.72 8327.13,-9469.52 8325.13,-9460.78"/>
<polygon fill="black" stroke="black" points="8328.49,-9459.79 8322.85,-9450.82 8321.67,-9461.35 8328.49,-9459.79"/>
</g>
<!-- layer_9_attn_out_gpu14 -->
<g id="node520" class="node">
<title>layer_9_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="8620.5,-9450.76 8453.5,-9450.76 8453.5,-9397.76 8620.5,-9397.76 8620.5,-9450.76"/>
<text text-anchor="middle" x="8537" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU14</text>
<text text-anchor="middle" x="8537" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="8537" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_9_attn_comp_gpu14&#45;&gt;layer_9_attn_out_gpu14 -->
<g id="edge646" class="edge">
<title>layer_9_attn_comp_gpu14&#45;&gt;layer_9_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M8554.63,-9486.89C8552.27,-9478.63 8549.61,-9469.32 8547.08,-9460.5"/>
<polygon fill="black" stroke="black" points="8550.43,-9459.47 8544.31,-9450.82 8543.7,-9461.4 8550.43,-9459.47"/>
</g>
<!-- layer_9_attn_out_gpu15 -->
<g id="node521" class="node">
<title>layer_9_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="8842.5,-9450.76 8675.5,-9450.76 8675.5,-9397.76 8842.5,-9397.76 8842.5,-9450.76"/>
<text text-anchor="middle" x="8759" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU15</text>
<text text-anchor="middle" x="8759" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="8759" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_9_attn_comp_gpu15&#45;&gt;layer_9_attn_out_gpu15 -->
<g id="edge647" class="edge">
<title>layer_9_attn_comp_gpu15&#45;&gt;layer_9_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M8778.75,-9486.89C8776.1,-9478.63 8773.12,-9469.32 8770.29,-9460.5"/>
<polygon fill="black" stroke="black" points="8773.58,-9459.27 8767.19,-9450.82 8766.91,-9461.41 8773.58,-9459.27"/>
</g>
<!-- layer_9_attn_allreduce -->
<g id="node522" class="node">
<title>layer_9_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="7999" cy="-9334.89" rx="112.36" ry="26.74"/>
<text text-anchor="middle" x="7999" y="-9338.69" font-family="Times,serif" font-size="14.00">Attention AllReduce</text>
<text text-anchor="middle" x="7999" y="-9323.69" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_9_attn_out_gpu8&#45;&gt;layer_9_attn_allreduce -->
<g id="edge648" class="edge">
<title>layer_9_attn_out_gpu8&#45;&gt;layer_9_attn_allreduce</title>
<path fill="none" stroke="black" d="M7350,-9406.32C7366.16,-9403.19 7383.09,-9400.16 7399,-9397.76 7566.32,-9372.53 7761.45,-9354.5 7882.63,-9344.63"/>
<polygon fill="black" stroke="black" points="7882.99,-9348.12 7892.68,-9343.82 7882.43,-9341.14 7882.99,-9348.12"/>
</g>
<!-- layer_9_attn_out_gpu9&#45;&gt;layer_9_attn_allreduce -->
<g id="edge649" class="edge">
<title>layer_9_attn_out_gpu9&#45;&gt;layer_9_attn_allreduce</title>
<path fill="none" stroke="black" d="M7566.17,-9403.8C7575.86,-9401.65 7585.64,-9399.58 7595,-9397.76 7695.03,-9378.33 7809.96,-9361.23 7891.6,-9349.96"/>
<polygon fill="black" stroke="black" points="7892.46,-9353.37 7901.89,-9348.55 7891.51,-9346.44 7892.46,-9353.37"/>
</g>
<!-- layer_9_attn_out_gpu10&#45;&gt;layer_9_attn_allreduce -->
<g id="edge650" class="edge">
<title>layer_9_attn_out_gpu10&#45;&gt;layer_9_attn_allreduce</title>
<path fill="none" stroke="black" d="M7770.61,-9399.85C7816.35,-9387.04 7872.76,-9371.24 7918.07,-9358.55"/>
<polygon fill="black" stroke="black" points="7919.18,-9361.88 7927.86,-9355.81 7917.29,-9355.14 7919.18,-9361.88"/>
</g>
<!-- layer_9_attn_out_gpu11&#45;&gt;layer_9_attn_allreduce -->
<g id="edge651" class="edge">
<title>layer_9_attn_out_gpu11&#45;&gt;layer_9_attn_allreduce</title>
<path fill="none" stroke="black" d="M7926.78,-9397.76C7937.77,-9388.34 7950.35,-9377.56 7961.91,-9367.66"/>
<polygon fill="black" stroke="black" points="7964.4,-9370.14 7969.71,-9360.98 7959.84,-9364.83 7964.4,-9370.14"/>
</g>
<!-- layer_9_attn_out_gpu12&#45;&gt;layer_9_attn_allreduce -->
<g id="edge652" class="edge">
<title>layer_9_attn_out_gpu12&#45;&gt;layer_9_attn_allreduce</title>
<path fill="none" stroke="black" d="M8071.93,-9397.76C8060.83,-9388.34 8048.12,-9377.56 8036.45,-9367.66"/>
<polygon fill="black" stroke="black" points="8038.46,-9364.78 8028.57,-9360.98 8033.93,-9370.12 8038.46,-9364.78"/>
</g>
<!-- layer_9_attn_out_gpu13&#45;&gt;layer_9_attn_allreduce -->
<g id="edge653" class="edge">
<title>layer_9_attn_out_gpu13&#45;&gt;layer_9_attn_allreduce</title>
<path fill="none" stroke="black" d="M8233.45,-9400.31C8186.29,-9387.35 8127.6,-9371.23 8080.74,-9358.35"/>
<polygon fill="black" stroke="black" points="8081.5,-9354.93 8070.93,-9355.66 8079.65,-9361.68 8081.5,-9354.93"/>
</g>
<!-- layer_9_attn_out_gpu14&#45;&gt;layer_9_attn_allreduce -->
<g id="edge654" class="edge">
<title>layer_9_attn_out_gpu14&#45;&gt;layer_9_attn_allreduce</title>
<path fill="none" stroke="black" d="M8453.42,-9405.88C8438.97,-9403.05 8424.07,-9400.23 8410,-9397.76 8306.7,-9379.63 8188.22,-9362.14 8105.09,-9350.41"/>
<polygon fill="black" stroke="black" points="8105.52,-9346.94 8095.13,-9349.01 8104.55,-9353.87 8105.52,-9346.94"/>
</g>
<!-- layer_9_attn_out_gpu15&#45;&gt;layer_9_attn_allreduce -->
<g id="edge655" class="edge">
<title>layer_9_attn_out_gpu15&#45;&gt;layer_9_attn_allreduce</title>
<path fill="none" stroke="black" d="M8675.24,-9405.48C8660.22,-9402.64 8644.68,-9399.93 8630,-9397.76 8451.61,-9371.45 8243.15,-9353.48 8116.15,-9343.95"/>
<polygon fill="black" stroke="black" points="8116.24,-9340.44 8106.01,-9343.19 8115.72,-9347.43 8116.24,-9340.44"/>
</g>
<!-- layer_9_residual1 -->
<g id="node523" class="node">
<title>layer_9_residual1</title>
<polygon fill="lightyellow" stroke="black" points="8127.61,-9272.02 7923.02,-9272.02 7870.39,-9196.02 8074.98,-9196.02 8127.61,-9272.02"/>
<text text-anchor="middle" x="7999" y="-9237.82" font-family="Times,serif" font-size="14.00">Residual Add 9</text>
<text text-anchor="middle" x="7999" y="-9222.82" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_9_attn_allreduce&#45;&gt;layer_9_residual1 -->
<g id="edge656" class="edge">
<title>layer_9_attn_allreduce&#45;&gt;layer_9_residual1</title>
<path fill="none" stroke="black" d="M7999,-9307.92C7999,-9300.1 7999,-9291.27 7999,-9282.52"/>
<polygon fill="black" stroke="black" points="8002.5,-9282.35 7999,-9272.35 7995.5,-9282.35 8002.5,-9282.35"/>
</g>
<!-- layer_9_ln1 -->
<g id="node524" class="node">
<title>layer_9_ln1</title>
<polygon fill="lightblue" stroke="black" points="8054.5,-9141.02 7943.5,-9141.02 7943.5,-9103.02 8054.5,-9103.02 8054.5,-9141.02"/>
<text text-anchor="middle" x="7999" y="-9125.82" font-family="Times,serif" font-size="14.00">LayerNorm 9</text>
<text text-anchor="middle" x="7999" y="-9110.82" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_9_residual1&#45;&gt;layer_9_ln1 -->
<g id="edge657" class="edge">
<title>layer_9_residual1&#45;&gt;layer_9_ln1</title>
<path fill="none" stroke="black" d="M7999,-9195.78C7999,-9181.22 7999,-9164.81 7999,-9151.26"/>
<polygon fill="black" stroke="black" points="8002.5,-9151.09 7999,-9141.09 7995.5,-9151.09 8002.5,-9151.09"/>
</g>
<!-- layer_9_mlp1_gpu8 -->
<g id="node525" class="node">
<title>layer_9_mlp1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="8566,-9045.02 8440,-9045.02 8440,-8992.02 8566,-8992.02 8566,-9045.02"/>
<text text-anchor="middle" x="8503" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU8</text>
<text text-anchor="middle" x="8503" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8503" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp1_gpu8 -->
<g id="edge658" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp1_gpu8</title>
<path fill="none" stroke="black" d="M8054.71,-9119.05C8155.54,-9114.85 8364.07,-9103.11 8431,-9076.02 8444.87,-9070.41 8458.27,-9061.28 8469.68,-9051.99"/>
<polygon fill="black" stroke="black" points="8472.27,-9054.38 8477.61,-9045.24 8467.73,-9049.05 8472.27,-9054.38"/>
</g>
<!-- layer_9_mlp1_gpu9 -->
<g id="node526" class="node">
<title>layer_9_mlp1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="8422,-9045.02 8296,-9045.02 8296,-8992.02 8422,-8992.02 8422,-9045.02"/>
<text text-anchor="middle" x="8359" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU9</text>
<text text-anchor="middle" x="8359" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8359" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp1_gpu9 -->
<g id="edge662" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp1_gpu9</title>
<path fill="none" stroke="black" d="M8054.64,-9120.58C8114.4,-9118.25 8211.01,-9109.07 8287,-9076.02 8300.6,-9070.11 8313.86,-9061 8325.21,-9051.8"/>
<polygon fill="black" stroke="black" points="8327.73,-9054.26 8333.12,-9045.14 8323.22,-9048.91 8327.73,-9054.26"/>
</g>
<!-- layer_9_mlp1_gpu10 -->
<g id="node527" class="node">
<title>layer_9_mlp1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="8278,-9045.02 8152,-9045.02 8152,-8992.02 8278,-8992.02 8278,-9045.02"/>
<text text-anchor="middle" x="8215" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU10</text>
<text text-anchor="middle" x="8215" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8215" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp1_gpu10 -->
<g id="edge666" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp1_gpu10</title>
<path fill="none" stroke="black" d="M8054.53,-9108.71C8082.08,-9101.36 8115.3,-9090.59 8143,-9076.02 8155.67,-9069.36 8168.35,-9060.38 8179.45,-9051.55"/>
<polygon fill="black" stroke="black" points="8181.71,-9054.22 8187.24,-9045.18 8177.28,-9048.8 8181.71,-9054.22"/>
</g>
<!-- layer_9_mlp1_gpu11 -->
<g id="node528" class="node">
<title>layer_9_mlp1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="8134,-9045.02 8008,-9045.02 8008,-8992.02 8134,-8992.02 8134,-9045.02"/>
<text text-anchor="middle" x="8071" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU11</text>
<text text-anchor="middle" x="8071" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8071" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp1_gpu11 -->
<g id="edge670" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp1_gpu11</title>
<path fill="none" stroke="black" d="M8011.87,-9102.88C8021.59,-9089.18 8035.19,-9070 8046.91,-9053.49"/>
<polygon fill="black" stroke="black" points="8049.9,-9055.32 8052.83,-9045.14 8044.19,-9051.27 8049.9,-9055.32"/>
</g>
<!-- layer_9_mlp1_gpu12 -->
<g id="node529" class="node">
<title>layer_9_mlp1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="7990,-9045.02 7864,-9045.02 7864,-8992.02 7990,-8992.02 7990,-9045.02"/>
<text text-anchor="middle" x="7927" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU12</text>
<text text-anchor="middle" x="7927" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7927" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp1_gpu12 -->
<g id="edge674" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp1_gpu12</title>
<path fill="none" stroke="black" d="M7986.13,-9102.88C7976.41,-9089.18 7962.81,-9070 7951.09,-9053.49"/>
<polygon fill="black" stroke="black" points="7953.81,-9051.27 7945.17,-9045.14 7948.1,-9055.32 7953.81,-9051.27"/>
</g>
<!-- layer_9_mlp1_gpu13 -->
<g id="node530" class="node">
<title>layer_9_mlp1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="7846,-9045.02 7720,-9045.02 7720,-8992.02 7846,-8992.02 7846,-9045.02"/>
<text text-anchor="middle" x="7783" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU13</text>
<text text-anchor="middle" x="7783" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7783" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp1_gpu13 -->
<g id="edge678" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp1_gpu13</title>
<path fill="none" stroke="black" d="M7943.47,-9108.71C7915.92,-9101.36 7882.7,-9090.59 7855,-9076.02 7842.33,-9069.36 7829.65,-9060.38 7818.55,-9051.55"/>
<polygon fill="black" stroke="black" points="7820.72,-9048.8 7810.76,-9045.18 7816.29,-9054.22 7820.72,-9048.8"/>
</g>
<!-- layer_9_mlp1_gpu14 -->
<g id="node531" class="node">
<title>layer_9_mlp1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="7702,-9045.02 7576,-9045.02 7576,-8992.02 7702,-8992.02 7702,-9045.02"/>
<text text-anchor="middle" x="7639" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU14</text>
<text text-anchor="middle" x="7639" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7639" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp1_gpu14 -->
<g id="edge682" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp1_gpu14</title>
<path fill="none" stroke="black" d="M7943.36,-9120.58C7883.6,-9118.25 7786.99,-9109.07 7711,-9076.02 7697.4,-9070.11 7684.14,-9061 7672.79,-9051.8"/>
<polygon fill="black" stroke="black" points="7674.78,-9048.91 7664.88,-9045.14 7670.27,-9054.26 7674.78,-9048.91"/>
</g>
<!-- layer_9_mlp1_gpu15 -->
<g id="node532" class="node">
<title>layer_9_mlp1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="7558,-9045.02 7432,-9045.02 7432,-8992.02 7558,-8992.02 7558,-9045.02"/>
<text text-anchor="middle" x="7495" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU15</text>
<text text-anchor="middle" x="7495" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7495" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp1_gpu15 -->
<g id="edge686" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp1_gpu15</title>
<path fill="none" stroke="black" d="M7943.29,-9119.05C7842.46,-9114.85 7633.93,-9103.11 7567,-9076.02 7553.13,-9070.41 7539.73,-9061.28 7528.32,-9051.99"/>
<polygon fill="black" stroke="black" points="7530.27,-9049.05 7520.39,-9045.24 7525.73,-9054.38 7530.27,-9049.05"/>
</g>
<!-- layer_9_gelu_gpu8 -->
<g id="node533" class="node">
<title>layer_9_gelu_gpu8</title>
<polygon fill="lightblue" stroke="black" points="8555,-8945.52 8451,-8945.52 8451,-8907.52 8555,-8907.52 8555,-8945.52"/>
<text text-anchor="middle" x="8503" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU8</text>
<text text-anchor="middle" x="8503" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_9_mlp1_gpu8&#45;&gt;layer_9_gelu_gpu8 -->
<g id="edge659" class="edge">
<title>layer_9_mlp1_gpu8&#45;&gt;layer_9_gelu_gpu8</title>
<path fill="none" stroke="black" d="M8503,-8991.97C8503,-8980.67 8503,-8967.35 8503,-8955.75"/>
<polygon fill="black" stroke="black" points="8506.5,-8955.7 8503,-8945.7 8499.5,-8955.7 8506.5,-8955.7"/>
</g>
<!-- layer_9_gelu_gpu9 -->
<g id="node534" class="node">
<title>layer_9_gelu_gpu9</title>
<polygon fill="lightblue" stroke="black" points="8411,-8945.52 8307,-8945.52 8307,-8907.52 8411,-8907.52 8411,-8945.52"/>
<text text-anchor="middle" x="8359" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU9</text>
<text text-anchor="middle" x="8359" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_9_mlp1_gpu9&#45;&gt;layer_9_gelu_gpu9 -->
<g id="edge663" class="edge">
<title>layer_9_mlp1_gpu9&#45;&gt;layer_9_gelu_gpu9</title>
<path fill="none" stroke="black" d="M8359,-8991.97C8359,-8980.67 8359,-8967.35 8359,-8955.75"/>
<polygon fill="black" stroke="black" points="8362.5,-8955.7 8359,-8945.7 8355.5,-8955.7 8362.5,-8955.7"/>
</g>
<!-- layer_9_gelu_gpu10 -->
<g id="node535" class="node">
<title>layer_9_gelu_gpu10</title>
<polygon fill="lightblue" stroke="black" points="8271.5,-8945.52 8158.5,-8945.52 8158.5,-8907.52 8271.5,-8907.52 8271.5,-8945.52"/>
<text text-anchor="middle" x="8215" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU10</text>
<text text-anchor="middle" x="8215" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_9_mlp1_gpu10&#45;&gt;layer_9_gelu_gpu10 -->
<g id="edge667" class="edge">
<title>layer_9_mlp1_gpu10&#45;&gt;layer_9_gelu_gpu10</title>
<path fill="none" stroke="black" d="M8215,-8991.97C8215,-8980.67 8215,-8967.35 8215,-8955.75"/>
<polygon fill="black" stroke="black" points="8218.5,-8955.7 8215,-8945.7 8211.5,-8955.7 8218.5,-8955.7"/>
</g>
<!-- layer_9_gelu_gpu11 -->
<g id="node536" class="node">
<title>layer_9_gelu_gpu11</title>
<polygon fill="lightblue" stroke="black" points="8127.5,-8945.52 8014.5,-8945.52 8014.5,-8907.52 8127.5,-8907.52 8127.5,-8945.52"/>
<text text-anchor="middle" x="8071" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU11</text>
<text text-anchor="middle" x="8071" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_9_mlp1_gpu11&#45;&gt;layer_9_gelu_gpu11 -->
<g id="edge671" class="edge">
<title>layer_9_mlp1_gpu11&#45;&gt;layer_9_gelu_gpu11</title>
<path fill="none" stroke="black" d="M8071,-8991.97C8071,-8980.67 8071,-8967.35 8071,-8955.75"/>
<polygon fill="black" stroke="black" points="8074.5,-8955.7 8071,-8945.7 8067.5,-8955.7 8074.5,-8955.7"/>
</g>
<!-- layer_9_gelu_gpu12 -->
<g id="node537" class="node">
<title>layer_9_gelu_gpu12</title>
<polygon fill="lightblue" stroke="black" points="7983.5,-8945.52 7870.5,-8945.52 7870.5,-8907.52 7983.5,-8907.52 7983.5,-8945.52"/>
<text text-anchor="middle" x="7927" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU12</text>
<text text-anchor="middle" x="7927" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_9_mlp1_gpu12&#45;&gt;layer_9_gelu_gpu12 -->
<g id="edge675" class="edge">
<title>layer_9_mlp1_gpu12&#45;&gt;layer_9_gelu_gpu12</title>
<path fill="none" stroke="black" d="M7927,-8991.97C7927,-8980.67 7927,-8967.35 7927,-8955.75"/>
<polygon fill="black" stroke="black" points="7930.5,-8955.7 7927,-8945.7 7923.5,-8955.7 7930.5,-8955.7"/>
</g>
<!-- layer_9_gelu_gpu13 -->
<g id="node538" class="node">
<title>layer_9_gelu_gpu13</title>
<polygon fill="lightblue" stroke="black" points="7839.5,-8945.52 7726.5,-8945.52 7726.5,-8907.52 7839.5,-8907.52 7839.5,-8945.52"/>
<text text-anchor="middle" x="7783" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU13</text>
<text text-anchor="middle" x="7783" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_9_mlp1_gpu13&#45;&gt;layer_9_gelu_gpu13 -->
<g id="edge679" class="edge">
<title>layer_9_mlp1_gpu13&#45;&gt;layer_9_gelu_gpu13</title>
<path fill="none" stroke="black" d="M7783,-8991.97C7783,-8980.67 7783,-8967.35 7783,-8955.75"/>
<polygon fill="black" stroke="black" points="7786.5,-8955.7 7783,-8945.7 7779.5,-8955.7 7786.5,-8955.7"/>
</g>
<!-- layer_9_gelu_gpu14 -->
<g id="node539" class="node">
<title>layer_9_gelu_gpu14</title>
<polygon fill="lightblue" stroke="black" points="7695.5,-8945.52 7582.5,-8945.52 7582.5,-8907.52 7695.5,-8907.52 7695.5,-8945.52"/>
<text text-anchor="middle" x="7639" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU14</text>
<text text-anchor="middle" x="7639" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_9_mlp1_gpu14&#45;&gt;layer_9_gelu_gpu14 -->
<g id="edge683" class="edge">
<title>layer_9_mlp1_gpu14&#45;&gt;layer_9_gelu_gpu14</title>
<path fill="none" stroke="black" d="M7639,-8991.97C7639,-8980.67 7639,-8967.35 7639,-8955.75"/>
<polygon fill="black" stroke="black" points="7642.5,-8955.7 7639,-8945.7 7635.5,-8955.7 7642.5,-8955.7"/>
</g>
<!-- layer_9_gelu_gpu15 -->
<g id="node540" class="node">
<title>layer_9_gelu_gpu15</title>
<polygon fill="lightblue" stroke="black" points="7551.5,-8945.52 7438.5,-8945.52 7438.5,-8907.52 7551.5,-8907.52 7551.5,-8945.52"/>
<text text-anchor="middle" x="7495" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU15</text>
<text text-anchor="middle" x="7495" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_9_mlp1_gpu15&#45;&gt;layer_9_gelu_gpu15 -->
<g id="edge687" class="edge">
<title>layer_9_mlp1_gpu15&#45;&gt;layer_9_gelu_gpu15</title>
<path fill="none" stroke="black" d="M7495,-8991.97C7495,-8980.67 7495,-8967.35 7495,-8955.75"/>
<polygon fill="black" stroke="black" points="7498.5,-8955.7 7495,-8945.7 7491.5,-8955.7 7498.5,-8955.7"/>
</g>
<!-- layer_9_mlp2_gpu8 -->
<g id="node541" class="node">
<title>layer_9_mlp2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="8566,-8864.02 8440,-8864.02 8440,-8811.02 8566,-8811.02 8566,-8864.02"/>
<text text-anchor="middle" x="8503" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU8</text>
<text text-anchor="middle" x="8503" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="8503" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_9_gelu_gpu8&#45;&gt;layer_9_mlp2_gpu8 -->
<g id="edge660" class="edge">
<title>layer_9_gelu_gpu8&#45;&gt;layer_9_mlp2_gpu8</title>
<path fill="none" stroke="black" d="M8503,-8907.5C8503,-8897.89 8503,-8885.73 8503,-8874.31"/>
<polygon fill="black" stroke="black" points="8506.5,-8874.11 8503,-8864.11 8499.5,-8874.11 8506.5,-8874.11"/>
</g>
<!-- layer_9_mlp2_gpu9 -->
<g id="node542" class="node">
<title>layer_9_mlp2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="8422,-8864.02 8296,-8864.02 8296,-8811.02 8422,-8811.02 8422,-8864.02"/>
<text text-anchor="middle" x="8359" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU9</text>
<text text-anchor="middle" x="8359" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="8359" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_9_gelu_gpu9&#45;&gt;layer_9_mlp2_gpu9 -->
<g id="edge664" class="edge">
<title>layer_9_gelu_gpu9&#45;&gt;layer_9_mlp2_gpu9</title>
<path fill="none" stroke="black" d="M8359,-8907.5C8359,-8897.89 8359,-8885.73 8359,-8874.31"/>
<polygon fill="black" stroke="black" points="8362.5,-8874.11 8359,-8864.11 8355.5,-8874.11 8362.5,-8874.11"/>
</g>
<!-- layer_9_mlp2_gpu10 -->
<g id="node543" class="node">
<title>layer_9_mlp2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="8278,-8864.02 8152,-8864.02 8152,-8811.02 8278,-8811.02 8278,-8864.02"/>
<text text-anchor="middle" x="8215" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU10</text>
<text text-anchor="middle" x="8215" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="8215" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_9_gelu_gpu10&#45;&gt;layer_9_mlp2_gpu10 -->
<g id="edge668" class="edge">
<title>layer_9_gelu_gpu10&#45;&gt;layer_9_mlp2_gpu10</title>
<path fill="none" stroke="black" d="M8215,-8907.5C8215,-8897.89 8215,-8885.73 8215,-8874.31"/>
<polygon fill="black" stroke="black" points="8218.5,-8874.11 8215,-8864.11 8211.5,-8874.11 8218.5,-8874.11"/>
</g>
<!-- layer_9_mlp2_gpu11 -->
<g id="node544" class="node">
<title>layer_9_mlp2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="8134,-8864.02 8008,-8864.02 8008,-8811.02 8134,-8811.02 8134,-8864.02"/>
<text text-anchor="middle" x="8071" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU11</text>
<text text-anchor="middle" x="8071" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="8071" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_9_gelu_gpu11&#45;&gt;layer_9_mlp2_gpu11 -->
<g id="edge672" class="edge">
<title>layer_9_gelu_gpu11&#45;&gt;layer_9_mlp2_gpu11</title>
<path fill="none" stroke="black" d="M8071,-8907.5C8071,-8897.89 8071,-8885.73 8071,-8874.31"/>
<polygon fill="black" stroke="black" points="8074.5,-8874.11 8071,-8864.11 8067.5,-8874.11 8074.5,-8874.11"/>
</g>
<!-- layer_9_mlp2_gpu12 -->
<g id="node545" class="node">
<title>layer_9_mlp2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="7990,-8864.02 7864,-8864.02 7864,-8811.02 7990,-8811.02 7990,-8864.02"/>
<text text-anchor="middle" x="7927" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU12</text>
<text text-anchor="middle" x="7927" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="7927" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_9_gelu_gpu12&#45;&gt;layer_9_mlp2_gpu12 -->
<g id="edge676" class="edge">
<title>layer_9_gelu_gpu12&#45;&gt;layer_9_mlp2_gpu12</title>
<path fill="none" stroke="black" d="M7927,-8907.5C7927,-8897.89 7927,-8885.73 7927,-8874.31"/>
<polygon fill="black" stroke="black" points="7930.5,-8874.11 7927,-8864.11 7923.5,-8874.11 7930.5,-8874.11"/>
</g>
<!-- layer_9_mlp2_gpu13 -->
<g id="node546" class="node">
<title>layer_9_mlp2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="7846,-8864.02 7720,-8864.02 7720,-8811.02 7846,-8811.02 7846,-8864.02"/>
<text text-anchor="middle" x="7783" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU13</text>
<text text-anchor="middle" x="7783" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="7783" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_9_gelu_gpu13&#45;&gt;layer_9_mlp2_gpu13 -->
<g id="edge680" class="edge">
<title>layer_9_gelu_gpu13&#45;&gt;layer_9_mlp2_gpu13</title>
<path fill="none" stroke="black" d="M7783,-8907.5C7783,-8897.89 7783,-8885.73 7783,-8874.31"/>
<polygon fill="black" stroke="black" points="7786.5,-8874.11 7783,-8864.11 7779.5,-8874.11 7786.5,-8874.11"/>
</g>
<!-- layer_9_mlp2_gpu14 -->
<g id="node547" class="node">
<title>layer_9_mlp2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="7702,-8864.02 7576,-8864.02 7576,-8811.02 7702,-8811.02 7702,-8864.02"/>
<text text-anchor="middle" x="7639" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU14</text>
<text text-anchor="middle" x="7639" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="7639" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_9_gelu_gpu14&#45;&gt;layer_9_mlp2_gpu14 -->
<g id="edge684" class="edge">
<title>layer_9_gelu_gpu14&#45;&gt;layer_9_mlp2_gpu14</title>
<path fill="none" stroke="black" d="M7639,-8907.5C7639,-8897.89 7639,-8885.73 7639,-8874.31"/>
<polygon fill="black" stroke="black" points="7642.5,-8874.11 7639,-8864.11 7635.5,-8874.11 7642.5,-8874.11"/>
</g>
<!-- layer_9_mlp2_gpu15 -->
<g id="node548" class="node">
<title>layer_9_mlp2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="7558,-8864.02 7432,-8864.02 7432,-8811.02 7558,-8811.02 7558,-8864.02"/>
<text text-anchor="middle" x="7495" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU15</text>
<text text-anchor="middle" x="7495" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="7495" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_9_gelu_gpu15&#45;&gt;layer_9_mlp2_gpu15 -->
<g id="edge688" class="edge">
<title>layer_9_gelu_gpu15&#45;&gt;layer_9_mlp2_gpu15</title>
<path fill="none" stroke="black" d="M7495,-8907.5C7495,-8897.89 7495,-8885.73 7495,-8874.31"/>
<polygon fill="black" stroke="black" points="7498.5,-8874.11 7495,-8864.11 7491.5,-8874.11 7498.5,-8874.11"/>
</g>
<!-- layer_9_mlp_allreduce -->
<g id="node549" class="node">
<title>layer_9_mlp_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="7999" cy="-8748.15" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="7999" y="-8751.95" font-family="Times,serif" font-size="14.00">MLP AllReduce</text>
<text text-anchor="middle" x="7999" y="-8736.95" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_9_mlp2_gpu8&#45;&gt;layer_9_mlp_allreduce -->
<g id="edge661" class="edge">
<title>layer_9_mlp2_gpu8&#45;&gt;layer_9_mlp_allreduce</title>
<path fill="none" stroke="black" d="M8440,-8813.41C8436.97,-8812.56 8433.96,-8811.75 8431,-8811.02 8316.59,-8782.87 8181.77,-8766.09 8093.56,-8757.25"/>
<polygon fill="black" stroke="black" points="8093.86,-8753.77 8083.57,-8756.27 8093.18,-8760.73 8093.86,-8753.77"/>
</g>
<!-- layer_9_mlp2_gpu9&#45;&gt;layer_9_mlp_allreduce -->
<g id="edge665" class="edge">
<title>layer_9_mlp2_gpu9&#45;&gt;layer_9_mlp_allreduce</title>
<path fill="none" stroke="black" d="M8295.93,-8813.67C8292.92,-8812.74 8289.93,-8811.85 8287,-8811.02 8219.58,-8791.93 8141.82,-8775.55 8084.11,-8764.45"/>
<polygon fill="black" stroke="black" points="8084.42,-8760.94 8073.94,-8762.51 8083.1,-8767.82 8084.42,-8760.94"/>
</g>
<!-- layer_9_mlp2_gpu10&#45;&gt;layer_9_mlp_allreduce -->
<g id="edge669" class="edge">
<title>layer_9_mlp2_gpu10&#45;&gt;layer_9_mlp_allreduce</title>
<path fill="none" stroke="black" d="M8151.94,-8811.02C8123.08,-8799.34 8089,-8785.56 8060.35,-8773.97"/>
<polygon fill="black" stroke="black" points="8061.44,-8770.63 8050.86,-8770.13 8058.81,-8777.12 8061.44,-8770.63"/>
</g>
<!-- layer_9_mlp2_gpu11&#45;&gt;layer_9_mlp_allreduce -->
<g id="edge673" class="edge">
<title>layer_9_mlp2_gpu11&#45;&gt;layer_9_mlp_allreduce</title>
<path fill="none" stroke="black" d="M8049.79,-8810.78C8042.4,-8801.82 8034,-8791.63 8026.2,-8782.16"/>
<polygon fill="black" stroke="black" points="8028.87,-8779.9 8019.81,-8774.41 8023.47,-8784.35 8028.87,-8779.9"/>
</g>
<!-- layer_9_mlp2_gpu12&#45;&gt;layer_9_mlp_allreduce -->
<g id="edge677" class="edge">
<title>layer_9_mlp2_gpu12&#45;&gt;layer_9_mlp_allreduce</title>
<path fill="none" stroke="black" d="M7948.21,-8810.78C7955.6,-8801.82 7964,-8791.63 7971.8,-8782.16"/>
<polygon fill="black" stroke="black" points="7974.53,-8784.35 7978.19,-8774.41 7969.13,-8779.9 7974.53,-8784.35"/>
</g>
<!-- layer_9_mlp2_gpu13&#45;&gt;layer_9_mlp_allreduce -->
<g id="edge681" class="edge">
<title>layer_9_mlp2_gpu13&#45;&gt;layer_9_mlp_allreduce</title>
<path fill="none" stroke="black" d="M7846.06,-8811.02C7874.92,-8799.34 7909,-8785.56 7937.65,-8773.97"/>
<polygon fill="black" stroke="black" points="7939.19,-8777.12 7947.14,-8770.13 7936.56,-8770.63 7939.19,-8777.12"/>
</g>
<!-- layer_9_mlp2_gpu14&#45;&gt;layer_9_mlp_allreduce -->
<g id="edge685" class="edge">
<title>layer_9_mlp2_gpu14&#45;&gt;layer_9_mlp_allreduce</title>
<path fill="none" stroke="black" d="M7702.07,-8813.67C7705.08,-8812.74 7708.07,-8811.85 7711,-8811.02 7778.42,-8791.93 7856.18,-8775.55 7913.89,-8764.45"/>
<polygon fill="black" stroke="black" points="7914.9,-8767.82 7924.06,-8762.51 7913.58,-8760.94 7914.9,-8767.82"/>
</g>
<!-- layer_9_mlp2_gpu15&#45;&gt;layer_9_mlp_allreduce -->
<g id="edge689" class="edge">
<title>layer_9_mlp2_gpu15&#45;&gt;layer_9_mlp_allreduce</title>
<path fill="none" stroke="black" d="M7558,-8813.41C7561.03,-8812.56 7564.04,-8811.75 7567,-8811.02 7681.41,-8782.87 7816.23,-8766.09 7904.44,-8757.25"/>
<polygon fill="black" stroke="black" points="7904.82,-8760.73 7914.43,-8756.27 7904.14,-8753.77 7904.82,-8760.73"/>
</g>
<!-- layer_9_residual2 -->
<g id="node550" class="node">
<title>layer_9_residual2</title>
<polygon fill="lightyellow" stroke="black" points="8127.61,-8685.28 7923.02,-8685.28 7870.39,-8609.28 8074.98,-8609.28 8127.61,-8685.28"/>
<text text-anchor="middle" x="7999" y="-8651.08" font-family="Times,serif" font-size="14.00">Residual Add 9</text>
<text text-anchor="middle" x="7999" y="-8636.08" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_9_mlp_allreduce&#45;&gt;layer_9_residual2 -->
<g id="edge690" class="edge">
<title>layer_9_mlp_allreduce&#45;&gt;layer_9_residual2</title>
<path fill="none" stroke="black" d="M7999,-8721.18C7999,-8713.36 7999,-8704.53 7999,-8695.78"/>
<polygon fill="black" stroke="black" points="8002.5,-8695.61 7999,-8685.61 7995.5,-8695.61 8002.5,-8695.61"/>
</g>
<!-- layer_9_ln2 -->
<g id="node551" class="node">
<title>layer_9_ln2</title>
<polygon fill="lightblue" stroke="black" points="8054.5,-8554.28 7943.5,-8554.28 7943.5,-8516.28 8054.5,-8516.28 8054.5,-8554.28"/>
<text text-anchor="middle" x="7999" y="-8539.08" font-family="Times,serif" font-size="14.00">LayerNorm 9</text>
<text text-anchor="middle" x="7999" y="-8524.08" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_9_residual2&#45;&gt;layer_9_ln2 -->
<g id="edge691" class="edge">
<title>layer_9_residual2&#45;&gt;layer_9_ln2</title>
<path fill="none" stroke="black" d="M7999,-8609.04C7999,-8594.48 7999,-8578.07 7999,-8564.52"/>
<polygon fill="black" stroke="black" points="8002.5,-8564.35 7999,-8554.35 7995.5,-8564.35 8002.5,-8564.35"/>
</g>
<!-- layer_10_qkv_gpu0 -->
<g id="node886" class="node">
<title>layer_10_qkv_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="8143.69,-8411.28 7913.52,-8411.28 7854.31,-8375.28 8084.48,-8375.28 8143.69,-8411.28"/>
<text text-anchor="middle" x="7999" y="-8389.58" font-family="Times,serif" font-size="14.00">layer_10_qkv_gpu0</text>
</g>
<!-- layer_9_ln2&#45;&gt;layer_10_qkv_gpu0 -->
<g id="edge692" class="edge">
<title>layer_9_ln2&#45;&gt;layer_10_qkv_gpu0</title>
<path fill="none" stroke="black" d="M7999,-8516.27C7999,-8492.27 7999,-8449.62 7999,-8421.64"/>
<polygon fill="black" stroke="black" points="8002.5,-8421.35 7999,-8411.35 7995.5,-8421.35 8002.5,-8421.35"/>
</g>
<!-- layer_10_qkv_gpu8 -->
<g id="node552" class="node">
<title>layer_10_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="10382,-9763.37 10254,-9763.37 10254,-9710.37 10382,-9710.37 10382,-9763.37"/>
<text text-anchor="middle" x="10318" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU8</text>
<text text-anchor="middle" x="10318" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="10318" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_10_qkv_comm -->
<g id="node560" class="node">
<title>layer_10_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="9788" cy="-9603.37" rx="85.62" ry="26.74"/>
<text text-anchor="middle" x="9788" y="-9607.17" font-family="Times,serif" font-size="14.00">QKV AllGather</text>
<text text-anchor="middle" x="9788" y="-9592.17" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_10_qkv_gpu8&#45;&gt;layer_10_qkv_comm -->
<g id="edge693" class="edge">
<title>layer_10_qkv_gpu8&#45;&gt;layer_10_qkv_comm</title>
<path fill="none" stroke="black" d="M10297.05,-9710.1C10283.73,-9695.55 10265.22,-9678.43 10245,-9668.87 10182.32,-9639.26 9995.6,-9620.21 9881.15,-9610.98"/>
<polygon fill="black" stroke="black" points="9881.24,-9607.47 9870.99,-9610.17 9880.68,-9614.45 9881.24,-9607.47"/>
</g>
<!-- layer_10_qkv_gpu9 -->
<g id="node553" class="node">
<title>layer_10_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="10236,-9763.37 10108,-9763.37 10108,-9710.37 10236,-9710.37 10236,-9763.37"/>
<text text-anchor="middle" x="10172" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU9</text>
<text text-anchor="middle" x="10172" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="10172" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_10_qkv_gpu9&#45;&gt;layer_10_qkv_comm -->
<g id="edge694" class="edge">
<title>layer_10_qkv_gpu9&#45;&gt;layer_10_qkv_comm</title>
<path fill="none" stroke="black" d="M10150.51,-9710.24C10137.13,-9695.93 10118.75,-9678.99 10099,-9668.87 10031.11,-9634.08 9945.77,-9618.06 9881.66,-9610.68"/>
<polygon fill="black" stroke="black" points="9881.89,-9607.18 9871.56,-9609.56 9881.12,-9614.14 9881.89,-9607.18"/>
</g>
<!-- layer_10_qkv_gpu10 -->
<g id="node554" class="node">
<title>layer_10_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="10089.5,-9763.37 9952.5,-9763.37 9952.5,-9710.37 10089.5,-9710.37 10089.5,-9763.37"/>
<text text-anchor="middle" x="10021" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU10</text>
<text text-anchor="middle" x="10021" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="10021" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_10_qkv_gpu10&#45;&gt;layer_10_qkv_comm -->
<g id="edge695" class="edge">
<title>layer_10_qkv_gpu10&#45;&gt;layer_10_qkv_comm</title>
<path fill="none" stroke="black" d="M9995.94,-9710.35C9981.64,-9696.77 9962.84,-9680.53 9944,-9668.87 9916.57,-9651.9 9883.89,-9637.6 9855.55,-9626.81"/>
<polygon fill="black" stroke="black" points="9856.71,-9623.51 9846.12,-9623.29 9854.26,-9630.07 9856.71,-9623.51"/>
</g>
<!-- layer_10_qkv_gpu11 -->
<g id="node555" class="node">
<title>layer_10_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="9934.5,-9763.37 9797.5,-9763.37 9797.5,-9710.37 9934.5,-9710.37 9934.5,-9763.37"/>
<text text-anchor="middle" x="9866" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU11</text>
<text text-anchor="middle" x="9866" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9866" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_10_qkv_gpu11&#45;&gt;layer_10_qkv_comm -->
<g id="edge696" class="edge">
<title>layer_10_qkv_gpu11&#45;&gt;layer_10_qkv_comm</title>
<path fill="none" stroke="black" d="M9850.78,-9710.21C9838.7,-9689.84 9821.7,-9661.18 9808.43,-9638.82"/>
<polygon fill="black" stroke="black" points="9811.3,-9636.79 9803.19,-9629.97 9805.28,-9640.36 9811.3,-9636.79"/>
</g>
<!-- layer_10_qkv_gpu12 -->
<g id="node556" class="node">
<title>layer_10_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="9779.5,-9763.37 9642.5,-9763.37 9642.5,-9710.37 9779.5,-9710.37 9779.5,-9763.37"/>
<text text-anchor="middle" x="9711" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU12</text>
<text text-anchor="middle" x="9711" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9711" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_10_qkv_gpu12&#45;&gt;layer_10_qkv_comm -->
<g id="edge697" class="edge">
<title>layer_10_qkv_gpu12&#45;&gt;layer_10_qkv_comm</title>
<path fill="none" stroke="black" d="M9726.03,-9710.21C9737.95,-9689.84 9754.74,-9661.18 9767.83,-9638.82"/>
<polygon fill="black" stroke="black" points="9770.98,-9640.37 9773.01,-9629.97 9764.94,-9636.84 9770.98,-9640.37"/>
</g>
<!-- layer_10_qkv_gpu13 -->
<g id="node557" class="node">
<title>layer_10_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="9624.5,-9763.37 9487.5,-9763.37 9487.5,-9710.37 9624.5,-9710.37 9624.5,-9763.37"/>
<text text-anchor="middle" x="9556" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU13</text>
<text text-anchor="middle" x="9556" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9556" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_10_qkv_gpu13&#45;&gt;layer_10_qkv_comm -->
<g id="edge698" class="edge">
<title>layer_10_qkv_gpu13&#45;&gt;layer_10_qkv_comm</title>
<path fill="none" stroke="black" d="M9581.8,-9710.08C9596.28,-9696.59 9615.17,-9680.5 9634,-9668.87 9661.03,-9652.19 9693.13,-9637.97 9721.02,-9627.16"/>
<polygon fill="black" stroke="black" points="9722.59,-9630.31 9730.69,-9623.48 9720.1,-9623.76 9722.59,-9630.31"/>
</g>
<!-- layer_10_qkv_gpu14 -->
<g id="node558" class="node">
<title>layer_10_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="9469.5,-9763.37 9332.5,-9763.37 9332.5,-9710.37 9469.5,-9710.37 9469.5,-9763.37"/>
<text text-anchor="middle" x="9401" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU14</text>
<text text-anchor="middle" x="9401" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9401" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_10_qkv_gpu14&#45;&gt;layer_10_qkv_comm -->
<g id="edge699" class="edge">
<title>layer_10_qkv_gpu14&#45;&gt;layer_10_qkv_comm</title>
<path fill="none" stroke="black" d="M9424.29,-9710.28C9438.7,-9695.98 9458.34,-9679.05 9479,-9668.87 9547.01,-9635.37 9631.76,-9619.24 9695.29,-9611.49"/>
<polygon fill="black" stroke="black" points="9695.77,-9614.96 9705.3,-9610.32 9694.96,-9608.01 9695.77,-9614.96"/>
</g>
<!-- layer_10_qkv_gpu15 -->
<g id="node559" class="node">
<title>layer_10_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="9314.5,-9763.37 9177.5,-9763.37 9177.5,-9710.37 9314.5,-9710.37 9314.5,-9763.37"/>
<text text-anchor="middle" x="9246" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU15</text>
<text text-anchor="middle" x="9246" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9246" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_10_qkv_gpu15&#45;&gt;layer_10_qkv_comm -->
<g id="edge700" class="edge">
<title>layer_10_qkv_gpu15&#45;&gt;layer_10_qkv_comm</title>
<path fill="none" stroke="black" d="M9268.71,-9710.1C9283.06,-9695.55 9302.85,-9678.42 9324,-9668.87 9388.31,-9639.85 9578.6,-9620.54 9694.56,-9611.11"/>
<polygon fill="black" stroke="black" points="9695.16,-9614.57 9704.85,-9610.28 9694.6,-9607.59 9695.16,-9614.57"/>
</g>
<!-- layer_10_attn_comp_gpu8 -->
<g id="node561" class="node">
<title>layer_10_attn_comp_gpu8</title>
<polygon fill="lightblue" stroke="black" points="9113,-9540.13 8915,-9540.13 8915,-9487.13 9113,-9487.13 9113,-9540.13"/>
<text text-anchor="middle" x="9014" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU8</text>
<text text-anchor="middle" x="9014" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="9014" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_10_qkv_comm&#45;&gt;layer_10_attn_comp_gpu8 -->
<g id="edge701" class="edge">
<title>layer_10_qkv_comm&#45;&gt;layer_10_attn_comp_gpu8</title>
<path fill="none" stroke="black" d="M9703.66,-9598.4C9578.76,-9591.65 9337.21,-9575.34 9123.22,-9540.61"/>
<polygon fill="black" stroke="black" points="9123.49,-9537.1 9113.05,-9538.94 9122.36,-9544.01 9123.49,-9537.1"/>
</g>
<!-- layer_10_attn_comp_gpu9 -->
<g id="node562" class="node">
<title>layer_10_attn_comp_gpu9</title>
<polygon fill="lightblue" stroke="black" points="9329,-9540.13 9131,-9540.13 9131,-9487.13 9329,-9487.13 9329,-9540.13"/>
<text text-anchor="middle" x="9230" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU9</text>
<text text-anchor="middle" x="9230" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="9230" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_10_qkv_comm&#45;&gt;layer_10_attn_comp_gpu9 -->
<g id="edge702" class="edge">
<title>layer_10_qkv_comm&#45;&gt;layer_10_attn_comp_gpu9</title>
<path fill="none" stroke="black" d="M9708.14,-9593.72C9618.07,-9583.41 9467.39,-9564.53 9339,-9540.5 9338.9,-9540.48 9338.8,-9540.46 9338.7,-9540.45"/>
<polygon fill="black" stroke="black" points="9339.61,-9537.06 9329.12,-9538.59 9338.27,-9543.93 9339.61,-9537.06"/>
</g>
<!-- layer_10_attn_comp_gpu10 -->
<g id="node563" class="node">
<title>layer_10_attn_comp_gpu10</title>
<polygon fill="lightblue" stroke="black" points="9554.5,-9540.13 9347.5,-9540.13 9347.5,-9487.13 9554.5,-9487.13 9554.5,-9540.13"/>
<text text-anchor="middle" x="9451" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU10</text>
<text text-anchor="middle" x="9451" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="9451" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_10_qkv_comm&#45;&gt;layer_10_attn_comp_gpu10 -->
<g id="edge703" class="edge">
<title>layer_10_qkv_comm&#45;&gt;layer_10_attn_comp_gpu10</title>
<path fill="none" stroke="black" d="M9723.42,-9585.56C9677,-9573.47 9613.32,-9556.89 9559.2,-9542.8"/>
<polygon fill="black" stroke="black" points="9559.77,-9539.33 9549.21,-9540.2 9558,-9546.11 9559.77,-9539.33"/>
</g>
<!-- layer_10_attn_comp_gpu11 -->
<g id="node564" class="node">
<title>layer_10_attn_comp_gpu11</title>
<polygon fill="lightblue" stroke="black" points="9779.5,-9540.13 9572.5,-9540.13 9572.5,-9487.13 9779.5,-9487.13 9779.5,-9540.13"/>
<text text-anchor="middle" x="9676" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU11</text>
<text text-anchor="middle" x="9676" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="9676" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_10_qkv_comm&#45;&gt;layer_10_attn_comp_gpu11 -->
<g id="edge704" class="edge">
<title>layer_10_qkv_comm&#45;&gt;layer_10_attn_comp_gpu11</title>
<path fill="none" stroke="black" d="M9757.1,-9578.17C9744.66,-9568.42 9730.14,-9557.04 9716.84,-9546.63"/>
<polygon fill="black" stroke="black" points="9718.79,-9543.71 9708.76,-9540.29 9714.47,-9549.22 9718.79,-9543.71"/>
</g>
<!-- layer_10_attn_comp_gpu12 -->
<g id="node565" class="node">
<title>layer_10_attn_comp_gpu12</title>
<polygon fill="lightblue" stroke="black" points="10004.5,-9540.13 9797.5,-9540.13 9797.5,-9487.13 10004.5,-9487.13 10004.5,-9540.13"/>
<text text-anchor="middle" x="9901" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU12</text>
<text text-anchor="middle" x="9901" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="9901" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_10_qkv_comm&#45;&gt;layer_10_attn_comp_gpu12 -->
<g id="edge705" class="edge">
<title>layer_10_qkv_comm&#45;&gt;layer_10_attn_comp_gpu12</title>
<path fill="none" stroke="black" d="M9819.18,-9578.17C9831.73,-9568.42 9846.38,-9557.04 9859.79,-9546.63"/>
<polygon fill="black" stroke="black" points="9862.2,-9549.19 9867.95,-9540.29 9857.91,-9543.66 9862.2,-9549.19"/>
</g>
<!-- layer_10_attn_comp_gpu13 -->
<g id="node566" class="node">
<title>layer_10_attn_comp_gpu13</title>
<polygon fill="lightblue" stroke="black" points="10229.5,-9540.13 10022.5,-9540.13 10022.5,-9487.13 10229.5,-9487.13 10229.5,-9540.13"/>
<text text-anchor="middle" x="10126" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU13</text>
<text text-anchor="middle" x="10126" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="10126" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_10_qkv_comm&#45;&gt;layer_10_attn_comp_gpu13 -->
<g id="edge706" class="edge">
<title>layer_10_qkv_comm&#45;&gt;layer_10_attn_comp_gpu13</title>
<path fill="none" stroke="black" d="M9852.37,-9585.66C9899.08,-9573.54 9963.37,-9556.85 10017.89,-9542.7"/>
<polygon fill="black" stroke="black" points="10018.8,-9546.08 10027.6,-9540.18 10017.04,-9539.3 10018.8,-9546.08"/>
</g>
<!-- layer_10_attn_comp_gpu14 -->
<g id="node567" class="node">
<title>layer_10_attn_comp_gpu14</title>
<polygon fill="lightblue" stroke="black" points="10454.5,-9540.13 10247.5,-9540.13 10247.5,-9487.13 10454.5,-9487.13 10454.5,-9540.13"/>
<text text-anchor="middle" x="10351" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU14</text>
<text text-anchor="middle" x="10351" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="10351" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_10_qkv_comm&#45;&gt;layer_10_attn_comp_gpu14 -->
<g id="edge707" class="edge">
<title>layer_10_qkv_comm&#45;&gt;layer_10_attn_comp_gpu14</title>
<path fill="none" stroke="black" d="M9867.78,-9593.64C9955.98,-9583.49 10102.41,-9565.16 10237.24,-9540.77"/>
<polygon fill="black" stroke="black" points="10238.13,-9544.16 10247.34,-9538.93 10236.87,-9537.28 10238.13,-9544.16"/>
</g>
<!-- layer_10_attn_comp_gpu15 -->
<g id="node568" class="node">
<title>layer_10_attn_comp_gpu15</title>
<polygon fill="lightblue" stroke="black" points="10679.5,-9540.13 10472.5,-9540.13 10472.5,-9487.13 10679.5,-9487.13 10679.5,-9540.13"/>
<text text-anchor="middle" x="10576" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU15</text>
<text text-anchor="middle" x="10576" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="10576" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_10_qkv_comm&#45;&gt;layer_10_attn_comp_gpu15 -->
<g id="edge708" class="edge">
<title>layer_10_qkv_comm&#45;&gt;layer_10_attn_comp_gpu15</title>
<path fill="none" stroke="black" d="M9872.24,-9598.34C9998.64,-9591.48 10244.91,-9574.96 10462.36,-9540.69"/>
<polygon fill="black" stroke="black" points="10463.04,-9544.12 10472.36,-9539.09 10461.94,-9537.21 10463.04,-9544.12"/>
</g>
<!-- layer_10_attn_out_gpu8 -->
<g id="node569" class="node">
<title>layer_10_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="9129,-9450.76 8971,-9450.76 8971,-9397.76 9129,-9397.76 9129,-9450.76"/>
<text text-anchor="middle" x="9050" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU8</text>
<text text-anchor="middle" x="9050" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="9050" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_10_attn_comp_gpu8&#45;&gt;layer_10_attn_out_gpu8 -->
<g id="edge709" class="edge">
<title>layer_10_attn_comp_gpu8&#45;&gt;layer_10_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M9024.61,-9486.89C9028.05,-9478.54 9031.93,-9469.12 9035.6,-9460.21"/>
<polygon fill="black" stroke="black" points="9038.9,-9461.4 9039.47,-9450.82 9032.42,-9458.73 9038.9,-9461.4"/>
</g>
<!-- layer_10_attn_out_gpu9 -->
<g id="node570" class="node">
<title>layer_10_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="9342,-9450.76 9184,-9450.76 9184,-9397.76 9342,-9397.76 9342,-9450.76"/>
<text text-anchor="middle" x="9263" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU9</text>
<text text-anchor="middle" x="9263" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="9263" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_10_attn_comp_gpu9&#45;&gt;layer_10_attn_out_gpu9 -->
<g id="edge710" class="edge">
<title>layer_10_attn_comp_gpu9&#45;&gt;layer_10_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M9239.72,-9486.89C9242.88,-9478.54 9246.43,-9469.12 9249.8,-9460.21"/>
<polygon fill="black" stroke="black" points="9253.09,-9461.41 9253.35,-9450.82 9246.54,-9458.94 9253.09,-9461.41"/>
</g>
<!-- layer_10_attn_out_gpu10 -->
<g id="node571" class="node">
<title>layer_10_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="9559.5,-9450.76 9392.5,-9450.76 9392.5,-9397.76 9559.5,-9397.76 9559.5,-9450.76"/>
<text text-anchor="middle" x="9476" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU10</text>
<text text-anchor="middle" x="9476" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="9476" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_10_attn_comp_gpu10&#45;&gt;layer_10_attn_out_gpu10 -->
<g id="edge711" class="edge">
<title>layer_10_attn_comp_gpu10&#45;&gt;layer_10_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M9458.37,-9486.89C9460.73,-9478.63 9463.39,-9469.32 9465.92,-9460.5"/>
<polygon fill="black" stroke="black" points="9469.3,-9461.4 9468.69,-9450.82 9462.57,-9459.47 9469.3,-9461.4"/>
</g>
<!-- layer_10_attn_out_gpu11 -->
<g id="node572" class="node">
<title>layer_10_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="9769.5,-9450.76 9602.5,-9450.76 9602.5,-9397.76 9769.5,-9397.76 9769.5,-9450.76"/>
<text text-anchor="middle" x="9686" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU11</text>
<text text-anchor="middle" x="9686" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="9686" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_10_attn_comp_gpu11&#45;&gt;layer_10_attn_out_gpu11 -->
<g id="edge712" class="edge">
<title>layer_10_attn_comp_gpu11&#45;&gt;layer_10_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M9678.95,-9486.89C9679.88,-9478.72 9680.93,-9469.52 9681.93,-9460.78"/>
<polygon fill="black" stroke="black" points="9685.41,-9461.15 9683.07,-9450.82 9678.46,-9460.36 9685.41,-9461.15"/>
</g>
<!-- layer_10_attn_out_gpu12 -->
<g id="node573" class="node">
<title>layer_10_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="9974.5,-9450.76 9807.5,-9450.76 9807.5,-9397.76 9974.5,-9397.76 9974.5,-9450.76"/>
<text text-anchor="middle" x="9891" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU12</text>
<text text-anchor="middle" x="9891" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="9891" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_10_attn_comp_gpu12&#45;&gt;layer_10_attn_out_gpu12 -->
<g id="edge713" class="edge">
<title>layer_10_attn_comp_gpu12&#45;&gt;layer_10_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M9898.05,-9486.89C9897.12,-9478.72 9896.07,-9469.52 9895.07,-9460.78"/>
<polygon fill="black" stroke="black" points="9898.54,-9460.36 9893.93,-9450.82 9891.59,-9461.15 9898.54,-9460.36"/>
</g>
<!-- layer_10_attn_out_gpu13 -->
<g id="node574" class="node">
<title>layer_10_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="10189.5,-9450.76 10022.5,-9450.76 10022.5,-9397.76 10189.5,-9397.76 10189.5,-9450.76"/>
<text text-anchor="middle" x="10106" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU13</text>
<text text-anchor="middle" x="10106" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="10106" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_10_attn_comp_gpu13&#45;&gt;layer_10_attn_out_gpu13 -->
<g id="edge714" class="edge">
<title>layer_10_attn_comp_gpu13&#45;&gt;layer_10_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M10120.11,-9486.89C10118.24,-9478.72 10116.13,-9469.52 10114.13,-9460.78"/>
<polygon fill="black" stroke="black" points="10117.49,-9459.79 10111.85,-9450.82 10110.67,-9461.35 10117.49,-9459.79"/>
</g>
<!-- layer_10_attn_out_gpu14 -->
<g id="node575" class="node">
<title>layer_10_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="10409.5,-9450.76 10242.5,-9450.76 10242.5,-9397.76 10409.5,-9397.76 10409.5,-9450.76"/>
<text text-anchor="middle" x="10326" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU14</text>
<text text-anchor="middle" x="10326" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="10326" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_10_attn_comp_gpu14&#45;&gt;layer_10_attn_out_gpu14 -->
<g id="edge715" class="edge">
<title>layer_10_attn_comp_gpu14&#45;&gt;layer_10_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M10343.63,-9486.89C10341.27,-9478.63 10338.61,-9469.32 10336.08,-9460.5"/>
<polygon fill="black" stroke="black" points="10339.43,-9459.47 10333.31,-9450.82 10332.7,-9461.4 10339.43,-9459.47"/>
</g>
<!-- layer_10_attn_out_gpu15 -->
<g id="node576" class="node">
<title>layer_10_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="10631.5,-9450.76 10464.5,-9450.76 10464.5,-9397.76 10631.5,-9397.76 10631.5,-9450.76"/>
<text text-anchor="middle" x="10548" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU15</text>
<text text-anchor="middle" x="10548" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="10548" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_10_attn_comp_gpu15&#45;&gt;layer_10_attn_out_gpu15 -->
<g id="edge716" class="edge">
<title>layer_10_attn_comp_gpu15&#45;&gt;layer_10_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M10567.75,-9486.89C10565.1,-9478.63 10562.12,-9469.32 10559.29,-9460.5"/>
<polygon fill="black" stroke="black" points="10562.58,-9459.27 10556.19,-9450.82 10555.91,-9461.41 10562.58,-9459.27"/>
</g>
<!-- layer_10_attn_allreduce -->
<g id="node577" class="node">
<title>layer_10_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="9789" cy="-9334.89" rx="112.36" ry="26.74"/>
<text text-anchor="middle" x="9789" y="-9338.69" font-family="Times,serif" font-size="14.00">Attention AllReduce</text>
<text text-anchor="middle" x="9789" y="-9323.69" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_10_attn_out_gpu8&#45;&gt;layer_10_attn_allreduce -->
<g id="edge717" class="edge">
<title>layer_10_attn_out_gpu8&#45;&gt;layer_10_attn_allreduce</title>
<path fill="none" stroke="black" d="M9129.14,-9405.87C9144.31,-9402.89 9160.11,-9400.03 9175,-9397.76 9347.05,-9371.61 9547.96,-9353.74 9671.84,-9344.17"/>
<polygon fill="black" stroke="black" points="9672.4,-9347.63 9682.11,-9343.38 9671.87,-9340.65 9672.4,-9347.63"/>
</g>
<!-- layer_10_attn_out_gpu9&#45;&gt;layer_10_attn_allreduce -->
<g id="edge718" class="edge">
<title>layer_10_attn_out_gpu9&#45;&gt;layer_10_attn_allreduce</title>
<path fill="none" stroke="black" d="M9342.28,-9405.89C9356.16,-9403.04 9370.48,-9400.22 9384,-9397.76 9485.11,-9379.4 9601.08,-9362.06 9682.95,-9350.43"/>
<polygon fill="black" stroke="black" points="9683.6,-9353.88 9693.01,-9349.01 9682.62,-9346.95 9683.6,-9353.88"/>
</g>
<!-- layer_10_attn_out_gpu10&#45;&gt;layer_10_attn_allreduce -->
<g id="edge719" class="edge">
<title>layer_10_attn_out_gpu10&#45;&gt;layer_10_attn_allreduce</title>
<path fill="none" stroke="black" d="M9559.88,-9399.85C9605.85,-9387.02 9662.56,-9371.19 9708.07,-9358.48"/>
<polygon fill="black" stroke="black" points="9709.2,-9361.8 9717.89,-9355.74 9707.32,-9355.06 9709.2,-9361.8"/>
</g>
<!-- layer_10_attn_out_gpu11&#45;&gt;layer_10_attn_allreduce -->
<g id="edge720" class="edge">
<title>layer_10_attn_out_gpu11&#45;&gt;layer_10_attn_allreduce</title>
<path fill="none" stroke="black" d="M9716.07,-9397.76C9727.17,-9388.34 9739.88,-9377.56 9751.55,-9367.66"/>
<polygon fill="black" stroke="black" points="9754.07,-9370.12 9759.43,-9360.98 9749.54,-9364.78 9754.07,-9370.12"/>
</g>
<!-- layer_10_attn_out_gpu12&#45;&gt;layer_10_attn_allreduce -->
<g id="edge721" class="edge">
<title>layer_10_attn_out_gpu12&#45;&gt;layer_10_attn_allreduce</title>
<path fill="none" stroke="black" d="M9861.22,-9397.76C9850.23,-9388.34 9837.65,-9377.56 9826.09,-9367.66"/>
<polygon fill="black" stroke="black" points="9828.16,-9364.83 9818.29,-9360.98 9823.6,-9370.14 9828.16,-9364.83"/>
</g>
<!-- layer_10_attn_out_gpu13&#45;&gt;layer_10_attn_allreduce -->
<g id="edge722" class="edge">
<title>layer_10_attn_out_gpu13&#45;&gt;layer_10_attn_allreduce</title>
<path fill="none" stroke="black" d="M10022.3,-9400.19C9975.37,-9387.26 9917.1,-9371.2 9870.54,-9358.37"/>
<polygon fill="black" stroke="black" points="9871.36,-9354.96 9860.79,-9355.68 9869.5,-9361.71 9871.36,-9354.96"/>
</g>
<!-- layer_10_attn_out_gpu14&#45;&gt;layer_10_attn_allreduce -->
<g id="edge723" class="edge">
<title>layer_10_attn_out_gpu14&#45;&gt;layer_10_attn_allreduce</title>
<path fill="none" stroke="black" d="M10242.42,-9405.88C10227.97,-9403.05 10213.06,-9400.23 10199,-9397.76 10095.95,-9379.65 9977.76,-9362.16 9894.83,-9350.43"/>
<polygon fill="black" stroke="black" points="9895.29,-9346.96 9884.9,-9349.03 9894.31,-9353.89 9895.29,-9346.96"/>
</g>
<!-- layer_10_attn_out_gpu15&#45;&gt;layer_10_attn_allreduce -->
<g id="edge724" class="edge">
<title>layer_10_attn_out_gpu15&#45;&gt;layer_10_attn_allreduce</title>
<path fill="none" stroke="black" d="M10464.24,-9405.48C10449.22,-9402.64 10433.68,-9399.93 10419,-9397.76 10241.03,-9371.5 10033.07,-9353.52 9906.24,-9343.98"/>
<polygon fill="black" stroke="black" points="9906.35,-9340.48 9896.12,-9343.22 9905.83,-9347.46 9906.35,-9340.48"/>
</g>
<!-- layer_10_residual1 -->
<g id="node578" class="node">
<title>layer_10_residual1</title>
<polygon fill="lightyellow" stroke="black" points="9926.78,-9272.02 9707.6,-9272.02 9651.22,-9196.02 9870.4,-9196.02 9926.78,-9272.02"/>
<text text-anchor="middle" x="9789" y="-9237.82" font-family="Times,serif" font-size="14.00">Residual Add 10</text>
<text text-anchor="middle" x="9789" y="-9222.82" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_10_attn_allreduce&#45;&gt;layer_10_residual1 -->
<g id="edge725" class="edge">
<title>layer_10_attn_allreduce&#45;&gt;layer_10_residual1</title>
<path fill="none" stroke="black" d="M9789,-9307.92C9789,-9300.1 9789,-9291.27 9789,-9282.52"/>
<polygon fill="black" stroke="black" points="9792.5,-9282.35 9789,-9272.35 9785.5,-9282.35 9792.5,-9282.35"/>
</g>
<!-- layer_10_ln1 -->
<g id="node579" class="node">
<title>layer_10_ln1</title>
<polygon fill="lightblue" stroke="black" points="9849,-9141.02 9729,-9141.02 9729,-9103.02 9849,-9103.02 9849,-9141.02"/>
<text text-anchor="middle" x="9789" y="-9125.82" font-family="Times,serif" font-size="14.00">LayerNorm 10</text>
<text text-anchor="middle" x="9789" y="-9110.82" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_10_residual1&#45;&gt;layer_10_ln1 -->
<g id="edge726" class="edge">
<title>layer_10_residual1&#45;&gt;layer_10_ln1</title>
<path fill="none" stroke="black" d="M9789,-9195.78C9789,-9181.22 9789,-9164.81 9789,-9151.26"/>
<polygon fill="black" stroke="black" points="9792.5,-9151.09 9789,-9141.09 9785.5,-9151.09 9792.5,-9151.09"/>
</g>
<!-- layer_10_mlp1_gpu8 -->
<g id="node580" class="node">
<title>layer_10_mlp1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="10356,-9045.02 10230,-9045.02 10230,-8992.02 10356,-8992.02 10356,-9045.02"/>
<text text-anchor="middle" x="10293" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU8</text>
<text text-anchor="middle" x="10293" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="10293" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp1_gpu8 -->
<g id="edge727" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp1_gpu8</title>
<path fill="none" stroke="black" d="M9849.12,-9118.87C9951.5,-9114.51 10155.03,-9102.72 10221,-9076.02 10234.87,-9070.41 10248.27,-9061.28 10259.68,-9051.99"/>
<polygon fill="black" stroke="black" points="10262.27,-9054.38 10267.61,-9045.24 10257.73,-9049.05 10262.27,-9054.38"/>
</g>
<!-- layer_10_mlp1_gpu9 -->
<g id="node581" class="node">
<title>layer_10_mlp1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="10212,-9045.02 10086,-9045.02 10086,-8992.02 10212,-8992.02 10212,-9045.02"/>
<text text-anchor="middle" x="10149" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU9</text>
<text text-anchor="middle" x="10149" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="10149" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp1_gpu9 -->
<g id="edge731" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp1_gpu9</title>
<path fill="none" stroke="black" d="M9849.08,-9120.39C9909.1,-9117.79 10002.86,-9108.26 10077,-9076.02 10090.6,-9070.11 10103.86,-9061 10115.21,-9051.8"/>
<polygon fill="black" stroke="black" points="10117.73,-9054.26 10123.12,-9045.14 10113.22,-9048.91 10117.73,-9054.26"/>
</g>
<!-- layer_10_mlp1_gpu10 -->
<g id="node582" class="node">
<title>layer_10_mlp1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="10068,-9045.02 9942,-9045.02 9942,-8992.02 10068,-8992.02 10068,-9045.02"/>
<text text-anchor="middle" x="10005" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU10</text>
<text text-anchor="middle" x="10005" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="10005" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp1_gpu10 -->
<g id="edge735" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp1_gpu10</title>
<path fill="none" stroke="black" d="M9849.08,-9107.48C9875.68,-9100.18 9906.8,-9089.8 9933,-9076.02 9945.67,-9069.36 9958.35,-9060.38 9969.45,-9051.55"/>
<polygon fill="black" stroke="black" points="9971.71,-9054.22 9977.24,-9045.18 9967.28,-9048.8 9971.71,-9054.22"/>
</g>
<!-- layer_10_mlp1_gpu11 -->
<g id="node583" class="node">
<title>layer_10_mlp1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="9924,-9045.02 9798,-9045.02 9798,-8992.02 9924,-8992.02 9924,-9045.02"/>
<text text-anchor="middle" x="9861" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU11</text>
<text text-anchor="middle" x="9861" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9861" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp1_gpu11 -->
<g id="edge739" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp1_gpu11</title>
<path fill="none" stroke="black" d="M9801.87,-9102.88C9811.59,-9089.18 9825.19,-9070 9836.91,-9053.49"/>
<polygon fill="black" stroke="black" points="9839.9,-9055.32 9842.83,-9045.14 9834.19,-9051.27 9839.9,-9055.32"/>
</g>
<!-- layer_10_mlp1_gpu12 -->
<g id="node584" class="node">
<title>layer_10_mlp1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="9780,-9045.02 9654,-9045.02 9654,-8992.02 9780,-8992.02 9780,-9045.02"/>
<text text-anchor="middle" x="9717" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU12</text>
<text text-anchor="middle" x="9717" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9717" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp1_gpu12 -->
<g id="edge743" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp1_gpu12</title>
<path fill="none" stroke="black" d="M9776.13,-9102.88C9766.41,-9089.18 9752.81,-9070 9741.09,-9053.49"/>
<polygon fill="black" stroke="black" points="9743.81,-9051.27 9735.17,-9045.14 9738.1,-9055.32 9743.81,-9051.27"/>
</g>
<!-- layer_10_mlp1_gpu13 -->
<g id="node585" class="node">
<title>layer_10_mlp1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="9636,-9045.02 9510,-9045.02 9510,-8992.02 9636,-8992.02 9636,-9045.02"/>
<text text-anchor="middle" x="9573" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU13</text>
<text text-anchor="middle" x="9573" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9573" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp1_gpu13 -->
<g id="edge747" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp1_gpu13</title>
<path fill="none" stroke="black" d="M9728.92,-9107.48C9702.32,-9100.18 9671.2,-9089.8 9645,-9076.02 9632.33,-9069.36 9619.65,-9060.38 9608.55,-9051.55"/>
<polygon fill="black" stroke="black" points="9610.72,-9048.8 9600.76,-9045.18 9606.29,-9054.22 9610.72,-9048.8"/>
</g>
<!-- layer_10_mlp1_gpu14 -->
<g id="node586" class="node">
<title>layer_10_mlp1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="9492,-9045.02 9366,-9045.02 9366,-8992.02 9492,-8992.02 9492,-9045.02"/>
<text text-anchor="middle" x="9429" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU14</text>
<text text-anchor="middle" x="9429" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9429" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp1_gpu14 -->
<g id="edge751" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp1_gpu14</title>
<path fill="none" stroke="black" d="M9728.92,-9120.39C9668.9,-9117.79 9575.14,-9108.26 9501,-9076.02 9487.4,-9070.11 9474.14,-9061 9462.79,-9051.8"/>
<polygon fill="black" stroke="black" points="9464.78,-9048.91 9454.88,-9045.14 9460.27,-9054.26 9464.78,-9048.91"/>
</g>
<!-- layer_10_mlp1_gpu15 -->
<g id="node587" class="node">
<title>layer_10_mlp1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="9348,-9045.02 9222,-9045.02 9222,-8992.02 9348,-8992.02 9348,-9045.02"/>
<text text-anchor="middle" x="9285" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU15</text>
<text text-anchor="middle" x="9285" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9285" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp1_gpu15 -->
<g id="edge755" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp1_gpu15</title>
<path fill="none" stroke="black" d="M9728.88,-9118.87C9626.5,-9114.51 9422.97,-9102.72 9357,-9076.02 9343.13,-9070.41 9329.73,-9061.28 9318.32,-9051.99"/>
<polygon fill="black" stroke="black" points="9320.27,-9049.05 9310.39,-9045.24 9315.73,-9054.38 9320.27,-9049.05"/>
</g>
<!-- layer_10_gelu_gpu8 -->
<g id="node588" class="node">
<title>layer_10_gelu_gpu8</title>
<polygon fill="lightblue" stroke="black" points="10345,-8945.52 10241,-8945.52 10241,-8907.52 10345,-8907.52 10345,-8945.52"/>
<text text-anchor="middle" x="10293" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU8</text>
<text text-anchor="middle" x="10293" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_10_mlp1_gpu8&#45;&gt;layer_10_gelu_gpu8 -->
<g id="edge728" class="edge">
<title>layer_10_mlp1_gpu8&#45;&gt;layer_10_gelu_gpu8</title>
<path fill="none" stroke="black" d="M10293,-8991.97C10293,-8980.67 10293,-8967.35 10293,-8955.75"/>
<polygon fill="black" stroke="black" points="10296.5,-8955.7 10293,-8945.7 10289.5,-8955.7 10296.5,-8955.7"/>
</g>
<!-- layer_10_gelu_gpu9 -->
<g id="node589" class="node">
<title>layer_10_gelu_gpu9</title>
<polygon fill="lightblue" stroke="black" points="10201,-8945.52 10097,-8945.52 10097,-8907.52 10201,-8907.52 10201,-8945.52"/>
<text text-anchor="middle" x="10149" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU9</text>
<text text-anchor="middle" x="10149" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_10_mlp1_gpu9&#45;&gt;layer_10_gelu_gpu9 -->
<g id="edge732" class="edge">
<title>layer_10_mlp1_gpu9&#45;&gt;layer_10_gelu_gpu9</title>
<path fill="none" stroke="black" d="M10149,-8991.97C10149,-8980.67 10149,-8967.35 10149,-8955.75"/>
<polygon fill="black" stroke="black" points="10152.5,-8955.7 10149,-8945.7 10145.5,-8955.7 10152.5,-8955.7"/>
</g>
<!-- layer_10_gelu_gpu10 -->
<g id="node590" class="node">
<title>layer_10_gelu_gpu10</title>
<polygon fill="lightblue" stroke="black" points="10061.5,-8945.52 9948.5,-8945.52 9948.5,-8907.52 10061.5,-8907.52 10061.5,-8945.52"/>
<text text-anchor="middle" x="10005" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU10</text>
<text text-anchor="middle" x="10005" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_10_mlp1_gpu10&#45;&gt;layer_10_gelu_gpu10 -->
<g id="edge736" class="edge">
<title>layer_10_mlp1_gpu10&#45;&gt;layer_10_gelu_gpu10</title>
<path fill="none" stroke="black" d="M10005,-8991.97C10005,-8980.67 10005,-8967.35 10005,-8955.75"/>
<polygon fill="black" stroke="black" points="10008.5,-8955.7 10005,-8945.7 10001.5,-8955.7 10008.5,-8955.7"/>
</g>
<!-- layer_10_gelu_gpu11 -->
<g id="node591" class="node">
<title>layer_10_gelu_gpu11</title>
<polygon fill="lightblue" stroke="black" points="9917.5,-8945.52 9804.5,-8945.52 9804.5,-8907.52 9917.5,-8907.52 9917.5,-8945.52"/>
<text text-anchor="middle" x="9861" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU11</text>
<text text-anchor="middle" x="9861" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_10_mlp1_gpu11&#45;&gt;layer_10_gelu_gpu11 -->
<g id="edge740" class="edge">
<title>layer_10_mlp1_gpu11&#45;&gt;layer_10_gelu_gpu11</title>
<path fill="none" stroke="black" d="M9861,-8991.97C9861,-8980.67 9861,-8967.35 9861,-8955.75"/>
<polygon fill="black" stroke="black" points="9864.5,-8955.7 9861,-8945.7 9857.5,-8955.7 9864.5,-8955.7"/>
</g>
<!-- layer_10_gelu_gpu12 -->
<g id="node592" class="node">
<title>layer_10_gelu_gpu12</title>
<polygon fill="lightblue" stroke="black" points="9773.5,-8945.52 9660.5,-8945.52 9660.5,-8907.52 9773.5,-8907.52 9773.5,-8945.52"/>
<text text-anchor="middle" x="9717" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU12</text>
<text text-anchor="middle" x="9717" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_10_mlp1_gpu12&#45;&gt;layer_10_gelu_gpu12 -->
<g id="edge744" class="edge">
<title>layer_10_mlp1_gpu12&#45;&gt;layer_10_gelu_gpu12</title>
<path fill="none" stroke="black" d="M9717,-8991.97C9717,-8980.67 9717,-8967.35 9717,-8955.75"/>
<polygon fill="black" stroke="black" points="9720.5,-8955.7 9717,-8945.7 9713.5,-8955.7 9720.5,-8955.7"/>
</g>
<!-- layer_10_gelu_gpu13 -->
<g id="node593" class="node">
<title>layer_10_gelu_gpu13</title>
<polygon fill="lightblue" stroke="black" points="9629.5,-8945.52 9516.5,-8945.52 9516.5,-8907.52 9629.5,-8907.52 9629.5,-8945.52"/>
<text text-anchor="middle" x="9573" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU13</text>
<text text-anchor="middle" x="9573" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_10_mlp1_gpu13&#45;&gt;layer_10_gelu_gpu13 -->
<g id="edge748" class="edge">
<title>layer_10_mlp1_gpu13&#45;&gt;layer_10_gelu_gpu13</title>
<path fill="none" stroke="black" d="M9573,-8991.97C9573,-8980.67 9573,-8967.35 9573,-8955.75"/>
<polygon fill="black" stroke="black" points="9576.5,-8955.7 9573,-8945.7 9569.5,-8955.7 9576.5,-8955.7"/>
</g>
<!-- layer_10_gelu_gpu14 -->
<g id="node594" class="node">
<title>layer_10_gelu_gpu14</title>
<polygon fill="lightblue" stroke="black" points="9485.5,-8945.52 9372.5,-8945.52 9372.5,-8907.52 9485.5,-8907.52 9485.5,-8945.52"/>
<text text-anchor="middle" x="9429" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU14</text>
<text text-anchor="middle" x="9429" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_10_mlp1_gpu14&#45;&gt;layer_10_gelu_gpu14 -->
<g id="edge752" class="edge">
<title>layer_10_mlp1_gpu14&#45;&gt;layer_10_gelu_gpu14</title>
<path fill="none" stroke="black" d="M9429,-8991.97C9429,-8980.67 9429,-8967.35 9429,-8955.75"/>
<polygon fill="black" stroke="black" points="9432.5,-8955.7 9429,-8945.7 9425.5,-8955.7 9432.5,-8955.7"/>
</g>
<!-- layer_10_gelu_gpu15 -->
<g id="node595" class="node">
<title>layer_10_gelu_gpu15</title>
<polygon fill="lightblue" stroke="black" points="9341.5,-8945.52 9228.5,-8945.52 9228.5,-8907.52 9341.5,-8907.52 9341.5,-8945.52"/>
<text text-anchor="middle" x="9285" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU15</text>
<text text-anchor="middle" x="9285" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_10_mlp1_gpu15&#45;&gt;layer_10_gelu_gpu15 -->
<g id="edge756" class="edge">
<title>layer_10_mlp1_gpu15&#45;&gt;layer_10_gelu_gpu15</title>
<path fill="none" stroke="black" d="M9285,-8991.97C9285,-8980.67 9285,-8967.35 9285,-8955.75"/>
<polygon fill="black" stroke="black" points="9288.5,-8955.7 9285,-8945.7 9281.5,-8955.7 9288.5,-8955.7"/>
</g>
<!-- layer_10_mlp2_gpu8 -->
<g id="node596" class="node">
<title>layer_10_mlp2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="10356,-8864.02 10230,-8864.02 10230,-8811.02 10356,-8811.02 10356,-8864.02"/>
<text text-anchor="middle" x="10293" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU8</text>
<text text-anchor="middle" x="10293" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="10293" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_10_gelu_gpu8&#45;&gt;layer_10_mlp2_gpu8 -->
<g id="edge729" class="edge">
<title>layer_10_gelu_gpu8&#45;&gt;layer_10_mlp2_gpu8</title>
<path fill="none" stroke="black" d="M10293,-8907.5C10293,-8897.89 10293,-8885.73 10293,-8874.31"/>
<polygon fill="black" stroke="black" points="10296.5,-8874.11 10293,-8864.11 10289.5,-8874.11 10296.5,-8874.11"/>
</g>
<!-- layer_10_mlp2_gpu9 -->
<g id="node597" class="node">
<title>layer_10_mlp2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="10212,-8864.02 10086,-8864.02 10086,-8811.02 10212,-8811.02 10212,-8864.02"/>
<text text-anchor="middle" x="10149" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU9</text>
<text text-anchor="middle" x="10149" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="10149" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_10_gelu_gpu9&#45;&gt;layer_10_mlp2_gpu9 -->
<g id="edge733" class="edge">
<title>layer_10_gelu_gpu9&#45;&gt;layer_10_mlp2_gpu9</title>
<path fill="none" stroke="black" d="M10149,-8907.5C10149,-8897.89 10149,-8885.73 10149,-8874.31"/>
<polygon fill="black" stroke="black" points="10152.5,-8874.11 10149,-8864.11 10145.5,-8874.11 10152.5,-8874.11"/>
</g>
<!-- layer_10_mlp2_gpu10 -->
<g id="node598" class="node">
<title>layer_10_mlp2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="10068,-8864.02 9942,-8864.02 9942,-8811.02 10068,-8811.02 10068,-8864.02"/>
<text text-anchor="middle" x="10005" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU10</text>
<text text-anchor="middle" x="10005" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="10005" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_10_gelu_gpu10&#45;&gt;layer_10_mlp2_gpu10 -->
<g id="edge737" class="edge">
<title>layer_10_gelu_gpu10&#45;&gt;layer_10_mlp2_gpu10</title>
<path fill="none" stroke="black" d="M10005,-8907.5C10005,-8897.89 10005,-8885.73 10005,-8874.31"/>
<polygon fill="black" stroke="black" points="10008.5,-8874.11 10005,-8864.11 10001.5,-8874.11 10008.5,-8874.11"/>
</g>
<!-- layer_10_mlp2_gpu11 -->
<g id="node599" class="node">
<title>layer_10_mlp2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="9924,-8864.02 9798,-8864.02 9798,-8811.02 9924,-8811.02 9924,-8864.02"/>
<text text-anchor="middle" x="9861" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU11</text>
<text text-anchor="middle" x="9861" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="9861" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_10_gelu_gpu11&#45;&gt;layer_10_mlp2_gpu11 -->
<g id="edge741" class="edge">
<title>layer_10_gelu_gpu11&#45;&gt;layer_10_mlp2_gpu11</title>
<path fill="none" stroke="black" d="M9861,-8907.5C9861,-8897.89 9861,-8885.73 9861,-8874.31"/>
<polygon fill="black" stroke="black" points="9864.5,-8874.11 9861,-8864.11 9857.5,-8874.11 9864.5,-8874.11"/>
</g>
<!-- layer_10_mlp2_gpu12 -->
<g id="node600" class="node">
<title>layer_10_mlp2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="9780,-8864.02 9654,-8864.02 9654,-8811.02 9780,-8811.02 9780,-8864.02"/>
<text text-anchor="middle" x="9717" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU12</text>
<text text-anchor="middle" x="9717" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="9717" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_10_gelu_gpu12&#45;&gt;layer_10_mlp2_gpu12 -->
<g id="edge745" class="edge">
<title>layer_10_gelu_gpu12&#45;&gt;layer_10_mlp2_gpu12</title>
<path fill="none" stroke="black" d="M9717,-8907.5C9717,-8897.89 9717,-8885.73 9717,-8874.31"/>
<polygon fill="black" stroke="black" points="9720.5,-8874.11 9717,-8864.11 9713.5,-8874.11 9720.5,-8874.11"/>
</g>
<!-- layer_10_mlp2_gpu13 -->
<g id="node601" class="node">
<title>layer_10_mlp2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="9636,-8864.02 9510,-8864.02 9510,-8811.02 9636,-8811.02 9636,-8864.02"/>
<text text-anchor="middle" x="9573" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU13</text>
<text text-anchor="middle" x="9573" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="9573" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_10_gelu_gpu13&#45;&gt;layer_10_mlp2_gpu13 -->
<g id="edge749" class="edge">
<title>layer_10_gelu_gpu13&#45;&gt;layer_10_mlp2_gpu13</title>
<path fill="none" stroke="black" d="M9573,-8907.5C9573,-8897.89 9573,-8885.73 9573,-8874.31"/>
<polygon fill="black" stroke="black" points="9576.5,-8874.11 9573,-8864.11 9569.5,-8874.11 9576.5,-8874.11"/>
</g>
<!-- layer_10_mlp2_gpu14 -->
<g id="node602" class="node">
<title>layer_10_mlp2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="9492,-8864.02 9366,-8864.02 9366,-8811.02 9492,-8811.02 9492,-8864.02"/>
<text text-anchor="middle" x="9429" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU14</text>
<text text-anchor="middle" x="9429" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="9429" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_10_gelu_gpu14&#45;&gt;layer_10_mlp2_gpu14 -->
<g id="edge753" class="edge">
<title>layer_10_gelu_gpu14&#45;&gt;layer_10_mlp2_gpu14</title>
<path fill="none" stroke="black" d="M9429,-8907.5C9429,-8897.89 9429,-8885.73 9429,-8874.31"/>
<polygon fill="black" stroke="black" points="9432.5,-8874.11 9429,-8864.11 9425.5,-8874.11 9432.5,-8874.11"/>
</g>
<!-- layer_10_mlp2_gpu15 -->
<g id="node603" class="node">
<title>layer_10_mlp2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="9348,-8864.02 9222,-8864.02 9222,-8811.02 9348,-8811.02 9348,-8864.02"/>
<text text-anchor="middle" x="9285" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU15</text>
<text text-anchor="middle" x="9285" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="9285" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_10_gelu_gpu15&#45;&gt;layer_10_mlp2_gpu15 -->
<g id="edge757" class="edge">
<title>layer_10_gelu_gpu15&#45;&gt;layer_10_mlp2_gpu15</title>
<path fill="none" stroke="black" d="M9285,-8907.5C9285,-8897.89 9285,-8885.73 9285,-8874.31"/>
<polygon fill="black" stroke="black" points="9288.5,-8874.11 9285,-8864.11 9281.5,-8874.11 9288.5,-8874.11"/>
</g>
<!-- layer_10_mlp_allreduce -->
<g id="node604" class="node">
<title>layer_10_mlp_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="9789" cy="-8748.15" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="9789" y="-8751.95" font-family="Times,serif" font-size="14.00">MLP AllReduce</text>
<text text-anchor="middle" x="9789" y="-8736.95" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_10_mlp2_gpu8&#45;&gt;layer_10_mlp_allreduce -->
<g id="edge730" class="edge">
<title>layer_10_mlp2_gpu8&#45;&gt;layer_10_mlp_allreduce</title>
<path fill="none" stroke="black" d="M10230,-8813.41C10226.97,-8812.56 10223.96,-8811.75 10221,-8811.02 10106.59,-8782.87 9971.77,-8766.09 9883.56,-8757.25"/>
<polygon fill="black" stroke="black" points="9883.86,-8753.77 9873.57,-8756.27 9883.18,-8760.73 9883.86,-8753.77"/>
</g>
<!-- layer_10_mlp2_gpu9&#45;&gt;layer_10_mlp_allreduce -->
<g id="edge734" class="edge">
<title>layer_10_mlp2_gpu9&#45;&gt;layer_10_mlp_allreduce</title>
<path fill="none" stroke="black" d="M10085.93,-8813.67C10082.92,-8812.74 10079.93,-8811.85 10077,-8811.02 10009.58,-8791.93 9931.82,-8775.55 9874.11,-8764.45"/>
<polygon fill="black" stroke="black" points="9874.42,-8760.94 9863.94,-8762.51 9873.1,-8767.82 9874.42,-8760.94"/>
</g>
<!-- layer_10_mlp2_gpu10&#45;&gt;layer_10_mlp_allreduce -->
<g id="edge738" class="edge">
<title>layer_10_mlp2_gpu10&#45;&gt;layer_10_mlp_allreduce</title>
<path fill="none" stroke="black" d="M9941.94,-8811.02C9913.08,-8799.34 9879,-8785.56 9850.35,-8773.97"/>
<polygon fill="black" stroke="black" points="9851.44,-8770.63 9840.86,-8770.13 9848.81,-8777.12 9851.44,-8770.63"/>
</g>
<!-- layer_10_mlp2_gpu11&#45;&gt;layer_10_mlp_allreduce -->
<g id="edge742" class="edge">
<title>layer_10_mlp2_gpu11&#45;&gt;layer_10_mlp_allreduce</title>
<path fill="none" stroke="black" d="M9839.79,-8810.78C9832.4,-8801.82 9824,-8791.63 9816.2,-8782.16"/>
<polygon fill="black" stroke="black" points="9818.87,-8779.9 9809.81,-8774.41 9813.47,-8784.35 9818.87,-8779.9"/>
</g>
<!-- layer_10_mlp2_gpu12&#45;&gt;layer_10_mlp_allreduce -->
<g id="edge746" class="edge">
<title>layer_10_mlp2_gpu12&#45;&gt;layer_10_mlp_allreduce</title>
<path fill="none" stroke="black" d="M9738.21,-8810.78C9745.6,-8801.82 9754,-8791.63 9761.8,-8782.16"/>
<polygon fill="black" stroke="black" points="9764.53,-8784.35 9768.19,-8774.41 9759.13,-8779.9 9764.53,-8784.35"/>
</g>
<!-- layer_10_mlp2_gpu13&#45;&gt;layer_10_mlp_allreduce -->
<g id="edge750" class="edge">
<title>layer_10_mlp2_gpu13&#45;&gt;layer_10_mlp_allreduce</title>
<path fill="none" stroke="black" d="M9636.06,-8811.02C9664.92,-8799.34 9699,-8785.56 9727.65,-8773.97"/>
<polygon fill="black" stroke="black" points="9729.19,-8777.12 9737.14,-8770.13 9726.56,-8770.63 9729.19,-8777.12"/>
</g>
<!-- layer_10_mlp2_gpu14&#45;&gt;layer_10_mlp_allreduce -->
<g id="edge754" class="edge">
<title>layer_10_mlp2_gpu14&#45;&gt;layer_10_mlp_allreduce</title>
<path fill="none" stroke="black" d="M9492.07,-8813.67C9495.08,-8812.74 9498.07,-8811.85 9501,-8811.02 9568.42,-8791.93 9646.18,-8775.55 9703.89,-8764.45"/>
<polygon fill="black" stroke="black" points="9704.9,-8767.82 9714.06,-8762.51 9703.58,-8760.94 9704.9,-8767.82"/>
</g>
<!-- layer_10_mlp2_gpu15&#45;&gt;layer_10_mlp_allreduce -->
<g id="edge758" class="edge">
<title>layer_10_mlp2_gpu15&#45;&gt;layer_10_mlp_allreduce</title>
<path fill="none" stroke="black" d="M9348,-8813.41C9351.03,-8812.56 9354.04,-8811.75 9357,-8811.02 9471.41,-8782.87 9606.23,-8766.09 9694.44,-8757.25"/>
<polygon fill="black" stroke="black" points="9694.82,-8760.73 9704.43,-8756.27 9694.14,-8753.77 9694.82,-8760.73"/>
</g>
<!-- layer_10_residual2 -->
<g id="node605" class="node">
<title>layer_10_residual2</title>
<polygon fill="lightyellow" stroke="black" points="9926.78,-8685.28 9707.6,-8685.28 9651.22,-8609.28 9870.4,-8609.28 9926.78,-8685.28"/>
<text text-anchor="middle" x="9789" y="-8651.08" font-family="Times,serif" font-size="14.00">Residual Add 10</text>
<text text-anchor="middle" x="9789" y="-8636.08" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_10_mlp_allreduce&#45;&gt;layer_10_residual2 -->
<g id="edge759" class="edge">
<title>layer_10_mlp_allreduce&#45;&gt;layer_10_residual2</title>
<path fill="none" stroke="black" d="M9789,-8721.18C9789,-8713.36 9789,-8704.53 9789,-8695.78"/>
<polygon fill="black" stroke="black" points="9792.5,-8695.61 9789,-8685.61 9785.5,-8695.61 9792.5,-8695.61"/>
</g>
<!-- layer_10_ln2 -->
<g id="node606" class="node">
<title>layer_10_ln2</title>
<polygon fill="lightblue" stroke="black" points="9849,-8554.28 9729,-8554.28 9729,-8516.28 9849,-8516.28 9849,-8554.28"/>
<text text-anchor="middle" x="9789" y="-8539.08" font-family="Times,serif" font-size="14.00">LayerNorm 10</text>
<text text-anchor="middle" x="9789" y="-8524.08" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_10_residual2&#45;&gt;layer_10_ln2 -->
<g id="edge760" class="edge">
<title>layer_10_residual2&#45;&gt;layer_10_ln2</title>
<path fill="none" stroke="black" d="M9789,-8609.04C9789,-8594.48 9789,-8578.07 9789,-8564.52"/>
<polygon fill="black" stroke="black" points="9792.5,-8564.35 9789,-8554.35 9785.5,-8564.35 9792.5,-8564.35"/>
</g>
<!-- layer_11_qkv_gpu0 -->
<g id="node887" class="node">
<title>layer_11_qkv_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="9933.69,-8411.28 9703.52,-8411.28 9644.31,-8375.28 9874.48,-8375.28 9933.69,-8411.28"/>
<text text-anchor="middle" x="9789" y="-8389.58" font-family="Times,serif" font-size="14.00">layer_11_qkv_gpu0</text>
</g>
<!-- layer_10_ln2&#45;&gt;layer_11_qkv_gpu0 -->
<g id="edge761" class="edge">
<title>layer_10_ln2&#45;&gt;layer_11_qkv_gpu0</title>
<path fill="none" stroke="black" d="M9789,-8516.27C9789,-8492.27 9789,-8449.62 9789,-8421.64"/>
<polygon fill="black" stroke="black" points="9792.5,-8421.35 9789,-8411.35 9785.5,-8421.35 9792.5,-8421.35"/>
</g>
<!-- layer_11_qkv_gpu8 -->
<g id="node607" class="node">
<title>layer_11_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="12171,-9763.37 12043,-9763.37 12043,-9710.37 12171,-9710.37 12171,-9763.37"/>
<text text-anchor="middle" x="12107" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU8</text>
<text text-anchor="middle" x="12107" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="12107" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_11_qkv_comm -->
<g id="node615" class="node">
<title>layer_11_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="11577" cy="-9603.37" rx="85.62" ry="26.74"/>
<text text-anchor="middle" x="11577" y="-9607.17" font-family="Times,serif" font-size="14.00">QKV AllGather</text>
<text text-anchor="middle" x="11577" y="-9592.17" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_11_qkv_gpu8&#45;&gt;layer_11_qkv_comm -->
<g id="edge762" class="edge">
<title>layer_11_qkv_gpu8&#45;&gt;layer_11_qkv_comm</title>
<path fill="none" stroke="black" d="M12086.05,-9710.1C12072.73,-9695.55 12054.22,-9678.43 12034,-9668.87 11971.32,-9639.26 11784.6,-9620.21 11670.15,-9610.98"/>
<polygon fill="black" stroke="black" points="11670.24,-9607.47 11659.99,-9610.17 11669.68,-9614.45 11670.24,-9607.47"/>
</g>
<!-- layer_11_qkv_gpu9 -->
<g id="node608" class="node">
<title>layer_11_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="12025,-9763.37 11897,-9763.37 11897,-9710.37 12025,-9710.37 12025,-9763.37"/>
<text text-anchor="middle" x="11961" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU9</text>
<text text-anchor="middle" x="11961" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="11961" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_11_qkv_gpu9&#45;&gt;layer_11_qkv_comm -->
<g id="edge763" class="edge">
<title>layer_11_qkv_gpu9&#45;&gt;layer_11_qkv_comm</title>
<path fill="none" stroke="black" d="M11939.51,-9710.24C11926.13,-9695.93 11907.75,-9678.99 11888,-9668.87 11820.11,-9634.08 11734.77,-9618.06 11670.66,-9610.68"/>
<polygon fill="black" stroke="black" points="11670.89,-9607.18 11660.56,-9609.56 11670.12,-9614.14 11670.89,-9607.18"/>
</g>
<!-- layer_11_qkv_gpu10 -->
<g id="node609" class="node">
<title>layer_11_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="11878.5,-9763.37 11741.5,-9763.37 11741.5,-9710.37 11878.5,-9710.37 11878.5,-9763.37"/>
<text text-anchor="middle" x="11810" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU10</text>
<text text-anchor="middle" x="11810" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="11810" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_11_qkv_gpu10&#45;&gt;layer_11_qkv_comm -->
<g id="edge764" class="edge">
<title>layer_11_qkv_gpu10&#45;&gt;layer_11_qkv_comm</title>
<path fill="none" stroke="black" d="M11784.94,-9710.35C11770.64,-9696.77 11751.84,-9680.53 11733,-9668.87 11705.57,-9651.9 11672.89,-9637.6 11644.55,-9626.81"/>
<polygon fill="black" stroke="black" points="11645.71,-9623.51 11635.12,-9623.29 11643.26,-9630.07 11645.71,-9623.51"/>
</g>
<!-- layer_11_qkv_gpu11 -->
<g id="node610" class="node">
<title>layer_11_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="11723.5,-9763.37 11586.5,-9763.37 11586.5,-9710.37 11723.5,-9710.37 11723.5,-9763.37"/>
<text text-anchor="middle" x="11655" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU11</text>
<text text-anchor="middle" x="11655" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="11655" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_11_qkv_gpu11&#45;&gt;layer_11_qkv_comm -->
<g id="edge765" class="edge">
<title>layer_11_qkv_gpu11&#45;&gt;layer_11_qkv_comm</title>
<path fill="none" stroke="black" d="M11639.78,-9710.21C11627.7,-9689.84 11610.7,-9661.18 11597.43,-9638.82"/>
<polygon fill="black" stroke="black" points="11600.3,-9636.79 11592.19,-9629.97 11594.28,-9640.36 11600.3,-9636.79"/>
</g>
<!-- layer_11_qkv_gpu12 -->
<g id="node611" class="node">
<title>layer_11_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="11568.5,-9763.37 11431.5,-9763.37 11431.5,-9710.37 11568.5,-9710.37 11568.5,-9763.37"/>
<text text-anchor="middle" x="11500" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU12</text>
<text text-anchor="middle" x="11500" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="11500" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_11_qkv_gpu12&#45;&gt;layer_11_qkv_comm -->
<g id="edge766" class="edge">
<title>layer_11_qkv_gpu12&#45;&gt;layer_11_qkv_comm</title>
<path fill="none" stroke="black" d="M11515.03,-9710.21C11526.95,-9689.84 11543.74,-9661.18 11556.83,-9638.82"/>
<polygon fill="black" stroke="black" points="11559.98,-9640.37 11562.01,-9629.97 11553.94,-9636.84 11559.98,-9640.37"/>
</g>
<!-- layer_11_qkv_gpu13 -->
<g id="node612" class="node">
<title>layer_11_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="11413.5,-9763.37 11276.5,-9763.37 11276.5,-9710.37 11413.5,-9710.37 11413.5,-9763.37"/>
<text text-anchor="middle" x="11345" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU13</text>
<text text-anchor="middle" x="11345" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="11345" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_11_qkv_gpu13&#45;&gt;layer_11_qkv_comm -->
<g id="edge767" class="edge">
<title>layer_11_qkv_gpu13&#45;&gt;layer_11_qkv_comm</title>
<path fill="none" stroke="black" d="M11370.8,-9710.08C11385.28,-9696.59 11404.17,-9680.5 11423,-9668.87 11450.03,-9652.19 11482.13,-9637.97 11510.02,-9627.16"/>
<polygon fill="black" stroke="black" points="11511.59,-9630.31 11519.69,-9623.48 11509.1,-9623.76 11511.59,-9630.31"/>
</g>
<!-- layer_11_qkv_gpu14 -->
<g id="node613" class="node">
<title>layer_11_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="11258.5,-9763.37 11121.5,-9763.37 11121.5,-9710.37 11258.5,-9710.37 11258.5,-9763.37"/>
<text text-anchor="middle" x="11190" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU14</text>
<text text-anchor="middle" x="11190" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="11190" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_11_qkv_gpu14&#45;&gt;layer_11_qkv_comm -->
<g id="edge768" class="edge">
<title>layer_11_qkv_gpu14&#45;&gt;layer_11_qkv_comm</title>
<path fill="none" stroke="black" d="M11213.29,-9710.28C11227.7,-9695.98 11247.34,-9679.05 11268,-9668.87 11336.01,-9635.37 11420.76,-9619.24 11484.29,-9611.49"/>
<polygon fill="black" stroke="black" points="11484.77,-9614.96 11494.3,-9610.32 11483.96,-9608.01 11484.77,-9614.96"/>
</g>
<!-- layer_11_qkv_gpu15 -->
<g id="node614" class="node">
<title>layer_11_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="11103.5,-9763.37 10966.5,-9763.37 10966.5,-9710.37 11103.5,-9710.37 11103.5,-9763.37"/>
<text text-anchor="middle" x="11035" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU15</text>
<text text-anchor="middle" x="11035" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="11035" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_11_qkv_gpu15&#45;&gt;layer_11_qkv_comm -->
<g id="edge769" class="edge">
<title>layer_11_qkv_gpu15&#45;&gt;layer_11_qkv_comm</title>
<path fill="none" stroke="black" d="M11057.71,-9710.1C11072.06,-9695.55 11091.85,-9678.42 11113,-9668.87 11177.31,-9639.85 11367.6,-9620.54 11483.56,-9611.11"/>
<polygon fill="black" stroke="black" points="11484.16,-9614.57 11493.85,-9610.28 11483.6,-9607.59 11484.16,-9614.57"/>
</g>
<!-- layer_11_attn_comp_gpu8 -->
<g id="node616" class="node">
<title>layer_11_attn_comp_gpu8</title>
<polygon fill="lightblue" stroke="black" points="10902,-9540.13 10704,-9540.13 10704,-9487.13 10902,-9487.13 10902,-9540.13"/>
<text text-anchor="middle" x="10803" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU8</text>
<text text-anchor="middle" x="10803" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="10803" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_11_qkv_comm&#45;&gt;layer_11_attn_comp_gpu8 -->
<g id="edge770" class="edge">
<title>layer_11_qkv_comm&#45;&gt;layer_11_attn_comp_gpu8</title>
<path fill="none" stroke="black" d="M11492.66,-9598.4C11367.76,-9591.65 11126.21,-9575.34 10912.22,-9540.61"/>
<polygon fill="black" stroke="black" points="10912.49,-9537.1 10902.05,-9538.94 10911.36,-9544.01 10912.49,-9537.1"/>
</g>
<!-- layer_11_attn_comp_gpu9 -->
<g id="node617" class="node">
<title>layer_11_attn_comp_gpu9</title>
<polygon fill="lightblue" stroke="black" points="11118,-9540.13 10920,-9540.13 10920,-9487.13 11118,-9487.13 11118,-9540.13"/>
<text text-anchor="middle" x="11019" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU9</text>
<text text-anchor="middle" x="11019" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="11019" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_11_qkv_comm&#45;&gt;layer_11_attn_comp_gpu9 -->
<g id="edge771" class="edge">
<title>layer_11_qkv_comm&#45;&gt;layer_11_attn_comp_gpu9</title>
<path fill="none" stroke="black" d="M11497.14,-9593.72C11407.07,-9583.41 11256.39,-9564.53 11128,-9540.5 11127.9,-9540.48 11127.8,-9540.46 11127.7,-9540.45"/>
<polygon fill="black" stroke="black" points="11128.61,-9537.06 11118.12,-9538.59 11127.27,-9543.93 11128.61,-9537.06"/>
</g>
<!-- layer_11_attn_comp_gpu10 -->
<g id="node618" class="node">
<title>layer_11_attn_comp_gpu10</title>
<polygon fill="lightblue" stroke="black" points="11343.5,-9540.13 11136.5,-9540.13 11136.5,-9487.13 11343.5,-9487.13 11343.5,-9540.13"/>
<text text-anchor="middle" x="11240" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU10</text>
<text text-anchor="middle" x="11240" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="11240" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_11_qkv_comm&#45;&gt;layer_11_attn_comp_gpu10 -->
<g id="edge772" class="edge">
<title>layer_11_qkv_comm&#45;&gt;layer_11_attn_comp_gpu10</title>
<path fill="none" stroke="black" d="M11512.42,-9585.56C11466,-9573.47 11402.32,-9556.89 11348.2,-9542.8"/>
<polygon fill="black" stroke="black" points="11348.77,-9539.33 11338.21,-9540.2 11347,-9546.11 11348.77,-9539.33"/>
</g>
<!-- layer_11_attn_comp_gpu11 -->
<g id="node619" class="node">
<title>layer_11_attn_comp_gpu11</title>
<polygon fill="lightblue" stroke="black" points="11568.5,-9540.13 11361.5,-9540.13 11361.5,-9487.13 11568.5,-9487.13 11568.5,-9540.13"/>
<text text-anchor="middle" x="11465" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU11</text>
<text text-anchor="middle" x="11465" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="11465" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_11_qkv_comm&#45;&gt;layer_11_attn_comp_gpu11 -->
<g id="edge773" class="edge">
<title>layer_11_qkv_comm&#45;&gt;layer_11_attn_comp_gpu11</title>
<path fill="none" stroke="black" d="M11546.1,-9578.17C11533.66,-9568.42 11519.14,-9557.04 11505.84,-9546.63"/>
<polygon fill="black" stroke="black" points="11507.79,-9543.71 11497.76,-9540.29 11503.47,-9549.22 11507.79,-9543.71"/>
</g>
<!-- layer_11_attn_comp_gpu12 -->
<g id="node620" class="node">
<title>layer_11_attn_comp_gpu12</title>
<polygon fill="lightblue" stroke="black" points="11793.5,-9540.13 11586.5,-9540.13 11586.5,-9487.13 11793.5,-9487.13 11793.5,-9540.13"/>
<text text-anchor="middle" x="11690" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU12</text>
<text text-anchor="middle" x="11690" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="11690" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_11_qkv_comm&#45;&gt;layer_11_attn_comp_gpu12 -->
<g id="edge774" class="edge">
<title>layer_11_qkv_comm&#45;&gt;layer_11_attn_comp_gpu12</title>
<path fill="none" stroke="black" d="M11608.18,-9578.17C11620.73,-9568.42 11635.38,-9557.04 11648.79,-9546.63"/>
<polygon fill="black" stroke="black" points="11651.2,-9549.19 11656.95,-9540.29 11646.91,-9543.66 11651.2,-9549.19"/>
</g>
<!-- layer_11_attn_comp_gpu13 -->
<g id="node621" class="node">
<title>layer_11_attn_comp_gpu13</title>
<polygon fill="lightblue" stroke="black" points="12018.5,-9540.13 11811.5,-9540.13 11811.5,-9487.13 12018.5,-9487.13 12018.5,-9540.13"/>
<text text-anchor="middle" x="11915" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU13</text>
<text text-anchor="middle" x="11915" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="11915" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_11_qkv_comm&#45;&gt;layer_11_attn_comp_gpu13 -->
<g id="edge775" class="edge">
<title>layer_11_qkv_comm&#45;&gt;layer_11_attn_comp_gpu13</title>
<path fill="none" stroke="black" d="M11641.37,-9585.66C11688.08,-9573.54 11752.37,-9556.85 11806.89,-9542.7"/>
<polygon fill="black" stroke="black" points="11807.8,-9546.08 11816.6,-9540.18 11806.04,-9539.3 11807.8,-9546.08"/>
</g>
<!-- layer_11_attn_comp_gpu14 -->
<g id="node622" class="node">
<title>layer_11_attn_comp_gpu14</title>
<polygon fill="lightblue" stroke="black" points="12243.5,-9540.13 12036.5,-9540.13 12036.5,-9487.13 12243.5,-9487.13 12243.5,-9540.13"/>
<text text-anchor="middle" x="12140" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU14</text>
<text text-anchor="middle" x="12140" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="12140" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_11_qkv_comm&#45;&gt;layer_11_attn_comp_gpu14 -->
<g id="edge776" class="edge">
<title>layer_11_qkv_comm&#45;&gt;layer_11_attn_comp_gpu14</title>
<path fill="none" stroke="black" d="M11656.78,-9593.64C11744.98,-9583.49 11891.41,-9565.16 12026.24,-9540.77"/>
<polygon fill="black" stroke="black" points="12027.13,-9544.16 12036.34,-9538.93 12025.87,-9537.28 12027.13,-9544.16"/>
</g>
<!-- layer_11_attn_comp_gpu15 -->
<g id="node623" class="node">
<title>layer_11_attn_comp_gpu15</title>
<polygon fill="lightblue" stroke="black" points="12468.5,-9540.13 12261.5,-9540.13 12261.5,-9487.13 12468.5,-9487.13 12468.5,-9540.13"/>
<text text-anchor="middle" x="12365" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU15</text>
<text text-anchor="middle" x="12365" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="12365" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_11_qkv_comm&#45;&gt;layer_11_attn_comp_gpu15 -->
<g id="edge777" class="edge">
<title>layer_11_qkv_comm&#45;&gt;layer_11_attn_comp_gpu15</title>
<path fill="none" stroke="black" d="M11661.24,-9598.34C11787.64,-9591.48 12033.91,-9574.96 12251.36,-9540.69"/>
<polygon fill="black" stroke="black" points="12252.04,-9544.12 12261.36,-9539.09 12250.94,-9537.21 12252.04,-9544.12"/>
</g>
<!-- layer_11_attn_out_gpu8 -->
<g id="node624" class="node">
<title>layer_11_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="10918,-9450.76 10760,-9450.76 10760,-9397.76 10918,-9397.76 10918,-9450.76"/>
<text text-anchor="middle" x="10839" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU8</text>
<text text-anchor="middle" x="10839" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="10839" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_11_attn_comp_gpu8&#45;&gt;layer_11_attn_out_gpu8 -->
<g id="edge778" class="edge">
<title>layer_11_attn_comp_gpu8&#45;&gt;layer_11_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M10813.61,-9486.89C10817.05,-9478.54 10820.93,-9469.12 10824.6,-9460.21"/>
<polygon fill="black" stroke="black" points="10827.9,-9461.4 10828.47,-9450.82 10821.42,-9458.73 10827.9,-9461.4"/>
</g>
<!-- layer_11_attn_out_gpu9 -->
<g id="node625" class="node">
<title>layer_11_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="11131,-9450.76 10973,-9450.76 10973,-9397.76 11131,-9397.76 11131,-9450.76"/>
<text text-anchor="middle" x="11052" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU9</text>
<text text-anchor="middle" x="11052" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="11052" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_11_attn_comp_gpu9&#45;&gt;layer_11_attn_out_gpu9 -->
<g id="edge779" class="edge">
<title>layer_11_attn_comp_gpu9&#45;&gt;layer_11_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M11028.72,-9486.89C11031.88,-9478.54 11035.43,-9469.12 11038.8,-9460.21"/>
<polygon fill="black" stroke="black" points="11042.09,-9461.41 11042.35,-9450.82 11035.54,-9458.94 11042.09,-9461.41"/>
</g>
<!-- layer_11_attn_out_gpu10 -->
<g id="node626" class="node">
<title>layer_11_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="11348.5,-9450.76 11181.5,-9450.76 11181.5,-9397.76 11348.5,-9397.76 11348.5,-9450.76"/>
<text text-anchor="middle" x="11265" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU10</text>
<text text-anchor="middle" x="11265" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="11265" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_11_attn_comp_gpu10&#45;&gt;layer_11_attn_out_gpu10 -->
<g id="edge780" class="edge">
<title>layer_11_attn_comp_gpu10&#45;&gt;layer_11_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M11247.37,-9486.89C11249.73,-9478.63 11252.39,-9469.32 11254.92,-9460.5"/>
<polygon fill="black" stroke="black" points="11258.3,-9461.4 11257.69,-9450.82 11251.57,-9459.47 11258.3,-9461.4"/>
</g>
<!-- layer_11_attn_out_gpu11 -->
<g id="node627" class="node">
<title>layer_11_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="11558.5,-9450.76 11391.5,-9450.76 11391.5,-9397.76 11558.5,-9397.76 11558.5,-9450.76"/>
<text text-anchor="middle" x="11475" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU11</text>
<text text-anchor="middle" x="11475" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="11475" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_11_attn_comp_gpu11&#45;&gt;layer_11_attn_out_gpu11 -->
<g id="edge781" class="edge">
<title>layer_11_attn_comp_gpu11&#45;&gt;layer_11_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M11467.95,-9486.89C11468.88,-9478.72 11469.93,-9469.52 11470.93,-9460.78"/>
<polygon fill="black" stroke="black" points="11474.41,-9461.15 11472.07,-9450.82 11467.46,-9460.36 11474.41,-9461.15"/>
</g>
<!-- layer_11_attn_out_gpu12 -->
<g id="node628" class="node">
<title>layer_11_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="11763.5,-9450.76 11596.5,-9450.76 11596.5,-9397.76 11763.5,-9397.76 11763.5,-9450.76"/>
<text text-anchor="middle" x="11680" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU12</text>
<text text-anchor="middle" x="11680" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="11680" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_11_attn_comp_gpu12&#45;&gt;layer_11_attn_out_gpu12 -->
<g id="edge782" class="edge">
<title>layer_11_attn_comp_gpu12&#45;&gt;layer_11_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M11687.05,-9486.89C11686.12,-9478.72 11685.07,-9469.52 11684.07,-9460.78"/>
<polygon fill="black" stroke="black" points="11687.54,-9460.36 11682.93,-9450.82 11680.59,-9461.15 11687.54,-9460.36"/>
</g>
<!-- layer_11_attn_out_gpu13 -->
<g id="node629" class="node">
<title>layer_11_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="11978.5,-9450.76 11811.5,-9450.76 11811.5,-9397.76 11978.5,-9397.76 11978.5,-9450.76"/>
<text text-anchor="middle" x="11895" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU13</text>
<text text-anchor="middle" x="11895" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="11895" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_11_attn_comp_gpu13&#45;&gt;layer_11_attn_out_gpu13 -->
<g id="edge783" class="edge">
<title>layer_11_attn_comp_gpu13&#45;&gt;layer_11_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M11909.11,-9486.89C11907.24,-9478.72 11905.13,-9469.52 11903.13,-9460.78"/>
<polygon fill="black" stroke="black" points="11906.49,-9459.79 11900.85,-9450.82 11899.67,-9461.35 11906.49,-9459.79"/>
</g>
<!-- layer_11_attn_out_gpu14 -->
<g id="node630" class="node">
<title>layer_11_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="12198.5,-9450.76 12031.5,-9450.76 12031.5,-9397.76 12198.5,-9397.76 12198.5,-9450.76"/>
<text text-anchor="middle" x="12115" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU14</text>
<text text-anchor="middle" x="12115" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="12115" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_11_attn_comp_gpu14&#45;&gt;layer_11_attn_out_gpu14 -->
<g id="edge784" class="edge">
<title>layer_11_attn_comp_gpu14&#45;&gt;layer_11_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M12132.63,-9486.89C12130.27,-9478.63 12127.61,-9469.32 12125.08,-9460.5"/>
<polygon fill="black" stroke="black" points="12128.43,-9459.47 12122.31,-9450.82 12121.7,-9461.4 12128.43,-9459.47"/>
</g>
<!-- layer_11_attn_out_gpu15 -->
<g id="node631" class="node">
<title>layer_11_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="12420.5,-9450.76 12253.5,-9450.76 12253.5,-9397.76 12420.5,-9397.76 12420.5,-9450.76"/>
<text text-anchor="middle" x="12337" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU15</text>
<text text-anchor="middle" x="12337" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="12337" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_11_attn_comp_gpu15&#45;&gt;layer_11_attn_out_gpu15 -->
<g id="edge785" class="edge">
<title>layer_11_attn_comp_gpu15&#45;&gt;layer_11_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M12356.75,-9486.89C12354.1,-9478.63 12351.12,-9469.32 12348.29,-9460.5"/>
<polygon fill="black" stroke="black" points="12351.58,-9459.27 12345.19,-9450.82 12344.91,-9461.41 12351.58,-9459.27"/>
</g>
<!-- layer_11_attn_allreduce -->
<g id="node632" class="node">
<title>layer_11_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="11578" cy="-9334.89" rx="112.36" ry="26.74"/>
<text text-anchor="middle" x="11578" y="-9338.69" font-family="Times,serif" font-size="14.00">Attention AllReduce</text>
<text text-anchor="middle" x="11578" y="-9323.69" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_11_attn_out_gpu8&#45;&gt;layer_11_attn_allreduce -->
<g id="edge786" class="edge">
<title>layer_11_attn_out_gpu8&#45;&gt;layer_11_attn_allreduce</title>
<path fill="none" stroke="black" d="M10918.14,-9405.87C10933.31,-9402.89 10949.11,-9400.03 10964,-9397.76 11136.05,-9371.61 11336.96,-9353.74 11460.84,-9344.17"/>
<polygon fill="black" stroke="black" points="11461.4,-9347.63 11471.11,-9343.38 11460.87,-9340.65 11461.4,-9347.63"/>
</g>
<!-- layer_11_attn_out_gpu9&#45;&gt;layer_11_attn_allreduce -->
<g id="edge787" class="edge">
<title>layer_11_attn_out_gpu9&#45;&gt;layer_11_attn_allreduce</title>
<path fill="none" stroke="black" d="M11131.28,-9405.89C11145.16,-9403.04 11159.48,-9400.22 11173,-9397.76 11274.11,-9379.4 11390.08,-9362.06 11471.95,-9350.43"/>
<polygon fill="black" stroke="black" points="11472.6,-9353.88 11482.01,-9349.01 11471.62,-9346.95 11472.6,-9353.88"/>
</g>
<!-- layer_11_attn_out_gpu10&#45;&gt;layer_11_attn_allreduce -->
<g id="edge788" class="edge">
<title>layer_11_attn_out_gpu10&#45;&gt;layer_11_attn_allreduce</title>
<path fill="none" stroke="black" d="M11348.88,-9399.85C11394.85,-9387.02 11451.56,-9371.19 11497.07,-9358.48"/>
<polygon fill="black" stroke="black" points="11498.2,-9361.8 11506.89,-9355.74 11496.32,-9355.06 11498.2,-9361.8"/>
</g>
<!-- layer_11_attn_out_gpu11&#45;&gt;layer_11_attn_allreduce -->
<g id="edge789" class="edge">
<title>layer_11_attn_out_gpu11&#45;&gt;layer_11_attn_allreduce</title>
<path fill="none" stroke="black" d="M11505.07,-9397.76C11516.17,-9388.34 11528.88,-9377.56 11540.55,-9367.66"/>
<polygon fill="black" stroke="black" points="11543.07,-9370.12 11548.43,-9360.98 11538.54,-9364.78 11543.07,-9370.12"/>
</g>
<!-- layer_11_attn_out_gpu12&#45;&gt;layer_11_attn_allreduce -->
<g id="edge790" class="edge">
<title>layer_11_attn_out_gpu12&#45;&gt;layer_11_attn_allreduce</title>
<path fill="none" stroke="black" d="M11650.22,-9397.76C11639.23,-9388.34 11626.65,-9377.56 11615.09,-9367.66"/>
<polygon fill="black" stroke="black" points="11617.16,-9364.83 11607.29,-9360.98 11612.6,-9370.14 11617.16,-9364.83"/>
</g>
<!-- layer_11_attn_out_gpu13&#45;&gt;layer_11_attn_allreduce -->
<g id="edge791" class="edge">
<title>layer_11_attn_out_gpu13&#45;&gt;layer_11_attn_allreduce</title>
<path fill="none" stroke="black" d="M11811.3,-9400.19C11764.37,-9387.26 11706.1,-9371.2 11659.54,-9358.37"/>
<polygon fill="black" stroke="black" points="11660.36,-9354.96 11649.79,-9355.68 11658.5,-9361.71 11660.36,-9354.96"/>
</g>
<!-- layer_11_attn_out_gpu14&#45;&gt;layer_11_attn_allreduce -->
<g id="edge792" class="edge">
<title>layer_11_attn_out_gpu14&#45;&gt;layer_11_attn_allreduce</title>
<path fill="none" stroke="black" d="M12031.42,-9405.88C12016.97,-9403.05 12002.06,-9400.23 11988,-9397.76 11884.95,-9379.65 11766.76,-9362.16 11683.83,-9350.43"/>
<polygon fill="black" stroke="black" points="11684.29,-9346.96 11673.9,-9349.03 11683.31,-9353.89 11684.29,-9346.96"/>
</g>
<!-- layer_11_attn_out_gpu15&#45;&gt;layer_11_attn_allreduce -->
<g id="edge793" class="edge">
<title>layer_11_attn_out_gpu15&#45;&gt;layer_11_attn_allreduce</title>
<path fill="none" stroke="black" d="M12253.24,-9405.48C12238.22,-9402.64 12222.68,-9399.93 12208,-9397.76 12030.03,-9371.5 11822.07,-9353.52 11695.24,-9343.98"/>
<polygon fill="black" stroke="black" points="11695.35,-9340.48 11685.12,-9343.22 11694.83,-9347.46 11695.35,-9340.48"/>
</g>
<!-- layer_11_residual1 -->
<g id="node633" class="node">
<title>layer_11_residual1</title>
<polygon fill="lightyellow" stroke="black" points="11715.78,-9272.02 11496.6,-9272.02 11440.22,-9196.02 11659.4,-9196.02 11715.78,-9272.02"/>
<text text-anchor="middle" x="11578" y="-9237.82" font-family="Times,serif" font-size="14.00">Residual Add 11</text>
<text text-anchor="middle" x="11578" y="-9222.82" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_11_attn_allreduce&#45;&gt;layer_11_residual1 -->
<g id="edge794" class="edge">
<title>layer_11_attn_allreduce&#45;&gt;layer_11_residual1</title>
<path fill="none" stroke="black" d="M11578,-9307.92C11578,-9300.1 11578,-9291.27 11578,-9282.52"/>
<polygon fill="black" stroke="black" points="11581.5,-9282.35 11578,-9272.35 11574.5,-9282.35 11581.5,-9282.35"/>
</g>
<!-- layer_11_ln1 -->
<g id="node634" class="node">
<title>layer_11_ln1</title>
<polygon fill="lightblue" stroke="black" points="11638,-9141.02 11518,-9141.02 11518,-9103.02 11638,-9103.02 11638,-9141.02"/>
<text text-anchor="middle" x="11578" y="-9125.82" font-family="Times,serif" font-size="14.00">LayerNorm 11</text>
<text text-anchor="middle" x="11578" y="-9110.82" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_11_residual1&#45;&gt;layer_11_ln1 -->
<g id="edge795" class="edge">
<title>layer_11_residual1&#45;&gt;layer_11_ln1</title>
<path fill="none" stroke="black" d="M11578,-9195.78C11578,-9181.22 11578,-9164.81 11578,-9151.26"/>
<polygon fill="black" stroke="black" points="11581.5,-9151.09 11578,-9141.09 11574.5,-9151.09 11581.5,-9151.09"/>
</g>
<!-- layer_11_mlp1_gpu8 -->
<g id="node635" class="node">
<title>layer_11_mlp1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="12145,-9045.02 12019,-9045.02 12019,-8992.02 12145,-8992.02 12145,-9045.02"/>
<text text-anchor="middle" x="12082" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU8</text>
<text text-anchor="middle" x="12082" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="12082" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp1_gpu8 -->
<g id="edge796" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp1_gpu8</title>
<path fill="none" stroke="black" d="M11638.12,-9118.87C11740.5,-9114.51 11944.03,-9102.72 12010,-9076.02 12023.87,-9070.41 12037.27,-9061.28 12048.68,-9051.99"/>
<polygon fill="black" stroke="black" points="12051.27,-9054.38 12056.61,-9045.24 12046.73,-9049.05 12051.27,-9054.38"/>
</g>
<!-- layer_11_mlp1_gpu9 -->
<g id="node636" class="node">
<title>layer_11_mlp1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="12001,-9045.02 11875,-9045.02 11875,-8992.02 12001,-8992.02 12001,-9045.02"/>
<text text-anchor="middle" x="11938" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU9</text>
<text text-anchor="middle" x="11938" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="11938" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp1_gpu9 -->
<g id="edge800" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp1_gpu9</title>
<path fill="none" stroke="black" d="M11638.08,-9120.39C11698.1,-9117.79 11791.86,-9108.26 11866,-9076.02 11879.6,-9070.11 11892.86,-9061 11904.21,-9051.8"/>
<polygon fill="black" stroke="black" points="11906.73,-9054.26 11912.12,-9045.14 11902.22,-9048.91 11906.73,-9054.26"/>
</g>
<!-- layer_11_mlp1_gpu10 -->
<g id="node637" class="node">
<title>layer_11_mlp1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="11857,-9045.02 11731,-9045.02 11731,-8992.02 11857,-8992.02 11857,-9045.02"/>
<text text-anchor="middle" x="11794" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU10</text>
<text text-anchor="middle" x="11794" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="11794" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp1_gpu10 -->
<g id="edge804" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp1_gpu10</title>
<path fill="none" stroke="black" d="M11638.08,-9107.48C11664.68,-9100.18 11695.8,-9089.8 11722,-9076.02 11734.67,-9069.36 11747.35,-9060.38 11758.45,-9051.55"/>
<polygon fill="black" stroke="black" points="11760.71,-9054.22 11766.24,-9045.18 11756.28,-9048.8 11760.71,-9054.22"/>
</g>
<!-- layer_11_mlp1_gpu11 -->
<g id="node638" class="node">
<title>layer_11_mlp1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="11713,-9045.02 11587,-9045.02 11587,-8992.02 11713,-8992.02 11713,-9045.02"/>
<text text-anchor="middle" x="11650" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU11</text>
<text text-anchor="middle" x="11650" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="11650" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp1_gpu11 -->
<g id="edge808" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp1_gpu11</title>
<path fill="none" stroke="black" d="M11590.87,-9102.88C11600.59,-9089.18 11614.19,-9070 11625.91,-9053.49"/>
<polygon fill="black" stroke="black" points="11628.9,-9055.32 11631.83,-9045.14 11623.19,-9051.27 11628.9,-9055.32"/>
</g>
<!-- layer_11_mlp1_gpu12 -->
<g id="node639" class="node">
<title>layer_11_mlp1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="11569,-9045.02 11443,-9045.02 11443,-8992.02 11569,-8992.02 11569,-9045.02"/>
<text text-anchor="middle" x="11506" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU12</text>
<text text-anchor="middle" x="11506" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="11506" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp1_gpu12 -->
<g id="edge812" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp1_gpu12</title>
<path fill="none" stroke="black" d="M11565.13,-9102.88C11555.41,-9089.18 11541.81,-9070 11530.09,-9053.49"/>
<polygon fill="black" stroke="black" points="11532.81,-9051.27 11524.17,-9045.14 11527.1,-9055.32 11532.81,-9051.27"/>
</g>
<!-- layer_11_mlp1_gpu13 -->
<g id="node640" class="node">
<title>layer_11_mlp1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="11425,-9045.02 11299,-9045.02 11299,-8992.02 11425,-8992.02 11425,-9045.02"/>
<text text-anchor="middle" x="11362" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU13</text>
<text text-anchor="middle" x="11362" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="11362" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp1_gpu13 -->
<g id="edge816" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp1_gpu13</title>
<path fill="none" stroke="black" d="M11517.92,-9107.48C11491.32,-9100.18 11460.2,-9089.8 11434,-9076.02 11421.33,-9069.36 11408.65,-9060.38 11397.55,-9051.55"/>
<polygon fill="black" stroke="black" points="11399.72,-9048.8 11389.76,-9045.18 11395.29,-9054.22 11399.72,-9048.8"/>
</g>
<!-- layer_11_mlp1_gpu14 -->
<g id="node641" class="node">
<title>layer_11_mlp1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="11281,-9045.02 11155,-9045.02 11155,-8992.02 11281,-8992.02 11281,-9045.02"/>
<text text-anchor="middle" x="11218" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU14</text>
<text text-anchor="middle" x="11218" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="11218" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp1_gpu14 -->
<g id="edge820" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp1_gpu14</title>
<path fill="none" stroke="black" d="M11517.92,-9120.39C11457.9,-9117.79 11364.14,-9108.26 11290,-9076.02 11276.4,-9070.11 11263.14,-9061 11251.79,-9051.8"/>
<polygon fill="black" stroke="black" points="11253.78,-9048.91 11243.88,-9045.14 11249.27,-9054.26 11253.78,-9048.91"/>
</g>
<!-- layer_11_mlp1_gpu15 -->
<g id="node642" class="node">
<title>layer_11_mlp1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="11137,-9045.02 11011,-9045.02 11011,-8992.02 11137,-8992.02 11137,-9045.02"/>
<text text-anchor="middle" x="11074" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU15</text>
<text text-anchor="middle" x="11074" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="11074" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp1_gpu15 -->
<g id="edge824" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp1_gpu15</title>
<path fill="none" stroke="black" d="M11517.88,-9118.87C11415.5,-9114.51 11211.97,-9102.72 11146,-9076.02 11132.13,-9070.41 11118.73,-9061.28 11107.32,-9051.99"/>
<polygon fill="black" stroke="black" points="11109.27,-9049.05 11099.39,-9045.24 11104.73,-9054.38 11109.27,-9049.05"/>
</g>
<!-- layer_11_gelu_gpu8 -->
<g id="node643" class="node">
<title>layer_11_gelu_gpu8</title>
<polygon fill="lightblue" stroke="black" points="12134,-8945.52 12030,-8945.52 12030,-8907.52 12134,-8907.52 12134,-8945.52"/>
<text text-anchor="middle" x="12082" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU8</text>
<text text-anchor="middle" x="12082" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_11_mlp1_gpu8&#45;&gt;layer_11_gelu_gpu8 -->
<g id="edge797" class="edge">
<title>layer_11_mlp1_gpu8&#45;&gt;layer_11_gelu_gpu8</title>
<path fill="none" stroke="black" d="M12082,-8991.97C12082,-8980.67 12082,-8967.35 12082,-8955.75"/>
<polygon fill="black" stroke="black" points="12085.5,-8955.7 12082,-8945.7 12078.5,-8955.7 12085.5,-8955.7"/>
</g>
<!-- layer_11_gelu_gpu9 -->
<g id="node644" class="node">
<title>layer_11_gelu_gpu9</title>
<polygon fill="lightblue" stroke="black" points="11990,-8945.52 11886,-8945.52 11886,-8907.52 11990,-8907.52 11990,-8945.52"/>
<text text-anchor="middle" x="11938" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU9</text>
<text text-anchor="middle" x="11938" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_11_mlp1_gpu9&#45;&gt;layer_11_gelu_gpu9 -->
<g id="edge801" class="edge">
<title>layer_11_mlp1_gpu9&#45;&gt;layer_11_gelu_gpu9</title>
<path fill="none" stroke="black" d="M11938,-8991.97C11938,-8980.67 11938,-8967.35 11938,-8955.75"/>
<polygon fill="black" stroke="black" points="11941.5,-8955.7 11938,-8945.7 11934.5,-8955.7 11941.5,-8955.7"/>
</g>
<!-- layer_11_gelu_gpu10 -->
<g id="node645" class="node">
<title>layer_11_gelu_gpu10</title>
<polygon fill="lightblue" stroke="black" points="11850.5,-8945.52 11737.5,-8945.52 11737.5,-8907.52 11850.5,-8907.52 11850.5,-8945.52"/>
<text text-anchor="middle" x="11794" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU10</text>
<text text-anchor="middle" x="11794" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_11_mlp1_gpu10&#45;&gt;layer_11_gelu_gpu10 -->
<g id="edge805" class="edge">
<title>layer_11_mlp1_gpu10&#45;&gt;layer_11_gelu_gpu10</title>
<path fill="none" stroke="black" d="M11794,-8991.97C11794,-8980.67 11794,-8967.35 11794,-8955.75"/>
<polygon fill="black" stroke="black" points="11797.5,-8955.7 11794,-8945.7 11790.5,-8955.7 11797.5,-8955.7"/>
</g>
<!-- layer_11_gelu_gpu11 -->
<g id="node646" class="node">
<title>layer_11_gelu_gpu11</title>
<polygon fill="lightblue" stroke="black" points="11706.5,-8945.52 11593.5,-8945.52 11593.5,-8907.52 11706.5,-8907.52 11706.5,-8945.52"/>
<text text-anchor="middle" x="11650" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU11</text>
<text text-anchor="middle" x="11650" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_11_mlp1_gpu11&#45;&gt;layer_11_gelu_gpu11 -->
<g id="edge809" class="edge">
<title>layer_11_mlp1_gpu11&#45;&gt;layer_11_gelu_gpu11</title>
<path fill="none" stroke="black" d="M11650,-8991.97C11650,-8980.67 11650,-8967.35 11650,-8955.75"/>
<polygon fill="black" stroke="black" points="11653.5,-8955.7 11650,-8945.7 11646.5,-8955.7 11653.5,-8955.7"/>
</g>
<!-- layer_11_gelu_gpu12 -->
<g id="node647" class="node">
<title>layer_11_gelu_gpu12</title>
<polygon fill="lightblue" stroke="black" points="11562.5,-8945.52 11449.5,-8945.52 11449.5,-8907.52 11562.5,-8907.52 11562.5,-8945.52"/>
<text text-anchor="middle" x="11506" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU12</text>
<text text-anchor="middle" x="11506" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_11_mlp1_gpu12&#45;&gt;layer_11_gelu_gpu12 -->
<g id="edge813" class="edge">
<title>layer_11_mlp1_gpu12&#45;&gt;layer_11_gelu_gpu12</title>
<path fill="none" stroke="black" d="M11506,-8991.97C11506,-8980.67 11506,-8967.35 11506,-8955.75"/>
<polygon fill="black" stroke="black" points="11509.5,-8955.7 11506,-8945.7 11502.5,-8955.7 11509.5,-8955.7"/>
</g>
<!-- layer_11_gelu_gpu13 -->
<g id="node648" class="node">
<title>layer_11_gelu_gpu13</title>
<polygon fill="lightblue" stroke="black" points="11418.5,-8945.52 11305.5,-8945.52 11305.5,-8907.52 11418.5,-8907.52 11418.5,-8945.52"/>
<text text-anchor="middle" x="11362" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU13</text>
<text text-anchor="middle" x="11362" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_11_mlp1_gpu13&#45;&gt;layer_11_gelu_gpu13 -->
<g id="edge817" class="edge">
<title>layer_11_mlp1_gpu13&#45;&gt;layer_11_gelu_gpu13</title>
<path fill="none" stroke="black" d="M11362,-8991.97C11362,-8980.67 11362,-8967.35 11362,-8955.75"/>
<polygon fill="black" stroke="black" points="11365.5,-8955.7 11362,-8945.7 11358.5,-8955.7 11365.5,-8955.7"/>
</g>
<!-- layer_11_gelu_gpu14 -->
<g id="node649" class="node">
<title>layer_11_gelu_gpu14</title>
<polygon fill="lightblue" stroke="black" points="11274.5,-8945.52 11161.5,-8945.52 11161.5,-8907.52 11274.5,-8907.52 11274.5,-8945.52"/>
<text text-anchor="middle" x="11218" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU14</text>
<text text-anchor="middle" x="11218" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_11_mlp1_gpu14&#45;&gt;layer_11_gelu_gpu14 -->
<g id="edge821" class="edge">
<title>layer_11_mlp1_gpu14&#45;&gt;layer_11_gelu_gpu14</title>
<path fill="none" stroke="black" d="M11218,-8991.97C11218,-8980.67 11218,-8967.35 11218,-8955.75"/>
<polygon fill="black" stroke="black" points="11221.5,-8955.7 11218,-8945.7 11214.5,-8955.7 11221.5,-8955.7"/>
</g>
<!-- layer_11_gelu_gpu15 -->
<g id="node650" class="node">
<title>layer_11_gelu_gpu15</title>
<polygon fill="lightblue" stroke="black" points="11130.5,-8945.52 11017.5,-8945.52 11017.5,-8907.52 11130.5,-8907.52 11130.5,-8945.52"/>
<text text-anchor="middle" x="11074" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU15</text>
<text text-anchor="middle" x="11074" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_11_mlp1_gpu15&#45;&gt;layer_11_gelu_gpu15 -->
<g id="edge825" class="edge">
<title>layer_11_mlp1_gpu15&#45;&gt;layer_11_gelu_gpu15</title>
<path fill="none" stroke="black" d="M11074,-8991.97C11074,-8980.67 11074,-8967.35 11074,-8955.75"/>
<polygon fill="black" stroke="black" points="11077.5,-8955.7 11074,-8945.7 11070.5,-8955.7 11077.5,-8955.7"/>
</g>
<!-- layer_11_mlp2_gpu8 -->
<g id="node651" class="node">
<title>layer_11_mlp2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="12145,-8864.02 12019,-8864.02 12019,-8811.02 12145,-8811.02 12145,-8864.02"/>
<text text-anchor="middle" x="12082" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU8</text>
<text text-anchor="middle" x="12082" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="12082" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_11_gelu_gpu8&#45;&gt;layer_11_mlp2_gpu8 -->
<g id="edge798" class="edge">
<title>layer_11_gelu_gpu8&#45;&gt;layer_11_mlp2_gpu8</title>
<path fill="none" stroke="black" d="M12082,-8907.5C12082,-8897.89 12082,-8885.73 12082,-8874.31"/>
<polygon fill="black" stroke="black" points="12085.5,-8874.11 12082,-8864.11 12078.5,-8874.11 12085.5,-8874.11"/>
</g>
<!-- layer_11_mlp2_gpu9 -->
<g id="node652" class="node">
<title>layer_11_mlp2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="12001,-8864.02 11875,-8864.02 11875,-8811.02 12001,-8811.02 12001,-8864.02"/>
<text text-anchor="middle" x="11938" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU9</text>
<text text-anchor="middle" x="11938" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="11938" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_11_gelu_gpu9&#45;&gt;layer_11_mlp2_gpu9 -->
<g id="edge802" class="edge">
<title>layer_11_gelu_gpu9&#45;&gt;layer_11_mlp2_gpu9</title>
<path fill="none" stroke="black" d="M11938,-8907.5C11938,-8897.89 11938,-8885.73 11938,-8874.31"/>
<polygon fill="black" stroke="black" points="11941.5,-8874.11 11938,-8864.11 11934.5,-8874.11 11941.5,-8874.11"/>
</g>
<!-- layer_11_mlp2_gpu10 -->
<g id="node653" class="node">
<title>layer_11_mlp2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="11857,-8864.02 11731,-8864.02 11731,-8811.02 11857,-8811.02 11857,-8864.02"/>
<text text-anchor="middle" x="11794" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU10</text>
<text text-anchor="middle" x="11794" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="11794" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_11_gelu_gpu10&#45;&gt;layer_11_mlp2_gpu10 -->
<g id="edge806" class="edge">
<title>layer_11_gelu_gpu10&#45;&gt;layer_11_mlp2_gpu10</title>
<path fill="none" stroke="black" d="M11794,-8907.5C11794,-8897.89 11794,-8885.73 11794,-8874.31"/>
<polygon fill="black" stroke="black" points="11797.5,-8874.11 11794,-8864.11 11790.5,-8874.11 11797.5,-8874.11"/>
</g>
<!-- layer_11_mlp2_gpu11 -->
<g id="node654" class="node">
<title>layer_11_mlp2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="11713,-8864.02 11587,-8864.02 11587,-8811.02 11713,-8811.02 11713,-8864.02"/>
<text text-anchor="middle" x="11650" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU11</text>
<text text-anchor="middle" x="11650" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="11650" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_11_gelu_gpu11&#45;&gt;layer_11_mlp2_gpu11 -->
<g id="edge810" class="edge">
<title>layer_11_gelu_gpu11&#45;&gt;layer_11_mlp2_gpu11</title>
<path fill="none" stroke="black" d="M11650,-8907.5C11650,-8897.89 11650,-8885.73 11650,-8874.31"/>
<polygon fill="black" stroke="black" points="11653.5,-8874.11 11650,-8864.11 11646.5,-8874.11 11653.5,-8874.11"/>
</g>
<!-- layer_11_mlp2_gpu12 -->
<g id="node655" class="node">
<title>layer_11_mlp2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="11569,-8864.02 11443,-8864.02 11443,-8811.02 11569,-8811.02 11569,-8864.02"/>
<text text-anchor="middle" x="11506" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU12</text>
<text text-anchor="middle" x="11506" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="11506" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_11_gelu_gpu12&#45;&gt;layer_11_mlp2_gpu12 -->
<g id="edge814" class="edge">
<title>layer_11_gelu_gpu12&#45;&gt;layer_11_mlp2_gpu12</title>
<path fill="none" stroke="black" d="M11506,-8907.5C11506,-8897.89 11506,-8885.73 11506,-8874.31"/>
<polygon fill="black" stroke="black" points="11509.5,-8874.11 11506,-8864.11 11502.5,-8874.11 11509.5,-8874.11"/>
</g>
<!-- layer_11_mlp2_gpu13 -->
<g id="node656" class="node">
<title>layer_11_mlp2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="11425,-8864.02 11299,-8864.02 11299,-8811.02 11425,-8811.02 11425,-8864.02"/>
<text text-anchor="middle" x="11362" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU13</text>
<text text-anchor="middle" x="11362" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="11362" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_11_gelu_gpu13&#45;&gt;layer_11_mlp2_gpu13 -->
<g id="edge818" class="edge">
<title>layer_11_gelu_gpu13&#45;&gt;layer_11_mlp2_gpu13</title>
<path fill="none" stroke="black" d="M11362,-8907.5C11362,-8897.89 11362,-8885.73 11362,-8874.31"/>
<polygon fill="black" stroke="black" points="11365.5,-8874.11 11362,-8864.11 11358.5,-8874.11 11365.5,-8874.11"/>
</g>
<!-- layer_11_mlp2_gpu14 -->
<g id="node657" class="node">
<title>layer_11_mlp2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="11281,-8864.02 11155,-8864.02 11155,-8811.02 11281,-8811.02 11281,-8864.02"/>
<text text-anchor="middle" x="11218" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU14</text>
<text text-anchor="middle" x="11218" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="11218" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_11_gelu_gpu14&#45;&gt;layer_11_mlp2_gpu14 -->
<g id="edge822" class="edge">
<title>layer_11_gelu_gpu14&#45;&gt;layer_11_mlp2_gpu14</title>
<path fill="none" stroke="black" d="M11218,-8907.5C11218,-8897.89 11218,-8885.73 11218,-8874.31"/>
<polygon fill="black" stroke="black" points="11221.5,-8874.11 11218,-8864.11 11214.5,-8874.11 11221.5,-8874.11"/>
</g>
<!-- layer_11_mlp2_gpu15 -->
<g id="node658" class="node">
<title>layer_11_mlp2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="11137,-8864.02 11011,-8864.02 11011,-8811.02 11137,-8811.02 11137,-8864.02"/>
<text text-anchor="middle" x="11074" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU15</text>
<text text-anchor="middle" x="11074" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="11074" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_11_gelu_gpu15&#45;&gt;layer_11_mlp2_gpu15 -->
<g id="edge826" class="edge">
<title>layer_11_gelu_gpu15&#45;&gt;layer_11_mlp2_gpu15</title>
<path fill="none" stroke="black" d="M11074,-8907.5C11074,-8897.89 11074,-8885.73 11074,-8874.31"/>
<polygon fill="black" stroke="black" points="11077.5,-8874.11 11074,-8864.11 11070.5,-8874.11 11077.5,-8874.11"/>
</g>
<!-- layer_11_mlp_allreduce -->
<g id="node659" class="node">
<title>layer_11_mlp_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="11578" cy="-8748.15" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="11578" y="-8751.95" font-family="Times,serif" font-size="14.00">MLP AllReduce</text>
<text text-anchor="middle" x="11578" y="-8736.95" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_11_mlp2_gpu8&#45;&gt;layer_11_mlp_allreduce -->
<g id="edge799" class="edge">
<title>layer_11_mlp2_gpu8&#45;&gt;layer_11_mlp_allreduce</title>
<path fill="none" stroke="black" d="M12019,-8813.41C12015.97,-8812.56 12012.96,-8811.75 12010,-8811.02 11895.59,-8782.87 11760.77,-8766.09 11672.56,-8757.25"/>
<polygon fill="black" stroke="black" points="11672.86,-8753.77 11662.57,-8756.27 11672.18,-8760.73 11672.86,-8753.77"/>
</g>
<!-- layer_11_mlp2_gpu9&#45;&gt;layer_11_mlp_allreduce -->
<g id="edge803" class="edge">
<title>layer_11_mlp2_gpu9&#45;&gt;layer_11_mlp_allreduce</title>
<path fill="none" stroke="black" d="M11874.93,-8813.67C11871.92,-8812.74 11868.93,-8811.85 11866,-8811.02 11798.58,-8791.93 11720.82,-8775.55 11663.11,-8764.45"/>
<polygon fill="black" stroke="black" points="11663.42,-8760.94 11652.94,-8762.51 11662.1,-8767.82 11663.42,-8760.94"/>
</g>
<!-- layer_11_mlp2_gpu10&#45;&gt;layer_11_mlp_allreduce -->
<g id="edge807" class="edge">
<title>layer_11_mlp2_gpu10&#45;&gt;layer_11_mlp_allreduce</title>
<path fill="none" stroke="black" d="M11730.94,-8811.02C11702.08,-8799.34 11668,-8785.56 11639.35,-8773.97"/>
<polygon fill="black" stroke="black" points="11640.44,-8770.63 11629.86,-8770.13 11637.81,-8777.12 11640.44,-8770.63"/>
</g>
<!-- layer_11_mlp2_gpu11&#45;&gt;layer_11_mlp_allreduce -->
<g id="edge811" class="edge">
<title>layer_11_mlp2_gpu11&#45;&gt;layer_11_mlp_allreduce</title>
<path fill="none" stroke="black" d="M11628.79,-8810.78C11621.4,-8801.82 11613,-8791.63 11605.2,-8782.16"/>
<polygon fill="black" stroke="black" points="11607.87,-8779.9 11598.81,-8774.41 11602.47,-8784.35 11607.87,-8779.9"/>
</g>
<!-- layer_11_mlp2_gpu12&#45;&gt;layer_11_mlp_allreduce -->
<g id="edge815" class="edge">
<title>layer_11_mlp2_gpu12&#45;&gt;layer_11_mlp_allreduce</title>
<path fill="none" stroke="black" d="M11527.21,-8810.78C11534.6,-8801.82 11543,-8791.63 11550.8,-8782.16"/>
<polygon fill="black" stroke="black" points="11553.53,-8784.35 11557.19,-8774.41 11548.13,-8779.9 11553.53,-8784.35"/>
</g>
<!-- layer_11_mlp2_gpu13&#45;&gt;layer_11_mlp_allreduce -->
<g id="edge819" class="edge">
<title>layer_11_mlp2_gpu13&#45;&gt;layer_11_mlp_allreduce</title>
<path fill="none" stroke="black" d="M11425.06,-8811.02C11453.92,-8799.34 11488,-8785.56 11516.65,-8773.97"/>
<polygon fill="black" stroke="black" points="11518.19,-8777.12 11526.14,-8770.13 11515.56,-8770.63 11518.19,-8777.12"/>
</g>
<!-- layer_11_mlp2_gpu14&#45;&gt;layer_11_mlp_allreduce -->
<g id="edge823" class="edge">
<title>layer_11_mlp2_gpu14&#45;&gt;layer_11_mlp_allreduce</title>
<path fill="none" stroke="black" d="M11281.07,-8813.67C11284.08,-8812.74 11287.07,-8811.85 11290,-8811.02 11357.42,-8791.93 11435.18,-8775.55 11492.89,-8764.45"/>
<polygon fill="black" stroke="black" points="11493.9,-8767.82 11503.06,-8762.51 11492.58,-8760.94 11493.9,-8767.82"/>
</g>
<!-- layer_11_mlp2_gpu15&#45;&gt;layer_11_mlp_allreduce -->
<g id="edge827" class="edge">
<title>layer_11_mlp2_gpu15&#45;&gt;layer_11_mlp_allreduce</title>
<path fill="none" stroke="black" d="M11137,-8813.41C11140.03,-8812.56 11143.04,-8811.75 11146,-8811.02 11260.41,-8782.87 11395.23,-8766.09 11483.44,-8757.25"/>
<polygon fill="black" stroke="black" points="11483.82,-8760.73 11493.43,-8756.27 11483.14,-8753.77 11483.82,-8760.73"/>
</g>
<!-- layer_11_residual2 -->
<g id="node660" class="node">
<title>layer_11_residual2</title>
<polygon fill="lightyellow" stroke="black" points="11715.78,-8685.28 11496.6,-8685.28 11440.22,-8609.28 11659.4,-8609.28 11715.78,-8685.28"/>
<text text-anchor="middle" x="11578" y="-8651.08" font-family="Times,serif" font-size="14.00">Residual Add 11</text>
<text text-anchor="middle" x="11578" y="-8636.08" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_11_mlp_allreduce&#45;&gt;layer_11_residual2 -->
<g id="edge828" class="edge">
<title>layer_11_mlp_allreduce&#45;&gt;layer_11_residual2</title>
<path fill="none" stroke="black" d="M11578,-8721.18C11578,-8713.36 11578,-8704.53 11578,-8695.78"/>
<polygon fill="black" stroke="black" points="11581.5,-8695.61 11578,-8685.61 11574.5,-8695.61 11581.5,-8695.61"/>
</g>
<!-- layer_11_ln2 -->
<g id="node661" class="node">
<title>layer_11_ln2</title>
<polygon fill="lightblue" stroke="black" points="11638,-8554.28 11518,-8554.28 11518,-8516.28 11638,-8516.28 11638,-8554.28"/>
<text text-anchor="middle" x="11578" y="-8539.08" font-family="Times,serif" font-size="14.00">LayerNorm 11</text>
<text text-anchor="middle" x="11578" y="-8524.08" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_11_residual2&#45;&gt;layer_11_ln2 -->
<g id="edge829" class="edge">
<title>layer_11_residual2&#45;&gt;layer_11_ln2</title>
<path fill="none" stroke="black" d="M11578,-8609.04C11578,-8594.48 11578,-8578.07 11578,-8564.52"/>
<polygon fill="black" stroke="black" points="11581.5,-8564.35 11578,-8554.35 11574.5,-8564.35 11581.5,-8564.35"/>
</g>
<!-- layer_12_qkv_gpu0 -->
<g id="node888" class="node">
<title>layer_12_qkv_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="11722.69,-8411.28 11492.52,-8411.28 11433.31,-8375.28 11663.48,-8375.28 11722.69,-8411.28"/>
<text text-anchor="middle" x="11578" y="-8389.58" font-family="Times,serif" font-size="14.00">layer_12_qkv_gpu0</text>
</g>
<!-- layer_11_ln2&#45;&gt;layer_12_qkv_gpu0 -->
<g id="edge830" class="edge">
<title>layer_11_ln2&#45;&gt;layer_12_qkv_gpu0</title>
<path fill="none" stroke="black" d="M11578,-8516.27C11578,-8492.27 11578,-8449.62 11578,-8421.64"/>
<polygon fill="black" stroke="black" points="11581.5,-8421.35 11578,-8411.35 11574.5,-8421.35 11581.5,-8421.35"/>
</g>
<!-- layer_12_qkv_gpu8 -->
<g id="node662" class="node">
<title>layer_12_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="13960,-9763.37 13832,-9763.37 13832,-9710.37 13960,-9710.37 13960,-9763.37"/>
<text text-anchor="middle" x="13896" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU8</text>
<text text-anchor="middle" x="13896" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="13896" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_12_qkv_comm -->
<g id="node670" class="node">
<title>layer_12_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="13366" cy="-9603.37" rx="85.62" ry="26.74"/>
<text text-anchor="middle" x="13366" y="-9607.17" font-family="Times,serif" font-size="14.00">QKV AllGather</text>
<text text-anchor="middle" x="13366" y="-9592.17" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_12_qkv_gpu8&#45;&gt;layer_12_qkv_comm -->
<g id="edge831" class="edge">
<title>layer_12_qkv_gpu8&#45;&gt;layer_12_qkv_comm</title>
<path fill="none" stroke="black" d="M13875.05,-9710.1C13861.73,-9695.55 13843.22,-9678.43 13823,-9668.87 13760.32,-9639.26 13573.6,-9620.21 13459.15,-9610.98"/>
<polygon fill="black" stroke="black" points="13459.24,-9607.47 13448.99,-9610.17 13458.68,-9614.45 13459.24,-9607.47"/>
</g>
<!-- layer_12_qkv_gpu9 -->
<g id="node663" class="node">
<title>layer_12_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="13814,-9763.37 13686,-9763.37 13686,-9710.37 13814,-9710.37 13814,-9763.37"/>
<text text-anchor="middle" x="13750" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU9</text>
<text text-anchor="middle" x="13750" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="13750" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_12_qkv_gpu9&#45;&gt;layer_12_qkv_comm -->
<g id="edge832" class="edge">
<title>layer_12_qkv_gpu9&#45;&gt;layer_12_qkv_comm</title>
<path fill="none" stroke="black" d="M13728.51,-9710.24C13715.13,-9695.93 13696.75,-9678.99 13677,-9668.87 13609.11,-9634.08 13523.77,-9618.06 13459.66,-9610.68"/>
<polygon fill="black" stroke="black" points="13459.89,-9607.18 13449.56,-9609.56 13459.12,-9614.14 13459.89,-9607.18"/>
</g>
<!-- layer_12_qkv_gpu10 -->
<g id="node664" class="node">
<title>layer_12_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="13667.5,-9763.37 13530.5,-9763.37 13530.5,-9710.37 13667.5,-9710.37 13667.5,-9763.37"/>
<text text-anchor="middle" x="13599" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU10</text>
<text text-anchor="middle" x="13599" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="13599" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_12_qkv_gpu10&#45;&gt;layer_12_qkv_comm -->
<g id="edge833" class="edge">
<title>layer_12_qkv_gpu10&#45;&gt;layer_12_qkv_comm</title>
<path fill="none" stroke="black" d="M13573.94,-9710.35C13559.64,-9696.77 13540.84,-9680.53 13522,-9668.87 13494.57,-9651.9 13461.89,-9637.6 13433.55,-9626.81"/>
<polygon fill="black" stroke="black" points="13434.71,-9623.51 13424.12,-9623.29 13432.26,-9630.07 13434.71,-9623.51"/>
</g>
<!-- layer_12_qkv_gpu11 -->
<g id="node665" class="node">
<title>layer_12_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="13512.5,-9763.37 13375.5,-9763.37 13375.5,-9710.37 13512.5,-9710.37 13512.5,-9763.37"/>
<text text-anchor="middle" x="13444" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU11</text>
<text text-anchor="middle" x="13444" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="13444" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_12_qkv_gpu11&#45;&gt;layer_12_qkv_comm -->
<g id="edge834" class="edge">
<title>layer_12_qkv_gpu11&#45;&gt;layer_12_qkv_comm</title>
<path fill="none" stroke="black" d="M13428.78,-9710.21C13416.7,-9689.84 13399.7,-9661.18 13386.43,-9638.82"/>
<polygon fill="black" stroke="black" points="13389.3,-9636.79 13381.19,-9629.97 13383.28,-9640.36 13389.3,-9636.79"/>
</g>
<!-- layer_12_qkv_gpu12 -->
<g id="node666" class="node">
<title>layer_12_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="13357.5,-9763.37 13220.5,-9763.37 13220.5,-9710.37 13357.5,-9710.37 13357.5,-9763.37"/>
<text text-anchor="middle" x="13289" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU12</text>
<text text-anchor="middle" x="13289" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="13289" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_12_qkv_gpu12&#45;&gt;layer_12_qkv_comm -->
<g id="edge835" class="edge">
<title>layer_12_qkv_gpu12&#45;&gt;layer_12_qkv_comm</title>
<path fill="none" stroke="black" d="M13304.03,-9710.21C13315.95,-9689.84 13332.74,-9661.18 13345.83,-9638.82"/>
<polygon fill="black" stroke="black" points="13348.98,-9640.37 13351.01,-9629.97 13342.94,-9636.84 13348.98,-9640.37"/>
</g>
<!-- layer_12_qkv_gpu13 -->
<g id="node667" class="node">
<title>layer_12_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="13202.5,-9763.37 13065.5,-9763.37 13065.5,-9710.37 13202.5,-9710.37 13202.5,-9763.37"/>
<text text-anchor="middle" x="13134" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU13</text>
<text text-anchor="middle" x="13134" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="13134" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_12_qkv_gpu13&#45;&gt;layer_12_qkv_comm -->
<g id="edge836" class="edge">
<title>layer_12_qkv_gpu13&#45;&gt;layer_12_qkv_comm</title>
<path fill="none" stroke="black" d="M13159.8,-9710.08C13174.28,-9696.59 13193.17,-9680.5 13212,-9668.87 13239.03,-9652.19 13271.13,-9637.97 13299.02,-9627.16"/>
<polygon fill="black" stroke="black" points="13300.59,-9630.31 13308.69,-9623.48 13298.1,-9623.76 13300.59,-9630.31"/>
</g>
<!-- layer_12_qkv_gpu14 -->
<g id="node668" class="node">
<title>layer_12_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="13047.5,-9763.37 12910.5,-9763.37 12910.5,-9710.37 13047.5,-9710.37 13047.5,-9763.37"/>
<text text-anchor="middle" x="12979" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU14</text>
<text text-anchor="middle" x="12979" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="12979" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_12_qkv_gpu14&#45;&gt;layer_12_qkv_comm -->
<g id="edge837" class="edge">
<title>layer_12_qkv_gpu14&#45;&gt;layer_12_qkv_comm</title>
<path fill="none" stroke="black" d="M13002.29,-9710.28C13016.7,-9695.98 13036.34,-9679.05 13057,-9668.87 13125.01,-9635.37 13209.76,-9619.24 13273.29,-9611.49"/>
<polygon fill="black" stroke="black" points="13273.77,-9614.96 13283.3,-9610.32 13272.96,-9608.01 13273.77,-9614.96"/>
</g>
<!-- layer_12_qkv_gpu15 -->
<g id="node669" class="node">
<title>layer_12_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="12892.5,-9763.37 12755.5,-9763.37 12755.5,-9710.37 12892.5,-9710.37 12892.5,-9763.37"/>
<text text-anchor="middle" x="12824" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU15</text>
<text text-anchor="middle" x="12824" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="12824" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_12_qkv_gpu15&#45;&gt;layer_12_qkv_comm -->
<g id="edge838" class="edge">
<title>layer_12_qkv_gpu15&#45;&gt;layer_12_qkv_comm</title>
<path fill="none" stroke="black" d="M12846.71,-9710.1C12861.06,-9695.55 12880.85,-9678.42 12902,-9668.87 12966.31,-9639.85 13156.6,-9620.54 13272.56,-9611.11"/>
<polygon fill="black" stroke="black" points="13273.16,-9614.57 13282.85,-9610.28 13272.6,-9607.59 13273.16,-9614.57"/>
</g>
<!-- layer_12_attn_comp_gpu8 -->
<g id="node671" class="node">
<title>layer_12_attn_comp_gpu8</title>
<polygon fill="lightblue" stroke="black" points="12691,-9540.13 12493,-9540.13 12493,-9487.13 12691,-9487.13 12691,-9540.13"/>
<text text-anchor="middle" x="12592" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU8</text>
<text text-anchor="middle" x="12592" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="12592" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_12_qkv_comm&#45;&gt;layer_12_attn_comp_gpu8 -->
<g id="edge839" class="edge">
<title>layer_12_qkv_comm&#45;&gt;layer_12_attn_comp_gpu8</title>
<path fill="none" stroke="black" d="M13281.66,-9598.4C13156.76,-9591.65 12915.21,-9575.34 12701.22,-9540.61"/>
<polygon fill="black" stroke="black" points="12701.49,-9537.1 12691.05,-9538.94 12700.36,-9544.01 12701.49,-9537.1"/>
</g>
<!-- layer_12_attn_comp_gpu9 -->
<g id="node672" class="node">
<title>layer_12_attn_comp_gpu9</title>
<polygon fill="lightblue" stroke="black" points="12907,-9540.13 12709,-9540.13 12709,-9487.13 12907,-9487.13 12907,-9540.13"/>
<text text-anchor="middle" x="12808" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU9</text>
<text text-anchor="middle" x="12808" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="12808" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_12_qkv_comm&#45;&gt;layer_12_attn_comp_gpu9 -->
<g id="edge840" class="edge">
<title>layer_12_qkv_comm&#45;&gt;layer_12_attn_comp_gpu9</title>
<path fill="none" stroke="black" d="M13286.14,-9593.72C13196.07,-9583.41 13045.39,-9564.53 12917,-9540.5 12916.9,-9540.48 12916.8,-9540.46 12916.7,-9540.45"/>
<polygon fill="black" stroke="black" points="12917.61,-9537.06 12907.12,-9538.59 12916.27,-9543.93 12917.61,-9537.06"/>
</g>
<!-- layer_12_attn_comp_gpu10 -->
<g id="node673" class="node">
<title>layer_12_attn_comp_gpu10</title>
<polygon fill="lightblue" stroke="black" points="13132.5,-9540.13 12925.5,-9540.13 12925.5,-9487.13 13132.5,-9487.13 13132.5,-9540.13"/>
<text text-anchor="middle" x="13029" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU10</text>
<text text-anchor="middle" x="13029" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="13029" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_12_qkv_comm&#45;&gt;layer_12_attn_comp_gpu10 -->
<g id="edge841" class="edge">
<title>layer_12_qkv_comm&#45;&gt;layer_12_attn_comp_gpu10</title>
<path fill="none" stroke="black" d="M13301.42,-9585.56C13255,-9573.47 13191.32,-9556.89 13137.2,-9542.8"/>
<polygon fill="black" stroke="black" points="13137.77,-9539.33 13127.21,-9540.2 13136,-9546.11 13137.77,-9539.33"/>
</g>
<!-- layer_12_attn_comp_gpu11 -->
<g id="node674" class="node">
<title>layer_12_attn_comp_gpu11</title>
<polygon fill="lightblue" stroke="black" points="13357.5,-9540.13 13150.5,-9540.13 13150.5,-9487.13 13357.5,-9487.13 13357.5,-9540.13"/>
<text text-anchor="middle" x="13254" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU11</text>
<text text-anchor="middle" x="13254" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="13254" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_12_qkv_comm&#45;&gt;layer_12_attn_comp_gpu11 -->
<g id="edge842" class="edge">
<title>layer_12_qkv_comm&#45;&gt;layer_12_attn_comp_gpu11</title>
<path fill="none" stroke="black" d="M13335.1,-9578.17C13322.66,-9568.42 13308.14,-9557.04 13294.84,-9546.63"/>
<polygon fill="black" stroke="black" points="13296.79,-9543.71 13286.76,-9540.29 13292.47,-9549.22 13296.79,-9543.71"/>
</g>
<!-- layer_12_attn_comp_gpu12 -->
<g id="node675" class="node">
<title>layer_12_attn_comp_gpu12</title>
<polygon fill="lightblue" stroke="black" points="13582.5,-9540.13 13375.5,-9540.13 13375.5,-9487.13 13582.5,-9487.13 13582.5,-9540.13"/>
<text text-anchor="middle" x="13479" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU12</text>
<text text-anchor="middle" x="13479" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="13479" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_12_qkv_comm&#45;&gt;layer_12_attn_comp_gpu12 -->
<g id="edge843" class="edge">
<title>layer_12_qkv_comm&#45;&gt;layer_12_attn_comp_gpu12</title>
<path fill="none" stroke="black" d="M13397.18,-9578.17C13409.73,-9568.42 13424.38,-9557.04 13437.79,-9546.63"/>
<polygon fill="black" stroke="black" points="13440.2,-9549.19 13445.95,-9540.29 13435.91,-9543.66 13440.2,-9549.19"/>
</g>
<!-- layer_12_attn_comp_gpu13 -->
<g id="node676" class="node">
<title>layer_12_attn_comp_gpu13</title>
<polygon fill="lightblue" stroke="black" points="13807.5,-9540.13 13600.5,-9540.13 13600.5,-9487.13 13807.5,-9487.13 13807.5,-9540.13"/>
<text text-anchor="middle" x="13704" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU13</text>
<text text-anchor="middle" x="13704" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="13704" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_12_qkv_comm&#45;&gt;layer_12_attn_comp_gpu13 -->
<g id="edge844" class="edge">
<title>layer_12_qkv_comm&#45;&gt;layer_12_attn_comp_gpu13</title>
<path fill="none" stroke="black" d="M13430.37,-9585.66C13477.08,-9573.54 13541.37,-9556.85 13595.89,-9542.7"/>
<polygon fill="black" stroke="black" points="13596.8,-9546.08 13605.6,-9540.18 13595.04,-9539.3 13596.8,-9546.08"/>
</g>
<!-- layer_12_attn_comp_gpu14 -->
<g id="node677" class="node">
<title>layer_12_attn_comp_gpu14</title>
<polygon fill="lightblue" stroke="black" points="14032.5,-9540.13 13825.5,-9540.13 13825.5,-9487.13 14032.5,-9487.13 14032.5,-9540.13"/>
<text text-anchor="middle" x="13929" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU14</text>
<text text-anchor="middle" x="13929" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="13929" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_12_qkv_comm&#45;&gt;layer_12_attn_comp_gpu14 -->
<g id="edge845" class="edge">
<title>layer_12_qkv_comm&#45;&gt;layer_12_attn_comp_gpu14</title>
<path fill="none" stroke="black" d="M13445.78,-9593.64C13533.98,-9583.49 13680.41,-9565.16 13815.24,-9540.77"/>
<polygon fill="black" stroke="black" points="13816.13,-9544.16 13825.34,-9538.93 13814.87,-9537.28 13816.13,-9544.16"/>
</g>
<!-- layer_12_attn_comp_gpu15 -->
<g id="node678" class="node">
<title>layer_12_attn_comp_gpu15</title>
<polygon fill="lightblue" stroke="black" points="14257.5,-9540.13 14050.5,-9540.13 14050.5,-9487.13 14257.5,-9487.13 14257.5,-9540.13"/>
<text text-anchor="middle" x="14154" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU15</text>
<text text-anchor="middle" x="14154" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="14154" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_12_qkv_comm&#45;&gt;layer_12_attn_comp_gpu15 -->
<g id="edge846" class="edge">
<title>layer_12_qkv_comm&#45;&gt;layer_12_attn_comp_gpu15</title>
<path fill="none" stroke="black" d="M13450.24,-9598.34C13576.64,-9591.48 13822.91,-9574.96 14040.36,-9540.69"/>
<polygon fill="black" stroke="black" points="14041.04,-9544.12 14050.36,-9539.09 14039.94,-9537.21 14041.04,-9544.12"/>
</g>
<!-- layer_12_attn_out_gpu8 -->
<g id="node679" class="node">
<title>layer_12_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="12724,-9450.76 12566,-9450.76 12566,-9397.76 12724,-9397.76 12724,-9450.76"/>
<text text-anchor="middle" x="12645" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU8</text>
<text text-anchor="middle" x="12645" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="12645" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_12_attn_comp_gpu8&#45;&gt;layer_12_attn_out_gpu8 -->
<g id="edge847" class="edge">
<title>layer_12_attn_comp_gpu8&#45;&gt;layer_12_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M12607.62,-9486.89C12612.79,-9478.36 12618.64,-9468.72 12624.14,-9459.65"/>
<polygon fill="black" stroke="black" points="12627.3,-9461.19 12629.5,-9450.82 12621.32,-9457.55 12627.3,-9461.19"/>
</g>
<!-- layer_12_attn_out_gpu9 -->
<g id="node680" class="node">
<title>layer_12_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="12920,-9450.76 12762,-9450.76 12762,-9397.76 12920,-9397.76 12920,-9450.76"/>
<text text-anchor="middle" x="12841" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU9</text>
<text text-anchor="middle" x="12841" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="12841" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_12_attn_comp_gpu9&#45;&gt;layer_12_attn_out_gpu9 -->
<g id="edge848" class="edge">
<title>layer_12_attn_comp_gpu9&#45;&gt;layer_12_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M12817.72,-9486.89C12820.88,-9478.54 12824.43,-9469.12 12827.8,-9460.21"/>
<polygon fill="black" stroke="black" points="12831.09,-9461.41 12831.35,-9450.82 12824.54,-9458.94 12831.09,-9461.41"/>
</g>
<!-- layer_12_attn_out_gpu10 -->
<g id="node681" class="node">
<title>layer_12_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="13137.5,-9450.76 12970.5,-9450.76 12970.5,-9397.76 13137.5,-9397.76 13137.5,-9450.76"/>
<text text-anchor="middle" x="13054" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU10</text>
<text text-anchor="middle" x="13054" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="13054" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_12_attn_comp_gpu10&#45;&gt;layer_12_attn_out_gpu10 -->
<g id="edge849" class="edge">
<title>layer_12_attn_comp_gpu10&#45;&gt;layer_12_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M13036.37,-9486.89C13038.73,-9478.63 13041.39,-9469.32 13043.92,-9460.5"/>
<polygon fill="black" stroke="black" points="13047.3,-9461.4 13046.69,-9450.82 13040.57,-9459.47 13047.3,-9461.4"/>
</g>
<!-- layer_12_attn_out_gpu11 -->
<g id="node682" class="node">
<title>layer_12_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="13347.5,-9450.76 13180.5,-9450.76 13180.5,-9397.76 13347.5,-9397.76 13347.5,-9450.76"/>
<text text-anchor="middle" x="13264" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU11</text>
<text text-anchor="middle" x="13264" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="13264" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_12_attn_comp_gpu11&#45;&gt;layer_12_attn_out_gpu11 -->
<g id="edge850" class="edge">
<title>layer_12_attn_comp_gpu11&#45;&gt;layer_12_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M13256.95,-9486.89C13257.88,-9478.72 13258.93,-9469.52 13259.93,-9460.78"/>
<polygon fill="black" stroke="black" points="13263.41,-9461.15 13261.07,-9450.82 13256.46,-9460.36 13263.41,-9461.15"/>
</g>
<!-- layer_12_attn_out_gpu12 -->
<g id="node683" class="node">
<title>layer_12_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="13542.5,-9450.76 13375.5,-9450.76 13375.5,-9397.76 13542.5,-9397.76 13542.5,-9450.76"/>
<text text-anchor="middle" x="13459" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU12</text>
<text text-anchor="middle" x="13459" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="13459" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_12_attn_comp_gpu12&#45;&gt;layer_12_attn_out_gpu12 -->
<g id="edge851" class="edge">
<title>layer_12_attn_comp_gpu12&#45;&gt;layer_12_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M13473.11,-9486.89C13471.24,-9478.72 13469.13,-9469.52 13467.13,-9460.78"/>
<polygon fill="black" stroke="black" points="13470.49,-9459.79 13464.85,-9450.82 13463.67,-9461.35 13470.49,-9459.79"/>
</g>
<!-- layer_12_attn_out_gpu13 -->
<g id="node684" class="node">
<title>layer_12_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="13747.5,-9450.76 13580.5,-9450.76 13580.5,-9397.76 13747.5,-9397.76 13747.5,-9450.76"/>
<text text-anchor="middle" x="13664" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU13</text>
<text text-anchor="middle" x="13664" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="13664" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_12_attn_comp_gpu13&#45;&gt;layer_12_attn_out_gpu13 -->
<g id="edge852" class="edge">
<title>layer_12_attn_comp_gpu13&#45;&gt;layer_12_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M13692.22,-9486.89C13688.35,-9478.45 13683.99,-9468.92 13679.87,-9459.93"/>
<polygon fill="black" stroke="black" points="13683.05,-9458.46 13675.7,-9450.82 13676.68,-9461.37 13683.05,-9458.46"/>
</g>
<!-- layer_12_attn_out_gpu14 -->
<g id="node685" class="node">
<title>layer_12_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="13962.5,-9450.76 13795.5,-9450.76 13795.5,-9397.76 13962.5,-9397.76 13962.5,-9450.76"/>
<text text-anchor="middle" x="13879" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU14</text>
<text text-anchor="middle" x="13879" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="13879" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_12_attn_comp_gpu14&#45;&gt;layer_12_attn_out_gpu14 -->
<g id="edge853" class="edge">
<title>layer_12_attn_comp_gpu14&#45;&gt;layer_12_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M13914.27,-9486.89C13909.39,-9478.36 13903.87,-9468.72 13898.68,-9459.65"/>
<polygon fill="black" stroke="black" points="13901.63,-9457.76 13893.63,-9450.82 13895.56,-9461.24 13901.63,-9457.76"/>
</g>
<!-- layer_12_attn_out_gpu15 -->
<g id="node686" class="node">
<title>layer_12_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="14182.5,-9450.76 14015.5,-9450.76 14015.5,-9397.76 14182.5,-9397.76 14182.5,-9450.76"/>
<text text-anchor="middle" x="14099" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU15</text>
<text text-anchor="middle" x="14099" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="14099" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_12_attn_comp_gpu15&#45;&gt;layer_12_attn_out_gpu15 -->
<g id="edge854" class="edge">
<title>layer_12_attn_comp_gpu15&#45;&gt;layer_12_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M14137.8,-9486.89C14132.37,-9478.27 14126.23,-9468.52 14120.47,-9459.36"/>
<polygon fill="black" stroke="black" points="14123.38,-9457.42 14115.09,-9450.82 14117.45,-9461.15 14123.38,-9457.42"/>
</g>
<!-- layer_12_attn_allreduce -->
<g id="node687" class="node">
<title>layer_12_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="13357" cy="-9334.89" rx="112.36" ry="26.74"/>
<text text-anchor="middle" x="13357" y="-9338.69" font-family="Times,serif" font-size="14.00">Attention AllReduce</text>
<text text-anchor="middle" x="13357" y="-9323.69" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_12_attn_out_gpu8&#45;&gt;layer_12_attn_allreduce -->
<g id="edge855" class="edge">
<title>layer_12_attn_out_gpu8&#45;&gt;layer_12_attn_allreduce</title>
<path fill="none" stroke="black" d="M12724.09,-9403.35C12733.79,-9401.27 12743.6,-9399.35 12753,-9397.76 12920.7,-9369.5 13116.93,-9352.29 13239.11,-9343.42"/>
<polygon fill="black" stroke="black" points="13239.51,-9346.9 13249.24,-9342.69 13239.01,-9339.92 13239.51,-9346.9"/>
</g>
<!-- layer_12_attn_out_gpu9&#45;&gt;layer_12_attn_allreduce -->
<g id="edge856" class="edge">
<title>layer_12_attn_out_gpu9&#45;&gt;layer_12_attn_allreduce</title>
<path fill="none" stroke="black" d="M12920.29,-9405.93C12934.17,-9403.08 12948.49,-9400.24 12962,-9397.76 13059.88,-9379.8 13172.01,-9362.55 13251.74,-9350.85"/>
<polygon fill="black" stroke="black" points="13252.4,-9354.29 13261.79,-9349.38 13251.38,-9347.36 13252.4,-9354.29"/>
</g>
<!-- layer_12_attn_out_gpu10&#45;&gt;layer_12_attn_allreduce -->
<g id="edge857" class="edge">
<title>layer_12_attn_out_gpu10&#45;&gt;layer_12_attn_allreduce</title>
<path fill="none" stroke="black" d="M13137.6,-9399.16C13181.15,-9386.6 13234.14,-9371.32 13277.14,-9358.92"/>
<polygon fill="black" stroke="black" points="13278.35,-9362.21 13286.99,-9356.08 13276.41,-9355.49 13278.35,-9362.21"/>
</g>
<!-- layer_12_attn_out_gpu11&#45;&gt;layer_12_attn_allreduce -->
<g id="edge858" class="edge">
<title>layer_12_attn_out_gpu11&#45;&gt;layer_12_attn_allreduce</title>
<path fill="none" stroke="black" d="M13291.4,-9397.52C13301.23,-9388.29 13312.44,-9377.76 13322.78,-9368.05"/>
<polygon fill="black" stroke="black" points="13325.22,-9370.55 13330.12,-9361.15 13320.43,-9365.45 13325.22,-9370.55"/>
</g>
<!-- layer_12_attn_out_gpu12&#45;&gt;layer_12_attn_allreduce -->
<g id="edge859" class="edge">
<title>layer_12_attn_out_gpu12&#45;&gt;layer_12_attn_allreduce</title>
<path fill="none" stroke="black" d="M13429.22,-9397.76C13418.23,-9388.34 13405.65,-9377.56 13394.09,-9367.66"/>
<polygon fill="black" stroke="black" points="13396.16,-9364.83 13386.29,-9360.98 13391.6,-9370.14 13396.16,-9364.83"/>
</g>
<!-- layer_12_attn_out_gpu13&#45;&gt;layer_12_attn_allreduce -->
<g id="edge860" class="edge">
<title>layer_12_attn_out_gpu13&#45;&gt;layer_12_attn_allreduce</title>
<path fill="none" stroke="black" d="M13580.11,-9399.39C13535.55,-9386.71 13481.05,-9371.2 13437.08,-9358.68"/>
<polygon fill="black" stroke="black" points="13437.86,-9355.27 13427.29,-9355.9 13435.95,-9362 13437.86,-9355.27"/>
</g>
<!-- layer_12_attn_out_gpu14&#45;&gt;layer_12_attn_allreduce -->
<g id="edge861" class="edge">
<title>layer_12_attn_out_gpu14&#45;&gt;layer_12_attn_allreduce</title>
<path fill="none" stroke="black" d="M13795.44,-9405.19C13782.59,-9402.59 13769.45,-9400.03 13757,-9397.76 13657.55,-9379.69 13543.57,-9362.39 13462.78,-9350.71"/>
<polygon fill="black" stroke="black" points="13463,-9347.2 13452.6,-9349.24 13462,-9354.13 13463,-9347.2"/>
</g>
<!-- layer_12_attn_out_gpu15&#45;&gt;layer_12_attn_allreduce -->
<g id="edge862" class="edge">
<title>layer_12_attn_out_gpu15&#45;&gt;layer_12_attn_allreduce</title>
<path fill="none" stroke="black" d="M14015.18,-9405.23C14000.82,-9402.48 13986.01,-9399.87 13972,-9397.76 13799.5,-9371.83 13598.1,-9353.89 13474.05,-9344.24"/>
<polygon fill="black" stroke="black" points="13474.02,-9340.73 13463.78,-9343.45 13473.48,-9347.71 13474.02,-9340.73"/>
</g>
<!-- layer_12_residual1 -->
<g id="node688" class="node">
<title>layer_12_residual1</title>
<polygon fill="lightyellow" stroke="black" points="13494.78,-9272.02 13275.6,-9272.02 13219.22,-9196.02 13438.4,-9196.02 13494.78,-9272.02"/>
<text text-anchor="middle" x="13357" y="-9237.82" font-family="Times,serif" font-size="14.00">Residual Add 12</text>
<text text-anchor="middle" x="13357" y="-9222.82" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_12_attn_allreduce&#45;&gt;layer_12_residual1 -->
<g id="edge863" class="edge">
<title>layer_12_attn_allreduce&#45;&gt;layer_12_residual1</title>
<path fill="none" stroke="black" d="M13357,-9307.92C13357,-9300.1 13357,-9291.27 13357,-9282.52"/>
<polygon fill="black" stroke="black" points="13360.5,-9282.35 13357,-9272.35 13353.5,-9282.35 13360.5,-9282.35"/>
</g>
<!-- layer_12_ln1 -->
<g id="node689" class="node">
<title>layer_12_ln1</title>
<polygon fill="lightblue" stroke="black" points="13417,-9141.02 13297,-9141.02 13297,-9103.02 13417,-9103.02 13417,-9141.02"/>
<text text-anchor="middle" x="13357" y="-9125.82" font-family="Times,serif" font-size="14.00">LayerNorm 12</text>
<text text-anchor="middle" x="13357" y="-9110.82" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_12_residual1&#45;&gt;layer_12_ln1 -->
<g id="edge864" class="edge">
<title>layer_12_residual1&#45;&gt;layer_12_ln1</title>
<path fill="none" stroke="black" d="M13357,-9195.78C13357,-9181.22 13357,-9164.81 13357,-9151.26"/>
<polygon fill="black" stroke="black" points="13360.5,-9151.09 13357,-9141.09 13353.5,-9151.09 13360.5,-9151.09"/>
</g>
<!-- layer_12_mlp1_gpu8 -->
<g id="node690" class="node">
<title>layer_12_mlp1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="13924,-9045.02 13798,-9045.02 13798,-8992.02 13924,-8992.02 13924,-9045.02"/>
<text text-anchor="middle" x="13861" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU8</text>
<text text-anchor="middle" x="13861" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="13861" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp1_gpu8 -->
<g id="edge865" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp1_gpu8</title>
<path fill="none" stroke="black" d="M13417.12,-9118.87C13519.5,-9114.51 13723.03,-9102.72 13789,-9076.02 13802.87,-9070.41 13816.27,-9061.28 13827.68,-9051.99"/>
<polygon fill="black" stroke="black" points="13830.27,-9054.38 13835.61,-9045.24 13825.73,-9049.05 13830.27,-9054.38"/>
</g>
<!-- layer_12_mlp1_gpu9 -->
<g id="node691" class="node">
<title>layer_12_mlp1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="13780,-9045.02 13654,-9045.02 13654,-8992.02 13780,-8992.02 13780,-9045.02"/>
<text text-anchor="middle" x="13717" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU9</text>
<text text-anchor="middle" x="13717" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="13717" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp1_gpu9 -->
<g id="edge869" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp1_gpu9</title>
<path fill="none" stroke="black" d="M13417.08,-9120.39C13477.1,-9117.79 13570.86,-9108.26 13645,-9076.02 13658.6,-9070.11 13671.86,-9061 13683.21,-9051.8"/>
<polygon fill="black" stroke="black" points="13685.73,-9054.26 13691.12,-9045.14 13681.22,-9048.91 13685.73,-9054.26"/>
</g>
<!-- layer_12_mlp1_gpu10 -->
<g id="node692" class="node">
<title>layer_12_mlp1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="13636,-9045.02 13510,-9045.02 13510,-8992.02 13636,-8992.02 13636,-9045.02"/>
<text text-anchor="middle" x="13573" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU10</text>
<text text-anchor="middle" x="13573" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="13573" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp1_gpu10 -->
<g id="edge873" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp1_gpu10</title>
<path fill="none" stroke="black" d="M13417.08,-9107.48C13443.68,-9100.18 13474.8,-9089.8 13501,-9076.02 13513.67,-9069.36 13526.35,-9060.38 13537.45,-9051.55"/>
<polygon fill="black" stroke="black" points="13539.71,-9054.22 13545.24,-9045.18 13535.28,-9048.8 13539.71,-9054.22"/>
</g>
<!-- layer_12_mlp1_gpu11 -->
<g id="node693" class="node">
<title>layer_12_mlp1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="13492,-9045.02 13366,-9045.02 13366,-8992.02 13492,-8992.02 13492,-9045.02"/>
<text text-anchor="middle" x="13429" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU11</text>
<text text-anchor="middle" x="13429" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="13429" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp1_gpu11 -->
<g id="edge877" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp1_gpu11</title>
<path fill="none" stroke="black" d="M13369.87,-9102.88C13379.59,-9089.18 13393.19,-9070 13404.91,-9053.49"/>
<polygon fill="black" stroke="black" points="13407.9,-9055.32 13410.83,-9045.14 13402.19,-9051.27 13407.9,-9055.32"/>
</g>
<!-- layer_12_mlp1_gpu12 -->
<g id="node694" class="node">
<title>layer_12_mlp1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="13348,-9045.02 13222,-9045.02 13222,-8992.02 13348,-8992.02 13348,-9045.02"/>
<text text-anchor="middle" x="13285" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU12</text>
<text text-anchor="middle" x="13285" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="13285" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp1_gpu12 -->
<g id="edge881" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp1_gpu12</title>
<path fill="none" stroke="black" d="M13344.13,-9102.88C13334.41,-9089.18 13320.81,-9070 13309.09,-9053.49"/>
<polygon fill="black" stroke="black" points="13311.81,-9051.27 13303.17,-9045.14 13306.1,-9055.32 13311.81,-9051.27"/>
</g>
<!-- layer_12_mlp1_gpu13 -->
<g id="node695" class="node">
<title>layer_12_mlp1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="13204,-9045.02 13078,-9045.02 13078,-8992.02 13204,-8992.02 13204,-9045.02"/>
<text text-anchor="middle" x="13141" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU13</text>
<text text-anchor="middle" x="13141" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="13141" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp1_gpu13 -->
<g id="edge885" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp1_gpu13</title>
<path fill="none" stroke="black" d="M13296.92,-9107.48C13270.32,-9100.18 13239.2,-9089.8 13213,-9076.02 13200.33,-9069.36 13187.65,-9060.38 13176.55,-9051.55"/>
<polygon fill="black" stroke="black" points="13178.72,-9048.8 13168.76,-9045.18 13174.29,-9054.22 13178.72,-9048.8"/>
</g>
<!-- layer_12_mlp1_gpu14 -->
<g id="node696" class="node">
<title>layer_12_mlp1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="13060,-9045.02 12934,-9045.02 12934,-8992.02 13060,-8992.02 13060,-9045.02"/>
<text text-anchor="middle" x="12997" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU14</text>
<text text-anchor="middle" x="12997" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="12997" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp1_gpu14 -->
<g id="edge889" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp1_gpu14</title>
<path fill="none" stroke="black" d="M13296.92,-9120.39C13236.9,-9117.79 13143.14,-9108.26 13069,-9076.02 13055.4,-9070.11 13042.14,-9061 13030.79,-9051.8"/>
<polygon fill="black" stroke="black" points="13032.78,-9048.91 13022.88,-9045.14 13028.27,-9054.26 13032.78,-9048.91"/>
</g>
<!-- layer_12_mlp1_gpu15 -->
<g id="node697" class="node">
<title>layer_12_mlp1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="12916,-9045.02 12790,-9045.02 12790,-8992.02 12916,-8992.02 12916,-9045.02"/>
<text text-anchor="middle" x="12853" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU15</text>
<text text-anchor="middle" x="12853" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="12853" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp1_gpu15 -->
<g id="edge893" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp1_gpu15</title>
<path fill="none" stroke="black" d="M13296.88,-9118.87C13194.5,-9114.51 12990.97,-9102.72 12925,-9076.02 12911.13,-9070.41 12897.73,-9061.28 12886.32,-9051.99"/>
<polygon fill="black" stroke="black" points="12888.27,-9049.05 12878.39,-9045.24 12883.73,-9054.38 12888.27,-9049.05"/>
</g>
<!-- layer_12_gelu_gpu8 -->
<g id="node698" class="node">
<title>layer_12_gelu_gpu8</title>
<polygon fill="lightblue" stroke="black" points="13913,-8945.52 13809,-8945.52 13809,-8907.52 13913,-8907.52 13913,-8945.52"/>
<text text-anchor="middle" x="13861" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU8</text>
<text text-anchor="middle" x="13861" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_12_mlp1_gpu8&#45;&gt;layer_12_gelu_gpu8 -->
<g id="edge866" class="edge">
<title>layer_12_mlp1_gpu8&#45;&gt;layer_12_gelu_gpu8</title>
<path fill="none" stroke="black" d="M13861,-8991.97C13861,-8980.67 13861,-8967.35 13861,-8955.75"/>
<polygon fill="black" stroke="black" points="13864.5,-8955.7 13861,-8945.7 13857.5,-8955.7 13864.5,-8955.7"/>
</g>
<!-- layer_12_gelu_gpu9 -->
<g id="node699" class="node">
<title>layer_12_gelu_gpu9</title>
<polygon fill="lightblue" stroke="black" points="13769,-8945.52 13665,-8945.52 13665,-8907.52 13769,-8907.52 13769,-8945.52"/>
<text text-anchor="middle" x="13717" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU9</text>
<text text-anchor="middle" x="13717" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_12_mlp1_gpu9&#45;&gt;layer_12_gelu_gpu9 -->
<g id="edge870" class="edge">
<title>layer_12_mlp1_gpu9&#45;&gt;layer_12_gelu_gpu9</title>
<path fill="none" stroke="black" d="M13717,-8991.97C13717,-8980.67 13717,-8967.35 13717,-8955.75"/>
<polygon fill="black" stroke="black" points="13720.5,-8955.7 13717,-8945.7 13713.5,-8955.7 13720.5,-8955.7"/>
</g>
<!-- layer_12_gelu_gpu10 -->
<g id="node700" class="node">
<title>layer_12_gelu_gpu10</title>
<polygon fill="lightblue" stroke="black" points="13629.5,-8945.52 13516.5,-8945.52 13516.5,-8907.52 13629.5,-8907.52 13629.5,-8945.52"/>
<text text-anchor="middle" x="13573" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU10</text>
<text text-anchor="middle" x="13573" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_12_mlp1_gpu10&#45;&gt;layer_12_gelu_gpu10 -->
<g id="edge874" class="edge">
<title>layer_12_mlp1_gpu10&#45;&gt;layer_12_gelu_gpu10</title>
<path fill="none" stroke="black" d="M13573,-8991.97C13573,-8980.67 13573,-8967.35 13573,-8955.75"/>
<polygon fill="black" stroke="black" points="13576.5,-8955.7 13573,-8945.7 13569.5,-8955.7 13576.5,-8955.7"/>
</g>
<!-- layer_12_gelu_gpu11 -->
<g id="node701" class="node">
<title>layer_12_gelu_gpu11</title>
<polygon fill="lightblue" stroke="black" points="13485.5,-8945.52 13372.5,-8945.52 13372.5,-8907.52 13485.5,-8907.52 13485.5,-8945.52"/>
<text text-anchor="middle" x="13429" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU11</text>
<text text-anchor="middle" x="13429" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_12_mlp1_gpu11&#45;&gt;layer_12_gelu_gpu11 -->
<g id="edge878" class="edge">
<title>layer_12_mlp1_gpu11&#45;&gt;layer_12_gelu_gpu11</title>
<path fill="none" stroke="black" d="M13429,-8991.97C13429,-8980.67 13429,-8967.35 13429,-8955.75"/>
<polygon fill="black" stroke="black" points="13432.5,-8955.7 13429,-8945.7 13425.5,-8955.7 13432.5,-8955.7"/>
</g>
<!-- layer_12_gelu_gpu12 -->
<g id="node702" class="node">
<title>layer_12_gelu_gpu12</title>
<polygon fill="lightblue" stroke="black" points="13341.5,-8945.52 13228.5,-8945.52 13228.5,-8907.52 13341.5,-8907.52 13341.5,-8945.52"/>
<text text-anchor="middle" x="13285" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU12</text>
<text text-anchor="middle" x="13285" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_12_mlp1_gpu12&#45;&gt;layer_12_gelu_gpu12 -->
<g id="edge882" class="edge">
<title>layer_12_mlp1_gpu12&#45;&gt;layer_12_gelu_gpu12</title>
<path fill="none" stroke="black" d="M13285,-8991.97C13285,-8980.67 13285,-8967.35 13285,-8955.75"/>
<polygon fill="black" stroke="black" points="13288.5,-8955.7 13285,-8945.7 13281.5,-8955.7 13288.5,-8955.7"/>
</g>
<!-- layer_12_gelu_gpu13 -->
<g id="node703" class="node">
<title>layer_12_gelu_gpu13</title>
<polygon fill="lightblue" stroke="black" points="13197.5,-8945.52 13084.5,-8945.52 13084.5,-8907.52 13197.5,-8907.52 13197.5,-8945.52"/>
<text text-anchor="middle" x="13141" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU13</text>
<text text-anchor="middle" x="13141" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_12_mlp1_gpu13&#45;&gt;layer_12_gelu_gpu13 -->
<g id="edge886" class="edge">
<title>layer_12_mlp1_gpu13&#45;&gt;layer_12_gelu_gpu13</title>
<path fill="none" stroke="black" d="M13141,-8991.97C13141,-8980.67 13141,-8967.35 13141,-8955.75"/>
<polygon fill="black" stroke="black" points="13144.5,-8955.7 13141,-8945.7 13137.5,-8955.7 13144.5,-8955.7"/>
</g>
<!-- layer_12_gelu_gpu14 -->
<g id="node704" class="node">
<title>layer_12_gelu_gpu14</title>
<polygon fill="lightblue" stroke="black" points="13053.5,-8945.52 12940.5,-8945.52 12940.5,-8907.52 13053.5,-8907.52 13053.5,-8945.52"/>
<text text-anchor="middle" x="12997" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU14</text>
<text text-anchor="middle" x="12997" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_12_mlp1_gpu14&#45;&gt;layer_12_gelu_gpu14 -->
<g id="edge890" class="edge">
<title>layer_12_mlp1_gpu14&#45;&gt;layer_12_gelu_gpu14</title>
<path fill="none" stroke="black" d="M12997,-8991.97C12997,-8980.67 12997,-8967.35 12997,-8955.75"/>
<polygon fill="black" stroke="black" points="13000.5,-8955.7 12997,-8945.7 12993.5,-8955.7 13000.5,-8955.7"/>
</g>
<!-- layer_12_gelu_gpu15 -->
<g id="node705" class="node">
<title>layer_12_gelu_gpu15</title>
<polygon fill="lightblue" stroke="black" points="12909.5,-8945.52 12796.5,-8945.52 12796.5,-8907.52 12909.5,-8907.52 12909.5,-8945.52"/>
<text text-anchor="middle" x="12853" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU15</text>
<text text-anchor="middle" x="12853" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_12_mlp1_gpu15&#45;&gt;layer_12_gelu_gpu15 -->
<g id="edge894" class="edge">
<title>layer_12_mlp1_gpu15&#45;&gt;layer_12_gelu_gpu15</title>
<path fill="none" stroke="black" d="M12853,-8991.97C12853,-8980.67 12853,-8967.35 12853,-8955.75"/>
<polygon fill="black" stroke="black" points="12856.5,-8955.7 12853,-8945.7 12849.5,-8955.7 12856.5,-8955.7"/>
</g>
<!-- layer_12_mlp2_gpu8 -->
<g id="node706" class="node">
<title>layer_12_mlp2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="13924,-8864.02 13798,-8864.02 13798,-8811.02 13924,-8811.02 13924,-8864.02"/>
<text text-anchor="middle" x="13861" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU8</text>
<text text-anchor="middle" x="13861" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="13861" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_12_gelu_gpu8&#45;&gt;layer_12_mlp2_gpu8 -->
<g id="edge867" class="edge">
<title>layer_12_gelu_gpu8&#45;&gt;layer_12_mlp2_gpu8</title>
<path fill="none" stroke="black" d="M13861,-8907.5C13861,-8897.89 13861,-8885.73 13861,-8874.31"/>
<polygon fill="black" stroke="black" points="13864.5,-8874.11 13861,-8864.11 13857.5,-8874.11 13864.5,-8874.11"/>
</g>
<!-- layer_12_mlp2_gpu9 -->
<g id="node707" class="node">
<title>layer_12_mlp2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="13780,-8864.02 13654,-8864.02 13654,-8811.02 13780,-8811.02 13780,-8864.02"/>
<text text-anchor="middle" x="13717" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU9</text>
<text text-anchor="middle" x="13717" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="13717" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_12_gelu_gpu9&#45;&gt;layer_12_mlp2_gpu9 -->
<g id="edge871" class="edge">
<title>layer_12_gelu_gpu9&#45;&gt;layer_12_mlp2_gpu9</title>
<path fill="none" stroke="black" d="M13717,-8907.5C13717,-8897.89 13717,-8885.73 13717,-8874.31"/>
<polygon fill="black" stroke="black" points="13720.5,-8874.11 13717,-8864.11 13713.5,-8874.11 13720.5,-8874.11"/>
</g>
<!-- layer_12_mlp2_gpu10 -->
<g id="node708" class="node">
<title>layer_12_mlp2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="13636,-8864.02 13510,-8864.02 13510,-8811.02 13636,-8811.02 13636,-8864.02"/>
<text text-anchor="middle" x="13573" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU10</text>
<text text-anchor="middle" x="13573" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="13573" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_12_gelu_gpu10&#45;&gt;layer_12_mlp2_gpu10 -->
<g id="edge875" class="edge">
<title>layer_12_gelu_gpu10&#45;&gt;layer_12_mlp2_gpu10</title>
<path fill="none" stroke="black" d="M13573,-8907.5C13573,-8897.89 13573,-8885.73 13573,-8874.31"/>
<polygon fill="black" stroke="black" points="13576.5,-8874.11 13573,-8864.11 13569.5,-8874.11 13576.5,-8874.11"/>
</g>
<!-- layer_12_mlp2_gpu11 -->
<g id="node709" class="node">
<title>layer_12_mlp2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="13492,-8864.02 13366,-8864.02 13366,-8811.02 13492,-8811.02 13492,-8864.02"/>
<text text-anchor="middle" x="13429" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU11</text>
<text text-anchor="middle" x="13429" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="13429" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_12_gelu_gpu11&#45;&gt;layer_12_mlp2_gpu11 -->
<g id="edge879" class="edge">
<title>layer_12_gelu_gpu11&#45;&gt;layer_12_mlp2_gpu11</title>
<path fill="none" stroke="black" d="M13429,-8907.5C13429,-8897.89 13429,-8885.73 13429,-8874.31"/>
<polygon fill="black" stroke="black" points="13432.5,-8874.11 13429,-8864.11 13425.5,-8874.11 13432.5,-8874.11"/>
</g>
<!-- layer_12_mlp2_gpu12 -->
<g id="node710" class="node">
<title>layer_12_mlp2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="13348,-8864.02 13222,-8864.02 13222,-8811.02 13348,-8811.02 13348,-8864.02"/>
<text text-anchor="middle" x="13285" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU12</text>
<text text-anchor="middle" x="13285" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="13285" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_12_gelu_gpu12&#45;&gt;layer_12_mlp2_gpu12 -->
<g id="edge883" class="edge">
<title>layer_12_gelu_gpu12&#45;&gt;layer_12_mlp2_gpu12</title>
<path fill="none" stroke="black" d="M13285,-8907.5C13285,-8897.89 13285,-8885.73 13285,-8874.31"/>
<polygon fill="black" stroke="black" points="13288.5,-8874.11 13285,-8864.11 13281.5,-8874.11 13288.5,-8874.11"/>
</g>
<!-- layer_12_mlp2_gpu13 -->
<g id="node711" class="node">
<title>layer_12_mlp2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="13204,-8864.02 13078,-8864.02 13078,-8811.02 13204,-8811.02 13204,-8864.02"/>
<text text-anchor="middle" x="13141" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU13</text>
<text text-anchor="middle" x="13141" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="13141" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_12_gelu_gpu13&#45;&gt;layer_12_mlp2_gpu13 -->
<g id="edge887" class="edge">
<title>layer_12_gelu_gpu13&#45;&gt;layer_12_mlp2_gpu13</title>
<path fill="none" stroke="black" d="M13141,-8907.5C13141,-8897.89 13141,-8885.73 13141,-8874.31"/>
<polygon fill="black" stroke="black" points="13144.5,-8874.11 13141,-8864.11 13137.5,-8874.11 13144.5,-8874.11"/>
</g>
<!-- layer_12_mlp2_gpu14 -->
<g id="node712" class="node">
<title>layer_12_mlp2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="13060,-8864.02 12934,-8864.02 12934,-8811.02 13060,-8811.02 13060,-8864.02"/>
<text text-anchor="middle" x="12997" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU14</text>
<text text-anchor="middle" x="12997" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="12997" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_12_gelu_gpu14&#45;&gt;layer_12_mlp2_gpu14 -->
<g id="edge891" class="edge">
<title>layer_12_gelu_gpu14&#45;&gt;layer_12_mlp2_gpu14</title>
<path fill="none" stroke="black" d="M12997,-8907.5C12997,-8897.89 12997,-8885.73 12997,-8874.31"/>
<polygon fill="black" stroke="black" points="13000.5,-8874.11 12997,-8864.11 12993.5,-8874.11 13000.5,-8874.11"/>
</g>
<!-- layer_12_mlp2_gpu15 -->
<g id="node713" class="node">
<title>layer_12_mlp2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="12916,-8864.02 12790,-8864.02 12790,-8811.02 12916,-8811.02 12916,-8864.02"/>
<text text-anchor="middle" x="12853" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU15</text>
<text text-anchor="middle" x="12853" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="12853" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_12_gelu_gpu15&#45;&gt;layer_12_mlp2_gpu15 -->
<g id="edge895" class="edge">
<title>layer_12_gelu_gpu15&#45;&gt;layer_12_mlp2_gpu15</title>
<path fill="none" stroke="black" d="M12853,-8907.5C12853,-8897.89 12853,-8885.73 12853,-8874.31"/>
<polygon fill="black" stroke="black" points="12856.5,-8874.11 12853,-8864.11 12849.5,-8874.11 12856.5,-8874.11"/>
</g>
<!-- layer_12_mlp_allreduce -->
<g id="node714" class="node">
<title>layer_12_mlp_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="13357" cy="-8748.15" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="13357" y="-8751.95" font-family="Times,serif" font-size="14.00">MLP AllReduce</text>
<text text-anchor="middle" x="13357" y="-8736.95" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_12_mlp2_gpu8&#45;&gt;layer_12_mlp_allreduce -->
<g id="edge868" class="edge">
<title>layer_12_mlp2_gpu8&#45;&gt;layer_12_mlp_allreduce</title>
<path fill="none" stroke="black" d="M13798,-8813.41C13794.97,-8812.56 13791.96,-8811.75 13789,-8811.02 13674.59,-8782.87 13539.77,-8766.09 13451.56,-8757.25"/>
<polygon fill="black" stroke="black" points="13451.86,-8753.77 13441.57,-8756.27 13451.18,-8760.73 13451.86,-8753.77"/>
</g>
<!-- layer_12_mlp2_gpu9&#45;&gt;layer_12_mlp_allreduce -->
<g id="edge872" class="edge">
<title>layer_12_mlp2_gpu9&#45;&gt;layer_12_mlp_allreduce</title>
<path fill="none" stroke="black" d="M13653.93,-8813.67C13650.92,-8812.74 13647.93,-8811.85 13645,-8811.02 13577.58,-8791.93 13499.82,-8775.55 13442.11,-8764.45"/>
<polygon fill="black" stroke="black" points="13442.42,-8760.94 13431.94,-8762.51 13441.1,-8767.82 13442.42,-8760.94"/>
</g>
<!-- layer_12_mlp2_gpu10&#45;&gt;layer_12_mlp_allreduce -->
<g id="edge876" class="edge">
<title>layer_12_mlp2_gpu10&#45;&gt;layer_12_mlp_allreduce</title>
<path fill="none" stroke="black" d="M13509.94,-8811.02C13481.08,-8799.34 13447,-8785.56 13418.35,-8773.97"/>
<polygon fill="black" stroke="black" points="13419.44,-8770.63 13408.86,-8770.13 13416.81,-8777.12 13419.44,-8770.63"/>
</g>
<!-- layer_12_mlp2_gpu11&#45;&gt;layer_12_mlp_allreduce -->
<g id="edge880" class="edge">
<title>layer_12_mlp2_gpu11&#45;&gt;layer_12_mlp_allreduce</title>
<path fill="none" stroke="black" d="M13407.79,-8810.78C13400.4,-8801.82 13392,-8791.63 13384.2,-8782.16"/>
<polygon fill="black" stroke="black" points="13386.87,-8779.9 13377.81,-8774.41 13381.47,-8784.35 13386.87,-8779.9"/>
</g>
<!-- layer_12_mlp2_gpu12&#45;&gt;layer_12_mlp_allreduce -->
<g id="edge884" class="edge">
<title>layer_12_mlp2_gpu12&#45;&gt;layer_12_mlp_allreduce</title>
<path fill="none" stroke="black" d="M13306.21,-8810.78C13313.6,-8801.82 13322,-8791.63 13329.8,-8782.16"/>
<polygon fill="black" stroke="black" points="13332.53,-8784.35 13336.19,-8774.41 13327.13,-8779.9 13332.53,-8784.35"/>
</g>
<!-- layer_12_mlp2_gpu13&#45;&gt;layer_12_mlp_allreduce -->
<g id="edge888" class="edge">
<title>layer_12_mlp2_gpu13&#45;&gt;layer_12_mlp_allreduce</title>
<path fill="none" stroke="black" d="M13204.06,-8811.02C13232.92,-8799.34 13267,-8785.56 13295.65,-8773.97"/>
<polygon fill="black" stroke="black" points="13297.19,-8777.12 13305.14,-8770.13 13294.56,-8770.63 13297.19,-8777.12"/>
</g>
<!-- layer_12_mlp2_gpu14&#45;&gt;layer_12_mlp_allreduce -->
<g id="edge892" class="edge">
<title>layer_12_mlp2_gpu14&#45;&gt;layer_12_mlp_allreduce</title>
<path fill="none" stroke="black" d="M13060.07,-8813.67C13063.08,-8812.74 13066.07,-8811.85 13069,-8811.02 13136.42,-8791.93 13214.18,-8775.55 13271.89,-8764.45"/>
<polygon fill="black" stroke="black" points="13272.9,-8767.82 13282.06,-8762.51 13271.58,-8760.94 13272.9,-8767.82"/>
</g>
<!-- layer_12_mlp2_gpu15&#45;&gt;layer_12_mlp_allreduce -->
<g id="edge896" class="edge">
<title>layer_12_mlp2_gpu15&#45;&gt;layer_12_mlp_allreduce</title>
<path fill="none" stroke="black" d="M12916,-8813.41C12919.03,-8812.56 12922.04,-8811.75 12925,-8811.02 13039.41,-8782.87 13174.23,-8766.09 13262.44,-8757.25"/>
<polygon fill="black" stroke="black" points="13262.82,-8760.73 13272.43,-8756.27 13262.14,-8753.77 13262.82,-8760.73"/>
</g>
<!-- layer_12_residual2 -->
<g id="node715" class="node">
<title>layer_12_residual2</title>
<polygon fill="lightyellow" stroke="black" points="13494.78,-8685.28 13275.6,-8685.28 13219.22,-8609.28 13438.4,-8609.28 13494.78,-8685.28"/>
<text text-anchor="middle" x="13357" y="-8651.08" font-family="Times,serif" font-size="14.00">Residual Add 12</text>
<text text-anchor="middle" x="13357" y="-8636.08" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_12_mlp_allreduce&#45;&gt;layer_12_residual2 -->
<g id="edge897" class="edge">
<title>layer_12_mlp_allreduce&#45;&gt;layer_12_residual2</title>
<path fill="none" stroke="black" d="M13357,-8721.18C13357,-8713.36 13357,-8704.53 13357,-8695.78"/>
<polygon fill="black" stroke="black" points="13360.5,-8695.61 13357,-8685.61 13353.5,-8695.61 13360.5,-8695.61"/>
</g>
<!-- layer_12_ln2 -->
<g id="node716" class="node">
<title>layer_12_ln2</title>
<polygon fill="lightblue" stroke="black" points="13417,-8554.28 13297,-8554.28 13297,-8516.28 13417,-8516.28 13417,-8554.28"/>
<text text-anchor="middle" x="13357" y="-8539.08" font-family="Times,serif" font-size="14.00">LayerNorm 12</text>
<text text-anchor="middle" x="13357" y="-8524.08" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_12_residual2&#45;&gt;layer_12_ln2 -->
<g id="edge898" class="edge">
<title>layer_12_residual2&#45;&gt;layer_12_ln2</title>
<path fill="none" stroke="black" d="M13357,-8609.04C13357,-8594.48 13357,-8578.07 13357,-8564.52"/>
<polygon fill="black" stroke="black" points="13360.5,-8564.35 13357,-8554.35 13353.5,-8564.35 13360.5,-8564.35"/>
</g>
<!-- layer_13_qkv_gpu0 -->
<g id="node889" class="node">
<title>layer_13_qkv_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="13501.69,-8411.28 13271.52,-8411.28 13212.31,-8375.28 13442.48,-8375.28 13501.69,-8411.28"/>
<text text-anchor="middle" x="13357" y="-8389.58" font-family="Times,serif" font-size="14.00">layer_13_qkv_gpu0</text>
</g>
<!-- layer_12_ln2&#45;&gt;layer_13_qkv_gpu0 -->
<g id="edge899" class="edge">
<title>layer_12_ln2&#45;&gt;layer_13_qkv_gpu0</title>
<path fill="none" stroke="black" d="M13357,-8516.27C13357,-8492.27 13357,-8449.62 13357,-8421.64"/>
<polygon fill="black" stroke="black" points="13360.5,-8421.35 13357,-8411.35 13353.5,-8421.35 13360.5,-8421.35"/>
</g>
<!-- layer_13_qkv_gpu8 -->
<g id="node717" class="node">
<title>layer_13_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="15748,-9763.37 15620,-9763.37 15620,-9710.37 15748,-9710.37 15748,-9763.37"/>
<text text-anchor="middle" x="15684" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU8</text>
<text text-anchor="middle" x="15684" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="15684" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_13_qkv_comm -->
<g id="node725" class="node">
<title>layer_13_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="15155" cy="-9603.37" rx="85.62" ry="26.74"/>
<text text-anchor="middle" x="15155" y="-9607.17" font-family="Times,serif" font-size="14.00">QKV AllGather</text>
<text text-anchor="middle" x="15155" y="-9592.17" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_13_qkv_gpu8&#45;&gt;layer_13_qkv_comm -->
<g id="edge900" class="edge">
<title>layer_13_qkv_gpu8&#45;&gt;layer_13_qkv_comm</title>
<path fill="none" stroke="black" d="M15663.05,-9710.1C15649.73,-9695.56 15631.22,-9678.43 15611,-9668.87 15548.46,-9639.31 15362.15,-9620.25 15247.95,-9610.99"/>
<polygon fill="black" stroke="black" points="15248.06,-9607.49 15237.81,-9610.18 15247.5,-9614.47 15248.06,-9607.49"/>
</g>
<!-- layer_13_qkv_gpu9 -->
<g id="node718" class="node">
<title>layer_13_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="15602,-9763.37 15474,-9763.37 15474,-9710.37 15602,-9710.37 15602,-9763.37"/>
<text text-anchor="middle" x="15538" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU9</text>
<text text-anchor="middle" x="15538" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="15538" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_13_qkv_gpu9&#45;&gt;layer_13_qkv_comm -->
<g id="edge901" class="edge">
<title>layer_13_qkv_gpu9&#45;&gt;layer_13_qkv_comm</title>
<path fill="none" stroke="black" d="M15516.51,-9710.24C15503.13,-9695.93 15484.75,-9679 15465,-9668.87 15397.33,-9634.17 15312.26,-9618.14 15248.36,-9610.73"/>
<polygon fill="black" stroke="black" points="15248.62,-9607.24 15238.3,-9609.61 15247.85,-9614.2 15248.62,-9607.24"/>
</g>
<!-- layer_13_qkv_gpu10 -->
<g id="node719" class="node">
<title>layer_13_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="15455.5,-9763.37 15318.5,-9763.37 15318.5,-9710.37 15455.5,-9710.37 15455.5,-9763.37"/>
<text text-anchor="middle" x="15387" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU10</text>
<text text-anchor="middle" x="15387" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="15387" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_13_qkv_gpu10&#45;&gt;layer_13_qkv_comm -->
<g id="edge902" class="edge">
<title>layer_13_qkv_gpu10&#45;&gt;layer_13_qkv_comm</title>
<path fill="none" stroke="black" d="M15361.93,-9710.37C15347.62,-9696.8 15328.82,-9680.55 15310,-9668.87 15282.74,-9651.96 15250.27,-9637.67 15222.11,-9626.87"/>
<polygon fill="black" stroke="black" points="15223.33,-9623.59 15212.74,-9623.35 15220.86,-9630.14 15223.33,-9623.59"/>
</g>
<!-- layer_13_qkv_gpu11 -->
<g id="node720" class="node">
<title>layer_13_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="15300.5,-9763.37 15163.5,-9763.37 15163.5,-9710.37 15300.5,-9710.37 15300.5,-9763.37"/>
<text text-anchor="middle" x="15232" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU11</text>
<text text-anchor="middle" x="15232" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="15232" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_13_qkv_gpu11&#45;&gt;layer_13_qkv_comm -->
<g id="edge903" class="edge">
<title>layer_13_qkv_gpu11&#45;&gt;layer_13_qkv_comm</title>
<path fill="none" stroke="black" d="M15216.97,-9710.21C15205.05,-9689.84 15188.26,-9661.18 15175.17,-9638.82"/>
<polygon fill="black" stroke="black" points="15178.06,-9636.84 15169.99,-9629.97 15172.02,-9640.37 15178.06,-9636.84"/>
</g>
<!-- layer_13_qkv_gpu12 -->
<g id="node721" class="node">
<title>layer_13_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="15145.5,-9763.37 15008.5,-9763.37 15008.5,-9710.37 15145.5,-9710.37 15145.5,-9763.37"/>
<text text-anchor="middle" x="15077" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU12</text>
<text text-anchor="middle" x="15077" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="15077" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_13_qkv_gpu12&#45;&gt;layer_13_qkv_comm -->
<g id="edge904" class="edge">
<title>layer_13_qkv_gpu12&#45;&gt;layer_13_qkv_comm</title>
<path fill="none" stroke="black" d="M15092.22,-9710.21C15104.3,-9689.84 15121.3,-9661.18 15134.57,-9638.82"/>
<polygon fill="black" stroke="black" points="15137.72,-9640.36 15139.81,-9629.97 15131.7,-9636.79 15137.72,-9640.36"/>
</g>
<!-- layer_13_qkv_gpu13 -->
<g id="node722" class="node">
<title>layer_13_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="14990.5,-9763.37 14853.5,-9763.37 14853.5,-9710.37 14990.5,-9710.37 14990.5,-9763.37"/>
<text text-anchor="middle" x="14922" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU13</text>
<text text-anchor="middle" x="14922" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="14922" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_13_qkv_gpu13&#45;&gt;layer_13_qkv_comm -->
<g id="edge905" class="edge">
<title>layer_13_qkv_gpu13&#45;&gt;layer_13_qkv_comm</title>
<path fill="none" stroke="black" d="M14947.79,-9710.06C14962.26,-9696.56 14981.15,-9680.48 15000,-9668.87 15027.31,-9652.05 15059.79,-9637.77 15087.94,-9626.96"/>
<polygon fill="black" stroke="black" points="15089.19,-9630.23 15097.31,-9623.43 15086.72,-9623.68 15089.19,-9630.23"/>
</g>
<!-- layer_13_qkv_gpu14 -->
<g id="node723" class="node">
<title>layer_13_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="14835.5,-9763.37 14698.5,-9763.37 14698.5,-9710.37 14835.5,-9710.37 14835.5,-9763.37"/>
<text text-anchor="middle" x="14767" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU14</text>
<text text-anchor="middle" x="14767" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="14767" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_13_qkv_gpu14&#45;&gt;layer_13_qkv_comm -->
<g id="edge906" class="edge">
<title>layer_13_qkv_gpu14&#45;&gt;layer_13_qkv_comm</title>
<path fill="none" stroke="black" d="M14790.29,-9710.27C14804.69,-9695.98 14824.34,-9679.04 14845,-9668.87 14913.23,-9635.29 14998.26,-9619.16 15061.99,-9611.44"/>
<polygon fill="black" stroke="black" points="15062.5,-9614.9 15072.03,-9610.27 15061.69,-9607.95 15062.5,-9614.9"/>
</g>
<!-- layer_13_qkv_gpu15 -->
<g id="node724" class="node">
<title>layer_13_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="14680.5,-9763.37 14543.5,-9763.37 14543.5,-9710.37 14680.5,-9710.37 14680.5,-9763.37"/>
<text text-anchor="middle" x="14612" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU15</text>
<text text-anchor="middle" x="14612" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="14612" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_13_qkv_gpu15&#45;&gt;layer_13_qkv_comm -->
<g id="edge907" class="edge">
<title>layer_13_qkv_gpu15&#45;&gt;layer_13_qkv_comm</title>
<path fill="none" stroke="black" d="M14634.71,-9710.09C14649.06,-9695.54 14668.85,-9678.42 14690,-9668.87 14754.54,-9639.76 14945.69,-9620.45 15061.84,-9611.05"/>
<polygon fill="black" stroke="black" points="15062.46,-9614.51 15072.15,-9610.23 15061.9,-9607.54 15062.46,-9614.51"/>
</g>
<!-- layer_13_attn_comp_gpu8 -->
<g id="node726" class="node">
<title>layer_13_attn_comp_gpu8</title>
<polygon fill="lightblue" stroke="black" points="14480,-9540.13 14282,-9540.13 14282,-9487.13 14480,-9487.13 14480,-9540.13"/>
<text text-anchor="middle" x="14381" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU8</text>
<text text-anchor="middle" x="14381" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="14381" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_13_qkv_comm&#45;&gt;layer_13_attn_comp_gpu8 -->
<g id="edge908" class="edge">
<title>layer_13_qkv_comm&#45;&gt;layer_13_attn_comp_gpu8</title>
<path fill="none" stroke="black" d="M15070.66,-9598.4C14945.76,-9591.65 14704.21,-9575.34 14490.22,-9540.61"/>
<polygon fill="black" stroke="black" points="14490.49,-9537.1 14480.05,-9538.94 14489.36,-9544.01 14490.49,-9537.1"/>
</g>
<!-- layer_13_attn_comp_gpu9 -->
<g id="node727" class="node">
<title>layer_13_attn_comp_gpu9</title>
<polygon fill="lightblue" stroke="black" points="14696,-9540.13 14498,-9540.13 14498,-9487.13 14696,-9487.13 14696,-9540.13"/>
<text text-anchor="middle" x="14597" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU9</text>
<text text-anchor="middle" x="14597" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="14597" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_13_qkv_comm&#45;&gt;layer_13_attn_comp_gpu9 -->
<g id="edge909" class="edge">
<title>layer_13_qkv_comm&#45;&gt;layer_13_attn_comp_gpu9</title>
<path fill="none" stroke="black" d="M15075.14,-9593.72C14985.07,-9583.41 14834.39,-9564.53 14706,-9540.5 14705.9,-9540.48 14705.8,-9540.46 14705.7,-9540.45"/>
<polygon fill="black" stroke="black" points="14706.61,-9537.06 14696.12,-9538.59 14705.27,-9543.93 14706.61,-9537.06"/>
</g>
<!-- layer_13_attn_comp_gpu10 -->
<g id="node728" class="node">
<title>layer_13_attn_comp_gpu10</title>
<polygon fill="lightblue" stroke="black" points="14921.5,-9540.13 14714.5,-9540.13 14714.5,-9487.13 14921.5,-9487.13 14921.5,-9540.13"/>
<text text-anchor="middle" x="14818" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU10</text>
<text text-anchor="middle" x="14818" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="14818" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_13_qkv_comm&#45;&gt;layer_13_attn_comp_gpu10 -->
<g id="edge910" class="edge">
<title>layer_13_qkv_comm&#45;&gt;layer_13_attn_comp_gpu10</title>
<path fill="none" stroke="black" d="M15090.42,-9585.56C15044,-9573.47 14980.32,-9556.89 14926.2,-9542.8"/>
<polygon fill="black" stroke="black" points="14926.77,-9539.33 14916.21,-9540.2 14925,-9546.11 14926.77,-9539.33"/>
</g>
<!-- layer_13_attn_comp_gpu11 -->
<g id="node729" class="node">
<title>layer_13_attn_comp_gpu11</title>
<polygon fill="lightblue" stroke="black" points="15146.5,-9540.13 14939.5,-9540.13 14939.5,-9487.13 15146.5,-9487.13 15146.5,-9540.13"/>
<text text-anchor="middle" x="15043" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU11</text>
<text text-anchor="middle" x="15043" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="15043" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_13_qkv_comm&#45;&gt;layer_13_attn_comp_gpu11 -->
<g id="edge911" class="edge">
<title>layer_13_qkv_comm&#45;&gt;layer_13_attn_comp_gpu11</title>
<path fill="none" stroke="black" d="M15124.1,-9578.17C15111.66,-9568.42 15097.14,-9557.04 15083.84,-9546.63"/>
<polygon fill="black" stroke="black" points="15085.79,-9543.71 15075.76,-9540.29 15081.47,-9549.22 15085.79,-9543.71"/>
</g>
<!-- layer_13_attn_comp_gpu12 -->
<g id="node730" class="node">
<title>layer_13_attn_comp_gpu12</title>
<polygon fill="lightblue" stroke="black" points="15371.5,-9540.13 15164.5,-9540.13 15164.5,-9487.13 15371.5,-9487.13 15371.5,-9540.13"/>
<text text-anchor="middle" x="15268" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU12</text>
<text text-anchor="middle" x="15268" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="15268" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_13_qkv_comm&#45;&gt;layer_13_attn_comp_gpu12 -->
<g id="edge912" class="edge">
<title>layer_13_qkv_comm&#45;&gt;layer_13_attn_comp_gpu12</title>
<path fill="none" stroke="black" d="M15186.18,-9578.17C15198.73,-9568.42 15213.38,-9557.04 15226.79,-9546.63"/>
<polygon fill="black" stroke="black" points="15229.2,-9549.19 15234.95,-9540.29 15224.91,-9543.66 15229.2,-9549.19"/>
</g>
<!-- layer_13_attn_comp_gpu13 -->
<g id="node731" class="node">
<title>layer_13_attn_comp_gpu13</title>
<polygon fill="lightblue" stroke="black" points="15596.5,-9540.13 15389.5,-9540.13 15389.5,-9487.13 15596.5,-9487.13 15596.5,-9540.13"/>
<text text-anchor="middle" x="15493" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU13</text>
<text text-anchor="middle" x="15493" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="15493" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_13_qkv_comm&#45;&gt;layer_13_attn_comp_gpu13 -->
<g id="edge913" class="edge">
<title>layer_13_qkv_comm&#45;&gt;layer_13_attn_comp_gpu13</title>
<path fill="none" stroke="black" d="M15219.37,-9585.66C15266.08,-9573.54 15330.37,-9556.85 15384.89,-9542.7"/>
<polygon fill="black" stroke="black" points="15385.8,-9546.08 15394.6,-9540.18 15384.04,-9539.3 15385.8,-9546.08"/>
</g>
<!-- layer_13_attn_comp_gpu14 -->
<g id="node732" class="node">
<title>layer_13_attn_comp_gpu14</title>
<polygon fill="lightblue" stroke="black" points="15821.5,-9540.13 15614.5,-9540.13 15614.5,-9487.13 15821.5,-9487.13 15821.5,-9540.13"/>
<text text-anchor="middle" x="15718" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU14</text>
<text text-anchor="middle" x="15718" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="15718" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_13_qkv_comm&#45;&gt;layer_13_attn_comp_gpu14 -->
<g id="edge914" class="edge">
<title>layer_13_qkv_comm&#45;&gt;layer_13_attn_comp_gpu14</title>
<path fill="none" stroke="black" d="M15234.78,-9593.64C15322.98,-9583.49 15469.41,-9565.16 15604.24,-9540.77"/>
<polygon fill="black" stroke="black" points="15605.13,-9544.16 15614.34,-9538.93 15603.87,-9537.28 15605.13,-9544.16"/>
</g>
<!-- layer_13_attn_comp_gpu15 -->
<g id="node733" class="node">
<title>layer_13_attn_comp_gpu15</title>
<polygon fill="lightblue" stroke="black" points="16046.5,-9540.13 15839.5,-9540.13 15839.5,-9487.13 16046.5,-9487.13 16046.5,-9540.13"/>
<text text-anchor="middle" x="15943" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU15</text>
<text text-anchor="middle" x="15943" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="15943" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_13_qkv_comm&#45;&gt;layer_13_attn_comp_gpu15 -->
<g id="edge915" class="edge">
<title>layer_13_qkv_comm&#45;&gt;layer_13_attn_comp_gpu15</title>
<path fill="none" stroke="black" d="M15239.24,-9598.34C15365.64,-9591.48 15611.91,-9574.96 15829.36,-9540.69"/>
<polygon fill="black" stroke="black" points="15830.04,-9544.12 15839.36,-9539.09 15828.94,-9537.21 15830.04,-9544.12"/>
</g>
<!-- layer_13_attn_out_gpu8 -->
<g id="node734" class="node">
<title>layer_13_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="14496,-9450.76 14338,-9450.76 14338,-9397.76 14496,-9397.76 14496,-9450.76"/>
<text text-anchor="middle" x="14417" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU8</text>
<text text-anchor="middle" x="14417" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="14417" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_13_attn_comp_gpu8&#45;&gt;layer_13_attn_out_gpu8 -->
<g id="edge916" class="edge">
<title>layer_13_attn_comp_gpu8&#45;&gt;layer_13_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M14391.61,-9486.89C14395.05,-9478.54 14398.93,-9469.12 14402.6,-9460.21"/>
<polygon fill="black" stroke="black" points="14405.9,-9461.4 14406.47,-9450.82 14399.42,-9458.73 14405.9,-9461.4"/>
</g>
<!-- layer_13_attn_out_gpu9 -->
<g id="node735" class="node">
<title>layer_13_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="14709,-9450.76 14551,-9450.76 14551,-9397.76 14709,-9397.76 14709,-9450.76"/>
<text text-anchor="middle" x="14630" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU9</text>
<text text-anchor="middle" x="14630" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="14630" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_13_attn_comp_gpu9&#45;&gt;layer_13_attn_out_gpu9 -->
<g id="edge917" class="edge">
<title>layer_13_attn_comp_gpu9&#45;&gt;layer_13_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M14606.72,-9486.89C14609.88,-9478.54 14613.43,-9469.12 14616.8,-9460.21"/>
<polygon fill="black" stroke="black" points="14620.09,-9461.41 14620.35,-9450.82 14613.54,-9458.94 14620.09,-9461.41"/>
</g>
<!-- layer_13_attn_out_gpu10 -->
<g id="node736" class="node">
<title>layer_13_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="14926.5,-9450.76 14759.5,-9450.76 14759.5,-9397.76 14926.5,-9397.76 14926.5,-9450.76"/>
<text text-anchor="middle" x="14843" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU10</text>
<text text-anchor="middle" x="14843" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="14843" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_13_attn_comp_gpu10&#45;&gt;layer_13_attn_out_gpu10 -->
<g id="edge918" class="edge">
<title>layer_13_attn_comp_gpu10&#45;&gt;layer_13_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M14825.37,-9486.89C14827.73,-9478.63 14830.39,-9469.32 14832.92,-9460.5"/>
<polygon fill="black" stroke="black" points="14836.3,-9461.4 14835.69,-9450.82 14829.57,-9459.47 14836.3,-9461.4"/>
</g>
<!-- layer_13_attn_out_gpu11 -->
<g id="node737" class="node">
<title>layer_13_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="15136.5,-9450.76 14969.5,-9450.76 14969.5,-9397.76 15136.5,-9397.76 15136.5,-9450.76"/>
<text text-anchor="middle" x="15053" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU11</text>
<text text-anchor="middle" x="15053" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="15053" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_13_attn_comp_gpu11&#45;&gt;layer_13_attn_out_gpu11 -->
<g id="edge919" class="edge">
<title>layer_13_attn_comp_gpu11&#45;&gt;layer_13_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M15045.95,-9486.89C15046.88,-9478.72 15047.93,-9469.52 15048.93,-9460.78"/>
<polygon fill="black" stroke="black" points="15052.41,-9461.15 15050.07,-9450.82 15045.46,-9460.36 15052.41,-9461.15"/>
</g>
<!-- layer_13_attn_out_gpu12 -->
<g id="node738" class="node">
<title>layer_13_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="15341.5,-9450.76 15174.5,-9450.76 15174.5,-9397.76 15341.5,-9397.76 15341.5,-9450.76"/>
<text text-anchor="middle" x="15258" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU12</text>
<text text-anchor="middle" x="15258" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="15258" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_13_attn_comp_gpu12&#45;&gt;layer_13_attn_out_gpu12 -->
<g id="edge920" class="edge">
<title>layer_13_attn_comp_gpu12&#45;&gt;layer_13_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M15265.05,-9486.89C15264.12,-9478.72 15263.07,-9469.52 15262.07,-9460.78"/>
<polygon fill="black" stroke="black" points="15265.54,-9460.36 15260.93,-9450.82 15258.59,-9461.15 15265.54,-9460.36"/>
</g>
<!-- layer_13_attn_out_gpu13 -->
<g id="node739" class="node">
<title>layer_13_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="15556.5,-9450.76 15389.5,-9450.76 15389.5,-9397.76 15556.5,-9397.76 15556.5,-9450.76"/>
<text text-anchor="middle" x="15473" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU13</text>
<text text-anchor="middle" x="15473" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="15473" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_13_attn_comp_gpu13&#45;&gt;layer_13_attn_out_gpu13 -->
<g id="edge921" class="edge">
<title>layer_13_attn_comp_gpu13&#45;&gt;layer_13_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M15487.11,-9486.89C15485.24,-9478.72 15483.13,-9469.52 15481.13,-9460.78"/>
<polygon fill="black" stroke="black" points="15484.49,-9459.79 15478.85,-9450.82 15477.67,-9461.35 15484.49,-9459.79"/>
</g>
<!-- layer_13_attn_out_gpu14 -->
<g id="node740" class="node">
<title>layer_13_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="15776.5,-9450.76 15609.5,-9450.76 15609.5,-9397.76 15776.5,-9397.76 15776.5,-9450.76"/>
<text text-anchor="middle" x="15693" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU14</text>
<text text-anchor="middle" x="15693" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="15693" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_13_attn_comp_gpu14&#45;&gt;layer_13_attn_out_gpu14 -->
<g id="edge922" class="edge">
<title>layer_13_attn_comp_gpu14&#45;&gt;layer_13_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M15710.63,-9486.89C15708.27,-9478.63 15705.61,-9469.32 15703.08,-9460.5"/>
<polygon fill="black" stroke="black" points="15706.43,-9459.47 15700.31,-9450.82 15699.7,-9461.4 15706.43,-9459.47"/>
</g>
<!-- layer_13_attn_out_gpu15 -->
<g id="node741" class="node">
<title>layer_13_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="15998.5,-9450.76 15831.5,-9450.76 15831.5,-9397.76 15998.5,-9397.76 15998.5,-9450.76"/>
<text text-anchor="middle" x="15915" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU15</text>
<text text-anchor="middle" x="15915" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="15915" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_13_attn_comp_gpu15&#45;&gt;layer_13_attn_out_gpu15 -->
<g id="edge923" class="edge">
<title>layer_13_attn_comp_gpu15&#45;&gt;layer_13_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M15934.75,-9486.89C15932.1,-9478.63 15929.12,-9469.32 15926.29,-9460.5"/>
<polygon fill="black" stroke="black" points="15929.58,-9459.27 15923.19,-9450.82 15922.91,-9461.41 15929.58,-9459.27"/>
</g>
<!-- layer_13_attn_allreduce -->
<g id="node742" class="node">
<title>layer_13_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="15155" cy="-9334.89" rx="112.36" ry="26.74"/>
<text text-anchor="middle" x="15155" y="-9338.69" font-family="Times,serif" font-size="14.00">Attention AllReduce</text>
<text text-anchor="middle" x="15155" y="-9323.69" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_13_attn_out_gpu8&#45;&gt;layer_13_attn_allreduce -->
<g id="edge924" class="edge">
<title>layer_13_attn_out_gpu8&#45;&gt;layer_13_attn_allreduce</title>
<path fill="none" stroke="black" d="M14496.14,-9405.87C14511.31,-9402.89 14527.11,-9400.03 14542,-9397.76 14713.77,-9371.64 14914.36,-9353.76 15038.03,-9344.18"/>
<polygon fill="black" stroke="black" points="15038.58,-9347.65 15048.28,-9343.39 15038.04,-9340.67 15038.58,-9347.65"/>
</g>
<!-- layer_13_attn_out_gpu9&#45;&gt;layer_13_attn_allreduce -->
<g id="edge925" class="edge">
<title>layer_13_attn_out_gpu9&#45;&gt;layer_13_attn_allreduce</title>
<path fill="none" stroke="black" d="M14709.28,-9405.89C14723.16,-9403.04 14737.48,-9400.22 14751,-9397.76 14851.76,-9379.45 14967.32,-9362.12 15048.96,-9350.48"/>
<polygon fill="black" stroke="black" points="15049.84,-9353.89 15059.25,-9349.02 15048.85,-9346.96 15049.84,-9353.89"/>
</g>
<!-- layer_13_attn_out_gpu10&#45;&gt;layer_13_attn_allreduce -->
<g id="edge926" class="edge">
<title>layer_13_attn_out_gpu10&#45;&gt;layer_13_attn_allreduce</title>
<path fill="none" stroke="black" d="M14926.61,-9399.85C14972.35,-9387.04 15028.76,-9371.24 15074.07,-9358.55"/>
<polygon fill="black" stroke="black" points="15075.18,-9361.88 15083.86,-9355.81 15073.29,-9355.14 15075.18,-9361.88"/>
</g>
<!-- layer_13_attn_out_gpu11&#45;&gt;layer_13_attn_allreduce -->
<g id="edge927" class="edge">
<title>layer_13_attn_out_gpu11&#45;&gt;layer_13_attn_allreduce</title>
<path fill="none" stroke="black" d="M15082.78,-9397.76C15093.77,-9388.34 15106.35,-9377.56 15117.91,-9367.66"/>
<polygon fill="black" stroke="black" points="15120.4,-9370.14 15125.71,-9360.98 15115.84,-9364.83 15120.4,-9370.14"/>
</g>
<!-- layer_13_attn_out_gpu12&#45;&gt;layer_13_attn_allreduce -->
<g id="edge928" class="edge">
<title>layer_13_attn_out_gpu12&#45;&gt;layer_13_attn_allreduce</title>
<path fill="none" stroke="black" d="M15227.93,-9397.76C15216.83,-9388.34 15204.12,-9377.56 15192.45,-9367.66"/>
<polygon fill="black" stroke="black" points="15194.46,-9364.78 15184.57,-9360.98 15189.93,-9370.12 15194.46,-9364.78"/>
</g>
<!-- layer_13_attn_out_gpu13&#45;&gt;layer_13_attn_allreduce -->
<g id="edge929" class="edge">
<title>layer_13_attn_out_gpu13&#45;&gt;layer_13_attn_allreduce</title>
<path fill="none" stroke="black" d="M15389.45,-9400.31C15342.29,-9387.35 15283.6,-9371.23 15236.74,-9358.35"/>
<polygon fill="black" stroke="black" points="15237.5,-9354.93 15226.93,-9355.66 15235.65,-9361.68 15237.5,-9354.93"/>
</g>
<!-- layer_13_attn_out_gpu14&#45;&gt;layer_13_attn_allreduce -->
<g id="edge930" class="edge">
<title>layer_13_attn_out_gpu14&#45;&gt;layer_13_attn_allreduce</title>
<path fill="none" stroke="black" d="M15609.42,-9405.88C15594.97,-9403.05 15580.07,-9400.23 15566,-9397.76 15462.7,-9379.63 15344.22,-9362.14 15261.09,-9350.41"/>
<polygon fill="black" stroke="black" points="15261.52,-9346.94 15251.13,-9349.01 15260.55,-9353.87 15261.52,-9346.94"/>
</g>
<!-- layer_13_attn_out_gpu15&#45;&gt;layer_13_attn_allreduce -->
<g id="edge931" class="edge">
<title>layer_13_attn_out_gpu15&#45;&gt;layer_13_attn_allreduce</title>
<path fill="none" stroke="black" d="M15831.24,-9405.48C15816.22,-9402.64 15800.68,-9399.93 15786,-9397.76 15607.61,-9371.45 15399.15,-9353.48 15272.15,-9343.95"/>
<polygon fill="black" stroke="black" points="15272.24,-9340.44 15262.01,-9343.19 15271.72,-9347.43 15272.24,-9340.44"/>
</g>
<!-- layer_13_residual1 -->
<g id="node743" class="node">
<title>layer_13_residual1</title>
<polygon fill="lightyellow" stroke="black" points="15292.78,-9272.02 15073.6,-9272.02 15017.22,-9196.02 15236.4,-9196.02 15292.78,-9272.02"/>
<text text-anchor="middle" x="15155" y="-9237.82" font-family="Times,serif" font-size="14.00">Residual Add 13</text>
<text text-anchor="middle" x="15155" y="-9222.82" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_13_attn_allreduce&#45;&gt;layer_13_residual1 -->
<g id="edge932" class="edge">
<title>layer_13_attn_allreduce&#45;&gt;layer_13_residual1</title>
<path fill="none" stroke="black" d="M15155,-9307.92C15155,-9300.1 15155,-9291.27 15155,-9282.52"/>
<polygon fill="black" stroke="black" points="15158.5,-9282.35 15155,-9272.35 15151.5,-9282.35 15158.5,-9282.35"/>
</g>
<!-- layer_13_ln1 -->
<g id="node744" class="node">
<title>layer_13_ln1</title>
<polygon fill="lightblue" stroke="black" points="15215,-9141.02 15095,-9141.02 15095,-9103.02 15215,-9103.02 15215,-9141.02"/>
<text text-anchor="middle" x="15155" y="-9125.82" font-family="Times,serif" font-size="14.00">LayerNorm 13</text>
<text text-anchor="middle" x="15155" y="-9110.82" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_13_residual1&#45;&gt;layer_13_ln1 -->
<g id="edge933" class="edge">
<title>layer_13_residual1&#45;&gt;layer_13_ln1</title>
<path fill="none" stroke="black" d="M15155,-9195.78C15155,-9181.22 15155,-9164.81 15155,-9151.26"/>
<polygon fill="black" stroke="black" points="15158.5,-9151.09 15155,-9141.09 15151.5,-9151.09 15158.5,-9151.09"/>
</g>
<!-- layer_13_mlp1_gpu8 -->
<g id="node745" class="node">
<title>layer_13_mlp1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="15722,-9045.02 15596,-9045.02 15596,-8992.02 15722,-8992.02 15722,-9045.02"/>
<text text-anchor="middle" x="15659" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU8</text>
<text text-anchor="middle" x="15659" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="15659" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp1_gpu8 -->
<g id="edge934" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp1_gpu8</title>
<path fill="none" stroke="black" d="M15215.12,-9118.87C15317.5,-9114.51 15521.03,-9102.72 15587,-9076.02 15600.87,-9070.41 15614.27,-9061.28 15625.68,-9051.99"/>
<polygon fill="black" stroke="black" points="15628.27,-9054.38 15633.61,-9045.24 15623.73,-9049.05 15628.27,-9054.38"/>
</g>
<!-- layer_13_mlp1_gpu9 -->
<g id="node746" class="node">
<title>layer_13_mlp1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="15578,-9045.02 15452,-9045.02 15452,-8992.02 15578,-8992.02 15578,-9045.02"/>
<text text-anchor="middle" x="15515" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU9</text>
<text text-anchor="middle" x="15515" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="15515" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp1_gpu9 -->
<g id="edge938" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp1_gpu9</title>
<path fill="none" stroke="black" d="M15215.08,-9120.39C15275.1,-9117.79 15368.86,-9108.26 15443,-9076.02 15456.6,-9070.11 15469.86,-9061 15481.21,-9051.8"/>
<polygon fill="black" stroke="black" points="15483.73,-9054.26 15489.12,-9045.14 15479.22,-9048.91 15483.73,-9054.26"/>
</g>
<!-- layer_13_mlp1_gpu10 -->
<g id="node747" class="node">
<title>layer_13_mlp1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="15434,-9045.02 15308,-9045.02 15308,-8992.02 15434,-8992.02 15434,-9045.02"/>
<text text-anchor="middle" x="15371" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU10</text>
<text text-anchor="middle" x="15371" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="15371" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp1_gpu10 -->
<g id="edge942" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp1_gpu10</title>
<path fill="none" stroke="black" d="M15215.08,-9107.48C15241.68,-9100.18 15272.8,-9089.8 15299,-9076.02 15311.67,-9069.36 15324.35,-9060.38 15335.45,-9051.55"/>
<polygon fill="black" stroke="black" points="15337.71,-9054.22 15343.24,-9045.18 15333.28,-9048.8 15337.71,-9054.22"/>
</g>
<!-- layer_13_mlp1_gpu11 -->
<g id="node748" class="node">
<title>layer_13_mlp1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="15290,-9045.02 15164,-9045.02 15164,-8992.02 15290,-8992.02 15290,-9045.02"/>
<text text-anchor="middle" x="15227" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU11</text>
<text text-anchor="middle" x="15227" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="15227" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp1_gpu11 -->
<g id="edge946" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp1_gpu11</title>
<path fill="none" stroke="black" d="M15167.87,-9102.88C15177.59,-9089.18 15191.19,-9070 15202.91,-9053.49"/>
<polygon fill="black" stroke="black" points="15205.9,-9055.32 15208.83,-9045.14 15200.19,-9051.27 15205.9,-9055.32"/>
</g>
<!-- layer_13_mlp1_gpu12 -->
<g id="node749" class="node">
<title>layer_13_mlp1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="15146,-9045.02 15020,-9045.02 15020,-8992.02 15146,-8992.02 15146,-9045.02"/>
<text text-anchor="middle" x="15083" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU12</text>
<text text-anchor="middle" x="15083" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="15083" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp1_gpu12 -->
<g id="edge950" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp1_gpu12</title>
<path fill="none" stroke="black" d="M15142.13,-9102.88C15132.41,-9089.18 15118.81,-9070 15107.09,-9053.49"/>
<polygon fill="black" stroke="black" points="15109.81,-9051.27 15101.17,-9045.14 15104.1,-9055.32 15109.81,-9051.27"/>
</g>
<!-- layer_13_mlp1_gpu13 -->
<g id="node750" class="node">
<title>layer_13_mlp1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="15002,-9045.02 14876,-9045.02 14876,-8992.02 15002,-8992.02 15002,-9045.02"/>
<text text-anchor="middle" x="14939" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU13</text>
<text text-anchor="middle" x="14939" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="14939" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp1_gpu13 -->
<g id="edge954" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp1_gpu13</title>
<path fill="none" stroke="black" d="M15094.92,-9107.48C15068.32,-9100.18 15037.2,-9089.8 15011,-9076.02 14998.33,-9069.36 14985.65,-9060.38 14974.55,-9051.55"/>
<polygon fill="black" stroke="black" points="14976.72,-9048.8 14966.76,-9045.18 14972.29,-9054.22 14976.72,-9048.8"/>
</g>
<!-- layer_13_mlp1_gpu14 -->
<g id="node751" class="node">
<title>layer_13_mlp1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="14858,-9045.02 14732,-9045.02 14732,-8992.02 14858,-8992.02 14858,-9045.02"/>
<text text-anchor="middle" x="14795" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU14</text>
<text text-anchor="middle" x="14795" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="14795" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp1_gpu14 -->
<g id="edge958" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp1_gpu14</title>
<path fill="none" stroke="black" d="M15094.92,-9120.39C15034.9,-9117.79 14941.14,-9108.26 14867,-9076.02 14853.4,-9070.11 14840.14,-9061 14828.79,-9051.8"/>
<polygon fill="black" stroke="black" points="14830.78,-9048.91 14820.88,-9045.14 14826.27,-9054.26 14830.78,-9048.91"/>
</g>
<!-- layer_13_mlp1_gpu15 -->
<g id="node752" class="node">
<title>layer_13_mlp1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="14714,-9045.02 14588,-9045.02 14588,-8992.02 14714,-8992.02 14714,-9045.02"/>
<text text-anchor="middle" x="14651" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU15</text>
<text text-anchor="middle" x="14651" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="14651" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp1_gpu15 -->
<g id="edge962" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp1_gpu15</title>
<path fill="none" stroke="black" d="M15094.88,-9118.87C14992.5,-9114.51 14788.97,-9102.72 14723,-9076.02 14709.13,-9070.41 14695.73,-9061.28 14684.32,-9051.99"/>
<polygon fill="black" stroke="black" points="14686.27,-9049.05 14676.39,-9045.24 14681.73,-9054.38 14686.27,-9049.05"/>
</g>
<!-- layer_13_gelu_gpu8 -->
<g id="node753" class="node">
<title>layer_13_gelu_gpu8</title>
<polygon fill="lightblue" stroke="black" points="15711,-8945.52 15607,-8945.52 15607,-8907.52 15711,-8907.52 15711,-8945.52"/>
<text text-anchor="middle" x="15659" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU8</text>
<text text-anchor="middle" x="15659" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_13_mlp1_gpu8&#45;&gt;layer_13_gelu_gpu8 -->
<g id="edge935" class="edge">
<title>layer_13_mlp1_gpu8&#45;&gt;layer_13_gelu_gpu8</title>
<path fill="none" stroke="black" d="M15659,-8991.97C15659,-8980.67 15659,-8967.35 15659,-8955.75"/>
<polygon fill="black" stroke="black" points="15662.5,-8955.7 15659,-8945.7 15655.5,-8955.7 15662.5,-8955.7"/>
</g>
<!-- layer_13_gelu_gpu9 -->
<g id="node754" class="node">
<title>layer_13_gelu_gpu9</title>
<polygon fill="lightblue" stroke="black" points="15567,-8945.52 15463,-8945.52 15463,-8907.52 15567,-8907.52 15567,-8945.52"/>
<text text-anchor="middle" x="15515" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU9</text>
<text text-anchor="middle" x="15515" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_13_mlp1_gpu9&#45;&gt;layer_13_gelu_gpu9 -->
<g id="edge939" class="edge">
<title>layer_13_mlp1_gpu9&#45;&gt;layer_13_gelu_gpu9</title>
<path fill="none" stroke="black" d="M15515,-8991.97C15515,-8980.67 15515,-8967.35 15515,-8955.75"/>
<polygon fill="black" stroke="black" points="15518.5,-8955.7 15515,-8945.7 15511.5,-8955.7 15518.5,-8955.7"/>
</g>
<!-- layer_13_gelu_gpu10 -->
<g id="node755" class="node">
<title>layer_13_gelu_gpu10</title>
<polygon fill="lightblue" stroke="black" points="15427.5,-8945.52 15314.5,-8945.52 15314.5,-8907.52 15427.5,-8907.52 15427.5,-8945.52"/>
<text text-anchor="middle" x="15371" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU10</text>
<text text-anchor="middle" x="15371" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_13_mlp1_gpu10&#45;&gt;layer_13_gelu_gpu10 -->
<g id="edge943" class="edge">
<title>layer_13_mlp1_gpu10&#45;&gt;layer_13_gelu_gpu10</title>
<path fill="none" stroke="black" d="M15371,-8991.97C15371,-8980.67 15371,-8967.35 15371,-8955.75"/>
<polygon fill="black" stroke="black" points="15374.5,-8955.7 15371,-8945.7 15367.5,-8955.7 15374.5,-8955.7"/>
</g>
<!-- layer_13_gelu_gpu11 -->
<g id="node756" class="node">
<title>layer_13_gelu_gpu11</title>
<polygon fill="lightblue" stroke="black" points="15283.5,-8945.52 15170.5,-8945.52 15170.5,-8907.52 15283.5,-8907.52 15283.5,-8945.52"/>
<text text-anchor="middle" x="15227" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU11</text>
<text text-anchor="middle" x="15227" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_13_mlp1_gpu11&#45;&gt;layer_13_gelu_gpu11 -->
<g id="edge947" class="edge">
<title>layer_13_mlp1_gpu11&#45;&gt;layer_13_gelu_gpu11</title>
<path fill="none" stroke="black" d="M15227,-8991.97C15227,-8980.67 15227,-8967.35 15227,-8955.75"/>
<polygon fill="black" stroke="black" points="15230.5,-8955.7 15227,-8945.7 15223.5,-8955.7 15230.5,-8955.7"/>
</g>
<!-- layer_13_gelu_gpu12 -->
<g id="node757" class="node">
<title>layer_13_gelu_gpu12</title>
<polygon fill="lightblue" stroke="black" points="15139.5,-8945.52 15026.5,-8945.52 15026.5,-8907.52 15139.5,-8907.52 15139.5,-8945.52"/>
<text text-anchor="middle" x="15083" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU12</text>
<text text-anchor="middle" x="15083" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_13_mlp1_gpu12&#45;&gt;layer_13_gelu_gpu12 -->
<g id="edge951" class="edge">
<title>layer_13_mlp1_gpu12&#45;&gt;layer_13_gelu_gpu12</title>
<path fill="none" stroke="black" d="M15083,-8991.97C15083,-8980.67 15083,-8967.35 15083,-8955.75"/>
<polygon fill="black" stroke="black" points="15086.5,-8955.7 15083,-8945.7 15079.5,-8955.7 15086.5,-8955.7"/>
</g>
<!-- layer_13_gelu_gpu13 -->
<g id="node758" class="node">
<title>layer_13_gelu_gpu13</title>
<polygon fill="lightblue" stroke="black" points="14995.5,-8945.52 14882.5,-8945.52 14882.5,-8907.52 14995.5,-8907.52 14995.5,-8945.52"/>
<text text-anchor="middle" x="14939" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU13</text>
<text text-anchor="middle" x="14939" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_13_mlp1_gpu13&#45;&gt;layer_13_gelu_gpu13 -->
<g id="edge955" class="edge">
<title>layer_13_mlp1_gpu13&#45;&gt;layer_13_gelu_gpu13</title>
<path fill="none" stroke="black" d="M14939,-8991.97C14939,-8980.67 14939,-8967.35 14939,-8955.75"/>
<polygon fill="black" stroke="black" points="14942.5,-8955.7 14939,-8945.7 14935.5,-8955.7 14942.5,-8955.7"/>
</g>
<!-- layer_13_gelu_gpu14 -->
<g id="node759" class="node">
<title>layer_13_gelu_gpu14</title>
<polygon fill="lightblue" stroke="black" points="14851.5,-8945.52 14738.5,-8945.52 14738.5,-8907.52 14851.5,-8907.52 14851.5,-8945.52"/>
<text text-anchor="middle" x="14795" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU14</text>
<text text-anchor="middle" x="14795" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_13_mlp1_gpu14&#45;&gt;layer_13_gelu_gpu14 -->
<g id="edge959" class="edge">
<title>layer_13_mlp1_gpu14&#45;&gt;layer_13_gelu_gpu14</title>
<path fill="none" stroke="black" d="M14795,-8991.97C14795,-8980.67 14795,-8967.35 14795,-8955.75"/>
<polygon fill="black" stroke="black" points="14798.5,-8955.7 14795,-8945.7 14791.5,-8955.7 14798.5,-8955.7"/>
</g>
<!-- layer_13_gelu_gpu15 -->
<g id="node760" class="node">
<title>layer_13_gelu_gpu15</title>
<polygon fill="lightblue" stroke="black" points="14707.5,-8945.52 14594.5,-8945.52 14594.5,-8907.52 14707.5,-8907.52 14707.5,-8945.52"/>
<text text-anchor="middle" x="14651" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU15</text>
<text text-anchor="middle" x="14651" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_13_mlp1_gpu15&#45;&gt;layer_13_gelu_gpu15 -->
<g id="edge963" class="edge">
<title>layer_13_mlp1_gpu15&#45;&gt;layer_13_gelu_gpu15</title>
<path fill="none" stroke="black" d="M14651,-8991.97C14651,-8980.67 14651,-8967.35 14651,-8955.75"/>
<polygon fill="black" stroke="black" points="14654.5,-8955.7 14651,-8945.7 14647.5,-8955.7 14654.5,-8955.7"/>
</g>
<!-- layer_13_mlp2_gpu8 -->
<g id="node761" class="node">
<title>layer_13_mlp2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="15722,-8864.02 15596,-8864.02 15596,-8811.02 15722,-8811.02 15722,-8864.02"/>
<text text-anchor="middle" x="15659" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU8</text>
<text text-anchor="middle" x="15659" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="15659" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_13_gelu_gpu8&#45;&gt;layer_13_mlp2_gpu8 -->
<g id="edge936" class="edge">
<title>layer_13_gelu_gpu8&#45;&gt;layer_13_mlp2_gpu8</title>
<path fill="none" stroke="black" d="M15659,-8907.5C15659,-8897.89 15659,-8885.73 15659,-8874.31"/>
<polygon fill="black" stroke="black" points="15662.5,-8874.11 15659,-8864.11 15655.5,-8874.11 15662.5,-8874.11"/>
</g>
<!-- layer_13_mlp2_gpu9 -->
<g id="node762" class="node">
<title>layer_13_mlp2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="15578,-8864.02 15452,-8864.02 15452,-8811.02 15578,-8811.02 15578,-8864.02"/>
<text text-anchor="middle" x="15515" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU9</text>
<text text-anchor="middle" x="15515" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="15515" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_13_gelu_gpu9&#45;&gt;layer_13_mlp2_gpu9 -->
<g id="edge940" class="edge">
<title>layer_13_gelu_gpu9&#45;&gt;layer_13_mlp2_gpu9</title>
<path fill="none" stroke="black" d="M15515,-8907.5C15515,-8897.89 15515,-8885.73 15515,-8874.31"/>
<polygon fill="black" stroke="black" points="15518.5,-8874.11 15515,-8864.11 15511.5,-8874.11 15518.5,-8874.11"/>
</g>
<!-- layer_13_mlp2_gpu10 -->
<g id="node763" class="node">
<title>layer_13_mlp2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="15434,-8864.02 15308,-8864.02 15308,-8811.02 15434,-8811.02 15434,-8864.02"/>
<text text-anchor="middle" x="15371" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU10</text>
<text text-anchor="middle" x="15371" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="15371" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_13_gelu_gpu10&#45;&gt;layer_13_mlp2_gpu10 -->
<g id="edge944" class="edge">
<title>layer_13_gelu_gpu10&#45;&gt;layer_13_mlp2_gpu10</title>
<path fill="none" stroke="black" d="M15371,-8907.5C15371,-8897.89 15371,-8885.73 15371,-8874.31"/>
<polygon fill="black" stroke="black" points="15374.5,-8874.11 15371,-8864.11 15367.5,-8874.11 15374.5,-8874.11"/>
</g>
<!-- layer_13_mlp2_gpu11 -->
<g id="node764" class="node">
<title>layer_13_mlp2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="15290,-8864.02 15164,-8864.02 15164,-8811.02 15290,-8811.02 15290,-8864.02"/>
<text text-anchor="middle" x="15227" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU11</text>
<text text-anchor="middle" x="15227" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="15227" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_13_gelu_gpu11&#45;&gt;layer_13_mlp2_gpu11 -->
<g id="edge948" class="edge">
<title>layer_13_gelu_gpu11&#45;&gt;layer_13_mlp2_gpu11</title>
<path fill="none" stroke="black" d="M15227,-8907.5C15227,-8897.89 15227,-8885.73 15227,-8874.31"/>
<polygon fill="black" stroke="black" points="15230.5,-8874.11 15227,-8864.11 15223.5,-8874.11 15230.5,-8874.11"/>
</g>
<!-- layer_13_mlp2_gpu12 -->
<g id="node765" class="node">
<title>layer_13_mlp2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="15146,-8864.02 15020,-8864.02 15020,-8811.02 15146,-8811.02 15146,-8864.02"/>
<text text-anchor="middle" x="15083" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU12</text>
<text text-anchor="middle" x="15083" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="15083" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_13_gelu_gpu12&#45;&gt;layer_13_mlp2_gpu12 -->
<g id="edge952" class="edge">
<title>layer_13_gelu_gpu12&#45;&gt;layer_13_mlp2_gpu12</title>
<path fill="none" stroke="black" d="M15083,-8907.5C15083,-8897.89 15083,-8885.73 15083,-8874.31"/>
<polygon fill="black" stroke="black" points="15086.5,-8874.11 15083,-8864.11 15079.5,-8874.11 15086.5,-8874.11"/>
</g>
<!-- layer_13_mlp2_gpu13 -->
<g id="node766" class="node">
<title>layer_13_mlp2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="15002,-8864.02 14876,-8864.02 14876,-8811.02 15002,-8811.02 15002,-8864.02"/>
<text text-anchor="middle" x="14939" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU13</text>
<text text-anchor="middle" x="14939" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="14939" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_13_gelu_gpu13&#45;&gt;layer_13_mlp2_gpu13 -->
<g id="edge956" class="edge">
<title>layer_13_gelu_gpu13&#45;&gt;layer_13_mlp2_gpu13</title>
<path fill="none" stroke="black" d="M14939,-8907.5C14939,-8897.89 14939,-8885.73 14939,-8874.31"/>
<polygon fill="black" stroke="black" points="14942.5,-8874.11 14939,-8864.11 14935.5,-8874.11 14942.5,-8874.11"/>
</g>
<!-- layer_13_mlp2_gpu14 -->
<g id="node767" class="node">
<title>layer_13_mlp2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="14858,-8864.02 14732,-8864.02 14732,-8811.02 14858,-8811.02 14858,-8864.02"/>
<text text-anchor="middle" x="14795" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU14</text>
<text text-anchor="middle" x="14795" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="14795" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_13_gelu_gpu14&#45;&gt;layer_13_mlp2_gpu14 -->
<g id="edge960" class="edge">
<title>layer_13_gelu_gpu14&#45;&gt;layer_13_mlp2_gpu14</title>
<path fill="none" stroke="black" d="M14795,-8907.5C14795,-8897.89 14795,-8885.73 14795,-8874.31"/>
<polygon fill="black" stroke="black" points="14798.5,-8874.11 14795,-8864.11 14791.5,-8874.11 14798.5,-8874.11"/>
</g>
<!-- layer_13_mlp2_gpu15 -->
<g id="node768" class="node">
<title>layer_13_mlp2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="14714,-8864.02 14588,-8864.02 14588,-8811.02 14714,-8811.02 14714,-8864.02"/>
<text text-anchor="middle" x="14651" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU15</text>
<text text-anchor="middle" x="14651" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="14651" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_13_gelu_gpu15&#45;&gt;layer_13_mlp2_gpu15 -->
<g id="edge964" class="edge">
<title>layer_13_gelu_gpu15&#45;&gt;layer_13_mlp2_gpu15</title>
<path fill="none" stroke="black" d="M14651,-8907.5C14651,-8897.89 14651,-8885.73 14651,-8874.31"/>
<polygon fill="black" stroke="black" points="14654.5,-8874.11 14651,-8864.11 14647.5,-8874.11 14654.5,-8874.11"/>
</g>
<!-- layer_13_mlp_allreduce -->
<g id="node769" class="node">
<title>layer_13_mlp_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="15155" cy="-8748.15" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="15155" y="-8751.95" font-family="Times,serif" font-size="14.00">MLP AllReduce</text>
<text text-anchor="middle" x="15155" y="-8736.95" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_13_mlp2_gpu8&#45;&gt;layer_13_mlp_allreduce -->
<g id="edge937" class="edge">
<title>layer_13_mlp2_gpu8&#45;&gt;layer_13_mlp_allreduce</title>
<path fill="none" stroke="black" d="M15596,-8813.41C15592.97,-8812.56 15589.96,-8811.75 15587,-8811.02 15472.59,-8782.87 15337.77,-8766.09 15249.56,-8757.25"/>
<polygon fill="black" stroke="black" points="15249.86,-8753.77 15239.57,-8756.27 15249.18,-8760.73 15249.86,-8753.77"/>
</g>
<!-- layer_13_mlp2_gpu9&#45;&gt;layer_13_mlp_allreduce -->
<g id="edge941" class="edge">
<title>layer_13_mlp2_gpu9&#45;&gt;layer_13_mlp_allreduce</title>
<path fill="none" stroke="black" d="M15451.93,-8813.67C15448.92,-8812.74 15445.93,-8811.85 15443,-8811.02 15375.58,-8791.93 15297.82,-8775.55 15240.11,-8764.45"/>
<polygon fill="black" stroke="black" points="15240.42,-8760.94 15229.94,-8762.51 15239.1,-8767.82 15240.42,-8760.94"/>
</g>
<!-- layer_13_mlp2_gpu10&#45;&gt;layer_13_mlp_allreduce -->
<g id="edge945" class="edge">
<title>layer_13_mlp2_gpu10&#45;&gt;layer_13_mlp_allreduce</title>
<path fill="none" stroke="black" d="M15307.94,-8811.02C15279.08,-8799.34 15245,-8785.56 15216.35,-8773.97"/>
<polygon fill="black" stroke="black" points="15217.44,-8770.63 15206.86,-8770.13 15214.81,-8777.12 15217.44,-8770.63"/>
</g>
<!-- layer_13_mlp2_gpu11&#45;&gt;layer_13_mlp_allreduce -->
<g id="edge949" class="edge">
<title>layer_13_mlp2_gpu11&#45;&gt;layer_13_mlp_allreduce</title>
<path fill="none" stroke="black" d="M15205.79,-8810.78C15198.4,-8801.82 15190,-8791.63 15182.2,-8782.16"/>
<polygon fill="black" stroke="black" points="15184.87,-8779.9 15175.81,-8774.41 15179.47,-8784.35 15184.87,-8779.9"/>
</g>
<!-- layer_13_mlp2_gpu12&#45;&gt;layer_13_mlp_allreduce -->
<g id="edge953" class="edge">
<title>layer_13_mlp2_gpu12&#45;&gt;layer_13_mlp_allreduce</title>
<path fill="none" stroke="black" d="M15104.21,-8810.78C15111.6,-8801.82 15120,-8791.63 15127.8,-8782.16"/>
<polygon fill="black" stroke="black" points="15130.53,-8784.35 15134.19,-8774.41 15125.13,-8779.9 15130.53,-8784.35"/>
</g>
<!-- layer_13_mlp2_gpu13&#45;&gt;layer_13_mlp_allreduce -->
<g id="edge957" class="edge">
<title>layer_13_mlp2_gpu13&#45;&gt;layer_13_mlp_allreduce</title>
<path fill="none" stroke="black" d="M15002.06,-8811.02C15030.92,-8799.34 15065,-8785.56 15093.65,-8773.97"/>
<polygon fill="black" stroke="black" points="15095.19,-8777.12 15103.14,-8770.13 15092.56,-8770.63 15095.19,-8777.12"/>
</g>
<!-- layer_13_mlp2_gpu14&#45;&gt;layer_13_mlp_allreduce -->
<g id="edge961" class="edge">
<title>layer_13_mlp2_gpu14&#45;&gt;layer_13_mlp_allreduce</title>
<path fill="none" stroke="black" d="M14858.07,-8813.67C14861.08,-8812.74 14864.07,-8811.85 14867,-8811.02 14934.42,-8791.93 15012.18,-8775.55 15069.89,-8764.45"/>
<polygon fill="black" stroke="black" points="15070.9,-8767.82 15080.06,-8762.51 15069.58,-8760.94 15070.9,-8767.82"/>
</g>
<!-- layer_13_mlp2_gpu15&#45;&gt;layer_13_mlp_allreduce -->
<g id="edge965" class="edge">
<title>layer_13_mlp2_gpu15&#45;&gt;layer_13_mlp_allreduce</title>
<path fill="none" stroke="black" d="M14714,-8813.41C14717.03,-8812.56 14720.04,-8811.75 14723,-8811.02 14837.41,-8782.87 14972.23,-8766.09 15060.44,-8757.25"/>
<polygon fill="black" stroke="black" points="15060.82,-8760.73 15070.43,-8756.27 15060.14,-8753.77 15060.82,-8760.73"/>
</g>
<!-- layer_13_residual2 -->
<g id="node770" class="node">
<title>layer_13_residual2</title>
<polygon fill="lightyellow" stroke="black" points="15292.78,-8685.28 15073.6,-8685.28 15017.22,-8609.28 15236.4,-8609.28 15292.78,-8685.28"/>
<text text-anchor="middle" x="15155" y="-8651.08" font-family="Times,serif" font-size="14.00">Residual Add 13</text>
<text text-anchor="middle" x="15155" y="-8636.08" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_13_mlp_allreduce&#45;&gt;layer_13_residual2 -->
<g id="edge966" class="edge">
<title>layer_13_mlp_allreduce&#45;&gt;layer_13_residual2</title>
<path fill="none" stroke="black" d="M15155,-8721.18C15155,-8713.36 15155,-8704.53 15155,-8695.78"/>
<polygon fill="black" stroke="black" points="15158.5,-8695.61 15155,-8685.61 15151.5,-8695.61 15158.5,-8695.61"/>
</g>
<!-- layer_13_ln2 -->
<g id="node771" class="node">
<title>layer_13_ln2</title>
<polygon fill="lightblue" stroke="black" points="15215,-8554.28 15095,-8554.28 15095,-8516.28 15215,-8516.28 15215,-8554.28"/>
<text text-anchor="middle" x="15155" y="-8539.08" font-family="Times,serif" font-size="14.00">LayerNorm 13</text>
<text text-anchor="middle" x="15155" y="-8524.08" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_13_residual2&#45;&gt;layer_13_ln2 -->
<g id="edge967" class="edge">
<title>layer_13_residual2&#45;&gt;layer_13_ln2</title>
<path fill="none" stroke="black" d="M15155,-8609.04C15155,-8594.48 15155,-8578.07 15155,-8564.52"/>
<polygon fill="black" stroke="black" points="15158.5,-8564.35 15155,-8554.35 15151.5,-8564.35 15158.5,-8564.35"/>
</g>
<!-- layer_14_qkv_gpu0 -->
<g id="node890" class="node">
<title>layer_14_qkv_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="15299.69,-8411.28 15069.52,-8411.28 15010.31,-8375.28 15240.48,-8375.28 15299.69,-8411.28"/>
<text text-anchor="middle" x="15155" y="-8389.58" font-family="Times,serif" font-size="14.00">layer_14_qkv_gpu0</text>
</g>
<!-- layer_13_ln2&#45;&gt;layer_14_qkv_gpu0 -->
<g id="edge968" class="edge">
<title>layer_13_ln2&#45;&gt;layer_14_qkv_gpu0</title>
<path fill="none" stroke="black" d="M15155,-8516.27C15155,-8492.27 15155,-8449.62 15155,-8421.64"/>
<polygon fill="black" stroke="black" points="15158.5,-8421.35 15155,-8411.35 15151.5,-8421.35 15158.5,-8421.35"/>
</g>
<!-- layer_14_qkv_gpu8 -->
<g id="node772" class="node">
<title>layer_14_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="17538,-9763.37 17410,-9763.37 17410,-9710.37 17538,-9710.37 17538,-9763.37"/>
<text text-anchor="middle" x="17474" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU8</text>
<text text-anchor="middle" x="17474" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="17474" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_14_qkv_comm -->
<g id="node780" class="node">
<title>layer_14_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="16944" cy="-9603.37" rx="85.62" ry="26.74"/>
<text text-anchor="middle" x="16944" y="-9607.17" font-family="Times,serif" font-size="14.00">QKV AllGather</text>
<text text-anchor="middle" x="16944" y="-9592.17" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_14_qkv_gpu8&#45;&gt;layer_14_qkv_comm -->
<g id="edge969" class="edge">
<title>layer_14_qkv_gpu8&#45;&gt;layer_14_qkv_comm</title>
<path fill="none" stroke="black" d="M17453.05,-9710.1C17439.73,-9695.55 17421.22,-9678.43 17401,-9668.87 17338.32,-9639.26 17151.6,-9620.21 17037.15,-9610.98"/>
<polygon fill="black" stroke="black" points="17037.24,-9607.47 17026.99,-9610.17 17036.68,-9614.45 17037.24,-9607.47"/>
</g>
<!-- layer_14_qkv_gpu9 -->
<g id="node773" class="node">
<title>layer_14_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="17392,-9763.37 17264,-9763.37 17264,-9710.37 17392,-9710.37 17392,-9763.37"/>
<text text-anchor="middle" x="17328" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU9</text>
<text text-anchor="middle" x="17328" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="17328" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_14_qkv_gpu9&#45;&gt;layer_14_qkv_comm -->
<g id="edge970" class="edge">
<title>layer_14_qkv_gpu9&#45;&gt;layer_14_qkv_comm</title>
<path fill="none" stroke="black" d="M17306.51,-9710.24C17293.13,-9695.93 17274.75,-9678.99 17255,-9668.87 17187.11,-9634.08 17101.77,-9618.06 17037.66,-9610.68"/>
<polygon fill="black" stroke="black" points="17037.89,-9607.18 17027.56,-9609.56 17037.12,-9614.14 17037.89,-9607.18"/>
</g>
<!-- layer_14_qkv_gpu10 -->
<g id="node774" class="node">
<title>layer_14_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="17245.5,-9763.37 17108.5,-9763.37 17108.5,-9710.37 17245.5,-9710.37 17245.5,-9763.37"/>
<text text-anchor="middle" x="17177" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU10</text>
<text text-anchor="middle" x="17177" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="17177" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_14_qkv_gpu10&#45;&gt;layer_14_qkv_comm -->
<g id="edge971" class="edge">
<title>layer_14_qkv_gpu10&#45;&gt;layer_14_qkv_comm</title>
<path fill="none" stroke="black" d="M17151.94,-9710.35C17137.64,-9696.77 17118.84,-9680.53 17100,-9668.87 17072.57,-9651.9 17039.89,-9637.6 17011.55,-9626.81"/>
<polygon fill="black" stroke="black" points="17012.71,-9623.51 17002.12,-9623.29 17010.26,-9630.07 17012.71,-9623.51"/>
</g>
<!-- layer_14_qkv_gpu11 -->
<g id="node775" class="node">
<title>layer_14_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="17090.5,-9763.37 16953.5,-9763.37 16953.5,-9710.37 17090.5,-9710.37 17090.5,-9763.37"/>
<text text-anchor="middle" x="17022" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU11</text>
<text text-anchor="middle" x="17022" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="17022" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_14_qkv_gpu11&#45;&gt;layer_14_qkv_comm -->
<g id="edge972" class="edge">
<title>layer_14_qkv_gpu11&#45;&gt;layer_14_qkv_comm</title>
<path fill="none" stroke="black" d="M17006.78,-9710.21C16994.7,-9689.84 16977.7,-9661.18 16964.43,-9638.82"/>
<polygon fill="black" stroke="black" points="16967.3,-9636.79 16959.19,-9629.97 16961.28,-9640.36 16967.3,-9636.79"/>
</g>
<!-- layer_14_qkv_gpu12 -->
<g id="node776" class="node">
<title>layer_14_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="16935.5,-9763.37 16798.5,-9763.37 16798.5,-9710.37 16935.5,-9710.37 16935.5,-9763.37"/>
<text text-anchor="middle" x="16867" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU12</text>
<text text-anchor="middle" x="16867" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="16867" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_14_qkv_gpu12&#45;&gt;layer_14_qkv_comm -->
<g id="edge973" class="edge">
<title>layer_14_qkv_gpu12&#45;&gt;layer_14_qkv_comm</title>
<path fill="none" stroke="black" d="M16882.03,-9710.21C16893.95,-9689.84 16910.74,-9661.18 16923.83,-9638.82"/>
<polygon fill="black" stroke="black" points="16926.98,-9640.37 16929.01,-9629.97 16920.94,-9636.84 16926.98,-9640.37"/>
</g>
<!-- layer_14_qkv_gpu13 -->
<g id="node777" class="node">
<title>layer_14_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="16780.5,-9763.37 16643.5,-9763.37 16643.5,-9710.37 16780.5,-9710.37 16780.5,-9763.37"/>
<text text-anchor="middle" x="16712" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU13</text>
<text text-anchor="middle" x="16712" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="16712" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_14_qkv_gpu13&#45;&gt;layer_14_qkv_comm -->
<g id="edge974" class="edge">
<title>layer_14_qkv_gpu13&#45;&gt;layer_14_qkv_comm</title>
<path fill="none" stroke="black" d="M16737.8,-9710.08C16752.28,-9696.59 16771.17,-9680.5 16790,-9668.87 16817.03,-9652.19 16849.13,-9637.97 16877.02,-9627.16"/>
<polygon fill="black" stroke="black" points="16878.59,-9630.31 16886.69,-9623.48 16876.1,-9623.76 16878.59,-9630.31"/>
</g>
<!-- layer_14_qkv_gpu14 -->
<g id="node778" class="node">
<title>layer_14_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="16625.5,-9763.37 16488.5,-9763.37 16488.5,-9710.37 16625.5,-9710.37 16625.5,-9763.37"/>
<text text-anchor="middle" x="16557" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU14</text>
<text text-anchor="middle" x="16557" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="16557" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_14_qkv_gpu14&#45;&gt;layer_14_qkv_comm -->
<g id="edge975" class="edge">
<title>layer_14_qkv_gpu14&#45;&gt;layer_14_qkv_comm</title>
<path fill="none" stroke="black" d="M16580.29,-9710.28C16594.7,-9695.98 16614.34,-9679.05 16635,-9668.87 16703.01,-9635.37 16787.76,-9619.24 16851.29,-9611.49"/>
<polygon fill="black" stroke="black" points="16851.77,-9614.96 16861.3,-9610.32 16850.96,-9608.01 16851.77,-9614.96"/>
</g>
<!-- layer_14_qkv_gpu15 -->
<g id="node779" class="node">
<title>layer_14_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="16470.5,-9763.37 16333.5,-9763.37 16333.5,-9710.37 16470.5,-9710.37 16470.5,-9763.37"/>
<text text-anchor="middle" x="16402" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU15</text>
<text text-anchor="middle" x="16402" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="16402" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_14_qkv_gpu15&#45;&gt;layer_14_qkv_comm -->
<g id="edge976" class="edge">
<title>layer_14_qkv_gpu15&#45;&gt;layer_14_qkv_comm</title>
<path fill="none" stroke="black" d="M16424.71,-9710.1C16439.06,-9695.55 16458.85,-9678.42 16480,-9668.87 16544.31,-9639.85 16734.6,-9620.54 16850.56,-9611.11"/>
<polygon fill="black" stroke="black" points="16851.16,-9614.57 16860.85,-9610.28 16850.6,-9607.59 16851.16,-9614.57"/>
</g>
<!-- layer_14_attn_comp_gpu8 -->
<g id="node781" class="node">
<title>layer_14_attn_comp_gpu8</title>
<polygon fill="lightblue" stroke="black" points="16269,-9540.13 16071,-9540.13 16071,-9487.13 16269,-9487.13 16269,-9540.13"/>
<text text-anchor="middle" x="16170" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU8</text>
<text text-anchor="middle" x="16170" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="16170" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_14_qkv_comm&#45;&gt;layer_14_attn_comp_gpu8 -->
<g id="edge977" class="edge">
<title>layer_14_qkv_comm&#45;&gt;layer_14_attn_comp_gpu8</title>
<path fill="none" stroke="black" d="M16859.66,-9598.4C16734.76,-9591.65 16493.21,-9575.34 16279.22,-9540.61"/>
<polygon fill="black" stroke="black" points="16279.49,-9537.1 16269.05,-9538.94 16278.36,-9544.01 16279.49,-9537.1"/>
</g>
<!-- layer_14_attn_comp_gpu9 -->
<g id="node782" class="node">
<title>layer_14_attn_comp_gpu9</title>
<polygon fill="lightblue" stroke="black" points="16485,-9540.13 16287,-9540.13 16287,-9487.13 16485,-9487.13 16485,-9540.13"/>
<text text-anchor="middle" x="16386" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU9</text>
<text text-anchor="middle" x="16386" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="16386" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_14_qkv_comm&#45;&gt;layer_14_attn_comp_gpu9 -->
<g id="edge978" class="edge">
<title>layer_14_qkv_comm&#45;&gt;layer_14_attn_comp_gpu9</title>
<path fill="none" stroke="black" d="M16864.14,-9593.72C16774.07,-9583.41 16623.39,-9564.53 16495,-9540.5 16494.9,-9540.48 16494.8,-9540.46 16494.7,-9540.45"/>
<polygon fill="black" stroke="black" points="16495.61,-9537.06 16485.12,-9538.59 16494.27,-9543.93 16495.61,-9537.06"/>
</g>
<!-- layer_14_attn_comp_gpu10 -->
<g id="node783" class="node">
<title>layer_14_attn_comp_gpu10</title>
<polygon fill="lightblue" stroke="black" points="16710.5,-9540.13 16503.5,-9540.13 16503.5,-9487.13 16710.5,-9487.13 16710.5,-9540.13"/>
<text text-anchor="middle" x="16607" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU10</text>
<text text-anchor="middle" x="16607" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="16607" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_14_qkv_comm&#45;&gt;layer_14_attn_comp_gpu10 -->
<g id="edge979" class="edge">
<title>layer_14_qkv_comm&#45;&gt;layer_14_attn_comp_gpu10</title>
<path fill="none" stroke="black" d="M16879.42,-9585.56C16833,-9573.47 16769.32,-9556.89 16715.2,-9542.8"/>
<polygon fill="black" stroke="black" points="16715.77,-9539.33 16705.21,-9540.2 16714,-9546.11 16715.77,-9539.33"/>
</g>
<!-- layer_14_attn_comp_gpu11 -->
<g id="node784" class="node">
<title>layer_14_attn_comp_gpu11</title>
<polygon fill="lightblue" stroke="black" points="16935.5,-9540.13 16728.5,-9540.13 16728.5,-9487.13 16935.5,-9487.13 16935.5,-9540.13"/>
<text text-anchor="middle" x="16832" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU11</text>
<text text-anchor="middle" x="16832" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="16832" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_14_qkv_comm&#45;&gt;layer_14_attn_comp_gpu11 -->
<g id="edge980" class="edge">
<title>layer_14_qkv_comm&#45;&gt;layer_14_attn_comp_gpu11</title>
<path fill="none" stroke="black" d="M16913.1,-9578.17C16900.66,-9568.42 16886.14,-9557.04 16872.84,-9546.63"/>
<polygon fill="black" stroke="black" points="16874.79,-9543.71 16864.76,-9540.29 16870.47,-9549.22 16874.79,-9543.71"/>
</g>
<!-- layer_14_attn_comp_gpu12 -->
<g id="node785" class="node">
<title>layer_14_attn_comp_gpu12</title>
<polygon fill="lightblue" stroke="black" points="17160.5,-9540.13 16953.5,-9540.13 16953.5,-9487.13 17160.5,-9487.13 17160.5,-9540.13"/>
<text text-anchor="middle" x="17057" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU12</text>
<text text-anchor="middle" x="17057" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="17057" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_14_qkv_comm&#45;&gt;layer_14_attn_comp_gpu12 -->
<g id="edge981" class="edge">
<title>layer_14_qkv_comm&#45;&gt;layer_14_attn_comp_gpu12</title>
<path fill="none" stroke="black" d="M16975.18,-9578.17C16987.73,-9568.42 17002.38,-9557.04 17015.79,-9546.63"/>
<polygon fill="black" stroke="black" points="17018.2,-9549.19 17023.95,-9540.29 17013.91,-9543.66 17018.2,-9549.19"/>
</g>
<!-- layer_14_attn_comp_gpu13 -->
<g id="node786" class="node">
<title>layer_14_attn_comp_gpu13</title>
<polygon fill="lightblue" stroke="black" points="17385.5,-9540.13 17178.5,-9540.13 17178.5,-9487.13 17385.5,-9487.13 17385.5,-9540.13"/>
<text text-anchor="middle" x="17282" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU13</text>
<text text-anchor="middle" x="17282" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="17282" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_14_qkv_comm&#45;&gt;layer_14_attn_comp_gpu13 -->
<g id="edge982" class="edge">
<title>layer_14_qkv_comm&#45;&gt;layer_14_attn_comp_gpu13</title>
<path fill="none" stroke="black" d="M17008.37,-9585.66C17055.08,-9573.54 17119.37,-9556.85 17173.89,-9542.7"/>
<polygon fill="black" stroke="black" points="17174.8,-9546.08 17183.6,-9540.18 17173.04,-9539.3 17174.8,-9546.08"/>
</g>
<!-- layer_14_attn_comp_gpu14 -->
<g id="node787" class="node">
<title>layer_14_attn_comp_gpu14</title>
<polygon fill="lightblue" stroke="black" points="17610.5,-9540.13 17403.5,-9540.13 17403.5,-9487.13 17610.5,-9487.13 17610.5,-9540.13"/>
<text text-anchor="middle" x="17507" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU14</text>
<text text-anchor="middle" x="17507" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="17507" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_14_qkv_comm&#45;&gt;layer_14_attn_comp_gpu14 -->
<g id="edge983" class="edge">
<title>layer_14_qkv_comm&#45;&gt;layer_14_attn_comp_gpu14</title>
<path fill="none" stroke="black" d="M17023.78,-9593.64C17111.98,-9583.49 17258.41,-9565.16 17393.24,-9540.77"/>
<polygon fill="black" stroke="black" points="17394.13,-9544.16 17403.34,-9538.93 17392.87,-9537.28 17394.13,-9544.16"/>
</g>
<!-- layer_14_attn_comp_gpu15 -->
<g id="node788" class="node">
<title>layer_14_attn_comp_gpu15</title>
<polygon fill="lightblue" stroke="black" points="17835.5,-9540.13 17628.5,-9540.13 17628.5,-9487.13 17835.5,-9487.13 17835.5,-9540.13"/>
<text text-anchor="middle" x="17732" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU15</text>
<text text-anchor="middle" x="17732" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="17732" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_14_qkv_comm&#45;&gt;layer_14_attn_comp_gpu15 -->
<g id="edge984" class="edge">
<title>layer_14_qkv_comm&#45;&gt;layer_14_attn_comp_gpu15</title>
<path fill="none" stroke="black" d="M17028.24,-9598.34C17154.64,-9591.48 17400.91,-9574.96 17618.36,-9540.69"/>
<polygon fill="black" stroke="black" points="17619.04,-9544.12 17628.36,-9539.09 17617.94,-9537.21 17619.04,-9544.12"/>
</g>
<!-- layer_14_attn_out_gpu8 -->
<g id="node789" class="node">
<title>layer_14_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="16292,-9450.76 16134,-9450.76 16134,-9397.76 16292,-9397.76 16292,-9450.76"/>
<text text-anchor="middle" x="16213" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU8</text>
<text text-anchor="middle" x="16213" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="16213" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_14_attn_comp_gpu8&#45;&gt;layer_14_attn_out_gpu8 -->
<g id="edge985" class="edge">
<title>layer_14_attn_comp_gpu8&#45;&gt;layer_14_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M16182.67,-9486.89C16186.82,-9478.45 16191.51,-9468.92 16195.94,-9459.93"/>
<polygon fill="black" stroke="black" points="16199.15,-9461.34 16200.42,-9450.82 16192.87,-9458.25 16199.15,-9461.34"/>
</g>
<!-- layer_14_attn_out_gpu9 -->
<g id="node790" class="node">
<title>layer_14_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="16511,-9450.76 16353,-9450.76 16353,-9397.76 16511,-9397.76 16511,-9450.76"/>
<text text-anchor="middle" x="16432" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU9</text>
<text text-anchor="middle" x="16432" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="16432" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_14_attn_comp_gpu9&#45;&gt;layer_14_attn_out_gpu9 -->
<g id="edge986" class="edge">
<title>layer_14_attn_comp_gpu9&#45;&gt;layer_14_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M16399.55,-9486.89C16404,-9478.45 16409.01,-9468.92 16413.75,-9459.93"/>
<polygon fill="black" stroke="black" points="16416.98,-9461.3 16418.54,-9450.82 16410.79,-9458.04 16416.98,-9461.3"/>
</g>
<!-- layer_14_attn_out_gpu10 -->
<g id="node791" class="node">
<title>layer_14_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="16715.5,-9450.76 16548.5,-9450.76 16548.5,-9397.76 16715.5,-9397.76 16715.5,-9450.76"/>
<text text-anchor="middle" x="16632" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU10</text>
<text text-anchor="middle" x="16632" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="16632" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_14_attn_comp_gpu10&#45;&gt;layer_14_attn_out_gpu10 -->
<g id="edge987" class="edge">
<title>layer_14_attn_comp_gpu10&#45;&gt;layer_14_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M16614.37,-9486.89C16616.73,-9478.63 16619.39,-9469.32 16621.92,-9460.5"/>
<polygon fill="black" stroke="black" points="16625.3,-9461.4 16624.69,-9450.82 16618.57,-9459.47 16625.3,-9461.4"/>
</g>
<!-- layer_14_attn_out_gpu11 -->
<g id="node792" class="node">
<title>layer_14_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="16925.5,-9450.76 16758.5,-9450.76 16758.5,-9397.76 16925.5,-9397.76 16925.5,-9450.76"/>
<text text-anchor="middle" x="16842" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU11</text>
<text text-anchor="middle" x="16842" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="16842" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_14_attn_comp_gpu11&#45;&gt;layer_14_attn_out_gpu11 -->
<g id="edge988" class="edge">
<title>layer_14_attn_comp_gpu11&#45;&gt;layer_14_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M16834.95,-9486.89C16835.88,-9478.72 16836.93,-9469.52 16837.93,-9460.78"/>
<polygon fill="black" stroke="black" points="16841.41,-9461.15 16839.07,-9450.82 16834.46,-9460.36 16841.41,-9461.15"/>
</g>
<!-- layer_14_attn_out_gpu12 -->
<g id="node793" class="node">
<title>layer_14_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="17130.5,-9450.76 16963.5,-9450.76 16963.5,-9397.76 17130.5,-9397.76 17130.5,-9450.76"/>
<text text-anchor="middle" x="17047" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU12</text>
<text text-anchor="middle" x="17047" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="17047" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_14_attn_comp_gpu12&#45;&gt;layer_14_attn_out_gpu12 -->
<g id="edge989" class="edge">
<title>layer_14_attn_comp_gpu12&#45;&gt;layer_14_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M17054.05,-9486.89C17053.12,-9478.72 17052.07,-9469.52 17051.07,-9460.78"/>
<polygon fill="black" stroke="black" points="17054.54,-9460.36 17049.93,-9450.82 17047.59,-9461.15 17054.54,-9460.36"/>
</g>
<!-- layer_14_attn_out_gpu13 -->
<g id="node794" class="node">
<title>layer_14_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="17335.5,-9450.76 17168.5,-9450.76 17168.5,-9397.76 17335.5,-9397.76 17335.5,-9450.76"/>
<text text-anchor="middle" x="17252" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU13</text>
<text text-anchor="middle" x="17252" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="17252" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_14_attn_comp_gpu13&#45;&gt;layer_14_attn_out_gpu13 -->
<g id="edge990" class="edge">
<title>layer_14_attn_comp_gpu13&#45;&gt;layer_14_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M17273.16,-9486.89C17270.32,-9478.63 17267.13,-9469.32 17264.1,-9460.5"/>
<polygon fill="black" stroke="black" points="17267.33,-9459.14 17260.78,-9450.82 17260.71,-9461.41 17267.33,-9459.14"/>
</g>
<!-- layer_14_attn_out_gpu14 -->
<g id="node795" class="node">
<title>layer_14_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="17550.5,-9450.76 17383.5,-9450.76 17383.5,-9397.76 17550.5,-9397.76 17550.5,-9450.76"/>
<text text-anchor="middle" x="17467" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU14</text>
<text text-anchor="middle" x="17467" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="17467" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_14_attn_comp_gpu14&#45;&gt;layer_14_attn_out_gpu14 -->
<g id="edge991" class="edge">
<title>layer_14_attn_comp_gpu14&#45;&gt;layer_14_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M17495.22,-9486.89C17491.35,-9478.45 17486.99,-9468.92 17482.87,-9459.93"/>
<polygon fill="black" stroke="black" points="17486.05,-9458.46 17478.7,-9450.82 17479.68,-9461.37 17486.05,-9458.46"/>
</g>
<!-- layer_14_attn_out_gpu15 -->
<g id="node796" class="node">
<title>layer_14_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="17770.5,-9450.76 17603.5,-9450.76 17603.5,-9397.76 17770.5,-9397.76 17770.5,-9450.76"/>
<text text-anchor="middle" x="17687" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU15</text>
<text text-anchor="middle" x="17687" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="17687" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_14_attn_comp_gpu15&#45;&gt;layer_14_attn_out_gpu15 -->
<g id="edge992" class="edge">
<title>layer_14_attn_comp_gpu15&#45;&gt;layer_14_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M17718.74,-9486.89C17714.39,-9478.45 17709.49,-9468.92 17704.86,-9459.93"/>
<polygon fill="black" stroke="black" points="17707.85,-9458.11 17700.16,-9450.82 17701.63,-9461.31 17707.85,-9458.11"/>
</g>
<!-- layer_14_attn_allreduce -->
<g id="node797" class="node">
<title>layer_14_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="16944" cy="-9334.89" rx="112.36" ry="26.74"/>
<text text-anchor="middle" x="16944" y="-9338.69" font-family="Times,serif" font-size="14.00">Attention AllReduce</text>
<text text-anchor="middle" x="16944" y="-9323.69" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_14_attn_out_gpu8&#45;&gt;layer_14_attn_allreduce -->
<g id="edge993" class="edge">
<title>layer_14_attn_out_gpu8&#45;&gt;layer_14_attn_allreduce</title>
<path fill="none" stroke="black" d="M16292.12,-9406.68C16309.18,-9403.43 16327.16,-9400.27 16344,-9397.76 16511.5,-9372.88 16706.79,-9354.74 16827.93,-9344.76"/>
<polygon fill="black" stroke="black" points="16828.29,-9348.24 16837.97,-9343.94 16827.71,-9341.27 16828.29,-9348.24"/>
</g>
<!-- layer_14_attn_out_gpu9&#45;&gt;layer_14_attn_allreduce -->
<g id="edge994" class="edge">
<title>layer_14_attn_out_gpu9&#45;&gt;layer_14_attn_allreduce</title>
<path fill="none" stroke="black" d="M16511.17,-9403.8C16520.86,-9401.65 16530.64,-9399.58 16540,-9397.76 16640.03,-9378.33 16754.96,-9361.23 16836.6,-9349.96"/>
<polygon fill="black" stroke="black" points="16837.46,-9353.37 16846.89,-9348.55 16836.51,-9346.44 16837.46,-9353.37"/>
</g>
<!-- layer_14_attn_out_gpu10&#45;&gt;layer_14_attn_allreduce -->
<g id="edge995" class="edge">
<title>layer_14_attn_out_gpu10&#45;&gt;layer_14_attn_allreduce</title>
<path fill="none" stroke="black" d="M16715.61,-9399.85C16761.35,-9387.04 16817.76,-9371.24 16863.07,-9358.55"/>
<polygon fill="black" stroke="black" points="16864.18,-9361.88 16872.86,-9355.81 16862.29,-9355.14 16864.18,-9361.88"/>
</g>
<!-- layer_14_attn_out_gpu11&#45;&gt;layer_14_attn_allreduce -->
<g id="edge996" class="edge">
<title>layer_14_attn_out_gpu11&#45;&gt;layer_14_attn_allreduce</title>
<path fill="none" stroke="black" d="M16871.78,-9397.76C16882.77,-9388.34 16895.35,-9377.56 16906.91,-9367.66"/>
<polygon fill="black" stroke="black" points="16909.4,-9370.14 16914.71,-9360.98 16904.84,-9364.83 16909.4,-9370.14"/>
</g>
<!-- layer_14_attn_out_gpu12&#45;&gt;layer_14_attn_allreduce -->
<g id="edge997" class="edge">
<title>layer_14_attn_out_gpu12&#45;&gt;layer_14_attn_allreduce</title>
<path fill="none" stroke="black" d="M17016.93,-9397.76C17005.83,-9388.34 16993.12,-9377.56 16981.45,-9367.66"/>
<polygon fill="black" stroke="black" points="16983.46,-9364.78 16973.57,-9360.98 16978.93,-9370.12 16983.46,-9364.78"/>
</g>
<!-- layer_14_attn_out_gpu13&#45;&gt;layer_14_attn_allreduce -->
<g id="edge998" class="edge">
<title>layer_14_attn_out_gpu13&#45;&gt;layer_14_attn_allreduce</title>
<path fill="none" stroke="black" d="M17168.24,-9399.5C17123.45,-9386.8 17068.56,-9371.23 17024.3,-9358.67"/>
<polygon fill="black" stroke="black" points="17025.02,-9355.24 17014.45,-9355.88 17023.11,-9361.97 17025.02,-9355.24"/>
</g>
<!-- layer_14_attn_out_gpu14&#45;&gt;layer_14_attn_allreduce -->
<g id="edge999" class="edge">
<title>layer_14_attn_out_gpu14&#45;&gt;layer_14_attn_allreduce</title>
<path fill="none" stroke="black" d="M17383.44,-9405.19C17370.59,-9402.58 17357.45,-9400.02 17345,-9397.76 17245.13,-9379.63 17130.65,-9362.31 17049.64,-9350.63"/>
<polygon fill="black" stroke="black" points="17049.83,-9347.12 17039.44,-9349.17 17048.84,-9354.05 17049.83,-9347.12"/>
</g>
<!-- layer_14_attn_out_gpu15&#45;&gt;layer_14_attn_allreduce -->
<g id="edge1000" class="edge">
<title>layer_14_attn_out_gpu15&#45;&gt;layer_14_attn_allreduce</title>
<path fill="none" stroke="black" d="M17603.18,-9405.22C17588.82,-9402.48 17574.01,-9399.87 17560,-9397.76 17387.09,-9371.78 17185.19,-9353.84 17060.97,-9344.21"/>
<polygon fill="black" stroke="black" points="17060.92,-9340.69 17050.68,-9343.41 17060.38,-9347.67 17060.92,-9340.69"/>
</g>
<!-- layer_14_residual1 -->
<g id="node798" class="node">
<title>layer_14_residual1</title>
<polygon fill="lightyellow" stroke="black" points="17081.78,-9272.02 16862.6,-9272.02 16806.22,-9196.02 17025.4,-9196.02 17081.78,-9272.02"/>
<text text-anchor="middle" x="16944" y="-9237.82" font-family="Times,serif" font-size="14.00">Residual Add 14</text>
<text text-anchor="middle" x="16944" y="-9222.82" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_14_attn_allreduce&#45;&gt;layer_14_residual1 -->
<g id="edge1001" class="edge">
<title>layer_14_attn_allreduce&#45;&gt;layer_14_residual1</title>
<path fill="none" stroke="black" d="M16944,-9307.92C16944,-9300.1 16944,-9291.27 16944,-9282.52"/>
<polygon fill="black" stroke="black" points="16947.5,-9282.35 16944,-9272.35 16940.5,-9282.35 16947.5,-9282.35"/>
</g>
<!-- layer_14_ln1 -->
<g id="node799" class="node">
<title>layer_14_ln1</title>
<polygon fill="lightblue" stroke="black" points="17004,-9141.02 16884,-9141.02 16884,-9103.02 17004,-9103.02 17004,-9141.02"/>
<text text-anchor="middle" x="16944" y="-9125.82" font-family="Times,serif" font-size="14.00">LayerNorm 14</text>
<text text-anchor="middle" x="16944" y="-9110.82" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_14_residual1&#45;&gt;layer_14_ln1 -->
<g id="edge1002" class="edge">
<title>layer_14_residual1&#45;&gt;layer_14_ln1</title>
<path fill="none" stroke="black" d="M16944,-9195.78C16944,-9181.22 16944,-9164.81 16944,-9151.26"/>
<polygon fill="black" stroke="black" points="16947.5,-9151.09 16944,-9141.09 16940.5,-9151.09 16947.5,-9151.09"/>
</g>
<!-- layer_14_mlp1_gpu8 -->
<g id="node800" class="node">
<title>layer_14_mlp1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="17511,-9045.02 17385,-9045.02 17385,-8992.02 17511,-8992.02 17511,-9045.02"/>
<text text-anchor="middle" x="17448" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU8</text>
<text text-anchor="middle" x="17448" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="17448" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp1_gpu8 -->
<g id="edge1003" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp1_gpu8</title>
<path fill="none" stroke="black" d="M17004.12,-9118.87C17106.5,-9114.51 17310.03,-9102.72 17376,-9076.02 17389.87,-9070.41 17403.27,-9061.28 17414.68,-9051.99"/>
<polygon fill="black" stroke="black" points="17417.27,-9054.38 17422.61,-9045.24 17412.73,-9049.05 17417.27,-9054.38"/>
</g>
<!-- layer_14_mlp1_gpu9 -->
<g id="node801" class="node">
<title>layer_14_mlp1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="17367,-9045.02 17241,-9045.02 17241,-8992.02 17367,-8992.02 17367,-9045.02"/>
<text text-anchor="middle" x="17304" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU9</text>
<text text-anchor="middle" x="17304" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="17304" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp1_gpu9 -->
<g id="edge1007" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp1_gpu9</title>
<path fill="none" stroke="black" d="M17004.08,-9120.39C17064.1,-9117.79 17157.86,-9108.26 17232,-9076.02 17245.6,-9070.11 17258.86,-9061 17270.21,-9051.8"/>
<polygon fill="black" stroke="black" points="17272.73,-9054.26 17278.12,-9045.14 17268.22,-9048.91 17272.73,-9054.26"/>
</g>
<!-- layer_14_mlp1_gpu10 -->
<g id="node802" class="node">
<title>layer_14_mlp1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="17223,-9045.02 17097,-9045.02 17097,-8992.02 17223,-8992.02 17223,-9045.02"/>
<text text-anchor="middle" x="17160" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU10</text>
<text text-anchor="middle" x="17160" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="17160" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp1_gpu10 -->
<g id="edge1011" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp1_gpu10</title>
<path fill="none" stroke="black" d="M17004.08,-9107.48C17030.68,-9100.18 17061.8,-9089.8 17088,-9076.02 17100.67,-9069.36 17113.35,-9060.38 17124.45,-9051.55"/>
<polygon fill="black" stroke="black" points="17126.71,-9054.22 17132.24,-9045.18 17122.28,-9048.8 17126.71,-9054.22"/>
</g>
<!-- layer_14_mlp1_gpu11 -->
<g id="node803" class="node">
<title>layer_14_mlp1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="17079,-9045.02 16953,-9045.02 16953,-8992.02 17079,-8992.02 17079,-9045.02"/>
<text text-anchor="middle" x="17016" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU11</text>
<text text-anchor="middle" x="17016" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="17016" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp1_gpu11 -->
<g id="edge1015" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp1_gpu11</title>
<path fill="none" stroke="black" d="M16956.87,-9102.88C16966.59,-9089.18 16980.19,-9070 16991.91,-9053.49"/>
<polygon fill="black" stroke="black" points="16994.9,-9055.32 16997.83,-9045.14 16989.19,-9051.27 16994.9,-9055.32"/>
</g>
<!-- layer_14_mlp1_gpu12 -->
<g id="node804" class="node">
<title>layer_14_mlp1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="16935,-9045.02 16809,-9045.02 16809,-8992.02 16935,-8992.02 16935,-9045.02"/>
<text text-anchor="middle" x="16872" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU12</text>
<text text-anchor="middle" x="16872" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="16872" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp1_gpu12 -->
<g id="edge1019" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp1_gpu12</title>
<path fill="none" stroke="black" d="M16931.13,-9102.88C16921.41,-9089.18 16907.81,-9070 16896.09,-9053.49"/>
<polygon fill="black" stroke="black" points="16898.81,-9051.27 16890.17,-9045.14 16893.1,-9055.32 16898.81,-9051.27"/>
</g>
<!-- layer_14_mlp1_gpu13 -->
<g id="node805" class="node">
<title>layer_14_mlp1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="16791,-9045.02 16665,-9045.02 16665,-8992.02 16791,-8992.02 16791,-9045.02"/>
<text text-anchor="middle" x="16728" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU13</text>
<text text-anchor="middle" x="16728" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="16728" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp1_gpu13 -->
<g id="edge1023" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp1_gpu13</title>
<path fill="none" stroke="black" d="M16883.92,-9107.48C16857.32,-9100.18 16826.2,-9089.8 16800,-9076.02 16787.33,-9069.36 16774.65,-9060.38 16763.55,-9051.55"/>
<polygon fill="black" stroke="black" points="16765.72,-9048.8 16755.76,-9045.18 16761.29,-9054.22 16765.72,-9048.8"/>
</g>
<!-- layer_14_mlp1_gpu14 -->
<g id="node806" class="node">
<title>layer_14_mlp1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="16647,-9045.02 16521,-9045.02 16521,-8992.02 16647,-8992.02 16647,-9045.02"/>
<text text-anchor="middle" x="16584" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU14</text>
<text text-anchor="middle" x="16584" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="16584" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp1_gpu14 -->
<g id="edge1027" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp1_gpu14</title>
<path fill="none" stroke="black" d="M16883.92,-9120.39C16823.9,-9117.79 16730.14,-9108.26 16656,-9076.02 16642.4,-9070.11 16629.14,-9061 16617.79,-9051.8"/>
<polygon fill="black" stroke="black" points="16619.78,-9048.91 16609.88,-9045.14 16615.27,-9054.26 16619.78,-9048.91"/>
</g>
<!-- layer_14_mlp1_gpu15 -->
<g id="node807" class="node">
<title>layer_14_mlp1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="16503,-9045.02 16377,-9045.02 16377,-8992.02 16503,-8992.02 16503,-9045.02"/>
<text text-anchor="middle" x="16440" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU15</text>
<text text-anchor="middle" x="16440" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="16440" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp1_gpu15 -->
<g id="edge1031" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp1_gpu15</title>
<path fill="none" stroke="black" d="M16883.88,-9118.87C16781.5,-9114.51 16577.97,-9102.72 16512,-9076.02 16498.13,-9070.41 16484.73,-9061.28 16473.32,-9051.99"/>
<polygon fill="black" stroke="black" points="16475.27,-9049.05 16465.39,-9045.24 16470.73,-9054.38 16475.27,-9049.05"/>
</g>
<!-- layer_14_gelu_gpu8 -->
<g id="node808" class="node">
<title>layer_14_gelu_gpu8</title>
<polygon fill="lightblue" stroke="black" points="17500,-8945.52 17396,-8945.52 17396,-8907.52 17500,-8907.52 17500,-8945.52"/>
<text text-anchor="middle" x="17448" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU8</text>
<text text-anchor="middle" x="17448" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_14_mlp1_gpu8&#45;&gt;layer_14_gelu_gpu8 -->
<g id="edge1004" class="edge">
<title>layer_14_mlp1_gpu8&#45;&gt;layer_14_gelu_gpu8</title>
<path fill="none" stroke="black" d="M17448,-8991.97C17448,-8980.67 17448,-8967.35 17448,-8955.75"/>
<polygon fill="black" stroke="black" points="17451.5,-8955.7 17448,-8945.7 17444.5,-8955.7 17451.5,-8955.7"/>
</g>
<!-- layer_14_gelu_gpu9 -->
<g id="node809" class="node">
<title>layer_14_gelu_gpu9</title>
<polygon fill="lightblue" stroke="black" points="17356,-8945.52 17252,-8945.52 17252,-8907.52 17356,-8907.52 17356,-8945.52"/>
<text text-anchor="middle" x="17304" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU9</text>
<text text-anchor="middle" x="17304" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_14_mlp1_gpu9&#45;&gt;layer_14_gelu_gpu9 -->
<g id="edge1008" class="edge">
<title>layer_14_mlp1_gpu9&#45;&gt;layer_14_gelu_gpu9</title>
<path fill="none" stroke="black" d="M17304,-8991.97C17304,-8980.67 17304,-8967.35 17304,-8955.75"/>
<polygon fill="black" stroke="black" points="17307.5,-8955.7 17304,-8945.7 17300.5,-8955.7 17307.5,-8955.7"/>
</g>
<!-- layer_14_gelu_gpu10 -->
<g id="node810" class="node">
<title>layer_14_gelu_gpu10</title>
<polygon fill="lightblue" stroke="black" points="17216.5,-8945.52 17103.5,-8945.52 17103.5,-8907.52 17216.5,-8907.52 17216.5,-8945.52"/>
<text text-anchor="middle" x="17160" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU10</text>
<text text-anchor="middle" x="17160" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_14_mlp1_gpu10&#45;&gt;layer_14_gelu_gpu10 -->
<g id="edge1012" class="edge">
<title>layer_14_mlp1_gpu10&#45;&gt;layer_14_gelu_gpu10</title>
<path fill="none" stroke="black" d="M17160,-8991.97C17160,-8980.67 17160,-8967.35 17160,-8955.75"/>
<polygon fill="black" stroke="black" points="17163.5,-8955.7 17160,-8945.7 17156.5,-8955.7 17163.5,-8955.7"/>
</g>
<!-- layer_14_gelu_gpu11 -->
<g id="node811" class="node">
<title>layer_14_gelu_gpu11</title>
<polygon fill="lightblue" stroke="black" points="17072.5,-8945.52 16959.5,-8945.52 16959.5,-8907.52 17072.5,-8907.52 17072.5,-8945.52"/>
<text text-anchor="middle" x="17016" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU11</text>
<text text-anchor="middle" x="17016" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_14_mlp1_gpu11&#45;&gt;layer_14_gelu_gpu11 -->
<g id="edge1016" class="edge">
<title>layer_14_mlp1_gpu11&#45;&gt;layer_14_gelu_gpu11</title>
<path fill="none" stroke="black" d="M17016,-8991.97C17016,-8980.67 17016,-8967.35 17016,-8955.75"/>
<polygon fill="black" stroke="black" points="17019.5,-8955.7 17016,-8945.7 17012.5,-8955.7 17019.5,-8955.7"/>
</g>
<!-- layer_14_gelu_gpu12 -->
<g id="node812" class="node">
<title>layer_14_gelu_gpu12</title>
<polygon fill="lightblue" stroke="black" points="16928.5,-8945.52 16815.5,-8945.52 16815.5,-8907.52 16928.5,-8907.52 16928.5,-8945.52"/>
<text text-anchor="middle" x="16872" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU12</text>
<text text-anchor="middle" x="16872" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_14_mlp1_gpu12&#45;&gt;layer_14_gelu_gpu12 -->
<g id="edge1020" class="edge">
<title>layer_14_mlp1_gpu12&#45;&gt;layer_14_gelu_gpu12</title>
<path fill="none" stroke="black" d="M16872,-8991.97C16872,-8980.67 16872,-8967.35 16872,-8955.75"/>
<polygon fill="black" stroke="black" points="16875.5,-8955.7 16872,-8945.7 16868.5,-8955.7 16875.5,-8955.7"/>
</g>
<!-- layer_14_gelu_gpu13 -->
<g id="node813" class="node">
<title>layer_14_gelu_gpu13</title>
<polygon fill="lightblue" stroke="black" points="16784.5,-8945.52 16671.5,-8945.52 16671.5,-8907.52 16784.5,-8907.52 16784.5,-8945.52"/>
<text text-anchor="middle" x="16728" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU13</text>
<text text-anchor="middle" x="16728" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_14_mlp1_gpu13&#45;&gt;layer_14_gelu_gpu13 -->
<g id="edge1024" class="edge">
<title>layer_14_mlp1_gpu13&#45;&gt;layer_14_gelu_gpu13</title>
<path fill="none" stroke="black" d="M16728,-8991.97C16728,-8980.67 16728,-8967.35 16728,-8955.75"/>
<polygon fill="black" stroke="black" points="16731.5,-8955.7 16728,-8945.7 16724.5,-8955.7 16731.5,-8955.7"/>
</g>
<!-- layer_14_gelu_gpu14 -->
<g id="node814" class="node">
<title>layer_14_gelu_gpu14</title>
<polygon fill="lightblue" stroke="black" points="16640.5,-8945.52 16527.5,-8945.52 16527.5,-8907.52 16640.5,-8907.52 16640.5,-8945.52"/>
<text text-anchor="middle" x="16584" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU14</text>
<text text-anchor="middle" x="16584" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_14_mlp1_gpu14&#45;&gt;layer_14_gelu_gpu14 -->
<g id="edge1028" class="edge">
<title>layer_14_mlp1_gpu14&#45;&gt;layer_14_gelu_gpu14</title>
<path fill="none" stroke="black" d="M16584,-8991.97C16584,-8980.67 16584,-8967.35 16584,-8955.75"/>
<polygon fill="black" stroke="black" points="16587.5,-8955.7 16584,-8945.7 16580.5,-8955.7 16587.5,-8955.7"/>
</g>
<!-- layer_14_gelu_gpu15 -->
<g id="node815" class="node">
<title>layer_14_gelu_gpu15</title>
<polygon fill="lightblue" stroke="black" points="16496.5,-8945.52 16383.5,-8945.52 16383.5,-8907.52 16496.5,-8907.52 16496.5,-8945.52"/>
<text text-anchor="middle" x="16440" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU15</text>
<text text-anchor="middle" x="16440" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_14_mlp1_gpu15&#45;&gt;layer_14_gelu_gpu15 -->
<g id="edge1032" class="edge">
<title>layer_14_mlp1_gpu15&#45;&gt;layer_14_gelu_gpu15</title>
<path fill="none" stroke="black" d="M16440,-8991.97C16440,-8980.67 16440,-8967.35 16440,-8955.75"/>
<polygon fill="black" stroke="black" points="16443.5,-8955.7 16440,-8945.7 16436.5,-8955.7 16443.5,-8955.7"/>
</g>
<!-- layer_14_mlp2_gpu8 -->
<g id="node816" class="node">
<title>layer_14_mlp2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="17511,-8864.02 17385,-8864.02 17385,-8811.02 17511,-8811.02 17511,-8864.02"/>
<text text-anchor="middle" x="17448" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU8</text>
<text text-anchor="middle" x="17448" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="17448" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_14_gelu_gpu8&#45;&gt;layer_14_mlp2_gpu8 -->
<g id="edge1005" class="edge">
<title>layer_14_gelu_gpu8&#45;&gt;layer_14_mlp2_gpu8</title>
<path fill="none" stroke="black" d="M17448,-8907.5C17448,-8897.89 17448,-8885.73 17448,-8874.31"/>
<polygon fill="black" stroke="black" points="17451.5,-8874.11 17448,-8864.11 17444.5,-8874.11 17451.5,-8874.11"/>
</g>
<!-- layer_14_mlp2_gpu9 -->
<g id="node817" class="node">
<title>layer_14_mlp2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="17367,-8864.02 17241,-8864.02 17241,-8811.02 17367,-8811.02 17367,-8864.02"/>
<text text-anchor="middle" x="17304" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU9</text>
<text text-anchor="middle" x="17304" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="17304" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_14_gelu_gpu9&#45;&gt;layer_14_mlp2_gpu9 -->
<g id="edge1009" class="edge">
<title>layer_14_gelu_gpu9&#45;&gt;layer_14_mlp2_gpu9</title>
<path fill="none" stroke="black" d="M17304,-8907.5C17304,-8897.89 17304,-8885.73 17304,-8874.31"/>
<polygon fill="black" stroke="black" points="17307.5,-8874.11 17304,-8864.11 17300.5,-8874.11 17307.5,-8874.11"/>
</g>
<!-- layer_14_mlp2_gpu10 -->
<g id="node818" class="node">
<title>layer_14_mlp2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="17223,-8864.02 17097,-8864.02 17097,-8811.02 17223,-8811.02 17223,-8864.02"/>
<text text-anchor="middle" x="17160" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU10</text>
<text text-anchor="middle" x="17160" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="17160" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_14_gelu_gpu10&#45;&gt;layer_14_mlp2_gpu10 -->
<g id="edge1013" class="edge">
<title>layer_14_gelu_gpu10&#45;&gt;layer_14_mlp2_gpu10</title>
<path fill="none" stroke="black" d="M17160,-8907.5C17160,-8897.89 17160,-8885.73 17160,-8874.31"/>
<polygon fill="black" stroke="black" points="17163.5,-8874.11 17160,-8864.11 17156.5,-8874.11 17163.5,-8874.11"/>
</g>
<!-- layer_14_mlp2_gpu11 -->
<g id="node819" class="node">
<title>layer_14_mlp2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="17079,-8864.02 16953,-8864.02 16953,-8811.02 17079,-8811.02 17079,-8864.02"/>
<text text-anchor="middle" x="17016" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU11</text>
<text text-anchor="middle" x="17016" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="17016" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_14_gelu_gpu11&#45;&gt;layer_14_mlp2_gpu11 -->
<g id="edge1017" class="edge">
<title>layer_14_gelu_gpu11&#45;&gt;layer_14_mlp2_gpu11</title>
<path fill="none" stroke="black" d="M17016,-8907.5C17016,-8897.89 17016,-8885.73 17016,-8874.31"/>
<polygon fill="black" stroke="black" points="17019.5,-8874.11 17016,-8864.11 17012.5,-8874.11 17019.5,-8874.11"/>
</g>
<!-- layer_14_mlp2_gpu12 -->
<g id="node820" class="node">
<title>layer_14_mlp2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="16935,-8864.02 16809,-8864.02 16809,-8811.02 16935,-8811.02 16935,-8864.02"/>
<text text-anchor="middle" x="16872" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU12</text>
<text text-anchor="middle" x="16872" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="16872" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_14_gelu_gpu12&#45;&gt;layer_14_mlp2_gpu12 -->
<g id="edge1021" class="edge">
<title>layer_14_gelu_gpu12&#45;&gt;layer_14_mlp2_gpu12</title>
<path fill="none" stroke="black" d="M16872,-8907.5C16872,-8897.89 16872,-8885.73 16872,-8874.31"/>
<polygon fill="black" stroke="black" points="16875.5,-8874.11 16872,-8864.11 16868.5,-8874.11 16875.5,-8874.11"/>
</g>
<!-- layer_14_mlp2_gpu13 -->
<g id="node821" class="node">
<title>layer_14_mlp2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="16791,-8864.02 16665,-8864.02 16665,-8811.02 16791,-8811.02 16791,-8864.02"/>
<text text-anchor="middle" x="16728" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU13</text>
<text text-anchor="middle" x="16728" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="16728" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_14_gelu_gpu13&#45;&gt;layer_14_mlp2_gpu13 -->
<g id="edge1025" class="edge">
<title>layer_14_gelu_gpu13&#45;&gt;layer_14_mlp2_gpu13</title>
<path fill="none" stroke="black" d="M16728,-8907.5C16728,-8897.89 16728,-8885.73 16728,-8874.31"/>
<polygon fill="black" stroke="black" points="16731.5,-8874.11 16728,-8864.11 16724.5,-8874.11 16731.5,-8874.11"/>
</g>
<!-- layer_14_mlp2_gpu14 -->
<g id="node822" class="node">
<title>layer_14_mlp2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="16647,-8864.02 16521,-8864.02 16521,-8811.02 16647,-8811.02 16647,-8864.02"/>
<text text-anchor="middle" x="16584" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU14</text>
<text text-anchor="middle" x="16584" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="16584" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_14_gelu_gpu14&#45;&gt;layer_14_mlp2_gpu14 -->
<g id="edge1029" class="edge">
<title>layer_14_gelu_gpu14&#45;&gt;layer_14_mlp2_gpu14</title>
<path fill="none" stroke="black" d="M16584,-8907.5C16584,-8897.89 16584,-8885.73 16584,-8874.31"/>
<polygon fill="black" stroke="black" points="16587.5,-8874.11 16584,-8864.11 16580.5,-8874.11 16587.5,-8874.11"/>
</g>
<!-- layer_14_mlp2_gpu15 -->
<g id="node823" class="node">
<title>layer_14_mlp2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="16503,-8864.02 16377,-8864.02 16377,-8811.02 16503,-8811.02 16503,-8864.02"/>
<text text-anchor="middle" x="16440" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU15</text>
<text text-anchor="middle" x="16440" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="16440" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_14_gelu_gpu15&#45;&gt;layer_14_mlp2_gpu15 -->
<g id="edge1033" class="edge">
<title>layer_14_gelu_gpu15&#45;&gt;layer_14_mlp2_gpu15</title>
<path fill="none" stroke="black" d="M16440,-8907.5C16440,-8897.89 16440,-8885.73 16440,-8874.31"/>
<polygon fill="black" stroke="black" points="16443.5,-8874.11 16440,-8864.11 16436.5,-8874.11 16443.5,-8874.11"/>
</g>
<!-- layer_14_mlp_allreduce -->
<g id="node824" class="node">
<title>layer_14_mlp_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="16944" cy="-8748.15" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="16944" y="-8751.95" font-family="Times,serif" font-size="14.00">MLP AllReduce</text>
<text text-anchor="middle" x="16944" y="-8736.95" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_14_mlp2_gpu8&#45;&gt;layer_14_mlp_allreduce -->
<g id="edge1006" class="edge">
<title>layer_14_mlp2_gpu8&#45;&gt;layer_14_mlp_allreduce</title>
<path fill="none" stroke="black" d="M17385,-8813.41C17381.97,-8812.56 17378.96,-8811.75 17376,-8811.02 17261.59,-8782.87 17126.77,-8766.09 17038.56,-8757.25"/>
<polygon fill="black" stroke="black" points="17038.86,-8753.77 17028.57,-8756.27 17038.18,-8760.73 17038.86,-8753.77"/>
</g>
<!-- layer_14_mlp2_gpu9&#45;&gt;layer_14_mlp_allreduce -->
<g id="edge1010" class="edge">
<title>layer_14_mlp2_gpu9&#45;&gt;layer_14_mlp_allreduce</title>
<path fill="none" stroke="black" d="M17240.93,-8813.67C17237.92,-8812.74 17234.93,-8811.85 17232,-8811.02 17164.58,-8791.93 17086.82,-8775.55 17029.11,-8764.45"/>
<polygon fill="black" stroke="black" points="17029.42,-8760.94 17018.94,-8762.51 17028.1,-8767.82 17029.42,-8760.94"/>
</g>
<!-- layer_14_mlp2_gpu10&#45;&gt;layer_14_mlp_allreduce -->
<g id="edge1014" class="edge">
<title>layer_14_mlp2_gpu10&#45;&gt;layer_14_mlp_allreduce</title>
<path fill="none" stroke="black" d="M17096.94,-8811.02C17068.08,-8799.34 17034,-8785.56 17005.35,-8773.97"/>
<polygon fill="black" stroke="black" points="17006.44,-8770.63 16995.86,-8770.13 17003.81,-8777.12 17006.44,-8770.63"/>
</g>
<!-- layer_14_mlp2_gpu11&#45;&gt;layer_14_mlp_allreduce -->
<g id="edge1018" class="edge">
<title>layer_14_mlp2_gpu11&#45;&gt;layer_14_mlp_allreduce</title>
<path fill="none" stroke="black" d="M16994.79,-8810.78C16987.4,-8801.82 16979,-8791.63 16971.2,-8782.16"/>
<polygon fill="black" stroke="black" points="16973.87,-8779.9 16964.81,-8774.41 16968.47,-8784.35 16973.87,-8779.9"/>
</g>
<!-- layer_14_mlp2_gpu12&#45;&gt;layer_14_mlp_allreduce -->
<g id="edge1022" class="edge">
<title>layer_14_mlp2_gpu12&#45;&gt;layer_14_mlp_allreduce</title>
<path fill="none" stroke="black" d="M16893.21,-8810.78C16900.6,-8801.82 16909,-8791.63 16916.8,-8782.16"/>
<polygon fill="black" stroke="black" points="16919.53,-8784.35 16923.19,-8774.41 16914.13,-8779.9 16919.53,-8784.35"/>
</g>
<!-- layer_14_mlp2_gpu13&#45;&gt;layer_14_mlp_allreduce -->
<g id="edge1026" class="edge">
<title>layer_14_mlp2_gpu13&#45;&gt;layer_14_mlp_allreduce</title>
<path fill="none" stroke="black" d="M16791.06,-8811.02C16819.92,-8799.34 16854,-8785.56 16882.65,-8773.97"/>
<polygon fill="black" stroke="black" points="16884.19,-8777.12 16892.14,-8770.13 16881.56,-8770.63 16884.19,-8777.12"/>
</g>
<!-- layer_14_mlp2_gpu14&#45;&gt;layer_14_mlp_allreduce -->
<g id="edge1030" class="edge">
<title>layer_14_mlp2_gpu14&#45;&gt;layer_14_mlp_allreduce</title>
<path fill="none" stroke="black" d="M16647.07,-8813.67C16650.08,-8812.74 16653.07,-8811.85 16656,-8811.02 16723.42,-8791.93 16801.18,-8775.55 16858.89,-8764.45"/>
<polygon fill="black" stroke="black" points="16859.9,-8767.82 16869.06,-8762.51 16858.58,-8760.94 16859.9,-8767.82"/>
</g>
<!-- layer_14_mlp2_gpu15&#45;&gt;layer_14_mlp_allreduce -->
<g id="edge1034" class="edge">
<title>layer_14_mlp2_gpu15&#45;&gt;layer_14_mlp_allreduce</title>
<path fill="none" stroke="black" d="M16503,-8813.41C16506.03,-8812.56 16509.04,-8811.75 16512,-8811.02 16626.41,-8782.87 16761.23,-8766.09 16849.44,-8757.25"/>
<polygon fill="black" stroke="black" points="16849.82,-8760.73 16859.43,-8756.27 16849.14,-8753.77 16849.82,-8760.73"/>
</g>
<!-- layer_14_residual2 -->
<g id="node825" class="node">
<title>layer_14_residual2</title>
<polygon fill="lightyellow" stroke="black" points="17081.78,-8685.28 16862.6,-8685.28 16806.22,-8609.28 17025.4,-8609.28 17081.78,-8685.28"/>
<text text-anchor="middle" x="16944" y="-8651.08" font-family="Times,serif" font-size="14.00">Residual Add 14</text>
<text text-anchor="middle" x="16944" y="-8636.08" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_14_mlp_allreduce&#45;&gt;layer_14_residual2 -->
<g id="edge1035" class="edge">
<title>layer_14_mlp_allreduce&#45;&gt;layer_14_residual2</title>
<path fill="none" stroke="black" d="M16944,-8721.18C16944,-8713.36 16944,-8704.53 16944,-8695.78"/>
<polygon fill="black" stroke="black" points="16947.5,-8695.61 16944,-8685.61 16940.5,-8695.61 16947.5,-8695.61"/>
</g>
<!-- layer_14_ln2 -->
<g id="node826" class="node">
<title>layer_14_ln2</title>
<polygon fill="lightblue" stroke="black" points="17004,-8554.28 16884,-8554.28 16884,-8516.28 17004,-8516.28 17004,-8554.28"/>
<text text-anchor="middle" x="16944" y="-8539.08" font-family="Times,serif" font-size="14.00">LayerNorm 14</text>
<text text-anchor="middle" x="16944" y="-8524.08" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_14_residual2&#45;&gt;layer_14_ln2 -->
<g id="edge1036" class="edge">
<title>layer_14_residual2&#45;&gt;layer_14_ln2</title>
<path fill="none" stroke="black" d="M16944,-8609.04C16944,-8594.48 16944,-8578.07 16944,-8564.52"/>
<polygon fill="black" stroke="black" points="16947.5,-8564.35 16944,-8554.35 16940.5,-8564.35 16947.5,-8564.35"/>
</g>
<!-- layer_15_qkv_gpu0 -->
<g id="node891" class="node">
<title>layer_15_qkv_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="17088.69,-8411.28 16858.52,-8411.28 16799.31,-8375.28 17029.48,-8375.28 17088.69,-8411.28"/>
<text text-anchor="middle" x="16944" y="-8389.58" font-family="Times,serif" font-size="14.00">layer_15_qkv_gpu0</text>
</g>
<!-- layer_14_ln2&#45;&gt;layer_15_qkv_gpu0 -->
<g id="edge1037" class="edge">
<title>layer_14_ln2&#45;&gt;layer_15_qkv_gpu0</title>
<path fill="none" stroke="black" d="M16944,-8516.27C16944,-8492.27 16944,-8449.62 16944,-8421.64"/>
<polygon fill="black" stroke="black" points="16947.5,-8421.35 16944,-8411.35 16940.5,-8421.35 16947.5,-8421.35"/>
</g>
<!-- layer_15_qkv_gpu8 -->
<g id="node827" class="node">
<title>layer_15_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="19327,-9763.37 19199,-9763.37 19199,-9710.37 19327,-9710.37 19327,-9763.37"/>
<text text-anchor="middle" x="19263" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU8</text>
<text text-anchor="middle" x="19263" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="19263" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_15_qkv_comm -->
<g id="node835" class="node">
<title>layer_15_qkv_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="18733" cy="-9603.37" rx="85.62" ry="26.74"/>
<text text-anchor="middle" x="18733" y="-9607.17" font-family="Times,serif" font-size="14.00">QKV AllGather</text>
<text text-anchor="middle" x="18733" y="-9592.17" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_15_qkv_gpu8&#45;&gt;layer_15_qkv_comm -->
<g id="edge1038" class="edge">
<title>layer_15_qkv_gpu8&#45;&gt;layer_15_qkv_comm</title>
<path fill="none" stroke="black" d="M19242.05,-9710.1C19228.73,-9695.55 19210.22,-9678.43 19190,-9668.87 19127.32,-9639.26 18940.6,-9620.21 18826.15,-9610.98"/>
<polygon fill="black" stroke="black" points="18826.24,-9607.47 18815.99,-9610.17 18825.68,-9614.45 18826.24,-9607.47"/>
</g>
<!-- layer_15_qkv_gpu9 -->
<g id="node828" class="node">
<title>layer_15_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="19181,-9763.37 19053,-9763.37 19053,-9710.37 19181,-9710.37 19181,-9763.37"/>
<text text-anchor="middle" x="19117" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU9</text>
<text text-anchor="middle" x="19117" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="19117" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_15_qkv_gpu9&#45;&gt;layer_15_qkv_comm -->
<g id="edge1039" class="edge">
<title>layer_15_qkv_gpu9&#45;&gt;layer_15_qkv_comm</title>
<path fill="none" stroke="black" d="M19095.51,-9710.24C19082.13,-9695.93 19063.75,-9678.99 19044,-9668.87 18976.11,-9634.08 18890.77,-9618.06 18826.66,-9610.68"/>
<polygon fill="black" stroke="black" points="18826.89,-9607.18 18816.56,-9609.56 18826.12,-9614.14 18826.89,-9607.18"/>
</g>
<!-- layer_15_qkv_gpu10 -->
<g id="node829" class="node">
<title>layer_15_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="19034.5,-9763.37 18897.5,-9763.37 18897.5,-9710.37 19034.5,-9710.37 19034.5,-9763.37"/>
<text text-anchor="middle" x="18966" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU10</text>
<text text-anchor="middle" x="18966" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="18966" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_15_qkv_gpu10&#45;&gt;layer_15_qkv_comm -->
<g id="edge1040" class="edge">
<title>layer_15_qkv_gpu10&#45;&gt;layer_15_qkv_comm</title>
<path fill="none" stroke="black" d="M18940.94,-9710.35C18926.64,-9696.77 18907.84,-9680.53 18889,-9668.87 18861.57,-9651.9 18828.89,-9637.6 18800.55,-9626.81"/>
<polygon fill="black" stroke="black" points="18801.71,-9623.51 18791.12,-9623.29 18799.26,-9630.07 18801.71,-9623.51"/>
</g>
<!-- layer_15_qkv_gpu11 -->
<g id="node830" class="node">
<title>layer_15_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="18879.5,-9763.37 18742.5,-9763.37 18742.5,-9710.37 18879.5,-9710.37 18879.5,-9763.37"/>
<text text-anchor="middle" x="18811" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU11</text>
<text text-anchor="middle" x="18811" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="18811" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_15_qkv_gpu11&#45;&gt;layer_15_qkv_comm -->
<g id="edge1041" class="edge">
<title>layer_15_qkv_gpu11&#45;&gt;layer_15_qkv_comm</title>
<path fill="none" stroke="black" d="M18795.78,-9710.21C18783.7,-9689.84 18766.7,-9661.18 18753.43,-9638.82"/>
<polygon fill="black" stroke="black" points="18756.3,-9636.79 18748.19,-9629.97 18750.28,-9640.36 18756.3,-9636.79"/>
</g>
<!-- layer_15_qkv_gpu12 -->
<g id="node831" class="node">
<title>layer_15_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="18724.5,-9763.37 18587.5,-9763.37 18587.5,-9710.37 18724.5,-9710.37 18724.5,-9763.37"/>
<text text-anchor="middle" x="18656" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU12</text>
<text text-anchor="middle" x="18656" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="18656" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_15_qkv_gpu12&#45;&gt;layer_15_qkv_comm -->
<g id="edge1042" class="edge">
<title>layer_15_qkv_gpu12&#45;&gt;layer_15_qkv_comm</title>
<path fill="none" stroke="black" d="M18671.03,-9710.21C18682.95,-9689.84 18699.74,-9661.18 18712.83,-9638.82"/>
<polygon fill="black" stroke="black" points="18715.98,-9640.37 18718.01,-9629.97 18709.94,-9636.84 18715.98,-9640.37"/>
</g>
<!-- layer_15_qkv_gpu13 -->
<g id="node832" class="node">
<title>layer_15_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="18569.5,-9763.37 18432.5,-9763.37 18432.5,-9710.37 18569.5,-9710.37 18569.5,-9763.37"/>
<text text-anchor="middle" x="18501" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU13</text>
<text text-anchor="middle" x="18501" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="18501" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_15_qkv_gpu13&#45;&gt;layer_15_qkv_comm -->
<g id="edge1043" class="edge">
<title>layer_15_qkv_gpu13&#45;&gt;layer_15_qkv_comm</title>
<path fill="none" stroke="black" d="M18526.8,-9710.08C18541.28,-9696.59 18560.17,-9680.5 18579,-9668.87 18606.03,-9652.19 18638.13,-9637.97 18666.02,-9627.16"/>
<polygon fill="black" stroke="black" points="18667.59,-9630.31 18675.69,-9623.48 18665.1,-9623.76 18667.59,-9630.31"/>
</g>
<!-- layer_15_qkv_gpu14 -->
<g id="node833" class="node">
<title>layer_15_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="18414.5,-9763.37 18277.5,-9763.37 18277.5,-9710.37 18414.5,-9710.37 18414.5,-9763.37"/>
<text text-anchor="middle" x="18346" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU14</text>
<text text-anchor="middle" x="18346" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="18346" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_15_qkv_gpu14&#45;&gt;layer_15_qkv_comm -->
<g id="edge1044" class="edge">
<title>layer_15_qkv_gpu14&#45;&gt;layer_15_qkv_comm</title>
<path fill="none" stroke="black" d="M18369.29,-9710.28C18383.7,-9695.98 18403.34,-9679.05 18424,-9668.87 18492.01,-9635.37 18576.76,-9619.24 18640.29,-9611.49"/>
<polygon fill="black" stroke="black" points="18640.77,-9614.96 18650.3,-9610.32 18639.96,-9608.01 18640.77,-9614.96"/>
</g>
<!-- layer_15_qkv_gpu15 -->
<g id="node834" class="node">
<title>layer_15_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="18259.5,-9763.37 18122.5,-9763.37 18122.5,-9710.37 18259.5,-9710.37 18259.5,-9763.37"/>
<text text-anchor="middle" x="18191" y="-9748.17" font-family="Times,serif" font-size="14.00">QKV Proj GPU15</text>
<text text-anchor="middle" x="18191" y="-9733.17" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="18191" y="-9718.17" font-family="Times,serif" font-size="14.00">Dim: 512x1536</text>
</g>
<!-- layer_15_qkv_gpu15&#45;&gt;layer_15_qkv_comm -->
<g id="edge1045" class="edge">
<title>layer_15_qkv_gpu15&#45;&gt;layer_15_qkv_comm</title>
<path fill="none" stroke="black" d="M18213.71,-9710.1C18228.06,-9695.55 18247.85,-9678.42 18269,-9668.87 18333.31,-9639.85 18523.6,-9620.54 18639.56,-9611.11"/>
<polygon fill="black" stroke="black" points="18640.16,-9614.57 18649.85,-9610.28 18639.6,-9607.59 18640.16,-9614.57"/>
</g>
<!-- layer_15_attn_comp_gpu8 -->
<g id="node836" class="node">
<title>layer_15_attn_comp_gpu8</title>
<polygon fill="lightblue" stroke="black" points="18058,-9540.13 17860,-9540.13 17860,-9487.13 18058,-9487.13 18058,-9540.13"/>
<text text-anchor="middle" x="17959" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU8</text>
<text text-anchor="middle" x="17959" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="17959" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_15_qkv_comm&#45;&gt;layer_15_attn_comp_gpu8 -->
<g id="edge1046" class="edge">
<title>layer_15_qkv_comm&#45;&gt;layer_15_attn_comp_gpu8</title>
<path fill="none" stroke="black" d="M18648.66,-9598.4C18523.76,-9591.65 18282.21,-9575.34 18068.22,-9540.61"/>
<polygon fill="black" stroke="black" points="18068.49,-9537.1 18058.05,-9538.94 18067.36,-9544.01 18068.49,-9537.1"/>
</g>
<!-- layer_15_attn_comp_gpu9 -->
<g id="node837" class="node">
<title>layer_15_attn_comp_gpu9</title>
<polygon fill="lightblue" stroke="black" points="18274,-9540.13 18076,-9540.13 18076,-9487.13 18274,-9487.13 18274,-9540.13"/>
<text text-anchor="middle" x="18175" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU9</text>
<text text-anchor="middle" x="18175" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="18175" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_15_qkv_comm&#45;&gt;layer_15_attn_comp_gpu9 -->
<g id="edge1047" class="edge">
<title>layer_15_qkv_comm&#45;&gt;layer_15_attn_comp_gpu9</title>
<path fill="none" stroke="black" d="M18653.14,-9593.72C18563.07,-9583.41 18412.39,-9564.53 18284,-9540.5 18283.9,-9540.48 18283.8,-9540.46 18283.7,-9540.45"/>
<polygon fill="black" stroke="black" points="18284.61,-9537.06 18274.12,-9538.59 18283.27,-9543.93 18284.61,-9537.06"/>
</g>
<!-- layer_15_attn_comp_gpu10 -->
<g id="node838" class="node">
<title>layer_15_attn_comp_gpu10</title>
<polygon fill="lightblue" stroke="black" points="18499.5,-9540.13 18292.5,-9540.13 18292.5,-9487.13 18499.5,-9487.13 18499.5,-9540.13"/>
<text text-anchor="middle" x="18396" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU10</text>
<text text-anchor="middle" x="18396" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="18396" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_15_qkv_comm&#45;&gt;layer_15_attn_comp_gpu10 -->
<g id="edge1048" class="edge">
<title>layer_15_qkv_comm&#45;&gt;layer_15_attn_comp_gpu10</title>
<path fill="none" stroke="black" d="M18668.42,-9585.56C18622,-9573.47 18558.32,-9556.89 18504.2,-9542.8"/>
<polygon fill="black" stroke="black" points="18504.77,-9539.33 18494.21,-9540.2 18503,-9546.11 18504.77,-9539.33"/>
</g>
<!-- layer_15_attn_comp_gpu11 -->
<g id="node839" class="node">
<title>layer_15_attn_comp_gpu11</title>
<polygon fill="lightblue" stroke="black" points="18724.5,-9540.13 18517.5,-9540.13 18517.5,-9487.13 18724.5,-9487.13 18724.5,-9540.13"/>
<text text-anchor="middle" x="18621" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU11</text>
<text text-anchor="middle" x="18621" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="18621" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_15_qkv_comm&#45;&gt;layer_15_attn_comp_gpu11 -->
<g id="edge1049" class="edge">
<title>layer_15_qkv_comm&#45;&gt;layer_15_attn_comp_gpu11</title>
<path fill="none" stroke="black" d="M18702.1,-9578.17C18689.66,-9568.42 18675.14,-9557.04 18661.84,-9546.63"/>
<polygon fill="black" stroke="black" points="18663.79,-9543.71 18653.76,-9540.29 18659.47,-9549.22 18663.79,-9543.71"/>
</g>
<!-- layer_15_attn_comp_gpu12 -->
<g id="node840" class="node">
<title>layer_15_attn_comp_gpu12</title>
<polygon fill="lightblue" stroke="black" points="18949.5,-9540.13 18742.5,-9540.13 18742.5,-9487.13 18949.5,-9487.13 18949.5,-9540.13"/>
<text text-anchor="middle" x="18846" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU12</text>
<text text-anchor="middle" x="18846" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="18846" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_15_qkv_comm&#45;&gt;layer_15_attn_comp_gpu12 -->
<g id="edge1050" class="edge">
<title>layer_15_qkv_comm&#45;&gt;layer_15_attn_comp_gpu12</title>
<path fill="none" stroke="black" d="M18764.18,-9578.17C18776.73,-9568.42 18791.38,-9557.04 18804.79,-9546.63"/>
<polygon fill="black" stroke="black" points="18807.2,-9549.19 18812.95,-9540.29 18802.91,-9543.66 18807.2,-9549.19"/>
</g>
<!-- layer_15_attn_comp_gpu13 -->
<g id="node841" class="node">
<title>layer_15_attn_comp_gpu13</title>
<polygon fill="lightblue" stroke="black" points="19174.5,-9540.13 18967.5,-9540.13 18967.5,-9487.13 19174.5,-9487.13 19174.5,-9540.13"/>
<text text-anchor="middle" x="19071" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU13</text>
<text text-anchor="middle" x="19071" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="19071" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_15_qkv_comm&#45;&gt;layer_15_attn_comp_gpu13 -->
<g id="edge1051" class="edge">
<title>layer_15_qkv_comm&#45;&gt;layer_15_attn_comp_gpu13</title>
<path fill="none" stroke="black" d="M18797.37,-9585.66C18844.08,-9573.54 18908.37,-9556.85 18962.89,-9542.7"/>
<polygon fill="black" stroke="black" points="18963.8,-9546.08 18972.6,-9540.18 18962.04,-9539.3 18963.8,-9546.08"/>
</g>
<!-- layer_15_attn_comp_gpu14 -->
<g id="node842" class="node">
<title>layer_15_attn_comp_gpu14</title>
<polygon fill="lightblue" stroke="black" points="19399.5,-9540.13 19192.5,-9540.13 19192.5,-9487.13 19399.5,-9487.13 19399.5,-9540.13"/>
<text text-anchor="middle" x="19296" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU14</text>
<text text-anchor="middle" x="19296" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="19296" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_15_qkv_comm&#45;&gt;layer_15_attn_comp_gpu14 -->
<g id="edge1052" class="edge">
<title>layer_15_qkv_comm&#45;&gt;layer_15_attn_comp_gpu14</title>
<path fill="none" stroke="black" d="M18812.78,-9593.64C18900.98,-9583.49 19047.41,-9565.16 19182.24,-9540.77"/>
<polygon fill="black" stroke="black" points="19183.13,-9544.16 19192.34,-9538.93 19181.87,-9537.28 19183.13,-9544.16"/>
</g>
<!-- layer_15_attn_comp_gpu15 -->
<g id="node843" class="node">
<title>layer_15_attn_comp_gpu15</title>
<polygon fill="lightblue" stroke="black" points="19624.5,-9540.13 19417.5,-9540.13 19417.5,-9487.13 19624.5,-9487.13 19624.5,-9540.13"/>
<text text-anchor="middle" x="19521" y="-9524.93" font-family="Times,serif" font-size="14.00">Attention Compute GPU15</text>
<text text-anchor="middle" x="19521" y="-9509.93" font-family="Times,serif" font-size="14.00">4 heads</text>
<text text-anchor="middle" x="19521" y="-9494.93" font-family="Times,serif" font-size="14.00">Seq: 10000x128</text>
</g>
<!-- layer_15_qkv_comm&#45;&gt;layer_15_attn_comp_gpu15 -->
<g id="edge1053" class="edge">
<title>layer_15_qkv_comm&#45;&gt;layer_15_attn_comp_gpu15</title>
<path fill="none" stroke="black" d="M18817.24,-9598.34C18943.64,-9591.48 19189.91,-9574.96 19407.36,-9540.69"/>
<polygon fill="black" stroke="black" points="19408.04,-9544.12 19417.36,-9539.09 19406.94,-9537.21 19408.04,-9544.12"/>
</g>
<!-- layer_15_attn_out_gpu8 -->
<g id="node844" class="node">
<title>layer_15_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="18074,-9450.76 17916,-9450.76 17916,-9397.76 18074,-9397.76 18074,-9450.76"/>
<text text-anchor="middle" x="17995" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU8</text>
<text text-anchor="middle" x="17995" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="17995" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_15_attn_comp_gpu8&#45;&gt;layer_15_attn_out_gpu8 -->
<g id="edge1054" class="edge">
<title>layer_15_attn_comp_gpu8&#45;&gt;layer_15_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M17969.61,-9486.89C17973.05,-9478.54 17976.93,-9469.12 17980.6,-9460.21"/>
<polygon fill="black" stroke="black" points="17983.9,-9461.4 17984.47,-9450.82 17977.42,-9458.73 17983.9,-9461.4"/>
</g>
<!-- layer_15_attn_out_gpu9 -->
<g id="node845" class="node">
<title>layer_15_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="18287,-9450.76 18129,-9450.76 18129,-9397.76 18287,-9397.76 18287,-9450.76"/>
<text text-anchor="middle" x="18208" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU9</text>
<text text-anchor="middle" x="18208" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="18208" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_15_attn_comp_gpu9&#45;&gt;layer_15_attn_out_gpu9 -->
<g id="edge1055" class="edge">
<title>layer_15_attn_comp_gpu9&#45;&gt;layer_15_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M18184.72,-9486.89C18187.88,-9478.54 18191.43,-9469.12 18194.8,-9460.21"/>
<polygon fill="black" stroke="black" points="18198.09,-9461.41 18198.35,-9450.82 18191.54,-9458.94 18198.09,-9461.41"/>
</g>
<!-- layer_15_attn_out_gpu10 -->
<g id="node846" class="node">
<title>layer_15_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="18504.5,-9450.76 18337.5,-9450.76 18337.5,-9397.76 18504.5,-9397.76 18504.5,-9450.76"/>
<text text-anchor="middle" x="18421" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU10</text>
<text text-anchor="middle" x="18421" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="18421" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_15_attn_comp_gpu10&#45;&gt;layer_15_attn_out_gpu10 -->
<g id="edge1056" class="edge">
<title>layer_15_attn_comp_gpu10&#45;&gt;layer_15_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M18403.37,-9486.89C18405.73,-9478.63 18408.39,-9469.32 18410.92,-9460.5"/>
<polygon fill="black" stroke="black" points="18414.3,-9461.4 18413.69,-9450.82 18407.57,-9459.47 18414.3,-9461.4"/>
</g>
<!-- layer_15_attn_out_gpu11 -->
<g id="node847" class="node">
<title>layer_15_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="18714.5,-9450.76 18547.5,-9450.76 18547.5,-9397.76 18714.5,-9397.76 18714.5,-9450.76"/>
<text text-anchor="middle" x="18631" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU11</text>
<text text-anchor="middle" x="18631" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="18631" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_15_attn_comp_gpu11&#45;&gt;layer_15_attn_out_gpu11 -->
<g id="edge1057" class="edge">
<title>layer_15_attn_comp_gpu11&#45;&gt;layer_15_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M18623.95,-9486.89C18624.88,-9478.72 18625.93,-9469.52 18626.93,-9460.78"/>
<polygon fill="black" stroke="black" points="18630.41,-9461.15 18628.07,-9450.82 18623.46,-9460.36 18630.41,-9461.15"/>
</g>
<!-- layer_15_attn_out_gpu12 -->
<g id="node848" class="node">
<title>layer_15_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="18919.5,-9450.76 18752.5,-9450.76 18752.5,-9397.76 18919.5,-9397.76 18919.5,-9450.76"/>
<text text-anchor="middle" x="18836" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU12</text>
<text text-anchor="middle" x="18836" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="18836" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_15_attn_comp_gpu12&#45;&gt;layer_15_attn_out_gpu12 -->
<g id="edge1058" class="edge">
<title>layer_15_attn_comp_gpu12&#45;&gt;layer_15_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M18843.05,-9486.89C18842.12,-9478.72 18841.07,-9469.52 18840.07,-9460.78"/>
<polygon fill="black" stroke="black" points="18843.54,-9460.36 18838.93,-9450.82 18836.59,-9461.15 18843.54,-9460.36"/>
</g>
<!-- layer_15_attn_out_gpu13 -->
<g id="node849" class="node">
<title>layer_15_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="19134.5,-9450.76 18967.5,-9450.76 18967.5,-9397.76 19134.5,-9397.76 19134.5,-9450.76"/>
<text text-anchor="middle" x="19051" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU13</text>
<text text-anchor="middle" x="19051" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="19051" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_15_attn_comp_gpu13&#45;&gt;layer_15_attn_out_gpu13 -->
<g id="edge1059" class="edge">
<title>layer_15_attn_comp_gpu13&#45;&gt;layer_15_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M19065.11,-9486.89C19063.24,-9478.72 19061.13,-9469.52 19059.13,-9460.78"/>
<polygon fill="black" stroke="black" points="19062.49,-9459.79 19056.85,-9450.82 19055.67,-9461.35 19062.49,-9459.79"/>
</g>
<!-- layer_15_attn_out_gpu14 -->
<g id="node850" class="node">
<title>layer_15_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="19354.5,-9450.76 19187.5,-9450.76 19187.5,-9397.76 19354.5,-9397.76 19354.5,-9450.76"/>
<text text-anchor="middle" x="19271" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU14</text>
<text text-anchor="middle" x="19271" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="19271" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_15_attn_comp_gpu14&#45;&gt;layer_15_attn_out_gpu14 -->
<g id="edge1060" class="edge">
<title>layer_15_attn_comp_gpu14&#45;&gt;layer_15_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M19288.63,-9486.89C19286.27,-9478.63 19283.61,-9469.32 19281.08,-9460.5"/>
<polygon fill="black" stroke="black" points="19284.43,-9459.47 19278.31,-9450.82 19277.7,-9461.4 19284.43,-9459.47"/>
</g>
<!-- layer_15_attn_out_gpu15 -->
<g id="node851" class="node">
<title>layer_15_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="19576.5,-9450.76 19409.5,-9450.76 19409.5,-9397.76 19576.5,-9397.76 19576.5,-9450.76"/>
<text text-anchor="middle" x="19493" y="-9435.56" font-family="Times,serif" font-size="14.00">Attn Out Proj GPU15</text>
<text text-anchor="middle" x="19493" y="-9420.56" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="19493" y="-9405.56" font-family="Times,serif" font-size="14.00">Dim: 512x512</text>
</g>
<!-- layer_15_attn_comp_gpu15&#45;&gt;layer_15_attn_out_gpu15 -->
<g id="edge1061" class="edge">
<title>layer_15_attn_comp_gpu15&#45;&gt;layer_15_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M19512.75,-9486.89C19510.1,-9478.63 19507.12,-9469.32 19504.29,-9460.5"/>
<polygon fill="black" stroke="black" points="19507.58,-9459.27 19501.19,-9450.82 19500.91,-9461.41 19507.58,-9459.27"/>
</g>
<!-- layer_15_attn_allreduce -->
<g id="node852" class="node">
<title>layer_15_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="18733" cy="-9334.89" rx="112.36" ry="26.74"/>
<text text-anchor="middle" x="18733" y="-9338.69" font-family="Times,serif" font-size="14.00">Attention AllReduce</text>
<text text-anchor="middle" x="18733" y="-9323.69" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_15_attn_out_gpu8&#45;&gt;layer_15_attn_allreduce -->
<g id="edge1062" class="edge">
<title>layer_15_attn_out_gpu8&#45;&gt;layer_15_attn_allreduce</title>
<path fill="none" stroke="black" d="M18074.14,-9405.87C18089.31,-9402.89 18105.11,-9400.03 18120,-9397.76 18291.77,-9371.64 18492.36,-9353.76 18616.03,-9344.18"/>
<polygon fill="black" stroke="black" points="18616.58,-9347.65 18626.28,-9343.39 18616.04,-9340.67 18616.58,-9347.65"/>
</g>
<!-- layer_15_attn_out_gpu9&#45;&gt;layer_15_attn_allreduce -->
<g id="edge1063" class="edge">
<title>layer_15_attn_out_gpu9&#45;&gt;layer_15_attn_allreduce</title>
<path fill="none" stroke="black" d="M18287.28,-9405.89C18301.16,-9403.04 18315.48,-9400.22 18329,-9397.76 18429.76,-9379.45 18545.32,-9362.12 18626.96,-9350.48"/>
<polygon fill="black" stroke="black" points="18627.84,-9353.89 18637.25,-9349.02 18626.85,-9346.96 18627.84,-9353.89"/>
</g>
<!-- layer_15_attn_out_gpu10&#45;&gt;layer_15_attn_allreduce -->
<g id="edge1064" class="edge">
<title>layer_15_attn_out_gpu10&#45;&gt;layer_15_attn_allreduce</title>
<path fill="none" stroke="black" d="M18504.61,-9399.85C18550.35,-9387.04 18606.76,-9371.24 18652.07,-9358.55"/>
<polygon fill="black" stroke="black" points="18653.18,-9361.88 18661.86,-9355.81 18651.29,-9355.14 18653.18,-9361.88"/>
</g>
<!-- layer_15_attn_out_gpu11&#45;&gt;layer_15_attn_allreduce -->
<g id="edge1065" class="edge">
<title>layer_15_attn_out_gpu11&#45;&gt;layer_15_attn_allreduce</title>
<path fill="none" stroke="black" d="M18660.78,-9397.76C18671.77,-9388.34 18684.35,-9377.56 18695.91,-9367.66"/>
<polygon fill="black" stroke="black" points="18698.4,-9370.14 18703.71,-9360.98 18693.84,-9364.83 18698.4,-9370.14"/>
</g>
<!-- layer_15_attn_out_gpu12&#45;&gt;layer_15_attn_allreduce -->
<g id="edge1066" class="edge">
<title>layer_15_attn_out_gpu12&#45;&gt;layer_15_attn_allreduce</title>
<path fill="none" stroke="black" d="M18805.93,-9397.76C18794.83,-9388.34 18782.12,-9377.56 18770.45,-9367.66"/>
<polygon fill="black" stroke="black" points="18772.46,-9364.78 18762.57,-9360.98 18767.93,-9370.12 18772.46,-9364.78"/>
</g>
<!-- layer_15_attn_out_gpu13&#45;&gt;layer_15_attn_allreduce -->
<g id="edge1067" class="edge">
<title>layer_15_attn_out_gpu13&#45;&gt;layer_15_attn_allreduce</title>
<path fill="none" stroke="black" d="M18967.45,-9400.31C18920.29,-9387.35 18861.6,-9371.23 18814.74,-9358.35"/>
<polygon fill="black" stroke="black" points="18815.5,-9354.93 18804.93,-9355.66 18813.65,-9361.68 18815.5,-9354.93"/>
</g>
<!-- layer_15_attn_out_gpu14&#45;&gt;layer_15_attn_allreduce -->
<g id="edge1068" class="edge">
<title>layer_15_attn_out_gpu14&#45;&gt;layer_15_attn_allreduce</title>
<path fill="none" stroke="black" d="M19187.42,-9405.88C19172.97,-9403.05 19158.07,-9400.23 19144,-9397.76 19040.7,-9379.63 18922.22,-9362.14 18839.09,-9350.41"/>
<polygon fill="black" stroke="black" points="18839.52,-9346.94 18829.13,-9349.01 18838.55,-9353.87 18839.52,-9346.94"/>
</g>
<!-- layer_15_attn_out_gpu15&#45;&gt;layer_15_attn_allreduce -->
<g id="edge1069" class="edge">
<title>layer_15_attn_out_gpu15&#45;&gt;layer_15_attn_allreduce</title>
<path fill="none" stroke="black" d="M19409.24,-9405.48C19394.22,-9402.64 19378.68,-9399.93 19364,-9397.76 19185.61,-9371.45 18977.15,-9353.48 18850.15,-9343.95"/>
<polygon fill="black" stroke="black" points="18850.24,-9340.44 18840.01,-9343.19 18849.72,-9347.43 18850.24,-9340.44"/>
</g>
<!-- layer_15_residual1 -->
<g id="node853" class="node">
<title>layer_15_residual1</title>
<polygon fill="lightyellow" stroke="black" points="18870.78,-9272.02 18651.6,-9272.02 18595.22,-9196.02 18814.4,-9196.02 18870.78,-9272.02"/>
<text text-anchor="middle" x="18733" y="-9237.82" font-family="Times,serif" font-size="14.00">Residual Add 15</text>
<text text-anchor="middle" x="18733" y="-9222.82" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_15_attn_allreduce&#45;&gt;layer_15_residual1 -->
<g id="edge1070" class="edge">
<title>layer_15_attn_allreduce&#45;&gt;layer_15_residual1</title>
<path fill="none" stroke="black" d="M18733,-9307.92C18733,-9300.1 18733,-9291.27 18733,-9282.52"/>
<polygon fill="black" stroke="black" points="18736.5,-9282.35 18733,-9272.35 18729.5,-9282.35 18736.5,-9282.35"/>
</g>
<!-- layer_15_ln1 -->
<g id="node854" class="node">
<title>layer_15_ln1</title>
<polygon fill="lightblue" stroke="black" points="18793,-9141.02 18673,-9141.02 18673,-9103.02 18793,-9103.02 18793,-9141.02"/>
<text text-anchor="middle" x="18733" y="-9125.82" font-family="Times,serif" font-size="14.00">LayerNorm 15</text>
<text text-anchor="middle" x="18733" y="-9110.82" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_15_residual1&#45;&gt;layer_15_ln1 -->
<g id="edge1071" class="edge">
<title>layer_15_residual1&#45;&gt;layer_15_ln1</title>
<path fill="none" stroke="black" d="M18733,-9195.78C18733,-9181.22 18733,-9164.81 18733,-9151.26"/>
<polygon fill="black" stroke="black" points="18736.5,-9151.09 18733,-9141.09 18729.5,-9151.09 18736.5,-9151.09"/>
</g>
<!-- layer_15_mlp1_gpu8 -->
<g id="node855" class="node">
<title>layer_15_mlp1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="19300,-9045.02 19174,-9045.02 19174,-8992.02 19300,-8992.02 19300,-9045.02"/>
<text text-anchor="middle" x="19237" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU8</text>
<text text-anchor="middle" x="19237" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="19237" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp1_gpu8 -->
<g id="edge1072" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp1_gpu8</title>
<path fill="none" stroke="black" d="M18793.12,-9118.87C18895.5,-9114.51 19099.03,-9102.72 19165,-9076.02 19178.87,-9070.41 19192.27,-9061.28 19203.68,-9051.99"/>
<polygon fill="black" stroke="black" points="19206.27,-9054.38 19211.61,-9045.24 19201.73,-9049.05 19206.27,-9054.38"/>
</g>
<!-- layer_15_mlp1_gpu9 -->
<g id="node856" class="node">
<title>layer_15_mlp1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="19156,-9045.02 19030,-9045.02 19030,-8992.02 19156,-8992.02 19156,-9045.02"/>
<text text-anchor="middle" x="19093" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU9</text>
<text text-anchor="middle" x="19093" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="19093" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp1_gpu9 -->
<g id="edge1076" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp1_gpu9</title>
<path fill="none" stroke="black" d="M18793.08,-9120.39C18853.1,-9117.79 18946.86,-9108.26 19021,-9076.02 19034.6,-9070.11 19047.86,-9061 19059.21,-9051.8"/>
<polygon fill="black" stroke="black" points="19061.73,-9054.26 19067.12,-9045.14 19057.22,-9048.91 19061.73,-9054.26"/>
</g>
<!-- layer_15_mlp1_gpu10 -->
<g id="node857" class="node">
<title>layer_15_mlp1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="19012,-9045.02 18886,-9045.02 18886,-8992.02 19012,-8992.02 19012,-9045.02"/>
<text text-anchor="middle" x="18949" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU10</text>
<text text-anchor="middle" x="18949" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="18949" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp1_gpu10 -->
<g id="edge1080" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp1_gpu10</title>
<path fill="none" stroke="black" d="M18793.08,-9107.48C18819.68,-9100.18 18850.8,-9089.8 18877,-9076.02 18889.67,-9069.36 18902.35,-9060.38 18913.45,-9051.55"/>
<polygon fill="black" stroke="black" points="18915.71,-9054.22 18921.24,-9045.18 18911.28,-9048.8 18915.71,-9054.22"/>
</g>
<!-- layer_15_mlp1_gpu11 -->
<g id="node858" class="node">
<title>layer_15_mlp1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="18868,-9045.02 18742,-9045.02 18742,-8992.02 18868,-8992.02 18868,-9045.02"/>
<text text-anchor="middle" x="18805" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU11</text>
<text text-anchor="middle" x="18805" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="18805" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp1_gpu11 -->
<g id="edge1084" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp1_gpu11</title>
<path fill="none" stroke="black" d="M18745.87,-9102.88C18755.59,-9089.18 18769.19,-9070 18780.91,-9053.49"/>
<polygon fill="black" stroke="black" points="18783.9,-9055.32 18786.83,-9045.14 18778.19,-9051.27 18783.9,-9055.32"/>
</g>
<!-- layer_15_mlp1_gpu12 -->
<g id="node859" class="node">
<title>layer_15_mlp1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="18724,-9045.02 18598,-9045.02 18598,-8992.02 18724,-8992.02 18724,-9045.02"/>
<text text-anchor="middle" x="18661" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU12</text>
<text text-anchor="middle" x="18661" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="18661" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp1_gpu12 -->
<g id="edge1088" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp1_gpu12</title>
<path fill="none" stroke="black" d="M18720.13,-9102.88C18710.41,-9089.18 18696.81,-9070 18685.09,-9053.49"/>
<polygon fill="black" stroke="black" points="18687.81,-9051.27 18679.17,-9045.14 18682.1,-9055.32 18687.81,-9051.27"/>
</g>
<!-- layer_15_mlp1_gpu13 -->
<g id="node860" class="node">
<title>layer_15_mlp1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="18580,-9045.02 18454,-9045.02 18454,-8992.02 18580,-8992.02 18580,-9045.02"/>
<text text-anchor="middle" x="18517" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU13</text>
<text text-anchor="middle" x="18517" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="18517" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp1_gpu13 -->
<g id="edge1092" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp1_gpu13</title>
<path fill="none" stroke="black" d="M18672.92,-9107.48C18646.32,-9100.18 18615.2,-9089.8 18589,-9076.02 18576.33,-9069.36 18563.65,-9060.38 18552.55,-9051.55"/>
<polygon fill="black" stroke="black" points="18554.72,-9048.8 18544.76,-9045.18 18550.29,-9054.22 18554.72,-9048.8"/>
</g>
<!-- layer_15_mlp1_gpu14 -->
<g id="node861" class="node">
<title>layer_15_mlp1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="18436,-9045.02 18310,-9045.02 18310,-8992.02 18436,-8992.02 18436,-9045.02"/>
<text text-anchor="middle" x="18373" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU14</text>
<text text-anchor="middle" x="18373" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="18373" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp1_gpu14 -->
<g id="edge1096" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp1_gpu14</title>
<path fill="none" stroke="black" d="M18672.92,-9120.39C18612.9,-9117.79 18519.14,-9108.26 18445,-9076.02 18431.4,-9070.11 18418.14,-9061 18406.79,-9051.8"/>
<polygon fill="black" stroke="black" points="18408.78,-9048.91 18398.88,-9045.14 18404.27,-9054.26 18408.78,-9048.91"/>
</g>
<!-- layer_15_mlp1_gpu15 -->
<g id="node862" class="node">
<title>layer_15_mlp1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="18292,-9045.02 18166,-9045.02 18166,-8992.02 18292,-8992.02 18292,-9045.02"/>
<text text-anchor="middle" x="18229" y="-9029.82" font-family="Times,serif" font-size="14.00">MLP1 GPU15</text>
<text text-anchor="middle" x="18229" y="-9014.82" font-family="Times,serif" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="18229" y="-8999.82" font-family="Times,serif" font-size="14.00">Dim: 512x2048</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp1_gpu15 -->
<g id="edge1100" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp1_gpu15</title>
<path fill="none" stroke="black" d="M18672.88,-9118.87C18570.5,-9114.51 18366.97,-9102.72 18301,-9076.02 18287.13,-9070.41 18273.73,-9061.28 18262.32,-9051.99"/>
<polygon fill="black" stroke="black" points="18264.27,-9049.05 18254.39,-9045.24 18259.73,-9054.38 18264.27,-9049.05"/>
</g>
<!-- layer_15_gelu_gpu8 -->
<g id="node863" class="node">
<title>layer_15_gelu_gpu8</title>
<polygon fill="lightblue" stroke="black" points="19289,-8945.52 19185,-8945.52 19185,-8907.52 19289,-8907.52 19289,-8945.52"/>
<text text-anchor="middle" x="19237" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU8</text>
<text text-anchor="middle" x="19237" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_15_mlp1_gpu8&#45;&gt;layer_15_gelu_gpu8 -->
<g id="edge1073" class="edge">
<title>layer_15_mlp1_gpu8&#45;&gt;layer_15_gelu_gpu8</title>
<path fill="none" stroke="black" d="M19237,-8991.97C19237,-8980.67 19237,-8967.35 19237,-8955.75"/>
<polygon fill="black" stroke="black" points="19240.5,-8955.7 19237,-8945.7 19233.5,-8955.7 19240.5,-8955.7"/>
</g>
<!-- layer_15_gelu_gpu9 -->
<g id="node864" class="node">
<title>layer_15_gelu_gpu9</title>
<polygon fill="lightblue" stroke="black" points="19145,-8945.52 19041,-8945.52 19041,-8907.52 19145,-8907.52 19145,-8945.52"/>
<text text-anchor="middle" x="19093" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU9</text>
<text text-anchor="middle" x="19093" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_15_mlp1_gpu9&#45;&gt;layer_15_gelu_gpu9 -->
<g id="edge1077" class="edge">
<title>layer_15_mlp1_gpu9&#45;&gt;layer_15_gelu_gpu9</title>
<path fill="none" stroke="black" d="M19093,-8991.97C19093,-8980.67 19093,-8967.35 19093,-8955.75"/>
<polygon fill="black" stroke="black" points="19096.5,-8955.7 19093,-8945.7 19089.5,-8955.7 19096.5,-8955.7"/>
</g>
<!-- layer_15_gelu_gpu10 -->
<g id="node865" class="node">
<title>layer_15_gelu_gpu10</title>
<polygon fill="lightblue" stroke="black" points="19005.5,-8945.52 18892.5,-8945.52 18892.5,-8907.52 19005.5,-8907.52 19005.5,-8945.52"/>
<text text-anchor="middle" x="18949" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU10</text>
<text text-anchor="middle" x="18949" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_15_mlp1_gpu10&#45;&gt;layer_15_gelu_gpu10 -->
<g id="edge1081" class="edge">
<title>layer_15_mlp1_gpu10&#45;&gt;layer_15_gelu_gpu10</title>
<path fill="none" stroke="black" d="M18949,-8991.97C18949,-8980.67 18949,-8967.35 18949,-8955.75"/>
<polygon fill="black" stroke="black" points="18952.5,-8955.7 18949,-8945.7 18945.5,-8955.7 18952.5,-8955.7"/>
</g>
<!-- layer_15_gelu_gpu11 -->
<g id="node866" class="node">
<title>layer_15_gelu_gpu11</title>
<polygon fill="lightblue" stroke="black" points="18861.5,-8945.52 18748.5,-8945.52 18748.5,-8907.52 18861.5,-8907.52 18861.5,-8945.52"/>
<text text-anchor="middle" x="18805" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU11</text>
<text text-anchor="middle" x="18805" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_15_mlp1_gpu11&#45;&gt;layer_15_gelu_gpu11 -->
<g id="edge1085" class="edge">
<title>layer_15_mlp1_gpu11&#45;&gt;layer_15_gelu_gpu11</title>
<path fill="none" stroke="black" d="M18805,-8991.97C18805,-8980.67 18805,-8967.35 18805,-8955.75"/>
<polygon fill="black" stroke="black" points="18808.5,-8955.7 18805,-8945.7 18801.5,-8955.7 18808.5,-8955.7"/>
</g>
<!-- layer_15_gelu_gpu12 -->
<g id="node867" class="node">
<title>layer_15_gelu_gpu12</title>
<polygon fill="lightblue" stroke="black" points="18717.5,-8945.52 18604.5,-8945.52 18604.5,-8907.52 18717.5,-8907.52 18717.5,-8945.52"/>
<text text-anchor="middle" x="18661" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU12</text>
<text text-anchor="middle" x="18661" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_15_mlp1_gpu12&#45;&gt;layer_15_gelu_gpu12 -->
<g id="edge1089" class="edge">
<title>layer_15_mlp1_gpu12&#45;&gt;layer_15_gelu_gpu12</title>
<path fill="none" stroke="black" d="M18661,-8991.97C18661,-8980.67 18661,-8967.35 18661,-8955.75"/>
<polygon fill="black" stroke="black" points="18664.5,-8955.7 18661,-8945.7 18657.5,-8955.7 18664.5,-8955.7"/>
</g>
<!-- layer_15_gelu_gpu13 -->
<g id="node868" class="node">
<title>layer_15_gelu_gpu13</title>
<polygon fill="lightblue" stroke="black" points="18573.5,-8945.52 18460.5,-8945.52 18460.5,-8907.52 18573.5,-8907.52 18573.5,-8945.52"/>
<text text-anchor="middle" x="18517" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU13</text>
<text text-anchor="middle" x="18517" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_15_mlp1_gpu13&#45;&gt;layer_15_gelu_gpu13 -->
<g id="edge1093" class="edge">
<title>layer_15_mlp1_gpu13&#45;&gt;layer_15_gelu_gpu13</title>
<path fill="none" stroke="black" d="M18517,-8991.97C18517,-8980.67 18517,-8967.35 18517,-8955.75"/>
<polygon fill="black" stroke="black" points="18520.5,-8955.7 18517,-8945.7 18513.5,-8955.7 18520.5,-8955.7"/>
</g>
<!-- layer_15_gelu_gpu14 -->
<g id="node869" class="node">
<title>layer_15_gelu_gpu14</title>
<polygon fill="lightblue" stroke="black" points="18429.5,-8945.52 18316.5,-8945.52 18316.5,-8907.52 18429.5,-8907.52 18429.5,-8945.52"/>
<text text-anchor="middle" x="18373" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU14</text>
<text text-anchor="middle" x="18373" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_15_mlp1_gpu14&#45;&gt;layer_15_gelu_gpu14 -->
<g id="edge1097" class="edge">
<title>layer_15_mlp1_gpu14&#45;&gt;layer_15_gelu_gpu14</title>
<path fill="none" stroke="black" d="M18373,-8991.97C18373,-8980.67 18373,-8967.35 18373,-8955.75"/>
<polygon fill="black" stroke="black" points="18376.5,-8955.7 18373,-8945.7 18369.5,-8955.7 18376.5,-8955.7"/>
</g>
<!-- layer_15_gelu_gpu15 -->
<g id="node870" class="node">
<title>layer_15_gelu_gpu15</title>
<polygon fill="lightblue" stroke="black" points="18285.5,-8945.52 18172.5,-8945.52 18172.5,-8907.52 18285.5,-8907.52 18285.5,-8945.52"/>
<text text-anchor="middle" x="18229" y="-8930.32" font-family="Times,serif" font-size="14.00">GELU GPU15</text>
<text text-anchor="middle" x="18229" y="-8915.32" font-family="Times,serif" font-size="14.00">2048 dim</text>
</g>
<!-- layer_15_mlp1_gpu15&#45;&gt;layer_15_gelu_gpu15 -->
<g id="edge1101" class="edge">
<title>layer_15_mlp1_gpu15&#45;&gt;layer_15_gelu_gpu15</title>
<path fill="none" stroke="black" d="M18229,-8991.97C18229,-8980.67 18229,-8967.35 18229,-8955.75"/>
<polygon fill="black" stroke="black" points="18232.5,-8955.7 18229,-8945.7 18225.5,-8955.7 18232.5,-8955.7"/>
</g>
<!-- layer_15_mlp2_gpu8 -->
<g id="node871" class="node">
<title>layer_15_mlp2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="19300,-8864.02 19174,-8864.02 19174,-8811.02 19300,-8811.02 19300,-8864.02"/>
<text text-anchor="middle" x="19237" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU8</text>
<text text-anchor="middle" x="19237" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="19237" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_15_gelu_gpu8&#45;&gt;layer_15_mlp2_gpu8 -->
<g id="edge1074" class="edge">
<title>layer_15_gelu_gpu8&#45;&gt;layer_15_mlp2_gpu8</title>
<path fill="none" stroke="black" d="M19237,-8907.5C19237,-8897.89 19237,-8885.73 19237,-8874.31"/>
<polygon fill="black" stroke="black" points="19240.5,-8874.11 19237,-8864.11 19233.5,-8874.11 19240.5,-8874.11"/>
</g>
<!-- layer_15_mlp2_gpu9 -->
<g id="node872" class="node">
<title>layer_15_mlp2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="19156,-8864.02 19030,-8864.02 19030,-8811.02 19156,-8811.02 19156,-8864.02"/>
<text text-anchor="middle" x="19093" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU9</text>
<text text-anchor="middle" x="19093" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="19093" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_15_gelu_gpu9&#45;&gt;layer_15_mlp2_gpu9 -->
<g id="edge1078" class="edge">
<title>layer_15_gelu_gpu9&#45;&gt;layer_15_mlp2_gpu9</title>
<path fill="none" stroke="black" d="M19093,-8907.5C19093,-8897.89 19093,-8885.73 19093,-8874.31"/>
<polygon fill="black" stroke="black" points="19096.5,-8874.11 19093,-8864.11 19089.5,-8874.11 19096.5,-8874.11"/>
</g>
<!-- layer_15_mlp2_gpu10 -->
<g id="node873" class="node">
<title>layer_15_mlp2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="19012,-8864.02 18886,-8864.02 18886,-8811.02 19012,-8811.02 19012,-8864.02"/>
<text text-anchor="middle" x="18949" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU10</text>
<text text-anchor="middle" x="18949" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="18949" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_15_gelu_gpu10&#45;&gt;layer_15_mlp2_gpu10 -->
<g id="edge1082" class="edge">
<title>layer_15_gelu_gpu10&#45;&gt;layer_15_mlp2_gpu10</title>
<path fill="none" stroke="black" d="M18949,-8907.5C18949,-8897.89 18949,-8885.73 18949,-8874.31"/>
<polygon fill="black" stroke="black" points="18952.5,-8874.11 18949,-8864.11 18945.5,-8874.11 18952.5,-8874.11"/>
</g>
<!-- layer_15_mlp2_gpu11 -->
<g id="node874" class="node">
<title>layer_15_mlp2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="18868,-8864.02 18742,-8864.02 18742,-8811.02 18868,-8811.02 18868,-8864.02"/>
<text text-anchor="middle" x="18805" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU11</text>
<text text-anchor="middle" x="18805" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="18805" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_15_gelu_gpu11&#45;&gt;layer_15_mlp2_gpu11 -->
<g id="edge1086" class="edge">
<title>layer_15_gelu_gpu11&#45;&gt;layer_15_mlp2_gpu11</title>
<path fill="none" stroke="black" d="M18805,-8907.5C18805,-8897.89 18805,-8885.73 18805,-8874.31"/>
<polygon fill="black" stroke="black" points="18808.5,-8874.11 18805,-8864.11 18801.5,-8874.11 18808.5,-8874.11"/>
</g>
<!-- layer_15_mlp2_gpu12 -->
<g id="node875" class="node">
<title>layer_15_mlp2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="18724,-8864.02 18598,-8864.02 18598,-8811.02 18724,-8811.02 18724,-8864.02"/>
<text text-anchor="middle" x="18661" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU12</text>
<text text-anchor="middle" x="18661" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="18661" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_15_gelu_gpu12&#45;&gt;layer_15_mlp2_gpu12 -->
<g id="edge1090" class="edge">
<title>layer_15_gelu_gpu12&#45;&gt;layer_15_mlp2_gpu12</title>
<path fill="none" stroke="black" d="M18661,-8907.5C18661,-8897.89 18661,-8885.73 18661,-8874.31"/>
<polygon fill="black" stroke="black" points="18664.5,-8874.11 18661,-8864.11 18657.5,-8874.11 18664.5,-8874.11"/>
</g>
<!-- layer_15_mlp2_gpu13 -->
<g id="node876" class="node">
<title>layer_15_mlp2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="18580,-8864.02 18454,-8864.02 18454,-8811.02 18580,-8811.02 18580,-8864.02"/>
<text text-anchor="middle" x="18517" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU13</text>
<text text-anchor="middle" x="18517" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="18517" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_15_gelu_gpu13&#45;&gt;layer_15_mlp2_gpu13 -->
<g id="edge1094" class="edge">
<title>layer_15_gelu_gpu13&#45;&gt;layer_15_mlp2_gpu13</title>
<path fill="none" stroke="black" d="M18517,-8907.5C18517,-8897.89 18517,-8885.73 18517,-8874.31"/>
<polygon fill="black" stroke="black" points="18520.5,-8874.11 18517,-8864.11 18513.5,-8874.11 18520.5,-8874.11"/>
</g>
<!-- layer_15_mlp2_gpu14 -->
<g id="node877" class="node">
<title>layer_15_mlp2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="18436,-8864.02 18310,-8864.02 18310,-8811.02 18436,-8811.02 18436,-8864.02"/>
<text text-anchor="middle" x="18373" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU14</text>
<text text-anchor="middle" x="18373" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="18373" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_15_gelu_gpu14&#45;&gt;layer_15_mlp2_gpu14 -->
<g id="edge1098" class="edge">
<title>layer_15_gelu_gpu14&#45;&gt;layer_15_mlp2_gpu14</title>
<path fill="none" stroke="black" d="M18373,-8907.5C18373,-8897.89 18373,-8885.73 18373,-8874.31"/>
<polygon fill="black" stroke="black" points="18376.5,-8874.11 18373,-8864.11 18369.5,-8874.11 18376.5,-8874.11"/>
</g>
<!-- layer_15_mlp2_gpu15 -->
<g id="node878" class="node">
<title>layer_15_mlp2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="18292,-8864.02 18166,-8864.02 18166,-8811.02 18292,-8811.02 18292,-8864.02"/>
<text text-anchor="middle" x="18229" y="-8848.82" font-family="Times,serif" font-size="14.00">MLP2 GPU15</text>
<text text-anchor="middle" x="18229" y="-8833.82" font-family="Times,serif" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="18229" y="-8818.82" font-family="Times,serif" font-size="14.00">Dim: 2048x512</text>
</g>
<!-- layer_15_gelu_gpu15&#45;&gt;layer_15_mlp2_gpu15 -->
<g id="edge1102" class="edge">
<title>layer_15_gelu_gpu15&#45;&gt;layer_15_mlp2_gpu15</title>
<path fill="none" stroke="black" d="M18229,-8907.5C18229,-8897.89 18229,-8885.73 18229,-8874.31"/>
<polygon fill="black" stroke="black" points="18232.5,-8874.11 18229,-8864.11 18225.5,-8874.11 18232.5,-8874.11"/>
</g>
<!-- layer_15_mlp_allreduce -->
<g id="node879" class="node">
<title>layer_15_mlp_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="18733" cy="-8748.15" rx="88.28" ry="26.74"/>
<text text-anchor="middle" x="18733" y="-8751.95" font-family="Times,serif" font-size="14.00">MLP AllReduce</text>
<text text-anchor="middle" x="18733" y="-8736.95" font-family="Times,serif" font-size="14.00">8 GPUs</text>
</g>
<!-- layer_15_mlp2_gpu8&#45;&gt;layer_15_mlp_allreduce -->
<g id="edge1075" class="edge">
<title>layer_15_mlp2_gpu8&#45;&gt;layer_15_mlp_allreduce</title>
<path fill="none" stroke="black" d="M19174,-8813.41C19170.97,-8812.56 19167.96,-8811.75 19165,-8811.02 19050.59,-8782.87 18915.77,-8766.09 18827.56,-8757.25"/>
<polygon fill="black" stroke="black" points="18827.86,-8753.77 18817.57,-8756.27 18827.18,-8760.73 18827.86,-8753.77"/>
</g>
<!-- layer_15_mlp2_gpu9&#45;&gt;layer_15_mlp_allreduce -->
<g id="edge1079" class="edge">
<title>layer_15_mlp2_gpu9&#45;&gt;layer_15_mlp_allreduce</title>
<path fill="none" stroke="black" d="M19029.93,-8813.67C19026.92,-8812.74 19023.93,-8811.85 19021,-8811.02 18953.58,-8791.93 18875.82,-8775.55 18818.11,-8764.45"/>
<polygon fill="black" stroke="black" points="18818.42,-8760.94 18807.94,-8762.51 18817.1,-8767.82 18818.42,-8760.94"/>
</g>
<!-- layer_15_mlp2_gpu10&#45;&gt;layer_15_mlp_allreduce -->
<g id="edge1083" class="edge">
<title>layer_15_mlp2_gpu10&#45;&gt;layer_15_mlp_allreduce</title>
<path fill="none" stroke="black" d="M18885.94,-8811.02C18857.08,-8799.34 18823,-8785.56 18794.35,-8773.97"/>
<polygon fill="black" stroke="black" points="18795.44,-8770.63 18784.86,-8770.13 18792.81,-8777.12 18795.44,-8770.63"/>
</g>
<!-- layer_15_mlp2_gpu11&#45;&gt;layer_15_mlp_allreduce -->
<g id="edge1087" class="edge">
<title>layer_15_mlp2_gpu11&#45;&gt;layer_15_mlp_allreduce</title>
<path fill="none" stroke="black" d="M18783.79,-8810.78C18776.4,-8801.82 18768,-8791.63 18760.2,-8782.16"/>
<polygon fill="black" stroke="black" points="18762.87,-8779.9 18753.81,-8774.41 18757.47,-8784.35 18762.87,-8779.9"/>
</g>
<!-- layer_15_mlp2_gpu12&#45;&gt;layer_15_mlp_allreduce -->
<g id="edge1091" class="edge">
<title>layer_15_mlp2_gpu12&#45;&gt;layer_15_mlp_allreduce</title>
<path fill="none" stroke="black" d="M18682.21,-8810.78C18689.6,-8801.82 18698,-8791.63 18705.8,-8782.16"/>
<polygon fill="black" stroke="black" points="18708.53,-8784.35 18712.19,-8774.41 18703.13,-8779.9 18708.53,-8784.35"/>
</g>
<!-- layer_15_mlp2_gpu13&#45;&gt;layer_15_mlp_allreduce -->
<g id="edge1095" class="edge">
<title>layer_15_mlp2_gpu13&#45;&gt;layer_15_mlp_allreduce</title>
<path fill="none" stroke="black" d="M18580.06,-8811.02C18608.92,-8799.34 18643,-8785.56 18671.65,-8773.97"/>
<polygon fill="black" stroke="black" points="18673.19,-8777.12 18681.14,-8770.13 18670.56,-8770.63 18673.19,-8777.12"/>
</g>
<!-- layer_15_mlp2_gpu14&#45;&gt;layer_15_mlp_allreduce -->
<g id="edge1099" class="edge">
<title>layer_15_mlp2_gpu14&#45;&gt;layer_15_mlp_allreduce</title>
<path fill="none" stroke="black" d="M18436.07,-8813.67C18439.08,-8812.74 18442.07,-8811.85 18445,-8811.02 18512.42,-8791.93 18590.18,-8775.55 18647.89,-8764.45"/>
<polygon fill="black" stroke="black" points="18648.9,-8767.82 18658.06,-8762.51 18647.58,-8760.94 18648.9,-8767.82"/>
</g>
<!-- layer_15_mlp2_gpu15&#45;&gt;layer_15_mlp_allreduce -->
<g id="edge1103" class="edge">
<title>layer_15_mlp2_gpu15&#45;&gt;layer_15_mlp_allreduce</title>
<path fill="none" stroke="black" d="M18292,-8813.41C18295.03,-8812.56 18298.04,-8811.75 18301,-8811.02 18415.41,-8782.87 18550.23,-8766.09 18638.44,-8757.25"/>
<polygon fill="black" stroke="black" points="18638.82,-8760.73 18648.43,-8756.27 18638.14,-8753.77 18638.82,-8760.73"/>
</g>
<!-- layer_15_residual2 -->
<g id="node880" class="node">
<title>layer_15_residual2</title>
<polygon fill="lightyellow" stroke="black" points="18870.78,-8685.28 18651.6,-8685.28 18595.22,-8609.28 18814.4,-8609.28 18870.78,-8685.28"/>
<text text-anchor="middle" x="18733" y="-8651.08" font-family="Times,serif" font-size="14.00">Residual Add 15</text>
<text text-anchor="middle" x="18733" y="-8636.08" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_15_mlp_allreduce&#45;&gt;layer_15_residual2 -->
<g id="edge1104" class="edge">
<title>layer_15_mlp_allreduce&#45;&gt;layer_15_residual2</title>
<path fill="none" stroke="black" d="M18733,-8721.18C18733,-8713.36 18733,-8704.53 18733,-8695.78"/>
<polygon fill="black" stroke="black" points="18736.5,-8695.61 18733,-8685.61 18729.5,-8695.61 18736.5,-8695.61"/>
</g>
<!-- layer_15_ln2 -->
<g id="node881" class="node">
<title>layer_15_ln2</title>
<polygon fill="lightblue" stroke="black" points="18793,-8554.28 18673,-8554.28 18673,-8516.28 18793,-8516.28 18793,-8554.28"/>
<text text-anchor="middle" x="18733" y="-8539.08" font-family="Times,serif" font-size="14.00">LayerNorm 15</text>
<text text-anchor="middle" x="18733" y="-8524.08" font-family="Times,serif" font-size="14.00">4096 dim</text>
</g>
<!-- layer_15_residual2&#45;&gt;layer_15_ln2 -->
<g id="edge1105" class="edge">
<title>layer_15_residual2&#45;&gt;layer_15_ln2</title>
<path fill="none" stroke="black" d="M18733,-8609.04C18733,-8594.48 18733,-8578.07 18733,-8564.52"/>
<polygon fill="black" stroke="black" points="18736.5,-8564.35 18733,-8554.35 18729.5,-8564.35 18736.5,-8564.35"/>
</g>
<!-- output -->
<g id="node882" class="node">
<title>output</title>
<polygon fill="lightcoral" stroke="black" points="18733,-8461.28 18635,-8393.28 18733,-8325.28 18831,-8393.28 18733,-8461.28"/>
<text text-anchor="middle" x="18733" y="-8412.08" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="18733" y="-8397.08" font-family="Times,serif" font-size="14.00">Batch: 128</text>
<text text-anchor="middle" x="18733" y="-8382.08" font-family="Times,serif" font-size="14.00">Seq: 10000</text>
<text text-anchor="middle" x="18733" y="-8367.08" font-family="Times,serif" font-size="14.00">Dim: 4096</text>
</g>
<!-- layer_15_ln2&#45;&gt;output -->
<g id="edge1106" class="edge">
<title>layer_15_ln2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M18733,-8516.27C18733,-8504.59 18733,-8488.48 18733,-8471.8"/>
<polygon fill="black" stroke="black" points="18736.5,-8471.37 18733,-8461.37 18729.5,-8471.37 18736.5,-8471.37"/>
</g>
<!-- layer_8_qkv_gpu0 -->
<g id="node884" class="node">
<title>layer_8_qkv_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="1007.04,-36 790.63,-36 734.96,0 951.37,0 1007.04,-36"/>
<text text-anchor="middle" x="871" y="-14.3" font-family="Times,serif" font-size="14.00">layer_8_qkv_gpu0</text>
</g>
<!-- pipeline_comm_7_to_8&#45;&gt;layer_8_qkv_gpu0 -->
<g id="edge554" class="edge">
<title>pipeline_comm_7_to_8&#45;&gt;layer_8_qkv_gpu0</title>
<path fill="none" stroke="black" d="M871,-71.61C871,-63.51 871,-54.57 871,-46.39"/>
<polygon fill="black" stroke="black" points="874.5,-46.22 871,-36.22 867.5,-46.22 874.5,-46.22"/>
</g>
</g>
</svg>
