<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_tensor_pipeline_fixed Pages: 1 -->
<svg width="4170pt" height="22971pt"
 viewBox="0.00 0.00 4169.50 22970.90" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 22966.9)">
<title>baseline_tensor_pipeline_fixed</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-22966.9 4165.5,-22966.9 4165.5,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="567.44,-22962.9 445.05,-22962.9 413.56,-22858.9 535.95,-22858.9 567.44,-22962.9"/>
<text text-anchor="middle" x="490.5" y="-22924.9" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="490.5" y="-22913.9" font-family="Arial" font-size="10.00">Batch: 128</text>
<text text-anchor="middle" x="490.5" y="-22902.9" font-family="Arial" font-size="10.00">Seq: 10000</text>
<text text-anchor="middle" x="490.5" y="-22891.9" font-family="Arial" font-size="10.00">Hidden: 4096</text>
</g>
<!-- layer_0_input_dist -->
<g id="node3" class="node">
<title>layer_0_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="584.69,-22822.9 434.86,-22822.9 396.31,-22762.9 546.14,-22762.9 584.69,-22822.9"/>
<text text-anchor="middle" x="490.5" y="-22795.9" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="490.5" y="-22784.9" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- input&#45;&gt;layer_0_input_dist -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_0_input_dist</title>
<path fill="none" stroke="black" d="M490.5,-22858.68C490.5,-22850.06 490.5,-22841.24 490.5,-22832.99"/>
<polygon fill="black" stroke="black" points="494,-22832.9 490.5,-22822.9 487,-22832.9 494,-22832.9"/>
</g>
<!-- output -->
<g id="node2" class="node">
<title>output</title>
<polygon fill="lightgreen" stroke="black" points="4023.44,-104 3901.05,-104 3869.56,0 3991.95,0 4023.44,-104"/>
<text text-anchor="middle" x="3946.5" y="-66" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="3946.5" y="-55" font-family="Arial" font-size="10.00">Batch: 128</text>
<text text-anchor="middle" x="3946.5" y="-44" font-family="Arial" font-size="10.00">Seq: 10000</text>
<text text-anchor="middle" x="3946.5" y="-33" font-family="Arial" font-size="10.00">Hidden: 4096</text>
</g>
<!-- layer_0_qkv_gpu0 -->
<g id="node4" class="node">
<title>layer_0_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="93,-22726.9 0,-22726.9 0,-22674.9 93,-22674.9 93,-22726.9"/>
<text text-anchor="middle" x="46.5" y="-22714.9" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="46.5" y="-22703.9" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="46.5" y="-22692.9" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="46.5" y="-22681.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu0 -->
<g id="edge2" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu0</title>
<path fill="none" stroke="black" d="M410.13,-22784.65C332.73,-22776.29 212.67,-22759.64 102.86,-22727.03"/>
<polygon fill="black" stroke="black" points="103.88,-22723.68 93.29,-22724.14 101.85,-22730.38 103.88,-22723.68"/>
</g>
<!-- layer_0_qkv_gpu1 -->
<g id="node5" class="node">
<title>layer_0_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="204,-22726.9 111,-22726.9 111,-22674.9 204,-22674.9 204,-22726.9"/>
<text text-anchor="middle" x="157.5" y="-22714.9" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="157.5" y="-22703.9" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="157.5" y="-22692.9" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="157.5" y="-22681.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu1 -->
<g id="edge3" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu1</title>
<path fill="none" stroke="black" d="M404.72,-22776.39C351.64,-22765.74 282.18,-22749.89 213.71,-22727.08"/>
<polygon fill="black" stroke="black" points="214.65,-22723.7 204.05,-22723.81 212.41,-22730.33 214.65,-22723.7"/>
</g>
<!-- layer_0_qkv_gpu2 -->
<g id="node6" class="node">
<title>layer_0_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="315,-22726.9 222,-22726.9 222,-22674.9 315,-22674.9 315,-22726.9"/>
<text text-anchor="middle" x="268.5" y="-22714.9" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="268.5" y="-22703.9" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="268.5" y="-22692.9" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="268.5" y="-22681.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu2 -->
<g id="edge4" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu2</title>
<path fill="none" stroke="black" d="M413.24,-22762.85C387.31,-22752.86 358.12,-22741.34 324.75,-22727.36"/>
<polygon fill="black" stroke="black" points="325.8,-22724.01 315.23,-22723.35 323.09,-22730.46 325.8,-22724.01"/>
</g>
<!-- layer_0_qkv_gpu3 -->
<g id="node7" class="node">
<title>layer_0_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="426,-22726.9 333,-22726.9 333,-22674.9 426,-22674.9 426,-22726.9"/>
<text text-anchor="middle" x="379.5" y="-22714.9" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="379.5" y="-22703.9" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="379.5" y="-22692.9" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="379.5" y="-22681.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu3 -->
<g id="edge5" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu3</title>
<path fill="none" stroke="black" d="M454.46,-22762.68C442.94,-22753.33 430.14,-22742.95 418.42,-22733.45"/>
<polygon fill="black" stroke="black" points="420.48,-22730.62 410.51,-22727.04 416.08,-22736.06 420.48,-22730.62"/>
</g>
<!-- layer_0_qkv_gpu4 -->
<g id="node8" class="node">
<title>layer_0_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="537,-22726.9 444,-22726.9 444,-22674.9 537,-22674.9 537,-22726.9"/>
<text text-anchor="middle" x="490.5" y="-22714.9" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="490.5" y="-22703.9" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="490.5" y="-22692.9" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="490.5" y="-22681.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu4 -->
<g id="edge6" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu4</title>
<path fill="none" stroke="black" d="M490.5,-22762.43C490.5,-22754.35 490.5,-22745.52 490.5,-22737.16"/>
<polygon fill="black" stroke="black" points="494,-22736.91 490.5,-22726.91 487,-22736.91 494,-22736.91"/>
</g>
<!-- layer_0_qkv_gpu5 -->
<g id="node9" class="node">
<title>layer_0_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="648,-22726.9 555,-22726.9 555,-22674.9 648,-22674.9 648,-22726.9"/>
<text text-anchor="middle" x="601.5" y="-22714.9" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="601.5" y="-22703.9" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="601.5" y="-22692.9" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="601.5" y="-22681.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu5 -->
<g id="edge7" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu5</title>
<path fill="none" stroke="black" d="M526.54,-22762.68C538.06,-22753.33 550.86,-22742.95 562.58,-22733.45"/>
<polygon fill="black" stroke="black" points="564.92,-22736.06 570.49,-22727.04 560.52,-22730.62 564.92,-22736.06"/>
</g>
<!-- layer_0_qkv_gpu6 -->
<g id="node10" class="node">
<title>layer_0_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="759,-22726.9 666,-22726.9 666,-22674.9 759,-22674.9 759,-22726.9"/>
<text text-anchor="middle" x="712.5" y="-22714.9" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="712.5" y="-22703.9" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="712.5" y="-22692.9" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="712.5" y="-22681.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu6 -->
<g id="edge8" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu6</title>
<path fill="none" stroke="black" d="M550.73,-22769.38C580.33,-22758.1 616.68,-22743.92 656.42,-22727.28"/>
<polygon fill="black" stroke="black" points="657.91,-22730.45 665.77,-22723.35 655.2,-22724 657.91,-22730.45"/>
</g>
<!-- layer_0_qkv_gpu7 -->
<g id="node11" class="node">
<title>layer_0_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="870,-22726.9 777,-22726.9 777,-22674.9 870,-22674.9 870,-22726.9"/>
<text text-anchor="middle" x="823.5" y="-22714.9" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="823.5" y="-22703.9" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="823.5" y="-22692.9" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="823.5" y="-22681.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu7 -->
<g id="edge9" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu7</title>
<path fill="none" stroke="black" d="M557.25,-22780.13C611.88,-22769.63 691.07,-22752.42 767.2,-22727.11"/>
<polygon fill="black" stroke="black" points="768.59,-22730.33 776.95,-22723.81 766.35,-22723.7 768.59,-22730.33"/>
</g>
<!-- layer_0_residual1 -->
<g id="node23" class="node">
<title>layer_0_residual1</title>
<polygon fill="lightyellow" stroke="black" points="780.44,-22274.93 658.05,-22274.93 626.56,-22214.93 748.95,-22214.93 780.44,-22274.93"/>
<text text-anchor="middle" x="703.5" y="-22247.93" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="703.5" y="-22236.93" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_residual1 -->
<g id="edge36" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M563.59,-22789.55C663.77,-22784.74 836.3,-22770.24 879.5,-22726.9 916.38,-22689.9 898.5,-22663.14 898.5,-22610.91 898.5,-22610.91 898.5,-22610.91 898.5,-22429.91 898.5,-22361.13 833.52,-22310.45 778.59,-22279.9"/>
<polygon fill="black" stroke="black" points="779.98,-22276.67 769.52,-22274.98 776.64,-22282.82 779.98,-22276.67"/>
</g>
<!-- layer_0_allgather_qkv -->
<g id="node12" class="node">
<title>layer_0_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="446.5" cy="-22609.91" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="446.5" y="-22618.41" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="446.5" y="-22607.41" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="446.5" y="-22596.41" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_0_qkv_gpu0&#45;&gt;layer_0_allgather_qkv -->
<g id="edge10" class="edge">
<title>layer_0_qkv_gpu0&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M93,-22677.83C95.85,-22676.77 98.7,-22675.78 101.5,-22674.9 196.34,-22645.04 310.49,-22627.24 380.77,-22618.26"/>
<polygon fill="black" stroke="black" points="381.33,-22621.72 390.82,-22617 380.46,-22614.77 381.33,-22621.72"/>
</g>
<!-- layer_0_qkv_gpu1&#45;&gt;layer_0_allgather_qkv -->
<g id="edge11" class="edge">
<title>layer_0_qkv_gpu1&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M204.1,-22678.1C206.92,-22676.97 209.74,-22675.89 212.5,-22674.9 269.82,-22654.18 337.1,-22636.44 384.78,-22624.93"/>
<polygon fill="black" stroke="black" points="385.73,-22628.3 394.64,-22622.57 384.1,-22621.49 385.73,-22628.3"/>
</g>
<!-- layer_0_qkv_gpu2&#45;&gt;layer_0_allgather_qkv -->
<g id="edge12" class="edge">
<title>layer_0_qkv_gpu2&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M315.27,-22676.51C340.59,-22663.86 371.84,-22648.23 397.5,-22635.4"/>
<polygon fill="black" stroke="black" points="399.3,-22638.42 406.68,-22630.81 396.17,-22632.16 399.3,-22638.42"/>
</g>
<!-- layer_0_qkv_gpu3&#45;&gt;layer_0_allgather_qkv -->
<g id="edge13" class="edge">
<title>layer_0_qkv_gpu3&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M398.52,-22674.63C405.41,-22665.48 413.32,-22654.98 420.69,-22645.18"/>
<polygon fill="black" stroke="black" points="423.51,-22647.26 426.73,-22637.16 417.92,-22643.05 423.51,-22647.26"/>
</g>
<!-- layer_0_qkv_gpu4&#45;&gt;layer_0_allgather_qkv -->
<g id="edge14" class="edge">
<title>layer_0_qkv_gpu4&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M478.01,-22674.63C473.78,-22666.08 468.97,-22656.35 464.4,-22647.11"/>
<polygon fill="black" stroke="black" points="467.52,-22645.51 459.95,-22638.1 461.24,-22648.62 467.52,-22645.51"/>
</g>
<!-- layer_0_qkv_gpu5&#45;&gt;layer_0_allgather_qkv -->
<g id="edge15" class="edge">
<title>layer_0_qkv_gpu5&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M557.91,-22674.87C537.48,-22663.14 513.12,-22649.15 492.4,-22637.26"/>
<polygon fill="black" stroke="black" points="493.88,-22634.07 483.47,-22632.13 490.4,-22640.14 493.88,-22634.07"/>
</g>
<!-- layer_0_qkv_gpu6&#45;&gt;layer_0_allgather_qkv -->
<g id="edge16" class="edge">
<title>layer_0_qkv_gpu6&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M665.87,-22678.19C663.05,-22677.04 660.25,-22675.93 657.5,-22674.9 607.32,-22655.98 548.88,-22638.6 506.24,-22626.75"/>
<polygon fill="black" stroke="black" points="507.15,-22623.37 496.57,-22624.08 505.28,-22630.11 507.15,-22623.37"/>
</g>
<!-- layer_0_qkv_gpu7&#45;&gt;layer_0_allgather_qkv -->
<g id="edge17" class="edge">
<title>layer_0_qkv_gpu7&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M776.98,-22677.87C774.14,-22676.8 771.3,-22675.8 768.5,-22674.9 681.72,-22646.97 577.69,-22628.96 511.83,-22619.37"/>
<polygon fill="black" stroke="black" points="511.99,-22615.86 501.6,-22617.91 511,-22622.79 511.99,-22615.86"/>
</g>
<!-- layer_0_attention -->
<g id="node13" class="node">
<title>layer_0_attention</title>
<polygon fill="lightblue" stroke="black" points="480.5,-22544.91 412.5,-22544.91 412.5,-22492.91 480.5,-22492.91 480.5,-22544.91"/>
<text text-anchor="middle" x="446.5" y="-22532.91" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="446.5" y="-22521.91" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="446.5" y="-22510.91" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="446.5" y="-22499.91" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_0_allgather_qkv&#45;&gt;layer_0_attention -->
<g id="edge18" class="edge">
<title>layer_0_allgather_qkv&#45;&gt;layer_0_attention</title>
<path fill="none" stroke="black" d="M446.5,-22580.75C446.5,-22572.64 446.5,-22563.69 446.5,-22555.21"/>
<polygon fill="black" stroke="black" points="450,-22555.18 446.5,-22545.18 443,-22555.18 450,-22555.18"/>
</g>
<!-- layer_0_attn_out_gpu0 -->
<g id="node14" class="node">
<title>layer_0_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="128.5,-22456.91 40.5,-22456.91 40.5,-22404.91 128.5,-22404.91 128.5,-22456.91"/>
<text text-anchor="middle" x="84.5" y="-22444.91" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="84.5" y="-22433.91" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="84.5" y="-22422.91" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="84.5" y="-22411.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attention&#45;&gt;layer_0_attn_out_gpu0 -->
<g id="edge19" class="edge">
<title>layer_0_attention&#45;&gt;layer_0_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M412.43,-22513.97C356.48,-22506.91 241.85,-22489.94 138.37,-22456.88"/>
<polygon fill="black" stroke="black" points="139.3,-22453.5 128.71,-22453.73 137.13,-22460.16 139.3,-22453.5"/>
</g>
<!-- layer_0_attn_out_gpu1 -->
<g id="node15" class="node">
<title>layer_0_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="234.5,-22456.91 146.5,-22456.91 146.5,-22404.91 234.5,-22404.91 234.5,-22456.91"/>
<text text-anchor="middle" x="190.5" y="-22444.91" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="190.5" y="-22433.91" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="190.5" y="-22422.91" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="190.5" y="-22411.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attention&#45;&gt;layer_0_attn_out_gpu1 -->
<g id="edge20" class="edge">
<title>layer_0_attention&#45;&gt;layer_0_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M412.22,-22509.29C373.35,-22499.14 308.05,-22480.99 243.97,-22456.88"/>
<polygon fill="black" stroke="black" points="245.12,-22453.58 234.53,-22453.28 242.63,-22460.12 245.12,-22453.58"/>
</g>
<!-- layer_0_attn_out_gpu2 -->
<g id="node16" class="node">
<title>layer_0_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="340.5,-22456.91 252.5,-22456.91 252.5,-22404.91 340.5,-22404.91 340.5,-22456.91"/>
<text text-anchor="middle" x="296.5" y="-22444.91" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="296.5" y="-22433.91" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="296.5" y="-22422.91" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="296.5" y="-22411.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attention&#45;&gt;layer_0_attn_out_gpu2 -->
<g id="edge21" class="edge">
<title>layer_0_attention&#45;&gt;layer_0_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M412.46,-22498.4C393.78,-22487.69 370.21,-22474.17 349.2,-22462.13"/>
<polygon fill="black" stroke="black" points="350.8,-22459.01 340.38,-22457.07 347.31,-22465.08 350.8,-22459.01"/>
</g>
<!-- layer_0_attn_out_gpu3 -->
<g id="node17" class="node">
<title>layer_0_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="446.5,-22456.91 358.5,-22456.91 358.5,-22404.91 446.5,-22404.91 446.5,-22456.91"/>
<text text-anchor="middle" x="402.5" y="-22444.91" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="402.5" y="-22433.91" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="402.5" y="-22422.91" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="402.5" y="-22411.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attention&#45;&gt;layer_0_attn_out_gpu3 -->
<g id="edge22" class="edge">
<title>layer_0_attention&#45;&gt;layer_0_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M433.54,-22492.58C429.28,-22484.27 424.49,-22474.89 419.96,-22466.04"/>
<polygon fill="black" stroke="black" points="423.04,-22464.38 415.37,-22457.07 416.81,-22467.57 423.04,-22464.38"/>
</g>
<!-- layer_0_attn_out_gpu4 -->
<g id="node18" class="node">
<title>layer_0_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="552.5,-22456.91 464.5,-22456.91 464.5,-22404.91 552.5,-22404.91 552.5,-22456.91"/>
<text text-anchor="middle" x="508.5" y="-22444.91" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="508.5" y="-22433.91" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="508.5" y="-22422.91" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="508.5" y="-22411.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attention&#45;&gt;layer_0_attn_out_gpu4 -->
<g id="edge23" class="edge">
<title>layer_0_attention&#45;&gt;layer_0_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M464.77,-22492.58C470.95,-22484 477.95,-22474.3 484.5,-22465.2"/>
<polygon fill="black" stroke="black" points="487.35,-22467.23 490.36,-22457.07 481.68,-22463.14 487.35,-22467.23"/>
</g>
<!-- layer_0_attn_out_gpu5 -->
<g id="node19" class="node">
<title>layer_0_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="658.5,-22456.91 570.5,-22456.91 570.5,-22404.91 658.5,-22404.91 658.5,-22456.91"/>
<text text-anchor="middle" x="614.5" y="-22444.91" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="614.5" y="-22433.91" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="614.5" y="-22422.91" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="614.5" y="-22411.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attention&#45;&gt;layer_0_attn_out_gpu5 -->
<g id="edge24" class="edge">
<title>layer_0_attention&#45;&gt;layer_0_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M480.9,-22500.3C504,-22488.48 534.9,-22472.66 561.16,-22459.22"/>
<polygon fill="black" stroke="black" points="562.93,-22462.25 570.24,-22454.57 559.74,-22456.01 562.93,-22462.25"/>
</g>
<!-- layer_0_attn_out_gpu6 -->
<g id="node20" class="node">
<title>layer_0_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="764.5,-22456.91 676.5,-22456.91 676.5,-22404.91 764.5,-22404.91 764.5,-22456.91"/>
<text text-anchor="middle" x="720.5" y="-22444.91" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="720.5" y="-22433.91" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="720.5" y="-22422.91" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="720.5" y="-22411.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attention&#45;&gt;layer_0_attn_out_gpu6 -->
<g id="edge25" class="edge">
<title>layer_0_attention&#45;&gt;layer_0_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M480.77,-22510.38C522.82,-22500.73 596.28,-22482.5 666.99,-22456.86"/>
<polygon fill="black" stroke="black" points="668.32,-22460.1 676.5,-22453.36 665.9,-22453.53 668.32,-22460.1"/>
</g>
<!-- layer_0_attn_out_gpu7 -->
<g id="node21" class="node">
<title>layer_0_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="870.5,-22456.91 782.5,-22456.91 782.5,-22404.91 870.5,-22404.91 870.5,-22456.91"/>
<text text-anchor="middle" x="826.5" y="-22444.91" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="826.5" y="-22433.91" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="826.5" y="-22422.91" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="826.5" y="-22411.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attention&#45;&gt;layer_0_attn_out_gpu7 -->
<g id="edge26" class="edge">
<title>layer_0_attention&#45;&gt;layer_0_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M480.63,-22514.46C539.2,-22507.92 662.4,-22491.45 772.69,-22456.84"/>
<polygon fill="black" stroke="black" points="773.84,-22460.15 782.3,-22453.77 771.71,-22453.48 773.84,-22460.15"/>
</g>
<!-- layer_0_allreduce_attn -->
<g id="node22" class="node">
<title>layer_0_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="508.5" cy="-22339.92" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="508.5" y="-22348.42" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="508.5" y="-22337.42" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="508.5" y="-22326.42" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_0_attn_out_gpu0&#45;&gt;layer_0_allreduce_attn -->
<g id="edge27" class="edge">
<title>layer_0_attn_out_gpu0&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M128.68,-22408.01C131.63,-22406.88 134.59,-22405.83 137.5,-22404.91 240.93,-22372.26 366.16,-22355.05 441.47,-22346.99"/>
<polygon fill="black" stroke="black" points="442.17,-22350.43 451.75,-22345.91 441.44,-22343.47 442.17,-22350.43"/>
</g>
<!-- layer_0_attn_out_gpu1&#45;&gt;layer_0_allreduce_attn -->
<g id="edge28" class="edge">
<title>layer_0_attn_out_gpu1&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M234.76,-22408.24C237.69,-22407.05 240.62,-22405.93 243.5,-22404.91 310.63,-22381.25 390.34,-22363.31 444.69,-22352.53"/>
<polygon fill="black" stroke="black" points="445.39,-22355.96 454.53,-22350.6 444.04,-22349.09 445.39,-22355.96"/>
</g>
<!-- layer_0_attn_out_gpu2&#45;&gt;layer_0_allreduce_attn -->
<g id="edge29" class="edge">
<title>layer_0_attn_out_gpu2&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M340.66,-22408.85C343.64,-22407.5 346.61,-22406.18 349.5,-22404.91 383.83,-22389.93 422.84,-22374.21 453.63,-22362.1"/>
<polygon fill="black" stroke="black" points="455.29,-22365.21 463.32,-22358.3 452.73,-22358.69 455.29,-22365.21"/>
</g>
<!-- layer_0_attn_out_gpu3&#45;&gt;layer_0_allreduce_attn -->
<g id="edge30" class="edge">
<title>layer_0_attn_out_gpu3&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M432.31,-22404.89C444.58,-22394.59 458.92,-22382.55 471.83,-22371.71"/>
<polygon fill="black" stroke="black" points="474.24,-22374.26 479.65,-22365.15 469.74,-22368.9 474.24,-22374.26"/>
</g>
<!-- layer_0_attn_out_gpu4&#45;&gt;layer_0_allreduce_attn -->
<g id="edge31" class="edge">
<title>layer_0_attn_out_gpu4&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M508.5,-22404.65C508.5,-22396.76 508.5,-22387.87 508.5,-22379.29"/>
<polygon fill="black" stroke="black" points="512,-22379.06 508.5,-22369.06 505,-22379.06 512,-22379.06"/>
</g>
<!-- layer_0_attn_out_gpu5&#45;&gt;layer_0_allreduce_attn -->
<g id="edge32" class="edge">
<title>layer_0_attn_out_gpu5&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M584.69,-22404.89C572.42,-22394.59 558.08,-22382.55 545.17,-22371.71"/>
<polygon fill="black" stroke="black" points="547.26,-22368.9 537.35,-22365.15 542.76,-22374.26 547.26,-22368.9"/>
</g>
<!-- layer_0_attn_out_gpu6&#45;&gt;layer_0_allreduce_attn -->
<g id="edge33" class="edge">
<title>layer_0_attn_out_gpu6&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M676.34,-22408.85C673.36,-22407.5 670.39,-22406.18 667.5,-22404.91 633.17,-22389.93 594.16,-22374.21 563.37,-22362.1"/>
<polygon fill="black" stroke="black" points="564.27,-22358.69 553.68,-22358.3 561.71,-22365.21 564.27,-22358.69"/>
</g>
<!-- layer_0_attn_out_gpu7&#45;&gt;layer_0_allreduce_attn -->
<g id="edge34" class="edge">
<title>layer_0_attn_out_gpu7&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M782.24,-22408.24C779.31,-22407.05 776.38,-22405.93 773.5,-22404.91 706.37,-22381.25 626.66,-22363.31 572.31,-22352.53"/>
<polygon fill="black" stroke="black" points="572.96,-22349.09 562.47,-22350.6 571.61,-22355.96 572.96,-22349.09"/>
</g>
<!-- layer_0_allreduce_attn&#45;&gt;layer_0_residual1 -->
<g id="edge35" class="edge">
<title>layer_0_allreduce_attn&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M549.85,-22319.2C577.62,-22305.96 614.59,-22288.33 645.31,-22273.68"/>
<polygon fill="black" stroke="black" points="647.1,-22276.7 654.62,-22269.24 644.09,-22270.38 647.1,-22276.7"/>
</g>
<!-- layer_0_ln1 -->
<g id="node24" class="node">
<title>layer_0_ln1</title>
<polygon fill="lightblue" stroke="black" points="535,-22178.93 462,-22178.93 462,-22137.93 535,-22137.93 535,-22178.93"/>
<text text-anchor="middle" x="498.5" y="-22166.93" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="498.5" y="-22155.93" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="498.5" y="-22144.93" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_0_residual1&#45;&gt;layer_0_ln1 -->
<g id="edge37" class="edge">
<title>layer_0_residual1&#45;&gt;layer_0_ln1</title>
<path fill="none" stroke="black" d="M632.95,-22214.85C603.66,-22202.78 570.49,-22189.11 544.43,-22178.36"/>
<polygon fill="black" stroke="black" points="545.75,-22175.12 535.17,-22174.55 543.08,-22181.59 545.75,-22175.12"/>
</g>
<!-- layer_0_residual2 -->
<g id="node44" class="node">
<title>layer_0_residual2</title>
<polygon fill="lightyellow" stroke="black" points="780.44,-21665.97 658.05,-21665.97 626.56,-21605.97 748.95,-21605.97 780.44,-21665.97"/>
<text text-anchor="middle" x="703.5" y="-21638.97" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="703.5" y="-21627.97" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_0_residual1&#45;&gt;layer_0_residual2 -->
<g id="edge72" class="edge">
<title>layer_0_residual1&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M755.48,-22227.37C816.51,-22204.28 909.5,-22156.12 909.5,-22076.93 909.5,-22076.93 909.5,-22076.93 909.5,-21820.95 909.5,-21750.74 842.11,-21700.66 784.42,-21670.65"/>
<polygon fill="black" stroke="black" points="785.76,-21667.4 775.26,-21666 782.6,-21673.64 785.76,-21667.4"/>
</g>
<!-- layer_0_mlp_fc1_gpu0 -->
<g id="node25" class="node">
<title>layer_0_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="97.5,-22101.93 3.5,-22101.93 3.5,-22049.93 97.5,-22049.93 97.5,-22101.93"/>
<text text-anchor="middle" x="50.5" y="-22089.93" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="50.5" y="-22078.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="50.5" y="-22067.93" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="50.5" y="-22056.93" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu0 -->
<g id="edge38" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M461.85,-22155.65C393.28,-22151.6 241.17,-22139.18 107.13,-22101.76"/>
<polygon fill="black" stroke="black" points="108.08,-22098.4 97.51,-22099.03 106.17,-22105.13 108.08,-22098.4"/>
</g>
<!-- layer_0_mlp_fc1_gpu1 -->
<g id="node26" class="node">
<title>layer_0_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="209.5,-22101.93 115.5,-22101.93 115.5,-22049.93 209.5,-22049.93 209.5,-22101.93"/>
<text text-anchor="middle" x="162.5" y="-22089.93" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="162.5" y="-22078.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="162.5" y="-22067.93" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="162.5" y="-22056.93" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu1 -->
<g id="edge39" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M461.6,-22152.81C409.26,-22145.67 310.55,-22130.07 219.23,-22101.88"/>
<polygon fill="black" stroke="black" points="220.16,-22098.5 209.57,-22098.83 218.05,-22105.17 220.16,-22098.5"/>
</g>
<!-- layer_0_mlp_fc1_gpu2 -->
<g id="node27" class="node">
<title>layer_0_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="321.5,-22101.93 227.5,-22101.93 227.5,-22049.93 321.5,-22049.93 321.5,-22101.93"/>
<text text-anchor="middle" x="274.5" y="-22089.93" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="274.5" y="-22078.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="274.5" y="-22067.93" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="274.5" y="-22056.93" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu2 -->
<g id="edge40" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M461.75,-22146.46C429.47,-22136.57 381.12,-22121.12 331.08,-22102.02"/>
<polygon fill="black" stroke="black" points="332.3,-22098.74 321.72,-22098.41 329.79,-22105.27 332.3,-22098.74"/>
</g>
<!-- layer_0_mlp_fc1_gpu3 -->
<g id="node28" class="node">
<title>layer_0_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="433.5,-22101.93 339.5,-22101.93 339.5,-22049.93 433.5,-22049.93 433.5,-22101.93"/>
<text text-anchor="middle" x="386.5" y="-22089.93" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="386.5" y="-22078.93" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="386.5" y="-22067.93" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="386.5" y="-22056.93" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu3 -->
<g id="edge41" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M471.1,-22137.74C458.77,-22128.87 443.9,-22118.19 430.09,-22108.26"/>
<polygon fill="black" stroke="black" points="431.83,-22105.2 421.67,-22102.21 427.74,-22110.89 431.83,-22105.2"/>
</g>
<!-- layer_0_mlp_fc1_gpu4 -->
<g id="node29" class="node">
<title>layer_0_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="545.5,-22101.93 451.5,-22101.93 451.5,-22049.93 545.5,-22049.93 545.5,-22101.93"/>
<text text-anchor="middle" x="498.5" y="-22089.93" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="498.5" y="-22078.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="498.5" y="-22067.93" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="498.5" y="-22056.93" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu4 -->
<g id="edge42" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M498.5,-22137.53C498.5,-22129.92 498.5,-22120.99 498.5,-22112.36"/>
<polygon fill="black" stroke="black" points="502,-22112.09 498.5,-22102.09 495,-22112.09 502,-22112.09"/>
</g>
<!-- layer_0_mlp_fc1_gpu5 -->
<g id="node30" class="node">
<title>layer_0_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="657.5,-22101.93 563.5,-22101.93 563.5,-22049.93 657.5,-22049.93 657.5,-22101.93"/>
<text text-anchor="middle" x="610.5" y="-22089.93" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="610.5" y="-22078.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="610.5" y="-22067.93" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="610.5" y="-22056.93" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu5 -->
<g id="edge43" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M525.9,-22137.74C538.23,-22128.87 553.1,-22118.19 566.91,-22108.26"/>
<polygon fill="black" stroke="black" points="569.26,-22110.89 575.33,-22102.21 565.17,-22105.2 569.26,-22110.89"/>
</g>
<!-- layer_0_mlp_fc1_gpu6 -->
<g id="node31" class="node">
<title>layer_0_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="769.5,-22101.93 675.5,-22101.93 675.5,-22049.93 769.5,-22049.93 769.5,-22101.93"/>
<text text-anchor="middle" x="722.5" y="-22089.93" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="722.5" y="-22078.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="722.5" y="-22067.93" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="722.5" y="-22056.93" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu6 -->
<g id="edge44" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M535.25,-22146.46C567.53,-22136.57 615.88,-22121.12 665.92,-22102.02"/>
<polygon fill="black" stroke="black" points="667.21,-22105.27 675.28,-22098.41 664.7,-22098.74 667.21,-22105.27"/>
</g>
<!-- layer_0_mlp_fc1_gpu7 -->
<g id="node32" class="node">
<title>layer_0_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="881.5,-22101.93 787.5,-22101.93 787.5,-22049.93 881.5,-22049.93 881.5,-22101.93"/>
<text text-anchor="middle" x="834.5" y="-22089.93" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="834.5" y="-22078.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="834.5" y="-22067.93" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="834.5" y="-22056.93" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu7 -->
<g id="edge45" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M535.4,-22152.81C587.74,-22145.67 686.45,-22130.07 777.77,-22101.88"/>
<polygon fill="black" stroke="black" points="778.95,-22105.17 787.43,-22098.83 776.84,-22098.5 778.95,-22105.17"/>
</g>
<!-- layer_0_allgather_mlp -->
<g id="node33" class="node">
<title>layer_0_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="442.5" cy="-21984.94" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="442.5" y="-21993.44" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="442.5" y="-21982.44" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="442.5" y="-21971.44" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_0_mlp_fc1_gpu0&#45;&gt;layer_0_allgather_mlp -->
<g id="edge46" class="edge">
<title>layer_0_mlp_fc1_gpu0&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M97.56,-22053C100.56,-22051.89 103.55,-22050.86 106.5,-22049.93 198.52,-22021.06 309.02,-22003.06 377.51,-21993.77"/>
<polygon fill="black" stroke="black" points="378.27,-21997.2 387.72,-21992.4 377.34,-21990.26 378.27,-21997.2"/>
</g>
<!-- layer_0_mlp_fc1_gpu1&#45;&gt;layer_0_allgather_mlp -->
<g id="edge47" class="edge">
<title>layer_0_mlp_fc1_gpu1&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M209.66,-22053.31C212.64,-22052.12 215.6,-22050.99 218.5,-22049.93 273.03,-22030.08 336.79,-22012.38 382.32,-22000.66"/>
<polygon fill="black" stroke="black" points="383.21,-22004.04 392.03,-21998.17 381.47,-21997.26 383.21,-22004.04"/>
</g>
<!-- layer_0_mlp_fc1_gpu2&#45;&gt;layer_0_allgather_mlp -->
<g id="edge48" class="edge">
<title>layer_0_mlp_fc1_gpu2&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M321.74,-22049.9C344.71,-22037.74 372.23,-22023.16 395.2,-22010.99"/>
<polygon fill="black" stroke="black" points="396.89,-22014.06 404.09,-22006.29 393.61,-22007.88 396.89,-22014.06"/>
</g>
<!-- layer_0_mlp_fc1_gpu3&#45;&gt;layer_0_allgather_mlp -->
<g id="edge49" class="edge">
<title>layer_0_mlp_fc1_gpu3&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M402.4,-22049.67C407.94,-22040.85 414.27,-22030.8 420.24,-22021.31"/>
<polygon fill="black" stroke="black" points="423.22,-22023.15 425.58,-22012.82 417.3,-22019.42 423.22,-22023.15"/>
</g>
<!-- layer_0_mlp_fc1_gpu4&#45;&gt;layer_0_allgather_mlp -->
<g id="edge50" class="edge">
<title>layer_0_mlp_fc1_gpu4&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M482.6,-22049.67C477.06,-22040.85 470.73,-22030.8 464.76,-22021.31"/>
<polygon fill="black" stroke="black" points="467.7,-22019.42 459.42,-22012.82 461.78,-22023.15 467.7,-22019.42"/>
</g>
<!-- layer_0_mlp_fc1_gpu5&#45;&gt;layer_0_allgather_mlp -->
<g id="edge51" class="edge">
<title>layer_0_mlp_fc1_gpu5&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M563.26,-22049.9C540.29,-22037.74 512.77,-22023.16 489.8,-22010.99"/>
<polygon fill="black" stroke="black" points="491.39,-22007.88 480.91,-22006.29 488.11,-22014.06 491.39,-22007.88"/>
</g>
<!-- layer_0_mlp_fc1_gpu6&#45;&gt;layer_0_allgather_mlp -->
<g id="edge52" class="edge">
<title>layer_0_mlp_fc1_gpu6&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M675.34,-22053.31C672.36,-22052.12 669.4,-22050.99 666.5,-22049.93 611.97,-22030.08 548.21,-22012.38 502.68,-22000.66"/>
<polygon fill="black" stroke="black" points="503.53,-21997.26 492.97,-21998.17 501.79,-22004.04 503.53,-21997.26"/>
</g>
<!-- layer_0_mlp_fc1_gpu7&#45;&gt;layer_0_allgather_mlp -->
<g id="edge53" class="edge">
<title>layer_0_mlp_fc1_gpu7&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M787.44,-22053C784.44,-22051.89 781.45,-22050.86 778.5,-22049.93 686.48,-22021.06 575.98,-22003.06 507.49,-21993.77"/>
<polygon fill="black" stroke="black" points="507.66,-21990.26 497.28,-21992.4 506.73,-21997.2 507.66,-21990.26"/>
</g>
<!-- layer_0_gelu -->
<g id="node34" class="node">
<title>layer_0_gelu</title>
<polygon fill="lightblue" stroke="black" points="487,-21919.95 398,-21919.95 398,-21883.95 487,-21883.95 487,-21919.95"/>
<text text-anchor="middle" x="442.5" y="-21904.95" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="442.5" y="-21893.95" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_0_allgather_mlp&#45;&gt;layer_0_gelu -->
<g id="edge54" class="edge">
<title>layer_0_allgather_mlp&#45;&gt;layer_0_gelu</title>
<path fill="none" stroke="black" d="M442.5,-21955.61C442.5,-21947.37 442.5,-21938.38 442.5,-21930.2"/>
<polygon fill="black" stroke="black" points="446,-21930.04 442.5,-21920.04 439,-21930.04 446,-21930.04"/>
</g>
<!-- layer_0_mlp_fc2_gpu0 -->
<g id="node35" class="node">
<title>layer_0_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="97.5,-21847.95 3.5,-21847.95 3.5,-21795.95 97.5,-21795.95 97.5,-21847.95"/>
<text text-anchor="middle" x="50.5" y="-21835.95" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="50.5" y="-21824.95" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="50.5" y="-21813.95" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="50.5" y="-21802.95" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu0 -->
<g id="edge55" class="edge">
<title>layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu0</title>
<path fill="none" stroke="black" d="M397.92,-21897.67C334.69,-21892.21 215.52,-21878.92 107.29,-21847.85"/>
<polygon fill="black" stroke="black" points="108.1,-21844.44 97.52,-21844.99 106.14,-21851.16 108.1,-21844.44"/>
</g>
<!-- layer_0_mlp_fc2_gpu1 -->
<g id="node36" class="node">
<title>layer_0_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="209.5,-21847.95 115.5,-21847.95 115.5,-21795.95 209.5,-21795.95 209.5,-21847.95"/>
<text text-anchor="middle" x="162.5" y="-21835.95" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="162.5" y="-21824.95" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="162.5" y="-21813.95" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="162.5" y="-21802.95" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu1 -->
<g id="edge56" class="edge">
<title>layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu1</title>
<path fill="none" stroke="black" d="M397.61,-21892.9C354.02,-21884.52 286.01,-21869.94 219.42,-21848.01"/>
<polygon fill="black" stroke="black" points="220.2,-21844.59 209.61,-21844.73 217.98,-21851.22 220.2,-21844.59"/>
</g>
<!-- layer_0_mlp_fc2_gpu2 -->
<g id="node37" class="node">
<title>layer_0_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="321.5,-21847.95 227.5,-21847.95 227.5,-21795.95 321.5,-21795.95 321.5,-21847.95"/>
<text text-anchor="middle" x="274.5" y="-21835.95" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="274.5" y="-21824.95" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="274.5" y="-21813.95" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="274.5" y="-21802.95" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu2 -->
<g id="edge57" class="edge">
<title>layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu2</title>
<path fill="none" stroke="black" d="M405.63,-21883.83C383.71,-21873.65 355.45,-21860.53 330.78,-21849.08"/>
<polygon fill="black" stroke="black" points="332.06,-21845.82 321.52,-21844.78 329.12,-21852.16 332.06,-21845.82"/>
</g>
<!-- layer_0_mlp_fc2_gpu3 -->
<g id="node38" class="node">
<title>layer_0_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="433.5,-21847.95 339.5,-21847.95 339.5,-21795.95 433.5,-21795.95 433.5,-21847.95"/>
<text text-anchor="middle" x="386.5" y="-21835.95" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="386.5" y="-21824.95" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="386.5" y="-21813.95" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="386.5" y="-21802.95" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu3 -->
<g id="edge58" class="edge">
<title>layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu3</title>
<path fill="none" stroke="black" d="M430.07,-21883.64C424.35,-21875.67 417.35,-21865.92 410.65,-21856.59"/>
<polygon fill="black" stroke="black" points="413.31,-21854.29 404.63,-21848.21 407.62,-21858.37 413.31,-21854.29"/>
</g>
<!-- layer_0_mlp_fc2_gpu4 -->
<g id="node39" class="node">
<title>layer_0_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="545.5,-21847.95 451.5,-21847.95 451.5,-21795.95 545.5,-21795.95 545.5,-21847.95"/>
<text text-anchor="middle" x="498.5" y="-21835.95" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="498.5" y="-21824.95" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="498.5" y="-21813.95" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="498.5" y="-21802.95" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu4 -->
<g id="edge59" class="edge">
<title>layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu4</title>
<path fill="none" stroke="black" d="M454.93,-21883.64C460.65,-21875.67 467.65,-21865.92 474.35,-21856.59"/>
<polygon fill="black" stroke="black" points="477.38,-21858.37 480.37,-21848.21 471.69,-21854.29 477.38,-21858.37"/>
</g>
<!-- layer_0_mlp_fc2_gpu5 -->
<g id="node40" class="node">
<title>layer_0_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="657.5,-21847.95 563.5,-21847.95 563.5,-21795.95 657.5,-21795.95 657.5,-21847.95"/>
<text text-anchor="middle" x="610.5" y="-21835.95" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="610.5" y="-21824.95" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="610.5" y="-21813.95" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="610.5" y="-21802.95" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu5 -->
<g id="edge60" class="edge">
<title>layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu5</title>
<path fill="none" stroke="black" d="M479.37,-21883.83C501.29,-21873.65 529.55,-21860.53 554.22,-21849.08"/>
<polygon fill="black" stroke="black" points="555.88,-21852.16 563.48,-21844.78 552.94,-21845.82 555.88,-21852.16"/>
</g>
<!-- layer_0_mlp_fc2_gpu6 -->
<g id="node41" class="node">
<title>layer_0_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="769.5,-21847.95 675.5,-21847.95 675.5,-21795.95 769.5,-21795.95 769.5,-21847.95"/>
<text text-anchor="middle" x="722.5" y="-21835.95" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="722.5" y="-21824.95" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="722.5" y="-21813.95" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="722.5" y="-21802.95" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu6 -->
<g id="edge61" class="edge">
<title>layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu6</title>
<path fill="none" stroke="black" d="M487.39,-21892.9C530.98,-21884.52 598.99,-21869.94 665.58,-21848.01"/>
<polygon fill="black" stroke="black" points="667.02,-21851.22 675.39,-21844.73 664.8,-21844.59 667.02,-21851.22"/>
</g>
<!-- layer_0_mlp_fc2_gpu7 -->
<g id="node42" class="node">
<title>layer_0_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="881.5,-21847.95 787.5,-21847.95 787.5,-21795.95 881.5,-21795.95 881.5,-21847.95"/>
<text text-anchor="middle" x="834.5" y="-21835.95" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="834.5" y="-21824.95" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="834.5" y="-21813.95" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="834.5" y="-21802.95" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu7 -->
<g id="edge62" class="edge">
<title>layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu7</title>
<path fill="none" stroke="black" d="M487.08,-21897.67C550.31,-21892.21 669.48,-21878.92 777.71,-21847.85"/>
<polygon fill="black" stroke="black" points="778.86,-21851.16 787.48,-21844.99 776.9,-21844.44 778.86,-21851.16"/>
</g>
<!-- layer_0_allreduce_mlp -->
<g id="node43" class="node">
<title>layer_0_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="498.5" cy="-21730.96" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="498.5" y="-21739.46" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="498.5" y="-21728.46" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="498.5" y="-21717.46" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_0_mlp_fc2_gpu0&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge63" class="edge">
<title>layer_0_mlp_fc2_gpu0&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M97.53,-21798.93C100.54,-21797.84 103.54,-21796.83 106.5,-21795.95 216.66,-21762.97 349.65,-21745.8 428.97,-21737.84"/>
<polygon fill="black" stroke="black" points="429.71,-21741.29 439.32,-21736.82 429.03,-21734.32 429.71,-21741.29"/>
</g>
<!-- layer_0_mlp_fc2_gpu1&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge64" class="edge">
<title>layer_0_mlp_fc2_gpu1&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M209.6,-21799.14C212.59,-21798 215.57,-21796.93 218.5,-21795.95 290.11,-21772.04 374.96,-21754.02 432.34,-21743.3"/>
<polygon fill="black" stroke="black" points="433.17,-21746.7 442.37,-21741.45 431.9,-21739.82 433.17,-21746.7"/>
</g>
<!-- layer_0_mlp_fc2_gpu2&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge65" class="edge">
<title>layer_0_mlp_fc2_gpu2&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M321.78,-21799.62C324.72,-21798.36 327.65,-21797.13 330.5,-21795.95 367.39,-21780.7 409.34,-21764.72 442.1,-21752.54"/>
<polygon fill="black" stroke="black" points="443.35,-21755.81 451.51,-21749.05 440.92,-21749.25 443.35,-21755.81"/>
</g>
<!-- layer_0_mlp_fc2_gpu3&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge66" class="edge">
<title>layer_0_mlp_fc2_gpu3&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M418,-21795.92C431.09,-21785.52 446.4,-21773.35 460.14,-21762.44"/>
<polygon fill="black" stroke="black" points="462.36,-21765.14 468.01,-21756.18 458.01,-21759.66 462.36,-21765.14"/>
</g>
<!-- layer_0_mlp_fc2_gpu4&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge67" class="edge">
<title>layer_0_mlp_fc2_gpu4&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M498.5,-21795.68C498.5,-21787.79 498.5,-21778.9 498.5,-21770.32"/>
<polygon fill="black" stroke="black" points="502,-21770.1 498.5,-21760.1 495,-21770.1 502,-21770.1"/>
</g>
<!-- layer_0_mlp_fc2_gpu5&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge68" class="edge">
<title>layer_0_mlp_fc2_gpu5&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M579,-21795.92C565.91,-21785.52 550.6,-21773.35 536.86,-21762.44"/>
<polygon fill="black" stroke="black" points="538.99,-21759.66 528.99,-21756.18 534.64,-21765.14 538.99,-21759.66"/>
</g>
<!-- layer_0_mlp_fc2_gpu6&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge69" class="edge">
<title>layer_0_mlp_fc2_gpu6&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M675.22,-21799.62C672.28,-21798.36 669.35,-21797.13 666.5,-21795.95 629.61,-21780.7 587.66,-21764.72 554.9,-21752.54"/>
<polygon fill="black" stroke="black" points="556.08,-21749.25 545.49,-21749.05 553.65,-21755.81 556.08,-21749.25"/>
</g>
<!-- layer_0_mlp_fc2_gpu7&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge70" class="edge">
<title>layer_0_mlp_fc2_gpu7&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M787.4,-21799.14C784.41,-21798 781.43,-21796.93 778.5,-21795.95 706.89,-21772.04 622.04,-21754.02 564.66,-21743.3"/>
<polygon fill="black" stroke="black" points="565.1,-21739.82 554.63,-21741.45 563.83,-21746.7 565.1,-21739.82"/>
</g>
<!-- layer_0_allreduce_mlp&#45;&gt;layer_0_residual2 -->
<g id="edge71" class="edge">
<title>layer_0_allreduce_mlp&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M541.47,-21710.46C571.5,-21696.84 611.96,-21678.49 644.93,-21663.53"/>
<polygon fill="black" stroke="black" points="646.8,-21666.53 654.46,-21659.21 643.91,-21660.15 646.8,-21666.53"/>
</g>
<!-- layer_0_ln2 -->
<g id="node45" class="node">
<title>layer_0_ln2</title>
<polygon fill="lightblue" stroke="black" points="740,-21569.97 667,-21569.97 667,-21528.97 740,-21528.97 740,-21569.97"/>
<text text-anchor="middle" x="703.5" y="-21557.97" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="703.5" y="-21546.97" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="703.5" y="-21535.97" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_0_residual2&#45;&gt;layer_0_ln2 -->
<g id="edge73" class="edge">
<title>layer_0_residual2&#45;&gt;layer_0_ln2</title>
<path fill="none" stroke="black" d="M703.5,-21605.89C703.5,-21597.56 703.5,-21588.48 703.5,-21580.12"/>
<polygon fill="black" stroke="black" points="707,-21580.03 703.5,-21570.03 700,-21580.03 707,-21580.03"/>
</g>
<!-- layer_0_output_dist -->
<g id="node46" class="node">
<title>layer_0_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="805.2,-21492.97 643.42,-21492.97 601.8,-21432.97 763.58,-21432.97 805.2,-21492.97"/>
<text text-anchor="middle" x="703.5" y="-21465.97" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="703.5" y="-21454.97" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_0_ln2&#45;&gt;layer_0_output_dist -->
<g id="edge74" class="edge">
<title>layer_0_ln2&#45;&gt;layer_0_output_dist</title>
<path fill="none" stroke="black" d="M703.5,-21528.87C703.5,-21521.23 703.5,-21512.19 703.5,-21503.32"/>
<polygon fill="black" stroke="black" points="707,-21503.08 703.5,-21493.08 700,-21503.08 707,-21503.08"/>
</g>
<!-- layer_1_input_dist -->
<g id="node47" class="node">
<title>layer_1_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="797.69,-21396.97 647.86,-21396.97 609.31,-21336.97 759.14,-21336.97 797.69,-21396.97"/>
<text text-anchor="middle" x="703.5" y="-21369.97" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="703.5" y="-21358.97" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_0_output_dist&#45;&gt;layer_1_input_dist -->
<g id="edge75" class="edge">
<title>layer_0_output_dist&#45;&gt;layer_1_input_dist</title>
<path fill="none" stroke="black" d="M703.5,-21432.74C703.5,-21424.69 703.5,-21415.83 703.5,-21407.31"/>
<polygon fill="black" stroke="black" points="707,-21407.17 703.5,-21397.17 700,-21407.17 707,-21407.17"/>
</g>
<!-- layer_1_qkv_gpu0 -->
<g id="node48" class="node">
<title>layer_1_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="306,-21300.97 213,-21300.97 213,-21248.97 306,-21248.97 306,-21300.97"/>
<text text-anchor="middle" x="259.5" y="-21288.97" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="259.5" y="-21277.97" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="259.5" y="-21266.97" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="259.5" y="-21255.97" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu0 -->
<g id="edge76" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu0</title>
<path fill="none" stroke="black" d="M623.13,-21358.72C545.73,-21350.36 425.67,-21333.71 315.86,-21301.1"/>
<polygon fill="black" stroke="black" points="316.88,-21297.75 306.29,-21298.21 314.85,-21304.45 316.88,-21297.75"/>
</g>
<!-- layer_1_qkv_gpu1 -->
<g id="node49" class="node">
<title>layer_1_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="417,-21300.97 324,-21300.97 324,-21248.97 417,-21248.97 417,-21300.97"/>
<text text-anchor="middle" x="370.5" y="-21288.97" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="370.5" y="-21277.97" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="370.5" y="-21266.97" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="370.5" y="-21255.97" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu1 -->
<g id="edge77" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu1</title>
<path fill="none" stroke="black" d="M617.72,-21350.46C564.64,-21339.8 495.18,-21323.95 426.71,-21301.15"/>
<polygon fill="black" stroke="black" points="427.65,-21297.77 417.05,-21297.88 425.41,-21304.4 427.65,-21297.77"/>
</g>
<!-- layer_1_qkv_gpu2 -->
<g id="node50" class="node">
<title>layer_1_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="528,-21300.97 435,-21300.97 435,-21248.97 528,-21248.97 528,-21300.97"/>
<text text-anchor="middle" x="481.5" y="-21288.97" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="481.5" y="-21277.97" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="481.5" y="-21266.97" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="481.5" y="-21255.97" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu2 -->
<g id="edge78" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu2</title>
<path fill="none" stroke="black" d="M627.17,-21336.94C598.89,-21325.95 566.62,-21313.16 537.5,-21300.97 537.4,-21300.93 537.31,-21300.89 537.21,-21300.85"/>
<polygon fill="black" stroke="black" points="538.75,-21297.7 528.18,-21297 536.01,-21304.14 538.75,-21297.7"/>
</g>
<!-- layer_1_qkv_gpu3 -->
<g id="node51" class="node">
<title>layer_1_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="639,-21300.97 546,-21300.97 546,-21248.97 639,-21248.97 639,-21300.97"/>
<text text-anchor="middle" x="592.5" y="-21288.97" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="592.5" y="-21277.97" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="592.5" y="-21266.97" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="592.5" y="-21255.97" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu3 -->
<g id="edge79" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu3</title>
<path fill="none" stroke="black" d="M667.46,-21336.74C655.94,-21327.4 643.14,-21317.02 631.42,-21307.52"/>
<polygon fill="black" stroke="black" points="633.48,-21304.69 623.51,-21301.11 629.08,-21310.13 633.48,-21304.69"/>
</g>
<!-- layer_1_qkv_gpu4 -->
<g id="node52" class="node">
<title>layer_1_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="750,-21300.97 657,-21300.97 657,-21248.97 750,-21248.97 750,-21300.97"/>
<text text-anchor="middle" x="703.5" y="-21288.97" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="703.5" y="-21277.97" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="703.5" y="-21266.97" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="703.5" y="-21255.97" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu4 -->
<g id="edge80" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu4</title>
<path fill="none" stroke="black" d="M703.5,-21336.5C703.5,-21328.42 703.5,-21319.59 703.5,-21311.22"/>
<polygon fill="black" stroke="black" points="707,-21310.98 703.5,-21300.98 700,-21310.98 707,-21310.98"/>
</g>
<!-- layer_1_qkv_gpu5 -->
<g id="node53" class="node">
<title>layer_1_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="861,-21300.97 768,-21300.97 768,-21248.97 861,-21248.97 861,-21300.97"/>
<text text-anchor="middle" x="814.5" y="-21288.97" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="814.5" y="-21277.97" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="814.5" y="-21266.97" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="814.5" y="-21255.97" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu5 -->
<g id="edge81" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu5</title>
<path fill="none" stroke="black" d="M739.54,-21336.74C751.06,-21327.4 763.86,-21317.02 775.58,-21307.52"/>
<polygon fill="black" stroke="black" points="777.92,-21310.13 783.49,-21301.11 773.52,-21304.69 777.92,-21310.13"/>
</g>
<!-- layer_1_qkv_gpu6 -->
<g id="node54" class="node">
<title>layer_1_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="972,-21300.97 879,-21300.97 879,-21248.97 972,-21248.97 972,-21300.97"/>
<text text-anchor="middle" x="925.5" y="-21288.97" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="925.5" y="-21277.97" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="925.5" y="-21266.97" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="925.5" y="-21255.97" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu6 -->
<g id="edge82" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu6</title>
<path fill="none" stroke="black" d="M763.73,-21343.45C793.33,-21332.17 829.68,-21317.99 869.42,-21301.35"/>
<polygon fill="black" stroke="black" points="870.91,-21304.52 878.77,-21297.42 868.2,-21298.07 870.91,-21304.52"/>
</g>
<!-- layer_1_qkv_gpu7 -->
<g id="node55" class="node">
<title>layer_1_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1083,-21300.97 990,-21300.97 990,-21248.97 1083,-21248.97 1083,-21300.97"/>
<text text-anchor="middle" x="1036.5" y="-21288.97" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="1036.5" y="-21277.97" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1036.5" y="-21266.97" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1036.5" y="-21255.97" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu7 -->
<g id="edge83" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu7</title>
<path fill="none" stroke="black" d="M770.25,-21354.2C824.88,-21343.7 904.07,-21326.49 980.2,-21301.17"/>
<polygon fill="black" stroke="black" points="981.59,-21304.4 989.95,-21297.88 979.35,-21297.77 981.59,-21304.4"/>
</g>
<!-- layer_1_residual1 -->
<g id="node67" class="node">
<title>layer_1_residual1</title>
<polygon fill="lightyellow" stroke="black" points="993.44,-20849 871.05,-20849 839.56,-20789 961.95,-20789 993.44,-20849"/>
<text text-anchor="middle" x="916.5" y="-20822" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="916.5" y="-20811" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_residual1 -->
<g id="edge110" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M776.59,-21363.62C876.77,-21358.81 1049.3,-21344.31 1092.5,-21300.97 1129.38,-21263.97 1111.5,-21237.21 1111.5,-21184.97 1111.5,-21184.97 1111.5,-21184.97 1111.5,-21003.98 1111.5,-20935.2 1046.52,-20884.52 991.59,-20853.97"/>
<polygon fill="black" stroke="black" points="992.98,-20850.74 982.52,-20849.05 989.64,-20856.89 992.98,-20850.74"/>
</g>
<!-- layer_1_allgather_qkv -->
<g id="node56" class="node">
<title>layer_1_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="659.5" cy="-21183.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="659.5" y="-21192.47" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="659.5" y="-21181.47" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="659.5" y="-21170.47" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_1_qkv_gpu0&#45;&gt;layer_1_allgather_qkv -->
<g id="edge84" class="edge">
<title>layer_1_qkv_gpu0&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M306,-21251.9C308.85,-21250.84 311.7,-21249.85 314.5,-21248.97 409.34,-21219.11 523.49,-21201.31 593.77,-21192.33"/>
<polygon fill="black" stroke="black" points="594.33,-21195.79 603.82,-21191.07 593.46,-21188.84 594.33,-21195.79"/>
</g>
<!-- layer_1_qkv_gpu1&#45;&gt;layer_1_allgather_qkv -->
<g id="edge85" class="edge">
<title>layer_1_qkv_gpu1&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M417.1,-21252.17C419.92,-21251.04 422.74,-21249.96 425.5,-21248.97 482.82,-21228.25 550.1,-21210.51 597.78,-21199"/>
<polygon fill="black" stroke="black" points="598.73,-21202.37 607.64,-21196.64 597.1,-21195.56 598.73,-21202.37"/>
</g>
<!-- layer_1_qkv_gpu2&#45;&gt;layer_1_allgather_qkv -->
<g id="edge86" class="edge">
<title>layer_1_qkv_gpu2&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M528.27,-21250.58C553.59,-21237.93 584.84,-21222.3 610.5,-21209.47"/>
<polygon fill="black" stroke="black" points="612.3,-21212.49 619.68,-21204.88 609.17,-21206.22 612.3,-21212.49"/>
</g>
<!-- layer_1_qkv_gpu3&#45;&gt;layer_1_allgather_qkv -->
<g id="edge87" class="edge">
<title>layer_1_qkv_gpu3&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M611.52,-21248.7C618.41,-21239.55 626.32,-21229.05 633.69,-21219.25"/>
<polygon fill="black" stroke="black" points="636.51,-21221.32 639.73,-21211.23 630.92,-21217.11 636.51,-21221.32"/>
</g>
<!-- layer_1_qkv_gpu4&#45;&gt;layer_1_allgather_qkv -->
<g id="edge88" class="edge">
<title>layer_1_qkv_gpu4&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M691.01,-21248.7C686.78,-21240.15 681.97,-21230.42 677.4,-21221.18"/>
<polygon fill="black" stroke="black" points="680.52,-21219.58 672.95,-21212.17 674.24,-21222.68 680.52,-21219.58"/>
</g>
<!-- layer_1_qkv_gpu5&#45;&gt;layer_1_allgather_qkv -->
<g id="edge89" class="edge">
<title>layer_1_qkv_gpu5&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M770.91,-21248.94C750.48,-21237.21 726.12,-21223.22 705.4,-21211.33"/>
<polygon fill="black" stroke="black" points="706.88,-21208.14 696.47,-21206.2 703.4,-21214.21 706.88,-21208.14"/>
</g>
<!-- layer_1_qkv_gpu6&#45;&gt;layer_1_allgather_qkv -->
<g id="edge90" class="edge">
<title>layer_1_qkv_gpu6&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M878.87,-21252.26C876.05,-21251.11 873.25,-21250 870.5,-21248.97 820.32,-21230.05 761.88,-21212.67 719.24,-21200.82"/>
<polygon fill="black" stroke="black" points="720.15,-21197.43 709.57,-21198.15 718.28,-21204.18 720.15,-21197.43"/>
</g>
<!-- layer_1_qkv_gpu7&#45;&gt;layer_1_allgather_qkv -->
<g id="edge91" class="edge">
<title>layer_1_qkv_gpu7&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M989.98,-21251.94C987.14,-21250.87 984.3,-21249.87 981.5,-21248.97 894.72,-21221.03 790.69,-21203.03 724.83,-21193.44"/>
<polygon fill="black" stroke="black" points="724.99,-21189.93 714.6,-21191.98 724,-21196.86 724.99,-21189.93"/>
</g>
<!-- layer_1_attention -->
<g id="node57" class="node">
<title>layer_1_attention</title>
<polygon fill="lightblue" stroke="black" points="693.5,-21118.98 625.5,-21118.98 625.5,-21066.98 693.5,-21066.98 693.5,-21118.98"/>
<text text-anchor="middle" x="659.5" y="-21106.98" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="659.5" y="-21095.98" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="659.5" y="-21084.98" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="659.5" y="-21073.98" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_1_allgather_qkv&#45;&gt;layer_1_attention -->
<g id="edge92" class="edge">
<title>layer_1_allgather_qkv&#45;&gt;layer_1_attention</title>
<path fill="none" stroke="black" d="M659.5,-21154.82C659.5,-21146.71 659.5,-21137.76 659.5,-21129.27"/>
<polygon fill="black" stroke="black" points="663,-21129.25 659.5,-21119.25 656,-21129.25 663,-21129.25"/>
</g>
<!-- layer_1_attn_out_gpu0 -->
<g id="node58" class="node">
<title>layer_1_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="341.5,-21030.98 253.5,-21030.98 253.5,-20978.98 341.5,-20978.98 341.5,-21030.98"/>
<text text-anchor="middle" x="297.5" y="-21018.98" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="297.5" y="-21007.98" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="297.5" y="-20996.98" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="297.5" y="-20985.98" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attention&#45;&gt;layer_1_attn_out_gpu0 -->
<g id="edge93" class="edge">
<title>layer_1_attention&#45;&gt;layer_1_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M625.43,-21088.04C569.48,-21080.98 454.85,-21064.01 351.37,-21030.95"/>
<polygon fill="black" stroke="black" points="352.3,-21027.57 341.71,-21027.8 350.13,-21034.23 352.3,-21027.57"/>
</g>
<!-- layer_1_attn_out_gpu1 -->
<g id="node59" class="node">
<title>layer_1_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="447.5,-21030.98 359.5,-21030.98 359.5,-20978.98 447.5,-20978.98 447.5,-21030.98"/>
<text text-anchor="middle" x="403.5" y="-21018.98" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="403.5" y="-21007.98" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="403.5" y="-20996.98" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="403.5" y="-20985.98" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attention&#45;&gt;layer_1_attn_out_gpu1 -->
<g id="edge94" class="edge">
<title>layer_1_attention&#45;&gt;layer_1_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M625.22,-21083.35C586.35,-21073.21 521.05,-21055.06 456.97,-21030.95"/>
<polygon fill="black" stroke="black" points="458.12,-21027.65 447.53,-21027.35 455.63,-21034.19 458.12,-21027.65"/>
</g>
<!-- layer_1_attn_out_gpu2 -->
<g id="node60" class="node">
<title>layer_1_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="553.5,-21030.98 465.5,-21030.98 465.5,-20978.98 553.5,-20978.98 553.5,-21030.98"/>
<text text-anchor="middle" x="509.5" y="-21018.98" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="509.5" y="-21007.98" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="509.5" y="-20996.98" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="509.5" y="-20985.98" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attention&#45;&gt;layer_1_attn_out_gpu2 -->
<g id="edge95" class="edge">
<title>layer_1_attention&#45;&gt;layer_1_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M625.46,-21072.47C606.78,-21061.76 583.21,-21048.24 562.2,-21036.2"/>
<polygon fill="black" stroke="black" points="563.8,-21033.08 553.38,-21031.14 560.31,-21039.15 563.8,-21033.08"/>
</g>
<!-- layer_1_attn_out_gpu3 -->
<g id="node61" class="node">
<title>layer_1_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="659.5,-21030.98 571.5,-21030.98 571.5,-20978.98 659.5,-20978.98 659.5,-21030.98"/>
<text text-anchor="middle" x="615.5" y="-21018.98" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="615.5" y="-21007.98" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="615.5" y="-20996.98" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="615.5" y="-20985.98" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attention&#45;&gt;layer_1_attn_out_gpu3 -->
<g id="edge96" class="edge">
<title>layer_1_attention&#45;&gt;layer_1_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M646.54,-21066.64C642.28,-21058.33 637.49,-21048.96 632.96,-21040.11"/>
<polygon fill="black" stroke="black" points="636.04,-21038.45 628.37,-21031.14 629.81,-21041.64 636.04,-21038.45"/>
</g>
<!-- layer_1_attn_out_gpu4 -->
<g id="node62" class="node">
<title>layer_1_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="765.5,-21030.98 677.5,-21030.98 677.5,-20978.98 765.5,-20978.98 765.5,-21030.98"/>
<text text-anchor="middle" x="721.5" y="-21018.98" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="721.5" y="-21007.98" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="721.5" y="-20996.98" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="721.5" y="-20985.98" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attention&#45;&gt;layer_1_attn_out_gpu4 -->
<g id="edge97" class="edge">
<title>layer_1_attention&#45;&gt;layer_1_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M677.77,-21066.64C683.95,-21058.07 690.95,-21048.36 697.5,-21039.27"/>
<polygon fill="black" stroke="black" points="700.35,-21041.3 703.36,-21031.14 694.68,-21037.2 700.35,-21041.3"/>
</g>
<!-- layer_1_attn_out_gpu5 -->
<g id="node63" class="node">
<title>layer_1_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="871.5,-21030.98 783.5,-21030.98 783.5,-20978.98 871.5,-20978.98 871.5,-21030.98"/>
<text text-anchor="middle" x="827.5" y="-21018.98" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="827.5" y="-21007.98" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="827.5" y="-20996.98" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="827.5" y="-20985.98" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attention&#45;&gt;layer_1_attn_out_gpu5 -->
<g id="edge98" class="edge">
<title>layer_1_attention&#45;&gt;layer_1_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M693.9,-21074.37C717,-21062.55 747.9,-21046.73 774.16,-21033.29"/>
<polygon fill="black" stroke="black" points="775.93,-21036.31 783.24,-21028.64 772.74,-21030.08 775.93,-21036.31"/>
</g>
<!-- layer_1_attn_out_gpu6 -->
<g id="node64" class="node">
<title>layer_1_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="977.5,-21030.98 889.5,-21030.98 889.5,-20978.98 977.5,-20978.98 977.5,-21030.98"/>
<text text-anchor="middle" x="933.5" y="-21018.98" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="933.5" y="-21007.98" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="933.5" y="-20996.98" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="933.5" y="-20985.98" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attention&#45;&gt;layer_1_attn_out_gpu6 -->
<g id="edge99" class="edge">
<title>layer_1_attention&#45;&gt;layer_1_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M693.77,-21084.45C735.82,-21074.8 809.28,-21056.57 879.99,-21030.93"/>
<polygon fill="black" stroke="black" points="881.32,-21034.17 889.5,-21027.43 878.9,-21027.6 881.32,-21034.17"/>
</g>
<!-- layer_1_attn_out_gpu7 -->
<g id="node65" class="node">
<title>layer_1_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1083.5,-21030.98 995.5,-21030.98 995.5,-20978.98 1083.5,-20978.98 1083.5,-21030.98"/>
<text text-anchor="middle" x="1039.5" y="-21018.98" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="1039.5" y="-21007.98" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1039.5" y="-20996.98" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1039.5" y="-20985.98" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attention&#45;&gt;layer_1_attn_out_gpu7 -->
<g id="edge100" class="edge">
<title>layer_1_attention&#45;&gt;layer_1_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M693.63,-21088.53C752.2,-21081.99 875.4,-21065.52 985.69,-21030.91"/>
<polygon fill="black" stroke="black" points="986.84,-21034.22 995.3,-21027.84 984.71,-21027.55 986.84,-21034.22"/>
</g>
<!-- layer_1_allreduce_attn -->
<g id="node66" class="node">
<title>layer_1_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="721.5" cy="-20913.99" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="721.5" y="-20922.49" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="721.5" y="-20911.49" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="721.5" y="-20900.49" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_1_attn_out_gpu0&#45;&gt;layer_1_allreduce_attn -->
<g id="edge101" class="edge">
<title>layer_1_attn_out_gpu0&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M341.68,-20982.08C344.63,-20980.95 347.59,-20979.9 350.5,-20978.98 453.93,-20946.33 579.16,-20929.12 654.47,-20921.05"/>
<polygon fill="black" stroke="black" points="655.17,-20924.5 664.75,-20919.98 654.44,-20917.54 655.17,-20924.5"/>
</g>
<!-- layer_1_attn_out_gpu1&#45;&gt;layer_1_allreduce_attn -->
<g id="edge102" class="edge">
<title>layer_1_attn_out_gpu1&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M447.76,-20982.3C450.69,-20981.12 453.62,-20980 456.5,-20978.98 523.63,-20955.32 603.34,-20937.38 657.69,-20926.6"/>
<polygon fill="black" stroke="black" points="658.39,-20930.03 667.53,-20924.67 657.04,-20923.16 658.39,-20930.03"/>
</g>
<!-- layer_1_attn_out_gpu2&#45;&gt;layer_1_allreduce_attn -->
<g id="edge103" class="edge">
<title>layer_1_attn_out_gpu2&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M553.66,-20982.92C556.64,-20981.57 559.61,-20980.24 562.5,-20978.98 596.83,-20963.99 635.84,-20948.27 666.63,-20936.17"/>
<polygon fill="black" stroke="black" points="668.29,-20939.27 676.32,-20932.37 665.73,-20932.76 668.29,-20939.27"/>
</g>
<!-- layer_1_attn_out_gpu3&#45;&gt;layer_1_allreduce_attn -->
<g id="edge104" class="edge">
<title>layer_1_attn_out_gpu3&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M645.31,-20978.96C657.58,-20968.65 671.92,-20956.62 684.83,-20945.78"/>
<polygon fill="black" stroke="black" points="687.24,-20948.33 692.65,-20939.22 682.74,-20942.97 687.24,-20948.33"/>
</g>
<!-- layer_1_attn_out_gpu4&#45;&gt;layer_1_allreduce_attn -->
<g id="edge105" class="edge">
<title>layer_1_attn_out_gpu4&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M721.5,-20978.72C721.5,-20970.83 721.5,-20961.94 721.5,-20953.36"/>
<polygon fill="black" stroke="black" points="725,-20953.13 721.5,-20943.13 718,-20953.13 725,-20953.13"/>
</g>
<!-- layer_1_attn_out_gpu5&#45;&gt;layer_1_allreduce_attn -->
<g id="edge106" class="edge">
<title>layer_1_attn_out_gpu5&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M797.69,-20978.96C785.42,-20968.65 771.08,-20956.62 758.17,-20945.78"/>
<polygon fill="black" stroke="black" points="760.26,-20942.97 750.35,-20939.22 755.76,-20948.33 760.26,-20942.97"/>
</g>
<!-- layer_1_attn_out_gpu6&#45;&gt;layer_1_allreduce_attn -->
<g id="edge107" class="edge">
<title>layer_1_attn_out_gpu6&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M889.34,-20982.92C886.36,-20981.57 883.39,-20980.24 880.5,-20978.98 846.17,-20963.99 807.16,-20948.27 776.37,-20936.17"/>
<polygon fill="black" stroke="black" points="777.27,-20932.76 766.68,-20932.37 774.71,-20939.27 777.27,-20932.76"/>
</g>
<!-- layer_1_attn_out_gpu7&#45;&gt;layer_1_allreduce_attn -->
<g id="edge108" class="edge">
<title>layer_1_attn_out_gpu7&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M995.24,-20982.3C992.31,-20981.12 989.38,-20980 986.5,-20978.98 919.37,-20955.32 839.66,-20937.38 785.31,-20926.6"/>
<polygon fill="black" stroke="black" points="785.96,-20923.16 775.47,-20924.67 784.61,-20930.03 785.96,-20923.16"/>
</g>
<!-- layer_1_allreduce_attn&#45;&gt;layer_1_residual1 -->
<g id="edge109" class="edge">
<title>layer_1_allreduce_attn&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M762.85,-20893.27C790.62,-20880.03 827.59,-20862.4 858.31,-20847.75"/>
<polygon fill="black" stroke="black" points="860.1,-20850.77 867.62,-20843.31 857.09,-20844.45 860.1,-20850.77"/>
</g>
<!-- layer_1_ln1 -->
<g id="node68" class="node">
<title>layer_1_ln1</title>
<polygon fill="lightblue" stroke="black" points="748,-20753 675,-20753 675,-20712 748,-20712 748,-20753"/>
<text text-anchor="middle" x="711.5" y="-20741" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="711.5" y="-20730" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="711.5" y="-20719" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_1_residual1&#45;&gt;layer_1_ln1 -->
<g id="edge111" class="edge">
<title>layer_1_residual1&#45;&gt;layer_1_ln1</title>
<path fill="none" stroke="black" d="M845.95,-20788.92C816.66,-20776.84 783.49,-20763.17 757.43,-20752.43"/>
<polygon fill="black" stroke="black" points="758.75,-20749.19 748.17,-20748.62 756.08,-20755.66 758.75,-20749.19"/>
</g>
<!-- layer_1_residual2 -->
<g id="node88" class="node">
<title>layer_1_residual2</title>
<polygon fill="lightyellow" stroke="black" points="993.44,-20240.03 871.05,-20240.03 839.56,-20180.03 961.95,-20180.03 993.44,-20240.03"/>
<text text-anchor="middle" x="916.5" y="-20213.03" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="916.5" y="-20202.03" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_1_residual1&#45;&gt;layer_1_residual2 -->
<g id="edge146" class="edge">
<title>layer_1_residual1&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M968.48,-20801.44C1029.51,-20778.35 1122.5,-20730.19 1122.5,-20651 1122.5,-20651 1122.5,-20651 1122.5,-20395.02 1122.5,-20324.81 1055.11,-20274.73 997.42,-20244.71"/>
<polygon fill="black" stroke="black" points="998.76,-20241.47 988.26,-20240.07 995.6,-20247.71 998.76,-20241.47"/>
</g>
<!-- layer_1_mlp_fc1_gpu0 -->
<g id="node69" class="node">
<title>layer_1_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="310.5,-20676 216.5,-20676 216.5,-20624 310.5,-20624 310.5,-20676"/>
<text text-anchor="middle" x="263.5" y="-20664" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="263.5" y="-20653" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="263.5" y="-20642" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="263.5" y="-20631" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu0 -->
<g id="edge112" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M674.85,-20729.72C606.28,-20725.67 454.17,-20713.25 320.13,-20675.83"/>
<polygon fill="black" stroke="black" points="321.08,-20672.47 310.51,-20673.1 319.17,-20679.2 321.08,-20672.47"/>
</g>
<!-- layer_1_mlp_fc1_gpu1 -->
<g id="node70" class="node">
<title>layer_1_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="422.5,-20676 328.5,-20676 328.5,-20624 422.5,-20624 422.5,-20676"/>
<text text-anchor="middle" x="375.5" y="-20664" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="375.5" y="-20653" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="375.5" y="-20642" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="375.5" y="-20631" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu1 -->
<g id="edge113" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M674.6,-20726.87C622.26,-20719.74 523.55,-20704.14 432.23,-20675.94"/>
<polygon fill="black" stroke="black" points="433.16,-20672.57 422.57,-20672.9 431.05,-20679.24 433.16,-20672.57"/>
</g>
<!-- layer_1_mlp_fc1_gpu2 -->
<g id="node71" class="node">
<title>layer_1_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="534.5,-20676 440.5,-20676 440.5,-20624 534.5,-20624 534.5,-20676"/>
<text text-anchor="middle" x="487.5" y="-20664" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="487.5" y="-20653" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="487.5" y="-20642" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="487.5" y="-20631" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu2 -->
<g id="edge114" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M674.75,-20720.53C642.47,-20710.64 594.12,-20695.19 544.08,-20676.09"/>
<polygon fill="black" stroke="black" points="545.3,-20672.81 534.72,-20672.48 542.79,-20679.34 545.3,-20672.81"/>
</g>
<!-- layer_1_mlp_fc1_gpu3 -->
<g id="node72" class="node">
<title>layer_1_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="646.5,-20676 552.5,-20676 552.5,-20624 646.5,-20624 646.5,-20676"/>
<text text-anchor="middle" x="599.5" y="-20664" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="599.5" y="-20653" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="599.5" y="-20642" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="599.5" y="-20631" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu3 -->
<g id="edge115" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M684.1,-20711.81C671.77,-20702.94 656.9,-20692.26 643.09,-20682.33"/>
<polygon fill="black" stroke="black" points="644.83,-20679.27 634.67,-20676.28 640.74,-20684.95 644.83,-20679.27"/>
</g>
<!-- layer_1_mlp_fc1_gpu4 -->
<g id="node73" class="node">
<title>layer_1_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="758.5,-20676 664.5,-20676 664.5,-20624 758.5,-20624 758.5,-20676"/>
<text text-anchor="middle" x="711.5" y="-20664" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="711.5" y="-20653" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="711.5" y="-20642" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="711.5" y="-20631" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu4 -->
<g id="edge116" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M711.5,-20711.6C711.5,-20703.99 711.5,-20695.06 711.5,-20686.43"/>
<polygon fill="black" stroke="black" points="715,-20686.15 711.5,-20676.15 708,-20686.15 715,-20686.15"/>
</g>
<!-- layer_1_mlp_fc1_gpu5 -->
<g id="node74" class="node">
<title>layer_1_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="870.5,-20676 776.5,-20676 776.5,-20624 870.5,-20624 870.5,-20676"/>
<text text-anchor="middle" x="823.5" y="-20664" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="823.5" y="-20653" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="823.5" y="-20642" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="823.5" y="-20631" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu5 -->
<g id="edge117" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M738.9,-20711.81C751.23,-20702.94 766.1,-20692.26 779.91,-20682.33"/>
<polygon fill="black" stroke="black" points="782.26,-20684.95 788.33,-20676.28 778.17,-20679.27 782.26,-20684.95"/>
</g>
<!-- layer_1_mlp_fc1_gpu6 -->
<g id="node75" class="node">
<title>layer_1_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="982.5,-20676 888.5,-20676 888.5,-20624 982.5,-20624 982.5,-20676"/>
<text text-anchor="middle" x="935.5" y="-20664" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="935.5" y="-20653" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="935.5" y="-20642" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="935.5" y="-20631" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu6 -->
<g id="edge118" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M748.25,-20720.53C780.53,-20710.64 828.88,-20695.19 878.92,-20676.09"/>
<polygon fill="black" stroke="black" points="880.21,-20679.34 888.28,-20672.48 877.7,-20672.81 880.21,-20679.34"/>
</g>
<!-- layer_1_mlp_fc1_gpu7 -->
<g id="node76" class="node">
<title>layer_1_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1094.5,-20676 1000.5,-20676 1000.5,-20624 1094.5,-20624 1094.5,-20676"/>
<text text-anchor="middle" x="1047.5" y="-20664" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="1047.5" y="-20653" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1047.5" y="-20642" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1047.5" y="-20631" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu7 -->
<g id="edge119" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M748.4,-20726.87C800.74,-20719.74 899.45,-20704.14 990.77,-20675.94"/>
<polygon fill="black" stroke="black" points="991.95,-20679.24 1000.43,-20672.9 989.84,-20672.57 991.95,-20679.24"/>
</g>
<!-- layer_1_allgather_mlp -->
<g id="node77" class="node">
<title>layer_1_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="655.5" cy="-20559.01" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="655.5" y="-20567.51" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="655.5" y="-20556.51" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="655.5" y="-20545.51" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_1_mlp_fc1_gpu0&#45;&gt;layer_1_allgather_mlp -->
<g id="edge120" class="edge">
<title>layer_1_mlp_fc1_gpu0&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M310.56,-20627.07C313.56,-20625.96 316.55,-20624.92 319.5,-20624 411.52,-20595.13 522.02,-20577.13 590.51,-20567.84"/>
<polygon fill="black" stroke="black" points="591.27,-20571.27 600.72,-20566.47 590.34,-20564.33 591.27,-20571.27"/>
</g>
<!-- layer_1_mlp_fc1_gpu1&#45;&gt;layer_1_allgather_mlp -->
<g id="edge121" class="edge">
<title>layer_1_mlp_fc1_gpu1&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M422.66,-20627.38C425.64,-20626.19 428.6,-20625.06 431.5,-20624 486.03,-20604.15 549.79,-20586.45 595.32,-20574.73"/>
<polygon fill="black" stroke="black" points="596.21,-20578.11 605.03,-20572.24 594.47,-20571.33 596.21,-20578.11"/>
</g>
<!-- layer_1_mlp_fc1_gpu2&#45;&gt;layer_1_allgather_mlp -->
<g id="edge122" class="edge">
<title>layer_1_mlp_fc1_gpu2&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M534.74,-20623.97C557.71,-20611.81 585.23,-20597.23 608.2,-20585.06"/>
<polygon fill="black" stroke="black" points="609.89,-20588.13 617.09,-20580.36 606.61,-20581.95 609.89,-20588.13"/>
</g>
<!-- layer_1_mlp_fc1_gpu3&#45;&gt;layer_1_allgather_mlp -->
<g id="edge123" class="edge">
<title>layer_1_mlp_fc1_gpu3&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M615.4,-20623.74C620.94,-20614.92 627.27,-20604.86 633.24,-20595.38"/>
<polygon fill="black" stroke="black" points="636.22,-20597.22 638.58,-20586.89 630.3,-20593.49 636.22,-20597.22"/>
</g>
<!-- layer_1_mlp_fc1_gpu4&#45;&gt;layer_1_allgather_mlp -->
<g id="edge124" class="edge">
<title>layer_1_mlp_fc1_gpu4&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M695.6,-20623.74C690.06,-20614.92 683.73,-20604.86 677.76,-20595.38"/>
<polygon fill="black" stroke="black" points="680.7,-20593.49 672.42,-20586.89 674.78,-20597.22 680.7,-20593.49"/>
</g>
<!-- layer_1_mlp_fc1_gpu5&#45;&gt;layer_1_allgather_mlp -->
<g id="edge125" class="edge">
<title>layer_1_mlp_fc1_gpu5&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M776.26,-20623.97C753.29,-20611.81 725.77,-20597.23 702.8,-20585.06"/>
<polygon fill="black" stroke="black" points="704.39,-20581.95 693.91,-20580.36 701.11,-20588.13 704.39,-20581.95"/>
</g>
<!-- layer_1_mlp_fc1_gpu6&#45;&gt;layer_1_allgather_mlp -->
<g id="edge126" class="edge">
<title>layer_1_mlp_fc1_gpu6&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M888.34,-20627.38C885.36,-20626.19 882.4,-20625.06 879.5,-20624 824.97,-20604.15 761.21,-20586.45 715.68,-20574.73"/>
<polygon fill="black" stroke="black" points="716.53,-20571.33 705.97,-20572.24 714.79,-20578.11 716.53,-20571.33"/>
</g>
<!-- layer_1_mlp_fc1_gpu7&#45;&gt;layer_1_allgather_mlp -->
<g id="edge127" class="edge">
<title>layer_1_mlp_fc1_gpu7&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M1000.44,-20627.07C997.44,-20625.96 994.45,-20624.92 991.5,-20624 899.48,-20595.13 788.98,-20577.13 720.49,-20567.84"/>
<polygon fill="black" stroke="black" points="720.66,-20564.33 710.28,-20566.47 719.73,-20571.27 720.66,-20564.33"/>
</g>
<!-- layer_1_gelu -->
<g id="node78" class="node">
<title>layer_1_gelu</title>
<polygon fill="lightblue" stroke="black" points="700,-20494.02 611,-20494.02 611,-20458.02 700,-20458.02 700,-20494.02"/>
<text text-anchor="middle" x="655.5" y="-20479.02" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="655.5" y="-20468.02" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_1_allgather_mlp&#45;&gt;layer_1_gelu -->
<g id="edge128" class="edge">
<title>layer_1_allgather_mlp&#45;&gt;layer_1_gelu</title>
<path fill="none" stroke="black" d="M655.5,-20529.68C655.5,-20521.44 655.5,-20512.45 655.5,-20504.27"/>
<polygon fill="black" stroke="black" points="659,-20504.11 655.5,-20494.11 652,-20504.11 659,-20504.11"/>
</g>
<!-- layer_1_mlp_fc2_gpu0 -->
<g id="node79" class="node">
<title>layer_1_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="310.5,-20422.02 216.5,-20422.02 216.5,-20370.02 310.5,-20370.02 310.5,-20422.02"/>
<text text-anchor="middle" x="263.5" y="-20410.02" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="263.5" y="-20399.02" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="263.5" y="-20388.02" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="263.5" y="-20377.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu0 -->
<g id="edge129" class="edge">
<title>layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu0</title>
<path fill="none" stroke="black" d="M610.92,-20471.74C547.69,-20466.28 428.52,-20452.99 320.29,-20421.92"/>
<polygon fill="black" stroke="black" points="321.1,-20418.51 310.52,-20419.06 319.14,-20425.23 321.1,-20418.51"/>
</g>
<!-- layer_1_mlp_fc2_gpu1 -->
<g id="node80" class="node">
<title>layer_1_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="422.5,-20422.02 328.5,-20422.02 328.5,-20370.02 422.5,-20370.02 422.5,-20422.02"/>
<text text-anchor="middle" x="375.5" y="-20410.02" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="375.5" y="-20399.02" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="375.5" y="-20388.02" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="375.5" y="-20377.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu1 -->
<g id="edge130" class="edge">
<title>layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu1</title>
<path fill="none" stroke="black" d="M610.61,-20466.97C567.02,-20458.59 499.01,-20444.01 432.42,-20422.08"/>
<polygon fill="black" stroke="black" points="433.2,-20418.65 422.61,-20418.79 430.98,-20425.29 433.2,-20418.65"/>
</g>
<!-- layer_1_mlp_fc2_gpu2 -->
<g id="node81" class="node">
<title>layer_1_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="534.5,-20422.02 440.5,-20422.02 440.5,-20370.02 534.5,-20370.02 534.5,-20422.02"/>
<text text-anchor="middle" x="487.5" y="-20410.02" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="487.5" y="-20399.02" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="487.5" y="-20388.02" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="487.5" y="-20377.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu2 -->
<g id="edge131" class="edge">
<title>layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu2</title>
<path fill="none" stroke="black" d="M618.63,-20457.9C596.71,-20447.72 568.45,-20434.6 543.78,-20423.15"/>
<polygon fill="black" stroke="black" points="545.06,-20419.88 534.52,-20418.85 542.12,-20426.23 545.06,-20419.88"/>
</g>
<!-- layer_1_mlp_fc2_gpu3 -->
<g id="node82" class="node">
<title>layer_1_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="646.5,-20422.02 552.5,-20422.02 552.5,-20370.02 646.5,-20370.02 646.5,-20422.02"/>
<text text-anchor="middle" x="599.5" y="-20410.02" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="599.5" y="-20399.02" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="599.5" y="-20388.02" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="599.5" y="-20377.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu3 -->
<g id="edge132" class="edge">
<title>layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu3</title>
<path fill="none" stroke="black" d="M643.07,-20457.71C637.35,-20449.73 630.35,-20439.99 623.65,-20430.66"/>
<polygon fill="black" stroke="black" points="626.31,-20428.36 617.63,-20422.27 620.62,-20432.44 626.31,-20428.36"/>
</g>
<!-- layer_1_mlp_fc2_gpu4 -->
<g id="node83" class="node">
<title>layer_1_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="758.5,-20422.02 664.5,-20422.02 664.5,-20370.02 758.5,-20370.02 758.5,-20422.02"/>
<text text-anchor="middle" x="711.5" y="-20410.02" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="711.5" y="-20399.02" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="711.5" y="-20388.02" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="711.5" y="-20377.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu4 -->
<g id="edge133" class="edge">
<title>layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu4</title>
<path fill="none" stroke="black" d="M667.93,-20457.71C673.65,-20449.73 680.65,-20439.99 687.35,-20430.66"/>
<polygon fill="black" stroke="black" points="690.38,-20432.44 693.37,-20422.27 684.69,-20428.36 690.38,-20432.44"/>
</g>
<!-- layer_1_mlp_fc2_gpu5 -->
<g id="node84" class="node">
<title>layer_1_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="870.5,-20422.02 776.5,-20422.02 776.5,-20370.02 870.5,-20370.02 870.5,-20422.02"/>
<text text-anchor="middle" x="823.5" y="-20410.02" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="823.5" y="-20399.02" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="823.5" y="-20388.02" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="823.5" y="-20377.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu5 -->
<g id="edge134" class="edge">
<title>layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu5</title>
<path fill="none" stroke="black" d="M692.37,-20457.9C714.29,-20447.72 742.55,-20434.6 767.22,-20423.15"/>
<polygon fill="black" stroke="black" points="768.88,-20426.23 776.48,-20418.85 765.94,-20419.88 768.88,-20426.23"/>
</g>
<!-- layer_1_mlp_fc2_gpu6 -->
<g id="node85" class="node">
<title>layer_1_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="982.5,-20422.02 888.5,-20422.02 888.5,-20370.02 982.5,-20370.02 982.5,-20422.02"/>
<text text-anchor="middle" x="935.5" y="-20410.02" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="935.5" y="-20399.02" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="935.5" y="-20388.02" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="935.5" y="-20377.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu6 -->
<g id="edge135" class="edge">
<title>layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu6</title>
<path fill="none" stroke="black" d="M700.39,-20466.97C743.98,-20458.59 811.99,-20444.01 878.58,-20422.08"/>
<polygon fill="black" stroke="black" points="880.02,-20425.29 888.39,-20418.79 877.8,-20418.65 880.02,-20425.29"/>
</g>
<!-- layer_1_mlp_fc2_gpu7 -->
<g id="node86" class="node">
<title>layer_1_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1094.5,-20422.02 1000.5,-20422.02 1000.5,-20370.02 1094.5,-20370.02 1094.5,-20422.02"/>
<text text-anchor="middle" x="1047.5" y="-20410.02" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="1047.5" y="-20399.02" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1047.5" y="-20388.02" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1047.5" y="-20377.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu7 -->
<g id="edge136" class="edge">
<title>layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu7</title>
<path fill="none" stroke="black" d="M700.08,-20471.74C763.31,-20466.28 882.48,-20452.99 990.71,-20421.92"/>
<polygon fill="black" stroke="black" points="991.86,-20425.23 1000.48,-20419.06 989.9,-20418.51 991.86,-20425.23"/>
</g>
<!-- layer_1_allreduce_mlp -->
<g id="node87" class="node">
<title>layer_1_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="711.5" cy="-20305.03" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="711.5" y="-20313.53" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="711.5" y="-20302.53" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="711.5" y="-20291.53" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_1_mlp_fc2_gpu0&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge137" class="edge">
<title>layer_1_mlp_fc2_gpu0&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M310.53,-20373C313.54,-20371.91 316.54,-20370.9 319.5,-20370.02 429.66,-20337.04 562.65,-20319.87 641.97,-20311.91"/>
<polygon fill="black" stroke="black" points="642.71,-20315.35 652.32,-20310.89 642.03,-20308.39 642.71,-20315.35"/>
</g>
<!-- layer_1_mlp_fc2_gpu1&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge138" class="edge">
<title>layer_1_mlp_fc2_gpu1&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M422.6,-20373.21C425.59,-20372.07 428.57,-20371 431.5,-20370.02 503.11,-20346.1 587.96,-20328.09 645.34,-20317.37"/>
<polygon fill="black" stroke="black" points="646.17,-20320.77 655.37,-20315.51 644.9,-20313.89 646.17,-20320.77"/>
</g>
<!-- layer_1_mlp_fc2_gpu2&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge139" class="edge">
<title>layer_1_mlp_fc2_gpu2&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M534.78,-20373.69C537.72,-20372.43 540.65,-20371.2 543.5,-20370.02 580.39,-20354.77 622.34,-20338.79 655.1,-20326.61"/>
<polygon fill="black" stroke="black" points="656.35,-20329.88 664.51,-20323.12 653.92,-20323.32 656.35,-20329.88"/>
</g>
<!-- layer_1_mlp_fc2_gpu3&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge140" class="edge">
<title>layer_1_mlp_fc2_gpu3&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M631,-20369.99C644.09,-20359.59 659.4,-20347.42 673.14,-20336.51"/>
<polygon fill="black" stroke="black" points="675.36,-20339.21 681.01,-20330.25 671.01,-20333.73 675.36,-20339.21"/>
</g>
<!-- layer_1_mlp_fc2_gpu4&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge141" class="edge">
<title>layer_1_mlp_fc2_gpu4&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M711.5,-20369.75C711.5,-20361.86 711.5,-20352.97 711.5,-20344.39"/>
<polygon fill="black" stroke="black" points="715,-20344.17 711.5,-20334.17 708,-20344.17 715,-20344.17"/>
</g>
<!-- layer_1_mlp_fc2_gpu5&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge142" class="edge">
<title>layer_1_mlp_fc2_gpu5&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M792,-20369.99C778.91,-20359.59 763.6,-20347.42 749.86,-20336.51"/>
<polygon fill="black" stroke="black" points="751.99,-20333.73 741.99,-20330.25 747.64,-20339.21 751.99,-20333.73"/>
</g>
<!-- layer_1_mlp_fc2_gpu6&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge143" class="edge">
<title>layer_1_mlp_fc2_gpu6&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M888.22,-20373.69C885.28,-20372.43 882.35,-20371.2 879.5,-20370.02 842.61,-20354.77 800.66,-20338.79 767.9,-20326.61"/>
<polygon fill="black" stroke="black" points="769.08,-20323.32 758.49,-20323.12 766.65,-20329.88 769.08,-20323.32"/>
</g>
<!-- layer_1_mlp_fc2_gpu7&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge144" class="edge">
<title>layer_1_mlp_fc2_gpu7&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1000.4,-20373.21C997.41,-20372.07 994.43,-20371 991.5,-20370.02 919.89,-20346.1 835.04,-20328.09 777.66,-20317.37"/>
<polygon fill="black" stroke="black" points="778.1,-20313.89 767.63,-20315.51 776.83,-20320.77 778.1,-20313.89"/>
</g>
<!-- layer_1_allreduce_mlp&#45;&gt;layer_1_residual2 -->
<g id="edge145" class="edge">
<title>layer_1_allreduce_mlp&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M754.47,-20284.53C784.5,-20270.91 824.96,-20252.56 857.93,-20237.6"/>
<polygon fill="black" stroke="black" points="859.8,-20240.6 867.46,-20233.28 856.91,-20234.22 859.8,-20240.6"/>
</g>
<!-- layer_1_ln2 -->
<g id="node89" class="node">
<title>layer_1_ln2</title>
<polygon fill="lightblue" stroke="black" points="953,-20144.03 880,-20144.03 880,-20103.03 953,-20103.03 953,-20144.03"/>
<text text-anchor="middle" x="916.5" y="-20132.03" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="916.5" y="-20121.03" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="916.5" y="-20110.03" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_1_residual2&#45;&gt;layer_1_ln2 -->
<g id="edge147" class="edge">
<title>layer_1_residual2&#45;&gt;layer_1_ln2</title>
<path fill="none" stroke="black" d="M916.5,-20179.95C916.5,-20171.63 916.5,-20162.55 916.5,-20154.19"/>
<polygon fill="black" stroke="black" points="920,-20154.1 916.5,-20144.1 913,-20154.1 920,-20154.1"/>
</g>
<!-- layer_1_output_dist -->
<g id="node90" class="node">
<title>layer_1_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="1018.2,-20067.03 856.42,-20067.03 814.8,-20007.03 976.58,-20007.03 1018.2,-20067.03"/>
<text text-anchor="middle" x="916.5" y="-20040.03" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="916.5" y="-20029.03" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_1_ln2&#45;&gt;layer_1_output_dist -->
<g id="edge148" class="edge">
<title>layer_1_ln2&#45;&gt;layer_1_output_dist</title>
<path fill="none" stroke="black" d="M916.5,-20102.94C916.5,-20095.3 916.5,-20086.25 916.5,-20077.38"/>
<polygon fill="black" stroke="black" points="920,-20077.14 916.5,-20067.14 913,-20077.14 920,-20077.14"/>
</g>
<!-- layer_2_input_dist -->
<g id="node91" class="node">
<title>layer_2_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="1010.69,-19971.03 860.86,-19971.03 822.31,-19911.03 972.14,-19911.03 1010.69,-19971.03"/>
<text text-anchor="middle" x="916.5" y="-19944.03" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="916.5" y="-19933.03" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_1_output_dist&#45;&gt;layer_2_input_dist -->
<g id="edge149" class="edge">
<title>layer_1_output_dist&#45;&gt;layer_2_input_dist</title>
<path fill="none" stroke="black" d="M916.5,-20006.81C916.5,-19998.76 916.5,-19989.9 916.5,-19981.38"/>
<polygon fill="black" stroke="black" points="920,-19981.24 916.5,-19971.24 913,-19981.24 920,-19981.24"/>
</g>
<!-- layer_2_qkv_gpu0 -->
<g id="node92" class="node">
<title>layer_2_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="519,-19875.03 426,-19875.03 426,-19823.03 519,-19823.03 519,-19875.03"/>
<text text-anchor="middle" x="472.5" y="-19863.03" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="472.5" y="-19852.03" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="472.5" y="-19841.03" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="472.5" y="-19830.03" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu0 -->
<g id="edge150" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu0</title>
<path fill="none" stroke="black" d="M836,-19932.58C758.82,-19924.07 639.31,-19907.33 528.86,-19874.81"/>
<polygon fill="black" stroke="black" points="529.81,-19871.44 519.22,-19871.93 527.8,-19878.15 529.81,-19871.44"/>
</g>
<!-- layer_2_qkv_gpu1 -->
<g id="node93" class="node">
<title>layer_2_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="630,-19875.03 537,-19875.03 537,-19823.03 630,-19823.03 630,-19875.03"/>
<text text-anchor="middle" x="583.5" y="-19863.03" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="583.5" y="-19852.03" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="583.5" y="-19841.03" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="583.5" y="-19830.03" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu1 -->
<g id="edge151" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu1</title>
<path fill="none" stroke="black" d="M830.78,-19924.29C777.93,-19913.57 708.87,-19897.72 640.01,-19874.96"/>
<polygon fill="black" stroke="black" points="640.89,-19871.56 630.3,-19871.7 638.66,-19878.2 640.89,-19871.56"/>
</g>
<!-- layer_2_qkv_gpu2 -->
<g id="node94" class="node">
<title>layer_2_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="741,-19875.03 648,-19875.03 648,-19823.03 741,-19823.03 741,-19875.03"/>
<text text-anchor="middle" x="694.5" y="-19863.03" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="694.5" y="-19852.03" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="694.5" y="-19841.03" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="694.5" y="-19830.03" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu2 -->
<g id="edge152" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu2</title>
<path fill="none" stroke="black" d="M840.17,-19911.01C811.89,-19900.02 779.62,-19887.23 750.5,-19875.03 750.4,-19874.99 750.31,-19874.95 750.21,-19874.91"/>
<polygon fill="black" stroke="black" points="751.75,-19871.77 741.18,-19871.07 749.01,-19878.21 751.75,-19871.77"/>
</g>
<!-- layer_2_qkv_gpu3 -->
<g id="node95" class="node">
<title>layer_2_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="852,-19875.03 759,-19875.03 759,-19823.03 852,-19823.03 852,-19875.03"/>
<text text-anchor="middle" x="805.5" y="-19863.03" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="805.5" y="-19852.03" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="805.5" y="-19841.03" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="805.5" y="-19830.03" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu3 -->
<g id="edge153" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu3</title>
<path fill="none" stroke="black" d="M880.46,-19910.81C868.94,-19901.47 856.14,-19891.09 844.42,-19881.59"/>
<polygon fill="black" stroke="black" points="846.48,-19878.76 836.51,-19875.18 842.08,-19884.2 846.48,-19878.76"/>
</g>
<!-- layer_2_qkv_gpu4 -->
<g id="node96" class="node">
<title>layer_2_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="963,-19875.03 870,-19875.03 870,-19823.03 963,-19823.03 963,-19875.03"/>
<text text-anchor="middle" x="916.5" y="-19863.03" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="916.5" y="-19852.03" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="916.5" y="-19841.03" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="916.5" y="-19830.03" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu4 -->
<g id="edge154" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu4</title>
<path fill="none" stroke="black" d="M916.5,-19910.56C916.5,-19902.49 916.5,-19893.66 916.5,-19885.29"/>
<polygon fill="black" stroke="black" points="920,-19885.04 916.5,-19875.04 913,-19885.04 920,-19885.04"/>
</g>
<!-- layer_2_qkv_gpu5 -->
<g id="node97" class="node">
<title>layer_2_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1074,-19875.03 981,-19875.03 981,-19823.03 1074,-19823.03 1074,-19875.03"/>
<text text-anchor="middle" x="1027.5" y="-19863.03" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="1027.5" y="-19852.03" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1027.5" y="-19841.03" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1027.5" y="-19830.03" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu5 -->
<g id="edge155" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu5</title>
<path fill="none" stroke="black" d="M952.54,-19910.81C964.06,-19901.47 976.86,-19891.09 988.58,-19881.59"/>
<polygon fill="black" stroke="black" points="990.92,-19884.2 996.49,-19875.18 986.52,-19878.76 990.92,-19884.2"/>
</g>
<!-- layer_2_qkv_gpu6 -->
<g id="node98" class="node">
<title>layer_2_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1185,-19875.03 1092,-19875.03 1092,-19823.03 1185,-19823.03 1185,-19875.03"/>
<text text-anchor="middle" x="1138.5" y="-19863.03" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="1138.5" y="-19852.03" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1138.5" y="-19841.03" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1138.5" y="-19830.03" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu6 -->
<g id="edge156" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu6</title>
<path fill="none" stroke="black" d="M976.73,-19917.52C1006.33,-19906.24 1042.68,-19892.06 1082.42,-19875.42"/>
<polygon fill="black" stroke="black" points="1083.91,-19878.59 1091.77,-19871.49 1081.2,-19872.14 1083.91,-19878.59"/>
</g>
<!-- layer_2_qkv_gpu7 -->
<g id="node99" class="node">
<title>layer_2_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1296,-19875.03 1203,-19875.03 1203,-19823.03 1296,-19823.03 1296,-19875.03"/>
<text text-anchor="middle" x="1249.5" y="-19863.03" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="1249.5" y="-19852.03" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1249.5" y="-19841.03" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1249.5" y="-19830.03" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu7 -->
<g id="edge157" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu7</title>
<path fill="none" stroke="black" d="M983.25,-19928.27C1037.88,-19917.76 1117.07,-19900.56 1193.2,-19875.24"/>
<polygon fill="black" stroke="black" points="1194.59,-19878.47 1202.95,-19871.95 1192.35,-19871.83 1194.59,-19878.47"/>
</g>
<!-- layer_2_residual1 -->
<g id="node111" class="node">
<title>layer_2_residual1</title>
<polygon fill="lightyellow" stroke="black" points="1206.44,-19423.07 1084.05,-19423.07 1052.56,-19363.07 1174.95,-19363.07 1206.44,-19423.07"/>
<text text-anchor="middle" x="1129.5" y="-19396.07" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="1129.5" y="-19385.07" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_residual1 -->
<g id="edge184" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M989.59,-19937.69C1089.77,-19932.88 1262.3,-19918.38 1305.5,-19875.03 1342.38,-19838.04 1324.5,-19811.28 1324.5,-19759.04 1324.5,-19759.04 1324.5,-19759.04 1324.5,-19578.05 1324.5,-19509.27 1259.52,-19458.59 1204.59,-19428.04"/>
<polygon fill="black" stroke="black" points="1205.98,-19424.81 1195.52,-19423.12 1202.64,-19430.96 1205.98,-19424.81"/>
</g>
<!-- layer_2_allgather_qkv -->
<g id="node100" class="node">
<title>layer_2_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="872.5" cy="-19758.04" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="872.5" y="-19766.54" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="872.5" y="-19755.54" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="872.5" y="-19744.54" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_2_qkv_gpu0&#45;&gt;layer_2_allgather_qkv -->
<g id="edge158" class="edge">
<title>layer_2_qkv_gpu0&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M519.24,-19826.2C522.35,-19825.05 525.45,-19823.98 528.5,-19823.03 623.17,-19793.55 736.96,-19775.65 807.01,-19766.55"/>
<polygon fill="black" stroke="black" points="807.54,-19770.01 817.02,-19765.27 806.65,-19763.07 807.54,-19770.01"/>
</g>
<!-- layer_2_qkv_gpu1&#45;&gt;layer_2_allgather_qkv -->
<g id="edge159" class="edge">
<title>layer_2_qkv_gpu1&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M630.03,-19826.62C633.22,-19825.36 636.39,-19824.15 639.5,-19823.03 696.65,-19802.56 763.64,-19784.79 811.08,-19773.2"/>
<polygon fill="black" stroke="black" points="812,-19776.58 820.9,-19770.83 810.36,-19769.78 812,-19776.58"/>
</g>
<!-- layer_2_qkv_gpu2&#45;&gt;layer_2_allgather_qkv -->
<g id="edge160" class="edge">
<title>layer_2_qkv_gpu2&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M741.27,-19824.65C766.59,-19811.99 797.84,-19796.37 823.5,-19783.54"/>
<polygon fill="black" stroke="black" points="825.3,-19786.55 832.68,-19778.95 822.17,-19780.29 825.3,-19786.55"/>
</g>
<!-- layer_2_qkv_gpu3&#45;&gt;layer_2_allgather_qkv -->
<g id="edge161" class="edge">
<title>layer_2_qkv_gpu3&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M824.52,-19822.77C831.41,-19813.62 839.32,-19803.12 846.69,-19793.32"/>
<polygon fill="black" stroke="black" points="849.51,-19795.39 852.73,-19785.3 843.92,-19791.18 849.51,-19795.39"/>
</g>
<!-- layer_2_qkv_gpu4&#45;&gt;layer_2_allgather_qkv -->
<g id="edge162" class="edge">
<title>layer_2_qkv_gpu4&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M904.01,-19822.77C899.78,-19814.22 894.97,-19804.48 890.4,-19795.25"/>
<polygon fill="black" stroke="black" points="893.52,-19793.65 885.95,-19786.24 887.24,-19796.75 893.52,-19793.65"/>
</g>
<!-- layer_2_qkv_gpu5&#45;&gt;layer_2_allgather_qkv -->
<g id="edge163" class="edge">
<title>layer_2_qkv_gpu5&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M983.91,-19823.01C963.48,-19811.28 939.12,-19797.29 918.4,-19785.4"/>
<polygon fill="black" stroke="black" points="919.88,-19782.21 909.47,-19780.27 916.4,-19788.28 919.88,-19782.21"/>
</g>
<!-- layer_2_qkv_gpu6&#45;&gt;layer_2_allgather_qkv -->
<g id="edge164" class="edge">
<title>layer_2_qkv_gpu6&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M1091.87,-19826.33C1089.05,-19825.18 1086.25,-19824.07 1083.5,-19823.03 1033.32,-19804.12 974.88,-19786.74 932.24,-19774.88"/>
<polygon fill="black" stroke="black" points="933.15,-19771.5 922.57,-19772.22 931.28,-19778.25 933.15,-19771.5"/>
</g>
<!-- layer_2_qkv_gpu7&#45;&gt;layer_2_allgather_qkv -->
<g id="edge165" class="edge">
<title>layer_2_qkv_gpu7&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M1202.98,-19826.01C1200.14,-19824.94 1197.3,-19823.93 1194.5,-19823.03 1107.72,-19795.1 1003.69,-19777.09 937.83,-19767.51"/>
<polygon fill="black" stroke="black" points="937.99,-19764 927.6,-19766.05 937,-19770.93 937.99,-19764"/>
</g>
<!-- layer_2_attention -->
<g id="node101" class="node">
<title>layer_2_attention</title>
<polygon fill="lightblue" stroke="black" points="906.5,-19693.05 838.5,-19693.05 838.5,-19641.05 906.5,-19641.05 906.5,-19693.05"/>
<text text-anchor="middle" x="872.5" y="-19681.05" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="872.5" y="-19670.05" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="872.5" y="-19659.05" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="872.5" y="-19648.05" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_2_allgather_qkv&#45;&gt;layer_2_attention -->
<g id="edge166" class="edge">
<title>layer_2_allgather_qkv&#45;&gt;layer_2_attention</title>
<path fill="none" stroke="black" d="M872.5,-19728.89C872.5,-19720.78 872.5,-19711.83 872.5,-19703.34"/>
<polygon fill="black" stroke="black" points="876,-19703.31 872.5,-19693.31 869,-19703.31 876,-19703.31"/>
</g>
<!-- layer_2_attn_out_gpu0 -->
<g id="node102" class="node">
<title>layer_2_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="554.5,-19605.05 466.5,-19605.05 466.5,-19553.05 554.5,-19553.05 554.5,-19605.05"/>
<text text-anchor="middle" x="510.5" y="-19593.05" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="510.5" y="-19582.05" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="510.5" y="-19571.05" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="510.5" y="-19560.05" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attention&#45;&gt;layer_2_attn_out_gpu0 -->
<g id="edge167" class="edge">
<title>layer_2_attention&#45;&gt;layer_2_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M838.43,-19662.11C782.48,-19655.05 667.85,-19638.08 564.37,-19605.02"/>
<polygon fill="black" stroke="black" points="565.3,-19601.64 554.71,-19601.87 563.13,-19608.3 565.3,-19601.64"/>
</g>
<!-- layer_2_attn_out_gpu1 -->
<g id="node103" class="node">
<title>layer_2_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="660.5,-19605.05 572.5,-19605.05 572.5,-19553.05 660.5,-19553.05 660.5,-19605.05"/>
<text text-anchor="middle" x="616.5" y="-19593.05" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="616.5" y="-19582.05" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="616.5" y="-19571.05" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="616.5" y="-19560.05" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attention&#45;&gt;layer_2_attn_out_gpu1 -->
<g id="edge168" class="edge">
<title>layer_2_attention&#45;&gt;layer_2_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M838.22,-19657.42C799.35,-19647.28 734.05,-19629.13 669.97,-19605.02"/>
<polygon fill="black" stroke="black" points="671.12,-19601.72 660.53,-19601.42 668.63,-19608.26 671.12,-19601.72"/>
</g>
<!-- layer_2_attn_out_gpu2 -->
<g id="node104" class="node">
<title>layer_2_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="766.5,-19605.05 678.5,-19605.05 678.5,-19553.05 766.5,-19553.05 766.5,-19605.05"/>
<text text-anchor="middle" x="722.5" y="-19593.05" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="722.5" y="-19582.05" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="722.5" y="-19571.05" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="722.5" y="-19560.05" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attention&#45;&gt;layer_2_attn_out_gpu2 -->
<g id="edge169" class="edge">
<title>layer_2_attention&#45;&gt;layer_2_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M838.46,-19646.54C819.78,-19635.83 796.21,-19622.31 775.2,-19610.27"/>
<polygon fill="black" stroke="black" points="776.8,-19607.15 766.38,-19605.21 773.31,-19613.22 776.8,-19607.15"/>
</g>
<!-- layer_2_attn_out_gpu3 -->
<g id="node105" class="node">
<title>layer_2_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="872.5,-19605.05 784.5,-19605.05 784.5,-19553.05 872.5,-19553.05 872.5,-19605.05"/>
<text text-anchor="middle" x="828.5" y="-19593.05" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="828.5" y="-19582.05" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="828.5" y="-19571.05" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="828.5" y="-19560.05" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attention&#45;&gt;layer_2_attn_out_gpu3 -->
<g id="edge170" class="edge">
<title>layer_2_attention&#45;&gt;layer_2_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M859.54,-19640.71C855.28,-19632.4 850.49,-19623.03 845.96,-19614.18"/>
<polygon fill="black" stroke="black" points="849.04,-19612.52 841.37,-19605.21 842.81,-19615.7 849.04,-19612.52"/>
</g>
<!-- layer_2_attn_out_gpu4 -->
<g id="node106" class="node">
<title>layer_2_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="978.5,-19605.05 890.5,-19605.05 890.5,-19553.05 978.5,-19553.05 978.5,-19605.05"/>
<text text-anchor="middle" x="934.5" y="-19593.05" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="934.5" y="-19582.05" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="934.5" y="-19571.05" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="934.5" y="-19560.05" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attention&#45;&gt;layer_2_attn_out_gpu4 -->
<g id="edge171" class="edge">
<title>layer_2_attention&#45;&gt;layer_2_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M890.77,-19640.71C896.95,-19632.14 903.95,-19622.43 910.5,-19613.34"/>
<polygon fill="black" stroke="black" points="913.35,-19615.37 916.36,-19605.21 907.68,-19611.27 913.35,-19615.37"/>
</g>
<!-- layer_2_attn_out_gpu5 -->
<g id="node107" class="node">
<title>layer_2_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1084.5,-19605.05 996.5,-19605.05 996.5,-19553.05 1084.5,-19553.05 1084.5,-19605.05"/>
<text text-anchor="middle" x="1040.5" y="-19593.05" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="1040.5" y="-19582.05" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1040.5" y="-19571.05" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1040.5" y="-19560.05" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attention&#45;&gt;layer_2_attn_out_gpu5 -->
<g id="edge172" class="edge">
<title>layer_2_attention&#45;&gt;layer_2_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M906.9,-19648.44C930,-19636.62 960.9,-19620.8 987.16,-19607.36"/>
<polygon fill="black" stroke="black" points="988.93,-19610.38 996.24,-19602.71 985.74,-19604.15 988.93,-19610.38"/>
</g>
<!-- layer_2_attn_out_gpu6 -->
<g id="node108" class="node">
<title>layer_2_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1190.5,-19605.05 1102.5,-19605.05 1102.5,-19553.05 1190.5,-19553.05 1190.5,-19605.05"/>
<text text-anchor="middle" x="1146.5" y="-19593.05" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="1146.5" y="-19582.05" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1146.5" y="-19571.05" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1146.5" y="-19560.05" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attention&#45;&gt;layer_2_attn_out_gpu6 -->
<g id="edge173" class="edge">
<title>layer_2_attention&#45;&gt;layer_2_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M906.77,-19658.52C948.82,-19648.86 1022.28,-19630.64 1092.99,-19605"/>
<polygon fill="black" stroke="black" points="1094.32,-19608.24 1102.5,-19601.5 1091.9,-19601.67 1094.32,-19608.24"/>
</g>
<!-- layer_2_attn_out_gpu7 -->
<g id="node109" class="node">
<title>layer_2_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1296.5,-19605.05 1208.5,-19605.05 1208.5,-19553.05 1296.5,-19553.05 1296.5,-19605.05"/>
<text text-anchor="middle" x="1252.5" y="-19593.05" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="1252.5" y="-19582.05" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1252.5" y="-19571.05" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1252.5" y="-19560.05" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attention&#45;&gt;layer_2_attn_out_gpu7 -->
<g id="edge174" class="edge">
<title>layer_2_attention&#45;&gt;layer_2_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M906.63,-19662.6C965.2,-19656.06 1088.4,-19639.59 1198.69,-19604.98"/>
<polygon fill="black" stroke="black" points="1199.84,-19608.29 1208.3,-19601.91 1197.71,-19601.62 1199.84,-19608.29"/>
</g>
<!-- layer_2_allreduce_attn -->
<g id="node110" class="node">
<title>layer_2_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="934.5" cy="-19488.06" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="934.5" y="-19496.56" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="934.5" y="-19485.56" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="934.5" y="-19474.56" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_2_attn_out_gpu0&#45;&gt;layer_2_allreduce_attn -->
<g id="edge175" class="edge">
<title>layer_2_attn_out_gpu0&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M554.68,-19556.15C557.63,-19555.02 560.59,-19553.97 563.5,-19553.05 666.93,-19520.4 792.16,-19503.19 867.47,-19495.12"/>
<polygon fill="black" stroke="black" points="868.17,-19498.57 877.75,-19494.05 867.44,-19491.61 868.17,-19498.57"/>
</g>
<!-- layer_2_attn_out_gpu1&#45;&gt;layer_2_allreduce_attn -->
<g id="edge176" class="edge">
<title>layer_2_attn_out_gpu1&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M660.76,-19556.37C663.69,-19555.19 666.62,-19554.07 669.5,-19553.05 736.63,-19529.39 816.34,-19511.45 870.69,-19500.67"/>
<polygon fill="black" stroke="black" points="871.39,-19504.1 880.53,-19498.74 870.04,-19497.23 871.39,-19504.1"/>
</g>
<!-- layer_2_attn_out_gpu2&#45;&gt;layer_2_allreduce_attn -->
<g id="edge177" class="edge">
<title>layer_2_attn_out_gpu2&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M766.66,-19556.99C769.64,-19555.64 772.61,-19554.31 775.5,-19553.05 809.83,-19538.06 848.84,-19522.34 879.63,-19510.23"/>
<polygon fill="black" stroke="black" points="881.29,-19513.34 889.32,-19506.44 878.73,-19506.83 881.29,-19513.34"/>
</g>
<!-- layer_2_attn_out_gpu3&#45;&gt;layer_2_allreduce_attn -->
<g id="edge178" class="edge">
<title>layer_2_attn_out_gpu3&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M858.31,-19553.03C870.58,-19542.72 884.92,-19530.69 897.83,-19519.85"/>
<polygon fill="black" stroke="black" points="900.24,-19522.4 905.65,-19513.28 895.74,-19517.03 900.24,-19522.4"/>
</g>
<!-- layer_2_attn_out_gpu4&#45;&gt;layer_2_allreduce_attn -->
<g id="edge179" class="edge">
<title>layer_2_attn_out_gpu4&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M934.5,-19552.79C934.5,-19544.9 934.5,-19536.01 934.5,-19527.43"/>
<polygon fill="black" stroke="black" points="938,-19527.2 934.5,-19517.2 931,-19527.2 938,-19527.2"/>
</g>
<!-- layer_2_attn_out_gpu5&#45;&gt;layer_2_allreduce_attn -->
<g id="edge180" class="edge">
<title>layer_2_attn_out_gpu5&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M1010.69,-19553.03C998.42,-19542.72 984.08,-19530.69 971.17,-19519.85"/>
<polygon fill="black" stroke="black" points="973.26,-19517.03 963.35,-19513.28 968.76,-19522.4 973.26,-19517.03"/>
</g>
<!-- layer_2_attn_out_gpu6&#45;&gt;layer_2_allreduce_attn -->
<g id="edge181" class="edge">
<title>layer_2_attn_out_gpu6&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M1102.34,-19556.99C1099.36,-19555.64 1096.39,-19554.31 1093.5,-19553.05 1059.17,-19538.06 1020.16,-19522.34 989.37,-19510.23"/>
<polygon fill="black" stroke="black" points="990.27,-19506.83 979.68,-19506.44 987.71,-19513.34 990.27,-19506.83"/>
</g>
<!-- layer_2_attn_out_gpu7&#45;&gt;layer_2_allreduce_attn -->
<g id="edge182" class="edge">
<title>layer_2_attn_out_gpu7&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M1208.24,-19556.37C1205.31,-19555.19 1202.38,-19554.07 1199.5,-19553.05 1132.37,-19529.39 1052.66,-19511.45 998.31,-19500.67"/>
<polygon fill="black" stroke="black" points="998.96,-19497.23 988.47,-19498.74 997.61,-19504.1 998.96,-19497.23"/>
</g>
<!-- layer_2_allreduce_attn&#45;&gt;layer_2_residual1 -->
<g id="edge183" class="edge">
<title>layer_2_allreduce_attn&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M975.85,-19467.34C1003.62,-19454.1 1040.59,-19436.47 1071.31,-19421.82"/>
<polygon fill="black" stroke="black" points="1073.1,-19424.84 1080.62,-19417.38 1070.09,-19418.52 1073.1,-19424.84"/>
</g>
<!-- layer_2_ln1 -->
<g id="node112" class="node">
<title>layer_2_ln1</title>
<polygon fill="lightblue" stroke="black" points="961,-19327.07 888,-19327.07 888,-19286.07 961,-19286.07 961,-19327.07"/>
<text text-anchor="middle" x="924.5" y="-19315.07" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="924.5" y="-19304.07" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="924.5" y="-19293.07" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_2_residual1&#45;&gt;layer_2_ln1 -->
<g id="edge185" class="edge">
<title>layer_2_residual1&#45;&gt;layer_2_ln1</title>
<path fill="none" stroke="black" d="M1058.95,-19362.99C1029.66,-19350.91 996.49,-19337.24 970.43,-19326.5"/>
<polygon fill="black" stroke="black" points="971.75,-19323.26 961.17,-19322.68 969.08,-19329.73 971.75,-19323.26"/>
</g>
<!-- layer_2_residual2 -->
<g id="node132" class="node">
<title>layer_2_residual2</title>
<polygon fill="lightyellow" stroke="black" points="1206.44,-18814.1 1084.05,-18814.1 1052.56,-18754.1 1174.95,-18754.1 1206.44,-18814.1"/>
<text text-anchor="middle" x="1129.5" y="-18787.1" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="1129.5" y="-18776.1" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_2_residual1&#45;&gt;layer_2_residual2 -->
<g id="edge220" class="edge">
<title>layer_2_residual1&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M1181.48,-19375.51C1242.51,-19352.42 1335.5,-19304.26 1335.5,-19225.07 1335.5,-19225.07 1335.5,-19225.07 1335.5,-18969.09 1335.5,-18898.88 1268.11,-18848.8 1210.42,-18818.78"/>
<polygon fill="black" stroke="black" points="1211.76,-18815.54 1201.26,-18814.14 1208.6,-18821.78 1211.76,-18815.54"/>
</g>
<!-- layer_2_mlp_fc1_gpu0 -->
<g id="node113" class="node">
<title>layer_2_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="523.5,-19250.07 429.5,-19250.07 429.5,-19198.07 523.5,-19198.07 523.5,-19250.07"/>
<text text-anchor="middle" x="476.5" y="-19238.07" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="476.5" y="-19227.07" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="476.5" y="-19216.07" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="476.5" y="-19205.07" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu0 -->
<g id="edge186" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M887.85,-19303.79C819.28,-19299.74 667.17,-19287.32 533.13,-19249.9"/>
<polygon fill="black" stroke="black" points="534.08,-19246.54 523.51,-19247.16 532.17,-19253.27 534.08,-19246.54"/>
</g>
<!-- layer_2_mlp_fc1_gpu1 -->
<g id="node114" class="node">
<title>layer_2_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="635.5,-19250.07 541.5,-19250.07 541.5,-19198.07 635.5,-19198.07 635.5,-19250.07"/>
<text text-anchor="middle" x="588.5" y="-19238.07" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="588.5" y="-19227.07" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="588.5" y="-19216.07" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="588.5" y="-19205.07" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu1 -->
<g id="edge187" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M887.6,-19300.94C835.26,-19293.8 736.55,-19278.21 645.23,-19250.01"/>
<polygon fill="black" stroke="black" points="646.16,-19246.64 635.57,-19246.97 644.05,-19253.31 646.16,-19246.64"/>
</g>
<!-- layer_2_mlp_fc1_gpu2 -->
<g id="node115" class="node">
<title>layer_2_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="747.5,-19250.07 653.5,-19250.07 653.5,-19198.07 747.5,-19198.07 747.5,-19250.07"/>
<text text-anchor="middle" x="700.5" y="-19238.07" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="700.5" y="-19227.07" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="700.5" y="-19216.07" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="700.5" y="-19205.07" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu2 -->
<g id="edge188" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M887.75,-19294.6C855.47,-19284.71 807.12,-19269.26 757.08,-19250.16"/>
<polygon fill="black" stroke="black" points="758.3,-19246.88 747.72,-19246.55 755.79,-19253.41 758.3,-19246.88"/>
</g>
<!-- layer_2_mlp_fc1_gpu3 -->
<g id="node116" class="node">
<title>layer_2_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="859.5,-19250.07 765.5,-19250.07 765.5,-19198.07 859.5,-19198.07 859.5,-19250.07"/>
<text text-anchor="middle" x="812.5" y="-19238.07" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="812.5" y="-19227.07" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="812.5" y="-19216.07" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="812.5" y="-19205.07" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu3 -->
<g id="edge189" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M897.1,-19285.88C884.77,-19277.01 869.9,-19266.33 856.09,-19256.4"/>
<polygon fill="black" stroke="black" points="857.83,-19253.34 847.67,-19250.35 853.74,-19259.02 857.83,-19253.34"/>
</g>
<!-- layer_2_mlp_fc1_gpu4 -->
<g id="node117" class="node">
<title>layer_2_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="971.5,-19250.07 877.5,-19250.07 877.5,-19198.07 971.5,-19198.07 971.5,-19250.07"/>
<text text-anchor="middle" x="924.5" y="-19238.07" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="924.5" y="-19227.07" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="924.5" y="-19216.07" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="924.5" y="-19205.07" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu4 -->
<g id="edge190" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M924.5,-19285.67C924.5,-19278.06 924.5,-19269.13 924.5,-19260.49"/>
<polygon fill="black" stroke="black" points="928,-19260.22 924.5,-19250.22 921,-19260.22 928,-19260.22"/>
</g>
<!-- layer_2_mlp_fc1_gpu5 -->
<g id="node118" class="node">
<title>layer_2_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1083.5,-19250.07 989.5,-19250.07 989.5,-19198.07 1083.5,-19198.07 1083.5,-19250.07"/>
<text text-anchor="middle" x="1036.5" y="-19238.07" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="1036.5" y="-19227.07" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1036.5" y="-19216.07" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1036.5" y="-19205.07" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu5 -->
<g id="edge191" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M951.9,-19285.88C964.23,-19277.01 979.1,-19266.33 992.91,-19256.4"/>
<polygon fill="black" stroke="black" points="995.26,-19259.02 1001.33,-19250.35 991.17,-19253.34 995.26,-19259.02"/>
</g>
<!-- layer_2_mlp_fc1_gpu6 -->
<g id="node119" class="node">
<title>layer_2_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1195.5,-19250.07 1101.5,-19250.07 1101.5,-19198.07 1195.5,-19198.07 1195.5,-19250.07"/>
<text text-anchor="middle" x="1148.5" y="-19238.07" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="1148.5" y="-19227.07" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1148.5" y="-19216.07" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1148.5" y="-19205.07" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu6 -->
<g id="edge192" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M961.25,-19294.6C993.53,-19284.71 1041.88,-19269.26 1091.92,-19250.16"/>
<polygon fill="black" stroke="black" points="1093.21,-19253.41 1101.28,-19246.55 1090.7,-19246.88 1093.21,-19253.41"/>
</g>
<!-- layer_2_mlp_fc1_gpu7 -->
<g id="node120" class="node">
<title>layer_2_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1307.5,-19250.07 1213.5,-19250.07 1213.5,-19198.07 1307.5,-19198.07 1307.5,-19250.07"/>
<text text-anchor="middle" x="1260.5" y="-19238.07" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="1260.5" y="-19227.07" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1260.5" y="-19216.07" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1260.5" y="-19205.07" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu7 -->
<g id="edge193" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M961.4,-19300.94C1013.74,-19293.8 1112.45,-19278.21 1203.77,-19250.01"/>
<polygon fill="black" stroke="black" points="1204.95,-19253.31 1213.43,-19246.97 1202.84,-19246.64 1204.95,-19253.31"/>
</g>
<!-- layer_2_allgather_mlp -->
<g id="node121" class="node">
<title>layer_2_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="868.5" cy="-19133.08" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="868.5" y="-19141.58" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="868.5" y="-19130.58" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="868.5" y="-19119.58" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_2_mlp_fc1_gpu0&#45;&gt;layer_2_allgather_mlp -->
<g id="edge194" class="edge">
<title>layer_2_mlp_fc1_gpu0&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M523.56,-19201.14C526.56,-19200.03 529.55,-19198.99 532.5,-19198.07 624.52,-19169.2 735.02,-19151.2 803.51,-19141.9"/>
<polygon fill="black" stroke="black" points="804.27,-19145.33 813.72,-19140.54 803.34,-19138.4 804.27,-19145.33"/>
</g>
<!-- layer_2_mlp_fc1_gpu1&#45;&gt;layer_2_allgather_mlp -->
<g id="edge195" class="edge">
<title>layer_2_mlp_fc1_gpu1&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M635.66,-19201.45C638.64,-19200.26 641.6,-19199.12 644.5,-19198.07 699.03,-19178.22 762.79,-19160.52 808.32,-19148.8"/>
<polygon fill="black" stroke="black" points="809.21,-19152.18 818.03,-19146.31 807.47,-19145.4 809.21,-19152.18"/>
</g>
<!-- layer_2_mlp_fc1_gpu2&#45;&gt;layer_2_allgather_mlp -->
<g id="edge196" class="edge">
<title>layer_2_mlp_fc1_gpu2&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M747.74,-19198.04C770.71,-19185.88 798.23,-19171.3 821.2,-19159.13"/>
<polygon fill="black" stroke="black" points="822.89,-19162.2 830.09,-19154.43 819.61,-19156.01 822.89,-19162.2"/>
</g>
<!-- layer_2_mlp_fc1_gpu3&#45;&gt;layer_2_allgather_mlp -->
<g id="edge197" class="edge">
<title>layer_2_mlp_fc1_gpu3&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M828.4,-19197.81C833.94,-19188.99 840.27,-19178.93 846.24,-19169.45"/>
<polygon fill="black" stroke="black" points="849.22,-19171.29 851.58,-19160.96 843.3,-19167.56 849.22,-19171.29"/>
</g>
<!-- layer_2_mlp_fc1_gpu4&#45;&gt;layer_2_allgather_mlp -->
<g id="edge198" class="edge">
<title>layer_2_mlp_fc1_gpu4&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M908.6,-19197.81C903.06,-19188.99 896.73,-19178.93 890.76,-19169.45"/>
<polygon fill="black" stroke="black" points="893.7,-19167.56 885.42,-19160.96 887.78,-19171.29 893.7,-19167.56"/>
</g>
<!-- layer_2_mlp_fc1_gpu5&#45;&gt;layer_2_allgather_mlp -->
<g id="edge199" class="edge">
<title>layer_2_mlp_fc1_gpu5&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M989.26,-19198.04C966.29,-19185.88 938.77,-19171.3 915.8,-19159.13"/>
<polygon fill="black" stroke="black" points="917.39,-19156.01 906.91,-19154.43 914.11,-19162.2 917.39,-19156.01"/>
</g>
<!-- layer_2_mlp_fc1_gpu6&#45;&gt;layer_2_allgather_mlp -->
<g id="edge200" class="edge">
<title>layer_2_mlp_fc1_gpu6&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M1101.34,-19201.45C1098.36,-19200.26 1095.4,-19199.12 1092.5,-19198.07 1037.97,-19178.22 974.21,-19160.52 928.68,-19148.8"/>
<polygon fill="black" stroke="black" points="929.53,-19145.4 918.97,-19146.31 927.79,-19152.18 929.53,-19145.4"/>
</g>
<!-- layer_2_mlp_fc1_gpu7&#45;&gt;layer_2_allgather_mlp -->
<g id="edge201" class="edge">
<title>layer_2_mlp_fc1_gpu7&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M1213.44,-19201.14C1210.44,-19200.03 1207.45,-19198.99 1204.5,-19198.07 1112.48,-19169.2 1001.98,-19151.2 933.49,-19141.9"/>
<polygon fill="black" stroke="black" points="933.66,-19138.4 923.28,-19140.54 932.73,-19145.33 933.66,-19138.4"/>
</g>
<!-- layer_2_gelu -->
<g id="node122" class="node">
<title>layer_2_gelu</title>
<polygon fill="lightblue" stroke="black" points="913,-19068.09 824,-19068.09 824,-19032.09 913,-19032.09 913,-19068.09"/>
<text text-anchor="middle" x="868.5" y="-19053.09" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="868.5" y="-19042.09" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_2_allgather_mlp&#45;&gt;layer_2_gelu -->
<g id="edge202" class="edge">
<title>layer_2_allgather_mlp&#45;&gt;layer_2_gelu</title>
<path fill="none" stroke="black" d="M868.5,-19103.75C868.5,-19095.5 868.5,-19086.52 868.5,-19078.34"/>
<polygon fill="black" stroke="black" points="872,-19078.18 868.5,-19068.18 865,-19078.18 872,-19078.18"/>
</g>
<!-- layer_2_mlp_fc2_gpu0 -->
<g id="node123" class="node">
<title>layer_2_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="523.5,-18996.09 429.5,-18996.09 429.5,-18944.09 523.5,-18944.09 523.5,-18996.09"/>
<text text-anchor="middle" x="476.5" y="-18984.09" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="476.5" y="-18973.09" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="476.5" y="-18962.09" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="476.5" y="-18951.09" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu0 -->
<g id="edge203" class="edge">
<title>layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu0</title>
<path fill="none" stroke="black" d="M823.92,-19045.81C760.69,-19040.35 641.52,-19027.06 533.29,-18995.99"/>
<polygon fill="black" stroke="black" points="534.1,-18992.58 523.52,-18993.13 532.14,-18999.3 534.1,-18992.58"/>
</g>
<!-- layer_2_mlp_fc2_gpu1 -->
<g id="node124" class="node">
<title>layer_2_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="635.5,-18996.09 541.5,-18996.09 541.5,-18944.09 635.5,-18944.09 635.5,-18996.09"/>
<text text-anchor="middle" x="588.5" y="-18984.09" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="588.5" y="-18973.09" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="588.5" y="-18962.09" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="588.5" y="-18951.09" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu1 -->
<g id="edge204" class="edge">
<title>layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu1</title>
<path fill="none" stroke="black" d="M823.61,-19041.04C780.02,-19032.66 712.01,-19018.08 645.42,-18996.15"/>
<polygon fill="black" stroke="black" points="646.2,-18992.72 635.61,-18992.86 643.98,-18999.36 646.2,-18992.72"/>
</g>
<!-- layer_2_mlp_fc2_gpu2 -->
<g id="node125" class="node">
<title>layer_2_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="747.5,-18996.09 653.5,-18996.09 653.5,-18944.09 747.5,-18944.09 747.5,-18996.09"/>
<text text-anchor="middle" x="700.5" y="-18984.09" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="700.5" y="-18973.09" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="700.5" y="-18962.09" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="700.5" y="-18951.09" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu2 -->
<g id="edge205" class="edge">
<title>layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu2</title>
<path fill="none" stroke="black" d="M831.63,-19031.97C809.71,-19021.79 781.45,-19008.67 756.78,-18997.22"/>
<polygon fill="black" stroke="black" points="758.06,-18993.95 747.52,-18992.92 755.12,-19000.3 758.06,-18993.95"/>
</g>
<!-- layer_2_mlp_fc2_gpu3 -->
<g id="node126" class="node">
<title>layer_2_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="859.5,-18996.09 765.5,-18996.09 765.5,-18944.09 859.5,-18944.09 859.5,-18996.09"/>
<text text-anchor="middle" x="812.5" y="-18984.09" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="812.5" y="-18973.09" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="812.5" y="-18962.09" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="812.5" y="-18951.09" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu3 -->
<g id="edge206" class="edge">
<title>layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu3</title>
<path fill="none" stroke="black" d="M856.07,-19031.78C850.35,-19023.8 843.35,-19014.06 836.65,-19004.73"/>
<polygon fill="black" stroke="black" points="839.31,-19002.43 830.63,-18996.34 833.62,-19006.51 839.31,-19002.43"/>
</g>
<!-- layer_2_mlp_fc2_gpu4 -->
<g id="node127" class="node">
<title>layer_2_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="971.5,-18996.09 877.5,-18996.09 877.5,-18944.09 971.5,-18944.09 971.5,-18996.09"/>
<text text-anchor="middle" x="924.5" y="-18984.09" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="924.5" y="-18973.09" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="924.5" y="-18962.09" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="924.5" y="-18951.09" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu4 -->
<g id="edge207" class="edge">
<title>layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu4</title>
<path fill="none" stroke="black" d="M880.93,-19031.78C886.65,-19023.8 893.65,-19014.06 900.35,-19004.73"/>
<polygon fill="black" stroke="black" points="903.38,-19006.51 906.37,-18996.34 897.69,-19002.43 903.38,-19006.51"/>
</g>
<!-- layer_2_mlp_fc2_gpu5 -->
<g id="node128" class="node">
<title>layer_2_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1083.5,-18996.09 989.5,-18996.09 989.5,-18944.09 1083.5,-18944.09 1083.5,-18996.09"/>
<text text-anchor="middle" x="1036.5" y="-18984.09" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="1036.5" y="-18973.09" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1036.5" y="-18962.09" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1036.5" y="-18951.09" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu5 -->
<g id="edge208" class="edge">
<title>layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu5</title>
<path fill="none" stroke="black" d="M905.37,-19031.97C927.29,-19021.79 955.55,-19008.67 980.22,-18997.22"/>
<polygon fill="black" stroke="black" points="981.88,-19000.3 989.48,-18992.92 978.94,-18993.95 981.88,-19000.3"/>
</g>
<!-- layer_2_mlp_fc2_gpu6 -->
<g id="node129" class="node">
<title>layer_2_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1195.5,-18996.09 1101.5,-18996.09 1101.5,-18944.09 1195.5,-18944.09 1195.5,-18996.09"/>
<text text-anchor="middle" x="1148.5" y="-18984.09" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="1148.5" y="-18973.09" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1148.5" y="-18962.09" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1148.5" y="-18951.09" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu6 -->
<g id="edge209" class="edge">
<title>layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu6</title>
<path fill="none" stroke="black" d="M913.39,-19041.04C956.98,-19032.66 1024.99,-19018.08 1091.58,-18996.15"/>
<polygon fill="black" stroke="black" points="1093.02,-18999.36 1101.39,-18992.86 1090.8,-18992.72 1093.02,-18999.36"/>
</g>
<!-- layer_2_mlp_fc2_gpu7 -->
<g id="node130" class="node">
<title>layer_2_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1307.5,-18996.09 1213.5,-18996.09 1213.5,-18944.09 1307.5,-18944.09 1307.5,-18996.09"/>
<text text-anchor="middle" x="1260.5" y="-18984.09" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="1260.5" y="-18973.09" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1260.5" y="-18962.09" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1260.5" y="-18951.09" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu7 -->
<g id="edge210" class="edge">
<title>layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu7</title>
<path fill="none" stroke="black" d="M913.08,-19045.81C976.31,-19040.35 1095.48,-19027.06 1203.71,-18995.99"/>
<polygon fill="black" stroke="black" points="1204.86,-18999.3 1213.48,-18993.13 1202.9,-18992.58 1204.86,-18999.3"/>
</g>
<!-- layer_2_allreduce_mlp -->
<g id="node131" class="node">
<title>layer_2_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="924.5" cy="-18879.09" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="924.5" y="-18887.59" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="924.5" y="-18876.59" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="924.5" y="-18865.59" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_2_mlp_fc2_gpu0&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge211" class="edge">
<title>layer_2_mlp_fc2_gpu0&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M523.53,-18947.06C526.54,-18945.98 529.54,-18944.97 532.5,-18944.09 642.66,-18911.11 775.65,-18893.94 854.97,-18885.98"/>
<polygon fill="black" stroke="black" points="855.71,-18889.42 865.32,-18884.96 855.03,-18882.46 855.71,-18889.42"/>
</g>
<!-- layer_2_mlp_fc2_gpu1&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge212" class="edge">
<title>layer_2_mlp_fc2_gpu1&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M635.6,-18947.28C638.59,-18946.14 641.57,-18945.06 644.5,-18944.09 716.11,-18920.17 800.96,-18902.16 858.34,-18891.44"/>
<polygon fill="black" stroke="black" points="859.17,-18894.84 868.37,-18889.58 857.9,-18887.96 859.17,-18894.84"/>
</g>
<!-- layer_2_mlp_fc2_gpu2&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge213" class="edge">
<title>layer_2_mlp_fc2_gpu2&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M747.78,-18947.76C750.72,-18946.5 753.65,-18945.27 756.5,-18944.09 793.39,-18928.84 835.34,-18912.86 868.1,-18900.68"/>
<polygon fill="black" stroke="black" points="869.35,-18903.95 877.51,-18897.19 866.92,-18897.38 869.35,-18903.95"/>
</g>
<!-- layer_2_mlp_fc2_gpu3&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge214" class="edge">
<title>layer_2_mlp_fc2_gpu3&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M844,-18944.06C857.09,-18933.66 872.4,-18921.49 886.14,-18910.58"/>
<polygon fill="black" stroke="black" points="888.36,-18913.28 894.01,-18904.32 884.01,-18907.8 888.36,-18913.28"/>
</g>
<!-- layer_2_mlp_fc2_gpu4&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge215" class="edge">
<title>layer_2_mlp_fc2_gpu4&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M924.5,-18943.82C924.5,-18935.93 924.5,-18927.04 924.5,-18918.46"/>
<polygon fill="black" stroke="black" points="928,-18918.24 924.5,-18908.24 921,-18918.24 928,-18918.24"/>
</g>
<!-- layer_2_mlp_fc2_gpu5&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge216" class="edge">
<title>layer_2_mlp_fc2_gpu5&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1005,-18944.06C991.91,-18933.66 976.6,-18921.49 962.86,-18910.58"/>
<polygon fill="black" stroke="black" points="964.99,-18907.8 954.99,-18904.32 960.64,-18913.28 964.99,-18907.8"/>
</g>
<!-- layer_2_mlp_fc2_gpu6&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge217" class="edge">
<title>layer_2_mlp_fc2_gpu6&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1101.22,-18947.76C1098.28,-18946.5 1095.35,-18945.27 1092.5,-18944.09 1055.61,-18928.84 1013.66,-18912.86 980.9,-18900.68"/>
<polygon fill="black" stroke="black" points="982.08,-18897.38 971.49,-18897.19 979.65,-18903.95 982.08,-18897.38"/>
</g>
<!-- layer_2_mlp_fc2_gpu7&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge218" class="edge">
<title>layer_2_mlp_fc2_gpu7&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1213.4,-18947.28C1210.41,-18946.14 1207.43,-18945.06 1204.5,-18944.09 1132.89,-18920.17 1048.04,-18902.16 990.66,-18891.44"/>
<polygon fill="black" stroke="black" points="991.1,-18887.96 980.63,-18889.58 989.83,-18894.84 991.1,-18887.96"/>
</g>
<!-- layer_2_allreduce_mlp&#45;&gt;layer_2_residual2 -->
<g id="edge219" class="edge">
<title>layer_2_allreduce_mlp&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M967.47,-18858.6C997.5,-18844.98 1037.96,-18826.63 1070.93,-18811.67"/>
<polygon fill="black" stroke="black" points="1072.8,-18814.67 1080.46,-18807.35 1069.91,-18808.29 1072.8,-18814.67"/>
</g>
<!-- layer_2_ln2 -->
<g id="node133" class="node">
<title>layer_2_ln2</title>
<polygon fill="lightblue" stroke="black" points="1166,-18718.1 1093,-18718.1 1093,-18677.1 1166,-18677.1 1166,-18718.1"/>
<text text-anchor="middle" x="1129.5" y="-18706.1" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="1129.5" y="-18695.1" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="1129.5" y="-18684.1" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_2_residual2&#45;&gt;layer_2_ln2 -->
<g id="edge221" class="edge">
<title>layer_2_residual2&#45;&gt;layer_2_ln2</title>
<path fill="none" stroke="black" d="M1129.5,-18754.02C1129.5,-18745.7 1129.5,-18736.62 1129.5,-18728.26"/>
<polygon fill="black" stroke="black" points="1133,-18728.17 1129.5,-18718.17 1126,-18728.17 1133,-18728.17"/>
</g>
<!-- layer_2_output_dist -->
<g id="node134" class="node">
<title>layer_2_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="1231.2,-18641.1 1069.42,-18641.1 1027.8,-18581.1 1189.58,-18581.1 1231.2,-18641.1"/>
<text text-anchor="middle" x="1129.5" y="-18614.1" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="1129.5" y="-18603.1" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_2_ln2&#45;&gt;layer_2_output_dist -->
<g id="edge222" class="edge">
<title>layer_2_ln2&#45;&gt;layer_2_output_dist</title>
<path fill="none" stroke="black" d="M1129.5,-18677C1129.5,-18669.37 1129.5,-18660.32 1129.5,-18651.45"/>
<polygon fill="black" stroke="black" points="1133,-18651.21 1129.5,-18641.21 1126,-18651.21 1133,-18651.21"/>
</g>
<!-- layer_3_input_dist -->
<g id="node135" class="node">
<title>layer_3_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="1223.69,-18545.1 1073.86,-18545.1 1035.31,-18485.1 1185.14,-18485.1 1223.69,-18545.1"/>
<text text-anchor="middle" x="1129.5" y="-18518.1" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1129.5" y="-18507.1" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_2_output_dist&#45;&gt;layer_3_input_dist -->
<g id="edge223" class="edge">
<title>layer_2_output_dist&#45;&gt;layer_3_input_dist</title>
<path fill="none" stroke="black" d="M1129.5,-18580.88C1129.5,-18572.83 1129.5,-18563.97 1129.5,-18555.45"/>
<polygon fill="black" stroke="black" points="1133,-18555.31 1129.5,-18545.31 1126,-18555.31 1133,-18555.31"/>
</g>
<!-- layer_3_qkv_gpu0 -->
<g id="node136" class="node">
<title>layer_3_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="732,-18449.1 639,-18449.1 639,-18397.1 732,-18397.1 732,-18449.1"/>
<text text-anchor="middle" x="685.5" y="-18437.1" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="685.5" y="-18426.1" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="685.5" y="-18415.1" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="685.5" y="-18404.1" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu0 -->
<g id="edge224" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1049,-18506.64C971.82,-18498.13 852.31,-18481.4 741.86,-18448.88"/>
<polygon fill="black" stroke="black" points="742.81,-18445.51 732.22,-18446 740.8,-18452.22 742.81,-18445.51"/>
</g>
<!-- layer_3_qkv_gpu1 -->
<g id="node137" class="node">
<title>layer_3_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="843,-18449.1 750,-18449.1 750,-18397.1 843,-18397.1 843,-18449.1"/>
<text text-anchor="middle" x="796.5" y="-18437.1" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="796.5" y="-18426.1" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="796.5" y="-18415.1" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="796.5" y="-18404.1" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu1 -->
<g id="edge225" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1043.78,-18498.36C990.93,-18487.64 921.87,-18471.79 853.01,-18449.03"/>
<polygon fill="black" stroke="black" points="853.89,-18445.63 843.3,-18445.77 851.66,-18452.27 853.89,-18445.63"/>
</g>
<!-- layer_3_qkv_gpu2 -->
<g id="node138" class="node">
<title>layer_3_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="954,-18449.1 861,-18449.1 861,-18397.1 954,-18397.1 954,-18449.1"/>
<text text-anchor="middle" x="907.5" y="-18437.1" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="907.5" y="-18426.1" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="907.5" y="-18415.1" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="907.5" y="-18404.1" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu2 -->
<g id="edge226" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1053.17,-18485.07C1024.89,-18474.09 992.62,-18461.3 963.5,-18449.1 963.4,-18449.06 963.31,-18449.02 963.21,-18448.98"/>
<polygon fill="black" stroke="black" points="964.75,-18445.83 954.18,-18445.14 962.01,-18452.28 964.75,-18445.83"/>
</g>
<!-- layer_3_qkv_gpu3 -->
<g id="node139" class="node">
<title>layer_3_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1065,-18449.1 972,-18449.1 972,-18397.1 1065,-18397.1 1065,-18449.1"/>
<text text-anchor="middle" x="1018.5" y="-18437.1" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="1018.5" y="-18426.1" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1018.5" y="-18415.1" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1018.5" y="-18404.1" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu3 -->
<g id="edge227" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1093.46,-18484.88C1081.94,-18475.54 1069.14,-18465.16 1057.42,-18455.66"/>
<polygon fill="black" stroke="black" points="1059.48,-18452.83 1049.51,-18449.25 1055.08,-18458.26 1059.48,-18452.83"/>
</g>
<!-- layer_3_qkv_gpu4 -->
<g id="node140" class="node">
<title>layer_3_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1176,-18449.1 1083,-18449.1 1083,-18397.1 1176,-18397.1 1176,-18449.1"/>
<text text-anchor="middle" x="1129.5" y="-18437.1" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="1129.5" y="-18426.1" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1129.5" y="-18415.1" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1129.5" y="-18404.1" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu4 -->
<g id="edge228" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1129.5,-18484.63C1129.5,-18476.56 1129.5,-18467.73 1129.5,-18459.36"/>
<polygon fill="black" stroke="black" points="1133,-18459.11 1129.5,-18449.11 1126,-18459.11 1133,-18459.11"/>
</g>
<!-- layer_3_qkv_gpu5 -->
<g id="node141" class="node">
<title>layer_3_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1287,-18449.1 1194,-18449.1 1194,-18397.1 1287,-18397.1 1287,-18449.1"/>
<text text-anchor="middle" x="1240.5" y="-18437.1" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="1240.5" y="-18426.1" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1240.5" y="-18415.1" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1240.5" y="-18404.1" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu5 -->
<g id="edge229" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1165.54,-18484.88C1177.06,-18475.54 1189.86,-18465.16 1201.58,-18455.66"/>
<polygon fill="black" stroke="black" points="1203.92,-18458.26 1209.49,-18449.25 1199.52,-18452.83 1203.92,-18458.26"/>
</g>
<!-- layer_3_qkv_gpu6 -->
<g id="node142" class="node">
<title>layer_3_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1398,-18449.1 1305,-18449.1 1305,-18397.1 1398,-18397.1 1398,-18449.1"/>
<text text-anchor="middle" x="1351.5" y="-18437.1" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="1351.5" y="-18426.1" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1351.5" y="-18415.1" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1351.5" y="-18404.1" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu6 -->
<g id="edge230" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1189.73,-18491.59C1219.33,-18480.3 1255.68,-18466.13 1295.42,-18449.49"/>
<polygon fill="black" stroke="black" points="1296.91,-18452.66 1304.77,-18445.56 1294.2,-18446.21 1296.91,-18452.66"/>
</g>
<!-- layer_3_qkv_gpu7 -->
<g id="node143" class="node">
<title>layer_3_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1509,-18449.1 1416,-18449.1 1416,-18397.1 1509,-18397.1 1509,-18449.1"/>
<text text-anchor="middle" x="1462.5" y="-18437.1" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="1462.5" y="-18426.1" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1462.5" y="-18415.1" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1462.5" y="-18404.1" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu7 -->
<g id="edge231" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1196.25,-18502.33C1250.88,-18491.83 1330.07,-18474.63 1406.2,-18449.31"/>
<polygon fill="black" stroke="black" points="1407.59,-18452.54 1415.95,-18446.02 1405.35,-18445.9 1407.59,-18452.54"/>
</g>
<!-- layer_3_residual1 -->
<g id="node155" class="node">
<title>layer_3_residual1</title>
<polygon fill="lightyellow" stroke="black" points="1419.44,-17997.14 1297.05,-17997.14 1265.56,-17937.14 1387.95,-17937.14 1419.44,-17997.14"/>
<text text-anchor="middle" x="1342.5" y="-17970.14" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1342.5" y="-17959.14" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_residual1 -->
<g id="edge258" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M1202.59,-18511.76C1302.77,-18506.95 1475.3,-18492.44 1518.5,-18449.1 1555.38,-18412.11 1537.5,-18385.35 1537.5,-18333.11 1537.5,-18333.11 1537.5,-18333.11 1537.5,-18152.12 1537.5,-18083.34 1472.52,-18032.66 1417.59,-18002.1"/>
<polygon fill="black" stroke="black" points="1418.98,-17998.88 1408.52,-17997.19 1415.64,-18005.03 1418.98,-17998.88"/>
</g>
<!-- layer_3_allgather_qkv -->
<g id="node144" class="node">
<title>layer_3_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="1085.5" cy="-18332.11" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="1085.5" y="-18340.61" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1085.5" y="-18329.61" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="1085.5" y="-18318.61" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_3_qkv_gpu0&#45;&gt;layer_3_allgather_qkv -->
<g id="edge232" class="edge">
<title>layer_3_qkv_gpu0&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M732.24,-18400.27C735.35,-18399.12 738.45,-18398.05 741.5,-18397.1 836.17,-18367.62 949.96,-18349.72 1020.01,-18340.62"/>
<polygon fill="black" stroke="black" points="1020.54,-18344.08 1030.02,-18339.34 1019.65,-18337.13 1020.54,-18344.08"/>
</g>
<!-- layer_3_qkv_gpu1&#45;&gt;layer_3_allgather_qkv -->
<g id="edge233" class="edge">
<title>layer_3_qkv_gpu1&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M843.03,-18400.69C846.22,-18399.43 849.39,-18398.22 852.5,-18397.1 909.65,-18376.63 976.64,-18358.86 1024.08,-18347.27"/>
<polygon fill="black" stroke="black" points="1025,-18350.65 1033.9,-18344.9 1023.36,-18343.85 1025,-18350.65"/>
</g>
<!-- layer_3_qkv_gpu2&#45;&gt;layer_3_allgather_qkv -->
<g id="edge234" class="edge">
<title>layer_3_qkv_gpu2&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M954.27,-18398.72C979.59,-18386.06 1010.84,-18370.44 1036.5,-18357.61"/>
<polygon fill="black" stroke="black" points="1038.3,-18360.62 1045.68,-18353.02 1035.17,-18354.36 1038.3,-18360.62"/>
</g>
<!-- layer_3_qkv_gpu3&#45;&gt;layer_3_allgather_qkv -->
<g id="edge235" class="edge">
<title>layer_3_qkv_gpu3&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M1037.52,-18396.84C1044.41,-18387.69 1052.32,-18377.19 1059.69,-18367.39"/>
<polygon fill="black" stroke="black" points="1062.51,-18369.46 1065.73,-18359.37 1056.92,-18365.25 1062.51,-18369.46"/>
</g>
<!-- layer_3_qkv_gpu4&#45;&gt;layer_3_allgather_qkv -->
<g id="edge236" class="edge">
<title>layer_3_qkv_gpu4&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M1117.01,-18396.84C1112.78,-18388.28 1107.97,-18378.55 1103.4,-18369.32"/>
<polygon fill="black" stroke="black" points="1106.52,-18367.72 1098.95,-18360.31 1100.24,-18370.82 1106.52,-18367.72"/>
</g>
<!-- layer_3_qkv_gpu5&#45;&gt;layer_3_allgather_qkv -->
<g id="edge237" class="edge">
<title>layer_3_qkv_gpu5&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M1196.91,-18397.08C1176.48,-18385.34 1152.12,-18371.36 1131.4,-18359.47"/>
<polygon fill="black" stroke="black" points="1132.88,-18356.28 1122.47,-18354.34 1129.4,-18362.35 1132.88,-18356.28"/>
</g>
<!-- layer_3_qkv_gpu6&#45;&gt;layer_3_allgather_qkv -->
<g id="edge238" class="edge">
<title>layer_3_qkv_gpu6&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M1304.87,-18400.4C1302.05,-18399.25 1299.25,-18398.14 1296.5,-18397.1 1246.32,-18378.19 1187.88,-18360.81 1145.24,-18348.95"/>
<polygon fill="black" stroke="black" points="1146.15,-18345.57 1135.57,-18346.29 1144.28,-18352.32 1146.15,-18345.57"/>
</g>
<!-- layer_3_qkv_gpu7&#45;&gt;layer_3_allgather_qkv -->
<g id="edge239" class="edge">
<title>layer_3_qkv_gpu7&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M1415.98,-18400.08C1413.14,-18399.01 1410.3,-18398 1407.5,-18397.1 1320.72,-18369.17 1216.69,-18351.16 1150.83,-18341.58"/>
<polygon fill="black" stroke="black" points="1150.99,-18338.07 1140.6,-18340.12 1150,-18345 1150.99,-18338.07"/>
</g>
<!-- layer_3_attention -->
<g id="node145" class="node">
<title>layer_3_attention</title>
<polygon fill="lightblue" stroke="black" points="1119.5,-18267.12 1051.5,-18267.12 1051.5,-18215.12 1119.5,-18215.12 1119.5,-18267.12"/>
<text text-anchor="middle" x="1085.5" y="-18255.12" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1085.5" y="-18244.12" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1085.5" y="-18233.12" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="1085.5" y="-18222.12" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_3_allgather_qkv&#45;&gt;layer_3_attention -->
<g id="edge240" class="edge">
<title>layer_3_allgather_qkv&#45;&gt;layer_3_attention</title>
<path fill="none" stroke="black" d="M1085.5,-18302.95C1085.5,-18294.85 1085.5,-18285.9 1085.5,-18277.41"/>
<polygon fill="black" stroke="black" points="1089,-18277.38 1085.5,-18267.38 1082,-18277.38 1089,-18277.38"/>
</g>
<!-- layer_3_attn_out_gpu0 -->
<g id="node146" class="node">
<title>layer_3_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="767.5,-18179.12 679.5,-18179.12 679.5,-18127.12 767.5,-18127.12 767.5,-18179.12"/>
<text text-anchor="middle" x="723.5" y="-18167.12" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="723.5" y="-18156.12" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="723.5" y="-18145.12" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="723.5" y="-18134.12" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attention&#45;&gt;layer_3_attn_out_gpu0 -->
<g id="edge241" class="edge">
<title>layer_3_attention&#45;&gt;layer_3_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M1051.43,-18236.18C995.48,-18229.12 880.85,-18212.14 777.37,-18179.08"/>
<polygon fill="black" stroke="black" points="778.3,-18175.71 767.71,-18175.94 776.13,-18182.36 778.3,-18175.71"/>
</g>
<!-- layer_3_attn_out_gpu1 -->
<g id="node147" class="node">
<title>layer_3_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="873.5,-18179.12 785.5,-18179.12 785.5,-18127.12 873.5,-18127.12 873.5,-18179.12"/>
<text text-anchor="middle" x="829.5" y="-18167.12" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="829.5" y="-18156.12" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="829.5" y="-18145.12" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="829.5" y="-18134.12" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attention&#45;&gt;layer_3_attn_out_gpu1 -->
<g id="edge242" class="edge">
<title>layer_3_attention&#45;&gt;layer_3_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M1051.22,-18231.49C1012.35,-18221.34 947.05,-18203.2 882.97,-18179.09"/>
<polygon fill="black" stroke="black" points="884.12,-18175.78 873.53,-18175.49 881.63,-18182.32 884.12,-18175.78"/>
</g>
<!-- layer_3_attn_out_gpu2 -->
<g id="node148" class="node">
<title>layer_3_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="979.5,-18179.12 891.5,-18179.12 891.5,-18127.12 979.5,-18127.12 979.5,-18179.12"/>
<text text-anchor="middle" x="935.5" y="-18167.12" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="935.5" y="-18156.12" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="935.5" y="-18145.12" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="935.5" y="-18134.12" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attention&#45;&gt;layer_3_attn_out_gpu2 -->
<g id="edge243" class="edge">
<title>layer_3_attention&#45;&gt;layer_3_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M1051.46,-18220.61C1032.78,-18209.9 1009.21,-18196.38 988.2,-18184.34"/>
<polygon fill="black" stroke="black" points="989.8,-18181.22 979.38,-18179.28 986.31,-18187.29 989.8,-18181.22"/>
</g>
<!-- layer_3_attn_out_gpu3 -->
<g id="node149" class="node">
<title>layer_3_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1085.5,-18179.12 997.5,-18179.12 997.5,-18127.12 1085.5,-18127.12 1085.5,-18179.12"/>
<text text-anchor="middle" x="1041.5" y="-18167.12" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="1041.5" y="-18156.12" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1041.5" y="-18145.12" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1041.5" y="-18134.12" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attention&#45;&gt;layer_3_attn_out_gpu3 -->
<g id="edge244" class="edge">
<title>layer_3_attention&#45;&gt;layer_3_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M1072.54,-18214.78C1068.28,-18206.47 1063.49,-18197.1 1058.96,-18188.24"/>
<polygon fill="black" stroke="black" points="1062.04,-18186.59 1054.37,-18179.28 1055.81,-18189.77 1062.04,-18186.59"/>
</g>
<!-- layer_3_attn_out_gpu4 -->
<g id="node150" class="node">
<title>layer_3_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1191.5,-18179.12 1103.5,-18179.12 1103.5,-18127.12 1191.5,-18127.12 1191.5,-18179.12"/>
<text text-anchor="middle" x="1147.5" y="-18167.12" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="1147.5" y="-18156.12" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1147.5" y="-18145.12" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1147.5" y="-18134.12" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attention&#45;&gt;layer_3_attn_out_gpu4 -->
<g id="edge245" class="edge">
<title>layer_3_attention&#45;&gt;layer_3_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M1103.77,-18214.78C1109.95,-18206.21 1116.95,-18196.5 1123.5,-18187.41"/>
<polygon fill="black" stroke="black" points="1126.35,-18189.44 1129.36,-18179.28 1120.68,-18185.34 1126.35,-18189.44"/>
</g>
<!-- layer_3_attn_out_gpu5 -->
<g id="node151" class="node">
<title>layer_3_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1297.5,-18179.12 1209.5,-18179.12 1209.5,-18127.12 1297.5,-18127.12 1297.5,-18179.12"/>
<text text-anchor="middle" x="1253.5" y="-18167.12" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="1253.5" y="-18156.12" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1253.5" y="-18145.12" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1253.5" y="-18134.12" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attention&#45;&gt;layer_3_attn_out_gpu5 -->
<g id="edge246" class="edge">
<title>layer_3_attention&#45;&gt;layer_3_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M1119.9,-18222.51C1143,-18210.68 1173.9,-18194.87 1200.16,-18181.43"/>
<polygon fill="black" stroke="black" points="1201.93,-18184.45 1209.24,-18176.78 1198.74,-18178.22 1201.93,-18184.45"/>
</g>
<!-- layer_3_attn_out_gpu6 -->
<g id="node152" class="node">
<title>layer_3_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1403.5,-18179.12 1315.5,-18179.12 1315.5,-18127.12 1403.5,-18127.12 1403.5,-18179.12"/>
<text text-anchor="middle" x="1359.5" y="-18167.12" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="1359.5" y="-18156.12" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1359.5" y="-18145.12" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1359.5" y="-18134.12" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attention&#45;&gt;layer_3_attn_out_gpu6 -->
<g id="edge247" class="edge">
<title>layer_3_attention&#45;&gt;layer_3_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M1119.77,-18232.59C1161.82,-18222.93 1235.28,-18204.71 1305.99,-18179.07"/>
<polygon fill="black" stroke="black" points="1307.32,-18182.31 1315.5,-18175.57 1304.9,-18175.74 1307.32,-18182.31"/>
</g>
<!-- layer_3_attn_out_gpu7 -->
<g id="node153" class="node">
<title>layer_3_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1509.5,-18179.12 1421.5,-18179.12 1421.5,-18127.12 1509.5,-18127.12 1509.5,-18179.12"/>
<text text-anchor="middle" x="1465.5" y="-18167.12" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="1465.5" y="-18156.12" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1465.5" y="-18145.12" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1465.5" y="-18134.12" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attention&#45;&gt;layer_3_attn_out_gpu7 -->
<g id="edge248" class="edge">
<title>layer_3_attention&#45;&gt;layer_3_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M1119.63,-18236.67C1178.2,-18230.13 1301.4,-18213.65 1411.69,-18179.05"/>
<polygon fill="black" stroke="black" points="1412.84,-18182.36 1421.3,-18175.98 1410.71,-18175.69 1412.84,-18182.36"/>
</g>
<!-- layer_3_allreduce_attn -->
<g id="node154" class="node">
<title>layer_3_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="1147.5" cy="-18062.13" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="1147.5" y="-18070.63" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1147.5" y="-18059.63" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="1147.5" y="-18048.63" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_3_attn_out_gpu0&#45;&gt;layer_3_allreduce_attn -->
<g id="edge249" class="edge">
<title>layer_3_attn_out_gpu0&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M767.68,-18130.22C770.63,-18129.09 773.59,-18128.04 776.5,-18127.12 879.93,-18094.47 1005.16,-18077.26 1080.47,-18069.19"/>
<polygon fill="black" stroke="black" points="1081.17,-18072.64 1090.75,-18068.11 1080.44,-18065.68 1081.17,-18072.64"/>
</g>
<!-- layer_3_attn_out_gpu1&#45;&gt;layer_3_allreduce_attn -->
<g id="edge250" class="edge">
<title>layer_3_attn_out_gpu1&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M873.76,-18130.44C876.69,-18129.26 879.62,-18128.14 882.5,-18127.12 949.63,-18103.46 1029.34,-18085.52 1083.69,-18074.74"/>
<polygon fill="black" stroke="black" points="1084.39,-18078.16 1093.53,-18072.81 1083.04,-18071.3 1084.39,-18078.16"/>
</g>
<!-- layer_3_attn_out_gpu2&#45;&gt;layer_3_allreduce_attn -->
<g id="edge251" class="edge">
<title>layer_3_attn_out_gpu2&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M979.66,-18131.06C982.64,-18129.71 985.61,-18128.38 988.5,-18127.12 1022.83,-18112.13 1061.84,-18096.41 1092.63,-18084.3"/>
<polygon fill="black" stroke="black" points="1094.29,-18087.41 1102.32,-18080.5 1091.73,-18080.9 1094.29,-18087.41"/>
</g>
<!-- layer_3_attn_out_gpu3&#45;&gt;layer_3_allreduce_attn -->
<g id="edge252" class="edge">
<title>layer_3_attn_out_gpu3&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M1071.31,-18127.09C1083.58,-18116.79 1097.92,-18104.75 1110.83,-18093.92"/>
<polygon fill="black" stroke="black" points="1113.24,-18096.46 1118.65,-18087.35 1108.74,-18091.1 1113.24,-18096.46"/>
</g>
<!-- layer_3_attn_out_gpu4&#45;&gt;layer_3_allreduce_attn -->
<g id="edge253" class="edge">
<title>layer_3_attn_out_gpu4&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M1147.5,-18126.86C1147.5,-18118.97 1147.5,-18110.08 1147.5,-18101.5"/>
<polygon fill="black" stroke="black" points="1151,-18101.27 1147.5,-18091.27 1144,-18101.27 1151,-18101.27"/>
</g>
<!-- layer_3_attn_out_gpu5&#45;&gt;layer_3_allreduce_attn -->
<g id="edge254" class="edge">
<title>layer_3_attn_out_gpu5&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M1223.69,-18127.09C1211.42,-18116.79 1197.08,-18104.75 1184.17,-18093.92"/>
<polygon fill="black" stroke="black" points="1186.26,-18091.1 1176.35,-18087.35 1181.76,-18096.46 1186.26,-18091.1"/>
</g>
<!-- layer_3_attn_out_gpu6&#45;&gt;layer_3_allreduce_attn -->
<g id="edge255" class="edge">
<title>layer_3_attn_out_gpu6&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M1315.34,-18131.06C1312.36,-18129.71 1309.39,-18128.38 1306.5,-18127.12 1272.17,-18112.13 1233.16,-18096.41 1202.37,-18084.3"/>
<polygon fill="black" stroke="black" points="1203.27,-18080.9 1192.68,-18080.5 1200.71,-18087.41 1203.27,-18080.9"/>
</g>
<!-- layer_3_attn_out_gpu7&#45;&gt;layer_3_allreduce_attn -->
<g id="edge256" class="edge">
<title>layer_3_attn_out_gpu7&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M1421.24,-18130.44C1418.31,-18129.26 1415.38,-18128.14 1412.5,-18127.12 1345.37,-18103.46 1265.66,-18085.52 1211.31,-18074.74"/>
<polygon fill="black" stroke="black" points="1211.96,-18071.3 1201.47,-18072.81 1210.61,-18078.16 1211.96,-18071.3"/>
</g>
<!-- layer_3_allreduce_attn&#45;&gt;layer_3_residual1 -->
<g id="edge257" class="edge">
<title>layer_3_allreduce_attn&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M1188.85,-18041.41C1216.62,-18028.17 1253.59,-18010.54 1284.31,-17995.89"/>
<polygon fill="black" stroke="black" points="1286.1,-17998.91 1293.62,-17991.45 1283.09,-17992.59 1286.1,-17998.91"/>
</g>
<!-- layer_3_ln1 -->
<g id="node156" class="node">
<title>layer_3_ln1</title>
<polygon fill="lightblue" stroke="black" points="1174,-17901.14 1101,-17901.14 1101,-17860.14 1174,-17860.14 1174,-17901.14"/>
<text text-anchor="middle" x="1137.5" y="-17889.14" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1137.5" y="-17878.14" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="1137.5" y="-17867.14" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_3_residual1&#45;&gt;layer_3_ln1 -->
<g id="edge259" class="edge">
<title>layer_3_residual1&#45;&gt;layer_3_ln1</title>
<path fill="none" stroke="black" d="M1271.95,-17937.06C1242.66,-17924.98 1209.49,-17911.31 1183.43,-17900.57"/>
<polygon fill="black" stroke="black" points="1184.75,-17897.33 1174.17,-17896.75 1182.08,-17903.8 1184.75,-17897.33"/>
</g>
<!-- layer_3_residual2 -->
<g id="node176" class="node">
<title>layer_3_residual2</title>
<polygon fill="lightyellow" stroke="black" points="1419.44,-17388.17 1297.05,-17388.17 1265.56,-17328.17 1387.95,-17328.17 1419.44,-17388.17"/>
<text text-anchor="middle" x="1342.5" y="-17361.17" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1342.5" y="-17350.17" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_3_residual1&#45;&gt;layer_3_residual2 -->
<g id="edge294" class="edge">
<title>layer_3_residual1&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M1394.48,-17949.57C1455.51,-17926.49 1548.5,-17878.33 1548.5,-17799.14 1548.5,-17799.14 1548.5,-17799.14 1548.5,-17543.16 1548.5,-17472.95 1481.11,-17422.86 1423.42,-17392.85"/>
<polygon fill="black" stroke="black" points="1424.76,-17389.61 1414.26,-17388.21 1421.6,-17395.85 1424.76,-17389.61"/>
</g>
<!-- layer_3_mlp_fc1_gpu0 -->
<g id="node157" class="node">
<title>layer_3_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="736.5,-17824.14 642.5,-17824.14 642.5,-17772.14 736.5,-17772.14 736.5,-17824.14"/>
<text text-anchor="middle" x="689.5" y="-17812.14" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="689.5" y="-17801.14" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="689.5" y="-17790.14" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="689.5" y="-17779.14" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu0 -->
<g id="edge260" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M1100.85,-17877.86C1032.28,-17873.81 880.17,-17861.39 746.13,-17823.97"/>
<polygon fill="black" stroke="black" points="747.08,-17820.6 736.51,-17821.23 745.17,-17827.34 747.08,-17820.6"/>
</g>
<!-- layer_3_mlp_fc1_gpu1 -->
<g id="node158" class="node">
<title>layer_3_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="848.5,-17824.14 754.5,-17824.14 754.5,-17772.14 848.5,-17772.14 848.5,-17824.14"/>
<text text-anchor="middle" x="801.5" y="-17812.14" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="801.5" y="-17801.14" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="801.5" y="-17790.14" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="801.5" y="-17779.14" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu1 -->
<g id="edge261" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M1100.6,-17875.01C1048.26,-17867.87 949.55,-17852.28 858.23,-17824.08"/>
<polygon fill="black" stroke="black" points="859.16,-17820.7 848.57,-17821.04 857.05,-17827.38 859.16,-17820.7"/>
</g>
<!-- layer_3_mlp_fc1_gpu2 -->
<g id="node159" class="node">
<title>layer_3_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="960.5,-17824.14 866.5,-17824.14 866.5,-17772.14 960.5,-17772.14 960.5,-17824.14"/>
<text text-anchor="middle" x="913.5" y="-17812.14" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="913.5" y="-17801.14" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="913.5" y="-17790.14" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="913.5" y="-17779.14" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu2 -->
<g id="edge262" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M1100.75,-17868.67C1068.47,-17858.77 1020.12,-17843.33 970.08,-17824.23"/>
<polygon fill="black" stroke="black" points="971.3,-17820.95 960.72,-17820.62 968.79,-17827.48 971.3,-17820.95"/>
</g>
<!-- layer_3_mlp_fc1_gpu3 -->
<g id="node160" class="node">
<title>layer_3_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1072.5,-17824.14 978.5,-17824.14 978.5,-17772.14 1072.5,-17772.14 1072.5,-17824.14"/>
<text text-anchor="middle" x="1025.5" y="-17812.14" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="1025.5" y="-17801.14" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1025.5" y="-17790.14" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1025.5" y="-17779.14" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu3 -->
<g id="edge263" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M1110.1,-17859.95C1097.77,-17851.08 1082.9,-17840.39 1069.09,-17830.47"/>
<polygon fill="black" stroke="black" points="1070.83,-17827.41 1060.67,-17824.41 1066.74,-17833.09 1070.83,-17827.41"/>
</g>
<!-- layer_3_mlp_fc1_gpu4 -->
<g id="node161" class="node">
<title>layer_3_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1184.5,-17824.14 1090.5,-17824.14 1090.5,-17772.14 1184.5,-17772.14 1184.5,-17824.14"/>
<text text-anchor="middle" x="1137.5" y="-17812.14" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="1137.5" y="-17801.14" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1137.5" y="-17790.14" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1137.5" y="-17779.14" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu4 -->
<g id="edge264" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M1137.5,-17859.74C1137.5,-17852.13 1137.5,-17843.19 1137.5,-17834.56"/>
<polygon fill="black" stroke="black" points="1141,-17834.29 1137.5,-17824.29 1134,-17834.29 1141,-17834.29"/>
</g>
<!-- layer_3_mlp_fc1_gpu5 -->
<g id="node162" class="node">
<title>layer_3_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1296.5,-17824.14 1202.5,-17824.14 1202.5,-17772.14 1296.5,-17772.14 1296.5,-17824.14"/>
<text text-anchor="middle" x="1249.5" y="-17812.14" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="1249.5" y="-17801.14" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1249.5" y="-17790.14" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1249.5" y="-17779.14" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu5 -->
<g id="edge265" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M1164.9,-17859.95C1177.23,-17851.08 1192.1,-17840.39 1205.91,-17830.47"/>
<polygon fill="black" stroke="black" points="1208.26,-17833.09 1214.33,-17824.41 1204.17,-17827.41 1208.26,-17833.09"/>
</g>
<!-- layer_3_mlp_fc1_gpu6 -->
<g id="node163" class="node">
<title>layer_3_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1408.5,-17824.14 1314.5,-17824.14 1314.5,-17772.14 1408.5,-17772.14 1408.5,-17824.14"/>
<text text-anchor="middle" x="1361.5" y="-17812.14" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="1361.5" y="-17801.14" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1361.5" y="-17790.14" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1361.5" y="-17779.14" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu6 -->
<g id="edge266" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M1174.25,-17868.67C1206.53,-17858.77 1254.88,-17843.33 1304.92,-17824.23"/>
<polygon fill="black" stroke="black" points="1306.21,-17827.48 1314.28,-17820.62 1303.7,-17820.95 1306.21,-17827.48"/>
</g>
<!-- layer_3_mlp_fc1_gpu7 -->
<g id="node164" class="node">
<title>layer_3_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1520.5,-17824.14 1426.5,-17824.14 1426.5,-17772.14 1520.5,-17772.14 1520.5,-17824.14"/>
<text text-anchor="middle" x="1473.5" y="-17812.14" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="1473.5" y="-17801.14" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1473.5" y="-17790.14" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1473.5" y="-17779.14" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu7 -->
<g id="edge267" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M1174.4,-17875.01C1226.74,-17867.87 1325.45,-17852.28 1416.77,-17824.08"/>
<polygon fill="black" stroke="black" points="1417.95,-17827.38 1426.43,-17821.04 1415.84,-17820.7 1417.95,-17827.38"/>
</g>
<!-- layer_3_allgather_mlp -->
<g id="node165" class="node">
<title>layer_3_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="1081.5" cy="-17707.15" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="1081.5" y="-17715.65" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1081.5" y="-17704.65" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="1081.5" y="-17693.65" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_3_mlp_fc1_gpu0&#45;&gt;layer_3_allgather_mlp -->
<g id="edge268" class="edge">
<title>layer_3_mlp_fc1_gpu0&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M736.56,-17775.21C739.56,-17774.1 742.55,-17773.06 745.5,-17772.14 837.52,-17743.26 948.02,-17725.27 1016.51,-17715.97"/>
<polygon fill="black" stroke="black" points="1017.27,-17719.4 1026.72,-17714.61 1016.34,-17712.47 1017.27,-17719.4"/>
</g>
<!-- layer_3_mlp_fc1_gpu1&#45;&gt;layer_3_allgather_mlp -->
<g id="edge269" class="edge">
<title>layer_3_mlp_fc1_gpu1&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M848.66,-17775.52C851.64,-17774.33 854.6,-17773.19 857.5,-17772.14 912.03,-17752.29 975.79,-17734.59 1021.32,-17722.86"/>
<polygon fill="black" stroke="black" points="1022.21,-17726.25 1031.03,-17720.38 1020.47,-17719.47 1022.21,-17726.25"/>
</g>
<!-- layer_3_mlp_fc1_gpu2&#45;&gt;layer_3_allgather_mlp -->
<g id="edge270" class="edge">
<title>layer_3_mlp_fc1_gpu2&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M960.74,-17772.11C983.71,-17759.95 1011.23,-17745.37 1034.2,-17733.2"/>
<polygon fill="black" stroke="black" points="1035.89,-17736.27 1043.09,-17728.49 1032.61,-17730.08 1035.89,-17736.27"/>
</g>
<!-- layer_3_mlp_fc1_gpu3&#45;&gt;layer_3_allgather_mlp -->
<g id="edge271" class="edge">
<title>layer_3_mlp_fc1_gpu3&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M1041.4,-17771.87C1046.94,-17763.06 1053.27,-17753 1059.24,-17743.52"/>
<polygon fill="black" stroke="black" points="1062.22,-17745.36 1064.58,-17735.03 1056.3,-17741.63 1062.22,-17745.36"/>
</g>
<!-- layer_3_mlp_fc1_gpu4&#45;&gt;layer_3_allgather_mlp -->
<g id="edge272" class="edge">
<title>layer_3_mlp_fc1_gpu4&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M1121.6,-17771.87C1116.06,-17763.06 1109.73,-17753 1103.76,-17743.52"/>
<polygon fill="black" stroke="black" points="1106.7,-17741.63 1098.42,-17735.03 1100.78,-17745.36 1106.7,-17741.63"/>
</g>
<!-- layer_3_mlp_fc1_gpu5&#45;&gt;layer_3_allgather_mlp -->
<g id="edge273" class="edge">
<title>layer_3_mlp_fc1_gpu5&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M1202.26,-17772.11C1179.29,-17759.95 1151.77,-17745.37 1128.8,-17733.2"/>
<polygon fill="black" stroke="black" points="1130.39,-17730.08 1119.91,-17728.49 1127.11,-17736.27 1130.39,-17730.08"/>
</g>
<!-- layer_3_mlp_fc1_gpu6&#45;&gt;layer_3_allgather_mlp -->
<g id="edge274" class="edge">
<title>layer_3_mlp_fc1_gpu6&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M1314.34,-17775.52C1311.36,-17774.33 1308.4,-17773.19 1305.5,-17772.14 1250.97,-17752.29 1187.21,-17734.59 1141.68,-17722.86"/>
<polygon fill="black" stroke="black" points="1142.53,-17719.47 1131.97,-17720.38 1140.79,-17726.25 1142.53,-17719.47"/>
</g>
<!-- layer_3_mlp_fc1_gpu7&#45;&gt;layer_3_allgather_mlp -->
<g id="edge275" class="edge">
<title>layer_3_mlp_fc1_gpu7&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M1426.44,-17775.21C1423.44,-17774.1 1420.45,-17773.06 1417.5,-17772.14 1325.48,-17743.26 1214.98,-17725.27 1146.49,-17715.97"/>
<polygon fill="black" stroke="black" points="1146.66,-17712.47 1136.28,-17714.61 1145.73,-17719.4 1146.66,-17712.47"/>
</g>
<!-- layer_3_gelu -->
<g id="node166" class="node">
<title>layer_3_gelu</title>
<polygon fill="lightblue" stroke="black" points="1126,-17642.16 1037,-17642.16 1037,-17606.16 1126,-17606.16 1126,-17642.16"/>
<text text-anchor="middle" x="1081.5" y="-17627.16" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1081.5" y="-17616.16" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_3_allgather_mlp&#45;&gt;layer_3_gelu -->
<g id="edge276" class="edge">
<title>layer_3_allgather_mlp&#45;&gt;layer_3_gelu</title>
<path fill="none" stroke="black" d="M1081.5,-17677.82C1081.5,-17669.57 1081.5,-17660.58 1081.5,-17652.41"/>
<polygon fill="black" stroke="black" points="1085,-17652.25 1081.5,-17642.25 1078,-17652.25 1085,-17652.25"/>
</g>
<!-- layer_3_mlp_fc2_gpu0 -->
<g id="node167" class="node">
<title>layer_3_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="736.5,-17570.16 642.5,-17570.16 642.5,-17518.16 736.5,-17518.16 736.5,-17570.16"/>
<text text-anchor="middle" x="689.5" y="-17558.16" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="689.5" y="-17547.16" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="689.5" y="-17536.16" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="689.5" y="-17525.16" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu0 -->
<g id="edge277" class="edge">
<title>layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu0</title>
<path fill="none" stroke="black" d="M1036.92,-17619.88C973.69,-17614.42 854.52,-17601.13 746.29,-17570.06"/>
<polygon fill="black" stroke="black" points="747.1,-17566.65 736.52,-17567.2 745.14,-17573.37 747.1,-17566.65"/>
</g>
<!-- layer_3_mlp_fc2_gpu1 -->
<g id="node168" class="node">
<title>layer_3_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="848.5,-17570.16 754.5,-17570.16 754.5,-17518.16 848.5,-17518.16 848.5,-17570.16"/>
<text text-anchor="middle" x="801.5" y="-17558.16" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="801.5" y="-17547.16" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="801.5" y="-17536.16" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="801.5" y="-17525.16" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu1 -->
<g id="edge278" class="edge">
<title>layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu1</title>
<path fill="none" stroke="black" d="M1036.61,-17615.11C993.02,-17606.73 925.01,-17592.15 858.42,-17570.22"/>
<polygon fill="black" stroke="black" points="859.2,-17566.79 848.61,-17566.93 856.98,-17573.43 859.2,-17566.79"/>
</g>
<!-- layer_3_mlp_fc2_gpu2 -->
<g id="node169" class="node">
<title>layer_3_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="960.5,-17570.16 866.5,-17570.16 866.5,-17518.16 960.5,-17518.16 960.5,-17570.16"/>
<text text-anchor="middle" x="913.5" y="-17558.16" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="913.5" y="-17547.16" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="913.5" y="-17536.16" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="913.5" y="-17525.16" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu2 -->
<g id="edge279" class="edge">
<title>layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu2</title>
<path fill="none" stroke="black" d="M1044.63,-17606.04C1022.71,-17595.86 994.45,-17582.74 969.78,-17571.28"/>
<polygon fill="black" stroke="black" points="971.06,-17568.02 960.52,-17566.99 968.12,-17574.37 971.06,-17568.02"/>
</g>
<!-- layer_3_mlp_fc2_gpu3 -->
<g id="node170" class="node">
<title>layer_3_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1072.5,-17570.16 978.5,-17570.16 978.5,-17518.16 1072.5,-17518.16 1072.5,-17570.16"/>
<text text-anchor="middle" x="1025.5" y="-17558.16" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="1025.5" y="-17547.16" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1025.5" y="-17536.16" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1025.5" y="-17525.16" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu3 -->
<g id="edge280" class="edge">
<title>layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu3</title>
<path fill="none" stroke="black" d="M1069.07,-17605.84C1063.35,-17597.87 1056.35,-17588.13 1049.65,-17578.8"/>
<polygon fill="black" stroke="black" points="1052.31,-17576.49 1043.63,-17570.41 1046.62,-17580.58 1052.31,-17576.49"/>
</g>
<!-- layer_3_mlp_fc2_gpu4 -->
<g id="node171" class="node">
<title>layer_3_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1184.5,-17570.16 1090.5,-17570.16 1090.5,-17518.16 1184.5,-17518.16 1184.5,-17570.16"/>
<text text-anchor="middle" x="1137.5" y="-17558.16" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="1137.5" y="-17547.16" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1137.5" y="-17536.16" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1137.5" y="-17525.16" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu4 -->
<g id="edge281" class="edge">
<title>layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu4</title>
<path fill="none" stroke="black" d="M1093.93,-17605.84C1099.65,-17597.87 1106.65,-17588.13 1113.35,-17578.8"/>
<polygon fill="black" stroke="black" points="1116.38,-17580.58 1119.37,-17570.41 1110.69,-17576.49 1116.38,-17580.58"/>
</g>
<!-- layer_3_mlp_fc2_gpu5 -->
<g id="node172" class="node">
<title>layer_3_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1296.5,-17570.16 1202.5,-17570.16 1202.5,-17518.16 1296.5,-17518.16 1296.5,-17570.16"/>
<text text-anchor="middle" x="1249.5" y="-17558.16" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="1249.5" y="-17547.16" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1249.5" y="-17536.16" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1249.5" y="-17525.16" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu5 -->
<g id="edge282" class="edge">
<title>layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu5</title>
<path fill="none" stroke="black" d="M1118.37,-17606.04C1140.29,-17595.86 1168.55,-17582.74 1193.22,-17571.28"/>
<polygon fill="black" stroke="black" points="1194.88,-17574.37 1202.48,-17566.99 1191.94,-17568.02 1194.88,-17574.37"/>
</g>
<!-- layer_3_mlp_fc2_gpu6 -->
<g id="node173" class="node">
<title>layer_3_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1408.5,-17570.16 1314.5,-17570.16 1314.5,-17518.16 1408.5,-17518.16 1408.5,-17570.16"/>
<text text-anchor="middle" x="1361.5" y="-17558.16" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="1361.5" y="-17547.16" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1361.5" y="-17536.16" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1361.5" y="-17525.16" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu6 -->
<g id="edge283" class="edge">
<title>layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu6</title>
<path fill="none" stroke="black" d="M1126.39,-17615.11C1169.98,-17606.73 1237.99,-17592.15 1304.58,-17570.22"/>
<polygon fill="black" stroke="black" points="1306.02,-17573.43 1314.39,-17566.93 1303.8,-17566.79 1306.02,-17573.43"/>
</g>
<!-- layer_3_mlp_fc2_gpu7 -->
<g id="node174" class="node">
<title>layer_3_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1520.5,-17570.16 1426.5,-17570.16 1426.5,-17518.16 1520.5,-17518.16 1520.5,-17570.16"/>
<text text-anchor="middle" x="1473.5" y="-17558.16" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="1473.5" y="-17547.16" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1473.5" y="-17536.16" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1473.5" y="-17525.16" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu7 -->
<g id="edge284" class="edge">
<title>layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu7</title>
<path fill="none" stroke="black" d="M1126.08,-17619.88C1189.31,-17614.42 1308.48,-17601.13 1416.71,-17570.06"/>
<polygon fill="black" stroke="black" points="1417.86,-17573.37 1426.48,-17567.2 1415.9,-17566.65 1417.86,-17573.37"/>
</g>
<!-- layer_3_allreduce_mlp -->
<g id="node175" class="node">
<title>layer_3_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="1137.5" cy="-17453.16" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="1137.5" y="-17461.66" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1137.5" y="-17450.66" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="1137.5" y="-17439.66" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_3_mlp_fc2_gpu0&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge285" class="edge">
<title>layer_3_mlp_fc2_gpu0&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M736.53,-17521.13C739.54,-17520.05 742.54,-17519.04 745.5,-17518.16 855.66,-17485.18 988.65,-17468.01 1067.97,-17460.05"/>
<polygon fill="black" stroke="black" points="1068.71,-17463.49 1078.32,-17459.03 1068.03,-17456.53 1068.71,-17463.49"/>
</g>
<!-- layer_3_mlp_fc2_gpu1&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge286" class="edge">
<title>layer_3_mlp_fc2_gpu1&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M848.6,-17521.35C851.59,-17520.21 854.57,-17519.13 857.5,-17518.16 929.11,-17494.24 1013.96,-17476.23 1071.34,-17465.51"/>
<polygon fill="black" stroke="black" points="1072.17,-17468.91 1081.37,-17463.65 1070.9,-17462.03 1072.17,-17468.91"/>
</g>
<!-- layer_3_mlp_fc2_gpu2&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge287" class="edge">
<title>layer_3_mlp_fc2_gpu2&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M960.78,-17521.83C963.72,-17520.57 966.65,-17519.33 969.5,-17518.16 1006.39,-17502.91 1048.34,-17486.93 1081.1,-17474.75"/>
<polygon fill="black" stroke="black" points="1082.35,-17478.02 1090.51,-17471.26 1079.92,-17471.45 1082.35,-17478.02"/>
</g>
<!-- layer_3_mlp_fc2_gpu3&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge288" class="edge">
<title>layer_3_mlp_fc2_gpu3&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1057,-17518.13C1070.09,-17507.73 1085.4,-17495.56 1099.14,-17484.65"/>
<polygon fill="black" stroke="black" points="1101.36,-17487.35 1107.01,-17478.39 1097.01,-17481.87 1101.36,-17487.35"/>
</g>
<!-- layer_3_mlp_fc2_gpu4&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge289" class="edge">
<title>layer_3_mlp_fc2_gpu4&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1137.5,-17517.89C1137.5,-17510 1137.5,-17501.11 1137.5,-17492.53"/>
<polygon fill="black" stroke="black" points="1141,-17492.31 1137.5,-17482.31 1134,-17492.31 1141,-17492.31"/>
</g>
<!-- layer_3_mlp_fc2_gpu5&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge290" class="edge">
<title>layer_3_mlp_fc2_gpu5&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1218,-17518.13C1204.91,-17507.73 1189.6,-17495.56 1175.86,-17484.65"/>
<polygon fill="black" stroke="black" points="1177.99,-17481.87 1167.99,-17478.39 1173.64,-17487.35 1177.99,-17481.87"/>
</g>
<!-- layer_3_mlp_fc2_gpu6&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge291" class="edge">
<title>layer_3_mlp_fc2_gpu6&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1314.22,-17521.83C1311.28,-17520.57 1308.35,-17519.33 1305.5,-17518.16 1268.61,-17502.91 1226.66,-17486.93 1193.9,-17474.75"/>
<polygon fill="black" stroke="black" points="1195.08,-17471.45 1184.49,-17471.26 1192.65,-17478.02 1195.08,-17471.45"/>
</g>
<!-- layer_3_mlp_fc2_gpu7&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge292" class="edge">
<title>layer_3_mlp_fc2_gpu7&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1426.4,-17521.35C1423.41,-17520.21 1420.43,-17519.13 1417.5,-17518.16 1345.89,-17494.24 1261.04,-17476.23 1203.66,-17465.51"/>
<polygon fill="black" stroke="black" points="1204.1,-17462.03 1193.63,-17463.65 1202.83,-17468.91 1204.1,-17462.03"/>
</g>
<!-- layer_3_allreduce_mlp&#45;&gt;layer_3_residual2 -->
<g id="edge293" class="edge">
<title>layer_3_allreduce_mlp&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M1180.47,-17432.67C1210.5,-17419.05 1250.96,-17400.7 1283.93,-17385.74"/>
<polygon fill="black" stroke="black" points="1285.8,-17388.73 1293.46,-17381.42 1282.91,-17382.36 1285.8,-17388.73"/>
</g>
<!-- layer_3_ln2 -->
<g id="node177" class="node">
<title>layer_3_ln2</title>
<polygon fill="lightblue" stroke="black" points="1379,-17292.17 1306,-17292.17 1306,-17251.17 1379,-17251.17 1379,-17292.17"/>
<text text-anchor="middle" x="1342.5" y="-17280.17" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1342.5" y="-17269.17" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="1342.5" y="-17258.17" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_3_residual2&#45;&gt;layer_3_ln2 -->
<g id="edge295" class="edge">
<title>layer_3_residual2&#45;&gt;layer_3_ln2</title>
<path fill="none" stroke="black" d="M1342.5,-17328.09C1342.5,-17319.77 1342.5,-17310.68 1342.5,-17302.33"/>
<polygon fill="black" stroke="black" points="1346,-17302.24 1342.5,-17292.24 1339,-17302.24 1346,-17302.24"/>
</g>
<!-- layer_3_output_dist -->
<g id="node178" class="node">
<title>layer_3_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="1444.2,-17215.17 1282.42,-17215.17 1240.8,-17155.17 1402.58,-17155.17 1444.2,-17215.17"/>
<text text-anchor="middle" x="1342.5" y="-17188.17" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1342.5" y="-17177.17" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_3_ln2&#45;&gt;layer_3_output_dist -->
<g id="edge296" class="edge">
<title>layer_3_ln2&#45;&gt;layer_3_output_dist</title>
<path fill="none" stroke="black" d="M1342.5,-17251.07C1342.5,-17243.43 1342.5,-17234.39 1342.5,-17225.52"/>
<polygon fill="black" stroke="black" points="1346,-17225.28 1342.5,-17215.28 1339,-17225.28 1346,-17225.28"/>
</g>
<!-- layer_4_input_dist -->
<g id="node179" class="node">
<title>layer_4_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="1436.69,-17119.17 1286.86,-17119.17 1248.31,-17059.17 1398.14,-17059.17 1436.69,-17119.17"/>
<text text-anchor="middle" x="1342.5" y="-17092.17" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1342.5" y="-17081.17" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_3_output_dist&#45;&gt;layer_4_input_dist -->
<g id="edge297" class="edge">
<title>layer_3_output_dist&#45;&gt;layer_4_input_dist</title>
<path fill="none" stroke="black" d="M1342.5,-17154.95C1342.5,-17146.9 1342.5,-17138.04 1342.5,-17129.52"/>
<polygon fill="black" stroke="black" points="1346,-17129.38 1342.5,-17119.38 1339,-17129.38 1346,-17129.38"/>
</g>
<!-- layer_4_qkv_gpu0 -->
<g id="node180" class="node">
<title>layer_4_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="945,-17023.17 852,-17023.17 852,-16971.17 945,-16971.17 945,-17023.17"/>
<text text-anchor="middle" x="898.5" y="-17011.17" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="898.5" y="-17000.17" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="898.5" y="-16989.17" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="898.5" y="-16978.17" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu0 -->
<g id="edge298" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1262,-17080.71C1184.82,-17072.2 1065.31,-17055.46 954.86,-17022.95"/>
<polygon fill="black" stroke="black" points="955.81,-17019.58 945.22,-17020.07 953.8,-17026.29 955.81,-17019.58"/>
</g>
<!-- layer_4_qkv_gpu1 -->
<g id="node181" class="node">
<title>layer_4_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1056,-17023.17 963,-17023.17 963,-16971.17 1056,-16971.17 1056,-17023.17"/>
<text text-anchor="middle" x="1009.5" y="-17011.17" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="1009.5" y="-17000.17" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1009.5" y="-16989.17" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1009.5" y="-16978.17" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu1 -->
<g id="edge299" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1256.78,-17072.43C1203.93,-17061.7 1134.87,-17045.86 1066.01,-17023.1"/>
<polygon fill="black" stroke="black" points="1066.89,-17019.7 1056.3,-17019.84 1064.66,-17026.34 1066.89,-17019.7"/>
</g>
<!-- layer_4_qkv_gpu2 -->
<g id="node182" class="node">
<title>layer_4_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1167,-17023.17 1074,-17023.17 1074,-16971.17 1167,-16971.17 1167,-17023.17"/>
<text text-anchor="middle" x="1120.5" y="-17011.17" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="1120.5" y="-17000.17" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1120.5" y="-16989.17" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1120.5" y="-16978.17" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu2 -->
<g id="edge300" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1266.17,-17059.14C1237.89,-17048.16 1205.62,-17035.37 1176.5,-17023.17 1176.4,-17023.13 1176.31,-17023.09 1176.21,-17023.05"/>
<polygon fill="black" stroke="black" points="1177.75,-17019.9 1167.18,-17019.21 1175.01,-17026.34 1177.75,-17019.9"/>
</g>
<!-- layer_4_qkv_gpu3 -->
<g id="node183" class="node">
<title>layer_4_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1278,-17023.17 1185,-17023.17 1185,-16971.17 1278,-16971.17 1278,-17023.17"/>
<text text-anchor="middle" x="1231.5" y="-17011.17" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="1231.5" y="-17000.17" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1231.5" y="-16989.17" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1231.5" y="-16978.17" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu3 -->
<g id="edge301" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1306.46,-17058.95C1294.94,-17049.61 1282.14,-17039.23 1270.42,-17029.73"/>
<polygon fill="black" stroke="black" points="1272.48,-17026.9 1262.51,-17023.32 1268.08,-17032.33 1272.48,-17026.9"/>
</g>
<!-- layer_4_qkv_gpu4 -->
<g id="node184" class="node">
<title>layer_4_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1389,-17023.17 1296,-17023.17 1296,-16971.17 1389,-16971.17 1389,-17023.17"/>
<text text-anchor="middle" x="1342.5" y="-17011.17" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="1342.5" y="-17000.17" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1342.5" y="-16989.17" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1342.5" y="-16978.17" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu4 -->
<g id="edge302" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1342.5,-17058.7C1342.5,-17050.63 1342.5,-17041.79 1342.5,-17033.43"/>
<polygon fill="black" stroke="black" points="1346,-17033.18 1342.5,-17023.18 1339,-17033.18 1346,-17033.18"/>
</g>
<!-- layer_4_qkv_gpu5 -->
<g id="node185" class="node">
<title>layer_4_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1500,-17023.17 1407,-17023.17 1407,-16971.17 1500,-16971.17 1500,-17023.17"/>
<text text-anchor="middle" x="1453.5" y="-17011.17" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="1453.5" y="-17000.17" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1453.5" y="-16989.17" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1453.5" y="-16978.17" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu5 -->
<g id="edge303" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1378.54,-17058.95C1390.06,-17049.61 1402.86,-17039.23 1414.58,-17029.73"/>
<polygon fill="black" stroke="black" points="1416.92,-17032.33 1422.49,-17023.32 1412.52,-17026.9 1416.92,-17032.33"/>
</g>
<!-- layer_4_qkv_gpu6 -->
<g id="node186" class="node">
<title>layer_4_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1611,-17023.17 1518,-17023.17 1518,-16971.17 1611,-16971.17 1611,-17023.17"/>
<text text-anchor="middle" x="1564.5" y="-17011.17" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="1564.5" y="-17000.17" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1564.5" y="-16989.17" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1564.5" y="-16978.17" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu6 -->
<g id="edge304" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1402.73,-17065.66C1432.33,-17054.37 1468.68,-17040.2 1508.42,-17023.56"/>
<polygon fill="black" stroke="black" points="1509.91,-17026.73 1517.77,-17019.63 1507.2,-17020.28 1509.91,-17026.73"/>
</g>
<!-- layer_4_qkv_gpu7 -->
<g id="node187" class="node">
<title>layer_4_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1722,-17023.17 1629,-17023.17 1629,-16971.17 1722,-16971.17 1722,-17023.17"/>
<text text-anchor="middle" x="1675.5" y="-17011.17" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="1675.5" y="-17000.17" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1675.5" y="-16989.17" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1675.5" y="-16978.17" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu7 -->
<g id="edge305" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1409.25,-17076.4C1463.88,-17065.9 1543.07,-17048.7 1619.2,-17023.38"/>
<polygon fill="black" stroke="black" points="1620.59,-17026.6 1628.95,-17020.09 1618.35,-17019.97 1620.59,-17026.6"/>
</g>
<!-- layer_4_residual1 -->
<g id="node199" class="node">
<title>layer_4_residual1</title>
<polygon fill="lightyellow" stroke="black" points="1632.44,-16571.21 1510.05,-16571.21 1478.56,-16511.21 1600.95,-16511.21 1632.44,-16571.21"/>
<text text-anchor="middle" x="1555.5" y="-16544.21" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1555.5" y="-16533.21" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_residual1 -->
<g id="edge332" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_residual1</title>
<path fill="none" stroke="black" d="M1415.59,-17085.83C1515.77,-17081.02 1688.3,-17066.51 1731.5,-17023.17 1768.38,-16986.17 1750.5,-16959.42 1750.5,-16907.18 1750.5,-16907.18 1750.5,-16907.18 1750.5,-16726.19 1750.5,-16657.41 1685.52,-16606.73 1630.59,-16576.17"/>
<polygon fill="black" stroke="black" points="1631.98,-16572.95 1621.52,-16571.26 1628.64,-16579.1 1631.98,-16572.95"/>
</g>
<!-- layer_4_allgather_qkv -->
<g id="node188" class="node">
<title>layer_4_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="1298.5" cy="-16906.18" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="1298.5" y="-16914.68" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1298.5" y="-16903.68" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="1298.5" y="-16892.68" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_4_qkv_gpu0&#45;&gt;layer_4_allgather_qkv -->
<g id="edge306" class="edge">
<title>layer_4_qkv_gpu0&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M945.24,-16974.34C948.35,-16973.19 951.45,-16972.12 954.5,-16971.17 1049.17,-16941.69 1162.96,-16923.79 1233.01,-16914.69"/>
<polygon fill="black" stroke="black" points="1233.54,-16918.15 1243.02,-16913.41 1232.65,-16911.2 1233.54,-16918.15"/>
</g>
<!-- layer_4_qkv_gpu1&#45;&gt;layer_4_allgather_qkv -->
<g id="edge307" class="edge">
<title>layer_4_qkv_gpu1&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M1056.03,-16974.76C1059.22,-16973.5 1062.39,-16972.29 1065.5,-16971.17 1122.65,-16950.7 1189.64,-16932.93 1237.08,-16921.34"/>
<polygon fill="black" stroke="black" points="1238,-16924.72 1246.9,-16918.96 1236.36,-16917.92 1238,-16924.72"/>
</g>
<!-- layer_4_qkv_gpu2&#45;&gt;layer_4_allgather_qkv -->
<g id="edge308" class="edge">
<title>layer_4_qkv_gpu2&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M1167.27,-16972.79C1192.59,-16960.13 1223.84,-16944.51 1249.5,-16931.68"/>
<polygon fill="black" stroke="black" points="1251.3,-16934.69 1258.68,-16927.09 1248.17,-16928.43 1251.3,-16934.69"/>
</g>
<!-- layer_4_qkv_gpu3&#45;&gt;layer_4_allgather_qkv -->
<g id="edge309" class="edge">
<title>layer_4_qkv_gpu3&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M1250.52,-16970.91C1257.41,-16961.76 1265.32,-16951.26 1272.69,-16941.46"/>
<polygon fill="black" stroke="black" points="1275.51,-16943.53 1278.73,-16933.44 1269.92,-16939.32 1275.51,-16943.53"/>
</g>
<!-- layer_4_qkv_gpu4&#45;&gt;layer_4_allgather_qkv -->
<g id="edge310" class="edge">
<title>layer_4_qkv_gpu4&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M1330.01,-16970.91C1325.78,-16962.35 1320.97,-16952.62 1316.4,-16943.39"/>
<polygon fill="black" stroke="black" points="1319.52,-16941.79 1311.95,-16934.38 1313.24,-16944.89 1319.52,-16941.79"/>
</g>
<!-- layer_4_qkv_gpu5&#45;&gt;layer_4_allgather_qkv -->
<g id="edge311" class="edge">
<title>layer_4_qkv_gpu5&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M1409.91,-16971.15C1389.48,-16959.41 1365.12,-16945.43 1344.4,-16933.54"/>
<polygon fill="black" stroke="black" points="1345.88,-16930.35 1335.47,-16928.41 1342.4,-16936.42 1345.88,-16930.35"/>
</g>
<!-- layer_4_qkv_gpu6&#45;&gt;layer_4_allgather_qkv -->
<g id="edge312" class="edge">
<title>layer_4_qkv_gpu6&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M1517.87,-16974.47C1515.05,-16973.32 1512.25,-16972.21 1509.5,-16971.17 1459.32,-16952.25 1400.88,-16934.88 1358.24,-16923.02"/>
<polygon fill="black" stroke="black" points="1359.15,-16919.64 1348.57,-16920.35 1357.28,-16926.39 1359.15,-16919.64"/>
</g>
<!-- layer_4_qkv_gpu7&#45;&gt;layer_4_allgather_qkv -->
<g id="edge313" class="edge">
<title>layer_4_qkv_gpu7&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M1628.98,-16974.15C1626.14,-16973.07 1623.3,-16972.07 1620.5,-16971.17 1533.72,-16943.24 1429.69,-16925.23 1363.83,-16915.65"/>
<polygon fill="black" stroke="black" points="1363.99,-16912.14 1353.6,-16914.19 1363,-16919.07 1363.99,-16912.14"/>
</g>
<!-- layer_4_attention -->
<g id="node189" class="node">
<title>layer_4_attention</title>
<polygon fill="lightblue" stroke="black" points="1332.5,-16841.19 1264.5,-16841.19 1264.5,-16789.19 1332.5,-16789.19 1332.5,-16841.19"/>
<text text-anchor="middle" x="1298.5" y="-16829.19" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1298.5" y="-16818.19" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1298.5" y="-16807.19" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="1298.5" y="-16796.19" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_4_allgather_qkv&#45;&gt;layer_4_attention -->
<g id="edge314" class="edge">
<title>layer_4_allgather_qkv&#45;&gt;layer_4_attention</title>
<path fill="none" stroke="black" d="M1298.5,-16877.02C1298.5,-16868.91 1298.5,-16859.96 1298.5,-16851.48"/>
<polygon fill="black" stroke="black" points="1302,-16851.45 1298.5,-16841.45 1295,-16851.45 1302,-16851.45"/>
</g>
<!-- layer_4_attn_out_gpu0 -->
<g id="node190" class="node">
<title>layer_4_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="980.5,-16753.19 892.5,-16753.19 892.5,-16701.19 980.5,-16701.19 980.5,-16753.19"/>
<text text-anchor="middle" x="936.5" y="-16741.19" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="936.5" y="-16730.19" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="936.5" y="-16719.19" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="936.5" y="-16708.19" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attention&#45;&gt;layer_4_attn_out_gpu0 -->
<g id="edge315" class="edge">
<title>layer_4_attention&#45;&gt;layer_4_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M1264.43,-16810.25C1208.48,-16803.18 1093.85,-16786.21 990.37,-16753.15"/>
<polygon fill="black" stroke="black" points="991.3,-16749.78 980.71,-16750.01 989.13,-16756.43 991.3,-16749.78"/>
</g>
<!-- layer_4_attn_out_gpu1 -->
<g id="node191" class="node">
<title>layer_4_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1086.5,-16753.19 998.5,-16753.19 998.5,-16701.19 1086.5,-16701.19 1086.5,-16753.19"/>
<text text-anchor="middle" x="1042.5" y="-16741.19" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="1042.5" y="-16730.19" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1042.5" y="-16719.19" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1042.5" y="-16708.19" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attention&#45;&gt;layer_4_attn_out_gpu1 -->
<g id="edge316" class="edge">
<title>layer_4_attention&#45;&gt;layer_4_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M1264.22,-16805.56C1225.35,-16795.41 1160.05,-16777.27 1095.97,-16753.16"/>
<polygon fill="black" stroke="black" points="1097.12,-16749.85 1086.53,-16749.56 1094.63,-16756.39 1097.12,-16749.85"/>
</g>
<!-- layer_4_attn_out_gpu2 -->
<g id="node192" class="node">
<title>layer_4_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1192.5,-16753.19 1104.5,-16753.19 1104.5,-16701.19 1192.5,-16701.19 1192.5,-16753.19"/>
<text text-anchor="middle" x="1148.5" y="-16741.19" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="1148.5" y="-16730.19" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1148.5" y="-16719.19" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1148.5" y="-16708.19" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attention&#45;&gt;layer_4_attn_out_gpu2 -->
<g id="edge317" class="edge">
<title>layer_4_attention&#45;&gt;layer_4_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M1264.46,-16794.67C1245.78,-16783.96 1222.21,-16770.45 1201.2,-16758.41"/>
<polygon fill="black" stroke="black" points="1202.8,-16755.28 1192.38,-16753.35 1199.31,-16761.36 1202.8,-16755.28"/>
</g>
<!-- layer_4_attn_out_gpu3 -->
<g id="node193" class="node">
<title>layer_4_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1298.5,-16753.19 1210.5,-16753.19 1210.5,-16701.19 1298.5,-16701.19 1298.5,-16753.19"/>
<text text-anchor="middle" x="1254.5" y="-16741.19" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="1254.5" y="-16730.19" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1254.5" y="-16719.19" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1254.5" y="-16708.19" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attention&#45;&gt;layer_4_attn_out_gpu3 -->
<g id="edge318" class="edge">
<title>layer_4_attention&#45;&gt;layer_4_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M1285.54,-16788.85C1281.28,-16780.54 1276.49,-16771.17 1271.96,-16762.31"/>
<polygon fill="black" stroke="black" points="1275.04,-16760.65 1267.37,-16753.35 1268.81,-16763.84 1275.04,-16760.65"/>
</g>
<!-- layer_4_attn_out_gpu4 -->
<g id="node194" class="node">
<title>layer_4_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1404.5,-16753.19 1316.5,-16753.19 1316.5,-16701.19 1404.5,-16701.19 1404.5,-16753.19"/>
<text text-anchor="middle" x="1360.5" y="-16741.19" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="1360.5" y="-16730.19" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1360.5" y="-16719.19" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1360.5" y="-16708.19" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attention&#45;&gt;layer_4_attn_out_gpu4 -->
<g id="edge319" class="edge">
<title>layer_4_attention&#45;&gt;layer_4_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M1316.77,-16788.85C1322.95,-16780.28 1329.95,-16770.57 1336.5,-16761.48"/>
<polygon fill="black" stroke="black" points="1339.35,-16763.5 1342.36,-16753.35 1333.68,-16759.41 1339.35,-16763.5"/>
</g>
<!-- layer_4_attn_out_gpu5 -->
<g id="node195" class="node">
<title>layer_4_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1510.5,-16753.19 1422.5,-16753.19 1422.5,-16701.19 1510.5,-16701.19 1510.5,-16753.19"/>
<text text-anchor="middle" x="1466.5" y="-16741.19" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="1466.5" y="-16730.19" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1466.5" y="-16719.19" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1466.5" y="-16708.19" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attention&#45;&gt;layer_4_attn_out_gpu5 -->
<g id="edge320" class="edge">
<title>layer_4_attention&#45;&gt;layer_4_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M1332.9,-16796.58C1356,-16784.75 1386.9,-16768.94 1413.16,-16755.49"/>
<polygon fill="black" stroke="black" points="1414.93,-16758.52 1422.24,-16750.85 1411.74,-16752.29 1414.93,-16758.52"/>
</g>
<!-- layer_4_attn_out_gpu6 -->
<g id="node196" class="node">
<title>layer_4_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1616.5,-16753.19 1528.5,-16753.19 1528.5,-16701.19 1616.5,-16701.19 1616.5,-16753.19"/>
<text text-anchor="middle" x="1572.5" y="-16741.19" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="1572.5" y="-16730.19" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1572.5" y="-16719.19" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1572.5" y="-16708.19" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attention&#45;&gt;layer_4_attn_out_gpu6 -->
<g id="edge321" class="edge">
<title>layer_4_attention&#45;&gt;layer_4_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M1332.77,-16806.66C1374.82,-16797 1448.28,-16778.78 1518.99,-16753.14"/>
<polygon fill="black" stroke="black" points="1520.32,-16756.38 1528.5,-16749.64 1517.9,-16749.81 1520.32,-16756.38"/>
</g>
<!-- layer_4_attn_out_gpu7 -->
<g id="node197" class="node">
<title>layer_4_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1722.5,-16753.19 1634.5,-16753.19 1634.5,-16701.19 1722.5,-16701.19 1722.5,-16753.19"/>
<text text-anchor="middle" x="1678.5" y="-16741.19" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="1678.5" y="-16730.19" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1678.5" y="-16719.19" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1678.5" y="-16708.19" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attention&#45;&gt;layer_4_attn_out_gpu7 -->
<g id="edge322" class="edge">
<title>layer_4_attention&#45;&gt;layer_4_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M1332.63,-16810.74C1391.2,-16804.2 1514.4,-16787.72 1624.69,-16753.12"/>
<polygon fill="black" stroke="black" points="1625.84,-16756.42 1634.3,-16750.05 1623.71,-16749.76 1625.84,-16756.42"/>
</g>
<!-- layer_4_allreduce_attn -->
<g id="node198" class="node">
<title>layer_4_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="1360.5" cy="-16636.2" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="1360.5" y="-16644.7" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1360.5" y="-16633.7" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="1360.5" y="-16622.7" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_4_attn_out_gpu0&#45;&gt;layer_4_allreduce_attn -->
<g id="edge323" class="edge">
<title>layer_4_attn_out_gpu0&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M980.68,-16704.29C983.63,-16703.16 986.59,-16702.11 989.5,-16701.19 1092.93,-16668.54 1218.16,-16651.33 1293.47,-16643.26"/>
<polygon fill="black" stroke="black" points="1294.17,-16646.71 1303.75,-16642.18 1293.44,-16639.75 1294.17,-16646.71"/>
</g>
<!-- layer_4_attn_out_gpu1&#45;&gt;layer_4_allreduce_attn -->
<g id="edge324" class="edge">
<title>layer_4_attn_out_gpu1&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M1086.76,-16704.51C1089.69,-16703.32 1092.62,-16702.2 1095.5,-16701.19 1162.63,-16677.53 1242.34,-16659.58 1296.69,-16648.8"/>
<polygon fill="black" stroke="black" points="1297.39,-16652.23 1306.53,-16646.88 1296.04,-16645.36 1297.39,-16652.23"/>
</g>
<!-- layer_4_attn_out_gpu2&#45;&gt;layer_4_allreduce_attn -->
<g id="edge325" class="edge">
<title>layer_4_attn_out_gpu2&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M1192.66,-16705.13C1195.64,-16703.77 1198.61,-16702.45 1201.5,-16701.19 1235.83,-16686.2 1274.84,-16670.48 1305.63,-16658.37"/>
<polygon fill="black" stroke="black" points="1307.29,-16661.48 1315.32,-16654.57 1304.73,-16654.96 1307.29,-16661.48"/>
</g>
<!-- layer_4_attn_out_gpu3&#45;&gt;layer_4_allreduce_attn -->
<g id="edge326" class="edge">
<title>layer_4_attn_out_gpu3&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M1284.31,-16701.16C1296.58,-16690.86 1310.92,-16678.82 1323.83,-16667.99"/>
<polygon fill="black" stroke="black" points="1326.24,-16670.53 1331.65,-16661.42 1321.74,-16665.17 1326.24,-16670.53"/>
</g>
<!-- layer_4_attn_out_gpu4&#45;&gt;layer_4_allreduce_attn -->
<g id="edge327" class="edge">
<title>layer_4_attn_out_gpu4&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M1360.5,-16700.93C1360.5,-16693.04 1360.5,-16684.14 1360.5,-16675.56"/>
<polygon fill="black" stroke="black" points="1364,-16675.34 1360.5,-16665.34 1357,-16675.34 1364,-16675.34"/>
</g>
<!-- layer_4_attn_out_gpu5&#45;&gt;layer_4_allreduce_attn -->
<g id="edge328" class="edge">
<title>layer_4_attn_out_gpu5&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M1436.69,-16701.16C1424.42,-16690.86 1410.08,-16678.82 1397.17,-16667.99"/>
<polygon fill="black" stroke="black" points="1399.26,-16665.17 1389.35,-16661.42 1394.76,-16670.53 1399.26,-16665.17"/>
</g>
<!-- layer_4_attn_out_gpu6&#45;&gt;layer_4_allreduce_attn -->
<g id="edge329" class="edge">
<title>layer_4_attn_out_gpu6&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M1528.34,-16705.13C1525.36,-16703.77 1522.39,-16702.45 1519.5,-16701.19 1485.17,-16686.2 1446.16,-16670.48 1415.37,-16658.37"/>
<polygon fill="black" stroke="black" points="1416.27,-16654.96 1405.68,-16654.57 1413.71,-16661.48 1416.27,-16654.96"/>
</g>
<!-- layer_4_attn_out_gpu7&#45;&gt;layer_4_allreduce_attn -->
<g id="edge330" class="edge">
<title>layer_4_attn_out_gpu7&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M1634.24,-16704.51C1631.31,-16703.32 1628.38,-16702.2 1625.5,-16701.19 1558.37,-16677.53 1478.66,-16659.58 1424.31,-16648.8"/>
<polygon fill="black" stroke="black" points="1424.96,-16645.36 1414.47,-16646.88 1423.61,-16652.23 1424.96,-16645.36"/>
</g>
<!-- layer_4_allreduce_attn&#45;&gt;layer_4_residual1 -->
<g id="edge331" class="edge">
<title>layer_4_allreduce_attn&#45;&gt;layer_4_residual1</title>
<path fill="none" stroke="black" d="M1401.85,-16615.48C1429.62,-16602.24 1466.59,-16584.61 1497.31,-16569.96"/>
<polygon fill="black" stroke="black" points="1499.1,-16572.98 1506.62,-16565.51 1496.09,-16566.66 1499.1,-16572.98"/>
</g>
<!-- layer_4_ln1 -->
<g id="node200" class="node">
<title>layer_4_ln1</title>
<polygon fill="lightblue" stroke="black" points="1387,-16475.21 1314,-16475.21 1314,-16434.21 1387,-16434.21 1387,-16475.21"/>
<text text-anchor="middle" x="1350.5" y="-16463.21" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1350.5" y="-16452.21" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="1350.5" y="-16441.21" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_4_residual1&#45;&gt;layer_4_ln1 -->
<g id="edge333" class="edge">
<title>layer_4_residual1&#45;&gt;layer_4_ln1</title>
<path fill="none" stroke="black" d="M1484.95,-16511.13C1455.66,-16499.05 1422.49,-16485.38 1396.43,-16474.64"/>
<polygon fill="black" stroke="black" points="1397.75,-16471.4 1387.17,-16470.82 1395.08,-16477.87 1397.75,-16471.4"/>
</g>
<!-- layer_4_residual2 -->
<g id="node220" class="node">
<title>layer_4_residual2</title>
<polygon fill="lightyellow" stroke="black" points="1632.44,-15962.24 1510.05,-15962.24 1478.56,-15902.24 1600.95,-15902.24 1632.44,-15962.24"/>
<text text-anchor="middle" x="1555.5" y="-15935.24" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1555.5" y="-15924.24" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_4_residual1&#45;&gt;layer_4_residual2 -->
<g id="edge368" class="edge">
<title>layer_4_residual1&#45;&gt;layer_4_residual2</title>
<path fill="none" stroke="black" d="M1607.48,-16523.64C1668.51,-16500.56 1761.5,-16452.4 1761.5,-16373.21 1761.5,-16373.21 1761.5,-16373.21 1761.5,-16117.22 1761.5,-16047.02 1694.11,-15996.93 1636.42,-15966.92"/>
<polygon fill="black" stroke="black" points="1637.76,-15963.68 1627.26,-15962.28 1634.6,-15969.92 1637.76,-15963.68"/>
</g>
<!-- layer_4_mlp_fc1_gpu0 -->
<g id="node201" class="node">
<title>layer_4_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="949.5,-16398.21 855.5,-16398.21 855.5,-16346.21 949.5,-16346.21 949.5,-16398.21"/>
<text text-anchor="middle" x="902.5" y="-16386.21" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="902.5" y="-16375.21" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="902.5" y="-16364.21" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="902.5" y="-16353.21" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu0 -->
<g id="edge334" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M1313.85,-16451.93C1245.28,-16447.88 1093.17,-16435.45 959.13,-16398.04"/>
<polygon fill="black" stroke="black" points="960.08,-16394.67 949.51,-16395.3 958.17,-16401.41 960.08,-16394.67"/>
</g>
<!-- layer_4_mlp_fc1_gpu1 -->
<g id="node202" class="node">
<title>layer_4_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1061.5,-16398.21 967.5,-16398.21 967.5,-16346.21 1061.5,-16346.21 1061.5,-16398.21"/>
<text text-anchor="middle" x="1014.5" y="-16386.21" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="1014.5" y="-16375.21" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1014.5" y="-16364.21" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1014.5" y="-16353.21" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu1 -->
<g id="edge335" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M1313.6,-16449.08C1261.26,-16441.94 1162.55,-16426.34 1071.23,-16398.15"/>
<polygon fill="black" stroke="black" points="1072.16,-16394.77 1061.57,-16395.11 1070.05,-16401.45 1072.16,-16394.77"/>
</g>
<!-- layer_4_mlp_fc1_gpu2 -->
<g id="node203" class="node">
<title>layer_4_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1173.5,-16398.21 1079.5,-16398.21 1079.5,-16346.21 1173.5,-16346.21 1173.5,-16398.21"/>
<text text-anchor="middle" x="1126.5" y="-16386.21" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="1126.5" y="-16375.21" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1126.5" y="-16364.21" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1126.5" y="-16353.21" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu2 -->
<g id="edge336" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M1313.75,-16442.74C1281.47,-16432.84 1233.12,-16417.4 1183.08,-16398.3"/>
<polygon fill="black" stroke="black" points="1184.3,-16395.02 1173.72,-16394.69 1181.79,-16401.55 1184.3,-16395.02"/>
</g>
<!-- layer_4_mlp_fc1_gpu3 -->
<g id="node204" class="node">
<title>layer_4_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1285.5,-16398.21 1191.5,-16398.21 1191.5,-16346.21 1285.5,-16346.21 1285.5,-16398.21"/>
<text text-anchor="middle" x="1238.5" y="-16386.21" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="1238.5" y="-16375.21" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1238.5" y="-16364.21" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1238.5" y="-16353.21" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu3 -->
<g id="edge337" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M1323.1,-16434.01C1310.77,-16425.15 1295.9,-16414.46 1282.09,-16404.54"/>
<polygon fill="black" stroke="black" points="1283.83,-16401.48 1273.67,-16398.48 1279.74,-16407.16 1283.83,-16401.48"/>
</g>
<!-- layer_4_mlp_fc1_gpu4 -->
<g id="node205" class="node">
<title>layer_4_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1397.5,-16398.21 1303.5,-16398.21 1303.5,-16346.21 1397.5,-16346.21 1397.5,-16398.21"/>
<text text-anchor="middle" x="1350.5" y="-16386.21" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="1350.5" y="-16375.21" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1350.5" y="-16364.21" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1350.5" y="-16353.21" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu4 -->
<g id="edge338" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M1350.5,-16433.81C1350.5,-16426.19 1350.5,-16417.26 1350.5,-16408.63"/>
<polygon fill="black" stroke="black" points="1354,-16408.36 1350.5,-16398.36 1347,-16408.36 1354,-16408.36"/>
</g>
<!-- layer_4_mlp_fc1_gpu5 -->
<g id="node206" class="node">
<title>layer_4_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1509.5,-16398.21 1415.5,-16398.21 1415.5,-16346.21 1509.5,-16346.21 1509.5,-16398.21"/>
<text text-anchor="middle" x="1462.5" y="-16386.21" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="1462.5" y="-16375.21" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1462.5" y="-16364.21" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1462.5" y="-16353.21" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu5 -->
<g id="edge339" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M1377.9,-16434.01C1390.23,-16425.15 1405.1,-16414.46 1418.91,-16404.54"/>
<polygon fill="black" stroke="black" points="1421.26,-16407.16 1427.33,-16398.48 1417.17,-16401.48 1421.26,-16407.16"/>
</g>
<!-- layer_4_mlp_fc1_gpu6 -->
<g id="node207" class="node">
<title>layer_4_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1621.5,-16398.21 1527.5,-16398.21 1527.5,-16346.21 1621.5,-16346.21 1621.5,-16398.21"/>
<text text-anchor="middle" x="1574.5" y="-16386.21" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="1574.5" y="-16375.21" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1574.5" y="-16364.21" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1574.5" y="-16353.21" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu6 -->
<g id="edge340" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M1387.25,-16442.74C1419.53,-16432.84 1467.88,-16417.4 1517.92,-16398.3"/>
<polygon fill="black" stroke="black" points="1519.21,-16401.55 1527.28,-16394.69 1516.7,-16395.02 1519.21,-16401.55"/>
</g>
<!-- layer_4_mlp_fc1_gpu7 -->
<g id="node208" class="node">
<title>layer_4_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1733.5,-16398.21 1639.5,-16398.21 1639.5,-16346.21 1733.5,-16346.21 1733.5,-16398.21"/>
<text text-anchor="middle" x="1686.5" y="-16386.21" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="1686.5" y="-16375.21" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1686.5" y="-16364.21" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1686.5" y="-16353.21" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu7 -->
<g id="edge341" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M1387.4,-16449.08C1439.74,-16441.94 1538.45,-16426.34 1629.77,-16398.15"/>
<polygon fill="black" stroke="black" points="1630.95,-16401.45 1639.43,-16395.11 1628.84,-16394.77 1630.95,-16401.45"/>
</g>
<!-- layer_4_allgather_mlp -->
<g id="node209" class="node">
<title>layer_4_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="1294.5" cy="-16281.22" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="1294.5" y="-16289.72" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1294.5" y="-16278.72" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="1294.5" y="-16267.72" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_4_mlp_fc1_gpu0&#45;&gt;layer_4_allgather_mlp -->
<g id="edge342" class="edge">
<title>layer_4_mlp_fc1_gpu0&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M949.56,-16349.28C952.56,-16348.17 955.55,-16347.13 958.5,-16346.21 1050.52,-16317.33 1161.02,-16299.34 1229.51,-16290.04"/>
<polygon fill="black" stroke="black" points="1230.27,-16293.47 1239.72,-16288.68 1229.34,-16286.53 1230.27,-16293.47"/>
</g>
<!-- layer_4_mlp_fc1_gpu1&#45;&gt;layer_4_allgather_mlp -->
<g id="edge343" class="edge">
<title>layer_4_mlp_fc1_gpu1&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M1061.66,-16349.59C1064.64,-16348.4 1067.6,-16347.26 1070.5,-16346.21 1125.03,-16326.36 1188.79,-16308.66 1234.32,-16296.93"/>
<polygon fill="black" stroke="black" points="1235.21,-16300.32 1244.03,-16294.45 1233.47,-16293.54 1235.21,-16300.32"/>
</g>
<!-- layer_4_mlp_fc1_gpu2&#45;&gt;layer_4_allgather_mlp -->
<g id="edge344" class="edge">
<title>layer_4_mlp_fc1_gpu2&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M1173.74,-16346.18C1196.71,-16334.02 1224.23,-16319.44 1247.2,-16307.27"/>
<polygon fill="black" stroke="black" points="1248.89,-16310.34 1256.09,-16302.56 1245.61,-16304.15 1248.89,-16310.34"/>
</g>
<!-- layer_4_mlp_fc1_gpu3&#45;&gt;layer_4_allgather_mlp -->
<g id="edge345" class="edge">
<title>layer_4_mlp_fc1_gpu3&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M1254.4,-16345.94C1259.94,-16337.13 1266.27,-16327.07 1272.24,-16317.59"/>
<polygon fill="black" stroke="black" points="1275.22,-16319.42 1277.58,-16309.1 1269.3,-16315.7 1275.22,-16319.42"/>
</g>
<!-- layer_4_mlp_fc1_gpu4&#45;&gt;layer_4_allgather_mlp -->
<g id="edge346" class="edge">
<title>layer_4_mlp_fc1_gpu4&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M1334.6,-16345.94C1329.06,-16337.13 1322.73,-16327.07 1316.76,-16317.59"/>
<polygon fill="black" stroke="black" points="1319.7,-16315.7 1311.42,-16309.1 1313.78,-16319.42 1319.7,-16315.7"/>
</g>
<!-- layer_4_mlp_fc1_gpu5&#45;&gt;layer_4_allgather_mlp -->
<g id="edge347" class="edge">
<title>layer_4_mlp_fc1_gpu5&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M1415.26,-16346.18C1392.29,-16334.02 1364.77,-16319.44 1341.8,-16307.27"/>
<polygon fill="black" stroke="black" points="1343.39,-16304.15 1332.91,-16302.56 1340.11,-16310.34 1343.39,-16304.15"/>
</g>
<!-- layer_4_mlp_fc1_gpu6&#45;&gt;layer_4_allgather_mlp -->
<g id="edge348" class="edge">
<title>layer_4_mlp_fc1_gpu6&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M1527.34,-16349.59C1524.36,-16348.4 1521.4,-16347.26 1518.5,-16346.21 1463.97,-16326.36 1400.21,-16308.66 1354.68,-16296.93"/>
<polygon fill="black" stroke="black" points="1355.53,-16293.54 1344.97,-16294.45 1353.79,-16300.32 1355.53,-16293.54"/>
</g>
<!-- layer_4_mlp_fc1_gpu7&#45;&gt;layer_4_allgather_mlp -->
<g id="edge349" class="edge">
<title>layer_4_mlp_fc1_gpu7&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M1639.44,-16349.28C1636.44,-16348.17 1633.45,-16347.13 1630.5,-16346.21 1538.48,-16317.33 1427.98,-16299.34 1359.49,-16290.04"/>
<polygon fill="black" stroke="black" points="1359.66,-16286.53 1349.28,-16288.68 1358.73,-16293.47 1359.66,-16286.53"/>
</g>
<!-- layer_4_gelu -->
<g id="node210" class="node">
<title>layer_4_gelu</title>
<polygon fill="lightblue" stroke="black" points="1339,-16216.22 1250,-16216.22 1250,-16180.22 1339,-16180.22 1339,-16216.22"/>
<text text-anchor="middle" x="1294.5" y="-16201.22" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1294.5" y="-16190.22" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_4_allgather_mlp&#45;&gt;layer_4_gelu -->
<g id="edge350" class="edge">
<title>layer_4_allgather_mlp&#45;&gt;layer_4_gelu</title>
<path fill="none" stroke="black" d="M1294.5,-16251.89C1294.5,-16243.64 1294.5,-16234.65 1294.5,-16226.47"/>
<polygon fill="black" stroke="black" points="1298,-16226.32 1294.5,-16216.32 1291,-16226.32 1298,-16226.32"/>
</g>
<!-- layer_4_mlp_fc2_gpu0 -->
<g id="node211" class="node">
<title>layer_4_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="949.5,-16144.22 855.5,-16144.22 855.5,-16092.22 949.5,-16092.22 949.5,-16144.22"/>
<text text-anchor="middle" x="902.5" y="-16132.22" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="902.5" y="-16121.22" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="902.5" y="-16110.22" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="902.5" y="-16099.22" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu0 -->
<g id="edge351" class="edge">
<title>layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu0</title>
<path fill="none" stroke="black" d="M1249.92,-16193.95C1186.69,-16188.49 1067.52,-16175.2 959.29,-16144.13"/>
<polygon fill="black" stroke="black" points="960.1,-16140.72 949.52,-16141.26 958.14,-16147.44 960.1,-16140.72"/>
</g>
<!-- layer_4_mlp_fc2_gpu1 -->
<g id="node212" class="node">
<title>layer_4_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1061.5,-16144.22 967.5,-16144.22 967.5,-16092.22 1061.5,-16092.22 1061.5,-16144.22"/>
<text text-anchor="middle" x="1014.5" y="-16132.22" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="1014.5" y="-16121.22" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1014.5" y="-16110.22" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1014.5" y="-16099.22" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu1 -->
<g id="edge352" class="edge">
<title>layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu1</title>
<path fill="none" stroke="black" d="M1249.61,-16189.18C1206.02,-16180.8 1138.01,-16166.22 1071.42,-16144.29"/>
<polygon fill="black" stroke="black" points="1072.2,-16140.86 1061.61,-16141 1069.98,-16147.5 1072.2,-16140.86"/>
</g>
<!-- layer_4_mlp_fc2_gpu2 -->
<g id="node213" class="node">
<title>layer_4_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1173.5,-16144.22 1079.5,-16144.22 1079.5,-16092.22 1173.5,-16092.22 1173.5,-16144.22"/>
<text text-anchor="middle" x="1126.5" y="-16132.22" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="1126.5" y="-16121.22" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1126.5" y="-16110.22" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1126.5" y="-16099.22" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu2 -->
<g id="edge353" class="edge">
<title>layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu2</title>
<path fill="none" stroke="black" d="M1257.63,-16180.11C1235.71,-16169.93 1207.45,-16156.81 1182.78,-16145.35"/>
<polygon fill="black" stroke="black" points="1184.06,-16142.09 1173.52,-16141.06 1181.12,-16148.44 1184.06,-16142.09"/>
</g>
<!-- layer_4_mlp_fc2_gpu3 -->
<g id="node214" class="node">
<title>layer_4_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1285.5,-16144.22 1191.5,-16144.22 1191.5,-16092.22 1285.5,-16092.22 1285.5,-16144.22"/>
<text text-anchor="middle" x="1238.5" y="-16132.22" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="1238.5" y="-16121.22" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1238.5" y="-16110.22" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1238.5" y="-16099.22" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu3 -->
<g id="edge354" class="edge">
<title>layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu3</title>
<path fill="none" stroke="black" d="M1282.07,-16179.91C1276.35,-16171.94 1269.35,-16162.2 1262.65,-16152.87"/>
<polygon fill="black" stroke="black" points="1265.31,-16150.56 1256.63,-16144.48 1259.62,-16154.65 1265.31,-16150.56"/>
</g>
<!-- layer_4_mlp_fc2_gpu4 -->
<g id="node215" class="node">
<title>layer_4_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1397.5,-16144.22 1303.5,-16144.22 1303.5,-16092.22 1397.5,-16092.22 1397.5,-16144.22"/>
<text text-anchor="middle" x="1350.5" y="-16132.22" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="1350.5" y="-16121.22" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1350.5" y="-16110.22" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1350.5" y="-16099.22" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu4 -->
<g id="edge355" class="edge">
<title>layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu4</title>
<path fill="none" stroke="black" d="M1306.93,-16179.91C1312.65,-16171.94 1319.65,-16162.2 1326.35,-16152.87"/>
<polygon fill="black" stroke="black" points="1329.38,-16154.65 1332.37,-16144.48 1323.69,-16150.56 1329.38,-16154.65"/>
</g>
<!-- layer_4_mlp_fc2_gpu5 -->
<g id="node216" class="node">
<title>layer_4_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1509.5,-16144.22 1415.5,-16144.22 1415.5,-16092.22 1509.5,-16092.22 1509.5,-16144.22"/>
<text text-anchor="middle" x="1462.5" y="-16132.22" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="1462.5" y="-16121.22" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1462.5" y="-16110.22" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1462.5" y="-16099.22" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu5 -->
<g id="edge356" class="edge">
<title>layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu5</title>
<path fill="none" stroke="black" d="M1331.37,-16180.11C1353.29,-16169.93 1381.55,-16156.81 1406.22,-16145.35"/>
<polygon fill="black" stroke="black" points="1407.88,-16148.44 1415.48,-16141.06 1404.94,-16142.09 1407.88,-16148.44"/>
</g>
<!-- layer_4_mlp_fc2_gpu6 -->
<g id="node217" class="node">
<title>layer_4_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1621.5,-16144.22 1527.5,-16144.22 1527.5,-16092.22 1621.5,-16092.22 1621.5,-16144.22"/>
<text text-anchor="middle" x="1574.5" y="-16132.22" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="1574.5" y="-16121.22" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1574.5" y="-16110.22" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1574.5" y="-16099.22" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu6 -->
<g id="edge357" class="edge">
<title>layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu6</title>
<path fill="none" stroke="black" d="M1339.39,-16189.18C1382.98,-16180.8 1450.99,-16166.22 1517.58,-16144.29"/>
<polygon fill="black" stroke="black" points="1519.02,-16147.5 1527.39,-16141 1516.8,-16140.86 1519.02,-16147.5"/>
</g>
<!-- layer_4_mlp_fc2_gpu7 -->
<g id="node218" class="node">
<title>layer_4_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1733.5,-16144.22 1639.5,-16144.22 1639.5,-16092.22 1733.5,-16092.22 1733.5,-16144.22"/>
<text text-anchor="middle" x="1686.5" y="-16132.22" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="1686.5" y="-16121.22" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1686.5" y="-16110.22" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1686.5" y="-16099.22" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu7 -->
<g id="edge358" class="edge">
<title>layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu7</title>
<path fill="none" stroke="black" d="M1339.08,-16193.95C1402.31,-16188.49 1521.48,-16175.2 1629.71,-16144.13"/>
<polygon fill="black" stroke="black" points="1630.86,-16147.44 1639.48,-16141.26 1628.9,-16140.72 1630.86,-16147.44"/>
</g>
<!-- layer_4_allreduce_mlp -->
<g id="node219" class="node">
<title>layer_4_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="1350.5" cy="-16027.23" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="1350.5" y="-16035.73" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1350.5" y="-16024.73" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="1350.5" y="-16013.73" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_4_mlp_fc2_gpu0&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge359" class="edge">
<title>layer_4_mlp_fc2_gpu0&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M949.53,-16095.2C952.54,-16094.12 955.54,-16093.11 958.5,-16092.22 1068.66,-16059.25 1201.65,-16042.08 1280.97,-16034.12"/>
<polygon fill="black" stroke="black" points="1281.71,-16037.56 1291.32,-16033.1 1281.03,-16030.6 1281.71,-16037.56"/>
</g>
<!-- layer_4_mlp_fc2_gpu1&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge360" class="edge">
<title>layer_4_mlp_fc2_gpu1&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1061.6,-16095.42C1064.59,-16094.28 1067.57,-16093.2 1070.5,-16092.22 1142.11,-16068.31 1226.96,-16050.3 1284.34,-16039.57"/>
<polygon fill="black" stroke="black" points="1285.17,-16042.98 1294.37,-16037.72 1283.9,-16036.1 1285.17,-16042.98"/>
</g>
<!-- layer_4_mlp_fc2_gpu2&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge361" class="edge">
<title>layer_4_mlp_fc2_gpu2&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1173.78,-16095.9C1176.72,-16094.64 1179.65,-16093.4 1182.5,-16092.22 1219.39,-16076.98 1261.34,-16061 1294.1,-16048.82"/>
<polygon fill="black" stroke="black" points="1295.35,-16052.09 1303.51,-16045.33 1292.92,-16045.52 1295.35,-16052.09"/>
</g>
<!-- layer_4_mlp_fc2_gpu3&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge362" class="edge">
<title>layer_4_mlp_fc2_gpu3&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1270,-16092.2C1283.09,-16081.8 1298.4,-16069.63 1312.14,-16058.72"/>
<polygon fill="black" stroke="black" points="1314.36,-16061.42 1320.01,-16052.46 1310.01,-16055.94 1314.36,-16061.42"/>
</g>
<!-- layer_4_mlp_fc2_gpu4&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge363" class="edge">
<title>layer_4_mlp_fc2_gpu4&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1350.5,-16091.96C1350.5,-16084.07 1350.5,-16075.18 1350.5,-16066.6"/>
<polygon fill="black" stroke="black" points="1354,-16066.37 1350.5,-16056.37 1347,-16066.37 1354,-16066.37"/>
</g>
<!-- layer_4_mlp_fc2_gpu5&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge364" class="edge">
<title>layer_4_mlp_fc2_gpu5&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1431,-16092.2C1417.91,-16081.8 1402.6,-16069.63 1388.86,-16058.72"/>
<polygon fill="black" stroke="black" points="1390.99,-16055.94 1380.99,-16052.46 1386.64,-16061.42 1390.99,-16055.94"/>
</g>
<!-- layer_4_mlp_fc2_gpu6&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge365" class="edge">
<title>layer_4_mlp_fc2_gpu6&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1527.22,-16095.9C1524.28,-16094.64 1521.35,-16093.4 1518.5,-16092.22 1481.61,-16076.98 1439.66,-16061 1406.9,-16048.82"/>
<polygon fill="black" stroke="black" points="1408.08,-16045.52 1397.49,-16045.33 1405.65,-16052.09 1408.08,-16045.52"/>
</g>
<!-- layer_4_mlp_fc2_gpu7&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge366" class="edge">
<title>layer_4_mlp_fc2_gpu7&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1639.4,-16095.42C1636.41,-16094.28 1633.43,-16093.2 1630.5,-16092.22 1558.89,-16068.31 1474.04,-16050.3 1416.66,-16039.57"/>
<polygon fill="black" stroke="black" points="1417.1,-16036.1 1406.63,-16037.72 1415.83,-16042.98 1417.1,-16036.1"/>
</g>
<!-- layer_4_allreduce_mlp&#45;&gt;layer_4_residual2 -->
<g id="edge367" class="edge">
<title>layer_4_allreduce_mlp&#45;&gt;layer_4_residual2</title>
<path fill="none" stroke="black" d="M1393.47,-16006.74C1423.5,-15993.12 1463.96,-15974.77 1496.93,-15959.81"/>
<polygon fill="black" stroke="black" points="1498.8,-15962.8 1506.46,-15955.49 1495.91,-15956.43 1498.8,-15962.8"/>
</g>
<!-- layer_4_ln2 -->
<g id="node221" class="node">
<title>layer_4_ln2</title>
<polygon fill="lightblue" stroke="black" points="1592,-15866.24 1519,-15866.24 1519,-15825.24 1592,-15825.24 1592,-15866.24"/>
<text text-anchor="middle" x="1555.5" y="-15854.24" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1555.5" y="-15843.24" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="1555.5" y="-15832.24" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_4_residual2&#45;&gt;layer_4_ln2 -->
<g id="edge369" class="edge">
<title>layer_4_residual2&#45;&gt;layer_4_ln2</title>
<path fill="none" stroke="black" d="M1555.5,-15902.16C1555.5,-15893.84 1555.5,-15884.75 1555.5,-15876.4"/>
<polygon fill="black" stroke="black" points="1559,-15876.31 1555.5,-15866.31 1552,-15876.31 1559,-15876.31"/>
</g>
<!-- layer_4_output_dist -->
<g id="node222" class="node">
<title>layer_4_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="1657.2,-15789.24 1495.42,-15789.24 1453.8,-15729.24 1615.58,-15729.24 1657.2,-15789.24"/>
<text text-anchor="middle" x="1555.5" y="-15762.24" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1555.5" y="-15751.24" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_4_ln2&#45;&gt;layer_4_output_dist -->
<g id="edge370" class="edge">
<title>layer_4_ln2&#45;&gt;layer_4_output_dist</title>
<path fill="none" stroke="black" d="M1555.5,-15825.14C1555.5,-15817.5 1555.5,-15808.46 1555.5,-15799.59"/>
<polygon fill="black" stroke="black" points="1559,-15799.35 1555.5,-15789.35 1552,-15799.35 1559,-15799.35"/>
</g>
<!-- layer_5_input_dist -->
<g id="node223" class="node">
<title>layer_5_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="1649.69,-15693.24 1499.86,-15693.24 1461.31,-15633.24 1611.14,-15633.24 1649.69,-15693.24"/>
<text text-anchor="middle" x="1555.5" y="-15666.24" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1555.5" y="-15655.24" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_4_output_dist&#45;&gt;layer_5_input_dist -->
<g id="edge371" class="edge">
<title>layer_4_output_dist&#45;&gt;layer_5_input_dist</title>
<path fill="none" stroke="black" d="M1555.5,-15729.01C1555.5,-15720.97 1555.5,-15712.11 1555.5,-15703.59"/>
<polygon fill="black" stroke="black" points="1559,-15703.45 1555.5,-15693.45 1552,-15703.45 1559,-15703.45"/>
</g>
<!-- layer_5_qkv_gpu0 -->
<g id="node224" class="node">
<title>layer_5_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1158,-15597.24 1065,-15597.24 1065,-15545.24 1158,-15545.24 1158,-15597.24"/>
<text text-anchor="middle" x="1111.5" y="-15585.24" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="1111.5" y="-15574.24" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1111.5" y="-15563.24" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1111.5" y="-15552.24" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu0 -->
<g id="edge372" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1475,-15654.78C1397.82,-15646.27 1278.31,-15629.53 1167.86,-15597.02"/>
<polygon fill="black" stroke="black" points="1168.81,-15593.65 1158.22,-15594.14 1166.8,-15600.36 1168.81,-15593.65"/>
</g>
<!-- layer_5_qkv_gpu1 -->
<g id="node225" class="node">
<title>layer_5_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1269,-15597.24 1176,-15597.24 1176,-15545.24 1269,-15545.24 1269,-15597.24"/>
<text text-anchor="middle" x="1222.5" y="-15585.24" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="1222.5" y="-15574.24" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1222.5" y="-15563.24" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1222.5" y="-15552.24" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu1 -->
<g id="edge373" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1469.78,-15646.5C1416.93,-15635.77 1347.87,-15619.93 1279.01,-15597.16"/>
<polygon fill="black" stroke="black" points="1279.89,-15593.77 1269.3,-15593.91 1277.66,-15600.4 1279.89,-15593.77"/>
</g>
<!-- layer_5_qkv_gpu2 -->
<g id="node226" class="node">
<title>layer_5_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1380,-15597.24 1287,-15597.24 1287,-15545.24 1380,-15545.24 1380,-15597.24"/>
<text text-anchor="middle" x="1333.5" y="-15585.24" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="1333.5" y="-15574.24" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1333.5" y="-15563.24" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1333.5" y="-15552.24" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu2 -->
<g id="edge374" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1479.17,-15633.21C1450.89,-15622.23 1418.62,-15609.43 1389.5,-15597.24 1389.4,-15597.2 1389.31,-15597.16 1389.21,-15597.12"/>
<polygon fill="black" stroke="black" points="1390.75,-15593.97 1380.18,-15593.28 1388.01,-15600.41 1390.75,-15593.97"/>
</g>
<!-- layer_5_qkv_gpu3 -->
<g id="node227" class="node">
<title>layer_5_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1491,-15597.24 1398,-15597.24 1398,-15545.24 1491,-15545.24 1491,-15597.24"/>
<text text-anchor="middle" x="1444.5" y="-15585.24" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="1444.5" y="-15574.24" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1444.5" y="-15563.24" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1444.5" y="-15552.24" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu3 -->
<g id="edge375" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1519.46,-15633.02C1507.94,-15623.68 1495.14,-15613.3 1483.42,-15603.8"/>
<polygon fill="black" stroke="black" points="1485.48,-15600.97 1475.51,-15597.39 1481.08,-15606.4 1485.48,-15600.97"/>
</g>
<!-- layer_5_qkv_gpu4 -->
<g id="node228" class="node">
<title>layer_5_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1602,-15597.24 1509,-15597.24 1509,-15545.24 1602,-15545.24 1602,-15597.24"/>
<text text-anchor="middle" x="1555.5" y="-15585.24" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="1555.5" y="-15574.24" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1555.5" y="-15563.24" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1555.5" y="-15552.24" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu4 -->
<g id="edge376" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1555.5,-15632.77C1555.5,-15624.7 1555.5,-15615.86 1555.5,-15607.5"/>
<polygon fill="black" stroke="black" points="1559,-15607.25 1555.5,-15597.25 1552,-15607.25 1559,-15607.25"/>
</g>
<!-- layer_5_qkv_gpu5 -->
<g id="node229" class="node">
<title>layer_5_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1713,-15597.24 1620,-15597.24 1620,-15545.24 1713,-15545.24 1713,-15597.24"/>
<text text-anchor="middle" x="1666.5" y="-15585.24" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="1666.5" y="-15574.24" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1666.5" y="-15563.24" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1666.5" y="-15552.24" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu5 -->
<g id="edge377" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1591.54,-15633.02C1603.06,-15623.68 1615.86,-15613.3 1627.58,-15603.8"/>
<polygon fill="black" stroke="black" points="1629.92,-15606.4 1635.49,-15597.39 1625.52,-15600.97 1629.92,-15606.4"/>
</g>
<!-- layer_5_qkv_gpu6 -->
<g id="node230" class="node">
<title>layer_5_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1824,-15597.24 1731,-15597.24 1731,-15545.24 1824,-15545.24 1824,-15597.24"/>
<text text-anchor="middle" x="1777.5" y="-15585.24" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="1777.5" y="-15574.24" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1777.5" y="-15563.24" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1777.5" y="-15552.24" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu6 -->
<g id="edge378" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1615.73,-15639.72C1645.33,-15628.44 1681.68,-15614.27 1721.42,-15597.63"/>
<polygon fill="black" stroke="black" points="1722.91,-15600.8 1730.77,-15593.7 1720.2,-15594.35 1722.91,-15600.8"/>
</g>
<!-- layer_5_qkv_gpu7 -->
<g id="node231" class="node">
<title>layer_5_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1935,-15597.24 1842,-15597.24 1842,-15545.24 1935,-15545.24 1935,-15597.24"/>
<text text-anchor="middle" x="1888.5" y="-15585.24" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="1888.5" y="-15574.24" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1888.5" y="-15563.24" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1888.5" y="-15552.24" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu7 -->
<g id="edge379" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1622.25,-15650.47C1676.88,-15639.97 1756.07,-15622.77 1832.2,-15597.45"/>
<polygon fill="black" stroke="black" points="1833.59,-15600.67 1841.95,-15594.16 1831.35,-15594.04 1833.59,-15600.67"/>
</g>
<!-- layer_5_residual1 -->
<g id="node243" class="node">
<title>layer_5_residual1</title>
<polygon fill="lightyellow" stroke="black" points="1845.44,-15145.28 1723.05,-15145.28 1691.56,-15085.28 1813.95,-15085.28 1845.44,-15145.28"/>
<text text-anchor="middle" x="1768.5" y="-15118.28" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1768.5" y="-15107.28" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_residual1 -->
<g id="edge406" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_residual1</title>
<path fill="none" stroke="black" d="M1628.59,-15659.9C1728.77,-15655.09 1901.3,-15640.58 1944.5,-15597.24 1981.38,-15560.24 1963.5,-15533.49 1963.5,-15481.25 1963.5,-15481.25 1963.5,-15481.25 1963.5,-15300.26 1963.5,-15231.48 1898.52,-15180.8 1843.59,-15150.24"/>
<polygon fill="black" stroke="black" points="1844.98,-15147.01 1834.52,-15145.33 1841.64,-15153.17 1844.98,-15147.01"/>
</g>
<!-- layer_5_allgather_qkv -->
<g id="node232" class="node">
<title>layer_5_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="1511.5" cy="-15480.25" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="1511.5" y="-15488.75" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1511.5" y="-15477.75" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="1511.5" y="-15466.75" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_5_qkv_gpu0&#45;&gt;layer_5_allgather_qkv -->
<g id="edge380" class="edge">
<title>layer_5_qkv_gpu0&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M1158.24,-15548.41C1161.35,-15547.26 1164.45,-15546.19 1167.5,-15545.24 1262.17,-15515.76 1375.96,-15497.86 1446.01,-15488.76"/>
<polygon fill="black" stroke="black" points="1446.54,-15492.22 1456.02,-15487.48 1445.65,-15485.27 1446.54,-15492.22"/>
</g>
<!-- layer_5_qkv_gpu1&#45;&gt;layer_5_allgather_qkv -->
<g id="edge381" class="edge">
<title>layer_5_qkv_gpu1&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M1269.03,-15548.83C1272.22,-15547.56 1275.39,-15546.35 1278.5,-15545.24 1335.65,-15524.77 1402.64,-15507 1450.08,-15495.41"/>
<polygon fill="black" stroke="black" points="1451,-15498.79 1459.9,-15493.03 1449.36,-15491.99 1451,-15498.79"/>
</g>
<!-- layer_5_qkv_gpu2&#45;&gt;layer_5_allgather_qkv -->
<g id="edge382" class="edge">
<title>layer_5_qkv_gpu2&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M1380.27,-15546.86C1405.59,-15534.2 1436.84,-15518.57 1462.5,-15505.75"/>
<polygon fill="black" stroke="black" points="1464.3,-15508.76 1471.68,-15501.16 1461.17,-15502.5 1464.3,-15508.76"/>
</g>
<!-- layer_5_qkv_gpu3&#45;&gt;layer_5_allgather_qkv -->
<g id="edge383" class="edge">
<title>layer_5_qkv_gpu3&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M1463.52,-15544.98C1470.41,-15535.82 1478.32,-15525.33 1485.69,-15515.53"/>
<polygon fill="black" stroke="black" points="1488.51,-15517.6 1491.73,-15507.51 1482.92,-15513.39 1488.51,-15517.6"/>
</g>
<!-- layer_5_qkv_gpu4&#45;&gt;layer_5_allgather_qkv -->
<g id="edge384" class="edge">
<title>layer_5_qkv_gpu4&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M1543.01,-15544.98C1538.78,-15536.42 1533.97,-15526.69 1529.4,-15517.46"/>
<polygon fill="black" stroke="black" points="1532.52,-15515.86 1524.95,-15508.45 1526.24,-15518.96 1532.52,-15515.86"/>
</g>
<!-- layer_5_qkv_gpu5&#45;&gt;layer_5_allgather_qkv -->
<g id="edge385" class="edge">
<title>layer_5_qkv_gpu5&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M1622.91,-15545.22C1602.48,-15533.48 1578.12,-15519.5 1557.4,-15507.6"/>
<polygon fill="black" stroke="black" points="1558.88,-15504.42 1548.47,-15502.47 1555.4,-15510.49 1558.88,-15504.42"/>
</g>
<!-- layer_5_qkv_gpu6&#45;&gt;layer_5_allgather_qkv -->
<g id="edge386" class="edge">
<title>layer_5_qkv_gpu6&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M1730.87,-15548.54C1728.05,-15547.39 1725.25,-15546.28 1722.5,-15545.24 1672.32,-15526.32 1613.88,-15508.95 1571.24,-15497.09"/>
<polygon fill="black" stroke="black" points="1572.15,-15493.71 1561.57,-15494.42 1570.28,-15500.46 1572.15,-15493.71"/>
</g>
<!-- layer_5_qkv_gpu7&#45;&gt;layer_5_allgather_qkv -->
<g id="edge387" class="edge">
<title>layer_5_qkv_gpu7&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M1841.98,-15548.21C1839.14,-15547.14 1836.3,-15546.14 1833.5,-15545.24 1746.72,-15517.31 1642.69,-15499.3 1576.83,-15489.72"/>
<polygon fill="black" stroke="black" points="1576.99,-15486.21 1566.6,-15488.25 1576,-15493.14 1576.99,-15486.21"/>
</g>
<!-- layer_5_attention -->
<g id="node233" class="node">
<title>layer_5_attention</title>
<polygon fill="lightblue" stroke="black" points="1545.5,-15415.26 1477.5,-15415.26 1477.5,-15363.26 1545.5,-15363.26 1545.5,-15415.26"/>
<text text-anchor="middle" x="1511.5" y="-15403.26" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1511.5" y="-15392.26" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1511.5" y="-15381.26" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="1511.5" y="-15370.26" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_5_allgather_qkv&#45;&gt;layer_5_attention -->
<g id="edge388" class="edge">
<title>layer_5_allgather_qkv&#45;&gt;layer_5_attention</title>
<path fill="none" stroke="black" d="M1511.5,-15451.09C1511.5,-15442.98 1511.5,-15434.03 1511.5,-15425.55"/>
<polygon fill="black" stroke="black" points="1515,-15425.52 1511.5,-15415.52 1508,-15425.52 1515,-15425.52"/>
</g>
<!-- layer_5_attn_out_gpu0 -->
<g id="node234" class="node">
<title>layer_5_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1193.5,-15327.26 1105.5,-15327.26 1105.5,-15275.26 1193.5,-15275.26 1193.5,-15327.26"/>
<text text-anchor="middle" x="1149.5" y="-15315.26" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="1149.5" y="-15304.26" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1149.5" y="-15293.26" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1149.5" y="-15282.26" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attention&#45;&gt;layer_5_attn_out_gpu0 -->
<g id="edge389" class="edge">
<title>layer_5_attention&#45;&gt;layer_5_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M1477.43,-15384.32C1421.48,-15377.25 1306.85,-15360.28 1203.37,-15327.22"/>
<polygon fill="black" stroke="black" points="1204.3,-15323.85 1193.71,-15324.08 1202.13,-15330.5 1204.3,-15323.85"/>
</g>
<!-- layer_5_attn_out_gpu1 -->
<g id="node235" class="node">
<title>layer_5_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1299.5,-15327.26 1211.5,-15327.26 1211.5,-15275.26 1299.5,-15275.26 1299.5,-15327.26"/>
<text text-anchor="middle" x="1255.5" y="-15315.26" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="1255.5" y="-15304.26" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1255.5" y="-15293.26" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1255.5" y="-15282.26" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attention&#45;&gt;layer_5_attn_out_gpu1 -->
<g id="edge390" class="edge">
<title>layer_5_attention&#45;&gt;layer_5_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M1477.22,-15379.63C1438.35,-15369.48 1373.05,-15351.34 1308.97,-15327.23"/>
<polygon fill="black" stroke="black" points="1310.12,-15323.92 1299.53,-15323.63 1307.63,-15330.46 1310.12,-15323.92"/>
</g>
<!-- layer_5_attn_out_gpu2 -->
<g id="node236" class="node">
<title>layer_5_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1405.5,-15327.26 1317.5,-15327.26 1317.5,-15275.26 1405.5,-15275.26 1405.5,-15327.26"/>
<text text-anchor="middle" x="1361.5" y="-15315.26" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="1361.5" y="-15304.26" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1361.5" y="-15293.26" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1361.5" y="-15282.26" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attention&#45;&gt;layer_5_attn_out_gpu2 -->
<g id="edge391" class="edge">
<title>layer_5_attention&#45;&gt;layer_5_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M1477.46,-15368.74C1458.78,-15358.03 1435.21,-15344.52 1414.2,-15332.47"/>
<polygon fill="black" stroke="black" points="1415.8,-15329.35 1405.38,-15327.42 1412.31,-15335.43 1415.8,-15329.35"/>
</g>
<!-- layer_5_attn_out_gpu3 -->
<g id="node237" class="node">
<title>layer_5_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1511.5,-15327.26 1423.5,-15327.26 1423.5,-15275.26 1511.5,-15275.26 1511.5,-15327.26"/>
<text text-anchor="middle" x="1467.5" y="-15315.26" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="1467.5" y="-15304.26" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1467.5" y="-15293.26" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1467.5" y="-15282.26" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attention&#45;&gt;layer_5_attn_out_gpu3 -->
<g id="edge392" class="edge">
<title>layer_5_attention&#45;&gt;layer_5_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M1498.54,-15362.92C1494.28,-15354.61 1489.49,-15345.23 1484.96,-15336.38"/>
<polygon fill="black" stroke="black" points="1488.04,-15334.72 1480.37,-15327.42 1481.81,-15337.91 1488.04,-15334.72"/>
</g>
<!-- layer_5_attn_out_gpu4 -->
<g id="node238" class="node">
<title>layer_5_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1617.5,-15327.26 1529.5,-15327.26 1529.5,-15275.26 1617.5,-15275.26 1617.5,-15327.26"/>
<text text-anchor="middle" x="1573.5" y="-15315.26" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="1573.5" y="-15304.26" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1573.5" y="-15293.26" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1573.5" y="-15282.26" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attention&#45;&gt;layer_5_attn_out_gpu4 -->
<g id="edge393" class="edge">
<title>layer_5_attention&#45;&gt;layer_5_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M1529.77,-15362.92C1535.95,-15354.35 1542.95,-15344.64 1549.5,-15335.55"/>
<polygon fill="black" stroke="black" points="1552.35,-15337.57 1555.36,-15327.42 1546.68,-15333.48 1552.35,-15337.57"/>
</g>
<!-- layer_5_attn_out_gpu5 -->
<g id="node239" class="node">
<title>layer_5_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1723.5,-15327.26 1635.5,-15327.26 1635.5,-15275.26 1723.5,-15275.26 1723.5,-15327.26"/>
<text text-anchor="middle" x="1679.5" y="-15315.26" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="1679.5" y="-15304.26" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1679.5" y="-15293.26" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1679.5" y="-15282.26" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attention&#45;&gt;layer_5_attn_out_gpu5 -->
<g id="edge394" class="edge">
<title>layer_5_attention&#45;&gt;layer_5_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M1545.9,-15370.65C1569,-15358.82 1599.9,-15343.01 1626.16,-15329.56"/>
<polygon fill="black" stroke="black" points="1627.93,-15332.59 1635.24,-15324.92 1624.74,-15326.36 1627.93,-15332.59"/>
</g>
<!-- layer_5_attn_out_gpu6 -->
<g id="node240" class="node">
<title>layer_5_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1829.5,-15327.26 1741.5,-15327.26 1741.5,-15275.26 1829.5,-15275.26 1829.5,-15327.26"/>
<text text-anchor="middle" x="1785.5" y="-15315.26" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="1785.5" y="-15304.26" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1785.5" y="-15293.26" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1785.5" y="-15282.26" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attention&#45;&gt;layer_5_attn_out_gpu6 -->
<g id="edge395" class="edge">
<title>layer_5_attention&#45;&gt;layer_5_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M1545.77,-15380.73C1587.82,-15371.07 1661.28,-15352.85 1731.99,-15327.21"/>
<polygon fill="black" stroke="black" points="1733.32,-15330.45 1741.5,-15323.71 1730.9,-15323.88 1733.32,-15330.45"/>
</g>
<!-- layer_5_attn_out_gpu7 -->
<g id="node241" class="node">
<title>layer_5_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1935.5,-15327.26 1847.5,-15327.26 1847.5,-15275.26 1935.5,-15275.26 1935.5,-15327.26"/>
<text text-anchor="middle" x="1891.5" y="-15315.26" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="1891.5" y="-15304.26" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1891.5" y="-15293.26" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1891.5" y="-15282.26" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attention&#45;&gt;layer_5_attn_out_gpu7 -->
<g id="edge396" class="edge">
<title>layer_5_attention&#45;&gt;layer_5_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M1545.63,-15384.81C1604.2,-15378.27 1727.4,-15361.79 1837.69,-15327.19"/>
<polygon fill="black" stroke="black" points="1838.84,-15330.49 1847.3,-15324.11 1836.71,-15323.83 1838.84,-15330.49"/>
</g>
<!-- layer_5_allreduce_attn -->
<g id="node242" class="node">
<title>layer_5_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="1573.5" cy="-15210.27" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="1573.5" y="-15218.77" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1573.5" y="-15207.77" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="1573.5" y="-15196.77" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_5_attn_out_gpu0&#45;&gt;layer_5_allreduce_attn -->
<g id="edge397" class="edge">
<title>layer_5_attn_out_gpu0&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M1193.68,-15278.36C1196.63,-15277.22 1199.59,-15276.18 1202.5,-15275.26 1305.93,-15242.61 1431.16,-15225.4 1506.47,-15217.33"/>
<polygon fill="black" stroke="black" points="1507.17,-15220.78 1516.75,-15216.25 1506.44,-15213.81 1507.17,-15220.78"/>
</g>
<!-- layer_5_attn_out_gpu1&#45;&gt;layer_5_allreduce_attn -->
<g id="edge398" class="edge">
<title>layer_5_attn_out_gpu1&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M1299.76,-15278.58C1302.69,-15277.39 1305.62,-15276.27 1308.5,-15275.26 1375.63,-15251.6 1455.34,-15233.65 1509.69,-15222.87"/>
<polygon fill="black" stroke="black" points="1510.39,-15226.3 1519.53,-15220.94 1509.04,-15219.43 1510.39,-15226.3"/>
</g>
<!-- layer_5_attn_out_gpu2&#45;&gt;layer_5_allreduce_attn -->
<g id="edge399" class="edge">
<title>layer_5_attn_out_gpu2&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M1405.66,-15279.19C1408.64,-15277.84 1411.61,-15276.52 1414.5,-15275.26 1448.83,-15260.27 1487.84,-15244.55 1518.63,-15232.44"/>
<polygon fill="black" stroke="black" points="1520.29,-15235.55 1528.32,-15228.64 1517.73,-15229.03 1520.29,-15235.55"/>
</g>
<!-- layer_5_attn_out_gpu3&#45;&gt;layer_5_allreduce_attn -->
<g id="edge400" class="edge">
<title>layer_5_attn_out_gpu3&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M1497.31,-15275.23C1509.58,-15264.93 1523.92,-15252.89 1536.83,-15242.06"/>
<polygon fill="black" stroke="black" points="1539.24,-15244.6 1544.65,-15235.49 1534.74,-15239.24 1539.24,-15244.6"/>
</g>
<!-- layer_5_attn_out_gpu4&#45;&gt;layer_5_allreduce_attn -->
<g id="edge401" class="edge">
<title>layer_5_attn_out_gpu4&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M1573.5,-15275C1573.5,-15267.1 1573.5,-15258.21 1573.5,-15249.63"/>
<polygon fill="black" stroke="black" points="1577,-15249.41 1573.5,-15239.41 1570,-15249.41 1577,-15249.41"/>
</g>
<!-- layer_5_attn_out_gpu5&#45;&gt;layer_5_allreduce_attn -->
<g id="edge402" class="edge">
<title>layer_5_attn_out_gpu5&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M1649.69,-15275.23C1637.42,-15264.93 1623.08,-15252.89 1610.17,-15242.06"/>
<polygon fill="black" stroke="black" points="1612.26,-15239.24 1602.35,-15235.49 1607.76,-15244.6 1612.26,-15239.24"/>
</g>
<!-- layer_5_attn_out_gpu6&#45;&gt;layer_5_allreduce_attn -->
<g id="edge403" class="edge">
<title>layer_5_attn_out_gpu6&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M1741.34,-15279.19C1738.36,-15277.84 1735.39,-15276.52 1732.5,-15275.26 1698.17,-15260.27 1659.16,-15244.55 1628.37,-15232.44"/>
<polygon fill="black" stroke="black" points="1629.27,-15229.03 1618.68,-15228.64 1626.71,-15235.55 1629.27,-15229.03"/>
</g>
<!-- layer_5_attn_out_gpu7&#45;&gt;layer_5_allreduce_attn -->
<g id="edge404" class="edge">
<title>layer_5_attn_out_gpu7&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M1847.24,-15278.58C1844.31,-15277.39 1841.38,-15276.27 1838.5,-15275.26 1771.37,-15251.6 1691.66,-15233.65 1637.31,-15222.87"/>
<polygon fill="black" stroke="black" points="1637.96,-15219.43 1627.47,-15220.94 1636.61,-15226.3 1637.96,-15219.43"/>
</g>
<!-- layer_5_allreduce_attn&#45;&gt;layer_5_residual1 -->
<g id="edge405" class="edge">
<title>layer_5_allreduce_attn&#45;&gt;layer_5_residual1</title>
<path fill="none" stroke="black" d="M1614.85,-15189.55C1642.62,-15176.31 1679.59,-15158.68 1710.31,-15144.03"/>
<polygon fill="black" stroke="black" points="1712.1,-15147.05 1719.62,-15139.58 1709.09,-15140.73 1712.1,-15147.05"/>
</g>
<!-- layer_5_ln1 -->
<g id="node244" class="node">
<title>layer_5_ln1</title>
<polygon fill="lightblue" stroke="black" points="1600,-15049.28 1527,-15049.28 1527,-15008.28 1600,-15008.28 1600,-15049.28"/>
<text text-anchor="middle" x="1563.5" y="-15037.28" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1563.5" y="-15026.28" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="1563.5" y="-15015.28" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_5_residual1&#45;&gt;layer_5_ln1 -->
<g id="edge407" class="edge">
<title>layer_5_residual1&#45;&gt;layer_5_ln1</title>
<path fill="none" stroke="black" d="M1697.95,-15085.2C1668.66,-15073.12 1635.49,-15059.45 1609.43,-15048.71"/>
<polygon fill="black" stroke="black" points="1610.75,-15045.47 1600.17,-15044.89 1608.08,-15051.94 1610.75,-15045.47"/>
</g>
<!-- layer_5_residual2 -->
<g id="node264" class="node">
<title>layer_5_residual2</title>
<polygon fill="lightyellow" stroke="black" points="1845.44,-14536.31 1723.05,-14536.31 1691.56,-14476.31 1813.95,-14476.31 1845.44,-14536.31"/>
<text text-anchor="middle" x="1768.5" y="-14509.31" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1768.5" y="-14498.31" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_5_residual1&#45;&gt;layer_5_residual2 -->
<g id="edge442" class="edge">
<title>layer_5_residual1&#45;&gt;layer_5_residual2</title>
<path fill="none" stroke="black" d="M1820.48,-15097.71C1881.51,-15074.63 1974.5,-15026.46 1974.5,-14947.28 1974.5,-14947.28 1974.5,-14947.28 1974.5,-14691.29 1974.5,-14621.08 1907.11,-14571 1849.42,-14540.99"/>
<polygon fill="black" stroke="black" points="1850.76,-14537.75 1840.26,-14536.35 1847.6,-14543.99 1850.76,-14537.75"/>
</g>
<!-- layer_5_mlp_fc1_gpu0 -->
<g id="node245" class="node">
<title>layer_5_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1162.5,-14972.28 1068.5,-14972.28 1068.5,-14920.28 1162.5,-14920.28 1162.5,-14972.28"/>
<text text-anchor="middle" x="1115.5" y="-14960.28" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="1115.5" y="-14949.28" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1115.5" y="-14938.28" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1115.5" y="-14927.28" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu0 -->
<g id="edge408" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M1526.85,-15026C1458.28,-15021.94 1306.17,-15009.52 1172.13,-14972.11"/>
<polygon fill="black" stroke="black" points="1173.08,-14968.74 1162.51,-14969.37 1171.17,-14975.48 1173.08,-14968.74"/>
</g>
<!-- layer_5_mlp_fc1_gpu1 -->
<g id="node246" class="node">
<title>layer_5_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1274.5,-14972.28 1180.5,-14972.28 1180.5,-14920.28 1274.5,-14920.28 1274.5,-14972.28"/>
<text text-anchor="middle" x="1227.5" y="-14960.28" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="1227.5" y="-14949.28" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1227.5" y="-14938.28" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1227.5" y="-14927.28" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu1 -->
<g id="edge409" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M1526.6,-15023.15C1474.26,-15016.01 1375.55,-15000.41 1284.23,-14972.22"/>
<polygon fill="black" stroke="black" points="1285.16,-14968.84 1274.57,-14969.18 1283.05,-14975.52 1285.16,-14968.84"/>
</g>
<!-- layer_5_mlp_fc1_gpu2 -->
<g id="node247" class="node">
<title>layer_5_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1386.5,-14972.28 1292.5,-14972.28 1292.5,-14920.28 1386.5,-14920.28 1386.5,-14972.28"/>
<text text-anchor="middle" x="1339.5" y="-14960.28" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="1339.5" y="-14949.28" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1339.5" y="-14938.28" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1339.5" y="-14927.28" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu2 -->
<g id="edge410" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M1526.75,-15016.81C1494.47,-15006.91 1446.12,-14991.47 1396.08,-14972.37"/>
<polygon fill="black" stroke="black" points="1397.3,-14969.09 1386.72,-14968.76 1394.79,-14975.62 1397.3,-14969.09"/>
</g>
<!-- layer_5_mlp_fc1_gpu3 -->
<g id="node248" class="node">
<title>layer_5_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1498.5,-14972.28 1404.5,-14972.28 1404.5,-14920.28 1498.5,-14920.28 1498.5,-14972.28"/>
<text text-anchor="middle" x="1451.5" y="-14960.28" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="1451.5" y="-14949.28" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1451.5" y="-14938.28" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1451.5" y="-14927.28" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu3 -->
<g id="edge411" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M1536.1,-15008.08C1523.77,-14999.22 1508.9,-14988.53 1495.09,-14978.61"/>
<polygon fill="black" stroke="black" points="1496.83,-14975.55 1486.67,-14972.55 1492.74,-14981.23 1496.83,-14975.55"/>
</g>
<!-- layer_5_mlp_fc1_gpu4 -->
<g id="node249" class="node">
<title>layer_5_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1610.5,-14972.28 1516.5,-14972.28 1516.5,-14920.28 1610.5,-14920.28 1610.5,-14972.28"/>
<text text-anchor="middle" x="1563.5" y="-14960.28" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="1563.5" y="-14949.28" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1563.5" y="-14938.28" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1563.5" y="-14927.28" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu4 -->
<g id="edge412" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M1563.5,-15007.88C1563.5,-15000.26 1563.5,-14991.33 1563.5,-14982.7"/>
<polygon fill="black" stroke="black" points="1567,-14982.43 1563.5,-14972.43 1560,-14982.43 1567,-14982.43"/>
</g>
<!-- layer_5_mlp_fc1_gpu5 -->
<g id="node250" class="node">
<title>layer_5_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1722.5,-14972.28 1628.5,-14972.28 1628.5,-14920.28 1722.5,-14920.28 1722.5,-14972.28"/>
<text text-anchor="middle" x="1675.5" y="-14960.28" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="1675.5" y="-14949.28" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1675.5" y="-14938.28" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1675.5" y="-14927.28" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu5 -->
<g id="edge413" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M1590.9,-15008.08C1603.23,-14999.22 1618.1,-14988.53 1631.91,-14978.61"/>
<polygon fill="black" stroke="black" points="1634.26,-14981.23 1640.33,-14972.55 1630.17,-14975.55 1634.26,-14981.23"/>
</g>
<!-- layer_5_mlp_fc1_gpu6 -->
<g id="node251" class="node">
<title>layer_5_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1834.5,-14972.28 1740.5,-14972.28 1740.5,-14920.28 1834.5,-14920.28 1834.5,-14972.28"/>
<text text-anchor="middle" x="1787.5" y="-14960.28" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="1787.5" y="-14949.28" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1787.5" y="-14938.28" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1787.5" y="-14927.28" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu6 -->
<g id="edge414" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M1600.25,-15016.81C1632.53,-15006.91 1680.88,-14991.47 1730.92,-14972.37"/>
<polygon fill="black" stroke="black" points="1732.21,-14975.62 1740.28,-14968.76 1729.7,-14969.09 1732.21,-14975.62"/>
</g>
<!-- layer_5_mlp_fc1_gpu7 -->
<g id="node252" class="node">
<title>layer_5_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1946.5,-14972.28 1852.5,-14972.28 1852.5,-14920.28 1946.5,-14920.28 1946.5,-14972.28"/>
<text text-anchor="middle" x="1899.5" y="-14960.28" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="1899.5" y="-14949.28" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1899.5" y="-14938.28" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1899.5" y="-14927.28" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu7 -->
<g id="edge415" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M1600.4,-15023.15C1652.74,-15016.01 1751.45,-15000.41 1842.77,-14972.22"/>
<polygon fill="black" stroke="black" points="1843.95,-14975.52 1852.43,-14969.18 1841.84,-14968.84 1843.95,-14975.52"/>
</g>
<!-- layer_5_allgather_mlp -->
<g id="node253" class="node">
<title>layer_5_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="1507.5" cy="-14855.28" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="1507.5" y="-14863.78" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1507.5" y="-14852.78" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="1507.5" y="-14841.78" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_5_mlp_fc1_gpu0&#45;&gt;layer_5_allgather_mlp -->
<g id="edge416" class="edge">
<title>layer_5_mlp_fc1_gpu0&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M1162.56,-14923.35C1165.56,-14922.24 1168.55,-14921.2 1171.5,-14920.28 1263.52,-14891.4 1374.02,-14873.41 1442.51,-14864.11"/>
<polygon fill="black" stroke="black" points="1443.27,-14867.54 1452.72,-14862.75 1442.34,-14860.6 1443.27,-14867.54"/>
</g>
<!-- layer_5_mlp_fc1_gpu1&#45;&gt;layer_5_allgather_mlp -->
<g id="edge417" class="edge">
<title>layer_5_mlp_fc1_gpu1&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M1274.66,-14923.66C1277.64,-14922.47 1280.6,-14921.33 1283.5,-14920.28 1338.03,-14900.43 1401.79,-14882.73 1447.32,-14871"/>
<polygon fill="black" stroke="black" points="1448.21,-14874.39 1457.03,-14868.52 1446.47,-14867.61 1448.21,-14874.39"/>
</g>
<!-- layer_5_mlp_fc1_gpu2&#45;&gt;layer_5_allgather_mlp -->
<g id="edge418" class="edge">
<title>layer_5_mlp_fc1_gpu2&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M1386.74,-14920.25C1409.71,-14908.09 1437.23,-14893.51 1460.2,-14881.34"/>
<polygon fill="black" stroke="black" points="1461.89,-14884.41 1469.09,-14876.63 1458.61,-14878.22 1461.89,-14884.41"/>
</g>
<!-- layer_5_mlp_fc1_gpu3&#45;&gt;layer_5_allgather_mlp -->
<g id="edge419" class="edge">
<title>layer_5_mlp_fc1_gpu3&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M1467.4,-14920.01C1472.94,-14911.2 1479.27,-14901.14 1485.24,-14891.66"/>
<polygon fill="black" stroke="black" points="1488.22,-14893.49 1490.58,-14883.17 1482.3,-14889.77 1488.22,-14893.49"/>
</g>
<!-- layer_5_mlp_fc1_gpu4&#45;&gt;layer_5_allgather_mlp -->
<g id="edge420" class="edge">
<title>layer_5_mlp_fc1_gpu4&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M1547.6,-14920.01C1542.06,-14911.2 1535.73,-14901.14 1529.76,-14891.66"/>
<polygon fill="black" stroke="black" points="1532.7,-14889.77 1524.42,-14883.17 1526.78,-14893.49 1532.7,-14889.77"/>
</g>
<!-- layer_5_mlp_fc1_gpu5&#45;&gt;layer_5_allgather_mlp -->
<g id="edge421" class="edge">
<title>layer_5_mlp_fc1_gpu5&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M1628.26,-14920.25C1605.29,-14908.09 1577.77,-14893.51 1554.8,-14881.34"/>
<polygon fill="black" stroke="black" points="1556.39,-14878.22 1545.91,-14876.63 1553.11,-14884.41 1556.39,-14878.22"/>
</g>
<!-- layer_5_mlp_fc1_gpu6&#45;&gt;layer_5_allgather_mlp -->
<g id="edge422" class="edge">
<title>layer_5_mlp_fc1_gpu6&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M1740.34,-14923.66C1737.36,-14922.47 1734.4,-14921.33 1731.5,-14920.28 1676.97,-14900.43 1613.21,-14882.73 1567.68,-14871"/>
<polygon fill="black" stroke="black" points="1568.53,-14867.61 1557.97,-14868.52 1566.79,-14874.39 1568.53,-14867.61"/>
</g>
<!-- layer_5_mlp_fc1_gpu7&#45;&gt;layer_5_allgather_mlp -->
<g id="edge423" class="edge">
<title>layer_5_mlp_fc1_gpu7&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M1852.44,-14923.35C1849.44,-14922.24 1846.45,-14921.2 1843.5,-14920.28 1751.48,-14891.4 1640.98,-14873.41 1572.49,-14864.11"/>
<polygon fill="black" stroke="black" points="1572.66,-14860.6 1562.28,-14862.75 1571.73,-14867.54 1572.66,-14860.6"/>
</g>
<!-- layer_5_gelu -->
<g id="node254" class="node">
<title>layer_5_gelu</title>
<polygon fill="lightblue" stroke="black" points="1552,-14790.29 1463,-14790.29 1463,-14754.29 1552,-14754.29 1552,-14790.29"/>
<text text-anchor="middle" x="1507.5" y="-14775.29" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1507.5" y="-14764.29" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_5_allgather_mlp&#45;&gt;layer_5_gelu -->
<g id="edge424" class="edge">
<title>layer_5_allgather_mlp&#45;&gt;layer_5_gelu</title>
<path fill="none" stroke="black" d="M1507.5,-14825.96C1507.5,-14817.71 1507.5,-14808.72 1507.5,-14800.54"/>
<polygon fill="black" stroke="black" points="1511,-14800.39 1507.5,-14790.39 1504,-14800.39 1511,-14800.39"/>
</g>
<!-- layer_5_mlp_fc2_gpu0 -->
<g id="node255" class="node">
<title>layer_5_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1162.5,-14718.29 1068.5,-14718.29 1068.5,-14666.29 1162.5,-14666.29 1162.5,-14718.29"/>
<text text-anchor="middle" x="1115.5" y="-14706.29" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="1115.5" y="-14695.29" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1115.5" y="-14684.29" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1115.5" y="-14673.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu0 -->
<g id="edge425" class="edge">
<title>layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu0</title>
<path fill="none" stroke="black" d="M1462.92,-14768.02C1399.69,-14762.56 1280.52,-14749.27 1172.29,-14718.2"/>
<polygon fill="black" stroke="black" points="1173.1,-14714.79 1162.52,-14715.33 1171.14,-14721.5 1173.1,-14714.79"/>
</g>
<!-- layer_5_mlp_fc2_gpu1 -->
<g id="node256" class="node">
<title>layer_5_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1274.5,-14718.29 1180.5,-14718.29 1180.5,-14666.29 1274.5,-14666.29 1274.5,-14718.29"/>
<text text-anchor="middle" x="1227.5" y="-14706.29" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="1227.5" y="-14695.29" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1227.5" y="-14684.29" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1227.5" y="-14673.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu1 -->
<g id="edge426" class="edge">
<title>layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu1</title>
<path fill="none" stroke="black" d="M1462.61,-14763.25C1419.02,-14754.87 1351.01,-14740.29 1284.42,-14718.36"/>
<polygon fill="black" stroke="black" points="1285.2,-14714.93 1274.61,-14715.07 1282.98,-14721.57 1285.2,-14714.93"/>
</g>
<!-- layer_5_mlp_fc2_gpu2 -->
<g id="node257" class="node">
<title>layer_5_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1386.5,-14718.29 1292.5,-14718.29 1292.5,-14666.29 1386.5,-14666.29 1386.5,-14718.29"/>
<text text-anchor="middle" x="1339.5" y="-14706.29" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="1339.5" y="-14695.29" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1339.5" y="-14684.29" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1339.5" y="-14673.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu2 -->
<g id="edge427" class="edge">
<title>layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu2</title>
<path fill="none" stroke="black" d="M1470.63,-14754.18C1448.71,-14744 1420.45,-14730.88 1395.78,-14719.42"/>
<polygon fill="black" stroke="black" points="1397.06,-14716.16 1386.52,-14715.12 1394.12,-14722.51 1397.06,-14716.16"/>
</g>
<!-- layer_5_mlp_fc2_gpu3 -->
<g id="node258" class="node">
<title>layer_5_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1498.5,-14718.29 1404.5,-14718.29 1404.5,-14666.29 1498.5,-14666.29 1498.5,-14718.29"/>
<text text-anchor="middle" x="1451.5" y="-14706.29" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="1451.5" y="-14695.29" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1451.5" y="-14684.29" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1451.5" y="-14673.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu3 -->
<g id="edge428" class="edge">
<title>layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu3</title>
<path fill="none" stroke="black" d="M1495.07,-14753.98C1489.35,-14746.01 1482.35,-14736.27 1475.65,-14726.94"/>
<polygon fill="black" stroke="black" points="1478.31,-14724.63 1469.63,-14718.55 1472.62,-14728.71 1478.31,-14724.63"/>
</g>
<!-- layer_5_mlp_fc2_gpu4 -->
<g id="node259" class="node">
<title>layer_5_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1610.5,-14718.29 1516.5,-14718.29 1516.5,-14666.29 1610.5,-14666.29 1610.5,-14718.29"/>
<text text-anchor="middle" x="1563.5" y="-14706.29" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="1563.5" y="-14695.29" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1563.5" y="-14684.29" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1563.5" y="-14673.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu4 -->
<g id="edge429" class="edge">
<title>layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu4</title>
<path fill="none" stroke="black" d="M1519.93,-14753.98C1525.65,-14746.01 1532.65,-14736.27 1539.35,-14726.94"/>
<polygon fill="black" stroke="black" points="1542.38,-14728.71 1545.37,-14718.55 1536.69,-14724.63 1542.38,-14728.71"/>
</g>
<!-- layer_5_mlp_fc2_gpu5 -->
<g id="node260" class="node">
<title>layer_5_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1722.5,-14718.29 1628.5,-14718.29 1628.5,-14666.29 1722.5,-14666.29 1722.5,-14718.29"/>
<text text-anchor="middle" x="1675.5" y="-14706.29" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="1675.5" y="-14695.29" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1675.5" y="-14684.29" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1675.5" y="-14673.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu5 -->
<g id="edge430" class="edge">
<title>layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu5</title>
<path fill="none" stroke="black" d="M1544.37,-14754.18C1566.29,-14744 1594.55,-14730.88 1619.22,-14719.42"/>
<polygon fill="black" stroke="black" points="1620.88,-14722.51 1628.48,-14715.12 1617.94,-14716.16 1620.88,-14722.51"/>
</g>
<!-- layer_5_mlp_fc2_gpu6 -->
<g id="node261" class="node">
<title>layer_5_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1834.5,-14718.29 1740.5,-14718.29 1740.5,-14666.29 1834.5,-14666.29 1834.5,-14718.29"/>
<text text-anchor="middle" x="1787.5" y="-14706.29" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="1787.5" y="-14695.29" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1787.5" y="-14684.29" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1787.5" y="-14673.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu6 -->
<g id="edge431" class="edge">
<title>layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu6</title>
<path fill="none" stroke="black" d="M1552.39,-14763.25C1595.98,-14754.87 1663.99,-14740.29 1730.58,-14718.36"/>
<polygon fill="black" stroke="black" points="1732.02,-14721.57 1740.39,-14715.07 1729.8,-14714.93 1732.02,-14721.57"/>
</g>
<!-- layer_5_mlp_fc2_gpu7 -->
<g id="node262" class="node">
<title>layer_5_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1946.5,-14718.29 1852.5,-14718.29 1852.5,-14666.29 1946.5,-14666.29 1946.5,-14718.29"/>
<text text-anchor="middle" x="1899.5" y="-14706.29" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="1899.5" y="-14695.29" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1899.5" y="-14684.29" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1899.5" y="-14673.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu7 -->
<g id="edge432" class="edge">
<title>layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu7</title>
<path fill="none" stroke="black" d="M1552.08,-14768.02C1615.31,-14762.56 1734.48,-14749.27 1842.71,-14718.2"/>
<polygon fill="black" stroke="black" points="1843.86,-14721.5 1852.48,-14715.33 1841.9,-14714.79 1843.86,-14721.5"/>
</g>
<!-- layer_5_allreduce_mlp -->
<g id="node263" class="node">
<title>layer_5_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="1563.5" cy="-14601.3" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="1563.5" y="-14609.8" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1563.5" y="-14598.8" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="1563.5" y="-14587.8" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_5_mlp_fc2_gpu0&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge433" class="edge">
<title>layer_5_mlp_fc2_gpu0&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1162.53,-14669.27C1165.54,-14668.18 1168.54,-14667.18 1171.5,-14666.29 1281.66,-14633.32 1414.65,-14616.15 1493.97,-14608.19"/>
<polygon fill="black" stroke="black" points="1494.71,-14611.63 1504.32,-14607.17 1494.03,-14604.66 1494.71,-14611.63"/>
</g>
<!-- layer_5_mlp_fc2_gpu1&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge434" class="edge">
<title>layer_5_mlp_fc2_gpu1&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1274.6,-14669.49C1277.59,-14668.35 1280.57,-14667.27 1283.5,-14666.29 1355.11,-14642.38 1439.96,-14624.37 1497.34,-14613.64"/>
<polygon fill="black" stroke="black" points="1498.17,-14617.05 1507.37,-14611.79 1496.9,-14610.17 1498.17,-14617.05"/>
</g>
<!-- layer_5_mlp_fc2_gpu2&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge435" class="edge">
<title>layer_5_mlp_fc2_gpu2&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1386.78,-14669.96C1389.72,-14668.71 1392.65,-14667.47 1395.5,-14666.29 1432.39,-14651.05 1474.34,-14635.07 1507.1,-14622.89"/>
<polygon fill="black" stroke="black" points="1508.35,-14626.15 1516.51,-14619.4 1505.92,-14619.59 1508.35,-14626.15"/>
</g>
<!-- layer_5_mlp_fc2_gpu3&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge436" class="edge">
<title>layer_5_mlp_fc2_gpu3&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1483,-14666.27C1496.09,-14655.87 1511.4,-14643.7 1525.14,-14632.78"/>
<polygon fill="black" stroke="black" points="1527.36,-14635.49 1533.01,-14626.53 1523.01,-14630.01 1527.36,-14635.49"/>
</g>
<!-- layer_5_mlp_fc2_gpu4&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge437" class="edge">
<title>layer_5_mlp_fc2_gpu4&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1563.5,-14666.03C1563.5,-14658.14 1563.5,-14649.25 1563.5,-14640.67"/>
<polygon fill="black" stroke="black" points="1567,-14640.44 1563.5,-14630.44 1560,-14640.44 1567,-14640.44"/>
</g>
<!-- layer_5_mlp_fc2_gpu5&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge438" class="edge">
<title>layer_5_mlp_fc2_gpu5&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1644,-14666.27C1630.91,-14655.87 1615.6,-14643.7 1601.86,-14632.78"/>
<polygon fill="black" stroke="black" points="1603.99,-14630.01 1593.99,-14626.53 1599.64,-14635.49 1603.99,-14630.01"/>
</g>
<!-- layer_5_mlp_fc2_gpu6&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge439" class="edge">
<title>layer_5_mlp_fc2_gpu6&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1740.22,-14669.96C1737.28,-14668.71 1734.35,-14667.47 1731.5,-14666.29 1694.61,-14651.05 1652.66,-14635.07 1619.9,-14622.89"/>
<polygon fill="black" stroke="black" points="1621.08,-14619.59 1610.49,-14619.4 1618.65,-14626.15 1621.08,-14619.59"/>
</g>
<!-- layer_5_mlp_fc2_gpu7&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge440" class="edge">
<title>layer_5_mlp_fc2_gpu7&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1852.4,-14669.49C1849.41,-14668.35 1846.43,-14667.27 1843.5,-14666.29 1771.89,-14642.38 1687.04,-14624.37 1629.66,-14613.64"/>
<polygon fill="black" stroke="black" points="1630.1,-14610.17 1619.63,-14611.79 1628.83,-14617.05 1630.1,-14610.17"/>
</g>
<!-- layer_5_allreduce_mlp&#45;&gt;layer_5_residual2 -->
<g id="edge441" class="edge">
<title>layer_5_allreduce_mlp&#45;&gt;layer_5_residual2</title>
<path fill="none" stroke="black" d="M1606.47,-14580.81C1636.5,-14567.19 1676.96,-14548.83 1709.93,-14533.88"/>
<polygon fill="black" stroke="black" points="1711.8,-14536.87 1719.46,-14529.55 1708.91,-14530.5 1711.8,-14536.87"/>
</g>
<!-- layer_5_ln2 -->
<g id="node265" class="node">
<title>layer_5_ln2</title>
<polygon fill="lightblue" stroke="black" points="1805,-14440.31 1732,-14440.31 1732,-14399.31 1805,-14399.31 1805,-14440.31"/>
<text text-anchor="middle" x="1768.5" y="-14428.31" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1768.5" y="-14417.31" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="1768.5" y="-14406.31" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_5_residual2&#45;&gt;layer_5_ln2 -->
<g id="edge443" class="edge">
<title>layer_5_residual2&#45;&gt;layer_5_ln2</title>
<path fill="none" stroke="black" d="M1768.5,-14476.23C1768.5,-14467.91 1768.5,-14458.82 1768.5,-14450.46"/>
<polygon fill="black" stroke="black" points="1772,-14450.38 1768.5,-14440.38 1765,-14450.38 1772,-14450.38"/>
</g>
<!-- layer_5_output_dist -->
<g id="node266" class="node">
<title>layer_5_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="1870.2,-14363.31 1708.42,-14363.31 1666.8,-14303.31 1828.58,-14303.31 1870.2,-14363.31"/>
<text text-anchor="middle" x="1768.5" y="-14336.31" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="1768.5" y="-14325.31" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_5_ln2&#45;&gt;layer_5_output_dist -->
<g id="edge444" class="edge">
<title>layer_5_ln2&#45;&gt;layer_5_output_dist</title>
<path fill="none" stroke="black" d="M1768.5,-14399.21C1768.5,-14391.57 1768.5,-14382.53 1768.5,-14373.66"/>
<polygon fill="black" stroke="black" points="1772,-14373.42 1768.5,-14363.42 1765,-14373.42 1772,-14373.42"/>
</g>
<!-- layer_6_input_dist -->
<g id="node267" class="node">
<title>layer_6_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="1862.69,-14267.31 1712.86,-14267.31 1674.31,-14207.31 1824.14,-14207.31 1862.69,-14267.31"/>
<text text-anchor="middle" x="1768.5" y="-14240.31" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1768.5" y="-14229.31" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_5_output_dist&#45;&gt;layer_6_input_dist -->
<g id="edge445" class="edge">
<title>layer_5_output_dist&#45;&gt;layer_6_input_dist</title>
<path fill="none" stroke="black" d="M1768.5,-14303.08C1768.5,-14295.04 1768.5,-14286.18 1768.5,-14277.66"/>
<polygon fill="black" stroke="black" points="1772,-14277.52 1768.5,-14267.52 1765,-14277.52 1772,-14277.52"/>
</g>
<!-- layer_6_qkv_gpu0 -->
<g id="node268" class="node">
<title>layer_6_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1371,-14171.31 1278,-14171.31 1278,-14119.31 1371,-14119.31 1371,-14171.31"/>
<text text-anchor="middle" x="1324.5" y="-14159.31" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="1324.5" y="-14148.31" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1324.5" y="-14137.31" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1324.5" y="-14126.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu0 -->
<g id="edge446" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1688,-14228.85C1610.82,-14220.34 1491.31,-14203.6 1380.86,-14171.09"/>
<polygon fill="black" stroke="black" points="1381.81,-14167.72 1371.22,-14168.2 1379.8,-14174.42 1381.81,-14167.72"/>
</g>
<!-- layer_6_qkv_gpu1 -->
<g id="node269" class="node">
<title>layer_6_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1482,-14171.31 1389,-14171.31 1389,-14119.31 1482,-14119.31 1482,-14171.31"/>
<text text-anchor="middle" x="1435.5" y="-14159.31" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="1435.5" y="-14148.31" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1435.5" y="-14137.31" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1435.5" y="-14126.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu1 -->
<g id="edge447" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1682.78,-14220.56C1629.93,-14209.84 1560.87,-14194 1492.01,-14171.23"/>
<polygon fill="black" stroke="black" points="1492.89,-14167.84 1482.3,-14167.97 1490.66,-14174.47 1492.89,-14167.84"/>
</g>
<!-- layer_6_qkv_gpu2 -->
<g id="node270" class="node">
<title>layer_6_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1593,-14171.31 1500,-14171.31 1500,-14119.31 1593,-14119.31 1593,-14171.31"/>
<text text-anchor="middle" x="1546.5" y="-14159.31" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="1546.5" y="-14148.31" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1546.5" y="-14137.31" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1546.5" y="-14126.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu2 -->
<g id="edge448" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1692.17,-14207.28C1663.89,-14196.3 1631.62,-14183.5 1602.5,-14171.31 1602.4,-14171.27 1602.31,-14171.23 1602.21,-14171.19"/>
<polygon fill="black" stroke="black" points="1603.75,-14168.04 1593.18,-14167.34 1601.01,-14174.48 1603.75,-14168.04"/>
</g>
<!-- layer_6_qkv_gpu3 -->
<g id="node271" class="node">
<title>layer_6_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1704,-14171.31 1611,-14171.31 1611,-14119.31 1704,-14119.31 1704,-14171.31"/>
<text text-anchor="middle" x="1657.5" y="-14159.31" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="1657.5" y="-14148.31" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1657.5" y="-14137.31" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1657.5" y="-14126.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu3 -->
<g id="edge449" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1732.46,-14207.09C1720.94,-14197.75 1708.14,-14187.37 1696.42,-14177.87"/>
<polygon fill="black" stroke="black" points="1698.48,-14175.03 1688.51,-14171.46 1694.08,-14180.47 1698.48,-14175.03"/>
</g>
<!-- layer_6_qkv_gpu4 -->
<g id="node272" class="node">
<title>layer_6_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1815,-14171.31 1722,-14171.31 1722,-14119.31 1815,-14119.31 1815,-14171.31"/>
<text text-anchor="middle" x="1768.5" y="-14159.31" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="1768.5" y="-14148.31" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1768.5" y="-14137.31" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1768.5" y="-14126.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu4 -->
<g id="edge450" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1768.5,-14206.84C1768.5,-14198.77 1768.5,-14189.93 1768.5,-14181.57"/>
<polygon fill="black" stroke="black" points="1772,-14181.32 1768.5,-14171.32 1765,-14181.32 1772,-14181.32"/>
</g>
<!-- layer_6_qkv_gpu5 -->
<g id="node273" class="node">
<title>layer_6_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1926,-14171.31 1833,-14171.31 1833,-14119.31 1926,-14119.31 1926,-14171.31"/>
<text text-anchor="middle" x="1879.5" y="-14159.31" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="1879.5" y="-14148.31" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1879.5" y="-14137.31" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1879.5" y="-14126.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu5 -->
<g id="edge451" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1804.54,-14207.09C1816.06,-14197.75 1828.86,-14187.37 1840.58,-14177.87"/>
<polygon fill="black" stroke="black" points="1842.92,-14180.47 1848.49,-14171.46 1838.52,-14175.03 1842.92,-14180.47"/>
</g>
<!-- layer_6_qkv_gpu6 -->
<g id="node274" class="node">
<title>layer_6_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2037,-14171.31 1944,-14171.31 1944,-14119.31 2037,-14119.31 2037,-14171.31"/>
<text text-anchor="middle" x="1990.5" y="-14159.31" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="1990.5" y="-14148.31" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1990.5" y="-14137.31" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1990.5" y="-14126.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu6 -->
<g id="edge452" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1828.73,-14213.79C1858.33,-14202.51 1894.68,-14188.34 1934.42,-14171.7"/>
<polygon fill="black" stroke="black" points="1935.91,-14174.87 1943.77,-14167.76 1933.2,-14168.42 1935.91,-14174.87"/>
</g>
<!-- layer_6_qkv_gpu7 -->
<g id="node275" class="node">
<title>layer_6_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2148,-14171.31 2055,-14171.31 2055,-14119.31 2148,-14119.31 2148,-14171.31"/>
<text text-anchor="middle" x="2101.5" y="-14159.31" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="2101.5" y="-14148.31" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2101.5" y="-14137.31" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2101.5" y="-14126.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu7 -->
<g id="edge453" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1835.25,-14224.54C1889.88,-14214.04 1969.07,-14196.84 2045.2,-14171.52"/>
<polygon fill="black" stroke="black" points="2046.59,-14174.74 2054.95,-14168.23 2044.35,-14168.11 2046.59,-14174.74"/>
</g>
<!-- layer_6_residual1 -->
<g id="node287" class="node">
<title>layer_6_residual1</title>
<polygon fill="lightyellow" stroke="black" points="2058.44,-13719.34 1936.05,-13719.34 1904.56,-13659.34 2026.95,-13659.34 2058.44,-13719.34"/>
<text text-anchor="middle" x="1981.5" y="-13692.34" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1981.5" y="-13681.34" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_residual1 -->
<g id="edge480" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_residual1</title>
<path fill="none" stroke="black" d="M1841.59,-14233.97C1941.77,-14229.16 2114.3,-14214.65 2157.5,-14171.31 2194.38,-14134.31 2176.5,-14107.56 2176.5,-14055.32 2176.5,-14055.32 2176.5,-14055.32 2176.5,-13874.33 2176.5,-13805.55 2111.52,-13754.87 2056.59,-13724.31"/>
<polygon fill="black" stroke="black" points="2057.98,-13721.08 2047.52,-13719.4 2054.64,-13727.24 2057.98,-13721.08"/>
</g>
<!-- layer_6_allgather_qkv -->
<g id="node276" class="node">
<title>layer_6_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="1724.5" cy="-14054.32" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="1724.5" y="-14062.82" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1724.5" y="-14051.82" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="1724.5" y="-14040.82" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_6_qkv_gpu0&#45;&gt;layer_6_allgather_qkv -->
<g id="edge454" class="edge">
<title>layer_6_qkv_gpu0&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M1371.24,-14122.48C1374.35,-14121.33 1377.45,-14120.26 1380.5,-14119.31 1475.17,-14089.83 1588.96,-14071.93 1659.01,-14062.82"/>
<polygon fill="black" stroke="black" points="1659.54,-14066.29 1669.02,-14061.55 1658.65,-14059.34 1659.54,-14066.29"/>
</g>
<!-- layer_6_qkv_gpu1&#45;&gt;layer_6_allgather_qkv -->
<g id="edge455" class="edge">
<title>layer_6_qkv_gpu1&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M1482.03,-14122.9C1485.22,-14121.63 1488.39,-14120.42 1491.5,-14119.31 1548.65,-14098.84 1615.64,-14081.07 1663.08,-14069.48"/>
<polygon fill="black" stroke="black" points="1664,-14072.86 1672.9,-14067.1 1662.36,-14066.05 1664,-14072.86"/>
</g>
<!-- layer_6_qkv_gpu2&#45;&gt;layer_6_allgather_qkv -->
<g id="edge456" class="edge">
<title>layer_6_qkv_gpu2&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M1593.27,-14120.93C1618.59,-14108.27 1649.84,-14092.64 1675.5,-14079.82"/>
<polygon fill="black" stroke="black" points="1677.3,-14082.83 1684.68,-14075.23 1674.17,-14076.57 1677.3,-14082.83"/>
</g>
<!-- layer_6_qkv_gpu3&#45;&gt;layer_6_allgather_qkv -->
<g id="edge457" class="edge">
<title>layer_6_qkv_gpu3&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M1676.52,-14119.05C1683.41,-14109.89 1691.32,-14099.4 1698.69,-14089.6"/>
<polygon fill="black" stroke="black" points="1701.51,-14091.67 1704.73,-14081.58 1695.92,-14087.46 1701.51,-14091.67"/>
</g>
<!-- layer_6_qkv_gpu4&#45;&gt;layer_6_allgather_qkv -->
<g id="edge458" class="edge">
<title>layer_6_qkv_gpu4&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M1756.01,-14119.05C1751.78,-14110.49 1746.97,-14100.76 1742.4,-14091.52"/>
<polygon fill="black" stroke="black" points="1745.52,-14089.93 1737.95,-14082.51 1739.24,-14093.03 1745.52,-14089.93"/>
</g>
<!-- layer_6_qkv_gpu5&#45;&gt;layer_6_allgather_qkv -->
<g id="edge459" class="edge">
<title>layer_6_qkv_gpu5&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M1835.91,-14119.28C1815.48,-14107.55 1791.12,-14093.57 1770.4,-14081.67"/>
<polygon fill="black" stroke="black" points="1771.88,-14078.49 1761.47,-14076.54 1768.4,-14084.56 1771.88,-14078.49"/>
</g>
<!-- layer_6_qkv_gpu6&#45;&gt;layer_6_allgather_qkv -->
<g id="edge460" class="edge">
<title>layer_6_qkv_gpu6&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M1943.87,-14122.61C1941.05,-14121.45 1938.25,-14120.35 1935.5,-14119.31 1885.32,-14100.39 1826.88,-14083.02 1784.24,-14071.16"/>
<polygon fill="black" stroke="black" points="1785.15,-14067.78 1774.57,-14068.49 1783.28,-14074.53 1785.15,-14067.78"/>
</g>
<!-- layer_6_qkv_gpu7&#45;&gt;layer_6_allgather_qkv -->
<g id="edge461" class="edge">
<title>layer_6_qkv_gpu7&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M2054.98,-14122.28C2052.14,-14121.21 2049.3,-14120.21 2046.5,-14119.31 1959.72,-14091.38 1855.69,-14073.37 1789.83,-14063.79"/>
<polygon fill="black" stroke="black" points="1789.99,-14060.28 1779.6,-14062.32 1789,-14067.21 1789.99,-14060.28"/>
</g>
<!-- layer_6_attention -->
<g id="node277" class="node">
<title>layer_6_attention</title>
<polygon fill="lightblue" stroke="black" points="1758.5,-13989.33 1690.5,-13989.33 1690.5,-13937.33 1758.5,-13937.33 1758.5,-13989.33"/>
<text text-anchor="middle" x="1724.5" y="-13977.33" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1724.5" y="-13966.33" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1724.5" y="-13955.33" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="1724.5" y="-13944.33" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_6_allgather_qkv&#45;&gt;layer_6_attention -->
<g id="edge462" class="edge">
<title>layer_6_allgather_qkv&#45;&gt;layer_6_attention</title>
<path fill="none" stroke="black" d="M1724.5,-14025.16C1724.5,-14017.05 1724.5,-14008.1 1724.5,-13999.62"/>
<polygon fill="black" stroke="black" points="1728,-13999.59 1724.5,-13989.59 1721,-13999.59 1728,-13999.59"/>
</g>
<!-- layer_6_attn_out_gpu0 -->
<g id="node278" class="node">
<title>layer_6_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1406.5,-13901.33 1318.5,-13901.33 1318.5,-13849.33 1406.5,-13849.33 1406.5,-13901.33"/>
<text text-anchor="middle" x="1362.5" y="-13889.33" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="1362.5" y="-13878.33" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1362.5" y="-13867.33" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1362.5" y="-13856.33" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attention&#45;&gt;layer_6_attn_out_gpu0 -->
<g id="edge463" class="edge">
<title>layer_6_attention&#45;&gt;layer_6_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M1690.43,-13958.39C1634.48,-13951.32 1519.85,-13934.35 1416.37,-13901.29"/>
<polygon fill="black" stroke="black" points="1417.3,-13897.92 1406.71,-13898.15 1415.13,-13904.57 1417.3,-13897.92"/>
</g>
<!-- layer_6_attn_out_gpu1 -->
<g id="node279" class="node">
<title>layer_6_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1512.5,-13901.33 1424.5,-13901.33 1424.5,-13849.33 1512.5,-13849.33 1512.5,-13901.33"/>
<text text-anchor="middle" x="1468.5" y="-13889.33" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="1468.5" y="-13878.33" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1468.5" y="-13867.33" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1468.5" y="-13856.33" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attention&#45;&gt;layer_6_attn_out_gpu1 -->
<g id="edge464" class="edge">
<title>layer_6_attention&#45;&gt;layer_6_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M1690.22,-13953.7C1651.35,-13943.55 1586.05,-13925.41 1521.97,-13901.3"/>
<polygon fill="black" stroke="black" points="1523.12,-13897.99 1512.53,-13897.7 1520.63,-13904.53 1523.12,-13897.99"/>
</g>
<!-- layer_6_attn_out_gpu2 -->
<g id="node280" class="node">
<title>layer_6_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1618.5,-13901.33 1530.5,-13901.33 1530.5,-13849.33 1618.5,-13849.33 1618.5,-13901.33"/>
<text text-anchor="middle" x="1574.5" y="-13889.33" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="1574.5" y="-13878.33" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1574.5" y="-13867.33" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1574.5" y="-13856.33" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attention&#45;&gt;layer_6_attn_out_gpu2 -->
<g id="edge465" class="edge">
<title>layer_6_attention&#45;&gt;layer_6_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M1690.46,-13942.81C1671.78,-13932.1 1648.21,-13918.59 1627.2,-13906.54"/>
<polygon fill="black" stroke="black" points="1628.8,-13903.42 1618.38,-13901.48 1625.31,-13909.5 1628.8,-13903.42"/>
</g>
<!-- layer_6_attn_out_gpu3 -->
<g id="node281" class="node">
<title>layer_6_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1724.5,-13901.33 1636.5,-13901.33 1636.5,-13849.33 1724.5,-13849.33 1724.5,-13901.33"/>
<text text-anchor="middle" x="1680.5" y="-13889.33" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="1680.5" y="-13878.33" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1680.5" y="-13867.33" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1680.5" y="-13856.33" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attention&#45;&gt;layer_6_attn_out_gpu3 -->
<g id="edge466" class="edge">
<title>layer_6_attention&#45;&gt;layer_6_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M1711.54,-13936.99C1707.28,-13928.68 1702.49,-13919.3 1697.96,-13910.45"/>
<polygon fill="black" stroke="black" points="1701.04,-13908.79 1693.37,-13901.48 1694.81,-13911.98 1701.04,-13908.79"/>
</g>
<!-- layer_6_attn_out_gpu4 -->
<g id="node282" class="node">
<title>layer_6_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1830.5,-13901.33 1742.5,-13901.33 1742.5,-13849.33 1830.5,-13849.33 1830.5,-13901.33"/>
<text text-anchor="middle" x="1786.5" y="-13889.33" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="1786.5" y="-13878.33" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1786.5" y="-13867.33" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1786.5" y="-13856.33" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attention&#45;&gt;layer_6_attn_out_gpu4 -->
<g id="edge467" class="edge">
<title>layer_6_attention&#45;&gt;layer_6_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M1742.77,-13936.99C1748.95,-13928.42 1755.95,-13918.71 1762.5,-13909.61"/>
<polygon fill="black" stroke="black" points="1765.35,-13911.64 1768.36,-13901.48 1759.68,-13907.55 1765.35,-13911.64"/>
</g>
<!-- layer_6_attn_out_gpu5 -->
<g id="node283" class="node">
<title>layer_6_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1936.5,-13901.33 1848.5,-13901.33 1848.5,-13849.33 1936.5,-13849.33 1936.5,-13901.33"/>
<text text-anchor="middle" x="1892.5" y="-13889.33" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="1892.5" y="-13878.33" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1892.5" y="-13867.33" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1892.5" y="-13856.33" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attention&#45;&gt;layer_6_attn_out_gpu5 -->
<g id="edge468" class="edge">
<title>layer_6_attention&#45;&gt;layer_6_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M1758.9,-13944.72C1782,-13932.89 1812.9,-13917.08 1839.16,-13903.63"/>
<polygon fill="black" stroke="black" points="1840.93,-13906.66 1848.24,-13898.99 1837.74,-13900.43 1840.93,-13906.66"/>
</g>
<!-- layer_6_attn_out_gpu6 -->
<g id="node284" class="node">
<title>layer_6_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2042.5,-13901.33 1954.5,-13901.33 1954.5,-13849.33 2042.5,-13849.33 2042.5,-13901.33"/>
<text text-anchor="middle" x="1998.5" y="-13889.33" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="1998.5" y="-13878.33" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1998.5" y="-13867.33" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1998.5" y="-13856.33" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attention&#45;&gt;layer_6_attn_out_gpu6 -->
<g id="edge469" class="edge">
<title>layer_6_attention&#45;&gt;layer_6_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M1758.77,-13954.8C1800.82,-13945.14 1874.28,-13926.92 1944.99,-13901.27"/>
<polygon fill="black" stroke="black" points="1946.32,-13904.51 1954.5,-13897.78 1943.9,-13897.95 1946.32,-13904.51"/>
</g>
<!-- layer_6_attn_out_gpu7 -->
<g id="node285" class="node">
<title>layer_6_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2148.5,-13901.33 2060.5,-13901.33 2060.5,-13849.33 2148.5,-13849.33 2148.5,-13901.33"/>
<text text-anchor="middle" x="2104.5" y="-13889.33" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="2104.5" y="-13878.33" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2104.5" y="-13867.33" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2104.5" y="-13856.33" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attention&#45;&gt;layer_6_attn_out_gpu7 -->
<g id="edge470" class="edge">
<title>layer_6_attention&#45;&gt;layer_6_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M1758.63,-13958.88C1817.2,-13952.34 1940.4,-13935.86 2050.69,-13901.26"/>
<polygon fill="black" stroke="black" points="2051.84,-13904.56 2060.3,-13898.18 2049.71,-13897.9 2051.84,-13904.56"/>
</g>
<!-- layer_6_allreduce_attn -->
<g id="node286" class="node">
<title>layer_6_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="1786.5" cy="-13784.34" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="1786.5" y="-13792.84" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1786.5" y="-13781.84" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="1786.5" y="-13770.84" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_6_attn_out_gpu0&#45;&gt;layer_6_allreduce_attn -->
<g id="edge471" class="edge">
<title>layer_6_attn_out_gpu0&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M1406.68,-13852.43C1409.63,-13851.29 1412.59,-13850.25 1415.5,-13849.33 1518.93,-13816.68 1644.16,-13799.47 1719.47,-13791.4"/>
<polygon fill="black" stroke="black" points="1720.17,-13794.84 1729.75,-13790.32 1719.44,-13787.88 1720.17,-13794.84"/>
</g>
<!-- layer_6_attn_out_gpu1&#45;&gt;layer_6_allreduce_attn -->
<g id="edge472" class="edge">
<title>layer_6_attn_out_gpu1&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M1512.76,-13852.65C1515.69,-13851.46 1518.62,-13850.34 1521.5,-13849.33 1588.63,-13825.67 1668.34,-13807.72 1722.69,-13796.94"/>
<polygon fill="black" stroke="black" points="1723.39,-13800.37 1732.53,-13795.01 1722.04,-13793.5 1723.39,-13800.37"/>
</g>
<!-- layer_6_attn_out_gpu2&#45;&gt;layer_6_allreduce_attn -->
<g id="edge473" class="edge">
<title>layer_6_attn_out_gpu2&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M1618.66,-13853.26C1621.64,-13851.91 1624.61,-13850.59 1627.5,-13849.33 1661.83,-13834.34 1700.84,-13818.62 1731.63,-13806.51"/>
<polygon fill="black" stroke="black" points="1733.29,-13809.62 1741.32,-13802.71 1730.73,-13803.1 1733.29,-13809.62"/>
</g>
<!-- layer_6_attn_out_gpu3&#45;&gt;layer_6_allreduce_attn -->
<g id="edge474" class="edge">
<title>layer_6_attn_out_gpu3&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M1710.31,-13849.3C1722.58,-13839 1736.92,-13826.96 1749.83,-13816.13"/>
<polygon fill="black" stroke="black" points="1752.24,-13818.67 1757.65,-13809.56 1747.74,-13813.31 1752.24,-13818.67"/>
</g>
<!-- layer_6_attn_out_gpu4&#45;&gt;layer_6_allreduce_attn -->
<g id="edge475" class="edge">
<title>layer_6_attn_out_gpu4&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M1786.5,-13849.06C1786.5,-13841.17 1786.5,-13832.28 1786.5,-13823.7"/>
<polygon fill="black" stroke="black" points="1790,-13823.48 1786.5,-13813.48 1783,-13823.48 1790,-13823.48"/>
</g>
<!-- layer_6_attn_out_gpu5&#45;&gt;layer_6_allreduce_attn -->
<g id="edge476" class="edge">
<title>layer_6_attn_out_gpu5&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M1862.69,-13849.3C1850.42,-13839 1836.08,-13826.96 1823.17,-13816.13"/>
<polygon fill="black" stroke="black" points="1825.26,-13813.31 1815.35,-13809.56 1820.76,-13818.67 1825.26,-13813.31"/>
</g>
<!-- layer_6_attn_out_gpu6&#45;&gt;layer_6_allreduce_attn -->
<g id="edge477" class="edge">
<title>layer_6_attn_out_gpu6&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M1954.34,-13853.26C1951.36,-13851.91 1948.39,-13850.59 1945.5,-13849.33 1911.17,-13834.34 1872.16,-13818.62 1841.37,-13806.51"/>
<polygon fill="black" stroke="black" points="1842.27,-13803.1 1831.68,-13802.71 1839.71,-13809.62 1842.27,-13803.1"/>
</g>
<!-- layer_6_attn_out_gpu7&#45;&gt;layer_6_allreduce_attn -->
<g id="edge478" class="edge">
<title>layer_6_attn_out_gpu7&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M2060.24,-13852.65C2057.31,-13851.46 2054.38,-13850.34 2051.5,-13849.33 1984.37,-13825.67 1904.66,-13807.72 1850.31,-13796.94"/>
<polygon fill="black" stroke="black" points="1850.96,-13793.5 1840.47,-13795.01 1849.61,-13800.37 1850.96,-13793.5"/>
</g>
<!-- layer_6_allreduce_attn&#45;&gt;layer_6_residual1 -->
<g id="edge479" class="edge">
<title>layer_6_allreduce_attn&#45;&gt;layer_6_residual1</title>
<path fill="none" stroke="black" d="M1827.85,-13763.62C1855.62,-13750.38 1892.59,-13732.74 1923.31,-13718.1"/>
<polygon fill="black" stroke="black" points="1925.1,-13721.12 1932.62,-13713.65 1922.09,-13714.8 1925.1,-13721.12"/>
</g>
<!-- layer_6_ln1 -->
<g id="node288" class="node">
<title>layer_6_ln1</title>
<polygon fill="lightblue" stroke="black" points="1813,-13623.34 1740,-13623.34 1740,-13582.34 1813,-13582.34 1813,-13623.34"/>
<text text-anchor="middle" x="1776.5" y="-13611.34" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1776.5" y="-13600.34" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="1776.5" y="-13589.34" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_6_residual1&#45;&gt;layer_6_ln1 -->
<g id="edge481" class="edge">
<title>layer_6_residual1&#45;&gt;layer_6_ln1</title>
<path fill="none" stroke="black" d="M1910.95,-13659.26C1881.66,-13647.19 1848.49,-13633.52 1822.43,-13622.78"/>
<polygon fill="black" stroke="black" points="1823.75,-13619.54 1813.17,-13618.96 1821.08,-13626.01 1823.75,-13619.54"/>
</g>
<!-- layer_6_residual2 -->
<g id="node308" class="node">
<title>layer_6_residual2</title>
<polygon fill="lightyellow" stroke="black" points="2058.44,-13110.38 1936.05,-13110.38 1904.56,-13050.38 2026.95,-13050.38 2058.44,-13110.38"/>
<text text-anchor="middle" x="1981.5" y="-13083.38" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1981.5" y="-13072.38" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_6_residual1&#45;&gt;layer_6_residual2 -->
<g id="edge516" class="edge">
<title>layer_6_residual1&#45;&gt;layer_6_residual2</title>
<path fill="none" stroke="black" d="M2033.48,-13671.78C2094.51,-13648.7 2187.5,-13600.53 2187.5,-13521.34 2187.5,-13521.34 2187.5,-13521.34 2187.5,-13265.36 2187.5,-13195.15 2120.11,-13145.07 2062.42,-13115.06"/>
<polygon fill="black" stroke="black" points="2063.76,-13111.81 2053.26,-13110.42 2060.6,-13118.06 2063.76,-13111.81"/>
</g>
<!-- layer_6_mlp_fc1_gpu0 -->
<g id="node289" class="node">
<title>layer_6_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1375.5,-13546.34 1281.5,-13546.34 1281.5,-13494.34 1375.5,-13494.34 1375.5,-13546.34"/>
<text text-anchor="middle" x="1328.5" y="-13534.34" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="1328.5" y="-13523.34" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1328.5" y="-13512.34" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1328.5" y="-13501.34" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu0 -->
<g id="edge482" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M1739.85,-13600.07C1671.28,-13596.01 1519.17,-13583.59 1385.13,-13546.18"/>
<polygon fill="black" stroke="black" points="1386.08,-13542.81 1375.51,-13543.44 1384.17,-13549.54 1386.08,-13542.81"/>
</g>
<!-- layer_6_mlp_fc1_gpu1 -->
<g id="node290" class="node">
<title>layer_6_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1487.5,-13546.34 1393.5,-13546.34 1393.5,-13494.34 1487.5,-13494.34 1487.5,-13546.34"/>
<text text-anchor="middle" x="1440.5" y="-13534.34" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="1440.5" y="-13523.34" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1440.5" y="-13512.34" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1440.5" y="-13501.34" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu1 -->
<g id="edge483" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M1739.6,-13597.22C1687.26,-13590.08 1588.55,-13574.48 1497.23,-13546.29"/>
<polygon fill="black" stroke="black" points="1498.16,-13542.91 1487.57,-13543.25 1496.05,-13549.59 1498.16,-13542.91"/>
</g>
<!-- layer_6_mlp_fc1_gpu2 -->
<g id="node291" class="node">
<title>layer_6_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1599.5,-13546.34 1505.5,-13546.34 1505.5,-13494.34 1599.5,-13494.34 1599.5,-13546.34"/>
<text text-anchor="middle" x="1552.5" y="-13534.34" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="1552.5" y="-13523.34" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1552.5" y="-13512.34" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1552.5" y="-13501.34" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu2 -->
<g id="edge484" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M1739.75,-13590.88C1707.47,-13580.98 1659.12,-13565.54 1609.08,-13546.43"/>
<polygon fill="black" stroke="black" points="1610.3,-13543.16 1599.72,-13542.82 1607.79,-13549.69 1610.3,-13543.16"/>
</g>
<!-- layer_6_mlp_fc1_gpu3 -->
<g id="node292" class="node">
<title>layer_6_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1711.5,-13546.34 1617.5,-13546.34 1617.5,-13494.34 1711.5,-13494.34 1711.5,-13546.34"/>
<text text-anchor="middle" x="1664.5" y="-13534.34" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="1664.5" y="-13523.34" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1664.5" y="-13512.34" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1664.5" y="-13501.34" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu3 -->
<g id="edge485" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M1749.1,-13582.15C1736.77,-13573.29 1721.9,-13562.6 1708.09,-13552.68"/>
<polygon fill="black" stroke="black" points="1709.83,-13549.62 1699.67,-13546.62 1705.74,-13555.3 1709.83,-13549.62"/>
</g>
<!-- layer_6_mlp_fc1_gpu4 -->
<g id="node293" class="node">
<title>layer_6_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1823.5,-13546.34 1729.5,-13546.34 1729.5,-13494.34 1823.5,-13494.34 1823.5,-13546.34"/>
<text text-anchor="middle" x="1776.5" y="-13534.34" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="1776.5" y="-13523.34" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1776.5" y="-13512.34" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1776.5" y="-13501.34" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu4 -->
<g id="edge486" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M1776.5,-13581.95C1776.5,-13574.33 1776.5,-13565.4 1776.5,-13556.77"/>
<polygon fill="black" stroke="black" points="1780,-13556.5 1776.5,-13546.5 1773,-13556.5 1780,-13556.5"/>
</g>
<!-- layer_6_mlp_fc1_gpu5 -->
<g id="node294" class="node">
<title>layer_6_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1935.5,-13546.34 1841.5,-13546.34 1841.5,-13494.34 1935.5,-13494.34 1935.5,-13546.34"/>
<text text-anchor="middle" x="1888.5" y="-13534.34" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="1888.5" y="-13523.34" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1888.5" y="-13512.34" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1888.5" y="-13501.34" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu5 -->
<g id="edge487" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M1803.9,-13582.15C1816.23,-13573.29 1831.1,-13562.6 1844.91,-13552.68"/>
<polygon fill="black" stroke="black" points="1847.26,-13555.3 1853.33,-13546.62 1843.17,-13549.62 1847.26,-13555.3"/>
</g>
<!-- layer_6_mlp_fc1_gpu6 -->
<g id="node295" class="node">
<title>layer_6_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2047.5,-13546.34 1953.5,-13546.34 1953.5,-13494.34 2047.5,-13494.34 2047.5,-13546.34"/>
<text text-anchor="middle" x="2000.5" y="-13534.34" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="2000.5" y="-13523.34" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2000.5" y="-13512.34" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2000.5" y="-13501.34" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu6 -->
<g id="edge488" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M1813.25,-13590.88C1845.53,-13580.98 1893.88,-13565.54 1943.92,-13546.43"/>
<polygon fill="black" stroke="black" points="1945.21,-13549.69 1953.28,-13542.82 1942.7,-13543.16 1945.21,-13549.69"/>
</g>
<!-- layer_6_mlp_fc1_gpu7 -->
<g id="node296" class="node">
<title>layer_6_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2159.5,-13546.34 2065.5,-13546.34 2065.5,-13494.34 2159.5,-13494.34 2159.5,-13546.34"/>
<text text-anchor="middle" x="2112.5" y="-13534.34" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="2112.5" y="-13523.34" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2112.5" y="-13512.34" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2112.5" y="-13501.34" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu7 -->
<g id="edge489" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M1813.4,-13597.22C1865.74,-13590.08 1964.45,-13574.48 2055.77,-13546.29"/>
<polygon fill="black" stroke="black" points="2056.95,-13549.59 2065.43,-13543.25 2054.84,-13542.91 2056.95,-13549.59"/>
</g>
<!-- layer_6_allgather_mlp -->
<g id="node297" class="node">
<title>layer_6_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="1720.5" cy="-13429.35" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="1720.5" y="-13437.85" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1720.5" y="-13426.85" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="1720.5" y="-13415.85" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_6_mlp_fc1_gpu0&#45;&gt;layer_6_allgather_mlp -->
<g id="edge490" class="edge">
<title>layer_6_mlp_fc1_gpu0&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M1375.56,-13497.41C1378.56,-13496.3 1381.55,-13495.27 1384.5,-13494.34 1476.52,-13465.47 1587.02,-13447.48 1655.51,-13438.18"/>
<polygon fill="black" stroke="black" points="1656.27,-13441.61 1665.72,-13436.82 1655.34,-13434.67 1656.27,-13441.61"/>
</g>
<!-- layer_6_mlp_fc1_gpu1&#45;&gt;layer_6_allgather_mlp -->
<g id="edge491" class="edge">
<title>layer_6_mlp_fc1_gpu1&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M1487.66,-13497.73C1490.64,-13496.54 1493.6,-13495.4 1496.5,-13494.34 1551.03,-13474.5 1614.79,-13456.8 1660.32,-13445.07"/>
<polygon fill="black" stroke="black" points="1661.21,-13448.46 1670.03,-13442.59 1659.47,-13441.67 1661.21,-13448.46"/>
</g>
<!-- layer_6_mlp_fc1_gpu2&#45;&gt;layer_6_allgather_mlp -->
<g id="edge492" class="edge">
<title>layer_6_mlp_fc1_gpu2&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M1599.74,-13494.32C1622.71,-13482.16 1650.23,-13467.57 1673.2,-13455.41"/>
<polygon fill="black" stroke="black" points="1674.89,-13458.48 1682.09,-13450.7 1671.61,-13452.29 1674.89,-13458.48"/>
</g>
<!-- layer_6_mlp_fc1_gpu3&#45;&gt;layer_6_allgather_mlp -->
<g id="edge493" class="edge">
<title>layer_6_mlp_fc1_gpu3&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M1680.4,-13494.08C1685.94,-13485.27 1692.27,-13475.21 1698.24,-13465.73"/>
<polygon fill="black" stroke="black" points="1701.22,-13467.56 1703.58,-13457.23 1695.3,-13463.83 1701.22,-13467.56"/>
</g>
<!-- layer_6_mlp_fc1_gpu4&#45;&gt;layer_6_allgather_mlp -->
<g id="edge494" class="edge">
<title>layer_6_mlp_fc1_gpu4&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M1760.6,-13494.08C1755.06,-13485.27 1748.73,-13475.21 1742.76,-13465.73"/>
<polygon fill="black" stroke="black" points="1745.7,-13463.83 1737.42,-13457.23 1739.78,-13467.56 1745.7,-13463.83"/>
</g>
<!-- layer_6_mlp_fc1_gpu5&#45;&gt;layer_6_allgather_mlp -->
<g id="edge495" class="edge">
<title>layer_6_mlp_fc1_gpu5&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M1841.26,-13494.32C1818.29,-13482.16 1790.77,-13467.57 1767.8,-13455.41"/>
<polygon fill="black" stroke="black" points="1769.39,-13452.29 1758.91,-13450.7 1766.11,-13458.48 1769.39,-13452.29"/>
</g>
<!-- layer_6_mlp_fc1_gpu6&#45;&gt;layer_6_allgather_mlp -->
<g id="edge496" class="edge">
<title>layer_6_mlp_fc1_gpu6&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M1953.34,-13497.73C1950.36,-13496.54 1947.4,-13495.4 1944.5,-13494.34 1889.97,-13474.5 1826.21,-13456.8 1780.68,-13445.07"/>
<polygon fill="black" stroke="black" points="1781.53,-13441.67 1770.97,-13442.59 1779.79,-13448.46 1781.53,-13441.67"/>
</g>
<!-- layer_6_mlp_fc1_gpu7&#45;&gt;layer_6_allgather_mlp -->
<g id="edge497" class="edge">
<title>layer_6_mlp_fc1_gpu7&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M2065.44,-13497.41C2062.44,-13496.3 2059.45,-13495.27 2056.5,-13494.34 1964.48,-13465.47 1853.98,-13447.48 1785.49,-13438.18"/>
<polygon fill="black" stroke="black" points="1785.66,-13434.67 1775.28,-13436.82 1784.73,-13441.61 1785.66,-13434.67"/>
</g>
<!-- layer_6_gelu -->
<g id="node298" class="node">
<title>layer_6_gelu</title>
<polygon fill="lightblue" stroke="black" points="1765,-13364.36 1676,-13364.36 1676,-13328.36 1765,-13328.36 1765,-13364.36"/>
<text text-anchor="middle" x="1720.5" y="-13349.36" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1720.5" y="-13338.36" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_6_allgather_mlp&#45;&gt;layer_6_gelu -->
<g id="edge498" class="edge">
<title>layer_6_allgather_mlp&#45;&gt;layer_6_gelu</title>
<path fill="none" stroke="black" d="M1720.5,-13400.03C1720.5,-13391.78 1720.5,-13382.79 1720.5,-13374.61"/>
<polygon fill="black" stroke="black" points="1724,-13374.46 1720.5,-13364.46 1717,-13374.46 1724,-13374.46"/>
</g>
<!-- layer_6_mlp_fc2_gpu0 -->
<g id="node299" class="node">
<title>layer_6_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1375.5,-13292.36 1281.5,-13292.36 1281.5,-13240.36 1375.5,-13240.36 1375.5,-13292.36"/>
<text text-anchor="middle" x="1328.5" y="-13280.36" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="1328.5" y="-13269.36" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1328.5" y="-13258.36" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1328.5" y="-13247.36" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu0 -->
<g id="edge499" class="edge">
<title>layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu0</title>
<path fill="none" stroke="black" d="M1675.92,-13342.09C1612.69,-13336.63 1493.52,-13323.34 1385.29,-13292.26"/>
<polygon fill="black" stroke="black" points="1386.1,-13288.86 1375.52,-13289.4 1384.14,-13295.57 1386.1,-13288.86"/>
</g>
<!-- layer_6_mlp_fc2_gpu1 -->
<g id="node300" class="node">
<title>layer_6_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1487.5,-13292.36 1393.5,-13292.36 1393.5,-13240.36 1487.5,-13240.36 1487.5,-13292.36"/>
<text text-anchor="middle" x="1440.5" y="-13280.36" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="1440.5" y="-13269.36" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1440.5" y="-13258.36" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1440.5" y="-13247.36" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu1 -->
<g id="edge500" class="edge">
<title>layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu1</title>
<path fill="none" stroke="black" d="M1675.61,-13337.32C1632.02,-13328.94 1564.01,-13314.36 1497.42,-13292.43"/>
<polygon fill="black" stroke="black" points="1498.2,-13289 1487.61,-13289.14 1495.98,-13295.64 1498.2,-13289"/>
</g>
<!-- layer_6_mlp_fc2_gpu2 -->
<g id="node301" class="node">
<title>layer_6_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1599.5,-13292.36 1505.5,-13292.36 1505.5,-13240.36 1599.5,-13240.36 1599.5,-13292.36"/>
<text text-anchor="middle" x="1552.5" y="-13280.36" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="1552.5" y="-13269.36" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1552.5" y="-13258.36" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1552.5" y="-13247.36" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu2 -->
<g id="edge501" class="edge">
<title>layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu2</title>
<path fill="none" stroke="black" d="M1683.63,-13328.24C1661.71,-13318.06 1633.45,-13304.94 1608.78,-13293.49"/>
<polygon fill="black" stroke="black" points="1610.06,-13290.23 1599.52,-13289.19 1607.12,-13296.58 1610.06,-13290.23"/>
</g>
<!-- layer_6_mlp_fc2_gpu3 -->
<g id="node302" class="node">
<title>layer_6_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1711.5,-13292.36 1617.5,-13292.36 1617.5,-13240.36 1711.5,-13240.36 1711.5,-13292.36"/>
<text text-anchor="middle" x="1664.5" y="-13280.36" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="1664.5" y="-13269.36" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1664.5" y="-13258.36" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1664.5" y="-13247.36" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu3 -->
<g id="edge502" class="edge">
<title>layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu3</title>
<path fill="none" stroke="black" d="M1708.07,-13328.05C1702.35,-13320.08 1695.35,-13310.33 1688.65,-13301.01"/>
<polygon fill="black" stroke="black" points="1691.31,-13298.7 1682.63,-13292.62 1685.62,-13302.78 1691.31,-13298.7"/>
</g>
<!-- layer_6_mlp_fc2_gpu4 -->
<g id="node303" class="node">
<title>layer_6_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1823.5,-13292.36 1729.5,-13292.36 1729.5,-13240.36 1823.5,-13240.36 1823.5,-13292.36"/>
<text text-anchor="middle" x="1776.5" y="-13280.36" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="1776.5" y="-13269.36" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1776.5" y="-13258.36" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1776.5" y="-13247.36" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu4 -->
<g id="edge503" class="edge">
<title>layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu4</title>
<path fill="none" stroke="black" d="M1732.93,-13328.05C1738.65,-13320.08 1745.65,-13310.33 1752.35,-13301.01"/>
<polygon fill="black" stroke="black" points="1755.38,-13302.78 1758.37,-13292.62 1749.69,-13298.7 1755.38,-13302.78"/>
</g>
<!-- layer_6_mlp_fc2_gpu5 -->
<g id="node304" class="node">
<title>layer_6_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1935.5,-13292.36 1841.5,-13292.36 1841.5,-13240.36 1935.5,-13240.36 1935.5,-13292.36"/>
<text text-anchor="middle" x="1888.5" y="-13280.36" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="1888.5" y="-13269.36" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1888.5" y="-13258.36" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1888.5" y="-13247.36" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu5 -->
<g id="edge504" class="edge">
<title>layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu5</title>
<path fill="none" stroke="black" d="M1757.37,-13328.24C1779.29,-13318.06 1807.55,-13304.94 1832.22,-13293.49"/>
<polygon fill="black" stroke="black" points="1833.88,-13296.58 1841.48,-13289.19 1830.94,-13290.23 1833.88,-13296.58"/>
</g>
<!-- layer_6_mlp_fc2_gpu6 -->
<g id="node305" class="node">
<title>layer_6_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2047.5,-13292.36 1953.5,-13292.36 1953.5,-13240.36 2047.5,-13240.36 2047.5,-13292.36"/>
<text text-anchor="middle" x="2000.5" y="-13280.36" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="2000.5" y="-13269.36" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2000.5" y="-13258.36" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2000.5" y="-13247.36" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu6 -->
<g id="edge505" class="edge">
<title>layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu6</title>
<path fill="none" stroke="black" d="M1765.39,-13337.32C1808.98,-13328.94 1876.99,-13314.36 1943.58,-13292.43"/>
<polygon fill="black" stroke="black" points="1945.02,-13295.64 1953.39,-13289.14 1942.8,-13289 1945.02,-13295.64"/>
</g>
<!-- layer_6_mlp_fc2_gpu7 -->
<g id="node306" class="node">
<title>layer_6_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2159.5,-13292.36 2065.5,-13292.36 2065.5,-13240.36 2159.5,-13240.36 2159.5,-13292.36"/>
<text text-anchor="middle" x="2112.5" y="-13280.36" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="2112.5" y="-13269.36" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2112.5" y="-13258.36" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2112.5" y="-13247.36" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu7 -->
<g id="edge506" class="edge">
<title>layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu7</title>
<path fill="none" stroke="black" d="M1765.08,-13342.09C1828.31,-13336.63 1947.48,-13323.34 2055.71,-13292.26"/>
<polygon fill="black" stroke="black" points="2056.86,-13295.57 2065.48,-13289.4 2054.9,-13288.86 2056.86,-13295.57"/>
</g>
<!-- layer_6_allreduce_mlp -->
<g id="node307" class="node">
<title>layer_6_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="1776.5" cy="-13175.37" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="1776.5" y="-13183.87" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1776.5" y="-13172.87" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="1776.5" y="-13161.87" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_6_mlp_fc2_gpu0&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge507" class="edge">
<title>layer_6_mlp_fc2_gpu0&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1375.53,-13243.34C1378.54,-13242.25 1381.54,-13241.25 1384.5,-13240.36 1494.66,-13207.39 1627.65,-13190.22 1706.97,-13182.26"/>
<polygon fill="black" stroke="black" points="1707.71,-13185.7 1717.32,-13181.24 1707.03,-13178.73 1707.71,-13185.7"/>
</g>
<!-- layer_6_mlp_fc2_gpu1&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge508" class="edge">
<title>layer_6_mlp_fc2_gpu1&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1487.6,-13243.56C1490.59,-13242.42 1493.57,-13241.34 1496.5,-13240.36 1568.11,-13216.45 1652.96,-13198.44 1710.34,-13187.71"/>
<polygon fill="black" stroke="black" points="1711.17,-13191.12 1720.37,-13185.86 1709.9,-13184.23 1711.17,-13191.12"/>
</g>
<!-- layer_6_mlp_fc2_gpu2&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge509" class="edge">
<title>layer_6_mlp_fc2_gpu2&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1599.78,-13244.03C1602.72,-13242.77 1605.65,-13241.54 1608.5,-13240.36 1645.39,-13225.12 1687.34,-13209.14 1720.1,-13196.96"/>
<polygon fill="black" stroke="black" points="1721.35,-13200.22 1729.51,-13193.47 1718.92,-13193.66 1721.35,-13200.22"/>
</g>
<!-- layer_6_mlp_fc2_gpu3&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge510" class="edge">
<title>layer_6_mlp_fc2_gpu3&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1696,-13240.34C1709.09,-13229.94 1724.4,-13217.77 1738.14,-13206.85"/>
<polygon fill="black" stroke="black" points="1740.36,-13209.56 1746.01,-13200.6 1736.01,-13204.08 1740.36,-13209.56"/>
</g>
<!-- layer_6_mlp_fc2_gpu4&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge511" class="edge">
<title>layer_6_mlp_fc2_gpu4&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1776.5,-13240.1C1776.5,-13232.21 1776.5,-13223.32 1776.5,-13214.74"/>
<polygon fill="black" stroke="black" points="1780,-13214.51 1776.5,-13204.51 1773,-13214.51 1780,-13214.51"/>
</g>
<!-- layer_6_mlp_fc2_gpu5&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge512" class="edge">
<title>layer_6_mlp_fc2_gpu5&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1857,-13240.34C1843.91,-13229.94 1828.6,-13217.77 1814.86,-13206.85"/>
<polygon fill="black" stroke="black" points="1816.99,-13204.08 1806.99,-13200.6 1812.64,-13209.56 1816.99,-13204.08"/>
</g>
<!-- layer_6_mlp_fc2_gpu6&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge513" class="edge">
<title>layer_6_mlp_fc2_gpu6&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1953.22,-13244.03C1950.28,-13242.77 1947.35,-13241.54 1944.5,-13240.36 1907.61,-13225.12 1865.66,-13209.14 1832.9,-13196.96"/>
<polygon fill="black" stroke="black" points="1834.08,-13193.66 1823.49,-13193.47 1831.65,-13200.22 1834.08,-13193.66"/>
</g>
<!-- layer_6_mlp_fc2_gpu7&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge514" class="edge">
<title>layer_6_mlp_fc2_gpu7&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2065.4,-13243.56C2062.41,-13242.42 2059.43,-13241.34 2056.5,-13240.36 1984.89,-13216.45 1900.04,-13198.44 1842.66,-13187.71"/>
<polygon fill="black" stroke="black" points="1843.1,-13184.23 1832.63,-13185.86 1841.83,-13191.12 1843.1,-13184.23"/>
</g>
<!-- layer_6_allreduce_mlp&#45;&gt;layer_6_residual2 -->
<g id="edge515" class="edge">
<title>layer_6_allreduce_mlp&#45;&gt;layer_6_residual2</title>
<path fill="none" stroke="black" d="M1819.47,-13154.88C1849.5,-13141.26 1889.96,-13122.9 1922.93,-13107.95"/>
<polygon fill="black" stroke="black" points="1924.8,-13110.94 1932.46,-13103.62 1921.91,-13104.57 1924.8,-13110.94"/>
</g>
<!-- layer_6_ln2 -->
<g id="node309" class="node">
<title>layer_6_ln2</title>
<polygon fill="lightblue" stroke="black" points="2018,-13014.38 1945,-13014.38 1945,-12973.38 2018,-12973.38 2018,-13014.38"/>
<text text-anchor="middle" x="1981.5" y="-13002.38" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1981.5" y="-12991.38" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="1981.5" y="-12980.38" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_6_residual2&#45;&gt;layer_6_ln2 -->
<g id="edge517" class="edge">
<title>layer_6_residual2&#45;&gt;layer_6_ln2</title>
<path fill="none" stroke="black" d="M1981.5,-13050.3C1981.5,-13041.97 1981.5,-13032.89 1981.5,-13024.53"/>
<polygon fill="black" stroke="black" points="1985,-13024.44 1981.5,-13014.44 1978,-13024.44 1985,-13024.44"/>
</g>
<!-- layer_6_output_dist -->
<g id="node310" class="node">
<title>layer_6_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="2083.2,-12937.38 1921.42,-12937.38 1879.8,-12877.38 2041.58,-12877.38 2083.2,-12937.38"/>
<text text-anchor="middle" x="1981.5" y="-12910.38" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="1981.5" y="-12899.38" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_6_ln2&#45;&gt;layer_6_output_dist -->
<g id="edge518" class="edge">
<title>layer_6_ln2&#45;&gt;layer_6_output_dist</title>
<path fill="none" stroke="black" d="M1981.5,-12973.28C1981.5,-12965.64 1981.5,-12956.6 1981.5,-12947.73"/>
<polygon fill="black" stroke="black" points="1985,-12947.49 1981.5,-12937.49 1978,-12947.49 1985,-12947.49"/>
</g>
<!-- layer_7_input_dist -->
<g id="node311" class="node">
<title>layer_7_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="2075.69,-12841.38 1925.86,-12841.38 1887.31,-12781.38 2037.14,-12781.38 2075.69,-12841.38"/>
<text text-anchor="middle" x="1981.5" y="-12814.38" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1981.5" y="-12803.38" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_6_output_dist&#45;&gt;layer_7_input_dist -->
<g id="edge519" class="edge">
<title>layer_6_output_dist&#45;&gt;layer_7_input_dist</title>
<path fill="none" stroke="black" d="M1981.5,-12877.15C1981.5,-12869.11 1981.5,-12860.24 1981.5,-12851.73"/>
<polygon fill="black" stroke="black" points="1985,-12851.59 1981.5,-12841.59 1978,-12851.59 1985,-12851.59"/>
</g>
<!-- layer_7_qkv_gpu0 -->
<g id="node312" class="node">
<title>layer_7_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1584,-12745.38 1491,-12745.38 1491,-12693.38 1584,-12693.38 1584,-12745.38"/>
<text text-anchor="middle" x="1537.5" y="-12733.38" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="1537.5" y="-12722.38" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1537.5" y="-12711.38" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1537.5" y="-12700.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu0 -->
<g id="edge520" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1901,-12802.92C1823.82,-12794.41 1704.31,-12777.67 1593.86,-12745.16"/>
<polygon fill="black" stroke="black" points="1594.81,-12741.79 1584.22,-12742.27 1592.8,-12748.49 1594.81,-12741.79"/>
</g>
<!-- layer_7_qkv_gpu1 -->
<g id="node313" class="node">
<title>layer_7_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1695,-12745.38 1602,-12745.38 1602,-12693.38 1695,-12693.38 1695,-12745.38"/>
<text text-anchor="middle" x="1648.5" y="-12733.38" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="1648.5" y="-12722.38" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1648.5" y="-12711.38" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1648.5" y="-12700.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu1 -->
<g id="edge521" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1895.78,-12794.63C1842.93,-12783.91 1773.87,-12768.07 1705.01,-12745.3"/>
<polygon fill="black" stroke="black" points="1705.89,-12741.91 1695.3,-12742.04 1703.66,-12748.54 1705.89,-12741.91"/>
</g>
<!-- layer_7_qkv_gpu2 -->
<g id="node314" class="node">
<title>layer_7_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1806,-12745.38 1713,-12745.38 1713,-12693.38 1806,-12693.38 1806,-12745.38"/>
<text text-anchor="middle" x="1759.5" y="-12733.38" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="1759.5" y="-12722.38" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1759.5" y="-12711.38" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1759.5" y="-12700.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu2 -->
<g id="edge522" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1905.17,-12781.35C1876.89,-12770.37 1844.62,-12757.57 1815.5,-12745.38 1815.4,-12745.34 1815.31,-12745.3 1815.21,-12745.26"/>
<polygon fill="black" stroke="black" points="1816.75,-12742.11 1806.18,-12741.41 1814.01,-12748.55 1816.75,-12742.11"/>
</g>
<!-- layer_7_qkv_gpu3 -->
<g id="node315" class="node">
<title>layer_7_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1917,-12745.38 1824,-12745.38 1824,-12693.38 1917,-12693.38 1917,-12745.38"/>
<text text-anchor="middle" x="1870.5" y="-12733.38" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="1870.5" y="-12722.38" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1870.5" y="-12711.38" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1870.5" y="-12700.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu3 -->
<g id="edge523" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1945.46,-12781.16C1933.94,-12771.82 1921.14,-12761.44 1909.42,-12751.94"/>
<polygon fill="black" stroke="black" points="1911.48,-12749.1 1901.51,-12745.52 1907.08,-12754.54 1911.48,-12749.1"/>
</g>
<!-- layer_7_qkv_gpu4 -->
<g id="node316" class="node">
<title>layer_7_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2028,-12745.38 1935,-12745.38 1935,-12693.38 2028,-12693.38 2028,-12745.38"/>
<text text-anchor="middle" x="1981.5" y="-12733.38" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="1981.5" y="-12722.38" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1981.5" y="-12711.38" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1981.5" y="-12700.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu4 -->
<g id="edge524" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1981.5,-12780.91C1981.5,-12772.84 1981.5,-12764 1981.5,-12755.64"/>
<polygon fill="black" stroke="black" points="1985,-12755.39 1981.5,-12745.39 1978,-12755.39 1985,-12755.39"/>
</g>
<!-- layer_7_qkv_gpu5 -->
<g id="node317" class="node">
<title>layer_7_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2139,-12745.38 2046,-12745.38 2046,-12693.38 2139,-12693.38 2139,-12745.38"/>
<text text-anchor="middle" x="2092.5" y="-12733.38" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="2092.5" y="-12722.38" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2092.5" y="-12711.38" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2092.5" y="-12700.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu5 -->
<g id="edge525" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu5</title>
<path fill="none" stroke="black" d="M2017.54,-12781.16C2029.06,-12771.82 2041.86,-12761.44 2053.58,-12751.94"/>
<polygon fill="black" stroke="black" points="2055.92,-12754.54 2061.49,-12745.52 2051.52,-12749.1 2055.92,-12754.54"/>
</g>
<!-- layer_7_qkv_gpu6 -->
<g id="node318" class="node">
<title>layer_7_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2250,-12745.38 2157,-12745.38 2157,-12693.38 2250,-12693.38 2250,-12745.38"/>
<text text-anchor="middle" x="2203.5" y="-12733.38" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="2203.5" y="-12722.38" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2203.5" y="-12711.38" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2203.5" y="-12700.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu6 -->
<g id="edge526" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu6</title>
<path fill="none" stroke="black" d="M2041.73,-12787.86C2071.33,-12776.58 2107.68,-12762.41 2147.42,-12745.77"/>
<polygon fill="black" stroke="black" points="2148.91,-12748.94 2156.77,-12741.83 2146.2,-12742.49 2148.91,-12748.94"/>
</g>
<!-- layer_7_qkv_gpu7 -->
<g id="node319" class="node">
<title>layer_7_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2361,-12745.38 2268,-12745.38 2268,-12693.38 2361,-12693.38 2361,-12745.38"/>
<text text-anchor="middle" x="2314.5" y="-12733.38" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="2314.5" y="-12722.38" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2314.5" y="-12711.38" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2314.5" y="-12700.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu7 -->
<g id="edge527" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu7</title>
<path fill="none" stroke="black" d="M2048.25,-12798.61C2102.88,-12788.11 2182.07,-12770.91 2258.2,-12745.59"/>
<polygon fill="black" stroke="black" points="2259.59,-12748.81 2267.95,-12742.29 2257.35,-12742.18 2259.59,-12748.81"/>
</g>
<!-- layer_7_residual1 -->
<g id="node331" class="node">
<title>layer_7_residual1</title>
<polygon fill="lightyellow" stroke="black" points="2271.44,-12293.41 2149.05,-12293.41 2117.56,-12233.41 2239.95,-12233.41 2271.44,-12293.41"/>
<text text-anchor="middle" x="2194.5" y="-12266.41" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="2194.5" y="-12255.41" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_residual1 -->
<g id="edge554" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_residual1</title>
<path fill="none" stroke="black" d="M2054.59,-12808.03C2154.77,-12803.23 2327.3,-12788.72 2370.5,-12745.38 2407.38,-12708.38 2389.5,-12681.63 2389.5,-12629.39 2389.5,-12629.39 2389.5,-12629.39 2389.5,-12448.4 2389.5,-12379.62 2324.52,-12328.94 2269.59,-12298.38"/>
<polygon fill="black" stroke="black" points="2270.98,-12295.15 2260.52,-12293.46 2267.64,-12301.31 2270.98,-12295.15"/>
</g>
<!-- layer_7_allgather_qkv -->
<g id="node320" class="node">
<title>layer_7_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="1937.5" cy="-12628.39" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="1937.5" y="-12636.89" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1937.5" y="-12625.89" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="1937.5" y="-12614.89" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_7_qkv_gpu0&#45;&gt;layer_7_allgather_qkv -->
<g id="edge528" class="edge">
<title>layer_7_qkv_gpu0&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M1584.24,-12696.55C1587.35,-12695.4 1590.45,-12694.33 1593.5,-12693.38 1688.17,-12663.9 1801.96,-12646 1872.01,-12636.89"/>
<polygon fill="black" stroke="black" points="1872.54,-12640.35 1882.02,-12635.61 1871.65,-12633.41 1872.54,-12640.35"/>
</g>
<!-- layer_7_qkv_gpu1&#45;&gt;layer_7_allgather_qkv -->
<g id="edge529" class="edge">
<title>layer_7_qkv_gpu1&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M1695.03,-12696.97C1698.22,-12695.7 1701.39,-12694.49 1704.5,-12693.38 1761.65,-12672.91 1828.64,-12655.13 1876.08,-12643.55"/>
<polygon fill="black" stroke="black" points="1877,-12646.93 1885.9,-12641.17 1875.36,-12640.12 1877,-12646.93"/>
</g>
<!-- layer_7_qkv_gpu2&#45;&gt;layer_7_allgather_qkv -->
<g id="edge530" class="edge">
<title>layer_7_qkv_gpu2&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M1806.27,-12695C1831.59,-12682.34 1862.84,-12666.71 1888.5,-12653.89"/>
<polygon fill="black" stroke="black" points="1890.3,-12656.9 1897.68,-12649.3 1887.17,-12650.64 1890.3,-12656.9"/>
</g>
<!-- layer_7_qkv_gpu3&#45;&gt;layer_7_allgather_qkv -->
<g id="edge531" class="edge">
<title>layer_7_qkv_gpu3&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M1889.52,-12693.12C1896.41,-12683.96 1904.32,-12673.47 1911.69,-12663.67"/>
<polygon fill="black" stroke="black" points="1914.51,-12665.74 1917.73,-12655.64 1908.92,-12661.53 1914.51,-12665.74"/>
</g>
<!-- layer_7_qkv_gpu4&#45;&gt;layer_7_allgather_qkv -->
<g id="edge532" class="edge">
<title>layer_7_qkv_gpu4&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M1969.01,-12693.12C1964.78,-12684.56 1959.97,-12674.83 1955.4,-12665.59"/>
<polygon fill="black" stroke="black" points="1958.52,-12664 1950.95,-12656.58 1952.24,-12667.1 1958.52,-12664"/>
</g>
<!-- layer_7_qkv_gpu5&#45;&gt;layer_7_allgather_qkv -->
<g id="edge533" class="edge">
<title>layer_7_qkv_gpu5&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M2048.91,-12693.35C2028.48,-12681.62 2004.12,-12667.64 1983.4,-12655.74"/>
<polygon fill="black" stroke="black" points="1984.88,-12652.56 1974.47,-12650.61 1981.4,-12658.63 1984.88,-12652.56"/>
</g>
<!-- layer_7_qkv_gpu6&#45;&gt;layer_7_allgather_qkv -->
<g id="edge534" class="edge">
<title>layer_7_qkv_gpu6&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M2156.87,-12696.68C2154.05,-12695.52 2151.25,-12694.42 2148.5,-12693.38 2098.32,-12674.46 2039.88,-12657.09 1997.24,-12645.23"/>
<polygon fill="black" stroke="black" points="1998.15,-12641.85 1987.57,-12642.56 1996.28,-12648.6 1998.15,-12641.85"/>
</g>
<!-- layer_7_qkv_gpu7&#45;&gt;layer_7_allgather_qkv -->
<g id="edge535" class="edge">
<title>layer_7_qkv_gpu7&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M2267.98,-12696.35C2265.14,-12695.28 2262.3,-12694.28 2259.5,-12693.38 2172.72,-12665.45 2068.69,-12647.44 2002.83,-12637.86"/>
<polygon fill="black" stroke="black" points="2002.99,-12634.35 1992.6,-12636.39 2002,-12641.27 2002.99,-12634.35"/>
</g>
<!-- layer_7_attention -->
<g id="node321" class="node">
<title>layer_7_attention</title>
<polygon fill="lightblue" stroke="black" points="1971.5,-12563.4 1903.5,-12563.4 1903.5,-12511.4 1971.5,-12511.4 1971.5,-12563.4"/>
<text text-anchor="middle" x="1937.5" y="-12551.4" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1937.5" y="-12540.4" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1937.5" y="-12529.4" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="1937.5" y="-12518.4" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_7_allgather_qkv&#45;&gt;layer_7_attention -->
<g id="edge536" class="edge">
<title>layer_7_allgather_qkv&#45;&gt;layer_7_attention</title>
<path fill="none" stroke="black" d="M1937.5,-12599.23C1937.5,-12591.12 1937.5,-12582.17 1937.5,-12573.69"/>
<polygon fill="black" stroke="black" points="1941,-12573.66 1937.5,-12563.66 1934,-12573.66 1941,-12573.66"/>
</g>
<!-- layer_7_attn_out_gpu0 -->
<g id="node322" class="node">
<title>layer_7_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1619.5,-12475.4 1531.5,-12475.4 1531.5,-12423.4 1619.5,-12423.4 1619.5,-12475.4"/>
<text text-anchor="middle" x="1575.5" y="-12463.4" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="1575.5" y="-12452.4" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1575.5" y="-12441.4" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1575.5" y="-12430.4" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attention&#45;&gt;layer_7_attn_out_gpu0 -->
<g id="edge537" class="edge">
<title>layer_7_attention&#45;&gt;layer_7_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M1903.43,-12532.46C1847.48,-12525.39 1732.85,-12508.42 1629.37,-12475.36"/>
<polygon fill="black" stroke="black" points="1630.3,-12471.98 1619.71,-12472.22 1628.13,-12478.64 1630.3,-12471.98"/>
</g>
<!-- layer_7_attn_out_gpu1 -->
<g id="node323" class="node">
<title>layer_7_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1725.5,-12475.4 1637.5,-12475.4 1637.5,-12423.4 1725.5,-12423.4 1725.5,-12475.4"/>
<text text-anchor="middle" x="1681.5" y="-12463.4" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="1681.5" y="-12452.4" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1681.5" y="-12441.4" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1681.5" y="-12430.4" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attention&#45;&gt;layer_7_attn_out_gpu1 -->
<g id="edge538" class="edge">
<title>layer_7_attention&#45;&gt;layer_7_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M1903.22,-12527.77C1864.35,-12517.62 1799.05,-12499.48 1734.97,-12475.37"/>
<polygon fill="black" stroke="black" points="1736.12,-12472.06 1725.53,-12471.77 1733.63,-12478.6 1736.12,-12472.06"/>
</g>
<!-- layer_7_attn_out_gpu2 -->
<g id="node324" class="node">
<title>layer_7_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1831.5,-12475.4 1743.5,-12475.4 1743.5,-12423.4 1831.5,-12423.4 1831.5,-12475.4"/>
<text text-anchor="middle" x="1787.5" y="-12463.4" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="1787.5" y="-12452.4" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1787.5" y="-12441.4" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1787.5" y="-12430.4" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attention&#45;&gt;layer_7_attn_out_gpu2 -->
<g id="edge539" class="edge">
<title>layer_7_attention&#45;&gt;layer_7_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M1903.46,-12516.88C1884.78,-12506.17 1861.21,-12492.66 1840.2,-12480.61"/>
<polygon fill="black" stroke="black" points="1841.8,-12477.49 1831.38,-12475.55 1838.31,-12483.56 1841.8,-12477.49"/>
</g>
<!-- layer_7_attn_out_gpu3 -->
<g id="node325" class="node">
<title>layer_7_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1937.5,-12475.4 1849.5,-12475.4 1849.5,-12423.4 1937.5,-12423.4 1937.5,-12475.4"/>
<text text-anchor="middle" x="1893.5" y="-12463.4" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="1893.5" y="-12452.4" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1893.5" y="-12441.4" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1893.5" y="-12430.4" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attention&#45;&gt;layer_7_attn_out_gpu3 -->
<g id="edge540" class="edge">
<title>layer_7_attention&#45;&gt;layer_7_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M1924.54,-12511.06C1920.28,-12502.75 1915.49,-12493.37 1910.96,-12484.52"/>
<polygon fill="black" stroke="black" points="1914.04,-12482.86 1906.37,-12475.55 1907.81,-12486.05 1914.04,-12482.86"/>
</g>
<!-- layer_7_attn_out_gpu4 -->
<g id="node326" class="node">
<title>layer_7_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2043.5,-12475.4 1955.5,-12475.4 1955.5,-12423.4 2043.5,-12423.4 2043.5,-12475.4"/>
<text text-anchor="middle" x="1999.5" y="-12463.4" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="1999.5" y="-12452.4" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1999.5" y="-12441.4" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1999.5" y="-12430.4" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attention&#45;&gt;layer_7_attn_out_gpu4 -->
<g id="edge541" class="edge">
<title>layer_7_attention&#45;&gt;layer_7_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M1955.77,-12511.06C1961.95,-12502.49 1968.95,-12492.78 1975.5,-12483.68"/>
<polygon fill="black" stroke="black" points="1978.35,-12485.71 1981.36,-12475.55 1972.68,-12481.62 1978.35,-12485.71"/>
</g>
<!-- layer_7_attn_out_gpu5 -->
<g id="node327" class="node">
<title>layer_7_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2149.5,-12475.4 2061.5,-12475.4 2061.5,-12423.4 2149.5,-12423.4 2149.5,-12475.4"/>
<text text-anchor="middle" x="2105.5" y="-12463.4" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="2105.5" y="-12452.4" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2105.5" y="-12441.4" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2105.5" y="-12430.4" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attention&#45;&gt;layer_7_attn_out_gpu5 -->
<g id="edge542" class="edge">
<title>layer_7_attention&#45;&gt;layer_7_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M1971.9,-12518.79C1995,-12506.96 2025.9,-12491.14 2052.16,-12477.7"/>
<polygon fill="black" stroke="black" points="2053.93,-12480.73 2061.24,-12473.06 2050.74,-12474.5 2053.93,-12480.73"/>
</g>
<!-- layer_7_attn_out_gpu6 -->
<g id="node328" class="node">
<title>layer_7_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2255.5,-12475.4 2167.5,-12475.4 2167.5,-12423.4 2255.5,-12423.4 2255.5,-12475.4"/>
<text text-anchor="middle" x="2211.5" y="-12463.4" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="2211.5" y="-12452.4" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2211.5" y="-12441.4" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2211.5" y="-12430.4" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attention&#45;&gt;layer_7_attn_out_gpu6 -->
<g id="edge543" class="edge">
<title>layer_7_attention&#45;&gt;layer_7_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M1971.77,-12528.87C2013.82,-12519.21 2087.28,-12500.99 2157.99,-12475.34"/>
<polygon fill="black" stroke="black" points="2159.32,-12478.58 2167.5,-12471.84 2156.9,-12472.01 2159.32,-12478.58"/>
</g>
<!-- layer_7_attn_out_gpu7 -->
<g id="node329" class="node">
<title>layer_7_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2361.5,-12475.4 2273.5,-12475.4 2273.5,-12423.4 2361.5,-12423.4 2361.5,-12475.4"/>
<text text-anchor="middle" x="2317.5" y="-12463.4" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="2317.5" y="-12452.4" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2317.5" y="-12441.4" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2317.5" y="-12430.4" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attention&#45;&gt;layer_7_attn_out_gpu7 -->
<g id="edge544" class="edge">
<title>layer_7_attention&#45;&gt;layer_7_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M1971.63,-12532.95C2030.2,-12526.41 2153.4,-12509.93 2263.69,-12475.32"/>
<polygon fill="black" stroke="black" points="2264.84,-12478.63 2273.3,-12472.25 2262.71,-12471.96 2264.84,-12478.63"/>
</g>
<!-- layer_7_allreduce_attn -->
<g id="node330" class="node">
<title>layer_7_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="1999.5" cy="-12358.41" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="1999.5" y="-12366.91" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1999.5" y="-12355.91" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="1999.5" y="-12344.91" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_7_attn_out_gpu0&#45;&gt;layer_7_allreduce_attn -->
<g id="edge545" class="edge">
<title>layer_7_attn_out_gpu0&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M1619.68,-12426.49C1622.63,-12425.36 1625.59,-12424.32 1628.5,-12423.4 1731.93,-12390.75 1857.16,-12373.54 1932.47,-12365.47"/>
<polygon fill="black" stroke="black" points="1933.17,-12368.91 1942.75,-12364.39 1932.44,-12361.95 1933.17,-12368.91"/>
</g>
<!-- layer_7_attn_out_gpu1&#45;&gt;layer_7_allreduce_attn -->
<g id="edge546" class="edge">
<title>layer_7_attn_out_gpu1&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M1725.76,-12426.72C1728.69,-12425.53 1731.62,-12424.41 1734.5,-12423.4 1801.63,-12399.74 1881.34,-12381.79 1935.69,-12371.01"/>
<polygon fill="black" stroke="black" points="1936.39,-12374.44 1945.53,-12369.08 1935.04,-12367.57 1936.39,-12374.44"/>
</g>
<!-- layer_7_attn_out_gpu2&#45;&gt;layer_7_allreduce_attn -->
<g id="edge547" class="edge">
<title>layer_7_attn_out_gpu2&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M1831.66,-12427.33C1834.64,-12425.98 1837.61,-12424.66 1840.5,-12423.4 1874.83,-12408.41 1913.84,-12392.69 1944.63,-12380.58"/>
<polygon fill="black" stroke="black" points="1946.29,-12383.69 1954.32,-12376.78 1943.73,-12377.17 1946.29,-12383.69"/>
</g>
<!-- layer_7_attn_out_gpu3&#45;&gt;layer_7_allreduce_attn -->
<g id="edge548" class="edge">
<title>layer_7_attn_out_gpu3&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M1923.31,-12423.37C1935.58,-12413.07 1949.92,-12401.03 1962.83,-12390.19"/>
<polygon fill="black" stroke="black" points="1965.24,-12392.74 1970.65,-12383.63 1960.74,-12387.38 1965.24,-12392.74"/>
</g>
<!-- layer_7_attn_out_gpu4&#45;&gt;layer_7_allreduce_attn -->
<g id="edge549" class="edge">
<title>layer_7_attn_out_gpu4&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M1999.5,-12423.13C1999.5,-12415.24 1999.5,-12406.35 1999.5,-12397.77"/>
<polygon fill="black" stroke="black" points="2003,-12397.55 1999.5,-12387.55 1996,-12397.55 2003,-12397.55"/>
</g>
<!-- layer_7_attn_out_gpu5&#45;&gt;layer_7_allreduce_attn -->
<g id="edge550" class="edge">
<title>layer_7_attn_out_gpu5&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M2075.69,-12423.37C2063.42,-12413.07 2049.08,-12401.03 2036.17,-12390.19"/>
<polygon fill="black" stroke="black" points="2038.26,-12387.38 2028.35,-12383.63 2033.76,-12392.74 2038.26,-12387.38"/>
</g>
<!-- layer_7_attn_out_gpu6&#45;&gt;layer_7_allreduce_attn -->
<g id="edge551" class="edge">
<title>layer_7_attn_out_gpu6&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M2167.34,-12427.33C2164.36,-12425.98 2161.39,-12424.66 2158.5,-12423.4 2124.17,-12408.41 2085.16,-12392.69 2054.37,-12380.58"/>
<polygon fill="black" stroke="black" points="2055.27,-12377.17 2044.68,-12376.78 2052.71,-12383.69 2055.27,-12377.17"/>
</g>
<!-- layer_7_attn_out_gpu7&#45;&gt;layer_7_allreduce_attn -->
<g id="edge552" class="edge">
<title>layer_7_attn_out_gpu7&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M2273.24,-12426.72C2270.31,-12425.53 2267.38,-12424.41 2264.5,-12423.4 2197.37,-12399.74 2117.66,-12381.79 2063.31,-12371.01"/>
<polygon fill="black" stroke="black" points="2063.96,-12367.57 2053.47,-12369.08 2062.61,-12374.44 2063.96,-12367.57"/>
</g>
<!-- layer_7_allreduce_attn&#45;&gt;layer_7_residual1 -->
<g id="edge553" class="edge">
<title>layer_7_allreduce_attn&#45;&gt;layer_7_residual1</title>
<path fill="none" stroke="black" d="M2040.85,-12337.68C2068.62,-12324.45 2105.59,-12306.81 2136.31,-12292.16"/>
<polygon fill="black" stroke="black" points="2138.1,-12295.19 2145.62,-12287.72 2135.09,-12288.87 2138.1,-12295.19"/>
</g>
<!-- layer_7_ln1 -->
<g id="node332" class="node">
<title>layer_7_ln1</title>
<polygon fill="lightblue" stroke="black" points="2026,-12197.41 1953,-12197.41 1953,-12156.41 2026,-12156.41 2026,-12197.41"/>
<text text-anchor="middle" x="1989.5" y="-12185.41" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1989.5" y="-12174.41" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="1989.5" y="-12163.41" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_7_residual1&#45;&gt;layer_7_ln1 -->
<g id="edge555" class="edge">
<title>layer_7_residual1&#45;&gt;layer_7_ln1</title>
<path fill="none" stroke="black" d="M2123.95,-12233.33C2094.66,-12221.26 2061.49,-12207.59 2035.43,-12196.85"/>
<polygon fill="black" stroke="black" points="2036.75,-12193.6 2026.17,-12193.03 2034.08,-12200.08 2036.75,-12193.6"/>
</g>
<!-- layer_7_residual2 -->
<g id="node352" class="node">
<title>layer_7_residual2</title>
<polygon fill="lightyellow" stroke="black" points="2271.44,-11684.45 2149.05,-11684.45 2117.56,-11624.45 2239.95,-11624.45 2271.44,-11684.45"/>
<text text-anchor="middle" x="2194.5" y="-11657.45" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="2194.5" y="-11646.45" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_7_residual1&#45;&gt;layer_7_residual2 -->
<g id="edge590" class="edge">
<title>layer_7_residual1&#45;&gt;layer_7_residual2</title>
<path fill="none" stroke="black" d="M2246.48,-12245.85C2307.51,-12222.77 2400.5,-12174.6 2400.5,-12095.41 2400.5,-12095.41 2400.5,-12095.41 2400.5,-11839.43 2400.5,-11769.22 2333.11,-11719.14 2275.42,-11689.13"/>
<polygon fill="black" stroke="black" points="2276.76,-11685.88 2266.26,-11684.48 2273.6,-11692.13 2276.76,-11685.88"/>
</g>
<!-- layer_7_mlp_fc1_gpu0 -->
<g id="node333" class="node">
<title>layer_7_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1588.5,-12120.41 1494.5,-12120.41 1494.5,-12068.41 1588.5,-12068.41 1588.5,-12120.41"/>
<text text-anchor="middle" x="1541.5" y="-12108.41" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="1541.5" y="-12097.41" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1541.5" y="-12086.41" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1541.5" y="-12075.41" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu0 -->
<g id="edge556" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M1952.85,-12174.14C1884.28,-12170.08 1732.17,-12157.66 1598.13,-12120.25"/>
<polygon fill="black" stroke="black" points="1599.08,-12116.88 1588.51,-12117.51 1597.17,-12123.61 1599.08,-12116.88"/>
</g>
<!-- layer_7_mlp_fc1_gpu1 -->
<g id="node334" class="node">
<title>layer_7_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1700.5,-12120.41 1606.5,-12120.41 1606.5,-12068.41 1700.5,-12068.41 1700.5,-12120.41"/>
<text text-anchor="middle" x="1653.5" y="-12108.41" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="1653.5" y="-12097.41" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1653.5" y="-12086.41" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1653.5" y="-12075.41" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu1 -->
<g id="edge557" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M1952.6,-12171.29C1900.26,-12164.15 1801.55,-12148.55 1710.23,-12120.36"/>
<polygon fill="black" stroke="black" points="1711.16,-12116.98 1700.57,-12117.32 1709.05,-12123.66 1711.16,-12116.98"/>
</g>
<!-- layer_7_mlp_fc1_gpu2 -->
<g id="node335" class="node">
<title>layer_7_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1812.5,-12120.41 1718.5,-12120.41 1718.5,-12068.41 1812.5,-12068.41 1812.5,-12120.41"/>
<text text-anchor="middle" x="1765.5" y="-12108.41" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="1765.5" y="-12097.41" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1765.5" y="-12086.41" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1765.5" y="-12075.41" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu2 -->
<g id="edge558" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M1952.75,-12164.94C1920.47,-12155.05 1872.12,-12139.61 1822.08,-12120.5"/>
<polygon fill="black" stroke="black" points="1823.3,-12117.23 1812.72,-12116.89 1820.79,-12123.76 1823.3,-12117.23"/>
</g>
<!-- layer_7_mlp_fc1_gpu3 -->
<g id="node336" class="node">
<title>layer_7_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1924.5,-12120.41 1830.5,-12120.41 1830.5,-12068.41 1924.5,-12068.41 1924.5,-12120.41"/>
<text text-anchor="middle" x="1877.5" y="-12108.41" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="1877.5" y="-12097.41" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1877.5" y="-12086.41" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1877.5" y="-12075.41" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu3 -->
<g id="edge559" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M1962.1,-12156.22C1949.77,-12147.36 1934.9,-12136.67 1921.09,-12126.75"/>
<polygon fill="black" stroke="black" points="1922.83,-12123.68 1912.67,-12120.69 1918.74,-12129.37 1922.83,-12123.68"/>
</g>
<!-- layer_7_mlp_fc1_gpu4 -->
<g id="node337" class="node">
<title>layer_7_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2036.5,-12120.41 1942.5,-12120.41 1942.5,-12068.41 2036.5,-12068.41 2036.5,-12120.41"/>
<text text-anchor="middle" x="1989.5" y="-12108.41" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="1989.5" y="-12097.41" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1989.5" y="-12086.41" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1989.5" y="-12075.41" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu4 -->
<g id="edge560" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M1989.5,-12156.01C1989.5,-12148.4 1989.5,-12139.47 1989.5,-12130.84"/>
<polygon fill="black" stroke="black" points="1993,-12130.57 1989.5,-12120.57 1986,-12130.57 1993,-12130.57"/>
</g>
<!-- layer_7_mlp_fc1_gpu5 -->
<g id="node338" class="node">
<title>layer_7_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2148.5,-12120.41 2054.5,-12120.41 2054.5,-12068.41 2148.5,-12068.41 2148.5,-12120.41"/>
<text text-anchor="middle" x="2101.5" y="-12108.41" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="2101.5" y="-12097.41" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2101.5" y="-12086.41" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2101.5" y="-12075.41" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu5 -->
<g id="edge561" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M2016.9,-12156.22C2029.23,-12147.36 2044.1,-12136.67 2057.91,-12126.75"/>
<polygon fill="black" stroke="black" points="2060.26,-12129.37 2066.33,-12120.69 2056.17,-12123.68 2060.26,-12129.37"/>
</g>
<!-- layer_7_mlp_fc1_gpu6 -->
<g id="node339" class="node">
<title>layer_7_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2260.5,-12120.41 2166.5,-12120.41 2166.5,-12068.41 2260.5,-12068.41 2260.5,-12120.41"/>
<text text-anchor="middle" x="2213.5" y="-12108.41" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="2213.5" y="-12097.41" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2213.5" y="-12086.41" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2213.5" y="-12075.41" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu6 -->
<g id="edge562" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M2026.25,-12164.94C2058.53,-12155.05 2106.88,-12139.61 2156.92,-12120.5"/>
<polygon fill="black" stroke="black" points="2158.21,-12123.76 2166.28,-12116.89 2155.7,-12117.23 2158.21,-12123.76"/>
</g>
<!-- layer_7_mlp_fc1_gpu7 -->
<g id="node340" class="node">
<title>layer_7_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2372.5,-12120.41 2278.5,-12120.41 2278.5,-12068.41 2372.5,-12068.41 2372.5,-12120.41"/>
<text text-anchor="middle" x="2325.5" y="-12108.41" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="2325.5" y="-12097.41" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2325.5" y="-12086.41" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2325.5" y="-12075.41" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu7 -->
<g id="edge563" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M2026.4,-12171.29C2078.74,-12164.15 2177.45,-12148.55 2268.77,-12120.36"/>
<polygon fill="black" stroke="black" points="2269.95,-12123.66 2278.43,-12117.32 2267.84,-12116.98 2269.95,-12123.66"/>
</g>
<!-- layer_7_allgather_mlp -->
<g id="node341" class="node">
<title>layer_7_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="1933.5" cy="-12003.42" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="1933.5" y="-12011.92" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1933.5" y="-12000.92" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="1933.5" y="-11989.92" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_7_mlp_fc1_gpu0&#45;&gt;layer_7_allgather_mlp -->
<g id="edge564" class="edge">
<title>layer_7_mlp_fc1_gpu0&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M1588.56,-12071.48C1591.56,-12070.37 1594.55,-12069.34 1597.5,-12068.41 1689.52,-12039.54 1800.02,-12021.55 1868.51,-12012.25"/>
<polygon fill="black" stroke="black" points="1869.27,-12015.68 1878.72,-12010.89 1868.34,-12008.74 1869.27,-12015.68"/>
</g>
<!-- layer_7_mlp_fc1_gpu1&#45;&gt;layer_7_allgather_mlp -->
<g id="edge565" class="edge">
<title>layer_7_mlp_fc1_gpu1&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M1700.66,-12071.79C1703.64,-12070.61 1706.6,-12069.47 1709.5,-12068.41 1764.03,-12048.57 1827.79,-12030.87 1873.32,-12019.14"/>
<polygon fill="black" stroke="black" points="1874.21,-12022.53 1883.03,-12016.66 1872.47,-12015.74 1874.21,-12022.53"/>
</g>
<!-- layer_7_mlp_fc1_gpu2&#45;&gt;layer_7_allgather_mlp -->
<g id="edge566" class="edge">
<title>layer_7_mlp_fc1_gpu2&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M1812.74,-12068.39C1835.71,-12056.22 1863.23,-12041.64 1886.2,-12029.48"/>
<polygon fill="black" stroke="black" points="1887.89,-12032.54 1895.09,-12024.77 1884.61,-12026.36 1887.89,-12032.54"/>
</g>
<!-- layer_7_mlp_fc1_gpu3&#45;&gt;layer_7_allgather_mlp -->
<g id="edge567" class="edge">
<title>layer_7_mlp_fc1_gpu3&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M1893.4,-12068.15C1898.94,-12059.34 1905.27,-12049.28 1911.24,-12039.8"/>
<polygon fill="black" stroke="black" points="1914.22,-12041.63 1916.58,-12031.3 1908.3,-12037.9 1914.22,-12041.63"/>
</g>
<!-- layer_7_mlp_fc1_gpu4&#45;&gt;layer_7_allgather_mlp -->
<g id="edge568" class="edge">
<title>layer_7_mlp_fc1_gpu4&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M1973.6,-12068.15C1968.06,-12059.34 1961.73,-12049.28 1955.76,-12039.8"/>
<polygon fill="black" stroke="black" points="1958.7,-12037.9 1950.42,-12031.3 1952.78,-12041.63 1958.7,-12037.9"/>
</g>
<!-- layer_7_mlp_fc1_gpu5&#45;&gt;layer_7_allgather_mlp -->
<g id="edge569" class="edge">
<title>layer_7_mlp_fc1_gpu5&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M2054.26,-12068.39C2031.29,-12056.22 2003.77,-12041.64 1980.8,-12029.48"/>
<polygon fill="black" stroke="black" points="1982.39,-12026.36 1971.91,-12024.77 1979.11,-12032.54 1982.39,-12026.36"/>
</g>
<!-- layer_7_mlp_fc1_gpu6&#45;&gt;layer_7_allgather_mlp -->
<g id="edge570" class="edge">
<title>layer_7_mlp_fc1_gpu6&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M2166.34,-12071.79C2163.36,-12070.61 2160.4,-12069.47 2157.5,-12068.41 2102.97,-12048.57 2039.21,-12030.87 1993.68,-12019.14"/>
<polygon fill="black" stroke="black" points="1994.53,-12015.74 1983.97,-12016.66 1992.79,-12022.53 1994.53,-12015.74"/>
</g>
<!-- layer_7_mlp_fc1_gpu7&#45;&gt;layer_7_allgather_mlp -->
<g id="edge571" class="edge">
<title>layer_7_mlp_fc1_gpu7&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M2278.44,-12071.48C2275.44,-12070.37 2272.45,-12069.34 2269.5,-12068.41 2177.48,-12039.54 2066.98,-12021.55 1998.49,-12012.25"/>
<polygon fill="black" stroke="black" points="1998.66,-12008.74 1988.28,-12010.89 1997.73,-12015.68 1998.66,-12008.74"/>
</g>
<!-- layer_7_gelu -->
<g id="node342" class="node">
<title>layer_7_gelu</title>
<polygon fill="lightblue" stroke="black" points="1978,-11938.43 1889,-11938.43 1889,-11902.43 1978,-11902.43 1978,-11938.43"/>
<text text-anchor="middle" x="1933.5" y="-11923.43" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1933.5" y="-11912.43" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_7_allgather_mlp&#45;&gt;layer_7_gelu -->
<g id="edge572" class="edge">
<title>layer_7_allgather_mlp&#45;&gt;layer_7_gelu</title>
<path fill="none" stroke="black" d="M1933.5,-11974.1C1933.5,-11965.85 1933.5,-11956.86 1933.5,-11948.68"/>
<polygon fill="black" stroke="black" points="1937,-11948.53 1933.5,-11938.53 1930,-11948.53 1937,-11948.53"/>
</g>
<!-- layer_7_mlp_fc2_gpu0 -->
<g id="node343" class="node">
<title>layer_7_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1588.5,-11866.43 1494.5,-11866.43 1494.5,-11814.43 1588.5,-11814.43 1588.5,-11866.43"/>
<text text-anchor="middle" x="1541.5" y="-11854.43" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="1541.5" y="-11843.43" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1541.5" y="-11832.43" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1541.5" y="-11821.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu0 -->
<g id="edge573" class="edge">
<title>layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu0</title>
<path fill="none" stroke="black" d="M1888.92,-11916.16C1825.69,-11910.7 1706.52,-11897.41 1598.29,-11866.33"/>
<polygon fill="black" stroke="black" points="1599.1,-11862.92 1588.52,-11863.47 1597.14,-11869.64 1599.1,-11862.92"/>
</g>
<!-- layer_7_mlp_fc2_gpu1 -->
<g id="node344" class="node">
<title>layer_7_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1700.5,-11866.43 1606.5,-11866.43 1606.5,-11814.43 1700.5,-11814.43 1700.5,-11866.43"/>
<text text-anchor="middle" x="1653.5" y="-11854.43" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="1653.5" y="-11843.43" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1653.5" y="-11832.43" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1653.5" y="-11821.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu1 -->
<g id="edge574" class="edge">
<title>layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu1</title>
<path fill="none" stroke="black" d="M1888.61,-11911.39C1845.02,-11903.01 1777.01,-11888.43 1710.42,-11866.5"/>
<polygon fill="black" stroke="black" points="1711.2,-11863.07 1700.61,-11863.21 1708.98,-11869.71 1711.2,-11863.07"/>
</g>
<!-- layer_7_mlp_fc2_gpu2 -->
<g id="node345" class="node">
<title>layer_7_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1812.5,-11866.43 1718.5,-11866.43 1718.5,-11814.43 1812.5,-11814.43 1812.5,-11866.43"/>
<text text-anchor="middle" x="1765.5" y="-11854.43" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="1765.5" y="-11843.43" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1765.5" y="-11832.43" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1765.5" y="-11821.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu2 -->
<g id="edge575" class="edge">
<title>layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu2</title>
<path fill="none" stroke="black" d="M1896.63,-11902.31C1874.71,-11892.13 1846.45,-11879.01 1821.78,-11867.56"/>
<polygon fill="black" stroke="black" points="1823.06,-11864.3 1812.52,-11863.26 1820.12,-11870.65 1823.06,-11864.3"/>
</g>
<!-- layer_7_mlp_fc2_gpu3 -->
<g id="node346" class="node">
<title>layer_7_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1924.5,-11866.43 1830.5,-11866.43 1830.5,-11814.43 1924.5,-11814.43 1924.5,-11866.43"/>
<text text-anchor="middle" x="1877.5" y="-11854.43" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="1877.5" y="-11843.43" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1877.5" y="-11832.43" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1877.5" y="-11821.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu3 -->
<g id="edge576" class="edge">
<title>layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu3</title>
<path fill="none" stroke="black" d="M1921.07,-11902.12C1915.35,-11894.15 1908.35,-11884.4 1901.65,-11875.07"/>
<polygon fill="black" stroke="black" points="1904.31,-11872.77 1895.63,-11866.69 1898.62,-11876.85 1904.31,-11872.77"/>
</g>
<!-- layer_7_mlp_fc2_gpu4 -->
<g id="node347" class="node">
<title>layer_7_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2036.5,-11866.43 1942.5,-11866.43 1942.5,-11814.43 2036.5,-11814.43 2036.5,-11866.43"/>
<text text-anchor="middle" x="1989.5" y="-11854.43" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="1989.5" y="-11843.43" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1989.5" y="-11832.43" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1989.5" y="-11821.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu4 -->
<g id="edge577" class="edge">
<title>layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu4</title>
<path fill="none" stroke="black" d="M1945.93,-11902.12C1951.65,-11894.15 1958.65,-11884.4 1965.35,-11875.07"/>
<polygon fill="black" stroke="black" points="1968.38,-11876.85 1971.37,-11866.69 1962.69,-11872.77 1968.38,-11876.85"/>
</g>
<!-- layer_7_mlp_fc2_gpu5 -->
<g id="node348" class="node">
<title>layer_7_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2148.5,-11866.43 2054.5,-11866.43 2054.5,-11814.43 2148.5,-11814.43 2148.5,-11866.43"/>
<text text-anchor="middle" x="2101.5" y="-11854.43" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="2101.5" y="-11843.43" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2101.5" y="-11832.43" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2101.5" y="-11821.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu5 -->
<g id="edge578" class="edge">
<title>layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu5</title>
<path fill="none" stroke="black" d="M1970.37,-11902.31C1992.29,-11892.13 2020.55,-11879.01 2045.22,-11867.56"/>
<polygon fill="black" stroke="black" points="2046.88,-11870.65 2054.48,-11863.26 2043.94,-11864.3 2046.88,-11870.65"/>
</g>
<!-- layer_7_mlp_fc2_gpu6 -->
<g id="node349" class="node">
<title>layer_7_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2260.5,-11866.43 2166.5,-11866.43 2166.5,-11814.43 2260.5,-11814.43 2260.5,-11866.43"/>
<text text-anchor="middle" x="2213.5" y="-11854.43" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="2213.5" y="-11843.43" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2213.5" y="-11832.43" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2213.5" y="-11821.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu6 -->
<g id="edge579" class="edge">
<title>layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu6</title>
<path fill="none" stroke="black" d="M1978.39,-11911.39C2021.98,-11903.01 2089.99,-11888.43 2156.58,-11866.5"/>
<polygon fill="black" stroke="black" points="2158.02,-11869.71 2166.39,-11863.21 2155.8,-11863.07 2158.02,-11869.71"/>
</g>
<!-- layer_7_mlp_fc2_gpu7 -->
<g id="node350" class="node">
<title>layer_7_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2372.5,-11866.43 2278.5,-11866.43 2278.5,-11814.43 2372.5,-11814.43 2372.5,-11866.43"/>
<text text-anchor="middle" x="2325.5" y="-11854.43" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="2325.5" y="-11843.43" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2325.5" y="-11832.43" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2325.5" y="-11821.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu7 -->
<g id="edge580" class="edge">
<title>layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu7</title>
<path fill="none" stroke="black" d="M1978.08,-11916.16C2041.31,-11910.7 2160.48,-11897.41 2268.71,-11866.33"/>
<polygon fill="black" stroke="black" points="2269.86,-11869.64 2278.48,-11863.47 2267.9,-11862.92 2269.86,-11869.64"/>
</g>
<!-- layer_7_allreduce_mlp -->
<g id="node351" class="node">
<title>layer_7_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="1989.5" cy="-11749.44" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="1989.5" y="-11757.94" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="1989.5" y="-11746.94" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="1989.5" y="-11735.94" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_7_mlp_fc2_gpu0&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge581" class="edge">
<title>layer_7_mlp_fc2_gpu0&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1588.53,-11817.41C1591.54,-11816.32 1594.54,-11815.32 1597.5,-11814.43 1707.66,-11781.45 1840.65,-11764.29 1919.97,-11756.32"/>
<polygon fill="black" stroke="black" points="1920.71,-11759.77 1930.32,-11755.31 1920.03,-11752.8 1920.71,-11759.77"/>
</g>
<!-- layer_7_mlp_fc2_gpu1&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge582" class="edge">
<title>layer_7_mlp_fc2_gpu1&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1700.6,-11817.63C1703.59,-11816.49 1706.57,-11815.41 1709.5,-11814.43 1781.11,-11790.52 1865.96,-11772.51 1923.34,-11761.78"/>
<polygon fill="black" stroke="black" points="1924.17,-11765.19 1933.37,-11759.93 1922.9,-11758.3 1924.17,-11765.19"/>
</g>
<!-- layer_7_mlp_fc2_gpu2&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge583" class="edge">
<title>layer_7_mlp_fc2_gpu2&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1812.78,-11818.1C1815.72,-11816.84 1818.65,-11815.61 1821.5,-11814.43 1858.39,-11799.19 1900.34,-11783.2 1933.1,-11771.03"/>
<polygon fill="black" stroke="black" points="1934.35,-11774.29 1942.51,-11767.54 1931.92,-11767.73 1934.35,-11774.29"/>
</g>
<!-- layer_7_mlp_fc2_gpu3&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge584" class="edge">
<title>layer_7_mlp_fc2_gpu3&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1909,-11814.41C1922.09,-11804.01 1937.4,-11791.84 1951.14,-11780.92"/>
<polygon fill="black" stroke="black" points="1953.36,-11783.63 1959.01,-11774.66 1949.01,-11778.14 1953.36,-11783.63"/>
</g>
<!-- layer_7_mlp_fc2_gpu4&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge585" class="edge">
<title>layer_7_mlp_fc2_gpu4&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1989.5,-11814.17C1989.5,-11806.28 1989.5,-11797.39 1989.5,-11788.81"/>
<polygon fill="black" stroke="black" points="1993,-11788.58 1989.5,-11778.58 1986,-11788.58 1993,-11788.58"/>
</g>
<!-- layer_7_mlp_fc2_gpu5&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge586" class="edge">
<title>layer_7_mlp_fc2_gpu5&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2070,-11814.41C2056.91,-11804.01 2041.6,-11791.84 2027.86,-11780.92"/>
<polygon fill="black" stroke="black" points="2029.99,-11778.14 2019.99,-11774.66 2025.64,-11783.63 2029.99,-11778.14"/>
</g>
<!-- layer_7_mlp_fc2_gpu6&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge587" class="edge">
<title>layer_7_mlp_fc2_gpu6&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2166.22,-11818.1C2163.28,-11816.84 2160.35,-11815.61 2157.5,-11814.43 2120.61,-11799.19 2078.66,-11783.2 2045.9,-11771.03"/>
<polygon fill="black" stroke="black" points="2047.08,-11767.73 2036.49,-11767.54 2044.65,-11774.29 2047.08,-11767.73"/>
</g>
<!-- layer_7_mlp_fc2_gpu7&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge588" class="edge">
<title>layer_7_mlp_fc2_gpu7&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2278.4,-11817.63C2275.41,-11816.49 2272.43,-11815.41 2269.5,-11814.43 2197.89,-11790.52 2113.04,-11772.51 2055.66,-11761.78"/>
<polygon fill="black" stroke="black" points="2056.1,-11758.3 2045.63,-11759.93 2054.83,-11765.19 2056.1,-11758.3"/>
</g>
<!-- layer_7_allreduce_mlp&#45;&gt;layer_7_residual2 -->
<g id="edge589" class="edge">
<title>layer_7_allreduce_mlp&#45;&gt;layer_7_residual2</title>
<path fill="none" stroke="black" d="M2032.47,-11728.95C2062.5,-11715.32 2102.96,-11696.97 2135.93,-11682.01"/>
<polygon fill="black" stroke="black" points="2137.8,-11685.01 2145.46,-11677.69 2134.91,-11678.64 2137.8,-11685.01"/>
</g>
<!-- layer_7_ln2 -->
<g id="node353" class="node">
<title>layer_7_ln2</title>
<polygon fill="lightblue" stroke="black" points="2231,-11588.45 2158,-11588.45 2158,-11547.45 2231,-11547.45 2231,-11588.45"/>
<text text-anchor="middle" x="2194.5" y="-11576.45" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="2194.5" y="-11565.45" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="2194.5" y="-11554.45" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_7_residual2&#45;&gt;layer_7_ln2 -->
<g id="edge591" class="edge">
<title>layer_7_residual2&#45;&gt;layer_7_ln2</title>
<path fill="none" stroke="black" d="M2194.5,-11624.37C2194.5,-11616.04 2194.5,-11606.96 2194.5,-11598.6"/>
<polygon fill="black" stroke="black" points="2198,-11598.51 2194.5,-11588.51 2191,-11598.51 2198,-11598.51"/>
</g>
<!-- layer_7_output_dist -->
<g id="node354" class="node">
<title>layer_7_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="2296.2,-11511.45 2134.42,-11511.45 2092.8,-11451.45 2254.58,-11451.45 2296.2,-11511.45"/>
<text text-anchor="middle" x="2194.5" y="-11484.45" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="2194.5" y="-11473.45" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_7_ln2&#45;&gt;layer_7_output_dist -->
<g id="edge592" class="edge">
<title>layer_7_ln2&#45;&gt;layer_7_output_dist</title>
<path fill="none" stroke="black" d="M2194.5,-11547.35C2194.5,-11539.71 2194.5,-11530.67 2194.5,-11521.8"/>
<polygon fill="black" stroke="black" points="2198,-11521.56 2194.5,-11511.56 2191,-11521.56 2198,-11521.56"/>
</g>
<!-- layer_8_input_dist -->
<g id="node355" class="node">
<title>layer_8_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="2288.69,-11415.45 2138.86,-11415.45 2100.31,-11355.45 2250.14,-11355.45 2288.69,-11415.45"/>
<text text-anchor="middle" x="2194.5" y="-11388.45" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="2194.5" y="-11377.45" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_7_output_dist&#45;&gt;layer_8_input_dist -->
<g id="edge593" class="edge">
<title>layer_7_output_dist&#45;&gt;layer_8_input_dist</title>
<path fill="none" stroke="black" d="M2194.5,-11451.22C2194.5,-11443.18 2194.5,-11434.31 2194.5,-11425.8"/>
<polygon fill="black" stroke="black" points="2198,-11425.66 2194.5,-11415.66 2191,-11425.66 2198,-11425.66"/>
</g>
<!-- layer_8_qkv_gpu8 -->
<g id="node356" class="node">
<title>layer_8_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="1797,-11319.45 1704,-11319.45 1704,-11267.45 1797,-11267.45 1797,-11319.45"/>
<text text-anchor="middle" x="1750.5" y="-11307.45" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="1750.5" y="-11296.45" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="1750.5" y="-11285.45" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1750.5" y="-11274.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu8 -->
<g id="edge594" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu8</title>
<path fill="none" stroke="black" d="M2114,-11376.99C2036.82,-11368.48 1917.31,-11351.74 1806.86,-11319.23"/>
<polygon fill="black" stroke="black" points="1807.81,-11315.86 1797.22,-11316.34 1805.8,-11322.56 1807.81,-11315.86"/>
</g>
<!-- layer_8_qkv_gpu9 -->
<g id="node357" class="node">
<title>layer_8_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="1908,-11319.45 1815,-11319.45 1815,-11267.45 1908,-11267.45 1908,-11319.45"/>
<text text-anchor="middle" x="1861.5" y="-11307.45" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="1861.5" y="-11296.45" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="1861.5" y="-11285.45" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1861.5" y="-11274.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu9 -->
<g id="edge595" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu9</title>
<path fill="none" stroke="black" d="M2108.78,-11368.7C2055.93,-11357.98 1986.87,-11342.14 1918.01,-11319.37"/>
<polygon fill="black" stroke="black" points="1918.89,-11315.97 1908.3,-11316.11 1916.66,-11322.61 1918.89,-11315.97"/>
</g>
<!-- layer_8_qkv_gpu10 -->
<g id="node358" class="node">
<title>layer_8_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2019,-11319.45 1926,-11319.45 1926,-11267.45 2019,-11267.45 2019,-11319.45"/>
<text text-anchor="middle" x="1972.5" y="-11307.45" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="1972.5" y="-11296.45" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="1972.5" y="-11285.45" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1972.5" y="-11274.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu10 -->
<g id="edge596" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu10</title>
<path fill="none" stroke="black" d="M2118.17,-11355.42C2089.89,-11344.44 2057.62,-11331.64 2028.5,-11319.45 2028.4,-11319.41 2028.31,-11319.37 2028.21,-11319.33"/>
<polygon fill="black" stroke="black" points="2029.75,-11316.18 2019.18,-11315.48 2027.01,-11322.62 2029.75,-11316.18"/>
</g>
<!-- layer_8_qkv_gpu11 -->
<g id="node359" class="node">
<title>layer_8_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2130,-11319.45 2037,-11319.45 2037,-11267.45 2130,-11267.45 2130,-11319.45"/>
<text text-anchor="middle" x="2083.5" y="-11307.45" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="2083.5" y="-11296.45" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2083.5" y="-11285.45" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2083.5" y="-11274.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu11 -->
<g id="edge597" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu11</title>
<path fill="none" stroke="black" d="M2158.46,-11355.23C2146.94,-11345.89 2134.14,-11335.51 2122.42,-11326.01"/>
<polygon fill="black" stroke="black" points="2124.48,-11323.17 2114.51,-11319.59 2120.08,-11328.61 2124.48,-11323.17"/>
</g>
<!-- layer_8_qkv_gpu12 -->
<g id="node360" class="node">
<title>layer_8_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2241,-11319.45 2148,-11319.45 2148,-11267.45 2241,-11267.45 2241,-11319.45"/>
<text text-anchor="middle" x="2194.5" y="-11307.45" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="2194.5" y="-11296.45" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="2194.5" y="-11285.45" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2194.5" y="-11274.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu12 -->
<g id="edge598" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu12</title>
<path fill="none" stroke="black" d="M2194.5,-11354.98C2194.5,-11346.9 2194.5,-11338.07 2194.5,-11329.71"/>
<polygon fill="black" stroke="black" points="2198,-11329.46 2194.5,-11319.46 2191,-11329.46 2198,-11329.46"/>
</g>
<!-- layer_8_qkv_gpu13 -->
<g id="node361" class="node">
<title>layer_8_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="2352,-11319.45 2259,-11319.45 2259,-11267.45 2352,-11267.45 2352,-11319.45"/>
<text text-anchor="middle" x="2305.5" y="-11307.45" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="2305.5" y="-11296.45" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="2305.5" y="-11285.45" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2305.5" y="-11274.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu13 -->
<g id="edge599" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu13</title>
<path fill="none" stroke="black" d="M2230.54,-11355.23C2242.06,-11345.89 2254.86,-11335.51 2266.58,-11326.01"/>
<polygon fill="black" stroke="black" points="2268.92,-11328.61 2274.49,-11319.59 2264.52,-11323.17 2268.92,-11328.61"/>
</g>
<!-- layer_8_qkv_gpu14 -->
<g id="node362" class="node">
<title>layer_8_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="2463,-11319.45 2370,-11319.45 2370,-11267.45 2463,-11267.45 2463,-11319.45"/>
<text text-anchor="middle" x="2416.5" y="-11307.45" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="2416.5" y="-11296.45" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="2416.5" y="-11285.45" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2416.5" y="-11274.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu14 -->
<g id="edge600" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu14</title>
<path fill="none" stroke="black" d="M2254.73,-11361.93C2284.33,-11350.65 2320.68,-11336.48 2360.42,-11319.84"/>
<polygon fill="black" stroke="black" points="2361.91,-11323.01 2369.77,-11315.9 2359.2,-11316.55 2361.91,-11323.01"/>
</g>
<!-- layer_8_qkv_gpu15 -->
<g id="node363" class="node">
<title>layer_8_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="2574,-11319.45 2481,-11319.45 2481,-11267.45 2574,-11267.45 2574,-11319.45"/>
<text text-anchor="middle" x="2527.5" y="-11307.45" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="2527.5" y="-11296.45" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="2527.5" y="-11285.45" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2527.5" y="-11274.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu15 -->
<g id="edge601" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu15</title>
<path fill="none" stroke="black" d="M2261.25,-11372.68C2315.88,-11362.18 2395.07,-11344.97 2471.2,-11319.66"/>
<polygon fill="black" stroke="black" points="2472.59,-11322.88 2480.95,-11316.36 2470.35,-11316.25 2472.59,-11322.88"/>
</g>
<!-- layer_8_residual1 -->
<g id="node375" class="node">
<title>layer_8_residual1</title>
<polygon fill="lightyellow" stroke="black" points="2484.44,-10867.48 2362.05,-10867.48 2330.56,-10807.48 2452.95,-10807.48 2484.44,-10867.48"/>
<text text-anchor="middle" x="2407.5" y="-10840.48" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="2407.5" y="-10829.48" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_residual1 -->
<g id="edge628" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_residual1</title>
<path fill="none" stroke="black" d="M2267.59,-11382.1C2367.77,-11377.3 2540.3,-11362.79 2583.5,-11319.45 2620.38,-11282.45 2602.5,-11255.7 2602.5,-11203.46 2602.5,-11203.46 2602.5,-11203.46 2602.5,-11022.47 2602.5,-10953.69 2537.52,-10903.01 2482.59,-10872.45"/>
<polygon fill="black" stroke="black" points="2483.98,-10869.22 2473.52,-10867.53 2480.64,-10875.38 2483.98,-10869.22"/>
</g>
<!-- layer_8_allgather_qkv -->
<g id="node364" class="node">
<title>layer_8_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="2150.5" cy="-11202.46" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="2150.5" y="-11210.96" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="2150.5" y="-11199.96" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="2150.5" y="-11188.96" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_8_qkv_gpu8&#45;&gt;layer_8_allgather_qkv -->
<g id="edge602" class="edge">
<title>layer_8_qkv_gpu8&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M1797.24,-11270.62C1800.35,-11269.47 1803.45,-11268.4 1806.5,-11267.45 1901.17,-11237.97 2014.96,-11220.07 2085.01,-11210.96"/>
<polygon fill="black" stroke="black" points="2085.54,-11214.42 2095.02,-11209.68 2084.65,-11207.48 2085.54,-11214.42"/>
</g>
<!-- layer_8_qkv_gpu9&#45;&gt;layer_8_allgather_qkv -->
<g id="edge603" class="edge">
<title>layer_8_qkv_gpu9&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M1908.03,-11271.04C1911.22,-11269.77 1914.39,-11268.56 1917.5,-11267.45 1974.65,-11246.98 2041.64,-11229.2 2089.08,-11217.62"/>
<polygon fill="black" stroke="black" points="2090,-11221 2098.9,-11215.24 2088.36,-11214.19 2090,-11221"/>
</g>
<!-- layer_8_qkv_gpu10&#45;&gt;layer_8_allgather_qkv -->
<g id="edge604" class="edge">
<title>layer_8_qkv_gpu10&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M2019.27,-11269.07C2044.59,-11256.41 2075.84,-11240.78 2101.5,-11227.95"/>
<polygon fill="black" stroke="black" points="2103.3,-11230.97 2110.68,-11223.37 2100.17,-11224.71 2103.3,-11230.97"/>
</g>
<!-- layer_8_qkv_gpu11&#45;&gt;layer_8_allgather_qkv -->
<g id="edge605" class="edge">
<title>layer_8_qkv_gpu11&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M2102.52,-11267.18C2109.41,-11258.03 2117.32,-11247.53 2124.69,-11237.74"/>
<polygon fill="black" stroke="black" points="2127.51,-11239.81 2130.73,-11229.71 2121.92,-11235.6 2127.51,-11239.81"/>
</g>
<!-- layer_8_qkv_gpu12&#45;&gt;layer_8_allgather_qkv -->
<g id="edge606" class="edge">
<title>layer_8_qkv_gpu12&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M2182.01,-11267.18C2177.78,-11258.63 2172.97,-11248.9 2168.4,-11239.66"/>
<polygon fill="black" stroke="black" points="2171.52,-11238.06 2163.95,-11230.65 2165.24,-11241.17 2171.52,-11238.06"/>
</g>
<!-- layer_8_qkv_gpu13&#45;&gt;layer_8_allgather_qkv -->
<g id="edge607" class="edge">
<title>layer_8_qkv_gpu13&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M2261.91,-11267.42C2241.48,-11255.69 2217.12,-11241.71 2196.4,-11229.81"/>
<polygon fill="black" stroke="black" points="2197.88,-11226.63 2187.47,-11224.68 2194.4,-11232.7 2197.88,-11226.63"/>
</g>
<!-- layer_8_qkv_gpu14&#45;&gt;layer_8_allgather_qkv -->
<g id="edge608" class="edge">
<title>layer_8_qkv_gpu14&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M2369.87,-11270.75C2367.05,-11269.59 2364.25,-11268.48 2361.5,-11267.45 2311.32,-11248.53 2252.88,-11231.15 2210.24,-11219.3"/>
<polygon fill="black" stroke="black" points="2211.15,-11215.92 2200.57,-11216.63 2209.28,-11222.67 2211.15,-11215.92"/>
</g>
<!-- layer_8_qkv_gpu15&#45;&gt;layer_8_allgather_qkv -->
<g id="edge609" class="edge">
<title>layer_8_qkv_gpu15&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M2480.98,-11270.42C2478.14,-11269.35 2475.3,-11268.35 2472.5,-11267.45 2385.72,-11239.52 2281.69,-11221.51 2215.83,-11211.93"/>
<polygon fill="black" stroke="black" points="2215.99,-11208.41 2205.6,-11210.46 2215,-11215.34 2215.99,-11208.41"/>
</g>
<!-- layer_8_attention -->
<g id="node365" class="node">
<title>layer_8_attention</title>
<polygon fill="lightblue" stroke="black" points="2184.5,-11137.47 2116.5,-11137.47 2116.5,-11085.47 2184.5,-11085.47 2184.5,-11137.47"/>
<text text-anchor="middle" x="2150.5" y="-11125.47" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="2150.5" y="-11114.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="2150.5" y="-11103.47" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="2150.5" y="-11092.47" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_8_allgather_qkv&#45;&gt;layer_8_attention -->
<g id="edge610" class="edge">
<title>layer_8_allgather_qkv&#45;&gt;layer_8_attention</title>
<path fill="none" stroke="black" d="M2150.5,-11173.3C2150.5,-11165.19 2150.5,-11156.24 2150.5,-11147.76"/>
<polygon fill="black" stroke="black" points="2154,-11147.73 2150.5,-11137.73 2147,-11147.73 2154,-11147.73"/>
</g>
<!-- layer_8_attn_out_gpu8 -->
<g id="node366" class="node">
<title>layer_8_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="1832.5,-11049.47 1744.5,-11049.47 1744.5,-10997.47 1832.5,-10997.47 1832.5,-11049.47"/>
<text text-anchor="middle" x="1788.5" y="-11037.47" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="1788.5" y="-11026.47" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="1788.5" y="-11015.47" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1788.5" y="-11004.47" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attention&#45;&gt;layer_8_attn_out_gpu8 -->
<g id="edge611" class="edge">
<title>layer_8_attention&#45;&gt;layer_8_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M2116.43,-11106.52C2060.48,-11099.46 1945.85,-11082.49 1842.37,-11049.43"/>
<polygon fill="black" stroke="black" points="1843.3,-11046.05 1832.71,-11046.29 1841.13,-11052.71 1843.3,-11046.05"/>
</g>
<!-- layer_8_attn_out_gpu9 -->
<g id="node367" class="node">
<title>layer_8_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="1938.5,-11049.47 1850.5,-11049.47 1850.5,-10997.47 1938.5,-10997.47 1938.5,-11049.47"/>
<text text-anchor="middle" x="1894.5" y="-11037.47" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="1894.5" y="-11026.47" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="1894.5" y="-11015.47" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1894.5" y="-11004.47" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attention&#45;&gt;layer_8_attn_out_gpu9 -->
<g id="edge612" class="edge">
<title>layer_8_attention&#45;&gt;layer_8_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M2116.22,-11101.84C2077.35,-11091.69 2012.05,-11073.55 1947.97,-11049.44"/>
<polygon fill="black" stroke="black" points="1949.12,-11046.13 1938.53,-11045.84 1946.63,-11052.67 1949.12,-11046.13"/>
</g>
<!-- layer_8_attn_out_gpu10 -->
<g id="node368" class="node">
<title>layer_8_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2044.5,-11049.47 1956.5,-11049.47 1956.5,-10997.47 2044.5,-10997.47 2044.5,-11049.47"/>
<text text-anchor="middle" x="2000.5" y="-11037.47" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="2000.5" y="-11026.47" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2000.5" y="-11015.47" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2000.5" y="-11004.47" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attention&#45;&gt;layer_8_attn_out_gpu10 -->
<g id="edge613" class="edge">
<title>layer_8_attention&#45;&gt;layer_8_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M2116.46,-11090.95C2097.78,-11080.24 2074.21,-11066.73 2053.2,-11054.68"/>
<polygon fill="black" stroke="black" points="2054.8,-11051.56 2044.38,-11049.62 2051.31,-11057.63 2054.8,-11051.56"/>
</g>
<!-- layer_8_attn_out_gpu11 -->
<g id="node369" class="node">
<title>layer_8_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2150.5,-11049.47 2062.5,-11049.47 2062.5,-10997.47 2150.5,-10997.47 2150.5,-11049.47"/>
<text text-anchor="middle" x="2106.5" y="-11037.47" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="2106.5" y="-11026.47" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2106.5" y="-11015.47" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2106.5" y="-11004.47" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attention&#45;&gt;layer_8_attn_out_gpu11 -->
<g id="edge614" class="edge">
<title>layer_8_attention&#45;&gt;layer_8_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M2137.54,-11085.13C2133.28,-11076.82 2128.49,-11067.44 2123.96,-11058.59"/>
<polygon fill="black" stroke="black" points="2127.04,-11056.93 2119.37,-11049.62 2120.81,-11060.12 2127.04,-11056.93"/>
</g>
<!-- layer_8_attn_out_gpu12 -->
<g id="node370" class="node">
<title>layer_8_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2256.5,-11049.47 2168.5,-11049.47 2168.5,-10997.47 2256.5,-10997.47 2256.5,-11049.47"/>
<text text-anchor="middle" x="2212.5" y="-11037.47" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="2212.5" y="-11026.47" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="2212.5" y="-11015.47" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2212.5" y="-11004.47" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attention&#45;&gt;layer_8_attn_out_gpu12 -->
<g id="edge615" class="edge">
<title>layer_8_attention&#45;&gt;layer_8_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M2168.77,-11085.13C2174.95,-11076.55 2181.95,-11066.85 2188.5,-11057.75"/>
<polygon fill="black" stroke="black" points="2191.35,-11059.78 2194.36,-11049.62 2185.68,-11055.69 2191.35,-11059.78"/>
</g>
<!-- layer_8_attn_out_gpu13 -->
<g id="node371" class="node">
<title>layer_8_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="2362.5,-11049.47 2274.5,-11049.47 2274.5,-10997.47 2362.5,-10997.47 2362.5,-11049.47"/>
<text text-anchor="middle" x="2318.5" y="-11037.47" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="2318.5" y="-11026.47" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="2318.5" y="-11015.47" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2318.5" y="-11004.47" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attention&#45;&gt;layer_8_attn_out_gpu13 -->
<g id="edge616" class="edge">
<title>layer_8_attention&#45;&gt;layer_8_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M2184.9,-11092.85C2208,-11081.03 2238.9,-11065.21 2265.16,-11051.77"/>
<polygon fill="black" stroke="black" points="2266.93,-11054.8 2274.24,-11047.12 2263.74,-11048.57 2266.93,-11054.8"/>
</g>
<!-- layer_8_attn_out_gpu14 -->
<g id="node372" class="node">
<title>layer_8_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="2468.5,-11049.47 2380.5,-11049.47 2380.5,-10997.47 2468.5,-10997.47 2468.5,-11049.47"/>
<text text-anchor="middle" x="2424.5" y="-11037.47" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="2424.5" y="-11026.47" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="2424.5" y="-11015.47" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2424.5" y="-11004.47" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attention&#45;&gt;layer_8_attn_out_gpu14 -->
<g id="edge617" class="edge">
<title>layer_8_attention&#45;&gt;layer_8_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M2184.77,-11102.94C2226.82,-11093.28 2300.28,-11075.06 2370.99,-11049.41"/>
<polygon fill="black" stroke="black" points="2372.32,-11052.65 2380.5,-11045.91 2369.9,-11046.08 2372.32,-11052.65"/>
</g>
<!-- layer_8_attn_out_gpu15 -->
<g id="node373" class="node">
<title>layer_8_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="2574.5,-11049.47 2486.5,-11049.47 2486.5,-10997.47 2574.5,-10997.47 2574.5,-11049.47"/>
<text text-anchor="middle" x="2530.5" y="-11037.47" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="2530.5" y="-11026.47" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="2530.5" y="-11015.47" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2530.5" y="-11004.47" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attention&#45;&gt;layer_8_attn_out_gpu15 -->
<g id="edge618" class="edge">
<title>layer_8_attention&#45;&gt;layer_8_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M2184.63,-11107.01C2243.2,-11100.47 2366.4,-11084 2476.69,-11049.39"/>
<polygon fill="black" stroke="black" points="2477.84,-11052.7 2486.3,-11046.32 2475.71,-11046.03 2477.84,-11052.7"/>
</g>
<!-- layer_8_allreduce_attn -->
<g id="node374" class="node">
<title>layer_8_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="2212.5" cy="-10932.47" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="2212.5" y="-10940.97" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="2212.5" y="-10929.97" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="2212.5" y="-10918.97" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_8_attn_out_gpu8&#45;&gt;layer_8_allreduce_attn -->
<g id="edge619" class="edge">
<title>layer_8_attn_out_gpu8&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M1832.68,-11000.56C1835.63,-10999.43 1838.59,-10998.38 1841.5,-10997.47 1944.93,-10964.81 2070.16,-10947.6 2145.47,-10939.54"/>
<polygon fill="black" stroke="black" points="2146.17,-10942.98 2155.75,-10938.46 2145.44,-10936.02 2146.17,-10942.98"/>
</g>
<!-- layer_8_attn_out_gpu9&#45;&gt;layer_8_allreduce_attn -->
<g id="edge620" class="edge">
<title>layer_8_attn_out_gpu9&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M1938.76,-11000.79C1941.69,-10999.6 1944.62,-10998.48 1947.5,-10997.47 2014.63,-10973.81 2094.34,-10955.86 2148.69,-10945.08"/>
<polygon fill="black" stroke="black" points="2149.39,-10948.51 2158.53,-10943.15 2148.04,-10941.64 2149.39,-10948.51"/>
</g>
<!-- layer_8_attn_out_gpu10&#45;&gt;layer_8_allreduce_attn -->
<g id="edge621" class="edge">
<title>layer_8_attn_out_gpu10&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M2044.66,-11001.4C2047.64,-11000.05 2050.61,-10998.73 2053.5,-10997.47 2087.83,-10982.48 2126.84,-10966.76 2157.63,-10954.65"/>
<polygon fill="black" stroke="black" points="2159.29,-10957.76 2167.32,-10950.85 2156.73,-10951.24 2159.29,-10957.76"/>
</g>
<!-- layer_8_attn_out_gpu11&#45;&gt;layer_8_allreduce_attn -->
<g id="edge622" class="edge">
<title>layer_8_attn_out_gpu11&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M2136.31,-10997.44C2148.58,-10987.14 2162.92,-10975.1 2175.83,-10964.26"/>
<polygon fill="black" stroke="black" points="2178.24,-10966.81 2183.65,-10957.7 2173.74,-10961.45 2178.24,-10966.81"/>
</g>
<!-- layer_8_attn_out_gpu12&#45;&gt;layer_8_allreduce_attn -->
<g id="edge623" class="edge">
<title>layer_8_attn_out_gpu12&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M2212.5,-10997.2C2212.5,-10989.31 2212.5,-10980.42 2212.5,-10971.84"/>
<polygon fill="black" stroke="black" points="2216,-10971.62 2212.5,-10961.62 2209,-10971.62 2216,-10971.62"/>
</g>
<!-- layer_8_attn_out_gpu13&#45;&gt;layer_8_allreduce_attn -->
<g id="edge624" class="edge">
<title>layer_8_attn_out_gpu13&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M2288.69,-10997.44C2276.42,-10987.14 2262.08,-10975.1 2249.17,-10964.26"/>
<polygon fill="black" stroke="black" points="2251.26,-10961.45 2241.35,-10957.7 2246.76,-10966.81 2251.26,-10961.45"/>
</g>
<!-- layer_8_attn_out_gpu14&#45;&gt;layer_8_allreduce_attn -->
<g id="edge625" class="edge">
<title>layer_8_attn_out_gpu14&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M2380.34,-11001.4C2377.36,-11000.05 2374.39,-10998.73 2371.5,-10997.47 2337.17,-10982.48 2298.16,-10966.76 2267.37,-10954.65"/>
<polygon fill="black" stroke="black" points="2268.27,-10951.24 2257.68,-10950.85 2265.71,-10957.76 2268.27,-10951.24"/>
</g>
<!-- layer_8_attn_out_gpu15&#45;&gt;layer_8_allreduce_attn -->
<g id="edge626" class="edge">
<title>layer_8_attn_out_gpu15&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M2486.24,-11000.79C2483.31,-10999.6 2480.38,-10998.48 2477.5,-10997.47 2410.37,-10973.81 2330.66,-10955.86 2276.31,-10945.08"/>
<polygon fill="black" stroke="black" points="2276.96,-10941.64 2266.47,-10943.15 2275.61,-10948.51 2276.96,-10941.64"/>
</g>
<!-- layer_8_allreduce_attn&#45;&gt;layer_8_residual1 -->
<g id="edge627" class="edge">
<title>layer_8_allreduce_attn&#45;&gt;layer_8_residual1</title>
<path fill="none" stroke="black" d="M2253.85,-10911.75C2281.62,-10898.51 2318.59,-10880.88 2349.31,-10866.23"/>
<polygon fill="black" stroke="black" points="2351.1,-10869.25 2358.62,-10861.79 2348.09,-10862.94 2351.1,-10869.25"/>
</g>
<!-- layer_8_ln1 -->
<g id="node376" class="node">
<title>layer_8_ln1</title>
<polygon fill="lightblue" stroke="black" points="2239,-10771.48 2166,-10771.48 2166,-10730.48 2239,-10730.48 2239,-10771.48"/>
<text text-anchor="middle" x="2202.5" y="-10759.48" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="2202.5" y="-10748.48" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="2202.5" y="-10737.48" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_8_residual1&#45;&gt;layer_8_ln1 -->
<g id="edge629" class="edge">
<title>layer_8_residual1&#45;&gt;layer_8_ln1</title>
<path fill="none" stroke="black" d="M2336.95,-10807.4C2307.66,-10795.33 2274.49,-10781.66 2248.43,-10770.92"/>
<polygon fill="black" stroke="black" points="2249.75,-10767.67 2239.17,-10767.1 2247.08,-10774.15 2249.75,-10767.67"/>
</g>
<!-- layer_8_residual2 -->
<g id="node396" class="node">
<title>layer_8_residual2</title>
<polygon fill="lightyellow" stroke="black" points="2484.44,-10258.52 2362.05,-10258.52 2330.56,-10198.52 2452.95,-10198.52 2484.44,-10258.52"/>
<text text-anchor="middle" x="2407.5" y="-10231.52" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="2407.5" y="-10220.52" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_8_residual1&#45;&gt;layer_8_residual2 -->
<g id="edge664" class="edge">
<title>layer_8_residual1&#45;&gt;layer_8_residual2</title>
<path fill="none" stroke="black" d="M2459.48,-10819.92C2520.51,-10796.84 2613.5,-10748.67 2613.5,-10669.48 2613.5,-10669.48 2613.5,-10669.48 2613.5,-10413.5 2613.5,-10343.29 2546.11,-10293.21 2488.42,-10263.2"/>
<polygon fill="black" stroke="black" points="2489.76,-10259.95 2479.26,-10258.55 2486.6,-10266.2 2489.76,-10259.95"/>
</g>
<!-- layer_8_mlp_fc1_gpu8 -->
<g id="node377" class="node">
<title>layer_8_mlp_fc1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="1801.5,-10694.48 1707.5,-10694.48 1707.5,-10642.48 1801.5,-10642.48 1801.5,-10694.48"/>
<text text-anchor="middle" x="1754.5" y="-10682.48" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="1754.5" y="-10671.48" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="1754.5" y="-10660.48" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1754.5" y="-10649.48" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu8 -->
<g id="edge630" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu8</title>
<path fill="none" stroke="black" d="M2165.85,-10748.2C2097.28,-10744.15 1945.17,-10731.73 1811.13,-10694.32"/>
<polygon fill="black" stroke="black" points="1812.08,-10690.95 1801.51,-10691.58 1810.17,-10697.68 1812.08,-10690.95"/>
</g>
<!-- layer_8_mlp_fc1_gpu9 -->
<g id="node378" class="node">
<title>layer_8_mlp_fc1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="1913.5,-10694.48 1819.5,-10694.48 1819.5,-10642.48 1913.5,-10642.48 1913.5,-10694.48"/>
<text text-anchor="middle" x="1866.5" y="-10682.48" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="1866.5" y="-10671.48" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="1866.5" y="-10660.48" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1866.5" y="-10649.48" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu9 -->
<g id="edge631" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu9</title>
<path fill="none" stroke="black" d="M2165.6,-10745.36C2113.26,-10738.22 2014.55,-10722.62 1923.23,-10694.43"/>
<polygon fill="black" stroke="black" points="1924.16,-10691.05 1913.57,-10691.39 1922.05,-10697.73 1924.16,-10691.05"/>
</g>
<!-- layer_8_mlp_fc1_gpu10 -->
<g id="node379" class="node">
<title>layer_8_mlp_fc1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2025.5,-10694.48 1931.5,-10694.48 1931.5,-10642.48 2025.5,-10642.48 2025.5,-10694.48"/>
<text text-anchor="middle" x="1978.5" y="-10682.48" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="1978.5" y="-10671.48" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="1978.5" y="-10660.48" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1978.5" y="-10649.48" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu10 -->
<g id="edge632" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu10</title>
<path fill="none" stroke="black" d="M2165.75,-10739.01C2133.47,-10729.12 2085.12,-10713.68 2035.08,-10694.57"/>
<polygon fill="black" stroke="black" points="2036.3,-10691.29 2025.72,-10690.96 2033.79,-10697.83 2036.3,-10691.29"/>
</g>
<!-- layer_8_mlp_fc1_gpu11 -->
<g id="node380" class="node">
<title>layer_8_mlp_fc1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2137.5,-10694.48 2043.5,-10694.48 2043.5,-10642.48 2137.5,-10642.48 2137.5,-10694.48"/>
<text text-anchor="middle" x="2090.5" y="-10682.48" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="2090.5" y="-10671.48" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2090.5" y="-10660.48" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2090.5" y="-10649.48" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu11 -->
<g id="edge633" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu11</title>
<path fill="none" stroke="black" d="M2175.1,-10730.29C2162.77,-10721.42 2147.9,-10710.74 2134.09,-10700.82"/>
<polygon fill="black" stroke="black" points="2135.83,-10697.75 2125.67,-10694.76 2131.74,-10703.44 2135.83,-10697.75"/>
</g>
<!-- layer_8_mlp_fc1_gpu12 -->
<g id="node381" class="node">
<title>layer_8_mlp_fc1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2249.5,-10694.48 2155.5,-10694.48 2155.5,-10642.48 2249.5,-10642.48 2249.5,-10694.48"/>
<text text-anchor="middle" x="2202.5" y="-10682.48" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="2202.5" y="-10671.48" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="2202.5" y="-10660.48" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2202.5" y="-10649.48" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu12 -->
<g id="edge634" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu12</title>
<path fill="none" stroke="black" d="M2202.5,-10730.08C2202.5,-10722.47 2202.5,-10713.54 2202.5,-10704.91"/>
<polygon fill="black" stroke="black" points="2206,-10704.64 2202.5,-10694.64 2199,-10704.64 2206,-10704.64"/>
</g>
<!-- layer_8_mlp_fc1_gpu13 -->
<g id="node382" class="node">
<title>layer_8_mlp_fc1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="2361.5,-10694.48 2267.5,-10694.48 2267.5,-10642.48 2361.5,-10642.48 2361.5,-10694.48"/>
<text text-anchor="middle" x="2314.5" y="-10682.48" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="2314.5" y="-10671.48" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="2314.5" y="-10660.48" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2314.5" y="-10649.48" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu13 -->
<g id="edge635" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu13</title>
<path fill="none" stroke="black" d="M2229.9,-10730.29C2242.23,-10721.42 2257.1,-10710.74 2270.91,-10700.82"/>
<polygon fill="black" stroke="black" points="2273.26,-10703.44 2279.33,-10694.76 2269.17,-10697.75 2273.26,-10703.44"/>
</g>
<!-- layer_8_mlp_fc1_gpu14 -->
<g id="node383" class="node">
<title>layer_8_mlp_fc1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="2473.5,-10694.48 2379.5,-10694.48 2379.5,-10642.48 2473.5,-10642.48 2473.5,-10694.48"/>
<text text-anchor="middle" x="2426.5" y="-10682.48" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="2426.5" y="-10671.48" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="2426.5" y="-10660.48" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2426.5" y="-10649.48" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu14 -->
<g id="edge636" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu14</title>
<path fill="none" stroke="black" d="M2239.25,-10739.01C2271.53,-10729.12 2319.88,-10713.68 2369.92,-10694.57"/>
<polygon fill="black" stroke="black" points="2371.21,-10697.83 2379.28,-10690.96 2368.7,-10691.29 2371.21,-10697.83"/>
</g>
<!-- layer_8_mlp_fc1_gpu15 -->
<g id="node384" class="node">
<title>layer_8_mlp_fc1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="2585.5,-10694.48 2491.5,-10694.48 2491.5,-10642.48 2585.5,-10642.48 2585.5,-10694.48"/>
<text text-anchor="middle" x="2538.5" y="-10682.48" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="2538.5" y="-10671.48" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="2538.5" y="-10660.48" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2538.5" y="-10649.48" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu15 -->
<g id="edge637" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu15</title>
<path fill="none" stroke="black" d="M2239.4,-10745.36C2291.74,-10738.22 2390.45,-10722.62 2481.77,-10694.43"/>
<polygon fill="black" stroke="black" points="2482.95,-10697.73 2491.43,-10691.39 2480.84,-10691.05 2482.95,-10697.73"/>
</g>
<!-- layer_8_allgather_mlp -->
<g id="node385" class="node">
<title>layer_8_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="2146.5" cy="-10577.49" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="2146.5" y="-10585.99" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="2146.5" y="-10574.99" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="2146.5" y="-10563.99" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_8_mlp_fc1_gpu8&#45;&gt;layer_8_allgather_mlp -->
<g id="edge638" class="edge">
<title>layer_8_mlp_fc1_gpu8&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M1801.56,-10645.55C1804.56,-10644.44 1807.55,-10643.41 1810.5,-10642.48 1902.52,-10613.61 2013.02,-10595.62 2081.51,-10586.32"/>
<polygon fill="black" stroke="black" points="2082.27,-10589.75 2091.72,-10584.96 2081.34,-10582.81 2082.27,-10589.75"/>
</g>
<!-- layer_8_mlp_fc1_gpu9&#45;&gt;layer_8_allgather_mlp -->
<g id="edge639" class="edge">
<title>layer_8_mlp_fc1_gpu9&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M1913.66,-10645.86C1916.64,-10644.68 1919.6,-10643.54 1922.5,-10642.48 1977.03,-10622.64 2040.79,-10604.94 2086.32,-10593.21"/>
<polygon fill="black" stroke="black" points="2087.21,-10596.59 2096.03,-10590.73 2085.47,-10589.81 2087.21,-10596.59"/>
</g>
<!-- layer_8_mlp_fc1_gpu10&#45;&gt;layer_8_allgather_mlp -->
<g id="edge640" class="edge">
<title>layer_8_mlp_fc1_gpu10&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M2025.74,-10642.46C2048.71,-10630.29 2076.23,-10615.71 2099.2,-10603.55"/>
<polygon fill="black" stroke="black" points="2100.89,-10606.61 2108.09,-10598.84 2097.61,-10600.43 2100.89,-10606.61"/>
</g>
<!-- layer_8_mlp_fc1_gpu11&#45;&gt;layer_8_allgather_mlp -->
<g id="edge641" class="edge">
<title>layer_8_mlp_fc1_gpu11&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M2106.4,-10642.22C2111.94,-10633.41 2118.27,-10623.35 2124.24,-10613.87"/>
<polygon fill="black" stroke="black" points="2127.22,-10615.7 2129.58,-10605.37 2121.3,-10611.97 2127.22,-10615.7"/>
</g>
<!-- layer_8_mlp_fc1_gpu12&#45;&gt;layer_8_allgather_mlp -->
<g id="edge642" class="edge">
<title>layer_8_mlp_fc1_gpu12&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M2186.6,-10642.22C2181.06,-10633.41 2174.73,-10623.35 2168.76,-10613.87"/>
<polygon fill="black" stroke="black" points="2171.7,-10611.97 2163.42,-10605.37 2165.78,-10615.7 2171.7,-10611.97"/>
</g>
<!-- layer_8_mlp_fc1_gpu13&#45;&gt;layer_8_allgather_mlp -->
<g id="edge643" class="edge">
<title>layer_8_mlp_fc1_gpu13&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M2267.26,-10642.46C2244.29,-10630.29 2216.77,-10615.71 2193.8,-10603.55"/>
<polygon fill="black" stroke="black" points="2195.39,-10600.43 2184.91,-10598.84 2192.11,-10606.61 2195.39,-10600.43"/>
</g>
<!-- layer_8_mlp_fc1_gpu14&#45;&gt;layer_8_allgather_mlp -->
<g id="edge644" class="edge">
<title>layer_8_mlp_fc1_gpu14&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M2379.34,-10645.86C2376.36,-10644.68 2373.4,-10643.54 2370.5,-10642.48 2315.97,-10622.64 2252.21,-10604.94 2206.68,-10593.21"/>
<polygon fill="black" stroke="black" points="2207.53,-10589.81 2196.97,-10590.73 2205.79,-10596.59 2207.53,-10589.81"/>
</g>
<!-- layer_8_mlp_fc1_gpu15&#45;&gt;layer_8_allgather_mlp -->
<g id="edge645" class="edge">
<title>layer_8_mlp_fc1_gpu15&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M2491.44,-10645.55C2488.44,-10644.44 2485.45,-10643.41 2482.5,-10642.48 2390.48,-10613.61 2279.98,-10595.62 2211.49,-10586.32"/>
<polygon fill="black" stroke="black" points="2211.66,-10582.81 2201.28,-10584.96 2210.73,-10589.75 2211.66,-10582.81"/>
</g>
<!-- layer_8_gelu -->
<g id="node386" class="node">
<title>layer_8_gelu</title>
<polygon fill="lightblue" stroke="black" points="2191,-10512.5 2102,-10512.5 2102,-10476.5 2191,-10476.5 2191,-10512.5"/>
<text text-anchor="middle" x="2146.5" y="-10497.5" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="2146.5" y="-10486.5" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_8_allgather_mlp&#45;&gt;layer_8_gelu -->
<g id="edge646" class="edge">
<title>layer_8_allgather_mlp&#45;&gt;layer_8_gelu</title>
<path fill="none" stroke="black" d="M2146.5,-10548.16C2146.5,-10539.92 2146.5,-10530.93 2146.5,-10522.75"/>
<polygon fill="black" stroke="black" points="2150,-10522.6 2146.5,-10512.6 2143,-10522.6 2150,-10522.6"/>
</g>
<!-- layer_8_mlp_fc2_gpu8 -->
<g id="node387" class="node">
<title>layer_8_mlp_fc2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="1801.5,-10440.5 1707.5,-10440.5 1707.5,-10388.5 1801.5,-10388.5 1801.5,-10440.5"/>
<text text-anchor="middle" x="1754.5" y="-10428.5" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="1754.5" y="-10417.5" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="1754.5" y="-10406.5" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1754.5" y="-10395.5" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu8 -->
<g id="edge647" class="edge">
<title>layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu8</title>
<path fill="none" stroke="black" d="M2101.92,-10490.22C2038.69,-10484.77 1919.52,-10471.48 1811.29,-10440.4"/>
<polygon fill="black" stroke="black" points="1812.1,-10436.99 1801.52,-10437.54 1810.14,-10443.71 1812.1,-10436.99"/>
</g>
<!-- layer_8_mlp_fc2_gpu9 -->
<g id="node388" class="node">
<title>layer_8_mlp_fc2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="1913.5,-10440.5 1819.5,-10440.5 1819.5,-10388.5 1913.5,-10388.5 1913.5,-10440.5"/>
<text text-anchor="middle" x="1866.5" y="-10428.5" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="1866.5" y="-10417.5" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="1866.5" y="-10406.5" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1866.5" y="-10395.5" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu9 -->
<g id="edge648" class="edge">
<title>layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu9</title>
<path fill="none" stroke="black" d="M2101.61,-10485.45C2058.02,-10477.08 1990.01,-10462.5 1923.42,-10440.57"/>
<polygon fill="black" stroke="black" points="1924.2,-10437.14 1913.61,-10437.28 1921.98,-10443.77 1924.2,-10437.14"/>
</g>
<!-- layer_8_mlp_fc2_gpu10 -->
<g id="node389" class="node">
<title>layer_8_mlp_fc2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2025.5,-10440.5 1931.5,-10440.5 1931.5,-10388.5 2025.5,-10388.5 2025.5,-10440.5"/>
<text text-anchor="middle" x="1978.5" y="-10428.5" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="1978.5" y="-10417.5" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="1978.5" y="-10406.5" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1978.5" y="-10395.5" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu10 -->
<g id="edge649" class="edge">
<title>layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu10</title>
<path fill="none" stroke="black" d="M2109.63,-10476.38C2087.71,-10466.2 2059.45,-10453.08 2034.78,-10441.63"/>
<polygon fill="black" stroke="black" points="2036.06,-10438.37 2025.52,-10437.33 2033.12,-10444.72 2036.06,-10438.37"/>
</g>
<!-- layer_8_mlp_fc2_gpu11 -->
<g id="node390" class="node">
<title>layer_8_mlp_fc2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2137.5,-10440.5 2043.5,-10440.5 2043.5,-10388.5 2137.5,-10388.5 2137.5,-10440.5"/>
<text text-anchor="middle" x="2090.5" y="-10428.5" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="2090.5" y="-10417.5" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2090.5" y="-10406.5" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2090.5" y="-10395.5" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu11 -->
<g id="edge650" class="edge">
<title>layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu11</title>
<path fill="none" stroke="black" d="M2134.07,-10476.19C2128.35,-10468.22 2121.35,-10458.47 2114.65,-10449.14"/>
<polygon fill="black" stroke="black" points="2117.31,-10446.84 2108.63,-10440.76 2111.62,-10450.92 2117.31,-10446.84"/>
</g>
<!-- layer_8_mlp_fc2_gpu12 -->
<g id="node391" class="node">
<title>layer_8_mlp_fc2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2249.5,-10440.5 2155.5,-10440.5 2155.5,-10388.5 2249.5,-10388.5 2249.5,-10440.5"/>
<text text-anchor="middle" x="2202.5" y="-10428.5" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="2202.5" y="-10417.5" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="2202.5" y="-10406.5" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2202.5" y="-10395.5" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu12 -->
<g id="edge651" class="edge">
<title>layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu12</title>
<path fill="none" stroke="black" d="M2158.93,-10476.19C2164.65,-10468.22 2171.65,-10458.47 2178.35,-10449.14"/>
<polygon fill="black" stroke="black" points="2181.38,-10450.92 2184.37,-10440.76 2175.69,-10446.84 2181.38,-10450.92"/>
</g>
<!-- layer_8_mlp_fc2_gpu13 -->
<g id="node392" class="node">
<title>layer_8_mlp_fc2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="2361.5,-10440.5 2267.5,-10440.5 2267.5,-10388.5 2361.5,-10388.5 2361.5,-10440.5"/>
<text text-anchor="middle" x="2314.5" y="-10428.5" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="2314.5" y="-10417.5" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="2314.5" y="-10406.5" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2314.5" y="-10395.5" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu13 -->
<g id="edge652" class="edge">
<title>layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu13</title>
<path fill="none" stroke="black" d="M2183.37,-10476.38C2205.29,-10466.2 2233.55,-10453.08 2258.22,-10441.63"/>
<polygon fill="black" stroke="black" points="2259.88,-10444.72 2267.48,-10437.33 2256.94,-10438.37 2259.88,-10444.72"/>
</g>
<!-- layer_8_mlp_fc2_gpu14 -->
<g id="node393" class="node">
<title>layer_8_mlp_fc2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="2473.5,-10440.5 2379.5,-10440.5 2379.5,-10388.5 2473.5,-10388.5 2473.5,-10440.5"/>
<text text-anchor="middle" x="2426.5" y="-10428.5" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="2426.5" y="-10417.5" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="2426.5" y="-10406.5" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2426.5" y="-10395.5" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu14 -->
<g id="edge653" class="edge">
<title>layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu14</title>
<path fill="none" stroke="black" d="M2191.39,-10485.45C2234.98,-10477.08 2302.99,-10462.5 2369.58,-10440.57"/>
<polygon fill="black" stroke="black" points="2371.02,-10443.77 2379.39,-10437.28 2368.8,-10437.14 2371.02,-10443.77"/>
</g>
<!-- layer_8_mlp_fc2_gpu15 -->
<g id="node394" class="node">
<title>layer_8_mlp_fc2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="2585.5,-10440.5 2491.5,-10440.5 2491.5,-10388.5 2585.5,-10388.5 2585.5,-10440.5"/>
<text text-anchor="middle" x="2538.5" y="-10428.5" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="2538.5" y="-10417.5" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="2538.5" y="-10406.5" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2538.5" y="-10395.5" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu15 -->
<g id="edge654" class="edge">
<title>layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu15</title>
<path fill="none" stroke="black" d="M2191.08,-10490.22C2254.31,-10484.77 2373.48,-10471.48 2481.71,-10440.4"/>
<polygon fill="black" stroke="black" points="2482.86,-10443.71 2491.48,-10437.54 2480.9,-10436.99 2482.86,-10443.71"/>
</g>
<!-- layer_8_allreduce_mlp -->
<g id="node395" class="node">
<title>layer_8_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="2202.5" cy="-10323.51" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="2202.5" y="-10332.01" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="2202.5" y="-10321.01" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="2202.5" y="-10310.01" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_8_mlp_fc2_gpu8&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge655" class="edge">
<title>layer_8_mlp_fc2_gpu8&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1801.53,-10391.48C1804.54,-10390.39 1807.54,-10389.39 1810.5,-10388.5 1920.66,-10355.52 2053.65,-10338.36 2132.97,-10330.39"/>
<polygon fill="black" stroke="black" points="2133.71,-10333.84 2143.32,-10329.38 2133.03,-10326.87 2133.71,-10333.84"/>
</g>
<!-- layer_8_mlp_fc2_gpu9&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge656" class="edge">
<title>layer_8_mlp_fc2_gpu9&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1913.6,-10391.7C1916.59,-10390.56 1919.57,-10389.48 1922.5,-10388.5 1994.11,-10364.59 2078.96,-10346.58 2136.34,-10335.85"/>
<polygon fill="black" stroke="black" points="2137.17,-10339.26 2146.37,-10334 2135.9,-10332.37 2137.17,-10339.26"/>
</g>
<!-- layer_8_mlp_fc2_gpu10&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge657" class="edge">
<title>layer_8_mlp_fc2_gpu10&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2025.78,-10392.17C2028.72,-10390.91 2031.65,-10389.68 2034.5,-10388.5 2071.39,-10373.26 2113.34,-10357.27 2146.1,-10345.1"/>
<polygon fill="black" stroke="black" points="2147.35,-10348.36 2155.51,-10341.6 2144.92,-10341.8 2147.35,-10348.36"/>
</g>
<!-- layer_8_mlp_fc2_gpu11&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge658" class="edge">
<title>layer_8_mlp_fc2_gpu11&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2122,-10388.47C2135.09,-10378.07 2150.4,-10365.91 2164.14,-10354.99"/>
<polygon fill="black" stroke="black" points="2166.36,-10357.69 2172.01,-10348.73 2162.01,-10352.21 2166.36,-10357.69"/>
</g>
<!-- layer_8_mlp_fc2_gpu12&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge659" class="edge">
<title>layer_8_mlp_fc2_gpu12&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2202.5,-10388.24C2202.5,-10380.35 2202.5,-10371.46 2202.5,-10362.88"/>
<polygon fill="black" stroke="black" points="2206,-10362.65 2202.5,-10352.65 2199,-10362.65 2206,-10362.65"/>
</g>
<!-- layer_8_mlp_fc2_gpu13&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge660" class="edge">
<title>layer_8_mlp_fc2_gpu13&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2283,-10388.47C2269.91,-10378.07 2254.6,-10365.91 2240.86,-10354.99"/>
<polygon fill="black" stroke="black" points="2242.99,-10352.21 2232.99,-10348.73 2238.64,-10357.69 2242.99,-10352.21"/>
</g>
<!-- layer_8_mlp_fc2_gpu14&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge661" class="edge">
<title>layer_8_mlp_fc2_gpu14&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2379.22,-10392.17C2376.28,-10390.91 2373.35,-10389.68 2370.5,-10388.5 2333.61,-10373.26 2291.66,-10357.27 2258.9,-10345.1"/>
<polygon fill="black" stroke="black" points="2260.08,-10341.8 2249.49,-10341.6 2257.65,-10348.36 2260.08,-10341.8"/>
</g>
<!-- layer_8_mlp_fc2_gpu15&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge662" class="edge">
<title>layer_8_mlp_fc2_gpu15&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2491.4,-10391.7C2488.41,-10390.56 2485.43,-10389.48 2482.5,-10388.5 2410.89,-10364.59 2326.04,-10346.58 2268.66,-10335.85"/>
<polygon fill="black" stroke="black" points="2269.1,-10332.37 2258.63,-10334 2267.83,-10339.26 2269.1,-10332.37"/>
</g>
<!-- layer_8_allreduce_mlp&#45;&gt;layer_8_residual2 -->
<g id="edge663" class="edge">
<title>layer_8_allreduce_mlp&#45;&gt;layer_8_residual2</title>
<path fill="none" stroke="black" d="M2245.47,-10303.01C2275.5,-10289.39 2315.96,-10271.04 2348.93,-10256.08"/>
<polygon fill="black" stroke="black" points="2350.8,-10259.08 2358.46,-10251.76 2347.91,-10252.7 2350.8,-10259.08"/>
</g>
<!-- layer_8_ln2 -->
<g id="node397" class="node">
<title>layer_8_ln2</title>
<polygon fill="lightblue" stroke="black" points="2444,-10162.52 2371,-10162.52 2371,-10121.52 2444,-10121.52 2444,-10162.52"/>
<text text-anchor="middle" x="2407.5" y="-10150.52" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="2407.5" y="-10139.52" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="2407.5" y="-10128.52" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_8_residual2&#45;&gt;layer_8_ln2 -->
<g id="edge665" class="edge">
<title>layer_8_residual2&#45;&gt;layer_8_ln2</title>
<path fill="none" stroke="black" d="M2407.5,-10198.44C2407.5,-10190.11 2407.5,-10181.03 2407.5,-10172.67"/>
<polygon fill="black" stroke="black" points="2411,-10172.58 2407.5,-10162.58 2404,-10172.58 2411,-10172.58"/>
</g>
<!-- layer_8_output_dist -->
<g id="node398" class="node">
<title>layer_8_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="2509.2,-10085.52 2347.42,-10085.52 2305.8,-10025.52 2467.58,-10025.52 2509.2,-10085.52"/>
<text text-anchor="middle" x="2407.5" y="-10058.52" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="2407.5" y="-10047.52" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_8_ln2&#45;&gt;layer_8_output_dist -->
<g id="edge666" class="edge">
<title>layer_8_ln2&#45;&gt;layer_8_output_dist</title>
<path fill="none" stroke="black" d="M2407.5,-10121.42C2407.5,-10113.78 2407.5,-10104.74 2407.5,-10095.87"/>
<polygon fill="black" stroke="black" points="2411,-10095.63 2407.5,-10085.63 2404,-10095.63 2411,-10095.63"/>
</g>
<!-- layer_9_input_dist -->
<g id="node399" class="node">
<title>layer_9_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="2501.69,-9989.52 2351.86,-9989.52 2313.31,-9929.52 2463.14,-9929.52 2501.69,-9989.52"/>
<text text-anchor="middle" x="2407.5" y="-9962.52" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="2407.5" y="-9951.52" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_8_output_dist&#45;&gt;layer_9_input_dist -->
<g id="edge667" class="edge">
<title>layer_8_output_dist&#45;&gt;layer_9_input_dist</title>
<path fill="none" stroke="black" d="M2407.5,-10025.29C2407.5,-10017.24 2407.5,-10008.38 2407.5,-9999.87"/>
<polygon fill="black" stroke="black" points="2411,-9999.73 2407.5,-9989.73 2404,-9999.73 2411,-9999.73"/>
</g>
<!-- layer_9_qkv_gpu8 -->
<g id="node400" class="node">
<title>layer_9_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2010,-9893.52 1917,-9893.52 1917,-9841.52 2010,-9841.52 2010,-9893.52"/>
<text text-anchor="middle" x="1963.5" y="-9881.52" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="1963.5" y="-9870.52" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="1963.5" y="-9859.52" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1963.5" y="-9848.52" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu8 -->
<g id="edge668" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu8</title>
<path fill="none" stroke="black" d="M2327,-9951.06C2249.82,-9942.55 2130.31,-9925.81 2019.86,-9893.29"/>
<polygon fill="black" stroke="black" points="2020.81,-9889.93 2010.22,-9890.41 2018.8,-9896.63 2020.81,-9889.93"/>
</g>
<!-- layer_9_qkv_gpu9 -->
<g id="node401" class="node">
<title>layer_9_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2121,-9893.52 2028,-9893.52 2028,-9841.52 2121,-9841.52 2121,-9893.52"/>
<text text-anchor="middle" x="2074.5" y="-9881.52" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="2074.5" y="-9870.52" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2074.5" y="-9859.52" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2074.5" y="-9848.52" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu9 -->
<g id="edge669" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu9</title>
<path fill="none" stroke="black" d="M2321.78,-9942.77C2268.93,-9932.05 2199.87,-9916.21 2131.01,-9893.44"/>
<polygon fill="black" stroke="black" points="2131.89,-9890.04 2121.3,-9890.18 2129.66,-9896.68 2131.89,-9890.04"/>
</g>
<!-- layer_9_qkv_gpu10 -->
<g id="node402" class="node">
<title>layer_9_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2232,-9893.52 2139,-9893.52 2139,-9841.52 2232,-9841.52 2232,-9893.52"/>
<text text-anchor="middle" x="2185.5" y="-9881.52" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="2185.5" y="-9870.52" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2185.5" y="-9859.52" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2185.5" y="-9848.52" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu10 -->
<g id="edge670" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu10</title>
<path fill="none" stroke="black" d="M2331.17,-9929.49C2302.89,-9918.51 2270.62,-9905.71 2241.5,-9893.52 2241.4,-9893.48 2241.31,-9893.44 2241.21,-9893.4"/>
<polygon fill="black" stroke="black" points="2242.75,-9890.25 2232.18,-9889.55 2240.01,-9896.69 2242.75,-9890.25"/>
</g>
<!-- layer_9_qkv_gpu11 -->
<g id="node403" class="node">
<title>layer_9_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2343,-9893.52 2250,-9893.52 2250,-9841.52 2343,-9841.52 2343,-9893.52"/>
<text text-anchor="middle" x="2296.5" y="-9881.52" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="2296.5" y="-9870.52" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2296.5" y="-9859.52" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2296.5" y="-9848.52" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu11 -->
<g id="edge671" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu11</title>
<path fill="none" stroke="black" d="M2371.46,-9929.3C2359.94,-9919.96 2347.14,-9909.57 2335.42,-9900.07"/>
<polygon fill="black" stroke="black" points="2337.48,-9897.24 2327.51,-9893.66 2333.08,-9902.68 2337.48,-9897.24"/>
</g>
<!-- layer_9_qkv_gpu12 -->
<g id="node404" class="node">
<title>layer_9_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2454,-9893.52 2361,-9893.52 2361,-9841.52 2454,-9841.52 2454,-9893.52"/>
<text text-anchor="middle" x="2407.5" y="-9881.52" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="2407.5" y="-9870.52" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="2407.5" y="-9859.52" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2407.5" y="-9848.52" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu12 -->
<g id="edge672" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu12</title>
<path fill="none" stroke="black" d="M2407.5,-9929.05C2407.5,-9920.97 2407.5,-9912.14 2407.5,-9903.78"/>
<polygon fill="black" stroke="black" points="2411,-9903.53 2407.5,-9893.53 2404,-9903.53 2411,-9903.53"/>
</g>
<!-- layer_9_qkv_gpu13 -->
<g id="node405" class="node">
<title>layer_9_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="2565,-9893.52 2472,-9893.52 2472,-9841.52 2565,-9841.52 2565,-9893.52"/>
<text text-anchor="middle" x="2518.5" y="-9881.52" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="2518.5" y="-9870.52" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="2518.5" y="-9859.52" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2518.5" y="-9848.52" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu13 -->
<g id="edge673" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu13</title>
<path fill="none" stroke="black" d="M2443.54,-9929.3C2455.06,-9919.96 2467.86,-9909.57 2479.58,-9900.07"/>
<polygon fill="black" stroke="black" points="2481.92,-9902.68 2487.49,-9893.66 2477.52,-9897.24 2481.92,-9902.68"/>
</g>
<!-- layer_9_qkv_gpu14 -->
<g id="node406" class="node">
<title>layer_9_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="2676,-9893.52 2583,-9893.52 2583,-9841.52 2676,-9841.52 2676,-9893.52"/>
<text text-anchor="middle" x="2629.5" y="-9881.52" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="2629.5" y="-9870.52" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="2629.5" y="-9859.52" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2629.5" y="-9848.52" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu14 -->
<g id="edge674" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu14</title>
<path fill="none" stroke="black" d="M2467.73,-9936C2497.33,-9924.72 2533.68,-9910.55 2573.42,-9893.9"/>
<polygon fill="black" stroke="black" points="2574.91,-9897.08 2582.77,-9889.97 2572.2,-9890.62 2574.91,-9897.08"/>
</g>
<!-- layer_9_qkv_gpu15 -->
<g id="node407" class="node">
<title>layer_9_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="2787,-9893.52 2694,-9893.52 2694,-9841.52 2787,-9841.52 2787,-9893.52"/>
<text text-anchor="middle" x="2740.5" y="-9881.52" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="2740.5" y="-9870.52" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="2740.5" y="-9859.52" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2740.5" y="-9848.52" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu15 -->
<g id="edge675" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu15</title>
<path fill="none" stroke="black" d="M2474.25,-9946.75C2528.88,-9936.25 2608.07,-9919.04 2684.2,-9893.73"/>
<polygon fill="black" stroke="black" points="2685.59,-9896.95 2693.95,-9890.43 2683.35,-9890.32 2685.59,-9896.95"/>
</g>
<!-- layer_9_residual1 -->
<g id="node419" class="node">
<title>layer_9_residual1</title>
<polygon fill="lightyellow" stroke="black" points="2697.44,-9441.55 2575.05,-9441.55 2543.56,-9381.55 2665.95,-9381.55 2697.44,-9441.55"/>
<text text-anchor="middle" x="2620.5" y="-9414.55" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="2620.5" y="-9403.55" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_residual1 -->
<g id="edge702" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_residual1</title>
<path fill="none" stroke="black" d="M2480.59,-9956.17C2580.77,-9951.36 2753.3,-9936.86 2796.5,-9893.52 2833.38,-9856.52 2815.5,-9829.76 2815.5,-9777.53 2815.5,-9777.53 2815.5,-9777.53 2815.5,-9596.53 2815.5,-9527.75 2750.52,-9477.08 2695.59,-9446.52"/>
<polygon fill="black" stroke="black" points="2696.98,-9443.29 2686.52,-9441.6 2693.64,-9449.44 2696.98,-9443.29"/>
</g>
<!-- layer_9_allgather_qkv -->
<g id="node408" class="node">
<title>layer_9_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="2363.5" cy="-9776.53" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="2363.5" y="-9785.03" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="2363.5" y="-9774.03" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="2363.5" y="-9763.03" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_9_qkv_gpu8&#45;&gt;layer_9_allgather_qkv -->
<g id="edge676" class="edge">
<title>layer_9_qkv_gpu8&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M2010.24,-9844.69C2013.35,-9843.54 2016.45,-9842.47 2019.5,-9841.52 2114.17,-9812.04 2227.96,-9794.13 2298.01,-9785.03"/>
<polygon fill="black" stroke="black" points="2298.54,-9788.49 2308.02,-9783.75 2297.65,-9781.55 2298.54,-9788.49"/>
</g>
<!-- layer_9_qkv_gpu9&#45;&gt;layer_9_allgather_qkv -->
<g id="edge677" class="edge">
<title>layer_9_qkv_gpu9&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M2121.03,-9845.11C2124.22,-9843.84 2127.39,-9842.63 2130.5,-9841.52 2187.65,-9821.05 2254.64,-9803.27 2302.08,-9791.69"/>
<polygon fill="black" stroke="black" points="2303,-9795.06 2311.9,-9789.31 2301.36,-9788.26 2303,-9795.06"/>
</g>
<!-- layer_9_qkv_gpu10&#45;&gt;layer_9_allgather_qkv -->
<g id="edge678" class="edge">
<title>layer_9_qkv_gpu10&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M2232.27,-9843.14C2257.59,-9830.48 2288.84,-9814.85 2314.5,-9802.02"/>
<polygon fill="black" stroke="black" points="2316.3,-9805.04 2323.68,-9797.43 2313.17,-9798.78 2316.3,-9805.04"/>
</g>
<!-- layer_9_qkv_gpu11&#45;&gt;layer_9_allgather_qkv -->
<g id="edge679" class="edge">
<title>layer_9_qkv_gpu11&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M2315.52,-9841.25C2322.41,-9832.1 2330.32,-9821.6 2337.69,-9811.8"/>
<polygon fill="black" stroke="black" points="2340.51,-9813.88 2343.73,-9803.78 2334.92,-9809.67 2340.51,-9813.88"/>
</g>
<!-- layer_9_qkv_gpu12&#45;&gt;layer_9_allgather_qkv -->
<g id="edge680" class="edge">
<title>layer_9_qkv_gpu12&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M2395.01,-9841.25C2390.78,-9832.7 2385.97,-9822.97 2381.4,-9813.73"/>
<polygon fill="black" stroke="black" points="2384.52,-9812.13 2376.95,-9804.72 2378.24,-9815.24 2384.52,-9812.13"/>
</g>
<!-- layer_9_qkv_gpu13&#45;&gt;layer_9_allgather_qkv -->
<g id="edge681" class="edge">
<title>layer_9_qkv_gpu13&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M2474.91,-9841.49C2454.48,-9829.76 2430.12,-9815.78 2409.4,-9803.88"/>
<polygon fill="black" stroke="black" points="2410.88,-9800.69 2400.47,-9798.75 2407.4,-9806.76 2410.88,-9800.69"/>
</g>
<!-- layer_9_qkv_gpu14&#45;&gt;layer_9_allgather_qkv -->
<g id="edge682" class="edge">
<title>layer_9_qkv_gpu14&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M2582.87,-9844.81C2580.05,-9843.66 2577.25,-9842.55 2574.5,-9841.52 2524.32,-9822.6 2465.88,-9805.22 2423.24,-9793.37"/>
<polygon fill="black" stroke="black" points="2424.15,-9789.99 2413.57,-9790.7 2422.28,-9796.73 2424.15,-9789.99"/>
</g>
<!-- layer_9_qkv_gpu15&#45;&gt;layer_9_allgather_qkv -->
<g id="edge683" class="edge">
<title>layer_9_qkv_gpu15&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M2693.98,-9844.49C2691.14,-9843.42 2688.3,-9842.42 2685.5,-9841.52 2598.72,-9813.59 2494.69,-9795.58 2428.83,-9786"/>
<polygon fill="black" stroke="black" points="2428.99,-9782.48 2418.6,-9784.53 2428,-9789.41 2428.99,-9782.48"/>
</g>
<!-- layer_9_attention -->
<g id="node409" class="node">
<title>layer_9_attention</title>
<polygon fill="lightblue" stroke="black" points="2397.5,-9711.53 2329.5,-9711.53 2329.5,-9659.53 2397.5,-9659.53 2397.5,-9711.53"/>
<text text-anchor="middle" x="2363.5" y="-9699.53" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="2363.5" y="-9688.53" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="2363.5" y="-9677.53" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="2363.5" y="-9666.53" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_9_allgather_qkv&#45;&gt;layer_9_attention -->
<g id="edge684" class="edge">
<title>layer_9_allgather_qkv&#45;&gt;layer_9_attention</title>
<path fill="none" stroke="black" d="M2363.5,-9747.37C2363.5,-9739.26 2363.5,-9730.31 2363.5,-9721.83"/>
<polygon fill="black" stroke="black" points="2367,-9721.8 2363.5,-9711.8 2360,-9721.8 2367,-9721.8"/>
</g>
<!-- layer_9_attn_out_gpu8 -->
<g id="node410" class="node">
<title>layer_9_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2045.5,-9623.53 1957.5,-9623.53 1957.5,-9571.53 2045.5,-9571.53 2045.5,-9623.53"/>
<text text-anchor="middle" x="2001.5" y="-9611.53" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="2001.5" y="-9600.53" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2001.5" y="-9589.53" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2001.5" y="-9578.53" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attention&#45;&gt;layer_9_attn_out_gpu8 -->
<g id="edge685" class="edge">
<title>layer_9_attention&#45;&gt;layer_9_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M2329.43,-9680.59C2273.48,-9673.53 2158.85,-9656.56 2055.37,-9623.5"/>
<polygon fill="black" stroke="black" points="2056.3,-9620.12 2045.71,-9620.35 2054.13,-9626.78 2056.3,-9620.12"/>
</g>
<!-- layer_9_attn_out_gpu9 -->
<g id="node411" class="node">
<title>layer_9_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2151.5,-9623.53 2063.5,-9623.53 2063.5,-9571.53 2151.5,-9571.53 2151.5,-9623.53"/>
<text text-anchor="middle" x="2107.5" y="-9611.53" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="2107.5" y="-9600.53" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2107.5" y="-9589.53" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2107.5" y="-9578.53" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attention&#45;&gt;layer_9_attn_out_gpu9 -->
<g id="edge686" class="edge">
<title>layer_9_attention&#45;&gt;layer_9_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M2329.22,-9675.91C2290.35,-9665.76 2225.05,-9647.61 2160.97,-9623.51"/>
<polygon fill="black" stroke="black" points="2162.12,-9620.2 2151.53,-9619.91 2159.63,-9626.74 2162.12,-9620.2"/>
</g>
<!-- layer_9_attn_out_gpu10 -->
<g id="node412" class="node">
<title>layer_9_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2257.5,-9623.53 2169.5,-9623.53 2169.5,-9571.53 2257.5,-9571.53 2257.5,-9623.53"/>
<text text-anchor="middle" x="2213.5" y="-9611.53" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="2213.5" y="-9600.53" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2213.5" y="-9589.53" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2213.5" y="-9578.53" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attention&#45;&gt;layer_9_attn_out_gpu10 -->
<g id="edge687" class="edge">
<title>layer_9_attention&#45;&gt;layer_9_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M2329.46,-9665.02C2310.78,-9654.31 2287.21,-9640.79 2266.2,-9628.75"/>
<polygon fill="black" stroke="black" points="2267.8,-9625.63 2257.38,-9623.69 2264.31,-9631.7 2267.8,-9625.63"/>
</g>
<!-- layer_9_attn_out_gpu11 -->
<g id="node413" class="node">
<title>layer_9_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2363.5,-9623.53 2275.5,-9623.53 2275.5,-9571.53 2363.5,-9571.53 2363.5,-9623.53"/>
<text text-anchor="middle" x="2319.5" y="-9611.53" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="2319.5" y="-9600.53" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2319.5" y="-9589.53" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2319.5" y="-9578.53" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attention&#45;&gt;layer_9_attn_out_gpu11 -->
<g id="edge688" class="edge">
<title>layer_9_attention&#45;&gt;layer_9_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M2350.54,-9659.2C2346.28,-9650.89 2341.49,-9641.51 2336.96,-9632.66"/>
<polygon fill="black" stroke="black" points="2340.04,-9631 2332.37,-9623.69 2333.81,-9634.19 2340.04,-9631"/>
</g>
<!-- layer_9_attn_out_gpu12 -->
<g id="node414" class="node">
<title>layer_9_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2469.5,-9623.53 2381.5,-9623.53 2381.5,-9571.53 2469.5,-9571.53 2469.5,-9623.53"/>
<text text-anchor="middle" x="2425.5" y="-9611.53" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="2425.5" y="-9600.53" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="2425.5" y="-9589.53" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2425.5" y="-9578.53" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attention&#45;&gt;layer_9_attn_out_gpu12 -->
<g id="edge689" class="edge">
<title>layer_9_attention&#45;&gt;layer_9_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M2381.77,-9659.2C2387.95,-9650.62 2394.95,-9640.92 2401.5,-9631.82"/>
<polygon fill="black" stroke="black" points="2404.35,-9633.85 2407.36,-9623.69 2398.68,-9629.76 2404.35,-9633.85"/>
</g>
<!-- layer_9_attn_out_gpu13 -->
<g id="node415" class="node">
<title>layer_9_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="2575.5,-9623.53 2487.5,-9623.53 2487.5,-9571.53 2575.5,-9571.53 2575.5,-9623.53"/>
<text text-anchor="middle" x="2531.5" y="-9611.53" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="2531.5" y="-9600.53" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="2531.5" y="-9589.53" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2531.5" y="-9578.53" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attention&#45;&gt;layer_9_attn_out_gpu13 -->
<g id="edge690" class="edge">
<title>layer_9_attention&#45;&gt;layer_9_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M2397.9,-9666.92C2421,-9655.1 2451.9,-9639.28 2478.16,-9625.84"/>
<polygon fill="black" stroke="black" points="2479.93,-9628.87 2487.24,-9621.19 2476.74,-9622.63 2479.93,-9628.87"/>
</g>
<!-- layer_9_attn_out_gpu14 -->
<g id="node416" class="node">
<title>layer_9_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="2681.5,-9623.53 2593.5,-9623.53 2593.5,-9571.53 2681.5,-9571.53 2681.5,-9623.53"/>
<text text-anchor="middle" x="2637.5" y="-9611.53" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="2637.5" y="-9600.53" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="2637.5" y="-9589.53" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2637.5" y="-9578.53" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attention&#45;&gt;layer_9_attn_out_gpu14 -->
<g id="edge691" class="edge">
<title>layer_9_attention&#45;&gt;layer_9_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M2397.77,-9677C2439.82,-9667.35 2513.28,-9649.12 2583.99,-9623.48"/>
<polygon fill="black" stroke="black" points="2585.32,-9626.72 2593.5,-9619.98 2582.9,-9620.15 2585.32,-9626.72"/>
</g>
<!-- layer_9_attn_out_gpu15 -->
<g id="node417" class="node">
<title>layer_9_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="2787.5,-9623.53 2699.5,-9623.53 2699.5,-9571.53 2787.5,-9571.53 2787.5,-9623.53"/>
<text text-anchor="middle" x="2743.5" y="-9611.53" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="2743.5" y="-9600.53" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="2743.5" y="-9589.53" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2743.5" y="-9578.53" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attention&#45;&gt;layer_9_attn_out_gpu15 -->
<g id="edge692" class="edge">
<title>layer_9_attention&#45;&gt;layer_9_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M2397.63,-9681.08C2456.2,-9674.54 2579.4,-9658.07 2689.69,-9623.46"/>
<polygon fill="black" stroke="black" points="2690.84,-9626.77 2699.3,-9620.39 2688.71,-9620.1 2690.84,-9626.77"/>
</g>
<!-- layer_9_allreduce_attn -->
<g id="node418" class="node">
<title>layer_9_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="2425.5" cy="-9506.54" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="2425.5" y="-9515.04" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="2425.5" y="-9504.04" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="2425.5" y="-9493.04" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_9_attn_out_gpu8&#45;&gt;layer_9_allreduce_attn -->
<g id="edge693" class="edge">
<title>layer_9_attn_out_gpu8&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M2045.68,-9574.63C2048.63,-9573.5 2051.59,-9572.45 2054.5,-9571.53 2157.93,-9538.88 2283.16,-9521.67 2358.47,-9513.61"/>
<polygon fill="black" stroke="black" points="2359.17,-9517.05 2368.75,-9512.53 2358.44,-9510.09 2359.17,-9517.05"/>
</g>
<!-- layer_9_attn_out_gpu9&#45;&gt;layer_9_allreduce_attn -->
<g id="edge694" class="edge">
<title>layer_9_attn_out_gpu9&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M2151.76,-9574.86C2154.69,-9573.67 2157.62,-9572.55 2160.5,-9571.53 2227.63,-9547.87 2307.34,-9529.93 2361.69,-9519.15"/>
<polygon fill="black" stroke="black" points="2362.39,-9522.58 2371.53,-9517.22 2361.04,-9515.71 2362.39,-9522.58"/>
</g>
<!-- layer_9_attn_out_gpu10&#45;&gt;layer_9_allreduce_attn -->
<g id="edge695" class="edge">
<title>layer_9_attn_out_gpu10&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M2257.66,-9575.47C2260.64,-9574.12 2263.61,-9572.8 2266.5,-9571.53 2300.83,-9556.55 2339.84,-9540.83 2370.63,-9528.72"/>
<polygon fill="black" stroke="black" points="2372.29,-9531.83 2380.32,-9524.92 2369.73,-9525.31 2372.29,-9531.83"/>
</g>
<!-- layer_9_attn_out_gpu11&#45;&gt;layer_9_allreduce_attn -->
<g id="edge696" class="edge">
<title>layer_9_attn_out_gpu11&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M2349.31,-9571.51C2361.58,-9561.21 2375.92,-9549.17 2388.83,-9538.33"/>
<polygon fill="black" stroke="black" points="2391.24,-9540.88 2396.65,-9531.77 2386.74,-9535.52 2391.24,-9540.88"/>
</g>
<!-- layer_9_attn_out_gpu12&#45;&gt;layer_9_allreduce_attn -->
<g id="edge697" class="edge">
<title>layer_9_attn_out_gpu12&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M2425.5,-9571.27C2425.5,-9563.38 2425.5,-9554.49 2425.5,-9545.91"/>
<polygon fill="black" stroke="black" points="2429,-9545.69 2425.5,-9535.69 2422,-9545.69 2429,-9545.69"/>
</g>
<!-- layer_9_attn_out_gpu13&#45;&gt;layer_9_allreduce_attn -->
<g id="edge698" class="edge">
<title>layer_9_attn_out_gpu13&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M2501.69,-9571.51C2489.42,-9561.21 2475.08,-9549.17 2462.17,-9538.33"/>
<polygon fill="black" stroke="black" points="2464.26,-9535.52 2454.35,-9531.77 2459.76,-9540.88 2464.26,-9535.52"/>
</g>
<!-- layer_9_attn_out_gpu14&#45;&gt;layer_9_allreduce_attn -->
<g id="edge699" class="edge">
<title>layer_9_attn_out_gpu14&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M2593.34,-9575.47C2590.36,-9574.12 2587.39,-9572.8 2584.5,-9571.53 2550.17,-9556.55 2511.16,-9540.83 2480.37,-9528.72"/>
<polygon fill="black" stroke="black" points="2481.27,-9525.31 2470.68,-9524.92 2478.71,-9531.83 2481.27,-9525.31"/>
</g>
<!-- layer_9_attn_out_gpu15&#45;&gt;layer_9_allreduce_attn -->
<g id="edge700" class="edge">
<title>layer_9_attn_out_gpu15&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M2699.24,-9574.86C2696.31,-9573.67 2693.38,-9572.55 2690.5,-9571.53 2623.37,-9547.87 2543.66,-9529.93 2489.31,-9519.15"/>
<polygon fill="black" stroke="black" points="2489.96,-9515.71 2479.47,-9517.22 2488.61,-9522.58 2489.96,-9515.71"/>
</g>
<!-- layer_9_allreduce_attn&#45;&gt;layer_9_residual1 -->
<g id="edge701" class="edge">
<title>layer_9_allreduce_attn&#45;&gt;layer_9_residual1</title>
<path fill="none" stroke="black" d="M2466.85,-9485.82C2494.62,-9472.58 2531.59,-9454.95 2562.31,-9440.3"/>
<polygon fill="black" stroke="black" points="2564.1,-9443.32 2571.62,-9435.86 2561.09,-9437.01 2564.1,-9443.32"/>
</g>
<!-- layer_9_ln1 -->
<g id="node420" class="node">
<title>layer_9_ln1</title>
<polygon fill="lightblue" stroke="black" points="2452,-9345.55 2379,-9345.55 2379,-9304.55 2452,-9304.55 2452,-9345.55"/>
<text text-anchor="middle" x="2415.5" y="-9333.55" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="2415.5" y="-9322.55" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="2415.5" y="-9311.55" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_9_residual1&#45;&gt;layer_9_ln1 -->
<g id="edge703" class="edge">
<title>layer_9_residual1&#45;&gt;layer_9_ln1</title>
<path fill="none" stroke="black" d="M2549.95,-9381.47C2520.66,-9369.4 2487.49,-9355.73 2461.43,-9344.98"/>
<polygon fill="black" stroke="black" points="2462.75,-9341.74 2452.17,-9341.17 2460.08,-9348.21 2462.75,-9341.74"/>
</g>
<!-- layer_9_residual2 -->
<g id="node440" class="node">
<title>layer_9_residual2</title>
<polygon fill="lightyellow" stroke="black" points="2697.44,-8832.59 2575.05,-8832.59 2543.56,-8772.59 2665.95,-8772.59 2697.44,-8832.59"/>
<text text-anchor="middle" x="2620.5" y="-8805.59" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="2620.5" y="-8794.59" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_9_residual1&#45;&gt;layer_9_residual2 -->
<g id="edge738" class="edge">
<title>layer_9_residual1&#45;&gt;layer_9_residual2</title>
<path fill="none" stroke="black" d="M2672.48,-9393.99C2733.51,-9370.91 2826.5,-9322.74 2826.5,-9243.55 2826.5,-9243.55 2826.5,-9243.55 2826.5,-8987.57 2826.5,-8917.36 2759.11,-8867.28 2701.42,-8837.27"/>
<polygon fill="black" stroke="black" points="2702.76,-8834.02 2692.26,-8832.62 2699.6,-8840.27 2702.76,-8834.02"/>
</g>
<!-- layer_9_mlp_fc1_gpu8 -->
<g id="node421" class="node">
<title>layer_9_mlp_fc1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2014.5,-9268.55 1920.5,-9268.55 1920.5,-9216.55 2014.5,-9216.55 2014.5,-9268.55"/>
<text text-anchor="middle" x="1967.5" y="-9256.55" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="1967.5" y="-9245.55" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="1967.5" y="-9234.55" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1967.5" y="-9223.55" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu8 -->
<g id="edge704" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu8</title>
<path fill="none" stroke="black" d="M2378.85,-9322.27C2310.28,-9318.22 2158.17,-9305.8 2024.13,-9268.38"/>
<polygon fill="black" stroke="black" points="2025.08,-9265.02 2014.51,-9265.65 2023.17,-9271.75 2025.08,-9265.02"/>
</g>
<!-- layer_9_mlp_fc1_gpu9 -->
<g id="node422" class="node">
<title>layer_9_mlp_fc1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2126.5,-9268.55 2032.5,-9268.55 2032.5,-9216.55 2126.5,-9216.55 2126.5,-9268.55"/>
<text text-anchor="middle" x="2079.5" y="-9256.55" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="2079.5" y="-9245.55" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2079.5" y="-9234.55" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2079.5" y="-9223.55" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu9 -->
<g id="edge705" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu9</title>
<path fill="none" stroke="black" d="M2378.6,-9319.43C2326.26,-9312.29 2227.55,-9296.69 2136.23,-9268.5"/>
<polygon fill="black" stroke="black" points="2137.16,-9265.12 2126.57,-9265.46 2135.05,-9271.8 2137.16,-9265.12"/>
</g>
<!-- layer_9_mlp_fc1_gpu10 -->
<g id="node423" class="node">
<title>layer_9_mlp_fc1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2238.5,-9268.55 2144.5,-9268.55 2144.5,-9216.55 2238.5,-9216.55 2238.5,-9268.55"/>
<text text-anchor="middle" x="2191.5" y="-9256.55" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="2191.5" y="-9245.55" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2191.5" y="-9234.55" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2191.5" y="-9223.55" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu10 -->
<g id="edge706" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu10</title>
<path fill="none" stroke="black" d="M2378.75,-9313.08C2346.47,-9303.19 2298.12,-9287.74 2248.08,-9268.64"/>
<polygon fill="black" stroke="black" points="2249.3,-9265.36 2238.72,-9265.03 2246.79,-9271.89 2249.3,-9265.36"/>
</g>
<!-- layer_9_mlp_fc1_gpu11 -->
<g id="node424" class="node">
<title>layer_9_mlp_fc1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2350.5,-9268.55 2256.5,-9268.55 2256.5,-9216.55 2350.5,-9216.55 2350.5,-9268.55"/>
<text text-anchor="middle" x="2303.5" y="-9256.55" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="2303.5" y="-9245.55" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2303.5" y="-9234.55" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2303.5" y="-9223.55" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu11 -->
<g id="edge707" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu11</title>
<path fill="none" stroke="black" d="M2388.1,-9304.36C2375.77,-9295.49 2360.9,-9284.81 2347.09,-9274.89"/>
<polygon fill="black" stroke="black" points="2348.83,-9271.82 2338.67,-9268.83 2344.74,-9277.51 2348.83,-9271.82"/>
</g>
<!-- layer_9_mlp_fc1_gpu12 -->
<g id="node425" class="node">
<title>layer_9_mlp_fc1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2462.5,-9268.55 2368.5,-9268.55 2368.5,-9216.55 2462.5,-9216.55 2462.5,-9268.55"/>
<text text-anchor="middle" x="2415.5" y="-9256.55" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="2415.5" y="-9245.55" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="2415.5" y="-9234.55" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2415.5" y="-9223.55" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu12 -->
<g id="edge708" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu12</title>
<path fill="none" stroke="black" d="M2415.5,-9304.15C2415.5,-9296.54 2415.5,-9287.61 2415.5,-9278.98"/>
<polygon fill="black" stroke="black" points="2419,-9278.71 2415.5,-9268.71 2412,-9278.71 2419,-9278.71"/>
</g>
<!-- layer_9_mlp_fc1_gpu13 -->
<g id="node426" class="node">
<title>layer_9_mlp_fc1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="2574.5,-9268.55 2480.5,-9268.55 2480.5,-9216.55 2574.5,-9216.55 2574.5,-9268.55"/>
<text text-anchor="middle" x="2527.5" y="-9256.55" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="2527.5" y="-9245.55" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="2527.5" y="-9234.55" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2527.5" y="-9223.55" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu13 -->
<g id="edge709" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu13</title>
<path fill="none" stroke="black" d="M2442.9,-9304.36C2455.23,-9295.49 2470.1,-9284.81 2483.91,-9274.89"/>
<polygon fill="black" stroke="black" points="2486.26,-9277.51 2492.33,-9268.83 2482.17,-9271.82 2486.26,-9277.51"/>
</g>
<!-- layer_9_mlp_fc1_gpu14 -->
<g id="node427" class="node">
<title>layer_9_mlp_fc1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="2686.5,-9268.55 2592.5,-9268.55 2592.5,-9216.55 2686.5,-9216.55 2686.5,-9268.55"/>
<text text-anchor="middle" x="2639.5" y="-9256.55" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="2639.5" y="-9245.55" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="2639.5" y="-9234.55" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2639.5" y="-9223.55" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu14 -->
<g id="edge710" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu14</title>
<path fill="none" stroke="black" d="M2452.25,-9313.08C2484.53,-9303.19 2532.88,-9287.74 2582.92,-9268.64"/>
<polygon fill="black" stroke="black" points="2584.21,-9271.89 2592.28,-9265.03 2581.7,-9265.36 2584.21,-9271.89"/>
</g>
<!-- layer_9_mlp_fc1_gpu15 -->
<g id="node428" class="node">
<title>layer_9_mlp_fc1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="2798.5,-9268.55 2704.5,-9268.55 2704.5,-9216.55 2798.5,-9216.55 2798.5,-9268.55"/>
<text text-anchor="middle" x="2751.5" y="-9256.55" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="2751.5" y="-9245.55" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="2751.5" y="-9234.55" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2751.5" y="-9223.55" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu15 -->
<g id="edge711" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu15</title>
<path fill="none" stroke="black" d="M2452.4,-9319.43C2504.74,-9312.29 2603.45,-9296.69 2694.77,-9268.5"/>
<polygon fill="black" stroke="black" points="2695.95,-9271.8 2704.43,-9265.46 2693.84,-9265.12 2695.95,-9271.8"/>
</g>
<!-- layer_9_allgather_mlp -->
<g id="node429" class="node">
<title>layer_9_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="2359.5" cy="-9151.56" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="2359.5" y="-9160.06" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="2359.5" y="-9149.06" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="2359.5" y="-9138.06" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_9_mlp_fc1_gpu8&#45;&gt;layer_9_allgather_mlp -->
<g id="edge712" class="edge">
<title>layer_9_mlp_fc1_gpu8&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M2014.56,-9219.62C2017.56,-9218.51 2020.55,-9217.48 2023.5,-9216.55 2115.52,-9187.68 2226.02,-9169.69 2294.51,-9160.39"/>
<polygon fill="black" stroke="black" points="2295.27,-9163.82 2304.72,-9159.02 2294.34,-9156.88 2295.27,-9163.82"/>
</g>
<!-- layer_9_mlp_fc1_gpu9&#45;&gt;layer_9_allgather_mlp -->
<g id="edge713" class="edge">
<title>layer_9_mlp_fc1_gpu9&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M2126.66,-9219.93C2129.64,-9218.75 2132.6,-9217.61 2135.5,-9216.55 2190.03,-9196.7 2253.79,-9179 2299.32,-9167.28"/>
<polygon fill="black" stroke="black" points="2300.21,-9170.66 2309.03,-9164.8 2298.47,-9163.88 2300.21,-9170.66"/>
</g>
<!-- layer_9_mlp_fc1_gpu10&#45;&gt;layer_9_allgather_mlp -->
<g id="edge714" class="edge">
<title>layer_9_mlp_fc1_gpu10&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M2238.74,-9216.53C2261.71,-9204.36 2289.23,-9189.78 2312.2,-9177.62"/>
<polygon fill="black" stroke="black" points="2313.89,-9180.68 2321.09,-9172.91 2310.61,-9174.5 2313.89,-9180.68"/>
</g>
<!-- layer_9_mlp_fc1_gpu11&#45;&gt;layer_9_allgather_mlp -->
<g id="edge715" class="edge">
<title>layer_9_mlp_fc1_gpu11&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M2319.4,-9216.29C2324.94,-9207.48 2331.27,-9197.42 2337.24,-9187.93"/>
<polygon fill="black" stroke="black" points="2340.22,-9189.77 2342.58,-9179.44 2334.3,-9186.04 2340.22,-9189.77"/>
</g>
<!-- layer_9_mlp_fc1_gpu12&#45;&gt;layer_9_allgather_mlp -->
<g id="edge716" class="edge">
<title>layer_9_mlp_fc1_gpu12&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M2399.6,-9216.29C2394.06,-9207.48 2387.73,-9197.42 2381.76,-9187.93"/>
<polygon fill="black" stroke="black" points="2384.7,-9186.04 2376.42,-9179.44 2378.78,-9189.77 2384.7,-9186.04"/>
</g>
<!-- layer_9_mlp_fc1_gpu13&#45;&gt;layer_9_allgather_mlp -->
<g id="edge717" class="edge">
<title>layer_9_mlp_fc1_gpu13&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M2480.26,-9216.53C2457.29,-9204.36 2429.77,-9189.78 2406.8,-9177.62"/>
<polygon fill="black" stroke="black" points="2408.39,-9174.5 2397.91,-9172.91 2405.11,-9180.68 2408.39,-9174.5"/>
</g>
<!-- layer_9_mlp_fc1_gpu14&#45;&gt;layer_9_allgather_mlp -->
<g id="edge718" class="edge">
<title>layer_9_mlp_fc1_gpu14&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M2592.34,-9219.93C2589.36,-9218.75 2586.4,-9217.61 2583.5,-9216.55 2528.97,-9196.7 2465.21,-9179 2419.68,-9167.28"/>
<polygon fill="black" stroke="black" points="2420.53,-9163.88 2409.97,-9164.8 2418.79,-9170.66 2420.53,-9163.88"/>
</g>
<!-- layer_9_mlp_fc1_gpu15&#45;&gt;layer_9_allgather_mlp -->
<g id="edge719" class="edge">
<title>layer_9_mlp_fc1_gpu15&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M2704.44,-9219.62C2701.44,-9218.51 2698.45,-9217.48 2695.5,-9216.55 2603.48,-9187.68 2492.98,-9169.69 2424.49,-9160.39"/>
<polygon fill="black" stroke="black" points="2424.66,-9156.88 2414.28,-9159.02 2423.73,-9163.82 2424.66,-9156.88"/>
</g>
<!-- layer_9_gelu -->
<g id="node430" class="node">
<title>layer_9_gelu</title>
<polygon fill="lightblue" stroke="black" points="2404,-9086.57 2315,-9086.57 2315,-9050.57 2404,-9050.57 2404,-9086.57"/>
<text text-anchor="middle" x="2359.5" y="-9071.57" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="2359.5" y="-9060.57" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_9_allgather_mlp&#45;&gt;layer_9_gelu -->
<g id="edge720" class="edge">
<title>layer_9_allgather_mlp&#45;&gt;layer_9_gelu</title>
<path fill="none" stroke="black" d="M2359.5,-9122.23C2359.5,-9113.99 2359.5,-9105 2359.5,-9096.82"/>
<polygon fill="black" stroke="black" points="2363,-9096.66 2359.5,-9086.66 2356,-9096.66 2363,-9096.66"/>
</g>
<!-- layer_9_mlp_fc2_gpu8 -->
<g id="node431" class="node">
<title>layer_9_mlp_fc2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2014.5,-9014.57 1920.5,-9014.57 1920.5,-8962.57 2014.5,-8962.57 2014.5,-9014.57"/>
<text text-anchor="middle" x="1967.5" y="-9002.57" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="1967.5" y="-8991.57" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="1967.5" y="-8980.57" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1967.5" y="-8969.57" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu8 -->
<g id="edge721" class="edge">
<title>layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu8</title>
<path fill="none" stroke="black" d="M2314.92,-9064.29C2251.69,-9058.83 2132.52,-9045.55 2024.29,-9014.47"/>
<polygon fill="black" stroke="black" points="2025.1,-9011.06 2014.52,-9011.61 2023.14,-9017.78 2025.1,-9011.06"/>
</g>
<!-- layer_9_mlp_fc2_gpu9 -->
<g id="node432" class="node">
<title>layer_9_mlp_fc2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2126.5,-9014.57 2032.5,-9014.57 2032.5,-8962.57 2126.5,-8962.57 2126.5,-9014.57"/>
<text text-anchor="middle" x="2079.5" y="-9002.57" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="2079.5" y="-8991.57" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2079.5" y="-8980.57" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2079.5" y="-8969.57" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu9 -->
<g id="edge722" class="edge">
<title>layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu9</title>
<path fill="none" stroke="black" d="M2314.61,-9059.52C2271.02,-9051.14 2203.01,-9036.57 2136.42,-9014.64"/>
<polygon fill="black" stroke="black" points="2137.2,-9011.21 2126.61,-9011.35 2134.98,-9017.84 2137.2,-9011.21"/>
</g>
<!-- layer_9_mlp_fc2_gpu10 -->
<g id="node433" class="node">
<title>layer_9_mlp_fc2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2238.5,-9014.57 2144.5,-9014.57 2144.5,-8962.57 2238.5,-8962.57 2238.5,-9014.57"/>
<text text-anchor="middle" x="2191.5" y="-9002.57" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="2191.5" y="-8991.57" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2191.5" y="-8980.57" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2191.5" y="-8969.57" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu10 -->
<g id="edge723" class="edge">
<title>layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu10</title>
<path fill="none" stroke="black" d="M2322.63,-9050.45C2300.71,-9040.27 2272.45,-9027.15 2247.78,-9015.7"/>
<polygon fill="black" stroke="black" points="2249.06,-9012.44 2238.52,-9011.4 2246.12,-9018.79 2249.06,-9012.44"/>
</g>
<!-- layer_9_mlp_fc2_gpu11 -->
<g id="node434" class="node">
<title>layer_9_mlp_fc2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2350.5,-9014.57 2256.5,-9014.57 2256.5,-8962.57 2350.5,-8962.57 2350.5,-9014.57"/>
<text text-anchor="middle" x="2303.5" y="-9002.57" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="2303.5" y="-8991.57" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2303.5" y="-8980.57" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2303.5" y="-8969.57" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu11 -->
<g id="edge724" class="edge">
<title>layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu11</title>
<path fill="none" stroke="black" d="M2347.07,-9050.26C2341.35,-9042.29 2334.35,-9032.54 2327.65,-9023.21"/>
<polygon fill="black" stroke="black" points="2330.31,-9020.91 2321.63,-9014.83 2324.62,-9024.99 2330.31,-9020.91"/>
</g>
<!-- layer_9_mlp_fc2_gpu12 -->
<g id="node435" class="node">
<title>layer_9_mlp_fc2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2462.5,-9014.57 2368.5,-9014.57 2368.5,-8962.57 2462.5,-8962.57 2462.5,-9014.57"/>
<text text-anchor="middle" x="2415.5" y="-9002.57" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="2415.5" y="-8991.57" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="2415.5" y="-8980.57" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2415.5" y="-8969.57" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu12 -->
<g id="edge725" class="edge">
<title>layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu12</title>
<path fill="none" stroke="black" d="M2371.93,-9050.26C2377.65,-9042.29 2384.65,-9032.54 2391.35,-9023.21"/>
<polygon fill="black" stroke="black" points="2394.38,-9024.99 2397.37,-9014.83 2388.69,-9020.91 2394.38,-9024.99"/>
</g>
<!-- layer_9_mlp_fc2_gpu13 -->
<g id="node436" class="node">
<title>layer_9_mlp_fc2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="2574.5,-9014.57 2480.5,-9014.57 2480.5,-8962.57 2574.5,-8962.57 2574.5,-9014.57"/>
<text text-anchor="middle" x="2527.5" y="-9002.57" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="2527.5" y="-8991.57" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="2527.5" y="-8980.57" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2527.5" y="-8969.57" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu13 -->
<g id="edge726" class="edge">
<title>layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu13</title>
<path fill="none" stroke="black" d="M2396.37,-9050.45C2418.29,-9040.27 2446.55,-9027.15 2471.22,-9015.7"/>
<polygon fill="black" stroke="black" points="2472.88,-9018.79 2480.48,-9011.4 2469.94,-9012.44 2472.88,-9018.79"/>
</g>
<!-- layer_9_mlp_fc2_gpu14 -->
<g id="node437" class="node">
<title>layer_9_mlp_fc2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="2686.5,-9014.57 2592.5,-9014.57 2592.5,-8962.57 2686.5,-8962.57 2686.5,-9014.57"/>
<text text-anchor="middle" x="2639.5" y="-9002.57" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="2639.5" y="-8991.57" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="2639.5" y="-8980.57" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2639.5" y="-8969.57" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu14 -->
<g id="edge727" class="edge">
<title>layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu14</title>
<path fill="none" stroke="black" d="M2404.39,-9059.52C2447.98,-9051.14 2515.99,-9036.57 2582.58,-9014.64"/>
<polygon fill="black" stroke="black" points="2584.02,-9017.84 2592.39,-9011.35 2581.8,-9011.21 2584.02,-9017.84"/>
</g>
<!-- layer_9_mlp_fc2_gpu15 -->
<g id="node438" class="node">
<title>layer_9_mlp_fc2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="2798.5,-9014.57 2704.5,-9014.57 2704.5,-8962.57 2798.5,-8962.57 2798.5,-9014.57"/>
<text text-anchor="middle" x="2751.5" y="-9002.57" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="2751.5" y="-8991.57" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="2751.5" y="-8980.57" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2751.5" y="-8969.57" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu15 -->
<g id="edge728" class="edge">
<title>layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu15</title>
<path fill="none" stroke="black" d="M2404.08,-9064.29C2467.31,-9058.83 2586.48,-9045.55 2694.71,-9014.47"/>
<polygon fill="black" stroke="black" points="2695.86,-9017.78 2704.48,-9011.61 2693.9,-9011.06 2695.86,-9017.78"/>
</g>
<!-- layer_9_allreduce_mlp -->
<g id="node439" class="node">
<title>layer_9_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="2415.5" cy="-8897.58" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="2415.5" y="-8906.08" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="2415.5" y="-8895.08" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="2415.5" y="-8884.08" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_9_mlp_fc2_gpu8&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge729" class="edge">
<title>layer_9_mlp_fc2_gpu8&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2014.53,-8965.55C2017.54,-8964.46 2020.54,-8963.45 2023.5,-8962.57 2133.66,-8929.59 2266.65,-8912.42 2345.97,-8904.46"/>
<polygon fill="black" stroke="black" points="2346.71,-8907.91 2356.32,-8903.45 2346.03,-8900.94 2346.71,-8907.91"/>
</g>
<!-- layer_9_mlp_fc2_gpu9&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge730" class="edge">
<title>layer_9_mlp_fc2_gpu9&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2126.6,-8965.77C2129.59,-8964.62 2132.57,-8963.55 2135.5,-8962.57 2207.11,-8938.66 2291.96,-8920.64 2349.34,-8909.92"/>
<polygon fill="black" stroke="black" points="2350.17,-8913.32 2359.37,-8908.07 2348.9,-8906.44 2350.17,-8913.32"/>
</g>
<!-- layer_9_mlp_fc2_gpu10&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge731" class="edge">
<title>layer_9_mlp_fc2_gpu10&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2238.78,-8966.24C2241.72,-8964.98 2244.65,-8963.75 2247.5,-8962.57 2284.39,-8947.32 2326.34,-8931.34 2359.1,-8919.16"/>
<polygon fill="black" stroke="black" points="2360.35,-8922.43 2368.51,-8915.67 2357.92,-8915.87 2360.35,-8922.43"/>
</g>
<!-- layer_9_mlp_fc2_gpu11&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge732" class="edge">
<title>layer_9_mlp_fc2_gpu11&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2335,-8962.54C2348.09,-8952.14 2363.4,-8939.98 2377.14,-8929.06"/>
<polygon fill="black" stroke="black" points="2379.36,-8931.76 2385.01,-8922.8 2375.01,-8926.28 2379.36,-8931.76"/>
</g>
<!-- layer_9_mlp_fc2_gpu12&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge733" class="edge">
<title>layer_9_mlp_fc2_gpu12&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2415.5,-8962.31C2415.5,-8954.41 2415.5,-8945.52 2415.5,-8936.94"/>
<polygon fill="black" stroke="black" points="2419,-8936.72 2415.5,-8926.72 2412,-8936.72 2419,-8936.72"/>
</g>
<!-- layer_9_mlp_fc2_gpu13&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge734" class="edge">
<title>layer_9_mlp_fc2_gpu13&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2496,-8962.54C2482.91,-8952.14 2467.6,-8939.98 2453.86,-8929.06"/>
<polygon fill="black" stroke="black" points="2455.99,-8926.28 2445.99,-8922.8 2451.64,-8931.76 2455.99,-8926.28"/>
</g>
<!-- layer_9_mlp_fc2_gpu14&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge735" class="edge">
<title>layer_9_mlp_fc2_gpu14&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2592.22,-8966.24C2589.28,-8964.98 2586.35,-8963.75 2583.5,-8962.57 2546.61,-8947.32 2504.66,-8931.34 2471.9,-8919.16"/>
<polygon fill="black" stroke="black" points="2473.08,-8915.87 2462.49,-8915.67 2470.65,-8922.43 2473.08,-8915.87"/>
</g>
<!-- layer_9_mlp_fc2_gpu15&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge736" class="edge">
<title>layer_9_mlp_fc2_gpu15&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2704.4,-8965.77C2701.41,-8964.62 2698.43,-8963.55 2695.5,-8962.57 2623.89,-8938.66 2539.04,-8920.64 2481.66,-8909.92"/>
<polygon fill="black" stroke="black" points="2482.1,-8906.44 2471.63,-8908.07 2480.83,-8913.32 2482.1,-8906.44"/>
</g>
<!-- layer_9_allreduce_mlp&#45;&gt;layer_9_residual2 -->
<g id="edge737" class="edge">
<title>layer_9_allreduce_mlp&#45;&gt;layer_9_residual2</title>
<path fill="none" stroke="black" d="M2458.47,-8877.08C2488.5,-8863.46 2528.96,-8845.11 2561.93,-8830.15"/>
<polygon fill="black" stroke="black" points="2563.8,-8833.15 2571.46,-8825.83 2560.91,-8826.77 2563.8,-8833.15"/>
</g>
<!-- layer_9_ln2 -->
<g id="node441" class="node">
<title>layer_9_ln2</title>
<polygon fill="lightblue" stroke="black" points="2657,-8736.59 2584,-8736.59 2584,-8695.59 2657,-8695.59 2657,-8736.59"/>
<text text-anchor="middle" x="2620.5" y="-8724.59" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="2620.5" y="-8713.59" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="2620.5" y="-8702.59" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_9_residual2&#45;&gt;layer_9_ln2 -->
<g id="edge739" class="edge">
<title>layer_9_residual2&#45;&gt;layer_9_ln2</title>
<path fill="none" stroke="black" d="M2620.5,-8772.51C2620.5,-8764.18 2620.5,-8755.1 2620.5,-8746.74"/>
<polygon fill="black" stroke="black" points="2624,-8746.65 2620.5,-8736.65 2617,-8746.65 2624,-8746.65"/>
</g>
<!-- layer_9_output_dist -->
<g id="node442" class="node">
<title>layer_9_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="2722.2,-8659.59 2560.42,-8659.59 2518.8,-8599.59 2680.58,-8599.59 2722.2,-8659.59"/>
<text text-anchor="middle" x="2620.5" y="-8632.59" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="2620.5" y="-8621.59" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_9_ln2&#45;&gt;layer_9_output_dist -->
<g id="edge740" class="edge">
<title>layer_9_ln2&#45;&gt;layer_9_output_dist</title>
<path fill="none" stroke="black" d="M2620.5,-8695.49C2620.5,-8687.85 2620.5,-8678.81 2620.5,-8669.94"/>
<polygon fill="black" stroke="black" points="2624,-8669.7 2620.5,-8659.7 2617,-8669.7 2624,-8669.7"/>
</g>
<!-- layer_10_input_dist -->
<g id="node443" class="node">
<title>layer_10_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="2714.69,-8563.59 2564.86,-8563.59 2526.31,-8503.59 2676.14,-8503.59 2714.69,-8563.59"/>
<text text-anchor="middle" x="2620.5" y="-8536.59" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="2620.5" y="-8525.59" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_9_output_dist&#45;&gt;layer_10_input_dist -->
<g id="edge741" class="edge">
<title>layer_9_output_dist&#45;&gt;layer_10_input_dist</title>
<path fill="none" stroke="black" d="M2620.5,-8599.36C2620.5,-8591.31 2620.5,-8582.45 2620.5,-8573.93"/>
<polygon fill="black" stroke="black" points="2624,-8573.79 2620.5,-8563.79 2617,-8573.8 2624,-8573.79"/>
</g>
<!-- layer_10_qkv_gpu8 -->
<g id="node444" class="node">
<title>layer_10_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2205.5,-8467.59 2107.5,-8467.59 2107.5,-8415.59 2205.5,-8415.59 2205.5,-8467.59"/>
<text text-anchor="middle" x="2156.5" y="-8455.59" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="2156.5" y="-8444.59" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2156.5" y="-8433.59" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2156.5" y="-8422.59" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu8 -->
<g id="edge742" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu8</title>
<path fill="none" stroke="black" d="M2540.24,-8525.67C2459.67,-8517.39 2332.23,-8500.66 2215.38,-8467.55"/>
<polygon fill="black" stroke="black" points="2216.13,-8464.12 2205.55,-8464.72 2214.19,-8470.85 2216.13,-8464.12"/>
</g>
<!-- layer_10_qkv_gpu9 -->
<g id="node445" class="node">
<title>layer_10_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2321.5,-8467.59 2223.5,-8467.59 2223.5,-8415.59 2321.5,-8415.59 2321.5,-8467.59"/>
<text text-anchor="middle" x="2272.5" y="-8455.59" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="2272.5" y="-8444.59" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2272.5" y="-8433.59" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2272.5" y="-8422.59" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu9 -->
<g id="edge743" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu9</title>
<path fill="none" stroke="black" d="M2535.31,-8517.83C2479.43,-8507.15 2404.84,-8490.98 2331.49,-8467.68"/>
<polygon fill="black" stroke="black" points="2332.21,-8464.24 2321.62,-8464.5 2330.06,-8470.9 2332.21,-8464.24"/>
</g>
<!-- layer_10_qkv_gpu10 -->
<g id="node446" class="node">
<title>layer_10_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2437.5,-8467.59 2339.5,-8467.59 2339.5,-8415.59 2437.5,-8415.59 2437.5,-8467.59"/>
<text text-anchor="middle" x="2388.5" y="-8455.59" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="2388.5" y="-8444.59" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2388.5" y="-8433.59" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2388.5" y="-8422.59" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu10 -->
<g id="edge744" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu10</title>
<path fill="none" stroke="black" d="M2540.05,-8503.48C2512.93,-8493.44 2482.36,-8481.87 2447.3,-8467.85"/>
<polygon fill="black" stroke="black" points="2448.38,-8464.51 2437.79,-8464.03 2445.77,-8471 2448.38,-8464.51"/>
</g>
<!-- layer_10_qkv_gpu11 -->
<g id="node447" class="node">
<title>layer_10_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2553.5,-8467.59 2455.5,-8467.59 2455.5,-8415.59 2553.5,-8415.59 2553.5,-8467.59"/>
<text text-anchor="middle" x="2504.5" y="-8455.59" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="2504.5" y="-8444.59" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2504.5" y="-8433.59" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2504.5" y="-8422.59" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu11 -->
<g id="edge745" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu11</title>
<path fill="none" stroke="black" d="M2582.84,-8503.37C2570.68,-8493.93 2557.16,-8483.44 2544.82,-8473.87"/>
<polygon fill="black" stroke="black" points="2546.96,-8471.1 2536.91,-8467.73 2542.66,-8476.63 2546.96,-8471.1"/>
</g>
<!-- layer_10_qkv_gpu12 -->
<g id="node448" class="node">
<title>layer_10_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2669.5,-8467.59 2571.5,-8467.59 2571.5,-8415.59 2669.5,-8415.59 2669.5,-8467.59"/>
<text text-anchor="middle" x="2620.5" y="-8455.59" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="2620.5" y="-8444.59" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="2620.5" y="-8433.59" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2620.5" y="-8422.59" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu12 -->
<g id="edge746" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu12</title>
<path fill="none" stroke="black" d="M2620.5,-8503.12C2620.5,-8495.04 2620.5,-8486.21 2620.5,-8477.84"/>
<polygon fill="black" stroke="black" points="2624,-8477.6 2620.5,-8467.6 2617,-8477.6 2624,-8477.6"/>
</g>
<!-- layer_10_qkv_gpu13 -->
<g id="node449" class="node">
<title>layer_10_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="2785.5,-8467.59 2687.5,-8467.59 2687.5,-8415.59 2785.5,-8415.59 2785.5,-8467.59"/>
<text text-anchor="middle" x="2736.5" y="-8455.59" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="2736.5" y="-8444.59" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="2736.5" y="-8433.59" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2736.5" y="-8422.59" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu13 -->
<g id="edge747" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu13</title>
<path fill="none" stroke="black" d="M2658.16,-8503.37C2670.32,-8493.93 2683.84,-8483.44 2696.18,-8473.87"/>
<polygon fill="black" stroke="black" points="2698.34,-8476.63 2704.09,-8467.73 2694.04,-8471.1 2698.34,-8476.63"/>
</g>
<!-- layer_10_qkv_gpu14 -->
<g id="node450" class="node">
<title>layer_10_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="2901.5,-8467.59 2803.5,-8467.59 2803.5,-8415.59 2901.5,-8415.59 2901.5,-8467.59"/>
<text text-anchor="middle" x="2852.5" y="-8455.59" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="2852.5" y="-8444.59" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="2852.5" y="-8433.59" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2852.5" y="-8422.59" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu14 -->
<g id="edge748" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu14</title>
<path fill="none" stroke="black" d="M2681.18,-8510.76C2712.44,-8499.31 2751.35,-8484.77 2793.81,-8467.8"/>
<polygon fill="black" stroke="black" points="2795.23,-8471 2803.21,-8464.03 2792.62,-8464.51 2795.23,-8471"/>
</g>
<!-- layer_10_qkv_gpu15 -->
<g id="node451" class="node">
<title>layer_10_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3017.5,-8467.59 2919.5,-8467.59 2919.5,-8415.59 3017.5,-8415.59 3017.5,-8467.59"/>
<text text-anchor="middle" x="2968.5" y="-8455.59" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="2968.5" y="-8444.59" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="2968.5" y="-8433.59" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2968.5" y="-8422.59" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu15 -->
<g id="edge749" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu15</title>
<path fill="none" stroke="black" d="M2687.68,-8521.21C2744.75,-8510.71 2828.78,-8493.3 2909.55,-8467.67"/>
<polygon fill="black" stroke="black" points="2910.93,-8470.9 2919.38,-8464.5 2908.79,-8464.23 2910.93,-8470.9"/>
</g>
<!-- layer_10_residual1 -->
<g id="node463" class="node">
<title>layer_10_residual1</title>
<polygon fill="lightyellow" stroke="black" points="2918.44,-8015.62 2796.05,-8015.62 2764.56,-7955.62 2886.95,-7955.62 2918.44,-8015.62"/>
<text text-anchor="middle" x="2841.5" y="-7988.62" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="2841.5" y="-7977.62" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_residual1 -->
<g id="edge776" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_residual1</title>
<path fill="none" stroke="black" d="M2693.7,-8530.83C2797.74,-8526.72 2980.86,-8513.06 3026.5,-8467.59 3063.51,-8430.71 3045.5,-8403.83 3045.5,-8351.59 3045.5,-8351.59 3045.5,-8351.59 3045.5,-8170.6 3045.5,-8100.66 2978.55,-8050.47 2921.36,-8020.36"/>
<polygon fill="black" stroke="black" points="2922.77,-8017.15 2912.28,-8015.7 2919.58,-8023.38 2922.77,-8017.15"/>
</g>
<!-- layer_10_allgather_qkv -->
<g id="node452" class="node">
<title>layer_10_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="2573.5" cy="-8350.59" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="2573.5" y="-8359.09" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="2573.5" y="-8348.09" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="2573.5" y="-8337.09" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_10_qkv_gpu8&#45;&gt;layer_10_allgather_qkv -->
<g id="edge750" class="edge">
<title>layer_10_qkv_gpu8&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M2205.57,-8418.52C2208.57,-8417.46 2211.56,-8416.47 2214.5,-8415.59 2314.69,-8385.51 2435.1,-8367.6 2507.89,-8358.68"/>
<polygon fill="black" stroke="black" points="2508.33,-8362.15 2517.84,-8357.48 2507.49,-8355.2 2508.33,-8362.15"/>
</g>
<!-- layer_10_qkv_gpu9&#45;&gt;layer_10_allgather_qkv -->
<g id="edge751" class="edge">
<title>layer_10_qkv_gpu9&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M2321.66,-8418.8C2324.64,-8417.67 2327.6,-8416.59 2330.5,-8415.59 2390.88,-8394.75 2461.68,-8376.82 2511.23,-8365.28"/>
<polygon fill="black" stroke="black" points="2512.2,-8368.65 2521.16,-8362.99 2510.63,-8361.83 2512.2,-8368.65"/>
</g>
<!-- layer_10_qkv_gpu10&#45;&gt;layer_10_allgather_qkv -->
<g id="edge752" class="edge">
<title>layer_10_qkv_gpu10&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M2437.59,-8416.97C2464.21,-8404.17 2497.03,-8388.38 2523.75,-8375.52"/>
<polygon fill="black" stroke="black" points="2525.44,-8378.6 2532.93,-8371.11 2522.4,-8372.29 2525.44,-8378.6"/>
</g>
<!-- layer_10_qkv_gpu11&#45;&gt;layer_10_allgather_qkv -->
<g id="edge753" class="edge">
<title>layer_10_qkv_gpu11&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M2524.09,-8415.32C2531.19,-8406.17 2539.32,-8395.67 2546.92,-8385.87"/>
<polygon fill="black" stroke="black" points="2549.78,-8387.9 2553.14,-8377.85 2544.25,-8383.61 2549.78,-8387.9"/>
</g>
<!-- layer_10_qkv_gpu12&#45;&gt;layer_10_allgather_qkv -->
<g id="edge754" class="edge">
<title>layer_10_qkv_gpu12&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M2607.16,-8415.32C2602.64,-8406.77 2597.5,-8397.04 2592.62,-8387.8"/>
<polygon fill="black" stroke="black" points="2595.63,-8386 2587.86,-8378.79 2589.44,-8389.27 2595.63,-8386"/>
</g>
<!-- layer_10_qkv_gpu13&#45;&gt;layer_10_allgather_qkv -->
<g id="edge755" class="edge">
<title>layer_10_qkv_gpu13&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M2690.66,-8415.56C2668.73,-8403.59 2642.51,-8389.27 2620.44,-8377.22"/>
<polygon fill="black" stroke="black" points="2622.03,-8374.1 2611.57,-8372.38 2618.67,-8380.24 2622.03,-8374.1"/>
</g>
<!-- layer_10_qkv_gpu14&#45;&gt;layer_10_allgather_qkv -->
<g id="edge756" class="edge">
<title>layer_10_qkv_gpu14&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M2803.31,-8418.88C2800.34,-8417.73 2797.39,-8416.62 2794.5,-8415.59 2741.02,-8396.4 2678.74,-8378.78 2633.95,-8366.91"/>
<polygon fill="black" stroke="black" points="2634.66,-8363.48 2624.1,-8364.31 2632.88,-8370.25 2634.66,-8363.48"/>
</g>
<!-- layer_10_qkv_gpu15&#45;&gt;layer_10_allgather_qkv -->
<g id="edge757" class="edge">
<title>layer_10_qkv_gpu15&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M2919.42,-8418.56C2916.42,-8417.49 2913.44,-8416.49 2910.5,-8415.59 2818.29,-8387.33 2707.89,-8369.22 2639.21,-8359.72"/>
<polygon fill="black" stroke="black" points="2639.35,-8356.21 2628.97,-8358.33 2638.41,-8363.14 2639.35,-8356.21"/>
</g>
<!-- layer_10_attention -->
<g id="node453" class="node">
<title>layer_10_attention</title>
<polygon fill="lightblue" stroke="black" points="2607.5,-8285.6 2539.5,-8285.6 2539.5,-8233.6 2607.5,-8233.6 2607.5,-8285.6"/>
<text text-anchor="middle" x="2573.5" y="-8273.6" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="2573.5" y="-8262.6" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="2573.5" y="-8251.6" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="2573.5" y="-8240.6" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_10_allgather_qkv&#45;&gt;layer_10_attention -->
<g id="edge758" class="edge">
<title>layer_10_allgather_qkv&#45;&gt;layer_10_attention</title>
<path fill="none" stroke="black" d="M2573.5,-8321.44C2573.5,-8313.33 2573.5,-8304.38 2573.5,-8295.89"/>
<polygon fill="black" stroke="black" points="2577,-8295.87 2573.5,-8285.87 2570,-8295.87 2577,-8295.87"/>
</g>
<!-- layer_10_attn_out_gpu8 -->
<g id="node454" class="node">
<title>layer_10_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2240,-8197.6 2147,-8197.6 2147,-8145.6 2240,-8145.6 2240,-8197.6"/>
<text text-anchor="middle" x="2193.5" y="-8185.6" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="2193.5" y="-8174.6" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2193.5" y="-8163.6" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2193.5" y="-8152.6" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attention&#45;&gt;layer_10_attn_out_gpu8 -->
<g id="edge759" class="edge">
<title>layer_10_attention&#45;&gt;layer_10_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M2539.28,-8254.83C2481.17,-8247.86 2359.62,-8230.8 2249.81,-8197.39"/>
<polygon fill="black" stroke="black" points="2250.83,-8194.04 2240.25,-8194.43 2248.76,-8200.73 2250.83,-8194.04"/>
</g>
<!-- layer_10_attn_out_gpu9 -->
<g id="node455" class="node">
<title>layer_10_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2351,-8197.6 2258,-8197.6 2258,-8145.6 2351,-8145.6 2351,-8197.6"/>
<text text-anchor="middle" x="2304.5" y="-8185.6" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="2304.5" y="-8174.6" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2304.5" y="-8163.6" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2304.5" y="-8152.6" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attention&#45;&gt;layer_10_attn_out_gpu9 -->
<g id="edge760" class="edge">
<title>layer_10_attention&#45;&gt;layer_10_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M2539.46,-8250.43C2497.01,-8239.89 2422.48,-8220.19 2360.5,-8197.6 2360.4,-8197.57 2360.31,-8197.53 2360.21,-8197.5"/>
<polygon fill="black" stroke="black" points="2361.64,-8194.3 2351.05,-8193.97 2359.13,-8200.83 2361.64,-8194.3"/>
</g>
<!-- layer_10_attn_out_gpu10 -->
<g id="node456" class="node">
<title>layer_10_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2462,-8197.6 2369,-8197.6 2369,-8145.6 2462,-8145.6 2462,-8197.6"/>
<text text-anchor="middle" x="2415.5" y="-8185.6" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="2415.5" y="-8174.6" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2415.5" y="-8163.6" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2415.5" y="-8152.6" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attention&#45;&gt;layer_10_attn_out_gpu10 -->
<g id="edge761" class="edge">
<title>layer_10_attention&#45;&gt;layer_10_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M2539.22,-8239.94C2519.19,-8229.04 2493.44,-8215.02 2470.62,-8202.6"/>
<polygon fill="black" stroke="black" points="2472.16,-8199.46 2461.71,-8197.75 2468.82,-8205.61 2472.16,-8199.46"/>
</g>
<!-- layer_10_attn_out_gpu11 -->
<g id="node457" class="node">
<title>layer_10_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2573,-8197.6 2480,-8197.6 2480,-8145.6 2573,-8145.6 2573,-8197.6"/>
<text text-anchor="middle" x="2526.5" y="-8185.6" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="2526.5" y="-8174.6" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2526.5" y="-8163.6" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2526.5" y="-8152.6" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attention&#45;&gt;layer_10_attn_out_gpu11 -->
<g id="edge762" class="edge">
<title>layer_10_attention&#45;&gt;layer_10_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M2559.65,-8233.27C2555.11,-8224.96 2549.99,-8215.58 2545.15,-8206.73"/>
<polygon fill="black" stroke="black" points="2548.12,-8204.86 2540.25,-8197.76 2541.97,-8208.21 2548.12,-8204.86"/>
</g>
<!-- layer_10_attn_out_gpu12 -->
<g id="node458" class="node">
<title>layer_10_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2684,-8197.6 2591,-8197.6 2591,-8145.6 2684,-8145.6 2684,-8197.6"/>
<text text-anchor="middle" x="2637.5" y="-8185.6" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="2637.5" y="-8174.6" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="2637.5" y="-8163.6" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2637.5" y="-8152.6" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attention&#45;&gt;layer_10_attn_out_gpu12 -->
<g id="edge763" class="edge">
<title>layer_10_attention&#45;&gt;layer_10_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M2592.36,-8233.27C2598.74,-8224.69 2605.96,-8214.99 2612.73,-8205.89"/>
<polygon fill="black" stroke="black" points="2615.62,-8207.87 2618.78,-8197.76 2610,-8203.69 2615.62,-8207.87"/>
</g>
<!-- layer_10_attn_out_gpu13 -->
<g id="node459" class="node">
<title>layer_10_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="2795,-8197.6 2702,-8197.6 2702,-8145.6 2795,-8145.6 2795,-8197.6"/>
<text text-anchor="middle" x="2748.5" y="-8185.6" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="2748.5" y="-8174.6" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="2748.5" y="-8163.6" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2748.5" y="-8152.6" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attention&#45;&gt;layer_10_attn_out_gpu13 -->
<g id="edge764" class="edge">
<title>layer_10_attention&#45;&gt;layer_10_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M2607.66,-8241.82C2631.79,-8229.96 2664.67,-8213.8 2692.59,-8200.08"/>
<polygon fill="black" stroke="black" points="2694.42,-8203.08 2701.85,-8195.53 2691.33,-8196.8 2694.42,-8203.08"/>
</g>
<!-- layer_10_attn_out_gpu14 -->
<g id="node460" class="node">
<title>layer_10_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="2906,-8197.6 2813,-8197.6 2813,-8145.6 2906,-8145.6 2906,-8197.6"/>
<text text-anchor="middle" x="2859.5" y="-8185.6" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="2859.5" y="-8174.6" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="2859.5" y="-8163.6" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2859.5" y="-8152.6" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attention&#45;&gt;layer_10_attn_out_gpu14 -->
<g id="edge765" class="edge">
<title>layer_10_attention&#45;&gt;layer_10_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M2607.71,-8251.47C2651.42,-8241.94 2729.39,-8223.56 2803.44,-8197.77"/>
<polygon fill="black" stroke="black" points="2804.65,-8201.06 2812.91,-8194.43 2802.32,-8194.46 2804.65,-8201.06"/>
</g>
<!-- layer_10_attn_out_gpu15 -->
<g id="node461" class="node">
<title>layer_10_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3017,-8197.6 2924,-8197.6 2924,-8145.6 3017,-8145.6 3017,-8197.6"/>
<text text-anchor="middle" x="2970.5" y="-8185.6" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="2970.5" y="-8174.6" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="2970.5" y="-8163.6" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2970.5" y="-8152.6" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attention&#45;&gt;layer_10_attn_out_gpu15 -->
<g id="edge766" class="edge">
<title>layer_10_attention&#45;&gt;layer_10_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M2607.66,-8255.37C2668.27,-8249.02 2798.42,-8232.66 2913.99,-8197.79"/>
<polygon fill="black" stroke="black" points="2915.17,-8201.09 2923.7,-8194.81 2913.11,-8194.4 2915.17,-8201.09"/>
</g>
<!-- layer_10_allreduce_attn -->
<g id="node462" class="node">
<title>layer_10_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="2637.5" cy="-8080.61" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="2637.5" y="-8089.11" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="2637.5" y="-8078.11" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="2637.5" y="-8067.11" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_10_attn_out_gpu8&#45;&gt;layer_10_allreduce_attn -->
<g id="edge767" class="edge">
<title>layer_10_attn_out_gpu8&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M2240.22,-8148.7C2243.33,-8147.57 2246.44,-8146.52 2249.5,-8145.6 2359.32,-8112.63 2492.06,-8095.38 2570.36,-8087.41"/>
<polygon fill="black" stroke="black" points="2570.97,-8090.87 2580.57,-8086.39 2570.27,-8083.9 2570.97,-8090.87"/>
</g>
<!-- layer_10_attn_out_gpu9&#45;&gt;layer_10_allreduce_attn -->
<g id="edge768" class="edge">
<title>layer_10_attn_out_gpu9&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M2351.29,-8148.93C2354.38,-8147.74 2357.47,-8146.62 2360.5,-8145.6 2431.91,-8121.67 2516.6,-8103.53 2573.37,-8092.78"/>
<polygon fill="black" stroke="black" points="2574.1,-8096.21 2583.29,-8090.93 2572.82,-8089.33 2574.1,-8096.21"/>
</g>
<!-- layer_10_attn_out_gpu10&#45;&gt;layer_10_allreduce_attn -->
<g id="edge769" class="edge">
<title>layer_10_attn_out_gpu10&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M2462.17,-8149.55C2465.32,-8148.2 2468.45,-8146.87 2471.5,-8145.6 2508.07,-8130.4 2549.66,-8114.37 2582.06,-8102.16"/>
<polygon fill="black" stroke="black" points="2583.67,-8105.29 2591.8,-8098.5 2581.21,-8098.74 2583.67,-8105.29"/>
</g>
<!-- layer_10_attn_out_gpu11&#45;&gt;layer_10_allreduce_attn -->
<g id="edge770" class="edge">
<title>layer_10_attn_out_gpu11&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M2557.72,-8145.58C2570.79,-8135.09 2586.11,-8122.81 2599.81,-8111.83"/>
<polygon fill="black" stroke="black" points="2602.05,-8114.52 2607.67,-8105.53 2597.67,-8109.06 2602.05,-8114.52"/>
</g>
<!-- layer_10_attn_out_gpu12&#45;&gt;layer_10_allreduce_attn -->
<g id="edge771" class="edge">
<title>layer_10_attn_out_gpu12&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M2637.5,-8145.34C2637.5,-8137.45 2637.5,-8128.56 2637.5,-8119.98"/>
<polygon fill="black" stroke="black" points="2641,-8119.75 2637.5,-8109.75 2634,-8119.75 2641,-8119.75"/>
</g>
<!-- layer_10_attn_out_gpu13&#45;&gt;layer_10_allreduce_attn -->
<g id="edge772" class="edge">
<title>layer_10_attn_out_gpu13&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M2717.28,-8145.58C2704.21,-8135.09 2688.89,-8122.81 2675.19,-8111.83"/>
<polygon fill="black" stroke="black" points="2677.33,-8109.06 2667.33,-8105.53 2672.95,-8114.52 2677.33,-8109.06"/>
</g>
<!-- layer_10_attn_out_gpu14&#45;&gt;layer_10_allreduce_attn -->
<g id="edge773" class="edge">
<title>layer_10_attn_out_gpu14&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M2812.78,-8149.13C2809.98,-8147.92 2807.21,-8146.74 2804.5,-8145.6 2767.61,-8130.17 2725.57,-8114.07 2692.9,-8101.88"/>
<polygon fill="black" stroke="black" points="2694.11,-8098.59 2683.52,-8098.39 2691.67,-8105.15 2694.11,-8098.59"/>
</g>
<!-- layer_10_attn_out_gpu15&#45;&gt;layer_10_allreduce_attn -->
<g id="edge774" class="edge">
<title>layer_10_attn_out_gpu15&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M2923.95,-8148.68C2921.11,-8147.58 2918.28,-8146.55 2915.5,-8145.6 2843.92,-8121.37 2758.9,-8103.29 2701.9,-8092.64"/>
<polygon fill="black" stroke="black" points="2702.41,-8089.17 2691.94,-8090.8 2701.14,-8096.06 2702.41,-8089.17"/>
</g>
<!-- layer_10_allreduce_attn&#45;&gt;layer_10_residual1 -->
<g id="edge775" class="edge">
<title>layer_10_allreduce_attn&#45;&gt;layer_10_residual1</title>
<path fill="none" stroke="black" d="M2679.77,-8060.34C2709.62,-8046.74 2750,-8028.33 2782.95,-8013.31"/>
<polygon fill="black" stroke="black" points="2784.82,-8016.3 2792.47,-8008.97 2781.92,-8009.93 2784.82,-8016.3"/>
</g>
<!-- layer_10_ln1 -->
<g id="node464" class="node">
<title>layer_10_ln1</title>
<polygon fill="lightblue" stroke="black" points="2664,-7919.62 2591,-7919.62 2591,-7878.62 2664,-7878.62 2664,-7919.62"/>
<text text-anchor="middle" x="2627.5" y="-7907.62" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="2627.5" y="-7896.62" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="2627.5" y="-7885.62" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_10_residual1&#45;&gt;layer_10_ln1 -->
<g id="edge777" class="edge">
<title>layer_10_residual1&#45;&gt;layer_10_ln1</title>
<path fill="none" stroke="black" d="M2767.85,-7955.54C2736.49,-7943.16 2700.88,-7929.09 2673.37,-7918.23"/>
<polygon fill="black" stroke="black" points="2674.59,-7914.95 2664,-7914.53 2672.02,-7921.46 2674.59,-7914.95"/>
</g>
<!-- layer_10_residual2 -->
<g id="node484" class="node">
<title>layer_10_residual2</title>
<polygon fill="lightyellow" stroke="black" points="2918.44,-7406.66 2796.05,-7406.66 2764.56,-7346.66 2886.95,-7346.66 2918.44,-7406.66"/>
<text text-anchor="middle" x="2841.5" y="-7379.66" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="2841.5" y="-7368.66" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_10_residual1&#45;&gt;layer_10_residual2 -->
<g id="edge812" class="edge">
<title>layer_10_residual1&#45;&gt;layer_10_residual2</title>
<path fill="none" stroke="black" d="M2894.37,-7969.22C2958.03,-7947.04 3056.5,-7899.5 3056.5,-7817.62 3056.5,-7817.62 3056.5,-7817.62 3056.5,-7561.64 3056.5,-7490.26 2987.25,-7440.64 2927.35,-7411.07"/>
<polygon fill="black" stroke="black" points="2928.74,-7407.86 2918.21,-7406.68 2925.7,-7414.17 2928.74,-7407.86"/>
</g>
<!-- layer_10_mlp_fc1_gpu8 -->
<g id="node465" class="node">
<title>layer_10_mlp_fc1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2209,-7842.62 2110,-7842.62 2110,-7790.62 2209,-7790.62 2209,-7842.62"/>
<text text-anchor="middle" x="2159.5" y="-7830.62" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="2159.5" y="-7819.62" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2159.5" y="-7808.62" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2159.5" y="-7797.62" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu8 -->
<g id="edge778" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu8</title>
<path fill="none" stroke="black" d="M2590.74,-7896.41C2519.94,-7892.41 2359.96,-7879.99 2218.76,-7842.35"/>
<polygon fill="black" stroke="black" points="2219.63,-7838.96 2209.06,-7839.72 2217.79,-7845.72 2219.63,-7838.96"/>
</g>
<!-- layer_10_mlp_fc1_gpu9 -->
<g id="node466" class="node">
<title>layer_10_mlp_fc1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2326,-7842.62 2227,-7842.62 2227,-7790.62 2326,-7790.62 2326,-7842.62"/>
<text text-anchor="middle" x="2276.5" y="-7830.62" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="2276.5" y="-7819.62" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2276.5" y="-7808.62" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2276.5" y="-7797.62" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu9 -->
<g id="edge779" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu9</title>
<path fill="none" stroke="black" d="M2590.94,-7893.72C2536.85,-7886.66 2432.39,-7870.92 2335.74,-7842.41"/>
<polygon fill="black" stroke="black" points="2336.7,-7839.05 2326.12,-7839.52 2334.69,-7845.75 2336.7,-7839.05"/>
</g>
<!-- layer_10_mlp_fc1_gpu10 -->
<g id="node467" class="node">
<title>layer_10_mlp_fc1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2443,-7842.62 2344,-7842.62 2344,-7790.62 2443,-7790.62 2443,-7842.62"/>
<text text-anchor="middle" x="2393.5" y="-7830.62" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="2393.5" y="-7819.62" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2393.5" y="-7808.62" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2393.5" y="-7797.62" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu10 -->
<g id="edge780" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu10</title>
<path fill="none" stroke="black" d="M2590.97,-7887.62C2557.35,-7877.72 2505.97,-7861.99 2452.85,-7842.62"/>
<polygon fill="black" stroke="black" points="2453.86,-7839.26 2443.26,-7839.09 2451.44,-7845.83 2453.86,-7839.26"/>
</g>
<!-- layer_10_mlp_fc1_gpu11 -->
<g id="node468" class="node">
<title>layer_10_mlp_fc1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2560,-7842.62 2461,-7842.62 2461,-7790.62 2560,-7790.62 2560,-7842.62"/>
<text text-anchor="middle" x="2510.5" y="-7830.62" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="2510.5" y="-7819.62" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2510.5" y="-7808.62" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2510.5" y="-7797.62" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu11 -->
<g id="edge781" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu11</title>
<path fill="none" stroke="black" d="M2598.88,-7878.43C2585.87,-7869.48 2570.17,-7858.68 2555.63,-7848.67"/>
<polygon fill="black" stroke="black" points="2557.46,-7845.68 2547.24,-7842.9 2553.49,-7851.45 2557.46,-7845.68"/>
</g>
<!-- layer_10_mlp_fc1_gpu12 -->
<g id="node469" class="node">
<title>layer_10_mlp_fc1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2677,-7842.62 2578,-7842.62 2578,-7790.62 2677,-7790.62 2677,-7842.62"/>
<text text-anchor="middle" x="2627.5" y="-7830.62" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="2627.5" y="-7819.62" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="2627.5" y="-7808.62" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2627.5" y="-7797.62" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu12 -->
<g id="edge782" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu12</title>
<path fill="none" stroke="black" d="M2627.5,-7878.22C2627.5,-7870.61 2627.5,-7861.68 2627.5,-7853.05"/>
<polygon fill="black" stroke="black" points="2631,-7852.78 2627.5,-7842.78 2624,-7852.78 2631,-7852.78"/>
</g>
<!-- layer_10_mlp_fc1_gpu13 -->
<g id="node470" class="node">
<title>layer_10_mlp_fc1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="2794,-7842.62 2695,-7842.62 2695,-7790.62 2794,-7790.62 2794,-7842.62"/>
<text text-anchor="middle" x="2744.5" y="-7830.62" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="2744.5" y="-7819.62" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="2744.5" y="-7808.62" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2744.5" y="-7797.62" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu13 -->
<g id="edge783" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu13</title>
<path fill="none" stroke="black" d="M2656.12,-7878.43C2669.13,-7869.48 2684.83,-7858.68 2699.37,-7848.67"/>
<polygon fill="black" stroke="black" points="2701.51,-7851.45 2707.76,-7842.9 2697.54,-7845.68 2701.51,-7851.45"/>
</g>
<!-- layer_10_mlp_fc1_gpu14 -->
<g id="node471" class="node">
<title>layer_10_mlp_fc1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="2911,-7842.62 2812,-7842.62 2812,-7790.62 2911,-7790.62 2911,-7842.62"/>
<text text-anchor="middle" x="2861.5" y="-7830.62" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="2861.5" y="-7819.62" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="2861.5" y="-7808.62" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2861.5" y="-7797.62" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu14 -->
<g id="edge784" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu14</title>
<path fill="none" stroke="black" d="M2664.27,-7887.71C2698.1,-7877.87 2749.79,-7862.18 2802.46,-7842.88"/>
<polygon fill="black" stroke="black" points="2803.8,-7846.12 2811.96,-7839.37 2801.37,-7839.56 2803.8,-7846.12"/>
</g>
<!-- layer_10_mlp_fc1_gpu15 -->
<g id="node472" class="node">
<title>layer_10_mlp_fc1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3028,-7842.62 2929,-7842.62 2929,-7790.62 3028,-7790.62 3028,-7842.62"/>
<text text-anchor="middle" x="2978.5" y="-7830.62" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="2978.5" y="-7819.62" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="2978.5" y="-7808.62" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2978.5" y="-7797.62" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu15 -->
<g id="edge785" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu15</title>
<path fill="none" stroke="black" d="M2664.21,-7893.8C2718.46,-7886.86 2823.15,-7871.28 2918.94,-7842.85"/>
<polygon fill="black" stroke="black" points="2920.22,-7846.12 2928.77,-7839.88 2918.19,-7839.42 2920.22,-7846.12"/>
</g>
<!-- layer_10_allgather_mlp -->
<g id="node473" class="node">
<title>layer_10_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="2568.5" cy="-7725.63" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="2568.5" y="-7734.13" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="2568.5" y="-7723.13" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="2568.5" y="-7712.13" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_10_mlp_fc1_gpu8&#45;&gt;layer_10_allgather_mlp -->
<g id="edge786" class="edge">
<title>layer_10_mlp_fc1_gpu8&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M2209.11,-7793.69C2212.26,-7792.58 2215.41,-7791.55 2218.5,-7790.62 2315.8,-7761.5 2432.48,-7743.39 2503.52,-7734.16"/>
<polygon fill="black" stroke="black" points="2504.19,-7737.6 2513.66,-7732.86 2503.3,-7730.66 2504.19,-7737.6"/>
</g>
<!-- layer_10_mlp_fc1_gpu9&#45;&gt;layer_10_allgather_mlp -->
<g id="edge787" class="edge">
<title>layer_10_mlp_fc1_gpu9&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M2326.21,-7794.01C2329.34,-7792.82 2332.45,-7791.68 2335.5,-7790.62 2393.03,-7770.63 2460.24,-7752.74 2507.65,-7740.99"/>
<polygon fill="black" stroke="black" points="2508.58,-7744.36 2517.46,-7738.57 2506.91,-7737.56 2508.58,-7744.36"/>
</g>
<!-- layer_10_mlp_fc1_gpu10&#45;&gt;layer_10_allgather_mlp -->
<g id="edge788" class="edge">
<title>layer_10_mlp_fc1_gpu10&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M2442.71,-7790.59C2466.92,-7778.29 2495.99,-7763.5 2520.08,-7751.25"/>
<polygon fill="black" stroke="black" points="2521.73,-7754.34 2529.05,-7746.69 2518.55,-7748.1 2521.73,-7754.34"/>
</g>
<!-- layer_10_mlp_fc1_gpu11&#45;&gt;layer_10_allgather_mlp -->
<g id="edge789" class="edge">
<title>layer_10_mlp_fc1_gpu11&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M2526.97,-7790.36C2532.71,-7781.54 2539.27,-7771.49 2545.44,-7762"/>
<polygon fill="black" stroke="black" points="2548.45,-7763.8 2550.98,-7753.51 2542.59,-7759.98 2548.45,-7763.8"/>
</g>
<!-- layer_10_mlp_fc1_gpu12&#45;&gt;layer_10_allgather_mlp -->
<g id="edge790" class="edge">
<title>layer_10_mlp_fc1_gpu12&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M2610.75,-7790.36C2604.86,-7781.47 2598.12,-7771.31 2591.78,-7761.75"/>
<polygon fill="black" stroke="black" points="2594.56,-7759.6 2586.11,-7753.2 2588.72,-7763.47 2594.56,-7759.6"/>
</g>
<!-- layer_10_mlp_fc1_gpu13&#45;&gt;layer_10_allgather_mlp -->
<g id="edge791" class="edge">
<title>layer_10_mlp_fc1_gpu13&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M2695.01,-7790.59C2670.57,-7778.24 2641.21,-7763.39 2616.92,-7751.11"/>
<polygon fill="black" stroke="black" points="2618.39,-7747.93 2607.89,-7746.54 2615.23,-7754.18 2618.39,-7747.93"/>
</g>
<!-- layer_10_mlp_fc1_gpu14&#45;&gt;layer_10_allgather_mlp -->
<g id="edge792" class="edge">
<title>layer_10_mlp_fc1_gpu14&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M2811.69,-7793.62C2808.93,-7792.57 2806.19,-7791.56 2803.5,-7790.62 2745.37,-7770.29 2677.32,-7752.38 2629.45,-7740.72"/>
<polygon fill="black" stroke="black" points="2630.1,-7737.27 2619.56,-7738.33 2628.45,-7744.08 2630.1,-7737.27"/>
</g>
<!-- layer_10_mlp_fc1_gpu15&#45;&gt;layer_10_allgather_mlp -->
<g id="edge793" class="edge">
<title>layer_10_mlp_fc1_gpu15&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M2928.78,-7793.34C2926,-7792.36 2923.23,-7791.45 2920.5,-7790.62 2822.6,-7761.04 2705.02,-7743.04 2633.58,-7733.96"/>
<polygon fill="black" stroke="black" points="2633.73,-7730.45 2623.38,-7732.68 2632.87,-7737.4 2633.73,-7730.45"/>
</g>
<!-- layer_10_gelu -->
<g id="node474" class="node">
<title>layer_10_gelu</title>
<polygon fill="lightblue" stroke="black" points="2613,-7660.64 2524,-7660.64 2524,-7624.64 2613,-7624.64 2613,-7660.64"/>
<text text-anchor="middle" x="2568.5" y="-7645.64" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="2568.5" y="-7634.64" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_10_allgather_mlp&#45;&gt;layer_10_gelu -->
<g id="edge794" class="edge">
<title>layer_10_allgather_mlp&#45;&gt;layer_10_gelu</title>
<path fill="none" stroke="black" d="M2568.5,-7696.3C2568.5,-7688.06 2568.5,-7679.07 2568.5,-7670.89"/>
<polygon fill="black" stroke="black" points="2572,-7670.73 2568.5,-7660.73 2565,-7670.73 2572,-7670.73"/>
</g>
<!-- layer_10_mlp_fc2_gpu8 -->
<g id="node475" class="node">
<title>layer_10_mlp_fc2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2209,-7588.64 2110,-7588.64 2110,-7536.64 2209,-7536.64 2209,-7588.64"/>
<text text-anchor="middle" x="2159.5" y="-7576.64" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="2159.5" y="-7565.64" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2159.5" y="-7554.64" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2159.5" y="-7543.64" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu8 -->
<g id="edge795" class="edge">
<title>layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu8</title>
<path fill="none" stroke="black" d="M2523.82,-7638.47C2458.45,-7633.06 2333.05,-7619.73 2219.02,-7588.46"/>
<polygon fill="black" stroke="black" points="2219.65,-7585 2209.08,-7585.68 2217.76,-7591.74 2219.65,-7585"/>
</g>
<!-- layer_10_mlp_fc2_gpu9 -->
<g id="node476" class="node">
<title>layer_10_mlp_fc2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2326,-7588.64 2227,-7588.64 2227,-7536.64 2326,-7536.64 2326,-7588.64"/>
<text text-anchor="middle" x="2276.5" y="-7576.64" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="2276.5" y="-7565.64" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2276.5" y="-7554.64" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2276.5" y="-7543.64" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu9 -->
<g id="edge796" class="edge">
<title>layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu9</title>
<path fill="none" stroke="black" d="M2523.63,-7633.88C2478.37,-7625.51 2406.48,-7610.75 2336.08,-7588.59"/>
<polygon fill="black" stroke="black" points="2336.75,-7585.13 2326.16,-7585.41 2334.61,-7591.79 2336.75,-7585.13"/>
</g>
<!-- layer_10_mlp_fc2_gpu10 -->
<g id="node477" class="node">
<title>layer_10_mlp_fc2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2443,-7588.64 2344,-7588.64 2344,-7536.64 2443,-7536.64 2443,-7588.64"/>
<text text-anchor="middle" x="2393.5" y="-7576.64" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="2393.5" y="-7565.64" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2393.5" y="-7554.64" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2393.5" y="-7543.64" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu10 -->
<g id="edge797" class="edge">
<title>layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu10</title>
<path fill="none" stroke="black" d="M2530.1,-7624.52C2507.33,-7614.38 2478.02,-7601.31 2452.39,-7589.89"/>
<polygon fill="black" stroke="black" points="2453.69,-7586.63 2443.13,-7585.76 2450.84,-7593.03 2453.69,-7586.63"/>
</g>
<!-- layer_10_mlp_fc2_gpu11 -->
<g id="node478" class="node">
<title>layer_10_mlp_fc2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2560,-7588.64 2461,-7588.64 2461,-7536.64 2560,-7536.64 2560,-7588.64"/>
<text text-anchor="middle" x="2510.5" y="-7576.64" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="2510.5" y="-7565.64" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2510.5" y="-7554.64" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2510.5" y="-7543.64" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu11 -->
<g id="edge798" class="edge">
<title>layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu11</title>
<path fill="none" stroke="black" d="M2555.63,-7624.33C2549.64,-7616.27 2542.31,-7606.41 2535.3,-7597"/>
<polygon fill="black" stroke="black" points="2538.06,-7594.83 2529.28,-7588.89 2532.44,-7599.01 2538.06,-7594.83"/>
</g>
<!-- layer_10_mlp_fc2_gpu12 -->
<g id="node479" class="node">
<title>layer_10_mlp_fc2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2677,-7588.64 2578,-7588.64 2578,-7536.64 2677,-7536.64 2677,-7588.64"/>
<text text-anchor="middle" x="2627.5" y="-7576.64" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="2627.5" y="-7565.64" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="2627.5" y="-7554.64" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2627.5" y="-7543.64" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu12 -->
<g id="edge799" class="edge">
<title>layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu12</title>
<path fill="none" stroke="black" d="M2581.59,-7624.33C2587.69,-7616.27 2595.15,-7606.41 2602.27,-7597"/>
<polygon fill="black" stroke="black" points="2605.15,-7598.98 2608.4,-7588.89 2599.57,-7594.76 2605.15,-7598.98"/>
</g>
<!-- layer_10_mlp_fc2_gpu13 -->
<g id="node480" class="node">
<title>layer_10_mlp_fc2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="2794,-7588.64 2695,-7588.64 2695,-7536.64 2794,-7536.64 2794,-7588.64"/>
<text text-anchor="middle" x="2744.5" y="-7576.64" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="2744.5" y="-7565.64" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="2744.5" y="-7554.64" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2744.5" y="-7543.64" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu13 -->
<g id="edge800" class="edge">
<title>layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu13</title>
<path fill="none" stroke="black" d="M2607.12,-7624.52C2630.1,-7614.34 2659.73,-7601.21 2685.58,-7589.75"/>
<polygon fill="black" stroke="black" points="2687.19,-7592.87 2694.91,-7585.61 2684.35,-7586.47 2687.19,-7592.87"/>
</g>
<!-- layer_10_mlp_fc2_gpu14 -->
<g id="node481" class="node">
<title>layer_10_mlp_fc2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="2911,-7588.64 2812,-7588.64 2812,-7536.64 2911,-7536.64 2911,-7588.64"/>
<text text-anchor="middle" x="2861.5" y="-7576.64" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="2861.5" y="-7565.64" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="2861.5" y="-7554.64" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2861.5" y="-7543.64" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu14 -->
<g id="edge801" class="edge">
<title>layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu14</title>
<path fill="none" stroke="black" d="M2613.34,-7634.08C2658.98,-7625.83 2731.76,-7611.12 2801.87,-7588.96"/>
<polygon fill="black" stroke="black" points="2803.29,-7592.18 2811.74,-7585.78 2801.15,-7585.51 2803.29,-7592.18"/>
</g>
<!-- layer_10_mlp_fc2_gpu15 -->
<g id="node482" class="node">
<title>layer_10_mlp_fc2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3028,-7588.64 2929,-7588.64 2929,-7536.64 3028,-7536.64 3028,-7588.64"/>
<text text-anchor="middle" x="2978.5" y="-7576.64" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="2978.5" y="-7565.64" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="2978.5" y="-7554.64" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2978.5" y="-7543.64" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu15 -->
<g id="edge802" class="edge">
<title>layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu15</title>
<path fill="none" stroke="black" d="M2613.18,-7638.61C2678.87,-7633.36 2805.23,-7620.22 2918.91,-7588.81"/>
<polygon fill="black" stroke="black" points="2920.14,-7592.1 2928.81,-7586.02 2918.24,-7585.37 2920.14,-7592.1"/>
</g>
<!-- layer_10_allreduce_mlp -->
<g id="node483" class="node">
<title>layer_10_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="2627.5" cy="-7471.65" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="2627.5" y="-7480.15" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="2627.5" y="-7469.15" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="2627.5" y="-7458.15" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_10_mlp_fc2_gpu8&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge803" class="edge">
<title>layer_10_mlp_fc2_gpu8&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2209.08,-7539.62C2212.24,-7538.53 2215.4,-7537.52 2218.5,-7536.64 2335.27,-7503.31 2476.05,-7486.1 2558.3,-7478.25"/>
<polygon fill="black" stroke="black" points="2558.64,-7481.74 2568.27,-7477.32 2557.99,-7474.77 2558.64,-7481.74"/>
</g>
<!-- layer_10_mlp_fc2_gpu9&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge804" class="edge">
<title>layer_10_mlp_fc2_gpu9&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2326.15,-7539.84C2329.29,-7538.69 2332.43,-7537.62 2335.5,-7536.64 2411.35,-7512.49 2501.12,-7494.31 2560.91,-7483.61"/>
<polygon fill="black" stroke="black" points="2561.74,-7487.02 2570.98,-7481.83 2560.53,-7480.12 2561.74,-7487.02"/>
</g>
<!-- layer_10_mlp_fc2_gpu10&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge805" class="edge">
<title>layer_10_mlp_fc2_gpu10&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2443,-7540.45C2446.21,-7539.14 2449.4,-7537.86 2452.5,-7536.64 2491.39,-7521.3 2535.62,-7505.14 2569.88,-7492.89"/>
<polygon fill="black" stroke="black" points="2571.48,-7496.04 2579.72,-7489.39 2569.13,-7489.45 2571.48,-7496.04"/>
</g>
<!-- layer_10_mlp_fc2_gpu11&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge806" class="edge">
<title>layer_10_mlp_fc2_gpu11&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2543.4,-7536.61C2557.19,-7526.13 2573.34,-7513.84 2587.78,-7502.86"/>
<polygon fill="black" stroke="black" points="2590.21,-7505.41 2596.05,-7496.57 2585.97,-7499.83 2590.21,-7505.41"/>
</g>
<!-- layer_10_mlp_fc2_gpu12&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge807" class="edge">
<title>layer_10_mlp_fc2_gpu12&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2627.5,-7536.37C2627.5,-7528.48 2627.5,-7519.59 2627.5,-7511.01"/>
<polygon fill="black" stroke="black" points="2631,-7510.79 2627.5,-7500.79 2624,-7510.79 2631,-7510.79"/>
</g>
<!-- layer_10_mlp_fc2_gpu13&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge808" class="edge">
<title>layer_10_mlp_fc2_gpu13&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2711.6,-7536.61C2697.81,-7526.13 2681.66,-7513.84 2667.22,-7502.86"/>
<polygon fill="black" stroke="black" points="2669.03,-7499.83 2658.95,-7496.57 2664.79,-7505.41 2669.03,-7499.83"/>
</g>
<!-- layer_10_mlp_fc2_gpu14&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge809" class="edge">
<title>layer_10_mlp_fc2_gpu14&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2811.91,-7540.04C2809.07,-7538.87 2806.25,-7537.73 2803.5,-7536.64 2764.28,-7521.07 2719.58,-7504.84 2685.05,-7492.62"/>
<polygon fill="black" stroke="black" points="2686.19,-7489.31 2675.59,-7489.28 2683.86,-7495.91 2686.19,-7489.31"/>
</g>
<!-- layer_10_mlp_fc2_gpu15&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge810" class="edge">
<title>layer_10_mlp_fc2_gpu15&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2928.75,-7539.47C2925.98,-7538.46 2923.21,-7537.51 2920.5,-7536.64 2844.35,-7512.16 2754.09,-7494.02 2694.07,-7483.42"/>
<polygon fill="black" stroke="black" points="2694.42,-7479.93 2683.97,-7481.66 2693.22,-7486.83 2694.42,-7479.93"/>
</g>
<!-- layer_10_allreduce_mlp&#45;&gt;layer_10_residual2 -->
<g id="edge811" class="edge">
<title>layer_10_allreduce_mlp&#45;&gt;layer_10_residual2</title>
<path fill="none" stroke="black" d="M2671.32,-7451.6C2703.43,-7437.65 2747.35,-7418.57 2782.53,-7403.28"/>
<polygon fill="black" stroke="black" points="2783.97,-7406.47 2791.74,-7399.28 2781.18,-7400.05 2783.97,-7406.47"/>
</g>
<!-- layer_10_ln2 -->
<g id="node485" class="node">
<title>layer_10_ln2</title>
<polygon fill="lightblue" stroke="black" points="2878,-7310.66 2805,-7310.66 2805,-7269.66 2878,-7269.66 2878,-7310.66"/>
<text text-anchor="middle" x="2841.5" y="-7298.66" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="2841.5" y="-7287.66" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="2841.5" y="-7276.66" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_10_residual2&#45;&gt;layer_10_ln2 -->
<g id="edge813" class="edge">
<title>layer_10_residual2&#45;&gt;layer_10_ln2</title>
<path fill="none" stroke="black" d="M2841.5,-7346.58C2841.5,-7338.25 2841.5,-7329.17 2841.5,-7320.81"/>
<polygon fill="black" stroke="black" points="2845,-7320.72 2841.5,-7310.72 2838,-7320.72 2845,-7320.72"/>
</g>
<!-- layer_10_output_dist -->
<g id="node486" class="node">
<title>layer_10_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="2943.2,-7233.66 2781.42,-7233.66 2739.8,-7173.66 2901.58,-7173.66 2943.2,-7233.66"/>
<text text-anchor="middle" x="2841.5" y="-7206.66" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="2841.5" y="-7195.66" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_10_ln2&#45;&gt;layer_10_output_dist -->
<g id="edge814" class="edge">
<title>layer_10_ln2&#45;&gt;layer_10_output_dist</title>
<path fill="none" stroke="black" d="M2841.5,-7269.56C2841.5,-7261.92 2841.5,-7252.88 2841.5,-7244.01"/>
<polygon fill="black" stroke="black" points="2845,-7243.76 2841.5,-7233.76 2838,-7243.76 2845,-7243.76"/>
</g>
<!-- layer_11_input_dist -->
<g id="node487" class="node">
<title>layer_11_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="2935.69,-7137.66 2785.86,-7137.66 2747.31,-7077.66 2897.14,-7077.66 2935.69,-7137.66"/>
<text text-anchor="middle" x="2841.5" y="-7110.66" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="2841.5" y="-7099.66" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_10_output_dist&#45;&gt;layer_11_input_dist -->
<g id="edge815" class="edge">
<title>layer_10_output_dist&#45;&gt;layer_11_input_dist</title>
<path fill="none" stroke="black" d="M2841.5,-7173.43C2841.5,-7165.38 2841.5,-7156.52 2841.5,-7148"/>
<polygon fill="black" stroke="black" points="2845,-7147.86 2841.5,-7137.86 2838,-7147.86 2845,-7147.86"/>
</g>
<!-- layer_11_qkv_gpu8 -->
<g id="node488" class="node">
<title>layer_11_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2426.5,-7041.66 2328.5,-7041.66 2328.5,-6989.66 2426.5,-6989.66 2426.5,-7041.66"/>
<text text-anchor="middle" x="2377.5" y="-7029.66" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="2377.5" y="-7018.66" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2377.5" y="-7007.66" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2377.5" y="-6996.66" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu8 -->
<g id="edge816" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu8</title>
<path fill="none" stroke="black" d="M2761.24,-7099.74C2680.67,-7091.46 2553.23,-7074.73 2436.38,-7041.62"/>
<polygon fill="black" stroke="black" points="2437.13,-7038.19 2426.55,-7038.78 2435.19,-7044.92 2437.13,-7038.19"/>
</g>
<!-- layer_11_qkv_gpu9 -->
<g id="node489" class="node">
<title>layer_11_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2542.5,-7041.66 2444.5,-7041.66 2444.5,-6989.66 2542.5,-6989.66 2542.5,-7041.66"/>
<text text-anchor="middle" x="2493.5" y="-7029.66" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="2493.5" y="-7018.66" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2493.5" y="-7007.66" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2493.5" y="-6996.66" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu9 -->
<g id="edge817" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu9</title>
<path fill="none" stroke="black" d="M2756.31,-7091.9C2700.43,-7081.22 2625.84,-7065.05 2552.49,-7041.75"/>
<polygon fill="black" stroke="black" points="2553.21,-7038.31 2542.62,-7038.57 2551.06,-7044.97 2553.21,-7038.31"/>
</g>
<!-- layer_11_qkv_gpu10 -->
<g id="node490" class="node">
<title>layer_11_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2658.5,-7041.66 2560.5,-7041.66 2560.5,-6989.66 2658.5,-6989.66 2658.5,-7041.66"/>
<text text-anchor="middle" x="2609.5" y="-7029.66" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="2609.5" y="-7018.66" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2609.5" y="-7007.66" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2609.5" y="-6996.66" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu10 -->
<g id="edge818" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu10</title>
<path fill="none" stroke="black" d="M2761.05,-7077.55C2733.93,-7067.51 2703.36,-7055.94 2668.3,-7041.92"/>
<polygon fill="black" stroke="black" points="2669.38,-7038.58 2658.79,-7038.1 2666.77,-7045.07 2669.38,-7038.58"/>
</g>
<!-- layer_11_qkv_gpu11 -->
<g id="node491" class="node">
<title>layer_11_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2774.5,-7041.66 2676.5,-7041.66 2676.5,-6989.66 2774.5,-6989.66 2774.5,-7041.66"/>
<text text-anchor="middle" x="2725.5" y="-7029.66" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="2725.5" y="-7018.66" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2725.5" y="-7007.66" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2725.5" y="-6996.66" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu11 -->
<g id="edge819" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu11</title>
<path fill="none" stroke="black" d="M2803.84,-7077.43C2791.68,-7068 2778.16,-7057.51 2765.82,-7047.94"/>
<polygon fill="black" stroke="black" points="2767.96,-7045.16 2757.91,-7041.8 2763.66,-7050.7 2767.96,-7045.16"/>
</g>
<!-- layer_11_qkv_gpu12 -->
<g id="node492" class="node">
<title>layer_11_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2890.5,-7041.66 2792.5,-7041.66 2792.5,-6989.66 2890.5,-6989.66 2890.5,-7041.66"/>
<text text-anchor="middle" x="2841.5" y="-7029.66" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="2841.5" y="-7018.66" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="2841.5" y="-7007.66" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2841.5" y="-6996.66" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu12 -->
<g id="edge820" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu12</title>
<path fill="none" stroke="black" d="M2841.5,-7077.19C2841.5,-7069.11 2841.5,-7060.28 2841.5,-7051.91"/>
<polygon fill="black" stroke="black" points="2845,-7051.67 2841.5,-7041.67 2838,-7051.67 2845,-7051.67"/>
</g>
<!-- layer_11_qkv_gpu13 -->
<g id="node493" class="node">
<title>layer_11_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3006.5,-7041.66 2908.5,-7041.66 2908.5,-6989.66 3006.5,-6989.66 3006.5,-7041.66"/>
<text text-anchor="middle" x="2957.5" y="-7029.66" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="2957.5" y="-7018.66" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="2957.5" y="-7007.66" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2957.5" y="-6996.66" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu13 -->
<g id="edge821" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu13</title>
<path fill="none" stroke="black" d="M2879.16,-7077.43C2891.32,-7068 2904.84,-7057.51 2917.18,-7047.94"/>
<polygon fill="black" stroke="black" points="2919.34,-7050.7 2925.09,-7041.8 2915.04,-7045.16 2919.34,-7050.7"/>
</g>
<!-- layer_11_qkv_gpu14 -->
<g id="node494" class="node">
<title>layer_11_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3122.5,-7041.66 3024.5,-7041.66 3024.5,-6989.66 3122.5,-6989.66 3122.5,-7041.66"/>
<text text-anchor="middle" x="3073.5" y="-7029.66" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="3073.5" y="-7018.66" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3073.5" y="-7007.66" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3073.5" y="-6996.66" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu14 -->
<g id="edge822" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu14</title>
<path fill="none" stroke="black" d="M2902.18,-7084.82C2933.44,-7073.38 2972.35,-7058.84 3014.81,-7041.87"/>
<polygon fill="black" stroke="black" points="3016.23,-7045.07 3024.21,-7038.1 3013.62,-7038.58 3016.23,-7045.07"/>
</g>
<!-- layer_11_qkv_gpu15 -->
<g id="node495" class="node">
<title>layer_11_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3238.5,-7041.66 3140.5,-7041.66 3140.5,-6989.66 3238.5,-6989.66 3238.5,-7041.66"/>
<text text-anchor="middle" x="3189.5" y="-7029.66" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="3189.5" y="-7018.66" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3189.5" y="-7007.66" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3189.5" y="-6996.66" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu15 -->
<g id="edge823" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu15</title>
<path fill="none" stroke="black" d="M2908.68,-7095.28C2965.75,-7084.78 3049.78,-7067.37 3130.55,-7041.74"/>
<polygon fill="black" stroke="black" points="3131.93,-7044.97 3140.38,-7038.57 3129.79,-7038.3 3131.93,-7044.97"/>
</g>
<!-- layer_11_residual1 -->
<g id="node507" class="node">
<title>layer_11_residual1</title>
<polygon fill="lightyellow" stroke="black" points="3139.44,-6589.69 3017.05,-6589.69 2985.56,-6529.69 3107.95,-6529.69 3139.44,-6589.69"/>
<text text-anchor="middle" x="3062.5" y="-6562.69" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="3062.5" y="-6551.69" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_residual1 -->
<g id="edge850" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_residual1</title>
<path fill="none" stroke="black" d="M2914.7,-7104.89C3018.74,-7100.79 3201.86,-7087.13 3247.5,-7041.66 3284.51,-7004.78 3266.5,-6977.9 3266.5,-6925.66 3266.5,-6925.66 3266.5,-6925.66 3266.5,-6744.67 3266.5,-6674.73 3199.55,-6624.54 3142.36,-6594.43"/>
<polygon fill="black" stroke="black" points="3143.77,-6591.22 3133.28,-6589.77 3140.58,-6597.45 3143.77,-6591.22"/>
</g>
<!-- layer_11_allgather_qkv -->
<g id="node496" class="node">
<title>layer_11_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="2794.5" cy="-6924.66" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="2794.5" y="-6933.16" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="2794.5" y="-6922.16" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="2794.5" y="-6911.16" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_11_qkv_gpu8&#45;&gt;layer_11_allgather_qkv -->
<g id="edge824" class="edge">
<title>layer_11_qkv_gpu8&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M2426.57,-6992.59C2429.57,-6991.53 2432.56,-6990.54 2435.5,-6989.66 2535.69,-6959.57 2656.1,-6941.67 2728.89,-6932.75"/>
<polygon fill="black" stroke="black" points="2729.33,-6936.22 2738.84,-6931.55 2728.49,-6929.27 2729.33,-6936.22"/>
</g>
<!-- layer_11_qkv_gpu9&#45;&gt;layer_11_allgather_qkv -->
<g id="edge825" class="edge">
<title>layer_11_qkv_gpu9&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M2542.66,-6992.87C2545.64,-6991.74 2548.6,-6990.66 2551.5,-6989.66 2611.88,-6968.82 2682.68,-6950.89 2732.23,-6939.35"/>
<polygon fill="black" stroke="black" points="2733.2,-6942.72 2742.16,-6937.06 2731.63,-6935.9 2733.2,-6942.72"/>
</g>
<!-- layer_11_qkv_gpu10&#45;&gt;layer_11_allgather_qkv -->
<g id="edge826" class="edge">
<title>layer_11_qkv_gpu10&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M2658.59,-6991.04C2685.21,-6978.24 2718.03,-6962.45 2744.75,-6949.59"/>
<polygon fill="black" stroke="black" points="2746.44,-6952.67 2753.93,-6945.18 2743.4,-6946.36 2746.44,-6952.67"/>
</g>
<!-- layer_11_qkv_gpu11&#45;&gt;layer_11_allgather_qkv -->
<g id="edge827" class="edge">
<title>layer_11_qkv_gpu11&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M2745.09,-6989.39C2752.19,-6980.24 2760.32,-6969.74 2767.92,-6959.94"/>
<polygon fill="black" stroke="black" points="2770.78,-6961.97 2774.14,-6951.92 2765.25,-6957.68 2770.78,-6961.97"/>
</g>
<!-- layer_11_qkv_gpu12&#45;&gt;layer_11_allgather_qkv -->
<g id="edge828" class="edge">
<title>layer_11_qkv_gpu12&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M2828.16,-6989.39C2823.64,-6980.84 2818.5,-6971.11 2813.62,-6961.87"/>
<polygon fill="black" stroke="black" points="2816.63,-6960.07 2808.86,-6952.86 2810.44,-6963.34 2816.63,-6960.07"/>
</g>
<!-- layer_11_qkv_gpu13&#45;&gt;layer_11_allgather_qkv -->
<g id="edge829" class="edge">
<title>layer_11_qkv_gpu13&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M2911.66,-6989.63C2889.73,-6977.66 2863.51,-6963.34 2841.44,-6951.29"/>
<polygon fill="black" stroke="black" points="2843.03,-6948.17 2832.57,-6946.45 2839.67,-6954.31 2843.03,-6948.17"/>
</g>
<!-- layer_11_qkv_gpu14&#45;&gt;layer_11_allgather_qkv -->
<g id="edge830" class="edge">
<title>layer_11_qkv_gpu14&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M3024.31,-6992.95C3021.34,-6991.8 3018.39,-6990.69 3015.5,-6989.66 2962.02,-6970.47 2899.74,-6952.85 2854.95,-6940.98"/>
<polygon fill="black" stroke="black" points="2855.66,-6937.55 2845.1,-6938.38 2853.88,-6944.31 2855.66,-6937.55"/>
</g>
<!-- layer_11_qkv_gpu15&#45;&gt;layer_11_allgather_qkv -->
<g id="edge831" class="edge">
<title>layer_11_qkv_gpu15&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M3140.42,-6992.63C3137.42,-6991.56 3134.44,-6990.55 3131.5,-6989.66 3039.29,-6961.4 2928.89,-6943.29 2860.21,-6933.79"/>
<polygon fill="black" stroke="black" points="2860.35,-6930.28 2849.97,-6932.4 2859.41,-6937.21 2860.35,-6930.28"/>
</g>
<!-- layer_11_attention -->
<g id="node497" class="node">
<title>layer_11_attention</title>
<polygon fill="lightblue" stroke="black" points="2828.5,-6859.67 2760.5,-6859.67 2760.5,-6807.67 2828.5,-6807.67 2828.5,-6859.67"/>
<text text-anchor="middle" x="2794.5" y="-6847.67" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="2794.5" y="-6836.67" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="2794.5" y="-6825.67" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="2794.5" y="-6814.67" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_11_allgather_qkv&#45;&gt;layer_11_attention -->
<g id="edge832" class="edge">
<title>layer_11_allgather_qkv&#45;&gt;layer_11_attention</title>
<path fill="none" stroke="black" d="M2794.5,-6895.51C2794.5,-6887.4 2794.5,-6878.45 2794.5,-6869.96"/>
<polygon fill="black" stroke="black" points="2798,-6869.94 2794.5,-6859.94 2791,-6869.94 2798,-6869.94"/>
</g>
<!-- layer_11_attn_out_gpu8 -->
<g id="node498" class="node">
<title>layer_11_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2461,-6771.67 2368,-6771.67 2368,-6719.67 2461,-6719.67 2461,-6771.67"/>
<text text-anchor="middle" x="2414.5" y="-6759.67" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="2414.5" y="-6748.67" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2414.5" y="-6737.67" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2414.5" y="-6726.67" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attention&#45;&gt;layer_11_attn_out_gpu8 -->
<g id="edge833" class="edge">
<title>layer_11_attention&#45;&gt;layer_11_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M2760.28,-6828.9C2702.17,-6821.93 2580.62,-6804.87 2470.81,-6771.46"/>
<polygon fill="black" stroke="black" points="2471.83,-6768.11 2461.25,-6768.49 2469.76,-6774.8 2471.83,-6768.11"/>
</g>
<!-- layer_11_attn_out_gpu9 -->
<g id="node499" class="node">
<title>layer_11_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2572,-6771.67 2479,-6771.67 2479,-6719.67 2572,-6719.67 2572,-6771.67"/>
<text text-anchor="middle" x="2525.5" y="-6759.67" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="2525.5" y="-6748.67" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2525.5" y="-6737.67" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2525.5" y="-6726.67" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attention&#45;&gt;layer_11_attn_out_gpu9 -->
<g id="edge834" class="edge">
<title>layer_11_attention&#45;&gt;layer_11_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M2760.46,-6824.5C2718.01,-6813.96 2643.48,-6794.26 2581.5,-6771.67 2581.4,-6771.64 2581.31,-6771.6 2581.21,-6771.57"/>
<polygon fill="black" stroke="black" points="2582.64,-6768.37 2572.05,-6768.04 2580.13,-6774.9 2582.64,-6768.37"/>
</g>
<!-- layer_11_attn_out_gpu10 -->
<g id="node500" class="node">
<title>layer_11_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2683,-6771.67 2590,-6771.67 2590,-6719.67 2683,-6719.67 2683,-6771.67"/>
<text text-anchor="middle" x="2636.5" y="-6759.67" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="2636.5" y="-6748.67" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2636.5" y="-6737.67" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2636.5" y="-6726.67" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attention&#45;&gt;layer_11_attn_out_gpu10 -->
<g id="edge835" class="edge">
<title>layer_11_attention&#45;&gt;layer_11_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M2760.22,-6814.01C2740.19,-6803.11 2714.44,-6789.09 2691.62,-6776.67"/>
<polygon fill="black" stroke="black" points="2693.16,-6773.53 2682.71,-6771.82 2689.82,-6779.68 2693.16,-6773.53"/>
</g>
<!-- layer_11_attn_out_gpu11 -->
<g id="node501" class="node">
<title>layer_11_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2794,-6771.67 2701,-6771.67 2701,-6719.67 2794,-6719.67 2794,-6771.67"/>
<text text-anchor="middle" x="2747.5" y="-6759.67" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="2747.5" y="-6748.67" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2747.5" y="-6737.67" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2747.5" y="-6726.67" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attention&#45;&gt;layer_11_attn_out_gpu11 -->
<g id="edge836" class="edge">
<title>layer_11_attention&#45;&gt;layer_11_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M2780.65,-6807.33C2776.11,-6799.02 2770.99,-6789.65 2766.15,-6780.8"/>
<polygon fill="black" stroke="black" points="2769.12,-6778.93 2761.25,-6771.83 2762.97,-6782.28 2769.12,-6778.93"/>
</g>
<!-- layer_11_attn_out_gpu12 -->
<g id="node502" class="node">
<title>layer_11_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2905,-6771.67 2812,-6771.67 2812,-6719.67 2905,-6719.67 2905,-6771.67"/>
<text text-anchor="middle" x="2858.5" y="-6759.67" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="2858.5" y="-6748.67" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="2858.5" y="-6737.67" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2858.5" y="-6726.67" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attention&#45;&gt;layer_11_attn_out_gpu12 -->
<g id="edge837" class="edge">
<title>layer_11_attention&#45;&gt;layer_11_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M2813.36,-6807.33C2819.74,-6798.76 2826.96,-6789.05 2833.73,-6779.96"/>
<polygon fill="black" stroke="black" points="2836.62,-6781.94 2839.78,-6771.83 2831,-6777.76 2836.62,-6781.94"/>
</g>
<!-- layer_11_attn_out_gpu13 -->
<g id="node503" class="node">
<title>layer_11_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3016,-6771.67 2923,-6771.67 2923,-6719.67 3016,-6719.67 3016,-6771.67"/>
<text text-anchor="middle" x="2969.5" y="-6759.67" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="2969.5" y="-6748.67" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="2969.5" y="-6737.67" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2969.5" y="-6726.67" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attention&#45;&gt;layer_11_attn_out_gpu13 -->
<g id="edge838" class="edge">
<title>layer_11_attention&#45;&gt;layer_11_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M2828.66,-6815.89C2852.79,-6804.03 2885.67,-6787.87 2913.59,-6774.15"/>
<polygon fill="black" stroke="black" points="2915.42,-6777.15 2922.85,-6769.6 2912.33,-6770.87 2915.42,-6777.15"/>
</g>
<!-- layer_11_attn_out_gpu14 -->
<g id="node504" class="node">
<title>layer_11_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3127,-6771.67 3034,-6771.67 3034,-6719.67 3127,-6719.67 3127,-6771.67"/>
<text text-anchor="middle" x="3080.5" y="-6759.67" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="3080.5" y="-6748.67" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3080.5" y="-6737.67" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3080.5" y="-6726.67" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attention&#45;&gt;layer_11_attn_out_gpu14 -->
<g id="edge839" class="edge">
<title>layer_11_attention&#45;&gt;layer_11_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M2828.71,-6825.54C2872.42,-6816.01 2950.39,-6797.63 3024.44,-6771.84"/>
<polygon fill="black" stroke="black" points="3025.65,-6775.13 3033.91,-6768.49 3023.32,-6768.53 3025.65,-6775.13"/>
</g>
<!-- layer_11_attn_out_gpu15 -->
<g id="node505" class="node">
<title>layer_11_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3238,-6771.67 3145,-6771.67 3145,-6719.67 3238,-6719.67 3238,-6771.67"/>
<text text-anchor="middle" x="3191.5" y="-6759.67" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="3191.5" y="-6748.67" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3191.5" y="-6737.67" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3191.5" y="-6726.67" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attention&#45;&gt;layer_11_attn_out_gpu15 -->
<g id="edge840" class="edge">
<title>layer_11_attention&#45;&gt;layer_11_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M2828.66,-6829.44C2889.27,-6823.09 3019.42,-6806.73 3134.99,-6771.86"/>
<polygon fill="black" stroke="black" points="3136.17,-6775.16 3144.7,-6768.88 3134.11,-6768.47 3136.17,-6775.16"/>
</g>
<!-- layer_11_allreduce_attn -->
<g id="node506" class="node">
<title>layer_11_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="2858.5" cy="-6654.68" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="2858.5" y="-6663.18" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="2858.5" y="-6652.18" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="2858.5" y="-6641.18" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_11_attn_out_gpu8&#45;&gt;layer_11_allreduce_attn -->
<g id="edge841" class="edge">
<title>layer_11_attn_out_gpu8&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M2461.22,-6722.77C2464.33,-6721.64 2467.44,-6720.59 2470.5,-6719.67 2580.32,-6686.7 2713.06,-6669.45 2791.36,-6661.48"/>
<polygon fill="black" stroke="black" points="2791.97,-6664.94 2801.57,-6660.46 2791.27,-6657.97 2791.97,-6664.94"/>
</g>
<!-- layer_11_attn_out_gpu9&#45;&gt;layer_11_allreduce_attn -->
<g id="edge842" class="edge">
<title>layer_11_attn_out_gpu9&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M2572.29,-6723C2575.38,-6721.81 2578.47,-6720.69 2581.5,-6719.67 2652.91,-6695.73 2737.6,-6677.6 2794.37,-6666.85"/>
<polygon fill="black" stroke="black" points="2795.1,-6670.28 2804.29,-6665 2793.82,-6663.4 2795.1,-6670.28"/>
</g>
<!-- layer_11_attn_out_gpu10&#45;&gt;layer_11_allreduce_attn -->
<g id="edge843" class="edge">
<title>layer_11_attn_out_gpu10&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M2683.17,-6723.62C2686.32,-6722.27 2689.45,-6720.94 2692.5,-6719.67 2729.07,-6704.47 2770.66,-6688.44 2803.06,-6676.23"/>
<polygon fill="black" stroke="black" points="2804.67,-6679.36 2812.8,-6672.57 2802.21,-6672.81 2804.67,-6679.36"/>
</g>
<!-- layer_11_attn_out_gpu11&#45;&gt;layer_11_allreduce_attn -->
<g id="edge844" class="edge">
<title>layer_11_attn_out_gpu11&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M2778.72,-6719.65C2791.79,-6709.16 2807.11,-6696.88 2820.81,-6685.89"/>
<polygon fill="black" stroke="black" points="2823.05,-6688.59 2828.67,-6679.6 2818.67,-6683.12 2823.05,-6688.59"/>
</g>
<!-- layer_11_attn_out_gpu12&#45;&gt;layer_11_allreduce_attn -->
<g id="edge845" class="edge">
<title>layer_11_attn_out_gpu12&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M2858.5,-6719.41C2858.5,-6711.52 2858.5,-6702.63 2858.5,-6694.05"/>
<polygon fill="black" stroke="black" points="2862,-6693.82 2858.5,-6683.82 2855,-6693.82 2862,-6693.82"/>
</g>
<!-- layer_11_attn_out_gpu13&#45;&gt;layer_11_allreduce_attn -->
<g id="edge846" class="edge">
<title>layer_11_attn_out_gpu13&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M2938.28,-6719.65C2925.21,-6709.16 2909.89,-6696.88 2896.19,-6685.89"/>
<polygon fill="black" stroke="black" points="2898.33,-6683.12 2888.33,-6679.6 2893.95,-6688.59 2898.33,-6683.12"/>
</g>
<!-- layer_11_attn_out_gpu14&#45;&gt;layer_11_allreduce_attn -->
<g id="edge847" class="edge">
<title>layer_11_attn_out_gpu14&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M3033.78,-6723.2C3030.98,-6721.99 3028.21,-6720.81 3025.5,-6719.67 2988.61,-6704.24 2946.57,-6688.14 2913.9,-6675.95"/>
<polygon fill="black" stroke="black" points="2915.11,-6672.66 2904.52,-6672.46 2912.67,-6679.22 2915.11,-6672.66"/>
</g>
<!-- layer_11_attn_out_gpu15&#45;&gt;layer_11_allreduce_attn -->
<g id="edge848" class="edge">
<title>layer_11_attn_out_gpu15&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M3144.95,-6722.75C3142.11,-6721.65 3139.28,-6720.61 3136.5,-6719.67 3064.92,-6695.44 2979.9,-6677.36 2922.9,-6666.71"/>
<polygon fill="black" stroke="black" points="2923.41,-6663.24 2912.94,-6664.87 2922.14,-6670.13 2923.41,-6663.24"/>
</g>
<!-- layer_11_allreduce_attn&#45;&gt;layer_11_residual1 -->
<g id="edge849" class="edge">
<title>layer_11_allreduce_attn&#45;&gt;layer_11_residual1</title>
<path fill="none" stroke="black" d="M2900.77,-6634.41C2930.62,-6620.81 2971,-6602.4 3003.95,-6587.38"/>
<polygon fill="black" stroke="black" points="3005.82,-6590.37 3013.47,-6583.04 3002.92,-6584 3005.82,-6590.37"/>
</g>
<!-- layer_11_ln1 -->
<g id="node508" class="node">
<title>layer_11_ln1</title>
<polygon fill="lightblue" stroke="black" points="2885,-6493.69 2812,-6493.69 2812,-6452.69 2885,-6452.69 2885,-6493.69"/>
<text text-anchor="middle" x="2848.5" y="-6481.69" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="2848.5" y="-6470.69" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="2848.5" y="-6459.69" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_11_residual1&#45;&gt;layer_11_ln1 -->
<g id="edge851" class="edge">
<title>layer_11_residual1&#45;&gt;layer_11_ln1</title>
<path fill="none" stroke="black" d="M2988.85,-6529.61C2957.49,-6517.23 2921.88,-6503.16 2894.37,-6492.3"/>
<polygon fill="black" stroke="black" points="2895.59,-6489.02 2885,-6488.6 2893.02,-6495.53 2895.59,-6489.02"/>
</g>
<!-- layer_11_residual2 -->
<g id="node528" class="node">
<title>layer_11_residual2</title>
<polygon fill="lightyellow" stroke="black" points="3139.44,-5980.72 3017.05,-5980.72 2985.56,-5920.72 3107.95,-5920.72 3139.44,-5980.72"/>
<text text-anchor="middle" x="3062.5" y="-5953.72" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="3062.5" y="-5942.72" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_11_residual1&#45;&gt;layer_11_residual2 -->
<g id="edge886" class="edge">
<title>layer_11_residual1&#45;&gt;layer_11_residual2</title>
<path fill="none" stroke="black" d="M3115.37,-6543.29C3179.03,-6521.11 3277.5,-6473.57 3277.5,-6391.69 3277.5,-6391.69 3277.5,-6391.69 3277.5,-6135.71 3277.5,-6064.33 3208.25,-6014.71 3148.35,-5985.14"/>
<polygon fill="black" stroke="black" points="3149.74,-5981.93 3139.21,-5980.75 3146.7,-5988.23 3149.74,-5981.93"/>
</g>
<!-- layer_11_mlp_fc1_gpu8 -->
<g id="node509" class="node">
<title>layer_11_mlp_fc1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2430,-6416.69 2331,-6416.69 2331,-6364.69 2430,-6364.69 2430,-6416.69"/>
<text text-anchor="middle" x="2380.5" y="-6404.69" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="2380.5" y="-6393.69" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2380.5" y="-6382.69" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2380.5" y="-6371.69" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu8 -->
<g id="edge852" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu8</title>
<path fill="none" stroke="black" d="M2811.74,-6470.47C2740.94,-6466.47 2580.96,-6454.05 2439.76,-6416.42"/>
<polygon fill="black" stroke="black" points="2440.63,-6413.03 2430.06,-6413.79 2438.79,-6419.78 2440.63,-6413.03"/>
</g>
<!-- layer_11_mlp_fc1_gpu9 -->
<g id="node510" class="node">
<title>layer_11_mlp_fc1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2547,-6416.69 2448,-6416.69 2448,-6364.69 2547,-6364.69 2547,-6416.69"/>
<text text-anchor="middle" x="2497.5" y="-6404.69" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="2497.5" y="-6393.69" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2497.5" y="-6382.69" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2497.5" y="-6371.69" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu9 -->
<g id="edge853" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu9</title>
<path fill="none" stroke="black" d="M2811.94,-6467.79C2757.85,-6460.73 2653.39,-6444.99 2556.74,-6416.48"/>
<polygon fill="black" stroke="black" points="2557.7,-6413.12 2547.12,-6413.59 2555.69,-6419.82 2557.7,-6413.12"/>
</g>
<!-- layer_11_mlp_fc1_gpu10 -->
<g id="node511" class="node">
<title>layer_11_mlp_fc1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2664,-6416.69 2565,-6416.69 2565,-6364.69 2664,-6364.69 2664,-6416.69"/>
<text text-anchor="middle" x="2614.5" y="-6404.69" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="2614.5" y="-6393.69" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2614.5" y="-6382.69" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2614.5" y="-6371.69" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu10 -->
<g id="edge854" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu10</title>
<path fill="none" stroke="black" d="M2811.97,-6461.69C2778.35,-6451.79 2726.97,-6436.06 2673.85,-6416.69"/>
<polygon fill="black" stroke="black" points="2674.86,-6413.33 2664.26,-6413.16 2672.44,-6419.9 2674.86,-6413.33"/>
</g>
<!-- layer_11_mlp_fc1_gpu11 -->
<g id="node512" class="node">
<title>layer_11_mlp_fc1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2781,-6416.69 2682,-6416.69 2682,-6364.69 2781,-6364.69 2781,-6416.69"/>
<text text-anchor="middle" x="2731.5" y="-6404.69" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="2731.5" y="-6393.69" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2731.5" y="-6382.69" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2731.5" y="-6371.69" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu11 -->
<g id="edge855" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu11</title>
<path fill="none" stroke="black" d="M2819.88,-6452.5C2806.87,-6443.55 2791.17,-6432.74 2776.63,-6422.74"/>
<polygon fill="black" stroke="black" points="2778.46,-6419.75 2768.24,-6416.97 2774.49,-6425.52 2778.46,-6419.75"/>
</g>
<!-- layer_11_mlp_fc1_gpu12 -->
<g id="node513" class="node">
<title>layer_11_mlp_fc1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2898,-6416.69 2799,-6416.69 2799,-6364.69 2898,-6364.69 2898,-6416.69"/>
<text text-anchor="middle" x="2848.5" y="-6404.69" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="2848.5" y="-6393.69" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="2848.5" y="-6382.69" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2848.5" y="-6371.69" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu12 -->
<g id="edge856" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu12</title>
<path fill="none" stroke="black" d="M2848.5,-6452.29C2848.5,-6444.68 2848.5,-6435.75 2848.5,-6427.12"/>
<polygon fill="black" stroke="black" points="2852,-6426.84 2848.5,-6416.84 2845,-6426.84 2852,-6426.84"/>
</g>
<!-- layer_11_mlp_fc1_gpu13 -->
<g id="node514" class="node">
<title>layer_11_mlp_fc1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3015,-6416.69 2916,-6416.69 2916,-6364.69 3015,-6364.69 3015,-6416.69"/>
<text text-anchor="middle" x="2965.5" y="-6404.69" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="2965.5" y="-6393.69" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="2965.5" y="-6382.69" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2965.5" y="-6371.69" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu13 -->
<g id="edge857" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu13</title>
<path fill="none" stroke="black" d="M2877.12,-6452.5C2890.13,-6443.55 2905.83,-6432.74 2920.37,-6422.74"/>
<polygon fill="black" stroke="black" points="2922.51,-6425.52 2928.76,-6416.97 2918.54,-6419.75 2922.51,-6425.52"/>
</g>
<!-- layer_11_mlp_fc1_gpu14 -->
<g id="node515" class="node">
<title>layer_11_mlp_fc1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3132,-6416.69 3033,-6416.69 3033,-6364.69 3132,-6364.69 3132,-6416.69"/>
<text text-anchor="middle" x="3082.5" y="-6404.69" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="3082.5" y="-6393.69" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3082.5" y="-6382.69" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3082.5" y="-6371.69" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu14 -->
<g id="edge858" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu14</title>
<path fill="none" stroke="black" d="M2885.27,-6461.78C2919.1,-6451.94 2970.79,-6436.25 3023.46,-6416.95"/>
<polygon fill="black" stroke="black" points="3024.8,-6420.19 3032.96,-6413.44 3022.37,-6413.62 3024.8,-6420.19"/>
</g>
<!-- layer_11_mlp_fc1_gpu15 -->
<g id="node516" class="node">
<title>layer_11_mlp_fc1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3249,-6416.69 3150,-6416.69 3150,-6364.69 3249,-6364.69 3249,-6416.69"/>
<text text-anchor="middle" x="3199.5" y="-6404.69" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="3199.5" y="-6393.69" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3199.5" y="-6382.69" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3199.5" y="-6371.69" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu15 -->
<g id="edge859" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu15</title>
<path fill="none" stroke="black" d="M2885.21,-6467.87C2939.46,-6460.93 3044.15,-6445.35 3139.94,-6416.92"/>
<polygon fill="black" stroke="black" points="3141.22,-6420.19 3149.77,-6413.95 3139.19,-6413.49 3141.22,-6420.19"/>
</g>
<!-- layer_11_allgather_mlp -->
<g id="node517" class="node">
<title>layer_11_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="2789.5" cy="-6299.7" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="2789.5" y="-6308.2" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="2789.5" y="-6297.2" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="2789.5" y="-6286.2" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_11_mlp_fc1_gpu8&#45;&gt;layer_11_allgather_mlp -->
<g id="edge860" class="edge">
<title>layer_11_mlp_fc1_gpu8&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M2430.11,-6367.76C2433.26,-6366.65 2436.41,-6365.61 2439.5,-6364.69 2536.8,-6335.57 2653.48,-6317.46 2724.52,-6308.23"/>
<polygon fill="black" stroke="black" points="2725.19,-6311.67 2734.66,-6306.93 2724.3,-6304.73 2725.19,-6311.67"/>
</g>
<!-- layer_11_mlp_fc1_gpu9&#45;&gt;layer_11_allgather_mlp -->
<g id="edge861" class="edge">
<title>layer_11_mlp_fc1_gpu9&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M2547.21,-6368.08C2550.34,-6366.89 2553.45,-6365.75 2556.5,-6364.69 2614.03,-6344.7 2681.24,-6326.8 2728.65,-6315.06"/>
<polygon fill="black" stroke="black" points="2729.58,-6318.43 2738.46,-6312.64 2727.91,-6311.63 2729.58,-6318.43"/>
</g>
<!-- layer_11_mlp_fc1_gpu10&#45;&gt;layer_11_allgather_mlp -->
<g id="edge862" class="edge">
<title>layer_11_mlp_fc1_gpu10&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M2663.71,-6364.66C2687.92,-6352.36 2716.99,-6337.57 2741.08,-6325.32"/>
<polygon fill="black" stroke="black" points="2742.73,-6328.41 2750.05,-6320.76 2739.55,-6322.17 2742.73,-6328.41"/>
</g>
<!-- layer_11_mlp_fc1_gpu11&#45;&gt;layer_11_allgather_mlp -->
<g id="edge863" class="edge">
<title>layer_11_mlp_fc1_gpu11&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M2747.97,-6364.43C2753.71,-6355.61 2760.27,-6345.55 2766.44,-6336.07"/>
<polygon fill="black" stroke="black" points="2769.45,-6337.87 2771.98,-6327.58 2763.59,-6334.05 2769.45,-6337.87"/>
</g>
<!-- layer_11_mlp_fc1_gpu12&#45;&gt;layer_11_allgather_mlp -->
<g id="edge864" class="edge">
<title>layer_11_mlp_fc1_gpu12&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M2831.75,-6364.43C2825.86,-6355.53 2819.12,-6345.37 2812.78,-6335.82"/>
<polygon fill="black" stroke="black" points="2815.56,-6333.67 2807.11,-6327.27 2809.72,-6337.54 2815.56,-6333.67"/>
</g>
<!-- layer_11_mlp_fc1_gpu13&#45;&gt;layer_11_allgather_mlp -->
<g id="edge865" class="edge">
<title>layer_11_mlp_fc1_gpu13&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M2916.01,-6364.66C2891.57,-6352.31 2862.21,-6337.46 2837.92,-6325.18"/>
<polygon fill="black" stroke="black" points="2839.39,-6322 2828.89,-6320.61 2836.23,-6328.25 2839.39,-6322"/>
</g>
<!-- layer_11_mlp_fc1_gpu14&#45;&gt;layer_11_allgather_mlp -->
<g id="edge866" class="edge">
<title>layer_11_mlp_fc1_gpu14&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M3032.69,-6367.69C3029.93,-6366.64 3027.19,-6365.63 3024.5,-6364.69 2966.37,-6344.36 2898.32,-6326.45 2850.45,-6314.79"/>
<polygon fill="black" stroke="black" points="2851.1,-6311.34 2840.56,-6312.4 2849.45,-6318.15 2851.1,-6311.34"/>
</g>
<!-- layer_11_mlp_fc1_gpu15&#45;&gt;layer_11_allgather_mlp -->
<g id="edge867" class="edge">
<title>layer_11_mlp_fc1_gpu15&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M3149.78,-6367.41C3147,-6366.43 3144.23,-6365.51 3141.5,-6364.69 3043.6,-6335.11 2926.02,-6317.11 2854.58,-6308.03"/>
<polygon fill="black" stroke="black" points="2854.73,-6304.52 2844.38,-6306.75 2853.87,-6311.47 2854.73,-6304.52"/>
</g>
<!-- layer_11_gelu -->
<g id="node518" class="node">
<title>layer_11_gelu</title>
<polygon fill="lightblue" stroke="black" points="2834,-6234.71 2745,-6234.71 2745,-6198.71 2834,-6198.71 2834,-6234.71"/>
<text text-anchor="middle" x="2789.5" y="-6219.71" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="2789.5" y="-6208.71" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_11_allgather_mlp&#45;&gt;layer_11_gelu -->
<g id="edge868" class="edge">
<title>layer_11_allgather_mlp&#45;&gt;layer_11_gelu</title>
<path fill="none" stroke="black" d="M2789.5,-6270.37C2789.5,-6262.12 2789.5,-6253.14 2789.5,-6244.96"/>
<polygon fill="black" stroke="black" points="2793,-6244.8 2789.5,-6234.8 2786,-6244.8 2793,-6244.8"/>
</g>
<!-- layer_11_mlp_fc2_gpu8 -->
<g id="node519" class="node">
<title>layer_11_mlp_fc2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2430,-6162.71 2331,-6162.71 2331,-6110.71 2430,-6110.71 2430,-6162.71"/>
<text text-anchor="middle" x="2380.5" y="-6150.71" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="2380.5" y="-6139.71" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2380.5" y="-6128.71" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2380.5" y="-6117.71" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu8 -->
<g id="edge869" class="edge">
<title>layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu8</title>
<path fill="none" stroke="black" d="M2744.82,-6212.54C2679.45,-6207.13 2554.05,-6193.8 2440.02,-6162.53"/>
<polygon fill="black" stroke="black" points="2440.65,-6159.07 2430.08,-6159.75 2438.76,-6165.81 2440.65,-6159.07"/>
</g>
<!-- layer_11_mlp_fc2_gpu9 -->
<g id="node520" class="node">
<title>layer_11_mlp_fc2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2547,-6162.71 2448,-6162.71 2448,-6110.71 2547,-6110.71 2547,-6162.71"/>
<text text-anchor="middle" x="2497.5" y="-6150.71" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="2497.5" y="-6139.71" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2497.5" y="-6128.71" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2497.5" y="-6117.71" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu9 -->
<g id="edge870" class="edge">
<title>layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu9</title>
<path fill="none" stroke="black" d="M2744.63,-6207.95C2699.37,-6199.58 2627.48,-6184.82 2557.08,-6162.66"/>
<polygon fill="black" stroke="black" points="2557.75,-6159.2 2547.16,-6159.48 2555.61,-6165.86 2557.75,-6159.2"/>
</g>
<!-- layer_11_mlp_fc2_gpu10 -->
<g id="node521" class="node">
<title>layer_11_mlp_fc2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2664,-6162.71 2565,-6162.71 2565,-6110.71 2664,-6110.71 2664,-6162.71"/>
<text text-anchor="middle" x="2614.5" y="-6150.71" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="2614.5" y="-6139.71" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2614.5" y="-6128.71" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2614.5" y="-6117.71" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu10 -->
<g id="edge871" class="edge">
<title>layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu10</title>
<path fill="none" stroke="black" d="M2751.1,-6198.59C2728.33,-6188.44 2699.02,-6175.38 2673.39,-6163.95"/>
<polygon fill="black" stroke="black" points="2674.69,-6160.7 2664.13,-6159.83 2671.84,-6167.1 2674.69,-6160.7"/>
</g>
<!-- layer_11_mlp_fc2_gpu11 -->
<g id="node522" class="node">
<title>layer_11_mlp_fc2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2781,-6162.71 2682,-6162.71 2682,-6110.71 2781,-6110.71 2781,-6162.71"/>
<text text-anchor="middle" x="2731.5" y="-6150.71" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="2731.5" y="-6139.71" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2731.5" y="-6128.71" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2731.5" y="-6117.71" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu11 -->
<g id="edge872" class="edge">
<title>layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu11</title>
<path fill="none" stroke="black" d="M2776.63,-6198.4C2770.64,-6190.34 2763.31,-6180.48 2756.3,-6171.07"/>
<polygon fill="black" stroke="black" points="2759.06,-6168.9 2750.28,-6162.96 2753.44,-6173.08 2759.06,-6168.9"/>
</g>
<!-- layer_11_mlp_fc2_gpu12 -->
<g id="node523" class="node">
<title>layer_11_mlp_fc2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2898,-6162.71 2799,-6162.71 2799,-6110.71 2898,-6110.71 2898,-6162.71"/>
<text text-anchor="middle" x="2848.5" y="-6150.71" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="2848.5" y="-6139.71" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="2848.5" y="-6128.71" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2848.5" y="-6117.71" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu12 -->
<g id="edge873" class="edge">
<title>layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu12</title>
<path fill="none" stroke="black" d="M2802.59,-6198.4C2808.69,-6190.34 2816.15,-6180.48 2823.27,-6171.07"/>
<polygon fill="black" stroke="black" points="2826.15,-6173.05 2829.4,-6162.96 2820.57,-6168.83 2826.15,-6173.05"/>
</g>
<!-- layer_11_mlp_fc2_gpu13 -->
<g id="node524" class="node">
<title>layer_11_mlp_fc2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3015,-6162.71 2916,-6162.71 2916,-6110.71 3015,-6110.71 3015,-6162.71"/>
<text text-anchor="middle" x="2965.5" y="-6150.71" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="2965.5" y="-6139.71" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="2965.5" y="-6128.71" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2965.5" y="-6117.71" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu13 -->
<g id="edge874" class="edge">
<title>layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu13</title>
<path fill="none" stroke="black" d="M2828.12,-6198.59C2851.1,-6188.4 2880.73,-6175.28 2906.58,-6163.82"/>
<polygon fill="black" stroke="black" points="2908.19,-6166.93 2915.91,-6159.68 2905.35,-6160.53 2908.19,-6166.93"/>
</g>
<!-- layer_11_mlp_fc2_gpu14 -->
<g id="node525" class="node">
<title>layer_11_mlp_fc2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3132,-6162.71 3033,-6162.71 3033,-6110.71 3132,-6110.71 3132,-6162.71"/>
<text text-anchor="middle" x="3082.5" y="-6150.71" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="3082.5" y="-6139.71" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3082.5" y="-6128.71" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3082.5" y="-6117.71" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu14 -->
<g id="edge875" class="edge">
<title>layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu14</title>
<path fill="none" stroke="black" d="M2834.34,-6208.15C2879.98,-6199.9 2952.76,-6185.19 3022.87,-6163.03"/>
<polygon fill="black" stroke="black" points="3024.29,-6166.25 3032.74,-6159.85 3022.15,-6159.58 3024.29,-6166.25"/>
</g>
<!-- layer_11_mlp_fc2_gpu15 -->
<g id="node526" class="node">
<title>layer_11_mlp_fc2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3249,-6162.71 3150,-6162.71 3150,-6110.71 3249,-6110.71 3249,-6162.71"/>
<text text-anchor="middle" x="3199.5" y="-6150.71" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="3199.5" y="-6139.71" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3199.5" y="-6128.71" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3199.5" y="-6117.71" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu15 -->
<g id="edge876" class="edge">
<title>layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu15</title>
<path fill="none" stroke="black" d="M2834.18,-6212.68C2899.87,-6207.43 3026.23,-6194.28 3139.91,-6162.88"/>
<polygon fill="black" stroke="black" points="3141.14,-6166.17 3149.81,-6160.09 3139.24,-6159.43 3141.14,-6166.17"/>
</g>
<!-- layer_11_allreduce_mlp -->
<g id="node527" class="node">
<title>layer_11_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="2848.5" cy="-6045.72" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="2848.5" y="-6054.22" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="2848.5" y="-6043.22" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="2848.5" y="-6032.22" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_11_mlp_fc2_gpu8&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge877" class="edge">
<title>layer_11_mlp_fc2_gpu8&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2430.08,-6113.68C2433.24,-6112.6 2436.4,-6111.59 2439.5,-6110.71 2556.27,-6077.38 2697.05,-6060.17 2779.3,-6052.32"/>
<polygon fill="black" stroke="black" points="2779.64,-6055.8 2789.27,-6051.39 2778.99,-6048.83 2779.64,-6055.8"/>
</g>
<!-- layer_11_mlp_fc2_gpu9&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge878" class="edge">
<title>layer_11_mlp_fc2_gpu9&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2547.15,-6113.91C2550.29,-6112.76 2553.43,-6111.69 2556.5,-6110.71 2632.35,-6086.56 2722.12,-6068.37 2781.91,-6057.68"/>
<polygon fill="black" stroke="black" points="2782.74,-6061.09 2791.98,-6055.9 2781.53,-6054.19 2782.74,-6061.09"/>
</g>
<!-- layer_11_mlp_fc2_gpu10&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge879" class="edge">
<title>layer_11_mlp_fc2_gpu10&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2664,-6114.52C2667.21,-6113.21 2670.4,-6111.93 2673.5,-6110.71 2712.39,-6095.37 2756.62,-6079.21 2790.88,-6066.96"/>
<polygon fill="black" stroke="black" points="2792.48,-6070.11 2800.72,-6063.46 2790.13,-6063.52 2792.48,-6070.11"/>
</g>
<!-- layer_11_mlp_fc2_gpu11&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge880" class="edge">
<title>layer_11_mlp_fc2_gpu11&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2764.4,-6110.68C2778.19,-6100.2 2794.34,-6087.91 2808.78,-6076.93"/>
<polygon fill="black" stroke="black" points="2811.21,-6079.47 2817.05,-6070.63 2806.97,-6073.9 2811.21,-6079.47"/>
</g>
<!-- layer_11_mlp_fc2_gpu12&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge881" class="edge">
<title>layer_11_mlp_fc2_gpu12&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2848.5,-6110.44C2848.5,-6102.55 2848.5,-6093.66 2848.5,-6085.08"/>
<polygon fill="black" stroke="black" points="2852,-6084.86 2848.5,-6074.86 2845,-6084.86 2852,-6084.86"/>
</g>
<!-- layer_11_mlp_fc2_gpu13&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge882" class="edge">
<title>layer_11_mlp_fc2_gpu13&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2932.6,-6110.68C2918.81,-6100.2 2902.66,-6087.91 2888.22,-6076.93"/>
<polygon fill="black" stroke="black" points="2890.03,-6073.9 2879.95,-6070.63 2885.79,-6079.47 2890.03,-6073.9"/>
</g>
<!-- layer_11_mlp_fc2_gpu14&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge883" class="edge">
<title>layer_11_mlp_fc2_gpu14&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3032.91,-6114.1C3030.07,-6112.94 3027.25,-6111.8 3024.5,-6110.71 2985.28,-6095.14 2940.58,-6078.91 2906.05,-6066.69"/>
<polygon fill="black" stroke="black" points="2907.19,-6063.38 2896.59,-6063.35 2904.86,-6069.98 2907.19,-6063.38"/>
</g>
<!-- layer_11_mlp_fc2_gpu15&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge884" class="edge">
<title>layer_11_mlp_fc2_gpu15&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3149.75,-6113.54C3146.98,-6112.53 3144.21,-6111.58 3141.5,-6110.71 3065.35,-6086.23 2975.09,-6068.09 2915.07,-6057.49"/>
<polygon fill="black" stroke="black" points="2915.42,-6054 2904.97,-6055.73 2914.22,-6060.89 2915.42,-6054"/>
</g>
<!-- layer_11_allreduce_mlp&#45;&gt;layer_11_residual2 -->
<g id="edge885" class="edge">
<title>layer_11_allreduce_mlp&#45;&gt;layer_11_residual2</title>
<path fill="none" stroke="black" d="M2892.32,-6025.67C2924.43,-6011.72 2968.35,-5992.64 3003.53,-5977.35"/>
<polygon fill="black" stroke="black" points="3004.97,-5980.54 3012.74,-5973.35 3002.18,-5974.12 3004.97,-5980.54"/>
</g>
<!-- layer_11_ln2 -->
<g id="node529" class="node">
<title>layer_11_ln2</title>
<polygon fill="lightblue" stroke="black" points="3099,-5884.72 3026,-5884.72 3026,-5843.72 3099,-5843.72 3099,-5884.72"/>
<text text-anchor="middle" x="3062.5" y="-5872.72" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="3062.5" y="-5861.72" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="3062.5" y="-5850.72" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_11_residual2&#45;&gt;layer_11_ln2 -->
<g id="edge887" class="edge">
<title>layer_11_residual2&#45;&gt;layer_11_ln2</title>
<path fill="none" stroke="black" d="M3062.5,-5920.64C3062.5,-5912.32 3062.5,-5903.24 3062.5,-5894.88"/>
<polygon fill="black" stroke="black" points="3066,-5894.79 3062.5,-5884.79 3059,-5894.79 3066,-5894.79"/>
</g>
<!-- layer_11_output_dist -->
<g id="node530" class="node">
<title>layer_11_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="3164.2,-5807.72 3002.42,-5807.72 2960.8,-5747.72 3122.58,-5747.72 3164.2,-5807.72"/>
<text text-anchor="middle" x="3062.5" y="-5780.72" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="3062.5" y="-5769.72" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_11_ln2&#45;&gt;layer_11_output_dist -->
<g id="edge888" class="edge">
<title>layer_11_ln2&#45;&gt;layer_11_output_dist</title>
<path fill="none" stroke="black" d="M3062.5,-5843.63C3062.5,-5835.99 3062.5,-5826.94 3062.5,-5818.07"/>
<polygon fill="black" stroke="black" points="3066,-5817.83 3062.5,-5807.83 3059,-5817.83 3066,-5817.83"/>
</g>
<!-- layer_12_input_dist -->
<g id="node531" class="node">
<title>layer_12_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="3156.69,-5711.72 3006.86,-5711.72 2968.31,-5651.72 3118.14,-5651.72 3156.69,-5711.72"/>
<text text-anchor="middle" x="3062.5" y="-5684.72" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="3062.5" y="-5673.72" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_11_output_dist&#45;&gt;layer_12_input_dist -->
<g id="edge889" class="edge">
<title>layer_11_output_dist&#45;&gt;layer_12_input_dist</title>
<path fill="none" stroke="black" d="M3062.5,-5747.5C3062.5,-5739.45 3062.5,-5730.59 3062.5,-5722.07"/>
<polygon fill="black" stroke="black" points="3066,-5721.93 3062.5,-5711.93 3059,-5721.93 3066,-5721.93"/>
</g>
<!-- layer_12_qkv_gpu8 -->
<g id="node532" class="node">
<title>layer_12_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2647.5,-5615.72 2549.5,-5615.72 2549.5,-5563.72 2647.5,-5563.72 2647.5,-5615.72"/>
<text text-anchor="middle" x="2598.5" y="-5603.72" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="2598.5" y="-5592.72" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2598.5" y="-5581.72" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2598.5" y="-5570.72" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu8 -->
<g id="edge890" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu8</title>
<path fill="none" stroke="black" d="M2982.24,-5673.81C2901.67,-5665.53 2774.23,-5648.8 2657.38,-5615.68"/>
<polygon fill="black" stroke="black" points="2658.13,-5612.26 2647.55,-5612.85 2656.19,-5618.98 2658.13,-5612.26"/>
</g>
<!-- layer_12_qkv_gpu9 -->
<g id="node533" class="node">
<title>layer_12_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2763.5,-5615.72 2665.5,-5615.72 2665.5,-5563.72 2763.5,-5563.72 2763.5,-5615.72"/>
<text text-anchor="middle" x="2714.5" y="-5603.72" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="2714.5" y="-5592.72" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2714.5" y="-5581.72" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2714.5" y="-5570.72" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu9 -->
<g id="edge891" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu9</title>
<path fill="none" stroke="black" d="M2977.31,-5665.97C2921.43,-5655.29 2846.84,-5639.12 2773.49,-5615.82"/>
<polygon fill="black" stroke="black" points="2774.21,-5612.37 2763.62,-5612.64 2772.06,-5619.04 2774.21,-5612.37"/>
</g>
<!-- layer_12_qkv_gpu10 -->
<g id="node534" class="node">
<title>layer_12_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2879.5,-5615.72 2781.5,-5615.72 2781.5,-5563.72 2879.5,-5563.72 2879.5,-5615.72"/>
<text text-anchor="middle" x="2830.5" y="-5603.72" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="2830.5" y="-5592.72" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2830.5" y="-5581.72" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2830.5" y="-5570.72" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu10 -->
<g id="edge892" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu10</title>
<path fill="none" stroke="black" d="M2982.05,-5651.62C2954.93,-5641.58 2924.36,-5630.01 2889.3,-5615.99"/>
<polygon fill="black" stroke="black" points="2890.38,-5612.65 2879.79,-5612.17 2887.77,-5619.14 2890.38,-5612.65"/>
</g>
<!-- layer_12_qkv_gpu11 -->
<g id="node535" class="node">
<title>layer_12_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2995.5,-5615.72 2897.5,-5615.72 2897.5,-5563.72 2995.5,-5563.72 2995.5,-5615.72"/>
<text text-anchor="middle" x="2946.5" y="-5603.72" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="2946.5" y="-5592.72" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2946.5" y="-5581.72" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2946.5" y="-5570.72" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu11 -->
<g id="edge893" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu11</title>
<path fill="none" stroke="black" d="M3024.84,-5651.5C3012.68,-5642.07 2999.16,-5631.58 2986.82,-5622.01"/>
<polygon fill="black" stroke="black" points="2988.96,-5619.23 2978.91,-5615.87 2984.66,-5624.76 2988.96,-5619.23"/>
</g>
<!-- layer_12_qkv_gpu12 -->
<g id="node536" class="node">
<title>layer_12_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3111.5,-5615.72 3013.5,-5615.72 3013.5,-5563.72 3111.5,-5563.72 3111.5,-5615.72"/>
<text text-anchor="middle" x="3062.5" y="-5603.72" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="3062.5" y="-5592.72" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3062.5" y="-5581.72" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3062.5" y="-5570.72" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu12 -->
<g id="edge894" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu12</title>
<path fill="none" stroke="black" d="M3062.5,-5651.25C3062.5,-5643.18 3062.5,-5634.35 3062.5,-5625.98"/>
<polygon fill="black" stroke="black" points="3066,-5625.73 3062.5,-5615.73 3059,-5625.73 3066,-5625.73"/>
</g>
<!-- layer_12_qkv_gpu13 -->
<g id="node537" class="node">
<title>layer_12_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3227.5,-5615.72 3129.5,-5615.72 3129.5,-5563.72 3227.5,-5563.72 3227.5,-5615.72"/>
<text text-anchor="middle" x="3178.5" y="-5603.72" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="3178.5" y="-5592.72" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3178.5" y="-5581.72" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3178.5" y="-5570.72" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu13 -->
<g id="edge895" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu13</title>
<path fill="none" stroke="black" d="M3100.16,-5651.5C3112.32,-5642.07 3125.84,-5631.58 3138.18,-5622.01"/>
<polygon fill="black" stroke="black" points="3140.34,-5624.76 3146.09,-5615.87 3136.04,-5619.23 3140.34,-5624.76"/>
</g>
<!-- layer_12_qkv_gpu14 -->
<g id="node538" class="node">
<title>layer_12_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3343.5,-5615.72 3245.5,-5615.72 3245.5,-5563.72 3343.5,-5563.72 3343.5,-5615.72"/>
<text text-anchor="middle" x="3294.5" y="-5603.72" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="3294.5" y="-5592.72" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3294.5" y="-5581.72" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3294.5" y="-5570.72" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu14 -->
<g id="edge896" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu14</title>
<path fill="none" stroke="black" d="M3123.18,-5658.89C3154.44,-5647.45 3193.35,-5632.91 3235.81,-5615.94"/>
<polygon fill="black" stroke="black" points="3237.23,-5619.14 3245.21,-5612.17 3234.62,-5612.64 3237.23,-5619.14"/>
</g>
<!-- layer_12_qkv_gpu15 -->
<g id="node539" class="node">
<title>layer_12_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3459.5,-5615.72 3361.5,-5615.72 3361.5,-5563.72 3459.5,-5563.72 3459.5,-5615.72"/>
<text text-anchor="middle" x="3410.5" y="-5603.72" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="3410.5" y="-5592.72" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3410.5" y="-5581.72" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3410.5" y="-5570.72" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu15 -->
<g id="edge897" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu15</title>
<path fill="none" stroke="black" d="M3129.68,-5669.35C3186.75,-5658.85 3270.78,-5641.43 3351.55,-5615.8"/>
<polygon fill="black" stroke="black" points="3352.93,-5619.03 3361.38,-5612.64 3350.79,-5612.37 3352.93,-5619.03"/>
</g>
<!-- layer_12_residual1 -->
<g id="node551" class="node">
<title>layer_12_residual1</title>
<polygon fill="lightyellow" stroke="black" points="3360.44,-5163.76 3238.05,-5163.76 3206.56,-5103.76 3328.95,-5103.76 3360.44,-5163.76"/>
<text text-anchor="middle" x="3283.5" y="-5136.76" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="3283.5" y="-5125.76" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_residual1 -->
<g id="edge924" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_residual1</title>
<path fill="none" stroke="black" d="M3135.7,-5678.96C3239.74,-5674.86 3422.86,-5661.2 3468.5,-5615.72 3505.51,-5578.85 3487.5,-5551.97 3487.5,-5499.73 3487.5,-5499.73 3487.5,-5499.73 3487.5,-5318.74 3487.5,-5248.8 3420.55,-5198.61 3363.36,-5168.5"/>
<polygon fill="black" stroke="black" points="3364.77,-5165.29 3354.28,-5163.84 3361.58,-5171.52 3364.77,-5165.29"/>
</g>
<!-- layer_12_allgather_qkv -->
<g id="node540" class="node">
<title>layer_12_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="3015.5" cy="-5498.73" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="3015.5" y="-5507.23" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="3015.5" y="-5496.23" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="3015.5" y="-5485.23" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_12_qkv_gpu8&#45;&gt;layer_12_allgather_qkv -->
<g id="edge898" class="edge">
<title>layer_12_qkv_gpu8&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M2647.57,-5566.66C2650.57,-5565.6 2653.56,-5564.61 2656.5,-5563.72 2756.69,-5533.64 2877.1,-5515.74 2949.89,-5506.82"/>
<polygon fill="black" stroke="black" points="2950.33,-5510.29 2959.84,-5505.62 2949.49,-5503.34 2950.33,-5510.29"/>
</g>
<!-- layer_12_qkv_gpu9&#45;&gt;layer_12_allgather_qkv -->
<g id="edge899" class="edge">
<title>layer_12_qkv_gpu9&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M2763.66,-5566.94C2766.64,-5565.81 2769.6,-5564.73 2772.5,-5563.72 2832.88,-5542.89 2903.68,-5524.96 2953.23,-5513.42"/>
<polygon fill="black" stroke="black" points="2954.2,-5516.79 2963.16,-5511.13 2952.63,-5509.97 2954.2,-5516.79"/>
</g>
<!-- layer_12_qkv_gpu10&#45;&gt;layer_12_allgather_qkv -->
<g id="edge900" class="edge">
<title>layer_12_qkv_gpu10&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M2879.59,-5565.11C2906.21,-5552.3 2939.03,-5536.52 2965.75,-5523.66"/>
<polygon fill="black" stroke="black" points="2967.44,-5526.74 2974.93,-5519.25 2964.4,-5520.43 2967.44,-5526.74"/>
</g>
<!-- layer_12_qkv_gpu11&#45;&gt;layer_12_allgather_qkv -->
<g id="edge901" class="edge">
<title>layer_12_qkv_gpu11&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M2966.09,-5563.46C2973.19,-5554.31 2981.32,-5543.81 2988.92,-5534.01"/>
<polygon fill="black" stroke="black" points="2991.78,-5536.04 2995.14,-5525.99 2986.25,-5531.75 2991.78,-5536.04"/>
</g>
<!-- layer_12_qkv_gpu12&#45;&gt;layer_12_allgather_qkv -->
<g id="edge902" class="edge">
<title>layer_12_qkv_gpu12&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M3049.16,-5563.46C3044.64,-5554.9 3039.5,-5545.17 3034.62,-5535.94"/>
<polygon fill="black" stroke="black" points="3037.63,-5534.14 3029.86,-5526.93 3031.44,-5537.41 3037.63,-5534.14"/>
</g>
<!-- layer_12_qkv_gpu13&#45;&gt;layer_12_allgather_qkv -->
<g id="edge903" class="edge">
<title>layer_12_qkv_gpu13&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M3132.66,-5563.7C3110.73,-5551.72 3084.51,-5537.41 3062.44,-5525.36"/>
<polygon fill="black" stroke="black" points="3064.03,-5522.24 3053.57,-5520.52 3060.67,-5528.38 3064.03,-5522.24"/>
</g>
<!-- layer_12_qkv_gpu14&#45;&gt;layer_12_allgather_qkv -->
<g id="edge904" class="edge">
<title>layer_12_qkv_gpu14&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M3245.31,-5567.02C3242.34,-5565.87 3239.39,-5564.76 3236.5,-5563.72 3183.02,-5544.54 3120.74,-5526.92 3075.95,-5515.05"/>
<polygon fill="black" stroke="black" points="3076.66,-5511.61 3066.1,-5512.45 3074.88,-5518.38 3076.66,-5511.61"/>
</g>
<!-- layer_12_qkv_gpu15&#45;&gt;layer_12_allgather_qkv -->
<g id="edge905" class="edge">
<title>layer_12_qkv_gpu15&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M3361.42,-5566.7C3358.42,-5565.63 3355.44,-5564.62 3352.5,-5563.72 3260.29,-5535.47 3149.89,-5517.36 3081.21,-5507.86"/>
<polygon fill="black" stroke="black" points="3081.35,-5504.35 3070.97,-5506.46 3080.41,-5511.28 3081.35,-5504.35"/>
</g>
<!-- layer_12_attention -->
<g id="node541" class="node">
<title>layer_12_attention</title>
<polygon fill="lightblue" stroke="black" points="3049.5,-5433.74 2981.5,-5433.74 2981.5,-5381.74 3049.5,-5381.74 3049.5,-5433.74"/>
<text text-anchor="middle" x="3015.5" y="-5421.74" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="3015.5" y="-5410.74" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3015.5" y="-5399.74" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="3015.5" y="-5388.74" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_12_allgather_qkv&#45;&gt;layer_12_attention -->
<g id="edge906" class="edge">
<title>layer_12_allgather_qkv&#45;&gt;layer_12_attention</title>
<path fill="none" stroke="black" d="M3015.5,-5469.58C3015.5,-5461.47 3015.5,-5452.52 3015.5,-5444.03"/>
<polygon fill="black" stroke="black" points="3019,-5444 3015.5,-5434 3012,-5444 3019,-5444"/>
</g>
<!-- layer_12_attn_out_gpu8 -->
<g id="node542" class="node">
<title>layer_12_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2682,-5345.74 2589,-5345.74 2589,-5293.74 2682,-5293.74 2682,-5345.74"/>
<text text-anchor="middle" x="2635.5" y="-5333.74" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="2635.5" y="-5322.74" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2635.5" y="-5311.74" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2635.5" y="-5300.74" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attention&#45;&gt;layer_12_attn_out_gpu8 -->
<g id="edge907" class="edge">
<title>layer_12_attention&#45;&gt;layer_12_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M2981.28,-5402.97C2923.17,-5395.99 2801.62,-5378.94 2691.81,-5345.53"/>
<polygon fill="black" stroke="black" points="2692.83,-5342.18 2682.25,-5342.56 2690.76,-5348.86 2692.83,-5342.18"/>
</g>
<!-- layer_12_attn_out_gpu9 -->
<g id="node543" class="node">
<title>layer_12_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2793,-5345.74 2700,-5345.74 2700,-5293.74 2793,-5293.74 2793,-5345.74"/>
<text text-anchor="middle" x="2746.5" y="-5333.74" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="2746.5" y="-5322.74" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2746.5" y="-5311.74" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2746.5" y="-5300.74" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attention&#45;&gt;layer_12_attn_out_gpu9 -->
<g id="edge908" class="edge">
<title>layer_12_attention&#45;&gt;layer_12_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M2981.46,-5398.57C2939.01,-5388.03 2864.48,-5368.32 2802.5,-5345.74 2802.4,-5345.71 2802.31,-5345.67 2802.21,-5345.64"/>
<polygon fill="black" stroke="black" points="2803.64,-5342.44 2793.05,-5342.11 2801.13,-5348.97 2803.64,-5342.44"/>
</g>
<!-- layer_12_attn_out_gpu10 -->
<g id="node544" class="node">
<title>layer_12_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2904,-5345.74 2811,-5345.74 2811,-5293.74 2904,-5293.74 2904,-5345.74"/>
<text text-anchor="middle" x="2857.5" y="-5333.74" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="2857.5" y="-5322.74" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2857.5" y="-5311.74" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2857.5" y="-5300.74" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attention&#45;&gt;layer_12_attn_out_gpu10 -->
<g id="edge909" class="edge">
<title>layer_12_attention&#45;&gt;layer_12_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M2981.22,-5388.08C2961.19,-5377.18 2935.44,-5363.16 2912.62,-5350.74"/>
<polygon fill="black" stroke="black" points="2914.16,-5347.6 2903.71,-5345.89 2910.82,-5353.75 2914.16,-5347.6"/>
</g>
<!-- layer_12_attn_out_gpu11 -->
<g id="node545" class="node">
<title>layer_12_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3015,-5345.74 2922,-5345.74 2922,-5293.74 3015,-5293.74 3015,-5345.74"/>
<text text-anchor="middle" x="2968.5" y="-5333.74" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="2968.5" y="-5322.74" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2968.5" y="-5311.74" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2968.5" y="-5300.74" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attention&#45;&gt;layer_12_attn_out_gpu11 -->
<g id="edge910" class="edge">
<title>layer_12_attention&#45;&gt;layer_12_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M3001.65,-5381.4C2997.11,-5373.09 2991.99,-5363.72 2987.15,-5354.87"/>
<polygon fill="black" stroke="black" points="2990.12,-5352.99 2982.25,-5345.9 2983.97,-5356.35 2990.12,-5352.99"/>
</g>
<!-- layer_12_attn_out_gpu12 -->
<g id="node546" class="node">
<title>layer_12_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3126,-5345.74 3033,-5345.74 3033,-5293.74 3126,-5293.74 3126,-5345.74"/>
<text text-anchor="middle" x="3079.5" y="-5333.74" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="3079.5" y="-5322.74" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3079.5" y="-5311.74" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3079.5" y="-5300.74" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attention&#45;&gt;layer_12_attn_out_gpu12 -->
<g id="edge911" class="edge">
<title>layer_12_attention&#45;&gt;layer_12_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M3034.36,-5381.4C3040.74,-5372.83 3047.96,-5363.12 3054.73,-5354.03"/>
<polygon fill="black" stroke="black" points="3057.62,-5356.01 3060.78,-5345.9 3052,-5351.83 3057.62,-5356.01"/>
</g>
<!-- layer_12_attn_out_gpu13 -->
<g id="node547" class="node">
<title>layer_12_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3237,-5345.74 3144,-5345.74 3144,-5293.74 3237,-5293.74 3237,-5345.74"/>
<text text-anchor="middle" x="3190.5" y="-5333.74" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="3190.5" y="-5322.74" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3190.5" y="-5311.74" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3190.5" y="-5300.74" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attention&#45;&gt;layer_12_attn_out_gpu13 -->
<g id="edge912" class="edge">
<title>layer_12_attention&#45;&gt;layer_12_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M3049.66,-5389.96C3073.79,-5378.1 3106.67,-5361.94 3134.59,-5348.22"/>
<polygon fill="black" stroke="black" points="3136.42,-5351.22 3143.85,-5343.67 3133.33,-5344.94 3136.42,-5351.22"/>
</g>
<!-- layer_12_attn_out_gpu14 -->
<g id="node548" class="node">
<title>layer_12_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3348,-5345.74 3255,-5345.74 3255,-5293.74 3348,-5293.74 3348,-5345.74"/>
<text text-anchor="middle" x="3301.5" y="-5333.74" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="3301.5" y="-5322.74" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3301.5" y="-5311.74" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3301.5" y="-5300.74" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attention&#45;&gt;layer_12_attn_out_gpu14 -->
<g id="edge913" class="edge">
<title>layer_12_attention&#45;&gt;layer_12_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M3049.71,-5399.6C3093.42,-5390.08 3171.39,-5371.7 3245.44,-5345.91"/>
<polygon fill="black" stroke="black" points="3246.65,-5349.2 3254.91,-5342.56 3244.32,-5342.6 3246.65,-5349.2"/>
</g>
<!-- layer_12_attn_out_gpu15 -->
<g id="node549" class="node">
<title>layer_12_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3459,-5345.74 3366,-5345.74 3366,-5293.74 3459,-5293.74 3459,-5345.74"/>
<text text-anchor="middle" x="3412.5" y="-5333.74" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="3412.5" y="-5322.74" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3412.5" y="-5311.74" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3412.5" y="-5300.74" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attention&#45;&gt;layer_12_attn_out_gpu15 -->
<g id="edge914" class="edge">
<title>layer_12_attention&#45;&gt;layer_12_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M3049.66,-5403.51C3110.27,-5397.16 3240.42,-5380.8 3355.99,-5345.93"/>
<polygon fill="black" stroke="black" points="3357.17,-5349.23 3365.7,-5342.95 3355.11,-5342.54 3357.17,-5349.23"/>
</g>
<!-- layer_12_allreduce_attn -->
<g id="node550" class="node">
<title>layer_12_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="3079.5" cy="-5228.75" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="3079.5" y="-5237.25" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="3079.5" y="-5226.25" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="3079.5" y="-5215.25" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_12_attn_out_gpu8&#45;&gt;layer_12_allreduce_attn -->
<g id="edge915" class="edge">
<title>layer_12_attn_out_gpu8&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M2682.22,-5296.84C2685.33,-5295.71 2688.44,-5294.66 2691.5,-5293.74 2801.32,-5260.77 2934.06,-5243.52 3012.36,-5235.55"/>
<polygon fill="black" stroke="black" points="3012.97,-5239.01 3022.57,-5234.53 3012.27,-5232.04 3012.97,-5239.01"/>
</g>
<!-- layer_12_attn_out_gpu9&#45;&gt;layer_12_allreduce_attn -->
<g id="edge916" class="edge">
<title>layer_12_attn_out_gpu9&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M2793.29,-5297.06C2796.38,-5295.88 2799.47,-5294.76 2802.5,-5293.74 2873.91,-5269.8 2958.6,-5251.67 3015.37,-5240.92"/>
<polygon fill="black" stroke="black" points="3016.1,-5244.35 3025.29,-5239.07 3014.82,-5237.47 3016.1,-5244.35"/>
</g>
<!-- layer_12_attn_out_gpu10&#45;&gt;layer_12_allreduce_attn -->
<g id="edge917" class="edge">
<title>layer_12_attn_out_gpu10&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M2904.17,-5297.69C2907.32,-5296.33 2910.45,-5295.01 2913.5,-5293.74 2950.07,-5278.54 2991.66,-5262.51 3024.06,-5250.3"/>
<polygon fill="black" stroke="black" points="3025.67,-5253.43 3033.8,-5246.64 3023.21,-5246.88 3025.67,-5253.43"/>
</g>
<!-- layer_12_attn_out_gpu11&#45;&gt;layer_12_allreduce_attn -->
<g id="edge918" class="edge">
<title>layer_12_attn_out_gpu11&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M2999.72,-5293.72C3012.79,-5283.23 3028.11,-5270.95 3041.81,-5259.96"/>
<polygon fill="black" stroke="black" points="3044.05,-5262.66 3049.67,-5253.67 3039.67,-5257.19 3044.05,-5262.66"/>
</g>
<!-- layer_12_attn_out_gpu12&#45;&gt;layer_12_allreduce_attn -->
<g id="edge919" class="edge">
<title>layer_12_attn_out_gpu12&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M3079.5,-5293.48C3079.5,-5285.59 3079.5,-5276.7 3079.5,-5268.12"/>
<polygon fill="black" stroke="black" points="3083,-5267.89 3079.5,-5257.89 3076,-5267.89 3083,-5267.89"/>
</g>
<!-- layer_12_attn_out_gpu13&#45;&gt;layer_12_allreduce_attn -->
<g id="edge920" class="edge">
<title>layer_12_attn_out_gpu13&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M3159.28,-5293.72C3146.21,-5283.23 3130.89,-5270.95 3117.19,-5259.96"/>
<polygon fill="black" stroke="black" points="3119.33,-5257.19 3109.33,-5253.67 3114.95,-5262.66 3119.33,-5257.19"/>
</g>
<!-- layer_12_attn_out_gpu14&#45;&gt;layer_12_allreduce_attn -->
<g id="edge921" class="edge">
<title>layer_12_attn_out_gpu14&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M3254.78,-5297.27C3251.98,-5296.06 3249.21,-5294.87 3246.5,-5293.74 3209.61,-5278.31 3167.57,-5262.21 3134.9,-5250.02"/>
<polygon fill="black" stroke="black" points="3136.11,-5246.73 3125.52,-5246.53 3133.67,-5253.29 3136.11,-5246.73"/>
</g>
<!-- layer_12_attn_out_gpu15&#45;&gt;layer_12_allreduce_attn -->
<g id="edge922" class="edge">
<title>layer_12_attn_out_gpu15&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M3365.95,-5296.81C3363.11,-5295.72 3360.28,-5294.68 3357.5,-5293.74 3285.92,-5269.51 3200.9,-5251.43 3143.9,-5240.78"/>
<polygon fill="black" stroke="black" points="3144.41,-5237.31 3133.94,-5238.94 3143.14,-5244.2 3144.41,-5237.31"/>
</g>
<!-- layer_12_allreduce_attn&#45;&gt;layer_12_residual1 -->
<g id="edge923" class="edge">
<title>layer_12_allreduce_attn&#45;&gt;layer_12_residual1</title>
<path fill="none" stroke="black" d="M3121.77,-5208.48C3151.62,-5194.88 3192,-5176.47 3224.95,-5161.45"/>
<polygon fill="black" stroke="black" points="3226.82,-5164.44 3234.47,-5157.11 3223.92,-5158.07 3226.82,-5164.44"/>
</g>
<!-- layer_12_ln1 -->
<g id="node552" class="node">
<title>layer_12_ln1</title>
<polygon fill="lightblue" stroke="black" points="3106,-5067.76 3033,-5067.76 3033,-5026.76 3106,-5026.76 3106,-5067.76"/>
<text text-anchor="middle" x="3069.5" y="-5055.76" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="3069.5" y="-5044.76" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="3069.5" y="-5033.76" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_12_residual1&#45;&gt;layer_12_ln1 -->
<g id="edge925" class="edge">
<title>layer_12_residual1&#45;&gt;layer_12_ln1</title>
<path fill="none" stroke="black" d="M3209.85,-5103.68C3178.49,-5091.29 3142.88,-5077.23 3115.37,-5066.37"/>
<polygon fill="black" stroke="black" points="3116.59,-5063.09 3106,-5062.67 3114.02,-5069.6 3116.59,-5063.09"/>
</g>
<!-- layer_12_residual2 -->
<g id="node572" class="node">
<title>layer_12_residual2</title>
<polygon fill="lightyellow" stroke="black" points="3360.44,-4554.79 3238.05,-4554.79 3206.56,-4494.79 3328.95,-4494.79 3360.44,-4554.79"/>
<text text-anchor="middle" x="3283.5" y="-4527.79" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="3283.5" y="-4516.79" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_12_residual1&#45;&gt;layer_12_residual2 -->
<g id="edge960" class="edge">
<title>layer_12_residual1&#45;&gt;layer_12_residual2</title>
<path fill="none" stroke="black" d="M3336.37,-5117.36C3400.03,-5095.18 3498.5,-5047.64 3498.5,-4965.76 3498.5,-4965.76 3498.5,-4965.76 3498.5,-4709.78 3498.5,-4638.4 3429.25,-4588.78 3369.35,-4559.21"/>
<polygon fill="black" stroke="black" points="3370.74,-4555.99 3360.21,-4554.82 3367.7,-4562.3 3370.74,-4555.99"/>
</g>
<!-- layer_12_mlp_fc1_gpu8 -->
<g id="node553" class="node">
<title>layer_12_mlp_fc1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2651,-4990.76 2552,-4990.76 2552,-4938.76 2651,-4938.76 2651,-4990.76"/>
<text text-anchor="middle" x="2601.5" y="-4978.76" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="2601.5" y="-4967.76" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2601.5" y="-4956.76" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2601.5" y="-4945.76" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu8 -->
<g id="edge926" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu8</title>
<path fill="none" stroke="black" d="M3032.74,-5044.54C2961.94,-5040.54 2801.96,-5028.12 2660.76,-4990.49"/>
<polygon fill="black" stroke="black" points="2661.63,-4987.1 2651.06,-4987.85 2659.79,-4993.85 2661.63,-4987.1"/>
</g>
<!-- layer_12_mlp_fc1_gpu9 -->
<g id="node554" class="node">
<title>layer_12_mlp_fc1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2768,-4990.76 2669,-4990.76 2669,-4938.76 2768,-4938.76 2768,-4990.76"/>
<text text-anchor="middle" x="2718.5" y="-4978.76" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="2718.5" y="-4967.76" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2718.5" y="-4956.76" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2718.5" y="-4945.76" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu9 -->
<g id="edge927" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu9</title>
<path fill="none" stroke="black" d="M3032.94,-5041.86C2978.85,-5034.8 2874.39,-5019.06 2777.74,-4990.55"/>
<polygon fill="black" stroke="black" points="2778.7,-4987.19 2768.12,-4987.66 2776.69,-4993.89 2778.7,-4987.19"/>
</g>
<!-- layer_12_mlp_fc1_gpu10 -->
<g id="node555" class="node">
<title>layer_12_mlp_fc1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2885,-4990.76 2786,-4990.76 2786,-4938.76 2885,-4938.76 2885,-4990.76"/>
<text text-anchor="middle" x="2835.5" y="-4978.76" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="2835.5" y="-4967.76" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2835.5" y="-4956.76" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2835.5" y="-4945.76" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu10 -->
<g id="edge928" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu10</title>
<path fill="none" stroke="black" d="M3032.97,-5035.76C2999.35,-5025.86 2947.97,-5010.12 2894.85,-4990.76"/>
<polygon fill="black" stroke="black" points="2895.86,-4987.4 2885.26,-4987.23 2893.44,-4993.97 2895.86,-4987.4"/>
</g>
<!-- layer_12_mlp_fc1_gpu11 -->
<g id="node556" class="node">
<title>layer_12_mlp_fc1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3002,-4990.76 2903,-4990.76 2903,-4938.76 3002,-4938.76 3002,-4990.76"/>
<text text-anchor="middle" x="2952.5" y="-4978.76" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="2952.5" y="-4967.76" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2952.5" y="-4956.76" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2952.5" y="-4945.76" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu11 -->
<g id="edge929" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu11</title>
<path fill="none" stroke="black" d="M3040.88,-5026.57C3027.87,-5017.62 3012.17,-5006.81 2997.63,-4996.81"/>
<polygon fill="black" stroke="black" points="2999.46,-4993.82 2989.24,-4991.04 2995.49,-4999.59 2999.46,-4993.82"/>
</g>
<!-- layer_12_mlp_fc1_gpu12 -->
<g id="node557" class="node">
<title>layer_12_mlp_fc1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3119,-4990.76 3020,-4990.76 3020,-4938.76 3119,-4938.76 3119,-4990.76"/>
<text text-anchor="middle" x="3069.5" y="-4978.76" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="3069.5" y="-4967.76" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3069.5" y="-4956.76" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3069.5" y="-4945.76" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu12 -->
<g id="edge930" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu12</title>
<path fill="none" stroke="black" d="M3069.5,-5026.36C3069.5,-5018.75 3069.5,-5009.82 3069.5,-5001.18"/>
<polygon fill="black" stroke="black" points="3073,-5000.91 3069.5,-4990.91 3066,-5000.91 3073,-5000.91"/>
</g>
<!-- layer_12_mlp_fc1_gpu13 -->
<g id="node558" class="node">
<title>layer_12_mlp_fc1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3236,-4990.76 3137,-4990.76 3137,-4938.76 3236,-4938.76 3236,-4990.76"/>
<text text-anchor="middle" x="3186.5" y="-4978.76" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="3186.5" y="-4967.76" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3186.5" y="-4956.76" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3186.5" y="-4945.76" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu13 -->
<g id="edge931" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu13</title>
<path fill="none" stroke="black" d="M3098.12,-5026.57C3111.13,-5017.62 3126.83,-5006.81 3141.37,-4996.81"/>
<polygon fill="black" stroke="black" points="3143.51,-4999.59 3149.76,-4991.04 3139.54,-4993.82 3143.51,-4999.59"/>
</g>
<!-- layer_12_mlp_fc1_gpu14 -->
<g id="node559" class="node">
<title>layer_12_mlp_fc1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3353,-4990.76 3254,-4990.76 3254,-4938.76 3353,-4938.76 3353,-4990.76"/>
<text text-anchor="middle" x="3303.5" y="-4978.76" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="3303.5" y="-4967.76" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3303.5" y="-4956.76" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3303.5" y="-4945.76" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu14 -->
<g id="edge932" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu14</title>
<path fill="none" stroke="black" d="M3106.27,-5035.85C3140.1,-5026.01 3191.79,-5010.32 3244.46,-4991.02"/>
<polygon fill="black" stroke="black" points="3245.8,-4994.26 3253.96,-4987.5 3243.37,-4987.69 3245.8,-4994.26"/>
</g>
<!-- layer_12_mlp_fc1_gpu15 -->
<g id="node560" class="node">
<title>layer_12_mlp_fc1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3470,-4990.76 3371,-4990.76 3371,-4938.76 3470,-4938.76 3470,-4990.76"/>
<text text-anchor="middle" x="3420.5" y="-4978.76" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="3420.5" y="-4967.76" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3420.5" y="-4956.76" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3420.5" y="-4945.76" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu15 -->
<g id="edge933" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu15</title>
<path fill="none" stroke="black" d="M3106.21,-5041.94C3160.46,-5035 3265.15,-5019.42 3360.94,-4990.99"/>
<polygon fill="black" stroke="black" points="3362.22,-4994.26 3370.77,-4988.02 3360.19,-4987.56 3362.22,-4994.26"/>
</g>
<!-- layer_12_allgather_mlp -->
<g id="node561" class="node">
<title>layer_12_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="3010.5" cy="-4873.77" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="3010.5" y="-4882.27" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="3010.5" y="-4871.27" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="3010.5" y="-4860.27" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_12_mlp_fc1_gpu8&#45;&gt;layer_12_allgather_mlp -->
<g id="edge934" class="edge">
<title>layer_12_mlp_fc1_gpu8&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M2651.11,-4941.83C2654.26,-4940.72 2657.41,-4939.68 2660.5,-4938.76 2757.8,-4909.64 2874.48,-4891.53 2945.52,-4882.3"/>
<polygon fill="black" stroke="black" points="2946.19,-4885.74 2955.66,-4881 2945.3,-4878.8 2946.19,-4885.74"/>
</g>
<!-- layer_12_mlp_fc1_gpu9&#45;&gt;layer_12_allgather_mlp -->
<g id="edge935" class="edge">
<title>layer_12_mlp_fc1_gpu9&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M2768.21,-4942.15C2771.34,-4940.96 2774.45,-4939.82 2777.5,-4938.76 2835.03,-4918.77 2902.24,-4900.87 2949.65,-4889.12"/>
<polygon fill="black" stroke="black" points="2950.58,-4892.5 2959.46,-4886.71 2948.91,-4885.7 2950.58,-4892.5"/>
</g>
<!-- layer_12_mlp_fc1_gpu10&#45;&gt;layer_12_allgather_mlp -->
<g id="edge936" class="edge">
<title>layer_12_mlp_fc1_gpu10&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M2884.71,-4938.73C2908.92,-4926.42 2937.99,-4911.64 2962.08,-4899.39"/>
<polygon fill="black" stroke="black" points="2963.73,-4902.48 2971.05,-4894.83 2960.55,-4896.24 2963.73,-4902.48"/>
</g>
<!-- layer_12_mlp_fc1_gpu11&#45;&gt;layer_12_allgather_mlp -->
<g id="edge937" class="edge">
<title>layer_12_mlp_fc1_gpu11&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M2968.97,-4938.5C2974.71,-4929.68 2981.27,-4919.62 2987.44,-4910.14"/>
<polygon fill="black" stroke="black" points="2990.45,-4911.94 2992.98,-4901.65 2984.59,-4908.12 2990.45,-4911.94"/>
</g>
<!-- layer_12_mlp_fc1_gpu12&#45;&gt;layer_12_allgather_mlp -->
<g id="edge938" class="edge">
<title>layer_12_mlp_fc1_gpu12&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M3052.75,-4938.5C3046.86,-4929.6 3040.12,-4919.44 3033.78,-4909.89"/>
<polygon fill="black" stroke="black" points="3036.56,-4907.74 3028.11,-4901.34 3030.72,-4911.6 3036.56,-4907.74"/>
</g>
<!-- layer_12_mlp_fc1_gpu13&#45;&gt;layer_12_allgather_mlp -->
<g id="edge939" class="edge">
<title>layer_12_mlp_fc1_gpu13&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M3137.01,-4938.73C3112.57,-4926.38 3083.21,-4911.53 3058.92,-4899.25"/>
<polygon fill="black" stroke="black" points="3060.39,-4896.07 3049.89,-4894.68 3057.23,-4902.32 3060.39,-4896.07"/>
</g>
<!-- layer_12_mlp_fc1_gpu14&#45;&gt;layer_12_allgather_mlp -->
<g id="edge940" class="edge">
<title>layer_12_mlp_fc1_gpu14&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M3253.69,-4941.76C3250.93,-4940.71 3248.19,-4939.7 3245.5,-4938.76 3187.37,-4918.43 3119.32,-4900.52 3071.45,-4888.86"/>
<polygon fill="black" stroke="black" points="3072.1,-4885.41 3061.56,-4886.46 3070.45,-4892.22 3072.1,-4885.41"/>
</g>
<!-- layer_12_mlp_fc1_gpu15&#45;&gt;layer_12_allgather_mlp -->
<g id="edge941" class="edge">
<title>layer_12_mlp_fc1_gpu15&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M3370.78,-4941.48C3368,-4940.5 3365.23,-4939.58 3362.5,-4938.76 3264.6,-4909.18 3147.02,-4891.18 3075.58,-4882.1"/>
<polygon fill="black" stroke="black" points="3075.73,-4878.59 3065.38,-4880.82 3074.87,-4885.54 3075.73,-4878.59"/>
</g>
<!-- layer_12_gelu -->
<g id="node562" class="node">
<title>layer_12_gelu</title>
<polygon fill="lightblue" stroke="black" points="3055,-4808.78 2966,-4808.78 2966,-4772.78 3055,-4772.78 3055,-4808.78"/>
<text text-anchor="middle" x="3010.5" y="-4793.78" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="3010.5" y="-4782.78" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_12_allgather_mlp&#45;&gt;layer_12_gelu -->
<g id="edge942" class="edge">
<title>layer_12_allgather_mlp&#45;&gt;layer_12_gelu</title>
<path fill="none" stroke="black" d="M3010.5,-4844.44C3010.5,-4836.19 3010.5,-4827.2 3010.5,-4819.03"/>
<polygon fill="black" stroke="black" points="3014,-4818.87 3010.5,-4808.87 3007,-4818.87 3014,-4818.87"/>
</g>
<!-- layer_12_mlp_fc2_gpu8 -->
<g id="node563" class="node">
<title>layer_12_mlp_fc2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2651,-4736.78 2552,-4736.78 2552,-4684.78 2651,-4684.78 2651,-4736.78"/>
<text text-anchor="middle" x="2601.5" y="-4724.78" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="2601.5" y="-4713.78" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2601.5" y="-4702.78" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2601.5" y="-4691.78" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu8 -->
<g id="edge943" class="edge">
<title>layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu8</title>
<path fill="none" stroke="black" d="M2965.82,-4786.61C2900.45,-4781.2 2775.05,-4767.87 2661.02,-4736.6"/>
<polygon fill="black" stroke="black" points="2661.65,-4733.14 2651.08,-4733.82 2659.76,-4739.88 2661.65,-4733.14"/>
</g>
<!-- layer_12_mlp_fc2_gpu9 -->
<g id="node564" class="node">
<title>layer_12_mlp_fc2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2768,-4736.78 2669,-4736.78 2669,-4684.78 2768,-4684.78 2768,-4736.78"/>
<text text-anchor="middle" x="2718.5" y="-4724.78" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="2718.5" y="-4713.78" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2718.5" y="-4702.78" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2718.5" y="-4691.78" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu9 -->
<g id="edge944" class="edge">
<title>layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu9</title>
<path fill="none" stroke="black" d="M2965.63,-4782.02C2920.37,-4773.65 2848.48,-4758.89 2778.08,-4736.72"/>
<polygon fill="black" stroke="black" points="2778.75,-4733.26 2768.16,-4733.55 2776.61,-4739.93 2778.75,-4733.26"/>
</g>
<!-- layer_12_mlp_fc2_gpu10 -->
<g id="node565" class="node">
<title>layer_12_mlp_fc2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="2885,-4736.78 2786,-4736.78 2786,-4684.78 2885,-4684.78 2885,-4736.78"/>
<text text-anchor="middle" x="2835.5" y="-4724.78" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="2835.5" y="-4713.78" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2835.5" y="-4702.78" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2835.5" y="-4691.78" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu10 -->
<g id="edge945" class="edge">
<title>layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu10</title>
<path fill="none" stroke="black" d="M2972.1,-4772.66C2949.33,-4762.51 2920.02,-4749.45 2894.39,-4738.02"/>
<polygon fill="black" stroke="black" points="2895.69,-4734.77 2885.13,-4733.9 2892.84,-4741.16 2895.69,-4734.77"/>
</g>
<!-- layer_12_mlp_fc2_gpu11 -->
<g id="node566" class="node">
<title>layer_12_mlp_fc2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3002,-4736.78 2903,-4736.78 2903,-4684.78 3002,-4684.78 3002,-4736.78"/>
<text text-anchor="middle" x="2952.5" y="-4724.78" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="2952.5" y="-4713.78" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2952.5" y="-4702.78" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2952.5" y="-4691.78" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu11 -->
<g id="edge946" class="edge">
<title>layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu11</title>
<path fill="none" stroke="black" d="M2997.63,-4772.47C2991.64,-4764.41 2984.31,-4754.55 2977.3,-4745.13"/>
<polygon fill="black" stroke="black" points="2980.06,-4742.97 2971.28,-4737.03 2974.44,-4747.15 2980.06,-4742.97"/>
</g>
<!-- layer_12_mlp_fc2_gpu12 -->
<g id="node567" class="node">
<title>layer_12_mlp_fc2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3119,-4736.78 3020,-4736.78 3020,-4684.78 3119,-4684.78 3119,-4736.78"/>
<text text-anchor="middle" x="3069.5" y="-4724.78" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="3069.5" y="-4713.78" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3069.5" y="-4702.78" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3069.5" y="-4691.78" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu12 -->
<g id="edge947" class="edge">
<title>layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu12</title>
<path fill="none" stroke="black" d="M3023.59,-4772.47C3029.69,-4764.41 3037.15,-4754.55 3044.27,-4745.13"/>
<polygon fill="black" stroke="black" points="3047.15,-4747.12 3050.4,-4737.03 3041.57,-4742.9 3047.15,-4747.12"/>
</g>
<!-- layer_12_mlp_fc2_gpu13 -->
<g id="node568" class="node">
<title>layer_12_mlp_fc2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3236,-4736.78 3137,-4736.78 3137,-4684.78 3236,-4684.78 3236,-4736.78"/>
<text text-anchor="middle" x="3186.5" y="-4724.78" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="3186.5" y="-4713.78" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3186.5" y="-4702.78" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3186.5" y="-4691.78" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu13 -->
<g id="edge948" class="edge">
<title>layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu13</title>
<path fill="none" stroke="black" d="M3049.12,-4772.66C3072.1,-4762.47 3101.73,-4749.35 3127.58,-4737.89"/>
<polygon fill="black" stroke="black" points="3129.19,-4741 3136.91,-4733.75 3126.35,-4734.6 3129.19,-4741"/>
</g>
<!-- layer_12_mlp_fc2_gpu14 -->
<g id="node569" class="node">
<title>layer_12_mlp_fc2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3353,-4736.78 3254,-4736.78 3254,-4684.78 3353,-4684.78 3353,-4736.78"/>
<text text-anchor="middle" x="3303.5" y="-4724.78" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="3303.5" y="-4713.78" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3303.5" y="-4702.78" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3303.5" y="-4691.78" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu14 -->
<g id="edge949" class="edge">
<title>layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu14</title>
<path fill="none" stroke="black" d="M3055.34,-4782.22C3100.98,-4773.97 3173.76,-4759.26 3243.87,-4737.1"/>
<polygon fill="black" stroke="black" points="3245.29,-4740.31 3253.74,-4733.92 3243.15,-4733.65 3245.29,-4740.31"/>
</g>
<!-- layer_12_mlp_fc2_gpu15 -->
<g id="node570" class="node">
<title>layer_12_mlp_fc2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3470,-4736.78 3371,-4736.78 3371,-4684.78 3470,-4684.78 3470,-4736.78"/>
<text text-anchor="middle" x="3420.5" y="-4724.78" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="3420.5" y="-4713.78" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3420.5" y="-4702.78" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3420.5" y="-4691.78" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu15 -->
<g id="edge950" class="edge">
<title>layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu15</title>
<path fill="none" stroke="black" d="M3055.18,-4786.75C3120.87,-4781.5 3247.23,-4768.35 3360.91,-4736.95"/>
<polygon fill="black" stroke="black" points="3362.14,-4740.24 3370.81,-4734.16 3360.24,-4733.5 3362.14,-4740.24"/>
</g>
<!-- layer_12_allreduce_mlp -->
<g id="node571" class="node">
<title>layer_12_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="3069.5" cy="-4619.78" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="3069.5" y="-4628.28" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="3069.5" y="-4617.28" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="3069.5" y="-4606.28" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_12_mlp_fc2_gpu8&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge951" class="edge">
<title>layer_12_mlp_fc2_gpu8&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2651.08,-4687.75C2654.24,-4686.67 2657.4,-4685.66 2660.5,-4684.78 2777.27,-4651.45 2918.05,-4634.24 3000.3,-4626.39"/>
<polygon fill="black" stroke="black" points="3000.64,-4629.87 3010.27,-4625.46 2999.99,-4622.9 3000.64,-4629.87"/>
</g>
<!-- layer_12_mlp_fc2_gpu9&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge952" class="edge">
<title>layer_12_mlp_fc2_gpu9&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2768.15,-4687.97C2771.29,-4686.83 2774.43,-4685.75 2777.5,-4684.78 2853.35,-4660.63 2943.12,-4642.44 3002.91,-4631.75"/>
<polygon fill="black" stroke="black" points="3003.74,-4635.15 3012.98,-4629.97 3002.53,-4628.26 3003.74,-4635.15"/>
</g>
<!-- layer_12_mlp_fc2_gpu10&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge953" class="edge">
<title>layer_12_mlp_fc2_gpu10&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2885,-4688.59C2888.21,-4687.28 2891.4,-4686 2894.5,-4684.78 2933.39,-4669.44 2977.62,-4653.27 3011.88,-4641.03"/>
<polygon fill="black" stroke="black" points="3013.48,-4644.18 3021.72,-4637.53 3011.13,-4637.59 3013.48,-4644.18"/>
</g>
<!-- layer_12_mlp_fc2_gpu11&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge954" class="edge">
<title>layer_12_mlp_fc2_gpu11&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2985.4,-4684.75C2999.19,-4674.26 3015.34,-4661.98 3029.78,-4651"/>
<polygon fill="black" stroke="black" points="3032.21,-4653.54 3038.05,-4644.7 3027.97,-4647.97 3032.21,-4653.54"/>
</g>
<!-- layer_12_mlp_fc2_gpu12&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge955" class="edge">
<title>layer_12_mlp_fc2_gpu12&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3069.5,-4684.51C3069.5,-4676.62 3069.5,-4667.73 3069.5,-4659.15"/>
<polygon fill="black" stroke="black" points="3073,-4658.93 3069.5,-4648.93 3066,-4658.93 3073,-4658.93"/>
</g>
<!-- layer_12_mlp_fc2_gpu13&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge956" class="edge">
<title>layer_12_mlp_fc2_gpu13&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3153.6,-4684.75C3139.81,-4674.26 3123.66,-4661.98 3109.22,-4651"/>
<polygon fill="black" stroke="black" points="3111.03,-4647.97 3100.95,-4644.7 3106.79,-4653.54 3111.03,-4647.97"/>
</g>
<!-- layer_12_mlp_fc2_gpu14&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge957" class="edge">
<title>layer_12_mlp_fc2_gpu14&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3253.91,-4688.17C3251.07,-4687.01 3248.25,-4685.87 3245.5,-4684.78 3206.28,-4669.21 3161.58,-4652.98 3127.05,-4640.76"/>
<polygon fill="black" stroke="black" points="3128.19,-4637.45 3117.59,-4637.42 3125.86,-4644.05 3128.19,-4637.45"/>
</g>
<!-- layer_12_mlp_fc2_gpu15&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge958" class="edge">
<title>layer_12_mlp_fc2_gpu15&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3370.75,-4687.61C3367.98,-4686.6 3365.21,-4685.65 3362.5,-4684.78 3286.35,-4660.3 3196.09,-4642.16 3136.07,-4631.56"/>
<polygon fill="black" stroke="black" points="3136.42,-4628.07 3125.97,-4629.8 3135.22,-4634.96 3136.42,-4628.07"/>
</g>
<!-- layer_12_allreduce_mlp&#45;&gt;layer_12_residual2 -->
<g id="edge959" class="edge">
<title>layer_12_allreduce_mlp&#45;&gt;layer_12_residual2</title>
<path fill="none" stroke="black" d="M3113.32,-4599.74C3145.43,-4585.79 3189.35,-4566.7 3224.53,-4551.42"/>
<polygon fill="black" stroke="black" points="3225.97,-4554.61 3233.74,-4547.41 3223.18,-4548.19 3225.97,-4554.61"/>
</g>
<!-- layer_12_ln2 -->
<g id="node573" class="node">
<title>layer_12_ln2</title>
<polygon fill="lightblue" stroke="black" points="3320,-4458.79 3247,-4458.79 3247,-4417.79 3320,-4417.79 3320,-4458.79"/>
<text text-anchor="middle" x="3283.5" y="-4446.79" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="3283.5" y="-4435.79" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="3283.5" y="-4424.79" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_12_residual2&#45;&gt;layer_12_ln2 -->
<g id="edge961" class="edge">
<title>layer_12_residual2&#45;&gt;layer_12_ln2</title>
<path fill="none" stroke="black" d="M3283.5,-4494.71C3283.5,-4486.39 3283.5,-4477.31 3283.5,-4468.95"/>
<polygon fill="black" stroke="black" points="3287,-4468.86 3283.5,-4458.86 3280,-4468.86 3287,-4468.86"/>
</g>
<!-- layer_12_output_dist -->
<g id="node574" class="node">
<title>layer_12_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="3385.2,-4381.79 3223.42,-4381.79 3181.8,-4321.79 3343.58,-4321.79 3385.2,-4381.79"/>
<text text-anchor="middle" x="3283.5" y="-4354.79" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="3283.5" y="-4343.79" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_12_ln2&#45;&gt;layer_12_output_dist -->
<g id="edge962" class="edge">
<title>layer_12_ln2&#45;&gt;layer_12_output_dist</title>
<path fill="none" stroke="black" d="M3283.5,-4417.69C3283.5,-4410.06 3283.5,-4401.01 3283.5,-4392.14"/>
<polygon fill="black" stroke="black" points="3287,-4391.9 3283.5,-4381.9 3280,-4391.9 3287,-4391.9"/>
</g>
<!-- layer_13_input_dist -->
<g id="node575" class="node">
<title>layer_13_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="3377.69,-4285.79 3227.86,-4285.79 3189.31,-4225.79 3339.14,-4225.79 3377.69,-4285.79"/>
<text text-anchor="middle" x="3283.5" y="-4258.79" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="3283.5" y="-4247.79" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_12_output_dist&#45;&gt;layer_13_input_dist -->
<g id="edge963" class="edge">
<title>layer_12_output_dist&#45;&gt;layer_13_input_dist</title>
<path fill="none" stroke="black" d="M3283.5,-4321.57C3283.5,-4313.52 3283.5,-4304.66 3283.5,-4296.14"/>
<polygon fill="black" stroke="black" points="3287,-4296 3283.5,-4286 3280,-4296 3287,-4296"/>
</g>
<!-- layer_13_qkv_gpu8 -->
<g id="node576" class="node">
<title>layer_13_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2868.5,-4189.79 2770.5,-4189.79 2770.5,-4137.79 2868.5,-4137.79 2868.5,-4189.79"/>
<text text-anchor="middle" x="2819.5" y="-4177.79" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="2819.5" y="-4166.79" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2819.5" y="-4155.79" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2819.5" y="-4144.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu8 -->
<g id="edge964" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu8</title>
<path fill="none" stroke="black" d="M3203.24,-4247.87C3122.67,-4239.6 2995.23,-4222.87 2878.38,-4189.75"/>
<polygon fill="black" stroke="black" points="2879.13,-4186.33 2868.55,-4186.92 2877.19,-4193.05 2879.13,-4186.33"/>
</g>
<!-- layer_13_qkv_gpu9 -->
<g id="node577" class="node">
<title>layer_13_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2984.5,-4189.79 2886.5,-4189.79 2886.5,-4137.79 2984.5,-4137.79 2984.5,-4189.79"/>
<text text-anchor="middle" x="2935.5" y="-4177.79" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="2935.5" y="-4166.79" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2935.5" y="-4155.79" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2935.5" y="-4144.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu9 -->
<g id="edge965" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu9</title>
<path fill="none" stroke="black" d="M3198.31,-4240.04C3142.43,-4229.36 3067.84,-4213.19 2994.49,-4189.89"/>
<polygon fill="black" stroke="black" points="2995.21,-4186.44 2984.62,-4186.71 2993.06,-4193.11 2995.21,-4186.44"/>
</g>
<!-- layer_13_qkv_gpu10 -->
<g id="node578" class="node">
<title>layer_13_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3100.5,-4189.79 3002.5,-4189.79 3002.5,-4137.79 3100.5,-4137.79 3100.5,-4189.79"/>
<text text-anchor="middle" x="3051.5" y="-4177.79" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="3051.5" y="-4166.79" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3051.5" y="-4155.79" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3051.5" y="-4144.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu10 -->
<g id="edge966" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu10</title>
<path fill="none" stroke="black" d="M3203.05,-4225.68C3175.93,-4215.64 3145.36,-4204.08 3110.3,-4190.06"/>
<polygon fill="black" stroke="black" points="3111.38,-4186.72 3100.79,-4186.24 3108.77,-4193.21 3111.38,-4186.72"/>
</g>
<!-- layer_13_qkv_gpu11 -->
<g id="node579" class="node">
<title>layer_13_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3216.5,-4189.79 3118.5,-4189.79 3118.5,-4137.79 3216.5,-4137.79 3216.5,-4189.79"/>
<text text-anchor="middle" x="3167.5" y="-4177.79" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="3167.5" y="-4166.79" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3167.5" y="-4155.79" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3167.5" y="-4144.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu11 -->
<g id="edge967" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu11</title>
<path fill="none" stroke="black" d="M3245.84,-4225.57C3233.68,-4216.14 3220.16,-4205.65 3207.82,-4196.08"/>
<polygon fill="black" stroke="black" points="3209.96,-4193.3 3199.91,-4189.94 3205.66,-4198.83 3209.96,-4193.3"/>
</g>
<!-- layer_13_qkv_gpu12 -->
<g id="node580" class="node">
<title>layer_13_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3332.5,-4189.79 3234.5,-4189.79 3234.5,-4137.79 3332.5,-4137.79 3332.5,-4189.79"/>
<text text-anchor="middle" x="3283.5" y="-4177.79" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="3283.5" y="-4166.79" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3283.5" y="-4155.79" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3283.5" y="-4144.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu12 -->
<g id="edge968" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu12</title>
<path fill="none" stroke="black" d="M3283.5,-4225.32C3283.5,-4217.25 3283.5,-4208.41 3283.5,-4200.05"/>
<polygon fill="black" stroke="black" points="3287,-4199.8 3283.5,-4189.8 3280,-4199.8 3287,-4199.8"/>
</g>
<!-- layer_13_qkv_gpu13 -->
<g id="node581" class="node">
<title>layer_13_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3448.5,-4189.79 3350.5,-4189.79 3350.5,-4137.79 3448.5,-4137.79 3448.5,-4189.79"/>
<text text-anchor="middle" x="3399.5" y="-4177.79" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="3399.5" y="-4166.79" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3399.5" y="-4155.79" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3399.5" y="-4144.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu13 -->
<g id="edge969" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu13</title>
<path fill="none" stroke="black" d="M3321.16,-4225.57C3333.32,-4216.14 3346.84,-4205.65 3359.18,-4196.08"/>
<polygon fill="black" stroke="black" points="3361.34,-4198.83 3367.09,-4189.94 3357.04,-4193.3 3361.34,-4198.83"/>
</g>
<!-- layer_13_qkv_gpu14 -->
<g id="node582" class="node">
<title>layer_13_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3564.5,-4189.79 3466.5,-4189.79 3466.5,-4137.79 3564.5,-4137.79 3564.5,-4189.79"/>
<text text-anchor="middle" x="3515.5" y="-4177.79" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="3515.5" y="-4166.79" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3515.5" y="-4155.79" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3515.5" y="-4144.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu14 -->
<g id="edge970" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu14</title>
<path fill="none" stroke="black" d="M3344.18,-4232.96C3375.44,-4221.52 3414.35,-4206.98 3456.81,-4190.01"/>
<polygon fill="black" stroke="black" points="3458.23,-4193.21 3466.21,-4186.24 3455.62,-4186.71 3458.23,-4193.21"/>
</g>
<!-- layer_13_qkv_gpu15 -->
<g id="node583" class="node">
<title>layer_13_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3680.5,-4189.79 3582.5,-4189.79 3582.5,-4137.79 3680.5,-4137.79 3680.5,-4189.79"/>
<text text-anchor="middle" x="3631.5" y="-4177.79" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="3631.5" y="-4166.79" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3631.5" y="-4155.79" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3631.5" y="-4144.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu15 -->
<g id="edge971" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu15</title>
<path fill="none" stroke="black" d="M3350.68,-4243.42C3407.75,-4232.92 3491.78,-4215.5 3572.55,-4189.87"/>
<polygon fill="black" stroke="black" points="3573.93,-4193.1 3582.38,-4186.71 3571.79,-4186.44 3573.93,-4193.1"/>
</g>
<!-- layer_13_residual1 -->
<g id="node595" class="node">
<title>layer_13_residual1</title>
<polygon fill="lightyellow" stroke="black" points="3581.44,-3737.83 3459.05,-3737.83 3427.56,-3677.83 3549.95,-3677.83 3581.44,-3737.83"/>
<text text-anchor="middle" x="3504.5" y="-3710.83" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="3504.5" y="-3699.83" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_residual1 -->
<g id="edge998" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_residual1</title>
<path fill="none" stroke="black" d="M3356.7,-4253.03C3460.74,-4248.93 3643.86,-4235.27 3689.5,-4189.79 3726.51,-4152.92 3708.5,-4126.04 3708.5,-4073.8 3708.5,-4073.8 3708.5,-4073.8 3708.5,-3892.81 3708.5,-3822.87 3641.55,-3772.68 3584.36,-3742.57"/>
<polygon fill="black" stroke="black" points="3585.77,-3739.36 3575.28,-3737.91 3582.58,-3745.59 3585.77,-3739.36"/>
</g>
<!-- layer_13_allgather_qkv -->
<g id="node584" class="node">
<title>layer_13_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="3236.5" cy="-4072.8" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="3236.5" y="-4081.3" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="3236.5" y="-4070.3" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="3236.5" y="-4059.3" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_13_qkv_gpu8&#45;&gt;layer_13_allgather_qkv -->
<g id="edge972" class="edge">
<title>layer_13_qkv_gpu8&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M2868.57,-4140.73C2871.57,-4139.66 2874.56,-4138.68 2877.5,-4137.79 2977.69,-4107.71 3098.1,-4089.8 3170.89,-4080.89"/>
<polygon fill="black" stroke="black" points="3171.33,-4084.36 3180.84,-4079.69 3170.49,-4077.41 3171.33,-4084.36"/>
</g>
<!-- layer_13_qkv_gpu9&#45;&gt;layer_13_allgather_qkv -->
<g id="edge973" class="edge">
<title>layer_13_qkv_gpu9&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M2984.66,-4141.01C2987.64,-4139.88 2990.6,-4138.79 2993.5,-4137.79 3053.88,-4116.96 3124.68,-4099.03 3174.23,-4087.49"/>
<polygon fill="black" stroke="black" points="3175.2,-4090.86 3184.16,-4085.2 3173.63,-4084.04 3175.2,-4090.86"/>
</g>
<!-- layer_13_qkv_gpu10&#45;&gt;layer_13_allgather_qkv -->
<g id="edge974" class="edge">
<title>layer_13_qkv_gpu10&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M3100.59,-4139.18C3127.21,-4126.37 3160.03,-4110.58 3186.75,-4097.73"/>
<polygon fill="black" stroke="black" points="3188.44,-4100.81 3195.93,-4093.32 3185.4,-4094.5 3188.44,-4100.81"/>
</g>
<!-- layer_13_qkv_gpu11&#45;&gt;layer_13_allgather_qkv -->
<g id="edge975" class="edge">
<title>layer_13_qkv_gpu11&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M3187.09,-4137.53C3194.19,-4128.38 3202.32,-4117.88 3209.92,-4108.08"/>
<polygon fill="black" stroke="black" points="3212.78,-4110.11 3216.14,-4100.06 3207.25,-4105.82 3212.78,-4110.11"/>
</g>
<!-- layer_13_qkv_gpu12&#45;&gt;layer_13_allgather_qkv -->
<g id="edge976" class="edge">
<title>layer_13_qkv_gpu12&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M3270.16,-4137.53C3265.64,-4128.97 3260.5,-4119.24 3255.62,-4110.01"/>
<polygon fill="black" stroke="black" points="3258.63,-4108.2 3250.86,-4101 3252.44,-4111.47 3258.63,-4108.2"/>
</g>
<!-- layer_13_qkv_gpu13&#45;&gt;layer_13_allgather_qkv -->
<g id="edge977" class="edge">
<title>layer_13_qkv_gpu13&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M3353.66,-4137.77C3331.73,-4125.79 3305.51,-4111.48 3283.44,-4099.43"/>
<polygon fill="black" stroke="black" points="3285.03,-4096.31 3274.57,-4094.59 3281.67,-4102.45 3285.03,-4096.31"/>
</g>
<!-- layer_13_qkv_gpu14&#45;&gt;layer_13_allgather_qkv -->
<g id="edge978" class="edge">
<title>layer_13_qkv_gpu14&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M3466.31,-4141.09C3463.34,-4139.94 3460.39,-4138.83 3457.5,-4137.79 3404.02,-4118.61 3341.74,-4100.99 3296.95,-4089.12"/>
<polygon fill="black" stroke="black" points="3297.66,-4085.68 3287.1,-4086.52 3295.88,-4092.45 3297.66,-4085.68"/>
</g>
<!-- layer_13_qkv_gpu15&#45;&gt;layer_13_allgather_qkv -->
<g id="edge979" class="edge">
<title>layer_13_qkv_gpu15&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M3582.42,-4140.77C3579.42,-4139.69 3576.44,-4138.69 3573.5,-4137.79 3481.29,-4109.54 3370.89,-4091.43 3302.21,-4081.93"/>
<polygon fill="black" stroke="black" points="3302.35,-4078.42 3291.97,-4080.53 3301.41,-4085.35 3302.35,-4078.42"/>
</g>
<!-- layer_13_attention -->
<g id="node585" class="node">
<title>layer_13_attention</title>
<polygon fill="lightblue" stroke="black" points="3270.5,-4007.81 3202.5,-4007.81 3202.5,-3955.81 3270.5,-3955.81 3270.5,-4007.81"/>
<text text-anchor="middle" x="3236.5" y="-3995.81" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="3236.5" y="-3984.81" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3236.5" y="-3973.81" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="3236.5" y="-3962.81" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_13_allgather_qkv&#45;&gt;layer_13_attention -->
<g id="edge980" class="edge">
<title>layer_13_allgather_qkv&#45;&gt;layer_13_attention</title>
<path fill="none" stroke="black" d="M3236.5,-4043.64C3236.5,-4035.54 3236.5,-4026.59 3236.5,-4018.1"/>
<polygon fill="black" stroke="black" points="3240,-4018.07 3236.5,-4008.07 3233,-4018.07 3240,-4018.07"/>
</g>
<!-- layer_13_attn_out_gpu8 -->
<g id="node586" class="node">
<title>layer_13_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2903,-3919.81 2810,-3919.81 2810,-3867.81 2903,-3867.81 2903,-3919.81"/>
<text text-anchor="middle" x="2856.5" y="-3907.81" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="2856.5" y="-3896.81" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2856.5" y="-3885.81" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2856.5" y="-3874.81" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attention&#45;&gt;layer_13_attn_out_gpu8 -->
<g id="edge981" class="edge">
<title>layer_13_attention&#45;&gt;layer_13_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M3202.28,-3977.04C3144.17,-3970.06 3022.62,-3953.01 2912.81,-3919.6"/>
<polygon fill="black" stroke="black" points="2913.83,-3916.25 2903.25,-3916.63 2911.76,-3922.93 2913.83,-3916.25"/>
</g>
<!-- layer_13_attn_out_gpu9 -->
<g id="node587" class="node">
<title>layer_13_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3014,-3919.81 2921,-3919.81 2921,-3867.81 3014,-3867.81 3014,-3919.81"/>
<text text-anchor="middle" x="2967.5" y="-3907.81" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="2967.5" y="-3896.81" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2967.5" y="-3885.81" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2967.5" y="-3874.81" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attention&#45;&gt;layer_13_attn_out_gpu9 -->
<g id="edge982" class="edge">
<title>layer_13_attention&#45;&gt;layer_13_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M3202.46,-3972.64C3160.01,-3962.1 3085.48,-3942.39 3023.5,-3919.81 3023.4,-3919.78 3023.31,-3919.74 3023.21,-3919.7"/>
<polygon fill="black" stroke="black" points="3024.64,-3916.5 3014.05,-3916.18 3022.13,-3923.04 3024.64,-3916.5"/>
</g>
<!-- layer_13_attn_out_gpu10 -->
<g id="node588" class="node">
<title>layer_13_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3125,-3919.81 3032,-3919.81 3032,-3867.81 3125,-3867.81 3125,-3919.81"/>
<text text-anchor="middle" x="3078.5" y="-3907.81" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="3078.5" y="-3896.81" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3078.5" y="-3885.81" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3078.5" y="-3874.81" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attention&#45;&gt;layer_13_attn_out_gpu10 -->
<g id="edge983" class="edge">
<title>layer_13_attention&#45;&gt;layer_13_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M3202.22,-3962.15C3182.19,-3951.25 3156.44,-3937.23 3133.62,-3924.81"/>
<polygon fill="black" stroke="black" points="3135.16,-3921.67 3124.71,-3919.96 3131.82,-3927.82 3135.16,-3921.67"/>
</g>
<!-- layer_13_attn_out_gpu11 -->
<g id="node589" class="node">
<title>layer_13_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3236,-3919.81 3143,-3919.81 3143,-3867.81 3236,-3867.81 3236,-3919.81"/>
<text text-anchor="middle" x="3189.5" y="-3907.81" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="3189.5" y="-3896.81" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3189.5" y="-3885.81" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3189.5" y="-3874.81" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attention&#45;&gt;layer_13_attn_out_gpu11 -->
<g id="edge984" class="edge">
<title>layer_13_attention&#45;&gt;layer_13_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M3222.65,-3955.47C3218.11,-3947.16 3212.99,-3937.79 3208.15,-3928.93"/>
<polygon fill="black" stroke="black" points="3211.12,-3927.06 3203.25,-3919.97 3204.97,-3930.42 3211.12,-3927.06"/>
</g>
<!-- layer_13_attn_out_gpu12 -->
<g id="node590" class="node">
<title>layer_13_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3347,-3919.81 3254,-3919.81 3254,-3867.81 3347,-3867.81 3347,-3919.81"/>
<text text-anchor="middle" x="3300.5" y="-3907.81" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="3300.5" y="-3896.81" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3300.5" y="-3885.81" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3300.5" y="-3874.81" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attention&#45;&gt;layer_13_attn_out_gpu12 -->
<g id="edge985" class="edge">
<title>layer_13_attention&#45;&gt;layer_13_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M3255.36,-3955.47C3261.74,-3946.9 3268.96,-3937.19 3275.73,-3928.1"/>
<polygon fill="black" stroke="black" points="3278.62,-3930.08 3281.78,-3919.97 3273,-3925.9 3278.62,-3930.08"/>
</g>
<!-- layer_13_attn_out_gpu13 -->
<g id="node591" class="node">
<title>layer_13_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3458,-3919.81 3365,-3919.81 3365,-3867.81 3458,-3867.81 3458,-3919.81"/>
<text text-anchor="middle" x="3411.5" y="-3907.81" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="3411.5" y="-3896.81" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3411.5" y="-3885.81" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3411.5" y="-3874.81" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attention&#45;&gt;layer_13_attn_out_gpu13 -->
<g id="edge986" class="edge">
<title>layer_13_attention&#45;&gt;layer_13_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M3270.66,-3964.02C3294.79,-3952.17 3327.67,-3936.01 3355.59,-3922.29"/>
<polygon fill="black" stroke="black" points="3357.42,-3925.29 3364.85,-3917.74 3354.33,-3919.01 3357.42,-3925.29"/>
</g>
<!-- layer_13_attn_out_gpu14 -->
<g id="node592" class="node">
<title>layer_13_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3569,-3919.81 3476,-3919.81 3476,-3867.81 3569,-3867.81 3569,-3919.81"/>
<text text-anchor="middle" x="3522.5" y="-3907.81" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="3522.5" y="-3896.81" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3522.5" y="-3885.81" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3522.5" y="-3874.81" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attention&#45;&gt;layer_13_attn_out_gpu14 -->
<g id="edge987" class="edge">
<title>layer_13_attention&#45;&gt;layer_13_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M3270.71,-3973.67C3314.42,-3964.15 3392.39,-3945.77 3466.44,-3919.98"/>
<polygon fill="black" stroke="black" points="3467.65,-3923.26 3475.91,-3916.63 3465.32,-3916.66 3467.65,-3923.26"/>
</g>
<!-- layer_13_attn_out_gpu15 -->
<g id="node593" class="node">
<title>layer_13_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3680,-3919.81 3587,-3919.81 3587,-3867.81 3680,-3867.81 3680,-3919.81"/>
<text text-anchor="middle" x="3633.5" y="-3907.81" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="3633.5" y="-3896.81" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3633.5" y="-3885.81" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3633.5" y="-3874.81" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attention&#45;&gt;layer_13_attn_out_gpu15 -->
<g id="edge988" class="edge">
<title>layer_13_attention&#45;&gt;layer_13_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M3270.66,-3977.58C3331.27,-3971.23 3461.42,-3954.86 3576.99,-3920"/>
<polygon fill="black" stroke="black" points="3578.17,-3923.3 3586.7,-3917.02 3576.11,-3916.61 3578.17,-3923.3"/>
</g>
<!-- layer_13_allreduce_attn -->
<g id="node594" class="node">
<title>layer_13_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="3300.5" cy="-3802.82" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="3300.5" y="-3811.32" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="3300.5" y="-3800.32" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="3300.5" y="-3789.32" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_13_attn_out_gpu8&#45;&gt;layer_13_allreduce_attn -->
<g id="edge989" class="edge">
<title>layer_13_attn_out_gpu8&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M2903.22,-3870.91C2906.33,-3869.78 2909.44,-3868.73 2912.5,-3867.81 3022.32,-3834.84 3155.06,-3817.59 3233.36,-3809.62"/>
<polygon fill="black" stroke="black" points="3233.97,-3813.08 3243.57,-3808.6 3233.27,-3806.11 3233.97,-3813.08"/>
</g>
<!-- layer_13_attn_out_gpu9&#45;&gt;layer_13_allreduce_attn -->
<g id="edge990" class="edge">
<title>layer_13_attn_out_gpu9&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M3014.29,-3871.13C3017.38,-3869.95 3020.47,-3868.83 3023.5,-3867.81 3094.91,-3843.87 3179.6,-3825.74 3236.37,-3814.99"/>
<polygon fill="black" stroke="black" points="3237.1,-3818.41 3246.29,-3813.13 3235.82,-3811.53 3237.1,-3818.41"/>
</g>
<!-- layer_13_attn_out_gpu10&#45;&gt;layer_13_allreduce_attn -->
<g id="edge991" class="edge">
<title>layer_13_attn_out_gpu10&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M3125.17,-3871.76C3128.32,-3870.4 3131.45,-3869.08 3134.5,-3867.81 3171.07,-3852.61 3212.66,-3836.58 3245.06,-3824.37"/>
<polygon fill="black" stroke="black" points="3246.67,-3827.5 3254.8,-3820.7 3244.21,-3820.95 3246.67,-3827.5"/>
</g>
<!-- layer_13_attn_out_gpu11&#45;&gt;layer_13_allreduce_attn -->
<g id="edge992" class="edge">
<title>layer_13_attn_out_gpu11&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M3220.72,-3867.78C3233.79,-3857.3 3249.11,-3845.02 3262.81,-3834.03"/>
<polygon fill="black" stroke="black" points="3265.05,-3836.72 3270.67,-3827.74 3260.67,-3831.26 3265.05,-3836.72"/>
</g>
<!-- layer_13_attn_out_gpu12&#45;&gt;layer_13_allreduce_attn -->
<g id="edge993" class="edge">
<title>layer_13_attn_out_gpu12&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M3300.5,-3867.55C3300.5,-3859.66 3300.5,-3850.77 3300.5,-3842.19"/>
<polygon fill="black" stroke="black" points="3304,-3841.96 3300.5,-3831.96 3297,-3841.96 3304,-3841.96"/>
</g>
<!-- layer_13_attn_out_gpu13&#45;&gt;layer_13_allreduce_attn -->
<g id="edge994" class="edge">
<title>layer_13_attn_out_gpu13&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M3380.28,-3867.78C3367.21,-3857.3 3351.89,-3845.02 3338.19,-3834.03"/>
<polygon fill="black" stroke="black" points="3340.33,-3831.26 3330.33,-3827.74 3335.95,-3836.72 3340.33,-3831.26"/>
</g>
<!-- layer_13_attn_out_gpu14&#45;&gt;layer_13_allreduce_attn -->
<g id="edge995" class="edge">
<title>layer_13_attn_out_gpu14&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M3475.78,-3871.34C3472.98,-3870.13 3470.21,-3868.94 3467.5,-3867.81 3430.61,-3852.38 3388.57,-3836.28 3355.9,-3824.09"/>
<polygon fill="black" stroke="black" points="3357.11,-3820.8 3346.52,-3820.59 3354.67,-3827.36 3357.11,-3820.8"/>
</g>
<!-- layer_13_attn_out_gpu15&#45;&gt;layer_13_allreduce_attn -->
<g id="edge996" class="edge">
<title>layer_13_attn_out_gpu15&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M3586.95,-3870.88C3584.11,-3869.79 3581.28,-3868.75 3578.5,-3867.81 3506.92,-3843.58 3421.9,-3825.5 3364.9,-3814.85"/>
<polygon fill="black" stroke="black" points="3365.41,-3811.38 3354.94,-3813.01 3364.14,-3818.27 3365.41,-3811.38"/>
</g>
<!-- layer_13_allreduce_attn&#45;&gt;layer_13_residual1 -->
<g id="edge997" class="edge">
<title>layer_13_allreduce_attn&#45;&gt;layer_13_residual1</title>
<path fill="none" stroke="black" d="M3342.77,-3782.55C3372.62,-3768.95 3413,-3750.54 3445.95,-3735.52"/>
<polygon fill="black" stroke="black" points="3447.82,-3738.51 3455.47,-3731.18 3444.92,-3732.14 3447.82,-3738.51"/>
</g>
<!-- layer_13_ln1 -->
<g id="node596" class="node">
<title>layer_13_ln1</title>
<polygon fill="lightblue" stroke="black" points="3327,-3641.83 3254,-3641.83 3254,-3600.83 3327,-3600.83 3327,-3641.83"/>
<text text-anchor="middle" x="3290.5" y="-3629.83" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="3290.5" y="-3618.83" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="3290.5" y="-3607.83" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_13_residual1&#45;&gt;layer_13_ln1 -->
<g id="edge999" class="edge">
<title>layer_13_residual1&#45;&gt;layer_13_ln1</title>
<path fill="none" stroke="black" d="M3430.85,-3677.75C3399.49,-3665.36 3363.88,-3651.3 3336.37,-3640.44"/>
<polygon fill="black" stroke="black" points="3337.59,-3637.16 3327,-3636.74 3335.02,-3643.67 3337.59,-3637.16"/>
</g>
<!-- layer_13_residual2 -->
<g id="node616" class="node">
<title>layer_13_residual2</title>
<polygon fill="lightyellow" stroke="black" points="3581.44,-3128.86 3459.05,-3128.86 3427.56,-3068.86 3549.95,-3068.86 3581.44,-3128.86"/>
<text text-anchor="middle" x="3504.5" y="-3101.86" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="3504.5" y="-3090.86" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_13_residual1&#45;&gt;layer_13_residual2 -->
<g id="edge1034" class="edge">
<title>layer_13_residual1&#45;&gt;layer_13_residual2</title>
<path fill="none" stroke="black" d="M3557.37,-3691.43C3621.03,-3669.25 3719.5,-3621.71 3719.5,-3539.83 3719.5,-3539.83 3719.5,-3539.83 3719.5,-3283.84 3719.5,-3212.47 3650.25,-3162.85 3590.35,-3133.28"/>
<polygon fill="black" stroke="black" points="3591.74,-3130.06 3581.21,-3128.88 3588.7,-3136.37 3591.74,-3130.06"/>
</g>
<!-- layer_13_mlp_fc1_gpu8 -->
<g id="node597" class="node">
<title>layer_13_mlp_fc1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2872,-3564.83 2773,-3564.83 2773,-3512.83 2872,-3512.83 2872,-3564.83"/>
<text text-anchor="middle" x="2822.5" y="-3552.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="2822.5" y="-3541.83" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2822.5" y="-3530.83" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2822.5" y="-3519.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu8 -->
<g id="edge1000" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu8</title>
<path fill="none" stroke="black" d="M3253.74,-3618.61C3182.94,-3614.61 3022.96,-3602.19 2881.76,-3564.56"/>
<polygon fill="black" stroke="black" points="2882.63,-3561.17 2872.06,-3561.92 2880.79,-3567.92 2882.63,-3561.17"/>
</g>
<!-- layer_13_mlp_fc1_gpu9 -->
<g id="node598" class="node">
<title>layer_13_mlp_fc1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2989,-3564.83 2890,-3564.83 2890,-3512.83 2989,-3512.83 2989,-3564.83"/>
<text text-anchor="middle" x="2939.5" y="-3552.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="2939.5" y="-3541.83" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2939.5" y="-3530.83" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2939.5" y="-3519.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu9 -->
<g id="edge1001" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu9</title>
<path fill="none" stroke="black" d="M3253.94,-3615.93C3199.85,-3608.86 3095.39,-3593.13 2998.74,-3564.62"/>
<polygon fill="black" stroke="black" points="2999.7,-3561.25 2989.12,-3561.73 2997.69,-3567.96 2999.7,-3561.25"/>
</g>
<!-- layer_13_mlp_fc1_gpu10 -->
<g id="node599" class="node">
<title>layer_13_mlp_fc1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3106,-3564.83 3007,-3564.83 3007,-3512.83 3106,-3512.83 3106,-3564.83"/>
<text text-anchor="middle" x="3056.5" y="-3552.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="3056.5" y="-3541.83" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3056.5" y="-3530.83" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3056.5" y="-3519.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu10 -->
<g id="edge1002" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu10</title>
<path fill="none" stroke="black" d="M3253.97,-3609.83C3220.35,-3599.93 3168.97,-3584.19 3115.85,-3564.83"/>
<polygon fill="black" stroke="black" points="3116.86,-3561.47 3106.26,-3561.3 3114.44,-3568.04 3116.86,-3561.47"/>
</g>
<!-- layer_13_mlp_fc1_gpu11 -->
<g id="node600" class="node">
<title>layer_13_mlp_fc1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3223,-3564.83 3124,-3564.83 3124,-3512.83 3223,-3512.83 3223,-3564.83"/>
<text text-anchor="middle" x="3173.5" y="-3552.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="3173.5" y="-3541.83" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3173.5" y="-3530.83" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3173.5" y="-3519.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu11 -->
<g id="edge1003" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu11</title>
<path fill="none" stroke="black" d="M3261.88,-3600.64C3248.87,-3591.69 3233.17,-3580.88 3218.63,-3570.88"/>
<polygon fill="black" stroke="black" points="3220.46,-3567.89 3210.24,-3565.1 3216.49,-3573.66 3220.46,-3567.89"/>
</g>
<!-- layer_13_mlp_fc1_gpu12 -->
<g id="node601" class="node">
<title>layer_13_mlp_fc1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3340,-3564.83 3241,-3564.83 3241,-3512.83 3340,-3512.83 3340,-3564.83"/>
<text text-anchor="middle" x="3290.5" y="-3552.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="3290.5" y="-3541.83" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3290.5" y="-3530.83" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3290.5" y="-3519.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu12 -->
<g id="edge1004" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu12</title>
<path fill="none" stroke="black" d="M3290.5,-3600.43C3290.5,-3592.82 3290.5,-3583.88 3290.5,-3575.25"/>
<polygon fill="black" stroke="black" points="3294,-3574.98 3290.5,-3564.98 3287,-3574.98 3294,-3574.98"/>
</g>
<!-- layer_13_mlp_fc1_gpu13 -->
<g id="node602" class="node">
<title>layer_13_mlp_fc1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3457,-3564.83 3358,-3564.83 3358,-3512.83 3457,-3512.83 3457,-3564.83"/>
<text text-anchor="middle" x="3407.5" y="-3552.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="3407.5" y="-3541.83" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3407.5" y="-3530.83" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3407.5" y="-3519.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu13 -->
<g id="edge1005" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu13</title>
<path fill="none" stroke="black" d="M3319.12,-3600.64C3332.13,-3591.69 3347.83,-3580.88 3362.37,-3570.88"/>
<polygon fill="black" stroke="black" points="3364.51,-3573.66 3370.76,-3565.1 3360.54,-3567.89 3364.51,-3573.66"/>
</g>
<!-- layer_13_mlp_fc1_gpu14 -->
<g id="node603" class="node">
<title>layer_13_mlp_fc1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3574,-3564.83 3475,-3564.83 3475,-3512.83 3574,-3512.83 3574,-3564.83"/>
<text text-anchor="middle" x="3524.5" y="-3552.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="3524.5" y="-3541.83" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3524.5" y="-3530.83" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3524.5" y="-3519.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu14 -->
<g id="edge1006" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu14</title>
<path fill="none" stroke="black" d="M3327.27,-3609.92C3361.1,-3600.08 3412.79,-3584.39 3465.46,-3565.09"/>
<polygon fill="black" stroke="black" points="3466.8,-3568.33 3474.96,-3561.57 3464.37,-3561.76 3466.8,-3568.33"/>
</g>
<!-- layer_13_mlp_fc1_gpu15 -->
<g id="node604" class="node">
<title>layer_13_mlp_fc1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3691,-3564.83 3592,-3564.83 3592,-3512.83 3691,-3512.83 3691,-3564.83"/>
<text text-anchor="middle" x="3641.5" y="-3552.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="3641.5" y="-3541.83" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3641.5" y="-3530.83" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3641.5" y="-3519.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu15 -->
<g id="edge1007" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu15</title>
<path fill="none" stroke="black" d="M3327.21,-3616.01C3381.46,-3609.06 3486.15,-3593.49 3581.94,-3565.06"/>
<polygon fill="black" stroke="black" points="3583.22,-3568.33 3591.77,-3562.09 3581.19,-3561.63 3583.22,-3568.33"/>
</g>
<!-- layer_13_allgather_mlp -->
<g id="node605" class="node">
<title>layer_13_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="3231.5" cy="-3447.84" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="3231.5" y="-3456.34" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="3231.5" y="-3445.34" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="3231.5" y="-3434.34" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_13_mlp_fc1_gpu8&#45;&gt;layer_13_allgather_mlp -->
<g id="edge1008" class="edge">
<title>layer_13_mlp_fc1_gpu8&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M2872.11,-3515.9C2875.26,-3514.79 2878.41,-3513.75 2881.5,-3512.83 2978.8,-3483.71 3095.48,-3465.6 3166.52,-3456.37"/>
<polygon fill="black" stroke="black" points="3167.19,-3459.81 3176.66,-3455.07 3166.3,-3452.87 3167.19,-3459.81"/>
</g>
<!-- layer_13_mlp_fc1_gpu9&#45;&gt;layer_13_allgather_mlp -->
<g id="edge1009" class="edge">
<title>layer_13_mlp_fc1_gpu9&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M2989.21,-3516.21C2992.34,-3515.03 2995.45,-3513.89 2998.5,-3512.83 3056.03,-3492.84 3123.24,-3474.94 3170.65,-3463.19"/>
<polygon fill="black" stroke="black" points="3171.58,-3466.57 3180.46,-3460.78 3169.91,-3459.77 3171.58,-3466.57"/>
</g>
<!-- layer_13_mlp_fc1_gpu10&#45;&gt;layer_13_allgather_mlp -->
<g id="edge1010" class="edge">
<title>layer_13_mlp_fc1_gpu10&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M3105.71,-3512.8C3129.92,-3500.49 3158.99,-3485.71 3183.08,-3473.46"/>
<polygon fill="black" stroke="black" points="3184.73,-3476.55 3192.05,-3468.9 3181.55,-3470.31 3184.73,-3476.55"/>
</g>
<!-- layer_13_mlp_fc1_gpu11&#45;&gt;layer_13_allgather_mlp -->
<g id="edge1011" class="edge">
<title>layer_13_mlp_fc1_gpu11&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M3189.97,-3512.56C3195.71,-3503.75 3202.27,-3493.69 3208.44,-3484.21"/>
<polygon fill="black" stroke="black" points="3211.45,-3486.01 3213.98,-3475.72 3205.59,-3482.18 3211.45,-3486.01"/>
</g>
<!-- layer_13_mlp_fc1_gpu12&#45;&gt;layer_13_allgather_mlp -->
<g id="edge1012" class="edge">
<title>layer_13_mlp_fc1_gpu12&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M3273.75,-3512.56C3267.86,-3503.67 3261.12,-3493.51 3254.78,-3483.96"/>
<polygon fill="black" stroke="black" points="3257.56,-3481.81 3249.11,-3475.4 3251.72,-3485.67 3257.56,-3481.81"/>
</g>
<!-- layer_13_mlp_fc1_gpu13&#45;&gt;layer_13_allgather_mlp -->
<g id="edge1013" class="edge">
<title>layer_13_mlp_fc1_gpu13&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M3358.01,-3512.8C3333.57,-3500.45 3304.21,-3485.6 3279.92,-3473.32"/>
<polygon fill="black" stroke="black" points="3281.39,-3470.14 3270.89,-3468.75 3278.23,-3476.39 3281.39,-3470.14"/>
</g>
<!-- layer_13_mlp_fc1_gpu14&#45;&gt;layer_13_allgather_mlp -->
<g id="edge1014" class="edge">
<title>layer_13_mlp_fc1_gpu14&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M3474.69,-3515.83C3471.93,-3514.78 3469.19,-3513.77 3466.5,-3512.83 3408.37,-3492.5 3340.32,-3474.59 3292.45,-3462.93"/>
<polygon fill="black" stroke="black" points="3293.1,-3459.48 3282.56,-3460.53 3291.45,-3466.28 3293.1,-3459.48"/>
</g>
<!-- layer_13_mlp_fc1_gpu15&#45;&gt;layer_13_allgather_mlp -->
<g id="edge1015" class="edge">
<title>layer_13_mlp_fc1_gpu15&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M3591.78,-3515.55C3589,-3514.57 3586.23,-3513.65 3583.5,-3512.83 3485.6,-3483.25 3368.02,-3465.25 3296.58,-3456.17"/>
<polygon fill="black" stroke="black" points="3296.73,-3452.66 3286.38,-3454.89 3295.87,-3459.61 3296.73,-3452.66"/>
</g>
<!-- layer_13_gelu -->
<g id="node606" class="node">
<title>layer_13_gelu</title>
<polygon fill="lightblue" stroke="black" points="3276,-3382.84 3187,-3382.84 3187,-3346.84 3276,-3346.84 3276,-3382.84"/>
<text text-anchor="middle" x="3231.5" y="-3367.84" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="3231.5" y="-3356.84" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_13_allgather_mlp&#45;&gt;layer_13_gelu -->
<g id="edge1016" class="edge">
<title>layer_13_allgather_mlp&#45;&gt;layer_13_gelu</title>
<path fill="none" stroke="black" d="M3231.5,-3418.51C3231.5,-3410.26 3231.5,-3401.27 3231.5,-3393.1"/>
<polygon fill="black" stroke="black" points="3235,-3392.94 3231.5,-3382.94 3228,-3392.94 3235,-3392.94"/>
</g>
<!-- layer_13_mlp_fc2_gpu8 -->
<g id="node607" class="node">
<title>layer_13_mlp_fc2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2872,-3310.84 2773,-3310.84 2773,-3258.84 2872,-3258.84 2872,-3310.84"/>
<text text-anchor="middle" x="2822.5" y="-3298.84" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="2822.5" y="-3287.84" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2822.5" y="-3276.84" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2822.5" y="-3265.84" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu8 -->
<g id="edge1017" class="edge">
<title>layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu8</title>
<path fill="none" stroke="black" d="M3186.82,-3360.68C3121.45,-3355.27 2996.05,-3341.93 2882.02,-3310.66"/>
<polygon fill="black" stroke="black" points="2882.65,-3307.21 2872.08,-3307.88 2880.76,-3313.95 2882.65,-3307.21"/>
</g>
<!-- layer_13_mlp_fc2_gpu9 -->
<g id="node608" class="node">
<title>layer_13_mlp_fc2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="2989,-3310.84 2890,-3310.84 2890,-3258.84 2989,-3258.84 2989,-3310.84"/>
<text text-anchor="middle" x="2939.5" y="-3298.84" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="2939.5" y="-3287.84" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2939.5" y="-3276.84" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2939.5" y="-3265.84" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu9 -->
<g id="edge1018" class="edge">
<title>layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu9</title>
<path fill="none" stroke="black" d="M3186.63,-3356.09C3141.37,-3347.72 3069.48,-3332.96 2999.08,-3310.79"/>
<polygon fill="black" stroke="black" points="2999.75,-3307.33 2989.16,-3307.62 2997.61,-3314 2999.75,-3307.33"/>
</g>
<!-- layer_13_mlp_fc2_gpu10 -->
<g id="node609" class="node">
<title>layer_13_mlp_fc2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3106,-3310.84 3007,-3310.84 3007,-3258.84 3106,-3258.84 3106,-3310.84"/>
<text text-anchor="middle" x="3056.5" y="-3298.84" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="3056.5" y="-3287.84" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3056.5" y="-3276.84" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3056.5" y="-3265.84" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu10 -->
<g id="edge1019" class="edge">
<title>layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu10</title>
<path fill="none" stroke="black" d="M3193.1,-3346.73C3170.33,-3336.58 3141.02,-3323.52 3115.39,-3312.09"/>
<polygon fill="black" stroke="black" points="3116.69,-3308.84 3106.13,-3307.97 3113.84,-3315.23 3116.69,-3308.84"/>
</g>
<!-- layer_13_mlp_fc2_gpu11 -->
<g id="node610" class="node">
<title>layer_13_mlp_fc2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3223,-3310.84 3124,-3310.84 3124,-3258.84 3223,-3258.84 3223,-3310.84"/>
<text text-anchor="middle" x="3173.5" y="-3298.84" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="3173.5" y="-3287.84" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3173.5" y="-3276.84" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3173.5" y="-3265.84" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu11 -->
<g id="edge1020" class="edge">
<title>layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu11</title>
<path fill="none" stroke="black" d="M3218.63,-3346.53C3212.64,-3338.48 3205.31,-3328.62 3198.3,-3319.2"/>
<polygon fill="black" stroke="black" points="3201.06,-3317.04 3192.28,-3311.1 3195.44,-3321.21 3201.06,-3317.04"/>
</g>
<!-- layer_13_mlp_fc2_gpu12 -->
<g id="node611" class="node">
<title>layer_13_mlp_fc2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3340,-3310.84 3241,-3310.84 3241,-3258.84 3340,-3258.84 3340,-3310.84"/>
<text text-anchor="middle" x="3290.5" y="-3298.84" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="3290.5" y="-3287.84" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3290.5" y="-3276.84" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3290.5" y="-3265.84" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu12 -->
<g id="edge1021" class="edge">
<title>layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu12</title>
<path fill="none" stroke="black" d="M3244.59,-3346.53C3250.69,-3338.48 3258.15,-3328.62 3265.27,-3319.2"/>
<polygon fill="black" stroke="black" points="3268.15,-3321.19 3271.4,-3311.1 3262.57,-3316.97 3268.15,-3321.19"/>
</g>
<!-- layer_13_mlp_fc2_gpu13 -->
<g id="node612" class="node">
<title>layer_13_mlp_fc2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3457,-3310.84 3358,-3310.84 3358,-3258.84 3457,-3258.84 3457,-3310.84"/>
<text text-anchor="middle" x="3407.5" y="-3298.84" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="3407.5" y="-3287.84" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3407.5" y="-3276.84" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3407.5" y="-3265.84" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu13 -->
<g id="edge1022" class="edge">
<title>layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu13</title>
<path fill="none" stroke="black" d="M3270.12,-3346.73C3293.1,-3336.54 3322.73,-3323.41 3348.58,-3311.96"/>
<polygon fill="black" stroke="black" points="3350.19,-3315.07 3357.91,-3307.82 3347.35,-3308.67 3350.19,-3315.07"/>
</g>
<!-- layer_13_mlp_fc2_gpu14 -->
<g id="node613" class="node">
<title>layer_13_mlp_fc2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3574,-3310.84 3475,-3310.84 3475,-3258.84 3574,-3258.84 3574,-3310.84"/>
<text text-anchor="middle" x="3524.5" y="-3298.84" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="3524.5" y="-3287.84" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3524.5" y="-3276.84" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3524.5" y="-3265.84" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu14 -->
<g id="edge1023" class="edge">
<title>layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu14</title>
<path fill="none" stroke="black" d="M3276.34,-3356.29C3321.98,-3348.04 3394.76,-3333.32 3464.87,-3311.17"/>
<polygon fill="black" stroke="black" points="3466.29,-3314.38 3474.74,-3307.99 3464.15,-3307.72 3466.29,-3314.38"/>
</g>
<!-- layer_13_mlp_fc2_gpu15 -->
<g id="node614" class="node">
<title>layer_13_mlp_fc2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3691,-3310.84 3592,-3310.84 3592,-3258.84 3691,-3258.84 3691,-3310.84"/>
<text text-anchor="middle" x="3641.5" y="-3298.84" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="3641.5" y="-3287.84" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3641.5" y="-3276.84" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3641.5" y="-3265.84" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu15 -->
<g id="edge1024" class="edge">
<title>layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu15</title>
<path fill="none" stroke="black" d="M3276.18,-3360.82C3341.87,-3355.57 3468.23,-3342.42 3581.91,-3311.02"/>
<polygon fill="black" stroke="black" points="3583.14,-3314.31 3591.81,-3308.23 3581.24,-3307.57 3583.14,-3314.31"/>
</g>
<!-- layer_13_allreduce_mlp -->
<g id="node615" class="node">
<title>layer_13_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="3290.5" cy="-3193.85" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="3290.5" y="-3202.35" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="3290.5" y="-3191.35" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="3290.5" y="-3180.35" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_13_mlp_fc2_gpu8&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge1025" class="edge">
<title>layer_13_mlp_fc2_gpu8&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2872.08,-3261.82C2875.24,-3260.74 2878.4,-3259.73 2881.5,-3258.84 2998.27,-3225.52 3139.05,-3208.31 3221.3,-3200.46"/>
<polygon fill="black" stroke="black" points="3221.64,-3203.94 3231.27,-3199.53 3220.99,-3196.97 3221.64,-3203.94"/>
</g>
<!-- layer_13_mlp_fc2_gpu9&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge1026" class="edge">
<title>layer_13_mlp_fc2_gpu9&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2989.15,-3262.04C2992.29,-3260.9 2995.43,-3259.82 2998.5,-3258.84 3074.35,-3234.69 3164.12,-3216.51 3223.91,-3205.82"/>
<polygon fill="black" stroke="black" points="3224.74,-3209.22 3233.98,-3204.03 3223.53,-3202.33 3224.74,-3209.22"/>
</g>
<!-- layer_13_mlp_fc2_gpu10&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge1027" class="edge">
<title>layer_13_mlp_fc2_gpu10&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3106,-3262.66C3109.21,-3261.35 3112.4,-3260.07 3115.5,-3258.84 3154.39,-3243.5 3198.62,-3227.34 3232.88,-3215.1"/>
<polygon fill="black" stroke="black" points="3234.48,-3218.25 3242.72,-3211.59 3232.13,-3211.65 3234.48,-3218.25"/>
</g>
<!-- layer_13_mlp_fc2_gpu11&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge1028" class="edge">
<title>layer_13_mlp_fc2_gpu11&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3206.4,-3258.82C3220.19,-3248.33 3236.34,-3236.05 3250.78,-3225.07"/>
<polygon fill="black" stroke="black" points="3253.21,-3227.61 3259.05,-3218.77 3248.97,-3222.04 3253.21,-3227.61"/>
</g>
<!-- layer_13_mlp_fc2_gpu12&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge1029" class="edge">
<title>layer_13_mlp_fc2_gpu12&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3290.5,-3258.58C3290.5,-3250.69 3290.5,-3241.8 3290.5,-3233.22"/>
<polygon fill="black" stroke="black" points="3294,-3233 3290.5,-3223 3287,-3233 3294,-3233"/>
</g>
<!-- layer_13_mlp_fc2_gpu13&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge1030" class="edge">
<title>layer_13_mlp_fc2_gpu13&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3374.6,-3258.82C3360.81,-3248.33 3344.66,-3236.05 3330.22,-3225.07"/>
<polygon fill="black" stroke="black" points="3332.03,-3222.04 3321.95,-3218.77 3327.79,-3227.61 3332.03,-3222.04"/>
</g>
<!-- layer_13_mlp_fc2_gpu14&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge1031" class="edge">
<title>layer_13_mlp_fc2_gpu14&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3474.91,-3262.24C3472.07,-3261.08 3469.25,-3259.94 3466.5,-3258.84 3427.28,-3243.28 3382.58,-3227.04 3348.05,-3214.82"/>
<polygon fill="black" stroke="black" points="3349.19,-3211.51 3338.59,-3211.49 3346.86,-3218.12 3349.19,-3211.51"/>
</g>
<!-- layer_13_mlp_fc2_gpu15&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge1032" class="edge">
<title>layer_13_mlp_fc2_gpu15&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3591.75,-3261.68C3588.98,-3260.67 3586.21,-3259.72 3583.5,-3258.84 3507.35,-3234.37 3417.09,-3216.23 3357.07,-3205.63"/>
<polygon fill="black" stroke="black" points="3357.42,-3202.14 3346.97,-3203.87 3356.22,-3209.03 3357.42,-3202.14"/>
</g>
<!-- layer_13_allreduce_mlp&#45;&gt;layer_13_residual2 -->
<g id="edge1033" class="edge">
<title>layer_13_allreduce_mlp&#45;&gt;layer_13_residual2</title>
<path fill="none" stroke="black" d="M3334.32,-3173.81C3366.43,-3159.86 3410.35,-3140.77 3445.53,-3125.48"/>
<polygon fill="black" stroke="black" points="3446.97,-3128.68 3454.74,-3121.48 3444.18,-3122.26 3446.97,-3128.68"/>
</g>
<!-- layer_13_ln2 -->
<g id="node617" class="node">
<title>layer_13_ln2</title>
<polygon fill="lightblue" stroke="black" points="3541,-3032.86 3468,-3032.86 3468,-2991.86 3541,-2991.86 3541,-3032.86"/>
<text text-anchor="middle" x="3504.5" y="-3020.86" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="3504.5" y="-3009.86" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="3504.5" y="-2998.86" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_13_residual2&#45;&gt;layer_13_ln2 -->
<g id="edge1035" class="edge">
<title>layer_13_residual2&#45;&gt;layer_13_ln2</title>
<path fill="none" stroke="black" d="M3504.5,-3068.78C3504.5,-3060.46 3504.5,-3051.37 3504.5,-3043.02"/>
<polygon fill="black" stroke="black" points="3508,-3042.93 3504.5,-3032.93 3501,-3042.93 3508,-3042.93"/>
</g>
<!-- layer_13_output_dist -->
<g id="node618" class="node">
<title>layer_13_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="3606.2,-2955.86 3444.42,-2955.86 3402.8,-2895.86 3564.58,-2895.86 3606.2,-2955.86"/>
<text text-anchor="middle" x="3504.5" y="-2928.86" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="3504.5" y="-2917.86" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_13_ln2&#45;&gt;layer_13_output_dist -->
<g id="edge1036" class="edge">
<title>layer_13_ln2&#45;&gt;layer_13_output_dist</title>
<path fill="none" stroke="black" d="M3504.5,-2991.76C3504.5,-2984.12 3504.5,-2975.08 3504.5,-2966.21"/>
<polygon fill="black" stroke="black" points="3508,-2965.97 3504.5,-2955.97 3501,-2965.97 3508,-2965.97"/>
</g>
<!-- layer_14_input_dist -->
<g id="node619" class="node">
<title>layer_14_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="3598.69,-2859.86 3448.86,-2859.86 3410.31,-2799.86 3560.14,-2799.86 3598.69,-2859.86"/>
<text text-anchor="middle" x="3504.5" y="-2832.86" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="3504.5" y="-2821.86" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_13_output_dist&#45;&gt;layer_14_input_dist -->
<g id="edge1037" class="edge">
<title>layer_13_output_dist&#45;&gt;layer_14_input_dist</title>
<path fill="none" stroke="black" d="M3504.5,-2895.64C3504.5,-2887.59 3504.5,-2878.73 3504.5,-2870.21"/>
<polygon fill="black" stroke="black" points="3508,-2870.07 3504.5,-2860.07 3501,-2870.07 3508,-2870.07"/>
</g>
<!-- layer_14_qkv_gpu8 -->
<g id="node620" class="node">
<title>layer_14_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3089.5,-2763.86 2991.5,-2763.86 2991.5,-2711.86 3089.5,-2711.86 3089.5,-2763.86"/>
<text text-anchor="middle" x="3040.5" y="-2751.86" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="3040.5" y="-2740.86" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3040.5" y="-2729.86" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3040.5" y="-2718.86" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu8 -->
<g id="edge1038" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu8</title>
<path fill="none" stroke="black" d="M3424.24,-2821.94C3343.67,-2813.66 3216.23,-2796.94 3099.38,-2763.82"/>
<polygon fill="black" stroke="black" points="3100.13,-2760.4 3089.55,-2760.99 3098.19,-2767.12 3100.13,-2760.4"/>
</g>
<!-- layer_14_qkv_gpu9 -->
<g id="node621" class="node">
<title>layer_14_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3205.5,-2763.86 3107.5,-2763.86 3107.5,-2711.86 3205.5,-2711.86 3205.5,-2763.86"/>
<text text-anchor="middle" x="3156.5" y="-2751.86" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="3156.5" y="-2740.86" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3156.5" y="-2729.86" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3156.5" y="-2718.86" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu9 -->
<g id="edge1039" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu9</title>
<path fill="none" stroke="black" d="M3419.31,-2814.11C3363.43,-2803.43 3288.84,-2787.26 3215.49,-2763.96"/>
<polygon fill="black" stroke="black" points="3216.21,-2760.51 3205.62,-2760.78 3214.06,-2767.17 3216.21,-2760.51"/>
</g>
<!-- layer_14_qkv_gpu10 -->
<g id="node622" class="node">
<title>layer_14_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3321.5,-2763.86 3223.5,-2763.86 3223.5,-2711.86 3321.5,-2711.86 3321.5,-2763.86"/>
<text text-anchor="middle" x="3272.5" y="-2751.86" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="3272.5" y="-2740.86" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3272.5" y="-2729.86" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3272.5" y="-2718.86" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu10 -->
<g id="edge1040" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu10</title>
<path fill="none" stroke="black" d="M3424.05,-2799.75C3396.93,-2789.71 3366.36,-2778.15 3331.3,-2764.12"/>
<polygon fill="black" stroke="black" points="3332.38,-2760.79 3321.79,-2760.31 3329.77,-2767.28 3332.38,-2760.79"/>
</g>
<!-- layer_14_qkv_gpu11 -->
<g id="node623" class="node">
<title>layer_14_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3437.5,-2763.86 3339.5,-2763.86 3339.5,-2711.86 3437.5,-2711.86 3437.5,-2763.86"/>
<text text-anchor="middle" x="3388.5" y="-2751.86" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="3388.5" y="-2740.86" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3388.5" y="-2729.86" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3388.5" y="-2718.86" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu11 -->
<g id="edge1041" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu11</title>
<path fill="none" stroke="black" d="M3466.84,-2799.64C3454.68,-2790.21 3441.16,-2779.72 3428.82,-2770.15"/>
<polygon fill="black" stroke="black" points="3430.96,-2767.37 3420.91,-2764.01 3426.66,-2772.9 3430.96,-2767.37"/>
</g>
<!-- layer_14_qkv_gpu12 -->
<g id="node624" class="node">
<title>layer_14_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3553.5,-2763.86 3455.5,-2763.86 3455.5,-2711.86 3553.5,-2711.86 3553.5,-2763.86"/>
<text text-anchor="middle" x="3504.5" y="-2751.86" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="3504.5" y="-2740.86" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3504.5" y="-2729.86" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3504.5" y="-2718.86" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu12 -->
<g id="edge1042" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu12</title>
<path fill="none" stroke="black" d="M3504.5,-2799.39C3504.5,-2791.32 3504.5,-2782.48 3504.5,-2774.12"/>
<polygon fill="black" stroke="black" points="3508,-2773.87 3504.5,-2763.87 3501,-2773.87 3508,-2773.87"/>
</g>
<!-- layer_14_qkv_gpu13 -->
<g id="node625" class="node">
<title>layer_14_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3669.5,-2763.86 3571.5,-2763.86 3571.5,-2711.86 3669.5,-2711.86 3669.5,-2763.86"/>
<text text-anchor="middle" x="3620.5" y="-2751.86" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="3620.5" y="-2740.86" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3620.5" y="-2729.86" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3620.5" y="-2718.86" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu13 -->
<g id="edge1043" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu13</title>
<path fill="none" stroke="black" d="M3542.16,-2799.64C3554.32,-2790.21 3567.84,-2779.72 3580.18,-2770.15"/>
<polygon fill="black" stroke="black" points="3582.34,-2772.9 3588.09,-2764.01 3578.04,-2767.37 3582.34,-2772.9"/>
</g>
<!-- layer_14_qkv_gpu14 -->
<g id="node626" class="node">
<title>layer_14_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3785.5,-2763.86 3687.5,-2763.86 3687.5,-2711.86 3785.5,-2711.86 3785.5,-2763.86"/>
<text text-anchor="middle" x="3736.5" y="-2751.86" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="3736.5" y="-2740.86" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3736.5" y="-2729.86" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3736.5" y="-2718.86" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu14 -->
<g id="edge1044" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu14</title>
<path fill="none" stroke="black" d="M3565.18,-2807.03C3596.44,-2795.59 3635.35,-2781.05 3677.81,-2764.08"/>
<polygon fill="black" stroke="black" points="3679.23,-2767.28 3687.21,-2760.31 3676.62,-2760.78 3679.23,-2767.28"/>
</g>
<!-- layer_14_qkv_gpu15 -->
<g id="node627" class="node">
<title>layer_14_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3901.5,-2763.86 3803.5,-2763.86 3803.5,-2711.86 3901.5,-2711.86 3901.5,-2763.86"/>
<text text-anchor="middle" x="3852.5" y="-2751.86" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="3852.5" y="-2740.86" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3852.5" y="-2729.86" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3852.5" y="-2718.86" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu15 -->
<g id="edge1045" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu15</title>
<path fill="none" stroke="black" d="M3571.68,-2817.49C3628.75,-2806.99 3712.78,-2789.57 3793.55,-2763.94"/>
<polygon fill="black" stroke="black" points="3794.93,-2767.17 3803.38,-2760.78 3792.79,-2760.51 3794.93,-2767.17"/>
</g>
<!-- layer_14_residual1 -->
<g id="node639" class="node">
<title>layer_14_residual1</title>
<polygon fill="lightyellow" stroke="black" points="3802.44,-2311.9 3680.05,-2311.9 3648.56,-2251.9 3770.95,-2251.9 3802.44,-2311.9"/>
<text text-anchor="middle" x="3725.5" y="-2284.9" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="3725.5" y="-2273.9" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_residual1 -->
<g id="edge1072" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_residual1</title>
<path fill="none" stroke="black" d="M3577.7,-2827.1C3681.74,-2823 3864.86,-2809.33 3910.5,-2763.86 3947.51,-2726.99 3929.5,-2700.11 3929.5,-2647.87 3929.5,-2647.87 3929.5,-2647.87 3929.5,-2466.88 3929.5,-2396.94 3862.55,-2346.75 3805.36,-2316.64"/>
<polygon fill="black" stroke="black" points="3806.77,-2313.43 3796.28,-2311.98 3803.58,-2319.66 3806.77,-2313.43"/>
</g>
<!-- layer_14_allgather_qkv -->
<g id="node628" class="node">
<title>layer_14_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="3457.5" cy="-2646.87" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="3457.5" y="-2655.37" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="3457.5" y="-2644.37" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="3457.5" y="-2633.37" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_14_qkv_gpu8&#45;&gt;layer_14_allgather_qkv -->
<g id="edge1046" class="edge">
<title>layer_14_qkv_gpu8&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M3089.57,-2714.79C3092.57,-2713.73 3095.56,-2712.74 3098.5,-2711.86 3198.69,-2681.78 3319.1,-2663.87 3391.89,-2654.96"/>
<polygon fill="black" stroke="black" points="3392.33,-2658.43 3401.84,-2653.76 3391.49,-2651.48 3392.33,-2658.43"/>
</g>
<!-- layer_14_qkv_gpu9&#45;&gt;layer_14_allgather_qkv -->
<g id="edge1047" class="edge">
<title>layer_14_qkv_gpu9&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M3205.66,-2715.08C3208.64,-2713.94 3211.6,-2712.86 3214.5,-2711.86 3274.88,-2691.03 3345.68,-2673.09 3395.23,-2661.56"/>
<polygon fill="black" stroke="black" points="3396.2,-2664.93 3405.16,-2659.27 3394.63,-2658.1 3396.2,-2664.93"/>
</g>
<!-- layer_14_qkv_gpu10&#45;&gt;layer_14_allgather_qkv -->
<g id="edge1048" class="edge">
<title>layer_14_qkv_gpu10&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M3321.59,-2713.25C3348.21,-2700.44 3381.03,-2684.65 3407.75,-2671.8"/>
<polygon fill="black" stroke="black" points="3409.44,-2674.87 3416.93,-2667.39 3406.4,-2668.57 3409.44,-2674.87"/>
</g>
<!-- layer_14_qkv_gpu11&#45;&gt;layer_14_allgather_qkv -->
<g id="edge1049" class="edge">
<title>layer_14_qkv_gpu11&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M3408.09,-2711.6C3415.19,-2702.45 3423.32,-2691.95 3430.92,-2682.15"/>
<polygon fill="black" stroke="black" points="3433.78,-2684.17 3437.14,-2674.13 3428.25,-2679.89 3433.78,-2684.17"/>
</g>
<!-- layer_14_qkv_gpu12&#45;&gt;layer_14_allgather_qkv -->
<g id="edge1050" class="edge">
<title>layer_14_qkv_gpu12&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M3491.16,-2711.6C3486.64,-2703.04 3481.5,-2693.31 3476.62,-2684.08"/>
<polygon fill="black" stroke="black" points="3479.63,-2682.27 3471.86,-2675.07 3473.44,-2685.54 3479.63,-2682.27"/>
</g>
<!-- layer_14_qkv_gpu13&#45;&gt;layer_14_allgather_qkv -->
<g id="edge1051" class="edge">
<title>layer_14_qkv_gpu13&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M3574.66,-2711.84C3552.73,-2699.86 3526.51,-2685.55 3504.44,-2673.5"/>
<polygon fill="black" stroke="black" points="3506.03,-2670.38 3495.57,-2668.66 3502.67,-2676.52 3506.03,-2670.38"/>
</g>
<!-- layer_14_qkv_gpu14&#45;&gt;layer_14_allgather_qkv -->
<g id="edge1052" class="edge">
<title>layer_14_qkv_gpu14&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M3687.31,-2715.16C3684.34,-2714.01 3681.39,-2712.9 3678.5,-2711.86 3625.02,-2692.68 3562.74,-2675.06 3517.95,-2663.18"/>
<polygon fill="black" stroke="black" points="3518.66,-2659.75 3508.1,-2660.59 3516.88,-2666.52 3518.66,-2659.75"/>
</g>
<!-- layer_14_qkv_gpu15&#45;&gt;layer_14_allgather_qkv -->
<g id="edge1053" class="edge">
<title>layer_14_qkv_gpu15&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M3803.42,-2714.83C3800.42,-2713.76 3797.44,-2712.76 3794.5,-2711.86 3702.29,-2683.61 3591.89,-2665.5 3523.21,-2656"/>
<polygon fill="black" stroke="black" points="3523.35,-2652.48 3512.97,-2654.6 3522.41,-2659.42 3523.35,-2652.48"/>
</g>
<!-- layer_14_attention -->
<g id="node629" class="node">
<title>layer_14_attention</title>
<polygon fill="lightblue" stroke="black" points="3491.5,-2581.88 3423.5,-2581.88 3423.5,-2529.88 3491.5,-2529.88 3491.5,-2581.88"/>
<text text-anchor="middle" x="3457.5" y="-2569.88" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="3457.5" y="-2558.88" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3457.5" y="-2547.88" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="3457.5" y="-2536.88" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_14_allgather_qkv&#45;&gt;layer_14_attention -->
<g id="edge1054" class="edge">
<title>layer_14_allgather_qkv&#45;&gt;layer_14_attention</title>
<path fill="none" stroke="black" d="M3457.5,-2617.71C3457.5,-2609.6 3457.5,-2600.65 3457.5,-2592.17"/>
<polygon fill="black" stroke="black" points="3461,-2592.14 3457.5,-2582.14 3454,-2592.14 3461,-2592.14"/>
</g>
<!-- layer_14_attn_out_gpu8 -->
<g id="node630" class="node">
<title>layer_14_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3124,-2493.88 3031,-2493.88 3031,-2441.88 3124,-2441.88 3124,-2493.88"/>
<text text-anchor="middle" x="3077.5" y="-2481.88" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="3077.5" y="-2470.88" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3077.5" y="-2459.88" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3077.5" y="-2448.88" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attention&#45;&gt;layer_14_attn_out_gpu8 -->
<g id="edge1055" class="edge">
<title>layer_14_attention&#45;&gt;layer_14_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M3423.28,-2551.11C3365.17,-2544.13 3243.62,-2527.07 3133.81,-2493.66"/>
<polygon fill="black" stroke="black" points="3134.83,-2490.32 3124.25,-2490.7 3132.76,-2497 3134.83,-2490.32"/>
</g>
<!-- layer_14_attn_out_gpu9 -->
<g id="node631" class="node">
<title>layer_14_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3235,-2493.88 3142,-2493.88 3142,-2441.88 3235,-2441.88 3235,-2493.88"/>
<text text-anchor="middle" x="3188.5" y="-2481.88" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="3188.5" y="-2470.88" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3188.5" y="-2459.88" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3188.5" y="-2448.88" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attention&#45;&gt;layer_14_attn_out_gpu9 -->
<g id="edge1056" class="edge">
<title>layer_14_attention&#45;&gt;layer_14_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M3423.46,-2546.71C3381.01,-2536.16 3306.48,-2516.46 3244.5,-2493.88 3244.4,-2493.84 3244.31,-2493.81 3244.21,-2493.77"/>
<polygon fill="black" stroke="black" points="3245.64,-2490.57 3235.05,-2490.25 3243.13,-2497.11 3245.64,-2490.57"/>
</g>
<!-- layer_14_attn_out_gpu10 -->
<g id="node632" class="node">
<title>layer_14_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3346,-2493.88 3253,-2493.88 3253,-2441.88 3346,-2441.88 3346,-2493.88"/>
<text text-anchor="middle" x="3299.5" y="-2481.88" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="3299.5" y="-2470.88" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3299.5" y="-2459.88" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3299.5" y="-2448.88" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attention&#45;&gt;layer_14_attn_out_gpu10 -->
<g id="edge1057" class="edge">
<title>layer_14_attention&#45;&gt;layer_14_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M3423.22,-2536.22C3403.19,-2525.32 3377.44,-2511.3 3354.62,-2498.88"/>
<polygon fill="black" stroke="black" points="3356.16,-2495.74 3345.71,-2494.03 3352.82,-2501.89 3356.16,-2495.74"/>
</g>
<!-- layer_14_attn_out_gpu11 -->
<g id="node633" class="node">
<title>layer_14_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3457,-2493.88 3364,-2493.88 3364,-2441.88 3457,-2441.88 3457,-2493.88"/>
<text text-anchor="middle" x="3410.5" y="-2481.88" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="3410.5" y="-2470.88" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3410.5" y="-2459.88" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3410.5" y="-2448.88" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attention&#45;&gt;layer_14_attn_out_gpu11 -->
<g id="edge1058" class="edge">
<title>layer_14_attention&#45;&gt;layer_14_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M3443.65,-2529.54C3439.11,-2521.23 3433.99,-2511.85 3429.15,-2503"/>
<polygon fill="black" stroke="black" points="3432.12,-2501.13 3424.25,-2494.04 3425.97,-2504.49 3432.12,-2501.13"/>
</g>
<!-- layer_14_attn_out_gpu12 -->
<g id="node634" class="node">
<title>layer_14_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3568,-2493.88 3475,-2493.88 3475,-2441.88 3568,-2441.88 3568,-2493.88"/>
<text text-anchor="middle" x="3521.5" y="-2481.88" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="3521.5" y="-2470.88" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3521.5" y="-2459.88" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3521.5" y="-2448.88" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attention&#45;&gt;layer_14_attn_out_gpu12 -->
<g id="edge1059" class="edge">
<title>layer_14_attention&#45;&gt;layer_14_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M3476.36,-2529.54C3482.74,-2520.97 3489.96,-2511.26 3496.73,-2502.17"/>
<polygon fill="black" stroke="black" points="3499.62,-2504.15 3502.78,-2494.04 3494,-2499.97 3499.62,-2504.15"/>
</g>
<!-- layer_14_attn_out_gpu13 -->
<g id="node635" class="node">
<title>layer_14_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3679,-2493.88 3586,-2493.88 3586,-2441.88 3679,-2441.88 3679,-2493.88"/>
<text text-anchor="middle" x="3632.5" y="-2481.88" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="3632.5" y="-2470.88" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3632.5" y="-2459.88" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3632.5" y="-2448.88" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attention&#45;&gt;layer_14_attn_out_gpu13 -->
<g id="edge1060" class="edge">
<title>layer_14_attention&#45;&gt;layer_14_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M3491.66,-2538.09C3515.79,-2526.24 3548.67,-2510.08 3576.59,-2496.36"/>
<polygon fill="black" stroke="black" points="3578.42,-2499.36 3585.85,-2491.8 3575.33,-2493.07 3578.42,-2499.36"/>
</g>
<!-- layer_14_attn_out_gpu14 -->
<g id="node636" class="node">
<title>layer_14_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3790,-2493.88 3697,-2493.88 3697,-2441.88 3790,-2441.88 3790,-2493.88"/>
<text text-anchor="middle" x="3743.5" y="-2481.88" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="3743.5" y="-2470.88" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3743.5" y="-2459.88" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3743.5" y="-2448.88" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attention&#45;&gt;layer_14_attn_out_gpu14 -->
<g id="edge1061" class="edge">
<title>layer_14_attention&#45;&gt;layer_14_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M3491.71,-2547.74C3535.42,-2538.21 3613.39,-2519.84 3687.44,-2494.05"/>
<polygon fill="black" stroke="black" points="3688.65,-2497.33 3696.91,-2490.7 3686.32,-2490.73 3688.65,-2497.33"/>
</g>
<!-- layer_14_attn_out_gpu15 -->
<g id="node637" class="node">
<title>layer_14_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3901,-2493.88 3808,-2493.88 3808,-2441.88 3901,-2441.88 3901,-2493.88"/>
<text text-anchor="middle" x="3854.5" y="-2481.88" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="3854.5" y="-2470.88" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3854.5" y="-2459.88" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3854.5" y="-2448.88" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attention&#45;&gt;layer_14_attn_out_gpu15 -->
<g id="edge1062" class="edge">
<title>layer_14_attention&#45;&gt;layer_14_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M3491.66,-2551.64C3552.27,-2545.3 3682.42,-2528.93 3797.99,-2494.07"/>
<polygon fill="black" stroke="black" points="3799.17,-2497.37 3807.7,-2491.08 3797.11,-2490.68 3799.17,-2497.37"/>
</g>
<!-- layer_14_allreduce_attn -->
<g id="node638" class="node">
<title>layer_14_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="3521.5" cy="-2376.89" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="3521.5" y="-2385.39" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="3521.5" y="-2374.39" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="3521.5" y="-2363.39" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_14_attn_out_gpu8&#45;&gt;layer_14_allreduce_attn -->
<g id="edge1063" class="edge">
<title>layer_14_attn_out_gpu8&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M3124.22,-2444.98C3127.33,-2443.84 3130.44,-2442.8 3133.5,-2441.88 3243.32,-2408.91 3376.06,-2391.65 3454.36,-2383.69"/>
<polygon fill="black" stroke="black" points="3454.97,-2387.15 3464.57,-2382.67 3454.27,-2380.18 3454.97,-2387.15"/>
</g>
<!-- layer_14_attn_out_gpu9&#45;&gt;layer_14_allreduce_attn -->
<g id="edge1064" class="edge">
<title>layer_14_attn_out_gpu9&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M3235.29,-2445.2C3238.38,-2444.02 3241.47,-2442.89 3244.5,-2441.88 3315.91,-2417.94 3400.6,-2399.81 3457.37,-2389.06"/>
<polygon fill="black" stroke="black" points="3458.1,-2392.48 3467.29,-2387.2 3456.82,-2385.6 3458.1,-2392.48"/>
</g>
<!-- layer_14_attn_out_gpu10&#45;&gt;layer_14_allreduce_attn -->
<g id="edge1065" class="edge">
<title>layer_14_attn_out_gpu10&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M3346.17,-2445.83C3349.32,-2444.47 3352.45,-2443.15 3355.5,-2441.88 3392.07,-2426.68 3433.66,-2410.65 3466.06,-2398.44"/>
<polygon fill="black" stroke="black" points="3467.67,-2401.57 3475.8,-2394.77 3465.21,-2395.02 3467.67,-2401.57"/>
</g>
<!-- layer_14_attn_out_gpu11&#45;&gt;layer_14_allreduce_attn -->
<g id="edge1066" class="edge">
<title>layer_14_attn_out_gpu11&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M3441.72,-2441.85C3454.79,-2431.37 3470.11,-2419.08 3483.81,-2408.1"/>
<polygon fill="black" stroke="black" points="3486.05,-2410.79 3491.67,-2401.81 3481.67,-2405.33 3486.05,-2410.79"/>
</g>
<!-- layer_14_attn_out_gpu12&#45;&gt;layer_14_allreduce_attn -->
<g id="edge1067" class="edge">
<title>layer_14_attn_out_gpu12&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M3521.5,-2441.62C3521.5,-2433.72 3521.5,-2424.83 3521.5,-2416.25"/>
<polygon fill="black" stroke="black" points="3525,-2416.03 3521.5,-2406.03 3518,-2416.03 3525,-2416.03"/>
</g>
<!-- layer_14_attn_out_gpu13&#45;&gt;layer_14_allreduce_attn -->
<g id="edge1068" class="edge">
<title>layer_14_attn_out_gpu13&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M3601.28,-2441.85C3588.21,-2431.37 3572.89,-2419.08 3559.19,-2408.1"/>
<polygon fill="black" stroke="black" points="3561.33,-2405.33 3551.33,-2401.81 3556.95,-2410.79 3561.33,-2405.33"/>
</g>
<!-- layer_14_attn_out_gpu14&#45;&gt;layer_14_allreduce_attn -->
<g id="edge1069" class="edge">
<title>layer_14_attn_out_gpu14&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M3696.78,-2445.41C3693.98,-2444.2 3691.21,-2443.01 3688.5,-2441.88 3651.61,-2426.45 3609.57,-2410.34 3576.9,-2398.15"/>
<polygon fill="black" stroke="black" points="3578.11,-2394.87 3567.52,-2394.66 3575.67,-2401.43 3578.11,-2394.87"/>
</g>
<!-- layer_14_attn_out_gpu15&#45;&gt;layer_14_allreduce_attn -->
<g id="edge1070" class="edge">
<title>layer_14_attn_out_gpu15&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M3807.95,-2444.95C3805.11,-2443.86 3802.28,-2442.82 3799.5,-2441.88 3727.92,-2417.65 3642.9,-2399.57 3585.9,-2388.91"/>
<polygon fill="black" stroke="black" points="3586.41,-2385.45 3575.94,-2387.08 3585.14,-2392.33 3586.41,-2385.45"/>
</g>
<!-- layer_14_allreduce_attn&#45;&gt;layer_14_residual1 -->
<g id="edge1071" class="edge">
<title>layer_14_allreduce_attn&#45;&gt;layer_14_residual1</title>
<path fill="none" stroke="black" d="M3563.77,-2356.62C3593.62,-2343.01 3634,-2324.61 3666.95,-2309.59"/>
<polygon fill="black" stroke="black" points="3668.82,-2312.58 3676.47,-2305.25 3665.92,-2306.21 3668.82,-2312.58"/>
</g>
<!-- layer_14_ln1 -->
<g id="node640" class="node">
<title>layer_14_ln1</title>
<polygon fill="lightblue" stroke="black" points="3548,-2215.9 3475,-2215.9 3475,-2174.9 3548,-2174.9 3548,-2215.9"/>
<text text-anchor="middle" x="3511.5" y="-2203.9" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="3511.5" y="-2192.9" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="3511.5" y="-2181.9" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_14_residual1&#45;&gt;layer_14_ln1 -->
<g id="edge1073" class="edge">
<title>layer_14_residual1&#45;&gt;layer_14_ln1</title>
<path fill="none" stroke="black" d="M3651.85,-2251.82C3620.49,-2239.43 3584.88,-2225.37 3557.37,-2214.51"/>
<polygon fill="black" stroke="black" points="3558.59,-2211.23 3548,-2210.81 3556.02,-2217.74 3558.59,-2211.23"/>
</g>
<!-- layer_14_residual2 -->
<g id="node660" class="node">
<title>layer_14_residual2</title>
<polygon fill="lightyellow" stroke="black" points="3802.44,-1702.93 3680.05,-1702.93 3648.56,-1642.93 3770.95,-1642.93 3802.44,-1702.93"/>
<text text-anchor="middle" x="3725.5" y="-1675.93" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="3725.5" y="-1664.93" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_14_residual1&#45;&gt;layer_14_residual2 -->
<g id="edge1108" class="edge">
<title>layer_14_residual1&#45;&gt;layer_14_residual2</title>
<path fill="none" stroke="black" d="M3778.37,-2265.5C3842.03,-2243.32 3940.5,-2195.78 3940.5,-2113.9 3940.5,-2113.9 3940.5,-2113.9 3940.5,-1857.91 3940.5,-1786.54 3871.25,-1736.92 3811.35,-1707.35"/>
<polygon fill="black" stroke="black" points="3812.74,-1704.13 3802.21,-1702.95 3809.7,-1710.44 3812.74,-1704.13"/>
</g>
<!-- layer_14_mlp_fc1_gpu8 -->
<g id="node641" class="node">
<title>layer_14_mlp_fc1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3093,-2138.9 2994,-2138.9 2994,-2086.9 3093,-2086.9 3093,-2138.9"/>
<text text-anchor="middle" x="3043.5" y="-2126.9" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="3043.5" y="-2115.9" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3043.5" y="-2104.9" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3043.5" y="-2093.9" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu8 -->
<g id="edge1074" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu8</title>
<path fill="none" stroke="black" d="M3474.74,-2192.68C3403.94,-2188.68 3243.96,-2176.26 3102.76,-2138.63"/>
<polygon fill="black" stroke="black" points="3103.63,-2135.24 3093.06,-2135.99 3101.79,-2141.99 3103.63,-2135.24"/>
</g>
<!-- layer_14_mlp_fc1_gpu9 -->
<g id="node642" class="node">
<title>layer_14_mlp_fc1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3210,-2138.9 3111,-2138.9 3111,-2086.9 3210,-2086.9 3210,-2138.9"/>
<text text-anchor="middle" x="3160.5" y="-2126.9" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="3160.5" y="-2115.9" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3160.5" y="-2104.9" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3160.5" y="-2093.9" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu9 -->
<g id="edge1075" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu9</title>
<path fill="none" stroke="black" d="M3474.94,-2189.99C3420.85,-2182.93 3316.39,-2167.2 3219.74,-2138.69"/>
<polygon fill="black" stroke="black" points="3220.7,-2135.32 3210.12,-2135.8 3218.69,-2142.03 3220.7,-2135.32"/>
</g>
<!-- layer_14_mlp_fc1_gpu10 -->
<g id="node643" class="node">
<title>layer_14_mlp_fc1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3327,-2138.9 3228,-2138.9 3228,-2086.9 3327,-2086.9 3327,-2138.9"/>
<text text-anchor="middle" x="3277.5" y="-2126.9" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="3277.5" y="-2115.9" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3277.5" y="-2104.9" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3277.5" y="-2093.9" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu10 -->
<g id="edge1076" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu10</title>
<path fill="none" stroke="black" d="M3474.97,-2183.9C3441.35,-2174 3389.97,-2158.26 3336.85,-2138.9"/>
<polygon fill="black" stroke="black" points="3337.86,-2135.54 3327.26,-2135.37 3335.44,-2142.11 3337.86,-2135.54"/>
</g>
<!-- layer_14_mlp_fc1_gpu11 -->
<g id="node644" class="node">
<title>layer_14_mlp_fc1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3444,-2138.9 3345,-2138.9 3345,-2086.9 3444,-2086.9 3444,-2138.9"/>
<text text-anchor="middle" x="3394.5" y="-2126.9" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="3394.5" y="-2115.9" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3394.5" y="-2104.9" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3394.5" y="-2093.9" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu11 -->
<g id="edge1077" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu11</title>
<path fill="none" stroke="black" d="M3482.88,-2174.7C3469.87,-2165.75 3454.17,-2154.95 3439.63,-2144.95"/>
<polygon fill="black" stroke="black" points="3441.46,-2141.96 3431.24,-2139.17 3437.49,-2147.72 3441.46,-2141.96"/>
</g>
<!-- layer_14_mlp_fc1_gpu12 -->
<g id="node645" class="node">
<title>layer_14_mlp_fc1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3561,-2138.9 3462,-2138.9 3462,-2086.9 3561,-2086.9 3561,-2138.9"/>
<text text-anchor="middle" x="3511.5" y="-2126.9" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="3511.5" y="-2115.9" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3511.5" y="-2104.9" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3511.5" y="-2093.9" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu12 -->
<g id="edge1078" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu12</title>
<path fill="none" stroke="black" d="M3511.5,-2174.5C3511.5,-2166.88 3511.5,-2157.95 3511.5,-2149.32"/>
<polygon fill="black" stroke="black" points="3515,-2149.05 3511.5,-2139.05 3508,-2149.05 3515,-2149.05"/>
</g>
<!-- layer_14_mlp_fc1_gpu13 -->
<g id="node646" class="node">
<title>layer_14_mlp_fc1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3678,-2138.9 3579,-2138.9 3579,-2086.9 3678,-2086.9 3678,-2138.9"/>
<text text-anchor="middle" x="3628.5" y="-2126.9" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="3628.5" y="-2115.9" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3628.5" y="-2104.9" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3628.5" y="-2093.9" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu13 -->
<g id="edge1079" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu13</title>
<path fill="none" stroke="black" d="M3540.12,-2174.7C3553.13,-2165.75 3568.83,-2154.95 3583.37,-2144.95"/>
<polygon fill="black" stroke="black" points="3585.51,-2147.72 3591.76,-2139.17 3581.54,-2141.96 3585.51,-2147.72"/>
</g>
<!-- layer_14_mlp_fc1_gpu14 -->
<g id="node647" class="node">
<title>layer_14_mlp_fc1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3795,-2138.9 3696,-2138.9 3696,-2086.9 3795,-2086.9 3795,-2138.9"/>
<text text-anchor="middle" x="3745.5" y="-2126.9" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="3745.5" y="-2115.9" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3745.5" y="-2104.9" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3745.5" y="-2093.9" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu14 -->
<g id="edge1080" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu14</title>
<path fill="none" stroke="black" d="M3548.27,-2183.98C3582.1,-2174.14 3633.79,-2158.46 3686.46,-2139.16"/>
<polygon fill="black" stroke="black" points="3687.8,-2142.4 3695.96,-2135.64 3685.37,-2135.83 3687.8,-2142.4"/>
</g>
<!-- layer_14_mlp_fc1_gpu15 -->
<g id="node648" class="node">
<title>layer_14_mlp_fc1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3912,-2138.9 3813,-2138.9 3813,-2086.9 3912,-2086.9 3912,-2138.9"/>
<text text-anchor="middle" x="3862.5" y="-2126.9" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="3862.5" y="-2115.9" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3862.5" y="-2104.9" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3862.5" y="-2093.9" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu15 -->
<g id="edge1081" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu15</title>
<path fill="none" stroke="black" d="M3548.21,-2190.08C3602.46,-2183.13 3707.15,-2167.56 3802.94,-2139.13"/>
<polygon fill="black" stroke="black" points="3804.22,-2142.4 3812.77,-2136.15 3802.19,-2135.7 3804.22,-2142.4"/>
</g>
<!-- layer_14_allgather_mlp -->
<g id="node649" class="node">
<title>layer_14_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="3452.5" cy="-2021.91" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="3452.5" y="-2030.41" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="3452.5" y="-2019.41" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="3452.5" y="-2008.41" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_14_mlp_fc1_gpu8&#45;&gt;layer_14_allgather_mlp -->
<g id="edge1082" class="edge">
<title>layer_14_mlp_fc1_gpu8&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M3093.11,-2089.97C3096.26,-2088.86 3099.41,-2087.82 3102.5,-2086.9 3199.8,-2057.78 3316.48,-2039.67 3387.52,-2030.43"/>
<polygon fill="black" stroke="black" points="3388.19,-2033.88 3397.66,-2029.14 3387.3,-2026.93 3388.19,-2033.88"/>
</g>
<!-- layer_14_mlp_fc1_gpu9&#45;&gt;layer_14_allgather_mlp -->
<g id="edge1083" class="edge">
<title>layer_14_mlp_fc1_gpu9&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M3210.21,-2090.28C3213.34,-2089.1 3216.45,-2087.96 3219.5,-2086.9 3277.03,-2066.91 3344.24,-2049.01 3391.65,-2037.26"/>
<polygon fill="black" stroke="black" points="3392.58,-2040.64 3401.46,-2034.85 3390.91,-2033.84 3392.58,-2040.64"/>
</g>
<!-- layer_14_mlp_fc1_gpu10&#45;&gt;layer_14_allgather_mlp -->
<g id="edge1084" class="edge">
<title>layer_14_mlp_fc1_gpu10&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M3326.71,-2086.87C3350.92,-2074.56 3379.99,-2059.78 3404.08,-2047.53"/>
<polygon fill="black" stroke="black" points="3405.73,-2050.62 3413.05,-2042.96 3402.55,-2044.38 3405.73,-2050.62"/>
</g>
<!-- layer_14_mlp_fc1_gpu11&#45;&gt;layer_14_allgather_mlp -->
<g id="edge1085" class="edge">
<title>layer_14_mlp_fc1_gpu11&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M3410.97,-2086.63C3416.71,-2077.82 3423.27,-2067.76 3429.44,-2058.28"/>
<polygon fill="black" stroke="black" points="3432.45,-2060.08 3434.98,-2049.79 3426.59,-2056.25 3432.45,-2060.08"/>
</g>
<!-- layer_14_mlp_fc1_gpu12&#45;&gt;layer_14_allgather_mlp -->
<g id="edge1086" class="edge">
<title>layer_14_mlp_fc1_gpu12&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M3494.75,-2086.63C3488.86,-2077.74 3482.12,-2067.58 3475.78,-2058.03"/>
<polygon fill="black" stroke="black" points="3478.56,-2055.87 3470.11,-2049.47 3472.72,-2059.74 3478.56,-2055.87"/>
</g>
<!-- layer_14_mlp_fc1_gpu13&#45;&gt;layer_14_allgather_mlp -->
<g id="edge1087" class="edge">
<title>layer_14_mlp_fc1_gpu13&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M3579.01,-2086.87C3554.57,-2074.52 3525.21,-2059.67 3500.92,-2047.39"/>
<polygon fill="black" stroke="black" points="3502.39,-2044.21 3491.89,-2042.82 3499.23,-2050.46 3502.39,-2044.21"/>
</g>
<!-- layer_14_mlp_fc1_gpu14&#45;&gt;layer_14_allgather_mlp -->
<g id="edge1088" class="edge">
<title>layer_14_mlp_fc1_gpu14&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M3695.69,-2089.9C3692.93,-2088.85 3690.19,-2087.84 3687.5,-2086.9 3629.37,-2066.57 3561.32,-2048.66 3513.45,-2036.99"/>
<polygon fill="black" stroke="black" points="3514.1,-2033.55 3503.56,-2034.6 3512.45,-2040.35 3514.1,-2033.55"/>
</g>
<!-- layer_14_mlp_fc1_gpu15&#45;&gt;layer_14_allgather_mlp -->
<g id="edge1089" class="edge">
<title>layer_14_mlp_fc1_gpu15&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M3812.78,-2089.61C3810,-2088.64 3807.23,-2087.72 3804.5,-2086.9 3706.6,-2057.32 3589.02,-2039.32 3517.58,-2030.24"/>
<polygon fill="black" stroke="black" points="3517.73,-2026.73 3507.38,-2028.96 3516.87,-2033.67 3517.73,-2026.73"/>
</g>
<!-- layer_14_gelu -->
<g id="node650" class="node">
<title>layer_14_gelu</title>
<polygon fill="lightblue" stroke="black" points="3497,-1956.91 3408,-1956.91 3408,-1920.91 3497,-1920.91 3497,-1956.91"/>
<text text-anchor="middle" x="3452.5" y="-1941.91" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="3452.5" y="-1930.91" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_14_allgather_mlp&#45;&gt;layer_14_gelu -->
<g id="edge1090" class="edge">
<title>layer_14_allgather_mlp&#45;&gt;layer_14_gelu</title>
<path fill="none" stroke="black" d="M3452.5,-1992.58C3452.5,-1984.33 3452.5,-1975.34 3452.5,-1967.16"/>
<polygon fill="black" stroke="black" points="3456,-1967.01 3452.5,-1957.01 3449,-1967.01 3456,-1967.01"/>
</g>
<!-- layer_14_mlp_fc2_gpu8 -->
<g id="node651" class="node">
<title>layer_14_mlp_fc2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3093,-1884.91 2994,-1884.91 2994,-1832.91 3093,-1832.91 3093,-1884.91"/>
<text text-anchor="middle" x="3043.5" y="-1872.91" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="3043.5" y="-1861.91" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3043.5" y="-1850.91" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3043.5" y="-1839.91" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu8 -->
<g id="edge1091" class="edge">
<title>layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu8</title>
<path fill="none" stroke="black" d="M3407.82,-1934.75C3342.45,-1929.34 3217.05,-1916 3103.02,-1884.73"/>
<polygon fill="black" stroke="black" points="3103.65,-1881.28 3093.08,-1881.95 3101.76,-1888.02 3103.65,-1881.28"/>
</g>
<!-- layer_14_mlp_fc2_gpu9 -->
<g id="node652" class="node">
<title>layer_14_mlp_fc2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3210,-1884.91 3111,-1884.91 3111,-1832.91 3210,-1832.91 3210,-1884.91"/>
<text text-anchor="middle" x="3160.5" y="-1872.91" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="3160.5" y="-1861.91" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3160.5" y="-1850.91" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3160.5" y="-1839.91" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu9 -->
<g id="edge1092" class="edge">
<title>layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu9</title>
<path fill="none" stroke="black" d="M3407.63,-1930.16C3362.37,-1921.79 3290.48,-1907.02 3220.08,-1884.86"/>
<polygon fill="black" stroke="black" points="3220.75,-1881.4 3210.16,-1881.69 3218.61,-1888.07 3220.75,-1881.4"/>
</g>
<!-- layer_14_mlp_fc2_gpu10 -->
<g id="node653" class="node">
<title>layer_14_mlp_fc2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3327,-1884.91 3228,-1884.91 3228,-1832.91 3327,-1832.91 3327,-1884.91"/>
<text text-anchor="middle" x="3277.5" y="-1872.91" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="3277.5" y="-1861.91" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3277.5" y="-1850.91" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3277.5" y="-1839.91" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu10 -->
<g id="edge1093" class="edge">
<title>layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu10</title>
<path fill="none" stroke="black" d="M3414.1,-1920.8C3391.33,-1910.65 3362.02,-1897.59 3336.39,-1886.16"/>
<polygon fill="black" stroke="black" points="3337.69,-1882.91 3327.13,-1882.03 3334.84,-1889.3 3337.69,-1882.91"/>
</g>
<!-- layer_14_mlp_fc2_gpu11 -->
<g id="node654" class="node">
<title>layer_14_mlp_fc2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3444,-1884.91 3345,-1884.91 3345,-1832.91 3444,-1832.91 3444,-1884.91"/>
<text text-anchor="middle" x="3394.5" y="-1872.91" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="3394.5" y="-1861.91" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3394.5" y="-1850.91" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3394.5" y="-1839.91" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu11 -->
<g id="edge1094" class="edge">
<title>layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu11</title>
<path fill="none" stroke="black" d="M3439.63,-1920.6C3433.64,-1912.55 3426.31,-1902.69 3419.3,-1893.27"/>
<polygon fill="black" stroke="black" points="3422.06,-1891.11 3413.28,-1885.17 3416.44,-1895.28 3422.06,-1891.11"/>
</g>
<!-- layer_14_mlp_fc2_gpu12 -->
<g id="node655" class="node">
<title>layer_14_mlp_fc2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3561,-1884.91 3462,-1884.91 3462,-1832.91 3561,-1832.91 3561,-1884.91"/>
<text text-anchor="middle" x="3511.5" y="-1872.91" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="3511.5" y="-1861.91" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3511.5" y="-1850.91" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3511.5" y="-1839.91" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu12 -->
<g id="edge1095" class="edge">
<title>layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu12</title>
<path fill="none" stroke="black" d="M3465.59,-1920.6C3471.69,-1912.55 3479.15,-1902.69 3486.27,-1893.27"/>
<polygon fill="black" stroke="black" points="3489.15,-1895.26 3492.4,-1885.17 3483.57,-1891.03 3489.15,-1895.26"/>
</g>
<!-- layer_14_mlp_fc2_gpu13 -->
<g id="node656" class="node">
<title>layer_14_mlp_fc2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3678,-1884.91 3579,-1884.91 3579,-1832.91 3678,-1832.91 3678,-1884.91"/>
<text text-anchor="middle" x="3628.5" y="-1872.91" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="3628.5" y="-1861.91" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3628.5" y="-1850.91" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3628.5" y="-1839.91" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu13 -->
<g id="edge1096" class="edge">
<title>layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu13</title>
<path fill="none" stroke="black" d="M3491.12,-1920.8C3514.1,-1910.61 3543.73,-1897.48 3569.58,-1886.03"/>
<polygon fill="black" stroke="black" points="3571.19,-1889.14 3578.91,-1881.89 3568.35,-1882.74 3571.19,-1889.14"/>
</g>
<!-- layer_14_mlp_fc2_gpu14 -->
<g id="node657" class="node">
<title>layer_14_mlp_fc2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3795,-1884.91 3696,-1884.91 3696,-1832.91 3795,-1832.91 3795,-1884.91"/>
<text text-anchor="middle" x="3745.5" y="-1872.91" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="3745.5" y="-1861.91" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3745.5" y="-1850.91" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3745.5" y="-1839.91" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu14 -->
<g id="edge1097" class="edge">
<title>layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu14</title>
<path fill="none" stroke="black" d="M3497.34,-1930.36C3542.98,-1922.11 3615.76,-1907.39 3685.87,-1885.23"/>
<polygon fill="black" stroke="black" points="3687.29,-1888.45 3695.74,-1882.06 3685.15,-1881.79 3687.29,-1888.45"/>
</g>
<!-- layer_14_mlp_fc2_gpu15 -->
<g id="node658" class="node">
<title>layer_14_mlp_fc2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3912,-1884.91 3813,-1884.91 3813,-1832.91 3912,-1832.91 3912,-1884.91"/>
<text text-anchor="middle" x="3862.5" y="-1872.91" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="3862.5" y="-1861.91" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3862.5" y="-1850.91" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3862.5" y="-1839.91" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu15 -->
<g id="edge1098" class="edge">
<title>layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu15</title>
<path fill="none" stroke="black" d="M3497.18,-1934.89C3562.87,-1929.64 3689.23,-1916.49 3802.91,-1885.09"/>
<polygon fill="black" stroke="black" points="3804.14,-1888.38 3812.81,-1882.3 3802.24,-1881.64 3804.14,-1888.38"/>
</g>
<!-- layer_14_allreduce_mlp -->
<g id="node659" class="node">
<title>layer_14_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="3511.5" cy="-1767.92" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="3511.5" y="-1776.42" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="3511.5" y="-1765.42" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="3511.5" y="-1754.42" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_14_mlp_fc2_gpu8&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge1099" class="edge">
<title>layer_14_mlp_fc2_gpu8&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3093.08,-1835.89C3096.24,-1834.8 3099.4,-1833.8 3102.5,-1832.91 3219.27,-1799.59 3360.05,-1782.38 3442.3,-1774.53"/>
<polygon fill="black" stroke="black" points="3442.64,-1778.01 3452.27,-1773.59 3441.99,-1771.04 3442.64,-1778.01"/>
</g>
<!-- layer_14_mlp_fc2_gpu9&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge1100" class="edge">
<title>layer_14_mlp_fc2_gpu9&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3210.15,-1836.11C3213.29,-1834.97 3216.43,-1833.89 3219.5,-1832.91 3295.35,-1808.76 3385.12,-1790.58 3444.91,-1779.88"/>
<polygon fill="black" stroke="black" points="3445.74,-1783.29 3454.98,-1778.1 3444.53,-1776.4 3445.74,-1783.29"/>
</g>
<!-- layer_14_mlp_fc2_gpu10&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge1101" class="edge">
<title>layer_14_mlp_fc2_gpu10&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3327,-1836.73C3330.21,-1835.42 3333.4,-1834.14 3336.5,-1832.91 3375.39,-1817.57 3419.62,-1801.41 3453.88,-1789.17"/>
<polygon fill="black" stroke="black" points="3455.48,-1792.32 3463.72,-1785.66 3453.13,-1785.72 3455.48,-1792.32"/>
</g>
<!-- layer_14_mlp_fc2_gpu11&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge1102" class="edge">
<title>layer_14_mlp_fc2_gpu11&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3427.4,-1832.89C3441.19,-1822.4 3457.34,-1810.12 3471.78,-1799.14"/>
<polygon fill="black" stroke="black" points="3474.21,-1801.68 3480.05,-1792.84 3469.97,-1796.11 3474.21,-1801.68"/>
</g>
<!-- layer_14_mlp_fc2_gpu12&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge1103" class="edge">
<title>layer_14_mlp_fc2_gpu12&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3511.5,-1832.65C3511.5,-1824.76 3511.5,-1815.87 3511.5,-1807.29"/>
<polygon fill="black" stroke="black" points="3515,-1807.06 3511.5,-1797.06 3508,-1807.06 3515,-1807.06"/>
</g>
<!-- layer_14_mlp_fc2_gpu13&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge1104" class="edge">
<title>layer_14_mlp_fc2_gpu13&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3595.6,-1832.89C3581.81,-1822.4 3565.66,-1810.12 3551.22,-1799.14"/>
<polygon fill="black" stroke="black" points="3553.03,-1796.11 3542.95,-1792.84 3548.79,-1801.68 3553.03,-1796.11"/>
</g>
<!-- layer_14_mlp_fc2_gpu14&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge1105" class="edge">
<title>layer_14_mlp_fc2_gpu14&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3695.91,-1836.31C3693.07,-1835.15 3690.25,-1834.01 3687.5,-1832.91 3648.28,-1817.35 3603.58,-1801.11 3569.05,-1788.89"/>
<polygon fill="black" stroke="black" points="3570.19,-1785.58 3559.59,-1785.56 3567.86,-1792.18 3570.19,-1785.58"/>
</g>
<!-- layer_14_mlp_fc2_gpu15&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge1106" class="edge">
<title>layer_14_mlp_fc2_gpu15&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3812.75,-1835.75C3809.98,-1834.74 3807.21,-1833.79 3804.5,-1832.91 3728.35,-1808.44 3638.09,-1790.3 3578.07,-1779.7"/>
<polygon fill="black" stroke="black" points="3578.42,-1776.21 3567.97,-1777.93 3577.22,-1783.1 3578.42,-1776.21"/>
</g>
<!-- layer_14_allreduce_mlp&#45;&gt;layer_14_residual2 -->
<g id="edge1107" class="edge">
<title>layer_14_allreduce_mlp&#45;&gt;layer_14_residual2</title>
<path fill="none" stroke="black" d="M3555.32,-1747.88C3587.43,-1733.93 3631.35,-1714.84 3666.53,-1699.55"/>
<polygon fill="black" stroke="black" points="3667.97,-1702.75 3675.74,-1695.55 3665.18,-1696.33 3667.97,-1702.75"/>
</g>
<!-- layer_14_ln2 -->
<g id="node661" class="node">
<title>layer_14_ln2</title>
<polygon fill="lightblue" stroke="black" points="3762,-1606.93 3689,-1606.93 3689,-1565.93 3762,-1565.93 3762,-1606.93"/>
<text text-anchor="middle" x="3725.5" y="-1594.93" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="3725.5" y="-1583.93" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="3725.5" y="-1572.93" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_14_residual2&#45;&gt;layer_14_ln2 -->
<g id="edge1109" class="edge">
<title>layer_14_residual2&#45;&gt;layer_14_ln2</title>
<path fill="none" stroke="black" d="M3725.5,-1642.85C3725.5,-1634.53 3725.5,-1625.44 3725.5,-1617.09"/>
<polygon fill="black" stroke="black" points="3729,-1617 3725.5,-1607 3722,-1617 3729,-1617"/>
</g>
<!-- layer_14_output_dist -->
<g id="node662" class="node">
<title>layer_14_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="3827.2,-1529.93 3665.42,-1529.93 3623.8,-1469.93 3785.58,-1469.93 3827.2,-1529.93"/>
<text text-anchor="middle" x="3725.5" y="-1502.93" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="3725.5" y="-1491.93" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_14_ln2&#45;&gt;layer_14_output_dist -->
<g id="edge1110" class="edge">
<title>layer_14_ln2&#45;&gt;layer_14_output_dist</title>
<path fill="none" stroke="black" d="M3725.5,-1565.83C3725.5,-1558.19 3725.5,-1549.15 3725.5,-1540.28"/>
<polygon fill="black" stroke="black" points="3729,-1540.04 3725.5,-1530.04 3722,-1540.04 3729,-1540.04"/>
</g>
<!-- layer_15_input_dist -->
<g id="node663" class="node">
<title>layer_15_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="3819.69,-1433.93 3669.86,-1433.93 3631.31,-1373.93 3781.14,-1373.93 3819.69,-1433.93"/>
<text text-anchor="middle" x="3725.5" y="-1406.93" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="3725.5" y="-1395.93" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_14_output_dist&#45;&gt;layer_15_input_dist -->
<g id="edge1111" class="edge">
<title>layer_14_output_dist&#45;&gt;layer_15_input_dist</title>
<path fill="none" stroke="black" d="M3725.5,-1469.7C3725.5,-1461.66 3725.5,-1452.8 3725.5,-1444.28"/>
<polygon fill="black" stroke="black" points="3729,-1444.14 3725.5,-1434.14 3722,-1444.14 3729,-1444.14"/>
</g>
<!-- layer_15_qkv_gpu8 -->
<g id="node664" class="node">
<title>layer_15_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3310.5,-1337.93 3212.5,-1337.93 3212.5,-1285.93 3310.5,-1285.93 3310.5,-1337.93"/>
<text text-anchor="middle" x="3261.5" y="-1325.93" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="3261.5" y="-1314.93" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3261.5" y="-1303.93" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3261.5" y="-1292.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu8 -->
<g id="edge1112" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu8</title>
<path fill="none" stroke="black" d="M3645.24,-1396.01C3564.67,-1387.73 3437.23,-1371 3320.38,-1337.89"/>
<polygon fill="black" stroke="black" points="3321.13,-1334.47 3310.55,-1335.06 3319.19,-1341.19 3321.13,-1334.47"/>
</g>
<!-- layer_15_qkv_gpu9 -->
<g id="node665" class="node">
<title>layer_15_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3426.5,-1337.93 3328.5,-1337.93 3328.5,-1285.93 3426.5,-1285.93 3426.5,-1337.93"/>
<text text-anchor="middle" x="3377.5" y="-1325.93" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="3377.5" y="-1314.93" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3377.5" y="-1303.93" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3377.5" y="-1292.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu9 -->
<g id="edge1113" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu9</title>
<path fill="none" stroke="black" d="M3640.31,-1388.18C3584.43,-1377.49 3509.84,-1361.33 3436.49,-1338.03"/>
<polygon fill="black" stroke="black" points="3437.21,-1334.58 3426.62,-1334.84 3435.06,-1341.24 3437.21,-1334.58"/>
</g>
<!-- layer_15_qkv_gpu10 -->
<g id="node666" class="node">
<title>layer_15_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3542.5,-1337.93 3444.5,-1337.93 3444.5,-1285.93 3542.5,-1285.93 3542.5,-1337.93"/>
<text text-anchor="middle" x="3493.5" y="-1325.93" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="3493.5" y="-1314.93" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3493.5" y="-1303.93" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3493.5" y="-1292.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu10 -->
<g id="edge1114" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu10</title>
<path fill="none" stroke="black" d="M3645.05,-1373.82C3617.93,-1363.78 3587.36,-1352.22 3552.3,-1338.19"/>
<polygon fill="black" stroke="black" points="3553.38,-1334.85 3542.79,-1334.37 3550.77,-1341.35 3553.38,-1334.85"/>
</g>
<!-- layer_15_qkv_gpu11 -->
<g id="node667" class="node">
<title>layer_15_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3658.5,-1337.93 3560.5,-1337.93 3560.5,-1285.93 3658.5,-1285.93 3658.5,-1337.93"/>
<text text-anchor="middle" x="3609.5" y="-1325.93" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="3609.5" y="-1314.93" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3609.5" y="-1303.93" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3609.5" y="-1292.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu11 -->
<g id="edge1115" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu11</title>
<path fill="none" stroke="black" d="M3687.84,-1373.71C3675.68,-1364.28 3662.16,-1353.79 3649.82,-1344.21"/>
<polygon fill="black" stroke="black" points="3651.96,-1341.44 3641.91,-1338.08 3647.66,-1346.97 3651.96,-1341.44"/>
</g>
<!-- layer_15_qkv_gpu12 -->
<g id="node668" class="node">
<title>layer_15_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3774.5,-1337.93 3676.5,-1337.93 3676.5,-1285.93 3774.5,-1285.93 3774.5,-1337.93"/>
<text text-anchor="middle" x="3725.5" y="-1325.93" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="3725.5" y="-1314.93" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3725.5" y="-1303.93" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3725.5" y="-1292.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu12 -->
<g id="edge1116" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu12</title>
<path fill="none" stroke="black" d="M3725.5,-1373.46C3725.5,-1365.39 3725.5,-1356.55 3725.5,-1348.19"/>
<polygon fill="black" stroke="black" points="3729,-1347.94 3725.5,-1337.94 3722,-1347.94 3729,-1347.94"/>
</g>
<!-- layer_15_qkv_gpu13 -->
<g id="node669" class="node">
<title>layer_15_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3890.5,-1337.93 3792.5,-1337.93 3792.5,-1285.93 3890.5,-1285.93 3890.5,-1337.93"/>
<text text-anchor="middle" x="3841.5" y="-1325.93" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="3841.5" y="-1314.93" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3841.5" y="-1303.93" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3841.5" y="-1292.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu13 -->
<g id="edge1117" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu13</title>
<path fill="none" stroke="black" d="M3763.16,-1373.71C3775.32,-1364.28 3788.84,-1353.79 3801.18,-1344.21"/>
<polygon fill="black" stroke="black" points="3803.34,-1346.97 3809.09,-1338.08 3799.04,-1341.44 3803.34,-1346.97"/>
</g>
<!-- layer_15_qkv_gpu14 -->
<g id="node670" class="node">
<title>layer_15_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4006.5,-1337.93 3908.5,-1337.93 3908.5,-1285.93 4006.5,-1285.93 4006.5,-1337.93"/>
<text text-anchor="middle" x="3957.5" y="-1325.93" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="3957.5" y="-1314.93" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3957.5" y="-1303.93" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3957.5" y="-1292.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu14 -->
<g id="edge1118" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu14</title>
<path fill="none" stroke="black" d="M3786.18,-1381.1C3817.44,-1369.66 3856.35,-1355.12 3898.81,-1338.15"/>
<polygon fill="black" stroke="black" points="3900.23,-1341.35 3908.21,-1334.37 3897.62,-1334.85 3900.23,-1341.35"/>
</g>
<!-- layer_15_qkv_gpu15 -->
<g id="node671" class="node">
<title>layer_15_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4122.5,-1337.93 4024.5,-1337.93 4024.5,-1285.93 4122.5,-1285.93 4122.5,-1337.93"/>
<text text-anchor="middle" x="4073.5" y="-1325.93" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="4073.5" y="-1314.93" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="4073.5" y="-1303.93" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="4073.5" y="-1292.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu15 -->
<g id="edge1119" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu15</title>
<path fill="none" stroke="black" d="M3792.68,-1391.56C3849.75,-1381.06 3933.78,-1363.64 4014.55,-1338.01"/>
<polygon fill="black" stroke="black" points="4015.93,-1341.24 4024.38,-1334.84 4013.79,-1334.58 4015.93,-1341.24"/>
</g>
<!-- layer_15_residual1 -->
<g id="node683" class="node">
<title>layer_15_residual1</title>
<polygon fill="lightyellow" stroke="black" points="4023.44,-885.97 3901.05,-885.97 3869.56,-825.97 3991.95,-825.97 4023.44,-885.97"/>
<text text-anchor="middle" x="3946.5" y="-858.97" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="3946.5" y="-847.97" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_residual1 -->
<g id="edge1146" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_residual1</title>
<path fill="none" stroke="black" d="M3798.7,-1401.17C3902.74,-1397.07 4085.86,-1383.4 4131.5,-1337.93 4168.51,-1301.06 4150.5,-1274.18 4150.5,-1221.94 4150.5,-1221.94 4150.5,-1221.94 4150.5,-1040.95 4150.5,-971 4083.55,-920.82 4026.36,-890.71"/>
<polygon fill="black" stroke="black" points="4027.77,-887.5 4017.28,-886.05 4024.58,-893.73 4027.77,-887.5"/>
</g>
<!-- layer_15_allgather_qkv -->
<g id="node672" class="node">
<title>layer_15_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="3678.5" cy="-1220.94" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="3678.5" y="-1229.44" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="3678.5" y="-1218.44" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="3678.5" y="-1207.44" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_15_qkv_gpu8&#45;&gt;layer_15_allgather_qkv -->
<g id="edge1120" class="edge">
<title>layer_15_qkv_gpu8&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M3310.57,-1288.86C3313.57,-1287.8 3316.56,-1286.81 3319.5,-1285.93 3419.69,-1255.85 3540.1,-1237.94 3612.89,-1229.02"/>
<polygon fill="black" stroke="black" points="3613.33,-1232.5 3622.84,-1227.83 3612.49,-1225.55 3613.33,-1232.5"/>
</g>
<!-- layer_15_qkv_gpu9&#45;&gt;layer_15_allgather_qkv -->
<g id="edge1121" class="edge">
<title>layer_15_qkv_gpu9&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M3426.66,-1289.15C3429.64,-1288.01 3432.6,-1286.93 3435.5,-1285.93 3495.88,-1265.1 3566.68,-1247.16 3616.23,-1235.63"/>
<polygon fill="black" stroke="black" points="3617.2,-1238.99 3626.16,-1233.33 3615.63,-1232.17 3617.2,-1238.99"/>
</g>
<!-- layer_15_qkv_gpu10&#45;&gt;layer_15_allgather_qkv -->
<g id="edge1122" class="edge">
<title>layer_15_qkv_gpu10&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M3542.59,-1287.32C3569.21,-1274.51 3602.03,-1258.72 3628.75,-1245.87"/>
<polygon fill="black" stroke="black" points="3630.44,-1248.94 3637.93,-1241.45 3627.4,-1242.64 3630.44,-1248.94"/>
</g>
<!-- layer_15_qkv_gpu11&#45;&gt;layer_15_allgather_qkv -->
<g id="edge1123" class="edge">
<title>layer_15_qkv_gpu11&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M3629.09,-1285.67C3636.19,-1276.51 3644.32,-1266.02 3651.92,-1256.22"/>
<polygon fill="black" stroke="black" points="3654.78,-1258.24 3658.14,-1248.2 3649.25,-1253.95 3654.78,-1258.24"/>
</g>
<!-- layer_15_qkv_gpu12&#45;&gt;layer_15_allgather_qkv -->
<g id="edge1124" class="edge">
<title>layer_15_qkv_gpu12&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M3712.16,-1285.67C3707.64,-1277.11 3702.5,-1267.38 3697.62,-1258.14"/>
<polygon fill="black" stroke="black" points="3700.63,-1256.34 3692.86,-1249.13 3694.44,-1259.61 3700.63,-1256.34"/>
</g>
<!-- layer_15_qkv_gpu13&#45;&gt;layer_15_allgather_qkv -->
<g id="edge1125" class="edge">
<title>layer_15_qkv_gpu13&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M3795.66,-1285.91C3773.73,-1273.93 3747.51,-1259.61 3725.44,-1247.56"/>
<polygon fill="black" stroke="black" points="3727.03,-1244.44 3716.57,-1242.72 3723.67,-1250.59 3727.03,-1244.44"/>
</g>
<!-- layer_15_qkv_gpu14&#45;&gt;layer_15_allgather_qkv -->
<g id="edge1126" class="edge">
<title>layer_15_qkv_gpu14&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M3908.31,-1289.23C3905.34,-1288.08 3902.39,-1286.97 3899.5,-1285.93 3846.02,-1266.75 3783.74,-1249.13 3738.95,-1237.25"/>
<polygon fill="black" stroke="black" points="3739.66,-1233.82 3729.1,-1234.66 3737.88,-1240.59 3739.66,-1233.82"/>
</g>
<!-- layer_15_qkv_gpu15&#45;&gt;layer_15_allgather_qkv -->
<g id="edge1127" class="edge">
<title>layer_15_qkv_gpu15&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M4024.42,-1288.9C4021.42,-1287.83 4018.44,-1286.83 4015.5,-1285.93 3923.29,-1257.68 3812.89,-1239.56 3744.21,-1230.07"/>
<polygon fill="black" stroke="black" points="3744.35,-1226.55 3733.97,-1228.67 3743.41,-1233.49 3744.35,-1226.55"/>
</g>
<!-- layer_15_attention -->
<g id="node673" class="node">
<title>layer_15_attention</title>
<polygon fill="lightblue" stroke="black" points="3712.5,-1155.95 3644.5,-1155.95 3644.5,-1103.95 3712.5,-1103.95 3712.5,-1155.95"/>
<text text-anchor="middle" x="3678.5" y="-1143.95" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="3678.5" y="-1132.95" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3678.5" y="-1121.95" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="3678.5" y="-1110.95" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_15_allgather_qkv&#45;&gt;layer_15_attention -->
<g id="edge1128" class="edge">
<title>layer_15_allgather_qkv&#45;&gt;layer_15_attention</title>
<path fill="none" stroke="black" d="M3678.5,-1191.78C3678.5,-1183.67 3678.5,-1174.72 3678.5,-1166.24"/>
<polygon fill="black" stroke="black" points="3682,-1166.21 3678.5,-1156.21 3675,-1166.21 3682,-1166.21"/>
</g>
<!-- layer_15_attn_out_gpu8 -->
<g id="node674" class="node">
<title>layer_15_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3345,-1067.95 3252,-1067.95 3252,-1015.95 3345,-1015.95 3345,-1067.95"/>
<text text-anchor="middle" x="3298.5" y="-1055.95" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="3298.5" y="-1044.95" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3298.5" y="-1033.95" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3298.5" y="-1022.95" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attention&#45;&gt;layer_15_attn_out_gpu8 -->
<g id="edge1129" class="edge">
<title>layer_15_attention&#45;&gt;layer_15_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M3644.28,-1125.18C3586.17,-1118.2 3464.62,-1101.14 3354.81,-1067.73"/>
<polygon fill="black" stroke="black" points="3355.83,-1064.39 3345.25,-1064.77 3353.76,-1071.07 3355.83,-1064.39"/>
</g>
<!-- layer_15_attn_out_gpu9 -->
<g id="node675" class="node">
<title>layer_15_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3456,-1067.95 3363,-1067.95 3363,-1015.95 3456,-1015.95 3456,-1067.95"/>
<text text-anchor="middle" x="3409.5" y="-1055.95" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="3409.5" y="-1044.95" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3409.5" y="-1033.95" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3409.5" y="-1022.95" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attention&#45;&gt;layer_15_attn_out_gpu9 -->
<g id="edge1130" class="edge">
<title>layer_15_attention&#45;&gt;layer_15_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M3644.46,-1120.78C3602.01,-1110.23 3527.48,-1090.53 3465.5,-1067.95 3465.4,-1067.91 3465.31,-1067.88 3465.21,-1067.84"/>
<polygon fill="black" stroke="black" points="3466.64,-1064.64 3456.05,-1064.32 3464.13,-1071.18 3466.64,-1064.64"/>
</g>
<!-- layer_15_attn_out_gpu10 -->
<g id="node676" class="node">
<title>layer_15_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3567,-1067.95 3474,-1067.95 3474,-1015.95 3567,-1015.95 3567,-1067.95"/>
<text text-anchor="middle" x="3520.5" y="-1055.95" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="3520.5" y="-1044.95" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3520.5" y="-1033.95" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3520.5" y="-1022.95" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attention&#45;&gt;layer_15_attn_out_gpu10 -->
<g id="edge1131" class="edge">
<title>layer_15_attention&#45;&gt;layer_15_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M3644.22,-1110.29C3624.19,-1099.38 3598.44,-1085.37 3575.62,-1072.95"/>
<polygon fill="black" stroke="black" points="3577.16,-1069.81 3566.71,-1068.1 3573.82,-1075.95 3577.16,-1069.81"/>
</g>
<!-- layer_15_attn_out_gpu11 -->
<g id="node677" class="node">
<title>layer_15_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3678,-1067.95 3585,-1067.95 3585,-1015.95 3678,-1015.95 3678,-1067.95"/>
<text text-anchor="middle" x="3631.5" y="-1055.95" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="3631.5" y="-1044.95" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3631.5" y="-1033.95" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3631.5" y="-1022.95" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attention&#45;&gt;layer_15_attn_out_gpu11 -->
<g id="edge1132" class="edge">
<title>layer_15_attention&#45;&gt;layer_15_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M3664.65,-1103.61C3660.11,-1095.3 3654.99,-1085.92 3650.15,-1077.07"/>
<polygon fill="black" stroke="black" points="3653.12,-1075.2 3645.25,-1068.1 3646.97,-1078.56 3653.12,-1075.2"/>
</g>
<!-- layer_15_attn_out_gpu12 -->
<g id="node678" class="node">
<title>layer_15_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3789,-1067.95 3696,-1067.95 3696,-1015.95 3789,-1015.95 3789,-1067.95"/>
<text text-anchor="middle" x="3742.5" y="-1055.95" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="3742.5" y="-1044.95" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3742.5" y="-1033.95" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3742.5" y="-1022.95" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attention&#45;&gt;layer_15_attn_out_gpu12 -->
<g id="edge1133" class="edge">
<title>layer_15_attention&#45;&gt;layer_15_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M3697.36,-1103.61C3703.74,-1095.04 3710.96,-1085.33 3717.73,-1076.24"/>
<polygon fill="black" stroke="black" points="3720.62,-1078.22 3723.78,-1068.1 3715,-1074.04 3720.62,-1078.22"/>
</g>
<!-- layer_15_attn_out_gpu13 -->
<g id="node679" class="node">
<title>layer_15_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3900,-1067.95 3807,-1067.95 3807,-1015.95 3900,-1015.95 3900,-1067.95"/>
<text text-anchor="middle" x="3853.5" y="-1055.95" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="3853.5" y="-1044.95" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3853.5" y="-1033.95" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3853.5" y="-1022.95" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attention&#45;&gt;layer_15_attn_out_gpu13 -->
<g id="edge1134" class="edge">
<title>layer_15_attention&#45;&gt;layer_15_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M3712.66,-1112.16C3736.79,-1100.3 3769.67,-1084.15 3797.59,-1070.42"/>
<polygon fill="black" stroke="black" points="3799.42,-1073.43 3806.85,-1065.87 3796.33,-1067.14 3799.42,-1073.43"/>
</g>
<!-- layer_15_attn_out_gpu14 -->
<g id="node680" class="node">
<title>layer_15_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4011,-1067.95 3918,-1067.95 3918,-1015.95 4011,-1015.95 4011,-1067.95"/>
<text text-anchor="middle" x="3964.5" y="-1055.95" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="3964.5" y="-1044.95" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3964.5" y="-1033.95" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3964.5" y="-1022.95" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attention&#45;&gt;layer_15_attn_out_gpu14 -->
<g id="edge1135" class="edge">
<title>layer_15_attention&#45;&gt;layer_15_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M3712.71,-1121.81C3756.42,-1112.28 3834.39,-1093.91 3908.44,-1068.12"/>
<polygon fill="black" stroke="black" points="3909.65,-1071.4 3917.91,-1064.77 3907.32,-1064.8 3909.65,-1071.4"/>
</g>
<!-- layer_15_attn_out_gpu15 -->
<g id="node681" class="node">
<title>layer_15_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4122,-1067.95 4029,-1067.95 4029,-1015.95 4122,-1015.95 4122,-1067.95"/>
<text text-anchor="middle" x="4075.5" y="-1055.95" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="4075.5" y="-1044.95" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="4075.5" y="-1033.95" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="4075.5" y="-1022.95" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attention&#45;&gt;layer_15_attn_out_gpu15 -->
<g id="edge1136" class="edge">
<title>layer_15_attention&#45;&gt;layer_15_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M3712.66,-1125.71C3773.27,-1119.37 3903.42,-1103 4018.99,-1068.14"/>
<polygon fill="black" stroke="black" points="4020.17,-1071.44 4028.7,-1065.15 4018.11,-1064.75 4020.17,-1071.44"/>
</g>
<!-- layer_15_allreduce_attn -->
<g id="node682" class="node">
<title>layer_15_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="3742.5" cy="-950.96" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="3742.5" y="-959.46" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="3742.5" y="-948.46" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="3742.5" y="-937.46" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_15_attn_out_gpu8&#45;&gt;layer_15_allreduce_attn -->
<g id="edge1137" class="edge">
<title>layer_15_attn_out_gpu8&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M3345.22,-1019.05C3348.33,-1017.91 3351.44,-1016.87 3354.5,-1015.95 3464.32,-982.98 3597.06,-965.72 3675.36,-957.76"/>
<polygon fill="black" stroke="black" points="3675.97,-961.21 3685.57,-956.74 3675.27,-954.25 3675.97,-961.21"/>
</g>
<!-- layer_15_attn_out_gpu9&#45;&gt;layer_15_allreduce_attn -->
<g id="edge1138" class="edge">
<title>layer_15_attn_out_gpu9&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M3456.29,-1019.27C3459.38,-1018.08 3462.47,-1016.96 3465.5,-1015.95 3536.91,-992.01 3621.6,-973.87 3678.37,-963.13"/>
<polygon fill="black" stroke="black" points="3679.1,-966.55 3688.29,-961.27 3677.82,-959.67 3679.1,-966.55"/>
</g>
<!-- layer_15_attn_out_gpu10&#45;&gt;layer_15_allreduce_attn -->
<g id="edge1139" class="edge">
<title>layer_15_attn_out_gpu10&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M3567.17,-1019.89C3570.32,-1018.54 3573.45,-1017.22 3576.5,-1015.95 3613.07,-1000.75 3654.66,-984.72 3687.06,-972.51"/>
<polygon fill="black" stroke="black" points="3688.67,-975.64 3696.8,-968.84 3686.21,-969.09 3688.67,-975.64"/>
</g>
<!-- layer_15_attn_out_gpu11&#45;&gt;layer_15_allreduce_attn -->
<g id="edge1140" class="edge">
<title>layer_15_attn_out_gpu11&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M3662.72,-1015.92C3675.79,-1005.44 3691.11,-993.15 3704.81,-982.17"/>
<polygon fill="black" stroke="black" points="3707.05,-984.86 3712.67,-975.88 3702.67,-979.4 3707.05,-984.86"/>
</g>
<!-- layer_15_attn_out_gpu12&#45;&gt;layer_15_allreduce_attn -->
<g id="edge1141" class="edge">
<title>layer_15_attn_out_gpu12&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M3742.5,-1015.68C3742.5,-1007.79 3742.5,-998.9 3742.5,-990.32"/>
<polygon fill="black" stroke="black" points="3746,-990.1 3742.5,-980.1 3739,-990.1 3746,-990.1"/>
</g>
<!-- layer_15_attn_out_gpu13&#45;&gt;layer_15_allreduce_attn -->
<g id="edge1142" class="edge">
<title>layer_15_attn_out_gpu13&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M3822.28,-1015.92C3809.21,-1005.44 3793.89,-993.15 3780.19,-982.17"/>
<polygon fill="black" stroke="black" points="3782.33,-979.4 3772.33,-975.88 3777.95,-984.86 3782.33,-979.4"/>
</g>
<!-- layer_15_attn_out_gpu14&#45;&gt;layer_15_allreduce_attn -->
<g id="edge1143" class="edge">
<title>layer_15_attn_out_gpu14&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M3917.78,-1019.48C3914.98,-1018.27 3912.21,-1017.08 3909.5,-1015.95 3872.61,-1000.51 3830.57,-984.41 3797.9,-972.22"/>
<polygon fill="black" stroke="black" points="3799.11,-968.94 3788.52,-968.73 3796.67,-975.5 3799.11,-968.94"/>
</g>
<!-- layer_15_attn_out_gpu15&#45;&gt;layer_15_allreduce_attn -->
<g id="edge1144" class="edge">
<title>layer_15_attn_out_gpu15&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M4028.95,-1019.02C4026.11,-1017.92 4023.28,-1016.89 4020.5,-1015.95 3948.92,-991.72 3863.9,-973.64 3806.9,-962.98"/>
<polygon fill="black" stroke="black" points="3807.41,-959.52 3796.94,-961.15 3806.14,-966.4 3807.41,-959.52"/>
</g>
<!-- layer_15_allreduce_attn&#45;&gt;layer_15_residual1 -->
<g id="edge1145" class="edge">
<title>layer_15_allreduce_attn&#45;&gt;layer_15_residual1</title>
<path fill="none" stroke="black" d="M3784.77,-930.69C3814.62,-917.08 3855,-898.67 3887.95,-883.66"/>
<polygon fill="black" stroke="black" points="3889.82,-886.65 3897.47,-879.32 3886.92,-880.28 3889.82,-886.65"/>
</g>
<!-- layer_15_ln1 -->
<g id="node684" class="node">
<title>layer_15_ln1</title>
<polygon fill="lightblue" stroke="black" points="3769,-789.97 3696,-789.97 3696,-748.97 3769,-748.97 3769,-789.97"/>
<text text-anchor="middle" x="3732.5" y="-777.97" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="3732.5" y="-766.97" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="3732.5" y="-755.97" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_15_residual1&#45;&gt;layer_15_ln1 -->
<g id="edge1147" class="edge">
<title>layer_15_residual1&#45;&gt;layer_15_ln1</title>
<path fill="none" stroke="black" d="M3872.85,-825.89C3841.49,-813.5 3805.88,-799.44 3778.37,-788.58"/>
<polygon fill="black" stroke="black" points="3779.59,-785.3 3769,-784.88 3777.02,-791.81 3779.59,-785.3"/>
</g>
<!-- layer_15_residual2 -->
<g id="node704" class="node">
<title>layer_15_residual2</title>
<polygon fill="lightyellow" stroke="black" points="4023.44,-277 3901.05,-277 3869.56,-217 3991.95,-217 4023.44,-277"/>
<text text-anchor="middle" x="3946.5" y="-250" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="3946.5" y="-239" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_15_residual1&#45;&gt;layer_15_residual2 -->
<g id="edge1182" class="edge">
<title>layer_15_residual1&#45;&gt;layer_15_residual2</title>
<path fill="none" stroke="black" d="M3999.37,-839.57C4063.03,-817.39 4161.5,-769.85 4161.5,-687.97 4161.5,-687.97 4161.5,-687.97 4161.5,-431.98 4161.5,-360.6 4092.25,-310.98 4032.35,-281.42"/>
<polygon fill="black" stroke="black" points="4033.74,-278.2 4023.21,-277.02 4030.7,-284.51 4033.74,-278.2"/>
</g>
<!-- layer_15_mlp_fc1_gpu8 -->
<g id="node685" class="node">
<title>layer_15_mlp_fc1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3314,-712.97 3215,-712.97 3215,-660.97 3314,-660.97 3314,-712.97"/>
<text text-anchor="middle" x="3264.5" y="-700.97" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="3264.5" y="-689.97" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3264.5" y="-678.97" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3264.5" y="-667.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu8 -->
<g id="edge1148" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu8</title>
<path fill="none" stroke="black" d="M3695.74,-766.75C3624.94,-762.75 3464.96,-750.33 3323.76,-712.7"/>
<polygon fill="black" stroke="black" points="3324.63,-709.3 3314.06,-710.06 3322.79,-716.06 3324.63,-709.3"/>
</g>
<!-- layer_15_mlp_fc1_gpu9 -->
<g id="node686" class="node">
<title>layer_15_mlp_fc1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3431,-712.97 3332,-712.97 3332,-660.97 3431,-660.97 3431,-712.97"/>
<text text-anchor="middle" x="3381.5" y="-700.97" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="3381.5" y="-689.97" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3381.5" y="-678.97" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3381.5" y="-667.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu9 -->
<g id="edge1149" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu9</title>
<path fill="none" stroke="black" d="M3695.94,-764.06C3641.85,-757 3537.39,-741.27 3440.74,-712.76"/>
<polygon fill="black" stroke="black" points="3441.7,-709.39 3431.12,-709.87 3439.69,-716.1 3441.7,-709.39"/>
</g>
<!-- layer_15_mlp_fc1_gpu10 -->
<g id="node687" class="node">
<title>layer_15_mlp_fc1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3548,-712.97 3449,-712.97 3449,-660.97 3548,-660.97 3548,-712.97"/>
<text text-anchor="middle" x="3498.5" y="-700.97" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="3498.5" y="-689.97" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3498.5" y="-678.97" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3498.5" y="-667.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu10 -->
<g id="edge1150" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu10</title>
<path fill="none" stroke="black" d="M3695.97,-757.97C3662.35,-748.07 3610.97,-732.33 3557.85,-712.97"/>
<polygon fill="black" stroke="black" points="3558.86,-709.61 3548.26,-709.44 3556.44,-716.18 3558.86,-709.61"/>
</g>
<!-- layer_15_mlp_fc1_gpu11 -->
<g id="node688" class="node">
<title>layer_15_mlp_fc1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3665,-712.97 3566,-712.97 3566,-660.97 3665,-660.97 3665,-712.97"/>
<text text-anchor="middle" x="3615.5" y="-700.97" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="3615.5" y="-689.97" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3615.5" y="-678.97" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3615.5" y="-667.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu11 -->
<g id="edge1151" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu11</title>
<path fill="none" stroke="black" d="M3703.88,-748.77C3690.87,-739.82 3675.17,-729.02 3660.63,-719.02"/>
<polygon fill="black" stroke="black" points="3662.46,-716.03 3652.24,-713.24 3658.49,-721.79 3662.46,-716.03"/>
</g>
<!-- layer_15_mlp_fc1_gpu12 -->
<g id="node689" class="node">
<title>layer_15_mlp_fc1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3782,-712.97 3683,-712.97 3683,-660.97 3782,-660.97 3782,-712.97"/>
<text text-anchor="middle" x="3732.5" y="-700.97" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="3732.5" y="-689.97" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3732.5" y="-678.97" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3732.5" y="-667.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu12 -->
<g id="edge1152" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu12</title>
<path fill="none" stroke="black" d="M3732.5,-748.57C3732.5,-740.95 3732.5,-732.02 3732.5,-723.39"/>
<polygon fill="black" stroke="black" points="3736,-723.12 3732.5,-713.12 3729,-723.12 3736,-723.12"/>
</g>
<!-- layer_15_mlp_fc1_gpu13 -->
<g id="node690" class="node">
<title>layer_15_mlp_fc1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3899,-712.97 3800,-712.97 3800,-660.97 3899,-660.97 3899,-712.97"/>
<text text-anchor="middle" x="3849.5" y="-700.97" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="3849.5" y="-689.97" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3849.5" y="-678.97" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3849.5" y="-667.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu13 -->
<g id="edge1153" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu13</title>
<path fill="none" stroke="black" d="M3761.12,-748.77C3774.13,-739.82 3789.83,-729.02 3804.37,-719.02"/>
<polygon fill="black" stroke="black" points="3806.51,-721.79 3812.76,-713.24 3802.54,-716.03 3806.51,-721.79"/>
</g>
<!-- layer_15_mlp_fc1_gpu14 -->
<g id="node691" class="node">
<title>layer_15_mlp_fc1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4016,-712.97 3917,-712.97 3917,-660.97 4016,-660.97 4016,-712.97"/>
<text text-anchor="middle" x="3966.5" y="-700.97" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="3966.5" y="-689.97" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3966.5" y="-678.97" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3966.5" y="-667.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu14 -->
<g id="edge1154" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu14</title>
<path fill="none" stroke="black" d="M3769.27,-758.05C3803.1,-748.21 3854.79,-732.52 3907.46,-713.23"/>
<polygon fill="black" stroke="black" points="3908.8,-716.46 3916.96,-709.71 3906.37,-709.9 3908.8,-716.46"/>
</g>
<!-- layer_15_mlp_fc1_gpu15 -->
<g id="node692" class="node">
<title>layer_15_mlp_fc1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4133,-712.97 4034,-712.97 4034,-660.97 4133,-660.97 4133,-712.97"/>
<text text-anchor="middle" x="4083.5" y="-700.97" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="4083.5" y="-689.97" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="4083.5" y="-678.97" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="4083.5" y="-667.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu15 -->
<g id="edge1155" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu15</title>
<path fill="none" stroke="black" d="M3769.21,-764.15C3823.46,-757.2 3928.15,-741.63 4023.94,-713.2"/>
<polygon fill="black" stroke="black" points="4025.22,-716.47 4033.77,-710.22 4023.19,-709.77 4025.22,-716.47"/>
</g>
<!-- layer_15_allgather_mlp -->
<g id="node693" class="node">
<title>layer_15_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="3673.5" cy="-595.97" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="3673.5" y="-604.47" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="3673.5" y="-593.47" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="3673.5" y="-582.47" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_15_mlp_fc1_gpu8&#45;&gt;layer_15_allgather_mlp -->
<g id="edge1156" class="edge">
<title>layer_15_mlp_fc1_gpu8&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M3314.11,-664.04C3317.26,-662.93 3320.41,-661.89 3323.5,-660.97 3420.8,-631.84 3537.48,-613.73 3608.52,-604.5"/>
<polygon fill="black" stroke="black" points="3609.19,-607.95 3618.66,-603.21 3608.3,-601 3609.19,-607.95"/>
</g>
<!-- layer_15_mlp_fc1_gpu9&#45;&gt;layer_15_allgather_mlp -->
<g id="edge1157" class="edge">
<title>layer_15_mlp_fc1_gpu9&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M3431.21,-664.35C3434.34,-663.16 3437.45,-662.02 3440.5,-660.97 3498.03,-640.98 3565.24,-623.08 3612.65,-611.33"/>
<polygon fill="black" stroke="black" points="3613.58,-614.71 3622.46,-608.92 3611.91,-607.91 3613.58,-614.71"/>
</g>
<!-- layer_15_mlp_fc1_gpu10&#45;&gt;layer_15_allgather_mlp -->
<g id="edge1158" class="edge">
<title>layer_15_mlp_fc1_gpu10&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M3547.71,-660.94C3571.92,-648.63 3600.99,-633.85 3625.08,-621.59"/>
<polygon fill="black" stroke="black" points="3626.73,-624.69 3634.05,-617.03 3623.55,-618.45 3626.73,-624.69"/>
</g>
<!-- layer_15_mlp_fc1_gpu11&#45;&gt;layer_15_allgather_mlp -->
<g id="edge1159" class="edge">
<title>layer_15_mlp_fc1_gpu11&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M3631.97,-660.7C3637.71,-651.89 3644.27,-641.83 3650.44,-632.35"/>
<polygon fill="black" stroke="black" points="3653.45,-634.14 3655.98,-623.86 3647.59,-630.32 3653.45,-634.14"/>
</g>
<!-- layer_15_mlp_fc1_gpu12&#45;&gt;layer_15_allgather_mlp -->
<g id="edge1160" class="edge">
<title>layer_15_mlp_fc1_gpu12&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M3715.75,-660.7C3709.86,-651.81 3703.12,-641.65 3696.78,-632.09"/>
<polygon fill="black" stroke="black" points="3699.56,-629.94 3691.11,-623.54 3693.72,-633.81 3699.56,-629.94"/>
</g>
<!-- layer_15_mlp_fc1_gpu13&#45;&gt;layer_15_allgather_mlp -->
<g id="edge1161" class="edge">
<title>layer_15_mlp_fc1_gpu13&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M3800.01,-660.94C3775.57,-648.59 3746.21,-633.74 3721.92,-621.46"/>
<polygon fill="black" stroke="black" points="3723.39,-618.28 3712.89,-616.89 3720.23,-624.52 3723.39,-618.28"/>
</g>
<!-- layer_15_mlp_fc1_gpu14&#45;&gt;layer_15_allgather_mlp -->
<g id="edge1162" class="edge">
<title>layer_15_mlp_fc1_gpu14&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M3916.69,-663.97C3913.93,-662.91 3911.19,-661.91 3908.5,-660.97 3850.37,-640.64 3782.32,-622.73 3734.45,-611.06"/>
<polygon fill="black" stroke="black" points="3735.1,-607.62 3724.56,-608.67 3733.45,-614.42 3735.1,-607.62"/>
</g>
<!-- layer_15_mlp_fc1_gpu15&#45;&gt;layer_15_allgather_mlp -->
<g id="edge1163" class="edge">
<title>layer_15_mlp_fc1_gpu15&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M4033.78,-663.68C4031,-662.7 4028.23,-661.79 4025.5,-660.97 3927.6,-631.39 3810.02,-613.39 3738.58,-604.3"/>
<polygon fill="black" stroke="black" points="3738.73,-600.8 3728.38,-603.03 3737.87,-607.74 3738.73,-600.8"/>
</g>
<!-- layer_15_gelu -->
<g id="node694" class="node">
<title>layer_15_gelu</title>
<polygon fill="lightblue" stroke="black" points="3718,-530.98 3629,-530.98 3629,-494.98 3718,-494.98 3718,-530.98"/>
<text text-anchor="middle" x="3673.5" y="-515.98" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="3673.5" y="-504.98" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_15_allgather_mlp&#45;&gt;layer_15_gelu -->
<g id="edge1164" class="edge">
<title>layer_15_allgather_mlp&#45;&gt;layer_15_gelu</title>
<path fill="none" stroke="black" d="M3673.5,-566.65C3673.5,-558.4 3673.5,-549.41 3673.5,-541.23"/>
<polygon fill="black" stroke="black" points="3677,-541.08 3673.5,-531.08 3670,-541.08 3677,-541.08"/>
</g>
<!-- layer_15_mlp_fc2_gpu8 -->
<g id="node695" class="node">
<title>layer_15_mlp_fc2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3314,-458.98 3215,-458.98 3215,-406.98 3314,-406.98 3314,-458.98"/>
<text text-anchor="middle" x="3264.5" y="-446.98" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="3264.5" y="-435.98" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3264.5" y="-424.98" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3264.5" y="-413.98" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu8 -->
<g id="edge1165" class="edge">
<title>layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu8</title>
<path fill="none" stroke="black" d="M3628.82,-508.82C3563.45,-503.41 3438.05,-490.07 3324.02,-458.8"/>
<polygon fill="black" stroke="black" points="3324.65,-455.35 3314.08,-456.02 3322.76,-462.09 3324.65,-455.35"/>
</g>
<!-- layer_15_mlp_fc2_gpu9 -->
<g id="node696" class="node">
<title>layer_15_mlp_fc2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3431,-458.98 3332,-458.98 3332,-406.98 3431,-406.98 3431,-458.98"/>
<text text-anchor="middle" x="3381.5" y="-446.98" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="3381.5" y="-435.98" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3381.5" y="-424.98" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3381.5" y="-413.98" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu9 -->
<g id="edge1166" class="edge">
<title>layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu9</title>
<path fill="none" stroke="black" d="M3628.63,-504.22C3583.37,-495.86 3511.48,-481.09 3441.08,-458.93"/>
<polygon fill="black" stroke="black" points="3441.75,-455.47 3431.16,-455.76 3439.61,-462.14 3441.75,-455.47"/>
</g>
<!-- layer_15_mlp_fc2_gpu10 -->
<g id="node697" class="node">
<title>layer_15_mlp_fc2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3548,-458.98 3449,-458.98 3449,-406.98 3548,-406.98 3548,-458.98"/>
<text text-anchor="middle" x="3498.5" y="-446.98" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="3498.5" y="-435.98" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3498.5" y="-424.98" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3498.5" y="-413.98" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu10 -->
<g id="edge1167" class="edge">
<title>layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu10</title>
<path fill="none" stroke="black" d="M3635.1,-494.87C3612.33,-484.72 3583.02,-471.66 3557.39,-460.23"/>
<polygon fill="black" stroke="black" points="3558.69,-456.98 3548.13,-456.1 3555.84,-463.37 3558.69,-456.98"/>
</g>
<!-- layer_15_mlp_fc2_gpu11 -->
<g id="node698" class="node">
<title>layer_15_mlp_fc2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3665,-458.98 3566,-458.98 3566,-406.98 3665,-406.98 3665,-458.98"/>
<text text-anchor="middle" x="3615.5" y="-446.98" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="3615.5" y="-435.98" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3615.5" y="-424.98" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3615.5" y="-413.98" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu11 -->
<g id="edge1168" class="edge">
<title>layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu11</title>
<path fill="none" stroke="black" d="M3660.63,-494.67C3654.64,-486.62 3647.31,-476.76 3640.3,-467.34"/>
<polygon fill="black" stroke="black" points="3643.06,-465.18 3634.28,-459.24 3637.44,-469.35 3643.06,-465.18"/>
</g>
<!-- layer_15_mlp_fc2_gpu12 -->
<g id="node699" class="node">
<title>layer_15_mlp_fc2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3782,-458.98 3683,-458.98 3683,-406.98 3782,-406.98 3782,-458.98"/>
<text text-anchor="middle" x="3732.5" y="-446.98" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="3732.5" y="-435.98" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3732.5" y="-424.98" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3732.5" y="-413.98" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu12 -->
<g id="edge1169" class="edge">
<title>layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu12</title>
<path fill="none" stroke="black" d="M3686.59,-494.67C3692.69,-486.62 3700.15,-476.76 3707.27,-467.34"/>
<polygon fill="black" stroke="black" points="3710.15,-469.33 3713.4,-459.24 3704.57,-465.1 3710.15,-469.33"/>
</g>
<!-- layer_15_mlp_fc2_gpu13 -->
<g id="node700" class="node">
<title>layer_15_mlp_fc2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3899,-458.98 3800,-458.98 3800,-406.98 3899,-406.98 3899,-458.98"/>
<text text-anchor="middle" x="3849.5" y="-446.98" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="3849.5" y="-435.98" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3849.5" y="-424.98" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3849.5" y="-413.98" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu13 -->
<g id="edge1170" class="edge">
<title>layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu13</title>
<path fill="none" stroke="black" d="M3712.12,-494.87C3735.1,-484.68 3764.73,-471.55 3790.58,-460.1"/>
<polygon fill="black" stroke="black" points="3792.19,-463.21 3799.91,-455.96 3789.35,-456.81 3792.19,-463.21"/>
</g>
<!-- layer_15_mlp_fc2_gpu14 -->
<g id="node701" class="node">
<title>layer_15_mlp_fc2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4016,-458.98 3917,-458.98 3917,-406.98 4016,-406.98 4016,-458.98"/>
<text text-anchor="middle" x="3966.5" y="-446.98" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="3966.5" y="-435.98" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3966.5" y="-424.98" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3966.5" y="-413.98" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu14 -->
<g id="edge1171" class="edge">
<title>layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu14</title>
<path fill="none" stroke="black" d="M3718.34,-504.43C3763.98,-496.17 3836.76,-481.46 3906.87,-459.3"/>
<polygon fill="black" stroke="black" points="3908.29,-462.52 3916.74,-456.13 3906.15,-455.86 3908.29,-462.52"/>
</g>
<!-- layer_15_mlp_fc2_gpu15 -->
<g id="node702" class="node">
<title>layer_15_mlp_fc2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4133,-458.98 4034,-458.98 4034,-406.98 4133,-406.98 4133,-458.98"/>
<text text-anchor="middle" x="4083.5" y="-446.98" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="4083.5" y="-435.98" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="4083.5" y="-424.98" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="4083.5" y="-413.98" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu15 -->
<g id="edge1172" class="edge">
<title>layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu15</title>
<path fill="none" stroke="black" d="M3718.18,-508.96C3783.87,-503.71 3910.23,-490.56 4023.91,-459.16"/>
<polygon fill="black" stroke="black" points="4025.14,-462.45 4033.81,-456.37 4023.24,-455.71 4025.14,-462.45"/>
</g>
<!-- layer_15_allreduce_mlp -->
<g id="node703" class="node">
<title>layer_15_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="3732.5" cy="-341.99" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="3732.5" y="-350.49" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="3732.5" y="-339.49" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="3732.5" y="-328.49" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_15_mlp_fc2_gpu8&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge1173" class="edge">
<title>layer_15_mlp_fc2_gpu8&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3314.08,-409.96C3317.24,-408.87 3320.4,-407.87 3323.5,-406.98 3440.27,-373.66 3581.05,-356.45 3663.3,-348.6"/>
<polygon fill="black" stroke="black" points="3663.64,-352.08 3673.27,-347.66 3662.99,-345.11 3663.64,-352.08"/>
</g>
<!-- layer_15_mlp_fc2_gpu9&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge1174" class="edge">
<title>layer_15_mlp_fc2_gpu9&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3431.15,-410.18C3434.29,-409.04 3437.43,-407.96 3440.5,-406.98 3516.35,-382.83 3606.12,-364.65 3665.91,-353.95"/>
<polygon fill="black" stroke="black" points="3666.74,-357.36 3675.98,-352.17 3665.53,-350.47 3666.74,-357.36"/>
</g>
<!-- layer_15_mlp_fc2_gpu10&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge1175" class="edge">
<title>layer_15_mlp_fc2_gpu10&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3548,-410.8C3551.21,-409.49 3554.4,-408.21 3557.5,-406.98 3596.39,-391.64 3640.62,-375.48 3674.88,-363.24"/>
<polygon fill="black" stroke="black" points="3676.48,-366.39 3684.72,-359.73 3674.13,-359.79 3676.48,-366.39"/>
</g>
<!-- layer_15_mlp_fc2_gpu11&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge1176" class="edge">
<title>layer_15_mlp_fc2_gpu11&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3648.4,-406.96C3662.19,-396.47 3678.34,-384.19 3692.78,-373.2"/>
<polygon fill="black" stroke="black" points="3695.21,-375.75 3701.05,-366.91 3690.97,-370.18 3695.21,-375.75"/>
</g>
<!-- layer_15_mlp_fc2_gpu12&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge1177" class="edge">
<title>layer_15_mlp_fc2_gpu12&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3732.5,-406.72C3732.5,-398.83 3732.5,-389.94 3732.5,-381.36"/>
<polygon fill="black" stroke="black" points="3736,-381.13 3732.5,-371.13 3729,-381.13 3736,-381.13"/>
</g>
<!-- layer_15_mlp_fc2_gpu13&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge1178" class="edge">
<title>layer_15_mlp_fc2_gpu13&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3816.6,-406.96C3802.81,-396.47 3786.66,-384.19 3772.22,-373.2"/>
<polygon fill="black" stroke="black" points="3774.03,-370.18 3763.95,-366.91 3769.79,-375.75 3774.03,-370.18"/>
</g>
<!-- layer_15_mlp_fc2_gpu14&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge1179" class="edge">
<title>layer_15_mlp_fc2_gpu14&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3916.91,-410.38C3914.07,-409.21 3911.25,-408.07 3908.5,-406.98 3869.28,-391.41 3824.58,-375.18 3790.05,-362.96"/>
<polygon fill="black" stroke="black" points="3791.19,-359.65 3780.59,-359.63 3788.86,-366.25 3791.19,-359.65"/>
</g>
<!-- layer_15_mlp_fc2_gpu15&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge1180" class="edge">
<title>layer_15_mlp_fc2_gpu15&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4033.75,-409.82C4030.98,-408.81 4028.21,-407.86 4025.5,-406.98 3949.35,-382.51 3859.09,-364.36 3799.07,-353.77"/>
<polygon fill="black" stroke="black" points="3799.42,-350.27 3788.97,-352 3798.22,-357.17 3799.42,-350.27"/>
</g>
<!-- layer_15_allreduce_mlp&#45;&gt;layer_15_residual2 -->
<g id="edge1181" class="edge">
<title>layer_15_allreduce_mlp&#45;&gt;layer_15_residual2</title>
<path fill="none" stroke="black" d="M3776.32,-321.95C3808.43,-308 3852.35,-288.91 3887.53,-273.62"/>
<polygon fill="black" stroke="black" points="3888.97,-276.82 3896.74,-269.62 3886.18,-270.4 3888.97,-276.82"/>
</g>
<!-- layer_15_ln2 -->
<g id="node705" class="node">
<title>layer_15_ln2</title>
<polygon fill="lightblue" stroke="black" points="3983,-181 3910,-181 3910,-140 3983,-140 3983,-181"/>
<text text-anchor="middle" x="3946.5" y="-169" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="3946.5" y="-158" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="3946.5" y="-147" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_15_residual2&#45;&gt;layer_15_ln2 -->
<g id="edge1183" class="edge">
<title>layer_15_residual2&#45;&gt;layer_15_ln2</title>
<path fill="none" stroke="black" d="M3946.5,-216.92C3946.5,-208.6 3946.5,-199.51 3946.5,-191.15"/>
<polygon fill="black" stroke="black" points="3950,-191.07 3946.5,-181.07 3943,-191.07 3950,-191.07"/>
</g>
<!-- layer_15_ln2&#45;&gt;output -->
<g id="edge1184" class="edge">
<title>layer_15_ln2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3946.5,-139.97C3946.5,-132.56 3946.5,-123.67 3946.5,-114.45"/>
<polygon fill="black" stroke="black" points="3950,-114.36 3946.5,-104.36 3943,-114.36 3950,-114.36"/>
</g>
</g>
</svg>
