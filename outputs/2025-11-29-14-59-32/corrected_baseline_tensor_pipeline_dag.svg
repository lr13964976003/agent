<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_tensor_pipeline_dag Pages: 1 -->
<svg width="6393pt" height="22971pt"
 viewBox="0.00 0.00 6393.00 22970.90" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 22966.9)">
<title>baseline_tensor_pipeline_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-22966.9 6389,-22966.9 6389,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="657.94,-22962.9 535.55,-22962.9 504.06,-22858.9 626.45,-22858.9 657.94,-22962.9"/>
<text text-anchor="middle" x="581" y="-22924.9" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="581" y="-22913.9" font-family="Arial" font-size="10.00">Batch: 128</text>
<text text-anchor="middle" x="581" y="-22902.9" font-family="Arial" font-size="10.00">Seq: 10000</text>
<text text-anchor="middle" x="581" y="-22891.9" font-family="Arial" font-size="10.00">Hidden: 4096</text>
</g>
<!-- layer_0_input_dist -->
<g id="node2" class="node">
<title>layer_0_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="675.19,-22822.9 525.36,-22822.9 486.81,-22762.9 636.64,-22762.9 675.19,-22822.9"/>
<text text-anchor="middle" x="581" y="-22795.9" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="581" y="-22784.9" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- input&#45;&gt;layer_0_input_dist -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_0_input_dist</title>
<path fill="none" stroke="black" d="M574.29,-22858.68C574.19,-22850.06 574.28,-22841.24 574.58,-22832.99"/>
<polygon fill="black" stroke="black" points="578.08,-22833.06 575.06,-22822.9 571.09,-22832.72 578.08,-22833.06"/>
</g>
<!-- input&#45;&gt;layer_0_input_dist -->
<g id="edge2" class="edge">
<title>input&#45;&gt;layer_0_input_dist</title>
<path fill="none" stroke="black" d="M587.71,-22858.68C587.81,-22850.06 587.72,-22841.24 587.42,-22832.99"/>
<polygon fill="black" stroke="black" points="590.91,-22832.72 586.94,-22822.9 583.92,-22833.06 590.91,-22832.72"/>
</g>
<!-- layer_0_qkv_gpu0 -->
<g id="node3" class="node">
<title>layer_0_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="183.5,-22726.9 90.5,-22726.9 90.5,-22674.9 183.5,-22674.9 183.5,-22726.9"/>
<text text-anchor="middle" x="137" y="-22714.9" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="137" y="-22703.9" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="137" y="-22692.9" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="137" y="-22681.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu0 -->
<g id="edge3" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu0</title>
<path fill="none" stroke="black" d="M500.63,-22784.65C423.23,-22776.29 303.17,-22759.64 193.36,-22727.03"/>
<polygon fill="black" stroke="black" points="194.38,-22723.68 183.79,-22724.14 192.35,-22730.38 194.38,-22723.68"/>
</g>
<!-- layer_0_qkv_gpu1 -->
<g id="node4" class="node">
<title>layer_0_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="294.5,-22726.9 201.5,-22726.9 201.5,-22674.9 294.5,-22674.9 294.5,-22726.9"/>
<text text-anchor="middle" x="248" y="-22714.9" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="248" y="-22703.9" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="248" y="-22692.9" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="248" y="-22681.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu1 -->
<g id="edge4" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu1</title>
<path fill="none" stroke="black" d="M495.22,-22776.39C442.14,-22765.74 372.68,-22749.89 304.21,-22727.08"/>
<polygon fill="black" stroke="black" points="305.15,-22723.7 294.55,-22723.81 302.91,-22730.33 305.15,-22723.7"/>
</g>
<!-- layer_0_qkv_gpu2 -->
<g id="node5" class="node">
<title>layer_0_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="405.5,-22726.9 312.5,-22726.9 312.5,-22674.9 405.5,-22674.9 405.5,-22726.9"/>
<text text-anchor="middle" x="359" y="-22714.9" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="359" y="-22703.9" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="359" y="-22692.9" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="359" y="-22681.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu2 -->
<g id="edge5" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu2</title>
<path fill="none" stroke="black" d="M503.74,-22762.85C477.81,-22752.86 448.62,-22741.34 415.25,-22727.36"/>
<polygon fill="black" stroke="black" points="416.3,-22724.01 405.73,-22723.35 413.59,-22730.46 416.3,-22724.01"/>
</g>
<!-- layer_0_qkv_gpu3 -->
<g id="node6" class="node">
<title>layer_0_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="516.5,-22726.9 423.5,-22726.9 423.5,-22674.9 516.5,-22674.9 516.5,-22726.9"/>
<text text-anchor="middle" x="470" y="-22714.9" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="470" y="-22703.9" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="470" y="-22692.9" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="470" y="-22681.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu3 -->
<g id="edge6" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu3</title>
<path fill="none" stroke="black" d="M544.96,-22762.68C533.44,-22753.33 520.64,-22742.95 508.92,-22733.45"/>
<polygon fill="black" stroke="black" points="510.98,-22730.62 501.01,-22727.04 506.58,-22736.06 510.98,-22730.62"/>
</g>
<!-- layer_0_qkv_gpu4 -->
<g id="node7" class="node">
<title>layer_0_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="627.5,-22726.9 534.5,-22726.9 534.5,-22674.9 627.5,-22674.9 627.5,-22726.9"/>
<text text-anchor="middle" x="581" y="-22714.9" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="581" y="-22703.9" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="581" y="-22692.9" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="581" y="-22681.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu4 -->
<g id="edge7" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu4</title>
<path fill="none" stroke="black" d="M581,-22762.43C581,-22754.35 581,-22745.52 581,-22737.16"/>
<polygon fill="black" stroke="black" points="584.5,-22736.91 581,-22726.91 577.5,-22736.91 584.5,-22736.91"/>
</g>
<!-- layer_0_qkv_gpu5 -->
<g id="node8" class="node">
<title>layer_0_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="738.5,-22726.9 645.5,-22726.9 645.5,-22674.9 738.5,-22674.9 738.5,-22726.9"/>
<text text-anchor="middle" x="692" y="-22714.9" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="692" y="-22703.9" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="692" y="-22692.9" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="692" y="-22681.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu5 -->
<g id="edge8" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu5</title>
<path fill="none" stroke="black" d="M617.04,-22762.68C628.56,-22753.33 641.36,-22742.95 653.08,-22733.45"/>
<polygon fill="black" stroke="black" points="655.42,-22736.06 660.99,-22727.04 651.02,-22730.62 655.42,-22736.06"/>
</g>
<!-- layer_0_qkv_gpu6 -->
<g id="node9" class="node">
<title>layer_0_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="849.5,-22726.9 756.5,-22726.9 756.5,-22674.9 849.5,-22674.9 849.5,-22726.9"/>
<text text-anchor="middle" x="803" y="-22714.9" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="803" y="-22703.9" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="803" y="-22692.9" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="803" y="-22681.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu6 -->
<g id="edge9" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu6</title>
<path fill="none" stroke="black" d="M641.23,-22769.38C670.83,-22758.1 707.18,-22743.92 746.92,-22727.28"/>
<polygon fill="black" stroke="black" points="748.41,-22730.45 756.27,-22723.35 745.7,-22724 748.41,-22730.45"/>
</g>
<!-- layer_0_qkv_gpu7 -->
<g id="node10" class="node">
<title>layer_0_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="960.5,-22726.9 867.5,-22726.9 867.5,-22674.9 960.5,-22674.9 960.5,-22726.9"/>
<text text-anchor="middle" x="914" y="-22714.9" font-family="Arial" font-size="10.00">Layer 0 QKV Proj</text>
<text text-anchor="middle" x="914" y="-22703.9" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="914" y="-22692.9" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="914" y="-22681.9" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_qkv_gpu7 -->
<g id="edge10" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_qkv_gpu7</title>
<path fill="none" stroke="black" d="M647.75,-22780.13C702.38,-22769.63 781.57,-22752.42 857.7,-22727.11"/>
<polygon fill="black" stroke="black" points="859.09,-22730.33 867.45,-22723.81 856.85,-22723.7 859.09,-22730.33"/>
</g>
<!-- layer_0_residual1 -->
<g id="node22" class="node">
<title>layer_0_residual1</title>
<polygon fill="lightyellow" stroke="black" points="944.94,-22274.93 822.55,-22274.93 791.06,-22214.93 913.45,-22214.93 944.94,-22274.93"/>
<text text-anchor="middle" x="868" y="-22247.93" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="868" y="-22236.93" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_0_input_dist&#45;&gt;layer_0_residual1 -->
<g id="edge30" class="edge">
<title>layer_0_input_dist&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M651.87,-22786.13C748.96,-22777.21 917.28,-22757.8 970,-22726.9 1027,-22693.48 1063,-22676.98 1063,-22610.91 1063,-22610.91 1063,-22610.91 1063,-22429.91 1063,-22361.13 998.02,-22310.45 943.09,-22279.9"/>
<polygon fill="black" stroke="black" points="944.48,-22276.67 934.02,-22274.98 941.14,-22282.82 944.48,-22276.67"/>
</g>
<!-- layer_0_allgather_qkv -->
<g id="node11" class="node">
<title>layer_0_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="470" cy="-22609.91" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="470" y="-22618.41" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="470" y="-22607.41" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="470" y="-22596.41" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_0_qkv_gpu0&#45;&gt;layer_0_allgather_qkv -->
<g id="edge11" class="edge">
<title>layer_0_qkv_gpu0&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M183.55,-22677.97C186.39,-22676.87 189.22,-22675.84 192,-22674.9 263.8,-22650.59 349.12,-22632.47 406.13,-22621.83"/>
<polygon fill="black" stroke="black" points="406.88,-22625.25 416.08,-22620 405.61,-22618.37 406.88,-22625.25"/>
</g>
<!-- layer_0_qkv_gpu1&#45;&gt;layer_0_allgather_qkv -->
<g id="edge12" class="edge">
<title>layer_0_qkv_gpu1&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M294.72,-22678.43C297.52,-22677.21 300.29,-22676.03 303,-22674.9 340.02,-22659.41 382.22,-22643.25 414.94,-22631.04"/>
<polygon fill="black" stroke="black" points="416.19,-22634.31 424.34,-22627.55 413.75,-22627.75 416.19,-22634.31"/>
</g>
<!-- layer_0_qkv_gpu2&#45;&gt;layer_0_allgather_qkv -->
<g id="edge13" class="edge">
<title>layer_0_qkv_gpu2&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M390.22,-22674.87C403.29,-22664.38 418.61,-22652.1 432.31,-22641.12"/>
<polygon fill="black" stroke="black" points="434.55,-22643.81 440.17,-22634.82 430.17,-22638.35 434.55,-22643.81"/>
</g>
<!-- layer_0_qkv_gpu3&#45;&gt;layer_0_allgather_qkv -->
<g id="edge14" class="edge">
<title>layer_0_qkv_gpu3&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M470,-22674.63C470,-22666.74 470,-22657.85 470,-22649.27"/>
<polygon fill="black" stroke="black" points="473.5,-22649.05 470,-22639.05 466.5,-22649.05 473.5,-22649.05"/>
</g>
<!-- layer_0_qkv_gpu4&#45;&gt;layer_0_allgather_qkv -->
<g id="edge15" class="edge">
<title>layer_0_qkv_gpu4&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M549.78,-22674.87C536.71,-22664.38 521.39,-22652.1 507.69,-22641.12"/>
<polygon fill="black" stroke="black" points="509.83,-22638.35 499.83,-22634.82 505.45,-22643.81 509.83,-22638.35"/>
</g>
<!-- layer_0_qkv_gpu5&#45;&gt;layer_0_allgather_qkv -->
<g id="edge16" class="edge">
<title>layer_0_qkv_gpu5&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M645.28,-22678.43C642.48,-22677.21 639.71,-22676.03 637,-22674.9 599.98,-22659.41 557.78,-22643.25 525.06,-22631.04"/>
<polygon fill="black" stroke="black" points="526.25,-22627.75 515.66,-22627.55 523.81,-22634.31 526.25,-22627.75"/>
</g>
<!-- layer_0_qkv_gpu6&#45;&gt;layer_0_allgather_qkv -->
<g id="edge17" class="edge">
<title>layer_0_qkv_gpu6&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M756.45,-22677.97C753.61,-22676.87 750.78,-22675.84 748,-22674.9 676.2,-22650.59 590.88,-22632.47 533.87,-22621.83"/>
<polygon fill="black" stroke="black" points="534.39,-22618.37 523.92,-22620 533.12,-22625.25 534.39,-22618.37"/>
</g>
<!-- layer_0_qkv_gpu7&#45;&gt;layer_0_allgather_qkv -->
<g id="edge18" class="edge">
<title>layer_0_qkv_gpu7&#45;&gt;layer_0_allgather_qkv</title>
<path fill="none" stroke="black" d="M867.21,-22677.65C864.46,-22676.65 861.71,-22675.72 859,-22674.9 748.69,-22641.4 615.14,-22624.28 536.68,-22616.49"/>
<polygon fill="black" stroke="black" points="536.75,-22612.98 526.45,-22615.49 536.07,-22619.94 536.75,-22612.98"/>
</g>
<!-- layer_0_attention -->
<g id="node12" class="node">
<title>layer_0_attention</title>
<polygon fill="lightblue" stroke="black" points="357,-22544.91 289,-22544.91 289,-22492.91 357,-22492.91 357,-22544.91"/>
<text text-anchor="middle" x="323" y="-22532.91" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="323" y="-22521.91" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="323" y="-22510.91" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="323" y="-22499.91" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_0_allgather_qkv&#45;&gt;layer_0_attention -->
<g id="edge19" class="edge">
<title>layer_0_allgather_qkv&#45;&gt;layer_0_attention</title>
<path fill="none" stroke="black" d="M434.04,-22587.14C413.42,-22574.65 387.41,-22558.91 365.75,-22545.8"/>
<polygon fill="black" stroke="black" points="367.44,-22542.73 357.07,-22540.54 363.82,-22548.71 367.44,-22542.73"/>
</g>
<!-- layer_0_attn_out_gpu7 -->
<g id="node20" class="node">
<title>layer_0_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="293,-22456.91 205,-22456.91 205,-22404.91 293,-22404.91 293,-22456.91"/>
<text text-anchor="middle" x="249" y="-22444.91" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="249" y="-22433.91" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="249" y="-22422.91" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="249" y="-22411.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attention&#45;&gt;layer_0_attn_out_gpu7 -->
<g id="edge20" class="edge">
<title>layer_0_attention&#45;&gt;layer_0_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M301.2,-22492.58C293.75,-22483.92 285.3,-22474.1 277.4,-22464.92"/>
<polygon fill="black" stroke="black" points="279.82,-22462.37 270.65,-22457.07 274.52,-22466.93 279.82,-22462.37"/>
</g>
<!-- layer_0_attn_out_gpu0 -->
<g id="node13" class="node">
<title>layer_0_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="399,-22456.91 311,-22456.91 311,-22404.91 399,-22404.91 399,-22456.91"/>
<text text-anchor="middle" x="355" y="-22444.91" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="355" y="-22433.91" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="355" y="-22422.91" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="355" y="-22411.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_allreduce_attn -->
<g id="node21" class="node">
<title>layer_0_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="673" cy="-22339.92" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="673" y="-22348.42" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="673" y="-22337.42" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="673" y="-22326.42" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_0_attn_out_gpu0&#45;&gt;layer_0_allreduce_attn -->
<g id="edge21" class="edge">
<title>layer_0_attn_out_gpu0&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M399.26,-22408.24C402.19,-22407.05 405.12,-22405.93 408,-22404.91 475.13,-22381.25 554.84,-22363.31 609.19,-22352.53"/>
<polygon fill="black" stroke="black" points="609.89,-22355.96 619.03,-22350.6 608.54,-22349.09 609.89,-22355.96"/>
</g>
<!-- layer_0_attn_out_gpu1 -->
<g id="node14" class="node">
<title>layer_0_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="505,-22456.91 417,-22456.91 417,-22404.91 505,-22404.91 505,-22456.91"/>
<text text-anchor="middle" x="461" y="-22444.91" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="461" y="-22433.91" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="461" y="-22422.91" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="461" y="-22411.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attn_out_gpu1&#45;&gt;layer_0_allreduce_attn -->
<g id="edge22" class="edge">
<title>layer_0_attn_out_gpu1&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M505.16,-22408.85C508.14,-22407.5 511.11,-22406.18 514,-22404.91 548.33,-22389.93 587.34,-22374.21 618.13,-22362.1"/>
<polygon fill="black" stroke="black" points="619.79,-22365.21 627.82,-22358.3 617.23,-22358.69 619.79,-22365.21"/>
</g>
<!-- layer_0_attn_out_gpu2 -->
<g id="node15" class="node">
<title>layer_0_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="611,-22456.91 523,-22456.91 523,-22404.91 611,-22404.91 611,-22456.91"/>
<text text-anchor="middle" x="567" y="-22444.91" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="567" y="-22433.91" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="567" y="-22422.91" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="567" y="-22411.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attn_out_gpu2&#45;&gt;layer_0_allreduce_attn -->
<g id="edge23" class="edge">
<title>layer_0_attn_out_gpu2&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M596.81,-22404.89C609.08,-22394.59 623.42,-22382.55 636.33,-22371.71"/>
<polygon fill="black" stroke="black" points="638.74,-22374.26 644.15,-22365.15 634.24,-22368.9 638.74,-22374.26"/>
</g>
<!-- layer_0_attn_out_gpu3 -->
<g id="node16" class="node">
<title>layer_0_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="717,-22456.91 629,-22456.91 629,-22404.91 717,-22404.91 717,-22456.91"/>
<text text-anchor="middle" x="673" y="-22444.91" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="673" y="-22433.91" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="673" y="-22422.91" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="673" y="-22411.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attn_out_gpu3&#45;&gt;layer_0_allreduce_attn -->
<g id="edge24" class="edge">
<title>layer_0_attn_out_gpu3&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M673,-22404.65C673,-22396.76 673,-22387.87 673,-22379.29"/>
<polygon fill="black" stroke="black" points="676.5,-22379.06 673,-22369.06 669.5,-22379.06 676.5,-22379.06"/>
</g>
<!-- layer_0_attn_out_gpu4 -->
<g id="node17" class="node">
<title>layer_0_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="823,-22456.91 735,-22456.91 735,-22404.91 823,-22404.91 823,-22456.91"/>
<text text-anchor="middle" x="779" y="-22444.91" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="779" y="-22433.91" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="779" y="-22422.91" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="779" y="-22411.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attn_out_gpu4&#45;&gt;layer_0_allreduce_attn -->
<g id="edge25" class="edge">
<title>layer_0_attn_out_gpu4&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M749.19,-22404.89C736.92,-22394.59 722.58,-22382.55 709.67,-22371.71"/>
<polygon fill="black" stroke="black" points="711.76,-22368.9 701.85,-22365.15 707.26,-22374.26 711.76,-22368.9"/>
</g>
<!-- layer_0_attn_out_gpu5 -->
<g id="node18" class="node">
<title>layer_0_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="929,-22456.91 841,-22456.91 841,-22404.91 929,-22404.91 929,-22456.91"/>
<text text-anchor="middle" x="885" y="-22444.91" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="885" y="-22433.91" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="885" y="-22422.91" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="885" y="-22411.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attn_out_gpu5&#45;&gt;layer_0_allreduce_attn -->
<g id="edge26" class="edge">
<title>layer_0_attn_out_gpu5&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M840.84,-22408.85C837.86,-22407.5 834.89,-22406.18 832,-22404.91 797.67,-22389.93 758.66,-22374.21 727.87,-22362.1"/>
<polygon fill="black" stroke="black" points="728.77,-22358.69 718.18,-22358.3 726.21,-22365.21 728.77,-22358.69"/>
</g>
<!-- layer_0_attn_out_gpu6 -->
<g id="node19" class="node">
<title>layer_0_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1035,-22456.91 947,-22456.91 947,-22404.91 1035,-22404.91 1035,-22456.91"/>
<text text-anchor="middle" x="991" y="-22444.91" font-family="Arial" font-size="10.00">Layer 0 Attn Out</text>
<text text-anchor="middle" x="991" y="-22433.91" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="991" y="-22422.91" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="991" y="-22411.91" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_0_attn_out_gpu6&#45;&gt;layer_0_allreduce_attn -->
<g id="edge27" class="edge">
<title>layer_0_attn_out_gpu6&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M946.74,-22408.24C943.81,-22407.05 940.88,-22405.93 938,-22404.91 870.87,-22381.25 791.16,-22363.31 736.81,-22352.53"/>
<polygon fill="black" stroke="black" points="737.46,-22349.09 726.97,-22350.6 736.11,-22355.96 737.46,-22349.09"/>
</g>
<!-- layer_0_attn_out_gpu7&#45;&gt;layer_0_allreduce_attn -->
<g id="edge28" class="edge">
<title>layer_0_attn_out_gpu7&#45;&gt;layer_0_allreduce_attn</title>
<path fill="none" stroke="black" d="M293.18,-22408.01C296.13,-22406.88 299.09,-22405.83 302,-22404.91 405.43,-22372.26 530.66,-22355.05 605.97,-22346.99"/>
<polygon fill="black" stroke="black" points="606.67,-22350.43 616.25,-22345.91 605.94,-22343.47 606.67,-22350.43"/>
</g>
<!-- layer_0_allreduce_attn&#45;&gt;layer_0_residual1 -->
<g id="edge29" class="edge">
<title>layer_0_allreduce_attn&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M714.35,-22319.2C742.12,-22305.96 779.09,-22288.33 809.81,-22273.68"/>
<polygon fill="black" stroke="black" points="811.6,-22276.7 819.12,-22269.24 808.59,-22270.38 811.6,-22276.7"/>
</g>
<!-- layer_0_ln1 -->
<g id="node23" class="node">
<title>layer_0_ln1</title>
<polygon fill="lightblue" stroke="black" points="531.5,-22178.93 458.5,-22178.93 458.5,-22137.93 531.5,-22137.93 531.5,-22178.93"/>
<text text-anchor="middle" x="495" y="-22166.93" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="495" y="-22155.93" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="495" y="-22144.93" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_0_residual1&#45;&gt;layer_0_ln1 -->
<g id="edge31" class="edge">
<title>layer_0_residual1&#45;&gt;layer_0_ln1</title>
<path fill="none" stroke="black" d="M797.84,-22228.04C722.92,-22211.06 606.3,-22184.65 541.83,-22170.04"/>
<polygon fill="black" stroke="black" points="542.47,-22166.6 531.94,-22167.8 540.92,-22173.42 542.47,-22166.6"/>
</g>
<!-- layer_0_residual2 -->
<g id="node43" class="node">
<title>layer_0_residual2</title>
<polygon fill="lightyellow" stroke="black" points="860.94,-21665.97 738.55,-21665.97 707.06,-21605.97 829.45,-21605.97 860.94,-21665.97"/>
<text text-anchor="middle" x="784" y="-21638.97" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="784" y="-21627.97" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_0_residual1&#45;&gt;layer_0_residual2 -->
<g id="edge59" class="edge">
<title>layer_0_residual1&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M907.27,-22214.76C942.94,-22184.62 990,-22134.02 990,-22076.93 990,-22076.93 990,-22076.93 990,-21820.95 990,-21750.74 922.61,-21700.66 864.92,-21670.65"/>
<polygon fill="black" stroke="black" points="866.26,-21667.4 855.76,-21666 863.1,-21673.64 866.26,-21667.4"/>
</g>
<!-- layer_0_mlp_fc1_gpu0 -->
<g id="node24" class="node">
<title>layer_0_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="94,-22101.93 0,-22101.93 0,-22049.93 94,-22049.93 94,-22101.93"/>
<text text-anchor="middle" x="47" y="-22089.93" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="47" y="-22078.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="47" y="-22067.93" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="47" y="-22056.93" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu0 -->
<g id="edge32" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M458.35,-22155.65C389.78,-22151.6 237.67,-22139.18 103.63,-22101.76"/>
<polygon fill="black" stroke="black" points="104.58,-22098.4 94.01,-22099.03 102.67,-22105.13 104.58,-22098.4"/>
</g>
<!-- layer_0_mlp_fc1_gpu1 -->
<g id="node25" class="node">
<title>layer_0_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="206,-22101.93 112,-22101.93 112,-22049.93 206,-22049.93 206,-22101.93"/>
<text text-anchor="middle" x="159" y="-22089.93" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="159" y="-22078.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="159" y="-22067.93" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="159" y="-22056.93" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu1 -->
<g id="edge33" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M458.1,-22152.81C405.76,-22145.67 307.05,-22130.07 215.73,-22101.88"/>
<polygon fill="black" stroke="black" points="216.66,-22098.5 206.07,-22098.83 214.55,-22105.17 216.66,-22098.5"/>
</g>
<!-- layer_0_mlp_fc1_gpu2 -->
<g id="node26" class="node">
<title>layer_0_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="318,-22101.93 224,-22101.93 224,-22049.93 318,-22049.93 318,-22101.93"/>
<text text-anchor="middle" x="271" y="-22089.93" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="271" y="-22078.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="271" y="-22067.93" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="271" y="-22056.93" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu2 -->
<g id="edge34" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M458.25,-22146.46C425.97,-22136.57 377.62,-22121.12 327.58,-22102.02"/>
<polygon fill="black" stroke="black" points="328.8,-22098.74 318.22,-22098.41 326.29,-22105.27 328.8,-22098.74"/>
</g>
<!-- layer_0_mlp_fc1_gpu3 -->
<g id="node27" class="node">
<title>layer_0_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="430,-22101.93 336,-22101.93 336,-22049.93 430,-22049.93 430,-22101.93"/>
<text text-anchor="middle" x="383" y="-22089.93" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="383" y="-22078.93" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="383" y="-22067.93" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="383" y="-22056.93" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu3 -->
<g id="edge35" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M467.6,-22137.74C455.27,-22128.87 440.4,-22118.19 426.59,-22108.26"/>
<polygon fill="black" stroke="black" points="428.33,-22105.2 418.17,-22102.21 424.24,-22110.89 428.33,-22105.2"/>
</g>
<!-- layer_0_mlp_fc1_gpu4 -->
<g id="node28" class="node">
<title>layer_0_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="542,-22101.93 448,-22101.93 448,-22049.93 542,-22049.93 542,-22101.93"/>
<text text-anchor="middle" x="495" y="-22089.93" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="495" y="-22078.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="495" y="-22067.93" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="495" y="-22056.93" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu4 -->
<g id="edge36" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M495,-22137.53C495,-22129.92 495,-22120.99 495,-22112.36"/>
<polygon fill="black" stroke="black" points="498.5,-22112.09 495,-22102.09 491.5,-22112.09 498.5,-22112.09"/>
</g>
<!-- layer_0_mlp_fc1_gpu5 -->
<g id="node29" class="node">
<title>layer_0_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="654,-22101.93 560,-22101.93 560,-22049.93 654,-22049.93 654,-22101.93"/>
<text text-anchor="middle" x="607" y="-22089.93" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="607" y="-22078.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="607" y="-22067.93" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="607" y="-22056.93" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu5 -->
<g id="edge37" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M522.4,-22137.74C534.73,-22128.87 549.6,-22118.19 563.41,-22108.26"/>
<polygon fill="black" stroke="black" points="565.76,-22110.89 571.83,-22102.21 561.67,-22105.2 565.76,-22110.89"/>
</g>
<!-- layer_0_mlp_fc1_gpu6 -->
<g id="node30" class="node">
<title>layer_0_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="766,-22101.93 672,-22101.93 672,-22049.93 766,-22049.93 766,-22101.93"/>
<text text-anchor="middle" x="719" y="-22089.93" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="719" y="-22078.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="719" y="-22067.93" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="719" y="-22056.93" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu6 -->
<g id="edge38" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M531.75,-22146.46C564.03,-22136.57 612.38,-22121.12 662.42,-22102.02"/>
<polygon fill="black" stroke="black" points="663.71,-22105.27 671.78,-22098.41 661.2,-22098.74 663.71,-22105.27"/>
</g>
<!-- layer_0_mlp_fc1_gpu7 -->
<g id="node31" class="node">
<title>layer_0_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="878,-22101.93 784,-22101.93 784,-22049.93 878,-22049.93 878,-22101.93"/>
<text text-anchor="middle" x="831" y="-22089.93" font-family="Arial" font-size="10.00">Layer 0 MLP FC1</text>
<text text-anchor="middle" x="831" y="-22078.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="831" y="-22067.93" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="831" y="-22056.93" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu7 -->
<g id="edge39" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M531.9,-22152.81C584.24,-22145.67 682.95,-22130.07 774.27,-22101.88"/>
<polygon fill="black" stroke="black" points="775.45,-22105.17 783.93,-22098.83 773.34,-22098.5 775.45,-22105.17"/>
</g>
<!-- layer_0_allgather_mlp -->
<g id="node32" class="node">
<title>layer_0_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="383" cy="-21984.94" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="383" y="-21993.44" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="383" y="-21982.44" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="383" y="-21971.44" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_0_mlp_fc1_gpu0&#45;&gt;layer_0_allgather_mlp -->
<g id="edge40" class="edge">
<title>layer_0_mlp_fc1_gpu0&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M94.1,-22053.13C97.09,-22051.99 100.07,-22050.91 103,-22049.93 175.84,-22025.61 262.37,-22007.39 319.76,-21996.74"/>
<polygon fill="black" stroke="black" points="320.57,-22000.15 329.78,-21994.9 319.31,-21993.26 320.57,-22000.15"/>
</g>
<!-- layer_0_mlp_fc1_gpu1&#45;&gt;layer_0_allgather_mlp -->
<g id="edge41" class="edge">
<title>layer_0_mlp_fc1_gpu1&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M206.28,-22053.6C209.22,-22052.34 212.15,-22051.11 215,-22049.93 252.41,-22034.47 295.04,-22018.25 327.99,-22006.01"/>
<polygon fill="black" stroke="black" points="329.29,-22009.26 337.45,-22002.5 326.86,-22002.7 329.29,-22009.26"/>
</g>
<!-- layer_0_mlp_fc1_gpu2&#45;&gt;layer_0_allgather_mlp -->
<g id="edge42" class="edge">
<title>layer_0_mlp_fc1_gpu2&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M302.5,-22049.9C315.69,-22039.42 331.15,-22027.14 344.98,-22016.15"/>
<polygon fill="black" stroke="black" points="347.24,-22018.82 352.9,-22009.86 342.89,-22013.34 347.24,-22018.82"/>
</g>
<!-- layer_0_mlp_fc1_gpu3&#45;&gt;layer_0_allgather_mlp -->
<g id="edge43" class="edge">
<title>layer_0_mlp_fc1_gpu3&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M383,-22049.67C383,-22041.78 383,-22032.89 383,-22024.31"/>
<polygon fill="black" stroke="black" points="386.5,-22024.08 383,-22014.08 379.5,-22024.08 386.5,-22024.08"/>
</g>
<!-- layer_0_mlp_fc1_gpu4&#45;&gt;layer_0_allgather_mlp -->
<g id="edge44" class="edge">
<title>layer_0_mlp_fc1_gpu4&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M463.5,-22049.9C450.31,-22039.42 434.85,-22027.14 421.02,-22016.15"/>
<polygon fill="black" stroke="black" points="423.11,-22013.34 413.1,-22009.86 418.76,-22018.82 423.11,-22013.34"/>
</g>
<!-- layer_0_mlp_fc1_gpu5&#45;&gt;layer_0_allgather_mlp -->
<g id="edge45" class="edge">
<title>layer_0_mlp_fc1_gpu5&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M559.72,-22053.6C556.78,-22052.34 553.85,-22051.11 551,-22049.93 513.59,-22034.47 470.96,-22018.25 438.01,-22006.01"/>
<polygon fill="black" stroke="black" points="439.14,-22002.7 428.55,-22002.5 436.71,-22009.26 439.14,-22002.7"/>
</g>
<!-- layer_0_mlp_fc1_gpu6&#45;&gt;layer_0_allgather_mlp -->
<g id="edge46" class="edge">
<title>layer_0_mlp_fc1_gpu6&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M671.9,-22053.13C668.91,-22051.99 665.93,-22050.91 663,-22049.93 590.16,-22025.61 503.63,-22007.39 446.24,-21996.74"/>
<polygon fill="black" stroke="black" points="446.69,-21993.26 436.22,-21994.9 445.43,-22000.15 446.69,-21993.26"/>
</g>
<!-- layer_0_mlp_fc1_gpu7&#45;&gt;layer_0_allgather_mlp -->
<g id="edge47" class="edge">
<title>layer_0_mlp_fc1_gpu7&#45;&gt;layer_0_allgather_mlp</title>
<path fill="none" stroke="black" d="M783.97,-22052.91C780.96,-22051.82 777.96,-22050.82 775,-22049.93 663.1,-22016.43 527.65,-21999.25 448.82,-21991.45"/>
<polygon fill="black" stroke="black" points="448.84,-21987.94 438.55,-21990.46 448.16,-21994.91 448.84,-21987.94"/>
</g>
<!-- layer_0_gelu -->
<g id="node33" class="node">
<title>layer_0_gelu</title>
<polygon fill="lightblue" stroke="black" points="259.5,-21919.95 170.5,-21919.95 170.5,-21883.95 259.5,-21883.95 259.5,-21919.95"/>
<text text-anchor="middle" x="215" y="-21904.95" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="215" y="-21893.95" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_0_allgather_mlp&#45;&gt;layer_0_gelu -->
<g id="edge48" class="edge">
<title>layer_0_allgather_mlp&#45;&gt;layer_0_gelu</title>
<path fill="none" stroke="black" d="M342.76,-21964.54C317.69,-21952.45 285.4,-21936.89 259.56,-21924.43"/>
<polygon fill="black" stroke="black" points="260.88,-21921.18 250.35,-21919.99 257.84,-21927.49 260.88,-21921.18"/>
</g>
<!-- layer_0_mlp_fc2_gpu7 -->
<g id="node41" class="node">
<title>layer_0_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="178,-21847.95 84,-21847.95 84,-21795.95 178,-21795.95 178,-21847.95"/>
<text text-anchor="middle" x="131" y="-21835.95" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="131" y="-21824.95" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="131" y="-21813.95" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="131" y="-21802.95" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu7 -->
<g id="edge49" class="edge">
<title>layer_0_gelu&#45;&gt;layer_0_mlp_fc2_gpu7</title>
<path fill="none" stroke="black" d="M196.36,-21883.64C187.33,-21875.26 176.2,-21864.92 165.7,-21855.17"/>
<polygon fill="black" stroke="black" points="167.91,-21852.44 158.2,-21848.21 163.15,-21857.57 167.91,-21852.44"/>
</g>
<!-- layer_0_mlp_fc2_gpu0 -->
<g id="node34" class="node">
<title>layer_0_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="290,-21847.95 196,-21847.95 196,-21795.95 290,-21795.95 290,-21847.95"/>
<text text-anchor="middle" x="243" y="-21835.95" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="243" y="-21824.95" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="243" y="-21813.95" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="243" y="-21802.95" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_allreduce_mlp -->
<g id="node42" class="node">
<title>layer_0_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="579" cy="-21730.96" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="579" y="-21739.46" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="579" y="-21728.46" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="579" y="-21717.46" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_0_mlp_fc2_gpu0&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge50" class="edge">
<title>layer_0_mlp_fc2_gpu0&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M290.1,-21799.14C293.09,-21798 296.07,-21796.93 299,-21795.95 370.61,-21772.04 455.46,-21754.02 512.84,-21743.3"/>
<polygon fill="black" stroke="black" points="513.67,-21746.7 522.87,-21741.45 512.4,-21739.82 513.67,-21746.7"/>
</g>
<!-- layer_0_mlp_fc2_gpu1 -->
<g id="node35" class="node">
<title>layer_0_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="402,-21847.95 308,-21847.95 308,-21795.95 402,-21795.95 402,-21847.95"/>
<text text-anchor="middle" x="355" y="-21835.95" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="355" y="-21824.95" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="355" y="-21813.95" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="355" y="-21802.95" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_mlp_fc2_gpu1&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge51" class="edge">
<title>layer_0_mlp_fc2_gpu1&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M402.28,-21799.62C405.22,-21798.36 408.15,-21797.13 411,-21795.95 447.89,-21780.7 489.84,-21764.72 522.6,-21752.54"/>
<polygon fill="black" stroke="black" points="523.85,-21755.81 532.01,-21749.05 521.42,-21749.25 523.85,-21755.81"/>
</g>
<!-- layer_0_mlp_fc2_gpu2 -->
<g id="node36" class="node">
<title>layer_0_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="514,-21847.95 420,-21847.95 420,-21795.95 514,-21795.95 514,-21847.95"/>
<text text-anchor="middle" x="467" y="-21835.95" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="467" y="-21824.95" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="467" y="-21813.95" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="467" y="-21802.95" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_mlp_fc2_gpu2&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge52" class="edge">
<title>layer_0_mlp_fc2_gpu2&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M498.5,-21795.92C511.59,-21785.52 526.9,-21773.35 540.64,-21762.44"/>
<polygon fill="black" stroke="black" points="542.86,-21765.14 548.51,-21756.18 538.51,-21759.66 542.86,-21765.14"/>
</g>
<!-- layer_0_mlp_fc2_gpu3 -->
<g id="node37" class="node">
<title>layer_0_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="626,-21847.95 532,-21847.95 532,-21795.95 626,-21795.95 626,-21847.95"/>
<text text-anchor="middle" x="579" y="-21835.95" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="579" y="-21824.95" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="579" y="-21813.95" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="579" y="-21802.95" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_mlp_fc2_gpu3&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge53" class="edge">
<title>layer_0_mlp_fc2_gpu3&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M579,-21795.68C579,-21787.79 579,-21778.9 579,-21770.32"/>
<polygon fill="black" stroke="black" points="582.5,-21770.1 579,-21760.1 575.5,-21770.1 582.5,-21770.1"/>
</g>
<!-- layer_0_mlp_fc2_gpu4 -->
<g id="node38" class="node">
<title>layer_0_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="738,-21847.95 644,-21847.95 644,-21795.95 738,-21795.95 738,-21847.95"/>
<text text-anchor="middle" x="691" y="-21835.95" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="691" y="-21824.95" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="691" y="-21813.95" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="691" y="-21802.95" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_mlp_fc2_gpu4&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge54" class="edge">
<title>layer_0_mlp_fc2_gpu4&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M659.5,-21795.92C646.41,-21785.52 631.1,-21773.35 617.36,-21762.44"/>
<polygon fill="black" stroke="black" points="619.49,-21759.66 609.49,-21756.18 615.14,-21765.14 619.49,-21759.66"/>
</g>
<!-- layer_0_mlp_fc2_gpu5 -->
<g id="node39" class="node">
<title>layer_0_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="850,-21847.95 756,-21847.95 756,-21795.95 850,-21795.95 850,-21847.95"/>
<text text-anchor="middle" x="803" y="-21835.95" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="803" y="-21824.95" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="803" y="-21813.95" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="803" y="-21802.95" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_mlp_fc2_gpu5&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge55" class="edge">
<title>layer_0_mlp_fc2_gpu5&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M755.72,-21799.62C752.78,-21798.36 749.85,-21797.13 747,-21795.95 710.11,-21780.7 668.16,-21764.72 635.4,-21752.54"/>
<polygon fill="black" stroke="black" points="636.58,-21749.25 625.99,-21749.05 634.15,-21755.81 636.58,-21749.25"/>
</g>
<!-- layer_0_mlp_fc2_gpu6 -->
<g id="node40" class="node">
<title>layer_0_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="962,-21847.95 868,-21847.95 868,-21795.95 962,-21795.95 962,-21847.95"/>
<text text-anchor="middle" x="915" y="-21835.95" font-family="Arial" font-size="10.00">Layer 0 MLP FC2</text>
<text text-anchor="middle" x="915" y="-21824.95" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="915" y="-21813.95" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="915" y="-21802.95" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_0_mlp_fc2_gpu6&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge56" class="edge">
<title>layer_0_mlp_fc2_gpu6&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M867.9,-21799.14C864.91,-21798 861.93,-21796.93 859,-21795.95 787.39,-21772.04 702.54,-21754.02 645.16,-21743.3"/>
<polygon fill="black" stroke="black" points="645.6,-21739.82 635.13,-21741.45 644.33,-21746.7 645.6,-21739.82"/>
</g>
<!-- layer_0_mlp_fc2_gpu7&#45;&gt;layer_0_allreduce_mlp -->
<g id="edge57" class="edge">
<title>layer_0_mlp_fc2_gpu7&#45;&gt;layer_0_allreduce_mlp</title>
<path fill="none" stroke="black" d="M178.03,-21798.93C181.04,-21797.84 184.04,-21796.83 187,-21795.95 297.16,-21762.97 430.15,-21745.8 509.47,-21737.84"/>
<polygon fill="black" stroke="black" points="510.21,-21741.29 519.82,-21736.82 509.53,-21734.32 510.21,-21741.29"/>
</g>
<!-- layer_0_allreduce_mlp&#45;&gt;layer_0_residual2 -->
<g id="edge58" class="edge">
<title>layer_0_allreduce_mlp&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M621.97,-21710.46C652,-21696.84 692.46,-21678.49 725.43,-21663.53"/>
<polygon fill="black" stroke="black" points="727.3,-21666.53 734.96,-21659.21 724.41,-21660.15 727.3,-21666.53"/>
</g>
<!-- layer_0_ln2 -->
<g id="node44" class="node">
<title>layer_0_ln2</title>
<polygon fill="lightblue" stroke="black" points="820.5,-21569.97 747.5,-21569.97 747.5,-21528.97 820.5,-21528.97 820.5,-21569.97"/>
<text text-anchor="middle" x="784" y="-21557.97" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="784" y="-21546.97" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="784" y="-21535.97" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_0_residual2&#45;&gt;layer_0_ln2 -->
<g id="edge60" class="edge">
<title>layer_0_residual2&#45;&gt;layer_0_ln2</title>
<path fill="none" stroke="black" d="M784,-21605.89C784,-21597.56 784,-21588.48 784,-21580.12"/>
<polygon fill="black" stroke="black" points="787.5,-21580.03 784,-21570.03 780.5,-21580.03 787.5,-21580.03"/>
</g>
<!-- layer_0_output_dist -->
<g id="node45" class="node">
<title>layer_0_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="885.7,-21492.97 723.92,-21492.97 682.3,-21432.97 844.08,-21432.97 885.7,-21492.97"/>
<text text-anchor="middle" x="784" y="-21465.97" font-family="Arial" font-size="10.00">Layer 0</text>
<text text-anchor="middle" x="784" y="-21454.97" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_0_ln2&#45;&gt;layer_0_output_dist -->
<g id="edge61" class="edge">
<title>layer_0_ln2&#45;&gt;layer_0_output_dist</title>
<path fill="none" stroke="black" d="M784,-21528.87C784,-21521.23 784,-21512.19 784,-21503.32"/>
<polygon fill="black" stroke="black" points="787.5,-21503.08 784,-21493.08 780.5,-21503.08 787.5,-21503.08"/>
</g>
<!-- layer_1_input_dist -->
<g id="node46" class="node">
<title>layer_1_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="878.19,-21396.97 728.36,-21396.97 689.81,-21336.97 839.64,-21336.97 878.19,-21396.97"/>
<text text-anchor="middle" x="784" y="-21369.97" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="784" y="-21358.97" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_0_output_dist&#45;&gt;layer_1_input_dist -->
<g id="edge62" class="edge">
<title>layer_0_output_dist&#45;&gt;layer_1_input_dist</title>
<path fill="none" stroke="black" d="M784,-21432.74C784,-21424.69 784,-21415.83 784,-21407.31"/>
<polygon fill="black" stroke="black" points="787.5,-21407.17 784,-21397.17 780.5,-21407.17 787.5,-21407.17"/>
</g>
<!-- layer_1_qkv_gpu0 -->
<g id="node47" class="node">
<title>layer_1_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="386.5,-21300.97 293.5,-21300.97 293.5,-21248.97 386.5,-21248.97 386.5,-21300.97"/>
<text text-anchor="middle" x="340" y="-21288.97" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="340" y="-21277.97" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="340" y="-21266.97" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="340" y="-21255.97" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu0 -->
<g id="edge63" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu0</title>
<path fill="none" stroke="black" d="M703.63,-21358.72C626.23,-21350.36 506.17,-21333.71 396.36,-21301.1"/>
<polygon fill="black" stroke="black" points="397.38,-21297.75 386.79,-21298.21 395.35,-21304.45 397.38,-21297.75"/>
</g>
<!-- layer_1_qkv_gpu1 -->
<g id="node48" class="node">
<title>layer_1_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="497.5,-21300.97 404.5,-21300.97 404.5,-21248.97 497.5,-21248.97 497.5,-21300.97"/>
<text text-anchor="middle" x="451" y="-21288.97" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="451" y="-21277.97" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="451" y="-21266.97" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="451" y="-21255.97" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu1 -->
<g id="edge64" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu1</title>
<path fill="none" stroke="black" d="M698.28,-21350.22C645.43,-21339.5 576.37,-21323.65 507.51,-21300.89"/>
<polygon fill="black" stroke="black" points="508.39,-21297.49 497.8,-21297.63 506.16,-21304.13 508.39,-21297.49"/>
</g>
<!-- layer_1_qkv_gpu2 -->
<g id="node49" class="node">
<title>layer_1_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="608.5,-21300.97 515.5,-21300.97 515.5,-21248.97 608.5,-21248.97 608.5,-21300.97"/>
<text text-anchor="middle" x="562" y="-21288.97" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="562" y="-21277.97" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="562" y="-21266.97" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="562" y="-21255.97" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu2 -->
<g id="edge65" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu2</title>
<path fill="none" stroke="black" d="M707.67,-21336.94C679.39,-21325.95 647.12,-21313.16 618,-21300.97 617.9,-21300.93 617.81,-21300.89 617.71,-21300.85"/>
<polygon fill="black" stroke="black" points="619.25,-21297.7 608.68,-21297 616.51,-21304.14 619.25,-21297.7"/>
</g>
<!-- layer_1_qkv_gpu3 -->
<g id="node50" class="node">
<title>layer_1_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="719.5,-21300.97 626.5,-21300.97 626.5,-21248.97 719.5,-21248.97 719.5,-21300.97"/>
<text text-anchor="middle" x="673" y="-21288.97" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="673" y="-21277.97" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="673" y="-21266.97" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="673" y="-21255.97" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu3 -->
<g id="edge66" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu3</title>
<path fill="none" stroke="black" d="M747.96,-21336.74C736.44,-21327.4 723.64,-21317.02 711.92,-21307.52"/>
<polygon fill="black" stroke="black" points="713.98,-21304.69 704.01,-21301.11 709.58,-21310.13 713.98,-21304.69"/>
</g>
<!-- layer_1_qkv_gpu4 -->
<g id="node51" class="node">
<title>layer_1_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="830.5,-21300.97 737.5,-21300.97 737.5,-21248.97 830.5,-21248.97 830.5,-21300.97"/>
<text text-anchor="middle" x="784" y="-21288.97" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="784" y="-21277.97" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="784" y="-21266.97" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="784" y="-21255.97" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu4 -->
<g id="edge67" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu4</title>
<path fill="none" stroke="black" d="M784,-21336.5C784,-21328.42 784,-21319.59 784,-21311.22"/>
<polygon fill="black" stroke="black" points="787.5,-21310.98 784,-21300.98 780.5,-21310.98 787.5,-21310.98"/>
</g>
<!-- layer_1_qkv_gpu5 -->
<g id="node52" class="node">
<title>layer_1_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="941.5,-21300.97 848.5,-21300.97 848.5,-21248.97 941.5,-21248.97 941.5,-21300.97"/>
<text text-anchor="middle" x="895" y="-21288.97" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="895" y="-21277.97" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="895" y="-21266.97" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="895" y="-21255.97" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu5 -->
<g id="edge68" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu5</title>
<path fill="none" stroke="black" d="M820.04,-21336.74C831.56,-21327.4 844.36,-21317.02 856.08,-21307.52"/>
<polygon fill="black" stroke="black" points="858.42,-21310.13 863.99,-21301.11 854.02,-21304.69 858.42,-21310.13"/>
</g>
<!-- layer_1_qkv_gpu6 -->
<g id="node53" class="node">
<title>layer_1_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1052.5,-21300.97 959.5,-21300.97 959.5,-21248.97 1052.5,-21248.97 1052.5,-21300.97"/>
<text text-anchor="middle" x="1006" y="-21288.97" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="1006" y="-21277.97" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1006" y="-21266.97" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1006" y="-21255.97" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu6 -->
<g id="edge69" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu6</title>
<path fill="none" stroke="black" d="M844.23,-21343.45C873.83,-21332.17 910.18,-21317.99 949.92,-21301.35"/>
<polygon fill="black" stroke="black" points="951.41,-21304.52 959.27,-21297.42 948.7,-21298.07 951.41,-21304.52"/>
</g>
<!-- layer_1_qkv_gpu7 -->
<g id="node54" class="node">
<title>layer_1_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1163.5,-21300.97 1070.5,-21300.97 1070.5,-21248.97 1163.5,-21248.97 1163.5,-21300.97"/>
<text text-anchor="middle" x="1117" y="-21288.97" font-family="Arial" font-size="10.00">Layer 1 QKV Proj</text>
<text text-anchor="middle" x="1117" y="-21277.97" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1117" y="-21266.97" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1117" y="-21255.97" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_qkv_gpu7 -->
<g id="edge70" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_qkv_gpu7</title>
<path fill="none" stroke="black" d="M850.75,-21354.2C905.38,-21343.7 984.57,-21326.49 1060.7,-21301.17"/>
<polygon fill="black" stroke="black" points="1062.09,-21304.4 1070.45,-21297.88 1059.85,-21297.77 1062.09,-21304.4"/>
</g>
<!-- layer_1_residual1 -->
<g id="node66" class="node">
<title>layer_1_residual1</title>
<polygon fill="lightyellow" stroke="black" points="1147.94,-20849 1025.55,-20849 994.06,-20789 1116.45,-20789 1147.94,-20849"/>
<text text-anchor="middle" x="1071" y="-20822" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="1071" y="-20811" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_1_input_dist&#45;&gt;layer_1_residual1 -->
<g id="edge90" class="edge">
<title>layer_1_input_dist&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M854.87,-21360.2C951.96,-21351.28 1120.28,-21331.87 1173,-21300.97 1230,-21267.55 1266,-21251.05 1266,-21184.97 1266,-21184.97 1266,-21184.97 1266,-21003.98 1266,-20935.2 1201.02,-20884.52 1146.09,-20853.97"/>
<polygon fill="black" stroke="black" points="1147.48,-20850.74 1137.02,-20849.05 1144.14,-20856.89 1147.48,-20850.74"/>
</g>
<!-- layer_1_allgather_qkv -->
<g id="node55" class="node">
<title>layer_1_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="673" cy="-21183.97" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="673" y="-21192.47" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="673" y="-21181.47" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="673" y="-21170.47" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_1_qkv_gpu0&#45;&gt;layer_1_allgather_qkv -->
<g id="edge71" class="edge">
<title>layer_1_qkv_gpu0&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M386.55,-21252.04C389.39,-21250.94 392.22,-21249.91 395,-21248.97 466.8,-21224.66 552.12,-21206.54 609.13,-21195.9"/>
<polygon fill="black" stroke="black" points="609.88,-21199.32 619.08,-21194.07 608.61,-21192.44 609.88,-21199.32"/>
</g>
<!-- layer_1_qkv_gpu1&#45;&gt;layer_1_allgather_qkv -->
<g id="edge72" class="edge">
<title>layer_1_qkv_gpu1&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M497.67,-21252.91C500.82,-21251.56 503.95,-21250.23 507,-21248.97 543.7,-21233.71 585.45,-21217.62 617.9,-21205.39"/>
<polygon fill="black" stroke="black" points="619.53,-21208.52 627.66,-21201.73 617.06,-21201.97 619.53,-21208.52"/>
</g>
<!-- layer_1_qkv_gpu2&#45;&gt;layer_1_allgather_qkv -->
<g id="edge73" class="edge">
<title>layer_1_qkv_gpu2&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M593.22,-21248.94C606.29,-21238.45 621.61,-21226.17 635.31,-21215.19"/>
<polygon fill="black" stroke="black" points="637.55,-21217.88 643.17,-21208.89 633.17,-21212.42 637.55,-21217.88"/>
</g>
<!-- layer_1_qkv_gpu3&#45;&gt;layer_1_allgather_qkv -->
<g id="edge74" class="edge">
<title>layer_1_qkv_gpu3&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M673,-21248.7C673,-21240.81 673,-21231.92 673,-21223.34"/>
<polygon fill="black" stroke="black" points="676.5,-21223.12 673,-21213.12 669.5,-21223.12 676.5,-21223.12"/>
</g>
<!-- layer_1_qkv_gpu4&#45;&gt;layer_1_allgather_qkv -->
<g id="edge75" class="edge">
<title>layer_1_qkv_gpu4&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M752.78,-21248.94C739.71,-21238.45 724.39,-21226.17 710.69,-21215.19"/>
<polygon fill="black" stroke="black" points="712.83,-21212.42 702.83,-21208.89 708.45,-21217.88 712.83,-21212.42"/>
</g>
<!-- layer_1_qkv_gpu5&#45;&gt;layer_1_allgather_qkv -->
<g id="edge76" class="edge">
<title>layer_1_qkv_gpu5&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M848.28,-21252.49C845.48,-21251.28 842.71,-21250.1 840,-21248.97 802.98,-21233.48 760.78,-21217.32 728.06,-21205.11"/>
<polygon fill="black" stroke="black" points="729.25,-21201.82 718.66,-21201.62 726.81,-21208.38 729.25,-21201.82"/>
</g>
<!-- layer_1_qkv_gpu6&#45;&gt;layer_1_allgather_qkv -->
<g id="edge77" class="edge">
<title>layer_1_qkv_gpu6&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M959.45,-21252.04C956.61,-21250.94 953.78,-21249.91 951,-21248.97 879.2,-21224.66 793.88,-21206.54 736.87,-21195.9"/>
<polygon fill="black" stroke="black" points="737.39,-21192.44 726.92,-21194.07 736.12,-21199.32 737.39,-21192.44"/>
</g>
<!-- layer_1_qkv_gpu7&#45;&gt;layer_1_allgather_qkv -->
<g id="edge78" class="edge">
<title>layer_1_qkv_gpu7&#45;&gt;layer_1_allgather_qkv</title>
<path fill="none" stroke="black" d="M1070.21,-21251.72C1067.46,-21250.72 1064.71,-21249.79 1062,-21248.97 951.69,-21215.47 818.14,-21198.35 739.68,-21190.55"/>
<polygon fill="black" stroke="black" points="739.75,-21187.04 729.45,-21189.56 739.07,-21194.01 739.75,-21187.04"/>
</g>
<!-- layer_1_attention -->
<g id="node56" class="node">
<title>layer_1_attention</title>
<polygon fill="lightblue" stroke="black" points="633,-21118.98 565,-21118.98 565,-21066.98 633,-21066.98 633,-21118.98"/>
<text text-anchor="middle" x="599" y="-21106.98" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="599" y="-21095.98" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="599" y="-21084.98" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="599" y="-21073.98" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_1_allgather_qkv&#45;&gt;layer_1_attention -->
<g id="edge79" class="edge">
<title>layer_1_allgather_qkv&#45;&gt;layer_1_attention</title>
<path fill="none" stroke="black" d="M651.2,-21156.75C643.39,-21147.37 634.5,-21136.67 626.29,-21126.8"/>
<polygon fill="black" stroke="black" points="628.97,-21124.55 619.88,-21119.1 623.59,-21129.02 628.97,-21124.55"/>
</g>
<!-- layer_1_attn_out_gpu7 -->
<g id="node64" class="node">
<title>layer_1_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="496,-21030.98 408,-21030.98 408,-20978.98 496,-20978.98 496,-21030.98"/>
<text text-anchor="middle" x="452" y="-21018.98" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="452" y="-21007.98" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="452" y="-20996.98" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="452" y="-20985.98" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attention&#45;&gt;layer_1_attn_out_gpu7 -->
<g id="edge80" class="edge">
<title>layer_1_attention&#45;&gt;layer_1_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M564.91,-21072.04C546.73,-21061.4 523.99,-21048.1 503.69,-21036.22"/>
<polygon fill="black" stroke="black" points="505.26,-21033.09 494.86,-21031.06 501.73,-21039.13 505.26,-21033.09"/>
</g>
<!-- layer_1_attn_out_gpu0 -->
<g id="node57" class="node">
<title>layer_1_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="602,-21030.98 514,-21030.98 514,-20978.98 602,-20978.98 602,-21030.98"/>
<text text-anchor="middle" x="558" y="-21018.98" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="558" y="-21007.98" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="558" y="-20996.98" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="558" y="-20985.98" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_allreduce_attn -->
<g id="node65" class="node">
<title>layer_1_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="876" cy="-20913.99" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="876" y="-20922.49" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="876" y="-20911.49" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="876" y="-20900.49" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_1_attn_out_gpu0&#45;&gt;layer_1_allreduce_attn -->
<g id="edge81" class="edge">
<title>layer_1_attn_out_gpu0&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M602.26,-20982.3C605.19,-20981.12 608.12,-20980 611,-20978.98 678.13,-20955.32 757.84,-20937.38 812.19,-20926.6"/>
<polygon fill="black" stroke="black" points="812.89,-20930.03 822.03,-20924.67 811.54,-20923.16 812.89,-20930.03"/>
</g>
<!-- layer_1_attn_out_gpu1 -->
<g id="node58" class="node">
<title>layer_1_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="708,-21030.98 620,-21030.98 620,-20978.98 708,-20978.98 708,-21030.98"/>
<text text-anchor="middle" x="664" y="-21018.98" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="664" y="-21007.98" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="664" y="-20996.98" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="664" y="-20985.98" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attn_out_gpu1&#45;&gt;layer_1_allreduce_attn -->
<g id="edge82" class="edge">
<title>layer_1_attn_out_gpu1&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M708.16,-20982.92C711.14,-20981.57 714.11,-20980.24 717,-20978.98 751.33,-20963.99 790.34,-20948.27 821.13,-20936.17"/>
<polygon fill="black" stroke="black" points="822.79,-20939.27 830.82,-20932.37 820.23,-20932.76 822.79,-20939.27"/>
</g>
<!-- layer_1_attn_out_gpu2 -->
<g id="node59" class="node">
<title>layer_1_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="814,-21030.98 726,-21030.98 726,-20978.98 814,-20978.98 814,-21030.98"/>
<text text-anchor="middle" x="770" y="-21018.98" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="770" y="-21007.98" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="770" y="-20996.98" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="770" y="-20985.98" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attn_out_gpu2&#45;&gt;layer_1_allreduce_attn -->
<g id="edge83" class="edge">
<title>layer_1_attn_out_gpu2&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M799.81,-20978.96C812.08,-20968.65 826.42,-20956.62 839.33,-20945.78"/>
<polygon fill="black" stroke="black" points="841.74,-20948.33 847.15,-20939.22 837.24,-20942.97 841.74,-20948.33"/>
</g>
<!-- layer_1_attn_out_gpu3 -->
<g id="node60" class="node">
<title>layer_1_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="920,-21030.98 832,-21030.98 832,-20978.98 920,-20978.98 920,-21030.98"/>
<text text-anchor="middle" x="876" y="-21018.98" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="876" y="-21007.98" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="876" y="-20996.98" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="876" y="-20985.98" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attn_out_gpu3&#45;&gt;layer_1_allreduce_attn -->
<g id="edge84" class="edge">
<title>layer_1_attn_out_gpu3&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M876,-20978.72C876,-20970.83 876,-20961.94 876,-20953.36"/>
<polygon fill="black" stroke="black" points="879.5,-20953.13 876,-20943.13 872.5,-20953.13 879.5,-20953.13"/>
</g>
<!-- layer_1_attn_out_gpu4 -->
<g id="node61" class="node">
<title>layer_1_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1026,-21030.98 938,-21030.98 938,-20978.98 1026,-20978.98 1026,-21030.98"/>
<text text-anchor="middle" x="982" y="-21018.98" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="982" y="-21007.98" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="982" y="-20996.98" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="982" y="-20985.98" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attn_out_gpu4&#45;&gt;layer_1_allreduce_attn -->
<g id="edge85" class="edge">
<title>layer_1_attn_out_gpu4&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M952.19,-20978.96C939.92,-20968.65 925.58,-20956.62 912.67,-20945.78"/>
<polygon fill="black" stroke="black" points="914.76,-20942.97 904.85,-20939.22 910.26,-20948.33 914.76,-20942.97"/>
</g>
<!-- layer_1_attn_out_gpu5 -->
<g id="node62" class="node">
<title>layer_1_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1132,-21030.98 1044,-21030.98 1044,-20978.98 1132,-20978.98 1132,-21030.98"/>
<text text-anchor="middle" x="1088" y="-21018.98" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="1088" y="-21007.98" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1088" y="-20996.98" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1088" y="-20985.98" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attn_out_gpu5&#45;&gt;layer_1_allreduce_attn -->
<g id="edge86" class="edge">
<title>layer_1_attn_out_gpu5&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M1043.84,-20982.92C1040.86,-20981.57 1037.89,-20980.24 1035,-20978.98 1000.67,-20963.99 961.66,-20948.27 930.87,-20936.17"/>
<polygon fill="black" stroke="black" points="931.77,-20932.76 921.18,-20932.37 929.21,-20939.27 931.77,-20932.76"/>
</g>
<!-- layer_1_attn_out_gpu6 -->
<g id="node63" class="node">
<title>layer_1_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1238,-21030.98 1150,-21030.98 1150,-20978.98 1238,-20978.98 1238,-21030.98"/>
<text text-anchor="middle" x="1194" y="-21018.98" font-family="Arial" font-size="10.00">Layer 1 Attn Out</text>
<text text-anchor="middle" x="1194" y="-21007.98" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1194" y="-20996.98" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1194" y="-20985.98" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_1_attn_out_gpu6&#45;&gt;layer_1_allreduce_attn -->
<g id="edge87" class="edge">
<title>layer_1_attn_out_gpu6&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M1149.74,-20982.3C1146.81,-20981.12 1143.88,-20980 1141,-20978.98 1073.87,-20955.32 994.16,-20937.38 939.81,-20926.6"/>
<polygon fill="black" stroke="black" points="940.46,-20923.16 929.97,-20924.67 939.11,-20930.03 940.46,-20923.16"/>
</g>
<!-- layer_1_attn_out_gpu7&#45;&gt;layer_1_allreduce_attn -->
<g id="edge88" class="edge">
<title>layer_1_attn_out_gpu7&#45;&gt;layer_1_allreduce_attn</title>
<path fill="none" stroke="black" d="M496.18,-20982.08C499.13,-20980.95 502.09,-20979.9 505,-20978.98 608.43,-20946.33 733.66,-20929.12 808.97,-20921.05"/>
<polygon fill="black" stroke="black" points="809.67,-20924.5 819.25,-20919.98 808.94,-20917.54 809.67,-20924.5"/>
</g>
<!-- layer_1_allreduce_attn&#45;&gt;layer_1_residual1 -->
<g id="edge89" class="edge">
<title>layer_1_allreduce_attn&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M917.35,-20893.27C945.12,-20880.03 982.09,-20862.4 1012.81,-20847.75"/>
<polygon fill="black" stroke="black" points="1014.6,-20850.77 1022.12,-20843.31 1011.59,-20844.45 1014.6,-20850.77"/>
</g>
<!-- layer_1_ln1 -->
<g id="node67" class="node">
<title>layer_1_ln1</title>
<polygon fill="lightblue" stroke="black" points="902.5,-20753 829.5,-20753 829.5,-20712 902.5,-20712 902.5,-20753"/>
<text text-anchor="middle" x="866" y="-20741" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="866" y="-20730" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="866" y="-20719" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_1_residual1&#45;&gt;layer_1_ln1 -->
<g id="edge91" class="edge">
<title>layer_1_residual1&#45;&gt;layer_1_ln1</title>
<path fill="none" stroke="black" d="M1000.45,-20788.92C971.16,-20776.84 937.99,-20763.17 911.93,-20752.43"/>
<polygon fill="black" stroke="black" points="913.25,-20749.19 902.67,-20748.62 910.58,-20755.66 913.25,-20749.19"/>
</g>
<!-- layer_1_residual2 -->
<g id="node87" class="node">
<title>layer_1_residual2</title>
<polygon fill="lightyellow" stroke="black" points="1231.94,-20240.03 1109.55,-20240.03 1078.06,-20180.03 1200.45,-20180.03 1231.94,-20240.03"/>
<text text-anchor="middle" x="1155" y="-20213.03" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="1155" y="-20202.03" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_1_residual1&#45;&gt;layer_1_residual2 -->
<g id="edge119" class="edge">
<title>layer_1_residual1&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M1128.29,-20810.94C1212.81,-20796.97 1361,-20757.32 1361,-20651 1361,-20651 1361,-20651 1361,-20395.02 1361,-20324.81 1293.61,-20274.73 1235.92,-20244.71"/>
<polygon fill="black" stroke="black" points="1237.26,-20241.47 1226.76,-20240.07 1234.1,-20247.71 1237.26,-20241.47"/>
</g>
<!-- layer_1_mlp_fc1_gpu0 -->
<g id="node68" class="node">
<title>layer_1_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="465,-20676 371,-20676 371,-20624 465,-20624 465,-20676"/>
<text text-anchor="middle" x="418" y="-20664" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="418" y="-20653" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="418" y="-20642" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="418" y="-20631" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu0 -->
<g id="edge92" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M829.35,-20729.72C760.78,-20725.67 608.67,-20713.25 474.63,-20675.83"/>
<polygon fill="black" stroke="black" points="475.58,-20672.47 465.01,-20673.1 473.67,-20679.2 475.58,-20672.47"/>
</g>
<!-- layer_1_mlp_fc1_gpu1 -->
<g id="node69" class="node">
<title>layer_1_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="577,-20676 483,-20676 483,-20624 577,-20624 577,-20676"/>
<text text-anchor="middle" x="530" y="-20664" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="530" y="-20653" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="530" y="-20642" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="530" y="-20631" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu1 -->
<g id="edge93" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M829.1,-20726.87C776.76,-20719.74 678.05,-20704.14 586.73,-20675.94"/>
<polygon fill="black" stroke="black" points="587.66,-20672.57 577.07,-20672.9 585.55,-20679.24 587.66,-20672.57"/>
</g>
<!-- layer_1_mlp_fc1_gpu2 -->
<g id="node70" class="node">
<title>layer_1_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="689,-20676 595,-20676 595,-20624 689,-20624 689,-20676"/>
<text text-anchor="middle" x="642" y="-20664" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="642" y="-20653" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="642" y="-20642" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="642" y="-20631" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu2 -->
<g id="edge94" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M829.25,-20720.53C796.97,-20710.64 748.62,-20695.19 698.58,-20676.09"/>
<polygon fill="black" stroke="black" points="699.8,-20672.81 689.22,-20672.48 697.29,-20679.34 699.8,-20672.81"/>
</g>
<!-- layer_1_mlp_fc1_gpu3 -->
<g id="node71" class="node">
<title>layer_1_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="801,-20676 707,-20676 707,-20624 801,-20624 801,-20676"/>
<text text-anchor="middle" x="754" y="-20664" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="754" y="-20653" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="754" y="-20642" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="754" y="-20631" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu3 -->
<g id="edge95" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M838.6,-20711.81C826.27,-20702.94 811.4,-20692.26 797.59,-20682.33"/>
<polygon fill="black" stroke="black" points="799.33,-20679.27 789.17,-20676.28 795.24,-20684.95 799.33,-20679.27"/>
</g>
<!-- layer_1_mlp_fc1_gpu4 -->
<g id="node72" class="node">
<title>layer_1_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="913,-20676 819,-20676 819,-20624 913,-20624 913,-20676"/>
<text text-anchor="middle" x="866" y="-20664" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="866" y="-20653" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="866" y="-20642" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="866" y="-20631" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu4 -->
<g id="edge96" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M866,-20711.6C866,-20703.99 866,-20695.06 866,-20686.43"/>
<polygon fill="black" stroke="black" points="869.5,-20686.15 866,-20676.15 862.5,-20686.15 869.5,-20686.15"/>
</g>
<!-- layer_1_mlp_fc1_gpu5 -->
<g id="node73" class="node">
<title>layer_1_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1025,-20676 931,-20676 931,-20624 1025,-20624 1025,-20676"/>
<text text-anchor="middle" x="978" y="-20664" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="978" y="-20653" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="978" y="-20642" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="978" y="-20631" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu5 -->
<g id="edge97" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M893.4,-20711.81C905.73,-20702.94 920.6,-20692.26 934.41,-20682.33"/>
<polygon fill="black" stroke="black" points="936.76,-20684.95 942.83,-20676.28 932.67,-20679.27 936.76,-20684.95"/>
</g>
<!-- layer_1_mlp_fc1_gpu6 -->
<g id="node74" class="node">
<title>layer_1_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1137,-20676 1043,-20676 1043,-20624 1137,-20624 1137,-20676"/>
<text text-anchor="middle" x="1090" y="-20664" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="1090" y="-20653" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1090" y="-20642" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1090" y="-20631" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu6 -->
<g id="edge98" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M902.75,-20720.53C935.03,-20710.64 983.38,-20695.19 1033.42,-20676.09"/>
<polygon fill="black" stroke="black" points="1034.71,-20679.34 1042.78,-20672.48 1032.2,-20672.81 1034.71,-20679.34"/>
</g>
<!-- layer_1_mlp_fc1_gpu7 -->
<g id="node75" class="node">
<title>layer_1_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1249,-20676 1155,-20676 1155,-20624 1249,-20624 1249,-20676"/>
<text text-anchor="middle" x="1202" y="-20664" font-family="Arial" font-size="10.00">Layer 1 MLP FC1</text>
<text text-anchor="middle" x="1202" y="-20653" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1202" y="-20642" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1202" y="-20631" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu7 -->
<g id="edge99" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M902.9,-20726.87C955.24,-20719.74 1053.95,-20704.14 1145.27,-20675.94"/>
<polygon fill="black" stroke="black" points="1146.45,-20679.24 1154.93,-20672.9 1144.34,-20672.57 1146.45,-20679.24"/>
</g>
<!-- layer_1_allgather_mlp -->
<g id="node76" class="node">
<title>layer_1_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="754" cy="-20559.01" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="754" y="-20567.51" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="754" y="-20556.51" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="754" y="-20545.51" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_1_mlp_fc1_gpu0&#45;&gt;layer_1_allgather_mlp -->
<g id="edge100" class="edge">
<title>layer_1_mlp_fc1_gpu0&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M465.1,-20627.2C468.09,-20626.06 471.07,-20624.98 474,-20624 546.84,-20599.68 633.37,-20581.46 690.76,-20570.81"/>
<polygon fill="black" stroke="black" points="691.57,-20574.22 700.78,-20568.97 690.31,-20567.33 691.57,-20574.22"/>
</g>
<!-- layer_1_mlp_fc1_gpu1&#45;&gt;layer_1_allgather_mlp -->
<g id="edge101" class="edge">
<title>layer_1_mlp_fc1_gpu1&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M577.28,-20627.67C580.22,-20626.41 583.15,-20625.18 586,-20624 623.41,-20608.54 666.04,-20592.32 698.99,-20580.08"/>
<polygon fill="black" stroke="black" points="700.29,-20583.33 708.45,-20576.57 697.86,-20576.76 700.29,-20583.33"/>
</g>
<!-- layer_1_mlp_fc1_gpu2&#45;&gt;layer_1_allgather_mlp -->
<g id="edge102" class="edge">
<title>layer_1_mlp_fc1_gpu2&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M673.5,-20623.97C686.69,-20613.49 702.15,-20601.21 715.98,-20590.22"/>
<polygon fill="black" stroke="black" points="718.24,-20592.89 723.9,-20583.93 713.89,-20587.41 718.24,-20592.89"/>
</g>
<!-- layer_1_mlp_fc1_gpu3&#45;&gt;layer_1_allgather_mlp -->
<g id="edge103" class="edge">
<title>layer_1_mlp_fc1_gpu3&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M754,-20623.74C754,-20615.85 754,-20606.96 754,-20598.37"/>
<polygon fill="black" stroke="black" points="757.5,-20598.15 754,-20588.15 750.5,-20598.15 757.5,-20598.15"/>
</g>
<!-- layer_1_mlp_fc1_gpu4&#45;&gt;layer_1_allgather_mlp -->
<g id="edge104" class="edge">
<title>layer_1_mlp_fc1_gpu4&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M834.5,-20623.97C821.31,-20613.49 805.85,-20601.21 792.02,-20590.22"/>
<polygon fill="black" stroke="black" points="794.11,-20587.41 784.1,-20583.93 789.76,-20592.89 794.11,-20587.41"/>
</g>
<!-- layer_1_mlp_fc1_gpu5&#45;&gt;layer_1_allgather_mlp -->
<g id="edge105" class="edge">
<title>layer_1_mlp_fc1_gpu5&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M930.72,-20627.67C927.78,-20626.41 924.85,-20625.18 922,-20624 884.59,-20608.54 841.96,-20592.32 809.01,-20580.08"/>
<polygon fill="black" stroke="black" points="810.14,-20576.76 799.55,-20576.57 807.71,-20583.33 810.14,-20576.76"/>
</g>
<!-- layer_1_mlp_fc1_gpu6&#45;&gt;layer_1_allgather_mlp -->
<g id="edge106" class="edge">
<title>layer_1_mlp_fc1_gpu6&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M1042.9,-20627.2C1039.91,-20626.06 1036.93,-20624.98 1034,-20624 961.16,-20599.68 874.63,-20581.46 817.24,-20570.81"/>
<polygon fill="black" stroke="black" points="817.69,-20567.33 807.22,-20568.97 816.43,-20574.22 817.69,-20567.33"/>
</g>
<!-- layer_1_mlp_fc1_gpu7&#45;&gt;layer_1_allgather_mlp -->
<g id="edge107" class="edge">
<title>layer_1_mlp_fc1_gpu7&#45;&gt;layer_1_allgather_mlp</title>
<path fill="none" stroke="black" d="M1154.97,-20626.98C1151.96,-20625.89 1148.96,-20624.89 1146,-20624 1034.1,-20590.5 898.65,-20573.32 819.82,-20565.52"/>
<polygon fill="black" stroke="black" points="819.84,-20562.01 809.55,-20564.53 819.16,-20568.98 819.84,-20562.01"/>
</g>
<!-- layer_1_gelu -->
<g id="node77" class="node">
<title>layer_1_gelu</title>
<polygon fill="lightblue" stroke="black" points="714.5,-20494.02 625.5,-20494.02 625.5,-20458.02 714.5,-20458.02 714.5,-20494.02"/>
<text text-anchor="middle" x="670" y="-20479.02" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="670" y="-20468.02" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_1_allgather_mlp&#45;&gt;layer_1_gelu -->
<g id="edge108" class="edge">
<title>layer_1_allgather_mlp&#45;&gt;layer_1_gelu</title>
<path fill="none" stroke="black" d="M727.88,-20532.83C717.42,-20522.74 705.41,-20511.16 695.06,-20501.18"/>
<polygon fill="black" stroke="black" points="697.48,-20498.65 687.85,-20494.23 692.62,-20503.69 697.48,-20498.65"/>
</g>
<!-- layer_1_mlp_fc2_gpu7 -->
<g id="node85" class="node">
<title>layer_1_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="549,-20422.02 455,-20422.02 455,-20370.02 549,-20370.02 549,-20422.02"/>
<text text-anchor="middle" x="502" y="-20410.02" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="502" y="-20399.02" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="502" y="-20388.02" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="502" y="-20377.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu7 -->
<g id="edge109" class="edge">
<title>layer_1_gelu&#45;&gt;layer_1_mlp_fc2_gpu7</title>
<path fill="none" stroke="black" d="M633.13,-20457.9C611.21,-20447.72 582.95,-20434.6 558.28,-20423.15"/>
<polygon fill="black" stroke="black" points="559.56,-20419.88 549.02,-20418.85 556.62,-20426.23 559.56,-20419.88"/>
</g>
<!-- layer_1_mlp_fc2_gpu0 -->
<g id="node78" class="node">
<title>layer_1_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="661,-20422.02 567,-20422.02 567,-20370.02 661,-20370.02 661,-20422.02"/>
<text text-anchor="middle" x="614" y="-20410.02" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="614" y="-20399.02" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="614" y="-20388.02" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="614" y="-20377.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_allreduce_mlp -->
<g id="node86" class="node">
<title>layer_1_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="950" cy="-20305.03" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="950" y="-20313.53" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="950" y="-20302.53" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="950" y="-20291.53" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_1_mlp_fc2_gpu0&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge110" class="edge">
<title>layer_1_mlp_fc2_gpu0&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M661.1,-20373.21C664.09,-20372.07 667.07,-20371 670,-20370.02 741.61,-20346.1 826.46,-20328.09 883.84,-20317.37"/>
<polygon fill="black" stroke="black" points="884.67,-20320.77 893.87,-20315.51 883.4,-20313.89 884.67,-20320.77"/>
</g>
<!-- layer_1_mlp_fc2_gpu1 -->
<g id="node79" class="node">
<title>layer_1_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="773,-20422.02 679,-20422.02 679,-20370.02 773,-20370.02 773,-20422.02"/>
<text text-anchor="middle" x="726" y="-20410.02" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="726" y="-20399.02" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="726" y="-20388.02" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="726" y="-20377.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_mlp_fc2_gpu1&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge111" class="edge">
<title>layer_1_mlp_fc2_gpu1&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M773.28,-20373.69C776.22,-20372.43 779.15,-20371.2 782,-20370.02 818.89,-20354.77 860.84,-20338.79 893.6,-20326.61"/>
<polygon fill="black" stroke="black" points="894.85,-20329.88 903.01,-20323.12 892.42,-20323.32 894.85,-20329.88"/>
</g>
<!-- layer_1_mlp_fc2_gpu2 -->
<g id="node80" class="node">
<title>layer_1_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="885,-20422.02 791,-20422.02 791,-20370.02 885,-20370.02 885,-20422.02"/>
<text text-anchor="middle" x="838" y="-20410.02" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="838" y="-20399.02" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="838" y="-20388.02" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="838" y="-20377.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_mlp_fc2_gpu2&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge112" class="edge">
<title>layer_1_mlp_fc2_gpu2&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M869.5,-20369.99C882.59,-20359.59 897.9,-20347.42 911.64,-20336.51"/>
<polygon fill="black" stroke="black" points="913.86,-20339.21 919.51,-20330.25 909.51,-20333.73 913.86,-20339.21"/>
</g>
<!-- layer_1_mlp_fc2_gpu3 -->
<g id="node81" class="node">
<title>layer_1_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="997,-20422.02 903,-20422.02 903,-20370.02 997,-20370.02 997,-20422.02"/>
<text text-anchor="middle" x="950" y="-20410.02" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="950" y="-20399.02" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="950" y="-20388.02" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="950" y="-20377.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_mlp_fc2_gpu3&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge113" class="edge">
<title>layer_1_mlp_fc2_gpu3&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M950,-20369.75C950,-20361.86 950,-20352.97 950,-20344.39"/>
<polygon fill="black" stroke="black" points="953.5,-20344.17 950,-20334.17 946.5,-20344.17 953.5,-20344.17"/>
</g>
<!-- layer_1_mlp_fc2_gpu4 -->
<g id="node82" class="node">
<title>layer_1_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1109,-20422.02 1015,-20422.02 1015,-20370.02 1109,-20370.02 1109,-20422.02"/>
<text text-anchor="middle" x="1062" y="-20410.02" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="1062" y="-20399.02" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1062" y="-20388.02" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1062" y="-20377.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_mlp_fc2_gpu4&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge114" class="edge">
<title>layer_1_mlp_fc2_gpu4&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1030.5,-20369.99C1017.41,-20359.59 1002.1,-20347.42 988.36,-20336.51"/>
<polygon fill="black" stroke="black" points="990.49,-20333.73 980.49,-20330.25 986.14,-20339.21 990.49,-20333.73"/>
</g>
<!-- layer_1_mlp_fc2_gpu5 -->
<g id="node83" class="node">
<title>layer_1_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1221,-20422.02 1127,-20422.02 1127,-20370.02 1221,-20370.02 1221,-20422.02"/>
<text text-anchor="middle" x="1174" y="-20410.02" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="1174" y="-20399.02" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1174" y="-20388.02" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1174" y="-20377.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_mlp_fc2_gpu5&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge115" class="edge">
<title>layer_1_mlp_fc2_gpu5&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1126.72,-20373.69C1123.78,-20372.43 1120.85,-20371.2 1118,-20370.02 1081.11,-20354.77 1039.16,-20338.79 1006.4,-20326.61"/>
<polygon fill="black" stroke="black" points="1007.58,-20323.32 996.99,-20323.12 1005.15,-20329.88 1007.58,-20323.32"/>
</g>
<!-- layer_1_mlp_fc2_gpu6 -->
<g id="node84" class="node">
<title>layer_1_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1333,-20422.02 1239,-20422.02 1239,-20370.02 1333,-20370.02 1333,-20422.02"/>
<text text-anchor="middle" x="1286" y="-20410.02" font-family="Arial" font-size="10.00">Layer 1 MLP FC2</text>
<text text-anchor="middle" x="1286" y="-20399.02" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1286" y="-20388.02" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1286" y="-20377.02" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_1_mlp_fc2_gpu6&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge116" class="edge">
<title>layer_1_mlp_fc2_gpu6&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1238.9,-20373.21C1235.91,-20372.07 1232.93,-20371 1230,-20370.02 1158.39,-20346.1 1073.54,-20328.09 1016.16,-20317.37"/>
<polygon fill="black" stroke="black" points="1016.6,-20313.89 1006.13,-20315.51 1015.33,-20320.77 1016.6,-20313.89"/>
</g>
<!-- layer_1_mlp_fc2_gpu7&#45;&gt;layer_1_allreduce_mlp -->
<g id="edge117" class="edge">
<title>layer_1_mlp_fc2_gpu7&#45;&gt;layer_1_allreduce_mlp</title>
<path fill="none" stroke="black" d="M549.03,-20373C552.04,-20371.91 555.04,-20370.9 558,-20370.02 668.16,-20337.04 801.15,-20319.87 880.47,-20311.91"/>
<polygon fill="black" stroke="black" points="881.21,-20315.35 890.82,-20310.89 880.53,-20308.39 881.21,-20315.35"/>
</g>
<!-- layer_1_allreduce_mlp&#45;&gt;layer_1_residual2 -->
<g id="edge118" class="edge">
<title>layer_1_allreduce_mlp&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M992.97,-20284.53C1023,-20270.91 1063.46,-20252.56 1096.43,-20237.6"/>
<polygon fill="black" stroke="black" points="1098.3,-20240.6 1105.96,-20233.28 1095.41,-20234.22 1098.3,-20240.6"/>
</g>
<!-- layer_1_ln2 -->
<g id="node88" class="node">
<title>layer_1_ln2</title>
<polygon fill="lightblue" stroke="black" points="1191.5,-20144.03 1118.5,-20144.03 1118.5,-20103.03 1191.5,-20103.03 1191.5,-20144.03"/>
<text text-anchor="middle" x="1155" y="-20132.03" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="1155" y="-20121.03" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="1155" y="-20110.03" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_1_residual2&#45;&gt;layer_1_ln2 -->
<g id="edge120" class="edge">
<title>layer_1_residual2&#45;&gt;layer_1_ln2</title>
<path fill="none" stroke="black" d="M1155,-20179.95C1155,-20171.63 1155,-20162.55 1155,-20154.19"/>
<polygon fill="black" stroke="black" points="1158.5,-20154.1 1155,-20144.1 1151.5,-20154.1 1158.5,-20154.1"/>
</g>
<!-- layer_1_output_dist -->
<g id="node89" class="node">
<title>layer_1_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="1256.7,-20067.03 1094.92,-20067.03 1053.3,-20007.03 1215.08,-20007.03 1256.7,-20067.03"/>
<text text-anchor="middle" x="1155" y="-20040.03" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="1155" y="-20029.03" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_1_ln2&#45;&gt;layer_1_output_dist -->
<g id="edge121" class="edge">
<title>layer_1_ln2&#45;&gt;layer_1_output_dist</title>
<path fill="none" stroke="black" d="M1155,-20102.94C1155,-20095.3 1155,-20086.25 1155,-20077.38"/>
<polygon fill="black" stroke="black" points="1158.5,-20077.14 1155,-20067.14 1151.5,-20077.14 1158.5,-20077.14"/>
</g>
<!-- layer_2_input_dist -->
<g id="node90" class="node">
<title>layer_2_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="1249.19,-19971.03 1099.36,-19971.03 1060.81,-19911.03 1210.64,-19911.03 1249.19,-19971.03"/>
<text text-anchor="middle" x="1155" y="-19944.03" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="1155" y="-19933.03" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_1_output_dist&#45;&gt;layer_2_input_dist -->
<g id="edge122" class="edge">
<title>layer_1_output_dist&#45;&gt;layer_2_input_dist</title>
<path fill="none" stroke="black" d="M1155,-20006.81C1155,-19998.76 1155,-19989.9 1155,-19981.38"/>
<polygon fill="black" stroke="black" points="1158.5,-19981.24 1155,-19971.24 1151.5,-19981.24 1158.5,-19981.24"/>
</g>
<!-- layer_2_qkv_gpu0 -->
<g id="node91" class="node">
<title>layer_2_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="757.5,-19875.03 664.5,-19875.03 664.5,-19823.03 757.5,-19823.03 757.5,-19875.03"/>
<text text-anchor="middle" x="711" y="-19863.03" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="711" y="-19852.03" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="711" y="-19841.03" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="711" y="-19830.03" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu0 -->
<g id="edge123" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1074.5,-19932.58C997.32,-19924.07 877.81,-19907.33 767.36,-19874.81"/>
<polygon fill="black" stroke="black" points="768.31,-19871.44 757.72,-19871.93 766.3,-19878.15 768.31,-19871.44"/>
</g>
<!-- layer_2_qkv_gpu1 -->
<g id="node92" class="node">
<title>layer_2_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="868.5,-19875.03 775.5,-19875.03 775.5,-19823.03 868.5,-19823.03 868.5,-19875.03"/>
<text text-anchor="middle" x="822" y="-19863.03" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="822" y="-19852.03" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="822" y="-19841.03" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="822" y="-19830.03" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu1 -->
<g id="edge124" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1069.28,-19924.29C1016.43,-19913.57 947.37,-19897.72 878.51,-19874.96"/>
<polygon fill="black" stroke="black" points="879.39,-19871.56 868.8,-19871.7 877.16,-19878.2 879.39,-19871.56"/>
</g>
<!-- layer_2_qkv_gpu2 -->
<g id="node93" class="node">
<title>layer_2_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="979.5,-19875.03 886.5,-19875.03 886.5,-19823.03 979.5,-19823.03 979.5,-19875.03"/>
<text text-anchor="middle" x="933" y="-19863.03" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="933" y="-19852.03" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="933" y="-19841.03" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="933" y="-19830.03" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu2 -->
<g id="edge125" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1078.67,-19911.01C1050.39,-19900.02 1018.12,-19887.23 989,-19875.03 988.9,-19874.99 988.81,-19874.95 988.71,-19874.91"/>
<polygon fill="black" stroke="black" points="990.25,-19871.77 979.68,-19871.07 987.51,-19878.21 990.25,-19871.77"/>
</g>
<!-- layer_2_qkv_gpu3 -->
<g id="node94" class="node">
<title>layer_2_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1090.5,-19875.03 997.5,-19875.03 997.5,-19823.03 1090.5,-19823.03 1090.5,-19875.03"/>
<text text-anchor="middle" x="1044" y="-19863.03" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="1044" y="-19852.03" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1044" y="-19841.03" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1044" y="-19830.03" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu3 -->
<g id="edge126" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1118.96,-19910.81C1107.44,-19901.47 1094.64,-19891.09 1082.92,-19881.59"/>
<polygon fill="black" stroke="black" points="1084.98,-19878.76 1075.01,-19875.18 1080.58,-19884.2 1084.98,-19878.76"/>
</g>
<!-- layer_2_qkv_gpu4 -->
<g id="node95" class="node">
<title>layer_2_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1201.5,-19875.03 1108.5,-19875.03 1108.5,-19823.03 1201.5,-19823.03 1201.5,-19875.03"/>
<text text-anchor="middle" x="1155" y="-19863.03" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="1155" y="-19852.03" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1155" y="-19841.03" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1155" y="-19830.03" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu4 -->
<g id="edge127" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1155,-19910.56C1155,-19902.49 1155,-19893.66 1155,-19885.29"/>
<polygon fill="black" stroke="black" points="1158.5,-19885.04 1155,-19875.04 1151.5,-19885.04 1158.5,-19885.04"/>
</g>
<!-- layer_2_qkv_gpu5 -->
<g id="node96" class="node">
<title>layer_2_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1312.5,-19875.03 1219.5,-19875.03 1219.5,-19823.03 1312.5,-19823.03 1312.5,-19875.03"/>
<text text-anchor="middle" x="1266" y="-19863.03" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="1266" y="-19852.03" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1266" y="-19841.03" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1266" y="-19830.03" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu5 -->
<g id="edge128" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1191.04,-19910.81C1202.56,-19901.47 1215.36,-19891.09 1227.08,-19881.59"/>
<polygon fill="black" stroke="black" points="1229.42,-19884.2 1234.99,-19875.18 1225.02,-19878.76 1229.42,-19884.2"/>
</g>
<!-- layer_2_qkv_gpu6 -->
<g id="node97" class="node">
<title>layer_2_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1423.5,-19875.03 1330.5,-19875.03 1330.5,-19823.03 1423.5,-19823.03 1423.5,-19875.03"/>
<text text-anchor="middle" x="1377" y="-19863.03" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="1377" y="-19852.03" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1377" y="-19841.03" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1377" y="-19830.03" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu6 -->
<g id="edge129" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1215.23,-19917.52C1244.83,-19906.24 1281.18,-19892.06 1320.92,-19875.42"/>
<polygon fill="black" stroke="black" points="1322.41,-19878.59 1330.27,-19871.49 1319.7,-19872.14 1322.41,-19878.59"/>
</g>
<!-- layer_2_qkv_gpu7 -->
<g id="node98" class="node">
<title>layer_2_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1534.5,-19875.03 1441.5,-19875.03 1441.5,-19823.03 1534.5,-19823.03 1534.5,-19875.03"/>
<text text-anchor="middle" x="1488" y="-19863.03" font-family="Arial" font-size="10.00">Layer 2 QKV Proj</text>
<text text-anchor="middle" x="1488" y="-19852.03" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1488" y="-19841.03" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1488" y="-19830.03" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_qkv_gpu7 -->
<g id="edge130" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1221.75,-19928.27C1276.38,-19917.76 1355.57,-19900.56 1431.7,-19875.24"/>
<polygon fill="black" stroke="black" points="1433.09,-19878.47 1441.45,-19871.95 1430.85,-19871.83 1433.09,-19878.47"/>
</g>
<!-- layer_2_residual1 -->
<g id="node110" class="node">
<title>layer_2_residual1</title>
<polygon fill="lightyellow" stroke="black" points="1518.94,-19423.07 1396.55,-19423.07 1365.06,-19363.07 1487.45,-19363.07 1518.94,-19423.07"/>
<text text-anchor="middle" x="1442" y="-19396.07" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="1442" y="-19385.07" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_2_input_dist&#45;&gt;layer_2_residual1 -->
<g id="edge150" class="edge">
<title>layer_2_input_dist&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M1225.87,-19934.27C1322.96,-19925.35 1491.28,-19905.94 1544,-19875.03 1601,-19841.62 1637,-19825.12 1637,-19759.04 1637,-19759.04 1637,-19759.04 1637,-19578.05 1637,-19509.27 1572.02,-19458.59 1517.09,-19428.04"/>
<polygon fill="black" stroke="black" points="1518.48,-19424.81 1508.02,-19423.12 1515.14,-19430.96 1518.48,-19424.81"/>
</g>
<!-- layer_2_allgather_qkv -->
<g id="node99" class="node">
<title>layer_2_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="1044" cy="-19758.04" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="1044" y="-19766.54" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="1044" y="-19755.54" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="1044" y="-19744.54" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_2_qkv_gpu0&#45;&gt;layer_2_allgather_qkv -->
<g id="edge131" class="edge">
<title>layer_2_qkv_gpu0&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M757.79,-19826.36C760.88,-19825.17 763.97,-19824.05 767,-19823.03 838.63,-19799.02 923.62,-19780.85 980.4,-19770.11"/>
<polygon fill="black" stroke="black" points="981.12,-19773.54 990.31,-19768.26 979.84,-19766.66 981.12,-19773.54"/>
</g>
<!-- layer_2_qkv_gpu1&#45;&gt;layer_2_allgather_qkv -->
<g id="edge132" class="edge">
<title>layer_2_qkv_gpu1&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M868.67,-19826.98C871.82,-19825.63 874.95,-19824.3 878,-19823.03 914.7,-19807.78 956.45,-19791.69 988.9,-19779.46"/>
<polygon fill="black" stroke="black" points="990.53,-19782.59 998.66,-19775.8 988.06,-19776.04 990.53,-19782.59"/>
</g>
<!-- layer_2_qkv_gpu2&#45;&gt;layer_2_allgather_qkv -->
<g id="edge133" class="edge">
<title>layer_2_qkv_gpu2&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M964.22,-19823.01C977.29,-19812.52 992.61,-19800.24 1006.31,-19789.26"/>
<polygon fill="black" stroke="black" points="1008.55,-19791.95 1014.17,-19782.96 1004.17,-19786.49 1008.55,-19791.95"/>
</g>
<!-- layer_2_qkv_gpu3&#45;&gt;layer_2_allgather_qkv -->
<g id="edge134" class="edge">
<title>layer_2_qkv_gpu3&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M1044,-19822.77C1044,-19814.88 1044,-19805.99 1044,-19797.41"/>
<polygon fill="black" stroke="black" points="1047.5,-19797.19 1044,-19787.19 1040.5,-19797.19 1047.5,-19797.19"/>
</g>
<!-- layer_2_qkv_gpu4&#45;&gt;layer_2_allgather_qkv -->
<g id="edge135" class="edge">
<title>layer_2_qkv_gpu4&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M1123.78,-19823.01C1110.71,-19812.52 1095.39,-19800.24 1081.69,-19789.26"/>
<polygon fill="black" stroke="black" points="1083.83,-19786.49 1073.83,-19782.96 1079.45,-19791.95 1083.83,-19786.49"/>
</g>
<!-- layer_2_qkv_gpu5&#45;&gt;layer_2_allgather_qkv -->
<g id="edge136" class="edge">
<title>layer_2_qkv_gpu5&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M1219.28,-19826.56C1216.48,-19825.35 1213.71,-19824.17 1211,-19823.03 1173.98,-19807.55 1131.78,-19791.39 1099.06,-19779.18"/>
<polygon fill="black" stroke="black" points="1100.25,-19775.89 1089.66,-19775.69 1097.81,-19782.45 1100.25,-19775.89"/>
</g>
<!-- layer_2_qkv_gpu6&#45;&gt;layer_2_allgather_qkv -->
<g id="edge137" class="edge">
<title>layer_2_qkv_gpu6&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M1330.45,-19826.11C1327.61,-19825.01 1324.78,-19823.98 1322,-19823.03 1250.2,-19798.73 1164.88,-19780.61 1107.87,-19769.97"/>
<polygon fill="black" stroke="black" points="1108.39,-19766.51 1097.92,-19768.14 1107.12,-19773.39 1108.39,-19766.51"/>
</g>
<!-- layer_2_qkv_gpu7&#45;&gt;layer_2_allgather_qkv -->
<g id="edge138" class="edge">
<title>layer_2_qkv_gpu7&#45;&gt;layer_2_allgather_qkv</title>
<path fill="none" stroke="black" d="M1441.21,-19825.79C1438.46,-19824.78 1435.71,-19823.86 1433,-19823.03 1322.69,-19789.54 1189.14,-19772.42 1110.68,-19764.62"/>
<polygon fill="black" stroke="black" points="1110.75,-19761.11 1100.45,-19763.63 1110.07,-19768.08 1110.75,-19761.11"/>
</g>
<!-- layer_2_attention -->
<g id="node100" class="node">
<title>layer_2_attention</title>
<polygon fill="lightblue" stroke="black" points="931,-19693.05 863,-19693.05 863,-19641.05 931,-19641.05 931,-19693.05"/>
<text text-anchor="middle" x="897" y="-19681.05" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="897" y="-19670.05" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="897" y="-19659.05" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="897" y="-19648.05" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_2_allgather_qkv&#45;&gt;layer_2_attention -->
<g id="edge139" class="edge">
<title>layer_2_allgather_qkv&#45;&gt;layer_2_attention</title>
<path fill="none" stroke="black" d="M1008.04,-19735.27C987.42,-19722.79 961.41,-19707.05 939.75,-19693.93"/>
<polygon fill="black" stroke="black" points="941.44,-19690.86 931.07,-19688.68 937.82,-19696.85 941.44,-19690.86"/>
</g>
<!-- layer_2_attn_out_gpu7 -->
<g id="node108" class="node">
<title>layer_2_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="867,-19605.05 779,-19605.05 779,-19553.05 867,-19553.05 867,-19605.05"/>
<text text-anchor="middle" x="823" y="-19593.05" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="823" y="-19582.05" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="823" y="-19571.05" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="823" y="-19560.05" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attention&#45;&gt;layer_2_attn_out_gpu7 -->
<g id="edge140" class="edge">
<title>layer_2_attention&#45;&gt;layer_2_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M875.2,-19640.71C867.75,-19632.05 859.3,-19622.24 851.4,-19613.06"/>
<polygon fill="black" stroke="black" points="853.82,-19610.51 844.65,-19605.21 848.52,-19615.07 853.82,-19610.51"/>
</g>
<!-- layer_2_attn_out_gpu0 -->
<g id="node101" class="node">
<title>layer_2_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="973,-19605.05 885,-19605.05 885,-19553.05 973,-19553.05 973,-19605.05"/>
<text text-anchor="middle" x="929" y="-19593.05" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="929" y="-19582.05" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="929" y="-19571.05" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="929" y="-19560.05" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_allreduce_attn -->
<g id="node109" class="node">
<title>layer_2_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="1247" cy="-19488.06" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="1247" y="-19496.56" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="1247" y="-19485.56" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="1247" y="-19474.56" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_2_attn_out_gpu0&#45;&gt;layer_2_allreduce_attn -->
<g id="edge141" class="edge">
<title>layer_2_attn_out_gpu0&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M973.26,-19556.37C976.19,-19555.19 979.12,-19554.07 982,-19553.05 1049.13,-19529.39 1128.84,-19511.45 1183.19,-19500.67"/>
<polygon fill="black" stroke="black" points="1183.89,-19504.1 1193.03,-19498.74 1182.54,-19497.23 1183.89,-19504.1"/>
</g>
<!-- layer_2_attn_out_gpu1 -->
<g id="node102" class="node">
<title>layer_2_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1079,-19605.05 991,-19605.05 991,-19553.05 1079,-19553.05 1079,-19605.05"/>
<text text-anchor="middle" x="1035" y="-19593.05" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="1035" y="-19582.05" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1035" y="-19571.05" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1035" y="-19560.05" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attn_out_gpu1&#45;&gt;layer_2_allreduce_attn -->
<g id="edge142" class="edge">
<title>layer_2_attn_out_gpu1&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M1079.16,-19556.99C1082.14,-19555.64 1085.11,-19554.31 1088,-19553.05 1122.33,-19538.06 1161.34,-19522.34 1192.13,-19510.23"/>
<polygon fill="black" stroke="black" points="1193.79,-19513.34 1201.82,-19506.44 1191.23,-19506.83 1193.79,-19513.34"/>
</g>
<!-- layer_2_attn_out_gpu2 -->
<g id="node103" class="node">
<title>layer_2_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1185,-19605.05 1097,-19605.05 1097,-19553.05 1185,-19553.05 1185,-19605.05"/>
<text text-anchor="middle" x="1141" y="-19593.05" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="1141" y="-19582.05" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1141" y="-19571.05" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1141" y="-19560.05" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attn_out_gpu2&#45;&gt;layer_2_allreduce_attn -->
<g id="edge143" class="edge">
<title>layer_2_attn_out_gpu2&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M1170.81,-19553.03C1183.08,-19542.72 1197.42,-19530.69 1210.33,-19519.85"/>
<polygon fill="black" stroke="black" points="1212.74,-19522.4 1218.15,-19513.28 1208.24,-19517.03 1212.74,-19522.4"/>
</g>
<!-- layer_2_attn_out_gpu3 -->
<g id="node104" class="node">
<title>layer_2_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1291,-19605.05 1203,-19605.05 1203,-19553.05 1291,-19553.05 1291,-19605.05"/>
<text text-anchor="middle" x="1247" y="-19593.05" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="1247" y="-19582.05" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1247" y="-19571.05" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1247" y="-19560.05" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attn_out_gpu3&#45;&gt;layer_2_allreduce_attn -->
<g id="edge144" class="edge">
<title>layer_2_attn_out_gpu3&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M1247,-19552.79C1247,-19544.9 1247,-19536.01 1247,-19527.43"/>
<polygon fill="black" stroke="black" points="1250.5,-19527.2 1247,-19517.2 1243.5,-19527.2 1250.5,-19527.2"/>
</g>
<!-- layer_2_attn_out_gpu4 -->
<g id="node105" class="node">
<title>layer_2_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1397,-19605.05 1309,-19605.05 1309,-19553.05 1397,-19553.05 1397,-19605.05"/>
<text text-anchor="middle" x="1353" y="-19593.05" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="1353" y="-19582.05" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1353" y="-19571.05" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1353" y="-19560.05" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attn_out_gpu4&#45;&gt;layer_2_allreduce_attn -->
<g id="edge145" class="edge">
<title>layer_2_attn_out_gpu4&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M1323.19,-19553.03C1310.92,-19542.72 1296.58,-19530.69 1283.67,-19519.85"/>
<polygon fill="black" stroke="black" points="1285.76,-19517.03 1275.85,-19513.28 1281.26,-19522.4 1285.76,-19517.03"/>
</g>
<!-- layer_2_attn_out_gpu5 -->
<g id="node106" class="node">
<title>layer_2_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1503,-19605.05 1415,-19605.05 1415,-19553.05 1503,-19553.05 1503,-19605.05"/>
<text text-anchor="middle" x="1459" y="-19593.05" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="1459" y="-19582.05" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1459" y="-19571.05" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1459" y="-19560.05" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attn_out_gpu5&#45;&gt;layer_2_allreduce_attn -->
<g id="edge146" class="edge">
<title>layer_2_attn_out_gpu5&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M1414.84,-19556.99C1411.86,-19555.64 1408.89,-19554.31 1406,-19553.05 1371.67,-19538.06 1332.66,-19522.34 1301.87,-19510.23"/>
<polygon fill="black" stroke="black" points="1302.77,-19506.83 1292.18,-19506.44 1300.21,-19513.34 1302.77,-19506.83"/>
</g>
<!-- layer_2_attn_out_gpu6 -->
<g id="node107" class="node">
<title>layer_2_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1609,-19605.05 1521,-19605.05 1521,-19553.05 1609,-19553.05 1609,-19605.05"/>
<text text-anchor="middle" x="1565" y="-19593.05" font-family="Arial" font-size="10.00">Layer 2 Attn Out</text>
<text text-anchor="middle" x="1565" y="-19582.05" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1565" y="-19571.05" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1565" y="-19560.05" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_2_attn_out_gpu6&#45;&gt;layer_2_allreduce_attn -->
<g id="edge147" class="edge">
<title>layer_2_attn_out_gpu6&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M1520.74,-19556.37C1517.81,-19555.19 1514.88,-19554.07 1512,-19553.05 1444.87,-19529.39 1365.16,-19511.45 1310.81,-19500.67"/>
<polygon fill="black" stroke="black" points="1311.46,-19497.23 1300.97,-19498.74 1310.11,-19504.1 1311.46,-19497.23"/>
</g>
<!-- layer_2_attn_out_gpu7&#45;&gt;layer_2_allreduce_attn -->
<g id="edge148" class="edge">
<title>layer_2_attn_out_gpu7&#45;&gt;layer_2_allreduce_attn</title>
<path fill="none" stroke="black" d="M867.18,-19556.15C870.13,-19555.02 873.09,-19553.97 876,-19553.05 979.43,-19520.4 1104.66,-19503.19 1179.97,-19495.12"/>
<polygon fill="black" stroke="black" points="1180.67,-19498.57 1190.25,-19494.05 1179.94,-19491.61 1180.67,-19498.57"/>
</g>
<!-- layer_2_allreduce_attn&#45;&gt;layer_2_residual1 -->
<g id="edge149" class="edge">
<title>layer_2_allreduce_attn&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M1288.35,-19467.34C1316.12,-19454.1 1353.09,-19436.47 1383.81,-19421.82"/>
<polygon fill="black" stroke="black" points="1385.6,-19424.84 1393.12,-19417.38 1382.59,-19418.52 1385.6,-19424.84"/>
</g>
<!-- layer_2_ln1 -->
<g id="node111" class="node">
<title>layer_2_ln1</title>
<polygon fill="lightblue" stroke="black" points="1273.5,-19327.07 1200.5,-19327.07 1200.5,-19286.07 1273.5,-19286.07 1273.5,-19327.07"/>
<text text-anchor="middle" x="1237" y="-19315.07" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="1237" y="-19304.07" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="1237" y="-19293.07" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_2_residual1&#45;&gt;layer_2_ln1 -->
<g id="edge151" class="edge">
<title>layer_2_residual1&#45;&gt;layer_2_ln1</title>
<path fill="none" stroke="black" d="M1371.45,-19362.99C1342.16,-19350.91 1308.99,-19337.24 1282.93,-19326.5"/>
<polygon fill="black" stroke="black" points="1284.25,-19323.26 1273.67,-19322.68 1281.58,-19329.73 1284.25,-19323.26"/>
</g>
<!-- layer_2_residual2 -->
<g id="node131" class="node">
<title>layer_2_residual2</title>
<polygon fill="lightyellow" stroke="black" points="1602.94,-18814.1 1480.55,-18814.1 1449.06,-18754.1 1571.45,-18754.1 1602.94,-18814.1"/>
<text text-anchor="middle" x="1526" y="-18787.1" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="1526" y="-18776.1" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_2_residual1&#45;&gt;layer_2_residual2 -->
<g id="edge179" class="edge">
<title>layer_2_residual1&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M1499.29,-19385.01C1583.81,-19371.04 1732,-19331.39 1732,-19225.07 1732,-19225.07 1732,-19225.07 1732,-18969.09 1732,-18898.88 1664.61,-18848.8 1606.92,-18818.78"/>
<polygon fill="black" stroke="black" points="1608.26,-18815.54 1597.76,-18814.14 1605.1,-18821.78 1608.26,-18815.54"/>
</g>
<!-- layer_2_mlp_fc1_gpu0 -->
<g id="node112" class="node">
<title>layer_2_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="836,-19250.07 742,-19250.07 742,-19198.07 836,-19198.07 836,-19250.07"/>
<text text-anchor="middle" x="789" y="-19238.07" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="789" y="-19227.07" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="789" y="-19216.07" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="789" y="-19205.07" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu0 -->
<g id="edge152" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M1200.35,-19303.79C1131.78,-19299.74 979.67,-19287.32 845.63,-19249.9"/>
<polygon fill="black" stroke="black" points="846.58,-19246.54 836.01,-19247.16 844.67,-19253.27 846.58,-19246.54"/>
</g>
<!-- layer_2_mlp_fc1_gpu1 -->
<g id="node113" class="node">
<title>layer_2_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="948,-19250.07 854,-19250.07 854,-19198.07 948,-19198.07 948,-19250.07"/>
<text text-anchor="middle" x="901" y="-19238.07" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="901" y="-19227.07" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="901" y="-19216.07" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="901" y="-19205.07" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu1 -->
<g id="edge153" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M1200.1,-19300.94C1147.76,-19293.8 1049.05,-19278.21 957.73,-19250.01"/>
<polygon fill="black" stroke="black" points="958.66,-19246.64 948.07,-19246.97 956.55,-19253.31 958.66,-19246.64"/>
</g>
<!-- layer_2_mlp_fc1_gpu2 -->
<g id="node114" class="node">
<title>layer_2_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1060,-19250.07 966,-19250.07 966,-19198.07 1060,-19198.07 1060,-19250.07"/>
<text text-anchor="middle" x="1013" y="-19238.07" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="1013" y="-19227.07" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1013" y="-19216.07" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1013" y="-19205.07" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu2 -->
<g id="edge154" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M1200.25,-19294.6C1167.97,-19284.71 1119.62,-19269.26 1069.58,-19250.16"/>
<polygon fill="black" stroke="black" points="1070.8,-19246.88 1060.22,-19246.55 1068.29,-19253.41 1070.8,-19246.88"/>
</g>
<!-- layer_2_mlp_fc1_gpu3 -->
<g id="node115" class="node">
<title>layer_2_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1172,-19250.07 1078,-19250.07 1078,-19198.07 1172,-19198.07 1172,-19250.07"/>
<text text-anchor="middle" x="1125" y="-19238.07" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="1125" y="-19227.07" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1125" y="-19216.07" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1125" y="-19205.07" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu3 -->
<g id="edge155" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M1209.6,-19285.88C1197.27,-19277.01 1182.4,-19266.33 1168.59,-19256.4"/>
<polygon fill="black" stroke="black" points="1170.33,-19253.34 1160.17,-19250.35 1166.24,-19259.02 1170.33,-19253.34"/>
</g>
<!-- layer_2_mlp_fc1_gpu4 -->
<g id="node116" class="node">
<title>layer_2_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1284,-19250.07 1190,-19250.07 1190,-19198.07 1284,-19198.07 1284,-19250.07"/>
<text text-anchor="middle" x="1237" y="-19238.07" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="1237" y="-19227.07" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1237" y="-19216.07" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1237" y="-19205.07" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu4 -->
<g id="edge156" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M1237,-19285.67C1237,-19278.06 1237,-19269.13 1237,-19260.49"/>
<polygon fill="black" stroke="black" points="1240.5,-19260.22 1237,-19250.22 1233.5,-19260.22 1240.5,-19260.22"/>
</g>
<!-- layer_2_mlp_fc1_gpu5 -->
<g id="node117" class="node">
<title>layer_2_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1396,-19250.07 1302,-19250.07 1302,-19198.07 1396,-19198.07 1396,-19250.07"/>
<text text-anchor="middle" x="1349" y="-19238.07" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="1349" y="-19227.07" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1349" y="-19216.07" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1349" y="-19205.07" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu5 -->
<g id="edge157" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M1264.4,-19285.88C1276.73,-19277.01 1291.6,-19266.33 1305.41,-19256.4"/>
<polygon fill="black" stroke="black" points="1307.76,-19259.02 1313.83,-19250.35 1303.67,-19253.34 1307.76,-19259.02"/>
</g>
<!-- layer_2_mlp_fc1_gpu6 -->
<g id="node118" class="node">
<title>layer_2_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1508,-19250.07 1414,-19250.07 1414,-19198.07 1508,-19198.07 1508,-19250.07"/>
<text text-anchor="middle" x="1461" y="-19238.07" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="1461" y="-19227.07" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1461" y="-19216.07" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1461" y="-19205.07" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu6 -->
<g id="edge158" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M1273.75,-19294.6C1306.03,-19284.71 1354.38,-19269.26 1404.42,-19250.16"/>
<polygon fill="black" stroke="black" points="1405.71,-19253.41 1413.78,-19246.55 1403.2,-19246.88 1405.71,-19253.41"/>
</g>
<!-- layer_2_mlp_fc1_gpu7 -->
<g id="node119" class="node">
<title>layer_2_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1620,-19250.07 1526,-19250.07 1526,-19198.07 1620,-19198.07 1620,-19250.07"/>
<text text-anchor="middle" x="1573" y="-19238.07" font-family="Arial" font-size="10.00">Layer 2 MLP FC1</text>
<text text-anchor="middle" x="1573" y="-19227.07" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1573" y="-19216.07" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1573" y="-19205.07" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu7 -->
<g id="edge159" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M1273.9,-19300.94C1326.24,-19293.8 1424.95,-19278.21 1516.27,-19250.01"/>
<polygon fill="black" stroke="black" points="1517.45,-19253.31 1525.93,-19246.97 1515.34,-19246.64 1517.45,-19253.31"/>
</g>
<!-- layer_2_allgather_mlp -->
<g id="node120" class="node">
<title>layer_2_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="1125" cy="-19133.08" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="1125" y="-19141.58" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="1125" y="-19130.58" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="1125" y="-19119.58" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_2_mlp_fc1_gpu0&#45;&gt;layer_2_allgather_mlp -->
<g id="edge160" class="edge">
<title>layer_2_mlp_fc1_gpu0&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M836.1,-19201.27C839.09,-19200.12 842.07,-19199.05 845,-19198.07 917.84,-19173.75 1004.37,-19155.53 1061.76,-19144.87"/>
<polygon fill="black" stroke="black" points="1062.57,-19148.28 1071.78,-19143.04 1061.31,-19141.4 1062.57,-19148.28"/>
</g>
<!-- layer_2_mlp_fc1_gpu1&#45;&gt;layer_2_allgather_mlp -->
<g id="edge161" class="edge">
<title>layer_2_mlp_fc1_gpu1&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M948.28,-19201.74C951.22,-19200.48 954.15,-19199.25 957,-19198.07 994.41,-19182.61 1037.04,-19166.39 1069.99,-19154.15"/>
<polygon fill="black" stroke="black" points="1071.29,-19157.4 1079.45,-19150.64 1068.86,-19150.83 1071.29,-19157.4"/>
</g>
<!-- layer_2_mlp_fc1_gpu2&#45;&gt;layer_2_allgather_mlp -->
<g id="edge162" class="edge">
<title>layer_2_mlp_fc1_gpu2&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M1044.5,-19198.04C1057.69,-19187.56 1073.15,-19175.27 1086.98,-19164.29"/>
<polygon fill="black" stroke="black" points="1089.24,-19166.96 1094.9,-19158 1084.89,-19161.48 1089.24,-19166.96"/>
</g>
<!-- layer_2_mlp_fc1_gpu3&#45;&gt;layer_2_allgather_mlp -->
<g id="edge163" class="edge">
<title>layer_2_mlp_fc1_gpu3&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M1125,-19197.81C1125,-19189.91 1125,-19181.02 1125,-19172.44"/>
<polygon fill="black" stroke="black" points="1128.5,-19172.22 1125,-19162.22 1121.5,-19172.22 1128.5,-19172.22"/>
</g>
<!-- layer_2_mlp_fc1_gpu4&#45;&gt;layer_2_allgather_mlp -->
<g id="edge164" class="edge">
<title>layer_2_mlp_fc1_gpu4&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M1205.5,-19198.04C1192.31,-19187.56 1176.85,-19175.27 1163.02,-19164.29"/>
<polygon fill="black" stroke="black" points="1165.11,-19161.48 1155.1,-19158 1160.76,-19166.96 1165.11,-19161.48"/>
</g>
<!-- layer_2_mlp_fc1_gpu5&#45;&gt;layer_2_allgather_mlp -->
<g id="edge165" class="edge">
<title>layer_2_mlp_fc1_gpu5&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M1301.72,-19201.74C1298.78,-19200.48 1295.85,-19199.25 1293,-19198.07 1255.59,-19182.61 1212.96,-19166.39 1180.01,-19154.15"/>
<polygon fill="black" stroke="black" points="1181.14,-19150.83 1170.55,-19150.64 1178.71,-19157.4 1181.14,-19150.83"/>
</g>
<!-- layer_2_mlp_fc1_gpu6&#45;&gt;layer_2_allgather_mlp -->
<g id="edge166" class="edge">
<title>layer_2_mlp_fc1_gpu6&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M1413.9,-19201.27C1410.91,-19200.12 1407.93,-19199.05 1405,-19198.07 1332.16,-19173.75 1245.63,-19155.53 1188.24,-19144.87"/>
<polygon fill="black" stroke="black" points="1188.69,-19141.4 1178.22,-19143.04 1187.43,-19148.28 1188.69,-19141.4"/>
</g>
<!-- layer_2_mlp_fc1_gpu7&#45;&gt;layer_2_allgather_mlp -->
<g id="edge167" class="edge">
<title>layer_2_mlp_fc1_gpu7&#45;&gt;layer_2_allgather_mlp</title>
<path fill="none" stroke="black" d="M1525.97,-19201.05C1522.96,-19199.96 1519.96,-19198.95 1517,-19198.07 1405.1,-19164.57 1269.65,-19147.39 1190.82,-19139.59"/>
<polygon fill="black" stroke="black" points="1190.84,-19136.08 1180.55,-19138.6 1190.16,-19143.05 1190.84,-19136.08"/>
</g>
<!-- layer_2_gelu -->
<g id="node121" class="node">
<title>layer_2_gelu</title>
<polygon fill="lightblue" stroke="black" points="1001.5,-19068.09 912.5,-19068.09 912.5,-19032.09 1001.5,-19032.09 1001.5,-19068.09"/>
<text text-anchor="middle" x="957" y="-19053.09" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="957" y="-19042.09" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_2_allgather_mlp&#45;&gt;layer_2_gelu -->
<g id="edge168" class="edge">
<title>layer_2_allgather_mlp&#45;&gt;layer_2_gelu</title>
<path fill="none" stroke="black" d="M1084.76,-19112.68C1059.69,-19100.59 1027.4,-19085.03 1001.56,-19072.57"/>
<polygon fill="black" stroke="black" points="1002.88,-19069.32 992.35,-19068.13 999.84,-19075.62 1002.88,-19069.32"/>
</g>
<!-- layer_2_mlp_fc2_gpu7 -->
<g id="node129" class="node">
<title>layer_2_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="920,-18996.09 826,-18996.09 826,-18944.09 920,-18944.09 920,-18996.09"/>
<text text-anchor="middle" x="873" y="-18984.09" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="873" y="-18973.09" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="873" y="-18962.09" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="873" y="-18951.09" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu7 -->
<g id="edge169" class="edge">
<title>layer_2_gelu&#45;&gt;layer_2_mlp_fc2_gpu7</title>
<path fill="none" stroke="black" d="M938.36,-19031.78C929.33,-19023.4 918.2,-19013.06 907.7,-19003.31"/>
<polygon fill="black" stroke="black" points="909.91,-19000.58 900.2,-18996.34 905.15,-19005.71 909.91,-19000.58"/>
</g>
<!-- layer_2_mlp_fc2_gpu0 -->
<g id="node122" class="node">
<title>layer_2_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1032,-18996.09 938,-18996.09 938,-18944.09 1032,-18944.09 1032,-18996.09"/>
<text text-anchor="middle" x="985" y="-18984.09" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="985" y="-18973.09" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="985" y="-18962.09" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="985" y="-18951.09" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_allreduce_mlp -->
<g id="node130" class="node">
<title>layer_2_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="1321" cy="-18879.09" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="1321" y="-18887.59" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="1321" y="-18876.59" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="1321" y="-18865.59" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_2_mlp_fc2_gpu0&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge170" class="edge">
<title>layer_2_mlp_fc2_gpu0&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1032.1,-18947.28C1035.09,-18946.14 1038.07,-18945.06 1041,-18944.09 1112.61,-18920.17 1197.46,-18902.16 1254.84,-18891.44"/>
<polygon fill="black" stroke="black" points="1255.67,-18894.84 1264.87,-18889.58 1254.4,-18887.96 1255.67,-18894.84"/>
</g>
<!-- layer_2_mlp_fc2_gpu1 -->
<g id="node123" class="node">
<title>layer_2_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1144,-18996.09 1050,-18996.09 1050,-18944.09 1144,-18944.09 1144,-18996.09"/>
<text text-anchor="middle" x="1097" y="-18984.09" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="1097" y="-18973.09" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1097" y="-18962.09" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1097" y="-18951.09" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_mlp_fc2_gpu1&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge171" class="edge">
<title>layer_2_mlp_fc2_gpu1&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1144.28,-18947.76C1147.22,-18946.5 1150.15,-18945.27 1153,-18944.09 1189.89,-18928.84 1231.84,-18912.86 1264.6,-18900.68"/>
<polygon fill="black" stroke="black" points="1265.85,-18903.95 1274.01,-18897.19 1263.42,-18897.38 1265.85,-18903.95"/>
</g>
<!-- layer_2_mlp_fc2_gpu2 -->
<g id="node124" class="node">
<title>layer_2_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1256,-18996.09 1162,-18996.09 1162,-18944.09 1256,-18944.09 1256,-18996.09"/>
<text text-anchor="middle" x="1209" y="-18984.09" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="1209" y="-18973.09" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1209" y="-18962.09" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1209" y="-18951.09" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_mlp_fc2_gpu2&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge172" class="edge">
<title>layer_2_mlp_fc2_gpu2&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1240.5,-18944.06C1253.59,-18933.66 1268.9,-18921.49 1282.64,-18910.58"/>
<polygon fill="black" stroke="black" points="1284.86,-18913.28 1290.51,-18904.32 1280.51,-18907.8 1284.86,-18913.28"/>
</g>
<!-- layer_2_mlp_fc2_gpu3 -->
<g id="node125" class="node">
<title>layer_2_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1368,-18996.09 1274,-18996.09 1274,-18944.09 1368,-18944.09 1368,-18996.09"/>
<text text-anchor="middle" x="1321" y="-18984.09" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="1321" y="-18973.09" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1321" y="-18962.09" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1321" y="-18951.09" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_mlp_fc2_gpu3&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge173" class="edge">
<title>layer_2_mlp_fc2_gpu3&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1321,-18943.82C1321,-18935.93 1321,-18927.04 1321,-18918.46"/>
<polygon fill="black" stroke="black" points="1324.5,-18918.24 1321,-18908.24 1317.5,-18918.24 1324.5,-18918.24"/>
</g>
<!-- layer_2_mlp_fc2_gpu4 -->
<g id="node126" class="node">
<title>layer_2_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1480,-18996.09 1386,-18996.09 1386,-18944.09 1480,-18944.09 1480,-18996.09"/>
<text text-anchor="middle" x="1433" y="-18984.09" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="1433" y="-18973.09" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1433" y="-18962.09" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1433" y="-18951.09" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_mlp_fc2_gpu4&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge174" class="edge">
<title>layer_2_mlp_fc2_gpu4&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1401.5,-18944.06C1388.41,-18933.66 1373.1,-18921.49 1359.36,-18910.58"/>
<polygon fill="black" stroke="black" points="1361.49,-18907.8 1351.49,-18904.32 1357.14,-18913.28 1361.49,-18907.8"/>
</g>
<!-- layer_2_mlp_fc2_gpu5 -->
<g id="node127" class="node">
<title>layer_2_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1592,-18996.09 1498,-18996.09 1498,-18944.09 1592,-18944.09 1592,-18996.09"/>
<text text-anchor="middle" x="1545" y="-18984.09" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="1545" y="-18973.09" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1545" y="-18962.09" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1545" y="-18951.09" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_mlp_fc2_gpu5&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge175" class="edge">
<title>layer_2_mlp_fc2_gpu5&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1497.72,-18947.76C1494.78,-18946.5 1491.85,-18945.27 1489,-18944.09 1452.11,-18928.84 1410.16,-18912.86 1377.4,-18900.68"/>
<polygon fill="black" stroke="black" points="1378.58,-18897.38 1367.99,-18897.19 1376.15,-18903.95 1378.58,-18897.38"/>
</g>
<!-- layer_2_mlp_fc2_gpu6 -->
<g id="node128" class="node">
<title>layer_2_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1704,-18996.09 1610,-18996.09 1610,-18944.09 1704,-18944.09 1704,-18996.09"/>
<text text-anchor="middle" x="1657" y="-18984.09" font-family="Arial" font-size="10.00">Layer 2 MLP FC2</text>
<text text-anchor="middle" x="1657" y="-18973.09" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1657" y="-18962.09" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1657" y="-18951.09" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_2_mlp_fc2_gpu6&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge176" class="edge">
<title>layer_2_mlp_fc2_gpu6&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1609.9,-18947.28C1606.91,-18946.14 1603.93,-18945.06 1601,-18944.09 1529.39,-18920.17 1444.54,-18902.16 1387.16,-18891.44"/>
<polygon fill="black" stroke="black" points="1387.6,-18887.96 1377.13,-18889.58 1386.33,-18894.84 1387.6,-18887.96"/>
</g>
<!-- layer_2_mlp_fc2_gpu7&#45;&gt;layer_2_allreduce_mlp -->
<g id="edge177" class="edge">
<title>layer_2_mlp_fc2_gpu7&#45;&gt;layer_2_allreduce_mlp</title>
<path fill="none" stroke="black" d="M920.03,-18947.06C923.04,-18945.98 926.04,-18944.97 929,-18944.09 1039.16,-18911.11 1172.15,-18893.94 1251.47,-18885.98"/>
<polygon fill="black" stroke="black" points="1252.21,-18889.42 1261.82,-18884.96 1251.53,-18882.46 1252.21,-18889.42"/>
</g>
<!-- layer_2_allreduce_mlp&#45;&gt;layer_2_residual2 -->
<g id="edge178" class="edge">
<title>layer_2_allreduce_mlp&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M1363.97,-18858.6C1394,-18844.98 1434.46,-18826.63 1467.43,-18811.67"/>
<polygon fill="black" stroke="black" points="1469.3,-18814.67 1476.96,-18807.35 1466.41,-18808.29 1469.3,-18814.67"/>
</g>
<!-- layer_2_ln2 -->
<g id="node132" class="node">
<title>layer_2_ln2</title>
<polygon fill="lightblue" stroke="black" points="1562.5,-18718.1 1489.5,-18718.1 1489.5,-18677.1 1562.5,-18677.1 1562.5,-18718.1"/>
<text text-anchor="middle" x="1526" y="-18706.1" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="1526" y="-18695.1" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="1526" y="-18684.1" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_2_residual2&#45;&gt;layer_2_ln2 -->
<g id="edge180" class="edge">
<title>layer_2_residual2&#45;&gt;layer_2_ln2</title>
<path fill="none" stroke="black" d="M1526,-18754.02C1526,-18745.7 1526,-18736.62 1526,-18728.26"/>
<polygon fill="black" stroke="black" points="1529.5,-18728.17 1526,-18718.17 1522.5,-18728.17 1529.5,-18728.17"/>
</g>
<!-- layer_2_output_dist -->
<g id="node133" class="node">
<title>layer_2_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="1627.7,-18641.1 1465.92,-18641.1 1424.3,-18581.1 1586.08,-18581.1 1627.7,-18641.1"/>
<text text-anchor="middle" x="1526" y="-18614.1" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="1526" y="-18603.1" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_2_ln2&#45;&gt;layer_2_output_dist -->
<g id="edge181" class="edge">
<title>layer_2_ln2&#45;&gt;layer_2_output_dist</title>
<path fill="none" stroke="black" d="M1526,-18677C1526,-18669.37 1526,-18660.32 1526,-18651.45"/>
<polygon fill="black" stroke="black" points="1529.5,-18651.21 1526,-18641.21 1522.5,-18651.21 1529.5,-18651.21"/>
</g>
<!-- layer_3_input_dist -->
<g id="node134" class="node">
<title>layer_3_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="1620.19,-18545.1 1470.36,-18545.1 1431.81,-18485.1 1581.64,-18485.1 1620.19,-18545.1"/>
<text text-anchor="middle" x="1526" y="-18518.1" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1526" y="-18507.1" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_2_output_dist&#45;&gt;layer_3_input_dist -->
<g id="edge182" class="edge">
<title>layer_2_output_dist&#45;&gt;layer_3_input_dist</title>
<path fill="none" stroke="black" d="M1526,-18580.88C1526,-18572.83 1526,-18563.97 1526,-18555.45"/>
<polygon fill="black" stroke="black" points="1529.5,-18555.31 1526,-18545.31 1522.5,-18555.31 1529.5,-18555.31"/>
</g>
<!-- layer_3_qkv_gpu0 -->
<g id="node135" class="node">
<title>layer_3_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1128.5,-18449.1 1035.5,-18449.1 1035.5,-18397.1 1128.5,-18397.1 1128.5,-18449.1"/>
<text text-anchor="middle" x="1082" y="-18437.1" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="1082" y="-18426.1" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1082" y="-18415.1" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1082" y="-18404.1" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu0 -->
<g id="edge183" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1445.5,-18506.64C1368.32,-18498.13 1248.81,-18481.4 1138.36,-18448.88"/>
<polygon fill="black" stroke="black" points="1139.31,-18445.51 1128.72,-18446 1137.3,-18452.22 1139.31,-18445.51"/>
</g>
<!-- layer_3_qkv_gpu1 -->
<g id="node136" class="node">
<title>layer_3_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1239.5,-18449.1 1146.5,-18449.1 1146.5,-18397.1 1239.5,-18397.1 1239.5,-18449.1"/>
<text text-anchor="middle" x="1193" y="-18437.1" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="1193" y="-18426.1" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1193" y="-18415.1" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1193" y="-18404.1" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu1 -->
<g id="edge184" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1440.28,-18498.36C1387.43,-18487.64 1318.37,-18471.79 1249.51,-18449.03"/>
<polygon fill="black" stroke="black" points="1250.39,-18445.63 1239.8,-18445.77 1248.16,-18452.27 1250.39,-18445.63"/>
</g>
<!-- layer_3_qkv_gpu2 -->
<g id="node137" class="node">
<title>layer_3_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1350.5,-18449.1 1257.5,-18449.1 1257.5,-18397.1 1350.5,-18397.1 1350.5,-18449.1"/>
<text text-anchor="middle" x="1304" y="-18437.1" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="1304" y="-18426.1" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1304" y="-18415.1" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1304" y="-18404.1" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu2 -->
<g id="edge185" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1449.67,-18485.07C1421.39,-18474.09 1389.12,-18461.3 1360,-18449.1 1359.9,-18449.06 1359.81,-18449.02 1359.71,-18448.98"/>
<polygon fill="black" stroke="black" points="1361.25,-18445.83 1350.68,-18445.14 1358.51,-18452.28 1361.25,-18445.83"/>
</g>
<!-- layer_3_qkv_gpu3 -->
<g id="node138" class="node">
<title>layer_3_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1461.5,-18449.1 1368.5,-18449.1 1368.5,-18397.1 1461.5,-18397.1 1461.5,-18449.1"/>
<text text-anchor="middle" x="1415" y="-18437.1" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="1415" y="-18426.1" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1415" y="-18415.1" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1415" y="-18404.1" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu3 -->
<g id="edge186" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1489.96,-18484.88C1478.44,-18475.54 1465.64,-18465.16 1453.92,-18455.66"/>
<polygon fill="black" stroke="black" points="1455.98,-18452.83 1446.01,-18449.25 1451.58,-18458.26 1455.98,-18452.83"/>
</g>
<!-- layer_3_qkv_gpu4 -->
<g id="node139" class="node">
<title>layer_3_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1572.5,-18449.1 1479.5,-18449.1 1479.5,-18397.1 1572.5,-18397.1 1572.5,-18449.1"/>
<text text-anchor="middle" x="1526" y="-18437.1" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="1526" y="-18426.1" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1526" y="-18415.1" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1526" y="-18404.1" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu4 -->
<g id="edge187" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1526,-18484.63C1526,-18476.56 1526,-18467.73 1526,-18459.36"/>
<polygon fill="black" stroke="black" points="1529.5,-18459.11 1526,-18449.11 1522.5,-18459.11 1529.5,-18459.11"/>
</g>
<!-- layer_3_qkv_gpu5 -->
<g id="node140" class="node">
<title>layer_3_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1683.5,-18449.1 1590.5,-18449.1 1590.5,-18397.1 1683.5,-18397.1 1683.5,-18449.1"/>
<text text-anchor="middle" x="1637" y="-18437.1" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="1637" y="-18426.1" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1637" y="-18415.1" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1637" y="-18404.1" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu5 -->
<g id="edge188" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1562.04,-18484.88C1573.56,-18475.54 1586.36,-18465.16 1598.08,-18455.66"/>
<polygon fill="black" stroke="black" points="1600.42,-18458.26 1605.99,-18449.25 1596.02,-18452.83 1600.42,-18458.26"/>
</g>
<!-- layer_3_qkv_gpu6 -->
<g id="node141" class="node">
<title>layer_3_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1794.5,-18449.1 1701.5,-18449.1 1701.5,-18397.1 1794.5,-18397.1 1794.5,-18449.1"/>
<text text-anchor="middle" x="1748" y="-18437.1" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="1748" y="-18426.1" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1748" y="-18415.1" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1748" y="-18404.1" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu6 -->
<g id="edge189" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1586.23,-18491.59C1615.83,-18480.3 1652.18,-18466.13 1691.92,-18449.49"/>
<polygon fill="black" stroke="black" points="1693.41,-18452.66 1701.27,-18445.56 1690.7,-18446.21 1693.41,-18452.66"/>
</g>
<!-- layer_3_qkv_gpu7 -->
<g id="node142" class="node">
<title>layer_3_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1905.5,-18449.1 1812.5,-18449.1 1812.5,-18397.1 1905.5,-18397.1 1905.5,-18449.1"/>
<text text-anchor="middle" x="1859" y="-18437.1" font-family="Arial" font-size="10.00">Layer 3 QKV Proj</text>
<text text-anchor="middle" x="1859" y="-18426.1" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1859" y="-18415.1" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1859" y="-18404.1" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_qkv_gpu7 -->
<g id="edge190" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1592.75,-18502.33C1647.38,-18491.83 1726.57,-18474.63 1802.7,-18449.31"/>
<polygon fill="black" stroke="black" points="1804.09,-18452.54 1812.45,-18446.02 1801.85,-18445.9 1804.09,-18452.54"/>
</g>
<!-- layer_3_residual1 -->
<g id="node154" class="node">
<title>layer_3_residual1</title>
<polygon fill="lightyellow" stroke="black" points="1889.94,-17997.14 1767.55,-17997.14 1736.06,-17937.14 1858.45,-17937.14 1889.94,-17997.14"/>
<text text-anchor="middle" x="1813" y="-17970.14" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1813" y="-17959.14" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_3_input_dist&#45;&gt;layer_3_residual1 -->
<g id="edge210" class="edge">
<title>layer_3_input_dist&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M1596.87,-18508.34C1693.96,-18499.42 1862.28,-18480.01 1915,-18449.1 1972,-18415.68 2008,-18399.19 2008,-18333.11 2008,-18333.11 2008,-18333.11 2008,-18152.12 2008,-18083.34 1943.02,-18032.66 1888.09,-18002.1"/>
<polygon fill="black" stroke="black" points="1889.48,-17998.88 1879.02,-17997.19 1886.14,-18005.03 1889.48,-17998.88"/>
</g>
<!-- layer_3_allgather_qkv -->
<g id="node143" class="node">
<title>layer_3_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="1415" cy="-18332.11" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="1415" y="-18340.61" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1415" y="-18329.61" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="1415" y="-18318.61" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_3_qkv_gpu0&#45;&gt;layer_3_allgather_qkv -->
<g id="edge191" class="edge">
<title>layer_3_qkv_gpu0&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M1128.79,-18400.43C1131.88,-18399.24 1134.97,-18398.12 1138,-18397.1 1209.63,-18373.09 1294.62,-18354.92 1351.4,-18344.18"/>
<polygon fill="black" stroke="black" points="1352.12,-18347.61 1361.31,-18342.33 1350.84,-18340.73 1352.12,-18347.61"/>
</g>
<!-- layer_3_qkv_gpu1&#45;&gt;layer_3_allgather_qkv -->
<g id="edge192" class="edge">
<title>layer_3_qkv_gpu1&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M1239.67,-18401.05C1242.82,-18399.7 1245.95,-18398.37 1249,-18397.1 1285.7,-18381.85 1327.45,-18365.76 1359.9,-18353.53"/>
<polygon fill="black" stroke="black" points="1361.53,-18356.66 1369.66,-18349.87 1359.06,-18350.11 1361.53,-18356.66"/>
</g>
<!-- layer_3_qkv_gpu2&#45;&gt;layer_3_allgather_qkv -->
<g id="edge193" class="edge">
<title>layer_3_qkv_gpu2&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M1335.22,-18397.08C1348.29,-18386.59 1363.61,-18374.31 1377.31,-18363.32"/>
<polygon fill="black" stroke="black" points="1379.55,-18366.02 1385.17,-18357.03 1375.17,-18360.56 1379.55,-18366.02"/>
</g>
<!-- layer_3_qkv_gpu3&#45;&gt;layer_3_allgather_qkv -->
<g id="edge194" class="edge">
<title>layer_3_qkv_gpu3&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M1415,-18396.84C1415,-18388.95 1415,-18380.06 1415,-18371.48"/>
<polygon fill="black" stroke="black" points="1418.5,-18371.25 1415,-18361.25 1411.5,-18371.25 1418.5,-18371.25"/>
</g>
<!-- layer_3_qkv_gpu4&#45;&gt;layer_3_allgather_qkv -->
<g id="edge195" class="edge">
<title>layer_3_qkv_gpu4&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M1494.78,-18397.08C1481.71,-18386.59 1466.39,-18374.31 1452.69,-18363.32"/>
<polygon fill="black" stroke="black" points="1454.83,-18360.56 1444.83,-18357.03 1450.45,-18366.02 1454.83,-18360.56"/>
</g>
<!-- layer_3_qkv_gpu5&#45;&gt;layer_3_allgather_qkv -->
<g id="edge196" class="edge">
<title>layer_3_qkv_gpu5&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M1590.28,-18400.63C1587.48,-18399.42 1584.71,-18398.24 1582,-18397.1 1544.98,-18381.61 1502.78,-18365.45 1470.06,-18353.25"/>
<polygon fill="black" stroke="black" points="1471.25,-18349.96 1460.66,-18349.76 1468.81,-18356.52 1471.25,-18349.96"/>
</g>
<!-- layer_3_qkv_gpu6&#45;&gt;layer_3_allgather_qkv -->
<g id="edge197" class="edge">
<title>layer_3_qkv_gpu6&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M1701.45,-18400.18C1698.61,-18399.08 1695.78,-18398.05 1693,-18397.1 1621.2,-18372.8 1535.88,-18354.68 1478.87,-18344.04"/>
<polygon fill="black" stroke="black" points="1479.39,-18340.58 1468.92,-18342.2 1478.12,-18347.46 1479.39,-18340.58"/>
</g>
<!-- layer_3_qkv_gpu7&#45;&gt;layer_3_allgather_qkv -->
<g id="edge198" class="edge">
<title>layer_3_qkv_gpu7&#45;&gt;layer_3_allgather_qkv</title>
<path fill="none" stroke="black" d="M1812.21,-18399.85C1809.46,-18398.85 1806.71,-18397.93 1804,-18397.1 1693.69,-18363.6 1560.14,-18346.48 1481.68,-18338.69"/>
<polygon fill="black" stroke="black" points="1481.75,-18335.18 1471.45,-18337.7 1481.07,-18342.15 1481.75,-18335.18"/>
</g>
<!-- layer_3_attention -->
<g id="node144" class="node">
<title>layer_3_attention</title>
<polygon fill="lightblue" stroke="black" points="1302,-18267.12 1234,-18267.12 1234,-18215.12 1302,-18215.12 1302,-18267.12"/>
<text text-anchor="middle" x="1268" y="-18255.12" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1268" y="-18244.12" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1268" y="-18233.12" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="1268" y="-18222.12" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_3_allgather_qkv&#45;&gt;layer_3_attention -->
<g id="edge199" class="edge">
<title>layer_3_allgather_qkv&#45;&gt;layer_3_attention</title>
<path fill="none" stroke="black" d="M1379.04,-18309.34C1358.42,-18296.86 1332.41,-18281.12 1310.75,-18268"/>
<polygon fill="black" stroke="black" points="1312.44,-18264.93 1302.07,-18262.75 1308.82,-18270.92 1312.44,-18264.93"/>
</g>
<!-- layer_3_attn_out_gpu7 -->
<g id="node152" class="node">
<title>layer_3_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1238,-18179.12 1150,-18179.12 1150,-18127.12 1238,-18127.12 1238,-18179.12"/>
<text text-anchor="middle" x="1194" y="-18167.12" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="1194" y="-18156.12" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1194" y="-18145.12" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1194" y="-18134.12" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attention&#45;&gt;layer_3_attn_out_gpu7 -->
<g id="edge200" class="edge">
<title>layer_3_attention&#45;&gt;layer_3_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M1246.2,-18214.78C1238.75,-18206.12 1230.3,-18196.3 1222.4,-18187.13"/>
<polygon fill="black" stroke="black" points="1224.82,-18184.57 1215.65,-18179.28 1219.52,-18189.14 1224.82,-18184.57"/>
</g>
<!-- layer_3_attn_out_gpu0 -->
<g id="node145" class="node">
<title>layer_3_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1344,-18179.12 1256,-18179.12 1256,-18127.12 1344,-18127.12 1344,-18179.12"/>
<text text-anchor="middle" x="1300" y="-18167.12" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="1300" y="-18156.12" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1300" y="-18145.12" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1300" y="-18134.12" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_allreduce_attn -->
<g id="node153" class="node">
<title>layer_3_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="1618" cy="-18062.13" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="1618" y="-18070.63" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1618" y="-18059.63" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="1618" y="-18048.63" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_3_attn_out_gpu0&#45;&gt;layer_3_allreduce_attn -->
<g id="edge201" class="edge">
<title>layer_3_attn_out_gpu0&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M1344.26,-18130.44C1347.19,-18129.26 1350.12,-18128.14 1353,-18127.12 1420.13,-18103.46 1499.84,-18085.52 1554.19,-18074.74"/>
<polygon fill="black" stroke="black" points="1554.89,-18078.16 1564.03,-18072.81 1553.54,-18071.3 1554.89,-18078.16"/>
</g>
<!-- layer_3_attn_out_gpu1 -->
<g id="node146" class="node">
<title>layer_3_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1450,-18179.12 1362,-18179.12 1362,-18127.12 1450,-18127.12 1450,-18179.12"/>
<text text-anchor="middle" x="1406" y="-18167.12" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="1406" y="-18156.12" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1406" y="-18145.12" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1406" y="-18134.12" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attn_out_gpu1&#45;&gt;layer_3_allreduce_attn -->
<g id="edge202" class="edge">
<title>layer_3_attn_out_gpu1&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M1450.16,-18131.06C1453.14,-18129.71 1456.11,-18128.38 1459,-18127.12 1493.33,-18112.13 1532.34,-18096.41 1563.13,-18084.3"/>
<polygon fill="black" stroke="black" points="1564.79,-18087.41 1572.82,-18080.5 1562.23,-18080.9 1564.79,-18087.41"/>
</g>
<!-- layer_3_attn_out_gpu2 -->
<g id="node147" class="node">
<title>layer_3_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1556,-18179.12 1468,-18179.12 1468,-18127.12 1556,-18127.12 1556,-18179.12"/>
<text text-anchor="middle" x="1512" y="-18167.12" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="1512" y="-18156.12" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1512" y="-18145.12" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1512" y="-18134.12" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attn_out_gpu2&#45;&gt;layer_3_allreduce_attn -->
<g id="edge203" class="edge">
<title>layer_3_attn_out_gpu2&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M1541.81,-18127.09C1554.08,-18116.79 1568.42,-18104.75 1581.33,-18093.92"/>
<polygon fill="black" stroke="black" points="1583.74,-18096.46 1589.15,-18087.35 1579.24,-18091.1 1583.74,-18096.46"/>
</g>
<!-- layer_3_attn_out_gpu3 -->
<g id="node148" class="node">
<title>layer_3_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1662,-18179.12 1574,-18179.12 1574,-18127.12 1662,-18127.12 1662,-18179.12"/>
<text text-anchor="middle" x="1618" y="-18167.12" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="1618" y="-18156.12" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1618" y="-18145.12" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1618" y="-18134.12" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attn_out_gpu3&#45;&gt;layer_3_allreduce_attn -->
<g id="edge204" class="edge">
<title>layer_3_attn_out_gpu3&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M1618,-18126.86C1618,-18118.97 1618,-18110.08 1618,-18101.5"/>
<polygon fill="black" stroke="black" points="1621.5,-18101.27 1618,-18091.27 1614.5,-18101.27 1621.5,-18101.27"/>
</g>
<!-- layer_3_attn_out_gpu4 -->
<g id="node149" class="node">
<title>layer_3_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1768,-18179.12 1680,-18179.12 1680,-18127.12 1768,-18127.12 1768,-18179.12"/>
<text text-anchor="middle" x="1724" y="-18167.12" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="1724" y="-18156.12" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1724" y="-18145.12" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1724" y="-18134.12" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attn_out_gpu4&#45;&gt;layer_3_allreduce_attn -->
<g id="edge205" class="edge">
<title>layer_3_attn_out_gpu4&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M1694.19,-18127.09C1681.92,-18116.79 1667.58,-18104.75 1654.67,-18093.92"/>
<polygon fill="black" stroke="black" points="1656.76,-18091.1 1646.85,-18087.35 1652.26,-18096.46 1656.76,-18091.1"/>
</g>
<!-- layer_3_attn_out_gpu5 -->
<g id="node150" class="node">
<title>layer_3_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1874,-18179.12 1786,-18179.12 1786,-18127.12 1874,-18127.12 1874,-18179.12"/>
<text text-anchor="middle" x="1830" y="-18167.12" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="1830" y="-18156.12" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1830" y="-18145.12" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1830" y="-18134.12" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attn_out_gpu5&#45;&gt;layer_3_allreduce_attn -->
<g id="edge206" class="edge">
<title>layer_3_attn_out_gpu5&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M1785.84,-18131.06C1782.86,-18129.71 1779.89,-18128.38 1777,-18127.12 1742.67,-18112.13 1703.66,-18096.41 1672.87,-18084.3"/>
<polygon fill="black" stroke="black" points="1673.77,-18080.9 1663.18,-18080.5 1671.21,-18087.41 1673.77,-18080.9"/>
</g>
<!-- layer_3_attn_out_gpu6 -->
<g id="node151" class="node">
<title>layer_3_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1980,-18179.12 1892,-18179.12 1892,-18127.12 1980,-18127.12 1980,-18179.12"/>
<text text-anchor="middle" x="1936" y="-18167.12" font-family="Arial" font-size="10.00">Layer 3 Attn Out</text>
<text text-anchor="middle" x="1936" y="-18156.12" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1936" y="-18145.12" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1936" y="-18134.12" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_3_attn_out_gpu6&#45;&gt;layer_3_allreduce_attn -->
<g id="edge207" class="edge">
<title>layer_3_attn_out_gpu6&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M1891.74,-18130.44C1888.81,-18129.26 1885.88,-18128.14 1883,-18127.12 1815.87,-18103.46 1736.16,-18085.52 1681.81,-18074.74"/>
<polygon fill="black" stroke="black" points="1682.46,-18071.3 1671.97,-18072.81 1681.11,-18078.16 1682.46,-18071.3"/>
</g>
<!-- layer_3_attn_out_gpu7&#45;&gt;layer_3_allreduce_attn -->
<g id="edge208" class="edge">
<title>layer_3_attn_out_gpu7&#45;&gt;layer_3_allreduce_attn</title>
<path fill="none" stroke="black" d="M1238.18,-18130.22C1241.13,-18129.09 1244.09,-18128.04 1247,-18127.12 1350.43,-18094.47 1475.66,-18077.26 1550.97,-18069.19"/>
<polygon fill="black" stroke="black" points="1551.67,-18072.64 1561.25,-18068.11 1550.94,-18065.68 1551.67,-18072.64"/>
</g>
<!-- layer_3_allreduce_attn&#45;&gt;layer_3_residual1 -->
<g id="edge209" class="edge">
<title>layer_3_allreduce_attn&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M1659.35,-18041.41C1687.12,-18028.17 1724.09,-18010.54 1754.81,-17995.89"/>
<polygon fill="black" stroke="black" points="1756.6,-17998.91 1764.12,-17991.45 1753.59,-17992.59 1756.6,-17998.91"/>
</g>
<!-- layer_3_ln1 -->
<g id="node155" class="node">
<title>layer_3_ln1</title>
<polygon fill="lightblue" stroke="black" points="1644.5,-17901.14 1571.5,-17901.14 1571.5,-17860.14 1644.5,-17860.14 1644.5,-17901.14"/>
<text text-anchor="middle" x="1608" y="-17889.14" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1608" y="-17878.14" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="1608" y="-17867.14" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_3_residual1&#45;&gt;layer_3_ln1 -->
<g id="edge211" class="edge">
<title>layer_3_residual1&#45;&gt;layer_3_ln1</title>
<path fill="none" stroke="black" d="M1742.45,-17937.06C1713.16,-17924.98 1679.99,-17911.31 1653.93,-17900.57"/>
<polygon fill="black" stroke="black" points="1655.25,-17897.33 1644.67,-17896.75 1652.58,-17903.8 1655.25,-17897.33"/>
</g>
<!-- layer_3_residual2 -->
<g id="node175" class="node">
<title>layer_3_residual2</title>
<polygon fill="lightyellow" stroke="black" points="1973.94,-17388.17 1851.55,-17388.17 1820.06,-17328.17 1942.45,-17328.17 1973.94,-17388.17"/>
<text text-anchor="middle" x="1897" y="-17361.17" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1897" y="-17350.17" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_3_residual1&#45;&gt;layer_3_residual2 -->
<g id="edge239" class="edge">
<title>layer_3_residual1&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M1870.29,-17959.08C1954.81,-17945.11 2103,-17905.46 2103,-17799.14 2103,-17799.14 2103,-17799.14 2103,-17543.16 2103,-17472.95 2035.61,-17422.86 1977.92,-17392.85"/>
<polygon fill="black" stroke="black" points="1979.26,-17389.61 1968.76,-17388.21 1976.1,-17395.85 1979.26,-17389.61"/>
</g>
<!-- layer_3_mlp_fc1_gpu0 -->
<g id="node156" class="node">
<title>layer_3_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1207,-17824.14 1113,-17824.14 1113,-17772.14 1207,-17772.14 1207,-17824.14"/>
<text text-anchor="middle" x="1160" y="-17812.14" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="1160" y="-17801.14" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1160" y="-17790.14" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1160" y="-17779.14" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu0 -->
<g id="edge212" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M1571.35,-17877.86C1502.78,-17873.81 1350.67,-17861.39 1216.63,-17823.97"/>
<polygon fill="black" stroke="black" points="1217.58,-17820.6 1207.01,-17821.23 1215.67,-17827.34 1217.58,-17820.6"/>
</g>
<!-- layer_3_mlp_fc1_gpu1 -->
<g id="node157" class="node">
<title>layer_3_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1319,-17824.14 1225,-17824.14 1225,-17772.14 1319,-17772.14 1319,-17824.14"/>
<text text-anchor="middle" x="1272" y="-17812.14" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="1272" y="-17801.14" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1272" y="-17790.14" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1272" y="-17779.14" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu1 -->
<g id="edge213" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M1571.1,-17875.01C1518.76,-17867.87 1420.05,-17852.28 1328.73,-17824.08"/>
<polygon fill="black" stroke="black" points="1329.66,-17820.7 1319.07,-17821.04 1327.55,-17827.38 1329.66,-17820.7"/>
</g>
<!-- layer_3_mlp_fc1_gpu2 -->
<g id="node158" class="node">
<title>layer_3_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1431,-17824.14 1337,-17824.14 1337,-17772.14 1431,-17772.14 1431,-17824.14"/>
<text text-anchor="middle" x="1384" y="-17812.14" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="1384" y="-17801.14" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1384" y="-17790.14" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1384" y="-17779.14" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu2 -->
<g id="edge214" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M1571.25,-17868.67C1538.97,-17858.77 1490.62,-17843.33 1440.58,-17824.23"/>
<polygon fill="black" stroke="black" points="1441.8,-17820.95 1431.22,-17820.62 1439.29,-17827.48 1441.8,-17820.95"/>
</g>
<!-- layer_3_mlp_fc1_gpu3 -->
<g id="node159" class="node">
<title>layer_3_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1543,-17824.14 1449,-17824.14 1449,-17772.14 1543,-17772.14 1543,-17824.14"/>
<text text-anchor="middle" x="1496" y="-17812.14" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="1496" y="-17801.14" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1496" y="-17790.14" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1496" y="-17779.14" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu3 -->
<g id="edge215" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M1580.6,-17859.95C1568.27,-17851.08 1553.4,-17840.39 1539.59,-17830.47"/>
<polygon fill="black" stroke="black" points="1541.33,-17827.41 1531.17,-17824.41 1537.24,-17833.09 1541.33,-17827.41"/>
</g>
<!-- layer_3_mlp_fc1_gpu4 -->
<g id="node160" class="node">
<title>layer_3_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1655,-17824.14 1561,-17824.14 1561,-17772.14 1655,-17772.14 1655,-17824.14"/>
<text text-anchor="middle" x="1608" y="-17812.14" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="1608" y="-17801.14" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1608" y="-17790.14" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1608" y="-17779.14" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu4 -->
<g id="edge216" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M1608,-17859.74C1608,-17852.13 1608,-17843.19 1608,-17834.56"/>
<polygon fill="black" stroke="black" points="1611.5,-17834.29 1608,-17824.29 1604.5,-17834.29 1611.5,-17834.29"/>
</g>
<!-- layer_3_mlp_fc1_gpu5 -->
<g id="node161" class="node">
<title>layer_3_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1767,-17824.14 1673,-17824.14 1673,-17772.14 1767,-17772.14 1767,-17824.14"/>
<text text-anchor="middle" x="1720" y="-17812.14" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="1720" y="-17801.14" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1720" y="-17790.14" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1720" y="-17779.14" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu5 -->
<g id="edge217" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M1635.4,-17859.95C1647.73,-17851.08 1662.6,-17840.39 1676.41,-17830.47"/>
<polygon fill="black" stroke="black" points="1678.76,-17833.09 1684.83,-17824.41 1674.67,-17827.41 1678.76,-17833.09"/>
</g>
<!-- layer_3_mlp_fc1_gpu6 -->
<g id="node162" class="node">
<title>layer_3_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="1879,-17824.14 1785,-17824.14 1785,-17772.14 1879,-17772.14 1879,-17824.14"/>
<text text-anchor="middle" x="1832" y="-17812.14" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="1832" y="-17801.14" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1832" y="-17790.14" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="1832" y="-17779.14" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu6 -->
<g id="edge218" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M1644.75,-17868.67C1677.03,-17858.77 1725.38,-17843.33 1775.42,-17824.23"/>
<polygon fill="black" stroke="black" points="1776.71,-17827.48 1784.78,-17820.62 1774.2,-17820.95 1776.71,-17827.48"/>
</g>
<!-- layer_3_mlp_fc1_gpu7 -->
<g id="node163" class="node">
<title>layer_3_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1991,-17824.14 1897,-17824.14 1897,-17772.14 1991,-17772.14 1991,-17824.14"/>
<text text-anchor="middle" x="1944" y="-17812.14" font-family="Arial" font-size="10.00">Layer 3 MLP FC1</text>
<text text-anchor="middle" x="1944" y="-17801.14" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1944" y="-17790.14" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1944" y="-17779.14" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu7 -->
<g id="edge219" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M1644.9,-17875.01C1697.24,-17867.87 1795.95,-17852.28 1887.27,-17824.08"/>
<polygon fill="black" stroke="black" points="1888.45,-17827.38 1896.93,-17821.04 1886.34,-17820.7 1888.45,-17827.38"/>
</g>
<!-- layer_3_allgather_mlp -->
<g id="node164" class="node">
<title>layer_3_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="1496" cy="-17707.15" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="1496" y="-17715.65" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1496" y="-17704.65" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="1496" y="-17693.65" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_3_mlp_fc1_gpu0&#45;&gt;layer_3_allgather_mlp -->
<g id="edge220" class="edge">
<title>layer_3_mlp_fc1_gpu0&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M1207.1,-17775.33C1210.09,-17774.19 1213.07,-17773.12 1216,-17772.14 1288.84,-17747.82 1375.37,-17729.6 1432.76,-17718.94"/>
<polygon fill="black" stroke="black" points="1433.57,-17722.35 1442.78,-17717.11 1432.31,-17715.47 1433.57,-17722.35"/>
</g>
<!-- layer_3_mlp_fc1_gpu1&#45;&gt;layer_3_allgather_mlp -->
<g id="edge221" class="edge">
<title>layer_3_mlp_fc1_gpu1&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M1319.28,-17775.81C1322.22,-17774.55 1325.15,-17773.32 1328,-17772.14 1365.41,-17756.68 1408.04,-17740.46 1440.99,-17728.22"/>
<polygon fill="black" stroke="black" points="1442.29,-17731.47 1450.45,-17724.71 1439.86,-17724.9 1442.29,-17731.47"/>
</g>
<!-- layer_3_mlp_fc1_gpu2&#45;&gt;layer_3_allgather_mlp -->
<g id="edge222" class="edge">
<title>layer_3_mlp_fc1_gpu2&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M1415.5,-17772.11C1428.69,-17761.63 1444.15,-17749.34 1457.98,-17738.36"/>
<polygon fill="black" stroke="black" points="1460.24,-17741.03 1465.9,-17732.07 1455.89,-17735.55 1460.24,-17741.03"/>
</g>
<!-- layer_3_mlp_fc1_gpu3&#45;&gt;layer_3_allgather_mlp -->
<g id="edge223" class="edge">
<title>layer_3_mlp_fc1_gpu3&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M1496,-17771.87C1496,-17763.98 1496,-17755.09 1496,-17746.51"/>
<polygon fill="black" stroke="black" points="1499.5,-17746.29 1496,-17736.29 1492.5,-17746.29 1499.5,-17746.29"/>
</g>
<!-- layer_3_mlp_fc1_gpu4&#45;&gt;layer_3_allgather_mlp -->
<g id="edge224" class="edge">
<title>layer_3_mlp_fc1_gpu4&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M1576.5,-17772.11C1563.31,-17761.63 1547.85,-17749.34 1534.02,-17738.36"/>
<polygon fill="black" stroke="black" points="1536.11,-17735.55 1526.1,-17732.07 1531.76,-17741.03 1536.11,-17735.55"/>
</g>
<!-- layer_3_mlp_fc1_gpu5&#45;&gt;layer_3_allgather_mlp -->
<g id="edge225" class="edge">
<title>layer_3_mlp_fc1_gpu5&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M1672.72,-17775.81C1669.78,-17774.55 1666.85,-17773.32 1664,-17772.14 1626.59,-17756.68 1583.96,-17740.46 1551.01,-17728.22"/>
<polygon fill="black" stroke="black" points="1552.14,-17724.9 1541.55,-17724.71 1549.71,-17731.47 1552.14,-17724.9"/>
</g>
<!-- layer_3_mlp_fc1_gpu6&#45;&gt;layer_3_allgather_mlp -->
<g id="edge226" class="edge">
<title>layer_3_mlp_fc1_gpu6&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M1784.9,-17775.33C1781.91,-17774.19 1778.93,-17773.12 1776,-17772.14 1703.16,-17747.82 1616.63,-17729.6 1559.24,-17718.94"/>
<polygon fill="black" stroke="black" points="1559.69,-17715.47 1549.22,-17717.11 1558.43,-17722.35 1559.69,-17715.47"/>
</g>
<!-- layer_3_mlp_fc1_gpu7&#45;&gt;layer_3_allgather_mlp -->
<g id="edge227" class="edge">
<title>layer_3_mlp_fc1_gpu7&#45;&gt;layer_3_allgather_mlp</title>
<path fill="none" stroke="black" d="M1896.97,-17775.12C1893.96,-17774.03 1890.96,-17773.02 1888,-17772.14 1776.1,-17738.64 1640.65,-17721.46 1561.82,-17713.66"/>
<polygon fill="black" stroke="black" points="1561.84,-17710.15 1551.55,-17712.67 1561.16,-17717.11 1561.84,-17710.15"/>
</g>
<!-- layer_3_gelu -->
<g id="node165" class="node">
<title>layer_3_gelu</title>
<polygon fill="lightblue" stroke="black" points="1456.5,-17642.16 1367.5,-17642.16 1367.5,-17606.16 1456.5,-17606.16 1456.5,-17642.16"/>
<text text-anchor="middle" x="1412" y="-17627.16" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1412" y="-17616.16" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_3_allgather_mlp&#45;&gt;layer_3_gelu -->
<g id="edge228" class="edge">
<title>layer_3_allgather_mlp&#45;&gt;layer_3_gelu</title>
<path fill="none" stroke="black" d="M1469.88,-17680.96C1459.42,-17670.88 1447.41,-17659.3 1437.06,-17649.31"/>
<polygon fill="black" stroke="black" points="1439.48,-17646.79 1429.85,-17642.37 1434.62,-17651.83 1439.48,-17646.79"/>
</g>
<!-- layer_3_mlp_fc2_gpu7 -->
<g id="node173" class="node">
<title>layer_3_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1291,-17570.16 1197,-17570.16 1197,-17518.16 1291,-17518.16 1291,-17570.16"/>
<text text-anchor="middle" x="1244" y="-17558.16" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="1244" y="-17547.16" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1244" y="-17536.16" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1244" y="-17525.16" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu7 -->
<g id="edge229" class="edge">
<title>layer_3_gelu&#45;&gt;layer_3_mlp_fc2_gpu7</title>
<path fill="none" stroke="black" d="M1375.13,-17606.04C1353.21,-17595.86 1324.95,-17582.74 1300.28,-17571.28"/>
<polygon fill="black" stroke="black" points="1301.56,-17568.02 1291.02,-17566.99 1298.62,-17574.37 1301.56,-17568.02"/>
</g>
<!-- layer_3_mlp_fc2_gpu0 -->
<g id="node166" class="node">
<title>layer_3_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1403,-17570.16 1309,-17570.16 1309,-17518.16 1403,-17518.16 1403,-17570.16"/>
<text text-anchor="middle" x="1356" y="-17558.16" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="1356" y="-17547.16" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1356" y="-17536.16" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1356" y="-17525.16" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_allreduce_mlp -->
<g id="node174" class="node">
<title>layer_3_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="1692" cy="-17453.16" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="1692" y="-17461.66" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1692" y="-17450.66" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="1692" y="-17439.66" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_3_mlp_fc2_gpu0&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge230" class="edge">
<title>layer_3_mlp_fc2_gpu0&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1403.1,-17521.35C1406.09,-17520.21 1409.07,-17519.13 1412,-17518.16 1483.61,-17494.24 1568.46,-17476.23 1625.84,-17465.51"/>
<polygon fill="black" stroke="black" points="1626.67,-17468.91 1635.87,-17463.65 1625.4,-17462.03 1626.67,-17468.91"/>
</g>
<!-- layer_3_mlp_fc2_gpu1 -->
<g id="node167" class="node">
<title>layer_3_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1515,-17570.16 1421,-17570.16 1421,-17518.16 1515,-17518.16 1515,-17570.16"/>
<text text-anchor="middle" x="1468" y="-17558.16" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="1468" y="-17547.16" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1468" y="-17536.16" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1468" y="-17525.16" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_mlp_fc2_gpu1&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge231" class="edge">
<title>layer_3_mlp_fc2_gpu1&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1515.28,-17521.83C1518.22,-17520.57 1521.15,-17519.33 1524,-17518.16 1560.89,-17502.91 1602.84,-17486.93 1635.6,-17474.75"/>
<polygon fill="black" stroke="black" points="1636.85,-17478.02 1645.01,-17471.26 1634.42,-17471.45 1636.85,-17478.02"/>
</g>
<!-- layer_3_mlp_fc2_gpu2 -->
<g id="node168" class="node">
<title>layer_3_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1627,-17570.16 1533,-17570.16 1533,-17518.16 1627,-17518.16 1627,-17570.16"/>
<text text-anchor="middle" x="1580" y="-17558.16" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="1580" y="-17547.16" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1580" y="-17536.16" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1580" y="-17525.16" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_mlp_fc2_gpu2&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge232" class="edge">
<title>layer_3_mlp_fc2_gpu2&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1611.5,-17518.13C1624.59,-17507.73 1639.9,-17495.56 1653.64,-17484.65"/>
<polygon fill="black" stroke="black" points="1655.86,-17487.35 1661.51,-17478.39 1651.51,-17481.87 1655.86,-17487.35"/>
</g>
<!-- layer_3_mlp_fc2_gpu3 -->
<g id="node169" class="node">
<title>layer_3_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1739,-17570.16 1645,-17570.16 1645,-17518.16 1739,-17518.16 1739,-17570.16"/>
<text text-anchor="middle" x="1692" y="-17558.16" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="1692" y="-17547.16" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1692" y="-17536.16" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1692" y="-17525.16" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_mlp_fc2_gpu3&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge233" class="edge">
<title>layer_3_mlp_fc2_gpu3&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1692,-17517.89C1692,-17510 1692,-17501.11 1692,-17492.53"/>
<polygon fill="black" stroke="black" points="1695.5,-17492.31 1692,-17482.31 1688.5,-17492.31 1695.5,-17492.31"/>
</g>
<!-- layer_3_mlp_fc2_gpu4 -->
<g id="node170" class="node">
<title>layer_3_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1851,-17570.16 1757,-17570.16 1757,-17518.16 1851,-17518.16 1851,-17570.16"/>
<text text-anchor="middle" x="1804" y="-17558.16" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="1804" y="-17547.16" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1804" y="-17536.16" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1804" y="-17525.16" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_mlp_fc2_gpu4&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge234" class="edge">
<title>layer_3_mlp_fc2_gpu4&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1772.5,-17518.13C1759.41,-17507.73 1744.1,-17495.56 1730.36,-17484.65"/>
<polygon fill="black" stroke="black" points="1732.49,-17481.87 1722.49,-17478.39 1728.14,-17487.35 1732.49,-17481.87"/>
</g>
<!-- layer_3_mlp_fc2_gpu5 -->
<g id="node171" class="node">
<title>layer_3_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="1963,-17570.16 1869,-17570.16 1869,-17518.16 1963,-17518.16 1963,-17570.16"/>
<text text-anchor="middle" x="1916" y="-17558.16" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="1916" y="-17547.16" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1916" y="-17536.16" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="1916" y="-17525.16" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_mlp_fc2_gpu5&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge235" class="edge">
<title>layer_3_mlp_fc2_gpu5&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1868.72,-17521.83C1865.78,-17520.57 1862.85,-17519.33 1860,-17518.16 1823.11,-17502.91 1781.16,-17486.93 1748.4,-17474.75"/>
<polygon fill="black" stroke="black" points="1749.58,-17471.45 1738.99,-17471.26 1747.15,-17478.02 1749.58,-17471.45"/>
</g>
<!-- layer_3_mlp_fc2_gpu6 -->
<g id="node172" class="node">
<title>layer_3_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2075,-17570.16 1981,-17570.16 1981,-17518.16 2075,-17518.16 2075,-17570.16"/>
<text text-anchor="middle" x="2028" y="-17558.16" font-family="Arial" font-size="10.00">Layer 3 MLP FC2</text>
<text text-anchor="middle" x="2028" y="-17547.16" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2028" y="-17536.16" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2028" y="-17525.16" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_3_mlp_fc2_gpu6&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge236" class="edge">
<title>layer_3_mlp_fc2_gpu6&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1980.9,-17521.35C1977.91,-17520.21 1974.93,-17519.13 1972,-17518.16 1900.39,-17494.24 1815.54,-17476.23 1758.16,-17465.51"/>
<polygon fill="black" stroke="black" points="1758.6,-17462.03 1748.13,-17463.65 1757.33,-17468.91 1758.6,-17462.03"/>
</g>
<!-- layer_3_mlp_fc2_gpu7&#45;&gt;layer_3_allreduce_mlp -->
<g id="edge237" class="edge">
<title>layer_3_mlp_fc2_gpu7&#45;&gt;layer_3_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1291.03,-17521.13C1294.04,-17520.05 1297.04,-17519.04 1300,-17518.16 1410.16,-17485.18 1543.15,-17468.01 1622.47,-17460.05"/>
<polygon fill="black" stroke="black" points="1623.21,-17463.49 1632.82,-17459.03 1622.53,-17456.53 1623.21,-17463.49"/>
</g>
<!-- layer_3_allreduce_mlp&#45;&gt;layer_3_residual2 -->
<g id="edge238" class="edge">
<title>layer_3_allreduce_mlp&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M1734.97,-17432.67C1765,-17419.05 1805.46,-17400.7 1838.43,-17385.74"/>
<polygon fill="black" stroke="black" points="1840.3,-17388.73 1847.96,-17381.42 1837.41,-17382.36 1840.3,-17388.73"/>
</g>
<!-- layer_3_ln2 -->
<g id="node176" class="node">
<title>layer_3_ln2</title>
<polygon fill="lightblue" stroke="black" points="1933.5,-17292.17 1860.5,-17292.17 1860.5,-17251.17 1933.5,-17251.17 1933.5,-17292.17"/>
<text text-anchor="middle" x="1897" y="-17280.17" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1897" y="-17269.17" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="1897" y="-17258.17" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_3_residual2&#45;&gt;layer_3_ln2 -->
<g id="edge240" class="edge">
<title>layer_3_residual2&#45;&gt;layer_3_ln2</title>
<path fill="none" stroke="black" d="M1897,-17328.09C1897,-17319.77 1897,-17310.68 1897,-17302.33"/>
<polygon fill="black" stroke="black" points="1900.5,-17302.24 1897,-17292.24 1893.5,-17302.24 1900.5,-17302.24"/>
</g>
<!-- layer_3_output_dist -->
<g id="node177" class="node">
<title>layer_3_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="1998.7,-17215.17 1836.92,-17215.17 1795.3,-17155.17 1957.08,-17155.17 1998.7,-17215.17"/>
<text text-anchor="middle" x="1897" y="-17188.17" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="1897" y="-17177.17" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_3_ln2&#45;&gt;layer_3_output_dist -->
<g id="edge241" class="edge">
<title>layer_3_ln2&#45;&gt;layer_3_output_dist</title>
<path fill="none" stroke="black" d="M1897,-17251.07C1897,-17243.43 1897,-17234.39 1897,-17225.52"/>
<polygon fill="black" stroke="black" points="1900.5,-17225.28 1897,-17215.28 1893.5,-17225.28 1900.5,-17225.28"/>
</g>
<!-- layer_4_input_dist -->
<g id="node178" class="node">
<title>layer_4_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="1991.19,-17119.17 1841.36,-17119.17 1802.81,-17059.17 1952.64,-17059.17 1991.19,-17119.17"/>
<text text-anchor="middle" x="1897" y="-17092.17" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1897" y="-17081.17" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_3_output_dist&#45;&gt;layer_4_input_dist -->
<g id="edge242" class="edge">
<title>layer_3_output_dist&#45;&gt;layer_4_input_dist</title>
<path fill="none" stroke="black" d="M1897,-17154.95C1897,-17146.9 1897,-17138.04 1897,-17129.52"/>
<polygon fill="black" stroke="black" points="1900.5,-17129.38 1897,-17119.38 1893.5,-17129.38 1900.5,-17129.38"/>
</g>
<!-- layer_4_qkv_gpu0 -->
<g id="node179" class="node">
<title>layer_4_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1499.5,-17023.17 1406.5,-17023.17 1406.5,-16971.17 1499.5,-16971.17 1499.5,-17023.17"/>
<text text-anchor="middle" x="1453" y="-17011.17" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="1453" y="-17000.17" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1453" y="-16989.17" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1453" y="-16978.17" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu0 -->
<g id="edge243" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1816.5,-17080.71C1739.32,-17072.2 1619.81,-17055.46 1509.36,-17022.95"/>
<polygon fill="black" stroke="black" points="1510.31,-17019.58 1499.72,-17020.07 1508.3,-17026.29 1510.31,-17019.58"/>
</g>
<!-- layer_4_qkv_gpu1 -->
<g id="node180" class="node">
<title>layer_4_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1610.5,-17023.17 1517.5,-17023.17 1517.5,-16971.17 1610.5,-16971.17 1610.5,-17023.17"/>
<text text-anchor="middle" x="1564" y="-17011.17" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="1564" y="-17000.17" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1564" y="-16989.17" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1564" y="-16978.17" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu1 -->
<g id="edge244" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1811.28,-17072.43C1758.43,-17061.7 1689.37,-17045.86 1620.51,-17023.1"/>
<polygon fill="black" stroke="black" points="1621.39,-17019.7 1610.8,-17019.84 1619.16,-17026.34 1621.39,-17019.7"/>
</g>
<!-- layer_4_qkv_gpu2 -->
<g id="node181" class="node">
<title>layer_4_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1721.5,-17023.17 1628.5,-17023.17 1628.5,-16971.17 1721.5,-16971.17 1721.5,-17023.17"/>
<text text-anchor="middle" x="1675" y="-17011.17" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="1675" y="-17000.17" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1675" y="-16989.17" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1675" y="-16978.17" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu2 -->
<g id="edge245" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1820.67,-17059.14C1792.39,-17048.16 1760.12,-17035.37 1731,-17023.17 1730.9,-17023.13 1730.81,-17023.09 1730.71,-17023.05"/>
<polygon fill="black" stroke="black" points="1732.25,-17019.9 1721.68,-17019.21 1729.51,-17026.34 1732.25,-17019.9"/>
</g>
<!-- layer_4_qkv_gpu3 -->
<g id="node182" class="node">
<title>layer_4_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1832.5,-17023.17 1739.5,-17023.17 1739.5,-16971.17 1832.5,-16971.17 1832.5,-17023.17"/>
<text text-anchor="middle" x="1786" y="-17011.17" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="1786" y="-17000.17" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1786" y="-16989.17" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1786" y="-16978.17" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu3 -->
<g id="edge246" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1860.96,-17058.95C1849.44,-17049.61 1836.64,-17039.23 1824.92,-17029.73"/>
<polygon fill="black" stroke="black" points="1826.98,-17026.9 1817.01,-17023.32 1822.58,-17032.33 1826.98,-17026.9"/>
</g>
<!-- layer_4_qkv_gpu4 -->
<g id="node183" class="node">
<title>layer_4_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="1943.5,-17023.17 1850.5,-17023.17 1850.5,-16971.17 1943.5,-16971.17 1943.5,-17023.17"/>
<text text-anchor="middle" x="1897" y="-17011.17" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="1897" y="-17000.17" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1897" y="-16989.17" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1897" y="-16978.17" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu4 -->
<g id="edge247" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1897,-17058.7C1897,-17050.63 1897,-17041.79 1897,-17033.43"/>
<polygon fill="black" stroke="black" points="1900.5,-17033.18 1897,-17023.18 1893.5,-17033.18 1900.5,-17033.18"/>
</g>
<!-- layer_4_qkv_gpu5 -->
<g id="node184" class="node">
<title>layer_4_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2054.5,-17023.17 1961.5,-17023.17 1961.5,-16971.17 2054.5,-16971.17 2054.5,-17023.17"/>
<text text-anchor="middle" x="2008" y="-17011.17" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="2008" y="-17000.17" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2008" y="-16989.17" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2008" y="-16978.17" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu5 -->
<g id="edge248" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu5</title>
<path fill="none" stroke="black" d="M1933.04,-17058.95C1944.56,-17049.61 1957.36,-17039.23 1969.08,-17029.73"/>
<polygon fill="black" stroke="black" points="1971.42,-17032.33 1976.99,-17023.32 1967.02,-17026.9 1971.42,-17032.33"/>
</g>
<!-- layer_4_qkv_gpu6 -->
<g id="node185" class="node">
<title>layer_4_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2165.5,-17023.17 2072.5,-17023.17 2072.5,-16971.17 2165.5,-16971.17 2165.5,-17023.17"/>
<text text-anchor="middle" x="2119" y="-17011.17" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="2119" y="-17000.17" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2119" y="-16989.17" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2119" y="-16978.17" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu6 -->
<g id="edge249" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu6</title>
<path fill="none" stroke="black" d="M1957.23,-17065.66C1986.83,-17054.37 2023.18,-17040.2 2062.92,-17023.56"/>
<polygon fill="black" stroke="black" points="2064.41,-17026.73 2072.27,-17019.63 2061.7,-17020.28 2064.41,-17026.73"/>
</g>
<!-- layer_4_qkv_gpu7 -->
<g id="node186" class="node">
<title>layer_4_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2276.5,-17023.17 2183.5,-17023.17 2183.5,-16971.17 2276.5,-16971.17 2276.5,-17023.17"/>
<text text-anchor="middle" x="2230" y="-17011.17" font-family="Arial" font-size="10.00">Layer 4 QKV Proj</text>
<text text-anchor="middle" x="2230" y="-17000.17" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2230" y="-16989.17" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2230" y="-16978.17" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_qkv_gpu7 -->
<g id="edge250" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_qkv_gpu7</title>
<path fill="none" stroke="black" d="M1963.75,-17076.4C2018.38,-17065.9 2097.57,-17048.7 2173.7,-17023.38"/>
<polygon fill="black" stroke="black" points="2175.09,-17026.6 2183.45,-17020.09 2172.85,-17019.97 2175.09,-17026.6"/>
</g>
<!-- layer_4_residual1 -->
<g id="node198" class="node">
<title>layer_4_residual1</title>
<polygon fill="lightyellow" stroke="black" points="2260.94,-16571.21 2138.55,-16571.21 2107.06,-16511.21 2229.45,-16511.21 2260.94,-16571.21"/>
<text text-anchor="middle" x="2184" y="-16544.21" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="2184" y="-16533.21" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_4_input_dist&#45;&gt;layer_4_residual1 -->
<g id="edge270" class="edge">
<title>layer_4_input_dist&#45;&gt;layer_4_residual1</title>
<path fill="none" stroke="black" d="M1967.87,-17082.41C2064.96,-17073.49 2233.28,-17054.08 2286,-17023.17 2343,-16989.75 2379,-16973.26 2379,-16907.18 2379,-16907.18 2379,-16907.18 2379,-16726.19 2379,-16657.41 2314.02,-16606.73 2259.09,-16576.17"/>
<polygon fill="black" stroke="black" points="2260.48,-16572.95 2250.02,-16571.26 2257.14,-16579.1 2260.48,-16572.95"/>
</g>
<!-- layer_4_allgather_qkv -->
<g id="node187" class="node">
<title>layer_4_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="1786" cy="-16906.18" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="1786" y="-16914.68" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1786" y="-16903.68" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="1786" y="-16892.68" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_4_qkv_gpu0&#45;&gt;layer_4_allgather_qkv -->
<g id="edge251" class="edge">
<title>layer_4_qkv_gpu0&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M1499.79,-16974.5C1502.88,-16973.31 1505.97,-16972.19 1509,-16971.17 1580.63,-16947.16 1665.62,-16928.99 1722.4,-16918.25"/>
<polygon fill="black" stroke="black" points="1723.12,-16921.68 1732.31,-16916.4 1721.84,-16914.8 1723.12,-16921.68"/>
</g>
<!-- layer_4_qkv_gpu1&#45;&gt;layer_4_allgather_qkv -->
<g id="edge252" class="edge">
<title>layer_4_qkv_gpu1&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M1610.67,-16975.12C1613.82,-16973.77 1616.95,-16972.44 1620,-16971.17 1656.7,-16955.92 1698.45,-16939.83 1730.9,-16927.6"/>
<polygon fill="black" stroke="black" points="1732.53,-16930.73 1740.66,-16923.93 1730.06,-16924.18 1732.53,-16930.73"/>
</g>
<!-- layer_4_qkv_gpu2&#45;&gt;layer_4_allgather_qkv -->
<g id="edge253" class="edge">
<title>layer_4_qkv_gpu2&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M1706.22,-16971.15C1719.29,-16960.66 1734.61,-16948.38 1748.31,-16937.39"/>
<polygon fill="black" stroke="black" points="1750.55,-16940.09 1756.17,-16931.1 1746.17,-16934.62 1750.55,-16940.09"/>
</g>
<!-- layer_4_qkv_gpu3&#45;&gt;layer_4_allgather_qkv -->
<g id="edge254" class="edge">
<title>layer_4_qkv_gpu3&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M1786,-16970.91C1786,-16963.02 1786,-16954.13 1786,-16945.55"/>
<polygon fill="black" stroke="black" points="1789.5,-16945.32 1786,-16935.32 1782.5,-16945.32 1789.5,-16945.32"/>
</g>
<!-- layer_4_qkv_gpu4&#45;&gt;layer_4_allgather_qkv -->
<g id="edge255" class="edge">
<title>layer_4_qkv_gpu4&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M1865.78,-16971.15C1852.71,-16960.66 1837.39,-16948.38 1823.69,-16937.39"/>
<polygon fill="black" stroke="black" points="1825.83,-16934.62 1815.83,-16931.1 1821.45,-16940.09 1825.83,-16934.62"/>
</g>
<!-- layer_4_qkv_gpu5&#45;&gt;layer_4_allgather_qkv -->
<g id="edge256" class="edge">
<title>layer_4_qkv_gpu5&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M1961.28,-16974.7C1958.48,-16973.49 1955.71,-16972.31 1953,-16971.17 1915.98,-16955.68 1873.78,-16939.52 1841.06,-16927.32"/>
<polygon fill="black" stroke="black" points="1842.25,-16924.03 1831.66,-16923.82 1839.81,-16930.59 1842.25,-16924.03"/>
</g>
<!-- layer_4_qkv_gpu6&#45;&gt;layer_4_allgather_qkv -->
<g id="edge257" class="edge">
<title>layer_4_qkv_gpu6&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M2072.45,-16974.25C2069.61,-16973.15 2066.78,-16972.11 2064,-16971.17 1992.2,-16946.86 1906.88,-16928.75 1849.87,-16918.11"/>
<polygon fill="black" stroke="black" points="1850.39,-16914.65 1839.92,-16916.27 1849.12,-16921.53 1850.39,-16914.65"/>
</g>
<!-- layer_4_qkv_gpu7&#45;&gt;layer_4_allgather_qkv -->
<g id="edge258" class="edge">
<title>layer_4_qkv_gpu7&#45;&gt;layer_4_allgather_qkv</title>
<path fill="none" stroke="black" d="M2183.21,-16973.92C2180.46,-16972.92 2177.71,-16972 2175,-16971.17 2064.69,-16937.67 1931.14,-16920.55 1852.68,-16912.76"/>
<polygon fill="black" stroke="black" points="1852.75,-16909.25 1842.45,-16911.77 1852.07,-16916.22 1852.75,-16909.25"/>
</g>
<!-- layer_4_attention -->
<g id="node188" class="node">
<title>layer_4_attention</title>
<polygon fill="lightblue" stroke="black" points="1673,-16841.19 1605,-16841.19 1605,-16789.19 1673,-16789.19 1673,-16841.19"/>
<text text-anchor="middle" x="1639" y="-16829.19" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1639" y="-16818.19" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1639" y="-16807.19" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="1639" y="-16796.19" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_4_allgather_qkv&#45;&gt;layer_4_attention -->
<g id="edge259" class="edge">
<title>layer_4_allgather_qkv&#45;&gt;layer_4_attention</title>
<path fill="none" stroke="black" d="M1750.04,-16883.41C1729.42,-16870.93 1703.41,-16855.19 1681.75,-16842.07"/>
<polygon fill="black" stroke="black" points="1683.44,-16839 1673.07,-16836.82 1679.82,-16844.99 1683.44,-16839"/>
</g>
<!-- layer_4_attn_out_gpu7 -->
<g id="node196" class="node">
<title>layer_4_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1609,-16753.19 1521,-16753.19 1521,-16701.19 1609,-16701.19 1609,-16753.19"/>
<text text-anchor="middle" x="1565" y="-16741.19" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="1565" y="-16730.19" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1565" y="-16719.19" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1565" y="-16708.19" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attention&#45;&gt;layer_4_attn_out_gpu7 -->
<g id="edge260" class="edge">
<title>layer_4_attention&#45;&gt;layer_4_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M1617.2,-16788.85C1609.75,-16780.19 1601.3,-16770.37 1593.4,-16761.2"/>
<polygon fill="black" stroke="black" points="1595.82,-16758.64 1586.65,-16753.35 1590.52,-16763.21 1595.82,-16758.64"/>
</g>
<!-- layer_4_attn_out_gpu0 -->
<g id="node189" class="node">
<title>layer_4_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1715,-16753.19 1627,-16753.19 1627,-16701.19 1715,-16701.19 1715,-16753.19"/>
<text text-anchor="middle" x="1671" y="-16741.19" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="1671" y="-16730.19" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1671" y="-16719.19" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1671" y="-16708.19" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_allreduce_attn -->
<g id="node197" class="node">
<title>layer_4_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="1989" cy="-16636.2" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="1989" y="-16644.7" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1989" y="-16633.7" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="1989" y="-16622.7" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_4_attn_out_gpu0&#45;&gt;layer_4_allreduce_attn -->
<g id="edge261" class="edge">
<title>layer_4_attn_out_gpu0&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M1715.26,-16704.51C1718.19,-16703.32 1721.12,-16702.2 1724,-16701.19 1791.13,-16677.53 1870.84,-16659.58 1925.19,-16648.8"/>
<polygon fill="black" stroke="black" points="1925.89,-16652.23 1935.03,-16646.88 1924.54,-16645.36 1925.89,-16652.23"/>
</g>
<!-- layer_4_attn_out_gpu1 -->
<g id="node190" class="node">
<title>layer_4_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1821,-16753.19 1733,-16753.19 1733,-16701.19 1821,-16701.19 1821,-16753.19"/>
<text text-anchor="middle" x="1777" y="-16741.19" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="1777" y="-16730.19" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1777" y="-16719.19" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1777" y="-16708.19" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attn_out_gpu1&#45;&gt;layer_4_allreduce_attn -->
<g id="edge262" class="edge">
<title>layer_4_attn_out_gpu1&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M1821.16,-16705.13C1824.14,-16703.77 1827.11,-16702.45 1830,-16701.19 1864.33,-16686.2 1903.34,-16670.48 1934.13,-16658.37"/>
<polygon fill="black" stroke="black" points="1935.79,-16661.48 1943.82,-16654.57 1933.23,-16654.96 1935.79,-16661.48"/>
</g>
<!-- layer_4_attn_out_gpu2 -->
<g id="node191" class="node">
<title>layer_4_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1927,-16753.19 1839,-16753.19 1839,-16701.19 1927,-16701.19 1927,-16753.19"/>
<text text-anchor="middle" x="1883" y="-16741.19" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="1883" y="-16730.19" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1883" y="-16719.19" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1883" y="-16708.19" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attn_out_gpu2&#45;&gt;layer_4_allreduce_attn -->
<g id="edge263" class="edge">
<title>layer_4_attn_out_gpu2&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M1912.81,-16701.16C1925.08,-16690.86 1939.42,-16678.82 1952.33,-16667.99"/>
<polygon fill="black" stroke="black" points="1954.74,-16670.53 1960.15,-16661.42 1950.24,-16665.17 1954.74,-16670.53"/>
</g>
<!-- layer_4_attn_out_gpu3 -->
<g id="node192" class="node">
<title>layer_4_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2033,-16753.19 1945,-16753.19 1945,-16701.19 2033,-16701.19 2033,-16753.19"/>
<text text-anchor="middle" x="1989" y="-16741.19" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="1989" y="-16730.19" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1989" y="-16719.19" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1989" y="-16708.19" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attn_out_gpu3&#45;&gt;layer_4_allreduce_attn -->
<g id="edge264" class="edge">
<title>layer_4_attn_out_gpu3&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M1989,-16700.93C1989,-16693.04 1989,-16684.14 1989,-16675.56"/>
<polygon fill="black" stroke="black" points="1992.5,-16675.34 1989,-16665.34 1985.5,-16675.34 1992.5,-16675.34"/>
</g>
<!-- layer_4_attn_out_gpu4 -->
<g id="node193" class="node">
<title>layer_4_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2139,-16753.19 2051,-16753.19 2051,-16701.19 2139,-16701.19 2139,-16753.19"/>
<text text-anchor="middle" x="2095" y="-16741.19" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="2095" y="-16730.19" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2095" y="-16719.19" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2095" y="-16708.19" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attn_out_gpu4&#45;&gt;layer_4_allreduce_attn -->
<g id="edge265" class="edge">
<title>layer_4_attn_out_gpu4&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M2065.19,-16701.16C2052.92,-16690.86 2038.58,-16678.82 2025.67,-16667.99"/>
<polygon fill="black" stroke="black" points="2027.76,-16665.17 2017.85,-16661.42 2023.26,-16670.53 2027.76,-16665.17"/>
</g>
<!-- layer_4_attn_out_gpu5 -->
<g id="node194" class="node">
<title>layer_4_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2245,-16753.19 2157,-16753.19 2157,-16701.19 2245,-16701.19 2245,-16753.19"/>
<text text-anchor="middle" x="2201" y="-16741.19" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="2201" y="-16730.19" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2201" y="-16719.19" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2201" y="-16708.19" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attn_out_gpu5&#45;&gt;layer_4_allreduce_attn -->
<g id="edge266" class="edge">
<title>layer_4_attn_out_gpu5&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M2156.84,-16705.13C2153.86,-16703.77 2150.89,-16702.45 2148,-16701.19 2113.67,-16686.2 2074.66,-16670.48 2043.87,-16658.37"/>
<polygon fill="black" stroke="black" points="2044.77,-16654.96 2034.18,-16654.57 2042.21,-16661.48 2044.77,-16654.96"/>
</g>
<!-- layer_4_attn_out_gpu6 -->
<g id="node195" class="node">
<title>layer_4_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2351,-16753.19 2263,-16753.19 2263,-16701.19 2351,-16701.19 2351,-16753.19"/>
<text text-anchor="middle" x="2307" y="-16741.19" font-family="Arial" font-size="10.00">Layer 4 Attn Out</text>
<text text-anchor="middle" x="2307" y="-16730.19" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2307" y="-16719.19" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2307" y="-16708.19" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_4_attn_out_gpu6&#45;&gt;layer_4_allreduce_attn -->
<g id="edge267" class="edge">
<title>layer_4_attn_out_gpu6&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M2262.74,-16704.51C2259.81,-16703.32 2256.88,-16702.2 2254,-16701.19 2186.87,-16677.53 2107.16,-16659.58 2052.81,-16648.8"/>
<polygon fill="black" stroke="black" points="2053.46,-16645.36 2042.97,-16646.88 2052.11,-16652.23 2053.46,-16645.36"/>
</g>
<!-- layer_4_attn_out_gpu7&#45;&gt;layer_4_allreduce_attn -->
<g id="edge268" class="edge">
<title>layer_4_attn_out_gpu7&#45;&gt;layer_4_allreduce_attn</title>
<path fill="none" stroke="black" d="M1609.18,-16704.29C1612.13,-16703.16 1615.09,-16702.11 1618,-16701.19 1721.43,-16668.54 1846.66,-16651.33 1921.97,-16643.26"/>
<polygon fill="black" stroke="black" points="1922.67,-16646.71 1932.25,-16642.18 1921.94,-16639.75 1922.67,-16646.71"/>
</g>
<!-- layer_4_allreduce_attn&#45;&gt;layer_4_residual1 -->
<g id="edge269" class="edge">
<title>layer_4_allreduce_attn&#45;&gt;layer_4_residual1</title>
<path fill="none" stroke="black" d="M2030.35,-16615.48C2058.12,-16602.24 2095.09,-16584.61 2125.81,-16569.96"/>
<polygon fill="black" stroke="black" points="2127.6,-16572.98 2135.12,-16565.51 2124.59,-16566.66 2127.6,-16572.98"/>
</g>
<!-- layer_4_ln1 -->
<g id="node199" class="node">
<title>layer_4_ln1</title>
<polygon fill="lightblue" stroke="black" points="2015.5,-16475.21 1942.5,-16475.21 1942.5,-16434.21 2015.5,-16434.21 2015.5,-16475.21"/>
<text text-anchor="middle" x="1979" y="-16463.21" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1979" y="-16452.21" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="1979" y="-16441.21" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_4_residual1&#45;&gt;layer_4_ln1 -->
<g id="edge271" class="edge">
<title>layer_4_residual1&#45;&gt;layer_4_ln1</title>
<path fill="none" stroke="black" d="M2113.45,-16511.13C2084.16,-16499.05 2050.99,-16485.38 2024.93,-16474.64"/>
<polygon fill="black" stroke="black" points="2026.25,-16471.4 2015.67,-16470.82 2023.58,-16477.87 2026.25,-16471.4"/>
</g>
<!-- layer_4_residual2 -->
<g id="node219" class="node">
<title>layer_4_residual2</title>
<polygon fill="lightyellow" stroke="black" points="2344.94,-15962.24 2222.55,-15962.24 2191.06,-15902.24 2313.45,-15902.24 2344.94,-15962.24"/>
<text text-anchor="middle" x="2268" y="-15935.24" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="2268" y="-15924.24" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_4_residual1&#45;&gt;layer_4_residual2 -->
<g id="edge299" class="edge">
<title>layer_4_residual1&#45;&gt;layer_4_residual2</title>
<path fill="none" stroke="black" d="M2241.29,-16533.15C2325.81,-16519.18 2474,-16479.53 2474,-16373.21 2474,-16373.21 2474,-16373.21 2474,-16117.22 2474,-16047.02 2406.61,-15996.93 2348.92,-15966.92"/>
<polygon fill="black" stroke="black" points="2350.26,-15963.68 2339.76,-15962.28 2347.1,-15969.92 2350.26,-15963.68"/>
</g>
<!-- layer_4_mlp_fc1_gpu0 -->
<g id="node200" class="node">
<title>layer_4_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1578,-16398.21 1484,-16398.21 1484,-16346.21 1578,-16346.21 1578,-16398.21"/>
<text text-anchor="middle" x="1531" y="-16386.21" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="1531" y="-16375.21" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1531" y="-16364.21" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1531" y="-16353.21" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu0 -->
<g id="edge272" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M1942.35,-16451.93C1873.78,-16447.88 1721.67,-16435.45 1587.63,-16398.04"/>
<polygon fill="black" stroke="black" points="1588.58,-16394.67 1578.01,-16395.3 1586.67,-16401.41 1588.58,-16394.67"/>
</g>
<!-- layer_4_mlp_fc1_gpu1 -->
<g id="node201" class="node">
<title>layer_4_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1690,-16398.21 1596,-16398.21 1596,-16346.21 1690,-16346.21 1690,-16398.21"/>
<text text-anchor="middle" x="1643" y="-16386.21" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="1643" y="-16375.21" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1643" y="-16364.21" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1643" y="-16353.21" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu1 -->
<g id="edge273" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M1942.1,-16449.08C1889.76,-16441.94 1791.05,-16426.34 1699.73,-16398.15"/>
<polygon fill="black" stroke="black" points="1700.66,-16394.77 1690.07,-16395.11 1698.55,-16401.45 1700.66,-16394.77"/>
</g>
<!-- layer_4_mlp_fc1_gpu2 -->
<g id="node202" class="node">
<title>layer_4_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1802,-16398.21 1708,-16398.21 1708,-16346.21 1802,-16346.21 1802,-16398.21"/>
<text text-anchor="middle" x="1755" y="-16386.21" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="1755" y="-16375.21" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1755" y="-16364.21" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1755" y="-16353.21" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu2 -->
<g id="edge274" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M1942.25,-16442.74C1909.97,-16432.84 1861.62,-16417.4 1811.58,-16398.3"/>
<polygon fill="black" stroke="black" points="1812.8,-16395.02 1802.22,-16394.69 1810.29,-16401.55 1812.8,-16395.02"/>
</g>
<!-- layer_4_mlp_fc1_gpu3 -->
<g id="node203" class="node">
<title>layer_4_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="1914,-16398.21 1820,-16398.21 1820,-16346.21 1914,-16346.21 1914,-16398.21"/>
<text text-anchor="middle" x="1867" y="-16386.21" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="1867" y="-16375.21" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1867" y="-16364.21" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="1867" y="-16353.21" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu3 -->
<g id="edge275" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M1951.6,-16434.01C1939.27,-16425.15 1924.4,-16414.46 1910.59,-16404.54"/>
<polygon fill="black" stroke="black" points="1912.33,-16401.48 1902.17,-16398.48 1908.24,-16407.16 1912.33,-16401.48"/>
</g>
<!-- layer_4_mlp_fc1_gpu4 -->
<g id="node204" class="node">
<title>layer_4_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2026,-16398.21 1932,-16398.21 1932,-16346.21 2026,-16346.21 2026,-16398.21"/>
<text text-anchor="middle" x="1979" y="-16386.21" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="1979" y="-16375.21" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1979" y="-16364.21" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="1979" y="-16353.21" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu4 -->
<g id="edge276" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M1979,-16433.81C1979,-16426.19 1979,-16417.26 1979,-16408.63"/>
<polygon fill="black" stroke="black" points="1982.5,-16408.36 1979,-16398.36 1975.5,-16408.36 1982.5,-16408.36"/>
</g>
<!-- layer_4_mlp_fc1_gpu5 -->
<g id="node205" class="node">
<title>layer_4_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2138,-16398.21 2044,-16398.21 2044,-16346.21 2138,-16346.21 2138,-16398.21"/>
<text text-anchor="middle" x="2091" y="-16386.21" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="2091" y="-16375.21" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2091" y="-16364.21" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2091" y="-16353.21" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu5 -->
<g id="edge277" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M2006.4,-16434.01C2018.73,-16425.15 2033.6,-16414.46 2047.41,-16404.54"/>
<polygon fill="black" stroke="black" points="2049.76,-16407.16 2055.83,-16398.48 2045.67,-16401.48 2049.76,-16407.16"/>
</g>
<!-- layer_4_mlp_fc1_gpu6 -->
<g id="node206" class="node">
<title>layer_4_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2250,-16398.21 2156,-16398.21 2156,-16346.21 2250,-16346.21 2250,-16398.21"/>
<text text-anchor="middle" x="2203" y="-16386.21" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="2203" y="-16375.21" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2203" y="-16364.21" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2203" y="-16353.21" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu6 -->
<g id="edge278" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M2015.75,-16442.74C2048.03,-16432.84 2096.38,-16417.4 2146.42,-16398.3"/>
<polygon fill="black" stroke="black" points="2147.71,-16401.55 2155.78,-16394.69 2145.2,-16395.02 2147.71,-16401.55"/>
</g>
<!-- layer_4_mlp_fc1_gpu7 -->
<g id="node207" class="node">
<title>layer_4_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2362,-16398.21 2268,-16398.21 2268,-16346.21 2362,-16346.21 2362,-16398.21"/>
<text text-anchor="middle" x="2315" y="-16386.21" font-family="Arial" font-size="10.00">Layer 4 MLP FC1</text>
<text text-anchor="middle" x="2315" y="-16375.21" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2315" y="-16364.21" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2315" y="-16353.21" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu7 -->
<g id="edge279" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M2015.9,-16449.08C2068.24,-16441.94 2166.95,-16426.34 2258.27,-16398.15"/>
<polygon fill="black" stroke="black" points="2259.45,-16401.45 2267.93,-16395.11 2257.34,-16394.77 2259.45,-16401.45"/>
</g>
<!-- layer_4_allgather_mlp -->
<g id="node208" class="node">
<title>layer_4_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="1867" cy="-16281.22" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="1867" y="-16289.72" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1867" y="-16278.72" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="1867" y="-16267.72" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_4_mlp_fc1_gpu0&#45;&gt;layer_4_allgather_mlp -->
<g id="edge280" class="edge">
<title>layer_4_mlp_fc1_gpu0&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M1578.1,-16349.4C1581.09,-16348.26 1584.07,-16347.18 1587,-16346.21 1659.84,-16321.88 1746.37,-16303.67 1803.76,-16293.01"/>
<polygon fill="black" stroke="black" points="1804.57,-16296.42 1813.78,-16291.18 1803.31,-16289.54 1804.57,-16296.42"/>
</g>
<!-- layer_4_mlp_fc1_gpu1&#45;&gt;layer_4_allgather_mlp -->
<g id="edge281" class="edge">
<title>layer_4_mlp_fc1_gpu1&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M1690.28,-16349.88C1693.22,-16348.62 1696.15,-16347.39 1699,-16346.21 1736.41,-16330.75 1779.04,-16314.53 1811.99,-16302.28"/>
<polygon fill="black" stroke="black" points="1813.29,-16305.54 1821.45,-16298.78 1810.86,-16298.97 1813.29,-16305.54"/>
</g>
<!-- layer_4_mlp_fc1_gpu2&#45;&gt;layer_4_allgather_mlp -->
<g id="edge282" class="edge">
<title>layer_4_mlp_fc1_gpu2&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M1786.5,-16346.18C1799.69,-16335.7 1815.15,-16323.41 1828.98,-16312.43"/>
<polygon fill="black" stroke="black" points="1831.24,-16315.1 1836.9,-16306.13 1826.89,-16309.62 1831.24,-16315.1"/>
</g>
<!-- layer_4_mlp_fc1_gpu3&#45;&gt;layer_4_allgather_mlp -->
<g id="edge283" class="edge">
<title>layer_4_mlp_fc1_gpu3&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M1867,-16345.94C1867,-16338.05 1867,-16329.16 1867,-16320.58"/>
<polygon fill="black" stroke="black" points="1870.5,-16320.36 1867,-16310.36 1863.5,-16320.36 1870.5,-16320.36"/>
</g>
<!-- layer_4_mlp_fc1_gpu4&#45;&gt;layer_4_allgather_mlp -->
<g id="edge284" class="edge">
<title>layer_4_mlp_fc1_gpu4&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M1947.5,-16346.18C1934.31,-16335.7 1918.85,-16323.41 1905.02,-16312.43"/>
<polygon fill="black" stroke="black" points="1907.11,-16309.62 1897.1,-16306.13 1902.76,-16315.1 1907.11,-16309.62"/>
</g>
<!-- layer_4_mlp_fc1_gpu5&#45;&gt;layer_4_allgather_mlp -->
<g id="edge285" class="edge">
<title>layer_4_mlp_fc1_gpu5&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M2043.72,-16349.88C2040.78,-16348.62 2037.85,-16347.39 2035,-16346.21 1997.59,-16330.75 1954.96,-16314.53 1922.01,-16302.28"/>
<polygon fill="black" stroke="black" points="1923.14,-16298.97 1912.55,-16298.78 1920.71,-16305.54 1923.14,-16298.97"/>
</g>
<!-- layer_4_mlp_fc1_gpu6&#45;&gt;layer_4_allgather_mlp -->
<g id="edge286" class="edge">
<title>layer_4_mlp_fc1_gpu6&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M2155.9,-16349.4C2152.91,-16348.26 2149.93,-16347.18 2147,-16346.21 2074.16,-16321.88 1987.63,-16303.67 1930.24,-16293.01"/>
<polygon fill="black" stroke="black" points="1930.69,-16289.54 1920.22,-16291.18 1929.43,-16296.42 1930.69,-16289.54"/>
</g>
<!-- layer_4_mlp_fc1_gpu7&#45;&gt;layer_4_allgather_mlp -->
<g id="edge287" class="edge">
<title>layer_4_mlp_fc1_gpu7&#45;&gt;layer_4_allgather_mlp</title>
<path fill="none" stroke="black" d="M2267.97,-16349.19C2264.96,-16348.1 2261.96,-16347.09 2259,-16346.21 2147.1,-16312.71 2011.65,-16295.52 1932.82,-16287.73"/>
<polygon fill="black" stroke="black" points="1932.84,-16284.22 1922.55,-16286.74 1932.16,-16291.18 1932.84,-16284.22"/>
</g>
<!-- layer_4_gelu -->
<g id="node209" class="node">
<title>layer_4_gelu</title>
<polygon fill="lightblue" stroke="black" points="1827.5,-16216.22 1738.5,-16216.22 1738.5,-16180.22 1827.5,-16180.22 1827.5,-16216.22"/>
<text text-anchor="middle" x="1783" y="-16201.22" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="1783" y="-16190.22" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_4_allgather_mlp&#45;&gt;layer_4_gelu -->
<g id="edge288" class="edge">
<title>layer_4_allgather_mlp&#45;&gt;layer_4_gelu</title>
<path fill="none" stroke="black" d="M1840.88,-16255.03C1830.42,-16244.94 1818.41,-16233.37 1808.06,-16223.38"/>
<polygon fill="black" stroke="black" points="1810.48,-16220.86 1800.85,-16216.44 1805.62,-16225.9 1810.48,-16220.86"/>
</g>
<!-- layer_4_mlp_fc2_gpu7 -->
<g id="node217" class="node">
<title>layer_4_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1662,-16144.22 1568,-16144.22 1568,-16092.22 1662,-16092.22 1662,-16144.22"/>
<text text-anchor="middle" x="1615" y="-16132.22" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="1615" y="-16121.22" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1615" y="-16110.22" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1615" y="-16099.22" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu7 -->
<g id="edge289" class="edge">
<title>layer_4_gelu&#45;&gt;layer_4_mlp_fc2_gpu7</title>
<path fill="none" stroke="black" d="M1746.13,-16180.11C1724.21,-16169.93 1695.95,-16156.81 1671.28,-16145.35"/>
<polygon fill="black" stroke="black" points="1672.56,-16142.09 1662.02,-16141.06 1669.62,-16148.44 1672.56,-16142.09"/>
</g>
<!-- layer_4_mlp_fc2_gpu0 -->
<g id="node210" class="node">
<title>layer_4_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1774,-16144.22 1680,-16144.22 1680,-16092.22 1774,-16092.22 1774,-16144.22"/>
<text text-anchor="middle" x="1727" y="-16132.22" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="1727" y="-16121.22" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1727" y="-16110.22" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1727" y="-16099.22" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_allreduce_mlp -->
<g id="node218" class="node">
<title>layer_4_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="2063" cy="-16027.23" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="2063" y="-16035.73" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="2063" y="-16024.73" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="2063" y="-16013.73" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_4_mlp_fc2_gpu0&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge290" class="edge">
<title>layer_4_mlp_fc2_gpu0&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1774.1,-16095.42C1777.09,-16094.28 1780.07,-16093.2 1783,-16092.22 1854.61,-16068.31 1939.46,-16050.3 1996.84,-16039.57"/>
<polygon fill="black" stroke="black" points="1997.67,-16042.98 2006.87,-16037.72 1996.4,-16036.1 1997.67,-16042.98"/>
</g>
<!-- layer_4_mlp_fc2_gpu1 -->
<g id="node211" class="node">
<title>layer_4_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1886,-16144.22 1792,-16144.22 1792,-16092.22 1886,-16092.22 1886,-16144.22"/>
<text text-anchor="middle" x="1839" y="-16132.22" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="1839" y="-16121.22" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1839" y="-16110.22" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1839" y="-16099.22" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_mlp_fc2_gpu1&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge291" class="edge">
<title>layer_4_mlp_fc2_gpu1&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1886.28,-16095.9C1889.22,-16094.64 1892.15,-16093.4 1895,-16092.22 1931.89,-16076.98 1973.84,-16061 2006.6,-16048.82"/>
<polygon fill="black" stroke="black" points="2007.85,-16052.09 2016.01,-16045.33 2005.42,-16045.52 2007.85,-16052.09"/>
</g>
<!-- layer_4_mlp_fc2_gpu2 -->
<g id="node212" class="node">
<title>layer_4_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1998,-16144.22 1904,-16144.22 1904,-16092.22 1998,-16092.22 1998,-16144.22"/>
<text text-anchor="middle" x="1951" y="-16132.22" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="1951" y="-16121.22" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1951" y="-16110.22" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="1951" y="-16099.22" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_mlp_fc2_gpu2&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge292" class="edge">
<title>layer_4_mlp_fc2_gpu2&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1982.5,-16092.2C1995.59,-16081.8 2010.9,-16069.63 2024.64,-16058.72"/>
<polygon fill="black" stroke="black" points="2026.86,-16061.42 2032.51,-16052.46 2022.51,-16055.94 2026.86,-16061.42"/>
</g>
<!-- layer_4_mlp_fc2_gpu3 -->
<g id="node213" class="node">
<title>layer_4_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2110,-16144.22 2016,-16144.22 2016,-16092.22 2110,-16092.22 2110,-16144.22"/>
<text text-anchor="middle" x="2063" y="-16132.22" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="2063" y="-16121.22" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="2063" y="-16110.22" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2063" y="-16099.22" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_mlp_fc2_gpu3&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge293" class="edge">
<title>layer_4_mlp_fc2_gpu3&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2063,-16091.96C2063,-16084.07 2063,-16075.18 2063,-16066.6"/>
<polygon fill="black" stroke="black" points="2066.5,-16066.37 2063,-16056.37 2059.5,-16066.37 2066.5,-16066.37"/>
</g>
<!-- layer_4_mlp_fc2_gpu4 -->
<g id="node214" class="node">
<title>layer_4_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2222,-16144.22 2128,-16144.22 2128,-16092.22 2222,-16092.22 2222,-16144.22"/>
<text text-anchor="middle" x="2175" y="-16132.22" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="2175" y="-16121.22" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2175" y="-16110.22" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2175" y="-16099.22" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_mlp_fc2_gpu4&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge294" class="edge">
<title>layer_4_mlp_fc2_gpu4&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2143.5,-16092.2C2130.41,-16081.8 2115.1,-16069.63 2101.36,-16058.72"/>
<polygon fill="black" stroke="black" points="2103.49,-16055.94 2093.49,-16052.46 2099.14,-16061.42 2103.49,-16055.94"/>
</g>
<!-- layer_4_mlp_fc2_gpu5 -->
<g id="node215" class="node">
<title>layer_4_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2334,-16144.22 2240,-16144.22 2240,-16092.22 2334,-16092.22 2334,-16144.22"/>
<text text-anchor="middle" x="2287" y="-16132.22" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="2287" y="-16121.22" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2287" y="-16110.22" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2287" y="-16099.22" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_mlp_fc2_gpu5&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge295" class="edge">
<title>layer_4_mlp_fc2_gpu5&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2239.72,-16095.9C2236.78,-16094.64 2233.85,-16093.4 2231,-16092.22 2194.11,-16076.98 2152.16,-16061 2119.4,-16048.82"/>
<polygon fill="black" stroke="black" points="2120.58,-16045.52 2109.99,-16045.33 2118.15,-16052.09 2120.58,-16045.52"/>
</g>
<!-- layer_4_mlp_fc2_gpu6 -->
<g id="node216" class="node">
<title>layer_4_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2446,-16144.22 2352,-16144.22 2352,-16092.22 2446,-16092.22 2446,-16144.22"/>
<text text-anchor="middle" x="2399" y="-16132.22" font-family="Arial" font-size="10.00">Layer 4 MLP FC2</text>
<text text-anchor="middle" x="2399" y="-16121.22" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2399" y="-16110.22" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2399" y="-16099.22" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_4_mlp_fc2_gpu6&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge296" class="edge">
<title>layer_4_mlp_fc2_gpu6&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2351.9,-16095.42C2348.91,-16094.28 2345.93,-16093.2 2343,-16092.22 2271.39,-16068.31 2186.54,-16050.3 2129.16,-16039.57"/>
<polygon fill="black" stroke="black" points="2129.6,-16036.1 2119.13,-16037.72 2128.33,-16042.98 2129.6,-16036.1"/>
</g>
<!-- layer_4_mlp_fc2_gpu7&#45;&gt;layer_4_allreduce_mlp -->
<g id="edge297" class="edge">
<title>layer_4_mlp_fc2_gpu7&#45;&gt;layer_4_allreduce_mlp</title>
<path fill="none" stroke="black" d="M1662.03,-16095.2C1665.04,-16094.12 1668.04,-16093.11 1671,-16092.22 1781.16,-16059.25 1914.15,-16042.08 1993.47,-16034.12"/>
<polygon fill="black" stroke="black" points="1994.21,-16037.56 2003.82,-16033.1 1993.53,-16030.6 1994.21,-16037.56"/>
</g>
<!-- layer_4_allreduce_mlp&#45;&gt;layer_4_residual2 -->
<g id="edge298" class="edge">
<title>layer_4_allreduce_mlp&#45;&gt;layer_4_residual2</title>
<path fill="none" stroke="black" d="M2105.97,-16006.74C2136,-15993.12 2176.46,-15974.77 2209.43,-15959.81"/>
<polygon fill="black" stroke="black" points="2211.3,-15962.8 2218.96,-15955.49 2208.41,-15956.43 2211.3,-15962.8"/>
</g>
<!-- layer_4_ln2 -->
<g id="node220" class="node">
<title>layer_4_ln2</title>
<polygon fill="lightblue" stroke="black" points="2304.5,-15866.24 2231.5,-15866.24 2231.5,-15825.24 2304.5,-15825.24 2304.5,-15866.24"/>
<text text-anchor="middle" x="2268" y="-15854.24" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="2268" y="-15843.24" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="2268" y="-15832.24" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_4_residual2&#45;&gt;layer_4_ln2 -->
<g id="edge300" class="edge">
<title>layer_4_residual2&#45;&gt;layer_4_ln2</title>
<path fill="none" stroke="black" d="M2268,-15902.16C2268,-15893.84 2268,-15884.75 2268,-15876.4"/>
<polygon fill="black" stroke="black" points="2271.5,-15876.31 2268,-15866.31 2264.5,-15876.31 2271.5,-15876.31"/>
</g>
<!-- layer_4_output_dist -->
<g id="node221" class="node">
<title>layer_4_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="2369.7,-15789.24 2207.92,-15789.24 2166.3,-15729.24 2328.08,-15729.24 2369.7,-15789.24"/>
<text text-anchor="middle" x="2268" y="-15762.24" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="2268" y="-15751.24" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_4_ln2&#45;&gt;layer_4_output_dist -->
<g id="edge301" class="edge">
<title>layer_4_ln2&#45;&gt;layer_4_output_dist</title>
<path fill="none" stroke="black" d="M2268,-15825.14C2268,-15817.5 2268,-15808.46 2268,-15799.59"/>
<polygon fill="black" stroke="black" points="2271.5,-15799.35 2268,-15789.35 2264.5,-15799.35 2271.5,-15799.35"/>
</g>
<!-- layer_5_input_dist -->
<g id="node222" class="node">
<title>layer_5_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="2362.19,-15693.24 2212.36,-15693.24 2173.81,-15633.24 2323.64,-15633.24 2362.19,-15693.24"/>
<text text-anchor="middle" x="2268" y="-15666.24" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="2268" y="-15655.24" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_4_output_dist&#45;&gt;layer_5_input_dist -->
<g id="edge302" class="edge">
<title>layer_4_output_dist&#45;&gt;layer_5_input_dist</title>
<path fill="none" stroke="black" d="M2268,-15729.01C2268,-15720.97 2268,-15712.11 2268,-15703.59"/>
<polygon fill="black" stroke="black" points="2271.5,-15703.45 2268,-15693.45 2264.5,-15703.45 2271.5,-15703.45"/>
</g>
<!-- layer_5_qkv_gpu0 -->
<g id="node223" class="node">
<title>layer_5_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1870.5,-15597.24 1777.5,-15597.24 1777.5,-15545.24 1870.5,-15545.24 1870.5,-15597.24"/>
<text text-anchor="middle" x="1824" y="-15585.24" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="1824" y="-15574.24" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1824" y="-15563.24" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1824" y="-15552.24" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu0 -->
<g id="edge303" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu0</title>
<path fill="none" stroke="black" d="M2187.5,-15654.78C2110.32,-15646.27 1990.81,-15629.53 1880.36,-15597.02"/>
<polygon fill="black" stroke="black" points="1881.31,-15593.65 1870.72,-15594.14 1879.3,-15600.36 1881.31,-15593.65"/>
</g>
<!-- layer_5_qkv_gpu1 -->
<g id="node224" class="node">
<title>layer_5_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1981.5,-15597.24 1888.5,-15597.24 1888.5,-15545.24 1981.5,-15545.24 1981.5,-15597.24"/>
<text text-anchor="middle" x="1935" y="-15585.24" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="1935" y="-15574.24" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1935" y="-15563.24" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1935" y="-15552.24" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu1 -->
<g id="edge304" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu1</title>
<path fill="none" stroke="black" d="M2182.28,-15646.5C2129.43,-15635.77 2060.37,-15619.93 1991.51,-15597.16"/>
<polygon fill="black" stroke="black" points="1992.39,-15593.77 1981.8,-15593.91 1990.16,-15600.4 1992.39,-15593.77"/>
</g>
<!-- layer_5_qkv_gpu2 -->
<g id="node225" class="node">
<title>layer_5_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2092.5,-15597.24 1999.5,-15597.24 1999.5,-15545.24 2092.5,-15545.24 2092.5,-15597.24"/>
<text text-anchor="middle" x="2046" y="-15585.24" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="2046" y="-15574.24" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2046" y="-15563.24" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2046" y="-15552.24" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu2 -->
<g id="edge305" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu2</title>
<path fill="none" stroke="black" d="M2191.67,-15633.21C2163.39,-15622.23 2131.12,-15609.43 2102,-15597.24 2101.9,-15597.2 2101.81,-15597.16 2101.71,-15597.12"/>
<polygon fill="black" stroke="black" points="2103.25,-15593.97 2092.68,-15593.28 2100.51,-15600.41 2103.25,-15593.97"/>
</g>
<!-- layer_5_qkv_gpu3 -->
<g id="node226" class="node">
<title>layer_5_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2203.5,-15597.24 2110.5,-15597.24 2110.5,-15545.24 2203.5,-15545.24 2203.5,-15597.24"/>
<text text-anchor="middle" x="2157" y="-15585.24" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="2157" y="-15574.24" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="2157" y="-15563.24" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2157" y="-15552.24" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu3 -->
<g id="edge306" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu3</title>
<path fill="none" stroke="black" d="M2231.96,-15633.02C2220.44,-15623.68 2207.64,-15613.3 2195.92,-15603.8"/>
<polygon fill="black" stroke="black" points="2197.98,-15600.97 2188.01,-15597.39 2193.58,-15606.4 2197.98,-15600.97"/>
</g>
<!-- layer_5_qkv_gpu4 -->
<g id="node227" class="node">
<title>layer_5_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2314.5,-15597.24 2221.5,-15597.24 2221.5,-15545.24 2314.5,-15545.24 2314.5,-15597.24"/>
<text text-anchor="middle" x="2268" y="-15585.24" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="2268" y="-15574.24" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2268" y="-15563.24" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2268" y="-15552.24" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu4 -->
<g id="edge307" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu4</title>
<path fill="none" stroke="black" d="M2268,-15632.77C2268,-15624.7 2268,-15615.86 2268,-15607.5"/>
<polygon fill="black" stroke="black" points="2271.5,-15607.25 2268,-15597.25 2264.5,-15607.25 2271.5,-15607.25"/>
</g>
<!-- layer_5_qkv_gpu5 -->
<g id="node228" class="node">
<title>layer_5_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2425.5,-15597.24 2332.5,-15597.24 2332.5,-15545.24 2425.5,-15545.24 2425.5,-15597.24"/>
<text text-anchor="middle" x="2379" y="-15585.24" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="2379" y="-15574.24" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2379" y="-15563.24" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2379" y="-15552.24" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu5 -->
<g id="edge308" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu5</title>
<path fill="none" stroke="black" d="M2304.04,-15633.02C2315.56,-15623.68 2328.36,-15613.3 2340.08,-15603.8"/>
<polygon fill="black" stroke="black" points="2342.42,-15606.4 2347.99,-15597.39 2338.02,-15600.97 2342.42,-15606.4"/>
</g>
<!-- layer_5_qkv_gpu6 -->
<g id="node229" class="node">
<title>layer_5_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2536.5,-15597.24 2443.5,-15597.24 2443.5,-15545.24 2536.5,-15545.24 2536.5,-15597.24"/>
<text text-anchor="middle" x="2490" y="-15585.24" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="2490" y="-15574.24" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2490" y="-15563.24" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2490" y="-15552.24" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu6 -->
<g id="edge309" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu6</title>
<path fill="none" stroke="black" d="M2328.23,-15639.72C2357.83,-15628.44 2394.18,-15614.27 2433.92,-15597.63"/>
<polygon fill="black" stroke="black" points="2435.41,-15600.8 2443.27,-15593.7 2432.7,-15594.35 2435.41,-15600.8"/>
</g>
<!-- layer_5_qkv_gpu7 -->
<g id="node230" class="node">
<title>layer_5_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2647.5,-15597.24 2554.5,-15597.24 2554.5,-15545.24 2647.5,-15545.24 2647.5,-15597.24"/>
<text text-anchor="middle" x="2601" y="-15585.24" font-family="Arial" font-size="10.00">Layer 5 QKV Proj</text>
<text text-anchor="middle" x="2601" y="-15574.24" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2601" y="-15563.24" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2601" y="-15552.24" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_qkv_gpu7 -->
<g id="edge310" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_qkv_gpu7</title>
<path fill="none" stroke="black" d="M2334.75,-15650.47C2389.38,-15639.97 2468.57,-15622.77 2544.7,-15597.45"/>
<polygon fill="black" stroke="black" points="2546.09,-15600.67 2554.45,-15594.16 2543.85,-15594.04 2546.09,-15600.67"/>
</g>
<!-- layer_5_residual1 -->
<g id="node242" class="node">
<title>layer_5_residual1</title>
<polygon fill="lightyellow" stroke="black" points="2631.94,-15145.28 2509.55,-15145.28 2478.06,-15085.28 2600.45,-15085.28 2631.94,-15145.28"/>
<text text-anchor="middle" x="2555" y="-15118.28" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="2555" y="-15107.28" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_5_input_dist&#45;&gt;layer_5_residual1 -->
<g id="edge330" class="edge">
<title>layer_5_input_dist&#45;&gt;layer_5_residual1</title>
<path fill="none" stroke="black" d="M2338.87,-15656.47C2435.96,-15647.56 2604.28,-15628.15 2657,-15597.24 2714,-15563.82 2750,-15547.33 2750,-15481.25 2750,-15481.25 2750,-15481.25 2750,-15300.26 2750,-15231.48 2685.02,-15180.8 2630.09,-15150.24"/>
<polygon fill="black" stroke="black" points="2631.48,-15147.01 2621.02,-15145.33 2628.14,-15153.17 2631.48,-15147.01"/>
</g>
<!-- layer_5_allgather_qkv -->
<g id="node231" class="node">
<title>layer_5_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="2157" cy="-15480.25" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="2157" y="-15488.75" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="2157" y="-15477.75" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="2157" y="-15466.75" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_5_qkv_gpu0&#45;&gt;layer_5_allgather_qkv -->
<g id="edge311" class="edge">
<title>layer_5_qkv_gpu0&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M1870.79,-15548.56C1873.88,-15547.38 1876.97,-15546.26 1880,-15545.24 1951.63,-15521.23 2036.62,-15503.06 2093.4,-15492.32"/>
<polygon fill="black" stroke="black" points="2094.12,-15495.75 2103.31,-15490.47 2092.84,-15488.87 2094.12,-15495.75"/>
</g>
<!-- layer_5_qkv_gpu1&#45;&gt;layer_5_allgather_qkv -->
<g id="edge312" class="edge">
<title>layer_5_qkv_gpu1&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M1981.67,-15549.19C1984.82,-15547.83 1987.95,-15546.51 1991,-15545.24 2027.7,-15529.99 2069.45,-15513.9 2101.9,-15501.67"/>
<polygon fill="black" stroke="black" points="2103.53,-15504.8 2111.66,-15498 2101.06,-15498.24 2103.53,-15504.8"/>
</g>
<!-- layer_5_qkv_gpu2&#45;&gt;layer_5_allgather_qkv -->
<g id="edge313" class="edge">
<title>layer_5_qkv_gpu2&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M2077.22,-15545.22C2090.29,-15534.73 2105.61,-15522.45 2119.31,-15511.46"/>
<polygon fill="black" stroke="black" points="2121.55,-15514.16 2127.17,-15505.17 2117.17,-15508.69 2121.55,-15514.16"/>
</g>
<!-- layer_5_qkv_gpu3&#45;&gt;layer_5_allgather_qkv -->
<g id="edge314" class="edge">
<title>layer_5_qkv_gpu3&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M2157,-15544.98C2157,-15537.09 2157,-15528.2 2157,-15519.62"/>
<polygon fill="black" stroke="black" points="2160.5,-15519.39 2157,-15509.39 2153.5,-15519.39 2160.5,-15519.39"/>
</g>
<!-- layer_5_qkv_gpu4&#45;&gt;layer_5_allgather_qkv -->
<g id="edge315" class="edge">
<title>layer_5_qkv_gpu4&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M2236.78,-15545.22C2223.71,-15534.73 2208.39,-15522.45 2194.69,-15511.46"/>
<polygon fill="black" stroke="black" points="2196.83,-15508.69 2186.83,-15505.17 2192.45,-15514.16 2196.83,-15508.69"/>
</g>
<!-- layer_5_qkv_gpu5&#45;&gt;layer_5_allgather_qkv -->
<g id="edge316" class="edge">
<title>layer_5_qkv_gpu5&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M2332.28,-15548.77C2329.48,-15547.56 2326.71,-15546.37 2324,-15545.24 2286.98,-15529.75 2244.78,-15513.59 2212.06,-15501.39"/>
<polygon fill="black" stroke="black" points="2213.25,-15498.1 2202.66,-15497.89 2210.81,-15504.66 2213.25,-15498.1"/>
</g>
<!-- layer_5_qkv_gpu6&#45;&gt;layer_5_allgather_qkv -->
<g id="edge317" class="edge">
<title>layer_5_qkv_gpu6&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M2443.45,-15548.31C2440.61,-15547.22 2437.78,-15546.18 2435,-15545.24 2363.2,-15520.93 2277.88,-15502.82 2220.87,-15492.18"/>
<polygon fill="black" stroke="black" points="2221.39,-15488.71 2210.92,-15490.34 2220.12,-15495.6 2221.39,-15488.71"/>
</g>
<!-- layer_5_qkv_gpu7&#45;&gt;layer_5_allgather_qkv -->
<g id="edge318" class="edge">
<title>layer_5_qkv_gpu7&#45;&gt;layer_5_allgather_qkv</title>
<path fill="none" stroke="black" d="M2554.21,-15547.99C2551.46,-15546.99 2548.71,-15546.06 2546,-15545.24 2435.69,-15511.74 2302.14,-15494.62 2223.68,-15486.83"/>
<polygon fill="black" stroke="black" points="2223.75,-15483.32 2213.45,-15485.84 2223.07,-15490.29 2223.75,-15483.32"/>
</g>
<!-- layer_5_attention -->
<g id="node232" class="node">
<title>layer_5_attention</title>
<polygon fill="lightblue" stroke="black" points="2044,-15415.26 1976,-15415.26 1976,-15363.26 2044,-15363.26 2044,-15415.26"/>
<text text-anchor="middle" x="2010" y="-15403.26" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="2010" y="-15392.26" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="2010" y="-15381.26" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="2010" y="-15370.26" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_5_allgather_qkv&#45;&gt;layer_5_attention -->
<g id="edge319" class="edge">
<title>layer_5_allgather_qkv&#45;&gt;layer_5_attention</title>
<path fill="none" stroke="black" d="M2121.04,-15457.48C2100.42,-15445 2074.41,-15429.25 2052.75,-15416.14"/>
<polygon fill="black" stroke="black" points="2054.44,-15413.07 2044.07,-15410.89 2050.82,-15419.06 2054.44,-15413.07"/>
</g>
<!-- layer_5_attn_out_gpu7 -->
<g id="node240" class="node">
<title>layer_5_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="1980,-15327.26 1892,-15327.26 1892,-15275.26 1980,-15275.26 1980,-15327.26"/>
<text text-anchor="middle" x="1936" y="-15315.26" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="1936" y="-15304.26" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1936" y="-15293.26" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1936" y="-15282.26" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attention&#45;&gt;layer_5_attn_out_gpu7 -->
<g id="edge320" class="edge">
<title>layer_5_attention&#45;&gt;layer_5_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M1988.2,-15362.92C1980.75,-15354.26 1972.3,-15344.44 1964.4,-15335.27"/>
<polygon fill="black" stroke="black" points="1966.82,-15332.71 1957.65,-15327.42 1961.52,-15337.28 1966.82,-15332.71"/>
</g>
<!-- layer_5_attn_out_gpu0 -->
<g id="node233" class="node">
<title>layer_5_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2086,-15327.26 1998,-15327.26 1998,-15275.26 2086,-15275.26 2086,-15327.26"/>
<text text-anchor="middle" x="2042" y="-15315.26" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="2042" y="-15304.26" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2042" y="-15293.26" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2042" y="-15282.26" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_allreduce_attn -->
<g id="node241" class="node">
<title>layer_5_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="2360" cy="-15210.27" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="2360" y="-15218.77" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="2360" y="-15207.77" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="2360" y="-15196.77" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_5_attn_out_gpu0&#45;&gt;layer_5_allreduce_attn -->
<g id="edge321" class="edge">
<title>layer_5_attn_out_gpu0&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M2086.26,-15278.58C2089.19,-15277.39 2092.12,-15276.27 2095,-15275.26 2162.13,-15251.6 2241.84,-15233.65 2296.19,-15222.87"/>
<polygon fill="black" stroke="black" points="2296.89,-15226.3 2306.03,-15220.94 2295.54,-15219.43 2296.89,-15226.3"/>
</g>
<!-- layer_5_attn_out_gpu1 -->
<g id="node234" class="node">
<title>layer_5_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2192,-15327.26 2104,-15327.26 2104,-15275.26 2192,-15275.26 2192,-15327.26"/>
<text text-anchor="middle" x="2148" y="-15315.26" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="2148" y="-15304.26" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2148" y="-15293.26" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2148" y="-15282.26" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attn_out_gpu1&#45;&gt;layer_5_allreduce_attn -->
<g id="edge322" class="edge">
<title>layer_5_attn_out_gpu1&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M2192.16,-15279.19C2195.14,-15277.84 2198.11,-15276.52 2201,-15275.26 2235.33,-15260.27 2274.34,-15244.55 2305.13,-15232.44"/>
<polygon fill="black" stroke="black" points="2306.79,-15235.55 2314.82,-15228.64 2304.23,-15229.03 2306.79,-15235.55"/>
</g>
<!-- layer_5_attn_out_gpu2 -->
<g id="node235" class="node">
<title>layer_5_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2298,-15327.26 2210,-15327.26 2210,-15275.26 2298,-15275.26 2298,-15327.26"/>
<text text-anchor="middle" x="2254" y="-15315.26" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="2254" y="-15304.26" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2254" y="-15293.26" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2254" y="-15282.26" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attn_out_gpu2&#45;&gt;layer_5_allreduce_attn -->
<g id="edge323" class="edge">
<title>layer_5_attn_out_gpu2&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M2283.81,-15275.23C2296.08,-15264.93 2310.42,-15252.89 2323.33,-15242.06"/>
<polygon fill="black" stroke="black" points="2325.74,-15244.6 2331.15,-15235.49 2321.24,-15239.24 2325.74,-15244.6"/>
</g>
<!-- layer_5_attn_out_gpu3 -->
<g id="node236" class="node">
<title>layer_5_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2404,-15327.26 2316,-15327.26 2316,-15275.26 2404,-15275.26 2404,-15327.26"/>
<text text-anchor="middle" x="2360" y="-15315.26" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="2360" y="-15304.26" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="2360" y="-15293.26" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2360" y="-15282.26" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attn_out_gpu3&#45;&gt;layer_5_allreduce_attn -->
<g id="edge324" class="edge">
<title>layer_5_attn_out_gpu3&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M2360,-15275C2360,-15267.1 2360,-15258.21 2360,-15249.63"/>
<polygon fill="black" stroke="black" points="2363.5,-15249.41 2360,-15239.41 2356.5,-15249.41 2363.5,-15249.41"/>
</g>
<!-- layer_5_attn_out_gpu4 -->
<g id="node237" class="node">
<title>layer_5_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2510,-15327.26 2422,-15327.26 2422,-15275.26 2510,-15275.26 2510,-15327.26"/>
<text text-anchor="middle" x="2466" y="-15315.26" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="2466" y="-15304.26" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2466" y="-15293.26" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2466" y="-15282.26" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attn_out_gpu4&#45;&gt;layer_5_allreduce_attn -->
<g id="edge325" class="edge">
<title>layer_5_attn_out_gpu4&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M2436.19,-15275.23C2423.92,-15264.93 2409.58,-15252.89 2396.67,-15242.06"/>
<polygon fill="black" stroke="black" points="2398.76,-15239.24 2388.85,-15235.49 2394.26,-15244.6 2398.76,-15239.24"/>
</g>
<!-- layer_5_attn_out_gpu5 -->
<g id="node238" class="node">
<title>layer_5_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2616,-15327.26 2528,-15327.26 2528,-15275.26 2616,-15275.26 2616,-15327.26"/>
<text text-anchor="middle" x="2572" y="-15315.26" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="2572" y="-15304.26" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2572" y="-15293.26" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2572" y="-15282.26" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attn_out_gpu5&#45;&gt;layer_5_allreduce_attn -->
<g id="edge326" class="edge">
<title>layer_5_attn_out_gpu5&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M2527.84,-15279.19C2524.86,-15277.84 2521.89,-15276.52 2519,-15275.26 2484.67,-15260.27 2445.66,-15244.55 2414.87,-15232.44"/>
<polygon fill="black" stroke="black" points="2415.77,-15229.03 2405.18,-15228.64 2413.21,-15235.55 2415.77,-15229.03"/>
</g>
<!-- layer_5_attn_out_gpu6 -->
<g id="node239" class="node">
<title>layer_5_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2722,-15327.26 2634,-15327.26 2634,-15275.26 2722,-15275.26 2722,-15327.26"/>
<text text-anchor="middle" x="2678" y="-15315.26" font-family="Arial" font-size="10.00">Layer 5 Attn Out</text>
<text text-anchor="middle" x="2678" y="-15304.26" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2678" y="-15293.26" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2678" y="-15282.26" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_5_attn_out_gpu6&#45;&gt;layer_5_allreduce_attn -->
<g id="edge327" class="edge">
<title>layer_5_attn_out_gpu6&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M2633.74,-15278.58C2630.81,-15277.39 2627.88,-15276.27 2625,-15275.26 2557.87,-15251.6 2478.16,-15233.65 2423.81,-15222.87"/>
<polygon fill="black" stroke="black" points="2424.46,-15219.43 2413.97,-15220.94 2423.11,-15226.3 2424.46,-15219.43"/>
</g>
<!-- layer_5_attn_out_gpu7&#45;&gt;layer_5_allreduce_attn -->
<g id="edge328" class="edge">
<title>layer_5_attn_out_gpu7&#45;&gt;layer_5_allreduce_attn</title>
<path fill="none" stroke="black" d="M1980.18,-15278.36C1983.13,-15277.22 1986.09,-15276.18 1989,-15275.26 2092.43,-15242.61 2217.66,-15225.4 2292.97,-15217.33"/>
<polygon fill="black" stroke="black" points="2293.67,-15220.78 2303.25,-15216.25 2292.94,-15213.81 2293.67,-15220.78"/>
</g>
<!-- layer_5_allreduce_attn&#45;&gt;layer_5_residual1 -->
<g id="edge329" class="edge">
<title>layer_5_allreduce_attn&#45;&gt;layer_5_residual1</title>
<path fill="none" stroke="black" d="M2401.35,-15189.55C2429.12,-15176.31 2466.09,-15158.68 2496.81,-15144.03"/>
<polygon fill="black" stroke="black" points="2498.6,-15147.05 2506.12,-15139.58 2495.59,-15140.73 2498.6,-15147.05"/>
</g>
<!-- layer_5_ln1 -->
<g id="node243" class="node">
<title>layer_5_ln1</title>
<polygon fill="lightblue" stroke="black" points="2386.5,-15049.28 2313.5,-15049.28 2313.5,-15008.28 2386.5,-15008.28 2386.5,-15049.28"/>
<text text-anchor="middle" x="2350" y="-15037.28" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="2350" y="-15026.28" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="2350" y="-15015.28" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_5_residual1&#45;&gt;layer_5_ln1 -->
<g id="edge331" class="edge">
<title>layer_5_residual1&#45;&gt;layer_5_ln1</title>
<path fill="none" stroke="black" d="M2484.45,-15085.2C2455.16,-15073.12 2421.99,-15059.45 2395.93,-15048.71"/>
<polygon fill="black" stroke="black" points="2397.25,-15045.47 2386.67,-15044.89 2394.58,-15051.94 2397.25,-15045.47"/>
</g>
<!-- layer_5_residual2 -->
<g id="node263" class="node">
<title>layer_5_residual2</title>
<polygon fill="lightyellow" stroke="black" points="2715.94,-14536.31 2593.55,-14536.31 2562.06,-14476.31 2684.45,-14476.31 2715.94,-14536.31"/>
<text text-anchor="middle" x="2639" y="-14509.31" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="2639" y="-14498.31" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_5_residual1&#45;&gt;layer_5_residual2 -->
<g id="edge359" class="edge">
<title>layer_5_residual1&#45;&gt;layer_5_residual2</title>
<path fill="none" stroke="black" d="M2612.29,-15107.22C2696.81,-15093.25 2845,-15053.6 2845,-14947.28 2845,-14947.28 2845,-14947.28 2845,-14691.29 2845,-14621.08 2777.61,-14571 2719.92,-14540.99"/>
<polygon fill="black" stroke="black" points="2721.26,-14537.75 2710.76,-14536.35 2718.1,-14543.99 2721.26,-14537.75"/>
</g>
<!-- layer_5_mlp_fc1_gpu0 -->
<g id="node244" class="node">
<title>layer_5_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1949,-14972.28 1855,-14972.28 1855,-14920.28 1949,-14920.28 1949,-14972.28"/>
<text text-anchor="middle" x="1902" y="-14960.28" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="1902" y="-14949.28" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1902" y="-14938.28" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="1902" y="-14927.28" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu0 -->
<g id="edge332" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M2313.35,-15026C2244.78,-15021.94 2092.67,-15009.52 1958.63,-14972.11"/>
<polygon fill="black" stroke="black" points="1959.58,-14968.74 1949.01,-14969.37 1957.67,-14975.48 1959.58,-14968.74"/>
</g>
<!-- layer_5_mlp_fc1_gpu1 -->
<g id="node245" class="node">
<title>layer_5_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2061,-14972.28 1967,-14972.28 1967,-14920.28 2061,-14920.28 2061,-14972.28"/>
<text text-anchor="middle" x="2014" y="-14960.28" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="2014" y="-14949.28" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2014" y="-14938.28" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2014" y="-14927.28" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu1 -->
<g id="edge333" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M2313.1,-15023.15C2260.76,-15016.01 2162.05,-15000.41 2070.73,-14972.22"/>
<polygon fill="black" stroke="black" points="2071.66,-14968.84 2061.07,-14969.18 2069.55,-14975.52 2071.66,-14968.84"/>
</g>
<!-- layer_5_mlp_fc1_gpu2 -->
<g id="node246" class="node">
<title>layer_5_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2173,-14972.28 2079,-14972.28 2079,-14920.28 2173,-14920.28 2173,-14972.28"/>
<text text-anchor="middle" x="2126" y="-14960.28" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="2126" y="-14949.28" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2126" y="-14938.28" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2126" y="-14927.28" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu2 -->
<g id="edge334" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M2313.25,-15016.81C2280.97,-15006.91 2232.62,-14991.47 2182.58,-14972.37"/>
<polygon fill="black" stroke="black" points="2183.8,-14969.09 2173.22,-14968.76 2181.29,-14975.62 2183.8,-14969.09"/>
</g>
<!-- layer_5_mlp_fc1_gpu3 -->
<g id="node247" class="node">
<title>layer_5_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2285,-14972.28 2191,-14972.28 2191,-14920.28 2285,-14920.28 2285,-14972.28"/>
<text text-anchor="middle" x="2238" y="-14960.28" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="2238" y="-14949.28" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="2238" y="-14938.28" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2238" y="-14927.28" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu3 -->
<g id="edge335" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M2322.6,-15008.08C2310.27,-14999.22 2295.4,-14988.53 2281.59,-14978.61"/>
<polygon fill="black" stroke="black" points="2283.33,-14975.55 2273.17,-14972.55 2279.24,-14981.23 2283.33,-14975.55"/>
</g>
<!-- layer_5_mlp_fc1_gpu4 -->
<g id="node248" class="node">
<title>layer_5_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2397,-14972.28 2303,-14972.28 2303,-14920.28 2397,-14920.28 2397,-14972.28"/>
<text text-anchor="middle" x="2350" y="-14960.28" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="2350" y="-14949.28" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2350" y="-14938.28" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2350" y="-14927.28" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu4 -->
<g id="edge336" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M2350,-15007.88C2350,-15000.26 2350,-14991.33 2350,-14982.7"/>
<polygon fill="black" stroke="black" points="2353.5,-14982.43 2350,-14972.43 2346.5,-14982.43 2353.5,-14982.43"/>
</g>
<!-- layer_5_mlp_fc1_gpu5 -->
<g id="node249" class="node">
<title>layer_5_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2509,-14972.28 2415,-14972.28 2415,-14920.28 2509,-14920.28 2509,-14972.28"/>
<text text-anchor="middle" x="2462" y="-14960.28" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="2462" y="-14949.28" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2462" y="-14938.28" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2462" y="-14927.28" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu5 -->
<g id="edge337" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M2377.4,-15008.08C2389.73,-14999.22 2404.6,-14988.53 2418.41,-14978.61"/>
<polygon fill="black" stroke="black" points="2420.76,-14981.23 2426.83,-14972.55 2416.67,-14975.55 2420.76,-14981.23"/>
</g>
<!-- layer_5_mlp_fc1_gpu6 -->
<g id="node250" class="node">
<title>layer_5_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2621,-14972.28 2527,-14972.28 2527,-14920.28 2621,-14920.28 2621,-14972.28"/>
<text text-anchor="middle" x="2574" y="-14960.28" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="2574" y="-14949.28" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2574" y="-14938.28" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2574" y="-14927.28" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu6 -->
<g id="edge338" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M2386.75,-15016.81C2419.03,-15006.91 2467.38,-14991.47 2517.42,-14972.37"/>
<polygon fill="black" stroke="black" points="2518.71,-14975.62 2526.78,-14968.76 2516.2,-14969.09 2518.71,-14975.62"/>
</g>
<!-- layer_5_mlp_fc1_gpu7 -->
<g id="node251" class="node">
<title>layer_5_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2733,-14972.28 2639,-14972.28 2639,-14920.28 2733,-14920.28 2733,-14972.28"/>
<text text-anchor="middle" x="2686" y="-14960.28" font-family="Arial" font-size="10.00">Layer 5 MLP FC1</text>
<text text-anchor="middle" x="2686" y="-14949.28" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2686" y="-14938.28" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2686" y="-14927.28" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu7 -->
<g id="edge339" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M2386.9,-15023.15C2439.24,-15016.01 2537.95,-15000.41 2629.27,-14972.22"/>
<polygon fill="black" stroke="black" points="2630.45,-14975.52 2638.93,-14969.18 2628.34,-14968.84 2630.45,-14975.52"/>
</g>
<!-- layer_5_allgather_mlp -->
<g id="node252" class="node">
<title>layer_5_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="2238" cy="-14855.28" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="2238" y="-14863.78" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="2238" y="-14852.78" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="2238" y="-14841.78" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_5_mlp_fc1_gpu0&#45;&gt;layer_5_allgather_mlp -->
<g id="edge340" class="edge">
<title>layer_5_mlp_fc1_gpu0&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M1949.1,-14923.47C1952.09,-14922.33 1955.07,-14921.25 1958,-14920.28 2030.84,-14895.95 2117.37,-14877.74 2174.76,-14867.08"/>
<polygon fill="black" stroke="black" points="2175.57,-14870.49 2184.78,-14865.24 2174.31,-14863.61 2175.57,-14870.49"/>
</g>
<!-- layer_5_mlp_fc1_gpu1&#45;&gt;layer_5_allgather_mlp -->
<g id="edge341" class="edge">
<title>layer_5_mlp_fc1_gpu1&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M2061.28,-14923.95C2064.22,-14922.69 2067.15,-14921.46 2070,-14920.28 2107.41,-14904.81 2150.04,-14888.59 2182.99,-14876.35"/>
<polygon fill="black" stroke="black" points="2184.29,-14879.6 2192.45,-14872.85 2181.86,-14873.04 2184.29,-14879.6"/>
</g>
<!-- layer_5_mlp_fc1_gpu2&#45;&gt;layer_5_allgather_mlp -->
<g id="edge342" class="edge">
<title>layer_5_mlp_fc1_gpu2&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M2157.5,-14920.25C2170.69,-14909.76 2186.15,-14897.48 2199.98,-14886.5"/>
<polygon fill="black" stroke="black" points="2202.24,-14889.17 2207.9,-14880.2 2197.89,-14883.68 2202.24,-14889.17"/>
</g>
<!-- layer_5_mlp_fc1_gpu3&#45;&gt;layer_5_allgather_mlp -->
<g id="edge343" class="edge">
<title>layer_5_mlp_fc1_gpu3&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M2238,-14920.01C2238,-14912.12 2238,-14903.23 2238,-14894.65"/>
<polygon fill="black" stroke="black" points="2241.5,-14894.43 2238,-14884.43 2234.5,-14894.43 2241.5,-14894.43"/>
</g>
<!-- layer_5_mlp_fc1_gpu4&#45;&gt;layer_5_allgather_mlp -->
<g id="edge344" class="edge">
<title>layer_5_mlp_fc1_gpu4&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M2318.5,-14920.25C2305.31,-14909.76 2289.85,-14897.48 2276.02,-14886.5"/>
<polygon fill="black" stroke="black" points="2278.11,-14883.68 2268.1,-14880.2 2273.76,-14889.17 2278.11,-14883.68"/>
</g>
<!-- layer_5_mlp_fc1_gpu5&#45;&gt;layer_5_allgather_mlp -->
<g id="edge345" class="edge">
<title>layer_5_mlp_fc1_gpu5&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M2414.72,-14923.95C2411.78,-14922.69 2408.85,-14921.46 2406,-14920.28 2368.59,-14904.81 2325.96,-14888.59 2293.01,-14876.35"/>
<polygon fill="black" stroke="black" points="2294.14,-14873.04 2283.55,-14872.85 2291.71,-14879.6 2294.14,-14873.04"/>
</g>
<!-- layer_5_mlp_fc1_gpu6&#45;&gt;layer_5_allgather_mlp -->
<g id="edge346" class="edge">
<title>layer_5_mlp_fc1_gpu6&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M2526.9,-14923.47C2523.91,-14922.33 2520.93,-14921.25 2518,-14920.28 2445.16,-14895.95 2358.63,-14877.74 2301.24,-14867.08"/>
<polygon fill="black" stroke="black" points="2301.69,-14863.61 2291.22,-14865.24 2300.43,-14870.49 2301.69,-14863.61"/>
</g>
<!-- layer_5_mlp_fc1_gpu7&#45;&gt;layer_5_allgather_mlp -->
<g id="edge347" class="edge">
<title>layer_5_mlp_fc1_gpu7&#45;&gt;layer_5_allgather_mlp</title>
<path fill="none" stroke="black" d="M2638.97,-14923.25C2635.96,-14922.17 2632.96,-14921.16 2630,-14920.28 2518.1,-14886.78 2382.65,-14869.59 2303.82,-14861.8"/>
<polygon fill="black" stroke="black" points="2303.84,-14858.29 2293.55,-14860.81 2303.16,-14865.25 2303.84,-14858.29"/>
</g>
<!-- layer_5_gelu -->
<g id="node253" class="node">
<title>layer_5_gelu</title>
<polygon fill="lightblue" stroke="black" points="2198.5,-14790.29 2109.5,-14790.29 2109.5,-14754.29 2198.5,-14754.29 2198.5,-14790.29"/>
<text text-anchor="middle" x="2154" y="-14775.29" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="2154" y="-14764.29" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_5_allgather_mlp&#45;&gt;layer_5_gelu -->
<g id="edge348" class="edge">
<title>layer_5_allgather_mlp&#45;&gt;layer_5_gelu</title>
<path fill="none" stroke="black" d="M2211.88,-14829.1C2201.42,-14819.01 2189.41,-14807.44 2179.06,-14797.45"/>
<polygon fill="black" stroke="black" points="2181.48,-14794.93 2171.85,-14790.51 2176.62,-14799.97 2181.48,-14794.93"/>
</g>
<!-- layer_5_mlp_fc2_gpu7 -->
<g id="node261" class="node">
<title>layer_5_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2033,-14718.29 1939,-14718.29 1939,-14666.29 2033,-14666.29 2033,-14718.29"/>
<text text-anchor="middle" x="1986" y="-14706.29" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="1986" y="-14695.29" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1986" y="-14684.29" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="1986" y="-14673.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu7 -->
<g id="edge349" class="edge">
<title>layer_5_gelu&#45;&gt;layer_5_mlp_fc2_gpu7</title>
<path fill="none" stroke="black" d="M2117.13,-14754.18C2095.21,-14744 2066.95,-14730.88 2042.28,-14719.42"/>
<polygon fill="black" stroke="black" points="2043.56,-14716.16 2033.02,-14715.12 2040.62,-14722.51 2043.56,-14716.16"/>
</g>
<!-- layer_5_mlp_fc2_gpu0 -->
<g id="node254" class="node">
<title>layer_5_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2145,-14718.29 2051,-14718.29 2051,-14666.29 2145,-14666.29 2145,-14718.29"/>
<text text-anchor="middle" x="2098" y="-14706.29" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="2098" y="-14695.29" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2098" y="-14684.29" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2098" y="-14673.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_allreduce_mlp -->
<g id="node262" class="node">
<title>layer_5_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="2434" cy="-14601.3" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="2434" y="-14609.8" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="2434" y="-14598.8" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="2434" y="-14587.8" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_5_mlp_fc2_gpu0&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge350" class="edge">
<title>layer_5_mlp_fc2_gpu0&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2145.1,-14669.49C2148.09,-14668.35 2151.07,-14667.27 2154,-14666.29 2225.61,-14642.38 2310.46,-14624.37 2367.84,-14613.64"/>
<polygon fill="black" stroke="black" points="2368.67,-14617.05 2377.87,-14611.79 2367.4,-14610.17 2368.67,-14617.05"/>
</g>
<!-- layer_5_mlp_fc2_gpu1 -->
<g id="node255" class="node">
<title>layer_5_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2257,-14718.29 2163,-14718.29 2163,-14666.29 2257,-14666.29 2257,-14718.29"/>
<text text-anchor="middle" x="2210" y="-14706.29" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="2210" y="-14695.29" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2210" y="-14684.29" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2210" y="-14673.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_mlp_fc2_gpu1&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge351" class="edge">
<title>layer_5_mlp_fc2_gpu1&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2257.28,-14669.96C2260.22,-14668.71 2263.15,-14667.47 2266,-14666.29 2302.89,-14651.05 2344.84,-14635.07 2377.6,-14622.89"/>
<polygon fill="black" stroke="black" points="2378.85,-14626.15 2387.01,-14619.4 2376.42,-14619.59 2378.85,-14626.15"/>
</g>
<!-- layer_5_mlp_fc2_gpu2 -->
<g id="node256" class="node">
<title>layer_5_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2369,-14718.29 2275,-14718.29 2275,-14666.29 2369,-14666.29 2369,-14718.29"/>
<text text-anchor="middle" x="2322" y="-14706.29" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="2322" y="-14695.29" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2322" y="-14684.29" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2322" y="-14673.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_mlp_fc2_gpu2&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge352" class="edge">
<title>layer_5_mlp_fc2_gpu2&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2353.5,-14666.27C2366.59,-14655.87 2381.9,-14643.7 2395.64,-14632.78"/>
<polygon fill="black" stroke="black" points="2397.86,-14635.49 2403.51,-14626.53 2393.51,-14630.01 2397.86,-14635.49"/>
</g>
<!-- layer_5_mlp_fc2_gpu3 -->
<g id="node257" class="node">
<title>layer_5_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2481,-14718.29 2387,-14718.29 2387,-14666.29 2481,-14666.29 2481,-14718.29"/>
<text text-anchor="middle" x="2434" y="-14706.29" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="2434" y="-14695.29" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="2434" y="-14684.29" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2434" y="-14673.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_mlp_fc2_gpu3&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge353" class="edge">
<title>layer_5_mlp_fc2_gpu3&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2434,-14666.03C2434,-14658.14 2434,-14649.25 2434,-14640.67"/>
<polygon fill="black" stroke="black" points="2437.5,-14640.44 2434,-14630.44 2430.5,-14640.44 2437.5,-14640.44"/>
</g>
<!-- layer_5_mlp_fc2_gpu4 -->
<g id="node258" class="node">
<title>layer_5_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2593,-14718.29 2499,-14718.29 2499,-14666.29 2593,-14666.29 2593,-14718.29"/>
<text text-anchor="middle" x="2546" y="-14706.29" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="2546" y="-14695.29" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2546" y="-14684.29" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2546" y="-14673.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_mlp_fc2_gpu4&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge354" class="edge">
<title>layer_5_mlp_fc2_gpu4&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2514.5,-14666.27C2501.41,-14655.87 2486.1,-14643.7 2472.36,-14632.78"/>
<polygon fill="black" stroke="black" points="2474.49,-14630.01 2464.49,-14626.53 2470.14,-14635.49 2474.49,-14630.01"/>
</g>
<!-- layer_5_mlp_fc2_gpu5 -->
<g id="node259" class="node">
<title>layer_5_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2705,-14718.29 2611,-14718.29 2611,-14666.29 2705,-14666.29 2705,-14718.29"/>
<text text-anchor="middle" x="2658" y="-14706.29" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="2658" y="-14695.29" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2658" y="-14684.29" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2658" y="-14673.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_mlp_fc2_gpu5&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge355" class="edge">
<title>layer_5_mlp_fc2_gpu5&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2610.72,-14669.96C2607.78,-14668.71 2604.85,-14667.47 2602,-14666.29 2565.11,-14651.05 2523.16,-14635.07 2490.4,-14622.89"/>
<polygon fill="black" stroke="black" points="2491.58,-14619.59 2480.99,-14619.4 2489.15,-14626.15 2491.58,-14619.59"/>
</g>
<!-- layer_5_mlp_fc2_gpu6 -->
<g id="node260" class="node">
<title>layer_5_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2817,-14718.29 2723,-14718.29 2723,-14666.29 2817,-14666.29 2817,-14718.29"/>
<text text-anchor="middle" x="2770" y="-14706.29" font-family="Arial" font-size="10.00">Layer 5 MLP FC2</text>
<text text-anchor="middle" x="2770" y="-14695.29" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2770" y="-14684.29" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2770" y="-14673.29" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_5_mlp_fc2_gpu6&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge356" class="edge">
<title>layer_5_mlp_fc2_gpu6&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2722.9,-14669.49C2719.91,-14668.35 2716.93,-14667.27 2714,-14666.29 2642.39,-14642.38 2557.54,-14624.37 2500.16,-14613.64"/>
<polygon fill="black" stroke="black" points="2500.6,-14610.17 2490.13,-14611.79 2499.33,-14617.05 2500.6,-14610.17"/>
</g>
<!-- layer_5_mlp_fc2_gpu7&#45;&gt;layer_5_allreduce_mlp -->
<g id="edge357" class="edge">
<title>layer_5_mlp_fc2_gpu7&#45;&gt;layer_5_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2033.03,-14669.27C2036.04,-14668.18 2039.04,-14667.18 2042,-14666.29 2152.16,-14633.32 2285.15,-14616.15 2364.47,-14608.19"/>
<polygon fill="black" stroke="black" points="2365.21,-14611.63 2374.82,-14607.17 2364.53,-14604.66 2365.21,-14611.63"/>
</g>
<!-- layer_5_allreduce_mlp&#45;&gt;layer_5_residual2 -->
<g id="edge358" class="edge">
<title>layer_5_allreduce_mlp&#45;&gt;layer_5_residual2</title>
<path fill="none" stroke="black" d="M2476.97,-14580.81C2507,-14567.19 2547.46,-14548.83 2580.43,-14533.88"/>
<polygon fill="black" stroke="black" points="2582.3,-14536.87 2589.96,-14529.55 2579.41,-14530.5 2582.3,-14536.87"/>
</g>
<!-- layer_5_ln2 -->
<g id="node264" class="node">
<title>layer_5_ln2</title>
<polygon fill="lightblue" stroke="black" points="2675.5,-14440.31 2602.5,-14440.31 2602.5,-14399.31 2675.5,-14399.31 2675.5,-14440.31"/>
<text text-anchor="middle" x="2639" y="-14428.31" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="2639" y="-14417.31" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="2639" y="-14406.31" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_5_residual2&#45;&gt;layer_5_ln2 -->
<g id="edge360" class="edge">
<title>layer_5_residual2&#45;&gt;layer_5_ln2</title>
<path fill="none" stroke="black" d="M2639,-14476.23C2639,-14467.91 2639,-14458.82 2639,-14450.46"/>
<polygon fill="black" stroke="black" points="2642.5,-14450.38 2639,-14440.38 2635.5,-14450.38 2642.5,-14450.38"/>
</g>
<!-- layer_5_output_dist -->
<g id="node265" class="node">
<title>layer_5_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="2740.7,-14363.31 2578.92,-14363.31 2537.3,-14303.31 2699.08,-14303.31 2740.7,-14363.31"/>
<text text-anchor="middle" x="2639" y="-14336.31" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="2639" y="-14325.31" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_5_ln2&#45;&gt;layer_5_output_dist -->
<g id="edge361" class="edge">
<title>layer_5_ln2&#45;&gt;layer_5_output_dist</title>
<path fill="none" stroke="black" d="M2639,-14399.21C2639,-14391.57 2639,-14382.53 2639,-14373.66"/>
<polygon fill="black" stroke="black" points="2642.5,-14373.42 2639,-14363.42 2635.5,-14373.42 2642.5,-14373.42"/>
</g>
<!-- layer_6_input_dist -->
<g id="node266" class="node">
<title>layer_6_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="2733.19,-14267.31 2583.36,-14267.31 2544.81,-14207.31 2694.64,-14207.31 2733.19,-14267.31"/>
<text text-anchor="middle" x="2639" y="-14240.31" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="2639" y="-14229.31" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_5_output_dist&#45;&gt;layer_6_input_dist -->
<g id="edge362" class="edge">
<title>layer_5_output_dist&#45;&gt;layer_6_input_dist</title>
<path fill="none" stroke="black" d="M2639,-14303.08C2639,-14295.04 2639,-14286.18 2639,-14277.66"/>
<polygon fill="black" stroke="black" points="2642.5,-14277.52 2639,-14267.52 2635.5,-14277.52 2642.5,-14277.52"/>
</g>
<!-- layer_6_qkv_gpu0 -->
<g id="node267" class="node">
<title>layer_6_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2241.5,-14171.31 2148.5,-14171.31 2148.5,-14119.31 2241.5,-14119.31 2241.5,-14171.31"/>
<text text-anchor="middle" x="2195" y="-14159.31" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="2195" y="-14148.31" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2195" y="-14137.31" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2195" y="-14126.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu0 -->
<g id="edge363" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu0</title>
<path fill="none" stroke="black" d="M2558.5,-14228.85C2481.32,-14220.34 2361.81,-14203.6 2251.36,-14171.09"/>
<polygon fill="black" stroke="black" points="2252.31,-14167.72 2241.72,-14168.2 2250.3,-14174.42 2252.31,-14167.72"/>
</g>
<!-- layer_6_qkv_gpu1 -->
<g id="node268" class="node">
<title>layer_6_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2352.5,-14171.31 2259.5,-14171.31 2259.5,-14119.31 2352.5,-14119.31 2352.5,-14171.31"/>
<text text-anchor="middle" x="2306" y="-14159.31" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="2306" y="-14148.31" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2306" y="-14137.31" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2306" y="-14126.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu1 -->
<g id="edge364" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu1</title>
<path fill="none" stroke="black" d="M2553.28,-14220.56C2500.43,-14209.84 2431.37,-14194 2362.51,-14171.23"/>
<polygon fill="black" stroke="black" points="2363.39,-14167.84 2352.8,-14167.97 2361.16,-14174.47 2363.39,-14167.84"/>
</g>
<!-- layer_6_qkv_gpu2 -->
<g id="node269" class="node">
<title>layer_6_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2463.5,-14171.31 2370.5,-14171.31 2370.5,-14119.31 2463.5,-14119.31 2463.5,-14171.31"/>
<text text-anchor="middle" x="2417" y="-14159.31" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="2417" y="-14148.31" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2417" y="-14137.31" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2417" y="-14126.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu2 -->
<g id="edge365" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu2</title>
<path fill="none" stroke="black" d="M2562.67,-14207.28C2534.39,-14196.3 2502.12,-14183.5 2473,-14171.31 2472.9,-14171.27 2472.81,-14171.23 2472.71,-14171.19"/>
<polygon fill="black" stroke="black" points="2474.25,-14168.04 2463.68,-14167.34 2471.51,-14174.48 2474.25,-14168.04"/>
</g>
<!-- layer_6_qkv_gpu3 -->
<g id="node270" class="node">
<title>layer_6_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2574.5,-14171.31 2481.5,-14171.31 2481.5,-14119.31 2574.5,-14119.31 2574.5,-14171.31"/>
<text text-anchor="middle" x="2528" y="-14159.31" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="2528" y="-14148.31" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="2528" y="-14137.31" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2528" y="-14126.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu3 -->
<g id="edge366" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu3</title>
<path fill="none" stroke="black" d="M2602.96,-14207.09C2591.44,-14197.75 2578.64,-14187.37 2566.92,-14177.87"/>
<polygon fill="black" stroke="black" points="2568.98,-14175.03 2559.01,-14171.46 2564.58,-14180.47 2568.98,-14175.03"/>
</g>
<!-- layer_6_qkv_gpu4 -->
<g id="node271" class="node">
<title>layer_6_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2685.5,-14171.31 2592.5,-14171.31 2592.5,-14119.31 2685.5,-14119.31 2685.5,-14171.31"/>
<text text-anchor="middle" x="2639" y="-14159.31" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="2639" y="-14148.31" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2639" y="-14137.31" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2639" y="-14126.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu4 -->
<g id="edge367" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu4</title>
<path fill="none" stroke="black" d="M2639,-14206.84C2639,-14198.77 2639,-14189.93 2639,-14181.57"/>
<polygon fill="black" stroke="black" points="2642.5,-14181.32 2639,-14171.32 2635.5,-14181.32 2642.5,-14181.32"/>
</g>
<!-- layer_6_qkv_gpu5 -->
<g id="node272" class="node">
<title>layer_6_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2796.5,-14171.31 2703.5,-14171.31 2703.5,-14119.31 2796.5,-14119.31 2796.5,-14171.31"/>
<text text-anchor="middle" x="2750" y="-14159.31" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="2750" y="-14148.31" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2750" y="-14137.31" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2750" y="-14126.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu5 -->
<g id="edge368" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu5</title>
<path fill="none" stroke="black" d="M2675.04,-14207.09C2686.56,-14197.75 2699.36,-14187.37 2711.08,-14177.87"/>
<polygon fill="black" stroke="black" points="2713.42,-14180.47 2718.99,-14171.46 2709.02,-14175.03 2713.42,-14180.47"/>
</g>
<!-- layer_6_qkv_gpu6 -->
<g id="node273" class="node">
<title>layer_6_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2907.5,-14171.31 2814.5,-14171.31 2814.5,-14119.31 2907.5,-14119.31 2907.5,-14171.31"/>
<text text-anchor="middle" x="2861" y="-14159.31" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="2861" y="-14148.31" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2861" y="-14137.31" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2861" y="-14126.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu6 -->
<g id="edge369" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu6</title>
<path fill="none" stroke="black" d="M2699.23,-14213.79C2728.83,-14202.51 2765.18,-14188.34 2804.92,-14171.7"/>
<polygon fill="black" stroke="black" points="2806.41,-14174.87 2814.27,-14167.76 2803.7,-14168.42 2806.41,-14174.87"/>
</g>
<!-- layer_6_qkv_gpu7 -->
<g id="node274" class="node">
<title>layer_6_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3018.5,-14171.31 2925.5,-14171.31 2925.5,-14119.31 3018.5,-14119.31 3018.5,-14171.31"/>
<text text-anchor="middle" x="2972" y="-14159.31" font-family="Arial" font-size="10.00">Layer 6 QKV Proj</text>
<text text-anchor="middle" x="2972" y="-14148.31" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2972" y="-14137.31" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2972" y="-14126.31" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_qkv_gpu7 -->
<g id="edge370" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_qkv_gpu7</title>
<path fill="none" stroke="black" d="M2705.75,-14224.54C2760.38,-14214.04 2839.57,-14196.84 2915.7,-14171.52"/>
<polygon fill="black" stroke="black" points="2917.09,-14174.74 2925.45,-14168.23 2914.85,-14168.11 2917.09,-14174.74"/>
</g>
<!-- layer_6_residual1 -->
<g id="node286" class="node">
<title>layer_6_residual1</title>
<polygon fill="lightyellow" stroke="black" points="3002.94,-13719.34 2880.55,-13719.34 2849.06,-13659.34 2971.45,-13659.34 3002.94,-13719.34"/>
<text text-anchor="middle" x="2926" y="-13692.34" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="2926" y="-13681.34" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_6_input_dist&#45;&gt;layer_6_residual1 -->
<g id="edge390" class="edge">
<title>layer_6_input_dist&#45;&gt;layer_6_residual1</title>
<path fill="none" stroke="black" d="M2709.87,-14230.54C2806.96,-14221.63 2975.28,-14202.22 3028,-14171.31 3085,-14137.89 3121,-14121.39 3121,-14055.32 3121,-14055.32 3121,-14055.32 3121,-13874.33 3121,-13805.55 3056.02,-13754.87 3001.09,-13724.31"/>
<polygon fill="black" stroke="black" points="3002.48,-13721.08 2992.02,-13719.4 2999.14,-13727.24 3002.48,-13721.08"/>
</g>
<!-- layer_6_allgather_qkv -->
<g id="node275" class="node">
<title>layer_6_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="2528" cy="-14054.32" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="2528" y="-14062.82" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="2528" y="-14051.82" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="2528" y="-14040.82" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_6_qkv_gpu0&#45;&gt;layer_6_allgather_qkv -->
<g id="edge371" class="edge">
<title>layer_6_qkv_gpu0&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M2241.79,-14122.63C2244.88,-14121.45 2247.97,-14120.33 2251,-14119.31 2322.63,-14095.3 2407.62,-14077.12 2464.4,-14066.39"/>
<polygon fill="black" stroke="black" points="2465.12,-14069.82 2474.31,-14064.54 2463.84,-14062.94 2465.12,-14069.82"/>
</g>
<!-- layer_6_qkv_gpu1&#45;&gt;layer_6_allgather_qkv -->
<g id="edge372" class="edge">
<title>layer_6_qkv_gpu1&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M2352.67,-14123.26C2355.82,-14121.9 2358.95,-14120.58 2362,-14119.31 2398.7,-14104.06 2440.45,-14087.97 2472.9,-14075.74"/>
<polygon fill="black" stroke="black" points="2474.53,-14078.87 2482.66,-14072.07 2472.06,-14072.31 2474.53,-14078.87"/>
</g>
<!-- layer_6_qkv_gpu2&#45;&gt;layer_6_allgather_qkv -->
<g id="edge373" class="edge">
<title>layer_6_qkv_gpu2&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M2448.22,-14119.28C2461.29,-14108.8 2476.61,-14096.52 2490.31,-14085.53"/>
<polygon fill="black" stroke="black" points="2492.55,-14088.22 2498.17,-14079.24 2488.17,-14082.76 2492.55,-14088.22"/>
</g>
<!-- layer_6_qkv_gpu3&#45;&gt;layer_6_allgather_qkv -->
<g id="edge374" class="edge">
<title>layer_6_qkv_gpu3&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M2528,-14119.05C2528,-14111.16 2528,-14102.27 2528,-14093.69"/>
<polygon fill="black" stroke="black" points="2531.5,-14093.46 2528,-14083.46 2524.5,-14093.46 2531.5,-14093.46"/>
</g>
<!-- layer_6_qkv_gpu4&#45;&gt;layer_6_allgather_qkv -->
<g id="edge375" class="edge">
<title>layer_6_qkv_gpu4&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M2607.78,-14119.28C2594.71,-14108.8 2579.39,-14096.52 2565.69,-14085.53"/>
<polygon fill="black" stroke="black" points="2567.83,-14082.76 2557.83,-14079.24 2563.45,-14088.22 2567.83,-14082.76"/>
</g>
<!-- layer_6_qkv_gpu5&#45;&gt;layer_6_allgather_qkv -->
<g id="edge376" class="edge">
<title>layer_6_qkv_gpu5&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M2703.28,-14122.84C2700.48,-14121.63 2697.71,-14120.44 2695,-14119.31 2657.98,-14103.82 2615.78,-14087.66 2583.06,-14075.46"/>
<polygon fill="black" stroke="black" points="2584.25,-14072.17 2573.66,-14071.96 2581.81,-14078.73 2584.25,-14072.17"/>
</g>
<!-- layer_6_qkv_gpu6&#45;&gt;layer_6_allgather_qkv -->
<g id="edge377" class="edge">
<title>layer_6_qkv_gpu6&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M2814.45,-14122.38C2811.61,-14121.29 2808.78,-14120.25 2806,-14119.31 2734.2,-14095 2648.88,-14076.89 2591.87,-14066.25"/>
<polygon fill="black" stroke="black" points="2592.39,-14062.78 2581.92,-14064.41 2591.12,-14069.67 2592.39,-14062.78"/>
</g>
<!-- layer_6_qkv_gpu7&#45;&gt;layer_6_allgather_qkv -->
<g id="edge378" class="edge">
<title>layer_6_qkv_gpu7&#45;&gt;layer_6_allgather_qkv</title>
<path fill="none" stroke="black" d="M2925.21,-14122.06C2922.46,-14121.06 2919.71,-14120.13 2917,-14119.31 2806.69,-14085.81 2673.14,-14068.69 2594.68,-14060.9"/>
<polygon fill="black" stroke="black" points="2594.75,-14057.39 2584.45,-14059.91 2594.07,-14064.36 2594.75,-14057.39"/>
</g>
<!-- layer_6_attention -->
<g id="node276" class="node">
<title>layer_6_attention</title>
<polygon fill="lightblue" stroke="black" points="2488,-13989.33 2420,-13989.33 2420,-13937.33 2488,-13937.33 2488,-13989.33"/>
<text text-anchor="middle" x="2454" y="-13977.33" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="2454" y="-13966.33" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="2454" y="-13955.33" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="2454" y="-13944.33" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_6_allgather_qkv&#45;&gt;layer_6_attention -->
<g id="edge379" class="edge">
<title>layer_6_allgather_qkv&#45;&gt;layer_6_attention</title>
<path fill="none" stroke="black" d="M2506.2,-14027.1C2498.39,-14017.71 2489.5,-14007.02 2481.29,-13997.14"/>
<polygon fill="black" stroke="black" points="2483.97,-13994.89 2474.88,-13989.44 2478.59,-13999.37 2483.97,-13994.89"/>
</g>
<!-- layer_6_attn_out_gpu7 -->
<g id="node284" class="node">
<title>layer_6_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2351,-13901.33 2263,-13901.33 2263,-13849.33 2351,-13849.33 2351,-13901.33"/>
<text text-anchor="middle" x="2307" y="-13889.33" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="2307" y="-13878.33" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2307" y="-13867.33" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2307" y="-13856.33" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attention&#45;&gt;layer_6_attn_out_gpu7 -->
<g id="edge380" class="edge">
<title>layer_6_attention&#45;&gt;layer_6_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M2419.91,-13942.38C2401.73,-13931.75 2378.99,-13918.45 2358.69,-13906.57"/>
<polygon fill="black" stroke="black" points="2360.26,-13903.43 2349.86,-13901.4 2356.73,-13909.48 2360.26,-13903.43"/>
</g>
<!-- layer_6_attn_out_gpu0 -->
<g id="node277" class="node">
<title>layer_6_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2457,-13901.33 2369,-13901.33 2369,-13849.33 2457,-13849.33 2457,-13901.33"/>
<text text-anchor="middle" x="2413" y="-13889.33" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="2413" y="-13878.33" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2413" y="-13867.33" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2413" y="-13856.33" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_allreduce_attn -->
<g id="node285" class="node">
<title>layer_6_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="2731" cy="-13784.34" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="2731" y="-13792.84" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="2731" y="-13781.84" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="2731" y="-13770.84" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_6_attn_out_gpu0&#45;&gt;layer_6_allreduce_attn -->
<g id="edge381" class="edge">
<title>layer_6_attn_out_gpu0&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M2457.26,-13852.65C2460.19,-13851.46 2463.12,-13850.34 2466,-13849.33 2533.13,-13825.67 2612.84,-13807.72 2667.19,-13796.94"/>
<polygon fill="black" stroke="black" points="2667.89,-13800.37 2677.03,-13795.01 2666.54,-13793.5 2667.89,-13800.37"/>
</g>
<!-- layer_6_attn_out_gpu1 -->
<g id="node278" class="node">
<title>layer_6_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2563,-13901.33 2475,-13901.33 2475,-13849.33 2563,-13849.33 2563,-13901.33"/>
<text text-anchor="middle" x="2519" y="-13889.33" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="2519" y="-13878.33" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2519" y="-13867.33" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2519" y="-13856.33" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attn_out_gpu1&#45;&gt;layer_6_allreduce_attn -->
<g id="edge382" class="edge">
<title>layer_6_attn_out_gpu1&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M2563.16,-13853.26C2566.14,-13851.91 2569.11,-13850.59 2572,-13849.33 2606.33,-13834.34 2645.34,-13818.62 2676.13,-13806.51"/>
<polygon fill="black" stroke="black" points="2677.79,-13809.62 2685.82,-13802.71 2675.23,-13803.1 2677.79,-13809.62"/>
</g>
<!-- layer_6_attn_out_gpu2 -->
<g id="node279" class="node">
<title>layer_6_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2669,-13901.33 2581,-13901.33 2581,-13849.33 2669,-13849.33 2669,-13901.33"/>
<text text-anchor="middle" x="2625" y="-13889.33" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="2625" y="-13878.33" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2625" y="-13867.33" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2625" y="-13856.33" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attn_out_gpu2&#45;&gt;layer_6_allreduce_attn -->
<g id="edge383" class="edge">
<title>layer_6_attn_out_gpu2&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M2654.81,-13849.3C2667.08,-13839 2681.42,-13826.96 2694.33,-13816.13"/>
<polygon fill="black" stroke="black" points="2696.74,-13818.67 2702.15,-13809.56 2692.24,-13813.31 2696.74,-13818.67"/>
</g>
<!-- layer_6_attn_out_gpu3 -->
<g id="node280" class="node">
<title>layer_6_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2775,-13901.33 2687,-13901.33 2687,-13849.33 2775,-13849.33 2775,-13901.33"/>
<text text-anchor="middle" x="2731" y="-13889.33" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="2731" y="-13878.33" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="2731" y="-13867.33" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2731" y="-13856.33" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attn_out_gpu3&#45;&gt;layer_6_allreduce_attn -->
<g id="edge384" class="edge">
<title>layer_6_attn_out_gpu3&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M2731,-13849.06C2731,-13841.17 2731,-13832.28 2731,-13823.7"/>
<polygon fill="black" stroke="black" points="2734.5,-13823.48 2731,-13813.48 2727.5,-13823.48 2734.5,-13823.48"/>
</g>
<!-- layer_6_attn_out_gpu4 -->
<g id="node281" class="node">
<title>layer_6_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2881,-13901.33 2793,-13901.33 2793,-13849.33 2881,-13849.33 2881,-13901.33"/>
<text text-anchor="middle" x="2837" y="-13889.33" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="2837" y="-13878.33" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2837" y="-13867.33" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2837" y="-13856.33" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attn_out_gpu4&#45;&gt;layer_6_allreduce_attn -->
<g id="edge385" class="edge">
<title>layer_6_attn_out_gpu4&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M2807.19,-13849.3C2794.92,-13839 2780.58,-13826.96 2767.67,-13816.13"/>
<polygon fill="black" stroke="black" points="2769.76,-13813.31 2759.85,-13809.56 2765.26,-13818.67 2769.76,-13813.31"/>
</g>
<!-- layer_6_attn_out_gpu5 -->
<g id="node282" class="node">
<title>layer_6_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2987,-13901.33 2899,-13901.33 2899,-13849.33 2987,-13849.33 2987,-13901.33"/>
<text text-anchor="middle" x="2943" y="-13889.33" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="2943" y="-13878.33" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2943" y="-13867.33" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2943" y="-13856.33" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attn_out_gpu5&#45;&gt;layer_6_allreduce_attn -->
<g id="edge386" class="edge">
<title>layer_6_attn_out_gpu5&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M2898.84,-13853.26C2895.86,-13851.91 2892.89,-13850.59 2890,-13849.33 2855.67,-13834.34 2816.66,-13818.62 2785.87,-13806.51"/>
<polygon fill="black" stroke="black" points="2786.77,-13803.1 2776.18,-13802.71 2784.21,-13809.62 2786.77,-13803.1"/>
</g>
<!-- layer_6_attn_out_gpu6 -->
<g id="node283" class="node">
<title>layer_6_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="3093,-13901.33 3005,-13901.33 3005,-13849.33 3093,-13849.33 3093,-13901.33"/>
<text text-anchor="middle" x="3049" y="-13889.33" font-family="Arial" font-size="10.00">Layer 6 Attn Out</text>
<text text-anchor="middle" x="3049" y="-13878.33" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3049" y="-13867.33" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3049" y="-13856.33" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_6_attn_out_gpu6&#45;&gt;layer_6_allreduce_attn -->
<g id="edge387" class="edge">
<title>layer_6_attn_out_gpu6&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M3004.74,-13852.65C3001.81,-13851.46 2998.88,-13850.34 2996,-13849.33 2928.87,-13825.67 2849.16,-13807.72 2794.81,-13796.94"/>
<polygon fill="black" stroke="black" points="2795.46,-13793.5 2784.97,-13795.01 2794.11,-13800.37 2795.46,-13793.5"/>
</g>
<!-- layer_6_attn_out_gpu7&#45;&gt;layer_6_allreduce_attn -->
<g id="edge388" class="edge">
<title>layer_6_attn_out_gpu7&#45;&gt;layer_6_allreduce_attn</title>
<path fill="none" stroke="black" d="M2351.18,-13852.43C2354.13,-13851.29 2357.09,-13850.25 2360,-13849.33 2463.43,-13816.68 2588.66,-13799.47 2663.97,-13791.4"/>
<polygon fill="black" stroke="black" points="2664.67,-13794.84 2674.25,-13790.32 2663.94,-13787.88 2664.67,-13794.84"/>
</g>
<!-- layer_6_allreduce_attn&#45;&gt;layer_6_residual1 -->
<g id="edge389" class="edge">
<title>layer_6_allreduce_attn&#45;&gt;layer_6_residual1</title>
<path fill="none" stroke="black" d="M2772.35,-13763.62C2800.12,-13750.38 2837.09,-13732.74 2867.81,-13718.1"/>
<polygon fill="black" stroke="black" points="2869.6,-13721.12 2877.12,-13713.65 2866.59,-13714.8 2869.6,-13721.12"/>
</g>
<!-- layer_6_ln1 -->
<g id="node287" class="node">
<title>layer_6_ln1</title>
<polygon fill="lightblue" stroke="black" points="2757.5,-13623.34 2684.5,-13623.34 2684.5,-13582.34 2757.5,-13582.34 2757.5,-13623.34"/>
<text text-anchor="middle" x="2721" y="-13611.34" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="2721" y="-13600.34" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="2721" y="-13589.34" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_6_residual1&#45;&gt;layer_6_ln1 -->
<g id="edge391" class="edge">
<title>layer_6_residual1&#45;&gt;layer_6_ln1</title>
<path fill="none" stroke="black" d="M2855.45,-13659.26C2826.16,-13647.19 2792.99,-13633.52 2766.93,-13622.78"/>
<polygon fill="black" stroke="black" points="2768.25,-13619.54 2757.67,-13618.96 2765.58,-13626.01 2768.25,-13619.54"/>
</g>
<!-- layer_6_residual2 -->
<g id="node307" class="node">
<title>layer_6_residual2</title>
<polygon fill="lightyellow" stroke="black" points="3086.94,-13110.38 2964.55,-13110.38 2933.06,-13050.38 3055.45,-13050.38 3086.94,-13110.38"/>
<text text-anchor="middle" x="3010" y="-13083.38" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="3010" y="-13072.38" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_6_residual1&#45;&gt;layer_6_residual2 -->
<g id="edge419" class="edge">
<title>layer_6_residual1&#45;&gt;layer_6_residual2</title>
<path fill="none" stroke="black" d="M2983.29,-13681.29C3067.81,-13667.32 3216,-13627.67 3216,-13521.34 3216,-13521.34 3216,-13521.34 3216,-13265.36 3216,-13195.15 3148.61,-13145.07 3090.92,-13115.06"/>
<polygon fill="black" stroke="black" points="3092.26,-13111.81 3081.76,-13110.42 3089.1,-13118.06 3092.26,-13111.81"/>
</g>
<!-- layer_6_mlp_fc1_gpu0 -->
<g id="node288" class="node">
<title>layer_6_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2320,-13546.34 2226,-13546.34 2226,-13494.34 2320,-13494.34 2320,-13546.34"/>
<text text-anchor="middle" x="2273" y="-13534.34" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="2273" y="-13523.34" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2273" y="-13512.34" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2273" y="-13501.34" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu0 -->
<g id="edge392" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M2684.35,-13600.07C2615.78,-13596.01 2463.67,-13583.59 2329.63,-13546.18"/>
<polygon fill="black" stroke="black" points="2330.58,-13542.81 2320.01,-13543.44 2328.67,-13549.54 2330.58,-13542.81"/>
</g>
<!-- layer_6_mlp_fc1_gpu1 -->
<g id="node289" class="node">
<title>layer_6_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2432,-13546.34 2338,-13546.34 2338,-13494.34 2432,-13494.34 2432,-13546.34"/>
<text text-anchor="middle" x="2385" y="-13534.34" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="2385" y="-13523.34" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2385" y="-13512.34" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2385" y="-13501.34" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu1 -->
<g id="edge393" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M2684.1,-13597.22C2631.76,-13590.08 2533.05,-13574.48 2441.73,-13546.29"/>
<polygon fill="black" stroke="black" points="2442.66,-13542.91 2432.07,-13543.25 2440.55,-13549.59 2442.66,-13542.91"/>
</g>
<!-- layer_6_mlp_fc1_gpu2 -->
<g id="node290" class="node">
<title>layer_6_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2544,-13546.34 2450,-13546.34 2450,-13494.34 2544,-13494.34 2544,-13546.34"/>
<text text-anchor="middle" x="2497" y="-13534.34" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="2497" y="-13523.34" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2497" y="-13512.34" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2497" y="-13501.34" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu2 -->
<g id="edge394" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M2684.25,-13590.88C2651.97,-13580.98 2603.62,-13565.54 2553.58,-13546.43"/>
<polygon fill="black" stroke="black" points="2554.8,-13543.16 2544.22,-13542.82 2552.29,-13549.69 2554.8,-13543.16"/>
</g>
<!-- layer_6_mlp_fc1_gpu3 -->
<g id="node291" class="node">
<title>layer_6_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2656,-13546.34 2562,-13546.34 2562,-13494.34 2656,-13494.34 2656,-13546.34"/>
<text text-anchor="middle" x="2609" y="-13534.34" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="2609" y="-13523.34" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="2609" y="-13512.34" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2609" y="-13501.34" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu3 -->
<g id="edge395" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M2693.6,-13582.15C2681.27,-13573.29 2666.4,-13562.6 2652.59,-13552.68"/>
<polygon fill="black" stroke="black" points="2654.33,-13549.62 2644.17,-13546.62 2650.24,-13555.3 2654.33,-13549.62"/>
</g>
<!-- layer_6_mlp_fc1_gpu4 -->
<g id="node292" class="node">
<title>layer_6_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2768,-13546.34 2674,-13546.34 2674,-13494.34 2768,-13494.34 2768,-13546.34"/>
<text text-anchor="middle" x="2721" y="-13534.34" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="2721" y="-13523.34" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2721" y="-13512.34" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2721" y="-13501.34" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu4 -->
<g id="edge396" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M2721,-13581.95C2721,-13574.33 2721,-13565.4 2721,-13556.77"/>
<polygon fill="black" stroke="black" points="2724.5,-13556.5 2721,-13546.5 2717.5,-13556.5 2724.5,-13556.5"/>
</g>
<!-- layer_6_mlp_fc1_gpu5 -->
<g id="node293" class="node">
<title>layer_6_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2880,-13546.34 2786,-13546.34 2786,-13494.34 2880,-13494.34 2880,-13546.34"/>
<text text-anchor="middle" x="2833" y="-13534.34" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="2833" y="-13523.34" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="2833" y="-13512.34" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="2833" y="-13501.34" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu5 -->
<g id="edge397" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M2748.4,-13582.15C2760.73,-13573.29 2775.6,-13562.6 2789.41,-13552.68"/>
<polygon fill="black" stroke="black" points="2791.76,-13555.3 2797.83,-13546.62 2787.67,-13549.62 2791.76,-13555.3"/>
</g>
<!-- layer_6_mlp_fc1_gpu6 -->
<g id="node294" class="node">
<title>layer_6_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2992,-13546.34 2898,-13546.34 2898,-13494.34 2992,-13494.34 2992,-13546.34"/>
<text text-anchor="middle" x="2945" y="-13534.34" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="2945" y="-13523.34" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2945" y="-13512.34" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="2945" y="-13501.34" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu6 -->
<g id="edge398" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M2757.75,-13590.88C2790.03,-13580.98 2838.38,-13565.54 2888.42,-13546.43"/>
<polygon fill="black" stroke="black" points="2889.71,-13549.69 2897.78,-13542.82 2887.2,-13543.16 2889.71,-13549.69"/>
</g>
<!-- layer_6_mlp_fc1_gpu7 -->
<g id="node295" class="node">
<title>layer_6_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3104,-13546.34 3010,-13546.34 3010,-13494.34 3104,-13494.34 3104,-13546.34"/>
<text text-anchor="middle" x="3057" y="-13534.34" font-family="Arial" font-size="10.00">Layer 6 MLP FC1</text>
<text text-anchor="middle" x="3057" y="-13523.34" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3057" y="-13512.34" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3057" y="-13501.34" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu7 -->
<g id="edge399" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M2757.9,-13597.22C2810.24,-13590.08 2908.95,-13574.48 3000.27,-13546.29"/>
<polygon fill="black" stroke="black" points="3001.45,-13549.59 3009.93,-13543.25 2999.34,-13542.91 3001.45,-13549.59"/>
</g>
<!-- layer_6_allgather_mlp -->
<g id="node296" class="node">
<title>layer_6_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="2609" cy="-13429.35" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="2609" y="-13437.85" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="2609" y="-13426.85" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="2609" y="-13415.85" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_6_mlp_fc1_gpu0&#45;&gt;layer_6_allgather_mlp -->
<g id="edge400" class="edge">
<title>layer_6_mlp_fc1_gpu0&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M2320.1,-13497.54C2323.09,-13496.4 2326.07,-13495.32 2329,-13494.34 2401.84,-13470.02 2488.37,-13451.81 2545.76,-13441.15"/>
<polygon fill="black" stroke="black" points="2546.57,-13444.56 2555.78,-13439.31 2545.31,-13437.68 2546.57,-13444.56"/>
</g>
<!-- layer_6_mlp_fc1_gpu1&#45;&gt;layer_6_allgather_mlp -->
<g id="edge401" class="edge">
<title>layer_6_mlp_fc1_gpu1&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M2432.28,-13498.02C2435.22,-13496.76 2438.15,-13495.52 2441,-13494.34 2478.41,-13478.88 2521.04,-13462.66 2553.99,-13450.42"/>
<polygon fill="black" stroke="black" points="2555.29,-13453.67 2563.45,-13446.92 2552.86,-13447.11 2555.29,-13453.67"/>
</g>
<!-- layer_6_mlp_fc1_gpu2&#45;&gt;layer_6_allgather_mlp -->
<g id="edge402" class="edge">
<title>layer_6_mlp_fc1_gpu2&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M2528.5,-13494.32C2541.69,-13483.83 2557.15,-13471.55 2570.98,-13460.57"/>
<polygon fill="black" stroke="black" points="2573.24,-13463.23 2578.9,-13454.27 2568.89,-13457.75 2573.24,-13463.23"/>
</g>
<!-- layer_6_mlp_fc1_gpu3&#45;&gt;layer_6_allgather_mlp -->
<g id="edge403" class="edge">
<title>layer_6_mlp_fc1_gpu3&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M2609,-13494.08C2609,-13486.19 2609,-13477.3 2609,-13468.72"/>
<polygon fill="black" stroke="black" points="2612.5,-13468.5 2609,-13458.5 2605.5,-13468.5 2612.5,-13468.5"/>
</g>
<!-- layer_6_mlp_fc1_gpu4&#45;&gt;layer_6_allgather_mlp -->
<g id="edge404" class="edge">
<title>layer_6_mlp_fc1_gpu4&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M2689.5,-13494.32C2676.31,-13483.83 2660.85,-13471.55 2647.02,-13460.57"/>
<polygon fill="black" stroke="black" points="2649.11,-13457.75 2639.1,-13454.27 2644.76,-13463.23 2649.11,-13457.75"/>
</g>
<!-- layer_6_mlp_fc1_gpu5&#45;&gt;layer_6_allgather_mlp -->
<g id="edge405" class="edge">
<title>layer_6_mlp_fc1_gpu5&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M2785.72,-13498.02C2782.78,-13496.76 2779.85,-13495.52 2777,-13494.34 2739.59,-13478.88 2696.96,-13462.66 2664.01,-13450.42"/>
<polygon fill="black" stroke="black" points="2665.14,-13447.11 2654.55,-13446.92 2662.71,-13453.67 2665.14,-13447.11"/>
</g>
<!-- layer_6_mlp_fc1_gpu6&#45;&gt;layer_6_allgather_mlp -->
<g id="edge406" class="edge">
<title>layer_6_mlp_fc1_gpu6&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M2897.9,-13497.54C2894.91,-13496.4 2891.93,-13495.32 2889,-13494.34 2816.16,-13470.02 2729.63,-13451.81 2672.24,-13441.15"/>
<polygon fill="black" stroke="black" points="2672.69,-13437.68 2662.22,-13439.31 2671.43,-13444.56 2672.69,-13437.68"/>
</g>
<!-- layer_6_mlp_fc1_gpu7&#45;&gt;layer_6_allgather_mlp -->
<g id="edge407" class="edge">
<title>layer_6_mlp_fc1_gpu7&#45;&gt;layer_6_allgather_mlp</title>
<path fill="none" stroke="black" d="M3009.97,-13497.32C3006.96,-13496.24 3003.96,-13495.23 3001,-13494.34 2889.1,-13460.85 2753.65,-13443.66 2674.82,-13435.87"/>
<polygon fill="black" stroke="black" points="2674.84,-13432.35 2664.55,-13434.87 2674.16,-13439.32 2674.84,-13432.35"/>
</g>
<!-- layer_6_gelu -->
<g id="node297" class="node">
<title>layer_6_gelu</title>
<polygon fill="lightblue" stroke="black" points="2485.5,-13364.36 2396.5,-13364.36 2396.5,-13328.36 2485.5,-13328.36 2485.5,-13364.36"/>
<text text-anchor="middle" x="2441" y="-13349.36" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="2441" y="-13338.36" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_6_allgather_mlp&#45;&gt;layer_6_gelu -->
<g id="edge408" class="edge">
<title>layer_6_allgather_mlp&#45;&gt;layer_6_gelu</title>
<path fill="none" stroke="black" d="M2568.76,-13408.95C2543.69,-13396.87 2511.4,-13381.3 2485.56,-13368.84"/>
<polygon fill="black" stroke="black" points="2486.88,-13365.59 2476.35,-13364.4 2483.84,-13371.9 2486.88,-13365.59"/>
</g>
<!-- layer_6_mlp_fc2_gpu7 -->
<g id="node305" class="node">
<title>layer_6_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2404,-13292.36 2310,-13292.36 2310,-13240.36 2404,-13240.36 2404,-13292.36"/>
<text text-anchor="middle" x="2357" y="-13280.36" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="2357" y="-13269.36" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2357" y="-13258.36" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2357" y="-13247.36" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu7 -->
<g id="edge409" class="edge">
<title>layer_6_gelu&#45;&gt;layer_6_mlp_fc2_gpu7</title>
<path fill="none" stroke="black" d="M2422.36,-13328.05C2413.33,-13319.67 2402.2,-13309.34 2391.7,-13299.58"/>
<polygon fill="black" stroke="black" points="2393.91,-13296.86 2384.2,-13292.62 2389.15,-13301.99 2393.91,-13296.86"/>
</g>
<!-- layer_6_mlp_fc2_gpu0 -->
<g id="node298" class="node">
<title>layer_6_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2516,-13292.36 2422,-13292.36 2422,-13240.36 2516,-13240.36 2516,-13292.36"/>
<text text-anchor="middle" x="2469" y="-13280.36" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="2469" y="-13269.36" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2469" y="-13258.36" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2469" y="-13247.36" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_allreduce_mlp -->
<g id="node306" class="node">
<title>layer_6_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="2805" cy="-13175.37" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="2805" y="-13183.87" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="2805" y="-13172.87" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="2805" y="-13161.87" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_6_mlp_fc2_gpu0&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge410" class="edge">
<title>layer_6_mlp_fc2_gpu0&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2516.1,-13243.56C2519.09,-13242.42 2522.07,-13241.34 2525,-13240.36 2596.61,-13216.45 2681.46,-13198.44 2738.84,-13187.71"/>
<polygon fill="black" stroke="black" points="2739.67,-13191.12 2748.87,-13185.86 2738.4,-13184.23 2739.67,-13191.12"/>
</g>
<!-- layer_6_mlp_fc2_gpu1 -->
<g id="node299" class="node">
<title>layer_6_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2628,-13292.36 2534,-13292.36 2534,-13240.36 2628,-13240.36 2628,-13292.36"/>
<text text-anchor="middle" x="2581" y="-13280.36" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="2581" y="-13269.36" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2581" y="-13258.36" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2581" y="-13247.36" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_mlp_fc2_gpu1&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge411" class="edge">
<title>layer_6_mlp_fc2_gpu1&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2628.28,-13244.03C2631.22,-13242.77 2634.15,-13241.54 2637,-13240.36 2673.89,-13225.12 2715.84,-13209.14 2748.6,-13196.96"/>
<polygon fill="black" stroke="black" points="2749.85,-13200.22 2758.01,-13193.47 2747.42,-13193.66 2749.85,-13200.22"/>
</g>
<!-- layer_6_mlp_fc2_gpu2 -->
<g id="node300" class="node">
<title>layer_6_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2740,-13292.36 2646,-13292.36 2646,-13240.36 2740,-13240.36 2740,-13292.36"/>
<text text-anchor="middle" x="2693" y="-13280.36" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="2693" y="-13269.36" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2693" y="-13258.36" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2693" y="-13247.36" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_mlp_fc2_gpu2&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge412" class="edge">
<title>layer_6_mlp_fc2_gpu2&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2724.5,-13240.34C2737.59,-13229.94 2752.9,-13217.77 2766.64,-13206.85"/>
<polygon fill="black" stroke="black" points="2768.86,-13209.56 2774.51,-13200.6 2764.51,-13204.08 2768.86,-13209.56"/>
</g>
<!-- layer_6_mlp_fc2_gpu3 -->
<g id="node301" class="node">
<title>layer_6_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2852,-13292.36 2758,-13292.36 2758,-13240.36 2852,-13240.36 2852,-13292.36"/>
<text text-anchor="middle" x="2805" y="-13280.36" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="2805" y="-13269.36" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="2805" y="-13258.36" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2805" y="-13247.36" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_mlp_fc2_gpu3&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge413" class="edge">
<title>layer_6_mlp_fc2_gpu3&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2805,-13240.1C2805,-13232.21 2805,-13223.32 2805,-13214.74"/>
<polygon fill="black" stroke="black" points="2808.5,-13214.51 2805,-13204.51 2801.5,-13214.51 2808.5,-13214.51"/>
</g>
<!-- layer_6_mlp_fc2_gpu4 -->
<g id="node302" class="node">
<title>layer_6_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2964,-13292.36 2870,-13292.36 2870,-13240.36 2964,-13240.36 2964,-13292.36"/>
<text text-anchor="middle" x="2917" y="-13280.36" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="2917" y="-13269.36" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="2917" y="-13258.36" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="2917" y="-13247.36" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_mlp_fc2_gpu4&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge414" class="edge">
<title>layer_6_mlp_fc2_gpu4&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2885.5,-13240.34C2872.41,-13229.94 2857.1,-13217.77 2843.36,-13206.85"/>
<polygon fill="black" stroke="black" points="2845.49,-13204.08 2835.49,-13200.6 2841.14,-13209.56 2845.49,-13204.08"/>
</g>
<!-- layer_6_mlp_fc2_gpu5 -->
<g id="node303" class="node">
<title>layer_6_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3076,-13292.36 2982,-13292.36 2982,-13240.36 3076,-13240.36 3076,-13292.36"/>
<text text-anchor="middle" x="3029" y="-13280.36" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="3029" y="-13269.36" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="3029" y="-13258.36" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3029" y="-13247.36" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_mlp_fc2_gpu5&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge415" class="edge">
<title>layer_6_mlp_fc2_gpu5&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2981.72,-13244.03C2978.78,-13242.77 2975.85,-13241.54 2973,-13240.36 2936.11,-13225.12 2894.16,-13209.14 2861.4,-13196.96"/>
<polygon fill="black" stroke="black" points="2862.58,-13193.66 2851.99,-13193.47 2860.15,-13200.22 2862.58,-13193.66"/>
</g>
<!-- layer_6_mlp_fc2_gpu6 -->
<g id="node304" class="node">
<title>layer_6_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="3188,-13292.36 3094,-13292.36 3094,-13240.36 3188,-13240.36 3188,-13292.36"/>
<text text-anchor="middle" x="3141" y="-13280.36" font-family="Arial" font-size="10.00">Layer 6 MLP FC2</text>
<text text-anchor="middle" x="3141" y="-13269.36" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3141" y="-13258.36" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3141" y="-13247.36" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_6_mlp_fc2_gpu6&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge416" class="edge">
<title>layer_6_mlp_fc2_gpu6&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3093.9,-13243.56C3090.91,-13242.42 3087.93,-13241.34 3085,-13240.36 3013.39,-13216.45 2928.54,-13198.44 2871.16,-13187.71"/>
<polygon fill="black" stroke="black" points="2871.6,-13184.23 2861.13,-13185.86 2870.33,-13191.12 2871.6,-13184.23"/>
</g>
<!-- layer_6_mlp_fc2_gpu7&#45;&gt;layer_6_allreduce_mlp -->
<g id="edge417" class="edge">
<title>layer_6_mlp_fc2_gpu7&#45;&gt;layer_6_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2404.03,-13243.34C2407.04,-13242.25 2410.04,-13241.25 2413,-13240.36 2523.16,-13207.39 2656.15,-13190.22 2735.47,-13182.26"/>
<polygon fill="black" stroke="black" points="2736.21,-13185.7 2745.82,-13181.24 2735.53,-13178.73 2736.21,-13185.7"/>
</g>
<!-- layer_6_allreduce_mlp&#45;&gt;layer_6_residual2 -->
<g id="edge418" class="edge">
<title>layer_6_allreduce_mlp&#45;&gt;layer_6_residual2</title>
<path fill="none" stroke="black" d="M2847.97,-13154.88C2878,-13141.26 2918.46,-13122.9 2951.43,-13107.95"/>
<polygon fill="black" stroke="black" points="2953.3,-13110.94 2960.96,-13103.62 2950.41,-13104.57 2953.3,-13110.94"/>
</g>
<!-- layer_6_ln2 -->
<g id="node308" class="node">
<title>layer_6_ln2</title>
<polygon fill="lightblue" stroke="black" points="3046.5,-13014.38 2973.5,-13014.38 2973.5,-12973.38 3046.5,-12973.38 3046.5,-13014.38"/>
<text text-anchor="middle" x="3010" y="-13002.38" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="3010" y="-12991.38" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="3010" y="-12980.38" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_6_residual2&#45;&gt;layer_6_ln2 -->
<g id="edge420" class="edge">
<title>layer_6_residual2&#45;&gt;layer_6_ln2</title>
<path fill="none" stroke="black" d="M3010,-13050.3C3010,-13041.97 3010,-13032.89 3010,-13024.53"/>
<polygon fill="black" stroke="black" points="3013.5,-13024.44 3010,-13014.44 3006.5,-13024.44 3013.5,-13024.44"/>
</g>
<!-- layer_6_output_dist -->
<g id="node309" class="node">
<title>layer_6_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="3111.7,-12937.38 2949.92,-12937.38 2908.3,-12877.38 3070.08,-12877.38 3111.7,-12937.38"/>
<text text-anchor="middle" x="3010" y="-12910.38" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="3010" y="-12899.38" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_6_ln2&#45;&gt;layer_6_output_dist -->
<g id="edge421" class="edge">
<title>layer_6_ln2&#45;&gt;layer_6_output_dist</title>
<path fill="none" stroke="black" d="M3010,-12973.28C3010,-12965.64 3010,-12956.6 3010,-12947.73"/>
<polygon fill="black" stroke="black" points="3013.5,-12947.49 3010,-12937.49 3006.5,-12947.49 3013.5,-12947.49"/>
</g>
<!-- layer_7_input_dist -->
<g id="node310" class="node">
<title>layer_7_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="3104.19,-12841.38 2954.36,-12841.38 2915.81,-12781.38 3065.64,-12781.38 3104.19,-12841.38"/>
<text text-anchor="middle" x="3010" y="-12814.38" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="3010" y="-12803.38" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_6_output_dist&#45;&gt;layer_7_input_dist -->
<g id="edge422" class="edge">
<title>layer_6_output_dist&#45;&gt;layer_7_input_dist</title>
<path fill="none" stroke="black" d="M3010,-12877.15C3010,-12869.11 3010,-12860.24 3010,-12851.73"/>
<polygon fill="black" stroke="black" points="3013.5,-12851.59 3010,-12841.59 3006.5,-12851.59 3013.5,-12851.59"/>
</g>
<!-- layer_7_qkv_gpu0 -->
<g id="node311" class="node">
<title>layer_7_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2612.5,-12745.38 2519.5,-12745.38 2519.5,-12693.38 2612.5,-12693.38 2612.5,-12745.38"/>
<text text-anchor="middle" x="2566" y="-12733.38" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="2566" y="-12722.38" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2566" y="-12711.38" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2566" y="-12700.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu0 -->
<g id="edge423" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu0</title>
<path fill="none" stroke="black" d="M2929.5,-12802.92C2852.32,-12794.41 2732.81,-12777.67 2622.36,-12745.16"/>
<polygon fill="black" stroke="black" points="2623.31,-12741.79 2612.72,-12742.27 2621.3,-12748.49 2623.31,-12741.79"/>
</g>
<!-- layer_7_qkv_gpu1 -->
<g id="node312" class="node">
<title>layer_7_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2723.5,-12745.38 2630.5,-12745.38 2630.5,-12693.38 2723.5,-12693.38 2723.5,-12745.38"/>
<text text-anchor="middle" x="2677" y="-12733.38" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="2677" y="-12722.38" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2677" y="-12711.38" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2677" y="-12700.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu1 -->
<g id="edge424" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu1</title>
<path fill="none" stroke="black" d="M2924.28,-12794.63C2871.43,-12783.91 2802.37,-12768.07 2733.51,-12745.3"/>
<polygon fill="black" stroke="black" points="2734.39,-12741.91 2723.8,-12742.04 2732.16,-12748.54 2734.39,-12741.91"/>
</g>
<!-- layer_7_qkv_gpu2 -->
<g id="node313" class="node">
<title>layer_7_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2834.5,-12745.38 2741.5,-12745.38 2741.5,-12693.38 2834.5,-12693.38 2834.5,-12745.38"/>
<text text-anchor="middle" x="2788" y="-12733.38" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="2788" y="-12722.38" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2788" y="-12711.38" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2788" y="-12700.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu2 -->
<g id="edge425" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu2</title>
<path fill="none" stroke="black" d="M2933.67,-12781.35C2905.39,-12770.37 2873.12,-12757.57 2844,-12745.38 2843.9,-12745.34 2843.81,-12745.3 2843.71,-12745.26"/>
<polygon fill="black" stroke="black" points="2845.25,-12742.11 2834.68,-12741.41 2842.51,-12748.55 2845.25,-12742.11"/>
</g>
<!-- layer_7_qkv_gpu3 -->
<g id="node314" class="node">
<title>layer_7_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2945.5,-12745.38 2852.5,-12745.38 2852.5,-12693.38 2945.5,-12693.38 2945.5,-12745.38"/>
<text text-anchor="middle" x="2899" y="-12733.38" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="2899" y="-12722.38" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="2899" y="-12711.38" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2899" y="-12700.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu3 -->
<g id="edge426" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu3</title>
<path fill="none" stroke="black" d="M2973.96,-12781.16C2962.44,-12771.82 2949.64,-12761.44 2937.92,-12751.94"/>
<polygon fill="black" stroke="black" points="2939.98,-12749.1 2930.01,-12745.52 2935.58,-12754.54 2939.98,-12749.1"/>
</g>
<!-- layer_7_qkv_gpu4 -->
<g id="node315" class="node">
<title>layer_7_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3056.5,-12745.38 2963.5,-12745.38 2963.5,-12693.38 3056.5,-12693.38 3056.5,-12745.38"/>
<text text-anchor="middle" x="3010" y="-12733.38" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="3010" y="-12722.38" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="3010" y="-12711.38" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3010" y="-12700.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu4 -->
<g id="edge427" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu4</title>
<path fill="none" stroke="black" d="M3010,-12780.91C3010,-12772.84 3010,-12764 3010,-12755.64"/>
<polygon fill="black" stroke="black" points="3013.5,-12755.39 3010,-12745.39 3006.5,-12755.39 3013.5,-12755.39"/>
</g>
<!-- layer_7_qkv_gpu5 -->
<g id="node316" class="node">
<title>layer_7_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3167.5,-12745.38 3074.5,-12745.38 3074.5,-12693.38 3167.5,-12693.38 3167.5,-12745.38"/>
<text text-anchor="middle" x="3121" y="-12733.38" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="3121" y="-12722.38" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="3121" y="-12711.38" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3121" y="-12700.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu5 -->
<g id="edge428" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu5</title>
<path fill="none" stroke="black" d="M3046.04,-12781.16C3057.56,-12771.82 3070.36,-12761.44 3082.08,-12751.94"/>
<polygon fill="black" stroke="black" points="3084.42,-12754.54 3089.99,-12745.52 3080.02,-12749.1 3084.42,-12754.54"/>
</g>
<!-- layer_7_qkv_gpu6 -->
<g id="node317" class="node">
<title>layer_7_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="3278.5,-12745.38 3185.5,-12745.38 3185.5,-12693.38 3278.5,-12693.38 3278.5,-12745.38"/>
<text text-anchor="middle" x="3232" y="-12733.38" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="3232" y="-12722.38" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3232" y="-12711.38" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3232" y="-12700.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu6 -->
<g id="edge429" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu6</title>
<path fill="none" stroke="black" d="M3070.23,-12787.86C3099.83,-12776.58 3136.18,-12762.41 3175.92,-12745.77"/>
<polygon fill="black" stroke="black" points="3177.41,-12748.94 3185.27,-12741.83 3174.7,-12742.49 3177.41,-12748.94"/>
</g>
<!-- layer_7_qkv_gpu7 -->
<g id="node318" class="node">
<title>layer_7_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3389.5,-12745.38 3296.5,-12745.38 3296.5,-12693.38 3389.5,-12693.38 3389.5,-12745.38"/>
<text text-anchor="middle" x="3343" y="-12733.38" font-family="Arial" font-size="10.00">Layer 7 QKV Proj</text>
<text text-anchor="middle" x="3343" y="-12722.38" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3343" y="-12711.38" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3343" y="-12700.38" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_qkv_gpu7 -->
<g id="edge430" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_qkv_gpu7</title>
<path fill="none" stroke="black" d="M3076.75,-12798.61C3131.38,-12788.11 3210.57,-12770.91 3286.7,-12745.59"/>
<polygon fill="black" stroke="black" points="3288.09,-12748.81 3296.45,-12742.29 3285.85,-12742.18 3288.09,-12748.81"/>
</g>
<!-- layer_7_residual1 -->
<g id="node330" class="node">
<title>layer_7_residual1</title>
<polygon fill="lightyellow" stroke="black" points="3373.94,-12293.41 3251.55,-12293.41 3220.06,-12233.41 3342.45,-12233.41 3373.94,-12293.41"/>
<text text-anchor="middle" x="3297" y="-12266.41" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="3297" y="-12255.41" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_7_input_dist&#45;&gt;layer_7_residual1 -->
<g id="edge450" class="edge">
<title>layer_7_input_dist&#45;&gt;layer_7_residual1</title>
<path fill="none" stroke="black" d="M3080.87,-12804.61C3177.96,-12795.69 3346.28,-12776.29 3399,-12745.38 3456,-12711.96 3492,-12695.46 3492,-12629.39 3492,-12629.39 3492,-12629.39 3492,-12448.4 3492,-12379.62 3427.02,-12328.94 3372.09,-12298.38"/>
<polygon fill="black" stroke="black" points="3373.48,-12295.15 3363.02,-12293.46 3370.14,-12301.31 3373.48,-12295.15"/>
</g>
<!-- layer_7_allgather_qkv -->
<g id="node319" class="node">
<title>layer_7_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="2899" cy="-12628.39" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="2899" y="-12636.89" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="2899" y="-12625.89" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="2899" y="-12614.89" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_7_qkv_gpu0&#45;&gt;layer_7_allgather_qkv -->
<g id="edge431" class="edge">
<title>layer_7_qkv_gpu0&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M2612.79,-12696.7C2615.88,-12695.52 2618.97,-12694.39 2622,-12693.38 2693.63,-12669.37 2778.62,-12651.19 2835.4,-12640.46"/>
<polygon fill="black" stroke="black" points="2836.12,-12643.88 2845.31,-12638.61 2834.84,-12637 2836.12,-12643.88"/>
</g>
<!-- layer_7_qkv_gpu1&#45;&gt;layer_7_allgather_qkv -->
<g id="edge432" class="edge">
<title>layer_7_qkv_gpu1&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M2723.67,-12697.33C2726.82,-12695.97 2729.95,-12694.65 2733,-12693.38 2769.7,-12678.12 2811.45,-12662.04 2843.9,-12649.81"/>
<polygon fill="black" stroke="black" points="2845.53,-12652.94 2853.66,-12646.14 2843.06,-12646.38 2845.53,-12652.94"/>
</g>
<!-- layer_7_qkv_gpu2&#45;&gt;layer_7_allgather_qkv -->
<g id="edge433" class="edge">
<title>layer_7_qkv_gpu2&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M2819.22,-12693.35C2832.29,-12682.87 2847.61,-12670.58 2861.31,-12659.6"/>
<polygon fill="black" stroke="black" points="2863.55,-12662.29 2869.17,-12653.31 2859.17,-12656.83 2863.55,-12662.29"/>
</g>
<!-- layer_7_qkv_gpu3&#45;&gt;layer_7_allgather_qkv -->
<g id="edge434" class="edge">
<title>layer_7_qkv_gpu3&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M2899,-12693.12C2899,-12685.22 2899,-12676.33 2899,-12667.75"/>
<polygon fill="black" stroke="black" points="2902.5,-12667.53 2899,-12657.53 2895.5,-12667.53 2902.5,-12667.53"/>
</g>
<!-- layer_7_qkv_gpu4&#45;&gt;layer_7_allgather_qkv -->
<g id="edge435" class="edge">
<title>layer_7_qkv_gpu4&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M2978.78,-12693.35C2965.71,-12682.87 2950.39,-12670.58 2936.69,-12659.6"/>
<polygon fill="black" stroke="black" points="2938.83,-12656.83 2928.83,-12653.31 2934.45,-12662.29 2938.83,-12656.83"/>
</g>
<!-- layer_7_qkv_gpu5&#45;&gt;layer_7_allgather_qkv -->
<g id="edge436" class="edge">
<title>layer_7_qkv_gpu5&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M3074.28,-12696.91C3071.48,-12695.7 3068.71,-12694.51 3066,-12693.38 3028.98,-12677.89 2986.78,-12661.73 2954.06,-12649.53"/>
<polygon fill="black" stroke="black" points="2955.25,-12646.24 2944.66,-12646.03 2952.81,-12652.8 2955.25,-12646.24"/>
</g>
<!-- layer_7_qkv_gpu6&#45;&gt;layer_7_allgather_qkv -->
<g id="edge437" class="edge">
<title>layer_7_qkv_gpu6&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M3185.45,-12696.45C3182.61,-12695.36 3179.78,-12694.32 3177,-12693.38 3105.2,-12669.07 3019.88,-12650.95 2962.87,-12640.32"/>
<polygon fill="black" stroke="black" points="2963.39,-12636.85 2952.92,-12638.48 2962.12,-12643.74 2963.39,-12636.85"/>
</g>
<!-- layer_7_qkv_gpu7&#45;&gt;layer_7_allgather_qkv -->
<g id="edge438" class="edge">
<title>layer_7_qkv_gpu7&#45;&gt;layer_7_allgather_qkv</title>
<path fill="none" stroke="black" d="M3296.21,-12696.13C3293.46,-12695.13 3290.71,-12694.2 3288,-12693.38 3177.69,-12659.88 3044.14,-12642.76 2965.68,-12634.97"/>
<polygon fill="black" stroke="black" points="2965.75,-12631.46 2955.45,-12633.97 2965.07,-12638.43 2965.75,-12631.46"/>
</g>
<!-- layer_7_attention -->
<g id="node320" class="node">
<title>layer_7_attention</title>
<polygon fill="lightblue" stroke="black" points="2786,-12563.4 2718,-12563.4 2718,-12511.4 2786,-12511.4 2786,-12563.4"/>
<text text-anchor="middle" x="2752" y="-12551.4" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="2752" y="-12540.4" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="2752" y="-12529.4" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="2752" y="-12518.4" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_7_allgather_qkv&#45;&gt;layer_7_attention -->
<g id="edge439" class="edge">
<title>layer_7_allgather_qkv&#45;&gt;layer_7_attention</title>
<path fill="none" stroke="black" d="M2863.04,-12605.62C2842.42,-12593.14 2816.41,-12577.39 2794.75,-12564.28"/>
<polygon fill="black" stroke="black" points="2796.44,-12561.21 2786.07,-12559.02 2792.82,-12567.2 2796.44,-12561.21"/>
</g>
<!-- layer_7_attn_out_gpu7 -->
<g id="node328" class="node">
<title>layer_7_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2722,-12475.4 2634,-12475.4 2634,-12423.4 2722,-12423.4 2722,-12475.4"/>
<text text-anchor="middle" x="2678" y="-12463.4" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="2678" y="-12452.4" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2678" y="-12441.4" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2678" y="-12430.4" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attention&#45;&gt;layer_7_attn_out_gpu7 -->
<g id="edge440" class="edge">
<title>layer_7_attention&#45;&gt;layer_7_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M2730.2,-12511.06C2722.75,-12502.4 2714.3,-12492.58 2706.4,-12483.41"/>
<polygon fill="black" stroke="black" points="2708.82,-12480.85 2699.65,-12475.55 2703.52,-12485.42 2708.82,-12480.85"/>
</g>
<!-- layer_7_attn_out_gpu0 -->
<g id="node321" class="node">
<title>layer_7_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2828,-12475.4 2740,-12475.4 2740,-12423.4 2828,-12423.4 2828,-12475.4"/>
<text text-anchor="middle" x="2784" y="-12463.4" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="2784" y="-12452.4" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2784" y="-12441.4" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2784" y="-12430.4" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_allreduce_attn -->
<g id="node329" class="node">
<title>layer_7_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="3102" cy="-12358.41" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="3102" y="-12366.91" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="3102" y="-12355.91" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="3102" y="-12344.91" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_7_attn_out_gpu0&#45;&gt;layer_7_allreduce_attn -->
<g id="edge441" class="edge">
<title>layer_7_attn_out_gpu0&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M2828.26,-12426.72C2831.19,-12425.53 2834.12,-12424.41 2837,-12423.4 2904.13,-12399.74 2983.84,-12381.79 3038.19,-12371.01"/>
<polygon fill="black" stroke="black" points="3038.89,-12374.44 3048.03,-12369.08 3037.54,-12367.57 3038.89,-12374.44"/>
</g>
<!-- layer_7_attn_out_gpu1 -->
<g id="node322" class="node">
<title>layer_7_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2934,-12475.4 2846,-12475.4 2846,-12423.4 2934,-12423.4 2934,-12475.4"/>
<text text-anchor="middle" x="2890" y="-12463.4" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="2890" y="-12452.4" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2890" y="-12441.4" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2890" y="-12430.4" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attn_out_gpu1&#45;&gt;layer_7_allreduce_attn -->
<g id="edge442" class="edge">
<title>layer_7_attn_out_gpu1&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M2934.16,-12427.33C2937.14,-12425.98 2940.11,-12424.66 2943,-12423.4 2977.33,-12408.41 3016.34,-12392.69 3047.13,-12380.58"/>
<polygon fill="black" stroke="black" points="3048.79,-12383.69 3056.82,-12376.78 3046.23,-12377.17 3048.79,-12383.69"/>
</g>
<!-- layer_7_attn_out_gpu2 -->
<g id="node323" class="node">
<title>layer_7_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="3040,-12475.4 2952,-12475.4 2952,-12423.4 3040,-12423.4 3040,-12475.4"/>
<text text-anchor="middle" x="2996" y="-12463.4" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="2996" y="-12452.4" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2996" y="-12441.4" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2996" y="-12430.4" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attn_out_gpu2&#45;&gt;layer_7_allreduce_attn -->
<g id="edge443" class="edge">
<title>layer_7_attn_out_gpu2&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M3025.81,-12423.37C3038.08,-12413.07 3052.42,-12401.03 3065.33,-12390.19"/>
<polygon fill="black" stroke="black" points="3067.74,-12392.74 3073.15,-12383.63 3063.24,-12387.38 3067.74,-12392.74"/>
</g>
<!-- layer_7_attn_out_gpu3 -->
<g id="node324" class="node">
<title>layer_7_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3146,-12475.4 3058,-12475.4 3058,-12423.4 3146,-12423.4 3146,-12475.4"/>
<text text-anchor="middle" x="3102" y="-12463.4" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="3102" y="-12452.4" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="3102" y="-12441.4" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3102" y="-12430.4" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attn_out_gpu3&#45;&gt;layer_7_allreduce_attn -->
<g id="edge444" class="edge">
<title>layer_7_attn_out_gpu3&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M3102,-12423.13C3102,-12415.24 3102,-12406.35 3102,-12397.77"/>
<polygon fill="black" stroke="black" points="3105.5,-12397.55 3102,-12387.55 3098.5,-12397.55 3105.5,-12397.55"/>
</g>
<!-- layer_7_attn_out_gpu4 -->
<g id="node325" class="node">
<title>layer_7_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3252,-12475.4 3164,-12475.4 3164,-12423.4 3252,-12423.4 3252,-12475.4"/>
<text text-anchor="middle" x="3208" y="-12463.4" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="3208" y="-12452.4" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="3208" y="-12441.4" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3208" y="-12430.4" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attn_out_gpu4&#45;&gt;layer_7_allreduce_attn -->
<g id="edge445" class="edge">
<title>layer_7_attn_out_gpu4&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M3178.19,-12423.37C3165.92,-12413.07 3151.58,-12401.03 3138.67,-12390.19"/>
<polygon fill="black" stroke="black" points="3140.76,-12387.38 3130.85,-12383.63 3136.26,-12392.74 3140.76,-12387.38"/>
</g>
<!-- layer_7_attn_out_gpu5 -->
<g id="node326" class="node">
<title>layer_7_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3358,-12475.4 3270,-12475.4 3270,-12423.4 3358,-12423.4 3358,-12475.4"/>
<text text-anchor="middle" x="3314" y="-12463.4" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="3314" y="-12452.4" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="3314" y="-12441.4" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3314" y="-12430.4" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attn_out_gpu5&#45;&gt;layer_7_allreduce_attn -->
<g id="edge446" class="edge">
<title>layer_7_attn_out_gpu5&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M3269.84,-12427.33C3266.86,-12425.98 3263.89,-12424.66 3261,-12423.4 3226.67,-12408.41 3187.66,-12392.69 3156.87,-12380.58"/>
<polygon fill="black" stroke="black" points="3157.77,-12377.17 3147.18,-12376.78 3155.21,-12383.69 3157.77,-12377.17"/>
</g>
<!-- layer_7_attn_out_gpu6 -->
<g id="node327" class="node">
<title>layer_7_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="3464,-12475.4 3376,-12475.4 3376,-12423.4 3464,-12423.4 3464,-12475.4"/>
<text text-anchor="middle" x="3420" y="-12463.4" font-family="Arial" font-size="10.00">Layer 7 Attn Out</text>
<text text-anchor="middle" x="3420" y="-12452.4" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3420" y="-12441.4" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3420" y="-12430.4" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_7_attn_out_gpu6&#45;&gt;layer_7_allreduce_attn -->
<g id="edge447" class="edge">
<title>layer_7_attn_out_gpu6&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M3375.74,-12426.72C3372.81,-12425.53 3369.88,-12424.41 3367,-12423.4 3299.87,-12399.74 3220.16,-12381.79 3165.81,-12371.01"/>
<polygon fill="black" stroke="black" points="3166.46,-12367.57 3155.97,-12369.08 3165.11,-12374.44 3166.46,-12367.57"/>
</g>
<!-- layer_7_attn_out_gpu7&#45;&gt;layer_7_allreduce_attn -->
<g id="edge448" class="edge">
<title>layer_7_attn_out_gpu7&#45;&gt;layer_7_allreduce_attn</title>
<path fill="none" stroke="black" d="M2722.18,-12426.49C2725.13,-12425.36 2728.09,-12424.32 2731,-12423.4 2834.43,-12390.75 2959.66,-12373.54 3034.97,-12365.47"/>
<polygon fill="black" stroke="black" points="3035.67,-12368.91 3045.25,-12364.39 3034.94,-12361.95 3035.67,-12368.91"/>
</g>
<!-- layer_7_allreduce_attn&#45;&gt;layer_7_residual1 -->
<g id="edge449" class="edge">
<title>layer_7_allreduce_attn&#45;&gt;layer_7_residual1</title>
<path fill="none" stroke="black" d="M3143.35,-12337.68C3171.12,-12324.45 3208.09,-12306.81 3238.81,-12292.16"/>
<polygon fill="black" stroke="black" points="3240.6,-12295.19 3248.12,-12287.72 3237.59,-12288.87 3240.6,-12295.19"/>
</g>
<!-- layer_7_ln1 -->
<g id="node331" class="node">
<title>layer_7_ln1</title>
<polygon fill="lightblue" stroke="black" points="3128.5,-12197.41 3055.5,-12197.41 3055.5,-12156.41 3128.5,-12156.41 3128.5,-12197.41"/>
<text text-anchor="middle" x="3092" y="-12185.41" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="3092" y="-12174.41" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="3092" y="-12163.41" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_7_residual1&#45;&gt;layer_7_ln1 -->
<g id="edge451" class="edge">
<title>layer_7_residual1&#45;&gt;layer_7_ln1</title>
<path fill="none" stroke="black" d="M3226.45,-12233.33C3197.16,-12221.26 3163.99,-12207.59 3137.93,-12196.85"/>
<polygon fill="black" stroke="black" points="3139.25,-12193.6 3128.67,-12193.03 3136.58,-12200.08 3139.25,-12193.6"/>
</g>
<!-- layer_7_residual2 -->
<g id="node351" class="node">
<title>layer_7_residual2</title>
<polygon fill="lightyellow" stroke="black" points="3457.94,-11684.45 3335.55,-11684.45 3304.06,-11624.45 3426.45,-11624.45 3457.94,-11684.45"/>
<text text-anchor="middle" x="3381" y="-11657.45" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="3381" y="-11646.45" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_7_residual1&#45;&gt;layer_7_residual2 -->
<g id="edge479" class="edge">
<title>layer_7_residual1&#45;&gt;layer_7_residual2</title>
<path fill="none" stroke="black" d="M3354.29,-12255.36C3438.81,-12241.39 3587,-12201.73 3587,-12095.41 3587,-12095.41 3587,-12095.41 3587,-11839.43 3587,-11769.22 3519.61,-11719.14 3461.92,-11689.13"/>
<polygon fill="black" stroke="black" points="3463.26,-11685.88 3452.76,-11684.48 3460.1,-11692.13 3463.26,-11685.88"/>
</g>
<!-- layer_7_mlp_fc1_gpu0 -->
<g id="node332" class="node">
<title>layer_7_mlp_fc1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2691,-12120.41 2597,-12120.41 2597,-12068.41 2691,-12068.41 2691,-12120.41"/>
<text text-anchor="middle" x="2644" y="-12108.41" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="2644" y="-12097.41" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2644" y="-12086.41" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2644" y="-12075.41" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu0 -->
<g id="edge452" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu0</title>
<path fill="none" stroke="black" d="M3055.35,-12174.14C2986.78,-12170.08 2834.67,-12157.66 2700.63,-12120.25"/>
<polygon fill="black" stroke="black" points="2701.58,-12116.88 2691.01,-12117.51 2699.67,-12123.61 2701.58,-12116.88"/>
</g>
<!-- layer_7_mlp_fc1_gpu1 -->
<g id="node333" class="node">
<title>layer_7_mlp_fc1_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2803,-12120.41 2709,-12120.41 2709,-12068.41 2803,-12068.41 2803,-12120.41"/>
<text text-anchor="middle" x="2756" y="-12108.41" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="2756" y="-12097.41" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2756" y="-12086.41" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2756" y="-12075.41" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu1 -->
<g id="edge453" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu1</title>
<path fill="none" stroke="black" d="M3055.1,-12171.29C3002.76,-12164.15 2904.05,-12148.55 2812.73,-12120.36"/>
<polygon fill="black" stroke="black" points="2813.66,-12116.98 2803.07,-12117.32 2811.55,-12123.66 2813.66,-12116.98"/>
</g>
<!-- layer_7_mlp_fc1_gpu2 -->
<g id="node334" class="node">
<title>layer_7_mlp_fc1_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2915,-12120.41 2821,-12120.41 2821,-12068.41 2915,-12068.41 2915,-12120.41"/>
<text text-anchor="middle" x="2868" y="-12108.41" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="2868" y="-12097.41" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="2868" y="-12086.41" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="2868" y="-12075.41" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu2 -->
<g id="edge454" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu2</title>
<path fill="none" stroke="black" d="M3055.25,-12164.94C3022.97,-12155.05 2974.62,-12139.61 2924.58,-12120.5"/>
<polygon fill="black" stroke="black" points="2925.8,-12117.23 2915.22,-12116.89 2923.29,-12123.76 2925.8,-12117.23"/>
</g>
<!-- layer_7_mlp_fc1_gpu3 -->
<g id="node335" class="node">
<title>layer_7_mlp_fc1_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3027,-12120.41 2933,-12120.41 2933,-12068.41 3027,-12068.41 3027,-12120.41"/>
<text text-anchor="middle" x="2980" y="-12108.41" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="2980" y="-12097.41" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="2980" y="-12086.41" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="2980" y="-12075.41" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu3 -->
<g id="edge455" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu3</title>
<path fill="none" stroke="black" d="M3064.6,-12156.22C3052.27,-12147.36 3037.4,-12136.67 3023.59,-12126.75"/>
<polygon fill="black" stroke="black" points="3025.33,-12123.68 3015.17,-12120.69 3021.24,-12129.37 3025.33,-12123.68"/>
</g>
<!-- layer_7_mlp_fc1_gpu4 -->
<g id="node336" class="node">
<title>layer_7_mlp_fc1_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3139,-12120.41 3045,-12120.41 3045,-12068.41 3139,-12068.41 3139,-12120.41"/>
<text text-anchor="middle" x="3092" y="-12108.41" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="3092" y="-12097.41" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="3092" y="-12086.41" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3092" y="-12075.41" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu4 -->
<g id="edge456" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu4</title>
<path fill="none" stroke="black" d="M3092,-12156.01C3092,-12148.4 3092,-12139.47 3092,-12130.84"/>
<polygon fill="black" stroke="black" points="3095.5,-12130.57 3092,-12120.57 3088.5,-12130.57 3095.5,-12130.57"/>
</g>
<!-- layer_7_mlp_fc1_gpu5 -->
<g id="node337" class="node">
<title>layer_7_mlp_fc1_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3251,-12120.41 3157,-12120.41 3157,-12068.41 3251,-12068.41 3251,-12120.41"/>
<text text-anchor="middle" x="3204" y="-12108.41" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="3204" y="-12097.41" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="3204" y="-12086.41" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3204" y="-12075.41" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu5 -->
<g id="edge457" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu5</title>
<path fill="none" stroke="black" d="M3119.4,-12156.22C3131.73,-12147.36 3146.6,-12136.67 3160.41,-12126.75"/>
<polygon fill="black" stroke="black" points="3162.76,-12129.37 3168.83,-12120.69 3158.67,-12123.68 3162.76,-12129.37"/>
</g>
<!-- layer_7_mlp_fc1_gpu6 -->
<g id="node338" class="node">
<title>layer_7_mlp_fc1_gpu6</title>
<polygon fill="lightblue" stroke="black" points="3363,-12120.41 3269,-12120.41 3269,-12068.41 3363,-12068.41 3363,-12120.41"/>
<text text-anchor="middle" x="3316" y="-12108.41" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="3316" y="-12097.41" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3316" y="-12086.41" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3316" y="-12075.41" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu6 -->
<g id="edge458" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu6</title>
<path fill="none" stroke="black" d="M3128.75,-12164.94C3161.03,-12155.05 3209.38,-12139.61 3259.42,-12120.5"/>
<polygon fill="black" stroke="black" points="3260.71,-12123.76 3268.78,-12116.89 3258.2,-12117.23 3260.71,-12123.76"/>
</g>
<!-- layer_7_mlp_fc1_gpu7 -->
<g id="node339" class="node">
<title>layer_7_mlp_fc1_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3475,-12120.41 3381,-12120.41 3381,-12068.41 3475,-12068.41 3475,-12120.41"/>
<text text-anchor="middle" x="3428" y="-12108.41" font-family="Arial" font-size="10.00">Layer 7 MLP FC1</text>
<text text-anchor="middle" x="3428" y="-12097.41" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="3428" y="-12086.41" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3428" y="-12075.41" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu7 -->
<g id="edge459" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_mlp_fc1_gpu7</title>
<path fill="none" stroke="black" d="M3128.9,-12171.29C3181.24,-12164.15 3279.95,-12148.55 3371.27,-12120.36"/>
<polygon fill="black" stroke="black" points="3372.45,-12123.66 3380.93,-12117.32 3370.34,-12116.98 3372.45,-12123.66"/>
</g>
<!-- layer_7_allgather_mlp -->
<g id="node340" class="node">
<title>layer_7_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="2980" cy="-12003.42" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="2980" y="-12011.92" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="2980" y="-12000.92" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="2980" y="-11989.92" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_7_mlp_fc1_gpu0&#45;&gt;layer_7_allgather_mlp -->
<g id="edge460" class="edge">
<title>layer_7_mlp_fc1_gpu0&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M2691.1,-12071.61C2694.09,-12070.47 2697.07,-12069.39 2700,-12068.41 2772.84,-12044.09 2859.37,-12025.87 2916.76,-12015.22"/>
<polygon fill="black" stroke="black" points="2917.57,-12018.63 2926.78,-12013.38 2916.31,-12011.74 2917.57,-12018.63"/>
</g>
<!-- layer_7_mlp_fc1_gpu1&#45;&gt;layer_7_allgather_mlp -->
<g id="edge461" class="edge">
<title>layer_7_mlp_fc1_gpu1&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M2803.28,-12072.09C2806.22,-12070.83 2809.15,-12069.59 2812,-12068.41 2849.41,-12052.95 2892.04,-12036.73 2924.99,-12024.49"/>
<polygon fill="black" stroke="black" points="2926.29,-12027.74 2934.45,-12020.99 2923.86,-12021.18 2926.29,-12027.74"/>
</g>
<!-- layer_7_mlp_fc1_gpu2&#45;&gt;layer_7_allgather_mlp -->
<g id="edge462" class="edge">
<title>layer_7_mlp_fc1_gpu2&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M2899.5,-12068.39C2912.69,-12057.9 2928.15,-12045.62 2941.98,-12034.64"/>
<polygon fill="black" stroke="black" points="2944.24,-12037.3 2949.9,-12028.34 2939.89,-12031.82 2944.24,-12037.3"/>
</g>
<!-- layer_7_mlp_fc1_gpu3&#45;&gt;layer_7_allgather_mlp -->
<g id="edge463" class="edge">
<title>layer_7_mlp_fc1_gpu3&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M2980,-12068.15C2980,-12060.26 2980,-12051.37 2980,-12042.79"/>
<polygon fill="black" stroke="black" points="2983.5,-12042.56 2980,-12032.56 2976.5,-12042.56 2983.5,-12042.56"/>
</g>
<!-- layer_7_mlp_fc1_gpu4&#45;&gt;layer_7_allgather_mlp -->
<g id="edge464" class="edge">
<title>layer_7_mlp_fc1_gpu4&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M3060.5,-12068.39C3047.31,-12057.9 3031.85,-12045.62 3018.02,-12034.64"/>
<polygon fill="black" stroke="black" points="3020.11,-12031.82 3010.1,-12028.34 3015.76,-12037.3 3020.11,-12031.82"/>
</g>
<!-- layer_7_mlp_fc1_gpu5&#45;&gt;layer_7_allgather_mlp -->
<g id="edge465" class="edge">
<title>layer_7_mlp_fc1_gpu5&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M3156.72,-12072.09C3153.78,-12070.83 3150.85,-12069.59 3148,-12068.41 3110.59,-12052.95 3067.96,-12036.73 3035.01,-12024.49"/>
<polygon fill="black" stroke="black" points="3036.14,-12021.18 3025.55,-12020.99 3033.71,-12027.74 3036.14,-12021.18"/>
</g>
<!-- layer_7_mlp_fc1_gpu6&#45;&gt;layer_7_allgather_mlp -->
<g id="edge466" class="edge">
<title>layer_7_mlp_fc1_gpu6&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M3268.9,-12071.61C3265.91,-12070.47 3262.93,-12069.39 3260,-12068.41 3187.16,-12044.09 3100.63,-12025.87 3043.24,-12015.22"/>
<polygon fill="black" stroke="black" points="3043.69,-12011.74 3033.22,-12013.38 3042.43,-12018.63 3043.69,-12011.74"/>
</g>
<!-- layer_7_mlp_fc1_gpu7&#45;&gt;layer_7_allgather_mlp -->
<g id="edge467" class="edge">
<title>layer_7_mlp_fc1_gpu7&#45;&gt;layer_7_allgather_mlp</title>
<path fill="none" stroke="black" d="M3380.97,-12071.39C3377.96,-12070.3 3374.96,-12069.3 3372,-12068.41 3260.1,-12034.92 3124.65,-12017.73 3045.82,-12009.94"/>
<polygon fill="black" stroke="black" points="3045.84,-12006.42 3035.55,-12008.94 3045.16,-12013.39 3045.84,-12006.42"/>
</g>
<!-- layer_7_gelu -->
<g id="node341" class="node">
<title>layer_7_gelu</title>
<polygon fill="lightblue" stroke="black" points="2940.5,-11938.43 2851.5,-11938.43 2851.5,-11902.43 2940.5,-11902.43 2940.5,-11938.43"/>
<text text-anchor="middle" x="2896" y="-11923.43" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="2896" y="-11912.43" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_7_allgather_mlp&#45;&gt;layer_7_gelu -->
<g id="edge468" class="edge">
<title>layer_7_allgather_mlp&#45;&gt;layer_7_gelu</title>
<path fill="none" stroke="black" d="M2953.88,-11977.24C2943.42,-11967.15 2931.41,-11955.58 2921.06,-11945.59"/>
<polygon fill="black" stroke="black" points="2923.48,-11943.07 2913.85,-11938.65 2918.62,-11948.11 2923.48,-11943.07"/>
</g>
<!-- layer_7_mlp_fc2_gpu7 -->
<g id="node349" class="node">
<title>layer_7_mlp_fc2_gpu7</title>
<polygon fill="lightblue" stroke="black" points="2775,-11866.43 2681,-11866.43 2681,-11814.43 2775,-11814.43 2775,-11866.43"/>
<text text-anchor="middle" x="2728" y="-11854.43" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="2728" y="-11843.43" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2728" y="-11832.43" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="2728" y="-11821.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu7 -->
<g id="edge469" class="edge">
<title>layer_7_gelu&#45;&gt;layer_7_mlp_fc2_gpu7</title>
<path fill="none" stroke="black" d="M2859.13,-11902.31C2837.21,-11892.13 2808.95,-11879.01 2784.28,-11867.56"/>
<polygon fill="black" stroke="black" points="2785.56,-11864.3 2775.02,-11863.26 2782.62,-11870.65 2785.56,-11864.3"/>
</g>
<!-- layer_7_mlp_fc2_gpu0 -->
<g id="node342" class="node">
<title>layer_7_mlp_fc2_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2887,-11866.43 2793,-11866.43 2793,-11814.43 2887,-11814.43 2887,-11866.43"/>
<text text-anchor="middle" x="2840" y="-11854.43" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="2840" y="-11843.43" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="2840" y="-11832.43" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2840" y="-11821.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_allreduce_mlp -->
<g id="node350" class="node">
<title>layer_7_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="3176" cy="-11749.44" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="3176" y="-11757.94" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="3176" y="-11746.94" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="3176" y="-11735.94" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_7_mlp_fc2_gpu0&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge470" class="edge">
<title>layer_7_mlp_fc2_gpu0&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2887.1,-11817.63C2890.09,-11816.49 2893.07,-11815.41 2896,-11814.43 2967.61,-11790.52 3052.46,-11772.51 3109.84,-11761.78"/>
<polygon fill="black" stroke="black" points="3110.67,-11765.19 3119.87,-11759.93 3109.4,-11758.3 3110.67,-11765.19"/>
</g>
<!-- layer_7_mlp_fc2_gpu1 -->
<g id="node343" class="node">
<title>layer_7_mlp_fc2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2999,-11866.43 2905,-11866.43 2905,-11814.43 2999,-11814.43 2999,-11866.43"/>
<text text-anchor="middle" x="2952" y="-11854.43" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="2952" y="-11843.43" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="2952" y="-11832.43" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="2952" y="-11821.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_mlp_fc2_gpu1&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge471" class="edge">
<title>layer_7_mlp_fc2_gpu1&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2999.28,-11818.1C3002.22,-11816.84 3005.15,-11815.61 3008,-11814.43 3044.89,-11799.19 3086.84,-11783.2 3119.6,-11771.03"/>
<polygon fill="black" stroke="black" points="3120.85,-11774.29 3129.01,-11767.54 3118.42,-11767.73 3120.85,-11774.29"/>
</g>
<!-- layer_7_mlp_fc2_gpu2 -->
<g id="node344" class="node">
<title>layer_7_mlp_fc2_gpu2</title>
<polygon fill="lightblue" stroke="black" points="3111,-11866.43 3017,-11866.43 3017,-11814.43 3111,-11814.43 3111,-11866.43"/>
<text text-anchor="middle" x="3064" y="-11854.43" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="3064" y="-11843.43" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="3064" y="-11832.43" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3064" y="-11821.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_mlp_fc2_gpu2&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge472" class="edge">
<title>layer_7_mlp_fc2_gpu2&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3095.5,-11814.41C3108.59,-11804.01 3123.9,-11791.84 3137.64,-11780.92"/>
<polygon fill="black" stroke="black" points="3139.86,-11783.63 3145.51,-11774.66 3135.51,-11778.14 3139.86,-11783.63"/>
</g>
<!-- layer_7_mlp_fc2_gpu3 -->
<g id="node345" class="node">
<title>layer_7_mlp_fc2_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3223,-11866.43 3129,-11866.43 3129,-11814.43 3223,-11814.43 3223,-11866.43"/>
<text text-anchor="middle" x="3176" y="-11854.43" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="3176" y="-11843.43" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="3176" y="-11832.43" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3176" y="-11821.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_mlp_fc2_gpu3&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge473" class="edge">
<title>layer_7_mlp_fc2_gpu3&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3176,-11814.17C3176,-11806.28 3176,-11797.39 3176,-11788.81"/>
<polygon fill="black" stroke="black" points="3179.5,-11788.58 3176,-11778.58 3172.5,-11788.58 3179.5,-11788.58"/>
</g>
<!-- layer_7_mlp_fc2_gpu4 -->
<g id="node346" class="node">
<title>layer_7_mlp_fc2_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3335,-11866.43 3241,-11866.43 3241,-11814.43 3335,-11814.43 3335,-11866.43"/>
<text text-anchor="middle" x="3288" y="-11854.43" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="3288" y="-11843.43" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="3288" y="-11832.43" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3288" y="-11821.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_mlp_fc2_gpu4&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge474" class="edge">
<title>layer_7_mlp_fc2_gpu4&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3256.5,-11814.41C3243.41,-11804.01 3228.1,-11791.84 3214.36,-11780.92"/>
<polygon fill="black" stroke="black" points="3216.49,-11778.14 3206.49,-11774.66 3212.14,-11783.63 3216.49,-11778.14"/>
</g>
<!-- layer_7_mlp_fc2_gpu5 -->
<g id="node347" class="node">
<title>layer_7_mlp_fc2_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3447,-11866.43 3353,-11866.43 3353,-11814.43 3447,-11814.43 3447,-11866.43"/>
<text text-anchor="middle" x="3400" y="-11854.43" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="3400" y="-11843.43" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="3400" y="-11832.43" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3400" y="-11821.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_mlp_fc2_gpu5&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge475" class="edge">
<title>layer_7_mlp_fc2_gpu5&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3352.72,-11818.1C3349.78,-11816.84 3346.85,-11815.61 3344,-11814.43 3307.11,-11799.19 3265.16,-11783.2 3232.4,-11771.03"/>
<polygon fill="black" stroke="black" points="3233.58,-11767.73 3222.99,-11767.54 3231.15,-11774.29 3233.58,-11767.73"/>
</g>
<!-- layer_7_mlp_fc2_gpu6 -->
<g id="node348" class="node">
<title>layer_7_mlp_fc2_gpu6</title>
<polygon fill="lightblue" stroke="black" points="3559,-11866.43 3465,-11866.43 3465,-11814.43 3559,-11814.43 3559,-11866.43"/>
<text text-anchor="middle" x="3512" y="-11854.43" font-family="Arial" font-size="10.00">Layer 7 MLP FC2</text>
<text text-anchor="middle" x="3512" y="-11843.43" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="3512" y="-11832.43" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3512" y="-11821.43" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_7_mlp_fc2_gpu6&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge476" class="edge">
<title>layer_7_mlp_fc2_gpu6&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3464.9,-11817.63C3461.91,-11816.49 3458.93,-11815.41 3456,-11814.43 3384.39,-11790.52 3299.54,-11772.51 3242.16,-11761.78"/>
<polygon fill="black" stroke="black" points="3242.6,-11758.3 3232.13,-11759.93 3241.33,-11765.19 3242.6,-11758.3"/>
</g>
<!-- layer_7_mlp_fc2_gpu7&#45;&gt;layer_7_allreduce_mlp -->
<g id="edge477" class="edge">
<title>layer_7_mlp_fc2_gpu7&#45;&gt;layer_7_allreduce_mlp</title>
<path fill="none" stroke="black" d="M2775.03,-11817.41C2778.04,-11816.32 2781.04,-11815.32 2784,-11814.43 2894.16,-11781.45 3027.15,-11764.29 3106.47,-11756.32"/>
<polygon fill="black" stroke="black" points="3107.21,-11759.77 3116.82,-11755.31 3106.53,-11752.8 3107.21,-11759.77"/>
</g>
<!-- layer_7_allreduce_mlp&#45;&gt;layer_7_residual2 -->
<g id="edge478" class="edge">
<title>layer_7_allreduce_mlp&#45;&gt;layer_7_residual2</title>
<path fill="none" stroke="black" d="M3218.97,-11728.95C3249,-11715.32 3289.46,-11696.97 3322.43,-11682.01"/>
<polygon fill="black" stroke="black" points="3324.3,-11685.01 3331.96,-11677.69 3321.41,-11678.64 3324.3,-11685.01"/>
</g>
<!-- layer_7_ln2 -->
<g id="node352" class="node">
<title>layer_7_ln2</title>
<polygon fill="lightblue" stroke="black" points="3417.5,-11588.45 3344.5,-11588.45 3344.5,-11547.45 3417.5,-11547.45 3417.5,-11588.45"/>
<text text-anchor="middle" x="3381" y="-11576.45" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="3381" y="-11565.45" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="3381" y="-11554.45" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_7_residual2&#45;&gt;layer_7_ln2 -->
<g id="edge480" class="edge">
<title>layer_7_residual2&#45;&gt;layer_7_ln2</title>
<path fill="none" stroke="black" d="M3381,-11624.37C3381,-11616.04 3381,-11606.96 3381,-11598.6"/>
<polygon fill="black" stroke="black" points="3384.5,-11598.51 3381,-11588.51 3377.5,-11598.51 3384.5,-11598.51"/>
</g>
<!-- layer_7_output_dist -->
<g id="node353" class="node">
<title>layer_7_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="3482.7,-11511.45 3320.92,-11511.45 3279.3,-11451.45 3441.08,-11451.45 3482.7,-11511.45"/>
<text text-anchor="middle" x="3381" y="-11484.45" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="3381" y="-11473.45" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_7_ln2&#45;&gt;layer_7_output_dist -->
<g id="edge481" class="edge">
<title>layer_7_ln2&#45;&gt;layer_7_output_dist</title>
<path fill="none" stroke="black" d="M3381,-11547.35C3381,-11539.71 3381,-11530.67 3381,-11521.8"/>
<polygon fill="black" stroke="black" points="3384.5,-11521.56 3381,-11511.56 3377.5,-11521.56 3384.5,-11521.56"/>
</g>
<!-- layer_8_input_dist -->
<g id="node354" class="node">
<title>layer_8_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="3475.19,-11415.45 3325.36,-11415.45 3286.81,-11355.45 3436.64,-11355.45 3475.19,-11415.45"/>
<text text-anchor="middle" x="3381" y="-11388.45" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="3381" y="-11377.45" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_7_output_dist&#45;&gt;layer_8_input_dist -->
<g id="edge482" class="edge">
<title>layer_7_output_dist&#45;&gt;layer_8_input_dist</title>
<path fill="none" stroke="black" d="M3381,-11451.22C3381,-11443.18 3381,-11434.31 3381,-11425.8"/>
<polygon fill="black" stroke="black" points="3384.5,-11425.66 3381,-11415.66 3377.5,-11425.66 3384.5,-11425.66"/>
</g>
<!-- layer_8_qkv_gpu8 -->
<g id="node355" class="node">
<title>layer_8_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="2983.5,-11319.45 2890.5,-11319.45 2890.5,-11267.45 2983.5,-11267.45 2983.5,-11319.45"/>
<text text-anchor="middle" x="2937" y="-11307.45" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="2937" y="-11296.45" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2937" y="-11285.45" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="2937" y="-11274.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu8 -->
<g id="edge483" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu8</title>
<path fill="none" stroke="black" d="M3300.5,-11376.99C3223.32,-11368.48 3103.81,-11351.74 2993.36,-11319.23"/>
<polygon fill="black" stroke="black" points="2994.31,-11315.86 2983.72,-11316.34 2992.3,-11322.56 2994.31,-11315.86"/>
</g>
<!-- layer_8_qkv_gpu9 -->
<g id="node356" class="node">
<title>layer_8_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3094.5,-11319.45 3001.5,-11319.45 3001.5,-11267.45 3094.5,-11267.45 3094.5,-11319.45"/>
<text text-anchor="middle" x="3048" y="-11307.45" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="3048" y="-11296.45" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3048" y="-11285.45" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3048" y="-11274.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu9 -->
<g id="edge484" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu9</title>
<path fill="none" stroke="black" d="M3295.28,-11368.7C3242.43,-11357.98 3173.37,-11342.14 3104.51,-11319.37"/>
<polygon fill="black" stroke="black" points="3105.39,-11315.97 3094.8,-11316.11 3103.16,-11322.61 3105.39,-11315.97"/>
</g>
<!-- layer_8_qkv_gpu10 -->
<g id="node357" class="node">
<title>layer_8_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3205.5,-11319.45 3112.5,-11319.45 3112.5,-11267.45 3205.5,-11267.45 3205.5,-11319.45"/>
<text text-anchor="middle" x="3159" y="-11307.45" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="3159" y="-11296.45" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3159" y="-11285.45" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3159" y="-11274.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu10 -->
<g id="edge485" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu10</title>
<path fill="none" stroke="black" d="M3304.67,-11355.42C3276.39,-11344.44 3244.12,-11331.64 3215,-11319.45 3214.9,-11319.41 3214.81,-11319.37 3214.71,-11319.33"/>
<polygon fill="black" stroke="black" points="3216.25,-11316.18 3205.68,-11315.48 3213.51,-11322.62 3216.25,-11316.18"/>
</g>
<!-- layer_8_qkv_gpu11 -->
<g id="node358" class="node">
<title>layer_8_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3316.5,-11319.45 3223.5,-11319.45 3223.5,-11267.45 3316.5,-11267.45 3316.5,-11319.45"/>
<text text-anchor="middle" x="3270" y="-11307.45" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="3270" y="-11296.45" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3270" y="-11285.45" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3270" y="-11274.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu11 -->
<g id="edge486" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu11</title>
<path fill="none" stroke="black" d="M3344.96,-11355.23C3333.44,-11345.89 3320.64,-11335.51 3308.92,-11326.01"/>
<polygon fill="black" stroke="black" points="3310.98,-11323.17 3301.01,-11319.59 3306.58,-11328.61 3310.98,-11323.17"/>
</g>
<!-- layer_8_qkv_gpu12 -->
<g id="node359" class="node">
<title>layer_8_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3427.5,-11319.45 3334.5,-11319.45 3334.5,-11267.45 3427.5,-11267.45 3427.5,-11319.45"/>
<text text-anchor="middle" x="3381" y="-11307.45" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="3381" y="-11296.45" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3381" y="-11285.45" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3381" y="-11274.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu12 -->
<g id="edge487" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu12</title>
<path fill="none" stroke="black" d="M3381,-11354.98C3381,-11346.9 3381,-11338.07 3381,-11329.71"/>
<polygon fill="black" stroke="black" points="3384.5,-11329.46 3381,-11319.46 3377.5,-11329.46 3384.5,-11329.46"/>
</g>
<!-- layer_8_qkv_gpu13 -->
<g id="node360" class="node">
<title>layer_8_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3538.5,-11319.45 3445.5,-11319.45 3445.5,-11267.45 3538.5,-11267.45 3538.5,-11319.45"/>
<text text-anchor="middle" x="3492" y="-11307.45" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="3492" y="-11296.45" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3492" y="-11285.45" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3492" y="-11274.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu13 -->
<g id="edge488" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu13</title>
<path fill="none" stroke="black" d="M3417.04,-11355.23C3428.56,-11345.89 3441.36,-11335.51 3453.08,-11326.01"/>
<polygon fill="black" stroke="black" points="3455.42,-11328.61 3460.99,-11319.59 3451.02,-11323.17 3455.42,-11328.61"/>
</g>
<!-- layer_8_qkv_gpu14 -->
<g id="node361" class="node">
<title>layer_8_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3649.5,-11319.45 3556.5,-11319.45 3556.5,-11267.45 3649.5,-11267.45 3649.5,-11319.45"/>
<text text-anchor="middle" x="3603" y="-11307.45" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="3603" y="-11296.45" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3603" y="-11285.45" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3603" y="-11274.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu14 -->
<g id="edge489" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu14</title>
<path fill="none" stroke="black" d="M3441.23,-11361.93C3470.83,-11350.65 3507.18,-11336.48 3546.92,-11319.84"/>
<polygon fill="black" stroke="black" points="3548.41,-11323.01 3556.27,-11315.9 3545.7,-11316.55 3548.41,-11323.01"/>
</g>
<!-- layer_8_qkv_gpu15 -->
<g id="node362" class="node">
<title>layer_8_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3760.5,-11319.45 3667.5,-11319.45 3667.5,-11267.45 3760.5,-11267.45 3760.5,-11319.45"/>
<text text-anchor="middle" x="3714" y="-11307.45" font-family="Arial" font-size="10.00">Layer 8 QKV Proj</text>
<text text-anchor="middle" x="3714" y="-11296.45" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3714" y="-11285.45" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3714" y="-11274.45" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_qkv_gpu15 -->
<g id="edge490" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_qkv_gpu15</title>
<path fill="none" stroke="black" d="M3447.75,-11372.68C3502.38,-11362.18 3581.57,-11344.97 3657.7,-11319.66"/>
<polygon fill="black" stroke="black" points="3659.09,-11322.88 3667.45,-11316.36 3656.85,-11316.25 3659.09,-11322.88"/>
</g>
<!-- layer_8_residual1 -->
<g id="node374" class="node">
<title>layer_8_residual1</title>
<polygon fill="lightyellow" stroke="black" points="3744.94,-10867.48 3622.55,-10867.48 3591.06,-10807.48 3713.45,-10807.48 3744.94,-10867.48"/>
<text text-anchor="middle" x="3668" y="-10840.48" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="3668" y="-10829.48" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_8_input_dist&#45;&gt;layer_8_residual1 -->
<g id="edge510" class="edge">
<title>layer_8_input_dist&#45;&gt;layer_8_residual1</title>
<path fill="none" stroke="black" d="M3451.87,-11378.68C3548.96,-11369.76 3717.28,-11350.36 3770,-11319.45 3827,-11286.03 3863,-11269.53 3863,-11203.46 3863,-11203.46 3863,-11203.46 3863,-11022.47 3863,-10953.69 3798.02,-10903.01 3743.09,-10872.45"/>
<polygon fill="black" stroke="black" points="3744.48,-10869.22 3734.02,-10867.53 3741.14,-10875.38 3744.48,-10869.22"/>
</g>
<!-- layer_8_allgather_qkv -->
<g id="node363" class="node">
<title>layer_8_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="3270" cy="-11202.46" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="3270" y="-11210.96" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="3270" y="-11199.96" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="3270" y="-11188.96" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_8_qkv_gpu8&#45;&gt;layer_8_allgather_qkv -->
<g id="edge491" class="edge">
<title>layer_8_qkv_gpu8&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M2983.79,-11270.77C2986.88,-11269.58 2989.97,-11268.46 2993,-11267.45 3064.63,-11243.44 3149.62,-11225.26 3206.4,-11214.53"/>
<polygon fill="black" stroke="black" points="3207.12,-11217.95 3216.31,-11212.68 3205.84,-11211.07 3207.12,-11217.95"/>
</g>
<!-- layer_8_qkv_gpu9&#45;&gt;layer_8_allgather_qkv -->
<g id="edge492" class="edge">
<title>layer_8_qkv_gpu9&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M3094.67,-11271.39C3097.82,-11270.04 3100.95,-11268.71 3104,-11267.45 3140.7,-11252.19 3182.45,-11236.1 3214.9,-11223.88"/>
<polygon fill="black" stroke="black" points="3216.53,-11227 3224.66,-11220.21 3214.06,-11220.45 3216.53,-11227"/>
</g>
<!-- layer_8_qkv_gpu10&#45;&gt;layer_8_allgather_qkv -->
<g id="edge493" class="edge">
<title>layer_8_qkv_gpu10&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M3190.22,-11267.42C3203.29,-11256.94 3218.61,-11244.65 3232.31,-11233.67"/>
<polygon fill="black" stroke="black" points="3234.55,-11236.36 3240.17,-11227.38 3230.17,-11230.9 3234.55,-11236.36"/>
</g>
<!-- layer_8_qkv_gpu11&#45;&gt;layer_8_allgather_qkv -->
<g id="edge494" class="edge">
<title>layer_8_qkv_gpu11&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M3270,-11267.18C3270,-11259.29 3270,-11250.4 3270,-11241.82"/>
<polygon fill="black" stroke="black" points="3273.5,-11241.6 3270,-11231.6 3266.5,-11241.6 3273.5,-11241.6"/>
</g>
<!-- layer_8_qkv_gpu12&#45;&gt;layer_8_allgather_qkv -->
<g id="edge495" class="edge">
<title>layer_8_qkv_gpu12&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M3349.78,-11267.42C3336.71,-11256.94 3321.39,-11244.65 3307.69,-11233.67"/>
<polygon fill="black" stroke="black" points="3309.83,-11230.9 3299.83,-11227.38 3305.45,-11236.36 3309.83,-11230.9"/>
</g>
<!-- layer_8_qkv_gpu13&#45;&gt;layer_8_allgather_qkv -->
<g id="edge496" class="edge">
<title>layer_8_qkv_gpu13&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M3445.28,-11270.98C3442.48,-11269.77 3439.71,-11268.58 3437,-11267.45 3399.98,-11251.96 3357.78,-11235.8 3325.06,-11223.59"/>
<polygon fill="black" stroke="black" points="3326.25,-11220.3 3315.66,-11220.1 3323.81,-11226.87 3326.25,-11220.3"/>
</g>
<!-- layer_8_qkv_gpu14&#45;&gt;layer_8_allgather_qkv -->
<g id="edge497" class="edge">
<title>layer_8_qkv_gpu14&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M3556.45,-11270.52C3553.61,-11269.42 3550.78,-11268.39 3548,-11267.45 3476.2,-11243.14 3390.88,-11225.02 3333.87,-11214.39"/>
<polygon fill="black" stroke="black" points="3334.39,-11210.92 3323.92,-11212.55 3333.12,-11217.81 3334.39,-11210.92"/>
</g>
<!-- layer_8_qkv_gpu15&#45;&gt;layer_8_allgather_qkv -->
<g id="edge498" class="edge">
<title>layer_8_qkv_gpu15&#45;&gt;layer_8_allgather_qkv</title>
<path fill="none" stroke="black" d="M3667.21,-11270.2C3664.46,-11269.2 3661.71,-11268.27 3659,-11267.45 3548.69,-11233.95 3415.14,-11216.83 3336.68,-11209.04"/>
<polygon fill="black" stroke="black" points="3336.75,-11205.53 3326.45,-11208.04 3336.07,-11212.49 3336.75,-11205.53"/>
</g>
<!-- layer_8_attention -->
<g id="node364" class="node">
<title>layer_8_attention</title>
<polygon fill="lightblue" stroke="black" points="3157,-11137.47 3089,-11137.47 3089,-11085.47 3157,-11085.47 3157,-11137.47"/>
<text text-anchor="middle" x="3123" y="-11125.47" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="3123" y="-11114.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3123" y="-11103.47" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="3123" y="-11092.47" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_8_allgather_qkv&#45;&gt;layer_8_attention -->
<g id="edge499" class="edge">
<title>layer_8_allgather_qkv&#45;&gt;layer_8_attention</title>
<path fill="none" stroke="black" d="M3234.04,-11179.69C3213.42,-11167.2 3187.41,-11151.46 3165.75,-11138.35"/>
<polygon fill="black" stroke="black" points="3167.44,-11135.28 3157.07,-11133.09 3163.82,-11141.27 3167.44,-11135.28"/>
</g>
<!-- layer_8_attn_out_gpu15 -->
<g id="node372" class="node">
<title>layer_8_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3093,-11049.47 3005,-11049.47 3005,-10997.47 3093,-10997.47 3093,-11049.47"/>
<text text-anchor="middle" x="3049" y="-11037.47" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="3049" y="-11026.47" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3049" y="-11015.47" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3049" y="-11004.47" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attention&#45;&gt;layer_8_attn_out_gpu15 -->
<g id="edge500" class="edge">
<title>layer_8_attention&#45;&gt;layer_8_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M3101.2,-11085.13C3093.75,-11076.47 3085.3,-11066.65 3077.4,-11057.47"/>
<polygon fill="black" stroke="black" points="3079.82,-11054.92 3070.65,-11049.62 3074.52,-11059.49 3079.82,-11054.92"/>
</g>
<!-- layer_8_attn_out_gpu8 -->
<g id="node365" class="node">
<title>layer_8_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3199,-11049.47 3111,-11049.47 3111,-10997.47 3199,-10997.47 3199,-11049.47"/>
<text text-anchor="middle" x="3155" y="-11037.47" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="3155" y="-11026.47" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3155" y="-11015.47" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3155" y="-11004.47" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_allreduce_attn -->
<g id="node373" class="node">
<title>layer_8_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="3473" cy="-10932.47" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="3473" y="-10940.97" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="3473" y="-10929.97" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="3473" y="-10918.97" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_8_attn_out_gpu8&#45;&gt;layer_8_allreduce_attn -->
<g id="edge501" class="edge">
<title>layer_8_attn_out_gpu8&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M3199.26,-11000.79C3202.19,-10999.6 3205.12,-10998.48 3208,-10997.47 3275.13,-10973.81 3354.84,-10955.86 3409.19,-10945.08"/>
<polygon fill="black" stroke="black" points="3409.89,-10948.51 3419.03,-10943.15 3408.54,-10941.64 3409.89,-10948.51"/>
</g>
<!-- layer_8_attn_out_gpu9 -->
<g id="node366" class="node">
<title>layer_8_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3305,-11049.47 3217,-11049.47 3217,-10997.47 3305,-10997.47 3305,-11049.47"/>
<text text-anchor="middle" x="3261" y="-11037.47" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="3261" y="-11026.47" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3261" y="-11015.47" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3261" y="-11004.47" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attn_out_gpu9&#45;&gt;layer_8_allreduce_attn -->
<g id="edge502" class="edge">
<title>layer_8_attn_out_gpu9&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M3305.16,-11001.4C3308.14,-11000.05 3311.11,-10998.73 3314,-10997.47 3348.33,-10982.48 3387.34,-10966.76 3418.13,-10954.65"/>
<polygon fill="black" stroke="black" points="3419.79,-10957.76 3427.82,-10950.85 3417.23,-10951.24 3419.79,-10957.76"/>
</g>
<!-- layer_8_attn_out_gpu10 -->
<g id="node367" class="node">
<title>layer_8_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3411,-11049.47 3323,-11049.47 3323,-10997.47 3411,-10997.47 3411,-11049.47"/>
<text text-anchor="middle" x="3367" y="-11037.47" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="3367" y="-11026.47" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3367" y="-11015.47" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3367" y="-11004.47" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attn_out_gpu10&#45;&gt;layer_8_allreduce_attn -->
<g id="edge503" class="edge">
<title>layer_8_attn_out_gpu10&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M3396.81,-10997.44C3409.08,-10987.14 3423.42,-10975.1 3436.33,-10964.26"/>
<polygon fill="black" stroke="black" points="3438.74,-10966.81 3444.15,-10957.7 3434.24,-10961.45 3438.74,-10966.81"/>
</g>
<!-- layer_8_attn_out_gpu11 -->
<g id="node368" class="node">
<title>layer_8_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3517,-11049.47 3429,-11049.47 3429,-10997.47 3517,-10997.47 3517,-11049.47"/>
<text text-anchor="middle" x="3473" y="-11037.47" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="3473" y="-11026.47" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3473" y="-11015.47" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3473" y="-11004.47" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attn_out_gpu11&#45;&gt;layer_8_allreduce_attn -->
<g id="edge504" class="edge">
<title>layer_8_attn_out_gpu11&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M3473,-10997.2C3473,-10989.31 3473,-10980.42 3473,-10971.84"/>
<polygon fill="black" stroke="black" points="3476.5,-10971.62 3473,-10961.62 3469.5,-10971.62 3476.5,-10971.62"/>
</g>
<!-- layer_8_attn_out_gpu12 -->
<g id="node369" class="node">
<title>layer_8_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3623,-11049.47 3535,-11049.47 3535,-10997.47 3623,-10997.47 3623,-11049.47"/>
<text text-anchor="middle" x="3579" y="-11037.47" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="3579" y="-11026.47" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3579" y="-11015.47" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3579" y="-11004.47" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attn_out_gpu12&#45;&gt;layer_8_allreduce_attn -->
<g id="edge505" class="edge">
<title>layer_8_attn_out_gpu12&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M3549.19,-10997.44C3536.92,-10987.14 3522.58,-10975.1 3509.67,-10964.26"/>
<polygon fill="black" stroke="black" points="3511.76,-10961.45 3501.85,-10957.7 3507.26,-10966.81 3511.76,-10961.45"/>
</g>
<!-- layer_8_attn_out_gpu13 -->
<g id="node370" class="node">
<title>layer_8_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3729,-11049.47 3641,-11049.47 3641,-10997.47 3729,-10997.47 3729,-11049.47"/>
<text text-anchor="middle" x="3685" y="-11037.47" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="3685" y="-11026.47" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3685" y="-11015.47" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3685" y="-11004.47" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attn_out_gpu13&#45;&gt;layer_8_allreduce_attn -->
<g id="edge506" class="edge">
<title>layer_8_attn_out_gpu13&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M3640.84,-11001.4C3637.86,-11000.05 3634.89,-10998.73 3632,-10997.47 3597.67,-10982.48 3558.66,-10966.76 3527.87,-10954.65"/>
<polygon fill="black" stroke="black" points="3528.77,-10951.24 3518.18,-10950.85 3526.21,-10957.76 3528.77,-10951.24"/>
</g>
<!-- layer_8_attn_out_gpu14 -->
<g id="node371" class="node">
<title>layer_8_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3835,-11049.47 3747,-11049.47 3747,-10997.47 3835,-10997.47 3835,-11049.47"/>
<text text-anchor="middle" x="3791" y="-11037.47" font-family="Arial" font-size="10.00">Layer 8 Attn Out</text>
<text text-anchor="middle" x="3791" y="-11026.47" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3791" y="-11015.47" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3791" y="-11004.47" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_8_attn_out_gpu14&#45;&gt;layer_8_allreduce_attn -->
<g id="edge507" class="edge">
<title>layer_8_attn_out_gpu14&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M3746.74,-11000.79C3743.81,-10999.6 3740.88,-10998.48 3738,-10997.47 3670.87,-10973.81 3591.16,-10955.86 3536.81,-10945.08"/>
<polygon fill="black" stroke="black" points="3537.46,-10941.64 3526.97,-10943.15 3536.11,-10948.51 3537.46,-10941.64"/>
</g>
<!-- layer_8_attn_out_gpu15&#45;&gt;layer_8_allreduce_attn -->
<g id="edge508" class="edge">
<title>layer_8_attn_out_gpu15&#45;&gt;layer_8_allreduce_attn</title>
<path fill="none" stroke="black" d="M3093.18,-11000.56C3096.13,-10999.43 3099.09,-10998.38 3102,-10997.47 3205.43,-10964.81 3330.66,-10947.6 3405.97,-10939.54"/>
<polygon fill="black" stroke="black" points="3406.67,-10942.98 3416.25,-10938.46 3405.94,-10936.02 3406.67,-10942.98"/>
</g>
<!-- layer_8_allreduce_attn&#45;&gt;layer_8_residual1 -->
<g id="edge509" class="edge">
<title>layer_8_allreduce_attn&#45;&gt;layer_8_residual1</title>
<path fill="none" stroke="black" d="M3514.35,-10911.75C3542.12,-10898.51 3579.09,-10880.88 3609.81,-10866.23"/>
<polygon fill="black" stroke="black" points="3611.6,-10869.25 3619.12,-10861.79 3608.59,-10862.94 3611.6,-10869.25"/>
</g>
<!-- layer_8_ln1 -->
<g id="node375" class="node">
<title>layer_8_ln1</title>
<polygon fill="lightblue" stroke="black" points="3499.5,-10771.48 3426.5,-10771.48 3426.5,-10730.48 3499.5,-10730.48 3499.5,-10771.48"/>
<text text-anchor="middle" x="3463" y="-10759.48" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="3463" y="-10748.48" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="3463" y="-10737.48" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_8_residual1&#45;&gt;layer_8_ln1 -->
<g id="edge511" class="edge">
<title>layer_8_residual1&#45;&gt;layer_8_ln1</title>
<path fill="none" stroke="black" d="M3597.45,-10807.4C3568.16,-10795.33 3534.99,-10781.66 3508.93,-10770.92"/>
<polygon fill="black" stroke="black" points="3510.25,-10767.67 3499.67,-10767.1 3507.58,-10774.15 3510.25,-10767.67"/>
</g>
<!-- layer_8_residual2 -->
<g id="node395" class="node">
<title>layer_8_residual2</title>
<polygon fill="lightyellow" stroke="black" points="3828.94,-10258.52 3706.55,-10258.52 3675.06,-10198.52 3797.45,-10198.52 3828.94,-10258.52"/>
<text text-anchor="middle" x="3752" y="-10231.52" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="3752" y="-10220.52" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_8_residual1&#45;&gt;layer_8_residual2 -->
<g id="edge539" class="edge">
<title>layer_8_residual1&#45;&gt;layer_8_residual2</title>
<path fill="none" stroke="black" d="M3725.29,-10829.42C3809.81,-10815.46 3958,-10775.8 3958,-10669.48 3958,-10669.48 3958,-10669.48 3958,-10413.5 3958,-10343.29 3890.61,-10293.21 3832.92,-10263.2"/>
<polygon fill="black" stroke="black" points="3834.26,-10259.95 3823.76,-10258.55 3831.1,-10266.2 3834.26,-10259.95"/>
</g>
<!-- layer_8_mlp_fc1_gpu8 -->
<g id="node376" class="node">
<title>layer_8_mlp_fc1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3062,-10694.48 2968,-10694.48 2968,-10642.48 3062,-10642.48 3062,-10694.48"/>
<text text-anchor="middle" x="3015" y="-10682.48" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="3015" y="-10671.48" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3015" y="-10660.48" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3015" y="-10649.48" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu8 -->
<g id="edge512" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu8</title>
<path fill="none" stroke="black" d="M3426.35,-10748.2C3357.78,-10744.15 3205.67,-10731.73 3071.63,-10694.32"/>
<polygon fill="black" stroke="black" points="3072.58,-10690.95 3062.01,-10691.58 3070.67,-10697.68 3072.58,-10690.95"/>
</g>
<!-- layer_8_mlp_fc1_gpu9 -->
<g id="node377" class="node">
<title>layer_8_mlp_fc1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3174,-10694.48 3080,-10694.48 3080,-10642.48 3174,-10642.48 3174,-10694.48"/>
<text text-anchor="middle" x="3127" y="-10682.48" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="3127" y="-10671.48" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3127" y="-10660.48" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3127" y="-10649.48" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu9 -->
<g id="edge513" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu9</title>
<path fill="none" stroke="black" d="M3426.1,-10745.36C3373.76,-10738.22 3275.05,-10722.62 3183.73,-10694.43"/>
<polygon fill="black" stroke="black" points="3184.66,-10691.05 3174.07,-10691.39 3182.55,-10697.73 3184.66,-10691.05"/>
</g>
<!-- layer_8_mlp_fc1_gpu10 -->
<g id="node378" class="node">
<title>layer_8_mlp_fc1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3286,-10694.48 3192,-10694.48 3192,-10642.48 3286,-10642.48 3286,-10694.48"/>
<text text-anchor="middle" x="3239" y="-10682.48" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="3239" y="-10671.48" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3239" y="-10660.48" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3239" y="-10649.48" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu10 -->
<g id="edge514" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu10</title>
<path fill="none" stroke="black" d="M3426.25,-10739.01C3393.97,-10729.12 3345.62,-10713.68 3295.58,-10694.57"/>
<polygon fill="black" stroke="black" points="3296.8,-10691.29 3286.22,-10690.96 3294.29,-10697.83 3296.8,-10691.29"/>
</g>
<!-- layer_8_mlp_fc1_gpu11 -->
<g id="node379" class="node">
<title>layer_8_mlp_fc1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3398,-10694.48 3304,-10694.48 3304,-10642.48 3398,-10642.48 3398,-10694.48"/>
<text text-anchor="middle" x="3351" y="-10682.48" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="3351" y="-10671.48" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3351" y="-10660.48" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3351" y="-10649.48" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu11 -->
<g id="edge515" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu11</title>
<path fill="none" stroke="black" d="M3435.6,-10730.29C3423.27,-10721.42 3408.4,-10710.74 3394.59,-10700.82"/>
<polygon fill="black" stroke="black" points="3396.33,-10697.75 3386.17,-10694.76 3392.24,-10703.44 3396.33,-10697.75"/>
</g>
<!-- layer_8_mlp_fc1_gpu12 -->
<g id="node380" class="node">
<title>layer_8_mlp_fc1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3510,-10694.48 3416,-10694.48 3416,-10642.48 3510,-10642.48 3510,-10694.48"/>
<text text-anchor="middle" x="3463" y="-10682.48" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="3463" y="-10671.48" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3463" y="-10660.48" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3463" y="-10649.48" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu12 -->
<g id="edge516" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu12</title>
<path fill="none" stroke="black" d="M3463,-10730.08C3463,-10722.47 3463,-10713.54 3463,-10704.91"/>
<polygon fill="black" stroke="black" points="3466.5,-10704.64 3463,-10694.64 3459.5,-10704.64 3466.5,-10704.64"/>
</g>
<!-- layer_8_mlp_fc1_gpu13 -->
<g id="node381" class="node">
<title>layer_8_mlp_fc1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3622,-10694.48 3528,-10694.48 3528,-10642.48 3622,-10642.48 3622,-10694.48"/>
<text text-anchor="middle" x="3575" y="-10682.48" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="3575" y="-10671.48" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3575" y="-10660.48" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3575" y="-10649.48" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu13 -->
<g id="edge517" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu13</title>
<path fill="none" stroke="black" d="M3490.4,-10730.29C3502.73,-10721.42 3517.6,-10710.74 3531.41,-10700.82"/>
<polygon fill="black" stroke="black" points="3533.76,-10703.44 3539.83,-10694.76 3529.67,-10697.75 3533.76,-10703.44"/>
</g>
<!-- layer_8_mlp_fc1_gpu14 -->
<g id="node382" class="node">
<title>layer_8_mlp_fc1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3734,-10694.48 3640,-10694.48 3640,-10642.48 3734,-10642.48 3734,-10694.48"/>
<text text-anchor="middle" x="3687" y="-10682.48" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="3687" y="-10671.48" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3687" y="-10660.48" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3687" y="-10649.48" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu14 -->
<g id="edge518" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu14</title>
<path fill="none" stroke="black" d="M3499.75,-10739.01C3532.03,-10729.12 3580.38,-10713.68 3630.42,-10694.57"/>
<polygon fill="black" stroke="black" points="3631.71,-10697.83 3639.78,-10690.96 3629.2,-10691.29 3631.71,-10697.83"/>
</g>
<!-- layer_8_mlp_fc1_gpu15 -->
<g id="node383" class="node">
<title>layer_8_mlp_fc1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3846,-10694.48 3752,-10694.48 3752,-10642.48 3846,-10642.48 3846,-10694.48"/>
<text text-anchor="middle" x="3799" y="-10682.48" font-family="Arial" font-size="10.00">Layer 8 MLP FC1</text>
<text text-anchor="middle" x="3799" y="-10671.48" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3799" y="-10660.48" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3799" y="-10649.48" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu15 -->
<g id="edge519" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_mlp_fc1_gpu15</title>
<path fill="none" stroke="black" d="M3499.9,-10745.36C3552.24,-10738.22 3650.95,-10722.62 3742.27,-10694.43"/>
<polygon fill="black" stroke="black" points="3743.45,-10697.73 3751.93,-10691.39 3741.34,-10691.05 3743.45,-10697.73"/>
</g>
<!-- layer_8_allgather_mlp -->
<g id="node384" class="node">
<title>layer_8_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="3351" cy="-10577.49" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="3351" y="-10585.99" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="3351" y="-10574.99" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="3351" y="-10563.99" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_8_mlp_fc1_gpu8&#45;&gt;layer_8_allgather_mlp -->
<g id="edge520" class="edge">
<title>layer_8_mlp_fc1_gpu8&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M3062.1,-10645.68C3065.09,-10644.54 3068.07,-10643.46 3071,-10642.48 3143.84,-10618.16 3230.37,-10599.94 3287.76,-10589.29"/>
<polygon fill="black" stroke="black" points="3288.57,-10592.7 3297.78,-10587.45 3287.31,-10585.81 3288.57,-10592.7"/>
</g>
<!-- layer_8_mlp_fc1_gpu9&#45;&gt;layer_8_allgather_mlp -->
<g id="edge521" class="edge">
<title>layer_8_mlp_fc1_gpu9&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M3174.28,-10646.15C3177.22,-10644.89 3180.15,-10643.66 3183,-10642.48 3220.41,-10627.02 3263.04,-10610.8 3295.99,-10598.56"/>
<polygon fill="black" stroke="black" points="3297.29,-10601.81 3305.45,-10595.06 3294.86,-10595.25 3297.29,-10601.81"/>
</g>
<!-- layer_8_mlp_fc1_gpu10&#45;&gt;layer_8_allgather_mlp -->
<g id="edge522" class="edge">
<title>layer_8_mlp_fc1_gpu10&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M3270.5,-10642.46C3283.69,-10631.97 3299.15,-10619.69 3312.98,-10608.7"/>
<polygon fill="black" stroke="black" points="3315.24,-10611.37 3320.9,-10602.41 3310.89,-10605.89 3315.24,-10611.37"/>
</g>
<!-- layer_8_mlp_fc1_gpu11&#45;&gt;layer_8_allgather_mlp -->
<g id="edge523" class="edge">
<title>layer_8_mlp_fc1_gpu11&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M3351,-10642.22C3351,-10634.33 3351,-10625.44 3351,-10616.86"/>
<polygon fill="black" stroke="black" points="3354.5,-10616.63 3351,-10606.63 3347.5,-10616.63 3354.5,-10616.63"/>
</g>
<!-- layer_8_mlp_fc1_gpu12&#45;&gt;layer_8_allgather_mlp -->
<g id="edge524" class="edge">
<title>layer_8_mlp_fc1_gpu12&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M3431.5,-10642.46C3418.31,-10631.97 3402.85,-10619.69 3389.02,-10608.7"/>
<polygon fill="black" stroke="black" points="3391.11,-10605.89 3381.1,-10602.41 3386.76,-10611.37 3391.11,-10605.89"/>
</g>
<!-- layer_8_mlp_fc1_gpu13&#45;&gt;layer_8_allgather_mlp -->
<g id="edge525" class="edge">
<title>layer_8_mlp_fc1_gpu13&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M3527.72,-10646.15C3524.78,-10644.89 3521.85,-10643.66 3519,-10642.48 3481.59,-10627.02 3438.96,-10610.8 3406.01,-10598.56"/>
<polygon fill="black" stroke="black" points="3407.14,-10595.25 3396.55,-10595.06 3404.71,-10601.81 3407.14,-10595.25"/>
</g>
<!-- layer_8_mlp_fc1_gpu14&#45;&gt;layer_8_allgather_mlp -->
<g id="edge526" class="edge">
<title>layer_8_mlp_fc1_gpu14&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M3639.9,-10645.68C3636.91,-10644.54 3633.93,-10643.46 3631,-10642.48 3558.16,-10618.16 3471.63,-10599.94 3414.24,-10589.29"/>
<polygon fill="black" stroke="black" points="3414.69,-10585.81 3404.22,-10587.45 3413.43,-10592.7 3414.69,-10585.81"/>
</g>
<!-- layer_8_mlp_fc1_gpu15&#45;&gt;layer_8_allgather_mlp -->
<g id="edge527" class="edge">
<title>layer_8_mlp_fc1_gpu15&#45;&gt;layer_8_allgather_mlp</title>
<path fill="none" stroke="black" d="M3751.97,-10645.46C3748.96,-10644.37 3745.96,-10643.37 3743,-10642.48 3631.1,-10608.99 3495.65,-10591.8 3416.82,-10584.01"/>
<polygon fill="black" stroke="black" points="3416.84,-10580.49 3406.55,-10583.01 3416.16,-10587.46 3416.84,-10580.49"/>
</g>
<!-- layer_8_gelu -->
<g id="node385" class="node">
<title>layer_8_gelu</title>
<polygon fill="lightblue" stroke="black" points="3227.5,-10512.5 3138.5,-10512.5 3138.5,-10476.5 3227.5,-10476.5 3227.5,-10512.5"/>
<text text-anchor="middle" x="3183" y="-10497.5" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="3183" y="-10486.5" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_8_allgather_mlp&#45;&gt;layer_8_gelu -->
<g id="edge528" class="edge">
<title>layer_8_allgather_mlp&#45;&gt;layer_8_gelu</title>
<path fill="none" stroke="black" d="M3310.76,-10557.09C3285.69,-10545 3253.4,-10529.44 3227.56,-10516.98"/>
<polygon fill="black" stroke="black" points="3228.88,-10513.73 3218.35,-10512.54 3225.84,-10520.04 3228.88,-10513.73"/>
</g>
<!-- layer_8_mlp_fc2_gpu15 -->
<g id="node393" class="node">
<title>layer_8_mlp_fc2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3146,-10440.5 3052,-10440.5 3052,-10388.5 3146,-10388.5 3146,-10440.5"/>
<text text-anchor="middle" x="3099" y="-10428.5" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="3099" y="-10417.5" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3099" y="-10406.5" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3099" y="-10395.5" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu15 -->
<g id="edge529" class="edge">
<title>layer_8_gelu&#45;&gt;layer_8_mlp_fc2_gpu15</title>
<path fill="none" stroke="black" d="M3164.36,-10476.19C3155.33,-10467.81 3144.2,-10457.47 3133.7,-10447.72"/>
<polygon fill="black" stroke="black" points="3135.91,-10445 3126.2,-10440.76 3131.15,-10450.13 3135.91,-10445"/>
</g>
<!-- layer_8_mlp_fc2_gpu8 -->
<g id="node386" class="node">
<title>layer_8_mlp_fc2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3258,-10440.5 3164,-10440.5 3164,-10388.5 3258,-10388.5 3258,-10440.5"/>
<text text-anchor="middle" x="3211" y="-10428.5" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="3211" y="-10417.5" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3211" y="-10406.5" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3211" y="-10395.5" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_allreduce_mlp -->
<g id="node394" class="node">
<title>layer_8_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="3547" cy="-10323.51" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="3547" y="-10332.01" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="3547" y="-10321.01" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="3547" y="-10310.01" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_8_mlp_fc2_gpu8&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge530" class="edge">
<title>layer_8_mlp_fc2_gpu8&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3258.1,-10391.7C3261.09,-10390.56 3264.07,-10389.48 3267,-10388.5 3338.61,-10364.59 3423.46,-10346.58 3480.84,-10335.85"/>
<polygon fill="black" stroke="black" points="3481.67,-10339.26 3490.87,-10334 3480.4,-10332.37 3481.67,-10339.26"/>
</g>
<!-- layer_8_mlp_fc2_gpu9 -->
<g id="node387" class="node">
<title>layer_8_mlp_fc2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3370,-10440.5 3276,-10440.5 3276,-10388.5 3370,-10388.5 3370,-10440.5"/>
<text text-anchor="middle" x="3323" y="-10428.5" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="3323" y="-10417.5" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3323" y="-10406.5" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3323" y="-10395.5" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_mlp_fc2_gpu9&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge531" class="edge">
<title>layer_8_mlp_fc2_gpu9&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3370.28,-10392.17C3373.22,-10390.91 3376.15,-10389.68 3379,-10388.5 3415.89,-10373.26 3457.84,-10357.27 3490.6,-10345.1"/>
<polygon fill="black" stroke="black" points="3491.85,-10348.36 3500.01,-10341.6 3489.42,-10341.8 3491.85,-10348.36"/>
</g>
<!-- layer_8_mlp_fc2_gpu10 -->
<g id="node388" class="node">
<title>layer_8_mlp_fc2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3482,-10440.5 3388,-10440.5 3388,-10388.5 3482,-10388.5 3482,-10440.5"/>
<text text-anchor="middle" x="3435" y="-10428.5" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="3435" y="-10417.5" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3435" y="-10406.5" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3435" y="-10395.5" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_mlp_fc2_gpu10&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge532" class="edge">
<title>layer_8_mlp_fc2_gpu10&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3466.5,-10388.47C3479.59,-10378.07 3494.9,-10365.91 3508.64,-10354.99"/>
<polygon fill="black" stroke="black" points="3510.86,-10357.69 3516.51,-10348.73 3506.51,-10352.21 3510.86,-10357.69"/>
</g>
<!-- layer_8_mlp_fc2_gpu11 -->
<g id="node389" class="node">
<title>layer_8_mlp_fc2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3594,-10440.5 3500,-10440.5 3500,-10388.5 3594,-10388.5 3594,-10440.5"/>
<text text-anchor="middle" x="3547" y="-10428.5" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="3547" y="-10417.5" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3547" y="-10406.5" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3547" y="-10395.5" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_mlp_fc2_gpu11&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge533" class="edge">
<title>layer_8_mlp_fc2_gpu11&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3547,-10388.24C3547,-10380.35 3547,-10371.46 3547,-10362.88"/>
<polygon fill="black" stroke="black" points="3550.5,-10362.65 3547,-10352.65 3543.5,-10362.65 3550.5,-10362.65"/>
</g>
<!-- layer_8_mlp_fc2_gpu12 -->
<g id="node390" class="node">
<title>layer_8_mlp_fc2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3706,-10440.5 3612,-10440.5 3612,-10388.5 3706,-10388.5 3706,-10440.5"/>
<text text-anchor="middle" x="3659" y="-10428.5" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="3659" y="-10417.5" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3659" y="-10406.5" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3659" y="-10395.5" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_mlp_fc2_gpu12&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge534" class="edge">
<title>layer_8_mlp_fc2_gpu12&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3627.5,-10388.47C3614.41,-10378.07 3599.1,-10365.91 3585.36,-10354.99"/>
<polygon fill="black" stroke="black" points="3587.49,-10352.21 3577.49,-10348.73 3583.14,-10357.69 3587.49,-10352.21"/>
</g>
<!-- layer_8_mlp_fc2_gpu13 -->
<g id="node391" class="node">
<title>layer_8_mlp_fc2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3818,-10440.5 3724,-10440.5 3724,-10388.5 3818,-10388.5 3818,-10440.5"/>
<text text-anchor="middle" x="3771" y="-10428.5" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="3771" y="-10417.5" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3771" y="-10406.5" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3771" y="-10395.5" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_mlp_fc2_gpu13&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge535" class="edge">
<title>layer_8_mlp_fc2_gpu13&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3723.72,-10392.17C3720.78,-10390.91 3717.85,-10389.68 3715,-10388.5 3678.11,-10373.26 3636.16,-10357.27 3603.4,-10345.1"/>
<polygon fill="black" stroke="black" points="3604.58,-10341.8 3593.99,-10341.6 3602.15,-10348.36 3604.58,-10341.8"/>
</g>
<!-- layer_8_mlp_fc2_gpu14 -->
<g id="node392" class="node">
<title>layer_8_mlp_fc2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="3930,-10440.5 3836,-10440.5 3836,-10388.5 3930,-10388.5 3930,-10440.5"/>
<text text-anchor="middle" x="3883" y="-10428.5" font-family="Arial" font-size="10.00">Layer 8 MLP FC2</text>
<text text-anchor="middle" x="3883" y="-10417.5" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3883" y="-10406.5" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3883" y="-10395.5" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_8_mlp_fc2_gpu14&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge536" class="edge">
<title>layer_8_mlp_fc2_gpu14&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3835.9,-10391.7C3832.91,-10390.56 3829.93,-10389.48 3827,-10388.5 3755.39,-10364.59 3670.54,-10346.58 3613.16,-10335.85"/>
<polygon fill="black" stroke="black" points="3613.6,-10332.37 3603.13,-10334 3612.33,-10339.26 3613.6,-10332.37"/>
</g>
<!-- layer_8_mlp_fc2_gpu15&#45;&gt;layer_8_allreduce_mlp -->
<g id="edge537" class="edge">
<title>layer_8_mlp_fc2_gpu15&#45;&gt;layer_8_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3146.03,-10391.48C3149.04,-10390.39 3152.04,-10389.39 3155,-10388.5 3265.16,-10355.52 3398.15,-10338.36 3477.47,-10330.39"/>
<polygon fill="black" stroke="black" points="3478.21,-10333.84 3487.82,-10329.38 3477.53,-10326.87 3478.21,-10333.84"/>
</g>
<!-- layer_8_allreduce_mlp&#45;&gt;layer_8_residual2 -->
<g id="edge538" class="edge">
<title>layer_8_allreduce_mlp&#45;&gt;layer_8_residual2</title>
<path fill="none" stroke="black" d="M3589.97,-10303.01C3620,-10289.39 3660.46,-10271.04 3693.43,-10256.08"/>
<polygon fill="black" stroke="black" points="3695.3,-10259.08 3702.96,-10251.76 3692.41,-10252.7 3695.3,-10259.08"/>
</g>
<!-- layer_8_ln2 -->
<g id="node396" class="node">
<title>layer_8_ln2</title>
<polygon fill="lightblue" stroke="black" points="3788.5,-10162.52 3715.5,-10162.52 3715.5,-10121.52 3788.5,-10121.52 3788.5,-10162.52"/>
<text text-anchor="middle" x="3752" y="-10150.52" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="3752" y="-10139.52" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="3752" y="-10128.52" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_8_residual2&#45;&gt;layer_8_ln2 -->
<g id="edge540" class="edge">
<title>layer_8_residual2&#45;&gt;layer_8_ln2</title>
<path fill="none" stroke="black" d="M3752,-10198.44C3752,-10190.11 3752,-10181.03 3752,-10172.67"/>
<polygon fill="black" stroke="black" points="3755.5,-10172.58 3752,-10162.58 3748.5,-10172.58 3755.5,-10172.58"/>
</g>
<!-- layer_8_output_dist -->
<g id="node397" class="node">
<title>layer_8_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="3853.7,-10085.52 3691.92,-10085.52 3650.3,-10025.52 3812.08,-10025.52 3853.7,-10085.52"/>
<text text-anchor="middle" x="3752" y="-10058.52" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="3752" y="-10047.52" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_8_ln2&#45;&gt;layer_8_output_dist -->
<g id="edge541" class="edge">
<title>layer_8_ln2&#45;&gt;layer_8_output_dist</title>
<path fill="none" stroke="black" d="M3752,-10121.42C3752,-10113.78 3752,-10104.74 3752,-10095.87"/>
<polygon fill="black" stroke="black" points="3755.5,-10095.63 3752,-10085.63 3748.5,-10095.63 3755.5,-10095.63"/>
</g>
<!-- layer_9_input_dist -->
<g id="node398" class="node">
<title>layer_9_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="3846.19,-9989.52 3696.36,-9989.52 3657.81,-9929.52 3807.64,-9929.52 3846.19,-9989.52"/>
<text text-anchor="middle" x="3752" y="-9962.52" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="3752" y="-9951.52" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_8_output_dist&#45;&gt;layer_9_input_dist -->
<g id="edge542" class="edge">
<title>layer_8_output_dist&#45;&gt;layer_9_input_dist</title>
<path fill="none" stroke="black" d="M3752,-10025.29C3752,-10017.24 3752,-10008.38 3752,-9999.87"/>
<polygon fill="black" stroke="black" points="3755.5,-9999.73 3752,-9989.73 3748.5,-9999.73 3755.5,-9999.73"/>
</g>
<!-- layer_9_qkv_gpu8 -->
<g id="node399" class="node">
<title>layer_9_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3354.5,-9893.52 3261.5,-9893.52 3261.5,-9841.52 3354.5,-9841.52 3354.5,-9893.52"/>
<text text-anchor="middle" x="3308" y="-9881.52" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="3308" y="-9870.52" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3308" y="-9859.52" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3308" y="-9848.52" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu8 -->
<g id="edge543" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu8</title>
<path fill="none" stroke="black" d="M3671.5,-9951.06C3594.32,-9942.55 3474.81,-9925.81 3364.36,-9893.29"/>
<polygon fill="black" stroke="black" points="3365.31,-9889.93 3354.72,-9890.41 3363.3,-9896.63 3365.31,-9889.93"/>
</g>
<!-- layer_9_qkv_gpu9 -->
<g id="node400" class="node">
<title>layer_9_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3465.5,-9893.52 3372.5,-9893.52 3372.5,-9841.52 3465.5,-9841.52 3465.5,-9893.52"/>
<text text-anchor="middle" x="3419" y="-9881.52" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="3419" y="-9870.52" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3419" y="-9859.52" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3419" y="-9848.52" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu9 -->
<g id="edge544" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu9</title>
<path fill="none" stroke="black" d="M3666.28,-9942.77C3613.43,-9932.05 3544.37,-9916.21 3475.51,-9893.44"/>
<polygon fill="black" stroke="black" points="3476.39,-9890.04 3465.8,-9890.18 3474.16,-9896.68 3476.39,-9890.04"/>
</g>
<!-- layer_9_qkv_gpu10 -->
<g id="node401" class="node">
<title>layer_9_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3576.5,-9893.52 3483.5,-9893.52 3483.5,-9841.52 3576.5,-9841.52 3576.5,-9893.52"/>
<text text-anchor="middle" x="3530" y="-9881.52" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="3530" y="-9870.52" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3530" y="-9859.52" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3530" y="-9848.52" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu10 -->
<g id="edge545" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu10</title>
<path fill="none" stroke="black" d="M3675.67,-9929.49C3647.39,-9918.51 3615.12,-9905.71 3586,-9893.52 3585.9,-9893.48 3585.81,-9893.44 3585.71,-9893.4"/>
<polygon fill="black" stroke="black" points="3587.25,-9890.25 3576.68,-9889.55 3584.51,-9896.69 3587.25,-9890.25"/>
</g>
<!-- layer_9_qkv_gpu11 -->
<g id="node402" class="node">
<title>layer_9_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3687.5,-9893.52 3594.5,-9893.52 3594.5,-9841.52 3687.5,-9841.52 3687.5,-9893.52"/>
<text text-anchor="middle" x="3641" y="-9881.52" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="3641" y="-9870.52" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3641" y="-9859.52" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3641" y="-9848.52" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu11 -->
<g id="edge546" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu11</title>
<path fill="none" stroke="black" d="M3715.96,-9929.3C3704.44,-9919.96 3691.64,-9909.57 3679.92,-9900.07"/>
<polygon fill="black" stroke="black" points="3681.98,-9897.24 3672.01,-9893.66 3677.58,-9902.68 3681.98,-9897.24"/>
</g>
<!-- layer_9_qkv_gpu12 -->
<g id="node403" class="node">
<title>layer_9_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3798.5,-9893.52 3705.5,-9893.52 3705.5,-9841.52 3798.5,-9841.52 3798.5,-9893.52"/>
<text text-anchor="middle" x="3752" y="-9881.52" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="3752" y="-9870.52" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3752" y="-9859.52" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3752" y="-9848.52" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu12 -->
<g id="edge547" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu12</title>
<path fill="none" stroke="black" d="M3752,-9929.05C3752,-9920.97 3752,-9912.14 3752,-9903.78"/>
<polygon fill="black" stroke="black" points="3755.5,-9903.53 3752,-9893.53 3748.5,-9903.53 3755.5,-9903.53"/>
</g>
<!-- layer_9_qkv_gpu13 -->
<g id="node404" class="node">
<title>layer_9_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3909.5,-9893.52 3816.5,-9893.52 3816.5,-9841.52 3909.5,-9841.52 3909.5,-9893.52"/>
<text text-anchor="middle" x="3863" y="-9881.52" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="3863" y="-9870.52" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3863" y="-9859.52" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3863" y="-9848.52" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu13 -->
<g id="edge548" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu13</title>
<path fill="none" stroke="black" d="M3788.04,-9929.3C3799.56,-9919.96 3812.36,-9909.57 3824.08,-9900.07"/>
<polygon fill="black" stroke="black" points="3826.42,-9902.68 3831.99,-9893.66 3822.02,-9897.24 3826.42,-9902.68"/>
</g>
<!-- layer_9_qkv_gpu14 -->
<g id="node405" class="node">
<title>layer_9_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4020.5,-9893.52 3927.5,-9893.52 3927.5,-9841.52 4020.5,-9841.52 4020.5,-9893.52"/>
<text text-anchor="middle" x="3974" y="-9881.52" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="3974" y="-9870.52" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3974" y="-9859.52" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="3974" y="-9848.52" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu14 -->
<g id="edge549" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu14</title>
<path fill="none" stroke="black" d="M3812.23,-9936C3841.83,-9924.72 3878.18,-9910.55 3917.92,-9893.9"/>
<polygon fill="black" stroke="black" points="3919.41,-9897.08 3927.27,-9889.97 3916.7,-9890.62 3919.41,-9897.08"/>
</g>
<!-- layer_9_qkv_gpu15 -->
<g id="node406" class="node">
<title>layer_9_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4131.5,-9893.52 4038.5,-9893.52 4038.5,-9841.52 4131.5,-9841.52 4131.5,-9893.52"/>
<text text-anchor="middle" x="4085" y="-9881.52" font-family="Arial" font-size="10.00">Layer 9 QKV Proj</text>
<text text-anchor="middle" x="4085" y="-9870.52" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="4085" y="-9859.52" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="4085" y="-9848.52" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_qkv_gpu15 -->
<g id="edge550" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_qkv_gpu15</title>
<path fill="none" stroke="black" d="M3818.75,-9946.75C3873.38,-9936.25 3952.57,-9919.04 4028.7,-9893.73"/>
<polygon fill="black" stroke="black" points="4030.09,-9896.95 4038.45,-9890.43 4027.85,-9890.32 4030.09,-9896.95"/>
</g>
<!-- layer_9_residual1 -->
<g id="node418" class="node">
<title>layer_9_residual1</title>
<polygon fill="lightyellow" stroke="black" points="4115.94,-9441.55 3993.55,-9441.55 3962.06,-9381.55 4084.45,-9381.55 4115.94,-9441.55"/>
<text text-anchor="middle" x="4039" y="-9414.55" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="4039" y="-9403.55" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_9_input_dist&#45;&gt;layer_9_residual1 -->
<g id="edge570" class="edge">
<title>layer_9_input_dist&#45;&gt;layer_9_residual1</title>
<path fill="none" stroke="black" d="M3822.87,-9952.75C3919.96,-9943.83 4088.28,-9924.42 4141,-9893.52 4198,-9860.1 4234,-9843.6 4234,-9777.53 4234,-9777.53 4234,-9777.53 4234,-9596.53 4234,-9527.75 4169.02,-9477.08 4114.09,-9446.52"/>
<polygon fill="black" stroke="black" points="4115.48,-9443.29 4105.02,-9441.6 4112.14,-9449.44 4115.48,-9443.29"/>
</g>
<!-- layer_9_allgather_qkv -->
<g id="node407" class="node">
<title>layer_9_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="3641" cy="-9776.53" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="3641" y="-9785.03" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="3641" y="-9774.03" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="3641" y="-9763.03" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_9_qkv_gpu8&#45;&gt;layer_9_allgather_qkv -->
<g id="edge551" class="edge">
<title>layer_9_qkv_gpu8&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M3354.79,-9844.84C3357.88,-9843.65 3360.97,-9842.53 3364,-9841.52 3435.63,-9817.51 3520.62,-9799.33 3577.4,-9788.6"/>
<polygon fill="black" stroke="black" points="3578.12,-9792.02 3587.31,-9786.75 3576.84,-9785.14 3578.12,-9792.02"/>
</g>
<!-- layer_9_qkv_gpu9&#45;&gt;layer_9_allgather_qkv -->
<g id="edge552" class="edge">
<title>layer_9_qkv_gpu9&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M3465.67,-9845.46C3468.82,-9844.11 3471.95,-9842.78 3475,-9841.52 3511.7,-9826.26 3553.45,-9810.17 3585.9,-9797.95"/>
<polygon fill="black" stroke="black" points="3587.53,-9801.07 3595.66,-9794.28 3585.06,-9794.52 3587.53,-9801.07"/>
</g>
<!-- layer_9_qkv_gpu10&#45;&gt;layer_9_allgather_qkv -->
<g id="edge553" class="edge">
<title>layer_9_qkv_gpu10&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M3561.22,-9841.49C3574.29,-9831.01 3589.61,-9818.72 3603.31,-9807.74"/>
<polygon fill="black" stroke="black" points="3605.55,-9810.43 3611.17,-9801.45 3601.17,-9804.97 3605.55,-9810.43"/>
</g>
<!-- layer_9_qkv_gpu11&#45;&gt;layer_9_allgather_qkv -->
<g id="edge554" class="edge">
<title>layer_9_qkv_gpu11&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M3641,-9841.25C3641,-9833.36 3641,-9824.47 3641,-9815.89"/>
<polygon fill="black" stroke="black" points="3644.5,-9815.67 3641,-9805.67 3637.5,-9815.67 3644.5,-9815.67"/>
</g>
<!-- layer_9_qkv_gpu12&#45;&gt;layer_9_allgather_qkv -->
<g id="edge555" class="edge">
<title>layer_9_qkv_gpu12&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M3720.78,-9841.49C3707.71,-9831.01 3692.39,-9818.72 3678.69,-9807.74"/>
<polygon fill="black" stroke="black" points="3680.83,-9804.97 3670.83,-9801.45 3676.45,-9810.43 3680.83,-9804.97"/>
</g>
<!-- layer_9_qkv_gpu13&#45;&gt;layer_9_allgather_qkv -->
<g id="edge556" class="edge">
<title>layer_9_qkv_gpu13&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M3816.28,-9845.05C3813.48,-9843.84 3810.71,-9842.65 3808,-9841.52 3770.98,-9826.03 3728.78,-9809.87 3696.06,-9797.66"/>
<polygon fill="black" stroke="black" points="3697.25,-9794.37 3686.66,-9794.17 3694.81,-9800.93 3697.25,-9794.37"/>
</g>
<!-- layer_9_qkv_gpu14&#45;&gt;layer_9_allgather_qkv -->
<g id="edge557" class="edge">
<title>layer_9_qkv_gpu14&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M3927.45,-9844.59C3924.61,-9843.49 3921.78,-9842.46 3919,-9841.52 3847.2,-9817.21 3761.88,-9799.09 3704.87,-9788.45"/>
<polygon fill="black" stroke="black" points="3705.39,-9784.99 3694.92,-9786.62 3704.12,-9791.87 3705.39,-9784.99"/>
</g>
<!-- layer_9_qkv_gpu15&#45;&gt;layer_9_allgather_qkv -->
<g id="edge558" class="edge">
<title>layer_9_qkv_gpu15&#45;&gt;layer_9_allgather_qkv</title>
<path fill="none" stroke="black" d="M4038.21,-9844.27C4035.46,-9843.27 4032.71,-9842.34 4030,-9841.52 3919.69,-9808.02 3786.14,-9790.9 3707.68,-9783.11"/>
<polygon fill="black" stroke="black" points="3707.75,-9779.6 3697.45,-9782.11 3707.07,-9786.56 3707.75,-9779.6"/>
</g>
<!-- layer_9_attention -->
<g id="node408" class="node">
<title>layer_9_attention</title>
<polygon fill="lightblue" stroke="black" points="3601,-9711.53 3533,-9711.53 3533,-9659.53 3601,-9659.53 3601,-9711.53"/>
<text text-anchor="middle" x="3567" y="-9699.53" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="3567" y="-9688.53" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3567" y="-9677.53" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="3567" y="-9666.53" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_9_allgather_qkv&#45;&gt;layer_9_attention -->
<g id="edge559" class="edge">
<title>layer_9_allgather_qkv&#45;&gt;layer_9_attention</title>
<path fill="none" stroke="black" d="M3619.2,-9749.31C3611.39,-9739.92 3602.5,-9729.22 3594.29,-9719.35"/>
<polygon fill="black" stroke="black" points="3596.97,-9717.1 3587.88,-9711.65 3591.59,-9721.58 3596.97,-9717.1"/>
</g>
<!-- layer_9_attn_out_gpu15 -->
<g id="node416" class="node">
<title>layer_9_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3464,-9623.53 3376,-9623.53 3376,-9571.53 3464,-9571.53 3464,-9623.53"/>
<text text-anchor="middle" x="3420" y="-9611.53" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="3420" y="-9600.53" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3420" y="-9589.53" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3420" y="-9578.53" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attention&#45;&gt;layer_9_attn_out_gpu15 -->
<g id="edge560" class="edge">
<title>layer_9_attention&#45;&gt;layer_9_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M3532.91,-9664.59C3514.73,-9653.96 3491.99,-9640.65 3471.69,-9628.78"/>
<polygon fill="black" stroke="black" points="3473.26,-9625.64 3462.86,-9623.61 3469.73,-9631.68 3473.26,-9625.64"/>
</g>
<!-- layer_9_attn_out_gpu8 -->
<g id="node409" class="node">
<title>layer_9_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3570,-9623.53 3482,-9623.53 3482,-9571.53 3570,-9571.53 3570,-9623.53"/>
<text text-anchor="middle" x="3526" y="-9611.53" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="3526" y="-9600.53" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3526" y="-9589.53" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3526" y="-9578.53" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_allreduce_attn -->
<g id="node417" class="node">
<title>layer_9_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="3844" cy="-9506.54" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="3844" y="-9515.04" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="3844" y="-9504.04" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="3844" y="-9493.04" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_9_attn_out_gpu8&#45;&gt;layer_9_allreduce_attn -->
<g id="edge561" class="edge">
<title>layer_9_attn_out_gpu8&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M3570.26,-9574.86C3573.19,-9573.67 3576.12,-9572.55 3579,-9571.53 3646.13,-9547.87 3725.84,-9529.93 3780.19,-9519.15"/>
<polygon fill="black" stroke="black" points="3780.89,-9522.58 3790.03,-9517.22 3779.54,-9515.71 3780.89,-9522.58"/>
</g>
<!-- layer_9_attn_out_gpu9 -->
<g id="node410" class="node">
<title>layer_9_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3676,-9623.53 3588,-9623.53 3588,-9571.53 3676,-9571.53 3676,-9623.53"/>
<text text-anchor="middle" x="3632" y="-9611.53" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="3632" y="-9600.53" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3632" y="-9589.53" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3632" y="-9578.53" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attn_out_gpu9&#45;&gt;layer_9_allreduce_attn -->
<g id="edge562" class="edge">
<title>layer_9_attn_out_gpu9&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M3676.16,-9575.47C3679.14,-9574.12 3682.11,-9572.8 3685,-9571.53 3719.33,-9556.55 3758.34,-9540.83 3789.13,-9528.72"/>
<polygon fill="black" stroke="black" points="3790.79,-9531.83 3798.82,-9524.92 3788.23,-9525.31 3790.79,-9531.83"/>
</g>
<!-- layer_9_attn_out_gpu10 -->
<g id="node411" class="node">
<title>layer_9_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3782,-9623.53 3694,-9623.53 3694,-9571.53 3782,-9571.53 3782,-9623.53"/>
<text text-anchor="middle" x="3738" y="-9611.53" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="3738" y="-9600.53" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3738" y="-9589.53" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3738" y="-9578.53" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attn_out_gpu10&#45;&gt;layer_9_allreduce_attn -->
<g id="edge563" class="edge">
<title>layer_9_attn_out_gpu10&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M3767.81,-9571.51C3780.08,-9561.21 3794.42,-9549.17 3807.33,-9538.33"/>
<polygon fill="black" stroke="black" points="3809.74,-9540.88 3815.15,-9531.77 3805.24,-9535.52 3809.74,-9540.88"/>
</g>
<!-- layer_9_attn_out_gpu11 -->
<g id="node412" class="node">
<title>layer_9_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3888,-9623.53 3800,-9623.53 3800,-9571.53 3888,-9571.53 3888,-9623.53"/>
<text text-anchor="middle" x="3844" y="-9611.53" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="3844" y="-9600.53" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3844" y="-9589.53" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3844" y="-9578.53" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attn_out_gpu11&#45;&gt;layer_9_allreduce_attn -->
<g id="edge564" class="edge">
<title>layer_9_attn_out_gpu11&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M3844,-9571.27C3844,-9563.38 3844,-9554.49 3844,-9545.91"/>
<polygon fill="black" stroke="black" points="3847.5,-9545.69 3844,-9535.69 3840.5,-9545.69 3847.5,-9545.69"/>
</g>
<!-- layer_9_attn_out_gpu12 -->
<g id="node413" class="node">
<title>layer_9_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3994,-9623.53 3906,-9623.53 3906,-9571.53 3994,-9571.53 3994,-9623.53"/>
<text text-anchor="middle" x="3950" y="-9611.53" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="3950" y="-9600.53" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3950" y="-9589.53" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3950" y="-9578.53" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attn_out_gpu12&#45;&gt;layer_9_allreduce_attn -->
<g id="edge565" class="edge">
<title>layer_9_attn_out_gpu12&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M3920.19,-9571.51C3907.92,-9561.21 3893.58,-9549.17 3880.67,-9538.33"/>
<polygon fill="black" stroke="black" points="3882.76,-9535.52 3872.85,-9531.77 3878.26,-9540.88 3882.76,-9535.52"/>
</g>
<!-- layer_9_attn_out_gpu13 -->
<g id="node414" class="node">
<title>layer_9_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="4100,-9623.53 4012,-9623.53 4012,-9571.53 4100,-9571.53 4100,-9623.53"/>
<text text-anchor="middle" x="4056" y="-9611.53" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="4056" y="-9600.53" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="4056" y="-9589.53" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="4056" y="-9578.53" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attn_out_gpu13&#45;&gt;layer_9_allreduce_attn -->
<g id="edge566" class="edge">
<title>layer_9_attn_out_gpu13&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M4011.84,-9575.47C4008.86,-9574.12 4005.89,-9572.8 4003,-9571.53 3968.67,-9556.55 3929.66,-9540.83 3898.87,-9528.72"/>
<polygon fill="black" stroke="black" points="3899.77,-9525.31 3889.18,-9524.92 3897.21,-9531.83 3899.77,-9525.31"/>
</g>
<!-- layer_9_attn_out_gpu14 -->
<g id="node415" class="node">
<title>layer_9_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4206,-9623.53 4118,-9623.53 4118,-9571.53 4206,-9571.53 4206,-9623.53"/>
<text text-anchor="middle" x="4162" y="-9611.53" font-family="Arial" font-size="10.00">Layer 9 Attn Out</text>
<text text-anchor="middle" x="4162" y="-9600.53" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="4162" y="-9589.53" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="4162" y="-9578.53" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_9_attn_out_gpu14&#45;&gt;layer_9_allreduce_attn -->
<g id="edge567" class="edge">
<title>layer_9_attn_out_gpu14&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M4117.74,-9574.86C4114.81,-9573.67 4111.88,-9572.55 4109,-9571.53 4041.87,-9547.87 3962.16,-9529.93 3907.81,-9519.15"/>
<polygon fill="black" stroke="black" points="3908.46,-9515.71 3897.97,-9517.22 3907.11,-9522.58 3908.46,-9515.71"/>
</g>
<!-- layer_9_attn_out_gpu15&#45;&gt;layer_9_allreduce_attn -->
<g id="edge568" class="edge">
<title>layer_9_attn_out_gpu15&#45;&gt;layer_9_allreduce_attn</title>
<path fill="none" stroke="black" d="M3464.18,-9574.63C3467.13,-9573.5 3470.09,-9572.45 3473,-9571.53 3576.43,-9538.88 3701.66,-9521.67 3776.97,-9513.61"/>
<polygon fill="black" stroke="black" points="3777.67,-9517.05 3787.25,-9512.53 3776.94,-9510.09 3777.67,-9517.05"/>
</g>
<!-- layer_9_allreduce_attn&#45;&gt;layer_9_residual1 -->
<g id="edge569" class="edge">
<title>layer_9_allreduce_attn&#45;&gt;layer_9_residual1</title>
<path fill="none" stroke="black" d="M3885.35,-9485.82C3913.12,-9472.58 3950.09,-9454.95 3980.81,-9440.3"/>
<polygon fill="black" stroke="black" points="3982.6,-9443.32 3990.12,-9435.86 3979.59,-9437.01 3982.6,-9443.32"/>
</g>
<!-- layer_9_ln1 -->
<g id="node419" class="node">
<title>layer_9_ln1</title>
<polygon fill="lightblue" stroke="black" points="3870.5,-9345.55 3797.5,-9345.55 3797.5,-9304.55 3870.5,-9304.55 3870.5,-9345.55"/>
<text text-anchor="middle" x="3834" y="-9333.55" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="3834" y="-9322.55" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="3834" y="-9311.55" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_9_residual1&#45;&gt;layer_9_ln1 -->
<g id="edge571" class="edge">
<title>layer_9_residual1&#45;&gt;layer_9_ln1</title>
<path fill="none" stroke="black" d="M3968.45,-9381.47C3939.16,-9369.4 3905.99,-9355.73 3879.93,-9344.98"/>
<polygon fill="black" stroke="black" points="3881.25,-9341.74 3870.67,-9341.17 3878.58,-9348.21 3881.25,-9341.74"/>
</g>
<!-- layer_9_residual2 -->
<g id="node439" class="node">
<title>layer_9_residual2</title>
<polygon fill="lightyellow" stroke="black" points="4199.94,-8832.59 4077.55,-8832.59 4046.06,-8772.59 4168.45,-8772.59 4199.94,-8832.59"/>
<text text-anchor="middle" x="4123" y="-8805.59" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="4123" y="-8794.59" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_9_residual1&#45;&gt;layer_9_residual2 -->
<g id="edge599" class="edge">
<title>layer_9_residual1&#45;&gt;layer_9_residual2</title>
<path fill="none" stroke="black" d="M4096.29,-9403.49C4180.81,-9389.52 4329,-9349.87 4329,-9243.55 4329,-9243.55 4329,-9243.55 4329,-8987.57 4329,-8917.36 4261.61,-8867.28 4203.92,-8837.27"/>
<polygon fill="black" stroke="black" points="4205.26,-8834.02 4194.76,-8832.62 4202.1,-8840.27 4205.26,-8834.02"/>
</g>
<!-- layer_9_mlp_fc1_gpu8 -->
<g id="node420" class="node">
<title>layer_9_mlp_fc1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3433,-9268.55 3339,-9268.55 3339,-9216.55 3433,-9216.55 3433,-9268.55"/>
<text text-anchor="middle" x="3386" y="-9256.55" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="3386" y="-9245.55" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3386" y="-9234.55" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3386" y="-9223.55" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu8 -->
<g id="edge572" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu8</title>
<path fill="none" stroke="black" d="M3797.35,-9322.27C3728.78,-9318.22 3576.67,-9305.8 3442.63,-9268.38"/>
<polygon fill="black" stroke="black" points="3443.58,-9265.02 3433.01,-9265.65 3441.67,-9271.75 3443.58,-9265.02"/>
</g>
<!-- layer_9_mlp_fc1_gpu9 -->
<g id="node421" class="node">
<title>layer_9_mlp_fc1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3545,-9268.55 3451,-9268.55 3451,-9216.55 3545,-9216.55 3545,-9268.55"/>
<text text-anchor="middle" x="3498" y="-9256.55" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="3498" y="-9245.55" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3498" y="-9234.55" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3498" y="-9223.55" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu9 -->
<g id="edge573" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu9</title>
<path fill="none" stroke="black" d="M3797.1,-9319.43C3744.76,-9312.29 3646.05,-9296.69 3554.73,-9268.5"/>
<polygon fill="black" stroke="black" points="3555.66,-9265.12 3545.07,-9265.46 3553.55,-9271.8 3555.66,-9265.12"/>
</g>
<!-- layer_9_mlp_fc1_gpu10 -->
<g id="node422" class="node">
<title>layer_9_mlp_fc1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3657,-9268.55 3563,-9268.55 3563,-9216.55 3657,-9216.55 3657,-9268.55"/>
<text text-anchor="middle" x="3610" y="-9256.55" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="3610" y="-9245.55" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3610" y="-9234.55" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3610" y="-9223.55" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu10 -->
<g id="edge574" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu10</title>
<path fill="none" stroke="black" d="M3797.25,-9313.08C3764.97,-9303.19 3716.62,-9287.74 3666.58,-9268.64"/>
<polygon fill="black" stroke="black" points="3667.8,-9265.36 3657.22,-9265.03 3665.29,-9271.89 3667.8,-9265.36"/>
</g>
<!-- layer_9_mlp_fc1_gpu11 -->
<g id="node423" class="node">
<title>layer_9_mlp_fc1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3769,-9268.55 3675,-9268.55 3675,-9216.55 3769,-9216.55 3769,-9268.55"/>
<text text-anchor="middle" x="3722" y="-9256.55" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="3722" y="-9245.55" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3722" y="-9234.55" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3722" y="-9223.55" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu11 -->
<g id="edge575" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu11</title>
<path fill="none" stroke="black" d="M3806.6,-9304.36C3794.27,-9295.49 3779.4,-9284.81 3765.59,-9274.89"/>
<polygon fill="black" stroke="black" points="3767.33,-9271.82 3757.17,-9268.83 3763.24,-9277.51 3767.33,-9271.82"/>
</g>
<!-- layer_9_mlp_fc1_gpu12 -->
<g id="node424" class="node">
<title>layer_9_mlp_fc1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3881,-9268.55 3787,-9268.55 3787,-9216.55 3881,-9216.55 3881,-9268.55"/>
<text text-anchor="middle" x="3834" y="-9256.55" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="3834" y="-9245.55" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3834" y="-9234.55" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="3834" y="-9223.55" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu12 -->
<g id="edge576" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu12</title>
<path fill="none" stroke="black" d="M3834,-9304.15C3834,-9296.54 3834,-9287.61 3834,-9278.98"/>
<polygon fill="black" stroke="black" points="3837.5,-9278.71 3834,-9268.71 3830.5,-9278.71 3837.5,-9278.71"/>
</g>
<!-- layer_9_mlp_fc1_gpu13 -->
<g id="node425" class="node">
<title>layer_9_mlp_fc1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3993,-9268.55 3899,-9268.55 3899,-9216.55 3993,-9216.55 3993,-9268.55"/>
<text text-anchor="middle" x="3946" y="-9256.55" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="3946" y="-9245.55" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3946" y="-9234.55" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="3946" y="-9223.55" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu13 -->
<g id="edge577" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu13</title>
<path fill="none" stroke="black" d="M3861.4,-9304.36C3873.73,-9295.49 3888.6,-9284.81 3902.41,-9274.89"/>
<polygon fill="black" stroke="black" points="3904.76,-9277.51 3910.83,-9268.83 3900.67,-9271.82 3904.76,-9277.51"/>
</g>
<!-- layer_9_mlp_fc1_gpu14 -->
<g id="node426" class="node">
<title>layer_9_mlp_fc1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4105,-9268.55 4011,-9268.55 4011,-9216.55 4105,-9216.55 4105,-9268.55"/>
<text text-anchor="middle" x="4058" y="-9256.55" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="4058" y="-9245.55" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="4058" y="-9234.55" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="4058" y="-9223.55" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu14 -->
<g id="edge578" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu14</title>
<path fill="none" stroke="black" d="M3870.75,-9313.08C3903.03,-9303.19 3951.38,-9287.74 4001.42,-9268.64"/>
<polygon fill="black" stroke="black" points="4002.71,-9271.89 4010.78,-9265.03 4000.2,-9265.36 4002.71,-9271.89"/>
</g>
<!-- layer_9_mlp_fc1_gpu15 -->
<g id="node427" class="node">
<title>layer_9_mlp_fc1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4217,-9268.55 4123,-9268.55 4123,-9216.55 4217,-9216.55 4217,-9268.55"/>
<text text-anchor="middle" x="4170" y="-9256.55" font-family="Arial" font-size="10.00">Layer 9 MLP FC1</text>
<text text-anchor="middle" x="4170" y="-9245.55" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="4170" y="-9234.55" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="4170" y="-9223.55" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu15 -->
<g id="edge579" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_mlp_fc1_gpu15</title>
<path fill="none" stroke="black" d="M3870.9,-9319.43C3923.24,-9312.29 4021.95,-9296.69 4113.27,-9268.5"/>
<polygon fill="black" stroke="black" points="4114.45,-9271.8 4122.93,-9265.46 4112.34,-9265.12 4114.45,-9271.8"/>
</g>
<!-- layer_9_allgather_mlp -->
<g id="node428" class="node">
<title>layer_9_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="3722" cy="-9151.56" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="3722" y="-9160.06" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="3722" y="-9149.06" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="3722" y="-9138.06" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_9_mlp_fc1_gpu8&#45;&gt;layer_9_allgather_mlp -->
<g id="edge580" class="edge">
<title>layer_9_mlp_fc1_gpu8&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M3433.1,-9219.75C3436.09,-9218.61 3439.07,-9217.53 3442,-9216.55 3514.84,-9192.23 3601.37,-9174.01 3658.76,-9163.36"/>
<polygon fill="black" stroke="black" points="3659.57,-9166.77 3668.78,-9161.52 3658.31,-9159.88 3659.57,-9166.77"/>
</g>
<!-- layer_9_mlp_fc1_gpu9&#45;&gt;layer_9_allgather_mlp -->
<g id="edge581" class="edge">
<title>layer_9_mlp_fc1_gpu9&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M3545.28,-9220.22C3548.22,-9218.96 3551.15,-9217.73 3554,-9216.55 3591.41,-9201.09 3634.04,-9184.87 3666.99,-9172.63"/>
<polygon fill="black" stroke="black" points="3668.29,-9175.88 3676.45,-9169.12 3665.86,-9169.32 3668.29,-9175.88"/>
</g>
<!-- layer_9_mlp_fc1_gpu10&#45;&gt;layer_9_allgather_mlp -->
<g id="edge582" class="edge">
<title>layer_9_mlp_fc1_gpu10&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M3641.5,-9216.53C3654.69,-9206.04 3670.15,-9193.76 3683.98,-9182.77"/>
<polygon fill="black" stroke="black" points="3686.24,-9185.44 3691.9,-9176.48 3681.89,-9179.96 3686.24,-9185.44"/>
</g>
<!-- layer_9_mlp_fc1_gpu11&#45;&gt;layer_9_allgather_mlp -->
<g id="edge583" class="edge">
<title>layer_9_mlp_fc1_gpu11&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M3722,-9216.29C3722,-9208.4 3722,-9199.51 3722,-9190.93"/>
<polygon fill="black" stroke="black" points="3725.5,-9190.7 3722,-9180.7 3718.5,-9190.7 3725.5,-9190.7"/>
</g>
<!-- layer_9_mlp_fc1_gpu12&#45;&gt;layer_9_allgather_mlp -->
<g id="edge584" class="edge">
<title>layer_9_mlp_fc1_gpu12&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M3802.5,-9216.53C3789.31,-9206.04 3773.85,-9193.76 3760.02,-9182.77"/>
<polygon fill="black" stroke="black" points="3762.11,-9179.96 3752.1,-9176.48 3757.76,-9185.44 3762.11,-9179.96"/>
</g>
<!-- layer_9_mlp_fc1_gpu13&#45;&gt;layer_9_allgather_mlp -->
<g id="edge585" class="edge">
<title>layer_9_mlp_fc1_gpu13&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M3898.72,-9220.22C3895.78,-9218.96 3892.85,-9217.73 3890,-9216.55 3852.59,-9201.09 3809.96,-9184.87 3777.01,-9172.63"/>
<polygon fill="black" stroke="black" points="3778.14,-9169.32 3767.55,-9169.12 3775.71,-9175.88 3778.14,-9169.32"/>
</g>
<!-- layer_9_mlp_fc1_gpu14&#45;&gt;layer_9_allgather_mlp -->
<g id="edge586" class="edge">
<title>layer_9_mlp_fc1_gpu14&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M4010.9,-9219.75C4007.91,-9218.61 4004.93,-9217.53 4002,-9216.55 3929.16,-9192.23 3842.63,-9174.01 3785.24,-9163.36"/>
<polygon fill="black" stroke="black" points="3785.69,-9159.88 3775.22,-9161.52 3784.43,-9166.77 3785.69,-9159.88"/>
</g>
<!-- layer_9_mlp_fc1_gpu15&#45;&gt;layer_9_allgather_mlp -->
<g id="edge587" class="edge">
<title>layer_9_mlp_fc1_gpu15&#45;&gt;layer_9_allgather_mlp</title>
<path fill="none" stroke="black" d="M4122.97,-9219.53C4119.96,-9218.44 4116.96,-9217.44 4114,-9216.55 4002.1,-9183.06 3866.65,-9165.87 3787.82,-9158.08"/>
<polygon fill="black" stroke="black" points="3787.84,-9154.56 3777.55,-9157.08 3787.16,-9161.53 3787.84,-9154.56"/>
</g>
<!-- layer_9_gelu -->
<g id="node429" class="node">
<title>layer_9_gelu</title>
<polygon fill="lightblue" stroke="black" points="3598.5,-9086.57 3509.5,-9086.57 3509.5,-9050.57 3598.5,-9050.57 3598.5,-9086.57"/>
<text text-anchor="middle" x="3554" y="-9071.57" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="3554" y="-9060.57" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_9_allgather_mlp&#45;&gt;layer_9_gelu -->
<g id="edge588" class="edge">
<title>layer_9_allgather_mlp&#45;&gt;layer_9_gelu</title>
<path fill="none" stroke="black" d="M3681.76,-9131.16C3656.69,-9119.07 3624.4,-9103.51 3598.56,-9091.05"/>
<polygon fill="black" stroke="black" points="3599.88,-9087.8 3589.35,-9086.61 3596.84,-9094.11 3599.88,-9087.8"/>
</g>
<!-- layer_9_mlp_fc2_gpu15 -->
<g id="node437" class="node">
<title>layer_9_mlp_fc2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3517,-9014.57 3423,-9014.57 3423,-8962.57 3517,-8962.57 3517,-9014.57"/>
<text text-anchor="middle" x="3470" y="-9002.57" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="3470" y="-8991.57" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3470" y="-8980.57" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3470" y="-8969.57" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu15 -->
<g id="edge589" class="edge">
<title>layer_9_gelu&#45;&gt;layer_9_mlp_fc2_gpu15</title>
<path fill="none" stroke="black" d="M3535.36,-9050.26C3526.33,-9041.88 3515.2,-9031.54 3504.7,-9021.79"/>
<polygon fill="black" stroke="black" points="3506.91,-9019.07 3497.2,-9014.83 3502.15,-9024.2 3506.91,-9019.07"/>
</g>
<!-- layer_9_mlp_fc2_gpu8 -->
<g id="node430" class="node">
<title>layer_9_mlp_fc2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3629,-9014.57 3535,-9014.57 3535,-8962.57 3629,-8962.57 3629,-9014.57"/>
<text text-anchor="middle" x="3582" y="-9002.57" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="3582" y="-8991.57" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3582" y="-8980.57" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3582" y="-8969.57" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_allreduce_mlp -->
<g id="node438" class="node">
<title>layer_9_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="3918" cy="-8897.58" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="3918" y="-8906.08" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="3918" y="-8895.08" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="3918" y="-8884.08" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_9_mlp_fc2_gpu8&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge590" class="edge">
<title>layer_9_mlp_fc2_gpu8&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3629.1,-8965.77C3632.09,-8964.62 3635.07,-8963.55 3638,-8962.57 3709.61,-8938.66 3794.46,-8920.64 3851.84,-8909.92"/>
<polygon fill="black" stroke="black" points="3852.67,-8913.32 3861.87,-8908.07 3851.4,-8906.44 3852.67,-8913.32"/>
</g>
<!-- layer_9_mlp_fc2_gpu9 -->
<g id="node431" class="node">
<title>layer_9_mlp_fc2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3741,-9014.57 3647,-9014.57 3647,-8962.57 3741,-8962.57 3741,-9014.57"/>
<text text-anchor="middle" x="3694" y="-9002.57" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="3694" y="-8991.57" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3694" y="-8980.57" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3694" y="-8969.57" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_mlp_fc2_gpu9&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge591" class="edge">
<title>layer_9_mlp_fc2_gpu9&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3741.28,-8966.24C3744.22,-8964.98 3747.15,-8963.75 3750,-8962.57 3786.89,-8947.32 3828.84,-8931.34 3861.6,-8919.16"/>
<polygon fill="black" stroke="black" points="3862.85,-8922.43 3871.01,-8915.67 3860.42,-8915.87 3862.85,-8922.43"/>
</g>
<!-- layer_9_mlp_fc2_gpu10 -->
<g id="node432" class="node">
<title>layer_9_mlp_fc2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3853,-9014.57 3759,-9014.57 3759,-8962.57 3853,-8962.57 3853,-9014.57"/>
<text text-anchor="middle" x="3806" y="-9002.57" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="3806" y="-8991.57" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3806" y="-8980.57" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3806" y="-8969.57" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_mlp_fc2_gpu10&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge592" class="edge">
<title>layer_9_mlp_fc2_gpu10&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3837.5,-8962.54C3850.59,-8952.14 3865.9,-8939.98 3879.64,-8929.06"/>
<polygon fill="black" stroke="black" points="3881.86,-8931.76 3887.51,-8922.8 3877.51,-8926.28 3881.86,-8931.76"/>
</g>
<!-- layer_9_mlp_fc2_gpu11 -->
<g id="node433" class="node">
<title>layer_9_mlp_fc2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="3965,-9014.57 3871,-9014.57 3871,-8962.57 3965,-8962.57 3965,-9014.57"/>
<text text-anchor="middle" x="3918" y="-9002.57" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="3918" y="-8991.57" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3918" y="-8980.57" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="3918" y="-8969.57" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_mlp_fc2_gpu11&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge593" class="edge">
<title>layer_9_mlp_fc2_gpu11&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3918,-8962.31C3918,-8954.41 3918,-8945.52 3918,-8936.94"/>
<polygon fill="black" stroke="black" points="3921.5,-8936.72 3918,-8926.72 3914.5,-8936.72 3921.5,-8936.72"/>
</g>
<!-- layer_9_mlp_fc2_gpu12 -->
<g id="node434" class="node">
<title>layer_9_mlp_fc2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="4077,-9014.57 3983,-9014.57 3983,-8962.57 4077,-8962.57 4077,-9014.57"/>
<text text-anchor="middle" x="4030" y="-9002.57" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="4030" y="-8991.57" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="4030" y="-8980.57" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="4030" y="-8969.57" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_mlp_fc2_gpu12&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge594" class="edge">
<title>layer_9_mlp_fc2_gpu12&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3998.5,-8962.54C3985.41,-8952.14 3970.1,-8939.98 3956.36,-8929.06"/>
<polygon fill="black" stroke="black" points="3958.49,-8926.28 3948.49,-8922.8 3954.14,-8931.76 3958.49,-8926.28"/>
</g>
<!-- layer_9_mlp_fc2_gpu13 -->
<g id="node435" class="node">
<title>layer_9_mlp_fc2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="4189,-9014.57 4095,-9014.57 4095,-8962.57 4189,-8962.57 4189,-9014.57"/>
<text text-anchor="middle" x="4142" y="-9002.57" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="4142" y="-8991.57" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="4142" y="-8980.57" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="4142" y="-8969.57" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_mlp_fc2_gpu13&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge595" class="edge">
<title>layer_9_mlp_fc2_gpu13&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4094.72,-8966.24C4091.78,-8964.98 4088.85,-8963.75 4086,-8962.57 4049.11,-8947.32 4007.16,-8931.34 3974.4,-8919.16"/>
<polygon fill="black" stroke="black" points="3975.58,-8915.87 3964.99,-8915.67 3973.15,-8922.43 3975.58,-8915.87"/>
</g>
<!-- layer_9_mlp_fc2_gpu14 -->
<g id="node436" class="node">
<title>layer_9_mlp_fc2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4301,-9014.57 4207,-9014.57 4207,-8962.57 4301,-8962.57 4301,-9014.57"/>
<text text-anchor="middle" x="4254" y="-9002.57" font-family="Arial" font-size="10.00">Layer 9 MLP FC2</text>
<text text-anchor="middle" x="4254" y="-8991.57" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="4254" y="-8980.57" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="4254" y="-8969.57" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_9_mlp_fc2_gpu14&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge596" class="edge">
<title>layer_9_mlp_fc2_gpu14&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4206.9,-8965.77C4203.91,-8964.62 4200.93,-8963.55 4198,-8962.57 4126.39,-8938.66 4041.54,-8920.64 3984.16,-8909.92"/>
<polygon fill="black" stroke="black" points="3984.6,-8906.44 3974.13,-8908.07 3983.33,-8913.32 3984.6,-8906.44"/>
</g>
<!-- layer_9_mlp_fc2_gpu15&#45;&gt;layer_9_allreduce_mlp -->
<g id="edge597" class="edge">
<title>layer_9_mlp_fc2_gpu15&#45;&gt;layer_9_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3517.03,-8965.55C3520.04,-8964.46 3523.04,-8963.45 3526,-8962.57 3636.16,-8929.59 3769.15,-8912.42 3848.47,-8904.46"/>
<polygon fill="black" stroke="black" points="3849.21,-8907.91 3858.82,-8903.45 3848.53,-8900.94 3849.21,-8907.91"/>
</g>
<!-- layer_9_allreduce_mlp&#45;&gt;layer_9_residual2 -->
<g id="edge598" class="edge">
<title>layer_9_allreduce_mlp&#45;&gt;layer_9_residual2</title>
<path fill="none" stroke="black" d="M3960.97,-8877.08C3991,-8863.46 4031.46,-8845.11 4064.43,-8830.15"/>
<polygon fill="black" stroke="black" points="4066.3,-8833.15 4073.96,-8825.83 4063.41,-8826.77 4066.3,-8833.15"/>
</g>
<!-- layer_9_ln2 -->
<g id="node440" class="node">
<title>layer_9_ln2</title>
<polygon fill="lightblue" stroke="black" points="4159.5,-8736.59 4086.5,-8736.59 4086.5,-8695.59 4159.5,-8695.59 4159.5,-8736.59"/>
<text text-anchor="middle" x="4123" y="-8724.59" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="4123" y="-8713.59" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="4123" y="-8702.59" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_9_residual2&#45;&gt;layer_9_ln2 -->
<g id="edge600" class="edge">
<title>layer_9_residual2&#45;&gt;layer_9_ln2</title>
<path fill="none" stroke="black" d="M4123,-8772.51C4123,-8764.18 4123,-8755.1 4123,-8746.74"/>
<polygon fill="black" stroke="black" points="4126.5,-8746.65 4123,-8736.65 4119.5,-8746.65 4126.5,-8746.65"/>
</g>
<!-- layer_9_output_dist -->
<g id="node441" class="node">
<title>layer_9_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="4224.7,-8659.59 4062.92,-8659.59 4021.3,-8599.59 4183.08,-8599.59 4224.7,-8659.59"/>
<text text-anchor="middle" x="4123" y="-8632.59" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="4123" y="-8621.59" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_9_ln2&#45;&gt;layer_9_output_dist -->
<g id="edge601" class="edge">
<title>layer_9_ln2&#45;&gt;layer_9_output_dist</title>
<path fill="none" stroke="black" d="M4123,-8695.49C4123,-8687.85 4123,-8678.81 4123,-8669.94"/>
<polygon fill="black" stroke="black" points="4126.5,-8669.7 4123,-8659.7 4119.5,-8669.7 4126.5,-8669.7"/>
</g>
<!-- layer_10_input_dist -->
<g id="node442" class="node">
<title>layer_10_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="4217.19,-8563.59 4067.36,-8563.59 4028.81,-8503.59 4178.64,-8503.59 4217.19,-8563.59"/>
<text text-anchor="middle" x="4123" y="-8536.59" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="4123" y="-8525.59" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_9_output_dist&#45;&gt;layer_10_input_dist -->
<g id="edge602" class="edge">
<title>layer_9_output_dist&#45;&gt;layer_10_input_dist</title>
<path fill="none" stroke="black" d="M4123,-8599.36C4123,-8591.31 4123,-8582.45 4123,-8573.93"/>
<polygon fill="black" stroke="black" points="4126.5,-8573.79 4123,-8563.79 4119.5,-8573.8 4126.5,-8573.79"/>
</g>
<!-- layer_10_qkv_gpu8 -->
<g id="node443" class="node">
<title>layer_10_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3708,-8467.59 3610,-8467.59 3610,-8415.59 3708,-8415.59 3708,-8467.59"/>
<text text-anchor="middle" x="3659" y="-8455.59" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="3659" y="-8444.59" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3659" y="-8433.59" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3659" y="-8422.59" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu8 -->
<g id="edge603" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu8</title>
<path fill="none" stroke="black" d="M4042.74,-8525.67C3962.17,-8517.39 3834.73,-8500.66 3717.88,-8467.55"/>
<polygon fill="black" stroke="black" points="3718.63,-8464.12 3708.05,-8464.72 3716.69,-8470.85 3718.63,-8464.12"/>
</g>
<!-- layer_10_qkv_gpu9 -->
<g id="node444" class="node">
<title>layer_10_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3824,-8467.59 3726,-8467.59 3726,-8415.59 3824,-8415.59 3824,-8467.59"/>
<text text-anchor="middle" x="3775" y="-8455.59" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="3775" y="-8444.59" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3775" y="-8433.59" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3775" y="-8422.59" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu9 -->
<g id="edge604" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu9</title>
<path fill="none" stroke="black" d="M4037.81,-8517.83C3981.93,-8507.15 3907.34,-8490.98 3833.99,-8467.68"/>
<polygon fill="black" stroke="black" points="3834.71,-8464.24 3824.12,-8464.5 3832.56,-8470.9 3834.71,-8464.24"/>
</g>
<!-- layer_10_qkv_gpu10 -->
<g id="node445" class="node">
<title>layer_10_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="3940,-8467.59 3842,-8467.59 3842,-8415.59 3940,-8415.59 3940,-8467.59"/>
<text text-anchor="middle" x="3891" y="-8455.59" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="3891" y="-8444.59" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3891" y="-8433.59" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3891" y="-8422.59" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu10 -->
<g id="edge605" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu10</title>
<path fill="none" stroke="black" d="M4042.55,-8503.48C4015.43,-8493.44 3984.86,-8481.87 3949.8,-8467.85"/>
<polygon fill="black" stroke="black" points="3950.88,-8464.51 3940.29,-8464.03 3948.27,-8471 3950.88,-8464.51"/>
</g>
<!-- layer_10_qkv_gpu11 -->
<g id="node446" class="node">
<title>layer_10_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="4056,-8467.59 3958,-8467.59 3958,-8415.59 4056,-8415.59 4056,-8467.59"/>
<text text-anchor="middle" x="4007" y="-8455.59" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="4007" y="-8444.59" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="4007" y="-8433.59" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="4007" y="-8422.59" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu11 -->
<g id="edge606" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu11</title>
<path fill="none" stroke="black" d="M4085.34,-8503.37C4073.18,-8493.93 4059.66,-8483.44 4047.32,-8473.87"/>
<polygon fill="black" stroke="black" points="4049.46,-8471.1 4039.41,-8467.73 4045.16,-8476.63 4049.46,-8471.1"/>
</g>
<!-- layer_10_qkv_gpu12 -->
<g id="node447" class="node">
<title>layer_10_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="4172,-8467.59 4074,-8467.59 4074,-8415.59 4172,-8415.59 4172,-8467.59"/>
<text text-anchor="middle" x="4123" y="-8455.59" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="4123" y="-8444.59" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="4123" y="-8433.59" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="4123" y="-8422.59" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu12 -->
<g id="edge607" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu12</title>
<path fill="none" stroke="black" d="M4123,-8503.12C4123,-8495.04 4123,-8486.21 4123,-8477.84"/>
<polygon fill="black" stroke="black" points="4126.5,-8477.6 4123,-8467.6 4119.5,-8477.6 4126.5,-8477.6"/>
</g>
<!-- layer_10_qkv_gpu13 -->
<g id="node448" class="node">
<title>layer_10_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="4288,-8467.59 4190,-8467.59 4190,-8415.59 4288,-8415.59 4288,-8467.59"/>
<text text-anchor="middle" x="4239" y="-8455.59" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="4239" y="-8444.59" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="4239" y="-8433.59" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="4239" y="-8422.59" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu13 -->
<g id="edge608" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu13</title>
<path fill="none" stroke="black" d="M4160.66,-8503.37C4172.82,-8493.93 4186.34,-8483.44 4198.68,-8473.87"/>
<polygon fill="black" stroke="black" points="4200.84,-8476.63 4206.59,-8467.73 4196.54,-8471.1 4200.84,-8476.63"/>
</g>
<!-- layer_10_qkv_gpu14 -->
<g id="node449" class="node">
<title>layer_10_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4404,-8467.59 4306,-8467.59 4306,-8415.59 4404,-8415.59 4404,-8467.59"/>
<text text-anchor="middle" x="4355" y="-8455.59" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="4355" y="-8444.59" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="4355" y="-8433.59" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="4355" y="-8422.59" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu14 -->
<g id="edge609" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu14</title>
<path fill="none" stroke="black" d="M4183.68,-8510.76C4214.94,-8499.31 4253.85,-8484.77 4296.31,-8467.8"/>
<polygon fill="black" stroke="black" points="4297.73,-8471 4305.71,-8464.03 4295.12,-8464.51 4297.73,-8471"/>
</g>
<!-- layer_10_qkv_gpu15 -->
<g id="node450" class="node">
<title>layer_10_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4520,-8467.59 4422,-8467.59 4422,-8415.59 4520,-8415.59 4520,-8467.59"/>
<text text-anchor="middle" x="4471" y="-8455.59" font-family="Arial" font-size="10.00">Layer 10 QKV Proj</text>
<text text-anchor="middle" x="4471" y="-8444.59" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="4471" y="-8433.59" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="4471" y="-8422.59" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_qkv_gpu15 -->
<g id="edge610" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_qkv_gpu15</title>
<path fill="none" stroke="black" d="M4190.18,-8521.21C4247.25,-8510.71 4331.28,-8493.3 4412.05,-8467.67"/>
<polygon fill="black" stroke="black" points="4413.43,-8470.9 4421.88,-8464.5 4411.29,-8464.23 4413.43,-8470.9"/>
</g>
<!-- layer_10_residual1 -->
<g id="node462" class="node">
<title>layer_10_residual1</title>
<polygon fill="lightyellow" stroke="black" points="4498.94,-8015.62 4376.55,-8015.62 4345.06,-7955.62 4467.45,-7955.62 4498.94,-8015.62"/>
<text text-anchor="middle" x="4422" y="-7988.62" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="4422" y="-7977.62" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_10_input_dist&#45;&gt;layer_10_residual1 -->
<g id="edge630" class="edge">
<title>layer_10_input_dist&#45;&gt;layer_10_residual1</title>
<path fill="none" stroke="black" d="M4193.91,-8527.23C4294.62,-8518.61 4473.06,-8499.36 4529,-8467.59 4587.43,-8434.4 4626,-8418.8 4626,-8351.59 4626,-8351.59 4626,-8351.59 4626,-8170.6 4626,-8100.66 4559.05,-8050.47 4501.86,-8020.36"/>
<polygon fill="black" stroke="black" points="4503.27,-8017.15 4492.78,-8015.7 4500.08,-8023.38 4503.27,-8017.15"/>
</g>
<!-- layer_10_allgather_qkv -->
<g id="node451" class="node">
<title>layer_10_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="4007" cy="-8350.59" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="4007" y="-8359.09" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="4007" y="-8348.09" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="4007" y="-8337.09" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_10_qkv_gpu8&#45;&gt;layer_10_allgather_qkv -->
<g id="edge611" class="edge">
<title>layer_10_qkv_gpu8&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M3708.12,-8418.66C3711.1,-8417.56 3714.08,-8416.53 3717,-8415.59 3793.19,-8391.01 3883.64,-8372.7 3943.02,-8362.1"/>
<polygon fill="black" stroke="black" points="3943.77,-8365.53 3953.01,-8360.34 3942.55,-8358.63 3943.77,-8365.53"/>
</g>
<!-- layer_10_qkv_gpu9&#45;&gt;layer_10_allgather_qkv -->
<g id="edge612" class="edge">
<title>layer_10_qkv_gpu9&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M3824.28,-8419.13C3827.23,-8417.91 3830.15,-8416.72 3833,-8415.59 3872.04,-8400.01 3916.54,-8383.67 3950.76,-8371.4"/>
<polygon fill="black" stroke="black" points="3952.34,-8374.55 3960.58,-8367.89 3949.98,-8367.96 3952.34,-8374.55"/>
</g>
<!-- layer_10_qkv_gpu10&#45;&gt;layer_10_allgather_qkv -->
<g id="edge613" class="edge">
<title>layer_10_qkv_gpu10&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M3923.62,-8415.56C3937.4,-8404.99 3953.56,-8392.59 3967.97,-8381.54"/>
<polygon fill="black" stroke="black" points="3970.41,-8384.07 3976.22,-8375.21 3966.15,-8378.52 3970.41,-8384.07"/>
</g>
<!-- layer_10_qkv_gpu11&#45;&gt;layer_10_allgather_qkv -->
<g id="edge614" class="edge">
<title>layer_10_qkv_gpu11&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M4007,-8415.32C4007,-8407.43 4007,-8398.54 4007,-8389.96"/>
<polygon fill="black" stroke="black" points="4010.5,-8389.74 4007,-8379.74 4003.5,-8389.74 4010.5,-8389.74"/>
</g>
<!-- layer_10_qkv_gpu12&#45;&gt;layer_10_allgather_qkv -->
<g id="edge615" class="edge">
<title>layer_10_qkv_gpu12&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M4090.38,-8415.56C4076.6,-8404.99 4060.44,-8392.59 4046.03,-8381.54"/>
<polygon fill="black" stroke="black" points="4047.85,-8378.52 4037.78,-8375.21 4043.59,-8384.07 4047.85,-8378.52"/>
</g>
<!-- layer_10_qkv_gpu13&#45;&gt;layer_10_allgather_qkv -->
<g id="edge616" class="edge">
<title>layer_10_qkv_gpu13&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M4189.72,-8419.13C4186.77,-8417.91 4183.85,-8416.72 4181,-8415.59 4141.96,-8400.01 4097.46,-8383.67 4063.24,-8371.4"/>
<polygon fill="black" stroke="black" points="4064.02,-8367.96 4053.42,-8367.89 4061.66,-8374.55 4064.02,-8367.96"/>
</g>
<!-- layer_10_qkv_gpu14&#45;&gt;layer_10_allgather_qkv -->
<g id="edge617" class="edge">
<title>layer_10_qkv_gpu14&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M4305.88,-8418.66C4302.9,-8417.56 4299.92,-8416.53 4297,-8415.59 4220.81,-8391.01 4130.36,-8372.7 4070.98,-8362.1"/>
<polygon fill="black" stroke="black" points="4071.45,-8358.63 4060.99,-8360.34 4070.23,-8365.53 4071.45,-8358.63"/>
</g>
<!-- layer_10_qkv_gpu15&#45;&gt;layer_10_allgather_qkv -->
<g id="edge618" class="edge">
<title>layer_10_qkv_gpu15&#45;&gt;layer_10_allgather_qkv</title>
<path fill="none" stroke="black" d="M4421.95,-8418.45C4418.95,-8417.41 4415.95,-8416.44 4413,-8415.59 4296.16,-8381.78 4154.91,-8364.62 4073.56,-8356.93"/>
<polygon fill="black" stroke="black" points="4073.74,-8353.43 4063.46,-8355.99 4073.09,-8360.4 4073.74,-8353.43"/>
</g>
<!-- layer_10_attention -->
<g id="node452" class="node">
<title>layer_10_attention</title>
<polygon fill="lightblue" stroke="black" points="3963,-8285.6 3895,-8285.6 3895,-8233.6 3963,-8233.6 3963,-8285.6"/>
<text text-anchor="middle" x="3929" y="-8273.6" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="3929" y="-8262.6" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3929" y="-8251.6" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="3929" y="-8240.6" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_10_allgather_qkv&#45;&gt;layer_10_attention -->
<g id="edge619" class="edge">
<title>layer_10_allgather_qkv&#45;&gt;layer_10_attention</title>
<path fill="none" stroke="black" d="M3984.44,-8323.85C3976.13,-8314.38 3966.61,-8303.51 3957.82,-8293.49"/>
<polygon fill="black" stroke="black" points="3960.2,-8290.89 3950.97,-8285.67 3954.93,-8295.5 3960.2,-8290.89"/>
</g>
<!-- layer_10_attn_out_gpu15 -->
<g id="node460" class="node">
<title>layer_10_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3820.5,-8197.6 3727.5,-8197.6 3727.5,-8145.6 3820.5,-8145.6 3820.5,-8197.6"/>
<text text-anchor="middle" x="3774" y="-8185.6" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="3774" y="-8174.6" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3774" y="-8163.6" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3774" y="-8152.6" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attention&#45;&gt;layer_10_attn_out_gpu15 -->
<g id="edge620" class="edge">
<title>layer_10_attention&#45;&gt;layer_10_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M3894.98,-8239.73C3875.4,-8228.87 3850.35,-8214.96 3828.12,-8202.63"/>
<polygon fill="black" stroke="black" points="3829.56,-8199.43 3819.12,-8197.64 3826.16,-8205.55 3829.56,-8199.43"/>
</g>
<!-- layer_10_attn_out_gpu8 -->
<g id="node453" class="node">
<title>layer_10_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3931.5,-8197.6 3838.5,-8197.6 3838.5,-8145.6 3931.5,-8145.6 3931.5,-8197.6"/>
<text text-anchor="middle" x="3885" y="-8185.6" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="3885" y="-8174.6" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3885" y="-8163.6" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3885" y="-8152.6" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_allreduce_attn -->
<g id="node461" class="node">
<title>layer_10_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="4218" cy="-8080.61" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="4218" y="-8089.11" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="4218" y="-8078.11" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="4218" y="-8067.11" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_10_attn_out_gpu8&#45;&gt;layer_10_allreduce_attn -->
<g id="edge621" class="edge">
<title>layer_10_attn_out_gpu8&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M3931.79,-8148.93C3934.88,-8147.74 3937.97,-8146.62 3941,-8145.6 4012.41,-8121.67 4097.1,-8103.53 4153.87,-8092.78"/>
<polygon fill="black" stroke="black" points="4154.6,-8096.21 4163.79,-8090.93 4153.32,-8089.33 4154.6,-8096.21"/>
</g>
<!-- layer_10_attn_out_gpu9 -->
<g id="node454" class="node">
<title>layer_10_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="4042.5,-8197.6 3949.5,-8197.6 3949.5,-8145.6 4042.5,-8145.6 4042.5,-8197.6"/>
<text text-anchor="middle" x="3996" y="-8185.6" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="3996" y="-8174.6" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3996" y="-8163.6" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3996" y="-8152.6" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attn_out_gpu9&#45;&gt;layer_10_allreduce_attn -->
<g id="edge622" class="edge">
<title>layer_10_attn_out_gpu9&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M4042.67,-8149.55C4045.82,-8148.2 4048.95,-8146.87 4052,-8145.6 4088.57,-8130.4 4130.16,-8114.37 4162.56,-8102.16"/>
<polygon fill="black" stroke="black" points="4164.17,-8105.29 4172.3,-8098.5 4161.71,-8098.74 4164.17,-8105.29"/>
</g>
<!-- layer_10_attn_out_gpu10 -->
<g id="node455" class="node">
<title>layer_10_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="4153.5,-8197.6 4060.5,-8197.6 4060.5,-8145.6 4153.5,-8145.6 4153.5,-8197.6"/>
<text text-anchor="middle" x="4107" y="-8185.6" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="4107" y="-8174.6" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="4107" y="-8163.6" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="4107" y="-8152.6" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attn_out_gpu10&#45;&gt;layer_10_allreduce_attn -->
<g id="edge623" class="edge">
<title>layer_10_attn_out_gpu10&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M4138.22,-8145.58C4151.29,-8135.09 4166.61,-8122.81 4180.31,-8111.83"/>
<polygon fill="black" stroke="black" points="4182.55,-8114.52 4188.17,-8105.53 4178.17,-8109.06 4182.55,-8114.52"/>
</g>
<!-- layer_10_attn_out_gpu11 -->
<g id="node456" class="node">
<title>layer_10_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="4264.5,-8197.6 4171.5,-8197.6 4171.5,-8145.6 4264.5,-8145.6 4264.5,-8197.6"/>
<text text-anchor="middle" x="4218" y="-8185.6" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="4218" y="-8174.6" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="4218" y="-8163.6" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="4218" y="-8152.6" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attn_out_gpu11&#45;&gt;layer_10_allreduce_attn -->
<g id="edge624" class="edge">
<title>layer_10_attn_out_gpu11&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M4218,-8145.34C4218,-8137.45 4218,-8128.56 4218,-8119.98"/>
<polygon fill="black" stroke="black" points="4221.5,-8119.75 4218,-8109.75 4214.5,-8119.75 4221.5,-8119.75"/>
</g>
<!-- layer_10_attn_out_gpu12 -->
<g id="node457" class="node">
<title>layer_10_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="4375.5,-8197.6 4282.5,-8197.6 4282.5,-8145.6 4375.5,-8145.6 4375.5,-8197.6"/>
<text text-anchor="middle" x="4329" y="-8185.6" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="4329" y="-8174.6" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="4329" y="-8163.6" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="4329" y="-8152.6" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attn_out_gpu12&#45;&gt;layer_10_allreduce_attn -->
<g id="edge625" class="edge">
<title>layer_10_attn_out_gpu12&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M4297.78,-8145.58C4284.71,-8135.09 4269.39,-8122.81 4255.69,-8111.83"/>
<polygon fill="black" stroke="black" points="4257.83,-8109.06 4247.83,-8105.53 4253.45,-8114.52 4257.83,-8109.06"/>
</g>
<!-- layer_10_attn_out_gpu13 -->
<g id="node458" class="node">
<title>layer_10_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="4486.5,-8197.6 4393.5,-8197.6 4393.5,-8145.6 4486.5,-8145.6 4486.5,-8197.6"/>
<text text-anchor="middle" x="4440" y="-8185.6" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="4440" y="-8174.6" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="4440" y="-8163.6" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="4440" y="-8152.6" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attn_out_gpu13&#45;&gt;layer_10_allreduce_attn -->
<g id="edge626" class="edge">
<title>layer_10_attn_out_gpu13&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M4393.28,-8149.13C4390.48,-8147.92 4387.71,-8146.74 4385,-8145.6 4348.11,-8130.17 4306.07,-8114.07 4273.4,-8101.88"/>
<polygon fill="black" stroke="black" points="4274.61,-8098.59 4264.02,-8098.39 4272.17,-8105.15 4274.61,-8098.59"/>
</g>
<!-- layer_10_attn_out_gpu14 -->
<g id="node459" class="node">
<title>layer_10_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4597.5,-8197.6 4504.5,-8197.6 4504.5,-8145.6 4597.5,-8145.6 4597.5,-8197.6"/>
<text text-anchor="middle" x="4551" y="-8185.6" font-family="Arial" font-size="10.00">Layer 10 Attn Out</text>
<text text-anchor="middle" x="4551" y="-8174.6" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="4551" y="-8163.6" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="4551" y="-8152.6" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_10_attn_out_gpu14&#45;&gt;layer_10_allreduce_attn -->
<g id="edge627" class="edge">
<title>layer_10_attn_out_gpu14&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M4504.45,-8148.68C4501.61,-8147.58 4498.78,-8146.55 4496,-8145.6 4424.42,-8121.37 4339.4,-8103.29 4282.4,-8092.64"/>
<polygon fill="black" stroke="black" points="4282.91,-8089.17 4272.44,-8090.8 4281.64,-8096.06 4282.91,-8089.17"/>
</g>
<!-- layer_10_attn_out_gpu15&#45;&gt;layer_10_allreduce_attn -->
<g id="edge628" class="edge">
<title>layer_10_attn_out_gpu15&#45;&gt;layer_10_allreduce_attn</title>
<path fill="none" stroke="black" d="M3820.72,-8148.7C3823.83,-8147.57 3826.94,-8146.52 3830,-8145.6 3939.82,-8112.63 4072.56,-8095.38 4150.86,-8087.41"/>
<polygon fill="black" stroke="black" points="4151.47,-8090.87 4161.07,-8086.39 4150.77,-8083.9 4151.47,-8090.87"/>
</g>
<!-- layer_10_allreduce_attn&#45;&gt;layer_10_residual1 -->
<g id="edge629" class="edge">
<title>layer_10_allreduce_attn&#45;&gt;layer_10_residual1</title>
<path fill="none" stroke="black" d="M4260.27,-8060.34C4290.12,-8046.74 4330.5,-8028.33 4363.45,-8013.31"/>
<polygon fill="black" stroke="black" points="4365.32,-8016.3 4372.97,-8008.97 4362.42,-8009.93 4365.32,-8016.3"/>
</g>
<!-- layer_10_ln1 -->
<g id="node463" class="node">
<title>layer_10_ln1</title>
<polygon fill="lightblue" stroke="black" points="4244.5,-7919.62 4171.5,-7919.62 4171.5,-7878.62 4244.5,-7878.62 4244.5,-7919.62"/>
<text text-anchor="middle" x="4208" y="-7907.62" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="4208" y="-7896.62" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="4208" y="-7885.62" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_10_residual1&#45;&gt;layer_10_ln1 -->
<g id="edge631" class="edge">
<title>layer_10_residual1&#45;&gt;layer_10_ln1</title>
<path fill="none" stroke="black" d="M4348.35,-7955.54C4316.99,-7943.16 4281.38,-7929.09 4253.87,-7918.23"/>
<polygon fill="black" stroke="black" points="4255.09,-7914.95 4244.5,-7914.53 4252.52,-7921.46 4255.09,-7914.95"/>
</g>
<!-- layer_10_residual2 -->
<g id="node483" class="node">
<title>layer_10_residual2</title>
<polygon fill="lightyellow" stroke="black" points="4586.94,-7406.66 4464.55,-7406.66 4433.06,-7346.66 4555.45,-7346.66 4586.94,-7406.66"/>
<text text-anchor="middle" x="4510" y="-7379.66" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="4510" y="-7368.66" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_10_residual1&#45;&gt;layer_10_residual2 -->
<g id="edge659" class="edge">
<title>layer_10_residual1&#45;&gt;layer_10_residual2</title>
<path fill="none" stroke="black" d="M4479.71,-7978.75C4567.62,-7966.27 4725,-7928.44 4725,-7817.62 4725,-7817.62 4725,-7817.62 4725,-7561.64 4725,-7490.26 4655.75,-7440.64 4595.85,-7411.07"/>
<polygon fill="black" stroke="black" points="4597.24,-7407.86 4586.71,-7406.68 4594.2,-7414.17 4597.24,-7407.86"/>
</g>
<!-- layer_10_mlp_fc1_gpu8 -->
<g id="node464" class="node">
<title>layer_10_mlp_fc1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3789.5,-7842.62 3690.5,-7842.62 3690.5,-7790.62 3789.5,-7790.62 3789.5,-7842.62"/>
<text text-anchor="middle" x="3740" y="-7830.62" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="3740" y="-7819.62" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3740" y="-7808.62" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3740" y="-7797.62" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu8 -->
<g id="edge632" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu8</title>
<path fill="none" stroke="black" d="M4171.24,-7896.41C4100.44,-7892.41 3940.46,-7879.99 3799.26,-7842.35"/>
<polygon fill="black" stroke="black" points="3800.13,-7838.96 3789.56,-7839.72 3798.29,-7845.72 3800.13,-7838.96"/>
</g>
<!-- layer_10_mlp_fc1_gpu9 -->
<g id="node465" class="node">
<title>layer_10_mlp_fc1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="3906.5,-7842.62 3807.5,-7842.62 3807.5,-7790.62 3906.5,-7790.62 3906.5,-7842.62"/>
<text text-anchor="middle" x="3857" y="-7830.62" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="3857" y="-7819.62" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="3857" y="-7808.62" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="3857" y="-7797.62" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu9 -->
<g id="edge633" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu9</title>
<path fill="none" stroke="black" d="M4171.44,-7893.72C4117.35,-7886.66 4012.89,-7870.92 3916.24,-7842.41"/>
<polygon fill="black" stroke="black" points="3917.2,-7839.05 3906.62,-7839.52 3915.19,-7845.75 3917.2,-7839.05"/>
</g>
<!-- layer_10_mlp_fc1_gpu10 -->
<g id="node466" class="node">
<title>layer_10_mlp_fc1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="4023.5,-7842.62 3924.5,-7842.62 3924.5,-7790.62 4023.5,-7790.62 4023.5,-7842.62"/>
<text text-anchor="middle" x="3974" y="-7830.62" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="3974" y="-7819.62" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3974" y="-7808.62" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="3974" y="-7797.62" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu10 -->
<g id="edge634" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu10</title>
<path fill="none" stroke="black" d="M4171.47,-7887.62C4137.85,-7877.72 4086.47,-7861.99 4033.35,-7842.62"/>
<polygon fill="black" stroke="black" points="4034.36,-7839.26 4023.76,-7839.09 4031.94,-7845.83 4034.36,-7839.26"/>
</g>
<!-- layer_10_mlp_fc1_gpu11 -->
<g id="node467" class="node">
<title>layer_10_mlp_fc1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="4140.5,-7842.62 4041.5,-7842.62 4041.5,-7790.62 4140.5,-7790.62 4140.5,-7842.62"/>
<text text-anchor="middle" x="4091" y="-7830.62" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="4091" y="-7819.62" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="4091" y="-7808.62" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="4091" y="-7797.62" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu11 -->
<g id="edge635" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu11</title>
<path fill="none" stroke="black" d="M4179.38,-7878.43C4166.37,-7869.48 4150.67,-7858.68 4136.13,-7848.67"/>
<polygon fill="black" stroke="black" points="4137.96,-7845.68 4127.74,-7842.9 4133.99,-7851.45 4137.96,-7845.68"/>
</g>
<!-- layer_10_mlp_fc1_gpu12 -->
<g id="node468" class="node">
<title>layer_10_mlp_fc1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="4257.5,-7842.62 4158.5,-7842.62 4158.5,-7790.62 4257.5,-7790.62 4257.5,-7842.62"/>
<text text-anchor="middle" x="4208" y="-7830.62" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="4208" y="-7819.62" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="4208" y="-7808.62" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="4208" y="-7797.62" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu12 -->
<g id="edge636" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu12</title>
<path fill="none" stroke="black" d="M4208,-7878.22C4208,-7870.61 4208,-7861.68 4208,-7853.05"/>
<polygon fill="black" stroke="black" points="4211.5,-7852.78 4208,-7842.78 4204.5,-7852.78 4211.5,-7852.78"/>
</g>
<!-- layer_10_mlp_fc1_gpu13 -->
<g id="node469" class="node">
<title>layer_10_mlp_fc1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="4374.5,-7842.62 4275.5,-7842.62 4275.5,-7790.62 4374.5,-7790.62 4374.5,-7842.62"/>
<text text-anchor="middle" x="4325" y="-7830.62" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="4325" y="-7819.62" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="4325" y="-7808.62" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="4325" y="-7797.62" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu13 -->
<g id="edge637" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu13</title>
<path fill="none" stroke="black" d="M4236.62,-7878.43C4249.63,-7869.48 4265.33,-7858.68 4279.87,-7848.67"/>
<polygon fill="black" stroke="black" points="4282.01,-7851.45 4288.26,-7842.9 4278.04,-7845.68 4282.01,-7851.45"/>
</g>
<!-- layer_10_mlp_fc1_gpu14 -->
<g id="node470" class="node">
<title>layer_10_mlp_fc1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4491.5,-7842.62 4392.5,-7842.62 4392.5,-7790.62 4491.5,-7790.62 4491.5,-7842.62"/>
<text text-anchor="middle" x="4442" y="-7830.62" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="4442" y="-7819.62" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="4442" y="-7808.62" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="4442" y="-7797.62" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu14 -->
<g id="edge638" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu14</title>
<path fill="none" stroke="black" d="M4244.77,-7887.71C4278.6,-7877.87 4330.29,-7862.18 4382.96,-7842.88"/>
<polygon fill="black" stroke="black" points="4384.3,-7846.12 4392.46,-7839.37 4381.87,-7839.56 4384.3,-7846.12"/>
</g>
<!-- layer_10_mlp_fc1_gpu15 -->
<g id="node471" class="node">
<title>layer_10_mlp_fc1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4608.5,-7842.62 4509.5,-7842.62 4509.5,-7790.62 4608.5,-7790.62 4608.5,-7842.62"/>
<text text-anchor="middle" x="4559" y="-7830.62" font-family="Arial" font-size="10.00">Layer 10 MLP FC1</text>
<text text-anchor="middle" x="4559" y="-7819.62" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="4559" y="-7808.62" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="4559" y="-7797.62" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu15 -->
<g id="edge639" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_mlp_fc1_gpu15</title>
<path fill="none" stroke="black" d="M4244.71,-7893.8C4298.96,-7886.86 4403.65,-7871.28 4499.44,-7842.85"/>
<polygon fill="black" stroke="black" points="4500.72,-7846.12 4509.27,-7839.88 4498.69,-7839.42 4500.72,-7846.12"/>
</g>
<!-- layer_10_allgather_mlp -->
<g id="node472" class="node">
<title>layer_10_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="4091" cy="-7725.63" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="4091" y="-7734.13" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="4091" y="-7723.13" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="4091" y="-7712.13" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_10_mlp_fc1_gpu8&#45;&gt;layer_10_allgather_mlp -->
<g id="edge640" class="edge">
<title>layer_10_mlp_fc1_gpu8&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M3789.65,-7793.82C3792.79,-7792.68 3795.93,-7791.6 3799,-7790.62 3876.13,-7766.06 3967.67,-7747.67 4027.43,-7737.05"/>
<polygon fill="black" stroke="black" points="4028.23,-7740.47 4037.47,-7735.29 4027.02,-7733.57 4028.23,-7740.47"/>
</g>
<!-- layer_10_mlp_fc1_gpu9&#45;&gt;layer_10_allgather_mlp -->
<g id="edge641" class="edge">
<title>layer_10_mlp_fc1_gpu9&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M3906.5,-7794.43C3909.71,-7793.13 3912.9,-7791.85 3916,-7790.62 3955.75,-7774.94 4001.07,-7758.41 4035.62,-7746.08"/>
<polygon fill="black" stroke="black" points="4036.83,-7749.36 4045.07,-7742.71 4034.48,-7742.77 4036.83,-7749.36"/>
</g>
<!-- layer_10_mlp_fc1_gpu10&#45;&gt;layer_10_allgather_mlp -->
<g id="edge642" class="edge">
<title>layer_10_mlp_fc1_gpu10&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M4006.9,-7790.59C4020.8,-7780.02 4037.1,-7767.62 4051.63,-7756.57"/>
<polygon fill="black" stroke="black" points="4054.11,-7759.08 4059.95,-7750.24 4049.87,-7753.51 4054.11,-7759.08"/>
</g>
<!-- layer_10_mlp_fc1_gpu11&#45;&gt;layer_10_allgather_mlp -->
<g id="edge643" class="edge">
<title>layer_10_mlp_fc1_gpu11&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M4091,-7790.36C4091,-7782.47 4091,-7773.58 4091,-7765"/>
<polygon fill="black" stroke="black" points="4094.5,-7764.77 4091,-7754.77 4087.5,-7764.77 4094.5,-7764.77"/>
</g>
<!-- layer_10_mlp_fc1_gpu12&#45;&gt;layer_10_allgather_mlp -->
<g id="edge644" class="edge">
<title>layer_10_mlp_fc1_gpu12&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M4175.1,-7790.59C4161.2,-7780.02 4144.9,-7767.62 4130.37,-7756.57"/>
<polygon fill="black" stroke="black" points="4132.13,-7753.51 4122.05,-7750.24 4127.89,-7759.08 4132.13,-7753.51"/>
</g>
<!-- layer_10_mlp_fc1_gpu13&#45;&gt;layer_10_allgather_mlp -->
<g id="edge645" class="edge">
<title>layer_10_mlp_fc1_gpu13&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M4275.41,-7794.02C4272.57,-7792.85 4269.75,-7791.71 4267,-7790.62 4227.09,-7774.78 4181.51,-7758.25 4146.74,-7745.96"/>
<polygon fill="black" stroke="black" points="4147.82,-7742.63 4137.23,-7742.61 4145.5,-7749.23 4147.82,-7742.63"/>
</g>
<!-- layer_10_mlp_fc1_gpu14&#45;&gt;layer_10_allgather_mlp -->
<g id="edge646" class="edge">
<title>layer_10_mlp_fc1_gpu14&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M4392.25,-7793.45C4389.48,-7792.45 4386.71,-7791.49 4384,-7790.62 4306.57,-7765.73 4214.53,-7747.39 4154.55,-7736.87"/>
<polygon fill="black" stroke="black" points="4154.92,-7733.39 4144.47,-7735.13 4153.73,-7740.28 4154.92,-7733.39"/>
</g>
<!-- layer_10_mlp_fc1_gpu15&#45;&gt;layer_10_allgather_mlp -->
<g id="edge647" class="edge">
<title>layer_10_mlp_fc1_gpu15&#45;&gt;layer_10_allgather_mlp</title>
<path fill="none" stroke="black" d="M4509.31,-7793.26C4506.52,-7792.3 4503.74,-7791.41 4501,-7790.62 4382.35,-7756.39 4238.76,-7739.31 4156.84,-7731.76"/>
<polygon fill="black" stroke="black" points="4156.94,-7728.25 4146.67,-7730.84 4156.32,-7735.23 4156.94,-7728.25"/>
</g>
<!-- layer_10_gelu -->
<g id="node473" class="node">
<title>layer_10_gelu</title>
<polygon fill="lightblue" stroke="black" points="4047.5,-7660.64 3958.5,-7660.64 3958.5,-7624.64 4047.5,-7624.64 4047.5,-7660.64"/>
<text text-anchor="middle" x="4003" y="-7645.64" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="4003" y="-7634.64" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_10_allgather_mlp&#45;&gt;layer_10_gelu -->
<g id="edge648" class="edge">
<title>layer_10_allgather_mlp&#45;&gt;layer_10_gelu</title>
<path fill="none" stroke="black" d="M4064.12,-7699.89C4053.06,-7689.71 4040.28,-7677.95 4029.28,-7667.83"/>
<polygon fill="black" stroke="black" points="4031.36,-7664.99 4021.64,-7660.79 4026.62,-7670.14 4031.36,-7664.99"/>
</g>
<!-- layer_10_mlp_fc2_gpu15 -->
<g id="node481" class="node">
<title>layer_10_mlp_fc2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="3877.5,-7588.64 3778.5,-7588.64 3778.5,-7536.64 3877.5,-7536.64 3877.5,-7588.64"/>
<text text-anchor="middle" x="3828" y="-7576.64" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="3828" y="-7565.64" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3828" y="-7554.64" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="3828" y="-7543.64" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu15 -->
<g id="edge649" class="edge">
<title>layer_10_gelu&#45;&gt;layer_10_mlp_fc2_gpu15</title>
<path fill="none" stroke="black" d="M3964.6,-7624.52C3941.83,-7614.38 3912.52,-7601.31 3886.89,-7589.89"/>
<polygon fill="black" stroke="black" points="3888.19,-7586.63 3877.63,-7585.76 3885.34,-7593.03 3888.19,-7586.63"/>
</g>
<!-- layer_10_mlp_fc2_gpu8 -->
<g id="node474" class="node">
<title>layer_10_mlp_fc2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="3994.5,-7588.64 3895.5,-7588.64 3895.5,-7536.64 3994.5,-7536.64 3994.5,-7588.64"/>
<text text-anchor="middle" x="3945" y="-7576.64" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="3945" y="-7565.64" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="3945" y="-7554.64" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="3945" y="-7543.64" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_allreduce_mlp -->
<g id="node482" class="node">
<title>layer_10_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="4296" cy="-7471.65" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="4296" y="-7480.15" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="4296" y="-7469.15" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="4296" y="-7458.15" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_10_mlp_fc2_gpu8&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge650" class="edge">
<title>layer_10_mlp_fc2_gpu8&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3994.65,-7539.84C3997.79,-7538.69 4000.93,-7537.62 4004,-7536.64 4079.85,-7512.49 4169.62,-7494.31 4229.41,-7483.61"/>
<polygon fill="black" stroke="black" points="4230.24,-7487.02 4239.48,-7481.83 4229.03,-7480.12 4230.24,-7487.02"/>
</g>
<!-- layer_10_mlp_fc2_gpu9 -->
<g id="node475" class="node">
<title>layer_10_mlp_fc2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="4111.5,-7588.64 4012.5,-7588.64 4012.5,-7536.64 4111.5,-7536.64 4111.5,-7588.64"/>
<text text-anchor="middle" x="4062" y="-7576.64" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="4062" y="-7565.64" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="4062" y="-7554.64" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="4062" y="-7543.64" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_mlp_fc2_gpu9&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge651" class="edge">
<title>layer_10_mlp_fc2_gpu9&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4111.5,-7540.45C4114.71,-7539.14 4117.9,-7537.86 4121,-7536.64 4159.89,-7521.3 4204.12,-7505.14 4238.38,-7492.89"/>
<polygon fill="black" stroke="black" points="4239.98,-7496.04 4248.22,-7489.39 4237.63,-7489.45 4239.98,-7496.04"/>
</g>
<!-- layer_10_mlp_fc2_gpu10 -->
<g id="node476" class="node">
<title>layer_10_mlp_fc2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="4228.5,-7588.64 4129.5,-7588.64 4129.5,-7536.64 4228.5,-7536.64 4228.5,-7588.64"/>
<text text-anchor="middle" x="4179" y="-7576.64" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="4179" y="-7565.64" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="4179" y="-7554.64" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="4179" y="-7543.64" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_mlp_fc2_gpu10&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge652" class="edge">
<title>layer_10_mlp_fc2_gpu10&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4211.9,-7536.61C4225.69,-7526.13 4241.84,-7513.84 4256.28,-7502.86"/>
<polygon fill="black" stroke="black" points="4258.71,-7505.41 4264.55,-7496.57 4254.47,-7499.83 4258.71,-7505.41"/>
</g>
<!-- layer_10_mlp_fc2_gpu11 -->
<g id="node477" class="node">
<title>layer_10_mlp_fc2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="4345.5,-7588.64 4246.5,-7588.64 4246.5,-7536.64 4345.5,-7536.64 4345.5,-7588.64"/>
<text text-anchor="middle" x="4296" y="-7576.64" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="4296" y="-7565.64" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="4296" y="-7554.64" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="4296" y="-7543.64" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_mlp_fc2_gpu11&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge653" class="edge">
<title>layer_10_mlp_fc2_gpu11&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4296,-7536.37C4296,-7528.48 4296,-7519.59 4296,-7511.01"/>
<polygon fill="black" stroke="black" points="4299.5,-7510.79 4296,-7500.79 4292.5,-7510.79 4299.5,-7510.79"/>
</g>
<!-- layer_10_mlp_fc2_gpu12 -->
<g id="node478" class="node">
<title>layer_10_mlp_fc2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="4462.5,-7588.64 4363.5,-7588.64 4363.5,-7536.64 4462.5,-7536.64 4462.5,-7588.64"/>
<text text-anchor="middle" x="4413" y="-7576.64" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="4413" y="-7565.64" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="4413" y="-7554.64" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="4413" y="-7543.64" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_mlp_fc2_gpu12&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge654" class="edge">
<title>layer_10_mlp_fc2_gpu12&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4380.1,-7536.61C4366.31,-7526.13 4350.16,-7513.84 4335.72,-7502.86"/>
<polygon fill="black" stroke="black" points="4337.53,-7499.83 4327.45,-7496.57 4333.29,-7505.41 4337.53,-7499.83"/>
</g>
<!-- layer_10_mlp_fc2_gpu13 -->
<g id="node479" class="node">
<title>layer_10_mlp_fc2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="4579.5,-7588.64 4480.5,-7588.64 4480.5,-7536.64 4579.5,-7536.64 4579.5,-7588.64"/>
<text text-anchor="middle" x="4530" y="-7576.64" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="4530" y="-7565.64" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="4530" y="-7554.64" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="4530" y="-7543.64" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_mlp_fc2_gpu13&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge655" class="edge">
<title>layer_10_mlp_fc2_gpu13&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4480.41,-7540.04C4477.57,-7538.87 4474.75,-7537.73 4472,-7536.64 4432.78,-7521.07 4388.08,-7504.84 4353.55,-7492.62"/>
<polygon fill="black" stroke="black" points="4354.69,-7489.31 4344.09,-7489.28 4352.36,-7495.91 4354.69,-7489.31"/>
</g>
<!-- layer_10_mlp_fc2_gpu14 -->
<g id="node480" class="node">
<title>layer_10_mlp_fc2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4696.5,-7588.64 4597.5,-7588.64 4597.5,-7536.64 4696.5,-7536.64 4696.5,-7588.64"/>
<text text-anchor="middle" x="4647" y="-7576.64" font-family="Arial" font-size="10.00">Layer 10 MLP FC2</text>
<text text-anchor="middle" x="4647" y="-7565.64" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="4647" y="-7554.64" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="4647" y="-7543.64" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_10_mlp_fc2_gpu14&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge656" class="edge">
<title>layer_10_mlp_fc2_gpu14&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4597.25,-7539.47C4594.48,-7538.46 4591.71,-7537.51 4589,-7536.64 4512.85,-7512.16 4422.59,-7494.02 4362.57,-7483.42"/>
<polygon fill="black" stroke="black" points="4362.92,-7479.93 4352.47,-7481.66 4361.72,-7486.83 4362.92,-7479.93"/>
</g>
<!-- layer_10_mlp_fc2_gpu15&#45;&gt;layer_10_allreduce_mlp -->
<g id="edge657" class="edge">
<title>layer_10_mlp_fc2_gpu15&#45;&gt;layer_10_allreduce_mlp</title>
<path fill="none" stroke="black" d="M3877.58,-7539.62C3880.74,-7538.53 3883.9,-7537.52 3887,-7536.64 4003.77,-7503.31 4144.55,-7486.1 4226.8,-7478.25"/>
<polygon fill="black" stroke="black" points="4227.14,-7481.74 4236.77,-7477.32 4226.49,-7474.77 4227.14,-7481.74"/>
</g>
<!-- layer_10_allreduce_mlp&#45;&gt;layer_10_residual2 -->
<g id="edge658" class="edge">
<title>layer_10_allreduce_mlp&#45;&gt;layer_10_residual2</title>
<path fill="none" stroke="black" d="M4339.82,-7451.6C4371.93,-7437.65 4415.85,-7418.57 4451.03,-7403.28"/>
<polygon fill="black" stroke="black" points="4452.47,-7406.47 4460.24,-7399.28 4449.68,-7400.05 4452.47,-7406.47"/>
</g>
<!-- layer_10_ln2 -->
<g id="node484" class="node">
<title>layer_10_ln2</title>
<polygon fill="lightblue" stroke="black" points="4546.5,-7310.66 4473.5,-7310.66 4473.5,-7269.66 4546.5,-7269.66 4546.5,-7310.66"/>
<text text-anchor="middle" x="4510" y="-7298.66" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="4510" y="-7287.66" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="4510" y="-7276.66" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_10_residual2&#45;&gt;layer_10_ln2 -->
<g id="edge660" class="edge">
<title>layer_10_residual2&#45;&gt;layer_10_ln2</title>
<path fill="none" stroke="black" d="M4510,-7346.58C4510,-7338.25 4510,-7329.17 4510,-7320.81"/>
<polygon fill="black" stroke="black" points="4513.5,-7320.72 4510,-7310.72 4506.5,-7320.72 4513.5,-7320.72"/>
</g>
<!-- layer_10_output_dist -->
<g id="node485" class="node">
<title>layer_10_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="4611.7,-7233.66 4449.92,-7233.66 4408.3,-7173.66 4570.08,-7173.66 4611.7,-7233.66"/>
<text text-anchor="middle" x="4510" y="-7206.66" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="4510" y="-7195.66" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_10_ln2&#45;&gt;layer_10_output_dist -->
<g id="edge661" class="edge">
<title>layer_10_ln2&#45;&gt;layer_10_output_dist</title>
<path fill="none" stroke="black" d="M4510,-7269.56C4510,-7261.92 4510,-7252.88 4510,-7244.01"/>
<polygon fill="black" stroke="black" points="4513.5,-7243.76 4510,-7233.76 4506.5,-7243.76 4513.5,-7243.76"/>
</g>
<!-- layer_11_input_dist -->
<g id="node486" class="node">
<title>layer_11_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="4604.19,-7137.66 4454.36,-7137.66 4415.81,-7077.66 4565.64,-7077.66 4604.19,-7137.66"/>
<text text-anchor="middle" x="4510" y="-7110.66" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="4510" y="-7099.66" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_10_output_dist&#45;&gt;layer_11_input_dist -->
<g id="edge662" class="edge">
<title>layer_10_output_dist&#45;&gt;layer_11_input_dist</title>
<path fill="none" stroke="black" d="M4510,-7173.43C4510,-7165.38 4510,-7156.52 4510,-7148"/>
<polygon fill="black" stroke="black" points="4513.5,-7147.86 4510,-7137.86 4506.5,-7147.86 4513.5,-7147.86"/>
</g>
<!-- layer_11_qkv_gpu8 -->
<g id="node487" class="node">
<title>layer_11_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="4095,-7041.66 3997,-7041.66 3997,-6989.66 4095,-6989.66 4095,-7041.66"/>
<text text-anchor="middle" x="4046" y="-7029.66" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="4046" y="-7018.66" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="4046" y="-7007.66" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="4046" y="-6996.66" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu8 -->
<g id="edge663" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu8</title>
<path fill="none" stroke="black" d="M4429.74,-7099.74C4349.17,-7091.46 4221.73,-7074.73 4104.88,-7041.62"/>
<polygon fill="black" stroke="black" points="4105.63,-7038.19 4095.05,-7038.78 4103.69,-7044.92 4105.63,-7038.19"/>
</g>
<!-- layer_11_qkv_gpu9 -->
<g id="node488" class="node">
<title>layer_11_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="4211,-7041.66 4113,-7041.66 4113,-6989.66 4211,-6989.66 4211,-7041.66"/>
<text text-anchor="middle" x="4162" y="-7029.66" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="4162" y="-7018.66" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="4162" y="-7007.66" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="4162" y="-6996.66" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu9 -->
<g id="edge664" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu9</title>
<path fill="none" stroke="black" d="M4424.81,-7091.9C4368.93,-7081.22 4294.34,-7065.05 4220.99,-7041.75"/>
<polygon fill="black" stroke="black" points="4221.71,-7038.31 4211.12,-7038.57 4219.56,-7044.97 4221.71,-7038.31"/>
</g>
<!-- layer_11_qkv_gpu10 -->
<g id="node489" class="node">
<title>layer_11_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="4327,-7041.66 4229,-7041.66 4229,-6989.66 4327,-6989.66 4327,-7041.66"/>
<text text-anchor="middle" x="4278" y="-7029.66" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="4278" y="-7018.66" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="4278" y="-7007.66" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="4278" y="-6996.66" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu10 -->
<g id="edge665" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu10</title>
<path fill="none" stroke="black" d="M4429.55,-7077.55C4402.43,-7067.51 4371.86,-7055.94 4336.8,-7041.92"/>
<polygon fill="black" stroke="black" points="4337.88,-7038.58 4327.29,-7038.1 4335.27,-7045.07 4337.88,-7038.58"/>
</g>
<!-- layer_11_qkv_gpu11 -->
<g id="node490" class="node">
<title>layer_11_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="4443,-7041.66 4345,-7041.66 4345,-6989.66 4443,-6989.66 4443,-7041.66"/>
<text text-anchor="middle" x="4394" y="-7029.66" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="4394" y="-7018.66" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="4394" y="-7007.66" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="4394" y="-6996.66" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu11 -->
<g id="edge666" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu11</title>
<path fill="none" stroke="black" d="M4472.34,-7077.43C4460.18,-7068 4446.66,-7057.51 4434.32,-7047.94"/>
<polygon fill="black" stroke="black" points="4436.46,-7045.16 4426.41,-7041.8 4432.16,-7050.7 4436.46,-7045.16"/>
</g>
<!-- layer_11_qkv_gpu12 -->
<g id="node491" class="node">
<title>layer_11_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="4559,-7041.66 4461,-7041.66 4461,-6989.66 4559,-6989.66 4559,-7041.66"/>
<text text-anchor="middle" x="4510" y="-7029.66" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="4510" y="-7018.66" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="4510" y="-7007.66" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="4510" y="-6996.66" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu12 -->
<g id="edge667" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu12</title>
<path fill="none" stroke="black" d="M4510,-7077.19C4510,-7069.11 4510,-7060.28 4510,-7051.91"/>
<polygon fill="black" stroke="black" points="4513.5,-7051.67 4510,-7041.67 4506.5,-7051.67 4513.5,-7051.67"/>
</g>
<!-- layer_11_qkv_gpu13 -->
<g id="node492" class="node">
<title>layer_11_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="4675,-7041.66 4577,-7041.66 4577,-6989.66 4675,-6989.66 4675,-7041.66"/>
<text text-anchor="middle" x="4626" y="-7029.66" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="4626" y="-7018.66" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="4626" y="-7007.66" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="4626" y="-6996.66" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu13 -->
<g id="edge668" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu13</title>
<path fill="none" stroke="black" d="M4547.66,-7077.43C4559.82,-7068 4573.34,-7057.51 4585.68,-7047.94"/>
<polygon fill="black" stroke="black" points="4587.84,-7050.7 4593.59,-7041.8 4583.54,-7045.16 4587.84,-7050.7"/>
</g>
<!-- layer_11_qkv_gpu14 -->
<g id="node493" class="node">
<title>layer_11_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4791,-7041.66 4693,-7041.66 4693,-6989.66 4791,-6989.66 4791,-7041.66"/>
<text text-anchor="middle" x="4742" y="-7029.66" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="4742" y="-7018.66" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="4742" y="-7007.66" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="4742" y="-6996.66" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu14 -->
<g id="edge669" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu14</title>
<path fill="none" stroke="black" d="M4570.68,-7084.82C4601.94,-7073.38 4640.85,-7058.84 4683.31,-7041.87"/>
<polygon fill="black" stroke="black" points="4684.73,-7045.07 4692.71,-7038.1 4682.12,-7038.58 4684.73,-7045.07"/>
</g>
<!-- layer_11_qkv_gpu15 -->
<g id="node494" class="node">
<title>layer_11_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4907,-7041.66 4809,-7041.66 4809,-6989.66 4907,-6989.66 4907,-7041.66"/>
<text text-anchor="middle" x="4858" y="-7029.66" font-family="Arial" font-size="10.00">Layer 11 QKV Proj</text>
<text text-anchor="middle" x="4858" y="-7018.66" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="4858" y="-7007.66" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="4858" y="-6996.66" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_qkv_gpu15 -->
<g id="edge670" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_qkv_gpu15</title>
<path fill="none" stroke="black" d="M4577.18,-7095.28C4634.25,-7084.78 4718.28,-7067.37 4799.05,-7041.74"/>
<polygon fill="black" stroke="black" points="4800.43,-7044.97 4808.88,-7038.57 4798.29,-7038.3 4800.43,-7044.97"/>
</g>
<!-- layer_11_residual1 -->
<g id="node506" class="node">
<title>layer_11_residual1</title>
<polygon fill="lightyellow" stroke="black" points="4885.94,-6589.69 4763.55,-6589.69 4732.06,-6529.69 4854.45,-6529.69 4885.94,-6589.69"/>
<text text-anchor="middle" x="4809" y="-6562.69" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="4809" y="-6551.69" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_11_input_dist&#45;&gt;layer_11_residual1 -->
<g id="edge690" class="edge">
<title>layer_11_input_dist&#45;&gt;layer_11_residual1</title>
<path fill="none" stroke="black" d="M4580.91,-7101.3C4681.62,-7092.68 4860.06,-7073.43 4916,-7041.66 4974.43,-7008.47 5013,-6992.87 5013,-6925.66 5013,-6925.66 5013,-6925.66 5013,-6744.67 5013,-6674.73 4946.05,-6624.54 4888.86,-6594.43"/>
<polygon fill="black" stroke="black" points="4890.27,-6591.22 4879.78,-6589.77 4887.08,-6597.45 4890.27,-6591.22"/>
</g>
<!-- layer_11_allgather_qkv -->
<g id="node495" class="node">
<title>layer_11_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="4394" cy="-6924.66" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="4394" y="-6933.16" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="4394" y="-6922.16" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="4394" y="-6911.16" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_11_qkv_gpu8&#45;&gt;layer_11_allgather_qkv -->
<g id="edge671" class="edge">
<title>layer_11_qkv_gpu8&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M4095.12,-6992.73C4098.1,-6991.63 4101.08,-6990.6 4104,-6989.66 4180.19,-6965.08 4270.64,-6946.77 4330.02,-6936.17"/>
<polygon fill="black" stroke="black" points="4330.77,-6939.6 4340.01,-6934.41 4329.55,-6932.7 4330.77,-6939.6"/>
</g>
<!-- layer_11_qkv_gpu9&#45;&gt;layer_11_allgather_qkv -->
<g id="edge672" class="edge">
<title>layer_11_qkv_gpu9&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M4211.28,-6993.19C4214.23,-6991.98 4217.15,-6990.79 4220,-6989.66 4259.04,-6974.07 4303.54,-6957.74 4337.76,-6945.47"/>
<polygon fill="black" stroke="black" points="4339.34,-6948.62 4347.58,-6941.96 4336.98,-6942.03 4339.34,-6948.62"/>
</g>
<!-- layer_11_qkv_gpu10&#45;&gt;layer_11_allgather_qkv -->
<g id="edge673" class="edge">
<title>layer_11_qkv_gpu10&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M4310.62,-6989.63C4324.4,-6979.06 4340.56,-6966.66 4354.97,-6955.61"/>
<polygon fill="black" stroke="black" points="4357.41,-6958.14 4363.22,-6949.28 4353.15,-6952.59 4357.41,-6958.14"/>
</g>
<!-- layer_11_qkv_gpu11&#45;&gt;layer_11_allgather_qkv -->
<g id="edge674" class="edge">
<title>layer_11_qkv_gpu11&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M4394,-6989.39C4394,-6981.5 4394,-6972.61 4394,-6964.03"/>
<polygon fill="black" stroke="black" points="4397.5,-6963.81 4394,-6953.81 4390.5,-6963.81 4397.5,-6963.81"/>
</g>
<!-- layer_11_qkv_gpu12&#45;&gt;layer_11_allgather_qkv -->
<g id="edge675" class="edge">
<title>layer_11_qkv_gpu12&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M4477.38,-6989.63C4463.6,-6979.06 4447.44,-6966.66 4433.03,-6955.61"/>
<polygon fill="black" stroke="black" points="4434.85,-6952.59 4424.78,-6949.28 4430.59,-6958.14 4434.85,-6952.59"/>
</g>
<!-- layer_11_qkv_gpu13&#45;&gt;layer_11_allgather_qkv -->
<g id="edge676" class="edge">
<title>layer_11_qkv_gpu13&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M4576.72,-6993.19C4573.77,-6991.98 4570.85,-6990.79 4568,-6989.66 4528.96,-6974.07 4484.46,-6957.74 4450.24,-6945.47"/>
<polygon fill="black" stroke="black" points="4451.02,-6942.03 4440.42,-6941.96 4448.66,-6948.62 4451.02,-6942.03"/>
</g>
<!-- layer_11_qkv_gpu14&#45;&gt;layer_11_allgather_qkv -->
<g id="edge677" class="edge">
<title>layer_11_qkv_gpu14&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M4692.88,-6992.73C4689.9,-6991.63 4686.92,-6990.6 4684,-6989.66 4607.81,-6965.08 4517.36,-6946.77 4457.98,-6936.17"/>
<polygon fill="black" stroke="black" points="4458.45,-6932.7 4447.99,-6934.41 4457.23,-6939.6 4458.45,-6932.7"/>
</g>
<!-- layer_11_qkv_gpu15&#45;&gt;layer_11_allgather_qkv -->
<g id="edge678" class="edge">
<title>layer_11_qkv_gpu15&#45;&gt;layer_11_allgather_qkv</title>
<path fill="none" stroke="black" d="M4808.95,-6992.52C4805.95,-6991.47 4802.95,-6990.51 4800,-6989.66 4683.16,-6955.85 4541.91,-6938.69 4460.56,-6931"/>
<polygon fill="black" stroke="black" points="4460.74,-6927.5 4450.46,-6930.06 4460.09,-6934.47 4460.74,-6927.5"/>
</g>
<!-- layer_11_attention -->
<g id="node496" class="node">
<title>layer_11_attention</title>
<polygon fill="lightblue" stroke="black" points="4273,-6859.67 4205,-6859.67 4205,-6807.67 4273,-6807.67 4273,-6859.67"/>
<text text-anchor="middle" x="4239" y="-6847.67" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="4239" y="-6836.67" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="4239" y="-6825.67" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="4239" y="-6814.67" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_11_allgather_qkv&#45;&gt;layer_11_attention -->
<g id="edge679" class="edge">
<title>layer_11_allgather_qkv&#45;&gt;layer_11_attention</title>
<path fill="none" stroke="black" d="M4356.87,-6902.35C4334.32,-6889.4 4305.44,-6872.82 4281.91,-6859.31"/>
<polygon fill="black" stroke="black" points="4283.59,-6856.24 4273.17,-6854.29 4280.1,-6862.31 4283.59,-6856.24"/>
</g>
<!-- layer_11_attn_out_gpu15 -->
<g id="node504" class="node">
<title>layer_11_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4207.5,-6771.67 4114.5,-6771.67 4114.5,-6719.67 4207.5,-6719.67 4207.5,-6771.67"/>
<text text-anchor="middle" x="4161" y="-6759.67" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="4161" y="-6748.67" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="4161" y="-6737.67" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="4161" y="-6726.67" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attention&#45;&gt;layer_11_attn_out_gpu15 -->
<g id="edge680" class="edge">
<title>layer_11_attention&#45;&gt;layer_11_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M4216.02,-6807.33C4208.09,-6798.59 4199.08,-6788.66 4190.69,-6779.4"/>
<polygon fill="black" stroke="black" points="4193.13,-6776.88 4183.82,-6771.83 4187.94,-6781.59 4193.13,-6776.88"/>
</g>
<!-- layer_11_attn_out_gpu8 -->
<g id="node497" class="node">
<title>layer_11_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="4318.5,-6771.67 4225.5,-6771.67 4225.5,-6719.67 4318.5,-6719.67 4318.5,-6771.67"/>
<text text-anchor="middle" x="4272" y="-6759.67" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="4272" y="-6748.67" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="4272" y="-6737.67" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="4272" y="-6726.67" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_allreduce_attn -->
<g id="node505" class="node">
<title>layer_11_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="4605" cy="-6654.68" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="4605" y="-6663.18" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="4605" y="-6652.18" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="4605" y="-6641.18" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_11_attn_out_gpu8&#45;&gt;layer_11_allreduce_attn -->
<g id="edge681" class="edge">
<title>layer_11_attn_out_gpu8&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M4318.79,-6723C4321.88,-6721.81 4324.97,-6720.69 4328,-6719.67 4399.41,-6695.73 4484.1,-6677.6 4540.87,-6666.85"/>
<polygon fill="black" stroke="black" points="4541.6,-6670.28 4550.79,-6665 4540.32,-6663.4 4541.6,-6670.28"/>
</g>
<!-- layer_11_attn_out_gpu9 -->
<g id="node498" class="node">
<title>layer_11_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="4429.5,-6771.67 4336.5,-6771.67 4336.5,-6719.67 4429.5,-6719.67 4429.5,-6771.67"/>
<text text-anchor="middle" x="4383" y="-6759.67" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="4383" y="-6748.67" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="4383" y="-6737.67" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="4383" y="-6726.67" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attn_out_gpu9&#45;&gt;layer_11_allreduce_attn -->
<g id="edge682" class="edge">
<title>layer_11_attn_out_gpu9&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M4429.67,-6723.62C4432.82,-6722.27 4435.95,-6720.94 4439,-6719.67 4475.57,-6704.47 4517.16,-6688.44 4549.56,-6676.23"/>
<polygon fill="black" stroke="black" points="4551.17,-6679.36 4559.3,-6672.57 4548.71,-6672.81 4551.17,-6679.36"/>
</g>
<!-- layer_11_attn_out_gpu10 -->
<g id="node499" class="node">
<title>layer_11_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="4540.5,-6771.67 4447.5,-6771.67 4447.5,-6719.67 4540.5,-6719.67 4540.5,-6771.67"/>
<text text-anchor="middle" x="4494" y="-6759.67" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="4494" y="-6748.67" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="4494" y="-6737.67" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="4494" y="-6726.67" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attn_out_gpu10&#45;&gt;layer_11_allreduce_attn -->
<g id="edge683" class="edge">
<title>layer_11_attn_out_gpu10&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M4525.22,-6719.65C4538.29,-6709.16 4553.61,-6696.88 4567.31,-6685.89"/>
<polygon fill="black" stroke="black" points="4569.55,-6688.59 4575.17,-6679.6 4565.17,-6683.12 4569.55,-6688.59"/>
</g>
<!-- layer_11_attn_out_gpu11 -->
<g id="node500" class="node">
<title>layer_11_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="4651.5,-6771.67 4558.5,-6771.67 4558.5,-6719.67 4651.5,-6719.67 4651.5,-6771.67"/>
<text text-anchor="middle" x="4605" y="-6759.67" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="4605" y="-6748.67" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="4605" y="-6737.67" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="4605" y="-6726.67" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attn_out_gpu11&#45;&gt;layer_11_allreduce_attn -->
<g id="edge684" class="edge">
<title>layer_11_attn_out_gpu11&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M4605,-6719.41C4605,-6711.52 4605,-6702.63 4605,-6694.05"/>
<polygon fill="black" stroke="black" points="4608.5,-6693.82 4605,-6683.82 4601.5,-6693.82 4608.5,-6693.82"/>
</g>
<!-- layer_11_attn_out_gpu12 -->
<g id="node501" class="node">
<title>layer_11_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="4762.5,-6771.67 4669.5,-6771.67 4669.5,-6719.67 4762.5,-6719.67 4762.5,-6771.67"/>
<text text-anchor="middle" x="4716" y="-6759.67" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="4716" y="-6748.67" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="4716" y="-6737.67" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="4716" y="-6726.67" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attn_out_gpu12&#45;&gt;layer_11_allreduce_attn -->
<g id="edge685" class="edge">
<title>layer_11_attn_out_gpu12&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M4684.78,-6719.65C4671.71,-6709.16 4656.39,-6696.88 4642.69,-6685.89"/>
<polygon fill="black" stroke="black" points="4644.83,-6683.12 4634.83,-6679.6 4640.45,-6688.59 4644.83,-6683.12"/>
</g>
<!-- layer_11_attn_out_gpu13 -->
<g id="node502" class="node">
<title>layer_11_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="4873.5,-6771.67 4780.5,-6771.67 4780.5,-6719.67 4873.5,-6719.67 4873.5,-6771.67"/>
<text text-anchor="middle" x="4827" y="-6759.67" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="4827" y="-6748.67" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="4827" y="-6737.67" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="4827" y="-6726.67" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attn_out_gpu13&#45;&gt;layer_11_allreduce_attn -->
<g id="edge686" class="edge">
<title>layer_11_attn_out_gpu13&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M4780.28,-6723.2C4777.48,-6721.99 4774.71,-6720.81 4772,-6719.67 4735.11,-6704.24 4693.07,-6688.14 4660.4,-6675.95"/>
<polygon fill="black" stroke="black" points="4661.61,-6672.66 4651.02,-6672.46 4659.17,-6679.22 4661.61,-6672.66"/>
</g>
<!-- layer_11_attn_out_gpu14 -->
<g id="node503" class="node">
<title>layer_11_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4984.5,-6771.67 4891.5,-6771.67 4891.5,-6719.67 4984.5,-6719.67 4984.5,-6771.67"/>
<text text-anchor="middle" x="4938" y="-6759.67" font-family="Arial" font-size="10.00">Layer 11 Attn Out</text>
<text text-anchor="middle" x="4938" y="-6748.67" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="4938" y="-6737.67" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="4938" y="-6726.67" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_11_attn_out_gpu14&#45;&gt;layer_11_allreduce_attn -->
<g id="edge687" class="edge">
<title>layer_11_attn_out_gpu14&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M4891.45,-6722.75C4888.61,-6721.65 4885.78,-6720.61 4883,-6719.67 4811.42,-6695.44 4726.4,-6677.36 4669.4,-6666.71"/>
<polygon fill="black" stroke="black" points="4669.91,-6663.24 4659.44,-6664.87 4668.64,-6670.13 4669.91,-6663.24"/>
</g>
<!-- layer_11_attn_out_gpu15&#45;&gt;layer_11_allreduce_attn -->
<g id="edge688" class="edge">
<title>layer_11_attn_out_gpu15&#45;&gt;layer_11_allreduce_attn</title>
<path fill="none" stroke="black" d="M4207.72,-6722.77C4210.83,-6721.64 4213.94,-6720.59 4217,-6719.67 4326.82,-6686.7 4459.56,-6669.45 4537.86,-6661.48"/>
<polygon fill="black" stroke="black" points="4538.47,-6664.94 4548.07,-6660.46 4537.77,-6657.97 4538.47,-6664.94"/>
</g>
<!-- layer_11_allreduce_attn&#45;&gt;layer_11_residual1 -->
<g id="edge689" class="edge">
<title>layer_11_allreduce_attn&#45;&gt;layer_11_residual1</title>
<path fill="none" stroke="black" d="M4647.27,-6634.41C4677.12,-6620.81 4717.5,-6602.4 4750.45,-6587.38"/>
<polygon fill="black" stroke="black" points="4752.32,-6590.37 4759.97,-6583.04 4749.42,-6584 4752.32,-6590.37"/>
</g>
<!-- layer_11_ln1 -->
<g id="node507" class="node">
<title>layer_11_ln1</title>
<polygon fill="lightblue" stroke="black" points="4631.5,-6493.69 4558.5,-6493.69 4558.5,-6452.69 4631.5,-6452.69 4631.5,-6493.69"/>
<text text-anchor="middle" x="4595" y="-6481.69" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="4595" y="-6470.69" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="4595" y="-6459.69" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_11_residual1&#45;&gt;layer_11_ln1 -->
<g id="edge691" class="edge">
<title>layer_11_residual1&#45;&gt;layer_11_ln1</title>
<path fill="none" stroke="black" d="M4735.35,-6529.61C4703.99,-6517.23 4668.38,-6503.16 4640.87,-6492.3"/>
<polygon fill="black" stroke="black" points="4642.09,-6489.02 4631.5,-6488.6 4639.52,-6495.53 4642.09,-6489.02"/>
</g>
<!-- layer_11_residual2 -->
<g id="node527" class="node">
<title>layer_11_residual2</title>
<polygon fill="lightyellow" stroke="black" points="4973.94,-5980.72 4851.55,-5980.72 4820.06,-5920.72 4942.45,-5920.72 4973.94,-5980.72"/>
<text text-anchor="middle" x="4897" y="-5953.72" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="4897" y="-5942.72" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_11_residual1&#45;&gt;layer_11_residual2 -->
<g id="edge719" class="edge">
<title>layer_11_residual1&#45;&gt;layer_11_residual2</title>
<path fill="none" stroke="black" d="M4866.71,-6552.82C4954.62,-6540.33 5112,-6502.51 5112,-6391.69 5112,-6391.69 5112,-6391.69 5112,-6135.71 5112,-6064.33 5042.75,-6014.71 4982.85,-5985.14"/>
<polygon fill="black" stroke="black" points="4984.24,-5981.93 4973.71,-5980.75 4981.2,-5988.23 4984.24,-5981.93"/>
</g>
<!-- layer_11_mlp_fc1_gpu8 -->
<g id="node508" class="node">
<title>layer_11_mlp_fc1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="4176.5,-6416.69 4077.5,-6416.69 4077.5,-6364.69 4176.5,-6364.69 4176.5,-6416.69"/>
<text text-anchor="middle" x="4127" y="-6404.69" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="4127" y="-6393.69" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="4127" y="-6382.69" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="4127" y="-6371.69" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu8 -->
<g id="edge692" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu8</title>
<path fill="none" stroke="black" d="M4558.24,-6470.47C4487.44,-6466.47 4327.46,-6454.05 4186.26,-6416.42"/>
<polygon fill="black" stroke="black" points="4187.13,-6413.03 4176.56,-6413.79 4185.29,-6419.78 4187.13,-6413.03"/>
</g>
<!-- layer_11_mlp_fc1_gpu9 -->
<g id="node509" class="node">
<title>layer_11_mlp_fc1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="4293.5,-6416.69 4194.5,-6416.69 4194.5,-6364.69 4293.5,-6364.69 4293.5,-6416.69"/>
<text text-anchor="middle" x="4244" y="-6404.69" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="4244" y="-6393.69" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="4244" y="-6382.69" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="4244" y="-6371.69" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu9 -->
<g id="edge693" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu9</title>
<path fill="none" stroke="black" d="M4558.44,-6467.79C4504.35,-6460.73 4399.89,-6444.99 4303.24,-6416.48"/>
<polygon fill="black" stroke="black" points="4304.2,-6413.12 4293.62,-6413.59 4302.19,-6419.82 4304.2,-6413.12"/>
</g>
<!-- layer_11_mlp_fc1_gpu10 -->
<g id="node510" class="node">
<title>layer_11_mlp_fc1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="4410.5,-6416.69 4311.5,-6416.69 4311.5,-6364.69 4410.5,-6364.69 4410.5,-6416.69"/>
<text text-anchor="middle" x="4361" y="-6404.69" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="4361" y="-6393.69" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="4361" y="-6382.69" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="4361" y="-6371.69" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu10 -->
<g id="edge694" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu10</title>
<path fill="none" stroke="black" d="M4558.47,-6461.69C4524.85,-6451.79 4473.47,-6436.06 4420.35,-6416.69"/>
<polygon fill="black" stroke="black" points="4421.36,-6413.33 4410.76,-6413.16 4418.94,-6419.9 4421.36,-6413.33"/>
</g>
<!-- layer_11_mlp_fc1_gpu11 -->
<g id="node511" class="node">
<title>layer_11_mlp_fc1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="4527.5,-6416.69 4428.5,-6416.69 4428.5,-6364.69 4527.5,-6364.69 4527.5,-6416.69"/>
<text text-anchor="middle" x="4478" y="-6404.69" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="4478" y="-6393.69" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="4478" y="-6382.69" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="4478" y="-6371.69" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu11 -->
<g id="edge695" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu11</title>
<path fill="none" stroke="black" d="M4566.38,-6452.5C4553.37,-6443.55 4537.67,-6432.74 4523.13,-6422.74"/>
<polygon fill="black" stroke="black" points="4524.96,-6419.75 4514.74,-6416.97 4520.99,-6425.52 4524.96,-6419.75"/>
</g>
<!-- layer_11_mlp_fc1_gpu12 -->
<g id="node512" class="node">
<title>layer_11_mlp_fc1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="4644.5,-6416.69 4545.5,-6416.69 4545.5,-6364.69 4644.5,-6364.69 4644.5,-6416.69"/>
<text text-anchor="middle" x="4595" y="-6404.69" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="4595" y="-6393.69" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="4595" y="-6382.69" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="4595" y="-6371.69" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu12 -->
<g id="edge696" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu12</title>
<path fill="none" stroke="black" d="M4595,-6452.29C4595,-6444.68 4595,-6435.75 4595,-6427.12"/>
<polygon fill="black" stroke="black" points="4598.5,-6426.84 4595,-6416.84 4591.5,-6426.84 4598.5,-6426.84"/>
</g>
<!-- layer_11_mlp_fc1_gpu13 -->
<g id="node513" class="node">
<title>layer_11_mlp_fc1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="4761.5,-6416.69 4662.5,-6416.69 4662.5,-6364.69 4761.5,-6364.69 4761.5,-6416.69"/>
<text text-anchor="middle" x="4712" y="-6404.69" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="4712" y="-6393.69" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="4712" y="-6382.69" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="4712" y="-6371.69" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu13 -->
<g id="edge697" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu13</title>
<path fill="none" stroke="black" d="M4623.62,-6452.5C4636.63,-6443.55 4652.33,-6432.74 4666.87,-6422.74"/>
<polygon fill="black" stroke="black" points="4669.01,-6425.52 4675.26,-6416.97 4665.04,-6419.75 4669.01,-6425.52"/>
</g>
<!-- layer_11_mlp_fc1_gpu14 -->
<g id="node514" class="node">
<title>layer_11_mlp_fc1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4878.5,-6416.69 4779.5,-6416.69 4779.5,-6364.69 4878.5,-6364.69 4878.5,-6416.69"/>
<text text-anchor="middle" x="4829" y="-6404.69" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="4829" y="-6393.69" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="4829" y="-6382.69" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="4829" y="-6371.69" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu14 -->
<g id="edge698" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu14</title>
<path fill="none" stroke="black" d="M4631.77,-6461.78C4665.6,-6451.94 4717.29,-6436.25 4769.96,-6416.95"/>
<polygon fill="black" stroke="black" points="4771.3,-6420.19 4779.46,-6413.44 4768.87,-6413.62 4771.3,-6420.19"/>
</g>
<!-- layer_11_mlp_fc1_gpu15 -->
<g id="node515" class="node">
<title>layer_11_mlp_fc1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4995.5,-6416.69 4896.5,-6416.69 4896.5,-6364.69 4995.5,-6364.69 4995.5,-6416.69"/>
<text text-anchor="middle" x="4946" y="-6404.69" font-family="Arial" font-size="10.00">Layer 11 MLP FC1</text>
<text text-anchor="middle" x="4946" y="-6393.69" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="4946" y="-6382.69" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="4946" y="-6371.69" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu15 -->
<g id="edge699" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_mlp_fc1_gpu15</title>
<path fill="none" stroke="black" d="M4631.71,-6467.87C4685.96,-6460.93 4790.65,-6445.35 4886.44,-6416.92"/>
<polygon fill="black" stroke="black" points="4887.72,-6420.19 4896.27,-6413.95 4885.69,-6413.49 4887.72,-6420.19"/>
</g>
<!-- layer_11_allgather_mlp -->
<g id="node516" class="node">
<title>layer_11_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="4478" cy="-6299.7" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="4478" y="-6308.2" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="4478" y="-6297.2" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="4478" y="-6286.2" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_11_mlp_fc1_gpu8&#45;&gt;layer_11_allgather_mlp -->
<g id="edge700" class="edge">
<title>layer_11_mlp_fc1_gpu8&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M4176.65,-6367.89C4179.79,-6366.75 4182.93,-6365.67 4186,-6364.69 4263.13,-6340.13 4354.67,-6321.74 4414.43,-6311.12"/>
<polygon fill="black" stroke="black" points="4415.23,-6314.54 4424.47,-6309.36 4414.02,-6307.64 4415.23,-6314.54"/>
</g>
<!-- layer_11_mlp_fc1_gpu9&#45;&gt;layer_11_allgather_mlp -->
<g id="edge701" class="edge">
<title>layer_11_mlp_fc1_gpu9&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M4293.5,-6368.5C4296.71,-6367.19 4299.9,-6365.91 4303,-6364.69 4342.75,-6349.01 4388.07,-6332.48 4422.62,-6320.14"/>
<polygon fill="black" stroke="black" points="4423.83,-6323.43 4432.07,-6316.78 4421.48,-6316.84 4423.83,-6323.43"/>
</g>
<!-- layer_11_mlp_fc1_gpu10&#45;&gt;layer_11_allgather_mlp -->
<g id="edge702" class="edge">
<title>layer_11_mlp_fc1_gpu10&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M4393.9,-6364.66C4407.8,-6354.09 4424.1,-6341.69 4438.63,-6330.64"/>
<polygon fill="black" stroke="black" points="4441.11,-6333.15 4446.95,-6324.31 4436.87,-6327.58 4441.11,-6333.15"/>
</g>
<!-- layer_11_mlp_fc1_gpu11&#45;&gt;layer_11_allgather_mlp -->
<g id="edge703" class="edge">
<title>layer_11_mlp_fc1_gpu11&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M4478,-6364.43C4478,-6356.54 4478,-6347.65 4478,-6339.06"/>
<polygon fill="black" stroke="black" points="4481.5,-6338.84 4478,-6328.84 4474.5,-6338.84 4481.5,-6338.84"/>
</g>
<!-- layer_11_mlp_fc1_gpu12&#45;&gt;layer_11_allgather_mlp -->
<g id="edge704" class="edge">
<title>layer_11_mlp_fc1_gpu12&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M4562.1,-6364.66C4548.2,-6354.09 4531.9,-6341.69 4517.37,-6330.64"/>
<polygon fill="black" stroke="black" points="4519.13,-6327.58 4509.05,-6324.31 4514.89,-6333.15 4519.13,-6327.58"/>
</g>
<!-- layer_11_mlp_fc1_gpu13&#45;&gt;layer_11_allgather_mlp -->
<g id="edge705" class="edge">
<title>layer_11_mlp_fc1_gpu13&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M4662.41,-6368.09C4659.57,-6366.92 4656.75,-6365.78 4654,-6364.69 4614.09,-6348.85 4568.51,-6332.32 4533.74,-6320.03"/>
<polygon fill="black" stroke="black" points="4534.82,-6316.7 4524.23,-6316.68 4532.5,-6323.3 4534.82,-6316.7"/>
</g>
<!-- layer_11_mlp_fc1_gpu14&#45;&gt;layer_11_allgather_mlp -->
<g id="edge706" class="edge">
<title>layer_11_mlp_fc1_gpu14&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M4779.25,-6367.52C4776.48,-6366.52 4773.71,-6365.56 4771,-6364.69 4693.57,-6339.8 4601.53,-6321.46 4541.55,-6310.94"/>
<polygon fill="black" stroke="black" points="4541.92,-6307.45 4531.47,-6309.2 4540.73,-6314.35 4541.92,-6307.45"/>
</g>
<!-- layer_11_mlp_fc1_gpu15&#45;&gt;layer_11_allgather_mlp -->
<g id="edge707" class="edge">
<title>layer_11_mlp_fc1_gpu15&#45;&gt;layer_11_allgather_mlp</title>
<path fill="none" stroke="black" d="M4896.31,-6367.32C4893.52,-6366.37 4890.74,-6365.48 4888,-6364.69 4769.35,-6330.45 4625.76,-6313.38 4543.84,-6305.83"/>
<polygon fill="black" stroke="black" points="4543.94,-6302.32 4533.67,-6304.91 4543.32,-6309.29 4543.94,-6302.32"/>
</g>
<!-- layer_11_gelu -->
<g id="node517" class="node">
<title>layer_11_gelu</title>
<polygon fill="lightblue" stroke="black" points="4434.5,-6234.71 4345.5,-6234.71 4345.5,-6198.71 4434.5,-6198.71 4434.5,-6234.71"/>
<text text-anchor="middle" x="4390" y="-6219.71" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="4390" y="-6208.71" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_11_allgather_mlp&#45;&gt;layer_11_gelu -->
<g id="edge708" class="edge">
<title>layer_11_allgather_mlp&#45;&gt;layer_11_gelu</title>
<path fill="none" stroke="black" d="M4451.12,-6273.96C4440.06,-6263.78 4427.28,-6252.02 4416.28,-6241.9"/>
<polygon fill="black" stroke="black" points="4418.36,-6239.05 4408.64,-6234.86 4413.62,-6244.21 4418.36,-6239.05"/>
</g>
<!-- layer_11_mlp_fc2_gpu15 -->
<g id="node525" class="node">
<title>layer_11_mlp_fc2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4264.5,-6162.71 4165.5,-6162.71 4165.5,-6110.71 4264.5,-6110.71 4264.5,-6162.71"/>
<text text-anchor="middle" x="4215" y="-6150.71" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="4215" y="-6139.71" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="4215" y="-6128.71" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="4215" y="-6117.71" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu15 -->
<g id="edge709" class="edge">
<title>layer_11_gelu&#45;&gt;layer_11_mlp_fc2_gpu15</title>
<path fill="none" stroke="black" d="M4351.6,-6198.59C4328.83,-6188.44 4299.52,-6175.38 4273.89,-6163.95"/>
<polygon fill="black" stroke="black" points="4275.19,-6160.7 4264.63,-6159.83 4272.34,-6167.1 4275.19,-6160.7"/>
</g>
<!-- layer_11_mlp_fc2_gpu8 -->
<g id="node518" class="node">
<title>layer_11_mlp_fc2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="4381.5,-6162.71 4282.5,-6162.71 4282.5,-6110.71 4381.5,-6110.71 4381.5,-6162.71"/>
<text text-anchor="middle" x="4332" y="-6150.71" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="4332" y="-6139.71" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="4332" y="-6128.71" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="4332" y="-6117.71" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_allreduce_mlp -->
<g id="node526" class="node">
<title>layer_11_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="4683" cy="-6045.72" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="4683" y="-6054.22" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="4683" y="-6043.22" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="4683" y="-6032.22" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_11_mlp_fc2_gpu8&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge710" class="edge">
<title>layer_11_mlp_fc2_gpu8&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4381.65,-6113.91C4384.79,-6112.76 4387.93,-6111.69 4391,-6110.71 4466.85,-6086.56 4556.62,-6068.37 4616.41,-6057.68"/>
<polygon fill="black" stroke="black" points="4617.24,-6061.09 4626.48,-6055.9 4616.03,-6054.19 4617.24,-6061.09"/>
</g>
<!-- layer_11_mlp_fc2_gpu9 -->
<g id="node519" class="node">
<title>layer_11_mlp_fc2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="4498.5,-6162.71 4399.5,-6162.71 4399.5,-6110.71 4498.5,-6110.71 4498.5,-6162.71"/>
<text text-anchor="middle" x="4449" y="-6150.71" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="4449" y="-6139.71" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="4449" y="-6128.71" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="4449" y="-6117.71" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_mlp_fc2_gpu9&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge711" class="edge">
<title>layer_11_mlp_fc2_gpu9&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4498.5,-6114.52C4501.71,-6113.21 4504.9,-6111.93 4508,-6110.71 4546.89,-6095.37 4591.12,-6079.21 4625.38,-6066.96"/>
<polygon fill="black" stroke="black" points="4626.98,-6070.11 4635.22,-6063.46 4624.63,-6063.52 4626.98,-6070.11"/>
</g>
<!-- layer_11_mlp_fc2_gpu10 -->
<g id="node520" class="node">
<title>layer_11_mlp_fc2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="4615.5,-6162.71 4516.5,-6162.71 4516.5,-6110.71 4615.5,-6110.71 4615.5,-6162.71"/>
<text text-anchor="middle" x="4566" y="-6150.71" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="4566" y="-6139.71" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="4566" y="-6128.71" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="4566" y="-6117.71" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_mlp_fc2_gpu10&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge712" class="edge">
<title>layer_11_mlp_fc2_gpu10&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4598.9,-6110.68C4612.69,-6100.2 4628.84,-6087.91 4643.28,-6076.93"/>
<polygon fill="black" stroke="black" points="4645.71,-6079.47 4651.55,-6070.63 4641.47,-6073.9 4645.71,-6079.47"/>
</g>
<!-- layer_11_mlp_fc2_gpu11 -->
<g id="node521" class="node">
<title>layer_11_mlp_fc2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="4732.5,-6162.71 4633.5,-6162.71 4633.5,-6110.71 4732.5,-6110.71 4732.5,-6162.71"/>
<text text-anchor="middle" x="4683" y="-6150.71" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="4683" y="-6139.71" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="4683" y="-6128.71" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="4683" y="-6117.71" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_mlp_fc2_gpu11&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge713" class="edge">
<title>layer_11_mlp_fc2_gpu11&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4683,-6110.44C4683,-6102.55 4683,-6093.66 4683,-6085.08"/>
<polygon fill="black" stroke="black" points="4686.5,-6084.86 4683,-6074.86 4679.5,-6084.86 4686.5,-6084.86"/>
</g>
<!-- layer_11_mlp_fc2_gpu12 -->
<g id="node522" class="node">
<title>layer_11_mlp_fc2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="4849.5,-6162.71 4750.5,-6162.71 4750.5,-6110.71 4849.5,-6110.71 4849.5,-6162.71"/>
<text text-anchor="middle" x="4800" y="-6150.71" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="4800" y="-6139.71" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="4800" y="-6128.71" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="4800" y="-6117.71" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_mlp_fc2_gpu12&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge714" class="edge">
<title>layer_11_mlp_fc2_gpu12&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4767.1,-6110.68C4753.31,-6100.2 4737.16,-6087.91 4722.72,-6076.93"/>
<polygon fill="black" stroke="black" points="4724.53,-6073.9 4714.45,-6070.63 4720.29,-6079.47 4724.53,-6073.9"/>
</g>
<!-- layer_11_mlp_fc2_gpu13 -->
<g id="node523" class="node">
<title>layer_11_mlp_fc2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="4966.5,-6162.71 4867.5,-6162.71 4867.5,-6110.71 4966.5,-6110.71 4966.5,-6162.71"/>
<text text-anchor="middle" x="4917" y="-6150.71" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="4917" y="-6139.71" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="4917" y="-6128.71" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="4917" y="-6117.71" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_mlp_fc2_gpu13&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge715" class="edge">
<title>layer_11_mlp_fc2_gpu13&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4867.41,-6114.1C4864.57,-6112.94 4861.75,-6111.8 4859,-6110.71 4819.78,-6095.14 4775.08,-6078.91 4740.55,-6066.69"/>
<polygon fill="black" stroke="black" points="4741.69,-6063.38 4731.09,-6063.35 4739.36,-6069.98 4741.69,-6063.38"/>
</g>
<!-- layer_11_mlp_fc2_gpu14 -->
<g id="node524" class="node">
<title>layer_11_mlp_fc2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="5083.5,-6162.71 4984.5,-6162.71 4984.5,-6110.71 5083.5,-6110.71 5083.5,-6162.71"/>
<text text-anchor="middle" x="5034" y="-6150.71" font-family="Arial" font-size="10.00">Layer 11 MLP FC2</text>
<text text-anchor="middle" x="5034" y="-6139.71" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5034" y="-6128.71" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="5034" y="-6117.71" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_11_mlp_fc2_gpu14&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge716" class="edge">
<title>layer_11_mlp_fc2_gpu14&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4984.25,-6113.54C4981.48,-6112.53 4978.71,-6111.58 4976,-6110.71 4899.85,-6086.23 4809.59,-6068.09 4749.57,-6057.49"/>
<polygon fill="black" stroke="black" points="4749.92,-6054 4739.47,-6055.73 4748.72,-6060.89 4749.92,-6054"/>
</g>
<!-- layer_11_mlp_fc2_gpu15&#45;&gt;layer_11_allreduce_mlp -->
<g id="edge717" class="edge">
<title>layer_11_mlp_fc2_gpu15&#45;&gt;layer_11_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4264.58,-6113.68C4267.74,-6112.6 4270.9,-6111.59 4274,-6110.71 4390.77,-6077.38 4531.55,-6060.17 4613.8,-6052.32"/>
<polygon fill="black" stroke="black" points="4614.14,-6055.8 4623.77,-6051.39 4613.49,-6048.83 4614.14,-6055.8"/>
</g>
<!-- layer_11_allreduce_mlp&#45;&gt;layer_11_residual2 -->
<g id="edge718" class="edge">
<title>layer_11_allreduce_mlp&#45;&gt;layer_11_residual2</title>
<path fill="none" stroke="black" d="M4726.82,-6025.67C4758.93,-6011.72 4802.85,-5992.64 4838.03,-5977.35"/>
<polygon fill="black" stroke="black" points="4839.47,-5980.54 4847.24,-5973.35 4836.68,-5974.12 4839.47,-5980.54"/>
</g>
<!-- layer_11_ln2 -->
<g id="node528" class="node">
<title>layer_11_ln2</title>
<polygon fill="lightblue" stroke="black" points="4933.5,-5884.72 4860.5,-5884.72 4860.5,-5843.72 4933.5,-5843.72 4933.5,-5884.72"/>
<text text-anchor="middle" x="4897" y="-5872.72" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="4897" y="-5861.72" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="4897" y="-5850.72" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_11_residual2&#45;&gt;layer_11_ln2 -->
<g id="edge720" class="edge">
<title>layer_11_residual2&#45;&gt;layer_11_ln2</title>
<path fill="none" stroke="black" d="M4897,-5920.64C4897,-5912.32 4897,-5903.24 4897,-5894.88"/>
<polygon fill="black" stroke="black" points="4900.5,-5894.79 4897,-5884.79 4893.5,-5894.79 4900.5,-5894.79"/>
</g>
<!-- layer_11_output_dist -->
<g id="node529" class="node">
<title>layer_11_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="4998.7,-5807.72 4836.92,-5807.72 4795.3,-5747.72 4957.08,-5747.72 4998.7,-5807.72"/>
<text text-anchor="middle" x="4897" y="-5780.72" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="4897" y="-5769.72" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_11_ln2&#45;&gt;layer_11_output_dist -->
<g id="edge721" class="edge">
<title>layer_11_ln2&#45;&gt;layer_11_output_dist</title>
<path fill="none" stroke="black" d="M4897,-5843.63C4897,-5835.99 4897,-5826.94 4897,-5818.07"/>
<polygon fill="black" stroke="black" points="4900.5,-5817.83 4897,-5807.83 4893.5,-5817.83 4900.5,-5817.83"/>
</g>
<!-- layer_12_input_dist -->
<g id="node530" class="node">
<title>layer_12_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="4991.19,-5711.72 4841.36,-5711.72 4802.81,-5651.72 4952.64,-5651.72 4991.19,-5711.72"/>
<text text-anchor="middle" x="4897" y="-5684.72" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="4897" y="-5673.72" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_11_output_dist&#45;&gt;layer_12_input_dist -->
<g id="edge722" class="edge">
<title>layer_11_output_dist&#45;&gt;layer_12_input_dist</title>
<path fill="none" stroke="black" d="M4897,-5747.5C4897,-5739.45 4897,-5730.59 4897,-5722.07"/>
<polygon fill="black" stroke="black" points="4900.5,-5721.93 4897,-5711.93 4893.5,-5721.93 4900.5,-5721.93"/>
</g>
<!-- layer_12_qkv_gpu8 -->
<g id="node531" class="node">
<title>layer_12_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="4482,-5615.72 4384,-5615.72 4384,-5563.72 4482,-5563.72 4482,-5615.72"/>
<text text-anchor="middle" x="4433" y="-5603.72" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="4433" y="-5592.72" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="4433" y="-5581.72" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="4433" y="-5570.72" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu8 -->
<g id="edge723" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu8</title>
<path fill="none" stroke="black" d="M4816.74,-5673.81C4736.17,-5665.53 4608.73,-5648.8 4491.88,-5615.68"/>
<polygon fill="black" stroke="black" points="4492.63,-5612.26 4482.05,-5612.85 4490.69,-5618.98 4492.63,-5612.26"/>
</g>
<!-- layer_12_qkv_gpu9 -->
<g id="node532" class="node">
<title>layer_12_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="4598,-5615.72 4500,-5615.72 4500,-5563.72 4598,-5563.72 4598,-5615.72"/>
<text text-anchor="middle" x="4549" y="-5603.72" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="4549" y="-5592.72" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="4549" y="-5581.72" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="4549" y="-5570.72" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu9 -->
<g id="edge724" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu9</title>
<path fill="none" stroke="black" d="M4811.81,-5665.97C4755.93,-5655.29 4681.34,-5639.12 4607.99,-5615.82"/>
<polygon fill="black" stroke="black" points="4608.71,-5612.37 4598.12,-5612.64 4606.56,-5619.04 4608.71,-5612.37"/>
</g>
<!-- layer_12_qkv_gpu10 -->
<g id="node533" class="node">
<title>layer_12_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="4714,-5615.72 4616,-5615.72 4616,-5563.72 4714,-5563.72 4714,-5615.72"/>
<text text-anchor="middle" x="4665" y="-5603.72" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="4665" y="-5592.72" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="4665" y="-5581.72" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="4665" y="-5570.72" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu10 -->
<g id="edge725" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu10</title>
<path fill="none" stroke="black" d="M4816.55,-5651.62C4789.43,-5641.58 4758.86,-5630.01 4723.8,-5615.99"/>
<polygon fill="black" stroke="black" points="4724.88,-5612.65 4714.29,-5612.17 4722.27,-5619.14 4724.88,-5612.65"/>
</g>
<!-- layer_12_qkv_gpu11 -->
<g id="node534" class="node">
<title>layer_12_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="4830,-5615.72 4732,-5615.72 4732,-5563.72 4830,-5563.72 4830,-5615.72"/>
<text text-anchor="middle" x="4781" y="-5603.72" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="4781" y="-5592.72" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="4781" y="-5581.72" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="4781" y="-5570.72" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu11 -->
<g id="edge726" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu11</title>
<path fill="none" stroke="black" d="M4859.34,-5651.5C4847.18,-5642.07 4833.66,-5631.58 4821.32,-5622.01"/>
<polygon fill="black" stroke="black" points="4823.46,-5619.23 4813.41,-5615.87 4819.16,-5624.76 4823.46,-5619.23"/>
</g>
<!-- layer_12_qkv_gpu12 -->
<g id="node535" class="node">
<title>layer_12_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="4946,-5615.72 4848,-5615.72 4848,-5563.72 4946,-5563.72 4946,-5615.72"/>
<text text-anchor="middle" x="4897" y="-5603.72" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="4897" y="-5592.72" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="4897" y="-5581.72" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="4897" y="-5570.72" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu12 -->
<g id="edge727" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu12</title>
<path fill="none" stroke="black" d="M4897,-5651.25C4897,-5643.18 4897,-5634.35 4897,-5625.98"/>
<polygon fill="black" stroke="black" points="4900.5,-5625.73 4897,-5615.73 4893.5,-5625.73 4900.5,-5625.73"/>
</g>
<!-- layer_12_qkv_gpu13 -->
<g id="node536" class="node">
<title>layer_12_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="5062,-5615.72 4964,-5615.72 4964,-5563.72 5062,-5563.72 5062,-5615.72"/>
<text text-anchor="middle" x="5013" y="-5603.72" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="5013" y="-5592.72" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="5013" y="-5581.72" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="5013" y="-5570.72" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu13 -->
<g id="edge728" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu13</title>
<path fill="none" stroke="black" d="M4934.66,-5651.5C4946.82,-5642.07 4960.34,-5631.58 4972.68,-5622.01"/>
<polygon fill="black" stroke="black" points="4974.84,-5624.76 4980.59,-5615.87 4970.54,-5619.23 4974.84,-5624.76"/>
</g>
<!-- layer_12_qkv_gpu14 -->
<g id="node537" class="node">
<title>layer_12_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="5178,-5615.72 5080,-5615.72 5080,-5563.72 5178,-5563.72 5178,-5615.72"/>
<text text-anchor="middle" x="5129" y="-5603.72" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="5129" y="-5592.72" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5129" y="-5581.72" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="5129" y="-5570.72" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu14 -->
<g id="edge729" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu14</title>
<path fill="none" stroke="black" d="M4957.68,-5658.89C4988.94,-5647.45 5027.85,-5632.91 5070.31,-5615.94"/>
<polygon fill="black" stroke="black" points="5071.73,-5619.14 5079.71,-5612.17 5069.12,-5612.64 5071.73,-5619.14"/>
</g>
<!-- layer_12_qkv_gpu15 -->
<g id="node538" class="node">
<title>layer_12_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5294,-5615.72 5196,-5615.72 5196,-5563.72 5294,-5563.72 5294,-5615.72"/>
<text text-anchor="middle" x="5245" y="-5603.72" font-family="Arial" font-size="10.00">Layer 12 QKV Proj</text>
<text text-anchor="middle" x="5245" y="-5592.72" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="5245" y="-5581.72" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="5245" y="-5570.72" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_qkv_gpu15 -->
<g id="edge730" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_qkv_gpu15</title>
<path fill="none" stroke="black" d="M4964.18,-5669.35C5021.25,-5658.85 5105.28,-5641.43 5186.05,-5615.8"/>
<polygon fill="black" stroke="black" points="5187.43,-5619.03 5195.88,-5612.64 5185.29,-5612.37 5187.43,-5619.03"/>
</g>
<!-- layer_12_residual1 -->
<g id="node550" class="node">
<title>layer_12_residual1</title>
<polygon fill="lightyellow" stroke="black" points="5272.94,-5163.76 5150.55,-5163.76 5119.06,-5103.76 5241.45,-5103.76 5272.94,-5163.76"/>
<text text-anchor="middle" x="5196" y="-5136.76" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="5196" y="-5125.76" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_12_input_dist&#45;&gt;layer_12_residual1 -->
<g id="edge750" class="edge">
<title>layer_12_input_dist&#45;&gt;layer_12_residual1</title>
<path fill="none" stroke="black" d="M4967.91,-5675.36C5068.62,-5666.75 5247.06,-5647.5 5303,-5615.72 5361.43,-5582.53 5400,-5566.94 5400,-5499.73 5400,-5499.73 5400,-5499.73 5400,-5318.74 5400,-5248.8 5333.05,-5198.61 5275.86,-5168.5"/>
<polygon fill="black" stroke="black" points="5277.27,-5165.29 5266.78,-5163.84 5274.08,-5171.52 5277.27,-5165.29"/>
</g>
<!-- layer_12_allgather_qkv -->
<g id="node539" class="node">
<title>layer_12_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="4781" cy="-5498.73" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="4781" y="-5507.23" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="4781" y="-5496.23" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="4781" y="-5485.23" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_12_qkv_gpu8&#45;&gt;layer_12_allgather_qkv -->
<g id="edge731" class="edge">
<title>layer_12_qkv_gpu8&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M4482.12,-5566.8C4485.1,-5565.7 4488.08,-5564.67 4491,-5563.72 4567.19,-5539.14 4657.64,-5520.84 4717.02,-5510.24"/>
<polygon fill="black" stroke="black" points="4717.77,-5513.66 4727.01,-5508.48 4716.55,-5506.77 4717.77,-5513.66"/>
</g>
<!-- layer_12_qkv_gpu9&#45;&gt;layer_12_allgather_qkv -->
<g id="edge732" class="edge">
<title>layer_12_qkv_gpu9&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M4598.28,-5567.26C4601.23,-5566.05 4604.15,-5564.86 4607,-5563.72 4646.04,-5548.14 4690.54,-5531.8 4724.76,-5519.54"/>
<polygon fill="black" stroke="black" points="4726.34,-5522.69 4734.58,-5516.03 4723.98,-5516.1 4726.34,-5522.69"/>
</g>
<!-- layer_12_qkv_gpu10&#45;&gt;layer_12_allgather_qkv -->
<g id="edge733" class="edge">
<title>layer_12_qkv_gpu10&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M4697.62,-5563.7C4711.4,-5553.13 4727.56,-5540.73 4741.97,-5529.68"/>
<polygon fill="black" stroke="black" points="4744.41,-5532.21 4750.22,-5523.35 4740.15,-5526.66 4744.41,-5532.21"/>
</g>
<!-- layer_12_qkv_gpu11&#45;&gt;layer_12_allgather_qkv -->
<g id="edge734" class="edge">
<title>layer_12_qkv_gpu11&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M4781,-5563.46C4781,-5555.57 4781,-5546.68 4781,-5538.1"/>
<polygon fill="black" stroke="black" points="4784.5,-5537.87 4781,-5527.87 4777.5,-5537.87 4784.5,-5537.87"/>
</g>
<!-- layer_12_qkv_gpu12&#45;&gt;layer_12_allgather_qkv -->
<g id="edge735" class="edge">
<title>layer_12_qkv_gpu12&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M4864.38,-5563.7C4850.6,-5553.13 4834.44,-5540.73 4820.03,-5529.68"/>
<polygon fill="black" stroke="black" points="4821.85,-5526.66 4811.78,-5523.35 4817.59,-5532.21 4821.85,-5526.66"/>
</g>
<!-- layer_12_qkv_gpu13&#45;&gt;layer_12_allgather_qkv -->
<g id="edge736" class="edge">
<title>layer_12_qkv_gpu13&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M4963.72,-5567.26C4960.77,-5566.05 4957.85,-5564.86 4955,-5563.72 4915.96,-5548.14 4871.46,-5531.8 4837.24,-5519.54"/>
<polygon fill="black" stroke="black" points="4838.02,-5516.1 4827.42,-5516.03 4835.66,-5522.69 4838.02,-5516.1"/>
</g>
<!-- layer_12_qkv_gpu14&#45;&gt;layer_12_allgather_qkv -->
<g id="edge737" class="edge">
<title>layer_12_qkv_gpu14&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M5079.88,-5566.8C5076.9,-5565.7 5073.92,-5564.67 5071,-5563.72 4994.81,-5539.14 4904.36,-5520.84 4844.98,-5510.24"/>
<polygon fill="black" stroke="black" points="4845.45,-5506.77 4834.99,-5508.48 4844.23,-5513.66 4845.45,-5506.77"/>
</g>
<!-- layer_12_qkv_gpu15&#45;&gt;layer_12_allgather_qkv -->
<g id="edge738" class="edge">
<title>layer_12_qkv_gpu15&#45;&gt;layer_12_allgather_qkv</title>
<path fill="none" stroke="black" d="M5195.95,-5566.59C5192.95,-5565.54 5189.95,-5564.58 5187,-5563.72 5070.16,-5529.92 4928.91,-5512.76 4847.56,-5505.07"/>
<polygon fill="black" stroke="black" points="4847.74,-5501.57 4837.46,-5504.13 4847.09,-5508.54 4847.74,-5501.57"/>
</g>
<!-- layer_12_attention -->
<g id="node540" class="node">
<title>layer_12_attention</title>
<polygon fill="lightblue" stroke="black" points="4737,-5433.74 4669,-5433.74 4669,-5381.74 4737,-5381.74 4737,-5433.74"/>
<text text-anchor="middle" x="4703" y="-5421.74" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="4703" y="-5410.74" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="4703" y="-5399.74" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="4703" y="-5388.74" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_12_allgather_qkv&#45;&gt;layer_12_attention -->
<g id="edge739" class="edge">
<title>layer_12_allgather_qkv&#45;&gt;layer_12_attention</title>
<path fill="none" stroke="black" d="M4758.44,-5471.99C4750.13,-5462.51 4740.61,-5451.65 4731.82,-5441.62"/>
<polygon fill="black" stroke="black" points="4734.2,-5439.02 4724.97,-5433.81 4728.93,-5443.64 4734.2,-5439.02"/>
</g>
<!-- layer_12_attn_out_gpu15 -->
<g id="node548" class="node">
<title>layer_12_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4594.5,-5345.74 4501.5,-5345.74 4501.5,-5293.74 4594.5,-5293.74 4594.5,-5345.74"/>
<text text-anchor="middle" x="4548" y="-5333.74" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="4548" y="-5322.74" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="4548" y="-5311.74" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="4548" y="-5300.74" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attention&#45;&gt;layer_12_attn_out_gpu15 -->
<g id="edge740" class="edge">
<title>layer_12_attention&#45;&gt;layer_12_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M4668.98,-5387.87C4649.4,-5377 4624.35,-5363.1 4602.12,-5350.77"/>
<polygon fill="black" stroke="black" points="4603.56,-5347.57 4593.12,-5345.77 4600.16,-5353.69 4603.56,-5347.57"/>
</g>
<!-- layer_12_attn_out_gpu8 -->
<g id="node541" class="node">
<title>layer_12_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="4705.5,-5345.74 4612.5,-5345.74 4612.5,-5293.74 4705.5,-5293.74 4705.5,-5345.74"/>
<text text-anchor="middle" x="4659" y="-5333.74" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="4659" y="-5322.74" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="4659" y="-5311.74" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="4659" y="-5300.74" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_allreduce_attn -->
<g id="node549" class="node">
<title>layer_12_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="4992" cy="-5228.75" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="4992" y="-5237.25" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="4992" y="-5226.25" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="4992" y="-5215.25" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_12_attn_out_gpu8&#45;&gt;layer_12_allreduce_attn -->
<g id="edge741" class="edge">
<title>layer_12_attn_out_gpu8&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M4705.79,-5297.06C4708.88,-5295.88 4711.97,-5294.76 4715,-5293.74 4786.41,-5269.8 4871.1,-5251.67 4927.87,-5240.92"/>
<polygon fill="black" stroke="black" points="4928.6,-5244.35 4937.79,-5239.07 4927.32,-5237.47 4928.6,-5244.35"/>
</g>
<!-- layer_12_attn_out_gpu9 -->
<g id="node542" class="node">
<title>layer_12_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="4816.5,-5345.74 4723.5,-5345.74 4723.5,-5293.74 4816.5,-5293.74 4816.5,-5345.74"/>
<text text-anchor="middle" x="4770" y="-5333.74" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="4770" y="-5322.74" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="4770" y="-5311.74" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="4770" y="-5300.74" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attn_out_gpu9&#45;&gt;layer_12_allreduce_attn -->
<g id="edge742" class="edge">
<title>layer_12_attn_out_gpu9&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M4816.67,-5297.69C4819.82,-5296.33 4822.95,-5295.01 4826,-5293.74 4862.57,-5278.54 4904.16,-5262.51 4936.56,-5250.3"/>
<polygon fill="black" stroke="black" points="4938.17,-5253.43 4946.3,-5246.64 4935.71,-5246.88 4938.17,-5253.43"/>
</g>
<!-- layer_12_attn_out_gpu10 -->
<g id="node543" class="node">
<title>layer_12_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="4927.5,-5345.74 4834.5,-5345.74 4834.5,-5293.74 4927.5,-5293.74 4927.5,-5345.74"/>
<text text-anchor="middle" x="4881" y="-5333.74" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="4881" y="-5322.74" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="4881" y="-5311.74" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="4881" y="-5300.74" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attn_out_gpu10&#45;&gt;layer_12_allreduce_attn -->
<g id="edge743" class="edge">
<title>layer_12_attn_out_gpu10&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M4912.22,-5293.72C4925.29,-5283.23 4940.61,-5270.95 4954.31,-5259.96"/>
<polygon fill="black" stroke="black" points="4956.55,-5262.66 4962.17,-5253.67 4952.17,-5257.19 4956.55,-5262.66"/>
</g>
<!-- layer_12_attn_out_gpu11 -->
<g id="node544" class="node">
<title>layer_12_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="5038.5,-5345.74 4945.5,-5345.74 4945.5,-5293.74 5038.5,-5293.74 5038.5,-5345.74"/>
<text text-anchor="middle" x="4992" y="-5333.74" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="4992" y="-5322.74" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="4992" y="-5311.74" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="4992" y="-5300.74" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attn_out_gpu11&#45;&gt;layer_12_allreduce_attn -->
<g id="edge744" class="edge">
<title>layer_12_attn_out_gpu11&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M4992,-5293.48C4992,-5285.59 4992,-5276.7 4992,-5268.12"/>
<polygon fill="black" stroke="black" points="4995.5,-5267.89 4992,-5257.89 4988.5,-5267.89 4995.5,-5267.89"/>
</g>
<!-- layer_12_attn_out_gpu12 -->
<g id="node545" class="node">
<title>layer_12_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="5149.5,-5345.74 5056.5,-5345.74 5056.5,-5293.74 5149.5,-5293.74 5149.5,-5345.74"/>
<text text-anchor="middle" x="5103" y="-5333.74" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="5103" y="-5322.74" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="5103" y="-5311.74" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="5103" y="-5300.74" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attn_out_gpu12&#45;&gt;layer_12_allreduce_attn -->
<g id="edge745" class="edge">
<title>layer_12_attn_out_gpu12&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M5071.78,-5293.72C5058.71,-5283.23 5043.39,-5270.95 5029.69,-5259.96"/>
<polygon fill="black" stroke="black" points="5031.83,-5257.19 5021.83,-5253.67 5027.45,-5262.66 5031.83,-5257.19"/>
</g>
<!-- layer_12_attn_out_gpu13 -->
<g id="node546" class="node">
<title>layer_12_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="5260.5,-5345.74 5167.5,-5345.74 5167.5,-5293.74 5260.5,-5293.74 5260.5,-5345.74"/>
<text text-anchor="middle" x="5214" y="-5333.74" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="5214" y="-5322.74" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="5214" y="-5311.74" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="5214" y="-5300.74" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attn_out_gpu13&#45;&gt;layer_12_allreduce_attn -->
<g id="edge746" class="edge">
<title>layer_12_attn_out_gpu13&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M5167.28,-5297.27C5164.48,-5296.06 5161.71,-5294.87 5159,-5293.74 5122.11,-5278.31 5080.07,-5262.21 5047.4,-5250.02"/>
<polygon fill="black" stroke="black" points="5048.61,-5246.73 5038.02,-5246.53 5046.17,-5253.29 5048.61,-5246.73"/>
</g>
<!-- layer_12_attn_out_gpu14 -->
<g id="node547" class="node">
<title>layer_12_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="5371.5,-5345.74 5278.5,-5345.74 5278.5,-5293.74 5371.5,-5293.74 5371.5,-5345.74"/>
<text text-anchor="middle" x="5325" y="-5333.74" font-family="Arial" font-size="10.00">Layer 12 Attn Out</text>
<text text-anchor="middle" x="5325" y="-5322.74" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5325" y="-5311.74" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="5325" y="-5300.74" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_12_attn_out_gpu14&#45;&gt;layer_12_allreduce_attn -->
<g id="edge747" class="edge">
<title>layer_12_attn_out_gpu14&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M5278.45,-5296.81C5275.61,-5295.72 5272.78,-5294.68 5270,-5293.74 5198.42,-5269.51 5113.4,-5251.43 5056.4,-5240.78"/>
<polygon fill="black" stroke="black" points="5056.91,-5237.31 5046.44,-5238.94 5055.64,-5244.2 5056.91,-5237.31"/>
</g>
<!-- layer_12_attn_out_gpu15&#45;&gt;layer_12_allreduce_attn -->
<g id="edge748" class="edge">
<title>layer_12_attn_out_gpu15&#45;&gt;layer_12_allreduce_attn</title>
<path fill="none" stroke="black" d="M4594.72,-5296.84C4597.83,-5295.71 4600.94,-5294.66 4604,-5293.74 4713.82,-5260.77 4846.56,-5243.52 4924.86,-5235.55"/>
<polygon fill="black" stroke="black" points="4925.47,-5239.01 4935.07,-5234.53 4924.77,-5232.04 4925.47,-5239.01"/>
</g>
<!-- layer_12_allreduce_attn&#45;&gt;layer_12_residual1 -->
<g id="edge749" class="edge">
<title>layer_12_allreduce_attn&#45;&gt;layer_12_residual1</title>
<path fill="none" stroke="black" d="M5034.27,-5208.48C5064.12,-5194.88 5104.5,-5176.47 5137.45,-5161.45"/>
<polygon fill="black" stroke="black" points="5139.32,-5164.44 5146.97,-5157.11 5136.42,-5158.07 5139.32,-5164.44"/>
</g>
<!-- layer_12_ln1 -->
<g id="node551" class="node">
<title>layer_12_ln1</title>
<polygon fill="lightblue" stroke="black" points="4842.5,-5067.76 4769.5,-5067.76 4769.5,-5026.76 4842.5,-5026.76 4842.5,-5067.76"/>
<text text-anchor="middle" x="4806" y="-5055.76" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="4806" y="-5044.76" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="4806" y="-5033.76" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_12_residual1&#45;&gt;layer_12_ln1 -->
<g id="edge751" class="edge">
<title>layer_12_residual1&#45;&gt;layer_12_ln1</title>
<path fill="none" stroke="black" d="M5126.28,-5117.65C5047.19,-5100.52 4920.42,-5073.05 4852.52,-5058.34"/>
<polygon fill="black" stroke="black" points="4853.06,-5054.87 4842.54,-5056.18 4851.57,-5061.71 4853.06,-5054.87"/>
</g>
<!-- layer_12_residual2 -->
<g id="node571" class="node">
<title>layer_12_residual2</title>
<polygon fill="lightyellow" stroke="black" points="5184.94,-4554.79 5062.55,-4554.79 5031.06,-4494.79 5153.45,-4494.79 5184.94,-4554.79"/>
<text text-anchor="middle" x="5108" y="-4527.79" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="5108" y="-4516.79" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_12_residual1&#45;&gt;layer_12_residual2 -->
<g id="edge779" class="edge">
<title>layer_12_residual1&#45;&gt;layer_12_residual2</title>
<path fill="none" stroke="black" d="M5237.23,-5103.66C5274.32,-5073.75 5323,-5023.49 5323,-4965.76 5323,-4965.76 5323,-4965.76 5323,-4709.78 5323,-4638.4 5253.75,-4588.78 5193.85,-4559.21"/>
<polygon fill="black" stroke="black" points="5195.24,-4555.99 5184.71,-4554.82 5192.2,-4562.3 5195.24,-4555.99"/>
</g>
<!-- layer_12_mlp_fc1_gpu8 -->
<g id="node552" class="node">
<title>layer_12_mlp_fc1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="4387.5,-4990.76 4288.5,-4990.76 4288.5,-4938.76 4387.5,-4938.76 4387.5,-4990.76"/>
<text text-anchor="middle" x="4338" y="-4978.76" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="4338" y="-4967.76" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="4338" y="-4956.76" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="4338" y="-4945.76" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu8 -->
<g id="edge752" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu8</title>
<path fill="none" stroke="black" d="M4769.24,-5044.54C4698.44,-5040.54 4538.46,-5028.12 4397.26,-4990.49"/>
<polygon fill="black" stroke="black" points="4398.13,-4987.1 4387.56,-4987.85 4396.29,-4993.85 4398.13,-4987.1"/>
</g>
<!-- layer_12_mlp_fc1_gpu9 -->
<g id="node553" class="node">
<title>layer_12_mlp_fc1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="4504.5,-4990.76 4405.5,-4990.76 4405.5,-4938.76 4504.5,-4938.76 4504.5,-4990.76"/>
<text text-anchor="middle" x="4455" y="-4978.76" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="4455" y="-4967.76" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="4455" y="-4956.76" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="4455" y="-4945.76" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu9 -->
<g id="edge753" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu9</title>
<path fill="none" stroke="black" d="M4769.44,-5041.86C4715.35,-5034.8 4610.89,-5019.06 4514.24,-4990.55"/>
<polygon fill="black" stroke="black" points="4515.2,-4987.19 4504.62,-4987.66 4513.19,-4993.89 4515.2,-4987.19"/>
</g>
<!-- layer_12_mlp_fc1_gpu10 -->
<g id="node554" class="node">
<title>layer_12_mlp_fc1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="4621.5,-4990.76 4522.5,-4990.76 4522.5,-4938.76 4621.5,-4938.76 4621.5,-4990.76"/>
<text text-anchor="middle" x="4572" y="-4978.76" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="4572" y="-4967.76" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="4572" y="-4956.76" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="4572" y="-4945.76" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu10 -->
<g id="edge754" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu10</title>
<path fill="none" stroke="black" d="M4769.47,-5035.76C4735.85,-5025.86 4684.47,-5010.12 4631.35,-4990.76"/>
<polygon fill="black" stroke="black" points="4632.36,-4987.4 4621.76,-4987.23 4629.94,-4993.97 4632.36,-4987.4"/>
</g>
<!-- layer_12_mlp_fc1_gpu11 -->
<g id="node555" class="node">
<title>layer_12_mlp_fc1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="4738.5,-4990.76 4639.5,-4990.76 4639.5,-4938.76 4738.5,-4938.76 4738.5,-4990.76"/>
<text text-anchor="middle" x="4689" y="-4978.76" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="4689" y="-4967.76" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="4689" y="-4956.76" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="4689" y="-4945.76" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu11 -->
<g id="edge755" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu11</title>
<path fill="none" stroke="black" d="M4777.38,-5026.57C4764.37,-5017.62 4748.67,-5006.81 4734.13,-4996.81"/>
<polygon fill="black" stroke="black" points="4735.96,-4993.82 4725.74,-4991.04 4731.99,-4999.59 4735.96,-4993.82"/>
</g>
<!-- layer_12_mlp_fc1_gpu12 -->
<g id="node556" class="node">
<title>layer_12_mlp_fc1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="4855.5,-4990.76 4756.5,-4990.76 4756.5,-4938.76 4855.5,-4938.76 4855.5,-4990.76"/>
<text text-anchor="middle" x="4806" y="-4978.76" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="4806" y="-4967.76" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="4806" y="-4956.76" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="4806" y="-4945.76" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu12 -->
<g id="edge756" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu12</title>
<path fill="none" stroke="black" d="M4806,-5026.36C4806,-5018.75 4806,-5009.82 4806,-5001.18"/>
<polygon fill="black" stroke="black" points="4809.5,-5000.91 4806,-4990.91 4802.5,-5000.91 4809.5,-5000.91"/>
</g>
<!-- layer_12_mlp_fc1_gpu13 -->
<g id="node557" class="node">
<title>layer_12_mlp_fc1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="4972.5,-4990.76 4873.5,-4990.76 4873.5,-4938.76 4972.5,-4938.76 4972.5,-4990.76"/>
<text text-anchor="middle" x="4923" y="-4978.76" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="4923" y="-4967.76" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="4923" y="-4956.76" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="4923" y="-4945.76" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu13 -->
<g id="edge757" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu13</title>
<path fill="none" stroke="black" d="M4834.62,-5026.57C4847.63,-5017.62 4863.33,-5006.81 4877.87,-4996.81"/>
<polygon fill="black" stroke="black" points="4880.01,-4999.59 4886.26,-4991.04 4876.04,-4993.82 4880.01,-4999.59"/>
</g>
<!-- layer_12_mlp_fc1_gpu14 -->
<g id="node558" class="node">
<title>layer_12_mlp_fc1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="5089.5,-4990.76 4990.5,-4990.76 4990.5,-4938.76 5089.5,-4938.76 5089.5,-4990.76"/>
<text text-anchor="middle" x="5040" y="-4978.76" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="5040" y="-4967.76" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5040" y="-4956.76" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="5040" y="-4945.76" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu14 -->
<g id="edge758" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu14</title>
<path fill="none" stroke="black" d="M4842.77,-5035.85C4876.6,-5026.01 4928.29,-5010.32 4980.96,-4991.02"/>
<polygon fill="black" stroke="black" points="4982.3,-4994.26 4990.46,-4987.5 4979.87,-4987.69 4982.3,-4994.26"/>
</g>
<!-- layer_12_mlp_fc1_gpu15 -->
<g id="node559" class="node">
<title>layer_12_mlp_fc1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5206.5,-4990.76 5107.5,-4990.76 5107.5,-4938.76 5206.5,-4938.76 5206.5,-4990.76"/>
<text text-anchor="middle" x="5157" y="-4978.76" font-family="Arial" font-size="10.00">Layer 12 MLP FC1</text>
<text text-anchor="middle" x="5157" y="-4967.76" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="5157" y="-4956.76" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="5157" y="-4945.76" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu15 -->
<g id="edge759" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_mlp_fc1_gpu15</title>
<path fill="none" stroke="black" d="M4842.71,-5041.94C4896.96,-5035 5001.65,-5019.42 5097.44,-4990.99"/>
<polygon fill="black" stroke="black" points="5098.72,-4994.26 5107.27,-4988.02 5096.69,-4987.56 5098.72,-4994.26"/>
</g>
<!-- layer_12_allgather_mlp -->
<g id="node560" class="node">
<title>layer_12_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="4689" cy="-4873.77" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="4689" y="-4882.27" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="4689" y="-4871.27" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="4689" y="-4860.27" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_12_mlp_fc1_gpu8&#45;&gt;layer_12_allgather_mlp -->
<g id="edge760" class="edge">
<title>layer_12_mlp_fc1_gpu8&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M4387.65,-4941.96C4390.79,-4940.82 4393.93,-4939.74 4397,-4938.76 4474.13,-4914.2 4565.67,-4895.81 4625.43,-4885.19"/>
<polygon fill="black" stroke="black" points="4626.23,-4888.61 4635.47,-4883.43 4625.02,-4881.71 4626.23,-4888.61"/>
</g>
<!-- layer_12_mlp_fc1_gpu9&#45;&gt;layer_12_allgather_mlp -->
<g id="edge761" class="edge">
<title>layer_12_mlp_fc1_gpu9&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M4504.5,-4942.57C4507.71,-4941.26 4510.9,-4939.98 4514,-4938.76 4553.75,-4923.08 4599.07,-4906.55 4633.62,-4894.21"/>
<polygon fill="black" stroke="black" points="4634.83,-4897.5 4643.07,-4890.85 4632.48,-4890.91 4634.83,-4897.5"/>
</g>
<!-- layer_12_mlp_fc1_gpu10&#45;&gt;layer_12_allgather_mlp -->
<g id="edge762" class="edge">
<title>layer_12_mlp_fc1_gpu10&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M4604.9,-4938.73C4618.8,-4928.16 4635.1,-4915.76 4649.63,-4904.71"/>
<polygon fill="black" stroke="black" points="4652.11,-4907.22 4657.95,-4898.38 4647.87,-4901.65 4652.11,-4907.22"/>
</g>
<!-- layer_12_mlp_fc1_gpu11&#45;&gt;layer_12_allgather_mlp -->
<g id="edge763" class="edge">
<title>layer_12_mlp_fc1_gpu11&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M4689,-4938.5C4689,-4930.6 4689,-4921.71 4689,-4913.13"/>
<polygon fill="black" stroke="black" points="4692.5,-4912.91 4689,-4902.91 4685.5,-4912.91 4692.5,-4912.91"/>
</g>
<!-- layer_12_mlp_fc1_gpu12&#45;&gt;layer_12_allgather_mlp -->
<g id="edge764" class="edge">
<title>layer_12_mlp_fc1_gpu12&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M4773.1,-4938.73C4759.2,-4928.16 4742.9,-4915.76 4728.37,-4904.71"/>
<polygon fill="black" stroke="black" points="4730.13,-4901.65 4720.05,-4898.38 4725.89,-4907.22 4730.13,-4901.65"/>
</g>
<!-- layer_12_mlp_fc1_gpu13&#45;&gt;layer_12_allgather_mlp -->
<g id="edge765" class="edge">
<title>layer_12_mlp_fc1_gpu13&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M4873.41,-4942.16C4870.57,-4940.99 4867.75,-4939.85 4865,-4938.76 4825.09,-4922.92 4779.51,-4906.39 4744.74,-4894.1"/>
<polygon fill="black" stroke="black" points="4745.82,-4890.77 4735.23,-4890.75 4743.5,-4897.37 4745.82,-4890.77"/>
</g>
<!-- layer_12_mlp_fc1_gpu14&#45;&gt;layer_12_allgather_mlp -->
<g id="edge766" class="edge">
<title>layer_12_mlp_fc1_gpu14&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M4990.25,-4941.59C4987.48,-4940.58 4984.71,-4939.63 4982,-4938.76 4904.57,-4913.87 4812.53,-4895.53 4752.55,-4885.01"/>
<polygon fill="black" stroke="black" points="4752.92,-4881.52 4742.47,-4883.26 4751.73,-4888.42 4752.92,-4881.52"/>
</g>
<!-- layer_12_mlp_fc1_gpu15&#45;&gt;layer_12_allgather_mlp -->
<g id="edge767" class="edge">
<title>layer_12_mlp_fc1_gpu15&#45;&gt;layer_12_allgather_mlp</title>
<path fill="none" stroke="black" d="M5107.31,-4941.39C5104.52,-4940.44 5101.74,-4939.55 5099,-4938.76 4980.35,-4904.52 4836.76,-4887.44 4754.84,-4879.9"/>
<polygon fill="black" stroke="black" points="4754.94,-4876.39 4744.67,-4878.98 4754.32,-4883.36 4754.94,-4876.39"/>
</g>
<!-- layer_12_gelu -->
<g id="node561" class="node">
<title>layer_12_gelu</title>
<polygon fill="lightblue" stroke="black" points="4558.5,-4808.78 4469.5,-4808.78 4469.5,-4772.78 4558.5,-4772.78 4558.5,-4808.78"/>
<text text-anchor="middle" x="4514" y="-4793.78" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="4514" y="-4782.78" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_12_allgather_mlp&#45;&gt;layer_12_gelu -->
<g id="edge768" class="edge">
<title>layer_12_allgather_mlp&#45;&gt;layer_12_gelu</title>
<path fill="none" stroke="black" d="M4647.97,-4853.78C4621.67,-4841.61 4587.49,-4825.79 4560.23,-4813.17"/>
<polygon fill="black" stroke="black" points="4561.45,-4809.88 4550.9,-4808.85 4558.51,-4816.23 4561.45,-4809.88"/>
</g>
<!-- layer_12_mlp_fc2_gpu15 -->
<g id="node569" class="node">
<title>layer_12_mlp_fc2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4475.5,-4736.78 4376.5,-4736.78 4376.5,-4684.78 4475.5,-4684.78 4475.5,-4736.78"/>
<text text-anchor="middle" x="4426" y="-4724.78" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="4426" y="-4713.78" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="4426" y="-4702.78" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="4426" y="-4691.78" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu15 -->
<g id="edge769" class="edge">
<title>layer_12_gelu&#45;&gt;layer_12_mlp_fc2_gpu15</title>
<path fill="none" stroke="black" d="M4494.47,-4772.47C4484.93,-4764 4473.13,-4753.55 4462.03,-4743.71"/>
<polygon fill="black" stroke="black" points="4464.3,-4741.05 4454.5,-4737.03 4459.66,-4746.29 4464.3,-4741.05"/>
</g>
<!-- layer_12_mlp_fc2_gpu8 -->
<g id="node562" class="node">
<title>layer_12_mlp_fc2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="4592.5,-4736.78 4493.5,-4736.78 4493.5,-4684.78 4592.5,-4684.78 4592.5,-4736.78"/>
<text text-anchor="middle" x="4543" y="-4724.78" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="4543" y="-4713.78" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="4543" y="-4702.78" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="4543" y="-4691.78" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_allreduce_mlp -->
<g id="node570" class="node">
<title>layer_12_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="4894" cy="-4619.78" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="4894" y="-4628.28" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="4894" y="-4617.28" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="4894" y="-4606.28" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_12_mlp_fc2_gpu8&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge770" class="edge">
<title>layer_12_mlp_fc2_gpu8&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4592.65,-4687.97C4595.79,-4686.83 4598.93,-4685.75 4602,-4684.78 4677.85,-4660.63 4767.62,-4642.44 4827.41,-4631.75"/>
<polygon fill="black" stroke="black" points="4828.24,-4635.15 4837.48,-4629.97 4827.03,-4628.26 4828.24,-4635.15"/>
</g>
<!-- layer_12_mlp_fc2_gpu9 -->
<g id="node563" class="node">
<title>layer_12_mlp_fc2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="4709.5,-4736.78 4610.5,-4736.78 4610.5,-4684.78 4709.5,-4684.78 4709.5,-4736.78"/>
<text text-anchor="middle" x="4660" y="-4724.78" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="4660" y="-4713.78" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="4660" y="-4702.78" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="4660" y="-4691.78" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_mlp_fc2_gpu9&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge771" class="edge">
<title>layer_12_mlp_fc2_gpu9&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4709.5,-4688.59C4712.71,-4687.28 4715.9,-4686 4719,-4684.78 4757.89,-4669.44 4802.12,-4653.27 4836.38,-4641.03"/>
<polygon fill="black" stroke="black" points="4837.98,-4644.18 4846.22,-4637.53 4835.63,-4637.59 4837.98,-4644.18"/>
</g>
<!-- layer_12_mlp_fc2_gpu10 -->
<g id="node564" class="node">
<title>layer_12_mlp_fc2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="4826.5,-4736.78 4727.5,-4736.78 4727.5,-4684.78 4826.5,-4684.78 4826.5,-4736.78"/>
<text text-anchor="middle" x="4777" y="-4724.78" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="4777" y="-4713.78" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="4777" y="-4702.78" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="4777" y="-4691.78" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_mlp_fc2_gpu10&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge772" class="edge">
<title>layer_12_mlp_fc2_gpu10&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4809.9,-4684.75C4823.69,-4674.26 4839.84,-4661.98 4854.28,-4651"/>
<polygon fill="black" stroke="black" points="4856.71,-4653.54 4862.55,-4644.7 4852.47,-4647.97 4856.71,-4653.54"/>
</g>
<!-- layer_12_mlp_fc2_gpu11 -->
<g id="node565" class="node">
<title>layer_12_mlp_fc2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="4943.5,-4736.78 4844.5,-4736.78 4844.5,-4684.78 4943.5,-4684.78 4943.5,-4736.78"/>
<text text-anchor="middle" x="4894" y="-4724.78" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="4894" y="-4713.78" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="4894" y="-4702.78" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="4894" y="-4691.78" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_mlp_fc2_gpu11&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge773" class="edge">
<title>layer_12_mlp_fc2_gpu11&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4894,-4684.51C4894,-4676.62 4894,-4667.73 4894,-4659.15"/>
<polygon fill="black" stroke="black" points="4897.5,-4658.93 4894,-4648.93 4890.5,-4658.93 4897.5,-4658.93"/>
</g>
<!-- layer_12_mlp_fc2_gpu12 -->
<g id="node566" class="node">
<title>layer_12_mlp_fc2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="5060.5,-4736.78 4961.5,-4736.78 4961.5,-4684.78 5060.5,-4684.78 5060.5,-4736.78"/>
<text text-anchor="middle" x="5011" y="-4724.78" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="5011" y="-4713.78" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="5011" y="-4702.78" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="5011" y="-4691.78" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_mlp_fc2_gpu12&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge774" class="edge">
<title>layer_12_mlp_fc2_gpu12&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4978.1,-4684.75C4964.31,-4674.26 4948.16,-4661.98 4933.72,-4651"/>
<polygon fill="black" stroke="black" points="4935.53,-4647.97 4925.45,-4644.7 4931.29,-4653.54 4935.53,-4647.97"/>
</g>
<!-- layer_12_mlp_fc2_gpu13 -->
<g id="node567" class="node">
<title>layer_12_mlp_fc2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="5177.5,-4736.78 5078.5,-4736.78 5078.5,-4684.78 5177.5,-4684.78 5177.5,-4736.78"/>
<text text-anchor="middle" x="5128" y="-4724.78" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="5128" y="-4713.78" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="5128" y="-4702.78" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="5128" y="-4691.78" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_mlp_fc2_gpu13&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge775" class="edge">
<title>layer_12_mlp_fc2_gpu13&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5078.41,-4688.17C5075.57,-4687.01 5072.75,-4685.87 5070,-4684.78 5030.78,-4669.21 4986.08,-4652.98 4951.55,-4640.76"/>
<polygon fill="black" stroke="black" points="4952.69,-4637.45 4942.09,-4637.42 4950.36,-4644.05 4952.69,-4637.45"/>
</g>
<!-- layer_12_mlp_fc2_gpu14 -->
<g id="node568" class="node">
<title>layer_12_mlp_fc2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="5294.5,-4736.78 5195.5,-4736.78 5195.5,-4684.78 5294.5,-4684.78 5294.5,-4736.78"/>
<text text-anchor="middle" x="5245" y="-4724.78" font-family="Arial" font-size="10.00">Layer 12 MLP FC2</text>
<text text-anchor="middle" x="5245" y="-4713.78" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5245" y="-4702.78" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="5245" y="-4691.78" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_12_mlp_fc2_gpu14&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge776" class="edge">
<title>layer_12_mlp_fc2_gpu14&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5195.25,-4687.61C5192.48,-4686.6 5189.71,-4685.65 5187,-4684.78 5110.85,-4660.3 5020.59,-4642.16 4960.57,-4631.56"/>
<polygon fill="black" stroke="black" points="4960.92,-4628.07 4950.47,-4629.8 4959.72,-4634.96 4960.92,-4628.07"/>
</g>
<!-- layer_12_mlp_fc2_gpu15&#45;&gt;layer_12_allreduce_mlp -->
<g id="edge777" class="edge">
<title>layer_12_mlp_fc2_gpu15&#45;&gt;layer_12_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4475.58,-4687.75C4478.74,-4686.67 4481.9,-4685.66 4485,-4684.78 4601.77,-4651.45 4742.55,-4634.24 4824.8,-4626.39"/>
<polygon fill="black" stroke="black" points="4825.14,-4629.87 4834.77,-4625.46 4824.49,-4622.9 4825.14,-4629.87"/>
</g>
<!-- layer_12_allreduce_mlp&#45;&gt;layer_12_residual2 -->
<g id="edge778" class="edge">
<title>layer_12_allreduce_mlp&#45;&gt;layer_12_residual2</title>
<path fill="none" stroke="black" d="M4937.82,-4599.74C4969.93,-4585.79 5013.85,-4566.7 5049.03,-4551.42"/>
<polygon fill="black" stroke="black" points="5050.47,-4554.61 5058.24,-4547.41 5047.68,-4548.19 5050.47,-4554.61"/>
</g>
<!-- layer_12_ln2 -->
<g id="node572" class="node">
<title>layer_12_ln2</title>
<polygon fill="lightblue" stroke="black" points="5144.5,-4458.79 5071.5,-4458.79 5071.5,-4417.79 5144.5,-4417.79 5144.5,-4458.79"/>
<text text-anchor="middle" x="5108" y="-4446.79" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="5108" y="-4435.79" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="5108" y="-4424.79" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_12_residual2&#45;&gt;layer_12_ln2 -->
<g id="edge780" class="edge">
<title>layer_12_residual2&#45;&gt;layer_12_ln2</title>
<path fill="none" stroke="black" d="M5108,-4494.71C5108,-4486.39 5108,-4477.31 5108,-4468.95"/>
<polygon fill="black" stroke="black" points="5111.5,-4468.86 5108,-4458.86 5104.5,-4468.86 5111.5,-4468.86"/>
</g>
<!-- layer_12_output_dist -->
<g id="node573" class="node">
<title>layer_12_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="5209.7,-4381.79 5047.92,-4381.79 5006.3,-4321.79 5168.08,-4321.79 5209.7,-4381.79"/>
<text text-anchor="middle" x="5108" y="-4354.79" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="5108" y="-4343.79" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_12_ln2&#45;&gt;layer_12_output_dist -->
<g id="edge781" class="edge">
<title>layer_12_ln2&#45;&gt;layer_12_output_dist</title>
<path fill="none" stroke="black" d="M5108,-4417.69C5108,-4410.06 5108,-4401.01 5108,-4392.14"/>
<polygon fill="black" stroke="black" points="5111.5,-4391.9 5108,-4381.9 5104.5,-4391.9 5111.5,-4391.9"/>
</g>
<!-- layer_13_input_dist -->
<g id="node574" class="node">
<title>layer_13_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="5202.19,-4285.79 5052.36,-4285.79 5013.81,-4225.79 5163.64,-4225.79 5202.19,-4285.79"/>
<text text-anchor="middle" x="5108" y="-4258.79" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="5108" y="-4247.79" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_12_output_dist&#45;&gt;layer_13_input_dist -->
<g id="edge782" class="edge">
<title>layer_12_output_dist&#45;&gt;layer_13_input_dist</title>
<path fill="none" stroke="black" d="M5108,-4321.57C5108,-4313.52 5108,-4304.66 5108,-4296.14"/>
<polygon fill="black" stroke="black" points="5111.5,-4296 5108,-4286 5104.5,-4296 5111.5,-4296"/>
</g>
<!-- layer_13_qkv_gpu8 -->
<g id="node575" class="node">
<title>layer_13_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="4693,-4189.79 4595,-4189.79 4595,-4137.79 4693,-4137.79 4693,-4189.79"/>
<text text-anchor="middle" x="4644" y="-4177.79" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="4644" y="-4166.79" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="4644" y="-4155.79" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="4644" y="-4144.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu8 -->
<g id="edge783" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu8</title>
<path fill="none" stroke="black" d="M5027.74,-4247.87C4947.17,-4239.6 4819.73,-4222.87 4702.88,-4189.75"/>
<polygon fill="black" stroke="black" points="4703.63,-4186.33 4693.05,-4186.92 4701.69,-4193.05 4703.63,-4186.33"/>
</g>
<!-- layer_13_qkv_gpu9 -->
<g id="node576" class="node">
<title>layer_13_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="4809,-4189.79 4711,-4189.79 4711,-4137.79 4809,-4137.79 4809,-4189.79"/>
<text text-anchor="middle" x="4760" y="-4177.79" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="4760" y="-4166.79" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="4760" y="-4155.79" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="4760" y="-4144.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu9 -->
<g id="edge784" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu9</title>
<path fill="none" stroke="black" d="M5022.81,-4240.04C4966.93,-4229.36 4892.34,-4213.19 4818.99,-4189.89"/>
<polygon fill="black" stroke="black" points="4819.71,-4186.44 4809.12,-4186.71 4817.56,-4193.11 4819.71,-4186.44"/>
</g>
<!-- layer_13_qkv_gpu10 -->
<g id="node577" class="node">
<title>layer_13_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="4925,-4189.79 4827,-4189.79 4827,-4137.79 4925,-4137.79 4925,-4189.79"/>
<text text-anchor="middle" x="4876" y="-4177.79" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="4876" y="-4166.79" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="4876" y="-4155.79" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="4876" y="-4144.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu10 -->
<g id="edge785" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu10</title>
<path fill="none" stroke="black" d="M5027.55,-4225.68C5000.43,-4215.64 4969.86,-4204.08 4934.8,-4190.06"/>
<polygon fill="black" stroke="black" points="4935.88,-4186.72 4925.29,-4186.24 4933.27,-4193.21 4935.88,-4186.72"/>
</g>
<!-- layer_13_qkv_gpu11 -->
<g id="node578" class="node">
<title>layer_13_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="5041,-4189.79 4943,-4189.79 4943,-4137.79 5041,-4137.79 5041,-4189.79"/>
<text text-anchor="middle" x="4992" y="-4177.79" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="4992" y="-4166.79" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="4992" y="-4155.79" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="4992" y="-4144.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu11 -->
<g id="edge786" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu11</title>
<path fill="none" stroke="black" d="M5070.34,-4225.57C5058.18,-4216.14 5044.66,-4205.65 5032.32,-4196.08"/>
<polygon fill="black" stroke="black" points="5034.46,-4193.3 5024.41,-4189.94 5030.16,-4198.83 5034.46,-4193.3"/>
</g>
<!-- layer_13_qkv_gpu12 -->
<g id="node579" class="node">
<title>layer_13_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="5157,-4189.79 5059,-4189.79 5059,-4137.79 5157,-4137.79 5157,-4189.79"/>
<text text-anchor="middle" x="5108" y="-4177.79" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="5108" y="-4166.79" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="5108" y="-4155.79" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="5108" y="-4144.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu12 -->
<g id="edge787" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu12</title>
<path fill="none" stroke="black" d="M5108,-4225.32C5108,-4217.25 5108,-4208.41 5108,-4200.05"/>
<polygon fill="black" stroke="black" points="5111.5,-4199.8 5108,-4189.8 5104.5,-4199.8 5111.5,-4199.8"/>
</g>
<!-- layer_13_qkv_gpu13 -->
<g id="node580" class="node">
<title>layer_13_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="5273,-4189.79 5175,-4189.79 5175,-4137.79 5273,-4137.79 5273,-4189.79"/>
<text text-anchor="middle" x="5224" y="-4177.79" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="5224" y="-4166.79" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="5224" y="-4155.79" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="5224" y="-4144.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu13 -->
<g id="edge788" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu13</title>
<path fill="none" stroke="black" d="M5145.66,-4225.57C5157.82,-4216.14 5171.34,-4205.65 5183.68,-4196.08"/>
<polygon fill="black" stroke="black" points="5185.84,-4198.83 5191.59,-4189.94 5181.54,-4193.3 5185.84,-4198.83"/>
</g>
<!-- layer_13_qkv_gpu14 -->
<g id="node581" class="node">
<title>layer_13_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="5389,-4189.79 5291,-4189.79 5291,-4137.79 5389,-4137.79 5389,-4189.79"/>
<text text-anchor="middle" x="5340" y="-4177.79" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="5340" y="-4166.79" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5340" y="-4155.79" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="5340" y="-4144.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu14 -->
<g id="edge789" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu14</title>
<path fill="none" stroke="black" d="M5168.68,-4232.96C5199.94,-4221.52 5238.85,-4206.98 5281.31,-4190.01"/>
<polygon fill="black" stroke="black" points="5282.73,-4193.21 5290.71,-4186.24 5280.12,-4186.71 5282.73,-4193.21"/>
</g>
<!-- layer_13_qkv_gpu15 -->
<g id="node582" class="node">
<title>layer_13_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5505,-4189.79 5407,-4189.79 5407,-4137.79 5505,-4137.79 5505,-4189.79"/>
<text text-anchor="middle" x="5456" y="-4177.79" font-family="Arial" font-size="10.00">Layer 13 QKV Proj</text>
<text text-anchor="middle" x="5456" y="-4166.79" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="5456" y="-4155.79" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="5456" y="-4144.79" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_qkv_gpu15 -->
<g id="edge790" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_qkv_gpu15</title>
<path fill="none" stroke="black" d="M5175.18,-4243.42C5232.25,-4232.92 5316.28,-4215.5 5397.05,-4189.87"/>
<polygon fill="black" stroke="black" points="5398.43,-4193.1 5406.88,-4186.71 5396.29,-4186.44 5398.43,-4193.1"/>
</g>
<!-- layer_13_residual1 -->
<g id="node594" class="node">
<title>layer_13_residual1</title>
<polygon fill="lightyellow" stroke="black" points="5483.94,-3737.83 5361.55,-3737.83 5330.06,-3677.83 5452.45,-3677.83 5483.94,-3737.83"/>
<text text-anchor="middle" x="5407" y="-3710.83" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="5407" y="-3699.83" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_13_input_dist&#45;&gt;layer_13_residual1 -->
<g id="edge810" class="edge">
<title>layer_13_input_dist&#45;&gt;layer_13_residual1</title>
<path fill="none" stroke="black" d="M5178.91,-4249.43C5279.62,-4240.82 5458.06,-4221.57 5514,-4189.79 5572.43,-4156.6 5611,-4141 5611,-4073.8 5611,-4073.8 5611,-4073.8 5611,-3892.81 5611,-3822.87 5544.05,-3772.68 5486.86,-3742.57"/>
<polygon fill="black" stroke="black" points="5488.27,-3739.36 5477.78,-3737.91 5485.08,-3745.59 5488.27,-3739.36"/>
</g>
<!-- layer_13_allgather_qkv -->
<g id="node583" class="node">
<title>layer_13_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="4992" cy="-4072.8" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="4992" y="-4081.3" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="4992" y="-4070.3" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="4992" y="-4059.3" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_13_qkv_gpu8&#45;&gt;layer_13_allgather_qkv -->
<g id="edge791" class="edge">
<title>layer_13_qkv_gpu8&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M4693.12,-4140.87C4696.1,-4139.77 4699.08,-4138.74 4702,-4137.79 4778.19,-4113.21 4868.64,-4094.91 4928.02,-4084.31"/>
<polygon fill="black" stroke="black" points="4928.77,-4087.73 4938.01,-4082.55 4927.55,-4080.84 4928.77,-4087.73"/>
</g>
<!-- layer_13_qkv_gpu9&#45;&gt;layer_13_allgather_qkv -->
<g id="edge792" class="edge">
<title>layer_13_qkv_gpu9&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M4809.28,-4141.33C4812.23,-4140.12 4815.15,-4138.93 4818,-4137.79 4857.04,-4122.21 4901.54,-4105.87 4935.76,-4093.61"/>
<polygon fill="black" stroke="black" points="4937.34,-4096.76 4945.58,-4090.1 4934.98,-4090.17 4937.34,-4096.76"/>
</g>
<!-- layer_13_qkv_gpu10&#45;&gt;layer_13_allgather_qkv -->
<g id="edge793" class="edge">
<title>layer_13_qkv_gpu10&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M4908.62,-4137.77C4922.4,-4127.2 4938.56,-4114.8 4952.97,-4103.74"/>
<polygon fill="black" stroke="black" points="4955.41,-4106.28 4961.22,-4097.42 4951.15,-4100.73 4955.41,-4106.28"/>
</g>
<!-- layer_13_qkv_gpu11&#45;&gt;layer_13_allgather_qkv -->
<g id="edge794" class="edge">
<title>layer_13_qkv_gpu11&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M4992,-4137.53C4992,-4129.64 4992,-4120.75 4992,-4112.17"/>
<polygon fill="black" stroke="black" points="4995.5,-4111.94 4992,-4101.94 4988.5,-4111.94 4995.5,-4111.94"/>
</g>
<!-- layer_13_qkv_gpu12&#45;&gt;layer_13_allgather_qkv -->
<g id="edge795" class="edge">
<title>layer_13_qkv_gpu12&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M5075.38,-4137.77C5061.6,-4127.2 5045.44,-4114.8 5031.03,-4103.74"/>
<polygon fill="black" stroke="black" points="5032.85,-4100.73 5022.78,-4097.42 5028.59,-4106.28 5032.85,-4100.73"/>
</g>
<!-- layer_13_qkv_gpu13&#45;&gt;layer_13_allgather_qkv -->
<g id="edge796" class="edge">
<title>layer_13_qkv_gpu13&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M5174.72,-4141.33C5171.77,-4140.12 5168.85,-4138.93 5166,-4137.79 5126.96,-4122.21 5082.46,-4105.87 5048.24,-4093.61"/>
<polygon fill="black" stroke="black" points="5049.02,-4090.17 5038.42,-4090.1 5046.66,-4096.76 5049.02,-4090.17"/>
</g>
<!-- layer_13_qkv_gpu14&#45;&gt;layer_13_allgather_qkv -->
<g id="edge797" class="edge">
<title>layer_13_qkv_gpu14&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M5290.88,-4140.87C5287.9,-4139.77 5284.92,-4138.74 5282,-4137.79 5205.81,-4113.21 5115.36,-4094.91 5055.98,-4084.31"/>
<polygon fill="black" stroke="black" points="5056.45,-4080.84 5045.99,-4082.55 5055.23,-4087.73 5056.45,-4080.84"/>
</g>
<!-- layer_13_qkv_gpu15&#45;&gt;layer_13_allgather_qkv -->
<g id="edge798" class="edge">
<title>layer_13_qkv_gpu15&#45;&gt;layer_13_allgather_qkv</title>
<path fill="none" stroke="black" d="M5406.95,-4140.66C5403.95,-4139.61 5400.95,-4138.65 5398,-4137.79 5281.16,-4103.99 5139.91,-4086.83 5058.56,-4079.14"/>
<polygon fill="black" stroke="black" points="5058.74,-4075.64 5048.46,-4078.2 5058.09,-4082.61 5058.74,-4075.64"/>
</g>
<!-- layer_13_attention -->
<g id="node584" class="node">
<title>layer_13_attention</title>
<polygon fill="lightblue" stroke="black" points="4948,-4007.81 4880,-4007.81 4880,-3955.81 4948,-3955.81 4948,-4007.81"/>
<text text-anchor="middle" x="4914" y="-3995.81" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="4914" y="-3984.81" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="4914" y="-3973.81" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="4914" y="-3962.81" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_13_allgather_qkv&#45;&gt;layer_13_attention -->
<g id="edge799" class="edge">
<title>layer_13_allgather_qkv&#45;&gt;layer_13_attention</title>
<path fill="none" stroke="black" d="M4969.44,-4046.06C4961.13,-4036.58 4951.61,-4025.72 4942.82,-4015.69"/>
<polygon fill="black" stroke="black" points="4945.2,-4013.09 4935.97,-4007.88 4939.93,-4017.71 4945.2,-4013.09"/>
</g>
<!-- layer_13_attn_out_gpu15 -->
<g id="node592" class="node">
<title>layer_13_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4805.5,-3919.81 4712.5,-3919.81 4712.5,-3867.81 4805.5,-3867.81 4805.5,-3919.81"/>
<text text-anchor="middle" x="4759" y="-3907.81" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="4759" y="-3896.81" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="4759" y="-3885.81" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="4759" y="-3874.81" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attention&#45;&gt;layer_13_attn_out_gpu15 -->
<g id="edge800" class="edge">
<title>layer_13_attention&#45;&gt;layer_13_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M4879.98,-3961.94C4860.4,-3951.07 4835.35,-3937.17 4813.12,-3924.84"/>
<polygon fill="black" stroke="black" points="4814.56,-3921.63 4804.12,-3919.84 4811.16,-3927.76 4814.56,-3921.63"/>
</g>
<!-- layer_13_attn_out_gpu8 -->
<g id="node585" class="node">
<title>layer_13_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="4916.5,-3919.81 4823.5,-3919.81 4823.5,-3867.81 4916.5,-3867.81 4916.5,-3919.81"/>
<text text-anchor="middle" x="4870" y="-3907.81" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="4870" y="-3896.81" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="4870" y="-3885.81" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="4870" y="-3874.81" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_allreduce_attn -->
<g id="node593" class="node">
<title>layer_13_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="5203" cy="-3802.82" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="5203" y="-3811.32" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="5203" y="-3800.32" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="5203" y="-3789.32" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_13_attn_out_gpu8&#45;&gt;layer_13_allreduce_attn -->
<g id="edge801" class="edge">
<title>layer_13_attn_out_gpu8&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M4916.79,-3871.13C4919.88,-3869.95 4922.97,-3868.83 4926,-3867.81 4997.41,-3843.87 5082.1,-3825.74 5138.87,-3814.99"/>
<polygon fill="black" stroke="black" points="5139.6,-3818.41 5148.79,-3813.13 5138.32,-3811.53 5139.6,-3818.41"/>
</g>
<!-- layer_13_attn_out_gpu9 -->
<g id="node586" class="node">
<title>layer_13_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="5027.5,-3919.81 4934.5,-3919.81 4934.5,-3867.81 5027.5,-3867.81 5027.5,-3919.81"/>
<text text-anchor="middle" x="4981" y="-3907.81" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="4981" y="-3896.81" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="4981" y="-3885.81" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="4981" y="-3874.81" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attn_out_gpu9&#45;&gt;layer_13_allreduce_attn -->
<g id="edge802" class="edge">
<title>layer_13_attn_out_gpu9&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M5027.67,-3871.76C5030.82,-3870.4 5033.95,-3869.08 5037,-3867.81 5073.57,-3852.61 5115.16,-3836.58 5147.56,-3824.37"/>
<polygon fill="black" stroke="black" points="5149.17,-3827.5 5157.3,-3820.7 5146.71,-3820.95 5149.17,-3827.5"/>
</g>
<!-- layer_13_attn_out_gpu10 -->
<g id="node587" class="node">
<title>layer_13_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="5138.5,-3919.81 5045.5,-3919.81 5045.5,-3867.81 5138.5,-3867.81 5138.5,-3919.81"/>
<text text-anchor="middle" x="5092" y="-3907.81" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="5092" y="-3896.81" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="5092" y="-3885.81" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="5092" y="-3874.81" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attn_out_gpu10&#45;&gt;layer_13_allreduce_attn -->
<g id="edge803" class="edge">
<title>layer_13_attn_out_gpu10&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M5123.22,-3867.78C5136.29,-3857.3 5151.61,-3845.02 5165.31,-3834.03"/>
<polygon fill="black" stroke="black" points="5167.55,-3836.72 5173.17,-3827.74 5163.17,-3831.26 5167.55,-3836.72"/>
</g>
<!-- layer_13_attn_out_gpu11 -->
<g id="node588" class="node">
<title>layer_13_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="5249.5,-3919.81 5156.5,-3919.81 5156.5,-3867.81 5249.5,-3867.81 5249.5,-3919.81"/>
<text text-anchor="middle" x="5203" y="-3907.81" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="5203" y="-3896.81" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="5203" y="-3885.81" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="5203" y="-3874.81" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attn_out_gpu11&#45;&gt;layer_13_allreduce_attn -->
<g id="edge804" class="edge">
<title>layer_13_attn_out_gpu11&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M5203,-3867.55C5203,-3859.66 5203,-3850.77 5203,-3842.19"/>
<polygon fill="black" stroke="black" points="5206.5,-3841.96 5203,-3831.96 5199.5,-3841.96 5206.5,-3841.96"/>
</g>
<!-- layer_13_attn_out_gpu12 -->
<g id="node589" class="node">
<title>layer_13_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="5360.5,-3919.81 5267.5,-3919.81 5267.5,-3867.81 5360.5,-3867.81 5360.5,-3919.81"/>
<text text-anchor="middle" x="5314" y="-3907.81" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="5314" y="-3896.81" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="5314" y="-3885.81" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="5314" y="-3874.81" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attn_out_gpu12&#45;&gt;layer_13_allreduce_attn -->
<g id="edge805" class="edge">
<title>layer_13_attn_out_gpu12&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M5282.78,-3867.78C5269.71,-3857.3 5254.39,-3845.02 5240.69,-3834.03"/>
<polygon fill="black" stroke="black" points="5242.83,-3831.26 5232.83,-3827.74 5238.45,-3836.72 5242.83,-3831.26"/>
</g>
<!-- layer_13_attn_out_gpu13 -->
<g id="node590" class="node">
<title>layer_13_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="5471.5,-3919.81 5378.5,-3919.81 5378.5,-3867.81 5471.5,-3867.81 5471.5,-3919.81"/>
<text text-anchor="middle" x="5425" y="-3907.81" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="5425" y="-3896.81" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="5425" y="-3885.81" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="5425" y="-3874.81" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attn_out_gpu13&#45;&gt;layer_13_allreduce_attn -->
<g id="edge806" class="edge">
<title>layer_13_attn_out_gpu13&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M5378.28,-3871.34C5375.48,-3870.13 5372.71,-3868.94 5370,-3867.81 5333.11,-3852.38 5291.07,-3836.28 5258.4,-3824.09"/>
<polygon fill="black" stroke="black" points="5259.61,-3820.8 5249.02,-3820.59 5257.17,-3827.36 5259.61,-3820.8"/>
</g>
<!-- layer_13_attn_out_gpu14 -->
<g id="node591" class="node">
<title>layer_13_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="5582.5,-3919.81 5489.5,-3919.81 5489.5,-3867.81 5582.5,-3867.81 5582.5,-3919.81"/>
<text text-anchor="middle" x="5536" y="-3907.81" font-family="Arial" font-size="10.00">Layer 13 Attn Out</text>
<text text-anchor="middle" x="5536" y="-3896.81" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5536" y="-3885.81" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="5536" y="-3874.81" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_13_attn_out_gpu14&#45;&gt;layer_13_allreduce_attn -->
<g id="edge807" class="edge">
<title>layer_13_attn_out_gpu14&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M5489.45,-3870.88C5486.61,-3869.79 5483.78,-3868.75 5481,-3867.81 5409.42,-3843.58 5324.4,-3825.5 5267.4,-3814.85"/>
<polygon fill="black" stroke="black" points="5267.91,-3811.38 5257.44,-3813.01 5266.64,-3818.27 5267.91,-3811.38"/>
</g>
<!-- layer_13_attn_out_gpu15&#45;&gt;layer_13_allreduce_attn -->
<g id="edge808" class="edge">
<title>layer_13_attn_out_gpu15&#45;&gt;layer_13_allreduce_attn</title>
<path fill="none" stroke="black" d="M4805.72,-3870.91C4808.83,-3869.78 4811.94,-3868.73 4815,-3867.81 4924.82,-3834.84 5057.56,-3817.59 5135.86,-3809.62"/>
<polygon fill="black" stroke="black" points="5136.47,-3813.08 5146.07,-3808.6 5135.77,-3806.11 5136.47,-3813.08"/>
</g>
<!-- layer_13_allreduce_attn&#45;&gt;layer_13_residual1 -->
<g id="edge809" class="edge">
<title>layer_13_allreduce_attn&#45;&gt;layer_13_residual1</title>
<path fill="none" stroke="black" d="M5245.27,-3782.55C5275.12,-3768.95 5315.5,-3750.54 5348.45,-3735.52"/>
<polygon fill="black" stroke="black" points="5350.32,-3738.51 5357.97,-3731.18 5347.42,-3732.14 5350.32,-3738.51"/>
</g>
<!-- layer_13_ln1 -->
<g id="node595" class="node">
<title>layer_13_ln1</title>
<polygon fill="lightblue" stroke="black" points="5229.5,-3641.83 5156.5,-3641.83 5156.5,-3600.83 5229.5,-3600.83 5229.5,-3641.83"/>
<text text-anchor="middle" x="5193" y="-3629.83" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="5193" y="-3618.83" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="5193" y="-3607.83" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_13_residual1&#45;&gt;layer_13_ln1 -->
<g id="edge811" class="edge">
<title>layer_13_residual1&#45;&gt;layer_13_ln1</title>
<path fill="none" stroke="black" d="M5333.35,-3677.75C5301.99,-3665.36 5266.38,-3651.3 5238.87,-3640.44"/>
<polygon fill="black" stroke="black" points="5240.09,-3637.16 5229.5,-3636.74 5237.52,-3643.67 5240.09,-3637.16"/>
</g>
<!-- layer_13_residual2 -->
<g id="node615" class="node">
<title>layer_13_residual2</title>
<polygon fill="lightyellow" stroke="black" points="5571.94,-3128.86 5449.55,-3128.86 5418.06,-3068.86 5540.45,-3068.86 5571.94,-3128.86"/>
<text text-anchor="middle" x="5495" y="-3101.86" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="5495" y="-3090.86" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_13_residual1&#45;&gt;layer_13_residual2 -->
<g id="edge839" class="edge">
<title>layer_13_residual1&#45;&gt;layer_13_residual2</title>
<path fill="none" stroke="black" d="M5464.71,-3700.96C5552.62,-3688.47 5710,-3650.65 5710,-3539.83 5710,-3539.83 5710,-3539.83 5710,-3283.84 5710,-3212.47 5640.75,-3162.85 5580.85,-3133.28"/>
<polygon fill="black" stroke="black" points="5582.24,-3130.06 5571.71,-3128.88 5579.2,-3136.37 5582.24,-3130.06"/>
</g>
<!-- layer_13_mlp_fc1_gpu8 -->
<g id="node596" class="node">
<title>layer_13_mlp_fc1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="4774.5,-3564.83 4675.5,-3564.83 4675.5,-3512.83 4774.5,-3512.83 4774.5,-3564.83"/>
<text text-anchor="middle" x="4725" y="-3552.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="4725" y="-3541.83" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="4725" y="-3530.83" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="4725" y="-3519.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu8 -->
<g id="edge812" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu8</title>
<path fill="none" stroke="black" d="M5156.24,-3618.61C5085.44,-3614.61 4925.46,-3602.19 4784.26,-3564.56"/>
<polygon fill="black" stroke="black" points="4785.13,-3561.17 4774.56,-3561.92 4783.29,-3567.92 4785.13,-3561.17"/>
</g>
<!-- layer_13_mlp_fc1_gpu9 -->
<g id="node597" class="node">
<title>layer_13_mlp_fc1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="4891.5,-3564.83 4792.5,-3564.83 4792.5,-3512.83 4891.5,-3512.83 4891.5,-3564.83"/>
<text text-anchor="middle" x="4842" y="-3552.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="4842" y="-3541.83" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="4842" y="-3530.83" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="4842" y="-3519.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu9 -->
<g id="edge813" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu9</title>
<path fill="none" stroke="black" d="M5156.44,-3615.93C5102.35,-3608.86 4997.89,-3593.13 4901.24,-3564.62"/>
<polygon fill="black" stroke="black" points="4902.2,-3561.25 4891.62,-3561.73 4900.19,-3567.96 4902.2,-3561.25"/>
</g>
<!-- layer_13_mlp_fc1_gpu10 -->
<g id="node598" class="node">
<title>layer_13_mlp_fc1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="5008.5,-3564.83 4909.5,-3564.83 4909.5,-3512.83 5008.5,-3512.83 5008.5,-3564.83"/>
<text text-anchor="middle" x="4959" y="-3552.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="4959" y="-3541.83" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="4959" y="-3530.83" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="4959" y="-3519.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu10 -->
<g id="edge814" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu10</title>
<path fill="none" stroke="black" d="M5156.47,-3609.83C5122.85,-3599.93 5071.47,-3584.19 5018.35,-3564.83"/>
<polygon fill="black" stroke="black" points="5019.36,-3561.47 5008.76,-3561.3 5016.94,-3568.04 5019.36,-3561.47"/>
</g>
<!-- layer_13_mlp_fc1_gpu11 -->
<g id="node599" class="node">
<title>layer_13_mlp_fc1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="5125.5,-3564.83 5026.5,-3564.83 5026.5,-3512.83 5125.5,-3512.83 5125.5,-3564.83"/>
<text text-anchor="middle" x="5076" y="-3552.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="5076" y="-3541.83" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="5076" y="-3530.83" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="5076" y="-3519.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu11 -->
<g id="edge815" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu11</title>
<path fill="none" stroke="black" d="M5164.38,-3600.64C5151.37,-3591.69 5135.67,-3580.88 5121.13,-3570.88"/>
<polygon fill="black" stroke="black" points="5122.96,-3567.89 5112.74,-3565.1 5118.99,-3573.66 5122.96,-3567.89"/>
</g>
<!-- layer_13_mlp_fc1_gpu12 -->
<g id="node600" class="node">
<title>layer_13_mlp_fc1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="5242.5,-3564.83 5143.5,-3564.83 5143.5,-3512.83 5242.5,-3512.83 5242.5,-3564.83"/>
<text text-anchor="middle" x="5193" y="-3552.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="5193" y="-3541.83" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="5193" y="-3530.83" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="5193" y="-3519.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu12 -->
<g id="edge816" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu12</title>
<path fill="none" stroke="black" d="M5193,-3600.43C5193,-3592.82 5193,-3583.88 5193,-3575.25"/>
<polygon fill="black" stroke="black" points="5196.5,-3574.98 5193,-3564.98 5189.5,-3574.98 5196.5,-3574.98"/>
</g>
<!-- layer_13_mlp_fc1_gpu13 -->
<g id="node601" class="node">
<title>layer_13_mlp_fc1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="5359.5,-3564.83 5260.5,-3564.83 5260.5,-3512.83 5359.5,-3512.83 5359.5,-3564.83"/>
<text text-anchor="middle" x="5310" y="-3552.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="5310" y="-3541.83" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="5310" y="-3530.83" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="5310" y="-3519.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu13 -->
<g id="edge817" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu13</title>
<path fill="none" stroke="black" d="M5221.62,-3600.64C5234.63,-3591.69 5250.33,-3580.88 5264.87,-3570.88"/>
<polygon fill="black" stroke="black" points="5267.01,-3573.66 5273.26,-3565.1 5263.04,-3567.89 5267.01,-3573.66"/>
</g>
<!-- layer_13_mlp_fc1_gpu14 -->
<g id="node602" class="node">
<title>layer_13_mlp_fc1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="5476.5,-3564.83 5377.5,-3564.83 5377.5,-3512.83 5476.5,-3512.83 5476.5,-3564.83"/>
<text text-anchor="middle" x="5427" y="-3552.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="5427" y="-3541.83" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5427" y="-3530.83" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="5427" y="-3519.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu14 -->
<g id="edge818" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu14</title>
<path fill="none" stroke="black" d="M5229.77,-3609.92C5263.6,-3600.08 5315.29,-3584.39 5367.96,-3565.09"/>
<polygon fill="black" stroke="black" points="5369.3,-3568.33 5377.46,-3561.57 5366.87,-3561.76 5369.3,-3568.33"/>
</g>
<!-- layer_13_mlp_fc1_gpu15 -->
<g id="node603" class="node">
<title>layer_13_mlp_fc1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5593.5,-3564.83 5494.5,-3564.83 5494.5,-3512.83 5593.5,-3512.83 5593.5,-3564.83"/>
<text text-anchor="middle" x="5544" y="-3552.83" font-family="Arial" font-size="10.00">Layer 13 MLP FC1</text>
<text text-anchor="middle" x="5544" y="-3541.83" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="5544" y="-3530.83" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="5544" y="-3519.83" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu15 -->
<g id="edge819" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_mlp_fc1_gpu15</title>
<path fill="none" stroke="black" d="M5229.71,-3616.01C5283.96,-3609.06 5388.65,-3593.49 5484.44,-3565.06"/>
<polygon fill="black" stroke="black" points="5485.72,-3568.33 5494.27,-3562.09 5483.69,-3561.63 5485.72,-3568.33"/>
</g>
<!-- layer_13_allgather_mlp -->
<g id="node604" class="node">
<title>layer_13_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="5076" cy="-3447.84" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="5076" y="-3456.34" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="5076" y="-3445.34" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="5076" y="-3434.34" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_13_mlp_fc1_gpu8&#45;&gt;layer_13_allgather_mlp -->
<g id="edge820" class="edge">
<title>layer_13_mlp_fc1_gpu8&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M4774.65,-3516.03C4777.79,-3514.88 4780.93,-3513.81 4784,-3512.83 4861.13,-3488.27 4952.67,-3469.88 5012.43,-3459.26"/>
<polygon fill="black" stroke="black" points="5013.23,-3462.67 5022.47,-3457.5 5012.02,-3455.78 5013.23,-3462.67"/>
</g>
<!-- layer_13_mlp_fc1_gpu9&#45;&gt;layer_13_allgather_mlp -->
<g id="edge821" class="edge">
<title>layer_13_mlp_fc1_gpu9&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M4891.5,-3516.64C4894.71,-3515.33 4897.9,-3514.05 4901,-3512.83 4940.75,-3497.15 4986.07,-3480.62 5020.62,-3468.28"/>
<polygon fill="black" stroke="black" points="5021.83,-3471.57 5030.07,-3464.92 5019.48,-3464.98 5021.83,-3471.57"/>
</g>
<!-- layer_13_mlp_fc1_gpu10&#45;&gt;layer_13_allgather_mlp -->
<g id="edge822" class="edge">
<title>layer_13_mlp_fc1_gpu10&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M4991.9,-3512.8C5005.8,-3502.23 5022.1,-3489.83 5036.63,-3478.78"/>
<polygon fill="black" stroke="black" points="5039.11,-3481.29 5044.95,-3472.45 5034.87,-3475.72 5039.11,-3481.29"/>
</g>
<!-- layer_13_mlp_fc1_gpu11&#45;&gt;layer_13_allgather_mlp -->
<g id="edge823" class="edge">
<title>layer_13_mlp_fc1_gpu11&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M5076,-3512.56C5076,-3504.67 5076,-3495.78 5076,-3487.2"/>
<polygon fill="black" stroke="black" points="5079.5,-3486.98 5076,-3476.98 5072.5,-3486.98 5079.5,-3486.98"/>
</g>
<!-- layer_13_mlp_fc1_gpu12&#45;&gt;layer_13_allgather_mlp -->
<g id="edge824" class="edge">
<title>layer_13_mlp_fc1_gpu12&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M5160.1,-3512.8C5146.2,-3502.23 5129.9,-3489.83 5115.37,-3478.78"/>
<polygon fill="black" stroke="black" points="5117.13,-3475.72 5107.05,-3472.45 5112.89,-3481.29 5117.13,-3475.72"/>
</g>
<!-- layer_13_mlp_fc1_gpu13&#45;&gt;layer_13_allgather_mlp -->
<g id="edge825" class="edge">
<title>layer_13_mlp_fc1_gpu13&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M5260.41,-3516.23C5257.57,-3515.06 5254.75,-3513.92 5252,-3512.83 5212.09,-3496.98 5166.51,-3480.46 5131.74,-3468.17"/>
<polygon fill="black" stroke="black" points="5132.82,-3464.84 5122.23,-3464.82 5130.5,-3471.44 5132.82,-3464.84"/>
</g>
<!-- layer_13_mlp_fc1_gpu14&#45;&gt;layer_13_allgather_mlp -->
<g id="edge826" class="edge">
<title>layer_13_mlp_fc1_gpu14&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M5377.25,-3515.66C5374.48,-3514.65 5371.71,-3513.7 5369,-3512.83 5291.57,-3487.94 5199.53,-3469.6 5139.55,-3459.08"/>
<polygon fill="black" stroke="black" points="5139.92,-3455.59 5129.47,-3457.33 5138.73,-3462.49 5139.92,-3455.59"/>
</g>
<!-- layer_13_mlp_fc1_gpu15&#45;&gt;layer_13_allgather_mlp -->
<g id="edge827" class="edge">
<title>layer_13_mlp_fc1_gpu15&#45;&gt;layer_13_allgather_mlp</title>
<path fill="none" stroke="black" d="M5494.31,-3515.46C5491.52,-3514.51 5488.74,-3513.62 5486,-3512.83 5367.35,-3478.59 5223.76,-3461.51 5141.84,-3453.97"/>
<polygon fill="black" stroke="black" points="5141.94,-3450.46 5131.67,-3453.05 5141.32,-3457.43 5141.94,-3450.46"/>
</g>
<!-- layer_13_gelu -->
<g id="node605" class="node">
<title>layer_13_gelu</title>
<polygon fill="lightblue" stroke="black" points="5032.5,-3382.84 4943.5,-3382.84 4943.5,-3346.84 5032.5,-3346.84 5032.5,-3382.84"/>
<text text-anchor="middle" x="4988" y="-3367.84" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="4988" y="-3356.84" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_13_allgather_mlp&#45;&gt;layer_13_gelu -->
<g id="edge828" class="edge">
<title>layer_13_allgather_mlp&#45;&gt;layer_13_gelu</title>
<path fill="none" stroke="black" d="M5049.12,-3422.1C5038.06,-3411.91 5025.28,-3400.16 5014.28,-3390.03"/>
<polygon fill="black" stroke="black" points="5016.36,-3387.19 5006.64,-3383 5011.62,-3392.34 5016.36,-3387.19"/>
</g>
<!-- layer_13_mlp_fc2_gpu15 -->
<g id="node613" class="node">
<title>layer_13_mlp_fc2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4862.5,-3310.84 4763.5,-3310.84 4763.5,-3258.84 4862.5,-3258.84 4862.5,-3310.84"/>
<text text-anchor="middle" x="4813" y="-3298.84" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="4813" y="-3287.84" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="4813" y="-3276.84" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="4813" y="-3265.84" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu15 -->
<g id="edge829" class="edge">
<title>layer_13_gelu&#45;&gt;layer_13_mlp_fc2_gpu15</title>
<path fill="none" stroke="black" d="M4949.6,-3346.73C4926.83,-3336.58 4897.52,-3323.52 4871.89,-3312.09"/>
<polygon fill="black" stroke="black" points="4873.19,-3308.84 4862.63,-3307.97 4870.34,-3315.23 4873.19,-3308.84"/>
</g>
<!-- layer_13_mlp_fc2_gpu8 -->
<g id="node606" class="node">
<title>layer_13_mlp_fc2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="4979.5,-3310.84 4880.5,-3310.84 4880.5,-3258.84 4979.5,-3258.84 4979.5,-3310.84"/>
<text text-anchor="middle" x="4930" y="-3298.84" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="4930" y="-3287.84" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="4930" y="-3276.84" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="4930" y="-3265.84" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_allreduce_mlp -->
<g id="node614" class="node">
<title>layer_13_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="5281" cy="-3193.85" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="5281" y="-3202.35" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="5281" y="-3191.35" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="5281" y="-3180.35" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_13_mlp_fc2_gpu8&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge830" class="edge">
<title>layer_13_mlp_fc2_gpu8&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4979.65,-3262.04C4982.79,-3260.9 4985.93,-3259.82 4989,-3258.84 5064.85,-3234.69 5154.62,-3216.51 5214.41,-3205.82"/>
<polygon fill="black" stroke="black" points="5215.24,-3209.22 5224.48,-3204.03 5214.03,-3202.33 5215.24,-3209.22"/>
</g>
<!-- layer_13_mlp_fc2_gpu9 -->
<g id="node607" class="node">
<title>layer_13_mlp_fc2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="5096.5,-3310.84 4997.5,-3310.84 4997.5,-3258.84 5096.5,-3258.84 5096.5,-3310.84"/>
<text text-anchor="middle" x="5047" y="-3298.84" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="5047" y="-3287.84" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="5047" y="-3276.84" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="5047" y="-3265.84" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_mlp_fc2_gpu9&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge831" class="edge">
<title>layer_13_mlp_fc2_gpu9&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5096.5,-3262.66C5099.71,-3261.35 5102.9,-3260.07 5106,-3258.84 5144.89,-3243.5 5189.12,-3227.34 5223.38,-3215.1"/>
<polygon fill="black" stroke="black" points="5224.98,-3218.25 5233.22,-3211.59 5222.63,-3211.65 5224.98,-3218.25"/>
</g>
<!-- layer_13_mlp_fc2_gpu10 -->
<g id="node608" class="node">
<title>layer_13_mlp_fc2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="5213.5,-3310.84 5114.5,-3310.84 5114.5,-3258.84 5213.5,-3258.84 5213.5,-3310.84"/>
<text text-anchor="middle" x="5164" y="-3298.84" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="5164" y="-3287.84" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="5164" y="-3276.84" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="5164" y="-3265.84" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_mlp_fc2_gpu10&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge832" class="edge">
<title>layer_13_mlp_fc2_gpu10&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5196.9,-3258.82C5210.69,-3248.33 5226.84,-3236.05 5241.28,-3225.07"/>
<polygon fill="black" stroke="black" points="5243.71,-3227.61 5249.55,-3218.77 5239.47,-3222.04 5243.71,-3227.61"/>
</g>
<!-- layer_13_mlp_fc2_gpu11 -->
<g id="node609" class="node">
<title>layer_13_mlp_fc2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="5330.5,-3310.84 5231.5,-3310.84 5231.5,-3258.84 5330.5,-3258.84 5330.5,-3310.84"/>
<text text-anchor="middle" x="5281" y="-3298.84" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="5281" y="-3287.84" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="5281" y="-3276.84" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="5281" y="-3265.84" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_mlp_fc2_gpu11&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge833" class="edge">
<title>layer_13_mlp_fc2_gpu11&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5281,-3258.58C5281,-3250.69 5281,-3241.8 5281,-3233.22"/>
<polygon fill="black" stroke="black" points="5284.5,-3233 5281,-3223 5277.5,-3233 5284.5,-3233"/>
</g>
<!-- layer_13_mlp_fc2_gpu12 -->
<g id="node610" class="node">
<title>layer_13_mlp_fc2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="5447.5,-3310.84 5348.5,-3310.84 5348.5,-3258.84 5447.5,-3258.84 5447.5,-3310.84"/>
<text text-anchor="middle" x="5398" y="-3298.84" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="5398" y="-3287.84" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="5398" y="-3276.84" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="5398" y="-3265.84" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_mlp_fc2_gpu12&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge834" class="edge">
<title>layer_13_mlp_fc2_gpu12&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5365.1,-3258.82C5351.31,-3248.33 5335.16,-3236.05 5320.72,-3225.07"/>
<polygon fill="black" stroke="black" points="5322.53,-3222.04 5312.45,-3218.77 5318.29,-3227.61 5322.53,-3222.04"/>
</g>
<!-- layer_13_mlp_fc2_gpu13 -->
<g id="node611" class="node">
<title>layer_13_mlp_fc2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="5564.5,-3310.84 5465.5,-3310.84 5465.5,-3258.84 5564.5,-3258.84 5564.5,-3310.84"/>
<text text-anchor="middle" x="5515" y="-3298.84" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="5515" y="-3287.84" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="5515" y="-3276.84" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="5515" y="-3265.84" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_mlp_fc2_gpu13&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge835" class="edge">
<title>layer_13_mlp_fc2_gpu13&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5465.41,-3262.24C5462.57,-3261.08 5459.75,-3259.94 5457,-3258.84 5417.78,-3243.28 5373.08,-3227.04 5338.55,-3214.82"/>
<polygon fill="black" stroke="black" points="5339.69,-3211.51 5329.09,-3211.49 5337.36,-3218.12 5339.69,-3211.51"/>
</g>
<!-- layer_13_mlp_fc2_gpu14 -->
<g id="node612" class="node">
<title>layer_13_mlp_fc2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="5681.5,-3310.84 5582.5,-3310.84 5582.5,-3258.84 5681.5,-3258.84 5681.5,-3310.84"/>
<text text-anchor="middle" x="5632" y="-3298.84" font-family="Arial" font-size="10.00">Layer 13 MLP FC2</text>
<text text-anchor="middle" x="5632" y="-3287.84" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5632" y="-3276.84" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="5632" y="-3265.84" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_13_mlp_fc2_gpu14&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge836" class="edge">
<title>layer_13_mlp_fc2_gpu14&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5582.25,-3261.68C5579.48,-3260.67 5576.71,-3259.72 5574,-3258.84 5497.85,-3234.37 5407.59,-3216.23 5347.57,-3205.63"/>
<polygon fill="black" stroke="black" points="5347.92,-3202.14 5337.47,-3203.87 5346.72,-3209.03 5347.92,-3202.14"/>
</g>
<!-- layer_13_mlp_fc2_gpu15&#45;&gt;layer_13_allreduce_mlp -->
<g id="edge837" class="edge">
<title>layer_13_mlp_fc2_gpu15&#45;&gt;layer_13_allreduce_mlp</title>
<path fill="none" stroke="black" d="M4862.58,-3261.82C4865.74,-3260.74 4868.9,-3259.73 4872,-3258.84 4988.77,-3225.52 5129.55,-3208.31 5211.8,-3200.46"/>
<polygon fill="black" stroke="black" points="5212.14,-3203.94 5221.77,-3199.53 5211.49,-3196.97 5212.14,-3203.94"/>
</g>
<!-- layer_13_allreduce_mlp&#45;&gt;layer_13_residual2 -->
<g id="edge838" class="edge">
<title>layer_13_allreduce_mlp&#45;&gt;layer_13_residual2</title>
<path fill="none" stroke="black" d="M5324.82,-3173.81C5356.93,-3159.86 5400.85,-3140.77 5436.03,-3125.48"/>
<polygon fill="black" stroke="black" points="5437.47,-3128.68 5445.24,-3121.48 5434.68,-3122.26 5437.47,-3128.68"/>
</g>
<!-- layer_13_ln2 -->
<g id="node616" class="node">
<title>layer_13_ln2</title>
<polygon fill="lightblue" stroke="black" points="5531.5,-3032.86 5458.5,-3032.86 5458.5,-2991.86 5531.5,-2991.86 5531.5,-3032.86"/>
<text text-anchor="middle" x="5495" y="-3020.86" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="5495" y="-3009.86" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="5495" y="-2998.86" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_13_residual2&#45;&gt;layer_13_ln2 -->
<g id="edge840" class="edge">
<title>layer_13_residual2&#45;&gt;layer_13_ln2</title>
<path fill="none" stroke="black" d="M5495,-3068.78C5495,-3060.46 5495,-3051.37 5495,-3043.02"/>
<polygon fill="black" stroke="black" points="5498.5,-3042.93 5495,-3032.93 5491.5,-3042.93 5498.5,-3042.93"/>
</g>
<!-- layer_13_output_dist -->
<g id="node617" class="node">
<title>layer_13_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="5596.7,-2955.86 5434.92,-2955.86 5393.3,-2895.86 5555.08,-2895.86 5596.7,-2955.86"/>
<text text-anchor="middle" x="5495" y="-2928.86" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="5495" y="-2917.86" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_13_ln2&#45;&gt;layer_13_output_dist -->
<g id="edge841" class="edge">
<title>layer_13_ln2&#45;&gt;layer_13_output_dist</title>
<path fill="none" stroke="black" d="M5495,-2991.76C5495,-2984.12 5495,-2975.08 5495,-2966.21"/>
<polygon fill="black" stroke="black" points="5498.5,-2965.97 5495,-2955.97 5491.5,-2965.97 5498.5,-2965.97"/>
</g>
<!-- layer_14_input_dist -->
<g id="node618" class="node">
<title>layer_14_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="5589.19,-2859.86 5439.36,-2859.86 5400.81,-2799.86 5550.64,-2799.86 5589.19,-2859.86"/>
<text text-anchor="middle" x="5495" y="-2832.86" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="5495" y="-2821.86" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_13_output_dist&#45;&gt;layer_14_input_dist -->
<g id="edge842" class="edge">
<title>layer_13_output_dist&#45;&gt;layer_14_input_dist</title>
<path fill="none" stroke="black" d="M5495,-2895.64C5495,-2887.59 5495,-2878.73 5495,-2870.21"/>
<polygon fill="black" stroke="black" points="5498.5,-2870.07 5495,-2860.07 5491.5,-2870.07 5498.5,-2870.07"/>
</g>
<!-- layer_14_qkv_gpu8 -->
<g id="node619" class="node">
<title>layer_14_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="5080,-2763.86 4982,-2763.86 4982,-2711.86 5080,-2711.86 5080,-2763.86"/>
<text text-anchor="middle" x="5031" y="-2751.86" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="5031" y="-2740.86" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="5031" y="-2729.86" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="5031" y="-2718.86" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu8 -->
<g id="edge843" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu8</title>
<path fill="none" stroke="black" d="M5414.74,-2821.94C5334.17,-2813.66 5206.73,-2796.94 5089.88,-2763.82"/>
<polygon fill="black" stroke="black" points="5090.63,-2760.4 5080.05,-2760.99 5088.69,-2767.12 5090.63,-2760.4"/>
</g>
<!-- layer_14_qkv_gpu9 -->
<g id="node620" class="node">
<title>layer_14_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="5196,-2763.86 5098,-2763.86 5098,-2711.86 5196,-2711.86 5196,-2763.86"/>
<text text-anchor="middle" x="5147" y="-2751.86" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="5147" y="-2740.86" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="5147" y="-2729.86" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="5147" y="-2718.86" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu9 -->
<g id="edge844" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu9</title>
<path fill="none" stroke="black" d="M5409.81,-2814.11C5353.93,-2803.43 5279.34,-2787.26 5205.99,-2763.96"/>
<polygon fill="black" stroke="black" points="5206.71,-2760.51 5196.12,-2760.78 5204.56,-2767.17 5206.71,-2760.51"/>
</g>
<!-- layer_14_qkv_gpu10 -->
<g id="node621" class="node">
<title>layer_14_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="5312,-2763.86 5214,-2763.86 5214,-2711.86 5312,-2711.86 5312,-2763.86"/>
<text text-anchor="middle" x="5263" y="-2751.86" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="5263" y="-2740.86" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="5263" y="-2729.86" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="5263" y="-2718.86" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu10 -->
<g id="edge845" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu10</title>
<path fill="none" stroke="black" d="M5414.55,-2799.75C5387.43,-2789.71 5356.86,-2778.15 5321.8,-2764.12"/>
<polygon fill="black" stroke="black" points="5322.88,-2760.79 5312.29,-2760.31 5320.27,-2767.28 5322.88,-2760.79"/>
</g>
<!-- layer_14_qkv_gpu11 -->
<g id="node622" class="node">
<title>layer_14_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="5428,-2763.86 5330,-2763.86 5330,-2711.86 5428,-2711.86 5428,-2763.86"/>
<text text-anchor="middle" x="5379" y="-2751.86" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="5379" y="-2740.86" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="5379" y="-2729.86" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="5379" y="-2718.86" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu11 -->
<g id="edge846" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu11</title>
<path fill="none" stroke="black" d="M5457.34,-2799.64C5445.18,-2790.21 5431.66,-2779.72 5419.32,-2770.15"/>
<polygon fill="black" stroke="black" points="5421.46,-2767.37 5411.41,-2764.01 5417.16,-2772.9 5421.46,-2767.37"/>
</g>
<!-- layer_14_qkv_gpu12 -->
<g id="node623" class="node">
<title>layer_14_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="5544,-2763.86 5446,-2763.86 5446,-2711.86 5544,-2711.86 5544,-2763.86"/>
<text text-anchor="middle" x="5495" y="-2751.86" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="5495" y="-2740.86" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="5495" y="-2729.86" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="5495" y="-2718.86" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu12 -->
<g id="edge847" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu12</title>
<path fill="none" stroke="black" d="M5495,-2799.39C5495,-2791.32 5495,-2782.48 5495,-2774.12"/>
<polygon fill="black" stroke="black" points="5498.5,-2773.87 5495,-2763.87 5491.5,-2773.87 5498.5,-2773.87"/>
</g>
<!-- layer_14_qkv_gpu13 -->
<g id="node624" class="node">
<title>layer_14_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="5660,-2763.86 5562,-2763.86 5562,-2711.86 5660,-2711.86 5660,-2763.86"/>
<text text-anchor="middle" x="5611" y="-2751.86" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="5611" y="-2740.86" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="5611" y="-2729.86" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="5611" y="-2718.86" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu13 -->
<g id="edge848" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu13</title>
<path fill="none" stroke="black" d="M5532.66,-2799.64C5544.82,-2790.21 5558.34,-2779.72 5570.68,-2770.15"/>
<polygon fill="black" stroke="black" points="5572.84,-2772.9 5578.59,-2764.01 5568.54,-2767.37 5572.84,-2772.9"/>
</g>
<!-- layer_14_qkv_gpu14 -->
<g id="node625" class="node">
<title>layer_14_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="5776,-2763.86 5678,-2763.86 5678,-2711.86 5776,-2711.86 5776,-2763.86"/>
<text text-anchor="middle" x="5727" y="-2751.86" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="5727" y="-2740.86" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5727" y="-2729.86" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="5727" y="-2718.86" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu14 -->
<g id="edge849" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu14</title>
<path fill="none" stroke="black" d="M5555.68,-2807.03C5586.94,-2795.59 5625.85,-2781.05 5668.31,-2764.08"/>
<polygon fill="black" stroke="black" points="5669.73,-2767.28 5677.71,-2760.31 5667.12,-2760.78 5669.73,-2767.28"/>
</g>
<!-- layer_14_qkv_gpu15 -->
<g id="node626" class="node">
<title>layer_14_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5892,-2763.86 5794,-2763.86 5794,-2711.86 5892,-2711.86 5892,-2763.86"/>
<text text-anchor="middle" x="5843" y="-2751.86" font-family="Arial" font-size="10.00">Layer 14 QKV Proj</text>
<text text-anchor="middle" x="5843" y="-2740.86" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="5843" y="-2729.86" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="5843" y="-2718.86" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_qkv_gpu15 -->
<g id="edge850" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_qkv_gpu15</title>
<path fill="none" stroke="black" d="M5562.18,-2817.49C5619.25,-2806.99 5703.28,-2789.57 5784.05,-2763.94"/>
<polygon fill="black" stroke="black" points="5785.43,-2767.17 5793.88,-2760.78 5783.29,-2760.51 5785.43,-2767.17"/>
</g>
<!-- layer_14_residual1 -->
<g id="node638" class="node">
<title>layer_14_residual1</title>
<polygon fill="lightyellow" stroke="black" points="5870.94,-2311.9 5748.55,-2311.9 5717.06,-2251.9 5839.45,-2251.9 5870.94,-2311.9"/>
<text text-anchor="middle" x="5794" y="-2284.9" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="5794" y="-2273.9" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_14_input_dist&#45;&gt;layer_14_residual1 -->
<g id="edge870" class="edge">
<title>layer_14_input_dist&#45;&gt;layer_14_residual1</title>
<path fill="none" stroke="black" d="M5565.91,-2823.5C5666.62,-2814.89 5845.06,-2795.64 5901,-2763.86 5959.43,-2730.67 5998,-2715.07 5998,-2647.87 5998,-2647.87 5998,-2647.87 5998,-2466.88 5998,-2396.94 5931.05,-2346.75 5873.86,-2316.64"/>
<polygon fill="black" stroke="black" points="5875.27,-2313.43 5864.78,-2311.98 5872.08,-2319.66 5875.27,-2313.43"/>
</g>
<!-- layer_14_allgather_qkv -->
<g id="node627" class="node">
<title>layer_14_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="5379" cy="-2646.87" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="5379" y="-2655.37" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="5379" y="-2644.37" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="5379" y="-2633.37" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_14_qkv_gpu8&#45;&gt;layer_14_allgather_qkv -->
<g id="edge851" class="edge">
<title>layer_14_qkv_gpu8&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M5080.12,-2714.94C5083.1,-2713.84 5086.08,-2712.8 5089,-2711.86 5165.19,-2687.28 5255.64,-2668.98 5315.02,-2658.38"/>
<polygon fill="black" stroke="black" points="5315.77,-2661.8 5325.01,-2656.62 5314.55,-2654.91 5315.77,-2661.8"/>
</g>
<!-- layer_14_qkv_gpu9&#45;&gt;layer_14_allgather_qkv -->
<g id="edge852" class="edge">
<title>layer_14_qkv_gpu9&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M5196.28,-2715.4C5199.23,-2714.19 5202.15,-2713 5205,-2711.86 5244.04,-2696.28 5288.54,-2679.94 5322.76,-2667.67"/>
<polygon fill="black" stroke="black" points="5324.34,-2670.83 5332.58,-2664.17 5321.98,-2664.24 5324.34,-2670.83"/>
</g>
<!-- layer_14_qkv_gpu10&#45;&gt;layer_14_allgather_qkv -->
<g id="edge853" class="edge">
<title>layer_14_qkv_gpu10&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M5295.62,-2711.84C5309.4,-2701.26 5325.56,-2688.87 5339.97,-2677.81"/>
<polygon fill="black" stroke="black" points="5342.41,-2680.35 5348.22,-2671.49 5338.15,-2674.8 5342.41,-2680.35"/>
</g>
<!-- layer_14_qkv_gpu11&#45;&gt;layer_14_allgather_qkv -->
<g id="edge854" class="edge">
<title>layer_14_qkv_gpu11&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M5379,-2711.6C5379,-2703.71 5379,-2694.82 5379,-2686.24"/>
<polygon fill="black" stroke="black" points="5382.5,-2686.01 5379,-2676.01 5375.5,-2686.01 5382.5,-2686.01"/>
</g>
<!-- layer_14_qkv_gpu12&#45;&gt;layer_14_allgather_qkv -->
<g id="edge855" class="edge">
<title>layer_14_qkv_gpu12&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M5462.38,-2711.84C5448.6,-2701.26 5432.44,-2688.87 5418.03,-2677.81"/>
<polygon fill="black" stroke="black" points="5419.85,-2674.8 5409.78,-2671.49 5415.59,-2680.35 5419.85,-2674.8"/>
</g>
<!-- layer_14_qkv_gpu13&#45;&gt;layer_14_allgather_qkv -->
<g id="edge856" class="edge">
<title>layer_14_qkv_gpu13&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M5561.72,-2715.4C5558.77,-2714.19 5555.85,-2713 5553,-2711.86 5513.96,-2696.28 5469.46,-2679.94 5435.24,-2667.67"/>
<polygon fill="black" stroke="black" points="5436.02,-2664.24 5425.42,-2664.17 5433.66,-2670.83 5436.02,-2664.24"/>
</g>
<!-- layer_14_qkv_gpu14&#45;&gt;layer_14_allgather_qkv -->
<g id="edge857" class="edge">
<title>layer_14_qkv_gpu14&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M5677.88,-2714.94C5674.9,-2713.84 5671.92,-2712.8 5669,-2711.86 5592.81,-2687.28 5502.36,-2668.98 5442.98,-2658.38"/>
<polygon fill="black" stroke="black" points="5443.45,-2654.91 5432.99,-2656.62 5442.23,-2661.8 5443.45,-2654.91"/>
</g>
<!-- layer_14_qkv_gpu15&#45;&gt;layer_14_allgather_qkv -->
<g id="edge858" class="edge">
<title>layer_14_qkv_gpu15&#45;&gt;layer_14_allgather_qkv</title>
<path fill="none" stroke="black" d="M5793.95,-2714.72C5790.95,-2713.68 5787.95,-2712.72 5785,-2711.86 5668.16,-2678.06 5526.91,-2660.9 5445.56,-2653.21"/>
<polygon fill="black" stroke="black" points="5445.74,-2649.71 5435.46,-2652.27 5445.09,-2656.68 5445.74,-2649.71"/>
</g>
<!-- layer_14_attention -->
<g id="node628" class="node">
<title>layer_14_attention</title>
<polygon fill="lightblue" stroke="black" points="5258,-2581.88 5190,-2581.88 5190,-2529.88 5258,-2529.88 5258,-2581.88"/>
<text text-anchor="middle" x="5224" y="-2569.88" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="5224" y="-2558.88" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="5224" y="-2547.88" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="5224" y="-2536.88" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_14_allgather_qkv&#45;&gt;layer_14_attention -->
<g id="edge859" class="edge">
<title>layer_14_allgather_qkv&#45;&gt;layer_14_attention</title>
<path fill="none" stroke="black" d="M5341.87,-2624.56C5319.32,-2611.61 5290.44,-2595.02 5266.91,-2581.51"/>
<polygon fill="black" stroke="black" points="5268.59,-2578.44 5258.17,-2576.5 5265.1,-2584.51 5268.59,-2578.44"/>
</g>
<!-- layer_14_attn_out_gpu15 -->
<g id="node636" class="node">
<title>layer_14_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5192.5,-2493.88 5099.5,-2493.88 5099.5,-2441.88 5192.5,-2441.88 5192.5,-2493.88"/>
<text text-anchor="middle" x="5146" y="-2481.88" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="5146" y="-2470.88" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="5146" y="-2459.88" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="5146" y="-2448.88" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attention&#45;&gt;layer_14_attn_out_gpu15 -->
<g id="edge860" class="edge">
<title>layer_14_attention&#45;&gt;layer_14_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M5201.02,-2529.54C5193.09,-2520.79 5184.08,-2510.86 5175.69,-2501.61"/>
<polygon fill="black" stroke="black" points="5178.13,-2499.09 5168.82,-2494.04 5172.94,-2503.79 5178.13,-2499.09"/>
</g>
<!-- layer_14_attn_out_gpu8 -->
<g id="node629" class="node">
<title>layer_14_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="5303.5,-2493.88 5210.5,-2493.88 5210.5,-2441.88 5303.5,-2441.88 5303.5,-2493.88"/>
<text text-anchor="middle" x="5257" y="-2481.88" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="5257" y="-2470.88" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="5257" y="-2459.88" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="5257" y="-2448.88" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_allreduce_attn -->
<g id="node637" class="node">
<title>layer_14_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="5590" cy="-2376.89" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="5590" y="-2385.39" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="5590" y="-2374.39" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="5590" y="-2363.39" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_14_attn_out_gpu8&#45;&gt;layer_14_allreduce_attn -->
<g id="edge861" class="edge">
<title>layer_14_attn_out_gpu8&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M5303.79,-2445.2C5306.88,-2444.02 5309.97,-2442.89 5313,-2441.88 5384.41,-2417.94 5469.1,-2399.81 5525.87,-2389.06"/>
<polygon fill="black" stroke="black" points="5526.6,-2392.48 5535.79,-2387.2 5525.32,-2385.6 5526.6,-2392.48"/>
</g>
<!-- layer_14_attn_out_gpu9 -->
<g id="node630" class="node">
<title>layer_14_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="5414.5,-2493.88 5321.5,-2493.88 5321.5,-2441.88 5414.5,-2441.88 5414.5,-2493.88"/>
<text text-anchor="middle" x="5368" y="-2481.88" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="5368" y="-2470.88" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="5368" y="-2459.88" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="5368" y="-2448.88" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attn_out_gpu9&#45;&gt;layer_14_allreduce_attn -->
<g id="edge862" class="edge">
<title>layer_14_attn_out_gpu9&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M5414.67,-2445.83C5417.82,-2444.47 5420.95,-2443.15 5424,-2441.88 5460.57,-2426.68 5502.16,-2410.65 5534.56,-2398.44"/>
<polygon fill="black" stroke="black" points="5536.17,-2401.57 5544.3,-2394.77 5533.71,-2395.02 5536.17,-2401.57"/>
</g>
<!-- layer_14_attn_out_gpu10 -->
<g id="node631" class="node">
<title>layer_14_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="5525.5,-2493.88 5432.5,-2493.88 5432.5,-2441.88 5525.5,-2441.88 5525.5,-2493.88"/>
<text text-anchor="middle" x="5479" y="-2481.88" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="5479" y="-2470.88" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="5479" y="-2459.88" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="5479" y="-2448.88" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attn_out_gpu10&#45;&gt;layer_14_allreduce_attn -->
<g id="edge863" class="edge">
<title>layer_14_attn_out_gpu10&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M5510.22,-2441.85C5523.29,-2431.37 5538.61,-2419.08 5552.31,-2408.1"/>
<polygon fill="black" stroke="black" points="5554.55,-2410.79 5560.17,-2401.81 5550.17,-2405.33 5554.55,-2410.79"/>
</g>
<!-- layer_14_attn_out_gpu11 -->
<g id="node632" class="node">
<title>layer_14_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="5636.5,-2493.88 5543.5,-2493.88 5543.5,-2441.88 5636.5,-2441.88 5636.5,-2493.88"/>
<text text-anchor="middle" x="5590" y="-2481.88" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="5590" y="-2470.88" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="5590" y="-2459.88" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="5590" y="-2448.88" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attn_out_gpu11&#45;&gt;layer_14_allreduce_attn -->
<g id="edge864" class="edge">
<title>layer_14_attn_out_gpu11&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M5590,-2441.62C5590,-2433.72 5590,-2424.83 5590,-2416.25"/>
<polygon fill="black" stroke="black" points="5593.5,-2416.03 5590,-2406.03 5586.5,-2416.03 5593.5,-2416.03"/>
</g>
<!-- layer_14_attn_out_gpu12 -->
<g id="node633" class="node">
<title>layer_14_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="5747.5,-2493.88 5654.5,-2493.88 5654.5,-2441.88 5747.5,-2441.88 5747.5,-2493.88"/>
<text text-anchor="middle" x="5701" y="-2481.88" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="5701" y="-2470.88" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="5701" y="-2459.88" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="5701" y="-2448.88" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attn_out_gpu12&#45;&gt;layer_14_allreduce_attn -->
<g id="edge865" class="edge">
<title>layer_14_attn_out_gpu12&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M5669.78,-2441.85C5656.71,-2431.37 5641.39,-2419.08 5627.69,-2408.1"/>
<polygon fill="black" stroke="black" points="5629.83,-2405.33 5619.83,-2401.81 5625.45,-2410.79 5629.83,-2405.33"/>
</g>
<!-- layer_14_attn_out_gpu13 -->
<g id="node634" class="node">
<title>layer_14_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="5858.5,-2493.88 5765.5,-2493.88 5765.5,-2441.88 5858.5,-2441.88 5858.5,-2493.88"/>
<text text-anchor="middle" x="5812" y="-2481.88" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="5812" y="-2470.88" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="5812" y="-2459.88" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="5812" y="-2448.88" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attn_out_gpu13&#45;&gt;layer_14_allreduce_attn -->
<g id="edge866" class="edge">
<title>layer_14_attn_out_gpu13&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M5765.28,-2445.41C5762.48,-2444.2 5759.71,-2443.01 5757,-2441.88 5720.11,-2426.45 5678.07,-2410.34 5645.4,-2398.15"/>
<polygon fill="black" stroke="black" points="5646.61,-2394.87 5636.02,-2394.66 5644.17,-2401.43 5646.61,-2394.87"/>
</g>
<!-- layer_14_attn_out_gpu14 -->
<g id="node635" class="node">
<title>layer_14_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="5969.5,-2493.88 5876.5,-2493.88 5876.5,-2441.88 5969.5,-2441.88 5969.5,-2493.88"/>
<text text-anchor="middle" x="5923" y="-2481.88" font-family="Arial" font-size="10.00">Layer 14 Attn Out</text>
<text text-anchor="middle" x="5923" y="-2470.88" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5923" y="-2459.88" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="5923" y="-2448.88" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_14_attn_out_gpu14&#45;&gt;layer_14_allreduce_attn -->
<g id="edge867" class="edge">
<title>layer_14_attn_out_gpu14&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M5876.45,-2444.95C5873.61,-2443.86 5870.78,-2442.82 5868,-2441.88 5796.42,-2417.65 5711.4,-2399.57 5654.4,-2388.91"/>
<polygon fill="black" stroke="black" points="5654.91,-2385.45 5644.44,-2387.08 5653.64,-2392.33 5654.91,-2385.45"/>
</g>
<!-- layer_14_attn_out_gpu15&#45;&gt;layer_14_allreduce_attn -->
<g id="edge868" class="edge">
<title>layer_14_attn_out_gpu15&#45;&gt;layer_14_allreduce_attn</title>
<path fill="none" stroke="black" d="M5192.72,-2444.98C5195.83,-2443.84 5198.94,-2442.8 5202,-2441.88 5311.82,-2408.91 5444.56,-2391.65 5522.86,-2383.69"/>
<polygon fill="black" stroke="black" points="5523.47,-2387.15 5533.07,-2382.67 5522.77,-2380.18 5523.47,-2387.15"/>
</g>
<!-- layer_14_allreduce_attn&#45;&gt;layer_14_residual1 -->
<g id="edge869" class="edge">
<title>layer_14_allreduce_attn&#45;&gt;layer_14_residual1</title>
<path fill="none" stroke="black" d="M5632.27,-2356.62C5662.12,-2343.01 5702.5,-2324.61 5735.45,-2309.59"/>
<polygon fill="black" stroke="black" points="5737.32,-2312.58 5744.97,-2305.25 5734.42,-2306.21 5737.32,-2312.58"/>
</g>
<!-- layer_14_ln1 -->
<g id="node639" class="node">
<title>layer_14_ln1</title>
<polygon fill="lightblue" stroke="black" points="5616.5,-2215.9 5543.5,-2215.9 5543.5,-2174.9 5616.5,-2174.9 5616.5,-2215.9"/>
<text text-anchor="middle" x="5580" y="-2203.9" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="5580" y="-2192.9" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="5580" y="-2181.9" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_14_residual1&#45;&gt;layer_14_ln1 -->
<g id="edge871" class="edge">
<title>layer_14_residual1&#45;&gt;layer_14_ln1</title>
<path fill="none" stroke="black" d="M5720.35,-2251.82C5688.99,-2239.43 5653.38,-2225.37 5625.87,-2214.51"/>
<polygon fill="black" stroke="black" points="5627.09,-2211.23 5616.5,-2210.81 5624.52,-2217.74 5627.09,-2211.23"/>
</g>
<!-- layer_14_residual2 -->
<g id="node659" class="node">
<title>layer_14_residual2</title>
<polygon fill="lightyellow" stroke="black" points="5958.94,-1702.93 5836.55,-1702.93 5805.06,-1642.93 5927.45,-1642.93 5958.94,-1702.93"/>
<text text-anchor="middle" x="5882" y="-1675.93" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="5882" y="-1664.93" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_14_residual1&#45;&gt;layer_14_residual2 -->
<g id="edge899" class="edge">
<title>layer_14_residual1&#45;&gt;layer_14_residual2</title>
<path fill="none" stroke="black" d="M5851.71,-2275.03C5939.62,-2262.54 6097,-2224.72 6097,-2113.9 6097,-2113.9 6097,-2113.9 6097,-1857.91 6097,-1786.54 6027.75,-1736.92 5967.85,-1707.35"/>
<polygon fill="black" stroke="black" points="5969.24,-1704.13 5958.71,-1702.95 5966.2,-1710.44 5969.24,-1704.13"/>
</g>
<!-- layer_14_mlp_fc1_gpu8 -->
<g id="node640" class="node">
<title>layer_14_mlp_fc1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="5161.5,-2138.9 5062.5,-2138.9 5062.5,-2086.9 5161.5,-2086.9 5161.5,-2138.9"/>
<text text-anchor="middle" x="5112" y="-2126.9" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="5112" y="-2115.9" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="5112" y="-2104.9" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="5112" y="-2093.9" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu8 -->
<g id="edge872" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu8</title>
<path fill="none" stroke="black" d="M5543.24,-2192.68C5472.44,-2188.68 5312.46,-2176.26 5171.26,-2138.63"/>
<polygon fill="black" stroke="black" points="5172.13,-2135.24 5161.56,-2135.99 5170.29,-2141.99 5172.13,-2135.24"/>
</g>
<!-- layer_14_mlp_fc1_gpu9 -->
<g id="node641" class="node">
<title>layer_14_mlp_fc1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="5278.5,-2138.9 5179.5,-2138.9 5179.5,-2086.9 5278.5,-2086.9 5278.5,-2138.9"/>
<text text-anchor="middle" x="5229" y="-2126.9" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="5229" y="-2115.9" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="5229" y="-2104.9" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="5229" y="-2093.9" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu9 -->
<g id="edge873" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu9</title>
<path fill="none" stroke="black" d="M5543.44,-2189.99C5489.35,-2182.93 5384.89,-2167.2 5288.24,-2138.69"/>
<polygon fill="black" stroke="black" points="5289.2,-2135.32 5278.62,-2135.8 5287.19,-2142.03 5289.2,-2135.32"/>
</g>
<!-- layer_14_mlp_fc1_gpu10 -->
<g id="node642" class="node">
<title>layer_14_mlp_fc1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="5395.5,-2138.9 5296.5,-2138.9 5296.5,-2086.9 5395.5,-2086.9 5395.5,-2138.9"/>
<text text-anchor="middle" x="5346" y="-2126.9" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="5346" y="-2115.9" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="5346" y="-2104.9" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="5346" y="-2093.9" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu10 -->
<g id="edge874" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu10</title>
<path fill="none" stroke="black" d="M5543.47,-2183.9C5509.85,-2174 5458.47,-2158.26 5405.35,-2138.9"/>
<polygon fill="black" stroke="black" points="5406.36,-2135.54 5395.76,-2135.37 5403.94,-2142.11 5406.36,-2135.54"/>
</g>
<!-- layer_14_mlp_fc1_gpu11 -->
<g id="node643" class="node">
<title>layer_14_mlp_fc1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="5512.5,-2138.9 5413.5,-2138.9 5413.5,-2086.9 5512.5,-2086.9 5512.5,-2138.9"/>
<text text-anchor="middle" x="5463" y="-2126.9" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="5463" y="-2115.9" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="5463" y="-2104.9" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="5463" y="-2093.9" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu11 -->
<g id="edge875" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu11</title>
<path fill="none" stroke="black" d="M5551.38,-2174.7C5538.37,-2165.75 5522.67,-2154.95 5508.13,-2144.95"/>
<polygon fill="black" stroke="black" points="5509.96,-2141.96 5499.74,-2139.17 5505.99,-2147.72 5509.96,-2141.96"/>
</g>
<!-- layer_14_mlp_fc1_gpu12 -->
<g id="node644" class="node">
<title>layer_14_mlp_fc1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="5629.5,-2138.9 5530.5,-2138.9 5530.5,-2086.9 5629.5,-2086.9 5629.5,-2138.9"/>
<text text-anchor="middle" x="5580" y="-2126.9" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="5580" y="-2115.9" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="5580" y="-2104.9" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="5580" y="-2093.9" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu12 -->
<g id="edge876" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu12</title>
<path fill="none" stroke="black" d="M5580,-2174.5C5580,-2166.88 5580,-2157.95 5580,-2149.32"/>
<polygon fill="black" stroke="black" points="5583.5,-2149.05 5580,-2139.05 5576.5,-2149.05 5583.5,-2149.05"/>
</g>
<!-- layer_14_mlp_fc1_gpu13 -->
<g id="node645" class="node">
<title>layer_14_mlp_fc1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="5746.5,-2138.9 5647.5,-2138.9 5647.5,-2086.9 5746.5,-2086.9 5746.5,-2138.9"/>
<text text-anchor="middle" x="5697" y="-2126.9" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="5697" y="-2115.9" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="5697" y="-2104.9" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="5697" y="-2093.9" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu13 -->
<g id="edge877" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu13</title>
<path fill="none" stroke="black" d="M5608.62,-2174.7C5621.63,-2165.75 5637.33,-2154.95 5651.87,-2144.95"/>
<polygon fill="black" stroke="black" points="5654.01,-2147.72 5660.26,-2139.17 5650.04,-2141.96 5654.01,-2147.72"/>
</g>
<!-- layer_14_mlp_fc1_gpu14 -->
<g id="node646" class="node">
<title>layer_14_mlp_fc1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="5863.5,-2138.9 5764.5,-2138.9 5764.5,-2086.9 5863.5,-2086.9 5863.5,-2138.9"/>
<text text-anchor="middle" x="5814" y="-2126.9" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="5814" y="-2115.9" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="5814" y="-2104.9" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="5814" y="-2093.9" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu14 -->
<g id="edge878" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu14</title>
<path fill="none" stroke="black" d="M5616.77,-2183.98C5650.6,-2174.14 5702.29,-2158.46 5754.96,-2139.16"/>
<polygon fill="black" stroke="black" points="5756.3,-2142.4 5764.46,-2135.64 5753.87,-2135.83 5756.3,-2142.4"/>
</g>
<!-- layer_14_mlp_fc1_gpu15 -->
<g id="node647" class="node">
<title>layer_14_mlp_fc1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5980.5,-2138.9 5881.5,-2138.9 5881.5,-2086.9 5980.5,-2086.9 5980.5,-2138.9"/>
<text text-anchor="middle" x="5931" y="-2126.9" font-family="Arial" font-size="10.00">Layer 14 MLP FC1</text>
<text text-anchor="middle" x="5931" y="-2115.9" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="5931" y="-2104.9" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="5931" y="-2093.9" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu15 -->
<g id="edge879" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_mlp_fc1_gpu15</title>
<path fill="none" stroke="black" d="M5616.71,-2190.08C5670.96,-2183.13 5775.65,-2167.56 5871.44,-2139.13"/>
<polygon fill="black" stroke="black" points="5872.72,-2142.4 5881.27,-2136.15 5870.69,-2135.7 5872.72,-2142.4"/>
</g>
<!-- layer_14_allgather_mlp -->
<g id="node648" class="node">
<title>layer_14_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="5463" cy="-2021.91" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="5463" y="-2030.41" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="5463" y="-2019.41" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="5463" y="-2008.41" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_14_mlp_fc1_gpu8&#45;&gt;layer_14_allgather_mlp -->
<g id="edge880" class="edge">
<title>layer_14_mlp_fc1_gpu8&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M5161.65,-2090.1C5164.79,-2088.95 5167.93,-2087.88 5171,-2086.9 5248.13,-2062.34 5339.67,-2043.95 5399.43,-2033.33"/>
<polygon fill="black" stroke="black" points="5400.23,-2036.74 5409.47,-2031.57 5399.02,-2029.85 5400.23,-2036.74"/>
</g>
<!-- layer_14_mlp_fc1_gpu9&#45;&gt;layer_14_allgather_mlp -->
<g id="edge881" class="edge">
<title>layer_14_mlp_fc1_gpu9&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M5278.5,-2090.71C5281.71,-2089.4 5284.9,-2088.12 5288,-2086.9 5327.75,-2071.22 5373.07,-2054.69 5407.62,-2042.35"/>
<polygon fill="black" stroke="black" points="5408.83,-2045.64 5417.07,-2038.99 5406.48,-2039.04 5408.83,-2045.64"/>
</g>
<!-- layer_14_mlp_fc1_gpu10&#45;&gt;layer_14_allgather_mlp -->
<g id="edge882" class="edge">
<title>layer_14_mlp_fc1_gpu10&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M5378.9,-2086.87C5392.8,-2076.3 5409.1,-2063.9 5423.63,-2052.85"/>
<polygon fill="black" stroke="black" points="5426.11,-2055.36 5431.95,-2046.52 5421.87,-2049.79 5426.11,-2055.36"/>
</g>
<!-- layer_14_mlp_fc1_gpu11&#45;&gt;layer_14_allgather_mlp -->
<g id="edge883" class="edge">
<title>layer_14_mlp_fc1_gpu11&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M5463,-2086.63C5463,-2078.74 5463,-2069.85 5463,-2061.27"/>
<polygon fill="black" stroke="black" points="5466.5,-2061.05 5463,-2051.05 5459.5,-2061.05 5466.5,-2061.05"/>
</g>
<!-- layer_14_mlp_fc1_gpu12&#45;&gt;layer_14_allgather_mlp -->
<g id="edge884" class="edge">
<title>layer_14_mlp_fc1_gpu12&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M5547.1,-2086.87C5533.2,-2076.3 5516.9,-2063.9 5502.37,-2052.85"/>
<polygon fill="black" stroke="black" points="5504.13,-2049.79 5494.05,-2046.52 5499.89,-2055.36 5504.13,-2049.79"/>
</g>
<!-- layer_14_mlp_fc1_gpu13&#45;&gt;layer_14_allgather_mlp -->
<g id="edge885" class="edge">
<title>layer_14_mlp_fc1_gpu13&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M5647.41,-2090.29C5644.57,-2089.13 5641.75,-2087.99 5639,-2086.9 5599.09,-2071.05 5553.51,-2054.52 5518.74,-2042.23"/>
<polygon fill="black" stroke="black" points="5519.82,-2038.91 5509.23,-2038.88 5517.5,-2045.51 5519.82,-2038.91"/>
</g>
<!-- layer_14_mlp_fc1_gpu14&#45;&gt;layer_14_allgather_mlp -->
<g id="edge886" class="edge">
<title>layer_14_mlp_fc1_gpu14&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M5764.25,-2089.73C5761.48,-2088.72 5758.71,-2087.77 5756,-2086.9 5678.57,-2062.01 5586.53,-2043.67 5526.55,-2033.15"/>
<polygon fill="black" stroke="black" points="5526.92,-2029.66 5516.47,-2031.4 5525.73,-2036.56 5526.92,-2029.66"/>
</g>
<!-- layer_14_mlp_fc1_gpu15&#45;&gt;layer_14_allgather_mlp -->
<g id="edge887" class="edge">
<title>layer_14_mlp_fc1_gpu15&#45;&gt;layer_14_allgather_mlp</title>
<path fill="none" stroke="black" d="M5881.31,-2089.53C5878.52,-2088.57 5875.74,-2087.69 5873,-2086.9 5754.35,-2052.66 5610.76,-2035.58 5528.84,-2028.03"/>
<polygon fill="black" stroke="black" points="5528.94,-2024.53 5518.67,-2027.12 5528.32,-2031.5 5528.94,-2024.53"/>
</g>
<!-- layer_14_gelu -->
<g id="node649" class="node">
<title>layer_14_gelu</title>
<polygon fill="lightblue" stroke="black" points="5332.5,-1956.91 5243.5,-1956.91 5243.5,-1920.91 5332.5,-1920.91 5332.5,-1956.91"/>
<text text-anchor="middle" x="5288" y="-1941.91" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="5288" y="-1930.91" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_14_allgather_mlp&#45;&gt;layer_14_gelu -->
<g id="edge888" class="edge">
<title>layer_14_allgather_mlp&#45;&gt;layer_14_gelu</title>
<path fill="none" stroke="black" d="M5421.97,-2001.92C5395.67,-1989.75 5361.49,-1973.92 5334.23,-1961.31"/>
<polygon fill="black" stroke="black" points="5335.45,-1958.02 5324.9,-1956.99 5332.51,-1964.37 5335.45,-1958.02"/>
</g>
<!-- layer_14_mlp_fc2_gpu15 -->
<g id="node657" class="node">
<title>layer_14_mlp_fc2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5249.5,-1884.91 5150.5,-1884.91 5150.5,-1832.91 5249.5,-1832.91 5249.5,-1884.91"/>
<text text-anchor="middle" x="5200" y="-1872.91" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="5200" y="-1861.91" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="5200" y="-1850.91" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="5200" y="-1839.91" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu15 -->
<g id="edge889" class="edge">
<title>layer_14_gelu&#45;&gt;layer_14_mlp_fc2_gpu15</title>
<path fill="none" stroke="black" d="M5268.47,-1920.6C5258.93,-1912.14 5247.13,-1901.69 5236.03,-1891.85"/>
<polygon fill="black" stroke="black" points="5238.3,-1889.18 5228.5,-1885.17 5233.66,-1894.42 5238.3,-1889.18"/>
</g>
<!-- layer_14_mlp_fc2_gpu8 -->
<g id="node650" class="node">
<title>layer_14_mlp_fc2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="5366.5,-1884.91 5267.5,-1884.91 5267.5,-1832.91 5366.5,-1832.91 5366.5,-1884.91"/>
<text text-anchor="middle" x="5317" y="-1872.91" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="5317" y="-1861.91" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="5317" y="-1850.91" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="5317" y="-1839.91" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_allreduce_mlp -->
<g id="node658" class="node">
<title>layer_14_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="5668" cy="-1767.92" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="5668" y="-1776.42" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="5668" y="-1765.42" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="5668" y="-1754.42" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_14_mlp_fc2_gpu8&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge890" class="edge">
<title>layer_14_mlp_fc2_gpu8&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5366.65,-1836.11C5369.79,-1834.97 5372.93,-1833.89 5376,-1832.91 5451.85,-1808.76 5541.62,-1790.58 5601.41,-1779.88"/>
<polygon fill="black" stroke="black" points="5602.24,-1783.29 5611.48,-1778.1 5601.03,-1776.4 5602.24,-1783.29"/>
</g>
<!-- layer_14_mlp_fc2_gpu9 -->
<g id="node651" class="node">
<title>layer_14_mlp_fc2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="5483.5,-1884.91 5384.5,-1884.91 5384.5,-1832.91 5483.5,-1832.91 5483.5,-1884.91"/>
<text text-anchor="middle" x="5434" y="-1872.91" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="5434" y="-1861.91" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="5434" y="-1850.91" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="5434" y="-1839.91" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_mlp_fc2_gpu9&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge891" class="edge">
<title>layer_14_mlp_fc2_gpu9&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5483.5,-1836.73C5486.71,-1835.42 5489.9,-1834.14 5493,-1832.91 5531.89,-1817.57 5576.12,-1801.41 5610.38,-1789.17"/>
<polygon fill="black" stroke="black" points="5611.98,-1792.32 5620.22,-1785.66 5609.63,-1785.72 5611.98,-1792.32"/>
</g>
<!-- layer_14_mlp_fc2_gpu10 -->
<g id="node652" class="node">
<title>layer_14_mlp_fc2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="5600.5,-1884.91 5501.5,-1884.91 5501.5,-1832.91 5600.5,-1832.91 5600.5,-1884.91"/>
<text text-anchor="middle" x="5551" y="-1872.91" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="5551" y="-1861.91" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="5551" y="-1850.91" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="5551" y="-1839.91" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_mlp_fc2_gpu10&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge892" class="edge">
<title>layer_14_mlp_fc2_gpu10&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5583.9,-1832.89C5597.69,-1822.4 5613.84,-1810.12 5628.28,-1799.14"/>
<polygon fill="black" stroke="black" points="5630.71,-1801.68 5636.55,-1792.84 5626.47,-1796.11 5630.71,-1801.68"/>
</g>
<!-- layer_14_mlp_fc2_gpu11 -->
<g id="node653" class="node">
<title>layer_14_mlp_fc2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="5717.5,-1884.91 5618.5,-1884.91 5618.5,-1832.91 5717.5,-1832.91 5717.5,-1884.91"/>
<text text-anchor="middle" x="5668" y="-1872.91" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="5668" y="-1861.91" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="5668" y="-1850.91" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="5668" y="-1839.91" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_mlp_fc2_gpu11&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge893" class="edge">
<title>layer_14_mlp_fc2_gpu11&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5668,-1832.65C5668,-1824.76 5668,-1815.87 5668,-1807.29"/>
<polygon fill="black" stroke="black" points="5671.5,-1807.06 5668,-1797.06 5664.5,-1807.06 5671.5,-1807.06"/>
</g>
<!-- layer_14_mlp_fc2_gpu12 -->
<g id="node654" class="node">
<title>layer_14_mlp_fc2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="5834.5,-1884.91 5735.5,-1884.91 5735.5,-1832.91 5834.5,-1832.91 5834.5,-1884.91"/>
<text text-anchor="middle" x="5785" y="-1872.91" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="5785" y="-1861.91" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="5785" y="-1850.91" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="5785" y="-1839.91" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_mlp_fc2_gpu12&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge894" class="edge">
<title>layer_14_mlp_fc2_gpu12&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5752.1,-1832.89C5738.31,-1822.4 5722.16,-1810.12 5707.72,-1799.14"/>
<polygon fill="black" stroke="black" points="5709.53,-1796.11 5699.45,-1792.84 5705.29,-1801.68 5709.53,-1796.11"/>
</g>
<!-- layer_14_mlp_fc2_gpu13 -->
<g id="node655" class="node">
<title>layer_14_mlp_fc2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="5951.5,-1884.91 5852.5,-1884.91 5852.5,-1832.91 5951.5,-1832.91 5951.5,-1884.91"/>
<text text-anchor="middle" x="5902" y="-1872.91" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="5902" y="-1861.91" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="5902" y="-1850.91" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="5902" y="-1839.91" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_mlp_fc2_gpu13&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge895" class="edge">
<title>layer_14_mlp_fc2_gpu13&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5852.41,-1836.31C5849.57,-1835.15 5846.75,-1834.01 5844,-1832.91 5804.78,-1817.35 5760.08,-1801.11 5725.55,-1788.89"/>
<polygon fill="black" stroke="black" points="5726.69,-1785.58 5716.09,-1785.56 5724.36,-1792.18 5726.69,-1785.58"/>
</g>
<!-- layer_14_mlp_fc2_gpu14 -->
<g id="node656" class="node">
<title>layer_14_mlp_fc2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="6068.5,-1884.91 5969.5,-1884.91 5969.5,-1832.91 6068.5,-1832.91 6068.5,-1884.91"/>
<text text-anchor="middle" x="6019" y="-1872.91" font-family="Arial" font-size="10.00">Layer 14 MLP FC2</text>
<text text-anchor="middle" x="6019" y="-1861.91" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="6019" y="-1850.91" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="6019" y="-1839.91" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_14_mlp_fc2_gpu14&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge896" class="edge">
<title>layer_14_mlp_fc2_gpu14&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5969.25,-1835.75C5966.48,-1834.74 5963.71,-1833.79 5961,-1832.91 5884.85,-1808.44 5794.59,-1790.3 5734.57,-1779.7"/>
<polygon fill="black" stroke="black" points="5734.92,-1776.21 5724.47,-1777.93 5733.72,-1783.1 5734.92,-1776.21"/>
</g>
<!-- layer_14_mlp_fc2_gpu15&#45;&gt;layer_14_allreduce_mlp -->
<g id="edge897" class="edge">
<title>layer_14_mlp_fc2_gpu15&#45;&gt;layer_14_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5249.58,-1835.89C5252.74,-1834.8 5255.9,-1833.8 5259,-1832.91 5375.77,-1799.59 5516.55,-1782.38 5598.8,-1774.53"/>
<polygon fill="black" stroke="black" points="5599.14,-1778.01 5608.77,-1773.59 5598.49,-1771.04 5599.14,-1778.01"/>
</g>
<!-- layer_14_allreduce_mlp&#45;&gt;layer_14_residual2 -->
<g id="edge898" class="edge">
<title>layer_14_allreduce_mlp&#45;&gt;layer_14_residual2</title>
<path fill="none" stroke="black" d="M5711.82,-1747.88C5743.93,-1733.93 5787.85,-1714.84 5823.03,-1699.55"/>
<polygon fill="black" stroke="black" points="5824.47,-1702.75 5832.24,-1695.55 5821.68,-1696.33 5824.47,-1702.75"/>
</g>
<!-- layer_14_ln2 -->
<g id="node660" class="node">
<title>layer_14_ln2</title>
<polygon fill="lightblue" stroke="black" points="5918.5,-1606.93 5845.5,-1606.93 5845.5,-1565.93 5918.5,-1565.93 5918.5,-1606.93"/>
<text text-anchor="middle" x="5882" y="-1594.93" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="5882" y="-1583.93" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="5882" y="-1572.93" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_14_residual2&#45;&gt;layer_14_ln2 -->
<g id="edge900" class="edge">
<title>layer_14_residual2&#45;&gt;layer_14_ln2</title>
<path fill="none" stroke="black" d="M5882,-1642.85C5882,-1634.53 5882,-1625.44 5882,-1617.09"/>
<polygon fill="black" stroke="black" points="5885.5,-1617 5882,-1607 5878.5,-1617 5885.5,-1617"/>
</g>
<!-- layer_14_output_dist -->
<g id="node661" class="node">
<title>layer_14_output_dist</title>
<polygon fill="lightyellow" stroke="black" points="5983.7,-1529.93 5821.92,-1529.93 5780.3,-1469.93 5942.08,-1469.93 5983.7,-1529.93"/>
<text text-anchor="middle" x="5882" y="-1502.93" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="5882" y="-1491.93" font-family="Arial" font-size="10.00">Output Distribution</text>
</g>
<!-- layer_14_ln2&#45;&gt;layer_14_output_dist -->
<g id="edge901" class="edge">
<title>layer_14_ln2&#45;&gt;layer_14_output_dist</title>
<path fill="none" stroke="black" d="M5882,-1565.83C5882,-1558.19 5882,-1549.15 5882,-1540.28"/>
<polygon fill="black" stroke="black" points="5885.5,-1540.04 5882,-1530.04 5878.5,-1540.04 5885.5,-1540.04"/>
</g>
<!-- layer_15_input_dist -->
<g id="node662" class="node">
<title>layer_15_input_dist</title>
<polygon fill="lightyellow" stroke="black" points="5976.19,-1433.93 5826.36,-1433.93 5787.81,-1373.93 5937.64,-1373.93 5976.19,-1433.93"/>
<text text-anchor="middle" x="5882" y="-1406.93" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="5882" y="-1395.93" font-family="Arial" font-size="10.00">Input Distribution</text>
</g>
<!-- layer_14_output_dist&#45;&gt;layer_15_input_dist -->
<g id="edge902" class="edge">
<title>layer_14_output_dist&#45;&gt;layer_15_input_dist</title>
<path fill="none" stroke="black" d="M5882,-1469.7C5882,-1461.66 5882,-1452.8 5882,-1444.28"/>
<polygon fill="black" stroke="black" points="5885.5,-1444.14 5882,-1434.14 5878.5,-1444.14 5885.5,-1444.14"/>
</g>
<!-- layer_15_qkv_gpu8 -->
<g id="node663" class="node">
<title>layer_15_qkv_gpu8</title>
<polygon fill="lightblue" stroke="black" points="5467,-1337.93 5369,-1337.93 5369,-1285.93 5467,-1285.93 5467,-1337.93"/>
<text text-anchor="middle" x="5418" y="-1325.93" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="5418" y="-1314.93" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="5418" y="-1303.93" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="5418" y="-1292.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu8 -->
<g id="edge903" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu8</title>
<path fill="none" stroke="black" d="M5801.74,-1396.01C5721.17,-1387.73 5593.73,-1371 5476.88,-1337.89"/>
<polygon fill="black" stroke="black" points="5477.63,-1334.47 5467.05,-1335.06 5475.69,-1341.19 5477.63,-1334.47"/>
</g>
<!-- layer_15_qkv_gpu9 -->
<g id="node664" class="node">
<title>layer_15_qkv_gpu9</title>
<polygon fill="lightblue" stroke="black" points="5583,-1337.93 5485,-1337.93 5485,-1285.93 5583,-1285.93 5583,-1337.93"/>
<text text-anchor="middle" x="5534" y="-1325.93" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="5534" y="-1314.93" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="5534" y="-1303.93" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="5534" y="-1292.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu9 -->
<g id="edge904" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu9</title>
<path fill="none" stroke="black" d="M5796.81,-1388.18C5740.93,-1377.49 5666.34,-1361.33 5592.99,-1338.03"/>
<polygon fill="black" stroke="black" points="5593.71,-1334.58 5583.12,-1334.84 5591.56,-1341.24 5593.71,-1334.58"/>
</g>
<!-- layer_15_qkv_gpu10 -->
<g id="node665" class="node">
<title>layer_15_qkv_gpu10</title>
<polygon fill="lightblue" stroke="black" points="5699,-1337.93 5601,-1337.93 5601,-1285.93 5699,-1285.93 5699,-1337.93"/>
<text text-anchor="middle" x="5650" y="-1325.93" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="5650" y="-1314.93" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="5650" y="-1303.93" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="5650" y="-1292.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu10 -->
<g id="edge905" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu10</title>
<path fill="none" stroke="black" d="M5801.55,-1373.82C5774.43,-1363.78 5743.86,-1352.22 5708.8,-1338.19"/>
<polygon fill="black" stroke="black" points="5709.88,-1334.85 5699.29,-1334.37 5707.27,-1341.35 5709.88,-1334.85"/>
</g>
<!-- layer_15_qkv_gpu11 -->
<g id="node666" class="node">
<title>layer_15_qkv_gpu11</title>
<polygon fill="lightblue" stroke="black" points="5815,-1337.93 5717,-1337.93 5717,-1285.93 5815,-1285.93 5815,-1337.93"/>
<text text-anchor="middle" x="5766" y="-1325.93" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="5766" y="-1314.93" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="5766" y="-1303.93" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="5766" y="-1292.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu11 -->
<g id="edge906" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu11</title>
<path fill="none" stroke="black" d="M5844.34,-1373.71C5832.18,-1364.28 5818.66,-1353.79 5806.32,-1344.21"/>
<polygon fill="black" stroke="black" points="5808.46,-1341.44 5798.41,-1338.08 5804.16,-1346.97 5808.46,-1341.44"/>
</g>
<!-- layer_15_qkv_gpu12 -->
<g id="node667" class="node">
<title>layer_15_qkv_gpu12</title>
<polygon fill="lightblue" stroke="black" points="5931,-1337.93 5833,-1337.93 5833,-1285.93 5931,-1285.93 5931,-1337.93"/>
<text text-anchor="middle" x="5882" y="-1325.93" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="5882" y="-1314.93" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="5882" y="-1303.93" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="5882" y="-1292.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu12 -->
<g id="edge907" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu12</title>
<path fill="none" stroke="black" d="M5882,-1373.46C5882,-1365.39 5882,-1356.55 5882,-1348.19"/>
<polygon fill="black" stroke="black" points="5885.5,-1347.94 5882,-1337.94 5878.5,-1347.94 5885.5,-1347.94"/>
</g>
<!-- layer_15_qkv_gpu13 -->
<g id="node668" class="node">
<title>layer_15_qkv_gpu13</title>
<polygon fill="lightblue" stroke="black" points="6047,-1337.93 5949,-1337.93 5949,-1285.93 6047,-1285.93 6047,-1337.93"/>
<text text-anchor="middle" x="5998" y="-1325.93" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="5998" y="-1314.93" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="5998" y="-1303.93" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="5998" y="-1292.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu13 -->
<g id="edge908" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu13</title>
<path fill="none" stroke="black" d="M5919.66,-1373.71C5931.82,-1364.28 5945.34,-1353.79 5957.68,-1344.21"/>
<polygon fill="black" stroke="black" points="5959.84,-1346.97 5965.59,-1338.08 5955.54,-1341.44 5959.84,-1346.97"/>
</g>
<!-- layer_15_qkv_gpu14 -->
<g id="node669" class="node">
<title>layer_15_qkv_gpu14</title>
<polygon fill="lightblue" stroke="black" points="6163,-1337.93 6065,-1337.93 6065,-1285.93 6163,-1285.93 6163,-1337.93"/>
<text text-anchor="middle" x="6114" y="-1325.93" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="6114" y="-1314.93" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="6114" y="-1303.93" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="6114" y="-1292.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu14 -->
<g id="edge909" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu14</title>
<path fill="none" stroke="black" d="M5942.68,-1381.1C5973.94,-1369.66 6012.85,-1355.12 6055.31,-1338.15"/>
<polygon fill="black" stroke="black" points="6056.73,-1341.35 6064.71,-1334.37 6054.12,-1334.85 6056.73,-1341.35"/>
</g>
<!-- layer_15_qkv_gpu15 -->
<g id="node670" class="node">
<title>layer_15_qkv_gpu15</title>
<polygon fill="lightblue" stroke="black" points="6279,-1337.93 6181,-1337.93 6181,-1285.93 6279,-1285.93 6279,-1337.93"/>
<text text-anchor="middle" x="6230" y="-1325.93" font-family="Arial" font-size="10.00">Layer 15 QKV Proj</text>
<text text-anchor="middle" x="6230" y="-1314.93" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="6230" y="-1303.93" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="6230" y="-1292.93" font-family="Arial" font-size="10.00">[4096→12288]</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_qkv_gpu15 -->
<g id="edge910" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_qkv_gpu15</title>
<path fill="none" stroke="black" d="M5949.18,-1391.56C6006.25,-1381.06 6090.28,-1363.64 6171.05,-1338.01"/>
<polygon fill="black" stroke="black" points="6172.43,-1341.24 6180.88,-1334.84 6170.29,-1334.58 6172.43,-1341.24"/>
</g>
<!-- layer_15_residual1 -->
<g id="node682" class="node">
<title>layer_15_residual1</title>
<polygon fill="lightyellow" stroke="black" points="6257.94,-885.97 6135.55,-885.97 6104.06,-825.97 6226.45,-825.97 6257.94,-885.97"/>
<text text-anchor="middle" x="6181" y="-858.97" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="6181" y="-847.97" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_15_input_dist&#45;&gt;layer_15_residual1 -->
<g id="edge930" class="edge">
<title>layer_15_input_dist&#45;&gt;layer_15_residual1</title>
<path fill="none" stroke="black" d="M5952.91,-1397.57C6053.62,-1388.96 6232.06,-1369.7 6288,-1337.93 6346.43,-1304.74 6385,-1289.14 6385,-1221.94 6385,-1221.94 6385,-1221.94 6385,-1040.95 6385,-971 6318.05,-920.82 6260.86,-890.71"/>
<polygon fill="black" stroke="black" points="6262.27,-887.5 6251.78,-886.05 6259.08,-893.73 6262.27,-887.5"/>
</g>
<!-- layer_15_allgather_qkv -->
<g id="node671" class="node">
<title>layer_15_allgather_qkv</title>
<ellipse fill="orange" stroke="black" cx="5766" cy="-1220.94" rx="57.05" ry="28.98"/>
<text text-anchor="middle" x="5766" y="-1229.44" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="5766" y="-1218.44" font-family="Arial" font-size="10.00">AllGather QKV</text>
<text text-anchor="middle" x="5766" y="-1207.44" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_15_qkv_gpu8&#45;&gt;layer_15_allgather_qkv -->
<g id="edge911" class="edge">
<title>layer_15_qkv_gpu8&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M5467.12,-1289.01C5470.1,-1287.91 5473.08,-1286.87 5476,-1285.93 5552.19,-1261.35 5642.64,-1243.05 5702.02,-1232.45"/>
<polygon fill="black" stroke="black" points="5702.77,-1235.87 5712.01,-1230.69 5701.55,-1228.98 5702.77,-1235.87"/>
</g>
<!-- layer_15_qkv_gpu9&#45;&gt;layer_15_allgather_qkv -->
<g id="edge912" class="edge">
<title>layer_15_qkv_gpu9&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M5583.28,-1289.47C5586.23,-1288.26 5589.15,-1287.07 5592,-1285.93 5631.04,-1270.35 5675.54,-1254.01 5709.76,-1241.74"/>
<polygon fill="black" stroke="black" points="5711.34,-1244.9 5719.58,-1238.23 5708.98,-1238.3 5711.34,-1244.9"/>
</g>
<!-- layer_15_qkv_gpu10&#45;&gt;layer_15_allgather_qkv -->
<g id="edge913" class="edge">
<title>layer_15_qkv_gpu10&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M5682.62,-1285.91C5696.4,-1275.33 5712.56,-1262.94 5726.97,-1251.88"/>
<polygon fill="black" stroke="black" points="5729.41,-1254.42 5735.22,-1245.55 5725.15,-1248.86 5729.41,-1254.42"/>
</g>
<!-- layer_15_qkv_gpu11&#45;&gt;layer_15_allgather_qkv -->
<g id="edge914" class="edge">
<title>layer_15_qkv_gpu11&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M5766,-1285.67C5766,-1277.78 5766,-1268.89 5766,-1260.31"/>
<polygon fill="black" stroke="black" points="5769.5,-1260.08 5766,-1250.08 5762.5,-1260.08 5769.5,-1260.08"/>
</g>
<!-- layer_15_qkv_gpu12&#45;&gt;layer_15_allgather_qkv -->
<g id="edge915" class="edge">
<title>layer_15_qkv_gpu12&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M5849.38,-1285.91C5835.6,-1275.33 5819.44,-1262.94 5805.03,-1251.88"/>
<polygon fill="black" stroke="black" points="5806.85,-1248.86 5796.78,-1245.55 5802.59,-1254.42 5806.85,-1248.86"/>
</g>
<!-- layer_15_qkv_gpu13&#45;&gt;layer_15_allgather_qkv -->
<g id="edge916" class="edge">
<title>layer_15_qkv_gpu13&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M5948.72,-1289.47C5945.77,-1288.26 5942.85,-1287.07 5940,-1285.93 5900.96,-1270.35 5856.46,-1254.01 5822.24,-1241.74"/>
<polygon fill="black" stroke="black" points="5823.02,-1238.3 5812.42,-1238.23 5820.66,-1244.9 5823.02,-1238.3"/>
</g>
<!-- layer_15_qkv_gpu14&#45;&gt;layer_15_allgather_qkv -->
<g id="edge917" class="edge">
<title>layer_15_qkv_gpu14&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M6064.88,-1289.01C6061.9,-1287.91 6058.92,-1286.87 6056,-1285.93 5979.81,-1261.35 5889.36,-1243.05 5829.98,-1232.45"/>
<polygon fill="black" stroke="black" points="5830.45,-1228.98 5819.99,-1230.69 5829.23,-1235.87 5830.45,-1228.98"/>
</g>
<!-- layer_15_qkv_gpu15&#45;&gt;layer_15_allgather_qkv -->
<g id="edge918" class="edge">
<title>layer_15_qkv_gpu15&#45;&gt;layer_15_allgather_qkv</title>
<path fill="none" stroke="black" d="M6180.95,-1288.79C6177.95,-1287.75 6174.95,-1286.78 6172,-1285.93 6055.16,-1252.12 5913.91,-1234.97 5832.56,-1227.28"/>
<polygon fill="black" stroke="black" points="5832.74,-1223.78 5822.46,-1226.34 5832.09,-1230.75 5832.74,-1223.78"/>
</g>
<!-- layer_15_attention -->
<g id="node672" class="node">
<title>layer_15_attention</title>
<polygon fill="lightblue" stroke="black" points="5645,-1155.95 5577,-1155.95 5577,-1103.95 5645,-1103.95 5645,-1155.95"/>
<text text-anchor="middle" x="5611" y="-1143.95" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="5611" y="-1132.95" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="5611" y="-1121.95" font-family="Arial" font-size="10.00">32×128 dim</text>
<text text-anchor="middle" x="5611" y="-1110.95" font-family="Arial" font-size="10.00">Softmax</text>
</g>
<!-- layer_15_allgather_qkv&#45;&gt;layer_15_attention -->
<g id="edge919" class="edge">
<title>layer_15_allgather_qkv&#45;&gt;layer_15_attention</title>
<path fill="none" stroke="black" d="M5728.87,-1198.62C5706.32,-1185.67 5677.44,-1169.09 5653.91,-1155.58"/>
<polygon fill="black" stroke="black" points="5655.59,-1152.51 5645.17,-1150.57 5652.1,-1158.58 5655.59,-1152.51"/>
</g>
<!-- layer_15_attn_out_gpu15 -->
<g id="node680" class="node">
<title>layer_15_attn_out_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5579.5,-1067.95 5486.5,-1067.95 5486.5,-1015.95 5579.5,-1015.95 5579.5,-1067.95"/>
<text text-anchor="middle" x="5533" y="-1055.95" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="5533" y="-1044.95" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="5533" y="-1033.95" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="5533" y="-1022.95" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attention&#45;&gt;layer_15_attn_out_gpu15 -->
<g id="edge920" class="edge">
<title>layer_15_attention&#45;&gt;layer_15_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M5588.02,-1103.61C5580.09,-1094.86 5571.08,-1084.93 5562.69,-1075.68"/>
<polygon fill="black" stroke="black" points="5565.13,-1073.16 5555.82,-1068.1 5559.94,-1077.86 5565.13,-1073.16"/>
</g>
<!-- layer_15_attn_out_gpu8 -->
<g id="node673" class="node">
<title>layer_15_attn_out_gpu8</title>
<polygon fill="lightblue" stroke="black" points="5690.5,-1067.95 5597.5,-1067.95 5597.5,-1015.95 5690.5,-1015.95 5690.5,-1067.95"/>
<text text-anchor="middle" x="5644" y="-1055.95" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="5644" y="-1044.95" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="5644" y="-1033.95" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="5644" y="-1022.95" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_allreduce_attn -->
<g id="node681" class="node">
<title>layer_15_allreduce_attn</title>
<ellipse fill="orange" stroke="black" cx="5977" cy="-950.96" rx="57.97" ry="28.98"/>
<text text-anchor="middle" x="5977" y="-959.46" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="5977" y="-948.46" font-family="Arial" font-size="10.00">AllReduce Attn</text>
<text text-anchor="middle" x="5977" y="-937.46" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_15_attn_out_gpu8&#45;&gt;layer_15_allreduce_attn -->
<g id="edge921" class="edge">
<title>layer_15_attn_out_gpu8&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M5690.79,-1019.27C5693.88,-1018.08 5696.97,-1016.96 5700,-1015.95 5771.41,-992.01 5856.1,-973.87 5912.87,-963.13"/>
<polygon fill="black" stroke="black" points="5913.6,-966.55 5922.79,-961.27 5912.32,-959.67 5913.6,-966.55"/>
</g>
<!-- layer_15_attn_out_gpu9 -->
<g id="node674" class="node">
<title>layer_15_attn_out_gpu9</title>
<polygon fill="lightblue" stroke="black" points="5801.5,-1067.95 5708.5,-1067.95 5708.5,-1015.95 5801.5,-1015.95 5801.5,-1067.95"/>
<text text-anchor="middle" x="5755" y="-1055.95" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="5755" y="-1044.95" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="5755" y="-1033.95" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="5755" y="-1022.95" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attn_out_gpu9&#45;&gt;layer_15_allreduce_attn -->
<g id="edge922" class="edge">
<title>layer_15_attn_out_gpu9&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M5801.67,-1019.89C5804.82,-1018.54 5807.95,-1017.22 5811,-1015.95 5847.57,-1000.75 5889.16,-984.72 5921.56,-972.51"/>
<polygon fill="black" stroke="black" points="5923.17,-975.64 5931.3,-968.84 5920.71,-969.09 5923.17,-975.64"/>
</g>
<!-- layer_15_attn_out_gpu10 -->
<g id="node675" class="node">
<title>layer_15_attn_out_gpu10</title>
<polygon fill="lightblue" stroke="black" points="5912.5,-1067.95 5819.5,-1067.95 5819.5,-1015.95 5912.5,-1015.95 5912.5,-1067.95"/>
<text text-anchor="middle" x="5866" y="-1055.95" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="5866" y="-1044.95" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="5866" y="-1033.95" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="5866" y="-1022.95" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attn_out_gpu10&#45;&gt;layer_15_allreduce_attn -->
<g id="edge923" class="edge">
<title>layer_15_attn_out_gpu10&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M5897.22,-1015.92C5910.29,-1005.44 5925.61,-993.15 5939.31,-982.17"/>
<polygon fill="black" stroke="black" points="5941.55,-984.86 5947.17,-975.88 5937.17,-979.4 5941.55,-984.86"/>
</g>
<!-- layer_15_attn_out_gpu11 -->
<g id="node676" class="node">
<title>layer_15_attn_out_gpu11</title>
<polygon fill="lightblue" stroke="black" points="6023.5,-1067.95 5930.5,-1067.95 5930.5,-1015.95 6023.5,-1015.95 6023.5,-1067.95"/>
<text text-anchor="middle" x="5977" y="-1055.95" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="5977" y="-1044.95" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="5977" y="-1033.95" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="5977" y="-1022.95" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attn_out_gpu11&#45;&gt;layer_15_allreduce_attn -->
<g id="edge924" class="edge">
<title>layer_15_attn_out_gpu11&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M5977,-1015.68C5977,-1007.79 5977,-998.9 5977,-990.32"/>
<polygon fill="black" stroke="black" points="5980.5,-990.1 5977,-980.1 5973.5,-990.1 5980.5,-990.1"/>
</g>
<!-- layer_15_attn_out_gpu12 -->
<g id="node677" class="node">
<title>layer_15_attn_out_gpu12</title>
<polygon fill="lightblue" stroke="black" points="6134.5,-1067.95 6041.5,-1067.95 6041.5,-1015.95 6134.5,-1015.95 6134.5,-1067.95"/>
<text text-anchor="middle" x="6088" y="-1055.95" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="6088" y="-1044.95" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="6088" y="-1033.95" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="6088" y="-1022.95" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attn_out_gpu12&#45;&gt;layer_15_allreduce_attn -->
<g id="edge925" class="edge">
<title>layer_15_attn_out_gpu12&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M6056.78,-1015.92C6043.71,-1005.44 6028.39,-993.15 6014.69,-982.17"/>
<polygon fill="black" stroke="black" points="6016.83,-979.4 6006.83,-975.88 6012.45,-984.86 6016.83,-979.4"/>
</g>
<!-- layer_15_attn_out_gpu13 -->
<g id="node678" class="node">
<title>layer_15_attn_out_gpu13</title>
<polygon fill="lightblue" stroke="black" points="6245.5,-1067.95 6152.5,-1067.95 6152.5,-1015.95 6245.5,-1015.95 6245.5,-1067.95"/>
<text text-anchor="middle" x="6199" y="-1055.95" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="6199" y="-1044.95" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="6199" y="-1033.95" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="6199" y="-1022.95" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attn_out_gpu13&#45;&gt;layer_15_allreduce_attn -->
<g id="edge926" class="edge">
<title>layer_15_attn_out_gpu13&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M6152.28,-1019.48C6149.48,-1018.27 6146.71,-1017.08 6144,-1015.95 6107.11,-1000.51 6065.07,-984.41 6032.4,-972.22"/>
<polygon fill="black" stroke="black" points="6033.61,-968.94 6023.02,-968.73 6031.17,-975.5 6033.61,-968.94"/>
</g>
<!-- layer_15_attn_out_gpu14 -->
<g id="node679" class="node">
<title>layer_15_attn_out_gpu14</title>
<polygon fill="lightblue" stroke="black" points="6356.5,-1067.95 6263.5,-1067.95 6263.5,-1015.95 6356.5,-1015.95 6356.5,-1067.95"/>
<text text-anchor="middle" x="6310" y="-1055.95" font-family="Arial" font-size="10.00">Layer 15 Attn Out</text>
<text text-anchor="middle" x="6310" y="-1044.95" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="6310" y="-1033.95" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="6310" y="-1022.95" font-family="Arial" font-size="10.00">[4096→4096]</text>
</g>
<!-- layer_15_attn_out_gpu14&#45;&gt;layer_15_allreduce_attn -->
<g id="edge927" class="edge">
<title>layer_15_attn_out_gpu14&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M6263.45,-1019.02C6260.61,-1017.92 6257.78,-1016.89 6255,-1015.95 6183.42,-991.72 6098.4,-973.64 6041.4,-962.98"/>
<polygon fill="black" stroke="black" points="6041.91,-959.52 6031.44,-961.15 6040.64,-966.4 6041.91,-959.52"/>
</g>
<!-- layer_15_attn_out_gpu15&#45;&gt;layer_15_allreduce_attn -->
<g id="edge928" class="edge">
<title>layer_15_attn_out_gpu15&#45;&gt;layer_15_allreduce_attn</title>
<path fill="none" stroke="black" d="M5579.72,-1019.05C5582.83,-1017.91 5585.94,-1016.87 5589,-1015.95 5698.82,-982.98 5831.56,-965.72 5909.86,-957.76"/>
<polygon fill="black" stroke="black" points="5910.47,-961.21 5920.07,-956.74 5909.77,-954.25 5910.47,-961.21"/>
</g>
<!-- layer_15_allreduce_attn&#45;&gt;layer_15_residual1 -->
<g id="edge929" class="edge">
<title>layer_15_allreduce_attn&#45;&gt;layer_15_residual1</title>
<path fill="none" stroke="black" d="M6019.27,-930.69C6049.12,-917.08 6089.5,-898.67 6122.45,-883.66"/>
<polygon fill="black" stroke="black" points="6124.32,-886.65 6131.97,-879.32 6121.42,-880.28 6124.32,-886.65"/>
</g>
<!-- layer_15_ln1 -->
<g id="node683" class="node">
<title>layer_15_ln1</title>
<polygon fill="lightblue" stroke="black" points="5827.5,-789.97 5754.5,-789.97 5754.5,-748.97 5827.5,-748.97 5827.5,-789.97"/>
<text text-anchor="middle" x="5791" y="-777.97" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="5791" y="-766.97" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="5791" y="-755.97" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_15_residual1&#45;&gt;layer_15_ln1 -->
<g id="edge931" class="edge">
<title>layer_15_residual1&#45;&gt;layer_15_ln1</title>
<path fill="none" stroke="black" d="M6111.28,-839.86C6032.19,-822.72 5905.42,-795.26 5837.52,-780.54"/>
<polygon fill="black" stroke="black" points="5838.06,-777.08 5827.54,-778.38 5836.57,-783.92 5838.06,-777.08"/>
</g>
<!-- layer_15_residual2 -->
<g id="node703" class="node">
<title>layer_15_residual2</title>
<polygon fill="lightyellow" stroke="black" points="6169.94,-277 6047.55,-277 6016.06,-217 6138.45,-217 6169.94,-277"/>
<text text-anchor="middle" x="6093" y="-250" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="6093" y="-239" font-family="Arial" font-size="10.00">Residual Add</text>
</g>
<!-- layer_15_residual1&#45;&gt;layer_15_residual2 -->
<g id="edge959" class="edge">
<title>layer_15_residual1&#45;&gt;layer_15_residual2</title>
<path fill="none" stroke="black" d="M6222.23,-825.87C6259.32,-795.96 6308,-745.7 6308,-687.97 6308,-687.97 6308,-687.97 6308,-431.98 6308,-360.6 6238.75,-310.98 6178.85,-281.42"/>
<polygon fill="black" stroke="black" points="6180.24,-278.2 6169.71,-277.02 6177.2,-284.51 6180.24,-278.2"/>
</g>
<!-- layer_15_mlp_fc1_gpu8 -->
<g id="node684" class="node">
<title>layer_15_mlp_fc1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="5372.5,-712.97 5273.5,-712.97 5273.5,-660.97 5372.5,-660.97 5372.5,-712.97"/>
<text text-anchor="middle" x="5323" y="-700.97" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="5323" y="-689.97" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="5323" y="-678.97" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="5323" y="-667.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu8 -->
<g id="edge932" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu8</title>
<path fill="none" stroke="black" d="M5754.24,-766.75C5683.44,-762.75 5523.46,-750.33 5382.26,-712.7"/>
<polygon fill="black" stroke="black" points="5383.13,-709.3 5372.56,-710.06 5381.29,-716.06 5383.13,-709.3"/>
</g>
<!-- layer_15_mlp_fc1_gpu9 -->
<g id="node685" class="node">
<title>layer_15_mlp_fc1_gpu9</title>
<polygon fill="lightblue" stroke="black" points="5489.5,-712.97 5390.5,-712.97 5390.5,-660.97 5489.5,-660.97 5489.5,-712.97"/>
<text text-anchor="middle" x="5440" y="-700.97" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="5440" y="-689.97" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="5440" y="-678.97" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="5440" y="-667.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu9 -->
<g id="edge933" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu9</title>
<path fill="none" stroke="black" d="M5754.44,-764.06C5700.35,-757 5595.89,-741.27 5499.24,-712.76"/>
<polygon fill="black" stroke="black" points="5500.2,-709.39 5489.62,-709.87 5498.19,-716.1 5500.2,-709.39"/>
</g>
<!-- layer_15_mlp_fc1_gpu10 -->
<g id="node686" class="node">
<title>layer_15_mlp_fc1_gpu10</title>
<polygon fill="lightblue" stroke="black" points="5606.5,-712.97 5507.5,-712.97 5507.5,-660.97 5606.5,-660.97 5606.5,-712.97"/>
<text text-anchor="middle" x="5557" y="-700.97" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="5557" y="-689.97" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="5557" y="-678.97" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="5557" y="-667.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu10 -->
<g id="edge934" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu10</title>
<path fill="none" stroke="black" d="M5754.47,-757.97C5720.85,-748.07 5669.47,-732.33 5616.35,-712.97"/>
<polygon fill="black" stroke="black" points="5617.36,-709.61 5606.76,-709.44 5614.94,-716.18 5617.36,-709.61"/>
</g>
<!-- layer_15_mlp_fc1_gpu11 -->
<g id="node687" class="node">
<title>layer_15_mlp_fc1_gpu11</title>
<polygon fill="lightblue" stroke="black" points="5723.5,-712.97 5624.5,-712.97 5624.5,-660.97 5723.5,-660.97 5723.5,-712.97"/>
<text text-anchor="middle" x="5674" y="-700.97" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="5674" y="-689.97" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="5674" y="-678.97" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="5674" y="-667.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu11 -->
<g id="edge935" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu11</title>
<path fill="none" stroke="black" d="M5762.38,-748.77C5749.37,-739.82 5733.67,-729.02 5719.13,-719.02"/>
<polygon fill="black" stroke="black" points="5720.96,-716.03 5710.74,-713.24 5716.99,-721.79 5720.96,-716.03"/>
</g>
<!-- layer_15_mlp_fc1_gpu12 -->
<g id="node688" class="node">
<title>layer_15_mlp_fc1_gpu12</title>
<polygon fill="lightblue" stroke="black" points="5840.5,-712.97 5741.5,-712.97 5741.5,-660.97 5840.5,-660.97 5840.5,-712.97"/>
<text text-anchor="middle" x="5791" y="-700.97" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="5791" y="-689.97" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="5791" y="-678.97" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="5791" y="-667.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu12 -->
<g id="edge936" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu12</title>
<path fill="none" stroke="black" d="M5791,-748.57C5791,-740.95 5791,-732.02 5791,-723.39"/>
<polygon fill="black" stroke="black" points="5794.5,-723.12 5791,-713.12 5787.5,-723.12 5794.5,-723.12"/>
</g>
<!-- layer_15_mlp_fc1_gpu13 -->
<g id="node689" class="node">
<title>layer_15_mlp_fc1_gpu13</title>
<polygon fill="lightblue" stroke="black" points="5957.5,-712.97 5858.5,-712.97 5858.5,-660.97 5957.5,-660.97 5957.5,-712.97"/>
<text text-anchor="middle" x="5908" y="-700.97" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="5908" y="-689.97" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="5908" y="-678.97" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="5908" y="-667.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu13 -->
<g id="edge937" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu13</title>
<path fill="none" stroke="black" d="M5819.62,-748.77C5832.63,-739.82 5848.33,-729.02 5862.87,-719.02"/>
<polygon fill="black" stroke="black" points="5865.01,-721.79 5871.26,-713.24 5861.04,-716.03 5865.01,-721.79"/>
</g>
<!-- layer_15_mlp_fc1_gpu14 -->
<g id="node690" class="node">
<title>layer_15_mlp_fc1_gpu14</title>
<polygon fill="lightblue" stroke="black" points="6074.5,-712.97 5975.5,-712.97 5975.5,-660.97 6074.5,-660.97 6074.5,-712.97"/>
<text text-anchor="middle" x="6025" y="-700.97" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="6025" y="-689.97" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="6025" y="-678.97" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="6025" y="-667.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu14 -->
<g id="edge938" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu14</title>
<path fill="none" stroke="black" d="M5827.77,-758.05C5861.6,-748.21 5913.29,-732.52 5965.96,-713.23"/>
<polygon fill="black" stroke="black" points="5967.3,-716.46 5975.46,-709.71 5964.87,-709.9 5967.3,-716.46"/>
</g>
<!-- layer_15_mlp_fc1_gpu15 -->
<g id="node691" class="node">
<title>layer_15_mlp_fc1_gpu15</title>
<polygon fill="lightblue" stroke="black" points="6191.5,-712.97 6092.5,-712.97 6092.5,-660.97 6191.5,-660.97 6191.5,-712.97"/>
<text text-anchor="middle" x="6142" y="-700.97" font-family="Arial" font-size="10.00">Layer 15 MLP FC1</text>
<text text-anchor="middle" x="6142" y="-689.97" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="6142" y="-678.97" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="6142" y="-667.97" font-family="Arial" font-size="10.00">[4096→16384]</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu15 -->
<g id="edge939" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_mlp_fc1_gpu15</title>
<path fill="none" stroke="black" d="M5827.71,-764.15C5881.96,-757.2 5986.65,-741.63 6082.44,-713.2"/>
<polygon fill="black" stroke="black" points="6083.72,-716.47 6092.27,-710.22 6081.69,-709.77 6083.72,-716.47"/>
</g>
<!-- layer_15_allgather_mlp -->
<g id="node692" class="node">
<title>layer_15_allgather_mlp</title>
<ellipse fill="orange" stroke="black" cx="5674" cy="-595.97" rx="56.64" ry="28.98"/>
<text text-anchor="middle" x="5674" y="-604.47" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="5674" y="-593.47" font-family="Arial" font-size="10.00">AllGather MLP</text>
<text text-anchor="middle" x="5674" y="-582.47" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_15_mlp_fc1_gpu8&#45;&gt;layer_15_allgather_mlp -->
<g id="edge940" class="edge">
<title>layer_15_mlp_fc1_gpu8&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M5372.65,-664.16C5375.79,-663.02 5378.93,-661.94 5382,-660.97 5459.13,-636.41 5550.67,-618.02 5610.43,-607.4"/>
<polygon fill="black" stroke="black" points="5611.23,-610.81 5620.47,-605.63 5610.02,-603.92 5611.23,-610.81"/>
</g>
<!-- layer_15_mlp_fc1_gpu9&#45;&gt;layer_15_allgather_mlp -->
<g id="edge941" class="edge">
<title>layer_15_mlp_fc1_gpu9&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M5489.5,-664.78C5492.71,-663.47 5495.9,-662.19 5499,-660.97 5538.75,-645.29 5584.07,-628.75 5618.62,-616.42"/>
<polygon fill="black" stroke="black" points="5619.83,-619.71 5628.07,-613.06 5617.48,-613.11 5619.83,-619.71"/>
</g>
<!-- layer_15_mlp_fc1_gpu10&#45;&gt;layer_15_allgather_mlp -->
<g id="edge942" class="edge">
<title>layer_15_mlp_fc1_gpu10&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M5589.9,-660.94C5603.8,-650.37 5620.1,-637.97 5634.63,-626.92"/>
<polygon fill="black" stroke="black" points="5637.11,-629.43 5642.95,-620.59 5632.87,-623.86 5637.11,-629.43"/>
</g>
<!-- layer_15_mlp_fc1_gpu11&#45;&gt;layer_15_allgather_mlp -->
<g id="edge943" class="edge">
<title>layer_15_mlp_fc1_gpu11&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M5674,-660.7C5674,-652.81 5674,-643.92 5674,-635.34"/>
<polygon fill="black" stroke="black" points="5677.5,-635.12 5674,-625.12 5670.5,-635.12 5677.5,-635.12"/>
</g>
<!-- layer_15_mlp_fc1_gpu12&#45;&gt;layer_15_allgather_mlp -->
<g id="edge944" class="edge">
<title>layer_15_mlp_fc1_gpu12&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M5758.1,-660.94C5744.2,-650.37 5727.9,-637.97 5713.37,-626.92"/>
<polygon fill="black" stroke="black" points="5715.13,-623.86 5705.05,-620.59 5710.89,-629.43 5715.13,-623.86"/>
</g>
<!-- layer_15_mlp_fc1_gpu13&#45;&gt;layer_15_allgather_mlp -->
<g id="edge945" class="edge">
<title>layer_15_mlp_fc1_gpu13&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M5858.41,-664.36C5855.57,-663.2 5852.75,-662.06 5850,-660.97 5810.09,-645.12 5764.51,-628.59 5729.74,-616.3"/>
<polygon fill="black" stroke="black" points="5730.82,-612.98 5720.23,-612.95 5728.5,-619.58 5730.82,-612.98"/>
</g>
<!-- layer_15_mlp_fc1_gpu14&#45;&gt;layer_15_allgather_mlp -->
<g id="edge946" class="edge">
<title>layer_15_mlp_fc1_gpu14&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M5975.25,-663.8C5972.48,-662.79 5969.71,-661.84 5967,-660.97 5889.57,-636.08 5797.53,-617.73 5737.55,-607.22"/>
<polygon fill="black" stroke="black" points="5737.92,-603.73 5727.47,-605.47 5736.73,-610.63 5737.92,-603.73"/>
</g>
<!-- layer_15_mlp_fc1_gpu15&#45;&gt;layer_15_allgather_mlp -->
<g id="edge947" class="edge">
<title>layer_15_mlp_fc1_gpu15&#45;&gt;layer_15_allgather_mlp</title>
<path fill="none" stroke="black" d="M6092.31,-663.6C6089.52,-662.64 6086.74,-661.76 6084,-660.97 5965.35,-626.73 5821.76,-609.65 5739.84,-602.1"/>
<polygon fill="black" stroke="black" points="5739.94,-598.6 5729.67,-601.19 5739.32,-605.57 5739.94,-598.6"/>
</g>
<!-- layer_15_gelu -->
<g id="node693" class="node">
<title>layer_15_gelu</title>
<polygon fill="lightblue" stroke="black" points="5543.5,-530.98 5454.5,-530.98 5454.5,-494.98 5543.5,-494.98 5543.5,-530.98"/>
<text text-anchor="middle" x="5499" y="-515.98" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="5499" y="-504.98" font-family="Arial" font-size="10.00">GELU Activation</text>
</g>
<!-- layer_15_allgather_mlp&#45;&gt;layer_15_gelu -->
<g id="edge948" class="edge">
<title>layer_15_allgather_mlp&#45;&gt;layer_15_gelu</title>
<path fill="none" stroke="black" d="M5632.97,-575.99C5606.67,-563.81 5572.49,-547.99 5545.23,-535.38"/>
<polygon fill="black" stroke="black" points="5546.45,-532.08 5535.9,-531.06 5543.51,-538.44 5546.45,-532.08"/>
</g>
<!-- layer_15_mlp_fc2_gpu15 -->
<g id="node701" class="node">
<title>layer_15_mlp_fc2_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5460.5,-458.98 5361.5,-458.98 5361.5,-406.98 5460.5,-406.98 5460.5,-458.98"/>
<text text-anchor="middle" x="5411" y="-446.98" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="5411" y="-435.98" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="5411" y="-424.98" font-family="Arial" font-size="10.00">TP Rank 7</text>
<text text-anchor="middle" x="5411" y="-413.98" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu15 -->
<g id="edge949" class="edge">
<title>layer_15_gelu&#45;&gt;layer_15_mlp_fc2_gpu15</title>
<path fill="none" stroke="black" d="M5479.47,-494.67C5469.93,-486.21 5458.13,-475.75 5447.03,-465.92"/>
<polygon fill="black" stroke="black" points="5449.3,-463.25 5439.5,-459.24 5444.66,-468.49 5449.3,-463.25"/>
</g>
<!-- layer_15_mlp_fc2_gpu8 -->
<g id="node694" class="node">
<title>layer_15_mlp_fc2_gpu8</title>
<polygon fill="lightblue" stroke="black" points="5577.5,-458.98 5478.5,-458.98 5478.5,-406.98 5577.5,-406.98 5577.5,-458.98"/>
<text text-anchor="middle" x="5528" y="-446.98" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="5528" y="-435.98" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="5528" y="-424.98" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="5528" y="-413.98" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_allreduce_mlp -->
<g id="node702" class="node">
<title>layer_15_allreduce_mlp</title>
<ellipse fill="orange" stroke="black" cx="5879" cy="-341.99" rx="60.21" ry="28.98"/>
<text text-anchor="middle" x="5879" y="-350.49" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="5879" y="-339.49" font-family="Arial" font-size="10.00">AllReduce MLP</text>
<text text-anchor="middle" x="5879" y="-328.49" font-family="Arial" font-size="10.00">TP=8</text>
</g>
<!-- layer_15_mlp_fc2_gpu8&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge950" class="edge">
<title>layer_15_mlp_fc2_gpu8&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5577.65,-410.18C5580.79,-409.04 5583.93,-407.96 5587,-406.98 5662.85,-382.83 5752.62,-364.65 5812.41,-353.95"/>
<polygon fill="black" stroke="black" points="5813.24,-357.36 5822.48,-352.17 5812.03,-350.47 5813.24,-357.36"/>
</g>
<!-- layer_15_mlp_fc2_gpu9 -->
<g id="node695" class="node">
<title>layer_15_mlp_fc2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="5694.5,-458.98 5595.5,-458.98 5595.5,-406.98 5694.5,-406.98 5694.5,-458.98"/>
<text text-anchor="middle" x="5645" y="-446.98" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="5645" y="-435.98" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="5645" y="-424.98" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="5645" y="-413.98" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_mlp_fc2_gpu9&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge951" class="edge">
<title>layer_15_mlp_fc2_gpu9&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5694.5,-410.8C5697.71,-409.49 5700.9,-408.21 5704,-406.98 5742.89,-391.64 5787.12,-375.48 5821.38,-363.24"/>
<polygon fill="black" stroke="black" points="5822.98,-366.39 5831.22,-359.73 5820.63,-359.79 5822.98,-366.39"/>
</g>
<!-- layer_15_mlp_fc2_gpu10 -->
<g id="node696" class="node">
<title>layer_15_mlp_fc2_gpu10</title>
<polygon fill="lightblue" stroke="black" points="5811.5,-458.98 5712.5,-458.98 5712.5,-406.98 5811.5,-406.98 5811.5,-458.98"/>
<text text-anchor="middle" x="5762" y="-446.98" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="5762" y="-435.98" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="5762" y="-424.98" font-family="Arial" font-size="10.00">TP Rank 2</text>
<text text-anchor="middle" x="5762" y="-413.98" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_mlp_fc2_gpu10&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge952" class="edge">
<title>layer_15_mlp_fc2_gpu10&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5794.9,-406.96C5808.69,-396.47 5824.84,-384.19 5839.28,-373.2"/>
<polygon fill="black" stroke="black" points="5841.71,-375.75 5847.55,-366.91 5837.47,-370.18 5841.71,-375.75"/>
</g>
<!-- layer_15_mlp_fc2_gpu11 -->
<g id="node697" class="node">
<title>layer_15_mlp_fc2_gpu11</title>
<polygon fill="lightblue" stroke="black" points="5928.5,-458.98 5829.5,-458.98 5829.5,-406.98 5928.5,-406.98 5928.5,-458.98"/>
<text text-anchor="middle" x="5879" y="-446.98" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="5879" y="-435.98" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="5879" y="-424.98" font-family="Arial" font-size="10.00">TP Rank 3</text>
<text text-anchor="middle" x="5879" y="-413.98" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_mlp_fc2_gpu11&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge953" class="edge">
<title>layer_15_mlp_fc2_gpu11&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5879,-406.72C5879,-398.83 5879,-389.94 5879,-381.36"/>
<polygon fill="black" stroke="black" points="5882.5,-381.13 5879,-371.13 5875.5,-381.13 5882.5,-381.13"/>
</g>
<!-- layer_15_mlp_fc2_gpu12 -->
<g id="node698" class="node">
<title>layer_15_mlp_fc2_gpu12</title>
<polygon fill="lightblue" stroke="black" points="6045.5,-458.98 5946.5,-458.98 5946.5,-406.98 6045.5,-406.98 6045.5,-458.98"/>
<text text-anchor="middle" x="5996" y="-446.98" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="5996" y="-435.98" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="5996" y="-424.98" font-family="Arial" font-size="10.00">TP Rank 4</text>
<text text-anchor="middle" x="5996" y="-413.98" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_mlp_fc2_gpu12&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge954" class="edge">
<title>layer_15_mlp_fc2_gpu12&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5963.1,-406.96C5949.31,-396.47 5933.16,-384.19 5918.72,-373.2"/>
<polygon fill="black" stroke="black" points="5920.53,-370.18 5910.45,-366.91 5916.29,-375.75 5920.53,-370.18"/>
</g>
<!-- layer_15_mlp_fc2_gpu13 -->
<g id="node699" class="node">
<title>layer_15_mlp_fc2_gpu13</title>
<polygon fill="lightblue" stroke="black" points="6162.5,-458.98 6063.5,-458.98 6063.5,-406.98 6162.5,-406.98 6162.5,-458.98"/>
<text text-anchor="middle" x="6113" y="-446.98" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="6113" y="-435.98" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="6113" y="-424.98" font-family="Arial" font-size="10.00">TP Rank 5</text>
<text text-anchor="middle" x="6113" y="-413.98" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_mlp_fc2_gpu13&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge955" class="edge">
<title>layer_15_mlp_fc2_gpu13&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M6063.41,-410.38C6060.57,-409.21 6057.75,-408.07 6055,-406.98 6015.78,-391.41 5971.08,-375.18 5936.55,-362.96"/>
<polygon fill="black" stroke="black" points="5937.69,-359.65 5927.09,-359.63 5935.36,-366.25 5937.69,-359.65"/>
</g>
<!-- layer_15_mlp_fc2_gpu14 -->
<g id="node700" class="node">
<title>layer_15_mlp_fc2_gpu14</title>
<polygon fill="lightblue" stroke="black" points="6279.5,-458.98 6180.5,-458.98 6180.5,-406.98 6279.5,-406.98 6279.5,-458.98"/>
<text text-anchor="middle" x="6230" y="-446.98" font-family="Arial" font-size="10.00">Layer 15 MLP FC2</text>
<text text-anchor="middle" x="6230" y="-435.98" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="6230" y="-424.98" font-family="Arial" font-size="10.00">TP Rank 6</text>
<text text-anchor="middle" x="6230" y="-413.98" font-family="Arial" font-size="10.00">[16384→4096]</text>
</g>
<!-- layer_15_mlp_fc2_gpu14&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge956" class="edge">
<title>layer_15_mlp_fc2_gpu14&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M6180.25,-409.82C6177.48,-408.81 6174.71,-407.86 6172,-406.98 6095.85,-382.51 6005.59,-364.36 5945.57,-353.77"/>
<polygon fill="black" stroke="black" points="5945.92,-350.27 5935.47,-352 5944.72,-357.17 5945.92,-350.27"/>
</g>
<!-- layer_15_mlp_fc2_gpu15&#45;&gt;layer_15_allreduce_mlp -->
<g id="edge957" class="edge">
<title>layer_15_mlp_fc2_gpu15&#45;&gt;layer_15_allreduce_mlp</title>
<path fill="none" stroke="black" d="M5460.58,-409.96C5463.74,-408.87 5466.9,-407.87 5470,-406.98 5586.77,-373.66 5727.55,-356.45 5809.8,-348.6"/>
<polygon fill="black" stroke="black" points="5810.14,-352.08 5819.77,-347.66 5809.49,-345.11 5810.14,-352.08"/>
</g>
<!-- layer_15_allreduce_mlp&#45;&gt;layer_15_residual2 -->
<g id="edge958" class="edge">
<title>layer_15_allreduce_mlp&#45;&gt;layer_15_residual2</title>
<path fill="none" stroke="black" d="M5922.82,-321.95C5954.93,-308 5998.85,-288.91 6034.03,-273.62"/>
<polygon fill="black" stroke="black" points="6035.47,-276.82 6043.24,-269.62 6032.68,-270.4 6035.47,-276.82"/>
</g>
<!-- layer_15_ln2 -->
<g id="node704" class="node">
<title>layer_15_ln2</title>
<polygon fill="lightblue" stroke="black" points="6129.5,-181 6056.5,-181 6056.5,-140 6129.5,-140 6129.5,-181"/>
<text text-anchor="middle" x="6093" y="-169" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="6093" y="-158" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="6093" y="-147" font-family="Arial" font-size="10.00">γ,β: 4096</text>
</g>
<!-- layer_15_residual2&#45;&gt;layer_15_ln2 -->
<g id="edge960" class="edge">
<title>layer_15_residual2&#45;&gt;layer_15_ln2</title>
<path fill="none" stroke="black" d="M6093,-216.92C6093,-208.6 6093,-199.51 6093,-191.15"/>
<polygon fill="black" stroke="black" points="6096.5,-191.07 6093,-181.07 6089.5,-191.07 6096.5,-191.07"/>
</g>
<!-- output -->
<g id="node705" class="node">
<title>output</title>
<polygon fill="lightgreen" stroke="black" points="6169.94,-104 6047.55,-104 6016.06,0 6138.45,0 6169.94,-104"/>
<text text-anchor="middle" x="6093" y="-66" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="6093" y="-55" font-family="Arial" font-size="10.00">Batch: 128</text>
<text text-anchor="middle" x="6093" y="-44" font-family="Arial" font-size="10.00">Seq: 10000</text>
<text text-anchor="middle" x="6093" y="-33" font-family="Arial" font-size="10.00">Hidden: 4096</text>
</g>
<!-- layer_15_ln2&#45;&gt;output -->
<g id="edge961" class="edge">
<title>layer_15_ln2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M6093,-139.97C6093,-132.56 6093,-123.67 6093,-114.45"/>
<polygon fill="black" stroke="black" points="6096.5,-114.36 6093,-104.36 6089.5,-114.36 6096.5,-114.36"/>
</g>
</g>
</svg>
