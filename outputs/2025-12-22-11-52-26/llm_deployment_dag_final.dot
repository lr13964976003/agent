// 30B MoE Model Deployment DAG - EP8-TP4-PP2-DP4 Complete Configuration
digraph {
	nodesep=0.5 rankdir=TB ranksep=1.0 size="40,30"
	node [fontname=Arial fontsize=10]
	input [label="Input Data\nBatch: 128, Seq: 10240\nTotal: 1310720 tokens" fillcolor=lightblue shape=box style=filled width=3]
	prefill_start [label="Prefill Phase Start\nAll 256 GPUs Active" fillcolor=lightblue shape=box style=filled width=4]
	embed_dp0_tp0_gpu0 [label="Embedding Layer\nDP0-TP0\nGPU0\nIn: [B=32,S=10240,D=1024]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	embed_ar_dp0_tp0_gpu0 [label="Embedding All-Reduce\nDP0 TP Group 0\nGPU0" fillcolor=lightblue shape=ellipse style=filled]
	embed_dp0_tp1_gpu8 [label="Embedding Layer\nDP0-TP1\nGPU8\nIn: [B=32,S=10240,D=1024]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	embed_ar_dp0_tp1_gpu8 [label="Embedding All-Reduce\nDP0 TP Group 1\nGPU8" fillcolor=lightblue shape=ellipse style=filled]
	embed_dp0_tp2_gpu16 [label="Embedding Layer\nDP0-TP2\nGPU16\nIn: [B=32,S=10240,D=1024]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	embed_ar_dp0_tp2_gpu16 [label="Embedding All-Reduce\nDP0 TP Group 2\nGPU16" fillcolor=lightblue shape=ellipse style=filled]
	embed_dp0_tp3_gpu24 [label="Embedding Layer\nDP0-TP3\nGPU24\nIn: [B=32,S=10240,D=1024]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	embed_ar_dp0_tp3_gpu24 [label="Embedding All-Reduce\nDP0 TP Group 3\nGPU24" fillcolor=lightblue shape=ellipse style=filled]
	embed_dp1_tp0_gpu1 [label="Embedding Layer\nDP1-TP0\nGPU1\nIn: [B=32,S=10240,D=1024]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	embed_ar_dp1_tp0_gpu1 [label="Embedding All-Reduce\nDP1 TP Group 0\nGPU1" fillcolor=lightblue shape=ellipse style=filled]
	embed_dp1_tp1_gpu9 [label="Embedding Layer\nDP1-TP1\nGPU9\nIn: [B=32,S=10240,D=1024]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	embed_ar_dp1_tp1_gpu9 [label="Embedding All-Reduce\nDP1 TP Group 1\nGPU9" fillcolor=lightblue shape=ellipse style=filled]
	embed_dp1_tp2_gpu17 [label="Embedding Layer\nDP1-TP2\nGPU17\nIn: [B=32,S=10240,D=1024]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	embed_ar_dp1_tp2_gpu17 [label="Embedding All-Reduce\nDP1 TP Group 2\nGPU17" fillcolor=lightblue shape=ellipse style=filled]
	embed_dp1_tp3_gpu25 [label="Embedding Layer\nDP1-TP3\nGPU25\nIn: [B=32,S=10240,D=1024]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	embed_ar_dp1_tp3_gpu25 [label="Embedding All-Reduce\nDP1 TP Group 3\nGPU25" fillcolor=lightblue shape=ellipse style=filled]
	embed_dp2_tp0_gpu2 [label="Embedding Layer\nDP2-TP0\nGPU2\nIn: [B=32,S=10240,D=1024]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	embed_ar_dp2_tp0_gpu2 [label="Embedding All-Reduce\nDP2 TP Group 0\nGPU2" fillcolor=lightblue shape=ellipse style=filled]
	embed_dp2_tp1_gpu10 [label="Embedding Layer\nDP2-TP1\nGPU10\nIn: [B=32,S=10240,D=1024]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	embed_ar_dp2_tp1_gpu10 [label="Embedding All-Reduce\nDP2 TP Group 1\nGPU10" fillcolor=lightblue shape=ellipse style=filled]
	embed_dp2_tp2_gpu18 [label="Embedding Layer\nDP2-TP2\nGPU18\nIn: [B=32,S=10240,D=1024]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	embed_ar_dp2_tp2_gpu18 [label="Embedding All-Reduce\nDP2 TP Group 2\nGPU18" fillcolor=lightblue shape=ellipse style=filled]
	embed_dp2_tp3_gpu26 [label="Embedding Layer\nDP2-TP3\nGPU26\nIn: [B=32,S=10240,D=1024]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	embed_ar_dp2_tp3_gpu26 [label="Embedding All-Reduce\nDP2 TP Group 3\nGPU26" fillcolor=lightblue shape=ellipse style=filled]
	embed_dp3_tp0_gpu3 [label="Embedding Layer\nDP3-TP0\nGPU3\nIn: [B=32,S=10240,D=1024]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	embed_ar_dp3_tp0_gpu3 [label="Embedding All-Reduce\nDP3 TP Group 0\nGPU3" fillcolor=lightblue shape=ellipse style=filled]
	embed_dp3_tp1_gpu11 [label="Embedding Layer\nDP3-TP1\nGPU11\nIn: [B=32,S=10240,D=1024]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	embed_ar_dp3_tp1_gpu11 [label="Embedding All-Reduce\nDP3 TP Group 1\nGPU11" fillcolor=lightblue shape=ellipse style=filled]
	embed_dp3_tp2_gpu19 [label="Embedding Layer\nDP3-TP2\nGPU19\nIn: [B=32,S=10240,D=1024]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	embed_ar_dp3_tp2_gpu19 [label="Embedding All-Reduce\nDP3 TP Group 2\nGPU19" fillcolor=lightblue shape=ellipse style=filled]
	embed_dp3_tp3_gpu27 [label="Embedding Layer\nDP3-TP3\nGPU27\nIn: [B=32,S=10240,D=1024]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	embed_ar_dp3_tp3_gpu27 [label="Embedding All-Reduce\nDP3 TP Group 3\nGPU27" fillcolor=lightblue shape=ellipse style=filled]
	ln1_L0_EP0TP0PP0DP0_GPU0 [label="Layer Norm 1\nL0_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L0_EP0TP0PP0DP0_GPU0 [label="QKV Projection\nL0_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L0_EP0TP0PP0DP0_GPU0 [label="Multi-Head Attention\nL0_EP0TP0PP0DP0_GPU0\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L0_EP0TP0PP0DP0_GPU0 [label="Attention Output Proj\nL0_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L0_EP0TP0PP0DP0_GPU0 [label="Attention All-Reduce\nL0 EP0 TP Group 0 PP0 DP0\nGPU0" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L0_EP0TP0PP0DP0_GPU0 [label="Residual Add 1\nL0_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L0_EP0TP0PP0DP0_GPU0 [label="Layer Norm 2\nL0_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L0_EP0TP0PP0DP0_GPU0 [label="MoE Gate (Routing)\nL0_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L0_EP0TP0PP0DP0_GPU0 [label="Expert Dispatch\nL0_EP0TP0PP0DP0_GPU0" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L0_EP0TP0PP0DP0_GPU0 [label="Expert 0\nL0_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L0_EP0TP0PP0DP0_GPU0 [label="Expert 1\nL0_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L0_EP0TP0PP0DP0_GPU0 [label="Expert 2\nL0_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L0_EP0TP0PP0DP0_GPU0 [label="Expert 3\nL0_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L0_EP0TP0PP0DP0_GPU0 [label="Expert Combine\nL0_EP0TP0PP0DP0_GPU0" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L0_EP0TP0PP0DP0_GPU0 [label="FFN (Up-proj + GeLU + Down-proj)\nL0_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L0_EP0TP0PP0DP0_GPU0 [label="FFN All-Reduce\nL0 EP0 TP Group 0 PP0 DP0\nGPU0" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L0_EP0TP0PP0DP0_GPU0 [label="Residual Add 2\nL0_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L0_EP0TP0PP0DP1_GPU1 [label="Layer Norm 1\nL0_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L0_EP0TP0PP0DP1_GPU1 [label="QKV Projection\nL0_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L0_EP0TP0PP0DP1_GPU1 [label="Multi-Head Attention\nL0_EP0TP0PP0DP1_GPU1\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L0_EP0TP0PP0DP1_GPU1 [label="Attention Output Proj\nL0_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L0_EP0TP0PP0DP1_GPU1 [label="Attention All-Reduce\nL0 EP0 TP Group 0 PP0 DP1\nGPU1" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L0_EP0TP0PP0DP1_GPU1 [label="Residual Add 1\nL0_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L0_EP0TP0PP0DP1_GPU1 [label="Layer Norm 2\nL0_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L0_EP0TP0PP0DP1_GPU1 [label="MoE Gate (Routing)\nL0_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L0_EP0TP0PP0DP1_GPU1 [label="Expert Dispatch\nL0_EP0TP0PP0DP1_GPU1" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L0_EP0TP0PP0DP1_GPU1 [label="Expert 0\nL0_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L0_EP0TP0PP0DP1_GPU1 [label="Expert 1\nL0_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L0_EP0TP0PP0DP1_GPU1 [label="Expert 2\nL0_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L0_EP0TP0PP0DP1_GPU1 [label="Expert 3\nL0_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L0_EP0TP0PP0DP1_GPU1 [label="Expert Combine\nL0_EP0TP0PP0DP1_GPU1" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L0_EP0TP0PP0DP1_GPU1 [label="FFN (Up-proj + GeLU + Down-proj)\nL0_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L0_EP0TP0PP0DP1_GPU1 [label="FFN All-Reduce\nL0 EP0 TP Group 0 PP0 DP1\nGPU1" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L0_EP0TP0PP0DP1_GPU1 [label="Residual Add 2\nL0_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L0_EP0TP1PP0DP0_GPU8 [label="Layer Norm 1\nL0_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L0_EP0TP1PP0DP0_GPU8 [label="QKV Projection\nL0_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L0_EP0TP1PP0DP0_GPU8 [label="Multi-Head Attention\nL0_EP0TP1PP0DP0_GPU8\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L0_EP0TP1PP0DP0_GPU8 [label="Attention Output Proj\nL0_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L0_EP0TP1PP0DP0_GPU8 [label="Attention All-Reduce\nL0 EP0 TP Group 1 PP0 DP0\nGPU8" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L0_EP0TP1PP0DP0_GPU8 [label="Residual Add 1\nL0_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L0_EP0TP1PP0DP0_GPU8 [label="Layer Norm 2\nL0_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L0_EP0TP1PP0DP0_GPU8 [label="MoE Gate (Routing)\nL0_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L0_EP0TP1PP0DP0_GPU8 [label="Expert Dispatch\nL0_EP0TP1PP0DP0_GPU8" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L0_EP0TP1PP0DP0_GPU8 [label="Expert 0\nL0_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L0_EP0TP1PP0DP0_GPU8 [label="Expert 1\nL0_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L0_EP0TP1PP0DP0_GPU8 [label="Expert 2\nL0_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L0_EP0TP1PP0DP0_GPU8 [label="Expert 3\nL0_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L0_EP0TP1PP0DP0_GPU8 [label="Expert Combine\nL0_EP0TP1PP0DP0_GPU8" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L0_EP0TP1PP0DP0_GPU8 [label="FFN (Up-proj + GeLU + Down-proj)\nL0_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L0_EP0TP1PP0DP0_GPU8 [label="FFN All-Reduce\nL0 EP0 TP Group 1 PP0 DP0\nGPU8" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L0_EP0TP1PP0DP0_GPU8 [label="Residual Add 2\nL0_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L0_EP0TP1PP0DP1_GPU9 [label="Layer Norm 1\nL0_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L0_EP0TP1PP0DP1_GPU9 [label="QKV Projection\nL0_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L0_EP0TP1PP0DP1_GPU9 [label="Multi-Head Attention\nL0_EP0TP1PP0DP1_GPU9\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L0_EP0TP1PP0DP1_GPU9 [label="Attention Output Proj\nL0_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L0_EP0TP1PP0DP1_GPU9 [label="Attention All-Reduce\nL0 EP0 TP Group 1 PP0 DP1\nGPU9" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L0_EP0TP1PP0DP1_GPU9 [label="Residual Add 1\nL0_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L0_EP0TP1PP0DP1_GPU9 [label="Layer Norm 2\nL0_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L0_EP0TP1PP0DP1_GPU9 [label="MoE Gate (Routing)\nL0_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L0_EP0TP1PP0DP1_GPU9 [label="Expert Dispatch\nL0_EP0TP1PP0DP1_GPU9" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L0_EP0TP1PP0DP1_GPU9 [label="Expert 0\nL0_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L0_EP0TP1PP0DP1_GPU9 [label="Expert 1\nL0_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L0_EP0TP1PP0DP1_GPU9 [label="Expert 2\nL0_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L0_EP0TP1PP0DP1_GPU9 [label="Expert 3\nL0_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L0_EP0TP1PP0DP1_GPU9 [label="Expert Combine\nL0_EP0TP1PP0DP1_GPU9" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L0_EP0TP1PP0DP1_GPU9 [label="FFN (Up-proj + GeLU + Down-proj)\nL0_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L0_EP0TP1PP0DP1_GPU9 [label="FFN All-Reduce\nL0 EP0 TP Group 1 PP0 DP1\nGPU9" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L0_EP0TP1PP0DP1_GPU9 [label="Residual Add 2\nL0_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L0_EP0TP2PP0DP0_GPU16 [label="Layer Norm 1\nL0_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L0_EP0TP2PP0DP0_GPU16 [label="QKV Projection\nL0_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L0_EP0TP2PP0DP0_GPU16 [label="Multi-Head Attention\nL0_EP0TP2PP0DP0_GPU16\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L0_EP0TP2PP0DP0_GPU16 [label="Attention Output Proj\nL0_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L0_EP0TP2PP0DP0_GPU16 [label="Attention All-Reduce\nL0 EP0 TP Group 2 PP0 DP0\nGPU16" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L0_EP0TP2PP0DP0_GPU16 [label="Residual Add 1\nL0_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L0_EP0TP2PP0DP0_GPU16 [label="Layer Norm 2\nL0_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L0_EP0TP2PP0DP0_GPU16 [label="MoE Gate (Routing)\nL0_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L0_EP0TP2PP0DP0_GPU16 [label="Expert Dispatch\nL0_EP0TP2PP0DP0_GPU16" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L0_EP0TP2PP0DP0_GPU16 [label="Expert 0\nL0_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L0_EP0TP2PP0DP0_GPU16 [label="Expert 1\nL0_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L0_EP0TP2PP0DP0_GPU16 [label="Expert 2\nL0_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L0_EP0TP2PP0DP0_GPU16 [label="Expert 3\nL0_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L0_EP0TP2PP0DP0_GPU16 [label="Expert Combine\nL0_EP0TP2PP0DP0_GPU16" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L0_EP0TP2PP0DP0_GPU16 [label="FFN (Up-proj + GeLU + Down-proj)\nL0_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L0_EP0TP2PP0DP0_GPU16 [label="FFN All-Reduce\nL0 EP0 TP Group 2 PP0 DP0\nGPU16" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L0_EP0TP2PP0DP0_GPU16 [label="Residual Add 2\nL0_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L0_EP0TP2PP0DP1_GPU17 [label="Layer Norm 1\nL0_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L0_EP0TP2PP0DP1_GPU17 [label="QKV Projection\nL0_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L0_EP0TP2PP0DP1_GPU17 [label="Multi-Head Attention\nL0_EP0TP2PP0DP1_GPU17\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L0_EP0TP2PP0DP1_GPU17 [label="Attention Output Proj\nL0_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L0_EP0TP2PP0DP1_GPU17 [label="Attention All-Reduce\nL0 EP0 TP Group 2 PP0 DP1\nGPU17" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L0_EP0TP2PP0DP1_GPU17 [label="Residual Add 1\nL0_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L0_EP0TP2PP0DP1_GPU17 [label="Layer Norm 2\nL0_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L0_EP0TP2PP0DP1_GPU17 [label="MoE Gate (Routing)\nL0_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L0_EP0TP2PP0DP1_GPU17 [label="Expert Dispatch\nL0_EP0TP2PP0DP1_GPU17" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L0_EP0TP2PP0DP1_GPU17 [label="Expert 0\nL0_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L0_EP0TP2PP0DP1_GPU17 [label="Expert 1\nL0_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L0_EP0TP2PP0DP1_GPU17 [label="Expert 2\nL0_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L0_EP0TP2PP0DP1_GPU17 [label="Expert 3\nL0_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L0_EP0TP2PP0DP1_GPU17 [label="Expert Combine\nL0_EP0TP2PP0DP1_GPU17" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L0_EP0TP2PP0DP1_GPU17 [label="FFN (Up-proj + GeLU + Down-proj)\nL0_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L0_EP0TP2PP0DP1_GPU17 [label="FFN All-Reduce\nL0 EP0 TP Group 2 PP0 DP1\nGPU17" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L0_EP0TP2PP0DP1_GPU17 [label="Residual Add 2\nL0_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L0_EP0TP3PP0DP0_GPU24 [label="Layer Norm 1\nL0_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L0_EP0TP3PP0DP0_GPU24 [label="QKV Projection\nL0_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L0_EP0TP3PP0DP0_GPU24 [label="Multi-Head Attention\nL0_EP0TP3PP0DP0_GPU24\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L0_EP0TP3PP0DP0_GPU24 [label="Attention Output Proj\nL0_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L0_EP0TP3PP0DP0_GPU24 [label="Attention All-Reduce\nL0 EP0 TP Group 3 PP0 DP0\nGPU24" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L0_EP0TP3PP0DP0_GPU24 [label="Residual Add 1\nL0_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L0_EP0TP3PP0DP0_GPU24 [label="Layer Norm 2\nL0_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L0_EP0TP3PP0DP0_GPU24 [label="MoE Gate (Routing)\nL0_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L0_EP0TP3PP0DP0_GPU24 [label="Expert Dispatch\nL0_EP0TP3PP0DP0_GPU24" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L0_EP0TP3PP0DP0_GPU24 [label="Expert 0\nL0_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L0_EP0TP3PP0DP0_GPU24 [label="Expert 1\nL0_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L0_EP0TP3PP0DP0_GPU24 [label="Expert 2\nL0_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L0_EP0TP3PP0DP0_GPU24 [label="Expert 3\nL0_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L0_EP0TP3PP0DP0_GPU24 [label="Expert Combine\nL0_EP0TP3PP0DP0_GPU24" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L0_EP0TP3PP0DP0_GPU24 [label="FFN (Up-proj + GeLU + Down-proj)\nL0_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L0_EP0TP3PP0DP0_GPU24 [label="FFN All-Reduce\nL0 EP0 TP Group 3 PP0 DP0\nGPU24" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L0_EP0TP3PP0DP0_GPU24 [label="Residual Add 2\nL0_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L0_EP0TP3PP0DP1_GPU25 [label="Layer Norm 1\nL0_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L0_EP0TP3PP0DP1_GPU25 [label="QKV Projection\nL0_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L0_EP0TP3PP0DP1_GPU25 [label="Multi-Head Attention\nL0_EP0TP3PP0DP1_GPU25\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L0_EP0TP3PP0DP1_GPU25 [label="Attention Output Proj\nL0_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L0_EP0TP3PP0DP1_GPU25 [label="Attention All-Reduce\nL0 EP0 TP Group 3 PP0 DP1\nGPU25" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L0_EP0TP3PP0DP1_GPU25 [label="Residual Add 1\nL0_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L0_EP0TP3PP0DP1_GPU25 [label="Layer Norm 2\nL0_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L0_EP0TP3PP0DP1_GPU25 [label="MoE Gate (Routing)\nL0_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L0_EP0TP3PP0DP1_GPU25 [label="Expert Dispatch\nL0_EP0TP3PP0DP1_GPU25" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L0_EP0TP3PP0DP1_GPU25 [label="Expert 0\nL0_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L0_EP0TP3PP0DP1_GPU25 [label="Expert 1\nL0_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L0_EP0TP3PP0DP1_GPU25 [label="Expert 2\nL0_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L0_EP0TP3PP0DP1_GPU25 [label="Expert 3\nL0_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L0_EP0TP3PP0DP1_GPU25 [label="Expert Combine\nL0_EP0TP3PP0DP1_GPU25" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L0_EP0TP3PP0DP1_GPU25 [label="FFN (Up-proj + GeLU + Down-proj)\nL0_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L0_EP0TP3PP0DP1_GPU25 [label="FFN All-Reduce\nL0 EP0 TP Group 3 PP0 DP1\nGPU25" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L0_EP0TP3PP0DP1_GPU25 [label="Residual Add 2\nL0_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L0_EP1TP0PP0DP0_GPU32 [label="Layer Norm 1\nL0_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L0_EP1TP0PP0DP0_GPU32 [label="QKV Projection\nL0_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L0_EP1TP0PP0DP0_GPU32 [label="Multi-Head Attention\nL0_EP1TP0PP0DP0_GPU32\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L0_EP1TP0PP0DP0_GPU32 [label="Attention Output Proj\nL0_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L0_EP1TP0PP0DP0_GPU32 [label="Attention All-Reduce\nL0 EP1 TP Group 0 PP0 DP0\nGPU32" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L0_EP1TP0PP0DP0_GPU32 [label="Residual Add 1\nL0_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L0_EP1TP0PP0DP0_GPU32 [label="Layer Norm 2\nL0_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L0_EP1TP0PP0DP0_GPU32 [label="MoE Gate (Routing)\nL0_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L0_EP1TP0PP0DP0_GPU32 [label="Expert Dispatch\nL0_EP1TP0PP0DP0_GPU32" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L0_EP1TP0PP0DP0_GPU32 [label="Expert 0\nL0_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L0_EP1TP0PP0DP0_GPU32 [label="Expert 1\nL0_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L0_EP1TP0PP0DP0_GPU32 [label="Expert 2\nL0_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L0_EP1TP0PP0DP0_GPU32 [label="Expert 3\nL0_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L0_EP1TP0PP0DP0_GPU32 [label="Expert Combine\nL0_EP1TP0PP0DP0_GPU32" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L0_EP1TP0PP0DP0_GPU32 [label="FFN (Up-proj + GeLU + Down-proj)\nL0_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L0_EP1TP0PP0DP0_GPU32 [label="FFN All-Reduce\nL0 EP1 TP Group 0 PP0 DP0\nGPU32" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L0_EP1TP0PP0DP0_GPU32 [label="Residual Add 2\nL0_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L0_EP1TP0PP0DP1_GPU33 [label="Layer Norm 1\nL0_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L0_EP1TP0PP0DP1_GPU33 [label="QKV Projection\nL0_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L0_EP1TP0PP0DP1_GPU33 [label="Multi-Head Attention\nL0_EP1TP0PP0DP1_GPU33\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L0_EP1TP0PP0DP1_GPU33 [label="Attention Output Proj\nL0_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L0_EP1TP0PP0DP1_GPU33 [label="Attention All-Reduce\nL0 EP1 TP Group 0 PP0 DP1\nGPU33" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L0_EP1TP0PP0DP1_GPU33 [label="Residual Add 1\nL0_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L0_EP1TP0PP0DP1_GPU33 [label="Layer Norm 2\nL0_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L0_EP1TP0PP0DP1_GPU33 [label="MoE Gate (Routing)\nL0_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L0_EP1TP0PP0DP1_GPU33 [label="Expert Dispatch\nL0_EP1TP0PP0DP1_GPU33" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L0_EP1TP0PP0DP1_GPU33 [label="Expert 0\nL0_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L0_EP1TP0PP0DP1_GPU33 [label="Expert 1\nL0_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L0_EP1TP0PP0DP1_GPU33 [label="Expert 2\nL0_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L0_EP1TP0PP0DP1_GPU33 [label="Expert 3\nL0_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L0_EP1TP0PP0DP1_GPU33 [label="Expert Combine\nL0_EP1TP0PP0DP1_GPU33" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L0_EP1TP0PP0DP1_GPU33 [label="FFN (Up-proj + GeLU + Down-proj)\nL0_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L0_EP1TP0PP0DP1_GPU33 [label="FFN All-Reduce\nL0 EP1 TP Group 0 PP0 DP1\nGPU33" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L0_EP1TP0PP0DP1_GPU33 [label="Residual Add 2\nL0_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L0_EP1TP1PP0DP0_GPU40 [label="Layer Norm 1\nL0_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L0_EP1TP1PP0DP0_GPU40 [label="QKV Projection\nL0_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L0_EP1TP1PP0DP0_GPU40 [label="Multi-Head Attention\nL0_EP1TP1PP0DP0_GPU40\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L0_EP1TP1PP0DP0_GPU40 [label="Attention Output Proj\nL0_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L0_EP1TP1PP0DP0_GPU40 [label="Attention All-Reduce\nL0 EP1 TP Group 1 PP0 DP0\nGPU40" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L0_EP1TP1PP0DP0_GPU40 [label="Residual Add 1\nL0_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L0_EP1TP1PP0DP0_GPU40 [label="Layer Norm 2\nL0_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L0_EP1TP1PP0DP0_GPU40 [label="MoE Gate (Routing)\nL0_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L0_EP1TP1PP0DP0_GPU40 [label="Expert Dispatch\nL0_EP1TP1PP0DP0_GPU40" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L0_EP1TP1PP0DP0_GPU40 [label="Expert 0\nL0_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L0_EP1TP1PP0DP0_GPU40 [label="Expert 1\nL0_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L0_EP1TP1PP0DP0_GPU40 [label="Expert 2\nL0_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L0_EP1TP1PP0DP0_GPU40 [label="Expert 3\nL0_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L0_EP1TP1PP0DP0_GPU40 [label="Expert Combine\nL0_EP1TP1PP0DP0_GPU40" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L0_EP1TP1PP0DP0_GPU40 [label="FFN (Up-proj + GeLU + Down-proj)\nL0_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L0_EP1TP1PP0DP0_GPU40 [label="FFN All-Reduce\nL0 EP1 TP Group 1 PP0 DP0\nGPU40" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L0_EP1TP1PP0DP0_GPU40 [label="Residual Add 2\nL0_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L0_EP1TP1PP0DP1_GPU41 [label="Layer Norm 1\nL0_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L0_EP1TP1PP0DP1_GPU41 [label="QKV Projection\nL0_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L0_EP1TP1PP0DP1_GPU41 [label="Multi-Head Attention\nL0_EP1TP1PP0DP1_GPU41\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L0_EP1TP1PP0DP1_GPU41 [label="Attention Output Proj\nL0_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L0_EP1TP1PP0DP1_GPU41 [label="Attention All-Reduce\nL0 EP1 TP Group 1 PP0 DP1\nGPU41" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L0_EP1TP1PP0DP1_GPU41 [label="Residual Add 1\nL0_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L0_EP1TP1PP0DP1_GPU41 [label="Layer Norm 2\nL0_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L0_EP1TP1PP0DP1_GPU41 [label="MoE Gate (Routing)\nL0_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L0_EP1TP1PP0DP1_GPU41 [label="Expert Dispatch\nL0_EP1TP1PP0DP1_GPU41" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L0_EP1TP1PP0DP1_GPU41 [label="Expert 0\nL0_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L0_EP1TP1PP0DP1_GPU41 [label="Expert 1\nL0_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L0_EP1TP1PP0DP1_GPU41 [label="Expert 2\nL0_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L0_EP1TP1PP0DP1_GPU41 [label="Expert 3\nL0_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L0_EP1TP1PP0DP1_GPU41 [label="Expert Combine\nL0_EP1TP1PP0DP1_GPU41" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L0_EP1TP1PP0DP1_GPU41 [label="FFN (Up-proj + GeLU + Down-proj)\nL0_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L0_EP1TP1PP0DP1_GPU41 [label="FFN All-Reduce\nL0 EP1 TP Group 1 PP0 DP1\nGPU41" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L0_EP1TP1PP0DP1_GPU41 [label="Residual Add 2\nL0_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L0_EP1TP2PP0DP0_GPU48 [label="Layer Norm 1\nL0_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L0_EP1TP2PP0DP0_GPU48 [label="QKV Projection\nL0_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L0_EP1TP2PP0DP0_GPU48 [label="Multi-Head Attention\nL0_EP1TP2PP0DP0_GPU48\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L0_EP1TP2PP0DP0_GPU48 [label="Attention Output Proj\nL0_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L0_EP1TP2PP0DP0_GPU48 [label="Attention All-Reduce\nL0 EP1 TP Group 2 PP0 DP0\nGPU48" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L0_EP1TP2PP0DP0_GPU48 [label="Residual Add 1\nL0_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L0_EP1TP2PP0DP0_GPU48 [label="Layer Norm 2\nL0_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L0_EP1TP2PP0DP0_GPU48 [label="MoE Gate (Routing)\nL0_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L0_EP1TP2PP0DP0_GPU48 [label="Expert Dispatch\nL0_EP1TP2PP0DP0_GPU48" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L0_EP1TP2PP0DP0_GPU48 [label="Expert 0\nL0_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L0_EP1TP2PP0DP0_GPU48 [label="Expert 1\nL0_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L0_EP1TP2PP0DP0_GPU48 [label="Expert 2\nL0_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L0_EP1TP2PP0DP0_GPU48 [label="Expert 3\nL0_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L0_EP1TP2PP0DP0_GPU48 [label="Expert Combine\nL0_EP1TP2PP0DP0_GPU48" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L0_EP1TP2PP0DP0_GPU48 [label="FFN (Up-proj + GeLU + Down-proj)\nL0_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L0_EP1TP2PP0DP0_GPU48 [label="FFN All-Reduce\nL0 EP1 TP Group 2 PP0 DP0\nGPU48" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L0_EP1TP2PP0DP0_GPU48 [label="Residual Add 2\nL0_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L0_EP1TP2PP0DP1_GPU49 [label="Layer Norm 1\nL0_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L0_EP1TP2PP0DP1_GPU49 [label="QKV Projection\nL0_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L0_EP1TP2PP0DP1_GPU49 [label="Multi-Head Attention\nL0_EP1TP2PP0DP1_GPU49\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L0_EP1TP2PP0DP1_GPU49 [label="Attention Output Proj\nL0_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L0_EP1TP2PP0DP1_GPU49 [label="Attention All-Reduce\nL0 EP1 TP Group 2 PP0 DP1\nGPU49" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L0_EP1TP2PP0DP1_GPU49 [label="Residual Add 1\nL0_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L0_EP1TP2PP0DP1_GPU49 [label="Layer Norm 2\nL0_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L0_EP1TP2PP0DP1_GPU49 [label="MoE Gate (Routing)\nL0_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L0_EP1TP2PP0DP1_GPU49 [label="Expert Dispatch\nL0_EP1TP2PP0DP1_GPU49" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L0_EP1TP2PP0DP1_GPU49 [label="Expert 0\nL0_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L0_EP1TP2PP0DP1_GPU49 [label="Expert 1\nL0_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L0_EP1TP2PP0DP1_GPU49 [label="Expert 2\nL0_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L0_EP1TP2PP0DP1_GPU49 [label="Expert 3\nL0_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L0_EP1TP2PP0DP1_GPU49 [label="Expert Combine\nL0_EP1TP2PP0DP1_GPU49" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L0_EP1TP2PP0DP1_GPU49 [label="FFN (Up-proj + GeLU + Down-proj)\nL0_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L0_EP1TP2PP0DP1_GPU49 [label="FFN All-Reduce\nL0 EP1 TP Group 2 PP0 DP1\nGPU49" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L0_EP1TP2PP0DP1_GPU49 [label="Residual Add 2\nL0_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L0_EP1TP3PP0DP0_GPU56 [label="Layer Norm 1\nL0_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L0_EP1TP3PP0DP0_GPU56 [label="QKV Projection\nL0_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L0_EP1TP3PP0DP0_GPU56 [label="Multi-Head Attention\nL0_EP1TP3PP0DP0_GPU56\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L0_EP1TP3PP0DP0_GPU56 [label="Attention Output Proj\nL0_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L0_EP1TP3PP0DP0_GPU56 [label="Attention All-Reduce\nL0 EP1 TP Group 3 PP0 DP0\nGPU56" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L0_EP1TP3PP0DP0_GPU56 [label="Residual Add 1\nL0_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L0_EP1TP3PP0DP0_GPU56 [label="Layer Norm 2\nL0_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L0_EP1TP3PP0DP0_GPU56 [label="MoE Gate (Routing)\nL0_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L0_EP1TP3PP0DP0_GPU56 [label="Expert Dispatch\nL0_EP1TP3PP0DP0_GPU56" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L0_EP1TP3PP0DP0_GPU56 [label="Expert 0\nL0_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L0_EP1TP3PP0DP0_GPU56 [label="Expert 1\nL0_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L0_EP1TP3PP0DP0_GPU56 [label="Expert 2\nL0_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L0_EP1TP3PP0DP0_GPU56 [label="Expert 3\nL0_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L0_EP1TP3PP0DP0_GPU56 [label="Expert Combine\nL0_EP1TP3PP0DP0_GPU56" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L0_EP1TP3PP0DP0_GPU56 [label="FFN (Up-proj + GeLU + Down-proj)\nL0_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L0_EP1TP3PP0DP0_GPU56 [label="FFN All-Reduce\nL0 EP1 TP Group 3 PP0 DP0\nGPU56" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L0_EP1TP3PP0DP0_GPU56 [label="Residual Add 2\nL0_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L0_EP1TP3PP0DP1_GPU57 [label="Layer Norm 1\nL0_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L0_EP1TP3PP0DP1_GPU57 [label="QKV Projection\nL0_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L0_EP1TP3PP0DP1_GPU57 [label="Multi-Head Attention\nL0_EP1TP3PP0DP1_GPU57\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L0_EP1TP3PP0DP1_GPU57 [label="Attention Output Proj\nL0_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L0_EP1TP3PP0DP1_GPU57 [label="Attention All-Reduce\nL0 EP1 TP Group 3 PP0 DP1\nGPU57" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L0_EP1TP3PP0DP1_GPU57 [label="Residual Add 1\nL0_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L0_EP1TP3PP0DP1_GPU57 [label="Layer Norm 2\nL0_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L0_EP1TP3PP0DP1_GPU57 [label="MoE Gate (Routing)\nL0_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L0_EP1TP3PP0DP1_GPU57 [label="Expert Dispatch\nL0_EP1TP3PP0DP1_GPU57" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L0_EP1TP3PP0DP1_GPU57 [label="Expert 0\nL0_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L0_EP1TP3PP0DP1_GPU57 [label="Expert 1\nL0_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L0_EP1TP3PP0DP1_GPU57 [label="Expert 2\nL0_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L0_EP1TP3PP0DP1_GPU57 [label="Expert 3\nL0_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L0_EP1TP3PP0DP1_GPU57 [label="Expert Combine\nL0_EP1TP3PP0DP1_GPU57" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L0_EP1TP3PP0DP1_GPU57 [label="FFN (Up-proj + GeLU + Down-proj)\nL0_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L0_EP1TP3PP0DP1_GPU57 [label="FFN All-Reduce\nL0 EP1 TP Group 3 PP0 DP1\nGPU57" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L0_EP1TP3PP0DP1_GPU57 [label="Residual Add 2\nL0_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L1_EP0TP0PP0DP0_GPU0 [label="Layer Norm 1\nL1_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L1_EP0TP0PP0DP0_GPU0 [label="QKV Projection\nL1_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L1_EP0TP0PP0DP0_GPU0 [label="Multi-Head Attention\nL1_EP0TP0PP0DP0_GPU0\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L1_EP0TP0PP0DP0_GPU0 [label="Attention Output Proj\nL1_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L1_EP0TP0PP0DP0_GPU0 [label="Attention All-Reduce\nL1 EP0 TP Group 0 PP0 DP0\nGPU0" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L1_EP0TP0PP0DP0_GPU0 [label="Residual Add 1\nL1_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L1_EP0TP0PP0DP0_GPU0 [label="Layer Norm 2\nL1_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L1_EP0TP0PP0DP0_GPU0 [label="MoE Gate (Routing)\nL1_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L1_EP0TP0PP0DP0_GPU0 [label="Expert Dispatch\nL1_EP0TP0PP0DP0_GPU0" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L1_EP0TP0PP0DP0_GPU0 [label="Expert 0\nL1_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L1_EP0TP0PP0DP0_GPU0 [label="Expert 1\nL1_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L1_EP0TP0PP0DP0_GPU0 [label="Expert 2\nL1_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L1_EP0TP0PP0DP0_GPU0 [label="Expert 3\nL1_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L1_EP0TP0PP0DP0_GPU0 [label="Expert Combine\nL1_EP0TP0PP0DP0_GPU0" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L1_EP0TP0PP0DP0_GPU0 [label="FFN (Up-proj + GeLU + Down-proj)\nL1_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L1_EP0TP0PP0DP0_GPU0 [label="FFN All-Reduce\nL1 EP0 TP Group 0 PP0 DP0\nGPU0" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L1_EP0TP0PP0DP0_GPU0 [label="Residual Add 2\nL1_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L1_EP0TP0PP0DP1_GPU1 [label="Layer Norm 1\nL1_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L1_EP0TP0PP0DP1_GPU1 [label="QKV Projection\nL1_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L1_EP0TP0PP0DP1_GPU1 [label="Multi-Head Attention\nL1_EP0TP0PP0DP1_GPU1\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L1_EP0TP0PP0DP1_GPU1 [label="Attention Output Proj\nL1_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L1_EP0TP0PP0DP1_GPU1 [label="Attention All-Reduce\nL1 EP0 TP Group 0 PP0 DP1\nGPU1" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L1_EP0TP0PP0DP1_GPU1 [label="Residual Add 1\nL1_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L1_EP0TP0PP0DP1_GPU1 [label="Layer Norm 2\nL1_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L1_EP0TP0PP0DP1_GPU1 [label="MoE Gate (Routing)\nL1_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L1_EP0TP0PP0DP1_GPU1 [label="Expert Dispatch\nL1_EP0TP0PP0DP1_GPU1" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L1_EP0TP0PP0DP1_GPU1 [label="Expert 0\nL1_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L1_EP0TP0PP0DP1_GPU1 [label="Expert 1\nL1_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L1_EP0TP0PP0DP1_GPU1 [label="Expert 2\nL1_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L1_EP0TP0PP0DP1_GPU1 [label="Expert 3\nL1_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L1_EP0TP0PP0DP1_GPU1 [label="Expert Combine\nL1_EP0TP0PP0DP1_GPU1" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L1_EP0TP0PP0DP1_GPU1 [label="FFN (Up-proj + GeLU + Down-proj)\nL1_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L1_EP0TP0PP0DP1_GPU1 [label="FFN All-Reduce\nL1 EP0 TP Group 0 PP0 DP1\nGPU1" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L1_EP0TP0PP0DP1_GPU1 [label="Residual Add 2\nL1_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L1_EP0TP1PP0DP0_GPU8 [label="Layer Norm 1\nL1_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L1_EP0TP1PP0DP0_GPU8 [label="QKV Projection\nL1_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L1_EP0TP1PP0DP0_GPU8 [label="Multi-Head Attention\nL1_EP0TP1PP0DP0_GPU8\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L1_EP0TP1PP0DP0_GPU8 [label="Attention Output Proj\nL1_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L1_EP0TP1PP0DP0_GPU8 [label="Attention All-Reduce\nL1 EP0 TP Group 1 PP0 DP0\nGPU8" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L1_EP0TP1PP0DP0_GPU8 [label="Residual Add 1\nL1_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L1_EP0TP1PP0DP0_GPU8 [label="Layer Norm 2\nL1_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L1_EP0TP1PP0DP0_GPU8 [label="MoE Gate (Routing)\nL1_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L1_EP0TP1PP0DP0_GPU8 [label="Expert Dispatch\nL1_EP0TP1PP0DP0_GPU8" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L1_EP0TP1PP0DP0_GPU8 [label="Expert 0\nL1_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L1_EP0TP1PP0DP0_GPU8 [label="Expert 1\nL1_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L1_EP0TP1PP0DP0_GPU8 [label="Expert 2\nL1_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L1_EP0TP1PP0DP0_GPU8 [label="Expert 3\nL1_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L1_EP0TP1PP0DP0_GPU8 [label="Expert Combine\nL1_EP0TP1PP0DP0_GPU8" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L1_EP0TP1PP0DP0_GPU8 [label="FFN (Up-proj + GeLU + Down-proj)\nL1_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L1_EP0TP1PP0DP0_GPU8 [label="FFN All-Reduce\nL1 EP0 TP Group 1 PP0 DP0\nGPU8" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L1_EP0TP1PP0DP0_GPU8 [label="Residual Add 2\nL1_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L1_EP0TP1PP0DP1_GPU9 [label="Layer Norm 1\nL1_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L1_EP0TP1PP0DP1_GPU9 [label="QKV Projection\nL1_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L1_EP0TP1PP0DP1_GPU9 [label="Multi-Head Attention\nL1_EP0TP1PP0DP1_GPU9\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L1_EP0TP1PP0DP1_GPU9 [label="Attention Output Proj\nL1_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L1_EP0TP1PP0DP1_GPU9 [label="Attention All-Reduce\nL1 EP0 TP Group 1 PP0 DP1\nGPU9" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L1_EP0TP1PP0DP1_GPU9 [label="Residual Add 1\nL1_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L1_EP0TP1PP0DP1_GPU9 [label="Layer Norm 2\nL1_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L1_EP0TP1PP0DP1_GPU9 [label="MoE Gate (Routing)\nL1_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L1_EP0TP1PP0DP1_GPU9 [label="Expert Dispatch\nL1_EP0TP1PP0DP1_GPU9" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L1_EP0TP1PP0DP1_GPU9 [label="Expert 0\nL1_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L1_EP0TP1PP0DP1_GPU9 [label="Expert 1\nL1_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L1_EP0TP1PP0DP1_GPU9 [label="Expert 2\nL1_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L1_EP0TP1PP0DP1_GPU9 [label="Expert 3\nL1_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L1_EP0TP1PP0DP1_GPU9 [label="Expert Combine\nL1_EP0TP1PP0DP1_GPU9" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L1_EP0TP1PP0DP1_GPU9 [label="FFN (Up-proj + GeLU + Down-proj)\nL1_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L1_EP0TP1PP0DP1_GPU9 [label="FFN All-Reduce\nL1 EP0 TP Group 1 PP0 DP1\nGPU9" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L1_EP0TP1PP0DP1_GPU9 [label="Residual Add 2\nL1_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L1_EP0TP2PP0DP0_GPU16 [label="Layer Norm 1\nL1_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L1_EP0TP2PP0DP0_GPU16 [label="QKV Projection\nL1_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L1_EP0TP2PP0DP0_GPU16 [label="Multi-Head Attention\nL1_EP0TP2PP0DP0_GPU16\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L1_EP0TP2PP0DP0_GPU16 [label="Attention Output Proj\nL1_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L1_EP0TP2PP0DP0_GPU16 [label="Attention All-Reduce\nL1 EP0 TP Group 2 PP0 DP0\nGPU16" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L1_EP0TP2PP0DP0_GPU16 [label="Residual Add 1\nL1_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L1_EP0TP2PP0DP0_GPU16 [label="Layer Norm 2\nL1_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L1_EP0TP2PP0DP0_GPU16 [label="MoE Gate (Routing)\nL1_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L1_EP0TP2PP0DP0_GPU16 [label="Expert Dispatch\nL1_EP0TP2PP0DP0_GPU16" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L1_EP0TP2PP0DP0_GPU16 [label="Expert 0\nL1_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L1_EP0TP2PP0DP0_GPU16 [label="Expert 1\nL1_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L1_EP0TP2PP0DP0_GPU16 [label="Expert 2\nL1_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L1_EP0TP2PP0DP0_GPU16 [label="Expert 3\nL1_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L1_EP0TP2PP0DP0_GPU16 [label="Expert Combine\nL1_EP0TP2PP0DP0_GPU16" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L1_EP0TP2PP0DP0_GPU16 [label="FFN (Up-proj + GeLU + Down-proj)\nL1_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L1_EP0TP2PP0DP0_GPU16 [label="FFN All-Reduce\nL1 EP0 TP Group 2 PP0 DP0\nGPU16" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L1_EP0TP2PP0DP0_GPU16 [label="Residual Add 2\nL1_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L1_EP0TP2PP0DP1_GPU17 [label="Layer Norm 1\nL1_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L1_EP0TP2PP0DP1_GPU17 [label="QKV Projection\nL1_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L1_EP0TP2PP0DP1_GPU17 [label="Multi-Head Attention\nL1_EP0TP2PP0DP1_GPU17\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L1_EP0TP2PP0DP1_GPU17 [label="Attention Output Proj\nL1_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L1_EP0TP2PP0DP1_GPU17 [label="Attention All-Reduce\nL1 EP0 TP Group 2 PP0 DP1\nGPU17" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L1_EP0TP2PP0DP1_GPU17 [label="Residual Add 1\nL1_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L1_EP0TP2PP0DP1_GPU17 [label="Layer Norm 2\nL1_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L1_EP0TP2PP0DP1_GPU17 [label="MoE Gate (Routing)\nL1_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L1_EP0TP2PP0DP1_GPU17 [label="Expert Dispatch\nL1_EP0TP2PP0DP1_GPU17" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L1_EP0TP2PP0DP1_GPU17 [label="Expert 0\nL1_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L1_EP0TP2PP0DP1_GPU17 [label="Expert 1\nL1_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L1_EP0TP2PP0DP1_GPU17 [label="Expert 2\nL1_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L1_EP0TP2PP0DP1_GPU17 [label="Expert 3\nL1_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L1_EP0TP2PP0DP1_GPU17 [label="Expert Combine\nL1_EP0TP2PP0DP1_GPU17" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L1_EP0TP2PP0DP1_GPU17 [label="FFN (Up-proj + GeLU + Down-proj)\nL1_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L1_EP0TP2PP0DP1_GPU17 [label="FFN All-Reduce\nL1 EP0 TP Group 2 PP0 DP1\nGPU17" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L1_EP0TP2PP0DP1_GPU17 [label="Residual Add 2\nL1_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L1_EP0TP3PP0DP0_GPU24 [label="Layer Norm 1\nL1_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L1_EP0TP3PP0DP0_GPU24 [label="QKV Projection\nL1_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L1_EP0TP3PP0DP0_GPU24 [label="Multi-Head Attention\nL1_EP0TP3PP0DP0_GPU24\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L1_EP0TP3PP0DP0_GPU24 [label="Attention Output Proj\nL1_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L1_EP0TP3PP0DP0_GPU24 [label="Attention All-Reduce\nL1 EP0 TP Group 3 PP0 DP0\nGPU24" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L1_EP0TP3PP0DP0_GPU24 [label="Residual Add 1\nL1_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L1_EP0TP3PP0DP0_GPU24 [label="Layer Norm 2\nL1_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L1_EP0TP3PP0DP0_GPU24 [label="MoE Gate (Routing)\nL1_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L1_EP0TP3PP0DP0_GPU24 [label="Expert Dispatch\nL1_EP0TP3PP0DP0_GPU24" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L1_EP0TP3PP0DP0_GPU24 [label="Expert 0\nL1_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L1_EP0TP3PP0DP0_GPU24 [label="Expert 1\nL1_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L1_EP0TP3PP0DP0_GPU24 [label="Expert 2\nL1_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L1_EP0TP3PP0DP0_GPU24 [label="Expert 3\nL1_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L1_EP0TP3PP0DP0_GPU24 [label="Expert Combine\nL1_EP0TP3PP0DP0_GPU24" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L1_EP0TP3PP0DP0_GPU24 [label="FFN (Up-proj + GeLU + Down-proj)\nL1_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L1_EP0TP3PP0DP0_GPU24 [label="FFN All-Reduce\nL1 EP0 TP Group 3 PP0 DP0\nGPU24" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L1_EP0TP3PP0DP0_GPU24 [label="Residual Add 2\nL1_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L1_EP0TP3PP0DP1_GPU25 [label="Layer Norm 1\nL1_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L1_EP0TP3PP0DP1_GPU25 [label="QKV Projection\nL1_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L1_EP0TP3PP0DP1_GPU25 [label="Multi-Head Attention\nL1_EP0TP3PP0DP1_GPU25\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L1_EP0TP3PP0DP1_GPU25 [label="Attention Output Proj\nL1_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L1_EP0TP3PP0DP1_GPU25 [label="Attention All-Reduce\nL1 EP0 TP Group 3 PP0 DP1\nGPU25" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L1_EP0TP3PP0DP1_GPU25 [label="Residual Add 1\nL1_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L1_EP0TP3PP0DP1_GPU25 [label="Layer Norm 2\nL1_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L1_EP0TP3PP0DP1_GPU25 [label="MoE Gate (Routing)\nL1_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L1_EP0TP3PP0DP1_GPU25 [label="Expert Dispatch\nL1_EP0TP3PP0DP1_GPU25" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L1_EP0TP3PP0DP1_GPU25 [label="Expert 0\nL1_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L1_EP0TP3PP0DP1_GPU25 [label="Expert 1\nL1_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L1_EP0TP3PP0DP1_GPU25 [label="Expert 2\nL1_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L1_EP0TP3PP0DP1_GPU25 [label="Expert 3\nL1_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L1_EP0TP3PP0DP1_GPU25 [label="Expert Combine\nL1_EP0TP3PP0DP1_GPU25" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L1_EP0TP3PP0DP1_GPU25 [label="FFN (Up-proj + GeLU + Down-proj)\nL1_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L1_EP0TP3PP0DP1_GPU25 [label="FFN All-Reduce\nL1 EP0 TP Group 3 PP0 DP1\nGPU25" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L1_EP0TP3PP0DP1_GPU25 [label="Residual Add 2\nL1_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L1_EP1TP0PP0DP0_GPU32 [label="Layer Norm 1\nL1_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L1_EP1TP0PP0DP0_GPU32 [label="QKV Projection\nL1_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L1_EP1TP0PP0DP0_GPU32 [label="Multi-Head Attention\nL1_EP1TP0PP0DP0_GPU32\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L1_EP1TP0PP0DP0_GPU32 [label="Attention Output Proj\nL1_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L1_EP1TP0PP0DP0_GPU32 [label="Attention All-Reduce\nL1 EP1 TP Group 0 PP0 DP0\nGPU32" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L1_EP1TP0PP0DP0_GPU32 [label="Residual Add 1\nL1_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L1_EP1TP0PP0DP0_GPU32 [label="Layer Norm 2\nL1_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L1_EP1TP0PP0DP0_GPU32 [label="MoE Gate (Routing)\nL1_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L1_EP1TP0PP0DP0_GPU32 [label="Expert Dispatch\nL1_EP1TP0PP0DP0_GPU32" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L1_EP1TP0PP0DP0_GPU32 [label="Expert 0\nL1_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L1_EP1TP0PP0DP0_GPU32 [label="Expert 1\nL1_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L1_EP1TP0PP0DP0_GPU32 [label="Expert 2\nL1_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L1_EP1TP0PP0DP0_GPU32 [label="Expert 3\nL1_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L1_EP1TP0PP0DP0_GPU32 [label="Expert Combine\nL1_EP1TP0PP0DP0_GPU32" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L1_EP1TP0PP0DP0_GPU32 [label="FFN (Up-proj + GeLU + Down-proj)\nL1_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L1_EP1TP0PP0DP0_GPU32 [label="FFN All-Reduce\nL1 EP1 TP Group 0 PP0 DP0\nGPU32" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L1_EP1TP0PP0DP0_GPU32 [label="Residual Add 2\nL1_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L1_EP1TP0PP0DP1_GPU33 [label="Layer Norm 1\nL1_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L1_EP1TP0PP0DP1_GPU33 [label="QKV Projection\nL1_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L1_EP1TP0PP0DP1_GPU33 [label="Multi-Head Attention\nL1_EP1TP0PP0DP1_GPU33\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L1_EP1TP0PP0DP1_GPU33 [label="Attention Output Proj\nL1_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L1_EP1TP0PP0DP1_GPU33 [label="Attention All-Reduce\nL1 EP1 TP Group 0 PP0 DP1\nGPU33" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L1_EP1TP0PP0DP1_GPU33 [label="Residual Add 1\nL1_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L1_EP1TP0PP0DP1_GPU33 [label="Layer Norm 2\nL1_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L1_EP1TP0PP0DP1_GPU33 [label="MoE Gate (Routing)\nL1_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L1_EP1TP0PP0DP1_GPU33 [label="Expert Dispatch\nL1_EP1TP0PP0DP1_GPU33" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L1_EP1TP0PP0DP1_GPU33 [label="Expert 0\nL1_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L1_EP1TP0PP0DP1_GPU33 [label="Expert 1\nL1_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L1_EP1TP0PP0DP1_GPU33 [label="Expert 2\nL1_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L1_EP1TP0PP0DP1_GPU33 [label="Expert 3\nL1_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L1_EP1TP0PP0DP1_GPU33 [label="Expert Combine\nL1_EP1TP0PP0DP1_GPU33" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L1_EP1TP0PP0DP1_GPU33 [label="FFN (Up-proj + GeLU + Down-proj)\nL1_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L1_EP1TP0PP0DP1_GPU33 [label="FFN All-Reduce\nL1 EP1 TP Group 0 PP0 DP1\nGPU33" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L1_EP1TP0PP0DP1_GPU33 [label="Residual Add 2\nL1_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L1_EP1TP1PP0DP0_GPU40 [label="Layer Norm 1\nL1_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L1_EP1TP1PP0DP0_GPU40 [label="QKV Projection\nL1_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L1_EP1TP1PP0DP0_GPU40 [label="Multi-Head Attention\nL1_EP1TP1PP0DP0_GPU40\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L1_EP1TP1PP0DP0_GPU40 [label="Attention Output Proj\nL1_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L1_EP1TP1PP0DP0_GPU40 [label="Attention All-Reduce\nL1 EP1 TP Group 1 PP0 DP0\nGPU40" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L1_EP1TP1PP0DP0_GPU40 [label="Residual Add 1\nL1_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L1_EP1TP1PP0DP0_GPU40 [label="Layer Norm 2\nL1_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L1_EP1TP1PP0DP0_GPU40 [label="MoE Gate (Routing)\nL1_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L1_EP1TP1PP0DP0_GPU40 [label="Expert Dispatch\nL1_EP1TP1PP0DP0_GPU40" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L1_EP1TP1PP0DP0_GPU40 [label="Expert 0\nL1_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L1_EP1TP1PP0DP0_GPU40 [label="Expert 1\nL1_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L1_EP1TP1PP0DP0_GPU40 [label="Expert 2\nL1_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L1_EP1TP1PP0DP0_GPU40 [label="Expert 3\nL1_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L1_EP1TP1PP0DP0_GPU40 [label="Expert Combine\nL1_EP1TP1PP0DP0_GPU40" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L1_EP1TP1PP0DP0_GPU40 [label="FFN (Up-proj + GeLU + Down-proj)\nL1_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L1_EP1TP1PP0DP0_GPU40 [label="FFN All-Reduce\nL1 EP1 TP Group 1 PP0 DP0\nGPU40" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L1_EP1TP1PP0DP0_GPU40 [label="Residual Add 2\nL1_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L1_EP1TP1PP0DP1_GPU41 [label="Layer Norm 1\nL1_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L1_EP1TP1PP0DP1_GPU41 [label="QKV Projection\nL1_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L1_EP1TP1PP0DP1_GPU41 [label="Multi-Head Attention\nL1_EP1TP1PP0DP1_GPU41\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L1_EP1TP1PP0DP1_GPU41 [label="Attention Output Proj\nL1_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L1_EP1TP1PP0DP1_GPU41 [label="Attention All-Reduce\nL1 EP1 TP Group 1 PP0 DP1\nGPU41" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L1_EP1TP1PP0DP1_GPU41 [label="Residual Add 1\nL1_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L1_EP1TP1PP0DP1_GPU41 [label="Layer Norm 2\nL1_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L1_EP1TP1PP0DP1_GPU41 [label="MoE Gate (Routing)\nL1_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L1_EP1TP1PP0DP1_GPU41 [label="Expert Dispatch\nL1_EP1TP1PP0DP1_GPU41" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L1_EP1TP1PP0DP1_GPU41 [label="Expert 0\nL1_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L1_EP1TP1PP0DP1_GPU41 [label="Expert 1\nL1_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L1_EP1TP1PP0DP1_GPU41 [label="Expert 2\nL1_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L1_EP1TP1PP0DP1_GPU41 [label="Expert 3\nL1_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L1_EP1TP1PP0DP1_GPU41 [label="Expert Combine\nL1_EP1TP1PP0DP1_GPU41" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L1_EP1TP1PP0DP1_GPU41 [label="FFN (Up-proj + GeLU + Down-proj)\nL1_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L1_EP1TP1PP0DP1_GPU41 [label="FFN All-Reduce\nL1 EP1 TP Group 1 PP0 DP1\nGPU41" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L1_EP1TP1PP0DP1_GPU41 [label="Residual Add 2\nL1_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L1_EP1TP2PP0DP0_GPU48 [label="Layer Norm 1\nL1_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L1_EP1TP2PP0DP0_GPU48 [label="QKV Projection\nL1_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L1_EP1TP2PP0DP0_GPU48 [label="Multi-Head Attention\nL1_EP1TP2PP0DP0_GPU48\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L1_EP1TP2PP0DP0_GPU48 [label="Attention Output Proj\nL1_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L1_EP1TP2PP0DP0_GPU48 [label="Attention All-Reduce\nL1 EP1 TP Group 2 PP0 DP0\nGPU48" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L1_EP1TP2PP0DP0_GPU48 [label="Residual Add 1\nL1_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L1_EP1TP2PP0DP0_GPU48 [label="Layer Norm 2\nL1_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L1_EP1TP2PP0DP0_GPU48 [label="MoE Gate (Routing)\nL1_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L1_EP1TP2PP0DP0_GPU48 [label="Expert Dispatch\nL1_EP1TP2PP0DP0_GPU48" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L1_EP1TP2PP0DP0_GPU48 [label="Expert 0\nL1_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L1_EP1TP2PP0DP0_GPU48 [label="Expert 1\nL1_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L1_EP1TP2PP0DP0_GPU48 [label="Expert 2\nL1_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L1_EP1TP2PP0DP0_GPU48 [label="Expert 3\nL1_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L1_EP1TP2PP0DP0_GPU48 [label="Expert Combine\nL1_EP1TP2PP0DP0_GPU48" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L1_EP1TP2PP0DP0_GPU48 [label="FFN (Up-proj + GeLU + Down-proj)\nL1_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L1_EP1TP2PP0DP0_GPU48 [label="FFN All-Reduce\nL1 EP1 TP Group 2 PP0 DP0\nGPU48" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L1_EP1TP2PP0DP0_GPU48 [label="Residual Add 2\nL1_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L1_EP1TP2PP0DP1_GPU49 [label="Layer Norm 1\nL1_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L1_EP1TP2PP0DP1_GPU49 [label="QKV Projection\nL1_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L1_EP1TP2PP0DP1_GPU49 [label="Multi-Head Attention\nL1_EP1TP2PP0DP1_GPU49\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L1_EP1TP2PP0DP1_GPU49 [label="Attention Output Proj\nL1_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L1_EP1TP2PP0DP1_GPU49 [label="Attention All-Reduce\nL1 EP1 TP Group 2 PP0 DP1\nGPU49" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L1_EP1TP2PP0DP1_GPU49 [label="Residual Add 1\nL1_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L1_EP1TP2PP0DP1_GPU49 [label="Layer Norm 2\nL1_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L1_EP1TP2PP0DP1_GPU49 [label="MoE Gate (Routing)\nL1_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L1_EP1TP2PP0DP1_GPU49 [label="Expert Dispatch\nL1_EP1TP2PP0DP1_GPU49" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L1_EP1TP2PP0DP1_GPU49 [label="Expert 0\nL1_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L1_EP1TP2PP0DP1_GPU49 [label="Expert 1\nL1_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L1_EP1TP2PP0DP1_GPU49 [label="Expert 2\nL1_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L1_EP1TP2PP0DP1_GPU49 [label="Expert 3\nL1_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L1_EP1TP2PP0DP1_GPU49 [label="Expert Combine\nL1_EP1TP2PP0DP1_GPU49" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L1_EP1TP2PP0DP1_GPU49 [label="FFN (Up-proj + GeLU + Down-proj)\nL1_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L1_EP1TP2PP0DP1_GPU49 [label="FFN All-Reduce\nL1 EP1 TP Group 2 PP0 DP1\nGPU49" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L1_EP1TP2PP0DP1_GPU49 [label="Residual Add 2\nL1_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L1_EP1TP3PP0DP0_GPU56 [label="Layer Norm 1\nL1_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L1_EP1TP3PP0DP0_GPU56 [label="QKV Projection\nL1_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L1_EP1TP3PP0DP0_GPU56 [label="Multi-Head Attention\nL1_EP1TP3PP0DP0_GPU56\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L1_EP1TP3PP0DP0_GPU56 [label="Attention Output Proj\nL1_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L1_EP1TP3PP0DP0_GPU56 [label="Attention All-Reduce\nL1 EP1 TP Group 3 PP0 DP0\nGPU56" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L1_EP1TP3PP0DP0_GPU56 [label="Residual Add 1\nL1_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L1_EP1TP3PP0DP0_GPU56 [label="Layer Norm 2\nL1_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L1_EP1TP3PP0DP0_GPU56 [label="MoE Gate (Routing)\nL1_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L1_EP1TP3PP0DP0_GPU56 [label="Expert Dispatch\nL1_EP1TP3PP0DP0_GPU56" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L1_EP1TP3PP0DP0_GPU56 [label="Expert 0\nL1_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L1_EP1TP3PP0DP0_GPU56 [label="Expert 1\nL1_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L1_EP1TP3PP0DP0_GPU56 [label="Expert 2\nL1_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L1_EP1TP3PP0DP0_GPU56 [label="Expert 3\nL1_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L1_EP1TP3PP0DP0_GPU56 [label="Expert Combine\nL1_EP1TP3PP0DP0_GPU56" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L1_EP1TP3PP0DP0_GPU56 [label="FFN (Up-proj + GeLU + Down-proj)\nL1_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L1_EP1TP3PP0DP0_GPU56 [label="FFN All-Reduce\nL1 EP1 TP Group 3 PP0 DP0\nGPU56" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L1_EP1TP3PP0DP0_GPU56 [label="Residual Add 2\nL1_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L1_EP1TP3PP0DP1_GPU57 [label="Layer Norm 1\nL1_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L1_EP1TP3PP0DP1_GPU57 [label="QKV Projection\nL1_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L1_EP1TP3PP0DP1_GPU57 [label="Multi-Head Attention\nL1_EP1TP3PP0DP1_GPU57\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L1_EP1TP3PP0DP1_GPU57 [label="Attention Output Proj\nL1_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L1_EP1TP3PP0DP1_GPU57 [label="Attention All-Reduce\nL1 EP1 TP Group 3 PP0 DP1\nGPU57" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L1_EP1TP3PP0DP1_GPU57 [label="Residual Add 1\nL1_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L1_EP1TP3PP0DP1_GPU57 [label="Layer Norm 2\nL1_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L1_EP1TP3PP0DP1_GPU57 [label="MoE Gate (Routing)\nL1_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L1_EP1TP3PP0DP1_GPU57 [label="Expert Dispatch\nL1_EP1TP3PP0DP1_GPU57" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L1_EP1TP3PP0DP1_GPU57 [label="Expert 0\nL1_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L1_EP1TP3PP0DP1_GPU57 [label="Expert 1\nL1_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L1_EP1TP3PP0DP1_GPU57 [label="Expert 2\nL1_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L1_EP1TP3PP0DP1_GPU57 [label="Expert 3\nL1_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L1_EP1TP3PP0DP1_GPU57 [label="Expert Combine\nL1_EP1TP3PP0DP1_GPU57" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L1_EP1TP3PP0DP1_GPU57 [label="FFN (Up-proj + GeLU + Down-proj)\nL1_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L1_EP1TP3PP0DP1_GPU57 [label="FFN All-Reduce\nL1 EP1 TP Group 3 PP0 DP1\nGPU57" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L1_EP1TP3PP0DP1_GPU57 [label="Residual Add 2\nL1_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L2_EP0TP0PP0DP0_GPU0 [label="Layer Norm 1\nL2_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L2_EP0TP0PP0DP0_GPU0 [label="QKV Projection\nL2_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L2_EP0TP0PP0DP0_GPU0 [label="Multi-Head Attention\nL2_EP0TP0PP0DP0_GPU0\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L2_EP0TP0PP0DP0_GPU0 [label="Attention Output Proj\nL2_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L2_EP0TP0PP0DP0_GPU0 [label="Attention All-Reduce\nL2 EP0 TP Group 0 PP0 DP0\nGPU0" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L2_EP0TP0PP0DP0_GPU0 [label="Residual Add 1\nL2_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L2_EP0TP0PP0DP0_GPU0 [label="Layer Norm 2\nL2_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L2_EP0TP0PP0DP0_GPU0 [label="MoE Gate (Routing)\nL2_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L2_EP0TP0PP0DP0_GPU0 [label="Expert Dispatch\nL2_EP0TP0PP0DP0_GPU0" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L2_EP0TP0PP0DP0_GPU0 [label="Expert 0\nL2_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L2_EP0TP0PP0DP0_GPU0 [label="Expert 1\nL2_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L2_EP0TP0PP0DP0_GPU0 [label="Expert 2\nL2_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L2_EP0TP0PP0DP0_GPU0 [label="Expert 3\nL2_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L2_EP0TP0PP0DP0_GPU0 [label="Expert Combine\nL2_EP0TP0PP0DP0_GPU0" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L2_EP0TP0PP0DP0_GPU0 [label="FFN (Up-proj + GeLU + Down-proj)\nL2_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L2_EP0TP0PP0DP0_GPU0 [label="FFN All-Reduce\nL2 EP0 TP Group 0 PP0 DP0\nGPU0" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L2_EP0TP0PP0DP0_GPU0 [label="Residual Add 2\nL2_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L2_EP0TP0PP0DP1_GPU1 [label="Layer Norm 1\nL2_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L2_EP0TP0PP0DP1_GPU1 [label="QKV Projection\nL2_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L2_EP0TP0PP0DP1_GPU1 [label="Multi-Head Attention\nL2_EP0TP0PP0DP1_GPU1\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L2_EP0TP0PP0DP1_GPU1 [label="Attention Output Proj\nL2_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L2_EP0TP0PP0DP1_GPU1 [label="Attention All-Reduce\nL2 EP0 TP Group 0 PP0 DP1\nGPU1" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L2_EP0TP0PP0DP1_GPU1 [label="Residual Add 1\nL2_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L2_EP0TP0PP0DP1_GPU1 [label="Layer Norm 2\nL2_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L2_EP0TP0PP0DP1_GPU1 [label="MoE Gate (Routing)\nL2_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L2_EP0TP0PP0DP1_GPU1 [label="Expert Dispatch\nL2_EP0TP0PP0DP1_GPU1" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L2_EP0TP0PP0DP1_GPU1 [label="Expert 0\nL2_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L2_EP0TP0PP0DP1_GPU1 [label="Expert 1\nL2_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L2_EP0TP0PP0DP1_GPU1 [label="Expert 2\nL2_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L2_EP0TP0PP0DP1_GPU1 [label="Expert 3\nL2_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L2_EP0TP0PP0DP1_GPU1 [label="Expert Combine\nL2_EP0TP0PP0DP1_GPU1" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L2_EP0TP0PP0DP1_GPU1 [label="FFN (Up-proj + GeLU + Down-proj)\nL2_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L2_EP0TP0PP0DP1_GPU1 [label="FFN All-Reduce\nL2 EP0 TP Group 0 PP0 DP1\nGPU1" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L2_EP0TP0PP0DP1_GPU1 [label="Residual Add 2\nL2_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L2_EP0TP1PP0DP0_GPU8 [label="Layer Norm 1\nL2_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L2_EP0TP1PP0DP0_GPU8 [label="QKV Projection\nL2_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L2_EP0TP1PP0DP0_GPU8 [label="Multi-Head Attention\nL2_EP0TP1PP0DP0_GPU8\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L2_EP0TP1PP0DP0_GPU8 [label="Attention Output Proj\nL2_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L2_EP0TP1PP0DP0_GPU8 [label="Attention All-Reduce\nL2 EP0 TP Group 1 PP0 DP0\nGPU8" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L2_EP0TP1PP0DP0_GPU8 [label="Residual Add 1\nL2_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L2_EP0TP1PP0DP0_GPU8 [label="Layer Norm 2\nL2_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L2_EP0TP1PP0DP0_GPU8 [label="MoE Gate (Routing)\nL2_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L2_EP0TP1PP0DP0_GPU8 [label="Expert Dispatch\nL2_EP0TP1PP0DP0_GPU8" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L2_EP0TP1PP0DP0_GPU8 [label="Expert 0\nL2_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L2_EP0TP1PP0DP0_GPU8 [label="Expert 1\nL2_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L2_EP0TP1PP0DP0_GPU8 [label="Expert 2\nL2_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L2_EP0TP1PP0DP0_GPU8 [label="Expert 3\nL2_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L2_EP0TP1PP0DP0_GPU8 [label="Expert Combine\nL2_EP0TP1PP0DP0_GPU8" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L2_EP0TP1PP0DP0_GPU8 [label="FFN (Up-proj + GeLU + Down-proj)\nL2_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L2_EP0TP1PP0DP0_GPU8 [label="FFN All-Reduce\nL2 EP0 TP Group 1 PP0 DP0\nGPU8" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L2_EP0TP1PP0DP0_GPU8 [label="Residual Add 2\nL2_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L2_EP0TP1PP0DP1_GPU9 [label="Layer Norm 1\nL2_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L2_EP0TP1PP0DP1_GPU9 [label="QKV Projection\nL2_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L2_EP0TP1PP0DP1_GPU9 [label="Multi-Head Attention\nL2_EP0TP1PP0DP1_GPU9\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L2_EP0TP1PP0DP1_GPU9 [label="Attention Output Proj\nL2_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L2_EP0TP1PP0DP1_GPU9 [label="Attention All-Reduce\nL2 EP0 TP Group 1 PP0 DP1\nGPU9" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L2_EP0TP1PP0DP1_GPU9 [label="Residual Add 1\nL2_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L2_EP0TP1PP0DP1_GPU9 [label="Layer Norm 2\nL2_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L2_EP0TP1PP0DP1_GPU9 [label="MoE Gate (Routing)\nL2_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L2_EP0TP1PP0DP1_GPU9 [label="Expert Dispatch\nL2_EP0TP1PP0DP1_GPU9" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L2_EP0TP1PP0DP1_GPU9 [label="Expert 0\nL2_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L2_EP0TP1PP0DP1_GPU9 [label="Expert 1\nL2_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L2_EP0TP1PP0DP1_GPU9 [label="Expert 2\nL2_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L2_EP0TP1PP0DP1_GPU9 [label="Expert 3\nL2_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L2_EP0TP1PP0DP1_GPU9 [label="Expert Combine\nL2_EP0TP1PP0DP1_GPU9" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L2_EP0TP1PP0DP1_GPU9 [label="FFN (Up-proj + GeLU + Down-proj)\nL2_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L2_EP0TP1PP0DP1_GPU9 [label="FFN All-Reduce\nL2 EP0 TP Group 1 PP0 DP1\nGPU9" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L2_EP0TP1PP0DP1_GPU9 [label="Residual Add 2\nL2_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L2_EP0TP2PP0DP0_GPU16 [label="Layer Norm 1\nL2_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L2_EP0TP2PP0DP0_GPU16 [label="QKV Projection\nL2_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L2_EP0TP2PP0DP0_GPU16 [label="Multi-Head Attention\nL2_EP0TP2PP0DP0_GPU16\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L2_EP0TP2PP0DP0_GPU16 [label="Attention Output Proj\nL2_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L2_EP0TP2PP0DP0_GPU16 [label="Attention All-Reduce\nL2 EP0 TP Group 2 PP0 DP0\nGPU16" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L2_EP0TP2PP0DP0_GPU16 [label="Residual Add 1\nL2_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L2_EP0TP2PP0DP0_GPU16 [label="Layer Norm 2\nL2_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L2_EP0TP2PP0DP0_GPU16 [label="MoE Gate (Routing)\nL2_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L2_EP0TP2PP0DP0_GPU16 [label="Expert Dispatch\nL2_EP0TP2PP0DP0_GPU16" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L2_EP0TP2PP0DP0_GPU16 [label="Expert 0\nL2_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L2_EP0TP2PP0DP0_GPU16 [label="Expert 1\nL2_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L2_EP0TP2PP0DP0_GPU16 [label="Expert 2\nL2_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L2_EP0TP2PP0DP0_GPU16 [label="Expert 3\nL2_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L2_EP0TP2PP0DP0_GPU16 [label="Expert Combine\nL2_EP0TP2PP0DP0_GPU16" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L2_EP0TP2PP0DP0_GPU16 [label="FFN (Up-proj + GeLU + Down-proj)\nL2_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L2_EP0TP2PP0DP0_GPU16 [label="FFN All-Reduce\nL2 EP0 TP Group 2 PP0 DP0\nGPU16" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L2_EP0TP2PP0DP0_GPU16 [label="Residual Add 2\nL2_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L2_EP0TP2PP0DP1_GPU17 [label="Layer Norm 1\nL2_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L2_EP0TP2PP0DP1_GPU17 [label="QKV Projection\nL2_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L2_EP0TP2PP0DP1_GPU17 [label="Multi-Head Attention\nL2_EP0TP2PP0DP1_GPU17\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L2_EP0TP2PP0DP1_GPU17 [label="Attention Output Proj\nL2_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L2_EP0TP2PP0DP1_GPU17 [label="Attention All-Reduce\nL2 EP0 TP Group 2 PP0 DP1\nGPU17" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L2_EP0TP2PP0DP1_GPU17 [label="Residual Add 1\nL2_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L2_EP0TP2PP0DP1_GPU17 [label="Layer Norm 2\nL2_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L2_EP0TP2PP0DP1_GPU17 [label="MoE Gate (Routing)\nL2_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L2_EP0TP2PP0DP1_GPU17 [label="Expert Dispatch\nL2_EP0TP2PP0DP1_GPU17" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L2_EP0TP2PP0DP1_GPU17 [label="Expert 0\nL2_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L2_EP0TP2PP0DP1_GPU17 [label="Expert 1\nL2_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L2_EP0TP2PP0DP1_GPU17 [label="Expert 2\nL2_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L2_EP0TP2PP0DP1_GPU17 [label="Expert 3\nL2_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L2_EP0TP2PP0DP1_GPU17 [label="Expert Combine\nL2_EP0TP2PP0DP1_GPU17" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L2_EP0TP2PP0DP1_GPU17 [label="FFN (Up-proj + GeLU + Down-proj)\nL2_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L2_EP0TP2PP0DP1_GPU17 [label="FFN All-Reduce\nL2 EP0 TP Group 2 PP0 DP1\nGPU17" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L2_EP0TP2PP0DP1_GPU17 [label="Residual Add 2\nL2_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L2_EP0TP3PP0DP0_GPU24 [label="Layer Norm 1\nL2_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L2_EP0TP3PP0DP0_GPU24 [label="QKV Projection\nL2_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L2_EP0TP3PP0DP0_GPU24 [label="Multi-Head Attention\nL2_EP0TP3PP0DP0_GPU24\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L2_EP0TP3PP0DP0_GPU24 [label="Attention Output Proj\nL2_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L2_EP0TP3PP0DP0_GPU24 [label="Attention All-Reduce\nL2 EP0 TP Group 3 PP0 DP0\nGPU24" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L2_EP0TP3PP0DP0_GPU24 [label="Residual Add 1\nL2_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L2_EP0TP3PP0DP0_GPU24 [label="Layer Norm 2\nL2_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L2_EP0TP3PP0DP0_GPU24 [label="MoE Gate (Routing)\nL2_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L2_EP0TP3PP0DP0_GPU24 [label="Expert Dispatch\nL2_EP0TP3PP0DP0_GPU24" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L2_EP0TP3PP0DP0_GPU24 [label="Expert 0\nL2_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L2_EP0TP3PP0DP0_GPU24 [label="Expert 1\nL2_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L2_EP0TP3PP0DP0_GPU24 [label="Expert 2\nL2_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L2_EP0TP3PP0DP0_GPU24 [label="Expert 3\nL2_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L2_EP0TP3PP0DP0_GPU24 [label="Expert Combine\nL2_EP0TP3PP0DP0_GPU24" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L2_EP0TP3PP0DP0_GPU24 [label="FFN (Up-proj + GeLU + Down-proj)\nL2_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L2_EP0TP3PP0DP0_GPU24 [label="FFN All-Reduce\nL2 EP0 TP Group 3 PP0 DP0\nGPU24" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L2_EP0TP3PP0DP0_GPU24 [label="Residual Add 2\nL2_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L2_EP0TP3PP0DP1_GPU25 [label="Layer Norm 1\nL2_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L2_EP0TP3PP0DP1_GPU25 [label="QKV Projection\nL2_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L2_EP0TP3PP0DP1_GPU25 [label="Multi-Head Attention\nL2_EP0TP3PP0DP1_GPU25\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L2_EP0TP3PP0DP1_GPU25 [label="Attention Output Proj\nL2_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L2_EP0TP3PP0DP1_GPU25 [label="Attention All-Reduce\nL2 EP0 TP Group 3 PP0 DP1\nGPU25" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L2_EP0TP3PP0DP1_GPU25 [label="Residual Add 1\nL2_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L2_EP0TP3PP0DP1_GPU25 [label="Layer Norm 2\nL2_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L2_EP0TP3PP0DP1_GPU25 [label="MoE Gate (Routing)\nL2_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L2_EP0TP3PP0DP1_GPU25 [label="Expert Dispatch\nL2_EP0TP3PP0DP1_GPU25" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L2_EP0TP3PP0DP1_GPU25 [label="Expert 0\nL2_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L2_EP0TP3PP0DP1_GPU25 [label="Expert 1\nL2_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L2_EP0TP3PP0DP1_GPU25 [label="Expert 2\nL2_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L2_EP0TP3PP0DP1_GPU25 [label="Expert 3\nL2_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L2_EP0TP3PP0DP1_GPU25 [label="Expert Combine\nL2_EP0TP3PP0DP1_GPU25" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L2_EP0TP3PP0DP1_GPU25 [label="FFN (Up-proj + GeLU + Down-proj)\nL2_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L2_EP0TP3PP0DP1_GPU25 [label="FFN All-Reduce\nL2 EP0 TP Group 3 PP0 DP1\nGPU25" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L2_EP0TP3PP0DP1_GPU25 [label="Residual Add 2\nL2_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L2_EP1TP0PP0DP0_GPU32 [label="Layer Norm 1\nL2_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L2_EP1TP0PP0DP0_GPU32 [label="QKV Projection\nL2_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L2_EP1TP0PP0DP0_GPU32 [label="Multi-Head Attention\nL2_EP1TP0PP0DP0_GPU32\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L2_EP1TP0PP0DP0_GPU32 [label="Attention Output Proj\nL2_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L2_EP1TP0PP0DP0_GPU32 [label="Attention All-Reduce\nL2 EP1 TP Group 0 PP0 DP0\nGPU32" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L2_EP1TP0PP0DP0_GPU32 [label="Residual Add 1\nL2_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L2_EP1TP0PP0DP0_GPU32 [label="Layer Norm 2\nL2_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L2_EP1TP0PP0DP0_GPU32 [label="MoE Gate (Routing)\nL2_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L2_EP1TP0PP0DP0_GPU32 [label="Expert Dispatch\nL2_EP1TP0PP0DP0_GPU32" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L2_EP1TP0PP0DP0_GPU32 [label="Expert 0\nL2_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L2_EP1TP0PP0DP0_GPU32 [label="Expert 1\nL2_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L2_EP1TP0PP0DP0_GPU32 [label="Expert 2\nL2_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L2_EP1TP0PP0DP0_GPU32 [label="Expert 3\nL2_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L2_EP1TP0PP0DP0_GPU32 [label="Expert Combine\nL2_EP1TP0PP0DP0_GPU32" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L2_EP1TP0PP0DP0_GPU32 [label="FFN (Up-proj + GeLU + Down-proj)\nL2_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L2_EP1TP0PP0DP0_GPU32 [label="FFN All-Reduce\nL2 EP1 TP Group 0 PP0 DP0\nGPU32" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L2_EP1TP0PP0DP0_GPU32 [label="Residual Add 2\nL2_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L2_EP1TP0PP0DP1_GPU33 [label="Layer Norm 1\nL2_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L2_EP1TP0PP0DP1_GPU33 [label="QKV Projection\nL2_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L2_EP1TP0PP0DP1_GPU33 [label="Multi-Head Attention\nL2_EP1TP0PP0DP1_GPU33\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L2_EP1TP0PP0DP1_GPU33 [label="Attention Output Proj\nL2_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L2_EP1TP0PP0DP1_GPU33 [label="Attention All-Reduce\nL2 EP1 TP Group 0 PP0 DP1\nGPU33" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L2_EP1TP0PP0DP1_GPU33 [label="Residual Add 1\nL2_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L2_EP1TP0PP0DP1_GPU33 [label="Layer Norm 2\nL2_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L2_EP1TP0PP0DP1_GPU33 [label="MoE Gate (Routing)\nL2_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L2_EP1TP0PP0DP1_GPU33 [label="Expert Dispatch\nL2_EP1TP0PP0DP1_GPU33" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L2_EP1TP0PP0DP1_GPU33 [label="Expert 0\nL2_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L2_EP1TP0PP0DP1_GPU33 [label="Expert 1\nL2_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L2_EP1TP0PP0DP1_GPU33 [label="Expert 2\nL2_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L2_EP1TP0PP0DP1_GPU33 [label="Expert 3\nL2_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L2_EP1TP0PP0DP1_GPU33 [label="Expert Combine\nL2_EP1TP0PP0DP1_GPU33" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L2_EP1TP0PP0DP1_GPU33 [label="FFN (Up-proj + GeLU + Down-proj)\nL2_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L2_EP1TP0PP0DP1_GPU33 [label="FFN All-Reduce\nL2 EP1 TP Group 0 PP0 DP1\nGPU33" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L2_EP1TP0PP0DP1_GPU33 [label="Residual Add 2\nL2_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L2_EP1TP1PP0DP0_GPU40 [label="Layer Norm 1\nL2_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L2_EP1TP1PP0DP0_GPU40 [label="QKV Projection\nL2_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L2_EP1TP1PP0DP0_GPU40 [label="Multi-Head Attention\nL2_EP1TP1PP0DP0_GPU40\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L2_EP1TP1PP0DP0_GPU40 [label="Attention Output Proj\nL2_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L2_EP1TP1PP0DP0_GPU40 [label="Attention All-Reduce\nL2 EP1 TP Group 1 PP0 DP0\nGPU40" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L2_EP1TP1PP0DP0_GPU40 [label="Residual Add 1\nL2_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L2_EP1TP1PP0DP0_GPU40 [label="Layer Norm 2\nL2_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L2_EP1TP1PP0DP0_GPU40 [label="MoE Gate (Routing)\nL2_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L2_EP1TP1PP0DP0_GPU40 [label="Expert Dispatch\nL2_EP1TP1PP0DP0_GPU40" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L2_EP1TP1PP0DP0_GPU40 [label="Expert 0\nL2_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L2_EP1TP1PP0DP0_GPU40 [label="Expert 1\nL2_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L2_EP1TP1PP0DP0_GPU40 [label="Expert 2\nL2_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L2_EP1TP1PP0DP0_GPU40 [label="Expert 3\nL2_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L2_EP1TP1PP0DP0_GPU40 [label="Expert Combine\nL2_EP1TP1PP0DP0_GPU40" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L2_EP1TP1PP0DP0_GPU40 [label="FFN (Up-proj + GeLU + Down-proj)\nL2_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L2_EP1TP1PP0DP0_GPU40 [label="FFN All-Reduce\nL2 EP1 TP Group 1 PP0 DP0\nGPU40" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L2_EP1TP1PP0DP0_GPU40 [label="Residual Add 2\nL2_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L2_EP1TP1PP0DP1_GPU41 [label="Layer Norm 1\nL2_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L2_EP1TP1PP0DP1_GPU41 [label="QKV Projection\nL2_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L2_EP1TP1PP0DP1_GPU41 [label="Multi-Head Attention\nL2_EP1TP1PP0DP1_GPU41\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L2_EP1TP1PP0DP1_GPU41 [label="Attention Output Proj\nL2_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L2_EP1TP1PP0DP1_GPU41 [label="Attention All-Reduce\nL2 EP1 TP Group 1 PP0 DP1\nGPU41" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L2_EP1TP1PP0DP1_GPU41 [label="Residual Add 1\nL2_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L2_EP1TP1PP0DP1_GPU41 [label="Layer Norm 2\nL2_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L2_EP1TP1PP0DP1_GPU41 [label="MoE Gate (Routing)\nL2_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L2_EP1TP1PP0DP1_GPU41 [label="Expert Dispatch\nL2_EP1TP1PP0DP1_GPU41" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L2_EP1TP1PP0DP1_GPU41 [label="Expert 0\nL2_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L2_EP1TP1PP0DP1_GPU41 [label="Expert 1\nL2_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L2_EP1TP1PP0DP1_GPU41 [label="Expert 2\nL2_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L2_EP1TP1PP0DP1_GPU41 [label="Expert 3\nL2_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L2_EP1TP1PP0DP1_GPU41 [label="Expert Combine\nL2_EP1TP1PP0DP1_GPU41" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L2_EP1TP1PP0DP1_GPU41 [label="FFN (Up-proj + GeLU + Down-proj)\nL2_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L2_EP1TP1PP0DP1_GPU41 [label="FFN All-Reduce\nL2 EP1 TP Group 1 PP0 DP1\nGPU41" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L2_EP1TP1PP0DP1_GPU41 [label="Residual Add 2\nL2_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L2_EP1TP2PP0DP0_GPU48 [label="Layer Norm 1\nL2_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L2_EP1TP2PP0DP0_GPU48 [label="QKV Projection\nL2_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L2_EP1TP2PP0DP0_GPU48 [label="Multi-Head Attention\nL2_EP1TP2PP0DP0_GPU48\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L2_EP1TP2PP0DP0_GPU48 [label="Attention Output Proj\nL2_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L2_EP1TP2PP0DP0_GPU48 [label="Attention All-Reduce\nL2 EP1 TP Group 2 PP0 DP0\nGPU48" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L2_EP1TP2PP0DP0_GPU48 [label="Residual Add 1\nL2_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L2_EP1TP2PP0DP0_GPU48 [label="Layer Norm 2\nL2_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L2_EP1TP2PP0DP0_GPU48 [label="MoE Gate (Routing)\nL2_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L2_EP1TP2PP0DP0_GPU48 [label="Expert Dispatch\nL2_EP1TP2PP0DP0_GPU48" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L2_EP1TP2PP0DP0_GPU48 [label="Expert 0\nL2_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L2_EP1TP2PP0DP0_GPU48 [label="Expert 1\nL2_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L2_EP1TP2PP0DP0_GPU48 [label="Expert 2\nL2_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L2_EP1TP2PP0DP0_GPU48 [label="Expert 3\nL2_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L2_EP1TP2PP0DP0_GPU48 [label="Expert Combine\nL2_EP1TP2PP0DP0_GPU48" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L2_EP1TP2PP0DP0_GPU48 [label="FFN (Up-proj + GeLU + Down-proj)\nL2_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L2_EP1TP2PP0DP0_GPU48 [label="FFN All-Reduce\nL2 EP1 TP Group 2 PP0 DP0\nGPU48" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L2_EP1TP2PP0DP0_GPU48 [label="Residual Add 2\nL2_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L2_EP1TP2PP0DP1_GPU49 [label="Layer Norm 1\nL2_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L2_EP1TP2PP0DP1_GPU49 [label="QKV Projection\nL2_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L2_EP1TP2PP0DP1_GPU49 [label="Multi-Head Attention\nL2_EP1TP2PP0DP1_GPU49\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L2_EP1TP2PP0DP1_GPU49 [label="Attention Output Proj\nL2_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L2_EP1TP2PP0DP1_GPU49 [label="Attention All-Reduce\nL2 EP1 TP Group 2 PP0 DP1\nGPU49" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L2_EP1TP2PP0DP1_GPU49 [label="Residual Add 1\nL2_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L2_EP1TP2PP0DP1_GPU49 [label="Layer Norm 2\nL2_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L2_EP1TP2PP0DP1_GPU49 [label="MoE Gate (Routing)\nL2_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L2_EP1TP2PP0DP1_GPU49 [label="Expert Dispatch\nL2_EP1TP2PP0DP1_GPU49" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L2_EP1TP2PP0DP1_GPU49 [label="Expert 0\nL2_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L2_EP1TP2PP0DP1_GPU49 [label="Expert 1\nL2_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L2_EP1TP2PP0DP1_GPU49 [label="Expert 2\nL2_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L2_EP1TP2PP0DP1_GPU49 [label="Expert 3\nL2_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L2_EP1TP2PP0DP1_GPU49 [label="Expert Combine\nL2_EP1TP2PP0DP1_GPU49" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L2_EP1TP2PP0DP1_GPU49 [label="FFN (Up-proj + GeLU + Down-proj)\nL2_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L2_EP1TP2PP0DP1_GPU49 [label="FFN All-Reduce\nL2 EP1 TP Group 2 PP0 DP1\nGPU49" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L2_EP1TP2PP0DP1_GPU49 [label="Residual Add 2\nL2_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L2_EP1TP3PP0DP0_GPU56 [label="Layer Norm 1\nL2_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L2_EP1TP3PP0DP0_GPU56 [label="QKV Projection\nL2_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L2_EP1TP3PP0DP0_GPU56 [label="Multi-Head Attention\nL2_EP1TP3PP0DP0_GPU56\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L2_EP1TP3PP0DP0_GPU56 [label="Attention Output Proj\nL2_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L2_EP1TP3PP0DP0_GPU56 [label="Attention All-Reduce\nL2 EP1 TP Group 3 PP0 DP0\nGPU56" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L2_EP1TP3PP0DP0_GPU56 [label="Residual Add 1\nL2_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L2_EP1TP3PP0DP0_GPU56 [label="Layer Norm 2\nL2_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L2_EP1TP3PP0DP0_GPU56 [label="MoE Gate (Routing)\nL2_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L2_EP1TP3PP0DP0_GPU56 [label="Expert Dispatch\nL2_EP1TP3PP0DP0_GPU56" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L2_EP1TP3PP0DP0_GPU56 [label="Expert 0\nL2_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L2_EP1TP3PP0DP0_GPU56 [label="Expert 1\nL2_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L2_EP1TP3PP0DP0_GPU56 [label="Expert 2\nL2_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L2_EP1TP3PP0DP0_GPU56 [label="Expert 3\nL2_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L2_EP1TP3PP0DP0_GPU56 [label="Expert Combine\nL2_EP1TP3PP0DP0_GPU56" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L2_EP1TP3PP0DP0_GPU56 [label="FFN (Up-proj + GeLU + Down-proj)\nL2_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L2_EP1TP3PP0DP0_GPU56 [label="FFN All-Reduce\nL2 EP1 TP Group 3 PP0 DP0\nGPU56" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L2_EP1TP3PP0DP0_GPU56 [label="Residual Add 2\nL2_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L2_EP1TP3PP0DP1_GPU57 [label="Layer Norm 1\nL2_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L2_EP1TP3PP0DP1_GPU57 [label="QKV Projection\nL2_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L2_EP1TP3PP0DP1_GPU57 [label="Multi-Head Attention\nL2_EP1TP3PP0DP1_GPU57\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L2_EP1TP3PP0DP1_GPU57 [label="Attention Output Proj\nL2_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L2_EP1TP3PP0DP1_GPU57 [label="Attention All-Reduce\nL2 EP1 TP Group 3 PP0 DP1\nGPU57" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L2_EP1TP3PP0DP1_GPU57 [label="Residual Add 1\nL2_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L2_EP1TP3PP0DP1_GPU57 [label="Layer Norm 2\nL2_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L2_EP1TP3PP0DP1_GPU57 [label="MoE Gate (Routing)\nL2_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L2_EP1TP3PP0DP1_GPU57 [label="Expert Dispatch\nL2_EP1TP3PP0DP1_GPU57" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L2_EP1TP3PP0DP1_GPU57 [label="Expert 0\nL2_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L2_EP1TP3PP0DP1_GPU57 [label="Expert 1\nL2_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L2_EP1TP3PP0DP1_GPU57 [label="Expert 2\nL2_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L2_EP1TP3PP0DP1_GPU57 [label="Expert 3\nL2_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L2_EP1TP3PP0DP1_GPU57 [label="Expert Combine\nL2_EP1TP3PP0DP1_GPU57" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L2_EP1TP3PP0DP1_GPU57 [label="FFN (Up-proj + GeLU + Down-proj)\nL2_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L2_EP1TP3PP0DP1_GPU57 [label="FFN All-Reduce\nL2 EP1 TP Group 3 PP0 DP1\nGPU57" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L2_EP1TP3PP0DP1_GPU57 [label="Residual Add 2\nL2_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L3_EP0TP0PP0DP0_GPU0 [label="Layer Norm 1\nL3_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L3_EP0TP0PP0DP0_GPU0 [label="QKV Projection\nL3_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L3_EP0TP0PP0DP0_GPU0 [label="Multi-Head Attention\nL3_EP0TP0PP0DP0_GPU0\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L3_EP0TP0PP0DP0_GPU0 [label="Attention Output Proj\nL3_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L3_EP0TP0PP0DP0_GPU0 [label="Attention All-Reduce\nL3 EP0 TP Group 0 PP0 DP0\nGPU0" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L3_EP0TP0PP0DP0_GPU0 [label="Residual Add 1\nL3_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L3_EP0TP0PP0DP0_GPU0 [label="Layer Norm 2\nL3_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L3_EP0TP0PP0DP0_GPU0 [label="MoE Gate (Routing)\nL3_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L3_EP0TP0PP0DP0_GPU0 [label="Expert Dispatch\nL3_EP0TP0PP0DP0_GPU0" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L3_EP0TP0PP0DP0_GPU0 [label="Expert 0\nL3_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L3_EP0TP0PP0DP0_GPU0 [label="Expert 1\nL3_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L3_EP0TP0PP0DP0_GPU0 [label="Expert 2\nL3_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L3_EP0TP0PP0DP0_GPU0 [label="Expert 3\nL3_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L3_EP0TP0PP0DP0_GPU0 [label="Expert Combine\nL3_EP0TP0PP0DP0_GPU0" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L3_EP0TP0PP0DP0_GPU0 [label="FFN (Up-proj + GeLU + Down-proj)\nL3_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L3_EP0TP0PP0DP0_GPU0 [label="FFN All-Reduce\nL3 EP0 TP Group 0 PP0 DP0\nGPU0" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L3_EP0TP0PP0DP0_GPU0 [label="Residual Add 2\nL3_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L3_EP0TP0PP0DP1_GPU1 [label="Layer Norm 1\nL3_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L3_EP0TP0PP0DP1_GPU1 [label="QKV Projection\nL3_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L3_EP0TP0PP0DP1_GPU1 [label="Multi-Head Attention\nL3_EP0TP0PP0DP1_GPU1\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L3_EP0TP0PP0DP1_GPU1 [label="Attention Output Proj\nL3_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L3_EP0TP0PP0DP1_GPU1 [label="Attention All-Reduce\nL3 EP0 TP Group 0 PP0 DP1\nGPU1" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L3_EP0TP0PP0DP1_GPU1 [label="Residual Add 1\nL3_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L3_EP0TP0PP0DP1_GPU1 [label="Layer Norm 2\nL3_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L3_EP0TP0PP0DP1_GPU1 [label="MoE Gate (Routing)\nL3_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L3_EP0TP0PP0DP1_GPU1 [label="Expert Dispatch\nL3_EP0TP0PP0DP1_GPU1" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L3_EP0TP0PP0DP1_GPU1 [label="Expert 0\nL3_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L3_EP0TP0PP0DP1_GPU1 [label="Expert 1\nL3_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L3_EP0TP0PP0DP1_GPU1 [label="Expert 2\nL3_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L3_EP0TP0PP0DP1_GPU1 [label="Expert 3\nL3_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L3_EP0TP0PP0DP1_GPU1 [label="Expert Combine\nL3_EP0TP0PP0DP1_GPU1" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L3_EP0TP0PP0DP1_GPU1 [label="FFN (Up-proj + GeLU + Down-proj)\nL3_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L3_EP0TP0PP0DP1_GPU1 [label="FFN All-Reduce\nL3 EP0 TP Group 0 PP0 DP1\nGPU1" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L3_EP0TP0PP0DP1_GPU1 [label="Residual Add 2\nL3_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L3_EP0TP1PP0DP0_GPU8 [label="Layer Norm 1\nL3_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L3_EP0TP1PP0DP0_GPU8 [label="QKV Projection\nL3_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L3_EP0TP1PP0DP0_GPU8 [label="Multi-Head Attention\nL3_EP0TP1PP0DP0_GPU8\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L3_EP0TP1PP0DP0_GPU8 [label="Attention Output Proj\nL3_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L3_EP0TP1PP0DP0_GPU8 [label="Attention All-Reduce\nL3 EP0 TP Group 1 PP0 DP0\nGPU8" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L3_EP0TP1PP0DP0_GPU8 [label="Residual Add 1\nL3_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L3_EP0TP1PP0DP0_GPU8 [label="Layer Norm 2\nL3_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L3_EP0TP1PP0DP0_GPU8 [label="MoE Gate (Routing)\nL3_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L3_EP0TP1PP0DP0_GPU8 [label="Expert Dispatch\nL3_EP0TP1PP0DP0_GPU8" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L3_EP0TP1PP0DP0_GPU8 [label="Expert 0\nL3_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L3_EP0TP1PP0DP0_GPU8 [label="Expert 1\nL3_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L3_EP0TP1PP0DP0_GPU8 [label="Expert 2\nL3_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L3_EP0TP1PP0DP0_GPU8 [label="Expert 3\nL3_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L3_EP0TP1PP0DP0_GPU8 [label="Expert Combine\nL3_EP0TP1PP0DP0_GPU8" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L3_EP0TP1PP0DP0_GPU8 [label="FFN (Up-proj + GeLU + Down-proj)\nL3_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L3_EP0TP1PP0DP0_GPU8 [label="FFN All-Reduce\nL3 EP0 TP Group 1 PP0 DP0\nGPU8" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L3_EP0TP1PP0DP0_GPU8 [label="Residual Add 2\nL3_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L3_EP0TP1PP0DP1_GPU9 [label="Layer Norm 1\nL3_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L3_EP0TP1PP0DP1_GPU9 [label="QKV Projection\nL3_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L3_EP0TP1PP0DP1_GPU9 [label="Multi-Head Attention\nL3_EP0TP1PP0DP1_GPU9\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L3_EP0TP1PP0DP1_GPU9 [label="Attention Output Proj\nL3_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L3_EP0TP1PP0DP1_GPU9 [label="Attention All-Reduce\nL3 EP0 TP Group 1 PP0 DP1\nGPU9" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L3_EP0TP1PP0DP1_GPU9 [label="Residual Add 1\nL3_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L3_EP0TP1PP0DP1_GPU9 [label="Layer Norm 2\nL3_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L3_EP0TP1PP0DP1_GPU9 [label="MoE Gate (Routing)\nL3_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L3_EP0TP1PP0DP1_GPU9 [label="Expert Dispatch\nL3_EP0TP1PP0DP1_GPU9" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L3_EP0TP1PP0DP1_GPU9 [label="Expert 0\nL3_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L3_EP0TP1PP0DP1_GPU9 [label="Expert 1\nL3_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L3_EP0TP1PP0DP1_GPU9 [label="Expert 2\nL3_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L3_EP0TP1PP0DP1_GPU9 [label="Expert 3\nL3_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L3_EP0TP1PP0DP1_GPU9 [label="Expert Combine\nL3_EP0TP1PP0DP1_GPU9" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L3_EP0TP1PP0DP1_GPU9 [label="FFN (Up-proj + GeLU + Down-proj)\nL3_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L3_EP0TP1PP0DP1_GPU9 [label="FFN All-Reduce\nL3 EP0 TP Group 1 PP0 DP1\nGPU9" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L3_EP0TP1PP0DP1_GPU9 [label="Residual Add 2\nL3_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L3_EP0TP2PP0DP0_GPU16 [label="Layer Norm 1\nL3_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L3_EP0TP2PP0DP0_GPU16 [label="QKV Projection\nL3_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L3_EP0TP2PP0DP0_GPU16 [label="Multi-Head Attention\nL3_EP0TP2PP0DP0_GPU16\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L3_EP0TP2PP0DP0_GPU16 [label="Attention Output Proj\nL3_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L3_EP0TP2PP0DP0_GPU16 [label="Attention All-Reduce\nL3 EP0 TP Group 2 PP0 DP0\nGPU16" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L3_EP0TP2PP0DP0_GPU16 [label="Residual Add 1\nL3_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L3_EP0TP2PP0DP0_GPU16 [label="Layer Norm 2\nL3_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L3_EP0TP2PP0DP0_GPU16 [label="MoE Gate (Routing)\nL3_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L3_EP0TP2PP0DP0_GPU16 [label="Expert Dispatch\nL3_EP0TP2PP0DP0_GPU16" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L3_EP0TP2PP0DP0_GPU16 [label="Expert 0\nL3_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L3_EP0TP2PP0DP0_GPU16 [label="Expert 1\nL3_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L3_EP0TP2PP0DP0_GPU16 [label="Expert 2\nL3_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L3_EP0TP2PP0DP0_GPU16 [label="Expert 3\nL3_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L3_EP0TP2PP0DP0_GPU16 [label="Expert Combine\nL3_EP0TP2PP0DP0_GPU16" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L3_EP0TP2PP0DP0_GPU16 [label="FFN (Up-proj + GeLU + Down-proj)\nL3_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L3_EP0TP2PP0DP0_GPU16 [label="FFN All-Reduce\nL3 EP0 TP Group 2 PP0 DP0\nGPU16" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L3_EP0TP2PP0DP0_GPU16 [label="Residual Add 2\nL3_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L3_EP0TP2PP0DP1_GPU17 [label="Layer Norm 1\nL3_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L3_EP0TP2PP0DP1_GPU17 [label="QKV Projection\nL3_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L3_EP0TP2PP0DP1_GPU17 [label="Multi-Head Attention\nL3_EP0TP2PP0DP1_GPU17\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L3_EP0TP2PP0DP1_GPU17 [label="Attention Output Proj\nL3_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L3_EP0TP2PP0DP1_GPU17 [label="Attention All-Reduce\nL3 EP0 TP Group 2 PP0 DP1\nGPU17" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L3_EP0TP2PP0DP1_GPU17 [label="Residual Add 1\nL3_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L3_EP0TP2PP0DP1_GPU17 [label="Layer Norm 2\nL3_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L3_EP0TP2PP0DP1_GPU17 [label="MoE Gate (Routing)\nL3_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L3_EP0TP2PP0DP1_GPU17 [label="Expert Dispatch\nL3_EP0TP2PP0DP1_GPU17" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L3_EP0TP2PP0DP1_GPU17 [label="Expert 0\nL3_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L3_EP0TP2PP0DP1_GPU17 [label="Expert 1\nL3_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L3_EP0TP2PP0DP1_GPU17 [label="Expert 2\nL3_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L3_EP0TP2PP0DP1_GPU17 [label="Expert 3\nL3_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L3_EP0TP2PP0DP1_GPU17 [label="Expert Combine\nL3_EP0TP2PP0DP1_GPU17" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L3_EP0TP2PP0DP1_GPU17 [label="FFN (Up-proj + GeLU + Down-proj)\nL3_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L3_EP0TP2PP0DP1_GPU17 [label="FFN All-Reduce\nL3 EP0 TP Group 2 PP0 DP1\nGPU17" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L3_EP0TP2PP0DP1_GPU17 [label="Residual Add 2\nL3_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L3_EP0TP3PP0DP0_GPU24 [label="Layer Norm 1\nL3_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L3_EP0TP3PP0DP0_GPU24 [label="QKV Projection\nL3_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L3_EP0TP3PP0DP0_GPU24 [label="Multi-Head Attention\nL3_EP0TP3PP0DP0_GPU24\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L3_EP0TP3PP0DP0_GPU24 [label="Attention Output Proj\nL3_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L3_EP0TP3PP0DP0_GPU24 [label="Attention All-Reduce\nL3 EP0 TP Group 3 PP0 DP0\nGPU24" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L3_EP0TP3PP0DP0_GPU24 [label="Residual Add 1\nL3_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L3_EP0TP3PP0DP0_GPU24 [label="Layer Norm 2\nL3_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L3_EP0TP3PP0DP0_GPU24 [label="MoE Gate (Routing)\nL3_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L3_EP0TP3PP0DP0_GPU24 [label="Expert Dispatch\nL3_EP0TP3PP0DP0_GPU24" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L3_EP0TP3PP0DP0_GPU24 [label="Expert 0\nL3_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L3_EP0TP3PP0DP0_GPU24 [label="Expert 1\nL3_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L3_EP0TP3PP0DP0_GPU24 [label="Expert 2\nL3_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L3_EP0TP3PP0DP0_GPU24 [label="Expert 3\nL3_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L3_EP0TP3PP0DP0_GPU24 [label="Expert Combine\nL3_EP0TP3PP0DP0_GPU24" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L3_EP0TP3PP0DP0_GPU24 [label="FFN (Up-proj + GeLU + Down-proj)\nL3_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L3_EP0TP3PP0DP0_GPU24 [label="FFN All-Reduce\nL3 EP0 TP Group 3 PP0 DP0\nGPU24" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L3_EP0TP3PP0DP0_GPU24 [label="Residual Add 2\nL3_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L3_EP0TP3PP0DP1_GPU25 [label="Layer Norm 1\nL3_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L3_EP0TP3PP0DP1_GPU25 [label="QKV Projection\nL3_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L3_EP0TP3PP0DP1_GPU25 [label="Multi-Head Attention\nL3_EP0TP3PP0DP1_GPU25\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L3_EP0TP3PP0DP1_GPU25 [label="Attention Output Proj\nL3_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L3_EP0TP3PP0DP1_GPU25 [label="Attention All-Reduce\nL3 EP0 TP Group 3 PP0 DP1\nGPU25" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L3_EP0TP3PP0DP1_GPU25 [label="Residual Add 1\nL3_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L3_EP0TP3PP0DP1_GPU25 [label="Layer Norm 2\nL3_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L3_EP0TP3PP0DP1_GPU25 [label="MoE Gate (Routing)\nL3_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L3_EP0TP3PP0DP1_GPU25 [label="Expert Dispatch\nL3_EP0TP3PP0DP1_GPU25" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L3_EP0TP3PP0DP1_GPU25 [label="Expert 0\nL3_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L3_EP0TP3PP0DP1_GPU25 [label="Expert 1\nL3_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L3_EP0TP3PP0DP1_GPU25 [label="Expert 2\nL3_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L3_EP0TP3PP0DP1_GPU25 [label="Expert 3\nL3_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L3_EP0TP3PP0DP1_GPU25 [label="Expert Combine\nL3_EP0TP3PP0DP1_GPU25" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L3_EP0TP3PP0DP1_GPU25 [label="FFN (Up-proj + GeLU + Down-proj)\nL3_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L3_EP0TP3PP0DP1_GPU25 [label="FFN All-Reduce\nL3 EP0 TP Group 3 PP0 DP1\nGPU25" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L3_EP0TP3PP0DP1_GPU25 [label="Residual Add 2\nL3_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L3_EP1TP0PP0DP0_GPU32 [label="Layer Norm 1\nL3_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L3_EP1TP0PP0DP0_GPU32 [label="QKV Projection\nL3_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L3_EP1TP0PP0DP0_GPU32 [label="Multi-Head Attention\nL3_EP1TP0PP0DP0_GPU32\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L3_EP1TP0PP0DP0_GPU32 [label="Attention Output Proj\nL3_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L3_EP1TP0PP0DP0_GPU32 [label="Attention All-Reduce\nL3 EP1 TP Group 0 PP0 DP0\nGPU32" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L3_EP1TP0PP0DP0_GPU32 [label="Residual Add 1\nL3_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L3_EP1TP0PP0DP0_GPU32 [label="Layer Norm 2\nL3_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L3_EP1TP0PP0DP0_GPU32 [label="MoE Gate (Routing)\nL3_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L3_EP1TP0PP0DP0_GPU32 [label="Expert Dispatch\nL3_EP1TP0PP0DP0_GPU32" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L3_EP1TP0PP0DP0_GPU32 [label="Expert 0\nL3_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L3_EP1TP0PP0DP0_GPU32 [label="Expert 1\nL3_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L3_EP1TP0PP0DP0_GPU32 [label="Expert 2\nL3_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L3_EP1TP0PP0DP0_GPU32 [label="Expert 3\nL3_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L3_EP1TP0PP0DP0_GPU32 [label="Expert Combine\nL3_EP1TP0PP0DP0_GPU32" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L3_EP1TP0PP0DP0_GPU32 [label="FFN (Up-proj + GeLU + Down-proj)\nL3_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L3_EP1TP0PP0DP0_GPU32 [label="FFN All-Reduce\nL3 EP1 TP Group 0 PP0 DP0\nGPU32" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L3_EP1TP0PP0DP0_GPU32 [label="Residual Add 2\nL3_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L3_EP1TP0PP0DP1_GPU33 [label="Layer Norm 1\nL3_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L3_EP1TP0PP0DP1_GPU33 [label="QKV Projection\nL3_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L3_EP1TP0PP0DP1_GPU33 [label="Multi-Head Attention\nL3_EP1TP0PP0DP1_GPU33\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L3_EP1TP0PP0DP1_GPU33 [label="Attention Output Proj\nL3_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L3_EP1TP0PP0DP1_GPU33 [label="Attention All-Reduce\nL3 EP1 TP Group 0 PP0 DP1\nGPU33" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L3_EP1TP0PP0DP1_GPU33 [label="Residual Add 1\nL3_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L3_EP1TP0PP0DP1_GPU33 [label="Layer Norm 2\nL3_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L3_EP1TP0PP0DP1_GPU33 [label="MoE Gate (Routing)\nL3_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L3_EP1TP0PP0DP1_GPU33 [label="Expert Dispatch\nL3_EP1TP0PP0DP1_GPU33" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L3_EP1TP0PP0DP1_GPU33 [label="Expert 0\nL3_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L3_EP1TP0PP0DP1_GPU33 [label="Expert 1\nL3_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L3_EP1TP0PP0DP1_GPU33 [label="Expert 2\nL3_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L3_EP1TP0PP0DP1_GPU33 [label="Expert 3\nL3_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L3_EP1TP0PP0DP1_GPU33 [label="Expert Combine\nL3_EP1TP0PP0DP1_GPU33" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L3_EP1TP0PP0DP1_GPU33 [label="FFN (Up-proj + GeLU + Down-proj)\nL3_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L3_EP1TP0PP0DP1_GPU33 [label="FFN All-Reduce\nL3 EP1 TP Group 0 PP0 DP1\nGPU33" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L3_EP1TP0PP0DP1_GPU33 [label="Residual Add 2\nL3_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L3_EP1TP1PP0DP0_GPU40 [label="Layer Norm 1\nL3_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L3_EP1TP1PP0DP0_GPU40 [label="QKV Projection\nL3_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L3_EP1TP1PP0DP0_GPU40 [label="Multi-Head Attention\nL3_EP1TP1PP0DP0_GPU40\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L3_EP1TP1PP0DP0_GPU40 [label="Attention Output Proj\nL3_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L3_EP1TP1PP0DP0_GPU40 [label="Attention All-Reduce\nL3 EP1 TP Group 1 PP0 DP0\nGPU40" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L3_EP1TP1PP0DP0_GPU40 [label="Residual Add 1\nL3_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L3_EP1TP1PP0DP0_GPU40 [label="Layer Norm 2\nL3_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L3_EP1TP1PP0DP0_GPU40 [label="MoE Gate (Routing)\nL3_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L3_EP1TP1PP0DP0_GPU40 [label="Expert Dispatch\nL3_EP1TP1PP0DP0_GPU40" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L3_EP1TP1PP0DP0_GPU40 [label="Expert 0\nL3_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L3_EP1TP1PP0DP0_GPU40 [label="Expert 1\nL3_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L3_EP1TP1PP0DP0_GPU40 [label="Expert 2\nL3_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L3_EP1TP1PP0DP0_GPU40 [label="Expert 3\nL3_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L3_EP1TP1PP0DP0_GPU40 [label="Expert Combine\nL3_EP1TP1PP0DP0_GPU40" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L3_EP1TP1PP0DP0_GPU40 [label="FFN (Up-proj + GeLU + Down-proj)\nL3_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L3_EP1TP1PP0DP0_GPU40 [label="FFN All-Reduce\nL3 EP1 TP Group 1 PP0 DP0\nGPU40" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L3_EP1TP1PP0DP0_GPU40 [label="Residual Add 2\nL3_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L3_EP1TP1PP0DP1_GPU41 [label="Layer Norm 1\nL3_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L3_EP1TP1PP0DP1_GPU41 [label="QKV Projection\nL3_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L3_EP1TP1PP0DP1_GPU41 [label="Multi-Head Attention\nL3_EP1TP1PP0DP1_GPU41\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L3_EP1TP1PP0DP1_GPU41 [label="Attention Output Proj\nL3_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L3_EP1TP1PP0DP1_GPU41 [label="Attention All-Reduce\nL3 EP1 TP Group 1 PP0 DP1\nGPU41" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L3_EP1TP1PP0DP1_GPU41 [label="Residual Add 1\nL3_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L3_EP1TP1PP0DP1_GPU41 [label="Layer Norm 2\nL3_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L3_EP1TP1PP0DP1_GPU41 [label="MoE Gate (Routing)\nL3_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L3_EP1TP1PP0DP1_GPU41 [label="Expert Dispatch\nL3_EP1TP1PP0DP1_GPU41" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L3_EP1TP1PP0DP1_GPU41 [label="Expert 0\nL3_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L3_EP1TP1PP0DP1_GPU41 [label="Expert 1\nL3_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L3_EP1TP1PP0DP1_GPU41 [label="Expert 2\nL3_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L3_EP1TP1PP0DP1_GPU41 [label="Expert 3\nL3_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L3_EP1TP1PP0DP1_GPU41 [label="Expert Combine\nL3_EP1TP1PP0DP1_GPU41" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L3_EP1TP1PP0DP1_GPU41 [label="FFN (Up-proj + GeLU + Down-proj)\nL3_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L3_EP1TP1PP0DP1_GPU41 [label="FFN All-Reduce\nL3 EP1 TP Group 1 PP0 DP1\nGPU41" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L3_EP1TP1PP0DP1_GPU41 [label="Residual Add 2\nL3_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L3_EP1TP2PP0DP0_GPU48 [label="Layer Norm 1\nL3_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L3_EP1TP2PP0DP0_GPU48 [label="QKV Projection\nL3_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L3_EP1TP2PP0DP0_GPU48 [label="Multi-Head Attention\nL3_EP1TP2PP0DP0_GPU48\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L3_EP1TP2PP0DP0_GPU48 [label="Attention Output Proj\nL3_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L3_EP1TP2PP0DP0_GPU48 [label="Attention All-Reduce\nL3 EP1 TP Group 2 PP0 DP0\nGPU48" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L3_EP1TP2PP0DP0_GPU48 [label="Residual Add 1\nL3_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L3_EP1TP2PP0DP0_GPU48 [label="Layer Norm 2\nL3_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L3_EP1TP2PP0DP0_GPU48 [label="MoE Gate (Routing)\nL3_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L3_EP1TP2PP0DP0_GPU48 [label="Expert Dispatch\nL3_EP1TP2PP0DP0_GPU48" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L3_EP1TP2PP0DP0_GPU48 [label="Expert 0\nL3_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L3_EP1TP2PP0DP0_GPU48 [label="Expert 1\nL3_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L3_EP1TP2PP0DP0_GPU48 [label="Expert 2\nL3_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L3_EP1TP2PP0DP0_GPU48 [label="Expert 3\nL3_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L3_EP1TP2PP0DP0_GPU48 [label="Expert Combine\nL3_EP1TP2PP0DP0_GPU48" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L3_EP1TP2PP0DP0_GPU48 [label="FFN (Up-proj + GeLU + Down-proj)\nL3_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L3_EP1TP2PP0DP0_GPU48 [label="FFN All-Reduce\nL3 EP1 TP Group 2 PP0 DP0\nGPU48" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L3_EP1TP2PP0DP0_GPU48 [label="Residual Add 2\nL3_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L3_EP1TP2PP0DP1_GPU49 [label="Layer Norm 1\nL3_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L3_EP1TP2PP0DP1_GPU49 [label="QKV Projection\nL3_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L3_EP1TP2PP0DP1_GPU49 [label="Multi-Head Attention\nL3_EP1TP2PP0DP1_GPU49\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L3_EP1TP2PP0DP1_GPU49 [label="Attention Output Proj\nL3_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L3_EP1TP2PP0DP1_GPU49 [label="Attention All-Reduce\nL3 EP1 TP Group 2 PP0 DP1\nGPU49" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L3_EP1TP2PP0DP1_GPU49 [label="Residual Add 1\nL3_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L3_EP1TP2PP0DP1_GPU49 [label="Layer Norm 2\nL3_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L3_EP1TP2PP0DP1_GPU49 [label="MoE Gate (Routing)\nL3_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L3_EP1TP2PP0DP1_GPU49 [label="Expert Dispatch\nL3_EP1TP2PP0DP1_GPU49" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L3_EP1TP2PP0DP1_GPU49 [label="Expert 0\nL3_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L3_EP1TP2PP0DP1_GPU49 [label="Expert 1\nL3_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L3_EP1TP2PP0DP1_GPU49 [label="Expert 2\nL3_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L3_EP1TP2PP0DP1_GPU49 [label="Expert 3\nL3_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L3_EP1TP2PP0DP1_GPU49 [label="Expert Combine\nL3_EP1TP2PP0DP1_GPU49" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L3_EP1TP2PP0DP1_GPU49 [label="FFN (Up-proj + GeLU + Down-proj)\nL3_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L3_EP1TP2PP0DP1_GPU49 [label="FFN All-Reduce\nL3 EP1 TP Group 2 PP0 DP1\nGPU49" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L3_EP1TP2PP0DP1_GPU49 [label="Residual Add 2\nL3_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L3_EP1TP3PP0DP0_GPU56 [label="Layer Norm 1\nL3_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L3_EP1TP3PP0DP0_GPU56 [label="QKV Projection\nL3_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L3_EP1TP3PP0DP0_GPU56 [label="Multi-Head Attention\nL3_EP1TP3PP0DP0_GPU56\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L3_EP1TP3PP0DP0_GPU56 [label="Attention Output Proj\nL3_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L3_EP1TP3PP0DP0_GPU56 [label="Attention All-Reduce\nL3 EP1 TP Group 3 PP0 DP0\nGPU56" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L3_EP1TP3PP0DP0_GPU56 [label="Residual Add 1\nL3_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L3_EP1TP3PP0DP0_GPU56 [label="Layer Norm 2\nL3_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L3_EP1TP3PP0DP0_GPU56 [label="MoE Gate (Routing)\nL3_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L3_EP1TP3PP0DP0_GPU56 [label="Expert Dispatch\nL3_EP1TP3PP0DP0_GPU56" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L3_EP1TP3PP0DP0_GPU56 [label="Expert 0\nL3_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L3_EP1TP3PP0DP0_GPU56 [label="Expert 1\nL3_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L3_EP1TP3PP0DP0_GPU56 [label="Expert 2\nL3_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L3_EP1TP3PP0DP0_GPU56 [label="Expert 3\nL3_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L3_EP1TP3PP0DP0_GPU56 [label="Expert Combine\nL3_EP1TP3PP0DP0_GPU56" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L3_EP1TP3PP0DP0_GPU56 [label="FFN (Up-proj + GeLU + Down-proj)\nL3_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L3_EP1TP3PP0DP0_GPU56 [label="FFN All-Reduce\nL3 EP1 TP Group 3 PP0 DP0\nGPU56" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L3_EP1TP3PP0DP0_GPU56 [label="Residual Add 2\nL3_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L3_EP1TP3PP0DP1_GPU57 [label="Layer Norm 1\nL3_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L3_EP1TP3PP0DP1_GPU57 [label="QKV Projection\nL3_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L3_EP1TP3PP0DP1_GPU57 [label="Multi-Head Attention\nL3_EP1TP3PP0DP1_GPU57\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L3_EP1TP3PP0DP1_GPU57 [label="Attention Output Proj\nL3_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L3_EP1TP3PP0DP1_GPU57 [label="Attention All-Reduce\nL3 EP1 TP Group 3 PP0 DP1\nGPU57" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L3_EP1TP3PP0DP1_GPU57 [label="Residual Add 1\nL3_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L3_EP1TP3PP0DP1_GPU57 [label="Layer Norm 2\nL3_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L3_EP1TP3PP0DP1_GPU57 [label="MoE Gate (Routing)\nL3_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L3_EP1TP3PP0DP1_GPU57 [label="Expert Dispatch\nL3_EP1TP3PP0DP1_GPU57" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L3_EP1TP3PP0DP1_GPU57 [label="Expert 0\nL3_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L3_EP1TP3PP0DP1_GPU57 [label="Expert 1\nL3_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L3_EP1TP3PP0DP1_GPU57 [label="Expert 2\nL3_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L3_EP1TP3PP0DP1_GPU57 [label="Expert 3\nL3_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L3_EP1TP3PP0DP1_GPU57 [label="Expert Combine\nL3_EP1TP3PP0DP1_GPU57" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L3_EP1TP3PP0DP1_GPU57 [label="FFN (Up-proj + GeLU + Down-proj)\nL3_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L3_EP1TP3PP0DP1_GPU57 [label="FFN All-Reduce\nL3 EP1 TP Group 3 PP0 DP1\nGPU57" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L3_EP1TP3PP0DP1_GPU57 [label="Residual Add 2\nL3_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L4_EP0TP0PP0DP0_GPU0 [label="Layer Norm 1\nL4_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L4_EP0TP0PP0DP0_GPU0 [label="QKV Projection\nL4_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L4_EP0TP0PP0DP0_GPU0 [label="Multi-Head Attention\nL4_EP0TP0PP0DP0_GPU0\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L4_EP0TP0PP0DP0_GPU0 [label="Attention Output Proj\nL4_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L4_EP0TP0PP0DP0_GPU0 [label="Attention All-Reduce\nL4 EP0 TP Group 0 PP0 DP0\nGPU0" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L4_EP0TP0PP0DP0_GPU0 [label="Residual Add 1\nL4_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L4_EP0TP0PP0DP0_GPU0 [label="Layer Norm 2\nL4_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L4_EP0TP0PP0DP0_GPU0 [label="MoE Gate (Routing)\nL4_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L4_EP0TP0PP0DP0_GPU0 [label="Expert Dispatch\nL4_EP0TP0PP0DP0_GPU0" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L4_EP0TP0PP0DP0_GPU0 [label="Expert 0\nL4_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L4_EP0TP0PP0DP0_GPU0 [label="Expert 1\nL4_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L4_EP0TP0PP0DP0_GPU0 [label="Expert 2\nL4_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L4_EP0TP0PP0DP0_GPU0 [label="Expert 3\nL4_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L4_EP0TP0PP0DP0_GPU0 [label="Expert Combine\nL4_EP0TP0PP0DP0_GPU0" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L4_EP0TP0PP0DP0_GPU0 [label="FFN (Up-proj + GeLU + Down-proj)\nL4_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L4_EP0TP0PP0DP0_GPU0 [label="FFN All-Reduce\nL4 EP0 TP Group 0 PP0 DP0\nGPU0" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L4_EP0TP0PP0DP0_GPU0 [label="Residual Add 2\nL4_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L4_EP0TP0PP0DP1_GPU1 [label="Layer Norm 1\nL4_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L4_EP0TP0PP0DP1_GPU1 [label="QKV Projection\nL4_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L4_EP0TP0PP0DP1_GPU1 [label="Multi-Head Attention\nL4_EP0TP0PP0DP1_GPU1\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L4_EP0TP0PP0DP1_GPU1 [label="Attention Output Proj\nL4_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L4_EP0TP0PP0DP1_GPU1 [label="Attention All-Reduce\nL4 EP0 TP Group 0 PP0 DP1\nGPU1" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L4_EP0TP0PP0DP1_GPU1 [label="Residual Add 1\nL4_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L4_EP0TP0PP0DP1_GPU1 [label="Layer Norm 2\nL4_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L4_EP0TP0PP0DP1_GPU1 [label="MoE Gate (Routing)\nL4_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L4_EP0TP0PP0DP1_GPU1 [label="Expert Dispatch\nL4_EP0TP0PP0DP1_GPU1" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L4_EP0TP0PP0DP1_GPU1 [label="Expert 0\nL4_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L4_EP0TP0PP0DP1_GPU1 [label="Expert 1\nL4_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L4_EP0TP0PP0DP1_GPU1 [label="Expert 2\nL4_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L4_EP0TP0PP0DP1_GPU1 [label="Expert 3\nL4_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L4_EP0TP0PP0DP1_GPU1 [label="Expert Combine\nL4_EP0TP0PP0DP1_GPU1" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L4_EP0TP0PP0DP1_GPU1 [label="FFN (Up-proj + GeLU + Down-proj)\nL4_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L4_EP0TP0PP0DP1_GPU1 [label="FFN All-Reduce\nL4 EP0 TP Group 0 PP0 DP1\nGPU1" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L4_EP0TP0PP0DP1_GPU1 [label="Residual Add 2\nL4_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L4_EP0TP1PP0DP0_GPU8 [label="Layer Norm 1\nL4_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L4_EP0TP1PP0DP0_GPU8 [label="QKV Projection\nL4_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L4_EP0TP1PP0DP0_GPU8 [label="Multi-Head Attention\nL4_EP0TP1PP0DP0_GPU8\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L4_EP0TP1PP0DP0_GPU8 [label="Attention Output Proj\nL4_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L4_EP0TP1PP0DP0_GPU8 [label="Attention All-Reduce\nL4 EP0 TP Group 1 PP0 DP0\nGPU8" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L4_EP0TP1PP0DP0_GPU8 [label="Residual Add 1\nL4_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L4_EP0TP1PP0DP0_GPU8 [label="Layer Norm 2\nL4_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L4_EP0TP1PP0DP0_GPU8 [label="MoE Gate (Routing)\nL4_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L4_EP0TP1PP0DP0_GPU8 [label="Expert Dispatch\nL4_EP0TP1PP0DP0_GPU8" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L4_EP0TP1PP0DP0_GPU8 [label="Expert 0\nL4_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L4_EP0TP1PP0DP0_GPU8 [label="Expert 1\nL4_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L4_EP0TP1PP0DP0_GPU8 [label="Expert 2\nL4_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L4_EP0TP1PP0DP0_GPU8 [label="Expert 3\nL4_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L4_EP0TP1PP0DP0_GPU8 [label="Expert Combine\nL4_EP0TP1PP0DP0_GPU8" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L4_EP0TP1PP0DP0_GPU8 [label="FFN (Up-proj + GeLU + Down-proj)\nL4_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L4_EP0TP1PP0DP0_GPU8 [label="FFN All-Reduce\nL4 EP0 TP Group 1 PP0 DP0\nGPU8" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L4_EP0TP1PP0DP0_GPU8 [label="Residual Add 2\nL4_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L4_EP0TP1PP0DP1_GPU9 [label="Layer Norm 1\nL4_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L4_EP0TP1PP0DP1_GPU9 [label="QKV Projection\nL4_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L4_EP0TP1PP0DP1_GPU9 [label="Multi-Head Attention\nL4_EP0TP1PP0DP1_GPU9\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L4_EP0TP1PP0DP1_GPU9 [label="Attention Output Proj\nL4_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L4_EP0TP1PP0DP1_GPU9 [label="Attention All-Reduce\nL4 EP0 TP Group 1 PP0 DP1\nGPU9" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L4_EP0TP1PP0DP1_GPU9 [label="Residual Add 1\nL4_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L4_EP0TP1PP0DP1_GPU9 [label="Layer Norm 2\nL4_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L4_EP0TP1PP0DP1_GPU9 [label="MoE Gate (Routing)\nL4_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L4_EP0TP1PP0DP1_GPU9 [label="Expert Dispatch\nL4_EP0TP1PP0DP1_GPU9" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L4_EP0TP1PP0DP1_GPU9 [label="Expert 0\nL4_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L4_EP0TP1PP0DP1_GPU9 [label="Expert 1\nL4_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L4_EP0TP1PP0DP1_GPU9 [label="Expert 2\nL4_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L4_EP0TP1PP0DP1_GPU9 [label="Expert 3\nL4_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L4_EP0TP1PP0DP1_GPU9 [label="Expert Combine\nL4_EP0TP1PP0DP1_GPU9" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L4_EP0TP1PP0DP1_GPU9 [label="FFN (Up-proj + GeLU + Down-proj)\nL4_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L4_EP0TP1PP0DP1_GPU9 [label="FFN All-Reduce\nL4 EP0 TP Group 1 PP0 DP1\nGPU9" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L4_EP0TP1PP0DP1_GPU9 [label="Residual Add 2\nL4_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L4_EP0TP2PP0DP0_GPU16 [label="Layer Norm 1\nL4_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L4_EP0TP2PP0DP0_GPU16 [label="QKV Projection\nL4_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L4_EP0TP2PP0DP0_GPU16 [label="Multi-Head Attention\nL4_EP0TP2PP0DP0_GPU16\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L4_EP0TP2PP0DP0_GPU16 [label="Attention Output Proj\nL4_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L4_EP0TP2PP0DP0_GPU16 [label="Attention All-Reduce\nL4 EP0 TP Group 2 PP0 DP0\nGPU16" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L4_EP0TP2PP0DP0_GPU16 [label="Residual Add 1\nL4_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L4_EP0TP2PP0DP0_GPU16 [label="Layer Norm 2\nL4_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L4_EP0TP2PP0DP0_GPU16 [label="MoE Gate (Routing)\nL4_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L4_EP0TP2PP0DP0_GPU16 [label="Expert Dispatch\nL4_EP0TP2PP0DP0_GPU16" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L4_EP0TP2PP0DP0_GPU16 [label="Expert 0\nL4_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L4_EP0TP2PP0DP0_GPU16 [label="Expert 1\nL4_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L4_EP0TP2PP0DP0_GPU16 [label="Expert 2\nL4_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L4_EP0TP2PP0DP0_GPU16 [label="Expert 3\nL4_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L4_EP0TP2PP0DP0_GPU16 [label="Expert Combine\nL4_EP0TP2PP0DP0_GPU16" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L4_EP0TP2PP0DP0_GPU16 [label="FFN (Up-proj + GeLU + Down-proj)\nL4_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L4_EP0TP2PP0DP0_GPU16 [label="FFN All-Reduce\nL4 EP0 TP Group 2 PP0 DP0\nGPU16" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L4_EP0TP2PP0DP0_GPU16 [label="Residual Add 2\nL4_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L4_EP0TP2PP0DP1_GPU17 [label="Layer Norm 1\nL4_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L4_EP0TP2PP0DP1_GPU17 [label="QKV Projection\nL4_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L4_EP0TP2PP0DP1_GPU17 [label="Multi-Head Attention\nL4_EP0TP2PP0DP1_GPU17\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L4_EP0TP2PP0DP1_GPU17 [label="Attention Output Proj\nL4_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L4_EP0TP2PP0DP1_GPU17 [label="Attention All-Reduce\nL4 EP0 TP Group 2 PP0 DP1\nGPU17" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L4_EP0TP2PP0DP1_GPU17 [label="Residual Add 1\nL4_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L4_EP0TP2PP0DP1_GPU17 [label="Layer Norm 2\nL4_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L4_EP0TP2PP0DP1_GPU17 [label="MoE Gate (Routing)\nL4_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L4_EP0TP2PP0DP1_GPU17 [label="Expert Dispatch\nL4_EP0TP2PP0DP1_GPU17" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L4_EP0TP2PP0DP1_GPU17 [label="Expert 0\nL4_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L4_EP0TP2PP0DP1_GPU17 [label="Expert 1\nL4_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L4_EP0TP2PP0DP1_GPU17 [label="Expert 2\nL4_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L4_EP0TP2PP0DP1_GPU17 [label="Expert 3\nL4_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L4_EP0TP2PP0DP1_GPU17 [label="Expert Combine\nL4_EP0TP2PP0DP1_GPU17" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L4_EP0TP2PP0DP1_GPU17 [label="FFN (Up-proj + GeLU + Down-proj)\nL4_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L4_EP0TP2PP0DP1_GPU17 [label="FFN All-Reduce\nL4 EP0 TP Group 2 PP0 DP1\nGPU17" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L4_EP0TP2PP0DP1_GPU17 [label="Residual Add 2\nL4_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L4_EP0TP3PP0DP0_GPU24 [label="Layer Norm 1\nL4_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L4_EP0TP3PP0DP0_GPU24 [label="QKV Projection\nL4_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L4_EP0TP3PP0DP0_GPU24 [label="Multi-Head Attention\nL4_EP0TP3PP0DP0_GPU24\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L4_EP0TP3PP0DP0_GPU24 [label="Attention Output Proj\nL4_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L4_EP0TP3PP0DP0_GPU24 [label="Attention All-Reduce\nL4 EP0 TP Group 3 PP0 DP0\nGPU24" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L4_EP0TP3PP0DP0_GPU24 [label="Residual Add 1\nL4_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L4_EP0TP3PP0DP0_GPU24 [label="Layer Norm 2\nL4_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L4_EP0TP3PP0DP0_GPU24 [label="MoE Gate (Routing)\nL4_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L4_EP0TP3PP0DP0_GPU24 [label="Expert Dispatch\nL4_EP0TP3PP0DP0_GPU24" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L4_EP0TP3PP0DP0_GPU24 [label="Expert 0\nL4_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L4_EP0TP3PP0DP0_GPU24 [label="Expert 1\nL4_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L4_EP0TP3PP0DP0_GPU24 [label="Expert 2\nL4_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L4_EP0TP3PP0DP0_GPU24 [label="Expert 3\nL4_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L4_EP0TP3PP0DP0_GPU24 [label="Expert Combine\nL4_EP0TP3PP0DP0_GPU24" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L4_EP0TP3PP0DP0_GPU24 [label="FFN (Up-proj + GeLU + Down-proj)\nL4_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L4_EP0TP3PP0DP0_GPU24 [label="FFN All-Reduce\nL4 EP0 TP Group 3 PP0 DP0\nGPU24" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L4_EP0TP3PP0DP0_GPU24 [label="Residual Add 2\nL4_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L4_EP0TP3PP0DP1_GPU25 [label="Layer Norm 1\nL4_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L4_EP0TP3PP0DP1_GPU25 [label="QKV Projection\nL4_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L4_EP0TP3PP0DP1_GPU25 [label="Multi-Head Attention\nL4_EP0TP3PP0DP1_GPU25\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L4_EP0TP3PP0DP1_GPU25 [label="Attention Output Proj\nL4_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L4_EP0TP3PP0DP1_GPU25 [label="Attention All-Reduce\nL4 EP0 TP Group 3 PP0 DP1\nGPU25" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L4_EP0TP3PP0DP1_GPU25 [label="Residual Add 1\nL4_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L4_EP0TP3PP0DP1_GPU25 [label="Layer Norm 2\nL4_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L4_EP0TP3PP0DP1_GPU25 [label="MoE Gate (Routing)\nL4_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L4_EP0TP3PP0DP1_GPU25 [label="Expert Dispatch\nL4_EP0TP3PP0DP1_GPU25" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L4_EP0TP3PP0DP1_GPU25 [label="Expert 0\nL4_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L4_EP0TP3PP0DP1_GPU25 [label="Expert 1\nL4_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L4_EP0TP3PP0DP1_GPU25 [label="Expert 2\nL4_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L4_EP0TP3PP0DP1_GPU25 [label="Expert 3\nL4_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L4_EP0TP3PP0DP1_GPU25 [label="Expert Combine\nL4_EP0TP3PP0DP1_GPU25" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L4_EP0TP3PP0DP1_GPU25 [label="FFN (Up-proj + GeLU + Down-proj)\nL4_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L4_EP0TP3PP0DP1_GPU25 [label="FFN All-Reduce\nL4 EP0 TP Group 3 PP0 DP1\nGPU25" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L4_EP0TP3PP0DP1_GPU25 [label="Residual Add 2\nL4_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L4_EP1TP0PP0DP0_GPU32 [label="Layer Norm 1\nL4_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L4_EP1TP0PP0DP0_GPU32 [label="QKV Projection\nL4_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L4_EP1TP0PP0DP0_GPU32 [label="Multi-Head Attention\nL4_EP1TP0PP0DP0_GPU32\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L4_EP1TP0PP0DP0_GPU32 [label="Attention Output Proj\nL4_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L4_EP1TP0PP0DP0_GPU32 [label="Attention All-Reduce\nL4 EP1 TP Group 0 PP0 DP0\nGPU32" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L4_EP1TP0PP0DP0_GPU32 [label="Residual Add 1\nL4_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L4_EP1TP0PP0DP0_GPU32 [label="Layer Norm 2\nL4_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L4_EP1TP0PP0DP0_GPU32 [label="MoE Gate (Routing)\nL4_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L4_EP1TP0PP0DP0_GPU32 [label="Expert Dispatch\nL4_EP1TP0PP0DP0_GPU32" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L4_EP1TP0PP0DP0_GPU32 [label="Expert 0\nL4_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L4_EP1TP0PP0DP0_GPU32 [label="Expert 1\nL4_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L4_EP1TP0PP0DP0_GPU32 [label="Expert 2\nL4_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L4_EP1TP0PP0DP0_GPU32 [label="Expert 3\nL4_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L4_EP1TP0PP0DP0_GPU32 [label="Expert Combine\nL4_EP1TP0PP0DP0_GPU32" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L4_EP1TP0PP0DP0_GPU32 [label="FFN (Up-proj + GeLU + Down-proj)\nL4_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L4_EP1TP0PP0DP0_GPU32 [label="FFN All-Reduce\nL4 EP1 TP Group 0 PP0 DP0\nGPU32" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L4_EP1TP0PP0DP0_GPU32 [label="Residual Add 2\nL4_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L4_EP1TP0PP0DP1_GPU33 [label="Layer Norm 1\nL4_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L4_EP1TP0PP0DP1_GPU33 [label="QKV Projection\nL4_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L4_EP1TP0PP0DP1_GPU33 [label="Multi-Head Attention\nL4_EP1TP0PP0DP1_GPU33\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L4_EP1TP0PP0DP1_GPU33 [label="Attention Output Proj\nL4_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L4_EP1TP0PP0DP1_GPU33 [label="Attention All-Reduce\nL4 EP1 TP Group 0 PP0 DP1\nGPU33" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L4_EP1TP0PP0DP1_GPU33 [label="Residual Add 1\nL4_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L4_EP1TP0PP0DP1_GPU33 [label="Layer Norm 2\nL4_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L4_EP1TP0PP0DP1_GPU33 [label="MoE Gate (Routing)\nL4_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L4_EP1TP0PP0DP1_GPU33 [label="Expert Dispatch\nL4_EP1TP0PP0DP1_GPU33" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L4_EP1TP0PP0DP1_GPU33 [label="Expert 0\nL4_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L4_EP1TP0PP0DP1_GPU33 [label="Expert 1\nL4_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L4_EP1TP0PP0DP1_GPU33 [label="Expert 2\nL4_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L4_EP1TP0PP0DP1_GPU33 [label="Expert 3\nL4_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L4_EP1TP0PP0DP1_GPU33 [label="Expert Combine\nL4_EP1TP0PP0DP1_GPU33" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L4_EP1TP0PP0DP1_GPU33 [label="FFN (Up-proj + GeLU + Down-proj)\nL4_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L4_EP1TP0PP0DP1_GPU33 [label="FFN All-Reduce\nL4 EP1 TP Group 0 PP0 DP1\nGPU33" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L4_EP1TP0PP0DP1_GPU33 [label="Residual Add 2\nL4_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L4_EP1TP1PP0DP0_GPU40 [label="Layer Norm 1\nL4_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L4_EP1TP1PP0DP0_GPU40 [label="QKV Projection\nL4_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L4_EP1TP1PP0DP0_GPU40 [label="Multi-Head Attention\nL4_EP1TP1PP0DP0_GPU40\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L4_EP1TP1PP0DP0_GPU40 [label="Attention Output Proj\nL4_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L4_EP1TP1PP0DP0_GPU40 [label="Attention All-Reduce\nL4 EP1 TP Group 1 PP0 DP0\nGPU40" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L4_EP1TP1PP0DP0_GPU40 [label="Residual Add 1\nL4_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L4_EP1TP1PP0DP0_GPU40 [label="Layer Norm 2\nL4_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L4_EP1TP1PP0DP0_GPU40 [label="MoE Gate (Routing)\nL4_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L4_EP1TP1PP0DP0_GPU40 [label="Expert Dispatch\nL4_EP1TP1PP0DP0_GPU40" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L4_EP1TP1PP0DP0_GPU40 [label="Expert 0\nL4_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L4_EP1TP1PP0DP0_GPU40 [label="Expert 1\nL4_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L4_EP1TP1PP0DP0_GPU40 [label="Expert 2\nL4_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L4_EP1TP1PP0DP0_GPU40 [label="Expert 3\nL4_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L4_EP1TP1PP0DP0_GPU40 [label="Expert Combine\nL4_EP1TP1PP0DP0_GPU40" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L4_EP1TP1PP0DP0_GPU40 [label="FFN (Up-proj + GeLU + Down-proj)\nL4_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L4_EP1TP1PP0DP0_GPU40 [label="FFN All-Reduce\nL4 EP1 TP Group 1 PP0 DP0\nGPU40" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L4_EP1TP1PP0DP0_GPU40 [label="Residual Add 2\nL4_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L4_EP1TP1PP0DP1_GPU41 [label="Layer Norm 1\nL4_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L4_EP1TP1PP0DP1_GPU41 [label="QKV Projection\nL4_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L4_EP1TP1PP0DP1_GPU41 [label="Multi-Head Attention\nL4_EP1TP1PP0DP1_GPU41\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L4_EP1TP1PP0DP1_GPU41 [label="Attention Output Proj\nL4_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L4_EP1TP1PP0DP1_GPU41 [label="Attention All-Reduce\nL4 EP1 TP Group 1 PP0 DP1\nGPU41" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L4_EP1TP1PP0DP1_GPU41 [label="Residual Add 1\nL4_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L4_EP1TP1PP0DP1_GPU41 [label="Layer Norm 2\nL4_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L4_EP1TP1PP0DP1_GPU41 [label="MoE Gate (Routing)\nL4_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L4_EP1TP1PP0DP1_GPU41 [label="Expert Dispatch\nL4_EP1TP1PP0DP1_GPU41" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L4_EP1TP1PP0DP1_GPU41 [label="Expert 0\nL4_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L4_EP1TP1PP0DP1_GPU41 [label="Expert 1\nL4_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L4_EP1TP1PP0DP1_GPU41 [label="Expert 2\nL4_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L4_EP1TP1PP0DP1_GPU41 [label="Expert 3\nL4_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L4_EP1TP1PP0DP1_GPU41 [label="Expert Combine\nL4_EP1TP1PP0DP1_GPU41" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L4_EP1TP1PP0DP1_GPU41 [label="FFN (Up-proj + GeLU + Down-proj)\nL4_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L4_EP1TP1PP0DP1_GPU41 [label="FFN All-Reduce\nL4 EP1 TP Group 1 PP0 DP1\nGPU41" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L4_EP1TP1PP0DP1_GPU41 [label="Residual Add 2\nL4_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L4_EP1TP2PP0DP0_GPU48 [label="Layer Norm 1\nL4_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L4_EP1TP2PP0DP0_GPU48 [label="QKV Projection\nL4_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L4_EP1TP2PP0DP0_GPU48 [label="Multi-Head Attention\nL4_EP1TP2PP0DP0_GPU48\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L4_EP1TP2PP0DP0_GPU48 [label="Attention Output Proj\nL4_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L4_EP1TP2PP0DP0_GPU48 [label="Attention All-Reduce\nL4 EP1 TP Group 2 PP0 DP0\nGPU48" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L4_EP1TP2PP0DP0_GPU48 [label="Residual Add 1\nL4_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L4_EP1TP2PP0DP0_GPU48 [label="Layer Norm 2\nL4_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L4_EP1TP2PP0DP0_GPU48 [label="MoE Gate (Routing)\nL4_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L4_EP1TP2PP0DP0_GPU48 [label="Expert Dispatch\nL4_EP1TP2PP0DP0_GPU48" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L4_EP1TP2PP0DP0_GPU48 [label="Expert 0\nL4_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L4_EP1TP2PP0DP0_GPU48 [label="Expert 1\nL4_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L4_EP1TP2PP0DP0_GPU48 [label="Expert 2\nL4_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L4_EP1TP2PP0DP0_GPU48 [label="Expert 3\nL4_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L4_EP1TP2PP0DP0_GPU48 [label="Expert Combine\nL4_EP1TP2PP0DP0_GPU48" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L4_EP1TP2PP0DP0_GPU48 [label="FFN (Up-proj + GeLU + Down-proj)\nL4_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L4_EP1TP2PP0DP0_GPU48 [label="FFN All-Reduce\nL4 EP1 TP Group 2 PP0 DP0\nGPU48" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L4_EP1TP2PP0DP0_GPU48 [label="Residual Add 2\nL4_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L4_EP1TP2PP0DP1_GPU49 [label="Layer Norm 1\nL4_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L4_EP1TP2PP0DP1_GPU49 [label="QKV Projection\nL4_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L4_EP1TP2PP0DP1_GPU49 [label="Multi-Head Attention\nL4_EP1TP2PP0DP1_GPU49\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L4_EP1TP2PP0DP1_GPU49 [label="Attention Output Proj\nL4_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L4_EP1TP2PP0DP1_GPU49 [label="Attention All-Reduce\nL4 EP1 TP Group 2 PP0 DP1\nGPU49" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L4_EP1TP2PP0DP1_GPU49 [label="Residual Add 1\nL4_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L4_EP1TP2PP0DP1_GPU49 [label="Layer Norm 2\nL4_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L4_EP1TP2PP0DP1_GPU49 [label="MoE Gate (Routing)\nL4_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L4_EP1TP2PP0DP1_GPU49 [label="Expert Dispatch\nL4_EP1TP2PP0DP1_GPU49" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L4_EP1TP2PP0DP1_GPU49 [label="Expert 0\nL4_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L4_EP1TP2PP0DP1_GPU49 [label="Expert 1\nL4_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L4_EP1TP2PP0DP1_GPU49 [label="Expert 2\nL4_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L4_EP1TP2PP0DP1_GPU49 [label="Expert 3\nL4_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L4_EP1TP2PP0DP1_GPU49 [label="Expert Combine\nL4_EP1TP2PP0DP1_GPU49" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L4_EP1TP2PP0DP1_GPU49 [label="FFN (Up-proj + GeLU + Down-proj)\nL4_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L4_EP1TP2PP0DP1_GPU49 [label="FFN All-Reduce\nL4 EP1 TP Group 2 PP0 DP1\nGPU49" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L4_EP1TP2PP0DP1_GPU49 [label="Residual Add 2\nL4_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L4_EP1TP3PP0DP0_GPU56 [label="Layer Norm 1\nL4_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L4_EP1TP3PP0DP0_GPU56 [label="QKV Projection\nL4_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L4_EP1TP3PP0DP0_GPU56 [label="Multi-Head Attention\nL4_EP1TP3PP0DP0_GPU56\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L4_EP1TP3PP0DP0_GPU56 [label="Attention Output Proj\nL4_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L4_EP1TP3PP0DP0_GPU56 [label="Attention All-Reduce\nL4 EP1 TP Group 3 PP0 DP0\nGPU56" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L4_EP1TP3PP0DP0_GPU56 [label="Residual Add 1\nL4_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L4_EP1TP3PP0DP0_GPU56 [label="Layer Norm 2\nL4_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L4_EP1TP3PP0DP0_GPU56 [label="MoE Gate (Routing)\nL4_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L4_EP1TP3PP0DP0_GPU56 [label="Expert Dispatch\nL4_EP1TP3PP0DP0_GPU56" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L4_EP1TP3PP0DP0_GPU56 [label="Expert 0\nL4_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L4_EP1TP3PP0DP0_GPU56 [label="Expert 1\nL4_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L4_EP1TP3PP0DP0_GPU56 [label="Expert 2\nL4_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L4_EP1TP3PP0DP0_GPU56 [label="Expert 3\nL4_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L4_EP1TP3PP0DP0_GPU56 [label="Expert Combine\nL4_EP1TP3PP0DP0_GPU56" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L4_EP1TP3PP0DP0_GPU56 [label="FFN (Up-proj + GeLU + Down-proj)\nL4_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L4_EP1TP3PP0DP0_GPU56 [label="FFN All-Reduce\nL4 EP1 TP Group 3 PP0 DP0\nGPU56" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L4_EP1TP3PP0DP0_GPU56 [label="Residual Add 2\nL4_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L4_EP1TP3PP0DP1_GPU57 [label="Layer Norm 1\nL4_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L4_EP1TP3PP0DP1_GPU57 [label="QKV Projection\nL4_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L4_EP1TP3PP0DP1_GPU57 [label="Multi-Head Attention\nL4_EP1TP3PP0DP1_GPU57\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L4_EP1TP3PP0DP1_GPU57 [label="Attention Output Proj\nL4_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L4_EP1TP3PP0DP1_GPU57 [label="Attention All-Reduce\nL4 EP1 TP Group 3 PP0 DP1\nGPU57" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L4_EP1TP3PP0DP1_GPU57 [label="Residual Add 1\nL4_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L4_EP1TP3PP0DP1_GPU57 [label="Layer Norm 2\nL4_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L4_EP1TP3PP0DP1_GPU57 [label="MoE Gate (Routing)\nL4_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L4_EP1TP3PP0DP1_GPU57 [label="Expert Dispatch\nL4_EP1TP3PP0DP1_GPU57" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L4_EP1TP3PP0DP1_GPU57 [label="Expert 0\nL4_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L4_EP1TP3PP0DP1_GPU57 [label="Expert 1\nL4_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L4_EP1TP3PP0DP1_GPU57 [label="Expert 2\nL4_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L4_EP1TP3PP0DP1_GPU57 [label="Expert 3\nL4_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L4_EP1TP3PP0DP1_GPU57 [label="Expert Combine\nL4_EP1TP3PP0DP1_GPU57" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L4_EP1TP3PP0DP1_GPU57 [label="FFN (Up-proj + GeLU + Down-proj)\nL4_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L4_EP1TP3PP0DP1_GPU57 [label="FFN All-Reduce\nL4 EP1 TP Group 3 PP0 DP1\nGPU57" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L4_EP1TP3PP0DP1_GPU57 [label="Residual Add 2\nL4_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L5_EP0TP0PP0DP0_GPU0 [label="Layer Norm 1\nL5_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L5_EP0TP0PP0DP0_GPU0 [label="QKV Projection\nL5_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L5_EP0TP0PP0DP0_GPU0 [label="Multi-Head Attention\nL5_EP0TP0PP0DP0_GPU0\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L5_EP0TP0PP0DP0_GPU0 [label="Attention Output Proj\nL5_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L5_EP0TP0PP0DP0_GPU0 [label="Attention All-Reduce\nL5 EP0 TP Group 0 PP0 DP0\nGPU0" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L5_EP0TP0PP0DP0_GPU0 [label="Residual Add 1\nL5_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L5_EP0TP0PP0DP0_GPU0 [label="Layer Norm 2\nL5_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L5_EP0TP0PP0DP0_GPU0 [label="MoE Gate (Routing)\nL5_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L5_EP0TP0PP0DP0_GPU0 [label="Expert Dispatch\nL5_EP0TP0PP0DP0_GPU0" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L5_EP0TP0PP0DP0_GPU0 [label="Expert 0\nL5_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L5_EP0TP0PP0DP0_GPU0 [label="Expert 1\nL5_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L5_EP0TP0PP0DP0_GPU0 [label="Expert 2\nL5_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L5_EP0TP0PP0DP0_GPU0 [label="Expert 3\nL5_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L5_EP0TP0PP0DP0_GPU0 [label="Expert Combine\nL5_EP0TP0PP0DP0_GPU0" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L5_EP0TP0PP0DP0_GPU0 [label="FFN (Up-proj + GeLU + Down-proj)\nL5_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L5_EP0TP0PP0DP0_GPU0 [label="FFN All-Reduce\nL5 EP0 TP Group 0 PP0 DP0\nGPU0" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L5_EP0TP0PP0DP0_GPU0 [label="Residual Add 2\nL5_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L5_EP0TP0PP0DP1_GPU1 [label="Layer Norm 1\nL5_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L5_EP0TP0PP0DP1_GPU1 [label="QKV Projection\nL5_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L5_EP0TP0PP0DP1_GPU1 [label="Multi-Head Attention\nL5_EP0TP0PP0DP1_GPU1\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L5_EP0TP0PP0DP1_GPU1 [label="Attention Output Proj\nL5_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L5_EP0TP0PP0DP1_GPU1 [label="Attention All-Reduce\nL5 EP0 TP Group 0 PP0 DP1\nGPU1" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L5_EP0TP0PP0DP1_GPU1 [label="Residual Add 1\nL5_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L5_EP0TP0PP0DP1_GPU1 [label="Layer Norm 2\nL5_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L5_EP0TP0PP0DP1_GPU1 [label="MoE Gate (Routing)\nL5_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L5_EP0TP0PP0DP1_GPU1 [label="Expert Dispatch\nL5_EP0TP0PP0DP1_GPU1" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L5_EP0TP0PP0DP1_GPU1 [label="Expert 0\nL5_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L5_EP0TP0PP0DP1_GPU1 [label="Expert 1\nL5_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L5_EP0TP0PP0DP1_GPU1 [label="Expert 2\nL5_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L5_EP0TP0PP0DP1_GPU1 [label="Expert 3\nL5_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L5_EP0TP0PP0DP1_GPU1 [label="Expert Combine\nL5_EP0TP0PP0DP1_GPU1" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L5_EP0TP0PP0DP1_GPU1 [label="FFN (Up-proj + GeLU + Down-proj)\nL5_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L5_EP0TP0PP0DP1_GPU1 [label="FFN All-Reduce\nL5 EP0 TP Group 0 PP0 DP1\nGPU1" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L5_EP0TP0PP0DP1_GPU1 [label="Residual Add 2\nL5_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L5_EP0TP1PP0DP0_GPU8 [label="Layer Norm 1\nL5_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L5_EP0TP1PP0DP0_GPU8 [label="QKV Projection\nL5_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L5_EP0TP1PP0DP0_GPU8 [label="Multi-Head Attention\nL5_EP0TP1PP0DP0_GPU8\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L5_EP0TP1PP0DP0_GPU8 [label="Attention Output Proj\nL5_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L5_EP0TP1PP0DP0_GPU8 [label="Attention All-Reduce\nL5 EP0 TP Group 1 PP0 DP0\nGPU8" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L5_EP0TP1PP0DP0_GPU8 [label="Residual Add 1\nL5_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L5_EP0TP1PP0DP0_GPU8 [label="Layer Norm 2\nL5_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L5_EP0TP1PP0DP0_GPU8 [label="MoE Gate (Routing)\nL5_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L5_EP0TP1PP0DP0_GPU8 [label="Expert Dispatch\nL5_EP0TP1PP0DP0_GPU8" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L5_EP0TP1PP0DP0_GPU8 [label="Expert 0\nL5_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L5_EP0TP1PP0DP0_GPU8 [label="Expert 1\nL5_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L5_EP0TP1PP0DP0_GPU8 [label="Expert 2\nL5_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L5_EP0TP1PP0DP0_GPU8 [label="Expert 3\nL5_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L5_EP0TP1PP0DP0_GPU8 [label="Expert Combine\nL5_EP0TP1PP0DP0_GPU8" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L5_EP0TP1PP0DP0_GPU8 [label="FFN (Up-proj + GeLU + Down-proj)\nL5_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L5_EP0TP1PP0DP0_GPU8 [label="FFN All-Reduce\nL5 EP0 TP Group 1 PP0 DP0\nGPU8" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L5_EP0TP1PP0DP0_GPU8 [label="Residual Add 2\nL5_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L5_EP0TP1PP0DP1_GPU9 [label="Layer Norm 1\nL5_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L5_EP0TP1PP0DP1_GPU9 [label="QKV Projection\nL5_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L5_EP0TP1PP0DP1_GPU9 [label="Multi-Head Attention\nL5_EP0TP1PP0DP1_GPU9\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L5_EP0TP1PP0DP1_GPU9 [label="Attention Output Proj\nL5_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L5_EP0TP1PP0DP1_GPU9 [label="Attention All-Reduce\nL5 EP0 TP Group 1 PP0 DP1\nGPU9" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L5_EP0TP1PP0DP1_GPU9 [label="Residual Add 1\nL5_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L5_EP0TP1PP0DP1_GPU9 [label="Layer Norm 2\nL5_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L5_EP0TP1PP0DP1_GPU9 [label="MoE Gate (Routing)\nL5_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L5_EP0TP1PP0DP1_GPU9 [label="Expert Dispatch\nL5_EP0TP1PP0DP1_GPU9" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L5_EP0TP1PP0DP1_GPU9 [label="Expert 0\nL5_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L5_EP0TP1PP0DP1_GPU9 [label="Expert 1\nL5_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L5_EP0TP1PP0DP1_GPU9 [label="Expert 2\nL5_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L5_EP0TP1PP0DP1_GPU9 [label="Expert 3\nL5_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L5_EP0TP1PP0DP1_GPU9 [label="Expert Combine\nL5_EP0TP1PP0DP1_GPU9" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L5_EP0TP1PP0DP1_GPU9 [label="FFN (Up-proj + GeLU + Down-proj)\nL5_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L5_EP0TP1PP0DP1_GPU9 [label="FFN All-Reduce\nL5 EP0 TP Group 1 PP0 DP1\nGPU9" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L5_EP0TP1PP0DP1_GPU9 [label="Residual Add 2\nL5_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L5_EP0TP2PP0DP0_GPU16 [label="Layer Norm 1\nL5_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L5_EP0TP2PP0DP0_GPU16 [label="QKV Projection\nL5_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L5_EP0TP2PP0DP0_GPU16 [label="Multi-Head Attention\nL5_EP0TP2PP0DP0_GPU16\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L5_EP0TP2PP0DP0_GPU16 [label="Attention Output Proj\nL5_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L5_EP0TP2PP0DP0_GPU16 [label="Attention All-Reduce\nL5 EP0 TP Group 2 PP0 DP0\nGPU16" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L5_EP0TP2PP0DP0_GPU16 [label="Residual Add 1\nL5_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L5_EP0TP2PP0DP0_GPU16 [label="Layer Norm 2\nL5_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L5_EP0TP2PP0DP0_GPU16 [label="MoE Gate (Routing)\nL5_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L5_EP0TP2PP0DP0_GPU16 [label="Expert Dispatch\nL5_EP0TP2PP0DP0_GPU16" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L5_EP0TP2PP0DP0_GPU16 [label="Expert 0\nL5_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L5_EP0TP2PP0DP0_GPU16 [label="Expert 1\nL5_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L5_EP0TP2PP0DP0_GPU16 [label="Expert 2\nL5_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L5_EP0TP2PP0DP0_GPU16 [label="Expert 3\nL5_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L5_EP0TP2PP0DP0_GPU16 [label="Expert Combine\nL5_EP0TP2PP0DP0_GPU16" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L5_EP0TP2PP0DP0_GPU16 [label="FFN (Up-proj + GeLU + Down-proj)\nL5_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L5_EP0TP2PP0DP0_GPU16 [label="FFN All-Reduce\nL5 EP0 TP Group 2 PP0 DP0\nGPU16" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L5_EP0TP2PP0DP0_GPU16 [label="Residual Add 2\nL5_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L5_EP0TP2PP0DP1_GPU17 [label="Layer Norm 1\nL5_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L5_EP0TP2PP0DP1_GPU17 [label="QKV Projection\nL5_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L5_EP0TP2PP0DP1_GPU17 [label="Multi-Head Attention\nL5_EP0TP2PP0DP1_GPU17\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L5_EP0TP2PP0DP1_GPU17 [label="Attention Output Proj\nL5_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L5_EP0TP2PP0DP1_GPU17 [label="Attention All-Reduce\nL5 EP0 TP Group 2 PP0 DP1\nGPU17" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L5_EP0TP2PP0DP1_GPU17 [label="Residual Add 1\nL5_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L5_EP0TP2PP0DP1_GPU17 [label="Layer Norm 2\nL5_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L5_EP0TP2PP0DP1_GPU17 [label="MoE Gate (Routing)\nL5_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L5_EP0TP2PP0DP1_GPU17 [label="Expert Dispatch\nL5_EP0TP2PP0DP1_GPU17" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L5_EP0TP2PP0DP1_GPU17 [label="Expert 0\nL5_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L5_EP0TP2PP0DP1_GPU17 [label="Expert 1\nL5_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L5_EP0TP2PP0DP1_GPU17 [label="Expert 2\nL5_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L5_EP0TP2PP0DP1_GPU17 [label="Expert 3\nL5_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L5_EP0TP2PP0DP1_GPU17 [label="Expert Combine\nL5_EP0TP2PP0DP1_GPU17" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L5_EP0TP2PP0DP1_GPU17 [label="FFN (Up-proj + GeLU + Down-proj)\nL5_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L5_EP0TP2PP0DP1_GPU17 [label="FFN All-Reduce\nL5 EP0 TP Group 2 PP0 DP1\nGPU17" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L5_EP0TP2PP0DP1_GPU17 [label="Residual Add 2\nL5_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L5_EP0TP3PP0DP0_GPU24 [label="Layer Norm 1\nL5_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L5_EP0TP3PP0DP0_GPU24 [label="QKV Projection\nL5_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L5_EP0TP3PP0DP0_GPU24 [label="Multi-Head Attention\nL5_EP0TP3PP0DP0_GPU24\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L5_EP0TP3PP0DP0_GPU24 [label="Attention Output Proj\nL5_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L5_EP0TP3PP0DP0_GPU24 [label="Attention All-Reduce\nL5 EP0 TP Group 3 PP0 DP0\nGPU24" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L5_EP0TP3PP0DP0_GPU24 [label="Residual Add 1\nL5_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L5_EP0TP3PP0DP0_GPU24 [label="Layer Norm 2\nL5_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L5_EP0TP3PP0DP0_GPU24 [label="MoE Gate (Routing)\nL5_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L5_EP0TP3PP0DP0_GPU24 [label="Expert Dispatch\nL5_EP0TP3PP0DP0_GPU24" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L5_EP0TP3PP0DP0_GPU24 [label="Expert 0\nL5_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L5_EP0TP3PP0DP0_GPU24 [label="Expert 1\nL5_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L5_EP0TP3PP0DP0_GPU24 [label="Expert 2\nL5_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L5_EP0TP3PP0DP0_GPU24 [label="Expert 3\nL5_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L5_EP0TP3PP0DP0_GPU24 [label="Expert Combine\nL5_EP0TP3PP0DP0_GPU24" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L5_EP0TP3PP0DP0_GPU24 [label="FFN (Up-proj + GeLU + Down-proj)\nL5_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L5_EP0TP3PP0DP0_GPU24 [label="FFN All-Reduce\nL5 EP0 TP Group 3 PP0 DP0\nGPU24" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L5_EP0TP3PP0DP0_GPU24 [label="Residual Add 2\nL5_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L5_EP0TP3PP0DP1_GPU25 [label="Layer Norm 1\nL5_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L5_EP0TP3PP0DP1_GPU25 [label="QKV Projection\nL5_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L5_EP0TP3PP0DP1_GPU25 [label="Multi-Head Attention\nL5_EP0TP3PP0DP1_GPU25\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L5_EP0TP3PP0DP1_GPU25 [label="Attention Output Proj\nL5_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L5_EP0TP3PP0DP1_GPU25 [label="Attention All-Reduce\nL5 EP0 TP Group 3 PP0 DP1\nGPU25" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L5_EP0TP3PP0DP1_GPU25 [label="Residual Add 1\nL5_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L5_EP0TP3PP0DP1_GPU25 [label="Layer Norm 2\nL5_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L5_EP0TP3PP0DP1_GPU25 [label="MoE Gate (Routing)\nL5_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L5_EP0TP3PP0DP1_GPU25 [label="Expert Dispatch\nL5_EP0TP3PP0DP1_GPU25" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L5_EP0TP3PP0DP1_GPU25 [label="Expert 0\nL5_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L5_EP0TP3PP0DP1_GPU25 [label="Expert 1\nL5_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L5_EP0TP3PP0DP1_GPU25 [label="Expert 2\nL5_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L5_EP0TP3PP0DP1_GPU25 [label="Expert 3\nL5_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L5_EP0TP3PP0DP1_GPU25 [label="Expert Combine\nL5_EP0TP3PP0DP1_GPU25" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L5_EP0TP3PP0DP1_GPU25 [label="FFN (Up-proj + GeLU + Down-proj)\nL5_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L5_EP0TP3PP0DP1_GPU25 [label="FFN All-Reduce\nL5 EP0 TP Group 3 PP0 DP1\nGPU25" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L5_EP0TP3PP0DP1_GPU25 [label="Residual Add 2\nL5_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L5_EP1TP0PP0DP0_GPU32 [label="Layer Norm 1\nL5_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L5_EP1TP0PP0DP0_GPU32 [label="QKV Projection\nL5_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L5_EP1TP0PP0DP0_GPU32 [label="Multi-Head Attention\nL5_EP1TP0PP0DP0_GPU32\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L5_EP1TP0PP0DP0_GPU32 [label="Attention Output Proj\nL5_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L5_EP1TP0PP0DP0_GPU32 [label="Attention All-Reduce\nL5 EP1 TP Group 0 PP0 DP0\nGPU32" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L5_EP1TP0PP0DP0_GPU32 [label="Residual Add 1\nL5_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L5_EP1TP0PP0DP0_GPU32 [label="Layer Norm 2\nL5_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L5_EP1TP0PP0DP0_GPU32 [label="MoE Gate (Routing)\nL5_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L5_EP1TP0PP0DP0_GPU32 [label="Expert Dispatch\nL5_EP1TP0PP0DP0_GPU32" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L5_EP1TP0PP0DP0_GPU32 [label="Expert 0\nL5_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L5_EP1TP0PP0DP0_GPU32 [label="Expert 1\nL5_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L5_EP1TP0PP0DP0_GPU32 [label="Expert 2\nL5_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L5_EP1TP0PP0DP0_GPU32 [label="Expert 3\nL5_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L5_EP1TP0PP0DP0_GPU32 [label="Expert Combine\nL5_EP1TP0PP0DP0_GPU32" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L5_EP1TP0PP0DP0_GPU32 [label="FFN (Up-proj + GeLU + Down-proj)\nL5_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L5_EP1TP0PP0DP0_GPU32 [label="FFN All-Reduce\nL5 EP1 TP Group 0 PP0 DP0\nGPU32" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L5_EP1TP0PP0DP0_GPU32 [label="Residual Add 2\nL5_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L5_EP1TP0PP0DP1_GPU33 [label="Layer Norm 1\nL5_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L5_EP1TP0PP0DP1_GPU33 [label="QKV Projection\nL5_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L5_EP1TP0PP0DP1_GPU33 [label="Multi-Head Attention\nL5_EP1TP0PP0DP1_GPU33\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L5_EP1TP0PP0DP1_GPU33 [label="Attention Output Proj\nL5_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L5_EP1TP0PP0DP1_GPU33 [label="Attention All-Reduce\nL5 EP1 TP Group 0 PP0 DP1\nGPU33" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L5_EP1TP0PP0DP1_GPU33 [label="Residual Add 1\nL5_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L5_EP1TP0PP0DP1_GPU33 [label="Layer Norm 2\nL5_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L5_EP1TP0PP0DP1_GPU33 [label="MoE Gate (Routing)\nL5_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L5_EP1TP0PP0DP1_GPU33 [label="Expert Dispatch\nL5_EP1TP0PP0DP1_GPU33" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L5_EP1TP0PP0DP1_GPU33 [label="Expert 0\nL5_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L5_EP1TP0PP0DP1_GPU33 [label="Expert 1\nL5_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L5_EP1TP0PP0DP1_GPU33 [label="Expert 2\nL5_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L5_EP1TP0PP0DP1_GPU33 [label="Expert 3\nL5_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L5_EP1TP0PP0DP1_GPU33 [label="Expert Combine\nL5_EP1TP0PP0DP1_GPU33" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L5_EP1TP0PP0DP1_GPU33 [label="FFN (Up-proj + GeLU + Down-proj)\nL5_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L5_EP1TP0PP0DP1_GPU33 [label="FFN All-Reduce\nL5 EP1 TP Group 0 PP0 DP1\nGPU33" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L5_EP1TP0PP0DP1_GPU33 [label="Residual Add 2\nL5_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L5_EP1TP1PP0DP0_GPU40 [label="Layer Norm 1\nL5_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L5_EP1TP1PP0DP0_GPU40 [label="QKV Projection\nL5_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L5_EP1TP1PP0DP0_GPU40 [label="Multi-Head Attention\nL5_EP1TP1PP0DP0_GPU40\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L5_EP1TP1PP0DP0_GPU40 [label="Attention Output Proj\nL5_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L5_EP1TP1PP0DP0_GPU40 [label="Attention All-Reduce\nL5 EP1 TP Group 1 PP0 DP0\nGPU40" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L5_EP1TP1PP0DP0_GPU40 [label="Residual Add 1\nL5_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L5_EP1TP1PP0DP0_GPU40 [label="Layer Norm 2\nL5_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L5_EP1TP1PP0DP0_GPU40 [label="MoE Gate (Routing)\nL5_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L5_EP1TP1PP0DP0_GPU40 [label="Expert Dispatch\nL5_EP1TP1PP0DP0_GPU40" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L5_EP1TP1PP0DP0_GPU40 [label="Expert 0\nL5_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L5_EP1TP1PP0DP0_GPU40 [label="Expert 1\nL5_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L5_EP1TP1PP0DP0_GPU40 [label="Expert 2\nL5_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L5_EP1TP1PP0DP0_GPU40 [label="Expert 3\nL5_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L5_EP1TP1PP0DP0_GPU40 [label="Expert Combine\nL5_EP1TP1PP0DP0_GPU40" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L5_EP1TP1PP0DP0_GPU40 [label="FFN (Up-proj + GeLU + Down-proj)\nL5_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L5_EP1TP1PP0DP0_GPU40 [label="FFN All-Reduce\nL5 EP1 TP Group 1 PP0 DP0\nGPU40" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L5_EP1TP1PP0DP0_GPU40 [label="Residual Add 2\nL5_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L5_EP1TP1PP0DP1_GPU41 [label="Layer Norm 1\nL5_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L5_EP1TP1PP0DP1_GPU41 [label="QKV Projection\nL5_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L5_EP1TP1PP0DP1_GPU41 [label="Multi-Head Attention\nL5_EP1TP1PP0DP1_GPU41\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L5_EP1TP1PP0DP1_GPU41 [label="Attention Output Proj\nL5_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L5_EP1TP1PP0DP1_GPU41 [label="Attention All-Reduce\nL5 EP1 TP Group 1 PP0 DP1\nGPU41" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L5_EP1TP1PP0DP1_GPU41 [label="Residual Add 1\nL5_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L5_EP1TP1PP0DP1_GPU41 [label="Layer Norm 2\nL5_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L5_EP1TP1PP0DP1_GPU41 [label="MoE Gate (Routing)\nL5_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L5_EP1TP1PP0DP1_GPU41 [label="Expert Dispatch\nL5_EP1TP1PP0DP1_GPU41" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L5_EP1TP1PP0DP1_GPU41 [label="Expert 0\nL5_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L5_EP1TP1PP0DP1_GPU41 [label="Expert 1\nL5_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L5_EP1TP1PP0DP1_GPU41 [label="Expert 2\nL5_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L5_EP1TP1PP0DP1_GPU41 [label="Expert 3\nL5_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L5_EP1TP1PP0DP1_GPU41 [label="Expert Combine\nL5_EP1TP1PP0DP1_GPU41" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L5_EP1TP1PP0DP1_GPU41 [label="FFN (Up-proj + GeLU + Down-proj)\nL5_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L5_EP1TP1PP0DP1_GPU41 [label="FFN All-Reduce\nL5 EP1 TP Group 1 PP0 DP1\nGPU41" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L5_EP1TP1PP0DP1_GPU41 [label="Residual Add 2\nL5_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L5_EP1TP2PP0DP0_GPU48 [label="Layer Norm 1\nL5_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L5_EP1TP2PP0DP0_GPU48 [label="QKV Projection\nL5_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L5_EP1TP2PP0DP0_GPU48 [label="Multi-Head Attention\nL5_EP1TP2PP0DP0_GPU48\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L5_EP1TP2PP0DP0_GPU48 [label="Attention Output Proj\nL5_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L5_EP1TP2PP0DP0_GPU48 [label="Attention All-Reduce\nL5 EP1 TP Group 2 PP0 DP0\nGPU48" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L5_EP1TP2PP0DP0_GPU48 [label="Residual Add 1\nL5_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L5_EP1TP2PP0DP0_GPU48 [label="Layer Norm 2\nL5_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L5_EP1TP2PP0DP0_GPU48 [label="MoE Gate (Routing)\nL5_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L5_EP1TP2PP0DP0_GPU48 [label="Expert Dispatch\nL5_EP1TP2PP0DP0_GPU48" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L5_EP1TP2PP0DP0_GPU48 [label="Expert 0\nL5_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L5_EP1TP2PP0DP0_GPU48 [label="Expert 1\nL5_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L5_EP1TP2PP0DP0_GPU48 [label="Expert 2\nL5_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L5_EP1TP2PP0DP0_GPU48 [label="Expert 3\nL5_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L5_EP1TP2PP0DP0_GPU48 [label="Expert Combine\nL5_EP1TP2PP0DP0_GPU48" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L5_EP1TP2PP0DP0_GPU48 [label="FFN (Up-proj + GeLU + Down-proj)\nL5_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L5_EP1TP2PP0DP0_GPU48 [label="FFN All-Reduce\nL5 EP1 TP Group 2 PP0 DP0\nGPU48" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L5_EP1TP2PP0DP0_GPU48 [label="Residual Add 2\nL5_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L5_EP1TP2PP0DP1_GPU49 [label="Layer Norm 1\nL5_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L5_EP1TP2PP0DP1_GPU49 [label="QKV Projection\nL5_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L5_EP1TP2PP0DP1_GPU49 [label="Multi-Head Attention\nL5_EP1TP2PP0DP1_GPU49\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L5_EP1TP2PP0DP1_GPU49 [label="Attention Output Proj\nL5_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L5_EP1TP2PP0DP1_GPU49 [label="Attention All-Reduce\nL5 EP1 TP Group 2 PP0 DP1\nGPU49" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L5_EP1TP2PP0DP1_GPU49 [label="Residual Add 1\nL5_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L5_EP1TP2PP0DP1_GPU49 [label="Layer Norm 2\nL5_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L5_EP1TP2PP0DP1_GPU49 [label="MoE Gate (Routing)\nL5_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L5_EP1TP2PP0DP1_GPU49 [label="Expert Dispatch\nL5_EP1TP2PP0DP1_GPU49" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L5_EP1TP2PP0DP1_GPU49 [label="Expert 0\nL5_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L5_EP1TP2PP0DP1_GPU49 [label="Expert 1\nL5_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L5_EP1TP2PP0DP1_GPU49 [label="Expert 2\nL5_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L5_EP1TP2PP0DP1_GPU49 [label="Expert 3\nL5_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L5_EP1TP2PP0DP1_GPU49 [label="Expert Combine\nL5_EP1TP2PP0DP1_GPU49" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L5_EP1TP2PP0DP1_GPU49 [label="FFN (Up-proj + GeLU + Down-proj)\nL5_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L5_EP1TP2PP0DP1_GPU49 [label="FFN All-Reduce\nL5 EP1 TP Group 2 PP0 DP1\nGPU49" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L5_EP1TP2PP0DP1_GPU49 [label="Residual Add 2\nL5_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L5_EP1TP3PP0DP0_GPU56 [label="Layer Norm 1\nL5_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L5_EP1TP3PP0DP0_GPU56 [label="QKV Projection\nL5_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L5_EP1TP3PP0DP0_GPU56 [label="Multi-Head Attention\nL5_EP1TP3PP0DP0_GPU56\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L5_EP1TP3PP0DP0_GPU56 [label="Attention Output Proj\nL5_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L5_EP1TP3PP0DP0_GPU56 [label="Attention All-Reduce\nL5 EP1 TP Group 3 PP0 DP0\nGPU56" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L5_EP1TP3PP0DP0_GPU56 [label="Residual Add 1\nL5_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L5_EP1TP3PP0DP0_GPU56 [label="Layer Norm 2\nL5_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L5_EP1TP3PP0DP0_GPU56 [label="MoE Gate (Routing)\nL5_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L5_EP1TP3PP0DP0_GPU56 [label="Expert Dispatch\nL5_EP1TP3PP0DP0_GPU56" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L5_EP1TP3PP0DP0_GPU56 [label="Expert 0\nL5_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L5_EP1TP3PP0DP0_GPU56 [label="Expert 1\nL5_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L5_EP1TP3PP0DP0_GPU56 [label="Expert 2\nL5_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L5_EP1TP3PP0DP0_GPU56 [label="Expert 3\nL5_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L5_EP1TP3PP0DP0_GPU56 [label="Expert Combine\nL5_EP1TP3PP0DP0_GPU56" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L5_EP1TP3PP0DP0_GPU56 [label="FFN (Up-proj + GeLU + Down-proj)\nL5_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L5_EP1TP3PP0DP0_GPU56 [label="FFN All-Reduce\nL5 EP1 TP Group 3 PP0 DP0\nGPU56" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L5_EP1TP3PP0DP0_GPU56 [label="Residual Add 2\nL5_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L5_EP1TP3PP0DP1_GPU57 [label="Layer Norm 1\nL5_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L5_EP1TP3PP0DP1_GPU57 [label="QKV Projection\nL5_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L5_EP1TP3PP0DP1_GPU57 [label="Multi-Head Attention\nL5_EP1TP3PP0DP1_GPU57\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L5_EP1TP3PP0DP1_GPU57 [label="Attention Output Proj\nL5_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L5_EP1TP3PP0DP1_GPU57 [label="Attention All-Reduce\nL5 EP1 TP Group 3 PP0 DP1\nGPU57" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L5_EP1TP3PP0DP1_GPU57 [label="Residual Add 1\nL5_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L5_EP1TP3PP0DP1_GPU57 [label="Layer Norm 2\nL5_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L5_EP1TP3PP0DP1_GPU57 [label="MoE Gate (Routing)\nL5_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L5_EP1TP3PP0DP1_GPU57 [label="Expert Dispatch\nL5_EP1TP3PP0DP1_GPU57" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L5_EP1TP3PP0DP1_GPU57 [label="Expert 0\nL5_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L5_EP1TP3PP0DP1_GPU57 [label="Expert 1\nL5_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L5_EP1TP3PP0DP1_GPU57 [label="Expert 2\nL5_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L5_EP1TP3PP0DP1_GPU57 [label="Expert 3\nL5_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L5_EP1TP3PP0DP1_GPU57 [label="Expert Combine\nL5_EP1TP3PP0DP1_GPU57" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L5_EP1TP3PP0DP1_GPU57 [label="FFN (Up-proj + GeLU + Down-proj)\nL5_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L5_EP1TP3PP0DP1_GPU57 [label="FFN All-Reduce\nL5 EP1 TP Group 3 PP0 DP1\nGPU57" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L5_EP1TP3PP0DP1_GPU57 [label="Residual Add 2\nL5_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L6_EP0TP0PP0DP0_GPU0 [label="Layer Norm 1\nL6_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L6_EP0TP0PP0DP0_GPU0 [label="QKV Projection\nL6_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L6_EP0TP0PP0DP0_GPU0 [label="Multi-Head Attention\nL6_EP0TP0PP0DP0_GPU0\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L6_EP0TP0PP0DP0_GPU0 [label="Attention Output Proj\nL6_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L6_EP0TP0PP0DP0_GPU0 [label="Attention All-Reduce\nL6 EP0 TP Group 0 PP0 DP0\nGPU0" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L6_EP0TP0PP0DP0_GPU0 [label="Residual Add 1\nL6_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L6_EP0TP0PP0DP0_GPU0 [label="Layer Norm 2\nL6_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L6_EP0TP0PP0DP0_GPU0 [label="MoE Gate (Routing)\nL6_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L6_EP0TP0PP0DP0_GPU0 [label="Expert Dispatch\nL6_EP0TP0PP0DP0_GPU0" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L6_EP0TP0PP0DP0_GPU0 [label="Expert 0\nL6_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L6_EP0TP0PP0DP0_GPU0 [label="Expert 1\nL6_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L6_EP0TP0PP0DP0_GPU0 [label="Expert 2\nL6_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L6_EP0TP0PP0DP0_GPU0 [label="Expert 3\nL6_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L6_EP0TP0PP0DP0_GPU0 [label="Expert Combine\nL6_EP0TP0PP0DP0_GPU0" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L6_EP0TP0PP0DP0_GPU0 [label="FFN (Up-proj + GeLU + Down-proj)\nL6_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L6_EP0TP0PP0DP0_GPU0 [label="FFN All-Reduce\nL6 EP0 TP Group 0 PP0 DP0\nGPU0" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L6_EP0TP0PP0DP0_GPU0 [label="Residual Add 2\nL6_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L6_EP0TP0PP0DP1_GPU1 [label="Layer Norm 1\nL6_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L6_EP0TP0PP0DP1_GPU1 [label="QKV Projection\nL6_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L6_EP0TP0PP0DP1_GPU1 [label="Multi-Head Attention\nL6_EP0TP0PP0DP1_GPU1\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L6_EP0TP0PP0DP1_GPU1 [label="Attention Output Proj\nL6_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L6_EP0TP0PP0DP1_GPU1 [label="Attention All-Reduce\nL6 EP0 TP Group 0 PP0 DP1\nGPU1" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L6_EP0TP0PP0DP1_GPU1 [label="Residual Add 1\nL6_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L6_EP0TP0PP0DP1_GPU1 [label="Layer Norm 2\nL6_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L6_EP0TP0PP0DP1_GPU1 [label="MoE Gate (Routing)\nL6_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L6_EP0TP0PP0DP1_GPU1 [label="Expert Dispatch\nL6_EP0TP0PP0DP1_GPU1" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L6_EP0TP0PP0DP1_GPU1 [label="Expert 0\nL6_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L6_EP0TP0PP0DP1_GPU1 [label="Expert 1\nL6_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L6_EP0TP0PP0DP1_GPU1 [label="Expert 2\nL6_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L6_EP0TP0PP0DP1_GPU1 [label="Expert 3\nL6_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L6_EP0TP0PP0DP1_GPU1 [label="Expert Combine\nL6_EP0TP0PP0DP1_GPU1" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L6_EP0TP0PP0DP1_GPU1 [label="FFN (Up-proj + GeLU + Down-proj)\nL6_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L6_EP0TP0PP0DP1_GPU1 [label="FFN All-Reduce\nL6 EP0 TP Group 0 PP0 DP1\nGPU1" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L6_EP0TP0PP0DP1_GPU1 [label="Residual Add 2\nL6_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L6_EP0TP1PP0DP0_GPU8 [label="Layer Norm 1\nL6_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L6_EP0TP1PP0DP0_GPU8 [label="QKV Projection\nL6_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L6_EP0TP1PP0DP0_GPU8 [label="Multi-Head Attention\nL6_EP0TP1PP0DP0_GPU8\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L6_EP0TP1PP0DP0_GPU8 [label="Attention Output Proj\nL6_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L6_EP0TP1PP0DP0_GPU8 [label="Attention All-Reduce\nL6 EP0 TP Group 1 PP0 DP0\nGPU8" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L6_EP0TP1PP0DP0_GPU8 [label="Residual Add 1\nL6_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L6_EP0TP1PP0DP0_GPU8 [label="Layer Norm 2\nL6_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L6_EP0TP1PP0DP0_GPU8 [label="MoE Gate (Routing)\nL6_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L6_EP0TP1PP0DP0_GPU8 [label="Expert Dispatch\nL6_EP0TP1PP0DP0_GPU8" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L6_EP0TP1PP0DP0_GPU8 [label="Expert 0\nL6_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L6_EP0TP1PP0DP0_GPU8 [label="Expert 1\nL6_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L6_EP0TP1PP0DP0_GPU8 [label="Expert 2\nL6_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L6_EP0TP1PP0DP0_GPU8 [label="Expert 3\nL6_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L6_EP0TP1PP0DP0_GPU8 [label="Expert Combine\nL6_EP0TP1PP0DP0_GPU8" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L6_EP0TP1PP0DP0_GPU8 [label="FFN (Up-proj + GeLU + Down-proj)\nL6_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L6_EP0TP1PP0DP0_GPU8 [label="FFN All-Reduce\nL6 EP0 TP Group 1 PP0 DP0\nGPU8" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L6_EP0TP1PP0DP0_GPU8 [label="Residual Add 2\nL6_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L6_EP0TP1PP0DP1_GPU9 [label="Layer Norm 1\nL6_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L6_EP0TP1PP0DP1_GPU9 [label="QKV Projection\nL6_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L6_EP0TP1PP0DP1_GPU9 [label="Multi-Head Attention\nL6_EP0TP1PP0DP1_GPU9\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L6_EP0TP1PP0DP1_GPU9 [label="Attention Output Proj\nL6_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L6_EP0TP1PP0DP1_GPU9 [label="Attention All-Reduce\nL6 EP0 TP Group 1 PP0 DP1\nGPU9" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L6_EP0TP1PP0DP1_GPU9 [label="Residual Add 1\nL6_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L6_EP0TP1PP0DP1_GPU9 [label="Layer Norm 2\nL6_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L6_EP0TP1PP0DP1_GPU9 [label="MoE Gate (Routing)\nL6_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L6_EP0TP1PP0DP1_GPU9 [label="Expert Dispatch\nL6_EP0TP1PP0DP1_GPU9" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L6_EP0TP1PP0DP1_GPU9 [label="Expert 0\nL6_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L6_EP0TP1PP0DP1_GPU9 [label="Expert 1\nL6_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L6_EP0TP1PP0DP1_GPU9 [label="Expert 2\nL6_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L6_EP0TP1PP0DP1_GPU9 [label="Expert 3\nL6_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L6_EP0TP1PP0DP1_GPU9 [label="Expert Combine\nL6_EP0TP1PP0DP1_GPU9" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L6_EP0TP1PP0DP1_GPU9 [label="FFN (Up-proj + GeLU + Down-proj)\nL6_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L6_EP0TP1PP0DP1_GPU9 [label="FFN All-Reduce\nL6 EP0 TP Group 1 PP0 DP1\nGPU9" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L6_EP0TP1PP0DP1_GPU9 [label="Residual Add 2\nL6_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L6_EP0TP2PP0DP0_GPU16 [label="Layer Norm 1\nL6_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L6_EP0TP2PP0DP0_GPU16 [label="QKV Projection\nL6_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L6_EP0TP2PP0DP0_GPU16 [label="Multi-Head Attention\nL6_EP0TP2PP0DP0_GPU16\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L6_EP0TP2PP0DP0_GPU16 [label="Attention Output Proj\nL6_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L6_EP0TP2PP0DP0_GPU16 [label="Attention All-Reduce\nL6 EP0 TP Group 2 PP0 DP0\nGPU16" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L6_EP0TP2PP0DP0_GPU16 [label="Residual Add 1\nL6_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L6_EP0TP2PP0DP0_GPU16 [label="Layer Norm 2\nL6_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L6_EP0TP2PP0DP0_GPU16 [label="MoE Gate (Routing)\nL6_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L6_EP0TP2PP0DP0_GPU16 [label="Expert Dispatch\nL6_EP0TP2PP0DP0_GPU16" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L6_EP0TP2PP0DP0_GPU16 [label="Expert 0\nL6_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L6_EP0TP2PP0DP0_GPU16 [label="Expert 1\nL6_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L6_EP0TP2PP0DP0_GPU16 [label="Expert 2\nL6_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L6_EP0TP2PP0DP0_GPU16 [label="Expert 3\nL6_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L6_EP0TP2PP0DP0_GPU16 [label="Expert Combine\nL6_EP0TP2PP0DP0_GPU16" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L6_EP0TP2PP0DP0_GPU16 [label="FFN (Up-proj + GeLU + Down-proj)\nL6_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L6_EP0TP2PP0DP0_GPU16 [label="FFN All-Reduce\nL6 EP0 TP Group 2 PP0 DP0\nGPU16" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L6_EP0TP2PP0DP0_GPU16 [label="Residual Add 2\nL6_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L6_EP0TP2PP0DP1_GPU17 [label="Layer Norm 1\nL6_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L6_EP0TP2PP0DP1_GPU17 [label="QKV Projection\nL6_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L6_EP0TP2PP0DP1_GPU17 [label="Multi-Head Attention\nL6_EP0TP2PP0DP1_GPU17\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L6_EP0TP2PP0DP1_GPU17 [label="Attention Output Proj\nL6_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L6_EP0TP2PP0DP1_GPU17 [label="Attention All-Reduce\nL6 EP0 TP Group 2 PP0 DP1\nGPU17" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L6_EP0TP2PP0DP1_GPU17 [label="Residual Add 1\nL6_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L6_EP0TP2PP0DP1_GPU17 [label="Layer Norm 2\nL6_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L6_EP0TP2PP0DP1_GPU17 [label="MoE Gate (Routing)\nL6_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L6_EP0TP2PP0DP1_GPU17 [label="Expert Dispatch\nL6_EP0TP2PP0DP1_GPU17" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L6_EP0TP2PP0DP1_GPU17 [label="Expert 0\nL6_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L6_EP0TP2PP0DP1_GPU17 [label="Expert 1\nL6_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L6_EP0TP2PP0DP1_GPU17 [label="Expert 2\nL6_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L6_EP0TP2PP0DP1_GPU17 [label="Expert 3\nL6_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L6_EP0TP2PP0DP1_GPU17 [label="Expert Combine\nL6_EP0TP2PP0DP1_GPU17" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L6_EP0TP2PP0DP1_GPU17 [label="FFN (Up-proj + GeLU + Down-proj)\nL6_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L6_EP0TP2PP0DP1_GPU17 [label="FFN All-Reduce\nL6 EP0 TP Group 2 PP0 DP1\nGPU17" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L6_EP0TP2PP0DP1_GPU17 [label="Residual Add 2\nL6_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L6_EP0TP3PP0DP0_GPU24 [label="Layer Norm 1\nL6_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L6_EP0TP3PP0DP0_GPU24 [label="QKV Projection\nL6_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L6_EP0TP3PP0DP0_GPU24 [label="Multi-Head Attention\nL6_EP0TP3PP0DP0_GPU24\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L6_EP0TP3PP0DP0_GPU24 [label="Attention Output Proj\nL6_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L6_EP0TP3PP0DP0_GPU24 [label="Attention All-Reduce\nL6 EP0 TP Group 3 PP0 DP0\nGPU24" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L6_EP0TP3PP0DP0_GPU24 [label="Residual Add 1\nL6_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L6_EP0TP3PP0DP0_GPU24 [label="Layer Norm 2\nL6_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L6_EP0TP3PP0DP0_GPU24 [label="MoE Gate (Routing)\nL6_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L6_EP0TP3PP0DP0_GPU24 [label="Expert Dispatch\nL6_EP0TP3PP0DP0_GPU24" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L6_EP0TP3PP0DP0_GPU24 [label="Expert 0\nL6_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L6_EP0TP3PP0DP0_GPU24 [label="Expert 1\nL6_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L6_EP0TP3PP0DP0_GPU24 [label="Expert 2\nL6_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L6_EP0TP3PP0DP0_GPU24 [label="Expert 3\nL6_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L6_EP0TP3PP0DP0_GPU24 [label="Expert Combine\nL6_EP0TP3PP0DP0_GPU24" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L6_EP0TP3PP0DP0_GPU24 [label="FFN (Up-proj + GeLU + Down-proj)\nL6_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L6_EP0TP3PP0DP0_GPU24 [label="FFN All-Reduce\nL6 EP0 TP Group 3 PP0 DP0\nGPU24" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L6_EP0TP3PP0DP0_GPU24 [label="Residual Add 2\nL6_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L6_EP0TP3PP0DP1_GPU25 [label="Layer Norm 1\nL6_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L6_EP0TP3PP0DP1_GPU25 [label="QKV Projection\nL6_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L6_EP0TP3PP0DP1_GPU25 [label="Multi-Head Attention\nL6_EP0TP3PP0DP1_GPU25\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L6_EP0TP3PP0DP1_GPU25 [label="Attention Output Proj\nL6_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L6_EP0TP3PP0DP1_GPU25 [label="Attention All-Reduce\nL6 EP0 TP Group 3 PP0 DP1\nGPU25" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L6_EP0TP3PP0DP1_GPU25 [label="Residual Add 1\nL6_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L6_EP0TP3PP0DP1_GPU25 [label="Layer Norm 2\nL6_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L6_EP0TP3PP0DP1_GPU25 [label="MoE Gate (Routing)\nL6_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L6_EP0TP3PP0DP1_GPU25 [label="Expert Dispatch\nL6_EP0TP3PP0DP1_GPU25" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L6_EP0TP3PP0DP1_GPU25 [label="Expert 0\nL6_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L6_EP0TP3PP0DP1_GPU25 [label="Expert 1\nL6_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L6_EP0TP3PP0DP1_GPU25 [label="Expert 2\nL6_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L6_EP0TP3PP0DP1_GPU25 [label="Expert 3\nL6_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L6_EP0TP3PP0DP1_GPU25 [label="Expert Combine\nL6_EP0TP3PP0DP1_GPU25" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L6_EP0TP3PP0DP1_GPU25 [label="FFN (Up-proj + GeLU + Down-proj)\nL6_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L6_EP0TP3PP0DP1_GPU25 [label="FFN All-Reduce\nL6 EP0 TP Group 3 PP0 DP1\nGPU25" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L6_EP0TP3PP0DP1_GPU25 [label="Residual Add 2\nL6_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L6_EP1TP0PP0DP0_GPU32 [label="Layer Norm 1\nL6_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L6_EP1TP0PP0DP0_GPU32 [label="QKV Projection\nL6_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L6_EP1TP0PP0DP0_GPU32 [label="Multi-Head Attention\nL6_EP1TP0PP0DP0_GPU32\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L6_EP1TP0PP0DP0_GPU32 [label="Attention Output Proj\nL6_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L6_EP1TP0PP0DP0_GPU32 [label="Attention All-Reduce\nL6 EP1 TP Group 0 PP0 DP0\nGPU32" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L6_EP1TP0PP0DP0_GPU32 [label="Residual Add 1\nL6_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L6_EP1TP0PP0DP0_GPU32 [label="Layer Norm 2\nL6_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L6_EP1TP0PP0DP0_GPU32 [label="MoE Gate (Routing)\nL6_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L6_EP1TP0PP0DP0_GPU32 [label="Expert Dispatch\nL6_EP1TP0PP0DP0_GPU32" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L6_EP1TP0PP0DP0_GPU32 [label="Expert 0\nL6_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L6_EP1TP0PP0DP0_GPU32 [label="Expert 1\nL6_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L6_EP1TP0PP0DP0_GPU32 [label="Expert 2\nL6_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L6_EP1TP0PP0DP0_GPU32 [label="Expert 3\nL6_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L6_EP1TP0PP0DP0_GPU32 [label="Expert Combine\nL6_EP1TP0PP0DP0_GPU32" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L6_EP1TP0PP0DP0_GPU32 [label="FFN (Up-proj + GeLU + Down-proj)\nL6_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L6_EP1TP0PP0DP0_GPU32 [label="FFN All-Reduce\nL6 EP1 TP Group 0 PP0 DP0\nGPU32" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L6_EP1TP0PP0DP0_GPU32 [label="Residual Add 2\nL6_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L6_EP1TP0PP0DP1_GPU33 [label="Layer Norm 1\nL6_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L6_EP1TP0PP0DP1_GPU33 [label="QKV Projection\nL6_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L6_EP1TP0PP0DP1_GPU33 [label="Multi-Head Attention\nL6_EP1TP0PP0DP1_GPU33\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L6_EP1TP0PP0DP1_GPU33 [label="Attention Output Proj\nL6_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L6_EP1TP0PP0DP1_GPU33 [label="Attention All-Reduce\nL6 EP1 TP Group 0 PP0 DP1\nGPU33" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L6_EP1TP0PP0DP1_GPU33 [label="Residual Add 1\nL6_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L6_EP1TP0PP0DP1_GPU33 [label="Layer Norm 2\nL6_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L6_EP1TP0PP0DP1_GPU33 [label="MoE Gate (Routing)\nL6_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L6_EP1TP0PP0DP1_GPU33 [label="Expert Dispatch\nL6_EP1TP0PP0DP1_GPU33" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L6_EP1TP0PP0DP1_GPU33 [label="Expert 0\nL6_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L6_EP1TP0PP0DP1_GPU33 [label="Expert 1\nL6_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L6_EP1TP0PP0DP1_GPU33 [label="Expert 2\nL6_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L6_EP1TP0PP0DP1_GPU33 [label="Expert 3\nL6_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L6_EP1TP0PP0DP1_GPU33 [label="Expert Combine\nL6_EP1TP0PP0DP1_GPU33" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L6_EP1TP0PP0DP1_GPU33 [label="FFN (Up-proj + GeLU + Down-proj)\nL6_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L6_EP1TP0PP0DP1_GPU33 [label="FFN All-Reduce\nL6 EP1 TP Group 0 PP0 DP1\nGPU33" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L6_EP1TP0PP0DP1_GPU33 [label="Residual Add 2\nL6_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L6_EP1TP1PP0DP0_GPU40 [label="Layer Norm 1\nL6_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L6_EP1TP1PP0DP0_GPU40 [label="QKV Projection\nL6_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L6_EP1TP1PP0DP0_GPU40 [label="Multi-Head Attention\nL6_EP1TP1PP0DP0_GPU40\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L6_EP1TP1PP0DP0_GPU40 [label="Attention Output Proj\nL6_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L6_EP1TP1PP0DP0_GPU40 [label="Attention All-Reduce\nL6 EP1 TP Group 1 PP0 DP0\nGPU40" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L6_EP1TP1PP0DP0_GPU40 [label="Residual Add 1\nL6_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L6_EP1TP1PP0DP0_GPU40 [label="Layer Norm 2\nL6_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L6_EP1TP1PP0DP0_GPU40 [label="MoE Gate (Routing)\nL6_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L6_EP1TP1PP0DP0_GPU40 [label="Expert Dispatch\nL6_EP1TP1PP0DP0_GPU40" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L6_EP1TP1PP0DP0_GPU40 [label="Expert 0\nL6_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L6_EP1TP1PP0DP0_GPU40 [label="Expert 1\nL6_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L6_EP1TP1PP0DP0_GPU40 [label="Expert 2\nL6_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L6_EP1TP1PP0DP0_GPU40 [label="Expert 3\nL6_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L6_EP1TP1PP0DP0_GPU40 [label="Expert Combine\nL6_EP1TP1PP0DP0_GPU40" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L6_EP1TP1PP0DP0_GPU40 [label="FFN (Up-proj + GeLU + Down-proj)\nL6_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L6_EP1TP1PP0DP0_GPU40 [label="FFN All-Reduce\nL6 EP1 TP Group 1 PP0 DP0\nGPU40" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L6_EP1TP1PP0DP0_GPU40 [label="Residual Add 2\nL6_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L6_EP1TP1PP0DP1_GPU41 [label="Layer Norm 1\nL6_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L6_EP1TP1PP0DP1_GPU41 [label="QKV Projection\nL6_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L6_EP1TP1PP0DP1_GPU41 [label="Multi-Head Attention\nL6_EP1TP1PP0DP1_GPU41\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L6_EP1TP1PP0DP1_GPU41 [label="Attention Output Proj\nL6_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L6_EP1TP1PP0DP1_GPU41 [label="Attention All-Reduce\nL6 EP1 TP Group 1 PP0 DP1\nGPU41" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L6_EP1TP1PP0DP1_GPU41 [label="Residual Add 1\nL6_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L6_EP1TP1PP0DP1_GPU41 [label="Layer Norm 2\nL6_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L6_EP1TP1PP0DP1_GPU41 [label="MoE Gate (Routing)\nL6_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L6_EP1TP1PP0DP1_GPU41 [label="Expert Dispatch\nL6_EP1TP1PP0DP1_GPU41" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L6_EP1TP1PP0DP1_GPU41 [label="Expert 0\nL6_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L6_EP1TP1PP0DP1_GPU41 [label="Expert 1\nL6_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L6_EP1TP1PP0DP1_GPU41 [label="Expert 2\nL6_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L6_EP1TP1PP0DP1_GPU41 [label="Expert 3\nL6_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L6_EP1TP1PP0DP1_GPU41 [label="Expert Combine\nL6_EP1TP1PP0DP1_GPU41" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L6_EP1TP1PP0DP1_GPU41 [label="FFN (Up-proj + GeLU + Down-proj)\nL6_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L6_EP1TP1PP0DP1_GPU41 [label="FFN All-Reduce\nL6 EP1 TP Group 1 PP0 DP1\nGPU41" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L6_EP1TP1PP0DP1_GPU41 [label="Residual Add 2\nL6_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L6_EP1TP2PP0DP0_GPU48 [label="Layer Norm 1\nL6_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L6_EP1TP2PP0DP0_GPU48 [label="QKV Projection\nL6_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L6_EP1TP2PP0DP0_GPU48 [label="Multi-Head Attention\nL6_EP1TP2PP0DP0_GPU48\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L6_EP1TP2PP0DP0_GPU48 [label="Attention Output Proj\nL6_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L6_EP1TP2PP0DP0_GPU48 [label="Attention All-Reduce\nL6 EP1 TP Group 2 PP0 DP0\nGPU48" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L6_EP1TP2PP0DP0_GPU48 [label="Residual Add 1\nL6_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L6_EP1TP2PP0DP0_GPU48 [label="Layer Norm 2\nL6_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L6_EP1TP2PP0DP0_GPU48 [label="MoE Gate (Routing)\nL6_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L6_EP1TP2PP0DP0_GPU48 [label="Expert Dispatch\nL6_EP1TP2PP0DP0_GPU48" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L6_EP1TP2PP0DP0_GPU48 [label="Expert 0\nL6_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L6_EP1TP2PP0DP0_GPU48 [label="Expert 1\nL6_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L6_EP1TP2PP0DP0_GPU48 [label="Expert 2\nL6_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L6_EP1TP2PP0DP0_GPU48 [label="Expert 3\nL6_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L6_EP1TP2PP0DP0_GPU48 [label="Expert Combine\nL6_EP1TP2PP0DP0_GPU48" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L6_EP1TP2PP0DP0_GPU48 [label="FFN (Up-proj + GeLU + Down-proj)\nL6_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L6_EP1TP2PP0DP0_GPU48 [label="FFN All-Reduce\nL6 EP1 TP Group 2 PP0 DP0\nGPU48" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L6_EP1TP2PP0DP0_GPU48 [label="Residual Add 2\nL6_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L6_EP1TP2PP0DP1_GPU49 [label="Layer Norm 1\nL6_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L6_EP1TP2PP0DP1_GPU49 [label="QKV Projection\nL6_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L6_EP1TP2PP0DP1_GPU49 [label="Multi-Head Attention\nL6_EP1TP2PP0DP1_GPU49\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L6_EP1TP2PP0DP1_GPU49 [label="Attention Output Proj\nL6_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L6_EP1TP2PP0DP1_GPU49 [label="Attention All-Reduce\nL6 EP1 TP Group 2 PP0 DP1\nGPU49" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L6_EP1TP2PP0DP1_GPU49 [label="Residual Add 1\nL6_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L6_EP1TP2PP0DP1_GPU49 [label="Layer Norm 2\nL6_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L6_EP1TP2PP0DP1_GPU49 [label="MoE Gate (Routing)\nL6_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L6_EP1TP2PP0DP1_GPU49 [label="Expert Dispatch\nL6_EP1TP2PP0DP1_GPU49" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L6_EP1TP2PP0DP1_GPU49 [label="Expert 0\nL6_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L6_EP1TP2PP0DP1_GPU49 [label="Expert 1\nL6_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L6_EP1TP2PP0DP1_GPU49 [label="Expert 2\nL6_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L6_EP1TP2PP0DP1_GPU49 [label="Expert 3\nL6_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L6_EP1TP2PP0DP1_GPU49 [label="Expert Combine\nL6_EP1TP2PP0DP1_GPU49" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L6_EP1TP2PP0DP1_GPU49 [label="FFN (Up-proj + GeLU + Down-proj)\nL6_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L6_EP1TP2PP0DP1_GPU49 [label="FFN All-Reduce\nL6 EP1 TP Group 2 PP0 DP1\nGPU49" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L6_EP1TP2PP0DP1_GPU49 [label="Residual Add 2\nL6_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L6_EP1TP3PP0DP0_GPU56 [label="Layer Norm 1\nL6_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L6_EP1TP3PP0DP0_GPU56 [label="QKV Projection\nL6_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L6_EP1TP3PP0DP0_GPU56 [label="Multi-Head Attention\nL6_EP1TP3PP0DP0_GPU56\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L6_EP1TP3PP0DP0_GPU56 [label="Attention Output Proj\nL6_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L6_EP1TP3PP0DP0_GPU56 [label="Attention All-Reduce\nL6 EP1 TP Group 3 PP0 DP0\nGPU56" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L6_EP1TP3PP0DP0_GPU56 [label="Residual Add 1\nL6_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L6_EP1TP3PP0DP0_GPU56 [label="Layer Norm 2\nL6_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L6_EP1TP3PP0DP0_GPU56 [label="MoE Gate (Routing)\nL6_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L6_EP1TP3PP0DP0_GPU56 [label="Expert Dispatch\nL6_EP1TP3PP0DP0_GPU56" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L6_EP1TP3PP0DP0_GPU56 [label="Expert 0\nL6_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L6_EP1TP3PP0DP0_GPU56 [label="Expert 1\nL6_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L6_EP1TP3PP0DP0_GPU56 [label="Expert 2\nL6_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L6_EP1TP3PP0DP0_GPU56 [label="Expert 3\nL6_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L6_EP1TP3PP0DP0_GPU56 [label="Expert Combine\nL6_EP1TP3PP0DP0_GPU56" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L6_EP1TP3PP0DP0_GPU56 [label="FFN (Up-proj + GeLU + Down-proj)\nL6_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L6_EP1TP3PP0DP0_GPU56 [label="FFN All-Reduce\nL6 EP1 TP Group 3 PP0 DP0\nGPU56" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L6_EP1TP3PP0DP0_GPU56 [label="Residual Add 2\nL6_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L6_EP1TP3PP0DP1_GPU57 [label="Layer Norm 1\nL6_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L6_EP1TP3PP0DP1_GPU57 [label="QKV Projection\nL6_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L6_EP1TP3PP0DP1_GPU57 [label="Multi-Head Attention\nL6_EP1TP3PP0DP1_GPU57\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L6_EP1TP3PP0DP1_GPU57 [label="Attention Output Proj\nL6_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L6_EP1TP3PP0DP1_GPU57 [label="Attention All-Reduce\nL6 EP1 TP Group 3 PP0 DP1\nGPU57" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L6_EP1TP3PP0DP1_GPU57 [label="Residual Add 1\nL6_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L6_EP1TP3PP0DP1_GPU57 [label="Layer Norm 2\nL6_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L6_EP1TP3PP0DP1_GPU57 [label="MoE Gate (Routing)\nL6_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L6_EP1TP3PP0DP1_GPU57 [label="Expert Dispatch\nL6_EP1TP3PP0DP1_GPU57" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L6_EP1TP3PP0DP1_GPU57 [label="Expert 0\nL6_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L6_EP1TP3PP0DP1_GPU57 [label="Expert 1\nL6_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L6_EP1TP3PP0DP1_GPU57 [label="Expert 2\nL6_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L6_EP1TP3PP0DP1_GPU57 [label="Expert 3\nL6_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L6_EP1TP3PP0DP1_GPU57 [label="Expert Combine\nL6_EP1TP3PP0DP1_GPU57" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L6_EP1TP3PP0DP1_GPU57 [label="FFN (Up-proj + GeLU + Down-proj)\nL6_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L6_EP1TP3PP0DP1_GPU57 [label="FFN All-Reduce\nL6 EP1 TP Group 3 PP0 DP1\nGPU57" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L6_EP1TP3PP0DP1_GPU57 [label="Residual Add 2\nL6_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L7_EP0TP0PP0DP0_GPU0 [label="Layer Norm 1\nL7_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L7_EP0TP0PP0DP0_GPU0 [label="QKV Projection\nL7_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L7_EP0TP0PP0DP0_GPU0 [label="Multi-Head Attention\nL7_EP0TP0PP0DP0_GPU0\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L7_EP0TP0PP0DP0_GPU0 [label="Attention Output Proj\nL7_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L7_EP0TP0PP0DP0_GPU0 [label="Attention All-Reduce\nL7 EP0 TP Group 0 PP0 DP0\nGPU0" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L7_EP0TP0PP0DP0_GPU0 [label="Residual Add 1\nL7_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L7_EP0TP0PP0DP0_GPU0 [label="Layer Norm 2\nL7_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L7_EP0TP0PP0DP0_GPU0 [label="MoE Gate (Routing)\nL7_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L7_EP0TP0PP0DP0_GPU0 [label="Expert Dispatch\nL7_EP0TP0PP0DP0_GPU0" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L7_EP0TP0PP0DP0_GPU0 [label="Expert 0\nL7_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L7_EP0TP0PP0DP0_GPU0 [label="Expert 1\nL7_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L7_EP0TP0PP0DP0_GPU0 [label="Expert 2\nL7_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L7_EP0TP0PP0DP0_GPU0 [label="Expert 3\nL7_EP0TP0PP0DP0_GPU0\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L7_EP0TP0PP0DP0_GPU0 [label="Expert Combine\nL7_EP0TP0PP0DP0_GPU0" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L7_EP0TP0PP0DP0_GPU0 [label="FFN (Up-proj + GeLU + Down-proj)\nL7_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L7_EP0TP0PP0DP0_GPU0 [label="FFN All-Reduce\nL7 EP0 TP Group 0 PP0 DP0\nGPU0" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L7_EP0TP0PP0DP0_GPU0 [label="Residual Add 2\nL7_EP0TP0PP0DP0_GPU0\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L7_EP0TP0PP0DP1_GPU1 [label="Layer Norm 1\nL7_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L7_EP0TP0PP0DP1_GPU1 [label="QKV Projection\nL7_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L7_EP0TP0PP0DP1_GPU1 [label="Multi-Head Attention\nL7_EP0TP0PP0DP1_GPU1\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L7_EP0TP0PP0DP1_GPU1 [label="Attention Output Proj\nL7_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L7_EP0TP0PP0DP1_GPU1 [label="Attention All-Reduce\nL7 EP0 TP Group 0 PP0 DP1\nGPU1" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L7_EP0TP0PP0DP1_GPU1 [label="Residual Add 1\nL7_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L7_EP0TP0PP0DP1_GPU1 [label="Layer Norm 2\nL7_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L7_EP0TP0PP0DP1_GPU1 [label="MoE Gate (Routing)\nL7_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L7_EP0TP0PP0DP1_GPU1 [label="Expert Dispatch\nL7_EP0TP0PP0DP1_GPU1" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L7_EP0TP0PP0DP1_GPU1 [label="Expert 0\nL7_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L7_EP0TP0PP0DP1_GPU1 [label="Expert 1\nL7_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L7_EP0TP0PP0DP1_GPU1 [label="Expert 2\nL7_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L7_EP0TP0PP0DP1_GPU1 [label="Expert 3\nL7_EP0TP0PP0DP1_GPU1\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L7_EP0TP0PP0DP1_GPU1 [label="Expert Combine\nL7_EP0TP0PP0DP1_GPU1" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L7_EP0TP0PP0DP1_GPU1 [label="FFN (Up-proj + GeLU + Down-proj)\nL7_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L7_EP0TP0PP0DP1_GPU1 [label="FFN All-Reduce\nL7 EP0 TP Group 0 PP0 DP1\nGPU1" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L7_EP0TP0PP0DP1_GPU1 [label="Residual Add 2\nL7_EP0TP0PP0DP1_GPU1\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L7_EP0TP1PP0DP0_GPU8 [label="Layer Norm 1\nL7_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L7_EP0TP1PP0DP0_GPU8 [label="QKV Projection\nL7_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L7_EP0TP1PP0DP0_GPU8 [label="Multi-Head Attention\nL7_EP0TP1PP0DP0_GPU8\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L7_EP0TP1PP0DP0_GPU8 [label="Attention Output Proj\nL7_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L7_EP0TP1PP0DP0_GPU8 [label="Attention All-Reduce\nL7 EP0 TP Group 1 PP0 DP0\nGPU8" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L7_EP0TP1PP0DP0_GPU8 [label="Residual Add 1\nL7_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L7_EP0TP1PP0DP0_GPU8 [label="Layer Norm 2\nL7_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L7_EP0TP1PP0DP0_GPU8 [label="MoE Gate (Routing)\nL7_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L7_EP0TP1PP0DP0_GPU8 [label="Expert Dispatch\nL7_EP0TP1PP0DP0_GPU8" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L7_EP0TP1PP0DP0_GPU8 [label="Expert 0\nL7_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L7_EP0TP1PP0DP0_GPU8 [label="Expert 1\nL7_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L7_EP0TP1PP0DP0_GPU8 [label="Expert 2\nL7_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L7_EP0TP1PP0DP0_GPU8 [label="Expert 3\nL7_EP0TP1PP0DP0_GPU8\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L7_EP0TP1PP0DP0_GPU8 [label="Expert Combine\nL7_EP0TP1PP0DP0_GPU8" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L7_EP0TP1PP0DP0_GPU8 [label="FFN (Up-proj + GeLU + Down-proj)\nL7_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L7_EP0TP1PP0DP0_GPU8 [label="FFN All-Reduce\nL7 EP0 TP Group 1 PP0 DP0\nGPU8" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L7_EP0TP1PP0DP0_GPU8 [label="Residual Add 2\nL7_EP0TP1PP0DP0_GPU8\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L7_EP0TP1PP0DP1_GPU9 [label="Layer Norm 1\nL7_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L7_EP0TP1PP0DP1_GPU9 [label="QKV Projection\nL7_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L7_EP0TP1PP0DP1_GPU9 [label="Multi-Head Attention\nL7_EP0TP1PP0DP1_GPU9\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L7_EP0TP1PP0DP1_GPU9 [label="Attention Output Proj\nL7_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L7_EP0TP1PP0DP1_GPU9 [label="Attention All-Reduce\nL7 EP0 TP Group 1 PP0 DP1\nGPU9" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L7_EP0TP1PP0DP1_GPU9 [label="Residual Add 1\nL7_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L7_EP0TP1PP0DP1_GPU9 [label="Layer Norm 2\nL7_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L7_EP0TP1PP0DP1_GPU9 [label="MoE Gate (Routing)\nL7_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L7_EP0TP1PP0DP1_GPU9 [label="Expert Dispatch\nL7_EP0TP1PP0DP1_GPU9" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L7_EP0TP1PP0DP1_GPU9 [label="Expert 0\nL7_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L7_EP0TP1PP0DP1_GPU9 [label="Expert 1\nL7_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L7_EP0TP1PP0DP1_GPU9 [label="Expert 2\nL7_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L7_EP0TP1PP0DP1_GPU9 [label="Expert 3\nL7_EP0TP1PP0DP1_GPU9\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L7_EP0TP1PP0DP1_GPU9 [label="Expert Combine\nL7_EP0TP1PP0DP1_GPU9" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L7_EP0TP1PP0DP1_GPU9 [label="FFN (Up-proj + GeLU + Down-proj)\nL7_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L7_EP0TP1PP0DP1_GPU9 [label="FFN All-Reduce\nL7 EP0 TP Group 1 PP0 DP1\nGPU9" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L7_EP0TP1PP0DP1_GPU9 [label="Residual Add 2\nL7_EP0TP1PP0DP1_GPU9\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L7_EP0TP2PP0DP0_GPU16 [label="Layer Norm 1\nL7_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L7_EP0TP2PP0DP0_GPU16 [label="QKV Projection\nL7_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L7_EP0TP2PP0DP0_GPU16 [label="Multi-Head Attention\nL7_EP0TP2PP0DP0_GPU16\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L7_EP0TP2PP0DP0_GPU16 [label="Attention Output Proj\nL7_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L7_EP0TP2PP0DP0_GPU16 [label="Attention All-Reduce\nL7 EP0 TP Group 2 PP0 DP0\nGPU16" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L7_EP0TP2PP0DP0_GPU16 [label="Residual Add 1\nL7_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L7_EP0TP2PP0DP0_GPU16 [label="Layer Norm 2\nL7_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L7_EP0TP2PP0DP0_GPU16 [label="MoE Gate (Routing)\nL7_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L7_EP0TP2PP0DP0_GPU16 [label="Expert Dispatch\nL7_EP0TP2PP0DP0_GPU16" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L7_EP0TP2PP0DP0_GPU16 [label="Expert 0\nL7_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L7_EP0TP2PP0DP0_GPU16 [label="Expert 1\nL7_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L7_EP0TP2PP0DP0_GPU16 [label="Expert 2\nL7_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L7_EP0TP2PP0DP0_GPU16 [label="Expert 3\nL7_EP0TP2PP0DP0_GPU16\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L7_EP0TP2PP0DP0_GPU16 [label="Expert Combine\nL7_EP0TP2PP0DP0_GPU16" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L7_EP0TP2PP0DP0_GPU16 [label="FFN (Up-proj + GeLU + Down-proj)\nL7_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L7_EP0TP2PP0DP0_GPU16 [label="FFN All-Reduce\nL7 EP0 TP Group 2 PP0 DP0\nGPU16" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L7_EP0TP2PP0DP0_GPU16 [label="Residual Add 2\nL7_EP0TP2PP0DP0_GPU16\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L7_EP0TP2PP0DP1_GPU17 [label="Layer Norm 1\nL7_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L7_EP0TP2PP0DP1_GPU17 [label="QKV Projection\nL7_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L7_EP0TP2PP0DP1_GPU17 [label="Multi-Head Attention\nL7_EP0TP2PP0DP1_GPU17\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L7_EP0TP2PP0DP1_GPU17 [label="Attention Output Proj\nL7_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L7_EP0TP2PP0DP1_GPU17 [label="Attention All-Reduce\nL7 EP0 TP Group 2 PP0 DP1\nGPU17" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L7_EP0TP2PP0DP1_GPU17 [label="Residual Add 1\nL7_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L7_EP0TP2PP0DP1_GPU17 [label="Layer Norm 2\nL7_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L7_EP0TP2PP0DP1_GPU17 [label="MoE Gate (Routing)\nL7_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L7_EP0TP2PP0DP1_GPU17 [label="Expert Dispatch\nL7_EP0TP2PP0DP1_GPU17" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L7_EP0TP2PP0DP1_GPU17 [label="Expert 0\nL7_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L7_EP0TP2PP0DP1_GPU17 [label="Expert 1\nL7_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L7_EP0TP2PP0DP1_GPU17 [label="Expert 2\nL7_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L7_EP0TP2PP0DP1_GPU17 [label="Expert 3\nL7_EP0TP2PP0DP1_GPU17\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L7_EP0TP2PP0DP1_GPU17 [label="Expert Combine\nL7_EP0TP2PP0DP1_GPU17" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L7_EP0TP2PP0DP1_GPU17 [label="FFN (Up-proj + GeLU + Down-proj)\nL7_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L7_EP0TP2PP0DP1_GPU17 [label="FFN All-Reduce\nL7 EP0 TP Group 2 PP0 DP1\nGPU17" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L7_EP0TP2PP0DP1_GPU17 [label="Residual Add 2\nL7_EP0TP2PP0DP1_GPU17\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L7_EP0TP3PP0DP0_GPU24 [label="Layer Norm 1\nL7_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L7_EP0TP3PP0DP0_GPU24 [label="QKV Projection\nL7_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L7_EP0TP3PP0DP0_GPU24 [label="Multi-Head Attention\nL7_EP0TP3PP0DP0_GPU24\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L7_EP0TP3PP0DP0_GPU24 [label="Attention Output Proj\nL7_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L7_EP0TP3PP0DP0_GPU24 [label="Attention All-Reduce\nL7 EP0 TP Group 3 PP0 DP0\nGPU24" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L7_EP0TP3PP0DP0_GPU24 [label="Residual Add 1\nL7_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L7_EP0TP3PP0DP0_GPU24 [label="Layer Norm 2\nL7_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L7_EP0TP3PP0DP0_GPU24 [label="MoE Gate (Routing)\nL7_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L7_EP0TP3PP0DP0_GPU24 [label="Expert Dispatch\nL7_EP0TP3PP0DP0_GPU24" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L7_EP0TP3PP0DP0_GPU24 [label="Expert 0\nL7_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L7_EP0TP3PP0DP0_GPU24 [label="Expert 1\nL7_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L7_EP0TP3PP0DP0_GPU24 [label="Expert 2\nL7_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L7_EP0TP3PP0DP0_GPU24 [label="Expert 3\nL7_EP0TP3PP0DP0_GPU24\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L7_EP0TP3PP0DP0_GPU24 [label="Expert Combine\nL7_EP0TP3PP0DP0_GPU24" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L7_EP0TP3PP0DP0_GPU24 [label="FFN (Up-proj + GeLU + Down-proj)\nL7_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L7_EP0TP3PP0DP0_GPU24 [label="FFN All-Reduce\nL7 EP0 TP Group 3 PP0 DP0\nGPU24" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L7_EP0TP3PP0DP0_GPU24 [label="Residual Add 2\nL7_EP0TP3PP0DP0_GPU24\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L7_EP0TP3PP0DP1_GPU25 [label="Layer Norm 1\nL7_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L7_EP0TP3PP0DP1_GPU25 [label="QKV Projection\nL7_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L7_EP0TP3PP0DP1_GPU25 [label="Multi-Head Attention\nL7_EP0TP3PP0DP1_GPU25\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L7_EP0TP3PP0DP1_GPU25 [label="Attention Output Proj\nL7_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L7_EP0TP3PP0DP1_GPU25 [label="Attention All-Reduce\nL7 EP0 TP Group 3 PP0 DP1\nGPU25" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L7_EP0TP3PP0DP1_GPU25 [label="Residual Add 1\nL7_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L7_EP0TP3PP0DP1_GPU25 [label="Layer Norm 2\nL7_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L7_EP0TP3PP0DP1_GPU25 [label="MoE Gate (Routing)\nL7_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L7_EP0TP3PP0DP1_GPU25 [label="Expert Dispatch\nL7_EP0TP3PP0DP1_GPU25" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L7_EP0TP3PP0DP1_GPU25 [label="Expert 0\nL7_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L7_EP0TP3PP0DP1_GPU25 [label="Expert 1\nL7_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L7_EP0TP3PP0DP1_GPU25 [label="Expert 2\nL7_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L7_EP0TP3PP0DP1_GPU25 [label="Expert 3\nL7_EP0TP3PP0DP1_GPU25\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L7_EP0TP3PP0DP1_GPU25 [label="Expert Combine\nL7_EP0TP3PP0DP1_GPU25" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L7_EP0TP3PP0DP1_GPU25 [label="FFN (Up-proj + GeLU + Down-proj)\nL7_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L7_EP0TP3PP0DP1_GPU25 [label="FFN All-Reduce\nL7 EP0 TP Group 3 PP0 DP1\nGPU25" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L7_EP0TP3PP0DP1_GPU25 [label="Residual Add 2\nL7_EP0TP3PP0DP1_GPU25\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L7_EP1TP0PP0DP0_GPU32 [label="Layer Norm 1\nL7_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L7_EP1TP0PP0DP0_GPU32 [label="QKV Projection\nL7_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L7_EP1TP0PP0DP0_GPU32 [label="Multi-Head Attention\nL7_EP1TP0PP0DP0_GPU32\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L7_EP1TP0PP0DP0_GPU32 [label="Attention Output Proj\nL7_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L7_EP1TP0PP0DP0_GPU32 [label="Attention All-Reduce\nL7 EP1 TP Group 0 PP0 DP0\nGPU32" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L7_EP1TP0PP0DP0_GPU32 [label="Residual Add 1\nL7_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L7_EP1TP0PP0DP0_GPU32 [label="Layer Norm 2\nL7_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L7_EP1TP0PP0DP0_GPU32 [label="MoE Gate (Routing)\nL7_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L7_EP1TP0PP0DP0_GPU32 [label="Expert Dispatch\nL7_EP1TP0PP0DP0_GPU32" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L7_EP1TP0PP0DP0_GPU32 [label="Expert 0\nL7_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L7_EP1TP0PP0DP0_GPU32 [label="Expert 1\nL7_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L7_EP1TP0PP0DP0_GPU32 [label="Expert 2\nL7_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L7_EP1TP0PP0DP0_GPU32 [label="Expert 3\nL7_EP1TP0PP0DP0_GPU32\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L7_EP1TP0PP0DP0_GPU32 [label="Expert Combine\nL7_EP1TP0PP0DP0_GPU32" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L7_EP1TP0PP0DP0_GPU32 [label="FFN (Up-proj + GeLU + Down-proj)\nL7_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L7_EP1TP0PP0DP0_GPU32 [label="FFN All-Reduce\nL7 EP1 TP Group 0 PP0 DP0\nGPU32" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L7_EP1TP0PP0DP0_GPU32 [label="Residual Add 2\nL7_EP1TP0PP0DP0_GPU32\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L7_EP1TP0PP0DP1_GPU33 [label="Layer Norm 1\nL7_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L7_EP1TP0PP0DP1_GPU33 [label="QKV Projection\nL7_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L7_EP1TP0PP0DP1_GPU33 [label="Multi-Head Attention\nL7_EP1TP0PP0DP1_GPU33\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L7_EP1TP0PP0DP1_GPU33 [label="Attention Output Proj\nL7_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L7_EP1TP0PP0DP1_GPU33 [label="Attention All-Reduce\nL7 EP1 TP Group 0 PP0 DP1\nGPU33" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L7_EP1TP0PP0DP1_GPU33 [label="Residual Add 1\nL7_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L7_EP1TP0PP0DP1_GPU33 [label="Layer Norm 2\nL7_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L7_EP1TP0PP0DP1_GPU33 [label="MoE Gate (Routing)\nL7_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L7_EP1TP0PP0DP1_GPU33 [label="Expert Dispatch\nL7_EP1TP0PP0DP1_GPU33" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L7_EP1TP0PP0DP1_GPU33 [label="Expert 0\nL7_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L7_EP1TP0PP0DP1_GPU33 [label="Expert 1\nL7_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L7_EP1TP0PP0DP1_GPU33 [label="Expert 2\nL7_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L7_EP1TP0PP0DP1_GPU33 [label="Expert 3\nL7_EP1TP0PP0DP1_GPU33\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L7_EP1TP0PP0DP1_GPU33 [label="Expert Combine\nL7_EP1TP0PP0DP1_GPU33" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L7_EP1TP0PP0DP1_GPU33 [label="FFN (Up-proj + GeLU + Down-proj)\nL7_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L7_EP1TP0PP0DP1_GPU33 [label="FFN All-Reduce\nL7 EP1 TP Group 0 PP0 DP1\nGPU33" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L7_EP1TP0PP0DP1_GPU33 [label="Residual Add 2\nL7_EP1TP0PP0DP1_GPU33\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L7_EP1TP1PP0DP0_GPU40 [label="Layer Norm 1\nL7_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L7_EP1TP1PP0DP0_GPU40 [label="QKV Projection\nL7_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L7_EP1TP1PP0DP0_GPU40 [label="Multi-Head Attention\nL7_EP1TP1PP0DP0_GPU40\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L7_EP1TP1PP0DP0_GPU40 [label="Attention Output Proj\nL7_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L7_EP1TP1PP0DP0_GPU40 [label="Attention All-Reduce\nL7 EP1 TP Group 1 PP0 DP0\nGPU40" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L7_EP1TP1PP0DP0_GPU40 [label="Residual Add 1\nL7_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L7_EP1TP1PP0DP0_GPU40 [label="Layer Norm 2\nL7_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L7_EP1TP1PP0DP0_GPU40 [label="MoE Gate (Routing)\nL7_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L7_EP1TP1PP0DP0_GPU40 [label="Expert Dispatch\nL7_EP1TP1PP0DP0_GPU40" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L7_EP1TP1PP0DP0_GPU40 [label="Expert 0\nL7_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L7_EP1TP1PP0DP0_GPU40 [label="Expert 1\nL7_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L7_EP1TP1PP0DP0_GPU40 [label="Expert 2\nL7_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L7_EP1TP1PP0DP0_GPU40 [label="Expert 3\nL7_EP1TP1PP0DP0_GPU40\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L7_EP1TP1PP0DP0_GPU40 [label="Expert Combine\nL7_EP1TP1PP0DP0_GPU40" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L7_EP1TP1PP0DP0_GPU40 [label="FFN (Up-proj + GeLU + Down-proj)\nL7_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L7_EP1TP1PP0DP0_GPU40 [label="FFN All-Reduce\nL7 EP1 TP Group 1 PP0 DP0\nGPU40" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L7_EP1TP1PP0DP0_GPU40 [label="Residual Add 2\nL7_EP1TP1PP0DP0_GPU40\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L7_EP1TP1PP0DP1_GPU41 [label="Layer Norm 1\nL7_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L7_EP1TP1PP0DP1_GPU41 [label="QKV Projection\nL7_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L7_EP1TP1PP0DP1_GPU41 [label="Multi-Head Attention\nL7_EP1TP1PP0DP1_GPU41\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L7_EP1TP1PP0DP1_GPU41 [label="Attention Output Proj\nL7_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L7_EP1TP1PP0DP1_GPU41 [label="Attention All-Reduce\nL7 EP1 TP Group 1 PP0 DP1\nGPU41" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L7_EP1TP1PP0DP1_GPU41 [label="Residual Add 1\nL7_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L7_EP1TP1PP0DP1_GPU41 [label="Layer Norm 2\nL7_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L7_EP1TP1PP0DP1_GPU41 [label="MoE Gate (Routing)\nL7_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L7_EP1TP1PP0DP1_GPU41 [label="Expert Dispatch\nL7_EP1TP1PP0DP1_GPU41" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L7_EP1TP1PP0DP1_GPU41 [label="Expert 0\nL7_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L7_EP1TP1PP0DP1_GPU41 [label="Expert 1\nL7_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L7_EP1TP1PP0DP1_GPU41 [label="Expert 2\nL7_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L7_EP1TP1PP0DP1_GPU41 [label="Expert 3\nL7_EP1TP1PP0DP1_GPU41\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L7_EP1TP1PP0DP1_GPU41 [label="Expert Combine\nL7_EP1TP1PP0DP1_GPU41" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L7_EP1TP1PP0DP1_GPU41 [label="FFN (Up-proj + GeLU + Down-proj)\nL7_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L7_EP1TP1PP0DP1_GPU41 [label="FFN All-Reduce\nL7 EP1 TP Group 1 PP0 DP1\nGPU41" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L7_EP1TP1PP0DP1_GPU41 [label="Residual Add 2\nL7_EP1TP1PP0DP1_GPU41\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L7_EP1TP2PP0DP0_GPU48 [label="Layer Norm 1\nL7_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L7_EP1TP2PP0DP0_GPU48 [label="QKV Projection\nL7_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L7_EP1TP2PP0DP0_GPU48 [label="Multi-Head Attention\nL7_EP1TP2PP0DP0_GPU48\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L7_EP1TP2PP0DP0_GPU48 [label="Attention Output Proj\nL7_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L7_EP1TP2PP0DP0_GPU48 [label="Attention All-Reduce\nL7 EP1 TP Group 2 PP0 DP0\nGPU48" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L7_EP1TP2PP0DP0_GPU48 [label="Residual Add 1\nL7_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L7_EP1TP2PP0DP0_GPU48 [label="Layer Norm 2\nL7_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L7_EP1TP2PP0DP0_GPU48 [label="MoE Gate (Routing)\nL7_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L7_EP1TP2PP0DP0_GPU48 [label="Expert Dispatch\nL7_EP1TP2PP0DP0_GPU48" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L7_EP1TP2PP0DP0_GPU48 [label="Expert 0\nL7_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L7_EP1TP2PP0DP0_GPU48 [label="Expert 1\nL7_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L7_EP1TP2PP0DP0_GPU48 [label="Expert 2\nL7_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L7_EP1TP2PP0DP0_GPU48 [label="Expert 3\nL7_EP1TP2PP0DP0_GPU48\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L7_EP1TP2PP0DP0_GPU48 [label="Expert Combine\nL7_EP1TP2PP0DP0_GPU48" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L7_EP1TP2PP0DP0_GPU48 [label="FFN (Up-proj + GeLU + Down-proj)\nL7_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L7_EP1TP2PP0DP0_GPU48 [label="FFN All-Reduce\nL7 EP1 TP Group 2 PP0 DP0\nGPU48" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L7_EP1TP2PP0DP0_GPU48 [label="Residual Add 2\nL7_EP1TP2PP0DP0_GPU48\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L7_EP1TP2PP0DP1_GPU49 [label="Layer Norm 1\nL7_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L7_EP1TP2PP0DP1_GPU49 [label="QKV Projection\nL7_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L7_EP1TP2PP0DP1_GPU49 [label="Multi-Head Attention\nL7_EP1TP2PP0DP1_GPU49\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L7_EP1TP2PP0DP1_GPU49 [label="Attention Output Proj\nL7_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L7_EP1TP2PP0DP1_GPU49 [label="Attention All-Reduce\nL7 EP1 TP Group 2 PP0 DP1\nGPU49" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L7_EP1TP2PP0DP1_GPU49 [label="Residual Add 1\nL7_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L7_EP1TP2PP0DP1_GPU49 [label="Layer Norm 2\nL7_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L7_EP1TP2PP0DP1_GPU49 [label="MoE Gate (Routing)\nL7_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L7_EP1TP2PP0DP1_GPU49 [label="Expert Dispatch\nL7_EP1TP2PP0DP1_GPU49" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L7_EP1TP2PP0DP1_GPU49 [label="Expert 0\nL7_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L7_EP1TP2PP0DP1_GPU49 [label="Expert 1\nL7_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L7_EP1TP2PP0DP1_GPU49 [label="Expert 2\nL7_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L7_EP1TP2PP0DP1_GPU49 [label="Expert 3\nL7_EP1TP2PP0DP1_GPU49\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L7_EP1TP2PP0DP1_GPU49 [label="Expert Combine\nL7_EP1TP2PP0DP1_GPU49" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L7_EP1TP2PP0DP1_GPU49 [label="FFN (Up-proj + GeLU + Down-proj)\nL7_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L7_EP1TP2PP0DP1_GPU49 [label="FFN All-Reduce\nL7 EP1 TP Group 2 PP0 DP1\nGPU49" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L7_EP1TP2PP0DP1_GPU49 [label="Residual Add 2\nL7_EP1TP2PP0DP1_GPU49\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L7_EP1TP3PP0DP0_GPU56 [label="Layer Norm 1\nL7_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L7_EP1TP3PP0DP0_GPU56 [label="QKV Projection\nL7_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L7_EP1TP3PP0DP0_GPU56 [label="Multi-Head Attention\nL7_EP1TP3PP0DP0_GPU56\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L7_EP1TP3PP0DP0_GPU56 [label="Attention Output Proj\nL7_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L7_EP1TP3PP0DP0_GPU56 [label="Attention All-Reduce\nL7 EP1 TP Group 3 PP0 DP0\nGPU56" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L7_EP1TP3PP0DP0_GPU56 [label="Residual Add 1\nL7_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L7_EP1TP3PP0DP0_GPU56 [label="Layer Norm 2\nL7_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L7_EP1TP3PP0DP0_GPU56 [label="MoE Gate (Routing)\nL7_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L7_EP1TP3PP0DP0_GPU56 [label="Expert Dispatch\nL7_EP1TP3PP0DP0_GPU56" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L7_EP1TP3PP0DP0_GPU56 [label="Expert 0\nL7_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L7_EP1TP3PP0DP0_GPU56 [label="Expert 1\nL7_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L7_EP1TP3PP0DP0_GPU56 [label="Expert 2\nL7_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L7_EP1TP3PP0DP0_GPU56 [label="Expert 3\nL7_EP1TP3PP0DP0_GPU56\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L7_EP1TP3PP0DP0_GPU56 [label="Expert Combine\nL7_EP1TP3PP0DP0_GPU56" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L7_EP1TP3PP0DP0_GPU56 [label="FFN (Up-proj + GeLU + Down-proj)\nL7_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L7_EP1TP3PP0DP0_GPU56 [label="FFN All-Reduce\nL7 EP1 TP Group 3 PP0 DP0\nGPU56" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L7_EP1TP3PP0DP0_GPU56 [label="Residual Add 2\nL7_EP1TP3PP0DP0_GPU56\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L7_EP1TP3PP0DP1_GPU57 [label="Layer Norm 1\nL7_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L7_EP1TP3PP0DP1_GPU57 [label="QKV Projection\nL7_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L7_EP1TP3PP0DP1_GPU57 [label="Multi-Head Attention\nL7_EP1TP3PP0DP1_GPU57\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L7_EP1TP3PP0DP1_GPU57 [label="Attention Output Proj\nL7_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L7_EP1TP3PP0DP1_GPU57 [label="Attention All-Reduce\nL7 EP1 TP Group 3 PP0 DP1\nGPU57" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L7_EP1TP3PP0DP1_GPU57 [label="Residual Add 1\nL7_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L7_EP1TP3PP0DP1_GPU57 [label="Layer Norm 2\nL7_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L7_EP1TP3PP0DP1_GPU57 [label="MoE Gate (Routing)\nL7_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L7_EP1TP3PP0DP1_GPU57 [label="Expert Dispatch\nL7_EP1TP3PP0DP1_GPU57" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L7_EP1TP3PP0DP1_GPU57 [label="Expert 0\nL7_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L7_EP1TP3PP0DP1_GPU57 [label="Expert 1\nL7_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L7_EP1TP3PP0DP1_GPU57 [label="Expert 2\nL7_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L7_EP1TP3PP0DP1_GPU57 [label="Expert 3\nL7_EP1TP3PP0DP1_GPU57\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L7_EP1TP3PP0DP1_GPU57 [label="Expert Combine\nL7_EP1TP3PP0DP1_GPU57" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L7_EP1TP3PP0DP1_GPU57 [label="FFN (Up-proj + GeLU + Down-proj)\nL7_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L7_EP1TP3PP0DP1_GPU57 [label="FFN All-Reduce\nL7 EP1 TP Group 3 PP0 DP1\nGPU57" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L7_EP1TP3PP0DP1_GPU57 [label="Residual Add 2\nL7_EP1TP3PP0DP1_GPU57\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L8_EP0TP0PP1DP0_GPU4 [label="Layer Norm 1\nL8_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L8_EP0TP0PP1DP0_GPU4 [label="QKV Projection\nL8_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L8_EP0TP0PP1DP0_GPU4 [label="Multi-Head Attention\nL8_EP0TP0PP1DP0_GPU4\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L8_EP0TP0PP1DP0_GPU4 [label="Attention Output Proj\nL8_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L8_EP0TP0PP1DP0_GPU4 [label="Attention All-Reduce\nL8 EP0 TP Group 0 PP1 DP0\nGPU4" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L8_EP0TP0PP1DP0_GPU4 [label="Residual Add 1\nL8_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L8_EP0TP0PP1DP0_GPU4 [label="Layer Norm 2\nL8_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L8_EP0TP0PP1DP0_GPU4 [label="MoE Gate (Routing)\nL8_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L8_EP0TP0PP1DP0_GPU4 [label="Expert Dispatch\nL8_EP0TP0PP1DP0_GPU4" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L8_EP0TP0PP1DP0_GPU4 [label="Expert 0\nL8_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L8_EP0TP0PP1DP0_GPU4 [label="Expert 1\nL8_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L8_EP0TP0PP1DP0_GPU4 [label="Expert 2\nL8_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L8_EP0TP0PP1DP0_GPU4 [label="Expert 3\nL8_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L8_EP0TP0PP1DP0_GPU4 [label="Expert Combine\nL8_EP0TP0PP1DP0_GPU4" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L8_EP0TP0PP1DP0_GPU4 [label="FFN (Up-proj + GeLU + Down-proj)\nL8_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L8_EP0TP0PP1DP0_GPU4 [label="FFN All-Reduce\nL8 EP0 TP Group 0 PP1 DP0\nGPU4" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L8_EP0TP0PP1DP0_GPU4 [label="Residual Add 2\nL8_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L8_EP0TP0PP1DP1_GPU5 [label="Layer Norm 1\nL8_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L8_EP0TP0PP1DP1_GPU5 [label="QKV Projection\nL8_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L8_EP0TP0PP1DP1_GPU5 [label="Multi-Head Attention\nL8_EP0TP0PP1DP1_GPU5\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L8_EP0TP0PP1DP1_GPU5 [label="Attention Output Proj\nL8_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L8_EP0TP0PP1DP1_GPU5 [label="Attention All-Reduce\nL8 EP0 TP Group 0 PP1 DP1\nGPU5" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L8_EP0TP0PP1DP1_GPU5 [label="Residual Add 1\nL8_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L8_EP0TP0PP1DP1_GPU5 [label="Layer Norm 2\nL8_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L8_EP0TP0PP1DP1_GPU5 [label="MoE Gate (Routing)\nL8_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L8_EP0TP0PP1DP1_GPU5 [label="Expert Dispatch\nL8_EP0TP0PP1DP1_GPU5" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L8_EP0TP0PP1DP1_GPU5 [label="Expert 0\nL8_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L8_EP0TP0PP1DP1_GPU5 [label="Expert 1\nL8_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L8_EP0TP0PP1DP1_GPU5 [label="Expert 2\nL8_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L8_EP0TP0PP1DP1_GPU5 [label="Expert 3\nL8_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L8_EP0TP0PP1DP1_GPU5 [label="Expert Combine\nL8_EP0TP0PP1DP1_GPU5" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L8_EP0TP0PP1DP1_GPU5 [label="FFN (Up-proj + GeLU + Down-proj)\nL8_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L8_EP0TP0PP1DP1_GPU5 [label="FFN All-Reduce\nL8 EP0 TP Group 0 PP1 DP1\nGPU5" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L8_EP0TP0PP1DP1_GPU5 [label="Residual Add 2\nL8_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L8_EP0TP1PP1DP0_GPU12 [label="Layer Norm 1\nL8_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L8_EP0TP1PP1DP0_GPU12 [label="QKV Projection\nL8_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L8_EP0TP1PP1DP0_GPU12 [label="Multi-Head Attention\nL8_EP0TP1PP1DP0_GPU12\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L8_EP0TP1PP1DP0_GPU12 [label="Attention Output Proj\nL8_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L8_EP0TP1PP1DP0_GPU12 [label="Attention All-Reduce\nL8 EP0 TP Group 1 PP1 DP0\nGPU12" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L8_EP0TP1PP1DP0_GPU12 [label="Residual Add 1\nL8_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L8_EP0TP1PP1DP0_GPU12 [label="Layer Norm 2\nL8_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L8_EP0TP1PP1DP0_GPU12 [label="MoE Gate (Routing)\nL8_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L8_EP0TP1PP1DP0_GPU12 [label="Expert Dispatch\nL8_EP0TP1PP1DP0_GPU12" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L8_EP0TP1PP1DP0_GPU12 [label="Expert 0\nL8_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L8_EP0TP1PP1DP0_GPU12 [label="Expert 1\nL8_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L8_EP0TP1PP1DP0_GPU12 [label="Expert 2\nL8_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L8_EP0TP1PP1DP0_GPU12 [label="Expert 3\nL8_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L8_EP0TP1PP1DP0_GPU12 [label="Expert Combine\nL8_EP0TP1PP1DP0_GPU12" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L8_EP0TP1PP1DP0_GPU12 [label="FFN (Up-proj + GeLU + Down-proj)\nL8_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L8_EP0TP1PP1DP0_GPU12 [label="FFN All-Reduce\nL8 EP0 TP Group 1 PP1 DP0\nGPU12" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L8_EP0TP1PP1DP0_GPU12 [label="Residual Add 2\nL8_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L8_EP0TP1PP1DP1_GPU13 [label="Layer Norm 1\nL8_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L8_EP0TP1PP1DP1_GPU13 [label="QKV Projection\nL8_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L8_EP0TP1PP1DP1_GPU13 [label="Multi-Head Attention\nL8_EP0TP1PP1DP1_GPU13\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L8_EP0TP1PP1DP1_GPU13 [label="Attention Output Proj\nL8_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L8_EP0TP1PP1DP1_GPU13 [label="Attention All-Reduce\nL8 EP0 TP Group 1 PP1 DP1\nGPU13" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L8_EP0TP1PP1DP1_GPU13 [label="Residual Add 1\nL8_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L8_EP0TP1PP1DP1_GPU13 [label="Layer Norm 2\nL8_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L8_EP0TP1PP1DP1_GPU13 [label="MoE Gate (Routing)\nL8_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L8_EP0TP1PP1DP1_GPU13 [label="Expert Dispatch\nL8_EP0TP1PP1DP1_GPU13" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L8_EP0TP1PP1DP1_GPU13 [label="Expert 0\nL8_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L8_EP0TP1PP1DP1_GPU13 [label="Expert 1\nL8_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L8_EP0TP1PP1DP1_GPU13 [label="Expert 2\nL8_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L8_EP0TP1PP1DP1_GPU13 [label="Expert 3\nL8_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L8_EP0TP1PP1DP1_GPU13 [label="Expert Combine\nL8_EP0TP1PP1DP1_GPU13" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L8_EP0TP1PP1DP1_GPU13 [label="FFN (Up-proj + GeLU + Down-proj)\nL8_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L8_EP0TP1PP1DP1_GPU13 [label="FFN All-Reduce\nL8 EP0 TP Group 1 PP1 DP1\nGPU13" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L8_EP0TP1PP1DP1_GPU13 [label="Residual Add 2\nL8_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L8_EP0TP2PP1DP0_GPU20 [label="Layer Norm 1\nL8_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L8_EP0TP2PP1DP0_GPU20 [label="QKV Projection\nL8_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L8_EP0TP2PP1DP0_GPU20 [label="Multi-Head Attention\nL8_EP0TP2PP1DP0_GPU20\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L8_EP0TP2PP1DP0_GPU20 [label="Attention Output Proj\nL8_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L8_EP0TP2PP1DP0_GPU20 [label="Attention All-Reduce\nL8 EP0 TP Group 2 PP1 DP0\nGPU20" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L8_EP0TP2PP1DP0_GPU20 [label="Residual Add 1\nL8_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L8_EP0TP2PP1DP0_GPU20 [label="Layer Norm 2\nL8_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L8_EP0TP2PP1DP0_GPU20 [label="MoE Gate (Routing)\nL8_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L8_EP0TP2PP1DP0_GPU20 [label="Expert Dispatch\nL8_EP0TP2PP1DP0_GPU20" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L8_EP0TP2PP1DP0_GPU20 [label="Expert 0\nL8_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L8_EP0TP2PP1DP0_GPU20 [label="Expert 1\nL8_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L8_EP0TP2PP1DP0_GPU20 [label="Expert 2\nL8_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L8_EP0TP2PP1DP0_GPU20 [label="Expert 3\nL8_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L8_EP0TP2PP1DP0_GPU20 [label="Expert Combine\nL8_EP0TP2PP1DP0_GPU20" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L8_EP0TP2PP1DP0_GPU20 [label="FFN (Up-proj + GeLU + Down-proj)\nL8_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L8_EP0TP2PP1DP0_GPU20 [label="FFN All-Reduce\nL8 EP0 TP Group 2 PP1 DP0\nGPU20" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L8_EP0TP2PP1DP0_GPU20 [label="Residual Add 2\nL8_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L8_EP0TP2PP1DP1_GPU21 [label="Layer Norm 1\nL8_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L8_EP0TP2PP1DP1_GPU21 [label="QKV Projection\nL8_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L8_EP0TP2PP1DP1_GPU21 [label="Multi-Head Attention\nL8_EP0TP2PP1DP1_GPU21\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L8_EP0TP2PP1DP1_GPU21 [label="Attention Output Proj\nL8_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L8_EP0TP2PP1DP1_GPU21 [label="Attention All-Reduce\nL8 EP0 TP Group 2 PP1 DP1\nGPU21" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L8_EP0TP2PP1DP1_GPU21 [label="Residual Add 1\nL8_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L8_EP0TP2PP1DP1_GPU21 [label="Layer Norm 2\nL8_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L8_EP0TP2PP1DP1_GPU21 [label="MoE Gate (Routing)\nL8_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L8_EP0TP2PP1DP1_GPU21 [label="Expert Dispatch\nL8_EP0TP2PP1DP1_GPU21" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L8_EP0TP2PP1DP1_GPU21 [label="Expert 0\nL8_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L8_EP0TP2PP1DP1_GPU21 [label="Expert 1\nL8_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L8_EP0TP2PP1DP1_GPU21 [label="Expert 2\nL8_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L8_EP0TP2PP1DP1_GPU21 [label="Expert 3\nL8_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L8_EP0TP2PP1DP1_GPU21 [label="Expert Combine\nL8_EP0TP2PP1DP1_GPU21" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L8_EP0TP2PP1DP1_GPU21 [label="FFN (Up-proj + GeLU + Down-proj)\nL8_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L8_EP0TP2PP1DP1_GPU21 [label="FFN All-Reduce\nL8 EP0 TP Group 2 PP1 DP1\nGPU21" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L8_EP0TP2PP1DP1_GPU21 [label="Residual Add 2\nL8_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L8_EP0TP3PP1DP0_GPU28 [label="Layer Norm 1\nL8_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L8_EP0TP3PP1DP0_GPU28 [label="QKV Projection\nL8_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L8_EP0TP3PP1DP0_GPU28 [label="Multi-Head Attention\nL8_EP0TP3PP1DP0_GPU28\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L8_EP0TP3PP1DP0_GPU28 [label="Attention Output Proj\nL8_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L8_EP0TP3PP1DP0_GPU28 [label="Attention All-Reduce\nL8 EP0 TP Group 3 PP1 DP0\nGPU28" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L8_EP0TP3PP1DP0_GPU28 [label="Residual Add 1\nL8_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L8_EP0TP3PP1DP0_GPU28 [label="Layer Norm 2\nL8_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L8_EP0TP3PP1DP0_GPU28 [label="MoE Gate (Routing)\nL8_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L8_EP0TP3PP1DP0_GPU28 [label="Expert Dispatch\nL8_EP0TP3PP1DP0_GPU28" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L8_EP0TP3PP1DP0_GPU28 [label="Expert 0\nL8_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L8_EP0TP3PP1DP0_GPU28 [label="Expert 1\nL8_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L8_EP0TP3PP1DP0_GPU28 [label="Expert 2\nL8_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L8_EP0TP3PP1DP0_GPU28 [label="Expert 3\nL8_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L8_EP0TP3PP1DP0_GPU28 [label="Expert Combine\nL8_EP0TP3PP1DP0_GPU28" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L8_EP0TP3PP1DP0_GPU28 [label="FFN (Up-proj + GeLU + Down-proj)\nL8_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L8_EP0TP3PP1DP0_GPU28 [label="FFN All-Reduce\nL8 EP0 TP Group 3 PP1 DP0\nGPU28" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L8_EP0TP3PP1DP0_GPU28 [label="Residual Add 2\nL8_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L8_EP0TP3PP1DP1_GPU29 [label="Layer Norm 1\nL8_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L8_EP0TP3PP1DP1_GPU29 [label="QKV Projection\nL8_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L8_EP0TP3PP1DP1_GPU29 [label="Multi-Head Attention\nL8_EP0TP3PP1DP1_GPU29\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L8_EP0TP3PP1DP1_GPU29 [label="Attention Output Proj\nL8_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L8_EP0TP3PP1DP1_GPU29 [label="Attention All-Reduce\nL8 EP0 TP Group 3 PP1 DP1\nGPU29" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L8_EP0TP3PP1DP1_GPU29 [label="Residual Add 1\nL8_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L8_EP0TP3PP1DP1_GPU29 [label="Layer Norm 2\nL8_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L8_EP0TP3PP1DP1_GPU29 [label="MoE Gate (Routing)\nL8_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L8_EP0TP3PP1DP1_GPU29 [label="Expert Dispatch\nL8_EP0TP3PP1DP1_GPU29" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L8_EP0TP3PP1DP1_GPU29 [label="Expert 0\nL8_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L8_EP0TP3PP1DP1_GPU29 [label="Expert 1\nL8_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L8_EP0TP3PP1DP1_GPU29 [label="Expert 2\nL8_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L8_EP0TP3PP1DP1_GPU29 [label="Expert 3\nL8_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L8_EP0TP3PP1DP1_GPU29 [label="Expert Combine\nL8_EP0TP3PP1DP1_GPU29" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L8_EP0TP3PP1DP1_GPU29 [label="FFN (Up-proj + GeLU + Down-proj)\nL8_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L8_EP0TP3PP1DP1_GPU29 [label="FFN All-Reduce\nL8 EP0 TP Group 3 PP1 DP1\nGPU29" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L8_EP0TP3PP1DP1_GPU29 [label="Residual Add 2\nL8_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L8_EP1TP0PP1DP0_GPU36 [label="Layer Norm 1\nL8_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L8_EP1TP0PP1DP0_GPU36 [label="QKV Projection\nL8_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L8_EP1TP0PP1DP0_GPU36 [label="Multi-Head Attention\nL8_EP1TP0PP1DP0_GPU36\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L8_EP1TP0PP1DP0_GPU36 [label="Attention Output Proj\nL8_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L8_EP1TP0PP1DP0_GPU36 [label="Attention All-Reduce\nL8 EP1 TP Group 0 PP1 DP0\nGPU36" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L8_EP1TP0PP1DP0_GPU36 [label="Residual Add 1\nL8_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L8_EP1TP0PP1DP0_GPU36 [label="Layer Norm 2\nL8_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L8_EP1TP0PP1DP0_GPU36 [label="MoE Gate (Routing)\nL8_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L8_EP1TP0PP1DP0_GPU36 [label="Expert Dispatch\nL8_EP1TP0PP1DP0_GPU36" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L8_EP1TP0PP1DP0_GPU36 [label="Expert 0\nL8_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L8_EP1TP0PP1DP0_GPU36 [label="Expert 1\nL8_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L8_EP1TP0PP1DP0_GPU36 [label="Expert 2\nL8_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L8_EP1TP0PP1DP0_GPU36 [label="Expert 3\nL8_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L8_EP1TP0PP1DP0_GPU36 [label="Expert Combine\nL8_EP1TP0PP1DP0_GPU36" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L8_EP1TP0PP1DP0_GPU36 [label="FFN (Up-proj + GeLU + Down-proj)\nL8_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L8_EP1TP0PP1DP0_GPU36 [label="FFN All-Reduce\nL8 EP1 TP Group 0 PP1 DP0\nGPU36" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L8_EP1TP0PP1DP0_GPU36 [label="Residual Add 2\nL8_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L8_EP1TP0PP1DP1_GPU37 [label="Layer Norm 1\nL8_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L8_EP1TP0PP1DP1_GPU37 [label="QKV Projection\nL8_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L8_EP1TP0PP1DP1_GPU37 [label="Multi-Head Attention\nL8_EP1TP0PP1DP1_GPU37\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L8_EP1TP0PP1DP1_GPU37 [label="Attention Output Proj\nL8_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L8_EP1TP0PP1DP1_GPU37 [label="Attention All-Reduce\nL8 EP1 TP Group 0 PP1 DP1\nGPU37" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L8_EP1TP0PP1DP1_GPU37 [label="Residual Add 1\nL8_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L8_EP1TP0PP1DP1_GPU37 [label="Layer Norm 2\nL8_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L8_EP1TP0PP1DP1_GPU37 [label="MoE Gate (Routing)\nL8_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L8_EP1TP0PP1DP1_GPU37 [label="Expert Dispatch\nL8_EP1TP0PP1DP1_GPU37" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L8_EP1TP0PP1DP1_GPU37 [label="Expert 0\nL8_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L8_EP1TP0PP1DP1_GPU37 [label="Expert 1\nL8_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L8_EP1TP0PP1DP1_GPU37 [label="Expert 2\nL8_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L8_EP1TP0PP1DP1_GPU37 [label="Expert 3\nL8_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L8_EP1TP0PP1DP1_GPU37 [label="Expert Combine\nL8_EP1TP0PP1DP1_GPU37" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L8_EP1TP0PP1DP1_GPU37 [label="FFN (Up-proj + GeLU + Down-proj)\nL8_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L8_EP1TP0PP1DP1_GPU37 [label="FFN All-Reduce\nL8 EP1 TP Group 0 PP1 DP1\nGPU37" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L8_EP1TP0PP1DP1_GPU37 [label="Residual Add 2\nL8_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L8_EP1TP1PP1DP0_GPU44 [label="Layer Norm 1\nL8_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L8_EP1TP1PP1DP0_GPU44 [label="QKV Projection\nL8_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L8_EP1TP1PP1DP0_GPU44 [label="Multi-Head Attention\nL8_EP1TP1PP1DP0_GPU44\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L8_EP1TP1PP1DP0_GPU44 [label="Attention Output Proj\nL8_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L8_EP1TP1PP1DP0_GPU44 [label="Attention All-Reduce\nL8 EP1 TP Group 1 PP1 DP0\nGPU44" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L8_EP1TP1PP1DP0_GPU44 [label="Residual Add 1\nL8_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L8_EP1TP1PP1DP0_GPU44 [label="Layer Norm 2\nL8_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L8_EP1TP1PP1DP0_GPU44 [label="MoE Gate (Routing)\nL8_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L8_EP1TP1PP1DP0_GPU44 [label="Expert Dispatch\nL8_EP1TP1PP1DP0_GPU44" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L8_EP1TP1PP1DP0_GPU44 [label="Expert 0\nL8_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L8_EP1TP1PP1DP0_GPU44 [label="Expert 1\nL8_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L8_EP1TP1PP1DP0_GPU44 [label="Expert 2\nL8_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L8_EP1TP1PP1DP0_GPU44 [label="Expert 3\nL8_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L8_EP1TP1PP1DP0_GPU44 [label="Expert Combine\nL8_EP1TP1PP1DP0_GPU44" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L8_EP1TP1PP1DP0_GPU44 [label="FFN (Up-proj + GeLU + Down-proj)\nL8_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L8_EP1TP1PP1DP0_GPU44 [label="FFN All-Reduce\nL8 EP1 TP Group 1 PP1 DP0\nGPU44" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L8_EP1TP1PP1DP0_GPU44 [label="Residual Add 2\nL8_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L8_EP1TP1PP1DP1_GPU45 [label="Layer Norm 1\nL8_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L8_EP1TP1PP1DP1_GPU45 [label="QKV Projection\nL8_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L8_EP1TP1PP1DP1_GPU45 [label="Multi-Head Attention\nL8_EP1TP1PP1DP1_GPU45\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L8_EP1TP1PP1DP1_GPU45 [label="Attention Output Proj\nL8_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L8_EP1TP1PP1DP1_GPU45 [label="Attention All-Reduce\nL8 EP1 TP Group 1 PP1 DP1\nGPU45" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L8_EP1TP1PP1DP1_GPU45 [label="Residual Add 1\nL8_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L8_EP1TP1PP1DP1_GPU45 [label="Layer Norm 2\nL8_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L8_EP1TP1PP1DP1_GPU45 [label="MoE Gate (Routing)\nL8_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L8_EP1TP1PP1DP1_GPU45 [label="Expert Dispatch\nL8_EP1TP1PP1DP1_GPU45" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L8_EP1TP1PP1DP1_GPU45 [label="Expert 0\nL8_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L8_EP1TP1PP1DP1_GPU45 [label="Expert 1\nL8_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L8_EP1TP1PP1DP1_GPU45 [label="Expert 2\nL8_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L8_EP1TP1PP1DP1_GPU45 [label="Expert 3\nL8_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L8_EP1TP1PP1DP1_GPU45 [label="Expert Combine\nL8_EP1TP1PP1DP1_GPU45" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L8_EP1TP1PP1DP1_GPU45 [label="FFN (Up-proj + GeLU + Down-proj)\nL8_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L8_EP1TP1PP1DP1_GPU45 [label="FFN All-Reduce\nL8 EP1 TP Group 1 PP1 DP1\nGPU45" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L8_EP1TP1PP1DP1_GPU45 [label="Residual Add 2\nL8_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L8_EP1TP2PP1DP0_GPU52 [label="Layer Norm 1\nL8_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L8_EP1TP2PP1DP0_GPU52 [label="QKV Projection\nL8_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L8_EP1TP2PP1DP0_GPU52 [label="Multi-Head Attention\nL8_EP1TP2PP1DP0_GPU52\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L8_EP1TP2PP1DP0_GPU52 [label="Attention Output Proj\nL8_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L8_EP1TP2PP1DP0_GPU52 [label="Attention All-Reduce\nL8 EP1 TP Group 2 PP1 DP0\nGPU52" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L8_EP1TP2PP1DP0_GPU52 [label="Residual Add 1\nL8_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L8_EP1TP2PP1DP0_GPU52 [label="Layer Norm 2\nL8_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L8_EP1TP2PP1DP0_GPU52 [label="MoE Gate (Routing)\nL8_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L8_EP1TP2PP1DP0_GPU52 [label="Expert Dispatch\nL8_EP1TP2PP1DP0_GPU52" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L8_EP1TP2PP1DP0_GPU52 [label="Expert 0\nL8_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L8_EP1TP2PP1DP0_GPU52 [label="Expert 1\nL8_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L8_EP1TP2PP1DP0_GPU52 [label="Expert 2\nL8_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L8_EP1TP2PP1DP0_GPU52 [label="Expert 3\nL8_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L8_EP1TP2PP1DP0_GPU52 [label="Expert Combine\nL8_EP1TP2PP1DP0_GPU52" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L8_EP1TP2PP1DP0_GPU52 [label="FFN (Up-proj + GeLU + Down-proj)\nL8_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L8_EP1TP2PP1DP0_GPU52 [label="FFN All-Reduce\nL8 EP1 TP Group 2 PP1 DP0\nGPU52" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L8_EP1TP2PP1DP0_GPU52 [label="Residual Add 2\nL8_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L8_EP1TP2PP1DP1_GPU53 [label="Layer Norm 1\nL8_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L8_EP1TP2PP1DP1_GPU53 [label="QKV Projection\nL8_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L8_EP1TP2PP1DP1_GPU53 [label="Multi-Head Attention\nL8_EP1TP2PP1DP1_GPU53\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L8_EP1TP2PP1DP1_GPU53 [label="Attention Output Proj\nL8_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L8_EP1TP2PP1DP1_GPU53 [label="Attention All-Reduce\nL8 EP1 TP Group 2 PP1 DP1\nGPU53" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L8_EP1TP2PP1DP1_GPU53 [label="Residual Add 1\nL8_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L8_EP1TP2PP1DP1_GPU53 [label="Layer Norm 2\nL8_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L8_EP1TP2PP1DP1_GPU53 [label="MoE Gate (Routing)\nL8_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L8_EP1TP2PP1DP1_GPU53 [label="Expert Dispatch\nL8_EP1TP2PP1DP1_GPU53" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L8_EP1TP2PP1DP1_GPU53 [label="Expert 0\nL8_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L8_EP1TP2PP1DP1_GPU53 [label="Expert 1\nL8_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L8_EP1TP2PP1DP1_GPU53 [label="Expert 2\nL8_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L8_EP1TP2PP1DP1_GPU53 [label="Expert 3\nL8_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L8_EP1TP2PP1DP1_GPU53 [label="Expert Combine\nL8_EP1TP2PP1DP1_GPU53" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L8_EP1TP2PP1DP1_GPU53 [label="FFN (Up-proj + GeLU + Down-proj)\nL8_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L8_EP1TP2PP1DP1_GPU53 [label="FFN All-Reduce\nL8 EP1 TP Group 2 PP1 DP1\nGPU53" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L8_EP1TP2PP1DP1_GPU53 [label="Residual Add 2\nL8_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L8_EP1TP3PP1DP0_GPU60 [label="Layer Norm 1\nL8_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L8_EP1TP3PP1DP0_GPU60 [label="QKV Projection\nL8_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L8_EP1TP3PP1DP0_GPU60 [label="Multi-Head Attention\nL8_EP1TP3PP1DP0_GPU60\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L8_EP1TP3PP1DP0_GPU60 [label="Attention Output Proj\nL8_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L8_EP1TP3PP1DP0_GPU60 [label="Attention All-Reduce\nL8 EP1 TP Group 3 PP1 DP0\nGPU60" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L8_EP1TP3PP1DP0_GPU60 [label="Residual Add 1\nL8_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L8_EP1TP3PP1DP0_GPU60 [label="Layer Norm 2\nL8_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L8_EP1TP3PP1DP0_GPU60 [label="MoE Gate (Routing)\nL8_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L8_EP1TP3PP1DP0_GPU60 [label="Expert Dispatch\nL8_EP1TP3PP1DP0_GPU60" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L8_EP1TP3PP1DP0_GPU60 [label="Expert 0\nL8_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L8_EP1TP3PP1DP0_GPU60 [label="Expert 1\nL8_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L8_EP1TP3PP1DP0_GPU60 [label="Expert 2\nL8_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L8_EP1TP3PP1DP0_GPU60 [label="Expert 3\nL8_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L8_EP1TP3PP1DP0_GPU60 [label="Expert Combine\nL8_EP1TP3PP1DP0_GPU60" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L8_EP1TP3PP1DP0_GPU60 [label="FFN (Up-proj + GeLU + Down-proj)\nL8_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L8_EP1TP3PP1DP0_GPU60 [label="FFN All-Reduce\nL8 EP1 TP Group 3 PP1 DP0\nGPU60" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L8_EP1TP3PP1DP0_GPU60 [label="Residual Add 2\nL8_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L8_EP1TP3PP1DP1_GPU61 [label="Layer Norm 1\nL8_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L8_EP1TP3PP1DP1_GPU61 [label="QKV Projection\nL8_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L8_EP1TP3PP1DP1_GPU61 [label="Multi-Head Attention\nL8_EP1TP3PP1DP1_GPU61\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L8_EP1TP3PP1DP1_GPU61 [label="Attention Output Proj\nL8_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L8_EP1TP3PP1DP1_GPU61 [label="Attention All-Reduce\nL8 EP1 TP Group 3 PP1 DP1\nGPU61" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L8_EP1TP3PP1DP1_GPU61 [label="Residual Add 1\nL8_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L8_EP1TP3PP1DP1_GPU61 [label="Layer Norm 2\nL8_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L8_EP1TP3PP1DP1_GPU61 [label="MoE Gate (Routing)\nL8_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L8_EP1TP3PP1DP1_GPU61 [label="Expert Dispatch\nL8_EP1TP3PP1DP1_GPU61" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L8_EP1TP3PP1DP1_GPU61 [label="Expert 0\nL8_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L8_EP1TP3PP1DP1_GPU61 [label="Expert 1\nL8_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L8_EP1TP3PP1DP1_GPU61 [label="Expert 2\nL8_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L8_EP1TP3PP1DP1_GPU61 [label="Expert 3\nL8_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L8_EP1TP3PP1DP1_GPU61 [label="Expert Combine\nL8_EP1TP3PP1DP1_GPU61" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L8_EP1TP3PP1DP1_GPU61 [label="FFN (Up-proj + GeLU + Down-proj)\nL8_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L8_EP1TP3PP1DP1_GPU61 [label="FFN All-Reduce\nL8 EP1 TP Group 3 PP1 DP1\nGPU61" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L8_EP1TP3PP1DP1_GPU61 [label="Residual Add 2\nL8_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L9_EP0TP0PP1DP0_GPU4 [label="Layer Norm 1\nL9_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L9_EP0TP0PP1DP0_GPU4 [label="QKV Projection\nL9_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L9_EP0TP0PP1DP0_GPU4 [label="Multi-Head Attention\nL9_EP0TP0PP1DP0_GPU4\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L9_EP0TP0PP1DP0_GPU4 [label="Attention Output Proj\nL9_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L9_EP0TP0PP1DP0_GPU4 [label="Attention All-Reduce\nL9 EP0 TP Group 0 PP1 DP0\nGPU4" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L9_EP0TP0PP1DP0_GPU4 [label="Residual Add 1\nL9_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L9_EP0TP0PP1DP0_GPU4 [label="Layer Norm 2\nL9_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L9_EP0TP0PP1DP0_GPU4 [label="MoE Gate (Routing)\nL9_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L9_EP0TP0PP1DP0_GPU4 [label="Expert Dispatch\nL9_EP0TP0PP1DP0_GPU4" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L9_EP0TP0PP1DP0_GPU4 [label="Expert 0\nL9_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L9_EP0TP0PP1DP0_GPU4 [label="Expert 1\nL9_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L9_EP0TP0PP1DP0_GPU4 [label="Expert 2\nL9_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L9_EP0TP0PP1DP0_GPU4 [label="Expert 3\nL9_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L9_EP0TP0PP1DP0_GPU4 [label="Expert Combine\nL9_EP0TP0PP1DP0_GPU4" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L9_EP0TP0PP1DP0_GPU4 [label="FFN (Up-proj + GeLU + Down-proj)\nL9_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L9_EP0TP0PP1DP0_GPU4 [label="FFN All-Reduce\nL9 EP0 TP Group 0 PP1 DP0\nGPU4" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L9_EP0TP0PP1DP0_GPU4 [label="Residual Add 2\nL9_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L9_EP0TP0PP1DP1_GPU5 [label="Layer Norm 1\nL9_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L9_EP0TP0PP1DP1_GPU5 [label="QKV Projection\nL9_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L9_EP0TP0PP1DP1_GPU5 [label="Multi-Head Attention\nL9_EP0TP0PP1DP1_GPU5\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L9_EP0TP0PP1DP1_GPU5 [label="Attention Output Proj\nL9_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L9_EP0TP0PP1DP1_GPU5 [label="Attention All-Reduce\nL9 EP0 TP Group 0 PP1 DP1\nGPU5" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L9_EP0TP0PP1DP1_GPU5 [label="Residual Add 1\nL9_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L9_EP0TP0PP1DP1_GPU5 [label="Layer Norm 2\nL9_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L9_EP0TP0PP1DP1_GPU5 [label="MoE Gate (Routing)\nL9_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L9_EP0TP0PP1DP1_GPU5 [label="Expert Dispatch\nL9_EP0TP0PP1DP1_GPU5" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L9_EP0TP0PP1DP1_GPU5 [label="Expert 0\nL9_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L9_EP0TP0PP1DP1_GPU5 [label="Expert 1\nL9_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L9_EP0TP0PP1DP1_GPU5 [label="Expert 2\nL9_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L9_EP0TP0PP1DP1_GPU5 [label="Expert 3\nL9_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L9_EP0TP0PP1DP1_GPU5 [label="Expert Combine\nL9_EP0TP0PP1DP1_GPU5" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L9_EP0TP0PP1DP1_GPU5 [label="FFN (Up-proj + GeLU + Down-proj)\nL9_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L9_EP0TP0PP1DP1_GPU5 [label="FFN All-Reduce\nL9 EP0 TP Group 0 PP1 DP1\nGPU5" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L9_EP0TP0PP1DP1_GPU5 [label="Residual Add 2\nL9_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L9_EP0TP1PP1DP0_GPU12 [label="Layer Norm 1\nL9_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L9_EP0TP1PP1DP0_GPU12 [label="QKV Projection\nL9_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L9_EP0TP1PP1DP0_GPU12 [label="Multi-Head Attention\nL9_EP0TP1PP1DP0_GPU12\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L9_EP0TP1PP1DP0_GPU12 [label="Attention Output Proj\nL9_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L9_EP0TP1PP1DP0_GPU12 [label="Attention All-Reduce\nL9 EP0 TP Group 1 PP1 DP0\nGPU12" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L9_EP0TP1PP1DP0_GPU12 [label="Residual Add 1\nL9_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L9_EP0TP1PP1DP0_GPU12 [label="Layer Norm 2\nL9_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L9_EP0TP1PP1DP0_GPU12 [label="MoE Gate (Routing)\nL9_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L9_EP0TP1PP1DP0_GPU12 [label="Expert Dispatch\nL9_EP0TP1PP1DP0_GPU12" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L9_EP0TP1PP1DP0_GPU12 [label="Expert 0\nL9_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L9_EP0TP1PP1DP0_GPU12 [label="Expert 1\nL9_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L9_EP0TP1PP1DP0_GPU12 [label="Expert 2\nL9_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L9_EP0TP1PP1DP0_GPU12 [label="Expert 3\nL9_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L9_EP0TP1PP1DP0_GPU12 [label="Expert Combine\nL9_EP0TP1PP1DP0_GPU12" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L9_EP0TP1PP1DP0_GPU12 [label="FFN (Up-proj + GeLU + Down-proj)\nL9_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L9_EP0TP1PP1DP0_GPU12 [label="FFN All-Reduce\nL9 EP0 TP Group 1 PP1 DP0\nGPU12" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L9_EP0TP1PP1DP0_GPU12 [label="Residual Add 2\nL9_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L9_EP0TP1PP1DP1_GPU13 [label="Layer Norm 1\nL9_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L9_EP0TP1PP1DP1_GPU13 [label="QKV Projection\nL9_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L9_EP0TP1PP1DP1_GPU13 [label="Multi-Head Attention\nL9_EP0TP1PP1DP1_GPU13\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L9_EP0TP1PP1DP1_GPU13 [label="Attention Output Proj\nL9_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L9_EP0TP1PP1DP1_GPU13 [label="Attention All-Reduce\nL9 EP0 TP Group 1 PP1 DP1\nGPU13" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L9_EP0TP1PP1DP1_GPU13 [label="Residual Add 1\nL9_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L9_EP0TP1PP1DP1_GPU13 [label="Layer Norm 2\nL9_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L9_EP0TP1PP1DP1_GPU13 [label="MoE Gate (Routing)\nL9_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L9_EP0TP1PP1DP1_GPU13 [label="Expert Dispatch\nL9_EP0TP1PP1DP1_GPU13" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L9_EP0TP1PP1DP1_GPU13 [label="Expert 0\nL9_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L9_EP0TP1PP1DP1_GPU13 [label="Expert 1\nL9_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L9_EP0TP1PP1DP1_GPU13 [label="Expert 2\nL9_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L9_EP0TP1PP1DP1_GPU13 [label="Expert 3\nL9_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L9_EP0TP1PP1DP1_GPU13 [label="Expert Combine\nL9_EP0TP1PP1DP1_GPU13" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L9_EP0TP1PP1DP1_GPU13 [label="FFN (Up-proj + GeLU + Down-proj)\nL9_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L9_EP0TP1PP1DP1_GPU13 [label="FFN All-Reduce\nL9 EP0 TP Group 1 PP1 DP1\nGPU13" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L9_EP0TP1PP1DP1_GPU13 [label="Residual Add 2\nL9_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L9_EP0TP2PP1DP0_GPU20 [label="Layer Norm 1\nL9_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L9_EP0TP2PP1DP0_GPU20 [label="QKV Projection\nL9_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L9_EP0TP2PP1DP0_GPU20 [label="Multi-Head Attention\nL9_EP0TP2PP1DP0_GPU20\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L9_EP0TP2PP1DP0_GPU20 [label="Attention Output Proj\nL9_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L9_EP0TP2PP1DP0_GPU20 [label="Attention All-Reduce\nL9 EP0 TP Group 2 PP1 DP0\nGPU20" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L9_EP0TP2PP1DP0_GPU20 [label="Residual Add 1\nL9_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L9_EP0TP2PP1DP0_GPU20 [label="Layer Norm 2\nL9_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L9_EP0TP2PP1DP0_GPU20 [label="MoE Gate (Routing)\nL9_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L9_EP0TP2PP1DP0_GPU20 [label="Expert Dispatch\nL9_EP0TP2PP1DP0_GPU20" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L9_EP0TP2PP1DP0_GPU20 [label="Expert 0\nL9_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L9_EP0TP2PP1DP0_GPU20 [label="Expert 1\nL9_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L9_EP0TP2PP1DP0_GPU20 [label="Expert 2\nL9_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L9_EP0TP2PP1DP0_GPU20 [label="Expert 3\nL9_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L9_EP0TP2PP1DP0_GPU20 [label="Expert Combine\nL9_EP0TP2PP1DP0_GPU20" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L9_EP0TP2PP1DP0_GPU20 [label="FFN (Up-proj + GeLU + Down-proj)\nL9_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L9_EP0TP2PP1DP0_GPU20 [label="FFN All-Reduce\nL9 EP0 TP Group 2 PP1 DP0\nGPU20" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L9_EP0TP2PP1DP0_GPU20 [label="Residual Add 2\nL9_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L9_EP0TP2PP1DP1_GPU21 [label="Layer Norm 1\nL9_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L9_EP0TP2PP1DP1_GPU21 [label="QKV Projection\nL9_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L9_EP0TP2PP1DP1_GPU21 [label="Multi-Head Attention\nL9_EP0TP2PP1DP1_GPU21\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L9_EP0TP2PP1DP1_GPU21 [label="Attention Output Proj\nL9_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L9_EP0TP2PP1DP1_GPU21 [label="Attention All-Reduce\nL9 EP0 TP Group 2 PP1 DP1\nGPU21" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L9_EP0TP2PP1DP1_GPU21 [label="Residual Add 1\nL9_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L9_EP0TP2PP1DP1_GPU21 [label="Layer Norm 2\nL9_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L9_EP0TP2PP1DP1_GPU21 [label="MoE Gate (Routing)\nL9_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L9_EP0TP2PP1DP1_GPU21 [label="Expert Dispatch\nL9_EP0TP2PP1DP1_GPU21" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L9_EP0TP2PP1DP1_GPU21 [label="Expert 0\nL9_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L9_EP0TP2PP1DP1_GPU21 [label="Expert 1\nL9_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L9_EP0TP2PP1DP1_GPU21 [label="Expert 2\nL9_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L9_EP0TP2PP1DP1_GPU21 [label="Expert 3\nL9_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L9_EP0TP2PP1DP1_GPU21 [label="Expert Combine\nL9_EP0TP2PP1DP1_GPU21" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L9_EP0TP2PP1DP1_GPU21 [label="FFN (Up-proj + GeLU + Down-proj)\nL9_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L9_EP0TP2PP1DP1_GPU21 [label="FFN All-Reduce\nL9 EP0 TP Group 2 PP1 DP1\nGPU21" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L9_EP0TP2PP1DP1_GPU21 [label="Residual Add 2\nL9_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L9_EP0TP3PP1DP0_GPU28 [label="Layer Norm 1\nL9_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L9_EP0TP3PP1DP0_GPU28 [label="QKV Projection\nL9_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L9_EP0TP3PP1DP0_GPU28 [label="Multi-Head Attention\nL9_EP0TP3PP1DP0_GPU28\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L9_EP0TP3PP1DP0_GPU28 [label="Attention Output Proj\nL9_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L9_EP0TP3PP1DP0_GPU28 [label="Attention All-Reduce\nL9 EP0 TP Group 3 PP1 DP0\nGPU28" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L9_EP0TP3PP1DP0_GPU28 [label="Residual Add 1\nL9_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L9_EP0TP3PP1DP0_GPU28 [label="Layer Norm 2\nL9_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L9_EP0TP3PP1DP0_GPU28 [label="MoE Gate (Routing)\nL9_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L9_EP0TP3PP1DP0_GPU28 [label="Expert Dispatch\nL9_EP0TP3PP1DP0_GPU28" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L9_EP0TP3PP1DP0_GPU28 [label="Expert 0\nL9_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L9_EP0TP3PP1DP0_GPU28 [label="Expert 1\nL9_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L9_EP0TP3PP1DP0_GPU28 [label="Expert 2\nL9_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L9_EP0TP3PP1DP0_GPU28 [label="Expert 3\nL9_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L9_EP0TP3PP1DP0_GPU28 [label="Expert Combine\nL9_EP0TP3PP1DP0_GPU28" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L9_EP0TP3PP1DP0_GPU28 [label="FFN (Up-proj + GeLU + Down-proj)\nL9_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L9_EP0TP3PP1DP0_GPU28 [label="FFN All-Reduce\nL9 EP0 TP Group 3 PP1 DP0\nGPU28" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L9_EP0TP3PP1DP0_GPU28 [label="Residual Add 2\nL9_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L9_EP0TP3PP1DP1_GPU29 [label="Layer Norm 1\nL9_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L9_EP0TP3PP1DP1_GPU29 [label="QKV Projection\nL9_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L9_EP0TP3PP1DP1_GPU29 [label="Multi-Head Attention\nL9_EP0TP3PP1DP1_GPU29\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L9_EP0TP3PP1DP1_GPU29 [label="Attention Output Proj\nL9_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L9_EP0TP3PP1DP1_GPU29 [label="Attention All-Reduce\nL9 EP0 TP Group 3 PP1 DP1\nGPU29" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L9_EP0TP3PP1DP1_GPU29 [label="Residual Add 1\nL9_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L9_EP0TP3PP1DP1_GPU29 [label="Layer Norm 2\nL9_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L9_EP0TP3PP1DP1_GPU29 [label="MoE Gate (Routing)\nL9_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L9_EP0TP3PP1DP1_GPU29 [label="Expert Dispatch\nL9_EP0TP3PP1DP1_GPU29" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L9_EP0TP3PP1DP1_GPU29 [label="Expert 0\nL9_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L9_EP0TP3PP1DP1_GPU29 [label="Expert 1\nL9_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L9_EP0TP3PP1DP1_GPU29 [label="Expert 2\nL9_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L9_EP0TP3PP1DP1_GPU29 [label="Expert 3\nL9_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L9_EP0TP3PP1DP1_GPU29 [label="Expert Combine\nL9_EP0TP3PP1DP1_GPU29" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L9_EP0TP3PP1DP1_GPU29 [label="FFN (Up-proj + GeLU + Down-proj)\nL9_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L9_EP0TP3PP1DP1_GPU29 [label="FFN All-Reduce\nL9 EP0 TP Group 3 PP1 DP1\nGPU29" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L9_EP0TP3PP1DP1_GPU29 [label="Residual Add 2\nL9_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L9_EP1TP0PP1DP0_GPU36 [label="Layer Norm 1\nL9_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L9_EP1TP0PP1DP0_GPU36 [label="QKV Projection\nL9_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L9_EP1TP0PP1DP0_GPU36 [label="Multi-Head Attention\nL9_EP1TP0PP1DP0_GPU36\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L9_EP1TP0PP1DP0_GPU36 [label="Attention Output Proj\nL9_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L9_EP1TP0PP1DP0_GPU36 [label="Attention All-Reduce\nL9 EP1 TP Group 0 PP1 DP0\nGPU36" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L9_EP1TP0PP1DP0_GPU36 [label="Residual Add 1\nL9_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L9_EP1TP0PP1DP0_GPU36 [label="Layer Norm 2\nL9_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L9_EP1TP0PP1DP0_GPU36 [label="MoE Gate (Routing)\nL9_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L9_EP1TP0PP1DP0_GPU36 [label="Expert Dispatch\nL9_EP1TP0PP1DP0_GPU36" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L9_EP1TP0PP1DP0_GPU36 [label="Expert 0\nL9_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L9_EP1TP0PP1DP0_GPU36 [label="Expert 1\nL9_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L9_EP1TP0PP1DP0_GPU36 [label="Expert 2\nL9_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L9_EP1TP0PP1DP0_GPU36 [label="Expert 3\nL9_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L9_EP1TP0PP1DP0_GPU36 [label="Expert Combine\nL9_EP1TP0PP1DP0_GPU36" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L9_EP1TP0PP1DP0_GPU36 [label="FFN (Up-proj + GeLU + Down-proj)\nL9_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L9_EP1TP0PP1DP0_GPU36 [label="FFN All-Reduce\nL9 EP1 TP Group 0 PP1 DP0\nGPU36" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L9_EP1TP0PP1DP0_GPU36 [label="Residual Add 2\nL9_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L9_EP1TP0PP1DP1_GPU37 [label="Layer Norm 1\nL9_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L9_EP1TP0PP1DP1_GPU37 [label="QKV Projection\nL9_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L9_EP1TP0PP1DP1_GPU37 [label="Multi-Head Attention\nL9_EP1TP0PP1DP1_GPU37\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L9_EP1TP0PP1DP1_GPU37 [label="Attention Output Proj\nL9_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L9_EP1TP0PP1DP1_GPU37 [label="Attention All-Reduce\nL9 EP1 TP Group 0 PP1 DP1\nGPU37" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L9_EP1TP0PP1DP1_GPU37 [label="Residual Add 1\nL9_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L9_EP1TP0PP1DP1_GPU37 [label="Layer Norm 2\nL9_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L9_EP1TP0PP1DP1_GPU37 [label="MoE Gate (Routing)\nL9_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L9_EP1TP0PP1DP1_GPU37 [label="Expert Dispatch\nL9_EP1TP0PP1DP1_GPU37" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L9_EP1TP0PP1DP1_GPU37 [label="Expert 0\nL9_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L9_EP1TP0PP1DP1_GPU37 [label="Expert 1\nL9_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L9_EP1TP0PP1DP1_GPU37 [label="Expert 2\nL9_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L9_EP1TP0PP1DP1_GPU37 [label="Expert 3\nL9_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L9_EP1TP0PP1DP1_GPU37 [label="Expert Combine\nL9_EP1TP0PP1DP1_GPU37" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L9_EP1TP0PP1DP1_GPU37 [label="FFN (Up-proj + GeLU + Down-proj)\nL9_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L9_EP1TP0PP1DP1_GPU37 [label="FFN All-Reduce\nL9 EP1 TP Group 0 PP1 DP1\nGPU37" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L9_EP1TP0PP1DP1_GPU37 [label="Residual Add 2\nL9_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L9_EP1TP1PP1DP0_GPU44 [label="Layer Norm 1\nL9_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L9_EP1TP1PP1DP0_GPU44 [label="QKV Projection\nL9_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L9_EP1TP1PP1DP0_GPU44 [label="Multi-Head Attention\nL9_EP1TP1PP1DP0_GPU44\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L9_EP1TP1PP1DP0_GPU44 [label="Attention Output Proj\nL9_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L9_EP1TP1PP1DP0_GPU44 [label="Attention All-Reduce\nL9 EP1 TP Group 1 PP1 DP0\nGPU44" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L9_EP1TP1PP1DP0_GPU44 [label="Residual Add 1\nL9_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L9_EP1TP1PP1DP0_GPU44 [label="Layer Norm 2\nL9_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L9_EP1TP1PP1DP0_GPU44 [label="MoE Gate (Routing)\nL9_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L9_EP1TP1PP1DP0_GPU44 [label="Expert Dispatch\nL9_EP1TP1PP1DP0_GPU44" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L9_EP1TP1PP1DP0_GPU44 [label="Expert 0\nL9_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L9_EP1TP1PP1DP0_GPU44 [label="Expert 1\nL9_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L9_EP1TP1PP1DP0_GPU44 [label="Expert 2\nL9_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L9_EP1TP1PP1DP0_GPU44 [label="Expert 3\nL9_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L9_EP1TP1PP1DP0_GPU44 [label="Expert Combine\nL9_EP1TP1PP1DP0_GPU44" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L9_EP1TP1PP1DP0_GPU44 [label="FFN (Up-proj + GeLU + Down-proj)\nL9_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L9_EP1TP1PP1DP0_GPU44 [label="FFN All-Reduce\nL9 EP1 TP Group 1 PP1 DP0\nGPU44" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L9_EP1TP1PP1DP0_GPU44 [label="Residual Add 2\nL9_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L9_EP1TP1PP1DP1_GPU45 [label="Layer Norm 1\nL9_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L9_EP1TP1PP1DP1_GPU45 [label="QKV Projection\nL9_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L9_EP1TP1PP1DP1_GPU45 [label="Multi-Head Attention\nL9_EP1TP1PP1DP1_GPU45\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L9_EP1TP1PP1DP1_GPU45 [label="Attention Output Proj\nL9_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L9_EP1TP1PP1DP1_GPU45 [label="Attention All-Reduce\nL9 EP1 TP Group 1 PP1 DP1\nGPU45" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L9_EP1TP1PP1DP1_GPU45 [label="Residual Add 1\nL9_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L9_EP1TP1PP1DP1_GPU45 [label="Layer Norm 2\nL9_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L9_EP1TP1PP1DP1_GPU45 [label="MoE Gate (Routing)\nL9_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L9_EP1TP1PP1DP1_GPU45 [label="Expert Dispatch\nL9_EP1TP1PP1DP1_GPU45" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L9_EP1TP1PP1DP1_GPU45 [label="Expert 0\nL9_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L9_EP1TP1PP1DP1_GPU45 [label="Expert 1\nL9_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L9_EP1TP1PP1DP1_GPU45 [label="Expert 2\nL9_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L9_EP1TP1PP1DP1_GPU45 [label="Expert 3\nL9_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L9_EP1TP1PP1DP1_GPU45 [label="Expert Combine\nL9_EP1TP1PP1DP1_GPU45" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L9_EP1TP1PP1DP1_GPU45 [label="FFN (Up-proj + GeLU + Down-proj)\nL9_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L9_EP1TP1PP1DP1_GPU45 [label="FFN All-Reduce\nL9 EP1 TP Group 1 PP1 DP1\nGPU45" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L9_EP1TP1PP1DP1_GPU45 [label="Residual Add 2\nL9_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L9_EP1TP2PP1DP0_GPU52 [label="Layer Norm 1\nL9_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L9_EP1TP2PP1DP0_GPU52 [label="QKV Projection\nL9_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L9_EP1TP2PP1DP0_GPU52 [label="Multi-Head Attention\nL9_EP1TP2PP1DP0_GPU52\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L9_EP1TP2PP1DP0_GPU52 [label="Attention Output Proj\nL9_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L9_EP1TP2PP1DP0_GPU52 [label="Attention All-Reduce\nL9 EP1 TP Group 2 PP1 DP0\nGPU52" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L9_EP1TP2PP1DP0_GPU52 [label="Residual Add 1\nL9_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L9_EP1TP2PP1DP0_GPU52 [label="Layer Norm 2\nL9_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L9_EP1TP2PP1DP0_GPU52 [label="MoE Gate (Routing)\nL9_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L9_EP1TP2PP1DP0_GPU52 [label="Expert Dispatch\nL9_EP1TP2PP1DP0_GPU52" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L9_EP1TP2PP1DP0_GPU52 [label="Expert 0\nL9_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L9_EP1TP2PP1DP0_GPU52 [label="Expert 1\nL9_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L9_EP1TP2PP1DP0_GPU52 [label="Expert 2\nL9_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L9_EP1TP2PP1DP0_GPU52 [label="Expert 3\nL9_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L9_EP1TP2PP1DP0_GPU52 [label="Expert Combine\nL9_EP1TP2PP1DP0_GPU52" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L9_EP1TP2PP1DP0_GPU52 [label="FFN (Up-proj + GeLU + Down-proj)\nL9_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L9_EP1TP2PP1DP0_GPU52 [label="FFN All-Reduce\nL9 EP1 TP Group 2 PP1 DP0\nGPU52" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L9_EP1TP2PP1DP0_GPU52 [label="Residual Add 2\nL9_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L9_EP1TP2PP1DP1_GPU53 [label="Layer Norm 1\nL9_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L9_EP1TP2PP1DP1_GPU53 [label="QKV Projection\nL9_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L9_EP1TP2PP1DP1_GPU53 [label="Multi-Head Attention\nL9_EP1TP2PP1DP1_GPU53\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L9_EP1TP2PP1DP1_GPU53 [label="Attention Output Proj\nL9_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L9_EP1TP2PP1DP1_GPU53 [label="Attention All-Reduce\nL9 EP1 TP Group 2 PP1 DP1\nGPU53" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L9_EP1TP2PP1DP1_GPU53 [label="Residual Add 1\nL9_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L9_EP1TP2PP1DP1_GPU53 [label="Layer Norm 2\nL9_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L9_EP1TP2PP1DP1_GPU53 [label="MoE Gate (Routing)\nL9_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L9_EP1TP2PP1DP1_GPU53 [label="Expert Dispatch\nL9_EP1TP2PP1DP1_GPU53" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L9_EP1TP2PP1DP1_GPU53 [label="Expert 0\nL9_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L9_EP1TP2PP1DP1_GPU53 [label="Expert 1\nL9_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L9_EP1TP2PP1DP1_GPU53 [label="Expert 2\nL9_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L9_EP1TP2PP1DP1_GPU53 [label="Expert 3\nL9_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L9_EP1TP2PP1DP1_GPU53 [label="Expert Combine\nL9_EP1TP2PP1DP1_GPU53" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L9_EP1TP2PP1DP1_GPU53 [label="FFN (Up-proj + GeLU + Down-proj)\nL9_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L9_EP1TP2PP1DP1_GPU53 [label="FFN All-Reduce\nL9 EP1 TP Group 2 PP1 DP1\nGPU53" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L9_EP1TP2PP1DP1_GPU53 [label="Residual Add 2\nL9_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L9_EP1TP3PP1DP0_GPU60 [label="Layer Norm 1\nL9_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L9_EP1TP3PP1DP0_GPU60 [label="QKV Projection\nL9_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L9_EP1TP3PP1DP0_GPU60 [label="Multi-Head Attention\nL9_EP1TP3PP1DP0_GPU60\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L9_EP1TP3PP1DP0_GPU60 [label="Attention Output Proj\nL9_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L9_EP1TP3PP1DP0_GPU60 [label="Attention All-Reduce\nL9 EP1 TP Group 3 PP1 DP0\nGPU60" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L9_EP1TP3PP1DP0_GPU60 [label="Residual Add 1\nL9_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L9_EP1TP3PP1DP0_GPU60 [label="Layer Norm 2\nL9_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L9_EP1TP3PP1DP0_GPU60 [label="MoE Gate (Routing)\nL9_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L9_EP1TP3PP1DP0_GPU60 [label="Expert Dispatch\nL9_EP1TP3PP1DP0_GPU60" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L9_EP1TP3PP1DP0_GPU60 [label="Expert 0\nL9_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L9_EP1TP3PP1DP0_GPU60 [label="Expert 1\nL9_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L9_EP1TP3PP1DP0_GPU60 [label="Expert 2\nL9_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L9_EP1TP3PP1DP0_GPU60 [label="Expert 3\nL9_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L9_EP1TP3PP1DP0_GPU60 [label="Expert Combine\nL9_EP1TP3PP1DP0_GPU60" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L9_EP1TP3PP1DP0_GPU60 [label="FFN (Up-proj + GeLU + Down-proj)\nL9_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L9_EP1TP3PP1DP0_GPU60 [label="FFN All-Reduce\nL9 EP1 TP Group 3 PP1 DP0\nGPU60" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L9_EP1TP3PP1DP0_GPU60 [label="Residual Add 2\nL9_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L9_EP1TP3PP1DP1_GPU61 [label="Layer Norm 1\nL9_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L9_EP1TP3PP1DP1_GPU61 [label="QKV Projection\nL9_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L9_EP1TP3PP1DP1_GPU61 [label="Multi-Head Attention\nL9_EP1TP3PP1DP1_GPU61\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L9_EP1TP3PP1DP1_GPU61 [label="Attention Output Proj\nL9_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L9_EP1TP3PP1DP1_GPU61 [label="Attention All-Reduce\nL9 EP1 TP Group 3 PP1 DP1\nGPU61" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L9_EP1TP3PP1DP1_GPU61 [label="Residual Add 1\nL9_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L9_EP1TP3PP1DP1_GPU61 [label="Layer Norm 2\nL9_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L9_EP1TP3PP1DP1_GPU61 [label="MoE Gate (Routing)\nL9_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L9_EP1TP3PP1DP1_GPU61 [label="Expert Dispatch\nL9_EP1TP3PP1DP1_GPU61" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L9_EP1TP3PP1DP1_GPU61 [label="Expert 0\nL9_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L9_EP1TP3PP1DP1_GPU61 [label="Expert 1\nL9_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L9_EP1TP3PP1DP1_GPU61 [label="Expert 2\nL9_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L9_EP1TP3PP1DP1_GPU61 [label="Expert 3\nL9_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L9_EP1TP3PP1DP1_GPU61 [label="Expert Combine\nL9_EP1TP3PP1DP1_GPU61" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L9_EP1TP3PP1DP1_GPU61 [label="FFN (Up-proj + GeLU + Down-proj)\nL9_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L9_EP1TP3PP1DP1_GPU61 [label="FFN All-Reduce\nL9 EP1 TP Group 3 PP1 DP1\nGPU61" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L9_EP1TP3PP1DP1_GPU61 [label="Residual Add 2\nL9_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L10_EP0TP0PP1DP0_GPU4 [label="Layer Norm 1\nL10_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L10_EP0TP0PP1DP0_GPU4 [label="QKV Projection\nL10_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L10_EP0TP0PP1DP0_GPU4 [label="Multi-Head Attention\nL10_EP0TP0PP1DP0_GPU4\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L10_EP0TP0PP1DP0_GPU4 [label="Attention Output Proj\nL10_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L10_EP0TP0PP1DP0_GPU4 [label="Attention All-Reduce\nL10 EP0 TP Group 0 PP1 DP0\nGPU4" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L10_EP0TP0PP1DP0_GPU4 [label="Residual Add 1\nL10_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L10_EP0TP0PP1DP0_GPU4 [label="Layer Norm 2\nL10_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L10_EP0TP0PP1DP0_GPU4 [label="MoE Gate (Routing)\nL10_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L10_EP0TP0PP1DP0_GPU4 [label="Expert Dispatch\nL10_EP0TP0PP1DP0_GPU4" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L10_EP0TP0PP1DP0_GPU4 [label="Expert 0\nL10_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L10_EP0TP0PP1DP0_GPU4 [label="Expert 1\nL10_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L10_EP0TP0PP1DP0_GPU4 [label="Expert 2\nL10_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L10_EP0TP0PP1DP0_GPU4 [label="Expert 3\nL10_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L10_EP0TP0PP1DP0_GPU4 [label="Expert Combine\nL10_EP0TP0PP1DP0_GPU4" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L10_EP0TP0PP1DP0_GPU4 [label="FFN (Up-proj + GeLU + Down-proj)\nL10_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L10_EP0TP0PP1DP0_GPU4 [label="FFN All-Reduce\nL10 EP0 TP Group 0 PP1 DP0\nGPU4" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L10_EP0TP0PP1DP0_GPU4 [label="Residual Add 2\nL10_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L10_EP0TP0PP1DP1_GPU5 [label="Layer Norm 1\nL10_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L10_EP0TP0PP1DP1_GPU5 [label="QKV Projection\nL10_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L10_EP0TP0PP1DP1_GPU5 [label="Multi-Head Attention\nL10_EP0TP0PP1DP1_GPU5\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L10_EP0TP0PP1DP1_GPU5 [label="Attention Output Proj\nL10_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L10_EP0TP0PP1DP1_GPU5 [label="Attention All-Reduce\nL10 EP0 TP Group 0 PP1 DP1\nGPU5" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L10_EP0TP0PP1DP1_GPU5 [label="Residual Add 1\nL10_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L10_EP0TP0PP1DP1_GPU5 [label="Layer Norm 2\nL10_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L10_EP0TP0PP1DP1_GPU5 [label="MoE Gate (Routing)\nL10_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L10_EP0TP0PP1DP1_GPU5 [label="Expert Dispatch\nL10_EP0TP0PP1DP1_GPU5" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L10_EP0TP0PP1DP1_GPU5 [label="Expert 0\nL10_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L10_EP0TP0PP1DP1_GPU5 [label="Expert 1\nL10_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L10_EP0TP0PP1DP1_GPU5 [label="Expert 2\nL10_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L10_EP0TP0PP1DP1_GPU5 [label="Expert 3\nL10_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L10_EP0TP0PP1DP1_GPU5 [label="Expert Combine\nL10_EP0TP0PP1DP1_GPU5" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L10_EP0TP0PP1DP1_GPU5 [label="FFN (Up-proj + GeLU + Down-proj)\nL10_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L10_EP0TP0PP1DP1_GPU5 [label="FFN All-Reduce\nL10 EP0 TP Group 0 PP1 DP1\nGPU5" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L10_EP0TP0PP1DP1_GPU5 [label="Residual Add 2\nL10_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L10_EP0TP1PP1DP0_GPU12 [label="Layer Norm 1\nL10_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L10_EP0TP1PP1DP0_GPU12 [label="QKV Projection\nL10_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L10_EP0TP1PP1DP0_GPU12 [label="Multi-Head Attention\nL10_EP0TP1PP1DP0_GPU12\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L10_EP0TP1PP1DP0_GPU12 [label="Attention Output Proj\nL10_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L10_EP0TP1PP1DP0_GPU12 [label="Attention All-Reduce\nL10 EP0 TP Group 1 PP1 DP0\nGPU12" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L10_EP0TP1PP1DP0_GPU12 [label="Residual Add 1\nL10_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L10_EP0TP1PP1DP0_GPU12 [label="Layer Norm 2\nL10_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L10_EP0TP1PP1DP0_GPU12 [label="MoE Gate (Routing)\nL10_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L10_EP0TP1PP1DP0_GPU12 [label="Expert Dispatch\nL10_EP0TP1PP1DP0_GPU12" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L10_EP0TP1PP1DP0_GPU12 [label="Expert 0\nL10_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L10_EP0TP1PP1DP0_GPU12 [label="Expert 1\nL10_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L10_EP0TP1PP1DP0_GPU12 [label="Expert 2\nL10_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L10_EP0TP1PP1DP0_GPU12 [label="Expert 3\nL10_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L10_EP0TP1PP1DP0_GPU12 [label="Expert Combine\nL10_EP0TP1PP1DP0_GPU12" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L10_EP0TP1PP1DP0_GPU12 [label="FFN (Up-proj + GeLU + Down-proj)\nL10_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L10_EP0TP1PP1DP0_GPU12 [label="FFN All-Reduce\nL10 EP0 TP Group 1 PP1 DP0\nGPU12" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L10_EP0TP1PP1DP0_GPU12 [label="Residual Add 2\nL10_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L10_EP0TP1PP1DP1_GPU13 [label="Layer Norm 1\nL10_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L10_EP0TP1PP1DP1_GPU13 [label="QKV Projection\nL10_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L10_EP0TP1PP1DP1_GPU13 [label="Multi-Head Attention\nL10_EP0TP1PP1DP1_GPU13\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L10_EP0TP1PP1DP1_GPU13 [label="Attention Output Proj\nL10_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L10_EP0TP1PP1DP1_GPU13 [label="Attention All-Reduce\nL10 EP0 TP Group 1 PP1 DP1\nGPU13" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L10_EP0TP1PP1DP1_GPU13 [label="Residual Add 1\nL10_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L10_EP0TP1PP1DP1_GPU13 [label="Layer Norm 2\nL10_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L10_EP0TP1PP1DP1_GPU13 [label="MoE Gate (Routing)\nL10_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L10_EP0TP1PP1DP1_GPU13 [label="Expert Dispatch\nL10_EP0TP1PP1DP1_GPU13" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L10_EP0TP1PP1DP1_GPU13 [label="Expert 0\nL10_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L10_EP0TP1PP1DP1_GPU13 [label="Expert 1\nL10_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L10_EP0TP1PP1DP1_GPU13 [label="Expert 2\nL10_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L10_EP0TP1PP1DP1_GPU13 [label="Expert 3\nL10_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L10_EP0TP1PP1DP1_GPU13 [label="Expert Combine\nL10_EP0TP1PP1DP1_GPU13" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L10_EP0TP1PP1DP1_GPU13 [label="FFN (Up-proj + GeLU + Down-proj)\nL10_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L10_EP0TP1PP1DP1_GPU13 [label="FFN All-Reduce\nL10 EP0 TP Group 1 PP1 DP1\nGPU13" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L10_EP0TP1PP1DP1_GPU13 [label="Residual Add 2\nL10_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L10_EP0TP2PP1DP0_GPU20 [label="Layer Norm 1\nL10_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L10_EP0TP2PP1DP0_GPU20 [label="QKV Projection\nL10_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L10_EP0TP2PP1DP0_GPU20 [label="Multi-Head Attention\nL10_EP0TP2PP1DP0_GPU20\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L10_EP0TP2PP1DP0_GPU20 [label="Attention Output Proj\nL10_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L10_EP0TP2PP1DP0_GPU20 [label="Attention All-Reduce\nL10 EP0 TP Group 2 PP1 DP0\nGPU20" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L10_EP0TP2PP1DP0_GPU20 [label="Residual Add 1\nL10_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L10_EP0TP2PP1DP0_GPU20 [label="Layer Norm 2\nL10_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L10_EP0TP2PP1DP0_GPU20 [label="MoE Gate (Routing)\nL10_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L10_EP0TP2PP1DP0_GPU20 [label="Expert Dispatch\nL10_EP0TP2PP1DP0_GPU20" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L10_EP0TP2PP1DP0_GPU20 [label="Expert 0\nL10_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L10_EP0TP2PP1DP0_GPU20 [label="Expert 1\nL10_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L10_EP0TP2PP1DP0_GPU20 [label="Expert 2\nL10_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L10_EP0TP2PP1DP0_GPU20 [label="Expert 3\nL10_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L10_EP0TP2PP1DP0_GPU20 [label="Expert Combine\nL10_EP0TP2PP1DP0_GPU20" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L10_EP0TP2PP1DP0_GPU20 [label="FFN (Up-proj + GeLU + Down-proj)\nL10_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L10_EP0TP2PP1DP0_GPU20 [label="FFN All-Reduce\nL10 EP0 TP Group 2 PP1 DP0\nGPU20" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L10_EP0TP2PP1DP0_GPU20 [label="Residual Add 2\nL10_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L10_EP0TP2PP1DP1_GPU21 [label="Layer Norm 1\nL10_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L10_EP0TP2PP1DP1_GPU21 [label="QKV Projection\nL10_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L10_EP0TP2PP1DP1_GPU21 [label="Multi-Head Attention\nL10_EP0TP2PP1DP1_GPU21\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L10_EP0TP2PP1DP1_GPU21 [label="Attention Output Proj\nL10_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L10_EP0TP2PP1DP1_GPU21 [label="Attention All-Reduce\nL10 EP0 TP Group 2 PP1 DP1\nGPU21" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L10_EP0TP2PP1DP1_GPU21 [label="Residual Add 1\nL10_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L10_EP0TP2PP1DP1_GPU21 [label="Layer Norm 2\nL10_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L10_EP0TP2PP1DP1_GPU21 [label="MoE Gate (Routing)\nL10_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L10_EP0TP2PP1DP1_GPU21 [label="Expert Dispatch\nL10_EP0TP2PP1DP1_GPU21" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L10_EP0TP2PP1DP1_GPU21 [label="Expert 0\nL10_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L10_EP0TP2PP1DP1_GPU21 [label="Expert 1\nL10_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L10_EP0TP2PP1DP1_GPU21 [label="Expert 2\nL10_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L10_EP0TP2PP1DP1_GPU21 [label="Expert 3\nL10_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L10_EP0TP2PP1DP1_GPU21 [label="Expert Combine\nL10_EP0TP2PP1DP1_GPU21" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L10_EP0TP2PP1DP1_GPU21 [label="FFN (Up-proj + GeLU + Down-proj)\nL10_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L10_EP0TP2PP1DP1_GPU21 [label="FFN All-Reduce\nL10 EP0 TP Group 2 PP1 DP1\nGPU21" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L10_EP0TP2PP1DP1_GPU21 [label="Residual Add 2\nL10_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L10_EP0TP3PP1DP0_GPU28 [label="Layer Norm 1\nL10_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L10_EP0TP3PP1DP0_GPU28 [label="QKV Projection\nL10_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L10_EP0TP3PP1DP0_GPU28 [label="Multi-Head Attention\nL10_EP0TP3PP1DP0_GPU28\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L10_EP0TP3PP1DP0_GPU28 [label="Attention Output Proj\nL10_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L10_EP0TP3PP1DP0_GPU28 [label="Attention All-Reduce\nL10 EP0 TP Group 3 PP1 DP0\nGPU28" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L10_EP0TP3PP1DP0_GPU28 [label="Residual Add 1\nL10_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L10_EP0TP3PP1DP0_GPU28 [label="Layer Norm 2\nL10_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L10_EP0TP3PP1DP0_GPU28 [label="MoE Gate (Routing)\nL10_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L10_EP0TP3PP1DP0_GPU28 [label="Expert Dispatch\nL10_EP0TP3PP1DP0_GPU28" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L10_EP0TP3PP1DP0_GPU28 [label="Expert 0\nL10_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L10_EP0TP3PP1DP0_GPU28 [label="Expert 1\nL10_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L10_EP0TP3PP1DP0_GPU28 [label="Expert 2\nL10_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L10_EP0TP3PP1DP0_GPU28 [label="Expert 3\nL10_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L10_EP0TP3PP1DP0_GPU28 [label="Expert Combine\nL10_EP0TP3PP1DP0_GPU28" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L10_EP0TP3PP1DP0_GPU28 [label="FFN (Up-proj + GeLU + Down-proj)\nL10_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L10_EP0TP3PP1DP0_GPU28 [label="FFN All-Reduce\nL10 EP0 TP Group 3 PP1 DP0\nGPU28" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L10_EP0TP3PP1DP0_GPU28 [label="Residual Add 2\nL10_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L10_EP0TP3PP1DP1_GPU29 [label="Layer Norm 1\nL10_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L10_EP0TP3PP1DP1_GPU29 [label="QKV Projection\nL10_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L10_EP0TP3PP1DP1_GPU29 [label="Multi-Head Attention\nL10_EP0TP3PP1DP1_GPU29\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L10_EP0TP3PP1DP1_GPU29 [label="Attention Output Proj\nL10_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L10_EP0TP3PP1DP1_GPU29 [label="Attention All-Reduce\nL10 EP0 TP Group 3 PP1 DP1\nGPU29" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L10_EP0TP3PP1DP1_GPU29 [label="Residual Add 1\nL10_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L10_EP0TP3PP1DP1_GPU29 [label="Layer Norm 2\nL10_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L10_EP0TP3PP1DP1_GPU29 [label="MoE Gate (Routing)\nL10_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L10_EP0TP3PP1DP1_GPU29 [label="Expert Dispatch\nL10_EP0TP3PP1DP1_GPU29" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L10_EP0TP3PP1DP1_GPU29 [label="Expert 0\nL10_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L10_EP0TP3PP1DP1_GPU29 [label="Expert 1\nL10_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L10_EP0TP3PP1DP1_GPU29 [label="Expert 2\nL10_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L10_EP0TP3PP1DP1_GPU29 [label="Expert 3\nL10_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L10_EP0TP3PP1DP1_GPU29 [label="Expert Combine\nL10_EP0TP3PP1DP1_GPU29" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L10_EP0TP3PP1DP1_GPU29 [label="FFN (Up-proj + GeLU + Down-proj)\nL10_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L10_EP0TP3PP1DP1_GPU29 [label="FFN All-Reduce\nL10 EP0 TP Group 3 PP1 DP1\nGPU29" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L10_EP0TP3PP1DP1_GPU29 [label="Residual Add 2\nL10_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L10_EP1TP0PP1DP0_GPU36 [label="Layer Norm 1\nL10_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L10_EP1TP0PP1DP0_GPU36 [label="QKV Projection\nL10_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L10_EP1TP0PP1DP0_GPU36 [label="Multi-Head Attention\nL10_EP1TP0PP1DP0_GPU36\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L10_EP1TP0PP1DP0_GPU36 [label="Attention Output Proj\nL10_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L10_EP1TP0PP1DP0_GPU36 [label="Attention All-Reduce\nL10 EP1 TP Group 0 PP1 DP0\nGPU36" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L10_EP1TP0PP1DP0_GPU36 [label="Residual Add 1\nL10_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L10_EP1TP0PP1DP0_GPU36 [label="Layer Norm 2\nL10_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L10_EP1TP0PP1DP0_GPU36 [label="MoE Gate (Routing)\nL10_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L10_EP1TP0PP1DP0_GPU36 [label="Expert Dispatch\nL10_EP1TP0PP1DP0_GPU36" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L10_EP1TP0PP1DP0_GPU36 [label="Expert 0\nL10_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L10_EP1TP0PP1DP0_GPU36 [label="Expert 1\nL10_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L10_EP1TP0PP1DP0_GPU36 [label="Expert 2\nL10_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L10_EP1TP0PP1DP0_GPU36 [label="Expert 3\nL10_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L10_EP1TP0PP1DP0_GPU36 [label="Expert Combine\nL10_EP1TP0PP1DP0_GPU36" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L10_EP1TP0PP1DP0_GPU36 [label="FFN (Up-proj + GeLU + Down-proj)\nL10_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L10_EP1TP0PP1DP0_GPU36 [label="FFN All-Reduce\nL10 EP1 TP Group 0 PP1 DP0\nGPU36" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L10_EP1TP0PP1DP0_GPU36 [label="Residual Add 2\nL10_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L10_EP1TP0PP1DP1_GPU37 [label="Layer Norm 1\nL10_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L10_EP1TP0PP1DP1_GPU37 [label="QKV Projection\nL10_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L10_EP1TP0PP1DP1_GPU37 [label="Multi-Head Attention\nL10_EP1TP0PP1DP1_GPU37\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L10_EP1TP0PP1DP1_GPU37 [label="Attention Output Proj\nL10_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L10_EP1TP0PP1DP1_GPU37 [label="Attention All-Reduce\nL10 EP1 TP Group 0 PP1 DP1\nGPU37" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L10_EP1TP0PP1DP1_GPU37 [label="Residual Add 1\nL10_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L10_EP1TP0PP1DP1_GPU37 [label="Layer Norm 2\nL10_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L10_EP1TP0PP1DP1_GPU37 [label="MoE Gate (Routing)\nL10_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L10_EP1TP0PP1DP1_GPU37 [label="Expert Dispatch\nL10_EP1TP0PP1DP1_GPU37" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L10_EP1TP0PP1DP1_GPU37 [label="Expert 0\nL10_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L10_EP1TP0PP1DP1_GPU37 [label="Expert 1\nL10_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L10_EP1TP0PP1DP1_GPU37 [label="Expert 2\nL10_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L10_EP1TP0PP1DP1_GPU37 [label="Expert 3\nL10_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L10_EP1TP0PP1DP1_GPU37 [label="Expert Combine\nL10_EP1TP0PP1DP1_GPU37" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L10_EP1TP0PP1DP1_GPU37 [label="FFN (Up-proj + GeLU + Down-proj)\nL10_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L10_EP1TP0PP1DP1_GPU37 [label="FFN All-Reduce\nL10 EP1 TP Group 0 PP1 DP1\nGPU37" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L10_EP1TP0PP1DP1_GPU37 [label="Residual Add 2\nL10_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L10_EP1TP1PP1DP0_GPU44 [label="Layer Norm 1\nL10_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L10_EP1TP1PP1DP0_GPU44 [label="QKV Projection\nL10_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L10_EP1TP1PP1DP0_GPU44 [label="Multi-Head Attention\nL10_EP1TP1PP1DP0_GPU44\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L10_EP1TP1PP1DP0_GPU44 [label="Attention Output Proj\nL10_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L10_EP1TP1PP1DP0_GPU44 [label="Attention All-Reduce\nL10 EP1 TP Group 1 PP1 DP0\nGPU44" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L10_EP1TP1PP1DP0_GPU44 [label="Residual Add 1\nL10_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L10_EP1TP1PP1DP0_GPU44 [label="Layer Norm 2\nL10_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L10_EP1TP1PP1DP0_GPU44 [label="MoE Gate (Routing)\nL10_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L10_EP1TP1PP1DP0_GPU44 [label="Expert Dispatch\nL10_EP1TP1PP1DP0_GPU44" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L10_EP1TP1PP1DP0_GPU44 [label="Expert 0\nL10_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L10_EP1TP1PP1DP0_GPU44 [label="Expert 1\nL10_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L10_EP1TP1PP1DP0_GPU44 [label="Expert 2\nL10_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L10_EP1TP1PP1DP0_GPU44 [label="Expert 3\nL10_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L10_EP1TP1PP1DP0_GPU44 [label="Expert Combine\nL10_EP1TP1PP1DP0_GPU44" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L10_EP1TP1PP1DP0_GPU44 [label="FFN (Up-proj + GeLU + Down-proj)\nL10_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L10_EP1TP1PP1DP0_GPU44 [label="FFN All-Reduce\nL10 EP1 TP Group 1 PP1 DP0\nGPU44" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L10_EP1TP1PP1DP0_GPU44 [label="Residual Add 2\nL10_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L10_EP1TP1PP1DP1_GPU45 [label="Layer Norm 1\nL10_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L10_EP1TP1PP1DP1_GPU45 [label="QKV Projection\nL10_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L10_EP1TP1PP1DP1_GPU45 [label="Multi-Head Attention\nL10_EP1TP1PP1DP1_GPU45\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L10_EP1TP1PP1DP1_GPU45 [label="Attention Output Proj\nL10_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L10_EP1TP1PP1DP1_GPU45 [label="Attention All-Reduce\nL10 EP1 TP Group 1 PP1 DP1\nGPU45" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L10_EP1TP1PP1DP1_GPU45 [label="Residual Add 1\nL10_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L10_EP1TP1PP1DP1_GPU45 [label="Layer Norm 2\nL10_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L10_EP1TP1PP1DP1_GPU45 [label="MoE Gate (Routing)\nL10_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L10_EP1TP1PP1DP1_GPU45 [label="Expert Dispatch\nL10_EP1TP1PP1DP1_GPU45" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L10_EP1TP1PP1DP1_GPU45 [label="Expert 0\nL10_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L10_EP1TP1PP1DP1_GPU45 [label="Expert 1\nL10_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L10_EP1TP1PP1DP1_GPU45 [label="Expert 2\nL10_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L10_EP1TP1PP1DP1_GPU45 [label="Expert 3\nL10_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L10_EP1TP1PP1DP1_GPU45 [label="Expert Combine\nL10_EP1TP1PP1DP1_GPU45" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L10_EP1TP1PP1DP1_GPU45 [label="FFN (Up-proj + GeLU + Down-proj)\nL10_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L10_EP1TP1PP1DP1_GPU45 [label="FFN All-Reduce\nL10 EP1 TP Group 1 PP1 DP1\nGPU45" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L10_EP1TP1PP1DP1_GPU45 [label="Residual Add 2\nL10_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L10_EP1TP2PP1DP0_GPU52 [label="Layer Norm 1\nL10_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L10_EP1TP2PP1DP0_GPU52 [label="QKV Projection\nL10_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L10_EP1TP2PP1DP0_GPU52 [label="Multi-Head Attention\nL10_EP1TP2PP1DP0_GPU52\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L10_EP1TP2PP1DP0_GPU52 [label="Attention Output Proj\nL10_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L10_EP1TP2PP1DP0_GPU52 [label="Attention All-Reduce\nL10 EP1 TP Group 2 PP1 DP0\nGPU52" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L10_EP1TP2PP1DP0_GPU52 [label="Residual Add 1\nL10_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L10_EP1TP2PP1DP0_GPU52 [label="Layer Norm 2\nL10_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L10_EP1TP2PP1DP0_GPU52 [label="MoE Gate (Routing)\nL10_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L10_EP1TP2PP1DP0_GPU52 [label="Expert Dispatch\nL10_EP1TP2PP1DP0_GPU52" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L10_EP1TP2PP1DP0_GPU52 [label="Expert 0\nL10_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L10_EP1TP2PP1DP0_GPU52 [label="Expert 1\nL10_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L10_EP1TP2PP1DP0_GPU52 [label="Expert 2\nL10_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L10_EP1TP2PP1DP0_GPU52 [label="Expert 3\nL10_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L10_EP1TP2PP1DP0_GPU52 [label="Expert Combine\nL10_EP1TP2PP1DP0_GPU52" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L10_EP1TP2PP1DP0_GPU52 [label="FFN (Up-proj + GeLU + Down-proj)\nL10_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L10_EP1TP2PP1DP0_GPU52 [label="FFN All-Reduce\nL10 EP1 TP Group 2 PP1 DP0\nGPU52" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L10_EP1TP2PP1DP0_GPU52 [label="Residual Add 2\nL10_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L10_EP1TP2PP1DP1_GPU53 [label="Layer Norm 1\nL10_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L10_EP1TP2PP1DP1_GPU53 [label="QKV Projection\nL10_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L10_EP1TP2PP1DP1_GPU53 [label="Multi-Head Attention\nL10_EP1TP2PP1DP1_GPU53\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L10_EP1TP2PP1DP1_GPU53 [label="Attention Output Proj\nL10_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L10_EP1TP2PP1DP1_GPU53 [label="Attention All-Reduce\nL10 EP1 TP Group 2 PP1 DP1\nGPU53" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L10_EP1TP2PP1DP1_GPU53 [label="Residual Add 1\nL10_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L10_EP1TP2PP1DP1_GPU53 [label="Layer Norm 2\nL10_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L10_EP1TP2PP1DP1_GPU53 [label="MoE Gate (Routing)\nL10_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L10_EP1TP2PP1DP1_GPU53 [label="Expert Dispatch\nL10_EP1TP2PP1DP1_GPU53" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L10_EP1TP2PP1DP1_GPU53 [label="Expert 0\nL10_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L10_EP1TP2PP1DP1_GPU53 [label="Expert 1\nL10_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L10_EP1TP2PP1DP1_GPU53 [label="Expert 2\nL10_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L10_EP1TP2PP1DP1_GPU53 [label="Expert 3\nL10_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L10_EP1TP2PP1DP1_GPU53 [label="Expert Combine\nL10_EP1TP2PP1DP1_GPU53" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L10_EP1TP2PP1DP1_GPU53 [label="FFN (Up-proj + GeLU + Down-proj)\nL10_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L10_EP1TP2PP1DP1_GPU53 [label="FFN All-Reduce\nL10 EP1 TP Group 2 PP1 DP1\nGPU53" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L10_EP1TP2PP1DP1_GPU53 [label="Residual Add 2\nL10_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L10_EP1TP3PP1DP0_GPU60 [label="Layer Norm 1\nL10_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L10_EP1TP3PP1DP0_GPU60 [label="QKV Projection\nL10_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L10_EP1TP3PP1DP0_GPU60 [label="Multi-Head Attention\nL10_EP1TP3PP1DP0_GPU60\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L10_EP1TP3PP1DP0_GPU60 [label="Attention Output Proj\nL10_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L10_EP1TP3PP1DP0_GPU60 [label="Attention All-Reduce\nL10 EP1 TP Group 3 PP1 DP0\nGPU60" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L10_EP1TP3PP1DP0_GPU60 [label="Residual Add 1\nL10_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L10_EP1TP3PP1DP0_GPU60 [label="Layer Norm 2\nL10_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L10_EP1TP3PP1DP0_GPU60 [label="MoE Gate (Routing)\nL10_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L10_EP1TP3PP1DP0_GPU60 [label="Expert Dispatch\nL10_EP1TP3PP1DP0_GPU60" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L10_EP1TP3PP1DP0_GPU60 [label="Expert 0\nL10_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L10_EP1TP3PP1DP0_GPU60 [label="Expert 1\nL10_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L10_EP1TP3PP1DP0_GPU60 [label="Expert 2\nL10_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L10_EP1TP3PP1DP0_GPU60 [label="Expert 3\nL10_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L10_EP1TP3PP1DP0_GPU60 [label="Expert Combine\nL10_EP1TP3PP1DP0_GPU60" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L10_EP1TP3PP1DP0_GPU60 [label="FFN (Up-proj + GeLU + Down-proj)\nL10_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L10_EP1TP3PP1DP0_GPU60 [label="FFN All-Reduce\nL10 EP1 TP Group 3 PP1 DP0\nGPU60" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L10_EP1TP3PP1DP0_GPU60 [label="Residual Add 2\nL10_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L10_EP1TP3PP1DP1_GPU61 [label="Layer Norm 1\nL10_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L10_EP1TP3PP1DP1_GPU61 [label="QKV Projection\nL10_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L10_EP1TP3PP1DP1_GPU61 [label="Multi-Head Attention\nL10_EP1TP3PP1DP1_GPU61\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L10_EP1TP3PP1DP1_GPU61 [label="Attention Output Proj\nL10_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L10_EP1TP3PP1DP1_GPU61 [label="Attention All-Reduce\nL10 EP1 TP Group 3 PP1 DP1\nGPU61" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L10_EP1TP3PP1DP1_GPU61 [label="Residual Add 1\nL10_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L10_EP1TP3PP1DP1_GPU61 [label="Layer Norm 2\nL10_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L10_EP1TP3PP1DP1_GPU61 [label="MoE Gate (Routing)\nL10_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L10_EP1TP3PP1DP1_GPU61 [label="Expert Dispatch\nL10_EP1TP3PP1DP1_GPU61" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L10_EP1TP3PP1DP1_GPU61 [label="Expert 0\nL10_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L10_EP1TP3PP1DP1_GPU61 [label="Expert 1\nL10_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L10_EP1TP3PP1DP1_GPU61 [label="Expert 2\nL10_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L10_EP1TP3PP1DP1_GPU61 [label="Expert 3\nL10_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L10_EP1TP3PP1DP1_GPU61 [label="Expert Combine\nL10_EP1TP3PP1DP1_GPU61" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L10_EP1TP3PP1DP1_GPU61 [label="FFN (Up-proj + GeLU + Down-proj)\nL10_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L10_EP1TP3PP1DP1_GPU61 [label="FFN All-Reduce\nL10 EP1 TP Group 3 PP1 DP1\nGPU61" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L10_EP1TP3PP1DP1_GPU61 [label="Residual Add 2\nL10_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L11_EP0TP0PP1DP0_GPU4 [label="Layer Norm 1\nL11_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L11_EP0TP0PP1DP0_GPU4 [label="QKV Projection\nL11_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L11_EP0TP0PP1DP0_GPU4 [label="Multi-Head Attention\nL11_EP0TP0PP1DP0_GPU4\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L11_EP0TP0PP1DP0_GPU4 [label="Attention Output Proj\nL11_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L11_EP0TP0PP1DP0_GPU4 [label="Attention All-Reduce\nL11 EP0 TP Group 0 PP1 DP0\nGPU4" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L11_EP0TP0PP1DP0_GPU4 [label="Residual Add 1\nL11_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L11_EP0TP0PP1DP0_GPU4 [label="Layer Norm 2\nL11_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L11_EP0TP0PP1DP0_GPU4 [label="MoE Gate (Routing)\nL11_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L11_EP0TP0PP1DP0_GPU4 [label="Expert Dispatch\nL11_EP0TP0PP1DP0_GPU4" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L11_EP0TP0PP1DP0_GPU4 [label="Expert 0\nL11_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L11_EP0TP0PP1DP0_GPU4 [label="Expert 1\nL11_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L11_EP0TP0PP1DP0_GPU4 [label="Expert 2\nL11_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L11_EP0TP0PP1DP0_GPU4 [label="Expert 3\nL11_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L11_EP0TP0PP1DP0_GPU4 [label="Expert Combine\nL11_EP0TP0PP1DP0_GPU4" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L11_EP0TP0PP1DP0_GPU4 [label="FFN (Up-proj + GeLU + Down-proj)\nL11_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L11_EP0TP0PP1DP0_GPU4 [label="FFN All-Reduce\nL11 EP0 TP Group 0 PP1 DP0\nGPU4" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L11_EP0TP0PP1DP0_GPU4 [label="Residual Add 2\nL11_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L11_EP0TP0PP1DP1_GPU5 [label="Layer Norm 1\nL11_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L11_EP0TP0PP1DP1_GPU5 [label="QKV Projection\nL11_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L11_EP0TP0PP1DP1_GPU5 [label="Multi-Head Attention\nL11_EP0TP0PP1DP1_GPU5\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L11_EP0TP0PP1DP1_GPU5 [label="Attention Output Proj\nL11_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L11_EP0TP0PP1DP1_GPU5 [label="Attention All-Reduce\nL11 EP0 TP Group 0 PP1 DP1\nGPU5" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L11_EP0TP0PP1DP1_GPU5 [label="Residual Add 1\nL11_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L11_EP0TP0PP1DP1_GPU5 [label="Layer Norm 2\nL11_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L11_EP0TP0PP1DP1_GPU5 [label="MoE Gate (Routing)\nL11_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L11_EP0TP0PP1DP1_GPU5 [label="Expert Dispatch\nL11_EP0TP0PP1DP1_GPU5" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L11_EP0TP0PP1DP1_GPU5 [label="Expert 0\nL11_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L11_EP0TP0PP1DP1_GPU5 [label="Expert 1\nL11_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L11_EP0TP0PP1DP1_GPU5 [label="Expert 2\nL11_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L11_EP0TP0PP1DP1_GPU5 [label="Expert 3\nL11_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L11_EP0TP0PP1DP1_GPU5 [label="Expert Combine\nL11_EP0TP0PP1DP1_GPU5" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L11_EP0TP0PP1DP1_GPU5 [label="FFN (Up-proj + GeLU + Down-proj)\nL11_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L11_EP0TP0PP1DP1_GPU5 [label="FFN All-Reduce\nL11 EP0 TP Group 0 PP1 DP1\nGPU5" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L11_EP0TP0PP1DP1_GPU5 [label="Residual Add 2\nL11_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L11_EP0TP1PP1DP0_GPU12 [label="Layer Norm 1\nL11_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L11_EP0TP1PP1DP0_GPU12 [label="QKV Projection\nL11_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L11_EP0TP1PP1DP0_GPU12 [label="Multi-Head Attention\nL11_EP0TP1PP1DP0_GPU12\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L11_EP0TP1PP1DP0_GPU12 [label="Attention Output Proj\nL11_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L11_EP0TP1PP1DP0_GPU12 [label="Attention All-Reduce\nL11 EP0 TP Group 1 PP1 DP0\nGPU12" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L11_EP0TP1PP1DP0_GPU12 [label="Residual Add 1\nL11_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L11_EP0TP1PP1DP0_GPU12 [label="Layer Norm 2\nL11_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L11_EP0TP1PP1DP0_GPU12 [label="MoE Gate (Routing)\nL11_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L11_EP0TP1PP1DP0_GPU12 [label="Expert Dispatch\nL11_EP0TP1PP1DP0_GPU12" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L11_EP0TP1PP1DP0_GPU12 [label="Expert 0\nL11_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L11_EP0TP1PP1DP0_GPU12 [label="Expert 1\nL11_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L11_EP0TP1PP1DP0_GPU12 [label="Expert 2\nL11_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L11_EP0TP1PP1DP0_GPU12 [label="Expert 3\nL11_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L11_EP0TP1PP1DP0_GPU12 [label="Expert Combine\nL11_EP0TP1PP1DP0_GPU12" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L11_EP0TP1PP1DP0_GPU12 [label="FFN (Up-proj + GeLU + Down-proj)\nL11_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L11_EP0TP1PP1DP0_GPU12 [label="FFN All-Reduce\nL11 EP0 TP Group 1 PP1 DP0\nGPU12" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L11_EP0TP1PP1DP0_GPU12 [label="Residual Add 2\nL11_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L11_EP0TP1PP1DP1_GPU13 [label="Layer Norm 1\nL11_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L11_EP0TP1PP1DP1_GPU13 [label="QKV Projection\nL11_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L11_EP0TP1PP1DP1_GPU13 [label="Multi-Head Attention\nL11_EP0TP1PP1DP1_GPU13\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L11_EP0TP1PP1DP1_GPU13 [label="Attention Output Proj\nL11_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L11_EP0TP1PP1DP1_GPU13 [label="Attention All-Reduce\nL11 EP0 TP Group 1 PP1 DP1\nGPU13" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L11_EP0TP1PP1DP1_GPU13 [label="Residual Add 1\nL11_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L11_EP0TP1PP1DP1_GPU13 [label="Layer Norm 2\nL11_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L11_EP0TP1PP1DP1_GPU13 [label="MoE Gate (Routing)\nL11_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L11_EP0TP1PP1DP1_GPU13 [label="Expert Dispatch\nL11_EP0TP1PP1DP1_GPU13" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L11_EP0TP1PP1DP1_GPU13 [label="Expert 0\nL11_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L11_EP0TP1PP1DP1_GPU13 [label="Expert 1\nL11_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L11_EP0TP1PP1DP1_GPU13 [label="Expert 2\nL11_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L11_EP0TP1PP1DP1_GPU13 [label="Expert 3\nL11_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L11_EP0TP1PP1DP1_GPU13 [label="Expert Combine\nL11_EP0TP1PP1DP1_GPU13" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L11_EP0TP1PP1DP1_GPU13 [label="FFN (Up-proj + GeLU + Down-proj)\nL11_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L11_EP0TP1PP1DP1_GPU13 [label="FFN All-Reduce\nL11 EP0 TP Group 1 PP1 DP1\nGPU13" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L11_EP0TP1PP1DP1_GPU13 [label="Residual Add 2\nL11_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L11_EP0TP2PP1DP0_GPU20 [label="Layer Norm 1\nL11_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L11_EP0TP2PP1DP0_GPU20 [label="QKV Projection\nL11_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L11_EP0TP2PP1DP0_GPU20 [label="Multi-Head Attention\nL11_EP0TP2PP1DP0_GPU20\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L11_EP0TP2PP1DP0_GPU20 [label="Attention Output Proj\nL11_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L11_EP0TP2PP1DP0_GPU20 [label="Attention All-Reduce\nL11 EP0 TP Group 2 PP1 DP0\nGPU20" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L11_EP0TP2PP1DP0_GPU20 [label="Residual Add 1\nL11_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L11_EP0TP2PP1DP0_GPU20 [label="Layer Norm 2\nL11_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L11_EP0TP2PP1DP0_GPU20 [label="MoE Gate (Routing)\nL11_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L11_EP0TP2PP1DP0_GPU20 [label="Expert Dispatch\nL11_EP0TP2PP1DP0_GPU20" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L11_EP0TP2PP1DP0_GPU20 [label="Expert 0\nL11_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L11_EP0TP2PP1DP0_GPU20 [label="Expert 1\nL11_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L11_EP0TP2PP1DP0_GPU20 [label="Expert 2\nL11_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L11_EP0TP2PP1DP0_GPU20 [label="Expert 3\nL11_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L11_EP0TP2PP1DP0_GPU20 [label="Expert Combine\nL11_EP0TP2PP1DP0_GPU20" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L11_EP0TP2PP1DP0_GPU20 [label="FFN (Up-proj + GeLU + Down-proj)\nL11_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L11_EP0TP2PP1DP0_GPU20 [label="FFN All-Reduce\nL11 EP0 TP Group 2 PP1 DP0\nGPU20" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L11_EP0TP2PP1DP0_GPU20 [label="Residual Add 2\nL11_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L11_EP0TP2PP1DP1_GPU21 [label="Layer Norm 1\nL11_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L11_EP0TP2PP1DP1_GPU21 [label="QKV Projection\nL11_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L11_EP0TP2PP1DP1_GPU21 [label="Multi-Head Attention\nL11_EP0TP2PP1DP1_GPU21\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L11_EP0TP2PP1DP1_GPU21 [label="Attention Output Proj\nL11_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L11_EP0TP2PP1DP1_GPU21 [label="Attention All-Reduce\nL11 EP0 TP Group 2 PP1 DP1\nGPU21" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L11_EP0TP2PP1DP1_GPU21 [label="Residual Add 1\nL11_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L11_EP0TP2PP1DP1_GPU21 [label="Layer Norm 2\nL11_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L11_EP0TP2PP1DP1_GPU21 [label="MoE Gate (Routing)\nL11_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L11_EP0TP2PP1DP1_GPU21 [label="Expert Dispatch\nL11_EP0TP2PP1DP1_GPU21" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L11_EP0TP2PP1DP1_GPU21 [label="Expert 0\nL11_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L11_EP0TP2PP1DP1_GPU21 [label="Expert 1\nL11_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L11_EP0TP2PP1DP1_GPU21 [label="Expert 2\nL11_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L11_EP0TP2PP1DP1_GPU21 [label="Expert 3\nL11_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L11_EP0TP2PP1DP1_GPU21 [label="Expert Combine\nL11_EP0TP2PP1DP1_GPU21" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L11_EP0TP2PP1DP1_GPU21 [label="FFN (Up-proj + GeLU + Down-proj)\nL11_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L11_EP0TP2PP1DP1_GPU21 [label="FFN All-Reduce\nL11 EP0 TP Group 2 PP1 DP1\nGPU21" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L11_EP0TP2PP1DP1_GPU21 [label="Residual Add 2\nL11_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L11_EP0TP3PP1DP0_GPU28 [label="Layer Norm 1\nL11_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L11_EP0TP3PP1DP0_GPU28 [label="QKV Projection\nL11_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L11_EP0TP3PP1DP0_GPU28 [label="Multi-Head Attention\nL11_EP0TP3PP1DP0_GPU28\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L11_EP0TP3PP1DP0_GPU28 [label="Attention Output Proj\nL11_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L11_EP0TP3PP1DP0_GPU28 [label="Attention All-Reduce\nL11 EP0 TP Group 3 PP1 DP0\nGPU28" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L11_EP0TP3PP1DP0_GPU28 [label="Residual Add 1\nL11_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L11_EP0TP3PP1DP0_GPU28 [label="Layer Norm 2\nL11_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L11_EP0TP3PP1DP0_GPU28 [label="MoE Gate (Routing)\nL11_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L11_EP0TP3PP1DP0_GPU28 [label="Expert Dispatch\nL11_EP0TP3PP1DP0_GPU28" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L11_EP0TP3PP1DP0_GPU28 [label="Expert 0\nL11_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L11_EP0TP3PP1DP0_GPU28 [label="Expert 1\nL11_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L11_EP0TP3PP1DP0_GPU28 [label="Expert 2\nL11_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L11_EP0TP3PP1DP0_GPU28 [label="Expert 3\nL11_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L11_EP0TP3PP1DP0_GPU28 [label="Expert Combine\nL11_EP0TP3PP1DP0_GPU28" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L11_EP0TP3PP1DP0_GPU28 [label="FFN (Up-proj + GeLU + Down-proj)\nL11_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L11_EP0TP3PP1DP0_GPU28 [label="FFN All-Reduce\nL11 EP0 TP Group 3 PP1 DP0\nGPU28" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L11_EP0TP3PP1DP0_GPU28 [label="Residual Add 2\nL11_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L11_EP0TP3PP1DP1_GPU29 [label="Layer Norm 1\nL11_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L11_EP0TP3PP1DP1_GPU29 [label="QKV Projection\nL11_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L11_EP0TP3PP1DP1_GPU29 [label="Multi-Head Attention\nL11_EP0TP3PP1DP1_GPU29\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L11_EP0TP3PP1DP1_GPU29 [label="Attention Output Proj\nL11_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L11_EP0TP3PP1DP1_GPU29 [label="Attention All-Reduce\nL11 EP0 TP Group 3 PP1 DP1\nGPU29" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L11_EP0TP3PP1DP1_GPU29 [label="Residual Add 1\nL11_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L11_EP0TP3PP1DP1_GPU29 [label="Layer Norm 2\nL11_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L11_EP0TP3PP1DP1_GPU29 [label="MoE Gate (Routing)\nL11_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L11_EP0TP3PP1DP1_GPU29 [label="Expert Dispatch\nL11_EP0TP3PP1DP1_GPU29" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L11_EP0TP3PP1DP1_GPU29 [label="Expert 0\nL11_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L11_EP0TP3PP1DP1_GPU29 [label="Expert 1\nL11_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L11_EP0TP3PP1DP1_GPU29 [label="Expert 2\nL11_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L11_EP0TP3PP1DP1_GPU29 [label="Expert 3\nL11_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L11_EP0TP3PP1DP1_GPU29 [label="Expert Combine\nL11_EP0TP3PP1DP1_GPU29" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L11_EP0TP3PP1DP1_GPU29 [label="FFN (Up-proj + GeLU + Down-proj)\nL11_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L11_EP0TP3PP1DP1_GPU29 [label="FFN All-Reduce\nL11 EP0 TP Group 3 PP1 DP1\nGPU29" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L11_EP0TP3PP1DP1_GPU29 [label="Residual Add 2\nL11_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L11_EP1TP0PP1DP0_GPU36 [label="Layer Norm 1\nL11_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L11_EP1TP0PP1DP0_GPU36 [label="QKV Projection\nL11_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L11_EP1TP0PP1DP0_GPU36 [label="Multi-Head Attention\nL11_EP1TP0PP1DP0_GPU36\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L11_EP1TP0PP1DP0_GPU36 [label="Attention Output Proj\nL11_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L11_EP1TP0PP1DP0_GPU36 [label="Attention All-Reduce\nL11 EP1 TP Group 0 PP1 DP0\nGPU36" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L11_EP1TP0PP1DP0_GPU36 [label="Residual Add 1\nL11_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L11_EP1TP0PP1DP0_GPU36 [label="Layer Norm 2\nL11_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L11_EP1TP0PP1DP0_GPU36 [label="MoE Gate (Routing)\nL11_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L11_EP1TP0PP1DP0_GPU36 [label="Expert Dispatch\nL11_EP1TP0PP1DP0_GPU36" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L11_EP1TP0PP1DP0_GPU36 [label="Expert 0\nL11_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L11_EP1TP0PP1DP0_GPU36 [label="Expert 1\nL11_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L11_EP1TP0PP1DP0_GPU36 [label="Expert 2\nL11_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L11_EP1TP0PP1DP0_GPU36 [label="Expert 3\nL11_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L11_EP1TP0PP1DP0_GPU36 [label="Expert Combine\nL11_EP1TP0PP1DP0_GPU36" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L11_EP1TP0PP1DP0_GPU36 [label="FFN (Up-proj + GeLU + Down-proj)\nL11_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L11_EP1TP0PP1DP0_GPU36 [label="FFN All-Reduce\nL11 EP1 TP Group 0 PP1 DP0\nGPU36" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L11_EP1TP0PP1DP0_GPU36 [label="Residual Add 2\nL11_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L11_EP1TP0PP1DP1_GPU37 [label="Layer Norm 1\nL11_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L11_EP1TP0PP1DP1_GPU37 [label="QKV Projection\nL11_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L11_EP1TP0PP1DP1_GPU37 [label="Multi-Head Attention\nL11_EP1TP0PP1DP1_GPU37\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L11_EP1TP0PP1DP1_GPU37 [label="Attention Output Proj\nL11_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L11_EP1TP0PP1DP1_GPU37 [label="Attention All-Reduce\nL11 EP1 TP Group 0 PP1 DP1\nGPU37" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L11_EP1TP0PP1DP1_GPU37 [label="Residual Add 1\nL11_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L11_EP1TP0PP1DP1_GPU37 [label="Layer Norm 2\nL11_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L11_EP1TP0PP1DP1_GPU37 [label="MoE Gate (Routing)\nL11_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L11_EP1TP0PP1DP1_GPU37 [label="Expert Dispatch\nL11_EP1TP0PP1DP1_GPU37" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L11_EP1TP0PP1DP1_GPU37 [label="Expert 0\nL11_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L11_EP1TP0PP1DP1_GPU37 [label="Expert 1\nL11_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L11_EP1TP0PP1DP1_GPU37 [label="Expert 2\nL11_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L11_EP1TP0PP1DP1_GPU37 [label="Expert 3\nL11_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L11_EP1TP0PP1DP1_GPU37 [label="Expert Combine\nL11_EP1TP0PP1DP1_GPU37" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L11_EP1TP0PP1DP1_GPU37 [label="FFN (Up-proj + GeLU + Down-proj)\nL11_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L11_EP1TP0PP1DP1_GPU37 [label="FFN All-Reduce\nL11 EP1 TP Group 0 PP1 DP1\nGPU37" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L11_EP1TP0PP1DP1_GPU37 [label="Residual Add 2\nL11_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L11_EP1TP1PP1DP0_GPU44 [label="Layer Norm 1\nL11_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L11_EP1TP1PP1DP0_GPU44 [label="QKV Projection\nL11_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L11_EP1TP1PP1DP0_GPU44 [label="Multi-Head Attention\nL11_EP1TP1PP1DP0_GPU44\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L11_EP1TP1PP1DP0_GPU44 [label="Attention Output Proj\nL11_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L11_EP1TP1PP1DP0_GPU44 [label="Attention All-Reduce\nL11 EP1 TP Group 1 PP1 DP0\nGPU44" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L11_EP1TP1PP1DP0_GPU44 [label="Residual Add 1\nL11_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L11_EP1TP1PP1DP0_GPU44 [label="Layer Norm 2\nL11_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L11_EP1TP1PP1DP0_GPU44 [label="MoE Gate (Routing)\nL11_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L11_EP1TP1PP1DP0_GPU44 [label="Expert Dispatch\nL11_EP1TP1PP1DP0_GPU44" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L11_EP1TP1PP1DP0_GPU44 [label="Expert 0\nL11_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L11_EP1TP1PP1DP0_GPU44 [label="Expert 1\nL11_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L11_EP1TP1PP1DP0_GPU44 [label="Expert 2\nL11_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L11_EP1TP1PP1DP0_GPU44 [label="Expert 3\nL11_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L11_EP1TP1PP1DP0_GPU44 [label="Expert Combine\nL11_EP1TP1PP1DP0_GPU44" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L11_EP1TP1PP1DP0_GPU44 [label="FFN (Up-proj + GeLU + Down-proj)\nL11_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L11_EP1TP1PP1DP0_GPU44 [label="FFN All-Reduce\nL11 EP1 TP Group 1 PP1 DP0\nGPU44" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L11_EP1TP1PP1DP0_GPU44 [label="Residual Add 2\nL11_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L11_EP1TP1PP1DP1_GPU45 [label="Layer Norm 1\nL11_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L11_EP1TP1PP1DP1_GPU45 [label="QKV Projection\nL11_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L11_EP1TP1PP1DP1_GPU45 [label="Multi-Head Attention\nL11_EP1TP1PP1DP1_GPU45\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L11_EP1TP1PP1DP1_GPU45 [label="Attention Output Proj\nL11_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L11_EP1TP1PP1DP1_GPU45 [label="Attention All-Reduce\nL11 EP1 TP Group 1 PP1 DP1\nGPU45" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L11_EP1TP1PP1DP1_GPU45 [label="Residual Add 1\nL11_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L11_EP1TP1PP1DP1_GPU45 [label="Layer Norm 2\nL11_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L11_EP1TP1PP1DP1_GPU45 [label="MoE Gate (Routing)\nL11_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L11_EP1TP1PP1DP1_GPU45 [label="Expert Dispatch\nL11_EP1TP1PP1DP1_GPU45" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L11_EP1TP1PP1DP1_GPU45 [label="Expert 0\nL11_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L11_EP1TP1PP1DP1_GPU45 [label="Expert 1\nL11_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L11_EP1TP1PP1DP1_GPU45 [label="Expert 2\nL11_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L11_EP1TP1PP1DP1_GPU45 [label="Expert 3\nL11_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L11_EP1TP1PP1DP1_GPU45 [label="Expert Combine\nL11_EP1TP1PP1DP1_GPU45" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L11_EP1TP1PP1DP1_GPU45 [label="FFN (Up-proj + GeLU + Down-proj)\nL11_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L11_EP1TP1PP1DP1_GPU45 [label="FFN All-Reduce\nL11 EP1 TP Group 1 PP1 DP1\nGPU45" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L11_EP1TP1PP1DP1_GPU45 [label="Residual Add 2\nL11_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L11_EP1TP2PP1DP0_GPU52 [label="Layer Norm 1\nL11_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L11_EP1TP2PP1DP0_GPU52 [label="QKV Projection\nL11_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L11_EP1TP2PP1DP0_GPU52 [label="Multi-Head Attention\nL11_EP1TP2PP1DP0_GPU52\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L11_EP1TP2PP1DP0_GPU52 [label="Attention Output Proj\nL11_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L11_EP1TP2PP1DP0_GPU52 [label="Attention All-Reduce\nL11 EP1 TP Group 2 PP1 DP0\nGPU52" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L11_EP1TP2PP1DP0_GPU52 [label="Residual Add 1\nL11_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L11_EP1TP2PP1DP0_GPU52 [label="Layer Norm 2\nL11_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L11_EP1TP2PP1DP0_GPU52 [label="MoE Gate (Routing)\nL11_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L11_EP1TP2PP1DP0_GPU52 [label="Expert Dispatch\nL11_EP1TP2PP1DP0_GPU52" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L11_EP1TP2PP1DP0_GPU52 [label="Expert 0\nL11_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L11_EP1TP2PP1DP0_GPU52 [label="Expert 1\nL11_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L11_EP1TP2PP1DP0_GPU52 [label="Expert 2\nL11_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L11_EP1TP2PP1DP0_GPU52 [label="Expert 3\nL11_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L11_EP1TP2PP1DP0_GPU52 [label="Expert Combine\nL11_EP1TP2PP1DP0_GPU52" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L11_EP1TP2PP1DP0_GPU52 [label="FFN (Up-proj + GeLU + Down-proj)\nL11_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L11_EP1TP2PP1DP0_GPU52 [label="FFN All-Reduce\nL11 EP1 TP Group 2 PP1 DP0\nGPU52" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L11_EP1TP2PP1DP0_GPU52 [label="Residual Add 2\nL11_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L11_EP1TP2PP1DP1_GPU53 [label="Layer Norm 1\nL11_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L11_EP1TP2PP1DP1_GPU53 [label="QKV Projection\nL11_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L11_EP1TP2PP1DP1_GPU53 [label="Multi-Head Attention\nL11_EP1TP2PP1DP1_GPU53\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L11_EP1TP2PP1DP1_GPU53 [label="Attention Output Proj\nL11_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L11_EP1TP2PP1DP1_GPU53 [label="Attention All-Reduce\nL11 EP1 TP Group 2 PP1 DP1\nGPU53" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L11_EP1TP2PP1DP1_GPU53 [label="Residual Add 1\nL11_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L11_EP1TP2PP1DP1_GPU53 [label="Layer Norm 2\nL11_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L11_EP1TP2PP1DP1_GPU53 [label="MoE Gate (Routing)\nL11_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L11_EP1TP2PP1DP1_GPU53 [label="Expert Dispatch\nL11_EP1TP2PP1DP1_GPU53" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L11_EP1TP2PP1DP1_GPU53 [label="Expert 0\nL11_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L11_EP1TP2PP1DP1_GPU53 [label="Expert 1\nL11_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L11_EP1TP2PP1DP1_GPU53 [label="Expert 2\nL11_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L11_EP1TP2PP1DP1_GPU53 [label="Expert 3\nL11_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L11_EP1TP2PP1DP1_GPU53 [label="Expert Combine\nL11_EP1TP2PP1DP1_GPU53" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L11_EP1TP2PP1DP1_GPU53 [label="FFN (Up-proj + GeLU + Down-proj)\nL11_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L11_EP1TP2PP1DP1_GPU53 [label="FFN All-Reduce\nL11 EP1 TP Group 2 PP1 DP1\nGPU53" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L11_EP1TP2PP1DP1_GPU53 [label="Residual Add 2\nL11_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L11_EP1TP3PP1DP0_GPU60 [label="Layer Norm 1\nL11_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L11_EP1TP3PP1DP0_GPU60 [label="QKV Projection\nL11_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L11_EP1TP3PP1DP0_GPU60 [label="Multi-Head Attention\nL11_EP1TP3PP1DP0_GPU60\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L11_EP1TP3PP1DP0_GPU60 [label="Attention Output Proj\nL11_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L11_EP1TP3PP1DP0_GPU60 [label="Attention All-Reduce\nL11 EP1 TP Group 3 PP1 DP0\nGPU60" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L11_EP1TP3PP1DP0_GPU60 [label="Residual Add 1\nL11_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L11_EP1TP3PP1DP0_GPU60 [label="Layer Norm 2\nL11_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L11_EP1TP3PP1DP0_GPU60 [label="MoE Gate (Routing)\nL11_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L11_EP1TP3PP1DP0_GPU60 [label="Expert Dispatch\nL11_EP1TP3PP1DP0_GPU60" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L11_EP1TP3PP1DP0_GPU60 [label="Expert 0\nL11_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L11_EP1TP3PP1DP0_GPU60 [label="Expert 1\nL11_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L11_EP1TP3PP1DP0_GPU60 [label="Expert 2\nL11_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L11_EP1TP3PP1DP0_GPU60 [label="Expert 3\nL11_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L11_EP1TP3PP1DP0_GPU60 [label="Expert Combine\nL11_EP1TP3PP1DP0_GPU60" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L11_EP1TP3PP1DP0_GPU60 [label="FFN (Up-proj + GeLU + Down-proj)\nL11_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L11_EP1TP3PP1DP0_GPU60 [label="FFN All-Reduce\nL11 EP1 TP Group 3 PP1 DP0\nGPU60" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L11_EP1TP3PP1DP0_GPU60 [label="Residual Add 2\nL11_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L11_EP1TP3PP1DP1_GPU61 [label="Layer Norm 1\nL11_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L11_EP1TP3PP1DP1_GPU61 [label="QKV Projection\nL11_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L11_EP1TP3PP1DP1_GPU61 [label="Multi-Head Attention\nL11_EP1TP3PP1DP1_GPU61\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L11_EP1TP3PP1DP1_GPU61 [label="Attention Output Proj\nL11_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L11_EP1TP3PP1DP1_GPU61 [label="Attention All-Reduce\nL11 EP1 TP Group 3 PP1 DP1\nGPU61" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L11_EP1TP3PP1DP1_GPU61 [label="Residual Add 1\nL11_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L11_EP1TP3PP1DP1_GPU61 [label="Layer Norm 2\nL11_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L11_EP1TP3PP1DP1_GPU61 [label="MoE Gate (Routing)\nL11_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L11_EP1TP3PP1DP1_GPU61 [label="Expert Dispatch\nL11_EP1TP3PP1DP1_GPU61" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L11_EP1TP3PP1DP1_GPU61 [label="Expert 0\nL11_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L11_EP1TP3PP1DP1_GPU61 [label="Expert 1\nL11_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L11_EP1TP3PP1DP1_GPU61 [label="Expert 2\nL11_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L11_EP1TP3PP1DP1_GPU61 [label="Expert 3\nL11_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L11_EP1TP3PP1DP1_GPU61 [label="Expert Combine\nL11_EP1TP3PP1DP1_GPU61" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L11_EP1TP3PP1DP1_GPU61 [label="FFN (Up-proj + GeLU + Down-proj)\nL11_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L11_EP1TP3PP1DP1_GPU61 [label="FFN All-Reduce\nL11 EP1 TP Group 3 PP1 DP1\nGPU61" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L11_EP1TP3PP1DP1_GPU61 [label="Residual Add 2\nL11_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L12_EP0TP0PP1DP0_GPU4 [label="Layer Norm 1\nL12_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L12_EP0TP0PP1DP0_GPU4 [label="QKV Projection\nL12_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L12_EP0TP0PP1DP0_GPU4 [label="Multi-Head Attention\nL12_EP0TP0PP1DP0_GPU4\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L12_EP0TP0PP1DP0_GPU4 [label="Attention Output Proj\nL12_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L12_EP0TP0PP1DP0_GPU4 [label="Attention All-Reduce\nL12 EP0 TP Group 0 PP1 DP0\nGPU4" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L12_EP0TP0PP1DP0_GPU4 [label="Residual Add 1\nL12_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L12_EP0TP0PP1DP0_GPU4 [label="Layer Norm 2\nL12_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L12_EP0TP0PP1DP0_GPU4 [label="MoE Gate (Routing)\nL12_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L12_EP0TP0PP1DP0_GPU4 [label="Expert Dispatch\nL12_EP0TP0PP1DP0_GPU4" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L12_EP0TP0PP1DP0_GPU4 [label="Expert 0\nL12_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L12_EP0TP0PP1DP0_GPU4 [label="Expert 1\nL12_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L12_EP0TP0PP1DP0_GPU4 [label="Expert 2\nL12_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L12_EP0TP0PP1DP0_GPU4 [label="Expert 3\nL12_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L12_EP0TP0PP1DP0_GPU4 [label="Expert Combine\nL12_EP0TP0PP1DP0_GPU4" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L12_EP0TP0PP1DP0_GPU4 [label="FFN (Up-proj + GeLU + Down-proj)\nL12_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L12_EP0TP0PP1DP0_GPU4 [label="FFN All-Reduce\nL12 EP0 TP Group 0 PP1 DP0\nGPU4" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L12_EP0TP0PP1DP0_GPU4 [label="Residual Add 2\nL12_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L12_EP0TP0PP1DP1_GPU5 [label="Layer Norm 1\nL12_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L12_EP0TP0PP1DP1_GPU5 [label="QKV Projection\nL12_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L12_EP0TP0PP1DP1_GPU5 [label="Multi-Head Attention\nL12_EP0TP0PP1DP1_GPU5\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L12_EP0TP0PP1DP1_GPU5 [label="Attention Output Proj\nL12_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L12_EP0TP0PP1DP1_GPU5 [label="Attention All-Reduce\nL12 EP0 TP Group 0 PP1 DP1\nGPU5" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L12_EP0TP0PP1DP1_GPU5 [label="Residual Add 1\nL12_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L12_EP0TP0PP1DP1_GPU5 [label="Layer Norm 2\nL12_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L12_EP0TP0PP1DP1_GPU5 [label="MoE Gate (Routing)\nL12_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L12_EP0TP0PP1DP1_GPU5 [label="Expert Dispatch\nL12_EP0TP0PP1DP1_GPU5" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L12_EP0TP0PP1DP1_GPU5 [label="Expert 0\nL12_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L12_EP0TP0PP1DP1_GPU5 [label="Expert 1\nL12_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L12_EP0TP0PP1DP1_GPU5 [label="Expert 2\nL12_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L12_EP0TP0PP1DP1_GPU5 [label="Expert 3\nL12_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L12_EP0TP0PP1DP1_GPU5 [label="Expert Combine\nL12_EP0TP0PP1DP1_GPU5" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L12_EP0TP0PP1DP1_GPU5 [label="FFN (Up-proj + GeLU + Down-proj)\nL12_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L12_EP0TP0PP1DP1_GPU5 [label="FFN All-Reduce\nL12 EP0 TP Group 0 PP1 DP1\nGPU5" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L12_EP0TP0PP1DP1_GPU5 [label="Residual Add 2\nL12_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L12_EP0TP1PP1DP0_GPU12 [label="Layer Norm 1\nL12_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L12_EP0TP1PP1DP0_GPU12 [label="QKV Projection\nL12_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L12_EP0TP1PP1DP0_GPU12 [label="Multi-Head Attention\nL12_EP0TP1PP1DP0_GPU12\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L12_EP0TP1PP1DP0_GPU12 [label="Attention Output Proj\nL12_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L12_EP0TP1PP1DP0_GPU12 [label="Attention All-Reduce\nL12 EP0 TP Group 1 PP1 DP0\nGPU12" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L12_EP0TP1PP1DP0_GPU12 [label="Residual Add 1\nL12_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L12_EP0TP1PP1DP0_GPU12 [label="Layer Norm 2\nL12_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L12_EP0TP1PP1DP0_GPU12 [label="MoE Gate (Routing)\nL12_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L12_EP0TP1PP1DP0_GPU12 [label="Expert Dispatch\nL12_EP0TP1PP1DP0_GPU12" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L12_EP0TP1PP1DP0_GPU12 [label="Expert 0\nL12_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L12_EP0TP1PP1DP0_GPU12 [label="Expert 1\nL12_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L12_EP0TP1PP1DP0_GPU12 [label="Expert 2\nL12_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L12_EP0TP1PP1DP0_GPU12 [label="Expert 3\nL12_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L12_EP0TP1PP1DP0_GPU12 [label="Expert Combine\nL12_EP0TP1PP1DP0_GPU12" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L12_EP0TP1PP1DP0_GPU12 [label="FFN (Up-proj + GeLU + Down-proj)\nL12_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L12_EP0TP1PP1DP0_GPU12 [label="FFN All-Reduce\nL12 EP0 TP Group 1 PP1 DP0\nGPU12" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L12_EP0TP1PP1DP0_GPU12 [label="Residual Add 2\nL12_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L12_EP0TP1PP1DP1_GPU13 [label="Layer Norm 1\nL12_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L12_EP0TP1PP1DP1_GPU13 [label="QKV Projection\nL12_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L12_EP0TP1PP1DP1_GPU13 [label="Multi-Head Attention\nL12_EP0TP1PP1DP1_GPU13\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L12_EP0TP1PP1DP1_GPU13 [label="Attention Output Proj\nL12_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L12_EP0TP1PP1DP1_GPU13 [label="Attention All-Reduce\nL12 EP0 TP Group 1 PP1 DP1\nGPU13" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L12_EP0TP1PP1DP1_GPU13 [label="Residual Add 1\nL12_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L12_EP0TP1PP1DP1_GPU13 [label="Layer Norm 2\nL12_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L12_EP0TP1PP1DP1_GPU13 [label="MoE Gate (Routing)\nL12_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L12_EP0TP1PP1DP1_GPU13 [label="Expert Dispatch\nL12_EP0TP1PP1DP1_GPU13" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L12_EP0TP1PP1DP1_GPU13 [label="Expert 0\nL12_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L12_EP0TP1PP1DP1_GPU13 [label="Expert 1\nL12_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L12_EP0TP1PP1DP1_GPU13 [label="Expert 2\nL12_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L12_EP0TP1PP1DP1_GPU13 [label="Expert 3\nL12_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L12_EP0TP1PP1DP1_GPU13 [label="Expert Combine\nL12_EP0TP1PP1DP1_GPU13" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L12_EP0TP1PP1DP1_GPU13 [label="FFN (Up-proj + GeLU + Down-proj)\nL12_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L12_EP0TP1PP1DP1_GPU13 [label="FFN All-Reduce\nL12 EP0 TP Group 1 PP1 DP1\nGPU13" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L12_EP0TP1PP1DP1_GPU13 [label="Residual Add 2\nL12_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L12_EP0TP2PP1DP0_GPU20 [label="Layer Norm 1\nL12_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L12_EP0TP2PP1DP0_GPU20 [label="QKV Projection\nL12_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L12_EP0TP2PP1DP0_GPU20 [label="Multi-Head Attention\nL12_EP0TP2PP1DP0_GPU20\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L12_EP0TP2PP1DP0_GPU20 [label="Attention Output Proj\nL12_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L12_EP0TP2PP1DP0_GPU20 [label="Attention All-Reduce\nL12 EP0 TP Group 2 PP1 DP0\nGPU20" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L12_EP0TP2PP1DP0_GPU20 [label="Residual Add 1\nL12_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L12_EP0TP2PP1DP0_GPU20 [label="Layer Norm 2\nL12_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L12_EP0TP2PP1DP0_GPU20 [label="MoE Gate (Routing)\nL12_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L12_EP0TP2PP1DP0_GPU20 [label="Expert Dispatch\nL12_EP0TP2PP1DP0_GPU20" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L12_EP0TP2PP1DP0_GPU20 [label="Expert 0\nL12_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L12_EP0TP2PP1DP0_GPU20 [label="Expert 1\nL12_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L12_EP0TP2PP1DP0_GPU20 [label="Expert 2\nL12_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L12_EP0TP2PP1DP0_GPU20 [label="Expert 3\nL12_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L12_EP0TP2PP1DP0_GPU20 [label="Expert Combine\nL12_EP0TP2PP1DP0_GPU20" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L12_EP0TP2PP1DP0_GPU20 [label="FFN (Up-proj + GeLU + Down-proj)\nL12_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L12_EP0TP2PP1DP0_GPU20 [label="FFN All-Reduce\nL12 EP0 TP Group 2 PP1 DP0\nGPU20" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L12_EP0TP2PP1DP0_GPU20 [label="Residual Add 2\nL12_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L12_EP0TP2PP1DP1_GPU21 [label="Layer Norm 1\nL12_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L12_EP0TP2PP1DP1_GPU21 [label="QKV Projection\nL12_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L12_EP0TP2PP1DP1_GPU21 [label="Multi-Head Attention\nL12_EP0TP2PP1DP1_GPU21\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L12_EP0TP2PP1DP1_GPU21 [label="Attention Output Proj\nL12_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L12_EP0TP2PP1DP1_GPU21 [label="Attention All-Reduce\nL12 EP0 TP Group 2 PP1 DP1\nGPU21" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L12_EP0TP2PP1DP1_GPU21 [label="Residual Add 1\nL12_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L12_EP0TP2PP1DP1_GPU21 [label="Layer Norm 2\nL12_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L12_EP0TP2PP1DP1_GPU21 [label="MoE Gate (Routing)\nL12_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L12_EP0TP2PP1DP1_GPU21 [label="Expert Dispatch\nL12_EP0TP2PP1DP1_GPU21" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L12_EP0TP2PP1DP1_GPU21 [label="Expert 0\nL12_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L12_EP0TP2PP1DP1_GPU21 [label="Expert 1\nL12_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L12_EP0TP2PP1DP1_GPU21 [label="Expert 2\nL12_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L12_EP0TP2PP1DP1_GPU21 [label="Expert 3\nL12_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L12_EP0TP2PP1DP1_GPU21 [label="Expert Combine\nL12_EP0TP2PP1DP1_GPU21" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L12_EP0TP2PP1DP1_GPU21 [label="FFN (Up-proj + GeLU + Down-proj)\nL12_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L12_EP0TP2PP1DP1_GPU21 [label="FFN All-Reduce\nL12 EP0 TP Group 2 PP1 DP1\nGPU21" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L12_EP0TP2PP1DP1_GPU21 [label="Residual Add 2\nL12_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L12_EP0TP3PP1DP0_GPU28 [label="Layer Norm 1\nL12_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L12_EP0TP3PP1DP0_GPU28 [label="QKV Projection\nL12_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L12_EP0TP3PP1DP0_GPU28 [label="Multi-Head Attention\nL12_EP0TP3PP1DP0_GPU28\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L12_EP0TP3PP1DP0_GPU28 [label="Attention Output Proj\nL12_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L12_EP0TP3PP1DP0_GPU28 [label="Attention All-Reduce\nL12 EP0 TP Group 3 PP1 DP0\nGPU28" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L12_EP0TP3PP1DP0_GPU28 [label="Residual Add 1\nL12_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L12_EP0TP3PP1DP0_GPU28 [label="Layer Norm 2\nL12_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L12_EP0TP3PP1DP0_GPU28 [label="MoE Gate (Routing)\nL12_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L12_EP0TP3PP1DP0_GPU28 [label="Expert Dispatch\nL12_EP0TP3PP1DP0_GPU28" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L12_EP0TP3PP1DP0_GPU28 [label="Expert 0\nL12_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L12_EP0TP3PP1DP0_GPU28 [label="Expert 1\nL12_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L12_EP0TP3PP1DP0_GPU28 [label="Expert 2\nL12_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L12_EP0TP3PP1DP0_GPU28 [label="Expert 3\nL12_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L12_EP0TP3PP1DP0_GPU28 [label="Expert Combine\nL12_EP0TP3PP1DP0_GPU28" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L12_EP0TP3PP1DP0_GPU28 [label="FFN (Up-proj + GeLU + Down-proj)\nL12_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L12_EP0TP3PP1DP0_GPU28 [label="FFN All-Reduce\nL12 EP0 TP Group 3 PP1 DP0\nGPU28" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L12_EP0TP3PP1DP0_GPU28 [label="Residual Add 2\nL12_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L12_EP0TP3PP1DP1_GPU29 [label="Layer Norm 1\nL12_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L12_EP0TP3PP1DP1_GPU29 [label="QKV Projection\nL12_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L12_EP0TP3PP1DP1_GPU29 [label="Multi-Head Attention\nL12_EP0TP3PP1DP1_GPU29\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L12_EP0TP3PP1DP1_GPU29 [label="Attention Output Proj\nL12_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L12_EP0TP3PP1DP1_GPU29 [label="Attention All-Reduce\nL12 EP0 TP Group 3 PP1 DP1\nGPU29" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L12_EP0TP3PP1DP1_GPU29 [label="Residual Add 1\nL12_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L12_EP0TP3PP1DP1_GPU29 [label="Layer Norm 2\nL12_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L12_EP0TP3PP1DP1_GPU29 [label="MoE Gate (Routing)\nL12_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L12_EP0TP3PP1DP1_GPU29 [label="Expert Dispatch\nL12_EP0TP3PP1DP1_GPU29" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L12_EP0TP3PP1DP1_GPU29 [label="Expert 0\nL12_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L12_EP0TP3PP1DP1_GPU29 [label="Expert 1\nL12_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L12_EP0TP3PP1DP1_GPU29 [label="Expert 2\nL12_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L12_EP0TP3PP1DP1_GPU29 [label="Expert 3\nL12_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L12_EP0TP3PP1DP1_GPU29 [label="Expert Combine\nL12_EP0TP3PP1DP1_GPU29" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L12_EP0TP3PP1DP1_GPU29 [label="FFN (Up-proj + GeLU + Down-proj)\nL12_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L12_EP0TP3PP1DP1_GPU29 [label="FFN All-Reduce\nL12 EP0 TP Group 3 PP1 DP1\nGPU29" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L12_EP0TP3PP1DP1_GPU29 [label="Residual Add 2\nL12_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L12_EP1TP0PP1DP0_GPU36 [label="Layer Norm 1\nL12_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L12_EP1TP0PP1DP0_GPU36 [label="QKV Projection\nL12_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L12_EP1TP0PP1DP0_GPU36 [label="Multi-Head Attention\nL12_EP1TP0PP1DP0_GPU36\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L12_EP1TP0PP1DP0_GPU36 [label="Attention Output Proj\nL12_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L12_EP1TP0PP1DP0_GPU36 [label="Attention All-Reduce\nL12 EP1 TP Group 0 PP1 DP0\nGPU36" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L12_EP1TP0PP1DP0_GPU36 [label="Residual Add 1\nL12_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L12_EP1TP0PP1DP0_GPU36 [label="Layer Norm 2\nL12_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L12_EP1TP0PP1DP0_GPU36 [label="MoE Gate (Routing)\nL12_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L12_EP1TP0PP1DP0_GPU36 [label="Expert Dispatch\nL12_EP1TP0PP1DP0_GPU36" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L12_EP1TP0PP1DP0_GPU36 [label="Expert 0\nL12_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L12_EP1TP0PP1DP0_GPU36 [label="Expert 1\nL12_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L12_EP1TP0PP1DP0_GPU36 [label="Expert 2\nL12_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L12_EP1TP0PP1DP0_GPU36 [label="Expert 3\nL12_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L12_EP1TP0PP1DP0_GPU36 [label="Expert Combine\nL12_EP1TP0PP1DP0_GPU36" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L12_EP1TP0PP1DP0_GPU36 [label="FFN (Up-proj + GeLU + Down-proj)\nL12_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L12_EP1TP0PP1DP0_GPU36 [label="FFN All-Reduce\nL12 EP1 TP Group 0 PP1 DP0\nGPU36" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L12_EP1TP0PP1DP0_GPU36 [label="Residual Add 2\nL12_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L12_EP1TP0PP1DP1_GPU37 [label="Layer Norm 1\nL12_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L12_EP1TP0PP1DP1_GPU37 [label="QKV Projection\nL12_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L12_EP1TP0PP1DP1_GPU37 [label="Multi-Head Attention\nL12_EP1TP0PP1DP1_GPU37\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L12_EP1TP0PP1DP1_GPU37 [label="Attention Output Proj\nL12_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L12_EP1TP0PP1DP1_GPU37 [label="Attention All-Reduce\nL12 EP1 TP Group 0 PP1 DP1\nGPU37" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L12_EP1TP0PP1DP1_GPU37 [label="Residual Add 1\nL12_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L12_EP1TP0PP1DP1_GPU37 [label="Layer Norm 2\nL12_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L12_EP1TP0PP1DP1_GPU37 [label="MoE Gate (Routing)\nL12_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L12_EP1TP0PP1DP1_GPU37 [label="Expert Dispatch\nL12_EP1TP0PP1DP1_GPU37" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L12_EP1TP0PP1DP1_GPU37 [label="Expert 0\nL12_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L12_EP1TP0PP1DP1_GPU37 [label="Expert 1\nL12_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L12_EP1TP0PP1DP1_GPU37 [label="Expert 2\nL12_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L12_EP1TP0PP1DP1_GPU37 [label="Expert 3\nL12_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L12_EP1TP0PP1DP1_GPU37 [label="Expert Combine\nL12_EP1TP0PP1DP1_GPU37" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L12_EP1TP0PP1DP1_GPU37 [label="FFN (Up-proj + GeLU + Down-proj)\nL12_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L12_EP1TP0PP1DP1_GPU37 [label="FFN All-Reduce\nL12 EP1 TP Group 0 PP1 DP1\nGPU37" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L12_EP1TP0PP1DP1_GPU37 [label="Residual Add 2\nL12_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L12_EP1TP1PP1DP0_GPU44 [label="Layer Norm 1\nL12_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L12_EP1TP1PP1DP0_GPU44 [label="QKV Projection\nL12_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L12_EP1TP1PP1DP0_GPU44 [label="Multi-Head Attention\nL12_EP1TP1PP1DP0_GPU44\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L12_EP1TP1PP1DP0_GPU44 [label="Attention Output Proj\nL12_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L12_EP1TP1PP1DP0_GPU44 [label="Attention All-Reduce\nL12 EP1 TP Group 1 PP1 DP0\nGPU44" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L12_EP1TP1PP1DP0_GPU44 [label="Residual Add 1\nL12_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L12_EP1TP1PP1DP0_GPU44 [label="Layer Norm 2\nL12_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L12_EP1TP1PP1DP0_GPU44 [label="MoE Gate (Routing)\nL12_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L12_EP1TP1PP1DP0_GPU44 [label="Expert Dispatch\nL12_EP1TP1PP1DP0_GPU44" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L12_EP1TP1PP1DP0_GPU44 [label="Expert 0\nL12_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L12_EP1TP1PP1DP0_GPU44 [label="Expert 1\nL12_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L12_EP1TP1PP1DP0_GPU44 [label="Expert 2\nL12_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L12_EP1TP1PP1DP0_GPU44 [label="Expert 3\nL12_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L12_EP1TP1PP1DP0_GPU44 [label="Expert Combine\nL12_EP1TP1PP1DP0_GPU44" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L12_EP1TP1PP1DP0_GPU44 [label="FFN (Up-proj + GeLU + Down-proj)\nL12_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L12_EP1TP1PP1DP0_GPU44 [label="FFN All-Reduce\nL12 EP1 TP Group 1 PP1 DP0\nGPU44" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L12_EP1TP1PP1DP0_GPU44 [label="Residual Add 2\nL12_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L12_EP1TP1PP1DP1_GPU45 [label="Layer Norm 1\nL12_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L12_EP1TP1PP1DP1_GPU45 [label="QKV Projection\nL12_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L12_EP1TP1PP1DP1_GPU45 [label="Multi-Head Attention\nL12_EP1TP1PP1DP1_GPU45\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L12_EP1TP1PP1DP1_GPU45 [label="Attention Output Proj\nL12_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L12_EP1TP1PP1DP1_GPU45 [label="Attention All-Reduce\nL12 EP1 TP Group 1 PP1 DP1\nGPU45" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L12_EP1TP1PP1DP1_GPU45 [label="Residual Add 1\nL12_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L12_EP1TP1PP1DP1_GPU45 [label="Layer Norm 2\nL12_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L12_EP1TP1PP1DP1_GPU45 [label="MoE Gate (Routing)\nL12_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L12_EP1TP1PP1DP1_GPU45 [label="Expert Dispatch\nL12_EP1TP1PP1DP1_GPU45" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L12_EP1TP1PP1DP1_GPU45 [label="Expert 0\nL12_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L12_EP1TP1PP1DP1_GPU45 [label="Expert 1\nL12_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L12_EP1TP1PP1DP1_GPU45 [label="Expert 2\nL12_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L12_EP1TP1PP1DP1_GPU45 [label="Expert 3\nL12_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L12_EP1TP1PP1DP1_GPU45 [label="Expert Combine\nL12_EP1TP1PP1DP1_GPU45" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L12_EP1TP1PP1DP1_GPU45 [label="FFN (Up-proj + GeLU + Down-proj)\nL12_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L12_EP1TP1PP1DP1_GPU45 [label="FFN All-Reduce\nL12 EP1 TP Group 1 PP1 DP1\nGPU45" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L12_EP1TP1PP1DP1_GPU45 [label="Residual Add 2\nL12_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L12_EP1TP2PP1DP0_GPU52 [label="Layer Norm 1\nL12_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L12_EP1TP2PP1DP0_GPU52 [label="QKV Projection\nL12_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L12_EP1TP2PP1DP0_GPU52 [label="Multi-Head Attention\nL12_EP1TP2PP1DP0_GPU52\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L12_EP1TP2PP1DP0_GPU52 [label="Attention Output Proj\nL12_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L12_EP1TP2PP1DP0_GPU52 [label="Attention All-Reduce\nL12 EP1 TP Group 2 PP1 DP0\nGPU52" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L12_EP1TP2PP1DP0_GPU52 [label="Residual Add 1\nL12_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L12_EP1TP2PP1DP0_GPU52 [label="Layer Norm 2\nL12_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L12_EP1TP2PP1DP0_GPU52 [label="MoE Gate (Routing)\nL12_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L12_EP1TP2PP1DP0_GPU52 [label="Expert Dispatch\nL12_EP1TP2PP1DP0_GPU52" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L12_EP1TP2PP1DP0_GPU52 [label="Expert 0\nL12_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L12_EP1TP2PP1DP0_GPU52 [label="Expert 1\nL12_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L12_EP1TP2PP1DP0_GPU52 [label="Expert 2\nL12_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L12_EP1TP2PP1DP0_GPU52 [label="Expert 3\nL12_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L12_EP1TP2PP1DP0_GPU52 [label="Expert Combine\nL12_EP1TP2PP1DP0_GPU52" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L12_EP1TP2PP1DP0_GPU52 [label="FFN (Up-proj + GeLU + Down-proj)\nL12_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L12_EP1TP2PP1DP0_GPU52 [label="FFN All-Reduce\nL12 EP1 TP Group 2 PP1 DP0\nGPU52" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L12_EP1TP2PP1DP0_GPU52 [label="Residual Add 2\nL12_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L12_EP1TP2PP1DP1_GPU53 [label="Layer Norm 1\nL12_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L12_EP1TP2PP1DP1_GPU53 [label="QKV Projection\nL12_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L12_EP1TP2PP1DP1_GPU53 [label="Multi-Head Attention\nL12_EP1TP2PP1DP1_GPU53\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L12_EP1TP2PP1DP1_GPU53 [label="Attention Output Proj\nL12_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L12_EP1TP2PP1DP1_GPU53 [label="Attention All-Reduce\nL12 EP1 TP Group 2 PP1 DP1\nGPU53" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L12_EP1TP2PP1DP1_GPU53 [label="Residual Add 1\nL12_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L12_EP1TP2PP1DP1_GPU53 [label="Layer Norm 2\nL12_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L12_EP1TP2PP1DP1_GPU53 [label="MoE Gate (Routing)\nL12_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L12_EP1TP2PP1DP1_GPU53 [label="Expert Dispatch\nL12_EP1TP2PP1DP1_GPU53" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L12_EP1TP2PP1DP1_GPU53 [label="Expert 0\nL12_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L12_EP1TP2PP1DP1_GPU53 [label="Expert 1\nL12_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L12_EP1TP2PP1DP1_GPU53 [label="Expert 2\nL12_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L12_EP1TP2PP1DP1_GPU53 [label="Expert 3\nL12_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L12_EP1TP2PP1DP1_GPU53 [label="Expert Combine\nL12_EP1TP2PP1DP1_GPU53" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L12_EP1TP2PP1DP1_GPU53 [label="FFN (Up-proj + GeLU + Down-proj)\nL12_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L12_EP1TP2PP1DP1_GPU53 [label="FFN All-Reduce\nL12 EP1 TP Group 2 PP1 DP1\nGPU53" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L12_EP1TP2PP1DP1_GPU53 [label="Residual Add 2\nL12_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L12_EP1TP3PP1DP0_GPU60 [label="Layer Norm 1\nL12_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L12_EP1TP3PP1DP0_GPU60 [label="QKV Projection\nL12_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L12_EP1TP3PP1DP0_GPU60 [label="Multi-Head Attention\nL12_EP1TP3PP1DP0_GPU60\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L12_EP1TP3PP1DP0_GPU60 [label="Attention Output Proj\nL12_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L12_EP1TP3PP1DP0_GPU60 [label="Attention All-Reduce\nL12 EP1 TP Group 3 PP1 DP0\nGPU60" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L12_EP1TP3PP1DP0_GPU60 [label="Residual Add 1\nL12_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L12_EP1TP3PP1DP0_GPU60 [label="Layer Norm 2\nL12_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L12_EP1TP3PP1DP0_GPU60 [label="MoE Gate (Routing)\nL12_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L12_EP1TP3PP1DP0_GPU60 [label="Expert Dispatch\nL12_EP1TP3PP1DP0_GPU60" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L12_EP1TP3PP1DP0_GPU60 [label="Expert 0\nL12_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L12_EP1TP3PP1DP0_GPU60 [label="Expert 1\nL12_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L12_EP1TP3PP1DP0_GPU60 [label="Expert 2\nL12_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L12_EP1TP3PP1DP0_GPU60 [label="Expert 3\nL12_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L12_EP1TP3PP1DP0_GPU60 [label="Expert Combine\nL12_EP1TP3PP1DP0_GPU60" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L12_EP1TP3PP1DP0_GPU60 [label="FFN (Up-proj + GeLU + Down-proj)\nL12_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L12_EP1TP3PP1DP0_GPU60 [label="FFN All-Reduce\nL12 EP1 TP Group 3 PP1 DP0\nGPU60" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L12_EP1TP3PP1DP0_GPU60 [label="Residual Add 2\nL12_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L12_EP1TP3PP1DP1_GPU61 [label="Layer Norm 1\nL12_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L12_EP1TP3PP1DP1_GPU61 [label="QKV Projection\nL12_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L12_EP1TP3PP1DP1_GPU61 [label="Multi-Head Attention\nL12_EP1TP3PP1DP1_GPU61\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L12_EP1TP3PP1DP1_GPU61 [label="Attention Output Proj\nL12_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L12_EP1TP3PP1DP1_GPU61 [label="Attention All-Reduce\nL12 EP1 TP Group 3 PP1 DP1\nGPU61" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L12_EP1TP3PP1DP1_GPU61 [label="Residual Add 1\nL12_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L12_EP1TP3PP1DP1_GPU61 [label="Layer Norm 2\nL12_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L12_EP1TP3PP1DP1_GPU61 [label="MoE Gate (Routing)\nL12_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L12_EP1TP3PP1DP1_GPU61 [label="Expert Dispatch\nL12_EP1TP3PP1DP1_GPU61" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L12_EP1TP3PP1DP1_GPU61 [label="Expert 0\nL12_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L12_EP1TP3PP1DP1_GPU61 [label="Expert 1\nL12_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L12_EP1TP3PP1DP1_GPU61 [label="Expert 2\nL12_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L12_EP1TP3PP1DP1_GPU61 [label="Expert 3\nL12_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L12_EP1TP3PP1DP1_GPU61 [label="Expert Combine\nL12_EP1TP3PP1DP1_GPU61" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L12_EP1TP3PP1DP1_GPU61 [label="FFN (Up-proj + GeLU + Down-proj)\nL12_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L12_EP1TP3PP1DP1_GPU61 [label="FFN All-Reduce\nL12 EP1 TP Group 3 PP1 DP1\nGPU61" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L12_EP1TP3PP1DP1_GPU61 [label="Residual Add 2\nL12_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L13_EP0TP0PP1DP0_GPU4 [label="Layer Norm 1\nL13_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L13_EP0TP0PP1DP0_GPU4 [label="QKV Projection\nL13_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L13_EP0TP0PP1DP0_GPU4 [label="Multi-Head Attention\nL13_EP0TP0PP1DP0_GPU4\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L13_EP0TP0PP1DP0_GPU4 [label="Attention Output Proj\nL13_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L13_EP0TP0PP1DP0_GPU4 [label="Attention All-Reduce\nL13 EP0 TP Group 0 PP1 DP0\nGPU4" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L13_EP0TP0PP1DP0_GPU4 [label="Residual Add 1\nL13_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L13_EP0TP0PP1DP0_GPU4 [label="Layer Norm 2\nL13_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L13_EP0TP0PP1DP0_GPU4 [label="MoE Gate (Routing)\nL13_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L13_EP0TP0PP1DP0_GPU4 [label="Expert Dispatch\nL13_EP0TP0PP1DP0_GPU4" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L13_EP0TP0PP1DP0_GPU4 [label="Expert 0\nL13_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L13_EP0TP0PP1DP0_GPU4 [label="Expert 1\nL13_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L13_EP0TP0PP1DP0_GPU4 [label="Expert 2\nL13_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L13_EP0TP0PP1DP0_GPU4 [label="Expert 3\nL13_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L13_EP0TP0PP1DP0_GPU4 [label="Expert Combine\nL13_EP0TP0PP1DP0_GPU4" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L13_EP0TP0PP1DP0_GPU4 [label="FFN (Up-proj + GeLU + Down-proj)\nL13_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L13_EP0TP0PP1DP0_GPU4 [label="FFN All-Reduce\nL13 EP0 TP Group 0 PP1 DP0\nGPU4" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L13_EP0TP0PP1DP0_GPU4 [label="Residual Add 2\nL13_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L13_EP0TP0PP1DP1_GPU5 [label="Layer Norm 1\nL13_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L13_EP0TP0PP1DP1_GPU5 [label="QKV Projection\nL13_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L13_EP0TP0PP1DP1_GPU5 [label="Multi-Head Attention\nL13_EP0TP0PP1DP1_GPU5\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L13_EP0TP0PP1DP1_GPU5 [label="Attention Output Proj\nL13_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L13_EP0TP0PP1DP1_GPU5 [label="Attention All-Reduce\nL13 EP0 TP Group 0 PP1 DP1\nGPU5" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L13_EP0TP0PP1DP1_GPU5 [label="Residual Add 1\nL13_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L13_EP0TP0PP1DP1_GPU5 [label="Layer Norm 2\nL13_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L13_EP0TP0PP1DP1_GPU5 [label="MoE Gate (Routing)\nL13_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L13_EP0TP0PP1DP1_GPU5 [label="Expert Dispatch\nL13_EP0TP0PP1DP1_GPU5" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L13_EP0TP0PP1DP1_GPU5 [label="Expert 0\nL13_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L13_EP0TP0PP1DP1_GPU5 [label="Expert 1\nL13_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L13_EP0TP0PP1DP1_GPU5 [label="Expert 2\nL13_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L13_EP0TP0PP1DP1_GPU5 [label="Expert 3\nL13_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L13_EP0TP0PP1DP1_GPU5 [label="Expert Combine\nL13_EP0TP0PP1DP1_GPU5" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L13_EP0TP0PP1DP1_GPU5 [label="FFN (Up-proj + GeLU + Down-proj)\nL13_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L13_EP0TP0PP1DP1_GPU5 [label="FFN All-Reduce\nL13 EP0 TP Group 0 PP1 DP1\nGPU5" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L13_EP0TP0PP1DP1_GPU5 [label="Residual Add 2\nL13_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L13_EP0TP1PP1DP0_GPU12 [label="Layer Norm 1\nL13_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L13_EP0TP1PP1DP0_GPU12 [label="QKV Projection\nL13_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L13_EP0TP1PP1DP0_GPU12 [label="Multi-Head Attention\nL13_EP0TP1PP1DP0_GPU12\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L13_EP0TP1PP1DP0_GPU12 [label="Attention Output Proj\nL13_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L13_EP0TP1PP1DP0_GPU12 [label="Attention All-Reduce\nL13 EP0 TP Group 1 PP1 DP0\nGPU12" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L13_EP0TP1PP1DP0_GPU12 [label="Residual Add 1\nL13_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L13_EP0TP1PP1DP0_GPU12 [label="Layer Norm 2\nL13_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L13_EP0TP1PP1DP0_GPU12 [label="MoE Gate (Routing)\nL13_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L13_EP0TP1PP1DP0_GPU12 [label="Expert Dispatch\nL13_EP0TP1PP1DP0_GPU12" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L13_EP0TP1PP1DP0_GPU12 [label="Expert 0\nL13_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L13_EP0TP1PP1DP0_GPU12 [label="Expert 1\nL13_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L13_EP0TP1PP1DP0_GPU12 [label="Expert 2\nL13_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L13_EP0TP1PP1DP0_GPU12 [label="Expert 3\nL13_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L13_EP0TP1PP1DP0_GPU12 [label="Expert Combine\nL13_EP0TP1PP1DP0_GPU12" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L13_EP0TP1PP1DP0_GPU12 [label="FFN (Up-proj + GeLU + Down-proj)\nL13_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L13_EP0TP1PP1DP0_GPU12 [label="FFN All-Reduce\nL13 EP0 TP Group 1 PP1 DP0\nGPU12" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L13_EP0TP1PP1DP0_GPU12 [label="Residual Add 2\nL13_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L13_EP0TP1PP1DP1_GPU13 [label="Layer Norm 1\nL13_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L13_EP0TP1PP1DP1_GPU13 [label="QKV Projection\nL13_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L13_EP0TP1PP1DP1_GPU13 [label="Multi-Head Attention\nL13_EP0TP1PP1DP1_GPU13\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L13_EP0TP1PP1DP1_GPU13 [label="Attention Output Proj\nL13_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L13_EP0TP1PP1DP1_GPU13 [label="Attention All-Reduce\nL13 EP0 TP Group 1 PP1 DP1\nGPU13" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L13_EP0TP1PP1DP1_GPU13 [label="Residual Add 1\nL13_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L13_EP0TP1PP1DP1_GPU13 [label="Layer Norm 2\nL13_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L13_EP0TP1PP1DP1_GPU13 [label="MoE Gate (Routing)\nL13_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L13_EP0TP1PP1DP1_GPU13 [label="Expert Dispatch\nL13_EP0TP1PP1DP1_GPU13" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L13_EP0TP1PP1DP1_GPU13 [label="Expert 0\nL13_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L13_EP0TP1PP1DP1_GPU13 [label="Expert 1\nL13_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L13_EP0TP1PP1DP1_GPU13 [label="Expert 2\nL13_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L13_EP0TP1PP1DP1_GPU13 [label="Expert 3\nL13_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L13_EP0TP1PP1DP1_GPU13 [label="Expert Combine\nL13_EP0TP1PP1DP1_GPU13" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L13_EP0TP1PP1DP1_GPU13 [label="FFN (Up-proj + GeLU + Down-proj)\nL13_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L13_EP0TP1PP1DP1_GPU13 [label="FFN All-Reduce\nL13 EP0 TP Group 1 PP1 DP1\nGPU13" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L13_EP0TP1PP1DP1_GPU13 [label="Residual Add 2\nL13_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L13_EP0TP2PP1DP0_GPU20 [label="Layer Norm 1\nL13_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L13_EP0TP2PP1DP0_GPU20 [label="QKV Projection\nL13_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L13_EP0TP2PP1DP0_GPU20 [label="Multi-Head Attention\nL13_EP0TP2PP1DP0_GPU20\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L13_EP0TP2PP1DP0_GPU20 [label="Attention Output Proj\nL13_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L13_EP0TP2PP1DP0_GPU20 [label="Attention All-Reduce\nL13 EP0 TP Group 2 PP1 DP0\nGPU20" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L13_EP0TP2PP1DP0_GPU20 [label="Residual Add 1\nL13_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L13_EP0TP2PP1DP0_GPU20 [label="Layer Norm 2\nL13_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L13_EP0TP2PP1DP0_GPU20 [label="MoE Gate (Routing)\nL13_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L13_EP0TP2PP1DP0_GPU20 [label="Expert Dispatch\nL13_EP0TP2PP1DP0_GPU20" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L13_EP0TP2PP1DP0_GPU20 [label="Expert 0\nL13_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L13_EP0TP2PP1DP0_GPU20 [label="Expert 1\nL13_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L13_EP0TP2PP1DP0_GPU20 [label="Expert 2\nL13_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L13_EP0TP2PP1DP0_GPU20 [label="Expert 3\nL13_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L13_EP0TP2PP1DP0_GPU20 [label="Expert Combine\nL13_EP0TP2PP1DP0_GPU20" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L13_EP0TP2PP1DP0_GPU20 [label="FFN (Up-proj + GeLU + Down-proj)\nL13_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L13_EP0TP2PP1DP0_GPU20 [label="FFN All-Reduce\nL13 EP0 TP Group 2 PP1 DP0\nGPU20" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L13_EP0TP2PP1DP0_GPU20 [label="Residual Add 2\nL13_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L13_EP0TP2PP1DP1_GPU21 [label="Layer Norm 1\nL13_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L13_EP0TP2PP1DP1_GPU21 [label="QKV Projection\nL13_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L13_EP0TP2PP1DP1_GPU21 [label="Multi-Head Attention\nL13_EP0TP2PP1DP1_GPU21\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L13_EP0TP2PP1DP1_GPU21 [label="Attention Output Proj\nL13_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L13_EP0TP2PP1DP1_GPU21 [label="Attention All-Reduce\nL13 EP0 TP Group 2 PP1 DP1\nGPU21" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L13_EP0TP2PP1DP1_GPU21 [label="Residual Add 1\nL13_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L13_EP0TP2PP1DP1_GPU21 [label="Layer Norm 2\nL13_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L13_EP0TP2PP1DP1_GPU21 [label="MoE Gate (Routing)\nL13_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L13_EP0TP2PP1DP1_GPU21 [label="Expert Dispatch\nL13_EP0TP2PP1DP1_GPU21" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L13_EP0TP2PP1DP1_GPU21 [label="Expert 0\nL13_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L13_EP0TP2PP1DP1_GPU21 [label="Expert 1\nL13_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L13_EP0TP2PP1DP1_GPU21 [label="Expert 2\nL13_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L13_EP0TP2PP1DP1_GPU21 [label="Expert 3\nL13_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L13_EP0TP2PP1DP1_GPU21 [label="Expert Combine\nL13_EP0TP2PP1DP1_GPU21" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L13_EP0TP2PP1DP1_GPU21 [label="FFN (Up-proj + GeLU + Down-proj)\nL13_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L13_EP0TP2PP1DP1_GPU21 [label="FFN All-Reduce\nL13 EP0 TP Group 2 PP1 DP1\nGPU21" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L13_EP0TP2PP1DP1_GPU21 [label="Residual Add 2\nL13_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L13_EP0TP3PP1DP0_GPU28 [label="Layer Norm 1\nL13_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L13_EP0TP3PP1DP0_GPU28 [label="QKV Projection\nL13_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L13_EP0TP3PP1DP0_GPU28 [label="Multi-Head Attention\nL13_EP0TP3PP1DP0_GPU28\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L13_EP0TP3PP1DP0_GPU28 [label="Attention Output Proj\nL13_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L13_EP0TP3PP1DP0_GPU28 [label="Attention All-Reduce\nL13 EP0 TP Group 3 PP1 DP0\nGPU28" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L13_EP0TP3PP1DP0_GPU28 [label="Residual Add 1\nL13_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L13_EP0TP3PP1DP0_GPU28 [label="Layer Norm 2\nL13_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L13_EP0TP3PP1DP0_GPU28 [label="MoE Gate (Routing)\nL13_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L13_EP0TP3PP1DP0_GPU28 [label="Expert Dispatch\nL13_EP0TP3PP1DP0_GPU28" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L13_EP0TP3PP1DP0_GPU28 [label="Expert 0\nL13_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L13_EP0TP3PP1DP0_GPU28 [label="Expert 1\nL13_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L13_EP0TP3PP1DP0_GPU28 [label="Expert 2\nL13_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L13_EP0TP3PP1DP0_GPU28 [label="Expert 3\nL13_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L13_EP0TP3PP1DP0_GPU28 [label="Expert Combine\nL13_EP0TP3PP1DP0_GPU28" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L13_EP0TP3PP1DP0_GPU28 [label="FFN (Up-proj + GeLU + Down-proj)\nL13_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L13_EP0TP3PP1DP0_GPU28 [label="FFN All-Reduce\nL13 EP0 TP Group 3 PP1 DP0\nGPU28" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L13_EP0TP3PP1DP0_GPU28 [label="Residual Add 2\nL13_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L13_EP0TP3PP1DP1_GPU29 [label="Layer Norm 1\nL13_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L13_EP0TP3PP1DP1_GPU29 [label="QKV Projection\nL13_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L13_EP0TP3PP1DP1_GPU29 [label="Multi-Head Attention\nL13_EP0TP3PP1DP1_GPU29\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L13_EP0TP3PP1DP1_GPU29 [label="Attention Output Proj\nL13_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L13_EP0TP3PP1DP1_GPU29 [label="Attention All-Reduce\nL13 EP0 TP Group 3 PP1 DP1\nGPU29" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L13_EP0TP3PP1DP1_GPU29 [label="Residual Add 1\nL13_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L13_EP0TP3PP1DP1_GPU29 [label="Layer Norm 2\nL13_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L13_EP0TP3PP1DP1_GPU29 [label="MoE Gate (Routing)\nL13_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L13_EP0TP3PP1DP1_GPU29 [label="Expert Dispatch\nL13_EP0TP3PP1DP1_GPU29" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L13_EP0TP3PP1DP1_GPU29 [label="Expert 0\nL13_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L13_EP0TP3PP1DP1_GPU29 [label="Expert 1\nL13_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L13_EP0TP3PP1DP1_GPU29 [label="Expert 2\nL13_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L13_EP0TP3PP1DP1_GPU29 [label="Expert 3\nL13_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L13_EP0TP3PP1DP1_GPU29 [label="Expert Combine\nL13_EP0TP3PP1DP1_GPU29" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L13_EP0TP3PP1DP1_GPU29 [label="FFN (Up-proj + GeLU + Down-proj)\nL13_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L13_EP0TP3PP1DP1_GPU29 [label="FFN All-Reduce\nL13 EP0 TP Group 3 PP1 DP1\nGPU29" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L13_EP0TP3PP1DP1_GPU29 [label="Residual Add 2\nL13_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L13_EP1TP0PP1DP0_GPU36 [label="Layer Norm 1\nL13_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L13_EP1TP0PP1DP0_GPU36 [label="QKV Projection\nL13_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L13_EP1TP0PP1DP0_GPU36 [label="Multi-Head Attention\nL13_EP1TP0PP1DP0_GPU36\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L13_EP1TP0PP1DP0_GPU36 [label="Attention Output Proj\nL13_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L13_EP1TP0PP1DP0_GPU36 [label="Attention All-Reduce\nL13 EP1 TP Group 0 PP1 DP0\nGPU36" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L13_EP1TP0PP1DP0_GPU36 [label="Residual Add 1\nL13_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L13_EP1TP0PP1DP0_GPU36 [label="Layer Norm 2\nL13_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L13_EP1TP0PP1DP0_GPU36 [label="MoE Gate (Routing)\nL13_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L13_EP1TP0PP1DP0_GPU36 [label="Expert Dispatch\nL13_EP1TP0PP1DP0_GPU36" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L13_EP1TP0PP1DP0_GPU36 [label="Expert 0\nL13_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L13_EP1TP0PP1DP0_GPU36 [label="Expert 1\nL13_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L13_EP1TP0PP1DP0_GPU36 [label="Expert 2\nL13_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L13_EP1TP0PP1DP0_GPU36 [label="Expert 3\nL13_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L13_EP1TP0PP1DP0_GPU36 [label="Expert Combine\nL13_EP1TP0PP1DP0_GPU36" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L13_EP1TP0PP1DP0_GPU36 [label="FFN (Up-proj + GeLU + Down-proj)\nL13_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L13_EP1TP0PP1DP0_GPU36 [label="FFN All-Reduce\nL13 EP1 TP Group 0 PP1 DP0\nGPU36" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L13_EP1TP0PP1DP0_GPU36 [label="Residual Add 2\nL13_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L13_EP1TP0PP1DP1_GPU37 [label="Layer Norm 1\nL13_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L13_EP1TP0PP1DP1_GPU37 [label="QKV Projection\nL13_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L13_EP1TP0PP1DP1_GPU37 [label="Multi-Head Attention\nL13_EP1TP0PP1DP1_GPU37\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L13_EP1TP0PP1DP1_GPU37 [label="Attention Output Proj\nL13_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L13_EP1TP0PP1DP1_GPU37 [label="Attention All-Reduce\nL13 EP1 TP Group 0 PP1 DP1\nGPU37" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L13_EP1TP0PP1DP1_GPU37 [label="Residual Add 1\nL13_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L13_EP1TP0PP1DP1_GPU37 [label="Layer Norm 2\nL13_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L13_EP1TP0PP1DP1_GPU37 [label="MoE Gate (Routing)\nL13_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L13_EP1TP0PP1DP1_GPU37 [label="Expert Dispatch\nL13_EP1TP0PP1DP1_GPU37" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L13_EP1TP0PP1DP1_GPU37 [label="Expert 0\nL13_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L13_EP1TP0PP1DP1_GPU37 [label="Expert 1\nL13_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L13_EP1TP0PP1DP1_GPU37 [label="Expert 2\nL13_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L13_EP1TP0PP1DP1_GPU37 [label="Expert 3\nL13_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L13_EP1TP0PP1DP1_GPU37 [label="Expert Combine\nL13_EP1TP0PP1DP1_GPU37" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L13_EP1TP0PP1DP1_GPU37 [label="FFN (Up-proj + GeLU + Down-proj)\nL13_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L13_EP1TP0PP1DP1_GPU37 [label="FFN All-Reduce\nL13 EP1 TP Group 0 PP1 DP1\nGPU37" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L13_EP1TP0PP1DP1_GPU37 [label="Residual Add 2\nL13_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L13_EP1TP1PP1DP0_GPU44 [label="Layer Norm 1\nL13_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L13_EP1TP1PP1DP0_GPU44 [label="QKV Projection\nL13_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L13_EP1TP1PP1DP0_GPU44 [label="Multi-Head Attention\nL13_EP1TP1PP1DP0_GPU44\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L13_EP1TP1PP1DP0_GPU44 [label="Attention Output Proj\nL13_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L13_EP1TP1PP1DP0_GPU44 [label="Attention All-Reduce\nL13 EP1 TP Group 1 PP1 DP0\nGPU44" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L13_EP1TP1PP1DP0_GPU44 [label="Residual Add 1\nL13_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L13_EP1TP1PP1DP0_GPU44 [label="Layer Norm 2\nL13_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L13_EP1TP1PP1DP0_GPU44 [label="MoE Gate (Routing)\nL13_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L13_EP1TP1PP1DP0_GPU44 [label="Expert Dispatch\nL13_EP1TP1PP1DP0_GPU44" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L13_EP1TP1PP1DP0_GPU44 [label="Expert 0\nL13_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L13_EP1TP1PP1DP0_GPU44 [label="Expert 1\nL13_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L13_EP1TP1PP1DP0_GPU44 [label="Expert 2\nL13_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L13_EP1TP1PP1DP0_GPU44 [label="Expert 3\nL13_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L13_EP1TP1PP1DP0_GPU44 [label="Expert Combine\nL13_EP1TP1PP1DP0_GPU44" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L13_EP1TP1PP1DP0_GPU44 [label="FFN (Up-proj + GeLU + Down-proj)\nL13_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L13_EP1TP1PP1DP0_GPU44 [label="FFN All-Reduce\nL13 EP1 TP Group 1 PP1 DP0\nGPU44" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L13_EP1TP1PP1DP0_GPU44 [label="Residual Add 2\nL13_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L13_EP1TP1PP1DP1_GPU45 [label="Layer Norm 1\nL13_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L13_EP1TP1PP1DP1_GPU45 [label="QKV Projection\nL13_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L13_EP1TP1PP1DP1_GPU45 [label="Multi-Head Attention\nL13_EP1TP1PP1DP1_GPU45\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L13_EP1TP1PP1DP1_GPU45 [label="Attention Output Proj\nL13_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L13_EP1TP1PP1DP1_GPU45 [label="Attention All-Reduce\nL13 EP1 TP Group 1 PP1 DP1\nGPU45" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L13_EP1TP1PP1DP1_GPU45 [label="Residual Add 1\nL13_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L13_EP1TP1PP1DP1_GPU45 [label="Layer Norm 2\nL13_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L13_EP1TP1PP1DP1_GPU45 [label="MoE Gate (Routing)\nL13_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L13_EP1TP1PP1DP1_GPU45 [label="Expert Dispatch\nL13_EP1TP1PP1DP1_GPU45" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L13_EP1TP1PP1DP1_GPU45 [label="Expert 0\nL13_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L13_EP1TP1PP1DP1_GPU45 [label="Expert 1\nL13_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L13_EP1TP1PP1DP1_GPU45 [label="Expert 2\nL13_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L13_EP1TP1PP1DP1_GPU45 [label="Expert 3\nL13_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L13_EP1TP1PP1DP1_GPU45 [label="Expert Combine\nL13_EP1TP1PP1DP1_GPU45" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L13_EP1TP1PP1DP1_GPU45 [label="FFN (Up-proj + GeLU + Down-proj)\nL13_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L13_EP1TP1PP1DP1_GPU45 [label="FFN All-Reduce\nL13 EP1 TP Group 1 PP1 DP1\nGPU45" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L13_EP1TP1PP1DP1_GPU45 [label="Residual Add 2\nL13_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L13_EP1TP2PP1DP0_GPU52 [label="Layer Norm 1\nL13_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L13_EP1TP2PP1DP0_GPU52 [label="QKV Projection\nL13_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L13_EP1TP2PP1DP0_GPU52 [label="Multi-Head Attention\nL13_EP1TP2PP1DP0_GPU52\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L13_EP1TP2PP1DP0_GPU52 [label="Attention Output Proj\nL13_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L13_EP1TP2PP1DP0_GPU52 [label="Attention All-Reduce\nL13 EP1 TP Group 2 PP1 DP0\nGPU52" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L13_EP1TP2PP1DP0_GPU52 [label="Residual Add 1\nL13_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L13_EP1TP2PP1DP0_GPU52 [label="Layer Norm 2\nL13_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L13_EP1TP2PP1DP0_GPU52 [label="MoE Gate (Routing)\nL13_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L13_EP1TP2PP1DP0_GPU52 [label="Expert Dispatch\nL13_EP1TP2PP1DP0_GPU52" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L13_EP1TP2PP1DP0_GPU52 [label="Expert 0\nL13_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L13_EP1TP2PP1DP0_GPU52 [label="Expert 1\nL13_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L13_EP1TP2PP1DP0_GPU52 [label="Expert 2\nL13_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L13_EP1TP2PP1DP0_GPU52 [label="Expert 3\nL13_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L13_EP1TP2PP1DP0_GPU52 [label="Expert Combine\nL13_EP1TP2PP1DP0_GPU52" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L13_EP1TP2PP1DP0_GPU52 [label="FFN (Up-proj + GeLU + Down-proj)\nL13_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L13_EP1TP2PP1DP0_GPU52 [label="FFN All-Reduce\nL13 EP1 TP Group 2 PP1 DP0\nGPU52" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L13_EP1TP2PP1DP0_GPU52 [label="Residual Add 2\nL13_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L13_EP1TP2PP1DP1_GPU53 [label="Layer Norm 1\nL13_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L13_EP1TP2PP1DP1_GPU53 [label="QKV Projection\nL13_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L13_EP1TP2PP1DP1_GPU53 [label="Multi-Head Attention\nL13_EP1TP2PP1DP1_GPU53\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L13_EP1TP2PP1DP1_GPU53 [label="Attention Output Proj\nL13_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L13_EP1TP2PP1DP1_GPU53 [label="Attention All-Reduce\nL13 EP1 TP Group 2 PP1 DP1\nGPU53" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L13_EP1TP2PP1DP1_GPU53 [label="Residual Add 1\nL13_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L13_EP1TP2PP1DP1_GPU53 [label="Layer Norm 2\nL13_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L13_EP1TP2PP1DP1_GPU53 [label="MoE Gate (Routing)\nL13_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L13_EP1TP2PP1DP1_GPU53 [label="Expert Dispatch\nL13_EP1TP2PP1DP1_GPU53" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L13_EP1TP2PP1DP1_GPU53 [label="Expert 0\nL13_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L13_EP1TP2PP1DP1_GPU53 [label="Expert 1\nL13_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L13_EP1TP2PP1DP1_GPU53 [label="Expert 2\nL13_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L13_EP1TP2PP1DP1_GPU53 [label="Expert 3\nL13_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L13_EP1TP2PP1DP1_GPU53 [label="Expert Combine\nL13_EP1TP2PP1DP1_GPU53" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L13_EP1TP2PP1DP1_GPU53 [label="FFN (Up-proj + GeLU + Down-proj)\nL13_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L13_EP1TP2PP1DP1_GPU53 [label="FFN All-Reduce\nL13 EP1 TP Group 2 PP1 DP1\nGPU53" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L13_EP1TP2PP1DP1_GPU53 [label="Residual Add 2\nL13_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L13_EP1TP3PP1DP0_GPU60 [label="Layer Norm 1\nL13_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L13_EP1TP3PP1DP0_GPU60 [label="QKV Projection\nL13_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L13_EP1TP3PP1DP0_GPU60 [label="Multi-Head Attention\nL13_EP1TP3PP1DP0_GPU60\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L13_EP1TP3PP1DP0_GPU60 [label="Attention Output Proj\nL13_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L13_EP1TP3PP1DP0_GPU60 [label="Attention All-Reduce\nL13 EP1 TP Group 3 PP1 DP0\nGPU60" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L13_EP1TP3PP1DP0_GPU60 [label="Residual Add 1\nL13_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L13_EP1TP3PP1DP0_GPU60 [label="Layer Norm 2\nL13_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L13_EP1TP3PP1DP0_GPU60 [label="MoE Gate (Routing)\nL13_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L13_EP1TP3PP1DP0_GPU60 [label="Expert Dispatch\nL13_EP1TP3PP1DP0_GPU60" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L13_EP1TP3PP1DP0_GPU60 [label="Expert 0\nL13_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L13_EP1TP3PP1DP0_GPU60 [label="Expert 1\nL13_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L13_EP1TP3PP1DP0_GPU60 [label="Expert 2\nL13_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L13_EP1TP3PP1DP0_GPU60 [label="Expert 3\nL13_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L13_EP1TP3PP1DP0_GPU60 [label="Expert Combine\nL13_EP1TP3PP1DP0_GPU60" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L13_EP1TP3PP1DP0_GPU60 [label="FFN (Up-proj + GeLU + Down-proj)\nL13_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L13_EP1TP3PP1DP0_GPU60 [label="FFN All-Reduce\nL13 EP1 TP Group 3 PP1 DP0\nGPU60" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L13_EP1TP3PP1DP0_GPU60 [label="Residual Add 2\nL13_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L13_EP1TP3PP1DP1_GPU61 [label="Layer Norm 1\nL13_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L13_EP1TP3PP1DP1_GPU61 [label="QKV Projection\nL13_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L13_EP1TP3PP1DP1_GPU61 [label="Multi-Head Attention\nL13_EP1TP3PP1DP1_GPU61\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L13_EP1TP3PP1DP1_GPU61 [label="Attention Output Proj\nL13_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L13_EP1TP3PP1DP1_GPU61 [label="Attention All-Reduce\nL13 EP1 TP Group 3 PP1 DP1\nGPU61" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L13_EP1TP3PP1DP1_GPU61 [label="Residual Add 1\nL13_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L13_EP1TP3PP1DP1_GPU61 [label="Layer Norm 2\nL13_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L13_EP1TP3PP1DP1_GPU61 [label="MoE Gate (Routing)\nL13_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L13_EP1TP3PP1DP1_GPU61 [label="Expert Dispatch\nL13_EP1TP3PP1DP1_GPU61" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L13_EP1TP3PP1DP1_GPU61 [label="Expert 0\nL13_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L13_EP1TP3PP1DP1_GPU61 [label="Expert 1\nL13_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L13_EP1TP3PP1DP1_GPU61 [label="Expert 2\nL13_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L13_EP1TP3PP1DP1_GPU61 [label="Expert 3\nL13_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L13_EP1TP3PP1DP1_GPU61 [label="Expert Combine\nL13_EP1TP3PP1DP1_GPU61" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L13_EP1TP3PP1DP1_GPU61 [label="FFN (Up-proj + GeLU + Down-proj)\nL13_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L13_EP1TP3PP1DP1_GPU61 [label="FFN All-Reduce\nL13 EP1 TP Group 3 PP1 DP1\nGPU61" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L13_EP1TP3PP1DP1_GPU61 [label="Residual Add 2\nL13_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L14_EP0TP0PP1DP0_GPU4 [label="Layer Norm 1\nL14_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L14_EP0TP0PP1DP0_GPU4 [label="QKV Projection\nL14_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L14_EP0TP0PP1DP0_GPU4 [label="Multi-Head Attention\nL14_EP0TP0PP1DP0_GPU4\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L14_EP0TP0PP1DP0_GPU4 [label="Attention Output Proj\nL14_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L14_EP0TP0PP1DP0_GPU4 [label="Attention All-Reduce\nL14 EP0 TP Group 0 PP1 DP0\nGPU4" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L14_EP0TP0PP1DP0_GPU4 [label="Residual Add 1\nL14_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L14_EP0TP0PP1DP0_GPU4 [label="Layer Norm 2\nL14_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L14_EP0TP0PP1DP0_GPU4 [label="MoE Gate (Routing)\nL14_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L14_EP0TP0PP1DP0_GPU4 [label="Expert Dispatch\nL14_EP0TP0PP1DP0_GPU4" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L14_EP0TP0PP1DP0_GPU4 [label="Expert 0\nL14_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L14_EP0TP0PP1DP0_GPU4 [label="Expert 1\nL14_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L14_EP0TP0PP1DP0_GPU4 [label="Expert 2\nL14_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L14_EP0TP0PP1DP0_GPU4 [label="Expert 3\nL14_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L14_EP0TP0PP1DP0_GPU4 [label="Expert Combine\nL14_EP0TP0PP1DP0_GPU4" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L14_EP0TP0PP1DP0_GPU4 [label="FFN (Up-proj + GeLU + Down-proj)\nL14_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L14_EP0TP0PP1DP0_GPU4 [label="FFN All-Reduce\nL14 EP0 TP Group 0 PP1 DP0\nGPU4" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L14_EP0TP0PP1DP0_GPU4 [label="Residual Add 2\nL14_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L14_EP0TP0PP1DP1_GPU5 [label="Layer Norm 1\nL14_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L14_EP0TP0PP1DP1_GPU5 [label="QKV Projection\nL14_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L14_EP0TP0PP1DP1_GPU5 [label="Multi-Head Attention\nL14_EP0TP0PP1DP1_GPU5\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L14_EP0TP0PP1DP1_GPU5 [label="Attention Output Proj\nL14_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L14_EP0TP0PP1DP1_GPU5 [label="Attention All-Reduce\nL14 EP0 TP Group 0 PP1 DP1\nGPU5" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L14_EP0TP0PP1DP1_GPU5 [label="Residual Add 1\nL14_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L14_EP0TP0PP1DP1_GPU5 [label="Layer Norm 2\nL14_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L14_EP0TP0PP1DP1_GPU5 [label="MoE Gate (Routing)\nL14_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L14_EP0TP0PP1DP1_GPU5 [label="Expert Dispatch\nL14_EP0TP0PP1DP1_GPU5" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L14_EP0TP0PP1DP1_GPU5 [label="Expert 0\nL14_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L14_EP0TP0PP1DP1_GPU5 [label="Expert 1\nL14_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L14_EP0TP0PP1DP1_GPU5 [label="Expert 2\nL14_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L14_EP0TP0PP1DP1_GPU5 [label="Expert 3\nL14_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L14_EP0TP0PP1DP1_GPU5 [label="Expert Combine\nL14_EP0TP0PP1DP1_GPU5" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L14_EP0TP0PP1DP1_GPU5 [label="FFN (Up-proj + GeLU + Down-proj)\nL14_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L14_EP0TP0PP1DP1_GPU5 [label="FFN All-Reduce\nL14 EP0 TP Group 0 PP1 DP1\nGPU5" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L14_EP0TP0PP1DP1_GPU5 [label="Residual Add 2\nL14_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L14_EP0TP1PP1DP0_GPU12 [label="Layer Norm 1\nL14_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L14_EP0TP1PP1DP0_GPU12 [label="QKV Projection\nL14_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L14_EP0TP1PP1DP0_GPU12 [label="Multi-Head Attention\nL14_EP0TP1PP1DP0_GPU12\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L14_EP0TP1PP1DP0_GPU12 [label="Attention Output Proj\nL14_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L14_EP0TP1PP1DP0_GPU12 [label="Attention All-Reduce\nL14 EP0 TP Group 1 PP1 DP0\nGPU12" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L14_EP0TP1PP1DP0_GPU12 [label="Residual Add 1\nL14_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L14_EP0TP1PP1DP0_GPU12 [label="Layer Norm 2\nL14_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L14_EP0TP1PP1DP0_GPU12 [label="MoE Gate (Routing)\nL14_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L14_EP0TP1PP1DP0_GPU12 [label="Expert Dispatch\nL14_EP0TP1PP1DP0_GPU12" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L14_EP0TP1PP1DP0_GPU12 [label="Expert 0\nL14_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L14_EP0TP1PP1DP0_GPU12 [label="Expert 1\nL14_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L14_EP0TP1PP1DP0_GPU12 [label="Expert 2\nL14_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L14_EP0TP1PP1DP0_GPU12 [label="Expert 3\nL14_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L14_EP0TP1PP1DP0_GPU12 [label="Expert Combine\nL14_EP0TP1PP1DP0_GPU12" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L14_EP0TP1PP1DP0_GPU12 [label="FFN (Up-proj + GeLU + Down-proj)\nL14_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L14_EP0TP1PP1DP0_GPU12 [label="FFN All-Reduce\nL14 EP0 TP Group 1 PP1 DP0\nGPU12" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L14_EP0TP1PP1DP0_GPU12 [label="Residual Add 2\nL14_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L14_EP0TP1PP1DP1_GPU13 [label="Layer Norm 1\nL14_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L14_EP0TP1PP1DP1_GPU13 [label="QKV Projection\nL14_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L14_EP0TP1PP1DP1_GPU13 [label="Multi-Head Attention\nL14_EP0TP1PP1DP1_GPU13\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L14_EP0TP1PP1DP1_GPU13 [label="Attention Output Proj\nL14_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L14_EP0TP1PP1DP1_GPU13 [label="Attention All-Reduce\nL14 EP0 TP Group 1 PP1 DP1\nGPU13" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L14_EP0TP1PP1DP1_GPU13 [label="Residual Add 1\nL14_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L14_EP0TP1PP1DP1_GPU13 [label="Layer Norm 2\nL14_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L14_EP0TP1PP1DP1_GPU13 [label="MoE Gate (Routing)\nL14_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L14_EP0TP1PP1DP1_GPU13 [label="Expert Dispatch\nL14_EP0TP1PP1DP1_GPU13" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L14_EP0TP1PP1DP1_GPU13 [label="Expert 0\nL14_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L14_EP0TP1PP1DP1_GPU13 [label="Expert 1\nL14_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L14_EP0TP1PP1DP1_GPU13 [label="Expert 2\nL14_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L14_EP0TP1PP1DP1_GPU13 [label="Expert 3\nL14_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L14_EP0TP1PP1DP1_GPU13 [label="Expert Combine\nL14_EP0TP1PP1DP1_GPU13" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L14_EP0TP1PP1DP1_GPU13 [label="FFN (Up-proj + GeLU + Down-proj)\nL14_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L14_EP0TP1PP1DP1_GPU13 [label="FFN All-Reduce\nL14 EP0 TP Group 1 PP1 DP1\nGPU13" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L14_EP0TP1PP1DP1_GPU13 [label="Residual Add 2\nL14_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L14_EP0TP2PP1DP0_GPU20 [label="Layer Norm 1\nL14_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L14_EP0TP2PP1DP0_GPU20 [label="QKV Projection\nL14_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L14_EP0TP2PP1DP0_GPU20 [label="Multi-Head Attention\nL14_EP0TP2PP1DP0_GPU20\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L14_EP0TP2PP1DP0_GPU20 [label="Attention Output Proj\nL14_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L14_EP0TP2PP1DP0_GPU20 [label="Attention All-Reduce\nL14 EP0 TP Group 2 PP1 DP0\nGPU20" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L14_EP0TP2PP1DP0_GPU20 [label="Residual Add 1\nL14_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L14_EP0TP2PP1DP0_GPU20 [label="Layer Norm 2\nL14_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L14_EP0TP2PP1DP0_GPU20 [label="MoE Gate (Routing)\nL14_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L14_EP0TP2PP1DP0_GPU20 [label="Expert Dispatch\nL14_EP0TP2PP1DP0_GPU20" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L14_EP0TP2PP1DP0_GPU20 [label="Expert 0\nL14_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L14_EP0TP2PP1DP0_GPU20 [label="Expert 1\nL14_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L14_EP0TP2PP1DP0_GPU20 [label="Expert 2\nL14_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L14_EP0TP2PP1DP0_GPU20 [label="Expert 3\nL14_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L14_EP0TP2PP1DP0_GPU20 [label="Expert Combine\nL14_EP0TP2PP1DP0_GPU20" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L14_EP0TP2PP1DP0_GPU20 [label="FFN (Up-proj + GeLU + Down-proj)\nL14_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L14_EP0TP2PP1DP0_GPU20 [label="FFN All-Reduce\nL14 EP0 TP Group 2 PP1 DP0\nGPU20" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L14_EP0TP2PP1DP0_GPU20 [label="Residual Add 2\nL14_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L14_EP0TP2PP1DP1_GPU21 [label="Layer Norm 1\nL14_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L14_EP0TP2PP1DP1_GPU21 [label="QKV Projection\nL14_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L14_EP0TP2PP1DP1_GPU21 [label="Multi-Head Attention\nL14_EP0TP2PP1DP1_GPU21\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L14_EP0TP2PP1DP1_GPU21 [label="Attention Output Proj\nL14_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L14_EP0TP2PP1DP1_GPU21 [label="Attention All-Reduce\nL14 EP0 TP Group 2 PP1 DP1\nGPU21" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L14_EP0TP2PP1DP1_GPU21 [label="Residual Add 1\nL14_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L14_EP0TP2PP1DP1_GPU21 [label="Layer Norm 2\nL14_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L14_EP0TP2PP1DP1_GPU21 [label="MoE Gate (Routing)\nL14_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L14_EP0TP2PP1DP1_GPU21 [label="Expert Dispatch\nL14_EP0TP2PP1DP1_GPU21" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L14_EP0TP2PP1DP1_GPU21 [label="Expert 0\nL14_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L14_EP0TP2PP1DP1_GPU21 [label="Expert 1\nL14_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L14_EP0TP2PP1DP1_GPU21 [label="Expert 2\nL14_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L14_EP0TP2PP1DP1_GPU21 [label="Expert 3\nL14_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L14_EP0TP2PP1DP1_GPU21 [label="Expert Combine\nL14_EP0TP2PP1DP1_GPU21" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L14_EP0TP2PP1DP1_GPU21 [label="FFN (Up-proj + GeLU + Down-proj)\nL14_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L14_EP0TP2PP1DP1_GPU21 [label="FFN All-Reduce\nL14 EP0 TP Group 2 PP1 DP1\nGPU21" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L14_EP0TP2PP1DP1_GPU21 [label="Residual Add 2\nL14_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L14_EP0TP3PP1DP0_GPU28 [label="Layer Norm 1\nL14_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L14_EP0TP3PP1DP0_GPU28 [label="QKV Projection\nL14_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L14_EP0TP3PP1DP0_GPU28 [label="Multi-Head Attention\nL14_EP0TP3PP1DP0_GPU28\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L14_EP0TP3PP1DP0_GPU28 [label="Attention Output Proj\nL14_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L14_EP0TP3PP1DP0_GPU28 [label="Attention All-Reduce\nL14 EP0 TP Group 3 PP1 DP0\nGPU28" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L14_EP0TP3PP1DP0_GPU28 [label="Residual Add 1\nL14_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L14_EP0TP3PP1DP0_GPU28 [label="Layer Norm 2\nL14_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L14_EP0TP3PP1DP0_GPU28 [label="MoE Gate (Routing)\nL14_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L14_EP0TP3PP1DP0_GPU28 [label="Expert Dispatch\nL14_EP0TP3PP1DP0_GPU28" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L14_EP0TP3PP1DP0_GPU28 [label="Expert 0\nL14_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L14_EP0TP3PP1DP0_GPU28 [label="Expert 1\nL14_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L14_EP0TP3PP1DP0_GPU28 [label="Expert 2\nL14_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L14_EP0TP3PP1DP0_GPU28 [label="Expert 3\nL14_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L14_EP0TP3PP1DP0_GPU28 [label="Expert Combine\nL14_EP0TP3PP1DP0_GPU28" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L14_EP0TP3PP1DP0_GPU28 [label="FFN (Up-proj + GeLU + Down-proj)\nL14_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L14_EP0TP3PP1DP0_GPU28 [label="FFN All-Reduce\nL14 EP0 TP Group 3 PP1 DP0\nGPU28" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L14_EP0TP3PP1DP0_GPU28 [label="Residual Add 2\nL14_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L14_EP0TP3PP1DP1_GPU29 [label="Layer Norm 1\nL14_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L14_EP0TP3PP1DP1_GPU29 [label="QKV Projection\nL14_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L14_EP0TP3PP1DP1_GPU29 [label="Multi-Head Attention\nL14_EP0TP3PP1DP1_GPU29\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L14_EP0TP3PP1DP1_GPU29 [label="Attention Output Proj\nL14_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L14_EP0TP3PP1DP1_GPU29 [label="Attention All-Reduce\nL14 EP0 TP Group 3 PP1 DP1\nGPU29" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L14_EP0TP3PP1DP1_GPU29 [label="Residual Add 1\nL14_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L14_EP0TP3PP1DP1_GPU29 [label="Layer Norm 2\nL14_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L14_EP0TP3PP1DP1_GPU29 [label="MoE Gate (Routing)\nL14_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L14_EP0TP3PP1DP1_GPU29 [label="Expert Dispatch\nL14_EP0TP3PP1DP1_GPU29" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L14_EP0TP3PP1DP1_GPU29 [label="Expert 0\nL14_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L14_EP0TP3PP1DP1_GPU29 [label="Expert 1\nL14_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L14_EP0TP3PP1DP1_GPU29 [label="Expert 2\nL14_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L14_EP0TP3PP1DP1_GPU29 [label="Expert 3\nL14_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L14_EP0TP3PP1DP1_GPU29 [label="Expert Combine\nL14_EP0TP3PP1DP1_GPU29" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L14_EP0TP3PP1DP1_GPU29 [label="FFN (Up-proj + GeLU + Down-proj)\nL14_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L14_EP0TP3PP1DP1_GPU29 [label="FFN All-Reduce\nL14 EP0 TP Group 3 PP1 DP1\nGPU29" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L14_EP0TP3PP1DP1_GPU29 [label="Residual Add 2\nL14_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L14_EP1TP0PP1DP0_GPU36 [label="Layer Norm 1\nL14_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L14_EP1TP0PP1DP0_GPU36 [label="QKV Projection\nL14_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L14_EP1TP0PP1DP0_GPU36 [label="Multi-Head Attention\nL14_EP1TP0PP1DP0_GPU36\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L14_EP1TP0PP1DP0_GPU36 [label="Attention Output Proj\nL14_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L14_EP1TP0PP1DP0_GPU36 [label="Attention All-Reduce\nL14 EP1 TP Group 0 PP1 DP0\nGPU36" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L14_EP1TP0PP1DP0_GPU36 [label="Residual Add 1\nL14_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L14_EP1TP0PP1DP0_GPU36 [label="Layer Norm 2\nL14_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L14_EP1TP0PP1DP0_GPU36 [label="MoE Gate (Routing)\nL14_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L14_EP1TP0PP1DP0_GPU36 [label="Expert Dispatch\nL14_EP1TP0PP1DP0_GPU36" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L14_EP1TP0PP1DP0_GPU36 [label="Expert 0\nL14_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L14_EP1TP0PP1DP0_GPU36 [label="Expert 1\nL14_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L14_EP1TP0PP1DP0_GPU36 [label="Expert 2\nL14_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L14_EP1TP0PP1DP0_GPU36 [label="Expert 3\nL14_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L14_EP1TP0PP1DP0_GPU36 [label="Expert Combine\nL14_EP1TP0PP1DP0_GPU36" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L14_EP1TP0PP1DP0_GPU36 [label="FFN (Up-proj + GeLU + Down-proj)\nL14_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L14_EP1TP0PP1DP0_GPU36 [label="FFN All-Reduce\nL14 EP1 TP Group 0 PP1 DP0\nGPU36" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L14_EP1TP0PP1DP0_GPU36 [label="Residual Add 2\nL14_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L14_EP1TP0PP1DP1_GPU37 [label="Layer Norm 1\nL14_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L14_EP1TP0PP1DP1_GPU37 [label="QKV Projection\nL14_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L14_EP1TP0PP1DP1_GPU37 [label="Multi-Head Attention\nL14_EP1TP0PP1DP1_GPU37\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L14_EP1TP0PP1DP1_GPU37 [label="Attention Output Proj\nL14_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L14_EP1TP0PP1DP1_GPU37 [label="Attention All-Reduce\nL14 EP1 TP Group 0 PP1 DP1\nGPU37" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L14_EP1TP0PP1DP1_GPU37 [label="Residual Add 1\nL14_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L14_EP1TP0PP1DP1_GPU37 [label="Layer Norm 2\nL14_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L14_EP1TP0PP1DP1_GPU37 [label="MoE Gate (Routing)\nL14_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L14_EP1TP0PP1DP1_GPU37 [label="Expert Dispatch\nL14_EP1TP0PP1DP1_GPU37" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L14_EP1TP0PP1DP1_GPU37 [label="Expert 0\nL14_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L14_EP1TP0PP1DP1_GPU37 [label="Expert 1\nL14_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L14_EP1TP0PP1DP1_GPU37 [label="Expert 2\nL14_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L14_EP1TP0PP1DP1_GPU37 [label="Expert 3\nL14_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L14_EP1TP0PP1DP1_GPU37 [label="Expert Combine\nL14_EP1TP0PP1DP1_GPU37" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L14_EP1TP0PP1DP1_GPU37 [label="FFN (Up-proj + GeLU + Down-proj)\nL14_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L14_EP1TP0PP1DP1_GPU37 [label="FFN All-Reduce\nL14 EP1 TP Group 0 PP1 DP1\nGPU37" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L14_EP1TP0PP1DP1_GPU37 [label="Residual Add 2\nL14_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L14_EP1TP1PP1DP0_GPU44 [label="Layer Norm 1\nL14_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L14_EP1TP1PP1DP0_GPU44 [label="QKV Projection\nL14_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L14_EP1TP1PP1DP0_GPU44 [label="Multi-Head Attention\nL14_EP1TP1PP1DP0_GPU44\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L14_EP1TP1PP1DP0_GPU44 [label="Attention Output Proj\nL14_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L14_EP1TP1PP1DP0_GPU44 [label="Attention All-Reduce\nL14 EP1 TP Group 1 PP1 DP0\nGPU44" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L14_EP1TP1PP1DP0_GPU44 [label="Residual Add 1\nL14_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L14_EP1TP1PP1DP0_GPU44 [label="Layer Norm 2\nL14_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L14_EP1TP1PP1DP0_GPU44 [label="MoE Gate (Routing)\nL14_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L14_EP1TP1PP1DP0_GPU44 [label="Expert Dispatch\nL14_EP1TP1PP1DP0_GPU44" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L14_EP1TP1PP1DP0_GPU44 [label="Expert 0\nL14_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L14_EP1TP1PP1DP0_GPU44 [label="Expert 1\nL14_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L14_EP1TP1PP1DP0_GPU44 [label="Expert 2\nL14_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L14_EP1TP1PP1DP0_GPU44 [label="Expert 3\nL14_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L14_EP1TP1PP1DP0_GPU44 [label="Expert Combine\nL14_EP1TP1PP1DP0_GPU44" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L14_EP1TP1PP1DP0_GPU44 [label="FFN (Up-proj + GeLU + Down-proj)\nL14_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L14_EP1TP1PP1DP0_GPU44 [label="FFN All-Reduce\nL14 EP1 TP Group 1 PP1 DP0\nGPU44" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L14_EP1TP1PP1DP0_GPU44 [label="Residual Add 2\nL14_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L14_EP1TP1PP1DP1_GPU45 [label="Layer Norm 1\nL14_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L14_EP1TP1PP1DP1_GPU45 [label="QKV Projection\nL14_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L14_EP1TP1PP1DP1_GPU45 [label="Multi-Head Attention\nL14_EP1TP1PP1DP1_GPU45\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L14_EP1TP1PP1DP1_GPU45 [label="Attention Output Proj\nL14_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L14_EP1TP1PP1DP1_GPU45 [label="Attention All-Reduce\nL14 EP1 TP Group 1 PP1 DP1\nGPU45" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L14_EP1TP1PP1DP1_GPU45 [label="Residual Add 1\nL14_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L14_EP1TP1PP1DP1_GPU45 [label="Layer Norm 2\nL14_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L14_EP1TP1PP1DP1_GPU45 [label="MoE Gate (Routing)\nL14_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L14_EP1TP1PP1DP1_GPU45 [label="Expert Dispatch\nL14_EP1TP1PP1DP1_GPU45" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L14_EP1TP1PP1DP1_GPU45 [label="Expert 0\nL14_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L14_EP1TP1PP1DP1_GPU45 [label="Expert 1\nL14_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L14_EP1TP1PP1DP1_GPU45 [label="Expert 2\nL14_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L14_EP1TP1PP1DP1_GPU45 [label="Expert 3\nL14_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L14_EP1TP1PP1DP1_GPU45 [label="Expert Combine\nL14_EP1TP1PP1DP1_GPU45" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L14_EP1TP1PP1DP1_GPU45 [label="FFN (Up-proj + GeLU + Down-proj)\nL14_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L14_EP1TP1PP1DP1_GPU45 [label="FFN All-Reduce\nL14 EP1 TP Group 1 PP1 DP1\nGPU45" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L14_EP1TP1PP1DP1_GPU45 [label="Residual Add 2\nL14_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L14_EP1TP2PP1DP0_GPU52 [label="Layer Norm 1\nL14_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L14_EP1TP2PP1DP0_GPU52 [label="QKV Projection\nL14_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L14_EP1TP2PP1DP0_GPU52 [label="Multi-Head Attention\nL14_EP1TP2PP1DP0_GPU52\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L14_EP1TP2PP1DP0_GPU52 [label="Attention Output Proj\nL14_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L14_EP1TP2PP1DP0_GPU52 [label="Attention All-Reduce\nL14 EP1 TP Group 2 PP1 DP0\nGPU52" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L14_EP1TP2PP1DP0_GPU52 [label="Residual Add 1\nL14_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L14_EP1TP2PP1DP0_GPU52 [label="Layer Norm 2\nL14_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L14_EP1TP2PP1DP0_GPU52 [label="MoE Gate (Routing)\nL14_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L14_EP1TP2PP1DP0_GPU52 [label="Expert Dispatch\nL14_EP1TP2PP1DP0_GPU52" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L14_EP1TP2PP1DP0_GPU52 [label="Expert 0\nL14_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L14_EP1TP2PP1DP0_GPU52 [label="Expert 1\nL14_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L14_EP1TP2PP1DP0_GPU52 [label="Expert 2\nL14_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L14_EP1TP2PP1DP0_GPU52 [label="Expert 3\nL14_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L14_EP1TP2PP1DP0_GPU52 [label="Expert Combine\nL14_EP1TP2PP1DP0_GPU52" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L14_EP1TP2PP1DP0_GPU52 [label="FFN (Up-proj + GeLU + Down-proj)\nL14_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L14_EP1TP2PP1DP0_GPU52 [label="FFN All-Reduce\nL14 EP1 TP Group 2 PP1 DP0\nGPU52" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L14_EP1TP2PP1DP0_GPU52 [label="Residual Add 2\nL14_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L14_EP1TP2PP1DP1_GPU53 [label="Layer Norm 1\nL14_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L14_EP1TP2PP1DP1_GPU53 [label="QKV Projection\nL14_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L14_EP1TP2PP1DP1_GPU53 [label="Multi-Head Attention\nL14_EP1TP2PP1DP1_GPU53\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L14_EP1TP2PP1DP1_GPU53 [label="Attention Output Proj\nL14_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L14_EP1TP2PP1DP1_GPU53 [label="Attention All-Reduce\nL14 EP1 TP Group 2 PP1 DP1\nGPU53" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L14_EP1TP2PP1DP1_GPU53 [label="Residual Add 1\nL14_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L14_EP1TP2PP1DP1_GPU53 [label="Layer Norm 2\nL14_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L14_EP1TP2PP1DP1_GPU53 [label="MoE Gate (Routing)\nL14_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L14_EP1TP2PP1DP1_GPU53 [label="Expert Dispatch\nL14_EP1TP2PP1DP1_GPU53" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L14_EP1TP2PP1DP1_GPU53 [label="Expert 0\nL14_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L14_EP1TP2PP1DP1_GPU53 [label="Expert 1\nL14_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L14_EP1TP2PP1DP1_GPU53 [label="Expert 2\nL14_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L14_EP1TP2PP1DP1_GPU53 [label="Expert 3\nL14_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L14_EP1TP2PP1DP1_GPU53 [label="Expert Combine\nL14_EP1TP2PP1DP1_GPU53" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L14_EP1TP2PP1DP1_GPU53 [label="FFN (Up-proj + GeLU + Down-proj)\nL14_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L14_EP1TP2PP1DP1_GPU53 [label="FFN All-Reduce\nL14 EP1 TP Group 2 PP1 DP1\nGPU53" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L14_EP1TP2PP1DP1_GPU53 [label="Residual Add 2\nL14_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L14_EP1TP3PP1DP0_GPU60 [label="Layer Norm 1\nL14_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L14_EP1TP3PP1DP0_GPU60 [label="QKV Projection\nL14_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L14_EP1TP3PP1DP0_GPU60 [label="Multi-Head Attention\nL14_EP1TP3PP1DP0_GPU60\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L14_EP1TP3PP1DP0_GPU60 [label="Attention Output Proj\nL14_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L14_EP1TP3PP1DP0_GPU60 [label="Attention All-Reduce\nL14 EP1 TP Group 3 PP1 DP0\nGPU60" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L14_EP1TP3PP1DP0_GPU60 [label="Residual Add 1\nL14_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L14_EP1TP3PP1DP0_GPU60 [label="Layer Norm 2\nL14_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L14_EP1TP3PP1DP0_GPU60 [label="MoE Gate (Routing)\nL14_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L14_EP1TP3PP1DP0_GPU60 [label="Expert Dispatch\nL14_EP1TP3PP1DP0_GPU60" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L14_EP1TP3PP1DP0_GPU60 [label="Expert 0\nL14_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L14_EP1TP3PP1DP0_GPU60 [label="Expert 1\nL14_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L14_EP1TP3PP1DP0_GPU60 [label="Expert 2\nL14_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L14_EP1TP3PP1DP0_GPU60 [label="Expert 3\nL14_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L14_EP1TP3PP1DP0_GPU60 [label="Expert Combine\nL14_EP1TP3PP1DP0_GPU60" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L14_EP1TP3PP1DP0_GPU60 [label="FFN (Up-proj + GeLU + Down-proj)\nL14_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L14_EP1TP3PP1DP0_GPU60 [label="FFN All-Reduce\nL14 EP1 TP Group 3 PP1 DP0\nGPU60" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L14_EP1TP3PP1DP0_GPU60 [label="Residual Add 2\nL14_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L14_EP1TP3PP1DP1_GPU61 [label="Layer Norm 1\nL14_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L14_EP1TP3PP1DP1_GPU61 [label="QKV Projection\nL14_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L14_EP1TP3PP1DP1_GPU61 [label="Multi-Head Attention\nL14_EP1TP3PP1DP1_GPU61\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L14_EP1TP3PP1DP1_GPU61 [label="Attention Output Proj\nL14_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L14_EP1TP3PP1DP1_GPU61 [label="Attention All-Reduce\nL14 EP1 TP Group 3 PP1 DP1\nGPU61" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L14_EP1TP3PP1DP1_GPU61 [label="Residual Add 1\nL14_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L14_EP1TP3PP1DP1_GPU61 [label="Layer Norm 2\nL14_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L14_EP1TP3PP1DP1_GPU61 [label="MoE Gate (Routing)\nL14_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L14_EP1TP3PP1DP1_GPU61 [label="Expert Dispatch\nL14_EP1TP3PP1DP1_GPU61" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L14_EP1TP3PP1DP1_GPU61 [label="Expert 0\nL14_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L14_EP1TP3PP1DP1_GPU61 [label="Expert 1\nL14_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L14_EP1TP3PP1DP1_GPU61 [label="Expert 2\nL14_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L14_EP1TP3PP1DP1_GPU61 [label="Expert 3\nL14_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L14_EP1TP3PP1DP1_GPU61 [label="Expert Combine\nL14_EP1TP3PP1DP1_GPU61" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L14_EP1TP3PP1DP1_GPU61 [label="FFN (Up-proj + GeLU + Down-proj)\nL14_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L14_EP1TP3PP1DP1_GPU61 [label="FFN All-Reduce\nL14 EP1 TP Group 3 PP1 DP1\nGPU61" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L14_EP1TP3PP1DP1_GPU61 [label="Residual Add 2\nL14_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L15_EP0TP0PP1DP0_GPU4 [label="Layer Norm 1\nL15_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L15_EP0TP0PP1DP0_GPU4 [label="QKV Projection\nL15_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L15_EP0TP0PP1DP0_GPU4 [label="Multi-Head Attention\nL15_EP0TP0PP1DP0_GPU4\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L15_EP0TP0PP1DP0_GPU4 [label="Attention Output Proj\nL15_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L15_EP0TP0PP1DP0_GPU4 [label="Attention All-Reduce\nL15 EP0 TP Group 0 PP1 DP0\nGPU4" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L15_EP0TP0PP1DP0_GPU4 [label="Residual Add 1\nL15_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L15_EP0TP0PP1DP0_GPU4 [label="Layer Norm 2\nL15_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L15_EP0TP0PP1DP0_GPU4 [label="MoE Gate (Routing)\nL15_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L15_EP0TP0PP1DP0_GPU4 [label="Expert Dispatch\nL15_EP0TP0PP1DP0_GPU4" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L15_EP0TP0PP1DP0_GPU4 [label="Expert 0\nL15_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L15_EP0TP0PP1DP0_GPU4 [label="Expert 1\nL15_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L15_EP0TP0PP1DP0_GPU4 [label="Expert 2\nL15_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L15_EP0TP0PP1DP0_GPU4 [label="Expert 3\nL15_EP0TP0PP1DP0_GPU4\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L15_EP0TP0PP1DP0_GPU4 [label="Expert Combine\nL15_EP0TP0PP1DP0_GPU4" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L15_EP0TP0PP1DP0_GPU4 [label="FFN (Up-proj + GeLU + Down-proj)\nL15_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L15_EP0TP0PP1DP0_GPU4 [label="FFN All-Reduce\nL15 EP0 TP Group 0 PP1 DP0\nGPU4" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L15_EP0TP0PP1DP0_GPU4 [label="Residual Add 2\nL15_EP0TP0PP1DP0_GPU4\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L15_EP0TP0PP1DP1_GPU5 [label="Layer Norm 1\nL15_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L15_EP0TP0PP1DP1_GPU5 [label="QKV Projection\nL15_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L15_EP0TP0PP1DP1_GPU5 [label="Multi-Head Attention\nL15_EP0TP0PP1DP1_GPU5\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L15_EP0TP0PP1DP1_GPU5 [label="Attention Output Proj\nL15_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L15_EP0TP0PP1DP1_GPU5 [label="Attention All-Reduce\nL15 EP0 TP Group 0 PP1 DP1\nGPU5" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L15_EP0TP0PP1DP1_GPU5 [label="Residual Add 1\nL15_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L15_EP0TP0PP1DP1_GPU5 [label="Layer Norm 2\nL15_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L15_EP0TP0PP1DP1_GPU5 [label="MoE Gate (Routing)\nL15_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L15_EP0TP0PP1DP1_GPU5 [label="Expert Dispatch\nL15_EP0TP0PP1DP1_GPU5" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L15_EP0TP0PP1DP1_GPU5 [label="Expert 0\nL15_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L15_EP0TP0PP1DP1_GPU5 [label="Expert 1\nL15_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L15_EP0TP0PP1DP1_GPU5 [label="Expert 2\nL15_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L15_EP0TP0PP1DP1_GPU5 [label="Expert 3\nL15_EP0TP0PP1DP1_GPU5\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L15_EP0TP0PP1DP1_GPU5 [label="Expert Combine\nL15_EP0TP0PP1DP1_GPU5" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L15_EP0TP0PP1DP1_GPU5 [label="FFN (Up-proj + GeLU + Down-proj)\nL15_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L15_EP0TP0PP1DP1_GPU5 [label="FFN All-Reduce\nL15 EP0 TP Group 0 PP1 DP1\nGPU5" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L15_EP0TP0PP1DP1_GPU5 [label="Residual Add 2\nL15_EP0TP0PP1DP1_GPU5\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L15_EP0TP1PP1DP0_GPU12 [label="Layer Norm 1\nL15_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L15_EP0TP1PP1DP0_GPU12 [label="QKV Projection\nL15_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L15_EP0TP1PP1DP0_GPU12 [label="Multi-Head Attention\nL15_EP0TP1PP1DP0_GPU12\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L15_EP0TP1PP1DP0_GPU12 [label="Attention Output Proj\nL15_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L15_EP0TP1PP1DP0_GPU12 [label="Attention All-Reduce\nL15 EP0 TP Group 1 PP1 DP0\nGPU12" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L15_EP0TP1PP1DP0_GPU12 [label="Residual Add 1\nL15_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L15_EP0TP1PP1DP0_GPU12 [label="Layer Norm 2\nL15_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L15_EP0TP1PP1DP0_GPU12 [label="MoE Gate (Routing)\nL15_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L15_EP0TP1PP1DP0_GPU12 [label="Expert Dispatch\nL15_EP0TP1PP1DP0_GPU12" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L15_EP0TP1PP1DP0_GPU12 [label="Expert 0\nL15_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L15_EP0TP1PP1DP0_GPU12 [label="Expert 1\nL15_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L15_EP0TP1PP1DP0_GPU12 [label="Expert 2\nL15_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L15_EP0TP1PP1DP0_GPU12 [label="Expert 3\nL15_EP0TP1PP1DP0_GPU12\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L15_EP0TP1PP1DP0_GPU12 [label="Expert Combine\nL15_EP0TP1PP1DP0_GPU12" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L15_EP0TP1PP1DP0_GPU12 [label="FFN (Up-proj + GeLU + Down-proj)\nL15_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L15_EP0TP1PP1DP0_GPU12 [label="FFN All-Reduce\nL15 EP0 TP Group 1 PP1 DP0\nGPU12" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L15_EP0TP1PP1DP0_GPU12 [label="Residual Add 2\nL15_EP0TP1PP1DP0_GPU12\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L15_EP0TP1PP1DP1_GPU13 [label="Layer Norm 1\nL15_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L15_EP0TP1PP1DP1_GPU13 [label="QKV Projection\nL15_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L15_EP0TP1PP1DP1_GPU13 [label="Multi-Head Attention\nL15_EP0TP1PP1DP1_GPU13\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L15_EP0TP1PP1DP1_GPU13 [label="Attention Output Proj\nL15_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L15_EP0TP1PP1DP1_GPU13 [label="Attention All-Reduce\nL15 EP0 TP Group 1 PP1 DP1\nGPU13" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L15_EP0TP1PP1DP1_GPU13 [label="Residual Add 1\nL15_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L15_EP0TP1PP1DP1_GPU13 [label="Layer Norm 2\nL15_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L15_EP0TP1PP1DP1_GPU13 [label="MoE Gate (Routing)\nL15_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L15_EP0TP1PP1DP1_GPU13 [label="Expert Dispatch\nL15_EP0TP1PP1DP1_GPU13" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L15_EP0TP1PP1DP1_GPU13 [label="Expert 0\nL15_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L15_EP0TP1PP1DP1_GPU13 [label="Expert 1\nL15_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L15_EP0TP1PP1DP1_GPU13 [label="Expert 2\nL15_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L15_EP0TP1PP1DP1_GPU13 [label="Expert 3\nL15_EP0TP1PP1DP1_GPU13\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L15_EP0TP1PP1DP1_GPU13 [label="Expert Combine\nL15_EP0TP1PP1DP1_GPU13" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L15_EP0TP1PP1DP1_GPU13 [label="FFN (Up-proj + GeLU + Down-proj)\nL15_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L15_EP0TP1PP1DP1_GPU13 [label="FFN All-Reduce\nL15 EP0 TP Group 1 PP1 DP1\nGPU13" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L15_EP0TP1PP1DP1_GPU13 [label="Residual Add 2\nL15_EP0TP1PP1DP1_GPU13\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L15_EP0TP2PP1DP0_GPU20 [label="Layer Norm 1\nL15_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L15_EP0TP2PP1DP0_GPU20 [label="QKV Projection\nL15_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L15_EP0TP2PP1DP0_GPU20 [label="Multi-Head Attention\nL15_EP0TP2PP1DP0_GPU20\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L15_EP0TP2PP1DP0_GPU20 [label="Attention Output Proj\nL15_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L15_EP0TP2PP1DP0_GPU20 [label="Attention All-Reduce\nL15 EP0 TP Group 2 PP1 DP0\nGPU20" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L15_EP0TP2PP1DP0_GPU20 [label="Residual Add 1\nL15_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L15_EP0TP2PP1DP0_GPU20 [label="Layer Norm 2\nL15_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L15_EP0TP2PP1DP0_GPU20 [label="MoE Gate (Routing)\nL15_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L15_EP0TP2PP1DP0_GPU20 [label="Expert Dispatch\nL15_EP0TP2PP1DP0_GPU20" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L15_EP0TP2PP1DP0_GPU20 [label="Expert 0\nL15_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L15_EP0TP2PP1DP0_GPU20 [label="Expert 1\nL15_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L15_EP0TP2PP1DP0_GPU20 [label="Expert 2\nL15_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L15_EP0TP2PP1DP0_GPU20 [label="Expert 3\nL15_EP0TP2PP1DP0_GPU20\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L15_EP0TP2PP1DP0_GPU20 [label="Expert Combine\nL15_EP0TP2PP1DP0_GPU20" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L15_EP0TP2PP1DP0_GPU20 [label="FFN (Up-proj + GeLU + Down-proj)\nL15_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L15_EP0TP2PP1DP0_GPU20 [label="FFN All-Reduce\nL15 EP0 TP Group 2 PP1 DP0\nGPU20" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L15_EP0TP2PP1DP0_GPU20 [label="Residual Add 2\nL15_EP0TP2PP1DP0_GPU20\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L15_EP0TP2PP1DP1_GPU21 [label="Layer Norm 1\nL15_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L15_EP0TP2PP1DP1_GPU21 [label="QKV Projection\nL15_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L15_EP0TP2PP1DP1_GPU21 [label="Multi-Head Attention\nL15_EP0TP2PP1DP1_GPU21\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L15_EP0TP2PP1DP1_GPU21 [label="Attention Output Proj\nL15_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L15_EP0TP2PP1DP1_GPU21 [label="Attention All-Reduce\nL15 EP0 TP Group 2 PP1 DP1\nGPU21" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L15_EP0TP2PP1DP1_GPU21 [label="Residual Add 1\nL15_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L15_EP0TP2PP1DP1_GPU21 [label="Layer Norm 2\nL15_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L15_EP0TP2PP1DP1_GPU21 [label="MoE Gate (Routing)\nL15_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L15_EP0TP2PP1DP1_GPU21 [label="Expert Dispatch\nL15_EP0TP2PP1DP1_GPU21" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L15_EP0TP2PP1DP1_GPU21 [label="Expert 0\nL15_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L15_EP0TP2PP1DP1_GPU21 [label="Expert 1\nL15_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L15_EP0TP2PP1DP1_GPU21 [label="Expert 2\nL15_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L15_EP0TP2PP1DP1_GPU21 [label="Expert 3\nL15_EP0TP2PP1DP1_GPU21\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L15_EP0TP2PP1DP1_GPU21 [label="Expert Combine\nL15_EP0TP2PP1DP1_GPU21" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L15_EP0TP2PP1DP1_GPU21 [label="FFN (Up-proj + GeLU + Down-proj)\nL15_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L15_EP0TP2PP1DP1_GPU21 [label="FFN All-Reduce\nL15 EP0 TP Group 2 PP1 DP1\nGPU21" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L15_EP0TP2PP1DP1_GPU21 [label="Residual Add 2\nL15_EP0TP2PP1DP1_GPU21\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L15_EP0TP3PP1DP0_GPU28 [label="Layer Norm 1\nL15_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L15_EP0TP3PP1DP0_GPU28 [label="QKV Projection\nL15_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L15_EP0TP3PP1DP0_GPU28 [label="Multi-Head Attention\nL15_EP0TP3PP1DP0_GPU28\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L15_EP0TP3PP1DP0_GPU28 [label="Attention Output Proj\nL15_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L15_EP0TP3PP1DP0_GPU28 [label="Attention All-Reduce\nL15 EP0 TP Group 3 PP1 DP0\nGPU28" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L15_EP0TP3PP1DP0_GPU28 [label="Residual Add 1\nL15_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L15_EP0TP3PP1DP0_GPU28 [label="Layer Norm 2\nL15_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L15_EP0TP3PP1DP0_GPU28 [label="MoE Gate (Routing)\nL15_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L15_EP0TP3PP1DP0_GPU28 [label="Expert Dispatch\nL15_EP0TP3PP1DP0_GPU28" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L15_EP0TP3PP1DP0_GPU28 [label="Expert 0\nL15_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L15_EP0TP3PP1DP0_GPU28 [label="Expert 1\nL15_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L15_EP0TP3PP1DP0_GPU28 [label="Expert 2\nL15_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L15_EP0TP3PP1DP0_GPU28 [label="Expert 3\nL15_EP0TP3PP1DP0_GPU28\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L15_EP0TP3PP1DP0_GPU28 [label="Expert Combine\nL15_EP0TP3PP1DP0_GPU28" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L15_EP0TP3PP1DP0_GPU28 [label="FFN (Up-proj + GeLU + Down-proj)\nL15_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L15_EP0TP3PP1DP0_GPU28 [label="FFN All-Reduce\nL15 EP0 TP Group 3 PP1 DP0\nGPU28" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L15_EP0TP3PP1DP0_GPU28 [label="Residual Add 2\nL15_EP0TP3PP1DP0_GPU28\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L15_EP0TP3PP1DP1_GPU29 [label="Layer Norm 1\nL15_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L15_EP0TP3PP1DP1_GPU29 [label="QKV Projection\nL15_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L15_EP0TP3PP1DP1_GPU29 [label="Multi-Head Attention\nL15_EP0TP3PP1DP1_GPU29\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L15_EP0TP3PP1DP1_GPU29 [label="Attention Output Proj\nL15_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L15_EP0TP3PP1DP1_GPU29 [label="Attention All-Reduce\nL15 EP0 TP Group 3 PP1 DP1\nGPU29" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L15_EP0TP3PP1DP1_GPU29 [label="Residual Add 1\nL15_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L15_EP0TP3PP1DP1_GPU29 [label="Layer Norm 2\nL15_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L15_EP0TP3PP1DP1_GPU29 [label="MoE Gate (Routing)\nL15_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L15_EP0TP3PP1DP1_GPU29 [label="Expert Dispatch\nL15_EP0TP3PP1DP1_GPU29" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L15_EP0TP3PP1DP1_GPU29 [label="Expert 0\nL15_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L15_EP0TP3PP1DP1_GPU29 [label="Expert 1\nL15_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L15_EP0TP3PP1DP1_GPU29 [label="Expert 2\nL15_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L15_EP0TP3PP1DP1_GPU29 [label="Expert 3\nL15_EP0TP3PP1DP1_GPU29\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L15_EP0TP3PP1DP1_GPU29 [label="Expert Combine\nL15_EP0TP3PP1DP1_GPU29" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L15_EP0TP3PP1DP1_GPU29 [label="FFN (Up-proj + GeLU + Down-proj)\nL15_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L15_EP0TP3PP1DP1_GPU29 [label="FFN All-Reduce\nL15 EP0 TP Group 3 PP1 DP1\nGPU29" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L15_EP0TP3PP1DP1_GPU29 [label="Residual Add 2\nL15_EP0TP3PP1DP1_GPU29\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L15_EP1TP0PP1DP0_GPU36 [label="Layer Norm 1\nL15_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L15_EP1TP0PP1DP0_GPU36 [label="QKV Projection\nL15_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L15_EP1TP0PP1DP0_GPU36 [label="Multi-Head Attention\nL15_EP1TP0PP1DP0_GPU36\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L15_EP1TP0PP1DP0_GPU36 [label="Attention Output Proj\nL15_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L15_EP1TP0PP1DP0_GPU36 [label="Attention All-Reduce\nL15 EP1 TP Group 0 PP1 DP0\nGPU36" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L15_EP1TP0PP1DP0_GPU36 [label="Residual Add 1\nL15_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L15_EP1TP0PP1DP0_GPU36 [label="Layer Norm 2\nL15_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L15_EP1TP0PP1DP0_GPU36 [label="MoE Gate (Routing)\nL15_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L15_EP1TP0PP1DP0_GPU36 [label="Expert Dispatch\nL15_EP1TP0PP1DP0_GPU36" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L15_EP1TP0PP1DP0_GPU36 [label="Expert 0\nL15_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L15_EP1TP0PP1DP0_GPU36 [label="Expert 1\nL15_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L15_EP1TP0PP1DP0_GPU36 [label="Expert 2\nL15_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L15_EP1TP0PP1DP0_GPU36 [label="Expert 3\nL15_EP1TP0PP1DP0_GPU36\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L15_EP1TP0PP1DP0_GPU36 [label="Expert Combine\nL15_EP1TP0PP1DP0_GPU36" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L15_EP1TP0PP1DP0_GPU36 [label="FFN (Up-proj + GeLU + Down-proj)\nL15_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L15_EP1TP0PP1DP0_GPU36 [label="FFN All-Reduce\nL15 EP1 TP Group 0 PP1 DP0\nGPU36" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L15_EP1TP0PP1DP0_GPU36 [label="Residual Add 2\nL15_EP1TP0PP1DP0_GPU36\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L15_EP1TP0PP1DP1_GPU37 [label="Layer Norm 1\nL15_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L15_EP1TP0PP1DP1_GPU37 [label="QKV Projection\nL15_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L15_EP1TP0PP1DP1_GPU37 [label="Multi-Head Attention\nL15_EP1TP0PP1DP1_GPU37\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L15_EP1TP0PP1DP1_GPU37 [label="Attention Output Proj\nL15_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L15_EP1TP0PP1DP1_GPU37 [label="Attention All-Reduce\nL15 EP1 TP Group 0 PP1 DP1\nGPU37" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L15_EP1TP0PP1DP1_GPU37 [label="Residual Add 1\nL15_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L15_EP1TP0PP1DP1_GPU37 [label="Layer Norm 2\nL15_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L15_EP1TP0PP1DP1_GPU37 [label="MoE Gate (Routing)\nL15_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L15_EP1TP0PP1DP1_GPU37 [label="Expert Dispatch\nL15_EP1TP0PP1DP1_GPU37" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L15_EP1TP0PP1DP1_GPU37 [label="Expert 0\nL15_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L15_EP1TP0PP1DP1_GPU37 [label="Expert 1\nL15_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L15_EP1TP0PP1DP1_GPU37 [label="Expert 2\nL15_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L15_EP1TP0PP1DP1_GPU37 [label="Expert 3\nL15_EP1TP0PP1DP1_GPU37\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L15_EP1TP0PP1DP1_GPU37 [label="Expert Combine\nL15_EP1TP0PP1DP1_GPU37" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L15_EP1TP0PP1DP1_GPU37 [label="FFN (Up-proj + GeLU + Down-proj)\nL15_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L15_EP1TP0PP1DP1_GPU37 [label="FFN All-Reduce\nL15 EP1 TP Group 0 PP1 DP1\nGPU37" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L15_EP1TP0PP1DP1_GPU37 [label="Residual Add 2\nL15_EP1TP0PP1DP1_GPU37\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L15_EP1TP1PP1DP0_GPU44 [label="Layer Norm 1\nL15_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L15_EP1TP1PP1DP0_GPU44 [label="QKV Projection\nL15_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L15_EP1TP1PP1DP0_GPU44 [label="Multi-Head Attention\nL15_EP1TP1PP1DP0_GPU44\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L15_EP1TP1PP1DP0_GPU44 [label="Attention Output Proj\nL15_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L15_EP1TP1PP1DP0_GPU44 [label="Attention All-Reduce\nL15 EP1 TP Group 1 PP1 DP0\nGPU44" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L15_EP1TP1PP1DP0_GPU44 [label="Residual Add 1\nL15_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L15_EP1TP1PP1DP0_GPU44 [label="Layer Norm 2\nL15_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L15_EP1TP1PP1DP0_GPU44 [label="MoE Gate (Routing)\nL15_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L15_EP1TP1PP1DP0_GPU44 [label="Expert Dispatch\nL15_EP1TP1PP1DP0_GPU44" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L15_EP1TP1PP1DP0_GPU44 [label="Expert 0\nL15_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L15_EP1TP1PP1DP0_GPU44 [label="Expert 1\nL15_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L15_EP1TP1PP1DP0_GPU44 [label="Expert 2\nL15_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L15_EP1TP1PP1DP0_GPU44 [label="Expert 3\nL15_EP1TP1PP1DP0_GPU44\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L15_EP1TP1PP1DP0_GPU44 [label="Expert Combine\nL15_EP1TP1PP1DP0_GPU44" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L15_EP1TP1PP1DP0_GPU44 [label="FFN (Up-proj + GeLU + Down-proj)\nL15_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L15_EP1TP1PP1DP0_GPU44 [label="FFN All-Reduce\nL15 EP1 TP Group 1 PP1 DP0\nGPU44" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L15_EP1TP1PP1DP0_GPU44 [label="Residual Add 2\nL15_EP1TP1PP1DP0_GPU44\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L15_EP1TP1PP1DP1_GPU45 [label="Layer Norm 1\nL15_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L15_EP1TP1PP1DP1_GPU45 [label="QKV Projection\nL15_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L15_EP1TP1PP1DP1_GPU45 [label="Multi-Head Attention\nL15_EP1TP1PP1DP1_GPU45\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L15_EP1TP1PP1DP1_GPU45 [label="Attention Output Proj\nL15_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L15_EP1TP1PP1DP1_GPU45 [label="Attention All-Reduce\nL15 EP1 TP Group 1 PP1 DP1\nGPU45" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L15_EP1TP1PP1DP1_GPU45 [label="Residual Add 1\nL15_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L15_EP1TP1PP1DP1_GPU45 [label="Layer Norm 2\nL15_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L15_EP1TP1PP1DP1_GPU45 [label="MoE Gate (Routing)\nL15_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L15_EP1TP1PP1DP1_GPU45 [label="Expert Dispatch\nL15_EP1TP1PP1DP1_GPU45" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L15_EP1TP1PP1DP1_GPU45 [label="Expert 0\nL15_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L15_EP1TP1PP1DP1_GPU45 [label="Expert 1\nL15_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L15_EP1TP1PP1DP1_GPU45 [label="Expert 2\nL15_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L15_EP1TP1PP1DP1_GPU45 [label="Expert 3\nL15_EP1TP1PP1DP1_GPU45\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L15_EP1TP1PP1DP1_GPU45 [label="Expert Combine\nL15_EP1TP1PP1DP1_GPU45" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L15_EP1TP1PP1DP1_GPU45 [label="FFN (Up-proj + GeLU + Down-proj)\nL15_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L15_EP1TP1PP1DP1_GPU45 [label="FFN All-Reduce\nL15 EP1 TP Group 1 PP1 DP1\nGPU45" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L15_EP1TP1PP1DP1_GPU45 [label="Residual Add 2\nL15_EP1TP1PP1DP1_GPU45\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L15_EP1TP2PP1DP0_GPU52 [label="Layer Norm 1\nL15_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L15_EP1TP2PP1DP0_GPU52 [label="QKV Projection\nL15_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L15_EP1TP2PP1DP0_GPU52 [label="Multi-Head Attention\nL15_EP1TP2PP1DP0_GPU52\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L15_EP1TP2PP1DP0_GPU52 [label="Attention Output Proj\nL15_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L15_EP1TP2PP1DP0_GPU52 [label="Attention All-Reduce\nL15 EP1 TP Group 2 PP1 DP0\nGPU52" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L15_EP1TP2PP1DP0_GPU52 [label="Residual Add 1\nL15_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L15_EP1TP2PP1DP0_GPU52 [label="Layer Norm 2\nL15_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L15_EP1TP2PP1DP0_GPU52 [label="MoE Gate (Routing)\nL15_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L15_EP1TP2PP1DP0_GPU52 [label="Expert Dispatch\nL15_EP1TP2PP1DP0_GPU52" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L15_EP1TP2PP1DP0_GPU52 [label="Expert 0\nL15_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L15_EP1TP2PP1DP0_GPU52 [label="Expert 1\nL15_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L15_EP1TP2PP1DP0_GPU52 [label="Expert 2\nL15_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L15_EP1TP2PP1DP0_GPU52 [label="Expert 3\nL15_EP1TP2PP1DP0_GPU52\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L15_EP1TP2PP1DP0_GPU52 [label="Expert Combine\nL15_EP1TP2PP1DP0_GPU52" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L15_EP1TP2PP1DP0_GPU52 [label="FFN (Up-proj + GeLU + Down-proj)\nL15_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L15_EP1TP2PP1DP0_GPU52 [label="FFN All-Reduce\nL15 EP1 TP Group 2 PP1 DP0\nGPU52" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L15_EP1TP2PP1DP0_GPU52 [label="Residual Add 2\nL15_EP1TP2PP1DP0_GPU52\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L15_EP1TP2PP1DP1_GPU53 [label="Layer Norm 1\nL15_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L15_EP1TP2PP1DP1_GPU53 [label="QKV Projection\nL15_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L15_EP1TP2PP1DP1_GPU53 [label="Multi-Head Attention\nL15_EP1TP2PP1DP1_GPU53\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L15_EP1TP2PP1DP1_GPU53 [label="Attention Output Proj\nL15_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L15_EP1TP2PP1DP1_GPU53 [label="Attention All-Reduce\nL15 EP1 TP Group 2 PP1 DP1\nGPU53" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L15_EP1TP2PP1DP1_GPU53 [label="Residual Add 1\nL15_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L15_EP1TP2PP1DP1_GPU53 [label="Layer Norm 2\nL15_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L15_EP1TP2PP1DP1_GPU53 [label="MoE Gate (Routing)\nL15_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L15_EP1TP2PP1DP1_GPU53 [label="Expert Dispatch\nL15_EP1TP2PP1DP1_GPU53" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L15_EP1TP2PP1DP1_GPU53 [label="Expert 0\nL15_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L15_EP1TP2PP1DP1_GPU53 [label="Expert 1\nL15_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L15_EP1TP2PP1DP1_GPU53 [label="Expert 2\nL15_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L15_EP1TP2PP1DP1_GPU53 [label="Expert 3\nL15_EP1TP2PP1DP1_GPU53\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L15_EP1TP2PP1DP1_GPU53 [label="Expert Combine\nL15_EP1TP2PP1DP1_GPU53" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L15_EP1TP2PP1DP1_GPU53 [label="FFN (Up-proj + GeLU + Down-proj)\nL15_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L15_EP1TP2PP1DP1_GPU53 [label="FFN All-Reduce\nL15 EP1 TP Group 2 PP1 DP1\nGPU53" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L15_EP1TP2PP1DP1_GPU53 [label="Residual Add 2\nL15_EP1TP2PP1DP1_GPU53\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L15_EP1TP3PP1DP0_GPU60 [label="Layer Norm 1\nL15_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L15_EP1TP3PP1DP0_GPU60 [label="QKV Projection\nL15_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L15_EP1TP3PP1DP0_GPU60 [label="Multi-Head Attention\nL15_EP1TP3PP1DP0_GPU60\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L15_EP1TP3PP1DP0_GPU60 [label="Attention Output Proj\nL15_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L15_EP1TP3PP1DP0_GPU60 [label="Attention All-Reduce\nL15 EP1 TP Group 3 PP1 DP0\nGPU60" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L15_EP1TP3PP1DP0_GPU60 [label="Residual Add 1\nL15_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L15_EP1TP3PP1DP0_GPU60 [label="Layer Norm 2\nL15_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L15_EP1TP3PP1DP0_GPU60 [label="MoE Gate (Routing)\nL15_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L15_EP1TP3PP1DP0_GPU60 [label="Expert Dispatch\nL15_EP1TP3PP1DP0_GPU60" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L15_EP1TP3PP1DP0_GPU60 [label="Expert 0\nL15_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L15_EP1TP3PP1DP0_GPU60 [label="Expert 1\nL15_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L15_EP1TP3PP1DP0_GPU60 [label="Expert 2\nL15_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L15_EP1TP3PP1DP0_GPU60 [label="Expert 3\nL15_EP1TP3PP1DP0_GPU60\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L15_EP1TP3PP1DP0_GPU60 [label="Expert Combine\nL15_EP1TP3PP1DP0_GPU60" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L15_EP1TP3PP1DP0_GPU60 [label="FFN (Up-proj + GeLU + Down-proj)\nL15_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L15_EP1TP3PP1DP0_GPU60 [label="FFN All-Reduce\nL15 EP1 TP Group 3 PP1 DP0\nGPU60" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L15_EP1TP3PP1DP0_GPU60 [label="Residual Add 2\nL15_EP1TP3PP1DP0_GPU60\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln1_L15_EP1TP3PP1DP1_GPU61 [label="Layer Norm 1\nL15_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	qkv_L15_EP1TP3PP1DP1_GPU61 [label="QKV Projection\nL15_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_L15_EP1TP3PP1DP1_GPU61 [label="Multi-Head Attention\nL15_EP1TP3PP1DP1_GPU61\nIn: [B=32,H=4,S=10240,D=64]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_out_L15_EP1TP3PP1DP1_GPU61 [label="Attention Output Proj\nL15_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	attn_ar_L15_EP1TP3PP1DP1_GPU61 [label="Attention All-Reduce\nL15 EP1 TP Group 3 PP1 DP1\nGPU61" fillcolor=lightblue shape=ellipse style=filled]
	residual1_L15_EP1TP3PP1DP1_GPU61 [label="Residual Add 1\nL15_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ln2_L15_EP1TP3PP1DP1_GPU61 [label="Layer Norm 2\nL15_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	gate_L15_EP1TP3PP1DP1_GPU61 [label="MoE Gate (Routing)\nL15_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,K=2]" fillcolor=lightyellow shape=parallelogram style=filled]
	dispatch_L15_EP1TP3PP1DP1_GPU61 [label="Expert Dispatch\nL15_EP1TP3PP1DP1_GPU61" fillcolor=lightblue shape=ellipse style="filled,dashed"]
	expert_0_L15_EP1TP3PP1DP1_GPU61 [label="Expert 0\nL15_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_1_L15_EP1TP3PP1DP1_GPU61 [label="Expert 1\nL15_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_2_L15_EP1TP3PP1DP1_GPU61 [label="Expert 2\nL15_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	expert_3_L15_EP1TP3PP1DP1_GPU61 [label="Expert 3\nL15_EP1TP3PP1DP1_GPU61\nIn: [B=4,S=10240,H=512]\nOut: [B=4,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	combine_L15_EP1TP3PP1DP1_GPU61 [label="Expert Combine\nL15_EP1TP3PP1DP1_GPU61" fillcolor=lightblue shape=ellipse style=filled]
	ffn_L15_EP1TP3PP1DP1_GPU61 [label="FFN (Up-proj + GeLU + Down-proj)\nL15_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	ffn_ar_L15_EP1TP3PP1DP1_GPU61 [label="FFN All-Reduce\nL15 EP1 TP Group 3 PP1 DP1\nGPU61" fillcolor=lightblue shape=ellipse style=filled]
	residual2_L15_EP1TP3PP1DP1_GPU61 [label="Residual Add 2\nL15_EP1TP3PP1DP1_GPU61\nIn: [B=32,S=10240,H=512]×2\nOut: [B=32,S=10240,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_start [label="Decode Phase Start\nSingle Token Processing" fillcolor=lightblue shape=box style=filled width=4]
	kv_read_EP0TP0PP0DP0_GPU0 [label="KV Cache Read\nEP0TP0PP0DP0_GPU0\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP0TP0PP0DP0_GPU0 [label="Decode Attention\nEP0TP0PP0DP0_GPU0\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP0TP0PP0DP0_GPU0 [label="KV Cache Update\nEP0TP0PP0DP0_GPU0" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP0TP0PP0DP1_GPU1 [label="KV Cache Read\nEP0TP0PP0DP1_GPU1\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP0TP0PP0DP1_GPU1 [label="Decode Attention\nEP0TP0PP0DP1_GPU1\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP0TP0PP0DP1_GPU1 [label="KV Cache Update\nEP0TP0PP0DP1_GPU1" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP0TP0PP1DP0_GPU4 [label="KV Cache Read\nEP0TP0PP1DP0_GPU4\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP0TP0PP1DP0_GPU4 [label="Decode Attention\nEP0TP0PP1DP0_GPU4\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP0TP0PP1DP0_GPU4 [label="KV Cache Update\nEP0TP0PP1DP0_GPU4" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP0TP0PP1DP1_GPU5 [label="KV Cache Read\nEP0TP0PP1DP1_GPU5\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP0TP0PP1DP1_GPU5 [label="Decode Attention\nEP0TP0PP1DP1_GPU5\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP0TP0PP1DP1_GPU5 [label="KV Cache Update\nEP0TP0PP1DP1_GPU5" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP0TP1PP0DP0_GPU8 [label="KV Cache Read\nEP0TP1PP0DP0_GPU8\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP0TP1PP0DP0_GPU8 [label="Decode Attention\nEP0TP1PP0DP0_GPU8\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP0TP1PP0DP0_GPU8 [label="KV Cache Update\nEP0TP1PP0DP0_GPU8" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP0TP1PP0DP1_GPU9 [label="KV Cache Read\nEP0TP1PP0DP1_GPU9\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP0TP1PP0DP1_GPU9 [label="Decode Attention\nEP0TP1PP0DP1_GPU9\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP0TP1PP0DP1_GPU9 [label="KV Cache Update\nEP0TP1PP0DP1_GPU9" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP0TP1PP1DP0_GPU12 [label="KV Cache Read\nEP0TP1PP1DP0_GPU12\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP0TP1PP1DP0_GPU12 [label="Decode Attention\nEP0TP1PP1DP0_GPU12\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP0TP1PP1DP0_GPU12 [label="KV Cache Update\nEP0TP1PP1DP0_GPU12" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP0TP1PP1DP1_GPU13 [label="KV Cache Read\nEP0TP1PP1DP1_GPU13\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP0TP1PP1DP1_GPU13 [label="Decode Attention\nEP0TP1PP1DP1_GPU13\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP0TP1PP1DP1_GPU13 [label="KV Cache Update\nEP0TP1PP1DP1_GPU13" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP0TP2PP0DP0_GPU16 [label="KV Cache Read\nEP0TP2PP0DP0_GPU16\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP0TP2PP0DP0_GPU16 [label="Decode Attention\nEP0TP2PP0DP0_GPU16\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP0TP2PP0DP0_GPU16 [label="KV Cache Update\nEP0TP2PP0DP0_GPU16" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP0TP2PP0DP1_GPU17 [label="KV Cache Read\nEP0TP2PP0DP1_GPU17\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP0TP2PP0DP1_GPU17 [label="Decode Attention\nEP0TP2PP0DP1_GPU17\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP0TP2PP0DP1_GPU17 [label="KV Cache Update\nEP0TP2PP0DP1_GPU17" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP0TP2PP1DP0_GPU20 [label="KV Cache Read\nEP0TP2PP1DP0_GPU20\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP0TP2PP1DP0_GPU20 [label="Decode Attention\nEP0TP2PP1DP0_GPU20\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP0TP2PP1DP0_GPU20 [label="KV Cache Update\nEP0TP2PP1DP0_GPU20" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP0TP2PP1DP1_GPU21 [label="KV Cache Read\nEP0TP2PP1DP1_GPU21\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP0TP2PP1DP1_GPU21 [label="Decode Attention\nEP0TP2PP1DP1_GPU21\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP0TP2PP1DP1_GPU21 [label="KV Cache Update\nEP0TP2PP1DP1_GPU21" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP0TP3PP0DP0_GPU24 [label="KV Cache Read\nEP0TP3PP0DP0_GPU24\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP0TP3PP0DP0_GPU24 [label="Decode Attention\nEP0TP3PP0DP0_GPU24\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP0TP3PP0DP0_GPU24 [label="KV Cache Update\nEP0TP3PP0DP0_GPU24" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP0TP3PP0DP1_GPU25 [label="KV Cache Read\nEP0TP3PP0DP1_GPU25\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP0TP3PP0DP1_GPU25 [label="Decode Attention\nEP0TP3PP0DP1_GPU25\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP0TP3PP0DP1_GPU25 [label="KV Cache Update\nEP0TP3PP0DP1_GPU25" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP0TP3PP1DP0_GPU28 [label="KV Cache Read\nEP0TP3PP1DP0_GPU28\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP0TP3PP1DP0_GPU28 [label="Decode Attention\nEP0TP3PP1DP0_GPU28\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP0TP3PP1DP0_GPU28 [label="KV Cache Update\nEP0TP3PP1DP0_GPU28" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP0TP3PP1DP1_GPU29 [label="KV Cache Read\nEP0TP3PP1DP1_GPU29\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP0TP3PP1DP1_GPU29 [label="Decode Attention\nEP0TP3PP1DP1_GPU29\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP0TP3PP1DP1_GPU29 [label="KV Cache Update\nEP0TP3PP1DP1_GPU29" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP1TP0PP0DP0_GPU32 [label="KV Cache Read\nEP1TP0PP0DP0_GPU32\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP1TP0PP0DP0_GPU32 [label="Decode Attention\nEP1TP0PP0DP0_GPU32\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP1TP0PP0DP0_GPU32 [label="KV Cache Update\nEP1TP0PP0DP0_GPU32" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP1TP0PP0DP1_GPU33 [label="KV Cache Read\nEP1TP0PP0DP1_GPU33\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP1TP0PP0DP1_GPU33 [label="Decode Attention\nEP1TP0PP0DP1_GPU33\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP1TP0PP0DP1_GPU33 [label="KV Cache Update\nEP1TP0PP0DP1_GPU33" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP1TP0PP1DP0_GPU36 [label="KV Cache Read\nEP1TP0PP1DP0_GPU36\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP1TP0PP1DP0_GPU36 [label="Decode Attention\nEP1TP0PP1DP0_GPU36\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP1TP0PP1DP0_GPU36 [label="KV Cache Update\nEP1TP0PP1DP0_GPU36" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP1TP0PP1DP1_GPU37 [label="KV Cache Read\nEP1TP0PP1DP1_GPU37\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP1TP0PP1DP1_GPU37 [label="Decode Attention\nEP1TP0PP1DP1_GPU37\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP1TP0PP1DP1_GPU37 [label="KV Cache Update\nEP1TP0PP1DP1_GPU37" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP1TP1PP0DP0_GPU40 [label="KV Cache Read\nEP1TP1PP0DP0_GPU40\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP1TP1PP0DP0_GPU40 [label="Decode Attention\nEP1TP1PP0DP0_GPU40\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP1TP1PP0DP0_GPU40 [label="KV Cache Update\nEP1TP1PP0DP0_GPU40" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP1TP1PP0DP1_GPU41 [label="KV Cache Read\nEP1TP1PP0DP1_GPU41\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP1TP1PP0DP1_GPU41 [label="Decode Attention\nEP1TP1PP0DP1_GPU41\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP1TP1PP0DP1_GPU41 [label="KV Cache Update\nEP1TP1PP0DP1_GPU41" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP1TP1PP1DP0_GPU44 [label="KV Cache Read\nEP1TP1PP1DP0_GPU44\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP1TP1PP1DP0_GPU44 [label="Decode Attention\nEP1TP1PP1DP0_GPU44\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP1TP1PP1DP0_GPU44 [label="KV Cache Update\nEP1TP1PP1DP0_GPU44" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP1TP1PP1DP1_GPU45 [label="KV Cache Read\nEP1TP1PP1DP1_GPU45\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP1TP1PP1DP1_GPU45 [label="Decode Attention\nEP1TP1PP1DP1_GPU45\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP1TP1PP1DP1_GPU45 [label="KV Cache Update\nEP1TP1PP1DP1_GPU45" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP1TP2PP0DP0_GPU48 [label="KV Cache Read\nEP1TP2PP0DP0_GPU48\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP1TP2PP0DP0_GPU48 [label="Decode Attention\nEP1TP2PP0DP0_GPU48\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP1TP2PP0DP0_GPU48 [label="KV Cache Update\nEP1TP2PP0DP0_GPU48" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP1TP2PP0DP1_GPU49 [label="KV Cache Read\nEP1TP2PP0DP1_GPU49\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP1TP2PP0DP1_GPU49 [label="Decode Attention\nEP1TP2PP0DP1_GPU49\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP1TP2PP0DP1_GPU49 [label="KV Cache Update\nEP1TP2PP0DP1_GPU49" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP1TP2PP1DP0_GPU52 [label="KV Cache Read\nEP1TP2PP1DP0_GPU52\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP1TP2PP1DP0_GPU52 [label="Decode Attention\nEP1TP2PP1DP0_GPU52\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP1TP2PP1DP0_GPU52 [label="KV Cache Update\nEP1TP2PP1DP0_GPU52" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP1TP2PP1DP1_GPU53 [label="KV Cache Read\nEP1TP2PP1DP1_GPU53\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP1TP2PP1DP1_GPU53 [label="Decode Attention\nEP1TP2PP1DP1_GPU53\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP1TP2PP1DP1_GPU53 [label="KV Cache Update\nEP1TP2PP1DP1_GPU53" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP1TP3PP0DP0_GPU56 [label="KV Cache Read\nEP1TP3PP0DP0_GPU56\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP1TP3PP0DP0_GPU56 [label="Decode Attention\nEP1TP3PP0DP0_GPU56\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP1TP3PP0DP0_GPU56 [label="KV Cache Update\nEP1TP3PP0DP0_GPU56" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP1TP3PP0DP1_GPU57 [label="KV Cache Read\nEP1TP3PP0DP1_GPU57\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP1TP3PP0DP1_GPU57 [label="Decode Attention\nEP1TP3PP0DP1_GPU57\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP1TP3PP0DP1_GPU57 [label="KV Cache Update\nEP1TP3PP0DP1_GPU57" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP1TP3PP1DP0_GPU60 [label="KV Cache Read\nEP1TP3PP1DP0_GPU60\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP1TP3PP1DP0_GPU60 [label="Decode Attention\nEP1TP3PP1DP0_GPU60\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP1TP3PP1DP0_GPU60 [label="KV Cache Update\nEP1TP3PP1DP0_GPU60" fillcolor=lightgreen shape=box style=filled]
	kv_read_EP1TP3PP1DP1_GPU61 [label="KV Cache Read\nEP1TP3PP1DP1_GPU61\nIn: [B=1,S=1,H=512]\nOut: [B=1,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	decode_attn_EP1TP3PP1DP1_GPU61 [label="Decode Attention\nEP1TP3PP1DP1_GPU61\nIn: [B=1,H=4,S=1,D=64]\nOut: [B=1,H=4,S=1,D=64]" fillcolor=lightgreen shape=box style=filled]
	kv_write_EP1TP3PP1DP1_GPU61 [label="KV Cache Update\nEP1TP3PP1DP1_GPU61" fillcolor=lightgreen shape=box style=filled]
	decode_end [label="Decode Phase End\nAll Tokens Processed" fillcolor=lightblue shape=box style=filled width=4]
	output_start [label="Output Phase Start" fillcolor=lightblue shape=box style=filled]
	final_ln_EP0TP0DP0_GPU4 [label="Final Layer Norm\nEP0TP0DP0_GPU4\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	output_proj_EP0TP0DP0_GPU4 [label="Output Projection\nEP0TP0DP0_GPU4\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,V=8000]" fillcolor=lightgreen shape=box style=filled]
	final_ar_EP0TP0DP0_GPU4 [label="Final All-Reduce\nEP0 TP Group 0 DP0\nGPU4" fillcolor=lightblue shape=ellipse style=filled]
	final_ln_EP0TP0DP1_GPU5 [label="Final Layer Norm\nEP0TP0DP1_GPU5\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	output_proj_EP0TP0DP1_GPU5 [label="Output Projection\nEP0TP0DP1_GPU5\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,V=8000]" fillcolor=lightgreen shape=box style=filled]
	final_ar_EP0TP0DP1_GPU5 [label="Final All-Reduce\nEP0 TP Group 0 DP1\nGPU5" fillcolor=lightblue shape=ellipse style=filled]
	final_ln_EP0TP1DP0_GPU12 [label="Final Layer Norm\nEP0TP1DP0_GPU12\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	output_proj_EP0TP1DP0_GPU12 [label="Output Projection\nEP0TP1DP0_GPU12\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,V=8000]" fillcolor=lightgreen shape=box style=filled]
	final_ar_EP0TP1DP0_GPU12 [label="Final All-Reduce\nEP0 TP Group 1 DP0\nGPU12" fillcolor=lightblue shape=ellipse style=filled]
	final_ln_EP0TP1DP1_GPU13 [label="Final Layer Norm\nEP0TP1DP1_GPU13\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	output_proj_EP0TP1DP1_GPU13 [label="Output Projection\nEP0TP1DP1_GPU13\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,V=8000]" fillcolor=lightgreen shape=box style=filled]
	final_ar_EP0TP1DP1_GPU13 [label="Final All-Reduce\nEP0 TP Group 1 DP1\nGPU13" fillcolor=lightblue shape=ellipse style=filled]
	final_ln_EP0TP2DP0_GPU20 [label="Final Layer Norm\nEP0TP2DP0_GPU20\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	output_proj_EP0TP2DP0_GPU20 [label="Output Projection\nEP0TP2DP0_GPU20\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,V=8000]" fillcolor=lightgreen shape=box style=filled]
	final_ar_EP0TP2DP0_GPU20 [label="Final All-Reduce\nEP0 TP Group 2 DP0\nGPU20" fillcolor=lightblue shape=ellipse style=filled]
	final_ln_EP0TP2DP1_GPU21 [label="Final Layer Norm\nEP0TP2DP1_GPU21\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	output_proj_EP0TP2DP1_GPU21 [label="Output Projection\nEP0TP2DP1_GPU21\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,V=8000]" fillcolor=lightgreen shape=box style=filled]
	final_ar_EP0TP2DP1_GPU21 [label="Final All-Reduce\nEP0 TP Group 2 DP1\nGPU21" fillcolor=lightblue shape=ellipse style=filled]
	final_ln_EP0TP3DP0_GPU28 [label="Final Layer Norm\nEP0TP3DP0_GPU28\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	output_proj_EP0TP3DP0_GPU28 [label="Output Projection\nEP0TP3DP0_GPU28\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,V=8000]" fillcolor=lightgreen shape=box style=filled]
	final_ar_EP0TP3DP0_GPU28 [label="Final All-Reduce\nEP0 TP Group 3 DP0\nGPU28" fillcolor=lightblue shape=ellipse style=filled]
	final_ln_EP0TP3DP1_GPU29 [label="Final Layer Norm\nEP0TP3DP1_GPU29\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	output_proj_EP0TP3DP1_GPU29 [label="Output Projection\nEP0TP3DP1_GPU29\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,V=8000]" fillcolor=lightgreen shape=box style=filled]
	final_ar_EP0TP3DP1_GPU29 [label="Final All-Reduce\nEP0 TP Group 3 DP1\nGPU29" fillcolor=lightblue shape=ellipse style=filled]
	final_ln_EP1TP0DP0_GPU36 [label="Final Layer Norm\nEP1TP0DP0_GPU36\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	output_proj_EP1TP0DP0_GPU36 [label="Output Projection\nEP1TP0DP0_GPU36\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,V=8000]" fillcolor=lightgreen shape=box style=filled]
	final_ar_EP1TP0DP0_GPU36 [label="Final All-Reduce\nEP1 TP Group 0 DP0\nGPU36" fillcolor=lightblue shape=ellipse style=filled]
	final_ln_EP1TP0DP1_GPU37 [label="Final Layer Norm\nEP1TP0DP1_GPU37\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	output_proj_EP1TP0DP1_GPU37 [label="Output Projection\nEP1TP0DP1_GPU37\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,V=8000]" fillcolor=lightgreen shape=box style=filled]
	final_ar_EP1TP0DP1_GPU37 [label="Final All-Reduce\nEP1 TP Group 0 DP1\nGPU37" fillcolor=lightblue shape=ellipse style=filled]
	final_ln_EP1TP1DP0_GPU44 [label="Final Layer Norm\nEP1TP1DP0_GPU44\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	output_proj_EP1TP1DP0_GPU44 [label="Output Projection\nEP1TP1DP0_GPU44\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,V=8000]" fillcolor=lightgreen shape=box style=filled]
	final_ar_EP1TP1DP0_GPU44 [label="Final All-Reduce\nEP1 TP Group 1 DP0\nGPU44" fillcolor=lightblue shape=ellipse style=filled]
	final_ln_EP1TP1DP1_GPU45 [label="Final Layer Norm\nEP1TP1DP1_GPU45\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	output_proj_EP1TP1DP1_GPU45 [label="Output Projection\nEP1TP1DP1_GPU45\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,V=8000]" fillcolor=lightgreen shape=box style=filled]
	final_ar_EP1TP1DP1_GPU45 [label="Final All-Reduce\nEP1 TP Group 1 DP1\nGPU45" fillcolor=lightblue shape=ellipse style=filled]
	final_ln_EP1TP2DP0_GPU52 [label="Final Layer Norm\nEP1TP2DP0_GPU52\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	output_proj_EP1TP2DP0_GPU52 [label="Output Projection\nEP1TP2DP0_GPU52\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,V=8000]" fillcolor=lightgreen shape=box style=filled]
	final_ar_EP1TP2DP0_GPU52 [label="Final All-Reduce\nEP1 TP Group 2 DP0\nGPU52" fillcolor=lightblue shape=ellipse style=filled]
	final_ln_EP1TP2DP1_GPU53 [label="Final Layer Norm\nEP1TP2DP1_GPU53\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	output_proj_EP1TP2DP1_GPU53 [label="Output Projection\nEP1TP2DP1_GPU53\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,V=8000]" fillcolor=lightgreen shape=box style=filled]
	final_ar_EP1TP2DP1_GPU53 [label="Final All-Reduce\nEP1 TP Group 2 DP1\nGPU53" fillcolor=lightblue shape=ellipse style=filled]
	final_ln_EP1TP3DP0_GPU60 [label="Final Layer Norm\nEP1TP3DP0_GPU60\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	output_proj_EP1TP3DP0_GPU60 [label="Output Projection\nEP1TP3DP0_GPU60\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,V=8000]" fillcolor=lightgreen shape=box style=filled]
	final_ar_EP1TP3DP0_GPU60 [label="Final All-Reduce\nEP1 TP Group 3 DP0\nGPU60" fillcolor=lightblue shape=ellipse style=filled]
	final_ln_EP1TP3DP1_GPU61 [label="Final Layer Norm\nEP1TP3DP1_GPU61\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,H=512]" fillcolor=lightgreen shape=box style=filled]
	output_proj_EP1TP3DP1_GPU61 [label="Output Projection\nEP1TP3DP1_GPU61\nIn: [B=32,S=1,H=512]\nOut: [B=32,S=1,V=8000]" fillcolor=lightgreen shape=box style=filled]
	final_ar_EP1TP3DP1_GPU61 [label="Final All-Reduce\nEP1 TP Group 3 DP1\nGPU61" fillcolor=lightblue shape=ellipse style=filled]
	final_output [label="Final Output\nBatch: 128, Vocab: 32000" fillcolor=lightgreen shape=box style=filled width=4]
}
