<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1170pt" height="1440pt"
 viewBox="0.00 0.00 1169.58 1440.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.49 0.49) rotate(0) translate(4 2948.26)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2948.26 2393.85,-2948.26 2393.85,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightblue" stroke="black" points="209.83,-2912.76 90.83,-2912.76 90.83,-2871.76 209.83,-2871.76 209.83,-2912.76"/>
<text text-anchor="middle" x="150.33" y="-2900.76" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="150.33" y="-2889.76" font-family="Arial" font-size="10.00">Batch: 128, Seq: 10240</text>
<text text-anchor="middle" x="150.33" y="-2878.76" font-family="Arial" font-size="10.00">Dim: 1024</text>
</g>
<!-- prefill_start -->
<g id="node2" class="node">
<title>prefill_start</title>
<polygon fill="lightblue" stroke="black" points="198.33,-2732.26 102.33,-2732.26 102.33,-2696.26 198.33,-2696.26 198.33,-2732.26"/>
<text text-anchor="middle" x="150.33" y="-2711.76" font-family="Arial" font-size="10.00">Prefill Phase Start</text>
</g>
<!-- input&#45;&gt;prefill_start -->
<g id="edge1" class="edge">
<title>input&#45;&gt;prefill_start</title>
<path fill="none" stroke="black" d="M145.9,-2871.75C143.03,-2840.37 142.82,-2778.55 145.27,-2742.72"/>
<polygon fill="black" stroke="black" points="148.78,-2742.75 146.11,-2732.5 141.8,-2742.17 148.78,-2742.75"/>
</g>
<!-- input&#45;&gt;prefill_start -->
<g id="edge19" class="edge">
<title>input&#45;&gt;prefill_start</title>
<path fill="none" stroke="black" d="M154.76,-2871.75C157.63,-2840.37 157.84,-2778.55 155.39,-2742.72"/>
<polygon fill="black" stroke="black" points="158.86,-2742.17 154.54,-2732.5 151.88,-2742.75 158.86,-2742.17"/>
</g>
<!-- embed_tp0_gpu0 -->
<g id="node3" class="node">
<title>embed_tp0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="226.33,-2588.26 74.33,-2588.26 74.33,-2525.26 226.33,-2525.26 226.33,-2588.26"/>
<text text-anchor="middle" x="150.33" y="-2576.26" font-family="Arial" font-size="10.00">Embedding</text>
<text text-anchor="middle" x="150.33" y="-2565.26" font-family="Arial" font-size="10.00">TP0</text>
<text text-anchor="middle" x="150.33" y="-2554.26" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="150.33" y="-2543.26" font-family="Arial" font-size="10.00">In: [B=128,S=10240,D=1024]</text>
<text text-anchor="middle" x="150.33" y="-2532.26" font-family="Arial" font-size="10.00">Out: [B=128,S=10240,H=2048]</text>
</g>
<!-- prefill_start&#45;&gt;embed_tp0_gpu0 -->
<g id="edge2" class="edge">
<title>prefill_start&#45;&gt;embed_tp0_gpu0</title>
<path fill="none" stroke="black" d="M150.33,-2696.03C150.33,-2672.72 150.33,-2630.44 150.33,-2598.75"/>
<polygon fill="black" stroke="black" points="153.83,-2598.45 150.33,-2588.45 146.83,-2598.45 153.83,-2598.45"/>
</g>
<!-- embed_ar_tp0_gpu0 -->
<g id="node7" class="node">
<title>embed_ar_tp0_gpu0</title>
<ellipse fill="lightblue" stroke="black" cx="150.33" cy="-2388.27" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="150.33" y="-2396.77" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="150.33" y="-2385.77" font-family="Arial" font-size="10.00">TP0</text>
<text text-anchor="middle" x="150.33" y="-2374.77" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- embed_tp0_gpu0&#45;&gt;embed_ar_tp0_gpu0 -->
<g id="edge3" class="edge">
<title>embed_tp0_gpu0&#45;&gt;embed_ar_tp0_gpu0</title>
<path fill="none" stroke="black" d="M150.33,-2525.22C150.33,-2497.8 150.33,-2457.41 150.33,-2427.78"/>
<polygon fill="black" stroke="black" points="153.83,-2427.4 150.33,-2417.4 146.83,-2427.4 153.83,-2427.4"/>
</g>
<!-- embed_tp0_gpu4 -->
<g id="node4" class="node">
<title>embed_tp0_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="380.33,-2923.76 228.33,-2923.76 228.33,-2860.76 380.33,-2860.76 380.33,-2923.76"/>
<text text-anchor="middle" x="304.33" y="-2911.76" font-family="Arial" font-size="10.00">Embedding</text>
<text text-anchor="middle" x="304.33" y="-2900.76" font-family="Arial" font-size="10.00">TP0</text>
<text text-anchor="middle" x="304.33" y="-2889.76" font-family="Arial" font-size="10.00">GPU4</text>
<text text-anchor="middle" x="304.33" y="-2878.76" font-family="Arial" font-size="10.00">In: [B=128,S=10240,D=1024]</text>
<text text-anchor="middle" x="304.33" y="-2867.76" font-family="Arial" font-size="10.00">Out: [B=128,S=10240,H=2048]</text>
</g>
<!-- embed_tp1_gpu1 -->
<g id="node5" class="node">
<title>embed_tp1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="550.33,-2923.76 398.33,-2923.76 398.33,-2860.76 550.33,-2860.76 550.33,-2923.76"/>
<text text-anchor="middle" x="474.33" y="-2911.76" font-family="Arial" font-size="10.00">Embedding</text>
<text text-anchor="middle" x="474.33" y="-2900.76" font-family="Arial" font-size="10.00">TP1</text>
<text text-anchor="middle" x="474.33" y="-2889.76" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="474.33" y="-2878.76" font-family="Arial" font-size="10.00">In: [B=128,S=10240,D=1024]</text>
<text text-anchor="middle" x="474.33" y="-2867.76" font-family="Arial" font-size="10.00">Out: [B=128,S=10240,H=2048]</text>
</g>
<!-- embed_tp1_gpu5 -->
<g id="node6" class="node">
<title>embed_tp1_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="720.33,-2923.76 568.33,-2923.76 568.33,-2860.76 720.33,-2860.76 720.33,-2923.76"/>
<text text-anchor="middle" x="644.33" y="-2911.76" font-family="Arial" font-size="10.00">Embedding</text>
<text text-anchor="middle" x="644.33" y="-2900.76" font-family="Arial" font-size="10.00">TP1</text>
<text text-anchor="middle" x="644.33" y="-2889.76" font-family="Arial" font-size="10.00">GPU5</text>
<text text-anchor="middle" x="644.33" y="-2878.76" font-family="Arial" font-size="10.00">In: [B=128,S=10240,D=1024]</text>
<text text-anchor="middle" x="644.33" y="-2867.76" font-family="Arial" font-size="10.00">Out: [B=128,S=10240,H=2048]</text>
</g>
<!-- ln1_l0_gpu0 -->
<g id="node11" class="node">
<title>ln1_l0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="226.33,-2251.28 74.33,-2251.28 74.33,-2199.28 226.33,-2199.28 226.33,-2251.28"/>
<text text-anchor="middle" x="150.33" y="-2239.28" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="150.33" y="-2228.28" font-family="Arial" font-size="10.00">L0 GPU0</text>
<text text-anchor="middle" x="150.33" y="-2217.28" font-family="Arial" font-size="10.00">In: [B=128,S=10240,H=2048]</text>
<text text-anchor="middle" x="150.33" y="-2206.28" font-family="Arial" font-size="10.00">Out: [B=128,S=10240,H=2048]</text>
</g>
<!-- embed_ar_tp0_gpu0&#45;&gt;ln1_l0_gpu0 -->
<g id="edge4" class="edge">
<title>embed_ar_tp0_gpu0&#45;&gt;ln1_l0_gpu0</title>
<path fill="none" stroke="black" d="M150.33,-2359.23C150.33,-2332.11 150.33,-2290.92 150.33,-2261.58"/>
<polygon fill="black" stroke="black" points="153.83,-2261.36 150.33,-2251.36 146.83,-2261.36 153.83,-2261.36"/>
</g>
<!-- embed_ar_tp0_gpu4 -->
<g id="node8" class="node">
<title>embed_ar_tp0_gpu4</title>
<ellipse fill="lightblue" stroke="black" cx="820.33" cy="-2892.26" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="820.33" y="-2900.76" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="820.33" y="-2889.76" font-family="Arial" font-size="10.00">TP0</text>
<text text-anchor="middle" x="820.33" y="-2878.76" font-family="Arial" font-size="10.00">GPU4</text>
</g>
<!-- embed_ar_tp1_gpu1 -->
<g id="node9" class="node">
<title>embed_ar_tp1_gpu1</title>
<ellipse fill="lightblue" stroke="black" cx="1002.33" cy="-2892.26" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="1002.33" y="-2900.76" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="1002.33" y="-2889.76" font-family="Arial" font-size="10.00">TP1</text>
<text text-anchor="middle" x="1002.33" y="-2878.76" font-family="Arial" font-size="10.00">GPU1</text>
</g>
<!-- embed_ar_tp1_gpu5 -->
<g id="node10" class="node">
<title>embed_ar_tp1_gpu5</title>
<ellipse fill="lightblue" stroke="black" cx="1184.33" cy="-2892.26" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="1184.33" y="-2900.76" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="1184.33" y="-2889.76" font-family="Arial" font-size="10.00">TP1</text>
<text text-anchor="middle" x="1184.33" y="-2878.76" font-family="Arial" font-size="10.00">GPU5</text>
</g>
<!-- qkv_l0_gpu0 -->
<g id="node12" class="node">
<title>qkv_l0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="226.33,-2091.28 74.33,-2091.28 74.33,-2039.28 226.33,-2039.28 226.33,-2091.28"/>
<text text-anchor="middle" x="150.33" y="-2079.28" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="150.33" y="-2068.28" font-family="Arial" font-size="10.00">L0 GPU0</text>
<text text-anchor="middle" x="150.33" y="-2057.28" font-family="Arial" font-size="10.00">In: [B=128,S=10240,H=2048]</text>
<text text-anchor="middle" x="150.33" y="-2046.28" font-family="Arial" font-size="10.00">Out: [B=128,S=10240,H=2048]</text>
</g>
<!-- ln1_l0_gpu0&#45;&gt;qkv_l0_gpu0 -->
<g id="edge5" class="edge">
<title>ln1_l0_gpu0&#45;&gt;qkv_l0_gpu0</title>
<path fill="none" stroke="black" d="M150.33,-2199.24C150.33,-2172.97 150.33,-2131.45 150.33,-2101.8"/>
<polygon fill="black" stroke="black" points="153.83,-2101.46 150.33,-2091.46 146.83,-2101.46 153.83,-2101.46"/>
</g>
<!-- attn_l0_gpu0 -->
<g id="node13" class="node">
<title>attn_l0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="234.83,-1931.28 65.83,-1931.28 65.83,-1879.28 234.83,-1879.28 234.83,-1931.28"/>
<text text-anchor="middle" x="150.33" y="-1919.28" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="150.33" y="-1908.28" font-family="Arial" font-size="10.00">L0 GPU0</text>
<text text-anchor="middle" x="150.33" y="-1897.28" font-family="Arial" font-size="10.00">In: [B=128,H=16,S=10240,D=64]</text>
<text text-anchor="middle" x="150.33" y="-1886.28" font-family="Arial" font-size="10.00">Out: [B=128,H=16,S=10240,D=64]</text>
</g>
<!-- qkv_l0_gpu0&#45;&gt;attn_l0_gpu0 -->
<g id="edge6" class="edge">
<title>qkv_l0_gpu0&#45;&gt;attn_l0_gpu0</title>
<path fill="none" stroke="black" d="M150.33,-2039.24C150.33,-2012.97 150.33,-1971.45 150.33,-1941.8"/>
<polygon fill="black" stroke="black" points="153.83,-1941.46 150.33,-1931.46 146.83,-1941.46 153.83,-1941.46"/>
</g>
<!-- gate_l0_gpu0 -->
<g id="node14" class="node">
<title>gate_l0_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="300.49,-1771.28 61.62,-1771.28 0.17,-1667.28 239.04,-1667.28 300.49,-1771.28"/>
<text text-anchor="middle" x="150.33" y="-1733.28" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="150.33" y="-1722.28" font-family="Arial" font-size="10.00">L0 GPU0</text>
<text text-anchor="middle" x="150.33" y="-1711.28" font-family="Arial" font-size="10.00">In: [B=128,S=10240,H=2048]</text>
<text text-anchor="middle" x="150.33" y="-1700.28" font-family="Arial" font-size="10.00">Out: [B=128,S=10240,K=2]</text>
</g>
<!-- attn_l0_gpu0&#45;&gt;gate_l0_gpu0 -->
<g id="edge7" class="edge">
<title>attn_l0_gpu0&#45;&gt;gate_l0_gpu0</title>
<path fill="none" stroke="black" d="M150.33,-1879.08C150.33,-1854.11 150.33,-1814.88 150.33,-1781.66"/>
<polygon fill="black" stroke="black" points="153.83,-1781.57 150.33,-1771.57 146.83,-1781.57 153.83,-1781.57"/>
</g>
<!-- dispatch_l0_gpu0 -->
<g id="node15" class="node">
<title>dispatch_l0_gpu0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="150.33" cy="-1538.07" rx="61.54" ry="21.43"/>
<text text-anchor="middle" x="150.33" y="-1541.07" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="150.33" y="-1530.07" font-family="Arial" font-size="10.00">L0 GPU0</text>
</g>
<!-- gate_l0_gpu0&#45;&gt;dispatch_l0_gpu0 -->
<g id="edge8" class="edge">
<title>gate_l0_gpu0&#45;&gt;dispatch_l0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M150.33,-1666.92C150.33,-1635.47 150.33,-1596.28 150.33,-1569.63"/>
<polygon fill="black" stroke="black" points="153.83,-1569.39 150.33,-1559.39 146.83,-1569.39 153.83,-1569.39"/>
</g>
<!-- expert_l0_gpu0 -->
<g id="node16" class="node">
<title>expert_l0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="223.83,-1408.85 76.83,-1408.85 76.83,-1356.85 223.83,-1356.85 223.83,-1408.85"/>
<text text-anchor="middle" x="150.33" y="-1396.85" font-family="Arial" font-size="10.00">Expert Compute</text>
<text text-anchor="middle" x="150.33" y="-1385.85" font-family="Arial" font-size="10.00">L0 GPU0</text>
<text text-anchor="middle" x="150.33" y="-1374.85" font-family="Arial" font-size="10.00">In: [B=16,S=10240,H=2048]</text>
<text text-anchor="middle" x="150.33" y="-1363.85" font-family="Arial" font-size="10.00">Out: [B=16,S=10240,H=2048]</text>
</g>
<!-- dispatch_l0_gpu0&#45;&gt;expert_l0_gpu0 -->
<g id="edge9" class="edge">
<title>dispatch_l0_gpu0&#45;&gt;expert_l0_gpu0</title>
<path fill="none" stroke="black" d="M150.33,-1516.72C150.33,-1491.82 150.33,-1449.24 150.33,-1419"/>
<polygon fill="black" stroke="black" points="153.83,-1418.86 150.33,-1408.86 146.83,-1418.86 153.83,-1418.86"/>
</g>
<!-- combine_l0_gpu0 -->
<g id="node17" class="node">
<title>combine_l0_gpu0</title>
<ellipse fill="lightblue" stroke="black" cx="150.33" cy="-1227.64" rx="61.54" ry="21.43"/>
<text text-anchor="middle" x="150.33" y="-1230.64" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="150.33" y="-1219.64" font-family="Arial" font-size="10.00">L0 GPU0</text>
</g>
<!-- expert_l0_gpu0&#45;&gt;combine_l0_gpu0 -->
<g id="edge10" class="edge">
<title>expert_l0_gpu0&#45;&gt;combine_l0_gpu0</title>
<path fill="none" stroke="black" d="M150.33,-1356.55C150.33,-1329.87 150.33,-1287.83 150.33,-1259.29"/>
<polygon fill="black" stroke="black" points="153.83,-1259.07 150.33,-1249.07 146.83,-1259.07 153.83,-1259.07"/>
</g>
<!-- pipeline_send_gpu0_to_gpu128 -->
<g id="node18" class="node">
<title>pipeline_send_gpu0_to_gpu128</title>
<ellipse fill="lightblue" stroke="black" cx="150.33" cy="-1077.21" rx="64.19" ry="21.43"/>
<text text-anchor="middle" x="150.33" y="-1080.21" font-family="Arial" font-size="10.00">Pipeline Send</text>
<text text-anchor="middle" x="150.33" y="-1069.21" font-family="Arial" font-size="10.00">GPU0â†’GPU128</text>
</g>
<!-- combine_l0_gpu0&#45;&gt;pipeline_send_gpu0_to_gpu128 -->
<g id="edge11" class="edge">
<title>combine_l0_gpu0&#45;&gt;pipeline_send_gpu0_to_gpu128</title>
<path fill="none" stroke="black" d="M150.33,-1206.31C150.33,-1181.14 150.33,-1138.02 150.33,-1108.83"/>
<polygon fill="black" stroke="black" points="153.83,-1108.77 150.33,-1098.77 146.83,-1108.77 153.83,-1108.77"/>
</g>
<!-- ln1_l8_gpu128 -->
<g id="node19" class="node">
<title>ln1_l8_gpu128</title>
<polygon fill="lightgreen" stroke="black" points="226.33,-948 74.33,-948 74.33,-896 226.33,-896 226.33,-948"/>
<text text-anchor="middle" x="150.33" y="-936" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="150.33" y="-925" font-family="Arial" font-size="10.00">L8 GPU128</text>
<text text-anchor="middle" x="150.33" y="-914" font-family="Arial" font-size="10.00">In: [B=128,S=10240,H=2048]</text>
<text text-anchor="middle" x="150.33" y="-903" font-family="Arial" font-size="10.00">Out: [B=128,S=10240,H=2048]</text>
</g>
<!-- pipeline_send_gpu0_to_gpu128&#45;&gt;ln1_l8_gpu128 -->
<g id="edge12" class="edge">
<title>pipeline_send_gpu0_to_gpu128&#45;&gt;ln1_l8_gpu128</title>
<path fill="none" stroke="black" d="M150.33,-1055.87C150.33,-1030.96 150.33,-988.38 150.33,-958.14"/>
<polygon fill="black" stroke="black" points="153.83,-958.01 150.33,-948.01 146.83,-958.01 153.83,-958.01"/>
</g>
<!-- prefill_end -->
<g id="node26" class="node">
<title>prefill_end</title>
<polygon fill="lightblue" stroke="black" points="196.33,-788 104.33,-788 104.33,-752 196.33,-752 196.33,-788"/>
<text text-anchor="middle" x="150.33" y="-767.5" font-family="Arial" font-size="10.00">Prefill Phase End</text>
</g>
<!-- ln1_l8_gpu128&#45;&gt;prefill_end -->
<g id="edge13" class="edge">
<title>ln1_l8_gpu128&#45;&gt;prefill_end</title>
<path fill="none" stroke="black" d="M150.33,-895.89C150.33,-868.95 150.33,-826.27 150.33,-798.45"/>
<polygon fill="black" stroke="black" points="153.83,-798.23 150.33,-788.23 146.83,-798.23 153.83,-798.23"/>
</g>
<!-- qkv_l8_gpu128 -->
<g id="node20" class="node">
<title>qkv_l8_gpu128</title>
<polygon fill="lightgreen" stroke="black" points="1436.33,-2918.26 1284.33,-2918.26 1284.33,-2866.26 1436.33,-2866.26 1436.33,-2918.26"/>
<text text-anchor="middle" x="1360.33" y="-2906.26" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1360.33" y="-2895.26" font-family="Arial" font-size="10.00">L8 GPU128</text>
<text text-anchor="middle" x="1360.33" y="-2884.26" font-family="Arial" font-size="10.00">In: [B=128,S=10240,H=2048]</text>
<text text-anchor="middle" x="1360.33" y="-2873.26" font-family="Arial" font-size="10.00">Out: [B=128,S=10240,H=2048]</text>
</g>
<!-- attn_l8_gpu128 -->
<g id="node21" class="node">
<title>attn_l8_gpu128</title>
<polygon fill="lightgreen" stroke="black" points="1623.83,-2918.26 1454.83,-2918.26 1454.83,-2866.26 1623.83,-2866.26 1623.83,-2918.26"/>
<text text-anchor="middle" x="1539.33" y="-2906.26" font-family="Arial" font-size="10.00">Self&#45;Attention</text>
<text text-anchor="middle" x="1539.33" y="-2895.26" font-family="Arial" font-size="10.00">L8 GPU128</text>
<text text-anchor="middle" x="1539.33" y="-2884.26" font-family="Arial" font-size="10.00">In: [B=128,H=16,S=10240,D=64]</text>
<text text-anchor="middle" x="1539.33" y="-2873.26" font-family="Arial" font-size="10.00">Out: [B=128,H=16,S=10240,D=64]</text>
</g>
<!-- gate_l8_gpu128 -->
<g id="node22" class="node">
<title>gate_l8_gpu128</title>
<polygon fill="lightyellow" stroke="black" points="1942.49,-2944.26 1703.62,-2944.26 1642.17,-2840.26 1881.04,-2840.26 1942.49,-2944.26"/>
<text text-anchor="middle" x="1792.33" y="-2906.26" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="1792.33" y="-2895.26" font-family="Arial" font-size="10.00">L8 GPU128</text>
<text text-anchor="middle" x="1792.33" y="-2884.26" font-family="Arial" font-size="10.00">In: [B=128,S=10240,H=2048]</text>
<text text-anchor="middle" x="1792.33" y="-2873.26" font-family="Arial" font-size="10.00">Out: [B=128,S=10240,K=2]</text>
</g>
<!-- dispatch_l8_gpu128 -->
<g id="node23" class="node">
<title>dispatch_l8_gpu128</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2022.33" cy="-2892.26" rx="61.54" ry="21.43"/>
<text text-anchor="middle" x="2022.33" y="-2895.26" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="2022.33" y="-2884.26" font-family="Arial" font-size="10.00">L8 GPU128</text>
</g>
<!-- expert_l8_gpu128 -->
<g id="node24" class="node">
<title>expert_l8_gpu128</title>
<polygon fill="lightgreen" stroke="black" points="2248.83,-2918.26 2101.83,-2918.26 2101.83,-2866.26 2248.83,-2866.26 2248.83,-2918.26"/>
<text text-anchor="middle" x="2175.33" y="-2906.26" font-family="Arial" font-size="10.00">Expert Compute</text>
<text text-anchor="middle" x="2175.33" y="-2895.26" font-family="Arial" font-size="10.00">L8 GPU128</text>
<text text-anchor="middle" x="2175.33" y="-2884.26" font-family="Arial" font-size="10.00">In: [B=16,S=10240,H=2048]</text>
<text text-anchor="middle" x="2175.33" y="-2873.26" font-family="Arial" font-size="10.00">Out: [B=16,S=10240,H=2048]</text>
</g>
<!-- combine_l8_gpu128 -->
<g id="node25" class="node">
<title>combine_l8_gpu128</title>
<ellipse fill="lightblue" stroke="black" cx="2328.33" cy="-2892.26" rx="61.54" ry="21.43"/>
<text text-anchor="middle" x="2328.33" y="-2895.26" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="2328.33" y="-2884.26" font-family="Arial" font-size="10.00">L8 GPU128</text>
</g>
<!-- decode_start -->
<g id="node27" class="node">
<title>decode_start</title>
<polygon fill="lightblue" stroke="black" points="202.83,-644 97.83,-644 97.83,-608 202.83,-608 202.83,-644"/>
<text text-anchor="middle" x="150.33" y="-623.5" font-family="Arial" font-size="10.00">Decode Phase Start</text>
</g>
<!-- prefill_end&#45;&gt;decode_start -->
<g id="edge14" class="edge">
<title>prefill_end&#45;&gt;decode_start</title>
<path fill="none" stroke="black" d="M145.74,-751.87C143.19,-727.67 142.89,-683.21 144.87,-654.39"/>
<polygon fill="black" stroke="black" points="148.38,-654.45 145.74,-644.19 141.4,-653.86 148.38,-654.45"/>
</g>
<!-- prefill_end&#45;&gt;decode_start -->
<g id="edge20" class="edge">
<title>prefill_end&#45;&gt;decode_start</title>
<path fill="none" stroke="black" d="M154.91,-751.87C157.47,-727.67 157.76,-683.21 155.79,-654.39"/>
<polygon fill="black" stroke="black" points="159.26,-653.86 154.92,-644.19 152.28,-654.45 159.26,-653.86"/>
</g>
<!-- kv_cache_read_gpu0 -->
<g id="node28" class="node">
<title>kv_cache_read_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="210.83,-500 89.83,-500 89.83,-448 210.83,-448 210.83,-500"/>
<text text-anchor="middle" x="150.33" y="-488" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="150.33" y="-477" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="150.33" y="-466" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=2048]</text>
<text text-anchor="middle" x="150.33" y="-455" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=2048]</text>
</g>
<!-- decode_start&#45;&gt;kv_cache_read_gpu0 -->
<g id="edge15" class="edge">
<title>decode_start&#45;&gt;kv_cache_read_gpu0</title>
<path fill="none" stroke="black" d="M150.33,-607.79C150.33,-584.18 150.33,-541.18 150.33,-510.51"/>
<polygon fill="black" stroke="black" points="153.83,-510.23 150.33,-500.23 146.83,-510.23 153.83,-510.23"/>
</g>
<!-- decode_layer_gpu0 -->
<g id="node29" class="node">
<title>decode_layer_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="210.83,-340 89.83,-340 89.83,-288 210.83,-288 210.83,-340"/>
<text text-anchor="middle" x="150.33" y="-328" font-family="Arial" font-size="10.00">Decode Layer</text>
<text text-anchor="middle" x="150.33" y="-317" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="150.33" y="-306" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=2048]</text>
<text text-anchor="middle" x="150.33" y="-295" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=2048]</text>
</g>
<!-- kv_cache_read_gpu0&#45;&gt;decode_layer_gpu0 -->
<g id="edge16" class="edge">
<title>kv_cache_read_gpu0&#45;&gt;decode_layer_gpu0</title>
<path fill="none" stroke="black" d="M150.33,-447.96C150.33,-421.69 150.33,-380.17 150.33,-350.52"/>
<polygon fill="black" stroke="black" points="153.83,-350.18 150.33,-340.18 146.83,-350.18 153.83,-350.18"/>
</g>
<!-- kv_cache_write_gpu0 -->
<g id="node30" class="node">
<title>kv_cache_write_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="198.33,-180 102.33,-180 102.33,-144 198.33,-144 198.33,-180"/>
<text text-anchor="middle" x="150.33" y="-165" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="150.33" y="-154" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- decode_layer_gpu0&#45;&gt;kv_cache_write_gpu0 -->
<g id="edge17" class="edge">
<title>decode_layer_gpu0&#45;&gt;kv_cache_write_gpu0</title>
<path fill="none" stroke="black" d="M150.33,-287.89C150.33,-260.95 150.33,-218.27 150.33,-190.45"/>
<polygon fill="black" stroke="black" points="153.83,-190.23 150.33,-180.23 146.83,-190.23 153.83,-190.23"/>
</g>
<!-- decode_end -->
<g id="node31" class="node">
<title>decode_end</title>
<polygon fill="lightblue" stroke="black" points="200.83,-36 99.83,-36 99.83,0 200.83,0 200.83,-36"/>
<text text-anchor="middle" x="150.33" y="-15.5" font-family="Arial" font-size="10.00">Decode Phase End</text>
</g>
<!-- kv_cache_write_gpu0&#45;&gt;decode_end -->
<g id="edge18" class="edge">
<title>kv_cache_write_gpu0&#45;&gt;decode_end</title>
<path fill="none" stroke="black" d="M150.33,-143.87C150.33,-119.67 150.33,-75.21 150.33,-46.39"/>
<polygon fill="black" stroke="black" points="153.83,-46.19 150.33,-36.19 146.83,-46.19 153.83,-46.19"/>
</g>
</g>
</svg>
