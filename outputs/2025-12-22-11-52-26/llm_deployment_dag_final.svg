<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="2880pt" height="0pt"
 viewBox="0.00 0.00 2880.00 0.34" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0 0) rotate(0) translate(4 108)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-108 935793,-108 935793,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightblue" stroke="black" points="216,-72.5 0,-72.5 0,-31.5 216,-31.5 216,-72.5"/>
<text text-anchor="middle" x="108" y="-60.5" font-family="Arial" font-size="10.00">Input Data</text>
<text text-anchor="middle" x="108" y="-49.5" font-family="Arial" font-size="10.00">Batch: 128, Seq: 10240</text>
<text text-anchor="middle" x="108" y="-38.5" font-family="Arial" font-size="10.00">Total: 1310720 tokens</text>
</g>
<!-- prefill_start -->
<g id="node2" class="node">
<title>prefill_start</title>
<polygon fill="lightblue" stroke="black" points="540,-70 252,-70 252,-34 540,-34 540,-70"/>
<text text-anchor="middle" x="396" y="-55" font-family="Arial" font-size="10.00">Prefill Phase Start</text>
<text text-anchor="middle" x="396" y="-44" font-family="Arial" font-size="10.00">All 256 GPUs Active</text>
</g>
<!-- embed_dp0_tp0_gpu0 -->
<g id="node3" class="node">
<title>embed_dp0_tp0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="718,-83.5 576,-83.5 576,-20.5 718,-20.5 718,-83.5"/>
<text text-anchor="middle" x="647" y="-71.5" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="647" y="-60.5" font-family="Arial" font-size="10.00">DP0&#45;TP0</text>
<text text-anchor="middle" x="647" y="-49.5" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="647" y="-38.5" font-family="Arial" font-size="10.00">In: [B=32,S=10240,D=1024]</text>
<text text-anchor="middle" x="647" y="-27.5" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- embed_ar_dp0_tp0_gpu0 -->
<g id="node4" class="node">
<title>embed_ar_dp0_tp0_gpu0</title>
<ellipse fill="lightblue" stroke="black" cx="836" cy="-52" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="836" y="-60.5" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="836" y="-49.5" font-family="Arial" font-size="10.00">DP0 TP Group 0</text>
<text text-anchor="middle" x="836" y="-38.5" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- embed_dp0_tp1_gpu8 -->
<g id="node5" class="node">
<title>embed_dp0_tp1_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="1096,-83.5 954,-83.5 954,-20.5 1096,-20.5 1096,-83.5"/>
<text text-anchor="middle" x="1025" y="-71.5" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="1025" y="-60.5" font-family="Arial" font-size="10.00">DP0&#45;TP1</text>
<text text-anchor="middle" x="1025" y="-49.5" font-family="Arial" font-size="10.00">GPU8</text>
<text text-anchor="middle" x="1025" y="-38.5" font-family="Arial" font-size="10.00">In: [B=32,S=10240,D=1024]</text>
<text text-anchor="middle" x="1025" y="-27.5" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- embed_ar_dp0_tp1_gpu8 -->
<g id="node6" class="node">
<title>embed_ar_dp0_tp1_gpu8</title>
<ellipse fill="lightblue" stroke="black" cx="1214" cy="-52" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="1214" y="-60.5" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="1214" y="-49.5" font-family="Arial" font-size="10.00">DP0 TP Group 1</text>
<text text-anchor="middle" x="1214" y="-38.5" font-family="Arial" font-size="10.00">GPU8</text>
</g>
<!-- embed_dp0_tp2_gpu16 -->
<g id="node7" class="node">
<title>embed_dp0_tp2_gpu16</title>
<polygon fill="lightgreen" stroke="black" points="1474,-83.5 1332,-83.5 1332,-20.5 1474,-20.5 1474,-83.5"/>
<text text-anchor="middle" x="1403" y="-71.5" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="1403" y="-60.5" font-family="Arial" font-size="10.00">DP0&#45;TP2</text>
<text text-anchor="middle" x="1403" y="-49.5" font-family="Arial" font-size="10.00">GPU16</text>
<text text-anchor="middle" x="1403" y="-38.5" font-family="Arial" font-size="10.00">In: [B=32,S=10240,D=1024]</text>
<text text-anchor="middle" x="1403" y="-27.5" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- embed_ar_dp0_tp2_gpu16 -->
<g id="node8" class="node">
<title>embed_ar_dp0_tp2_gpu16</title>
<ellipse fill="lightblue" stroke="black" cx="1592" cy="-52" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="1592" y="-60.5" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="1592" y="-49.5" font-family="Arial" font-size="10.00">DP0 TP Group 2</text>
<text text-anchor="middle" x="1592" y="-38.5" font-family="Arial" font-size="10.00">GPU16</text>
</g>
<!-- embed_dp0_tp3_gpu24 -->
<g id="node9" class="node">
<title>embed_dp0_tp3_gpu24</title>
<polygon fill="lightgreen" stroke="black" points="1852,-83.5 1710,-83.5 1710,-20.5 1852,-20.5 1852,-83.5"/>
<text text-anchor="middle" x="1781" y="-71.5" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="1781" y="-60.5" font-family="Arial" font-size="10.00">DP0&#45;TP3</text>
<text text-anchor="middle" x="1781" y="-49.5" font-family="Arial" font-size="10.00">GPU24</text>
<text text-anchor="middle" x="1781" y="-38.5" font-family="Arial" font-size="10.00">In: [B=32,S=10240,D=1024]</text>
<text text-anchor="middle" x="1781" y="-27.5" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- embed_ar_dp0_tp3_gpu24 -->
<g id="node10" class="node">
<title>embed_ar_dp0_tp3_gpu24</title>
<ellipse fill="lightblue" stroke="black" cx="1970" cy="-52" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="1970" y="-60.5" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="1970" y="-49.5" font-family="Arial" font-size="10.00">DP0 TP Group 3</text>
<text text-anchor="middle" x="1970" y="-38.5" font-family="Arial" font-size="10.00">GPU24</text>
</g>
<!-- embed_dp1_tp0_gpu1 -->
<g id="node11" class="node">
<title>embed_dp1_tp0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2230,-83.5 2088,-83.5 2088,-20.5 2230,-20.5 2230,-83.5"/>
<text text-anchor="middle" x="2159" y="-71.5" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="2159" y="-60.5" font-family="Arial" font-size="10.00">DP1&#45;TP0</text>
<text text-anchor="middle" x="2159" y="-49.5" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="2159" y="-38.5" font-family="Arial" font-size="10.00">In: [B=32,S=10240,D=1024]</text>
<text text-anchor="middle" x="2159" y="-27.5" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- embed_ar_dp1_tp0_gpu1 -->
<g id="node12" class="node">
<title>embed_ar_dp1_tp0_gpu1</title>
<ellipse fill="lightblue" stroke="black" cx="2348" cy="-52" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="2348" y="-60.5" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="2348" y="-49.5" font-family="Arial" font-size="10.00">DP1 TP Group 0</text>
<text text-anchor="middle" x="2348" y="-38.5" font-family="Arial" font-size="10.00">GPU1</text>
</g>
<!-- embed_dp1_tp1_gpu9 -->
<g id="node13" class="node">
<title>embed_dp1_tp1_gpu9</title>
<polygon fill="lightgreen" stroke="black" points="2608,-83.5 2466,-83.5 2466,-20.5 2608,-20.5 2608,-83.5"/>
<text text-anchor="middle" x="2537" y="-71.5" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="2537" y="-60.5" font-family="Arial" font-size="10.00">DP1&#45;TP1</text>
<text text-anchor="middle" x="2537" y="-49.5" font-family="Arial" font-size="10.00">GPU9</text>
<text text-anchor="middle" x="2537" y="-38.5" font-family="Arial" font-size="10.00">In: [B=32,S=10240,D=1024]</text>
<text text-anchor="middle" x="2537" y="-27.5" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- embed_ar_dp1_tp1_gpu9 -->
<g id="node14" class="node">
<title>embed_ar_dp1_tp1_gpu9</title>
<ellipse fill="lightblue" stroke="black" cx="2726" cy="-52" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="2726" y="-60.5" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="2726" y="-49.5" font-family="Arial" font-size="10.00">DP1 TP Group 1</text>
<text text-anchor="middle" x="2726" y="-38.5" font-family="Arial" font-size="10.00">GPU9</text>
</g>
<!-- embed_dp1_tp2_gpu17 -->
<g id="node15" class="node">
<title>embed_dp1_tp2_gpu17</title>
<polygon fill="lightgreen" stroke="black" points="2986,-83.5 2844,-83.5 2844,-20.5 2986,-20.5 2986,-83.5"/>
<text text-anchor="middle" x="2915" y="-71.5" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="2915" y="-60.5" font-family="Arial" font-size="10.00">DP1&#45;TP2</text>
<text text-anchor="middle" x="2915" y="-49.5" font-family="Arial" font-size="10.00">GPU17</text>
<text text-anchor="middle" x="2915" y="-38.5" font-family="Arial" font-size="10.00">In: [B=32,S=10240,D=1024]</text>
<text text-anchor="middle" x="2915" y="-27.5" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- embed_ar_dp1_tp2_gpu17 -->
<g id="node16" class="node">
<title>embed_ar_dp1_tp2_gpu17</title>
<ellipse fill="lightblue" stroke="black" cx="3104" cy="-52" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="3104" y="-60.5" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="3104" y="-49.5" font-family="Arial" font-size="10.00">DP1 TP Group 2</text>
<text text-anchor="middle" x="3104" y="-38.5" font-family="Arial" font-size="10.00">GPU17</text>
</g>
<!-- embed_dp1_tp3_gpu25 -->
<g id="node17" class="node">
<title>embed_dp1_tp3_gpu25</title>
<polygon fill="lightgreen" stroke="black" points="3364,-83.5 3222,-83.5 3222,-20.5 3364,-20.5 3364,-83.5"/>
<text text-anchor="middle" x="3293" y="-71.5" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="3293" y="-60.5" font-family="Arial" font-size="10.00">DP1&#45;TP3</text>
<text text-anchor="middle" x="3293" y="-49.5" font-family="Arial" font-size="10.00">GPU25</text>
<text text-anchor="middle" x="3293" y="-38.5" font-family="Arial" font-size="10.00">In: [B=32,S=10240,D=1024]</text>
<text text-anchor="middle" x="3293" y="-27.5" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- embed_ar_dp1_tp3_gpu25 -->
<g id="node18" class="node">
<title>embed_ar_dp1_tp3_gpu25</title>
<ellipse fill="lightblue" stroke="black" cx="3482" cy="-52" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="3482" y="-60.5" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="3482" y="-49.5" font-family="Arial" font-size="10.00">DP1 TP Group 3</text>
<text text-anchor="middle" x="3482" y="-38.5" font-family="Arial" font-size="10.00">GPU25</text>
</g>
<!-- embed_dp2_tp0_gpu2 -->
<g id="node19" class="node">
<title>embed_dp2_tp0_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="3742,-83.5 3600,-83.5 3600,-20.5 3742,-20.5 3742,-83.5"/>
<text text-anchor="middle" x="3671" y="-71.5" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="3671" y="-60.5" font-family="Arial" font-size="10.00">DP2&#45;TP0</text>
<text text-anchor="middle" x="3671" y="-49.5" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="3671" y="-38.5" font-family="Arial" font-size="10.00">In: [B=32,S=10240,D=1024]</text>
<text text-anchor="middle" x="3671" y="-27.5" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- embed_ar_dp2_tp0_gpu2 -->
<g id="node20" class="node">
<title>embed_ar_dp2_tp0_gpu2</title>
<ellipse fill="lightblue" stroke="black" cx="3860" cy="-52" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="3860" y="-60.5" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="3860" y="-49.5" font-family="Arial" font-size="10.00">DP2 TP Group 0</text>
<text text-anchor="middle" x="3860" y="-38.5" font-family="Arial" font-size="10.00">GPU2</text>
</g>
<!-- embed_dp2_tp1_gpu10 -->
<g id="node21" class="node">
<title>embed_dp2_tp1_gpu10</title>
<polygon fill="lightgreen" stroke="black" points="4120,-83.5 3978,-83.5 3978,-20.5 4120,-20.5 4120,-83.5"/>
<text text-anchor="middle" x="4049" y="-71.5" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="4049" y="-60.5" font-family="Arial" font-size="10.00">DP2&#45;TP1</text>
<text text-anchor="middle" x="4049" y="-49.5" font-family="Arial" font-size="10.00">GPU10</text>
<text text-anchor="middle" x="4049" y="-38.5" font-family="Arial" font-size="10.00">In: [B=32,S=10240,D=1024]</text>
<text text-anchor="middle" x="4049" y="-27.5" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- embed_ar_dp2_tp1_gpu10 -->
<g id="node22" class="node">
<title>embed_ar_dp2_tp1_gpu10</title>
<ellipse fill="lightblue" stroke="black" cx="4238" cy="-52" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="4238" y="-60.5" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="4238" y="-49.5" font-family="Arial" font-size="10.00">DP2 TP Group 1</text>
<text text-anchor="middle" x="4238" y="-38.5" font-family="Arial" font-size="10.00">GPU10</text>
</g>
<!-- embed_dp2_tp2_gpu18 -->
<g id="node23" class="node">
<title>embed_dp2_tp2_gpu18</title>
<polygon fill="lightgreen" stroke="black" points="4498,-83.5 4356,-83.5 4356,-20.5 4498,-20.5 4498,-83.5"/>
<text text-anchor="middle" x="4427" y="-71.5" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="4427" y="-60.5" font-family="Arial" font-size="10.00">DP2&#45;TP2</text>
<text text-anchor="middle" x="4427" y="-49.5" font-family="Arial" font-size="10.00">GPU18</text>
<text text-anchor="middle" x="4427" y="-38.5" font-family="Arial" font-size="10.00">In: [B=32,S=10240,D=1024]</text>
<text text-anchor="middle" x="4427" y="-27.5" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- embed_ar_dp2_tp2_gpu18 -->
<g id="node24" class="node">
<title>embed_ar_dp2_tp2_gpu18</title>
<ellipse fill="lightblue" stroke="black" cx="4616" cy="-52" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="4616" y="-60.5" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="4616" y="-49.5" font-family="Arial" font-size="10.00">DP2 TP Group 2</text>
<text text-anchor="middle" x="4616" y="-38.5" font-family="Arial" font-size="10.00">GPU18</text>
</g>
<!-- embed_dp2_tp3_gpu26 -->
<g id="node25" class="node">
<title>embed_dp2_tp3_gpu26</title>
<polygon fill="lightgreen" stroke="black" points="4876,-83.5 4734,-83.5 4734,-20.5 4876,-20.5 4876,-83.5"/>
<text text-anchor="middle" x="4805" y="-71.5" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="4805" y="-60.5" font-family="Arial" font-size="10.00">DP2&#45;TP3</text>
<text text-anchor="middle" x="4805" y="-49.5" font-family="Arial" font-size="10.00">GPU26</text>
<text text-anchor="middle" x="4805" y="-38.5" font-family="Arial" font-size="10.00">In: [B=32,S=10240,D=1024]</text>
<text text-anchor="middle" x="4805" y="-27.5" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- embed_ar_dp2_tp3_gpu26 -->
<g id="node26" class="node">
<title>embed_ar_dp2_tp3_gpu26</title>
<ellipse fill="lightblue" stroke="black" cx="4994" cy="-52" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="4994" y="-60.5" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="4994" y="-49.5" font-family="Arial" font-size="10.00">DP2 TP Group 3</text>
<text text-anchor="middle" x="4994" y="-38.5" font-family="Arial" font-size="10.00">GPU26</text>
</g>
<!-- embed_dp3_tp0_gpu3 -->
<g id="node27" class="node">
<title>embed_dp3_tp0_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="5254,-83.5 5112,-83.5 5112,-20.5 5254,-20.5 5254,-83.5"/>
<text text-anchor="middle" x="5183" y="-71.5" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="5183" y="-60.5" font-family="Arial" font-size="10.00">DP3&#45;TP0</text>
<text text-anchor="middle" x="5183" y="-49.5" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="5183" y="-38.5" font-family="Arial" font-size="10.00">In: [B=32,S=10240,D=1024]</text>
<text text-anchor="middle" x="5183" y="-27.5" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- embed_ar_dp3_tp0_gpu3 -->
<g id="node28" class="node">
<title>embed_ar_dp3_tp0_gpu3</title>
<ellipse fill="lightblue" stroke="black" cx="5372" cy="-52" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="5372" y="-60.5" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="5372" y="-49.5" font-family="Arial" font-size="10.00">DP3 TP Group 0</text>
<text text-anchor="middle" x="5372" y="-38.5" font-family="Arial" font-size="10.00">GPU3</text>
</g>
<!-- embed_dp3_tp1_gpu11 -->
<g id="node29" class="node">
<title>embed_dp3_tp1_gpu11</title>
<polygon fill="lightgreen" stroke="black" points="5632,-83.5 5490,-83.5 5490,-20.5 5632,-20.5 5632,-83.5"/>
<text text-anchor="middle" x="5561" y="-71.5" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="5561" y="-60.5" font-family="Arial" font-size="10.00">DP3&#45;TP1</text>
<text text-anchor="middle" x="5561" y="-49.5" font-family="Arial" font-size="10.00">GPU11</text>
<text text-anchor="middle" x="5561" y="-38.5" font-family="Arial" font-size="10.00">In: [B=32,S=10240,D=1024]</text>
<text text-anchor="middle" x="5561" y="-27.5" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- embed_ar_dp3_tp1_gpu11 -->
<g id="node30" class="node">
<title>embed_ar_dp3_tp1_gpu11</title>
<ellipse fill="lightblue" stroke="black" cx="5750" cy="-52" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="5750" y="-60.5" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="5750" y="-49.5" font-family="Arial" font-size="10.00">DP3 TP Group 1</text>
<text text-anchor="middle" x="5750" y="-38.5" font-family="Arial" font-size="10.00">GPU11</text>
</g>
<!-- embed_dp3_tp2_gpu19 -->
<g id="node31" class="node">
<title>embed_dp3_tp2_gpu19</title>
<polygon fill="lightgreen" stroke="black" points="6010,-83.5 5868,-83.5 5868,-20.5 6010,-20.5 6010,-83.5"/>
<text text-anchor="middle" x="5939" y="-71.5" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="5939" y="-60.5" font-family="Arial" font-size="10.00">DP3&#45;TP2</text>
<text text-anchor="middle" x="5939" y="-49.5" font-family="Arial" font-size="10.00">GPU19</text>
<text text-anchor="middle" x="5939" y="-38.5" font-family="Arial" font-size="10.00">In: [B=32,S=10240,D=1024]</text>
<text text-anchor="middle" x="5939" y="-27.5" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- embed_ar_dp3_tp2_gpu19 -->
<g id="node32" class="node">
<title>embed_ar_dp3_tp2_gpu19</title>
<ellipse fill="lightblue" stroke="black" cx="6128" cy="-52" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="6128" y="-60.5" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="6128" y="-49.5" font-family="Arial" font-size="10.00">DP3 TP Group 2</text>
<text text-anchor="middle" x="6128" y="-38.5" font-family="Arial" font-size="10.00">GPU19</text>
</g>
<!-- embed_dp3_tp3_gpu27 -->
<g id="node33" class="node">
<title>embed_dp3_tp3_gpu27</title>
<polygon fill="lightgreen" stroke="black" points="6388,-83.5 6246,-83.5 6246,-20.5 6388,-20.5 6388,-83.5"/>
<text text-anchor="middle" x="6317" y="-71.5" font-family="Arial" font-size="10.00">Embedding Layer</text>
<text text-anchor="middle" x="6317" y="-60.5" font-family="Arial" font-size="10.00">DP3&#45;TP3</text>
<text text-anchor="middle" x="6317" y="-49.5" font-family="Arial" font-size="10.00">GPU27</text>
<text text-anchor="middle" x="6317" y="-38.5" font-family="Arial" font-size="10.00">In: [B=32,S=10240,D=1024]</text>
<text text-anchor="middle" x="6317" y="-27.5" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- embed_ar_dp3_tp3_gpu27 -->
<g id="node34" class="node">
<title>embed_ar_dp3_tp3_gpu27</title>
<ellipse fill="lightblue" stroke="black" cx="6506" cy="-52" rx="82.05" ry="28.98"/>
<text text-anchor="middle" x="6506" y="-60.5" font-family="Arial" font-size="10.00">Embedding All&#45;Reduce</text>
<text text-anchor="middle" x="6506" y="-49.5" font-family="Arial" font-size="10.00">DP3 TP Group 3</text>
<text text-anchor="middle" x="6506" y="-38.5" font-family="Arial" font-size="10.00">GPU27</text>
</g>
<!-- ln1_L0_EP0TP0PP0DP0_GPU0 -->
<g id="node35" class="node">
<title>ln1_L0_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="6766,-78 6624,-78 6624,-26 6766,-26 6766,-78"/>
<text text-anchor="middle" x="6695" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="6695" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="6695" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="6695" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L0_EP0TP0PP0DP0_GPU0 -->
<g id="node36" class="node">
<title>qkv_L0_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="6944,-78 6802,-78 6802,-26 6944,-26 6944,-78"/>
<text text-anchor="middle" x="6873" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="6873" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="6873" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="6873" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L0_EP0TP0PP0DP0_GPU0 -->
<g id="node37" class="node">
<title>attn_L0_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="7131.5,-78 6980.5,-78 6980.5,-26 7131.5,-26 7131.5,-78"/>
<text text-anchor="middle" x="7056" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="7056" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="7056" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="7056" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L0_EP0TP0PP0DP0_GPU0 -->
<g id="node38" class="node">
<title>attn_out_L0_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="7310,-78 7168,-78 7168,-26 7310,-26 7310,-78"/>
<text text-anchor="middle" x="7239" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="7239" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="7239" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="7239" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L0_EP0TP0PP0DP0_GPU0 -->
<g id="node39" class="node">
<title>attn_ar_L0_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="7449" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="7449" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="7449" y="-49.5" font-family="Arial" font-size="10.00">L0 EP0 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="7449" y="-38.5" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- residual1_L0_EP0TP0PP0DP0_GPU0 -->
<g id="node40" class="node">
<title>residual1_L0_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="7734,-78 7588,-78 7588,-26 7734,-26 7734,-78"/>
<text text-anchor="middle" x="7661" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="7661" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="7661" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="7661" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L0_EP0TP0PP0DP0_GPU0 -->
<g id="node41" class="node">
<title>ln2_L0_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="7912,-78 7770,-78 7770,-26 7912,-26 7912,-78"/>
<text text-anchor="middle" x="7841" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="7841" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="7841" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="7841" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L0_EP0TP0PP0DP0_GPU0 -->
<g id="node42" class="node">
<title>gate_L0_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightyellow" stroke="black" points="8238.29,-104 8007.17,-104 7947.71,0 8178.83,0 8238.29,-104"/>
<text text-anchor="middle" x="8093" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="8093" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="8093" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="8093" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L0_EP0TP0PP0DP0_GPU0 -->
<g id="node43" class="node">
<title>dispatch_L0_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8373" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="8373" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="8373" y="-44" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP0_GPU0</text>
</g>
<!-- expert_0_L0_EP0TP0PP0DP0_GPU0 -->
<g id="node44" class="node">
<title>expert_0_L0_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="8648,-78 8508,-78 8508,-26 8648,-26 8648,-78"/>
<text text-anchor="middle" x="8578" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="8578" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="8578" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="8578" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L0_EP0TP0PP0DP0_GPU0 -->
<g id="node45" class="node">
<title>expert_1_L0_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="8824,-78 8684,-78 8684,-26 8824,-26 8824,-78"/>
<text text-anchor="middle" x="8754" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="8754" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="8754" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="8754" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L0_EP0TP0PP0DP0_GPU0 -->
<g id="node46" class="node">
<title>expert_2_L0_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="9000,-78 8860,-78 8860,-26 9000,-26 9000,-78"/>
<text text-anchor="middle" x="8930" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="8930" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="8930" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="8930" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L0_EP0TP0PP0DP0_GPU0 -->
<g id="node47" class="node">
<title>expert_3_L0_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="9176,-78 9036,-78 9036,-26 9176,-26 9176,-78"/>
<text text-anchor="middle" x="9106" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="9106" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="9106" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="9106" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L0_EP0TP0PP0DP0_GPU0 -->
<g id="node48" class="node">
<title>combine_L0_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="9311" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="9311" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="9311" y="-44" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP0_GPU0</text>
</g>
<!-- ffn_L0_EP0TP0PP0DP0_GPU0 -->
<g id="node49" class="node">
<title>ffn_L0_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="9616,-78 9446,-78 9446,-26 9616,-26 9616,-78"/>
<text text-anchor="middle" x="9531" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="9531" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="9531" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="9531" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L0_EP0TP0PP0DP0_GPU0 -->
<g id="node50" class="node">
<title>ffn_ar_L0_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="9755" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="9755" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="9755" y="-49.5" font-family="Arial" font-size="10.00">L0 EP0 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="9755" y="-38.5" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- residual2_L0_EP0TP0PP0DP0_GPU0 -->
<g id="node51" class="node">
<title>residual2_L0_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="10040,-78 9894,-78 9894,-26 10040,-26 10040,-78"/>
<text text-anchor="middle" x="9967" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="9967" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="9967" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="9967" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L0_EP0TP0PP0DP1_GPU1 -->
<g id="node52" class="node">
<title>ln1_L0_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="10218,-78 10076,-78 10076,-26 10218,-26 10218,-78"/>
<text text-anchor="middle" x="10147" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="10147" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="10147" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="10147" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L0_EP0TP0PP0DP1_GPU1 -->
<g id="node53" class="node">
<title>qkv_L0_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="10396,-78 10254,-78 10254,-26 10396,-26 10396,-78"/>
<text text-anchor="middle" x="10325" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="10325" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="10325" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="10325" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L0_EP0TP0PP0DP1_GPU1 -->
<g id="node54" class="node">
<title>attn_L0_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="10583.5,-78 10432.5,-78 10432.5,-26 10583.5,-26 10583.5,-78"/>
<text text-anchor="middle" x="10508" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="10508" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="10508" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="10508" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L0_EP0TP0PP0DP1_GPU1 -->
<g id="node55" class="node">
<title>attn_out_L0_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="10762,-78 10620,-78 10620,-26 10762,-26 10762,-78"/>
<text text-anchor="middle" x="10691" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="10691" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="10691" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="10691" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L0_EP0TP0PP0DP1_GPU1 -->
<g id="node56" class="node">
<title>attn_ar_L0_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="10901" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="10901" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="10901" y="-49.5" font-family="Arial" font-size="10.00">L0 EP0 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="10901" y="-38.5" font-family="Arial" font-size="10.00">GPU1</text>
</g>
<!-- residual1_L0_EP0TP0PP0DP1_GPU1 -->
<g id="node57" class="node">
<title>residual1_L0_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="11186,-78 11040,-78 11040,-26 11186,-26 11186,-78"/>
<text text-anchor="middle" x="11113" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="11113" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="11113" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="11113" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L0_EP0TP0PP0DP1_GPU1 -->
<g id="node58" class="node">
<title>ln2_L0_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="11364,-78 11222,-78 11222,-26 11364,-26 11364,-78"/>
<text text-anchor="middle" x="11293" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="11293" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="11293" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="11293" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L0_EP0TP0PP0DP1_GPU1 -->
<g id="node59" class="node">
<title>gate_L0_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightyellow" stroke="black" points="11690.29,-104 11459.17,-104 11399.71,0 11630.83,0 11690.29,-104"/>
<text text-anchor="middle" x="11545" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="11545" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="11545" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="11545" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L0_EP0TP0PP0DP1_GPU1 -->
<g id="node60" class="node">
<title>dispatch_L0_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="11825" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="11825" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="11825" y="-44" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP1_GPU1</text>
</g>
<!-- expert_0_L0_EP0TP0PP0DP1_GPU1 -->
<g id="node61" class="node">
<title>expert_0_L0_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="12100,-78 11960,-78 11960,-26 12100,-26 12100,-78"/>
<text text-anchor="middle" x="12030" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="12030" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="12030" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="12030" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L0_EP0TP0PP0DP1_GPU1 -->
<g id="node62" class="node">
<title>expert_1_L0_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="12276,-78 12136,-78 12136,-26 12276,-26 12276,-78"/>
<text text-anchor="middle" x="12206" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="12206" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="12206" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="12206" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L0_EP0TP0PP0DP1_GPU1 -->
<g id="node63" class="node">
<title>expert_2_L0_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="12452,-78 12312,-78 12312,-26 12452,-26 12452,-78"/>
<text text-anchor="middle" x="12382" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="12382" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="12382" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="12382" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L0_EP0TP0PP0DP1_GPU1 -->
<g id="node64" class="node">
<title>expert_3_L0_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="12628,-78 12488,-78 12488,-26 12628,-26 12628,-78"/>
<text text-anchor="middle" x="12558" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="12558" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="12558" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="12558" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L0_EP0TP0PP0DP1_GPU1 -->
<g id="node65" class="node">
<title>combine_L0_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="12763" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="12763" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="12763" y="-44" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP1_GPU1</text>
</g>
<!-- ffn_L0_EP0TP0PP0DP1_GPU1 -->
<g id="node66" class="node">
<title>ffn_L0_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="13068,-78 12898,-78 12898,-26 13068,-26 13068,-78"/>
<text text-anchor="middle" x="12983" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="12983" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="12983" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="12983" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L0_EP0TP0PP0DP1_GPU1 -->
<g id="node67" class="node">
<title>ffn_ar_L0_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="13207" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="13207" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="13207" y="-49.5" font-family="Arial" font-size="10.00">L0 EP0 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="13207" y="-38.5" font-family="Arial" font-size="10.00">GPU1</text>
</g>
<!-- residual2_L0_EP0TP0PP0DP1_GPU1 -->
<g id="node68" class="node">
<title>residual2_L0_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="13492,-78 13346,-78 13346,-26 13492,-26 13492,-78"/>
<text text-anchor="middle" x="13419" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="13419" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="13419" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="13419" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L0_EP0TP1PP0DP0_GPU8 -->
<g id="node69" class="node">
<title>ln1_L0_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="13670,-78 13528,-78 13528,-26 13670,-26 13670,-78"/>
<text text-anchor="middle" x="13599" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="13599" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="13599" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="13599" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L0_EP0TP1PP0DP0_GPU8 -->
<g id="node70" class="node">
<title>qkv_L0_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="13848,-78 13706,-78 13706,-26 13848,-26 13848,-78"/>
<text text-anchor="middle" x="13777" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="13777" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="13777" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="13777" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L0_EP0TP1PP0DP0_GPU8 -->
<g id="node71" class="node">
<title>attn_L0_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="14035.5,-78 13884.5,-78 13884.5,-26 14035.5,-26 14035.5,-78"/>
<text text-anchor="middle" x="13960" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="13960" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="13960" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="13960" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L0_EP0TP1PP0DP0_GPU8 -->
<g id="node72" class="node">
<title>attn_out_L0_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="14214,-78 14072,-78 14072,-26 14214,-26 14214,-78"/>
<text text-anchor="middle" x="14143" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="14143" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="14143" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="14143" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L0_EP0TP1PP0DP0_GPU8 -->
<g id="node73" class="node">
<title>attn_ar_L0_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="14353" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="14353" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="14353" y="-49.5" font-family="Arial" font-size="10.00">L0 EP0 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="14353" y="-38.5" font-family="Arial" font-size="10.00">GPU8</text>
</g>
<!-- residual1_L0_EP0TP1PP0DP0_GPU8 -->
<g id="node74" class="node">
<title>residual1_L0_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="14638,-78 14492,-78 14492,-26 14638,-26 14638,-78"/>
<text text-anchor="middle" x="14565" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="14565" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="14565" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="14565" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L0_EP0TP1PP0DP0_GPU8 -->
<g id="node75" class="node">
<title>ln2_L0_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="14816,-78 14674,-78 14674,-26 14816,-26 14816,-78"/>
<text text-anchor="middle" x="14745" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="14745" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="14745" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="14745" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L0_EP0TP1PP0DP0_GPU8 -->
<g id="node76" class="node">
<title>gate_L0_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightyellow" stroke="black" points="15142.29,-104 14911.17,-104 14851.71,0 15082.83,0 15142.29,-104"/>
<text text-anchor="middle" x="14997" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="14997" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="14997" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="14997" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L0_EP0TP1PP0DP0_GPU8 -->
<g id="node77" class="node">
<title>dispatch_L0_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="15277" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="15277" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="15277" y="-44" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP0_GPU8</text>
</g>
<!-- expert_0_L0_EP0TP1PP0DP0_GPU8 -->
<g id="node78" class="node">
<title>expert_0_L0_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="15552,-78 15412,-78 15412,-26 15552,-26 15552,-78"/>
<text text-anchor="middle" x="15482" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="15482" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="15482" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="15482" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L0_EP0TP1PP0DP0_GPU8 -->
<g id="node79" class="node">
<title>expert_1_L0_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="15728,-78 15588,-78 15588,-26 15728,-26 15728,-78"/>
<text text-anchor="middle" x="15658" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="15658" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="15658" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="15658" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L0_EP0TP1PP0DP0_GPU8 -->
<g id="node80" class="node">
<title>expert_2_L0_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="15904,-78 15764,-78 15764,-26 15904,-26 15904,-78"/>
<text text-anchor="middle" x="15834" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="15834" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="15834" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="15834" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L0_EP0TP1PP0DP0_GPU8 -->
<g id="node81" class="node">
<title>expert_3_L0_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="16080,-78 15940,-78 15940,-26 16080,-26 16080,-78"/>
<text text-anchor="middle" x="16010" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="16010" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="16010" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="16010" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L0_EP0TP1PP0DP0_GPU8 -->
<g id="node82" class="node">
<title>combine_L0_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="16215" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="16215" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="16215" y="-44" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP0_GPU8</text>
</g>
<!-- ffn_L0_EP0TP1PP0DP0_GPU8 -->
<g id="node83" class="node">
<title>ffn_L0_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="16520,-78 16350,-78 16350,-26 16520,-26 16520,-78"/>
<text text-anchor="middle" x="16435" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="16435" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="16435" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="16435" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L0_EP0TP1PP0DP0_GPU8 -->
<g id="node84" class="node">
<title>ffn_ar_L0_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="16659" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="16659" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="16659" y="-49.5" font-family="Arial" font-size="10.00">L0 EP0 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="16659" y="-38.5" font-family="Arial" font-size="10.00">GPU8</text>
</g>
<!-- residual2_L0_EP0TP1PP0DP0_GPU8 -->
<g id="node85" class="node">
<title>residual2_L0_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="16944,-78 16798,-78 16798,-26 16944,-26 16944,-78"/>
<text text-anchor="middle" x="16871" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="16871" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="16871" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="16871" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L0_EP0TP1PP0DP1_GPU9 -->
<g id="node86" class="node">
<title>ln1_L0_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="17122,-78 16980,-78 16980,-26 17122,-26 17122,-78"/>
<text text-anchor="middle" x="17051" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="17051" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="17051" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="17051" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L0_EP0TP1PP0DP1_GPU9 -->
<g id="node87" class="node">
<title>qkv_L0_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="17300,-78 17158,-78 17158,-26 17300,-26 17300,-78"/>
<text text-anchor="middle" x="17229" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="17229" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="17229" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="17229" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L0_EP0TP1PP0DP1_GPU9 -->
<g id="node88" class="node">
<title>attn_L0_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="17487.5,-78 17336.5,-78 17336.5,-26 17487.5,-26 17487.5,-78"/>
<text text-anchor="middle" x="17412" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="17412" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="17412" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="17412" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L0_EP0TP1PP0DP1_GPU9 -->
<g id="node89" class="node">
<title>attn_out_L0_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="17666,-78 17524,-78 17524,-26 17666,-26 17666,-78"/>
<text text-anchor="middle" x="17595" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="17595" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="17595" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="17595" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L0_EP0TP1PP0DP1_GPU9 -->
<g id="node90" class="node">
<title>attn_ar_L0_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="17805" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="17805" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="17805" y="-49.5" font-family="Arial" font-size="10.00">L0 EP0 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="17805" y="-38.5" font-family="Arial" font-size="10.00">GPU9</text>
</g>
<!-- residual1_L0_EP0TP1PP0DP1_GPU9 -->
<g id="node91" class="node">
<title>residual1_L0_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="18090,-78 17944,-78 17944,-26 18090,-26 18090,-78"/>
<text text-anchor="middle" x="18017" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="18017" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="18017" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="18017" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L0_EP0TP1PP0DP1_GPU9 -->
<g id="node92" class="node">
<title>ln2_L0_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="18268,-78 18126,-78 18126,-26 18268,-26 18268,-78"/>
<text text-anchor="middle" x="18197" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="18197" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="18197" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="18197" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L0_EP0TP1PP0DP1_GPU9 -->
<g id="node93" class="node">
<title>gate_L0_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightyellow" stroke="black" points="18594.29,-104 18363.17,-104 18303.71,0 18534.83,0 18594.29,-104"/>
<text text-anchor="middle" x="18449" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="18449" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="18449" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="18449" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L0_EP0TP1PP0DP1_GPU9 -->
<g id="node94" class="node">
<title>dispatch_L0_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="18729" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="18729" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="18729" y="-44" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP1_GPU9</text>
</g>
<!-- expert_0_L0_EP0TP1PP0DP1_GPU9 -->
<g id="node95" class="node">
<title>expert_0_L0_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="19004,-78 18864,-78 18864,-26 19004,-26 19004,-78"/>
<text text-anchor="middle" x="18934" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="18934" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="18934" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="18934" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L0_EP0TP1PP0DP1_GPU9 -->
<g id="node96" class="node">
<title>expert_1_L0_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="19180,-78 19040,-78 19040,-26 19180,-26 19180,-78"/>
<text text-anchor="middle" x="19110" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="19110" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="19110" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="19110" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L0_EP0TP1PP0DP1_GPU9 -->
<g id="node97" class="node">
<title>expert_2_L0_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="19356,-78 19216,-78 19216,-26 19356,-26 19356,-78"/>
<text text-anchor="middle" x="19286" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="19286" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="19286" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="19286" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L0_EP0TP1PP0DP1_GPU9 -->
<g id="node98" class="node">
<title>expert_3_L0_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="19532,-78 19392,-78 19392,-26 19532,-26 19532,-78"/>
<text text-anchor="middle" x="19462" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="19462" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="19462" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="19462" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L0_EP0TP1PP0DP1_GPU9 -->
<g id="node99" class="node">
<title>combine_L0_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="19667" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="19667" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="19667" y="-44" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP1_GPU9</text>
</g>
<!-- ffn_L0_EP0TP1PP0DP1_GPU9 -->
<g id="node100" class="node">
<title>ffn_L0_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="19972,-78 19802,-78 19802,-26 19972,-26 19972,-78"/>
<text text-anchor="middle" x="19887" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="19887" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="19887" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="19887" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L0_EP0TP1PP0DP1_GPU9 -->
<g id="node101" class="node">
<title>ffn_ar_L0_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="20111" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="20111" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="20111" y="-49.5" font-family="Arial" font-size="10.00">L0 EP0 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="20111" y="-38.5" font-family="Arial" font-size="10.00">GPU9</text>
</g>
<!-- residual2_L0_EP0TP1PP0DP1_GPU9 -->
<g id="node102" class="node">
<title>residual2_L0_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="20396,-78 20250,-78 20250,-26 20396,-26 20396,-78"/>
<text text-anchor="middle" x="20323" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="20323" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="20323" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="20323" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L0_EP0TP2PP0DP0_GPU16 -->
<g id="node103" class="node">
<title>ln1_L0_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="20577.5,-78 20432.5,-78 20432.5,-26 20577.5,-26 20577.5,-78"/>
<text text-anchor="middle" x="20505" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="20505" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="20505" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="20505" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L0_EP0TP2PP0DP0_GPU16 -->
<g id="node104" class="node">
<title>qkv_L0_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="20758.5,-78 20613.5,-78 20613.5,-26 20758.5,-26 20758.5,-78"/>
<text text-anchor="middle" x="20686" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="20686" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="20686" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="20686" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L0_EP0TP2PP0DP0_GPU16 -->
<g id="node105" class="node">
<title>attn_L0_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="20945.5,-78 20794.5,-78 20794.5,-26 20945.5,-26 20945.5,-78"/>
<text text-anchor="middle" x="20870" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="20870" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="20870" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="20870" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L0_EP0TP2PP0DP0_GPU16 -->
<g id="node106" class="node">
<title>attn_out_L0_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="21126.5,-78 20981.5,-78 20981.5,-26 21126.5,-26 21126.5,-78"/>
<text text-anchor="middle" x="21054" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="21054" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="21054" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="21054" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L0_EP0TP2PP0DP0_GPU16 -->
<g id="node107" class="node">
<title>attn_ar_L0_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="21266" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="21266" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="21266" y="-49.5" font-family="Arial" font-size="10.00">L0 EP0 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="21266" y="-38.5" font-family="Arial" font-size="10.00">GPU16</text>
</g>
<!-- residual1_L0_EP0TP2PP0DP0_GPU16 -->
<g id="node108" class="node">
<title>residual1_L0_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="21551,-78 21405,-78 21405,-26 21551,-26 21551,-78"/>
<text text-anchor="middle" x="21478" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="21478" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="21478" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="21478" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L0_EP0TP2PP0DP0_GPU16 -->
<g id="node109" class="node">
<title>ln2_L0_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="21732.5,-78 21587.5,-78 21587.5,-26 21732.5,-26 21732.5,-78"/>
<text text-anchor="middle" x="21660" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="21660" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="21660" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="21660" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L0_EP0TP2PP0DP0_GPU16 -->
<g id="node110" class="node">
<title>gate_L0_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightyellow" stroke="black" points="22069.16,-104 21830.29,-104 21768.84,0 22007.71,0 22069.16,-104"/>
<text text-anchor="middle" x="21919" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="21919" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="21919" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="21919" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L0_EP0TP2PP0DP0_GPU16 -->
<g id="node111" class="node">
<title>dispatch_L0_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="22208" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="22208" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="22208" y="-44" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP0_GPU16</text>
</g>
<!-- expert_0_L0_EP0TP2PP0DP0_GPU16 -->
<g id="node112" class="node">
<title>expert_0_L0_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="22491.5,-78 22346.5,-78 22346.5,-26 22491.5,-26 22491.5,-78"/>
<text text-anchor="middle" x="22419" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="22419" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="22419" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="22419" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L0_EP0TP2PP0DP0_GPU16 -->
<g id="node113" class="node">
<title>expert_1_L0_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="22672.5,-78 22527.5,-78 22527.5,-26 22672.5,-26 22672.5,-78"/>
<text text-anchor="middle" x="22600" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="22600" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="22600" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="22600" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L0_EP0TP2PP0DP0_GPU16 -->
<g id="node114" class="node">
<title>expert_2_L0_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="22853.5,-78 22708.5,-78 22708.5,-26 22853.5,-26 22853.5,-78"/>
<text text-anchor="middle" x="22781" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="22781" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="22781" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="22781" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L0_EP0TP2PP0DP0_GPU16 -->
<g id="node115" class="node">
<title>expert_3_L0_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="23034.5,-78 22889.5,-78 22889.5,-26 23034.5,-26 23034.5,-78"/>
<text text-anchor="middle" x="22962" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="22962" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="22962" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="22962" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L0_EP0TP2PP0DP0_GPU16 -->
<g id="node116" class="node">
<title>combine_L0_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="23173" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="23173" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="23173" y="-44" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP0_GPU16</text>
</g>
<!-- ffn_L0_EP0TP2PP0DP0_GPU16 -->
<g id="node117" class="node">
<title>ffn_L0_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="23482,-78 23312,-78 23312,-26 23482,-26 23482,-78"/>
<text text-anchor="middle" x="23397" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="23397" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="23397" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="23397" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L0_EP0TP2PP0DP0_GPU16 -->
<g id="node118" class="node">
<title>ffn_ar_L0_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="23621" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="23621" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="23621" y="-49.5" font-family="Arial" font-size="10.00">L0 EP0 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="23621" y="-38.5" font-family="Arial" font-size="10.00">GPU16</text>
</g>
<!-- residual2_L0_EP0TP2PP0DP0_GPU16 -->
<g id="node119" class="node">
<title>residual2_L0_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="23906,-78 23760,-78 23760,-26 23906,-26 23906,-78"/>
<text text-anchor="middle" x="23833" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="23833" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="23833" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="23833" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L0_EP0TP2PP0DP1_GPU17 -->
<g id="node120" class="node">
<title>ln1_L0_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="24087.5,-78 23942.5,-78 23942.5,-26 24087.5,-26 24087.5,-78"/>
<text text-anchor="middle" x="24015" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="24015" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="24015" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="24015" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L0_EP0TP2PP0DP1_GPU17 -->
<g id="node121" class="node">
<title>qkv_L0_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="24268.5,-78 24123.5,-78 24123.5,-26 24268.5,-26 24268.5,-78"/>
<text text-anchor="middle" x="24196" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="24196" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="24196" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="24196" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L0_EP0TP2PP0DP1_GPU17 -->
<g id="node122" class="node">
<title>attn_L0_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="24455.5,-78 24304.5,-78 24304.5,-26 24455.5,-26 24455.5,-78"/>
<text text-anchor="middle" x="24380" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="24380" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="24380" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="24380" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L0_EP0TP2PP0DP1_GPU17 -->
<g id="node123" class="node">
<title>attn_out_L0_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="24636.5,-78 24491.5,-78 24491.5,-26 24636.5,-26 24636.5,-78"/>
<text text-anchor="middle" x="24564" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="24564" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="24564" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="24564" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L0_EP0TP2PP0DP1_GPU17 -->
<g id="node124" class="node">
<title>attn_ar_L0_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="24776" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="24776" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="24776" y="-49.5" font-family="Arial" font-size="10.00">L0 EP0 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="24776" y="-38.5" font-family="Arial" font-size="10.00">GPU17</text>
</g>
<!-- residual1_L0_EP0TP2PP0DP1_GPU17 -->
<g id="node125" class="node">
<title>residual1_L0_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="25061,-78 24915,-78 24915,-26 25061,-26 25061,-78"/>
<text text-anchor="middle" x="24988" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="24988" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="24988" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="24988" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L0_EP0TP2PP0DP1_GPU17 -->
<g id="node126" class="node">
<title>ln2_L0_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="25242.5,-78 25097.5,-78 25097.5,-26 25242.5,-26 25242.5,-78"/>
<text text-anchor="middle" x="25170" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="25170" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="25170" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="25170" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L0_EP0TP2PP0DP1_GPU17 -->
<g id="node127" class="node">
<title>gate_L0_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightyellow" stroke="black" points="25579.16,-104 25340.29,-104 25278.84,0 25517.71,0 25579.16,-104"/>
<text text-anchor="middle" x="25429" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="25429" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="25429" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="25429" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L0_EP0TP2PP0DP1_GPU17 -->
<g id="node128" class="node">
<title>dispatch_L0_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="25718" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="25718" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="25718" y="-44" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP1_GPU17</text>
</g>
<!-- expert_0_L0_EP0TP2PP0DP1_GPU17 -->
<g id="node129" class="node">
<title>expert_0_L0_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="26001.5,-78 25856.5,-78 25856.5,-26 26001.5,-26 26001.5,-78"/>
<text text-anchor="middle" x="25929" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="25929" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="25929" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="25929" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L0_EP0TP2PP0DP1_GPU17 -->
<g id="node130" class="node">
<title>expert_1_L0_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="26182.5,-78 26037.5,-78 26037.5,-26 26182.5,-26 26182.5,-78"/>
<text text-anchor="middle" x="26110" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="26110" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="26110" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="26110" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L0_EP0TP2PP0DP1_GPU17 -->
<g id="node131" class="node">
<title>expert_2_L0_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="26363.5,-78 26218.5,-78 26218.5,-26 26363.5,-26 26363.5,-78"/>
<text text-anchor="middle" x="26291" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="26291" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="26291" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="26291" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L0_EP0TP2PP0DP1_GPU17 -->
<g id="node132" class="node">
<title>expert_3_L0_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="26544.5,-78 26399.5,-78 26399.5,-26 26544.5,-26 26544.5,-78"/>
<text text-anchor="middle" x="26472" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="26472" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="26472" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="26472" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L0_EP0TP2PP0DP1_GPU17 -->
<g id="node133" class="node">
<title>combine_L0_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="26683" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="26683" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="26683" y="-44" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP1_GPU17</text>
</g>
<!-- ffn_L0_EP0TP2PP0DP1_GPU17 -->
<g id="node134" class="node">
<title>ffn_L0_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="26992,-78 26822,-78 26822,-26 26992,-26 26992,-78"/>
<text text-anchor="middle" x="26907" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="26907" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="26907" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="26907" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L0_EP0TP2PP0DP1_GPU17 -->
<g id="node135" class="node">
<title>ffn_ar_L0_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="27131" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="27131" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="27131" y="-49.5" font-family="Arial" font-size="10.00">L0 EP0 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="27131" y="-38.5" font-family="Arial" font-size="10.00">GPU17</text>
</g>
<!-- residual2_L0_EP0TP2PP0DP1_GPU17 -->
<g id="node136" class="node">
<title>residual2_L0_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="27416,-78 27270,-78 27270,-26 27416,-26 27416,-78"/>
<text text-anchor="middle" x="27343" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="27343" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="27343" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="27343" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L0_EP0TP3PP0DP0_GPU24 -->
<g id="node137" class="node">
<title>ln1_L0_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="27597.5,-78 27452.5,-78 27452.5,-26 27597.5,-26 27597.5,-78"/>
<text text-anchor="middle" x="27525" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="27525" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="27525" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="27525" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L0_EP0TP3PP0DP0_GPU24 -->
<g id="node138" class="node">
<title>qkv_L0_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="27778.5,-78 27633.5,-78 27633.5,-26 27778.5,-26 27778.5,-78"/>
<text text-anchor="middle" x="27706" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="27706" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="27706" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="27706" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L0_EP0TP3PP0DP0_GPU24 -->
<g id="node139" class="node">
<title>attn_L0_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="27965.5,-78 27814.5,-78 27814.5,-26 27965.5,-26 27965.5,-78"/>
<text text-anchor="middle" x="27890" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="27890" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="27890" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="27890" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L0_EP0TP3PP0DP0_GPU24 -->
<g id="node140" class="node">
<title>attn_out_L0_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="28146.5,-78 28001.5,-78 28001.5,-26 28146.5,-26 28146.5,-78"/>
<text text-anchor="middle" x="28074" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="28074" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="28074" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="28074" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L0_EP0TP3PP0DP0_GPU24 -->
<g id="node141" class="node">
<title>attn_ar_L0_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="28286" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="28286" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="28286" y="-49.5" font-family="Arial" font-size="10.00">L0 EP0 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="28286" y="-38.5" font-family="Arial" font-size="10.00">GPU24</text>
</g>
<!-- residual1_L0_EP0TP3PP0DP0_GPU24 -->
<g id="node142" class="node">
<title>residual1_L0_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="28571,-78 28425,-78 28425,-26 28571,-26 28571,-78"/>
<text text-anchor="middle" x="28498" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="28498" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="28498" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="28498" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L0_EP0TP3PP0DP0_GPU24 -->
<g id="node143" class="node">
<title>ln2_L0_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="28752.5,-78 28607.5,-78 28607.5,-26 28752.5,-26 28752.5,-78"/>
<text text-anchor="middle" x="28680" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="28680" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="28680" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="28680" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L0_EP0TP3PP0DP0_GPU24 -->
<g id="node144" class="node">
<title>gate_L0_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightyellow" stroke="black" points="29089.16,-104 28850.29,-104 28788.84,0 29027.71,0 29089.16,-104"/>
<text text-anchor="middle" x="28939" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="28939" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="28939" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="28939" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L0_EP0TP3PP0DP0_GPU24 -->
<g id="node145" class="node">
<title>dispatch_L0_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="29228" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="29228" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="29228" y="-44" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP0_GPU24</text>
</g>
<!-- expert_0_L0_EP0TP3PP0DP0_GPU24 -->
<g id="node146" class="node">
<title>expert_0_L0_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="29511.5,-78 29366.5,-78 29366.5,-26 29511.5,-26 29511.5,-78"/>
<text text-anchor="middle" x="29439" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="29439" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="29439" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="29439" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L0_EP0TP3PP0DP0_GPU24 -->
<g id="node147" class="node">
<title>expert_1_L0_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="29692.5,-78 29547.5,-78 29547.5,-26 29692.5,-26 29692.5,-78"/>
<text text-anchor="middle" x="29620" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="29620" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="29620" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="29620" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L0_EP0TP3PP0DP0_GPU24 -->
<g id="node148" class="node">
<title>expert_2_L0_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="29873.5,-78 29728.5,-78 29728.5,-26 29873.5,-26 29873.5,-78"/>
<text text-anchor="middle" x="29801" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="29801" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="29801" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="29801" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L0_EP0TP3PP0DP0_GPU24 -->
<g id="node149" class="node">
<title>expert_3_L0_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="30054.5,-78 29909.5,-78 29909.5,-26 30054.5,-26 30054.5,-78"/>
<text text-anchor="middle" x="29982" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="29982" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="29982" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="29982" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L0_EP0TP3PP0DP0_GPU24 -->
<g id="node150" class="node">
<title>combine_L0_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="30193" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="30193" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="30193" y="-44" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP0_GPU24</text>
</g>
<!-- ffn_L0_EP0TP3PP0DP0_GPU24 -->
<g id="node151" class="node">
<title>ffn_L0_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="30502,-78 30332,-78 30332,-26 30502,-26 30502,-78"/>
<text text-anchor="middle" x="30417" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="30417" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="30417" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="30417" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L0_EP0TP3PP0DP0_GPU24 -->
<g id="node152" class="node">
<title>ffn_ar_L0_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="30641" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="30641" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="30641" y="-49.5" font-family="Arial" font-size="10.00">L0 EP0 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="30641" y="-38.5" font-family="Arial" font-size="10.00">GPU24</text>
</g>
<!-- residual2_L0_EP0TP3PP0DP0_GPU24 -->
<g id="node153" class="node">
<title>residual2_L0_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="30926,-78 30780,-78 30780,-26 30926,-26 30926,-78"/>
<text text-anchor="middle" x="30853" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="30853" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="30853" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="30853" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L0_EP0TP3PP0DP1_GPU25 -->
<g id="node154" class="node">
<title>ln1_L0_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="31107.5,-78 30962.5,-78 30962.5,-26 31107.5,-26 31107.5,-78"/>
<text text-anchor="middle" x="31035" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="31035" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="31035" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="31035" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L0_EP0TP3PP0DP1_GPU25 -->
<g id="node155" class="node">
<title>qkv_L0_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="31288.5,-78 31143.5,-78 31143.5,-26 31288.5,-26 31288.5,-78"/>
<text text-anchor="middle" x="31216" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="31216" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="31216" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="31216" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L0_EP0TP3PP0DP1_GPU25 -->
<g id="node156" class="node">
<title>attn_L0_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="31475.5,-78 31324.5,-78 31324.5,-26 31475.5,-26 31475.5,-78"/>
<text text-anchor="middle" x="31400" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="31400" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="31400" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="31400" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L0_EP0TP3PP0DP1_GPU25 -->
<g id="node157" class="node">
<title>attn_out_L0_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="31656.5,-78 31511.5,-78 31511.5,-26 31656.5,-26 31656.5,-78"/>
<text text-anchor="middle" x="31584" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="31584" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="31584" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="31584" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L0_EP0TP3PP0DP1_GPU25 -->
<g id="node158" class="node">
<title>attn_ar_L0_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="31796" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="31796" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="31796" y="-49.5" font-family="Arial" font-size="10.00">L0 EP0 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="31796" y="-38.5" font-family="Arial" font-size="10.00">GPU25</text>
</g>
<!-- residual1_L0_EP0TP3PP0DP1_GPU25 -->
<g id="node159" class="node">
<title>residual1_L0_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="32081,-78 31935,-78 31935,-26 32081,-26 32081,-78"/>
<text text-anchor="middle" x="32008" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="32008" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="32008" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="32008" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L0_EP0TP3PP0DP1_GPU25 -->
<g id="node160" class="node">
<title>ln2_L0_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="32262.5,-78 32117.5,-78 32117.5,-26 32262.5,-26 32262.5,-78"/>
<text text-anchor="middle" x="32190" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="32190" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="32190" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="32190" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L0_EP0TP3PP0DP1_GPU25 -->
<g id="node161" class="node">
<title>gate_L0_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightyellow" stroke="black" points="32599.16,-104 32360.29,-104 32298.84,0 32537.71,0 32599.16,-104"/>
<text text-anchor="middle" x="32449" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="32449" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="32449" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="32449" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L0_EP0TP3PP0DP1_GPU25 -->
<g id="node162" class="node">
<title>dispatch_L0_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="32738" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="32738" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="32738" y="-44" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP1_GPU25</text>
</g>
<!-- expert_0_L0_EP0TP3PP0DP1_GPU25 -->
<g id="node163" class="node">
<title>expert_0_L0_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="33021.5,-78 32876.5,-78 32876.5,-26 33021.5,-26 33021.5,-78"/>
<text text-anchor="middle" x="32949" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="32949" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="32949" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="32949" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L0_EP0TP3PP0DP1_GPU25 -->
<g id="node164" class="node">
<title>expert_1_L0_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="33202.5,-78 33057.5,-78 33057.5,-26 33202.5,-26 33202.5,-78"/>
<text text-anchor="middle" x="33130" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="33130" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="33130" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="33130" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L0_EP0TP3PP0DP1_GPU25 -->
<g id="node165" class="node">
<title>expert_2_L0_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="33383.5,-78 33238.5,-78 33238.5,-26 33383.5,-26 33383.5,-78"/>
<text text-anchor="middle" x="33311" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="33311" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="33311" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="33311" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L0_EP0TP3PP0DP1_GPU25 -->
<g id="node166" class="node">
<title>expert_3_L0_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="33564.5,-78 33419.5,-78 33419.5,-26 33564.5,-26 33564.5,-78"/>
<text text-anchor="middle" x="33492" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="33492" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="33492" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="33492" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L0_EP0TP3PP0DP1_GPU25 -->
<g id="node167" class="node">
<title>combine_L0_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="33703" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="33703" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="33703" y="-44" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP1_GPU25</text>
</g>
<!-- ffn_L0_EP0TP3PP0DP1_GPU25 -->
<g id="node168" class="node">
<title>ffn_L0_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="34012,-78 33842,-78 33842,-26 34012,-26 34012,-78"/>
<text text-anchor="middle" x="33927" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="33927" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="33927" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="33927" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L0_EP0TP3PP0DP1_GPU25 -->
<g id="node169" class="node">
<title>ffn_ar_L0_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="34151" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="34151" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="34151" y="-49.5" font-family="Arial" font-size="10.00">L0 EP0 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="34151" y="-38.5" font-family="Arial" font-size="10.00">GPU25</text>
</g>
<!-- residual2_L0_EP0TP3PP0DP1_GPU25 -->
<g id="node170" class="node">
<title>residual2_L0_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="34436,-78 34290,-78 34290,-26 34436,-26 34436,-78"/>
<text text-anchor="middle" x="34363" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="34363" y="-55" font-family="Arial" font-size="10.00">L0_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="34363" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="34363" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L0_EP1TP0PP0DP0_GPU32 -->
<g id="node171" class="node">
<title>ln1_L0_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="34617.5,-78 34472.5,-78 34472.5,-26 34617.5,-26 34617.5,-78"/>
<text text-anchor="middle" x="34545" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="34545" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="34545" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="34545" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L0_EP1TP0PP0DP0_GPU32 -->
<g id="node172" class="node">
<title>qkv_L0_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="34798.5,-78 34653.5,-78 34653.5,-26 34798.5,-26 34798.5,-78"/>
<text text-anchor="middle" x="34726" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="34726" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="34726" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="34726" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L0_EP1TP0PP0DP0_GPU32 -->
<g id="node173" class="node">
<title>attn_L0_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="34985.5,-78 34834.5,-78 34834.5,-26 34985.5,-26 34985.5,-78"/>
<text text-anchor="middle" x="34910" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="34910" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="34910" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="34910" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L0_EP1TP0PP0DP0_GPU32 -->
<g id="node174" class="node">
<title>attn_out_L0_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="35166.5,-78 35021.5,-78 35021.5,-26 35166.5,-26 35166.5,-78"/>
<text text-anchor="middle" x="35094" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="35094" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="35094" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="35094" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L0_EP1TP0PP0DP0_GPU32 -->
<g id="node175" class="node">
<title>attn_ar_L0_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="35306" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="35306" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="35306" y="-49.5" font-family="Arial" font-size="10.00">L0 EP1 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="35306" y="-38.5" font-family="Arial" font-size="10.00">GPU32</text>
</g>
<!-- residual1_L0_EP1TP0PP0DP0_GPU32 -->
<g id="node176" class="node">
<title>residual1_L0_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="35591,-78 35445,-78 35445,-26 35591,-26 35591,-78"/>
<text text-anchor="middle" x="35518" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="35518" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="35518" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="35518" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L0_EP1TP0PP0DP0_GPU32 -->
<g id="node177" class="node">
<title>ln2_L0_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="35772.5,-78 35627.5,-78 35627.5,-26 35772.5,-26 35772.5,-78"/>
<text text-anchor="middle" x="35700" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="35700" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="35700" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="35700" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L0_EP1TP0PP0DP0_GPU32 -->
<g id="node178" class="node">
<title>gate_L0_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightyellow" stroke="black" points="36109.16,-104 35870.29,-104 35808.84,0 36047.71,0 36109.16,-104"/>
<text text-anchor="middle" x="35959" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="35959" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="35959" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="35959" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L0_EP1TP0PP0DP0_GPU32 -->
<g id="node179" class="node">
<title>dispatch_L0_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="36248" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="36248" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="36248" y="-44" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP0_GPU32</text>
</g>
<!-- expert_0_L0_EP1TP0PP0DP0_GPU32 -->
<g id="node180" class="node">
<title>expert_0_L0_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="36531.5,-78 36386.5,-78 36386.5,-26 36531.5,-26 36531.5,-78"/>
<text text-anchor="middle" x="36459" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="36459" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="36459" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="36459" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L0_EP1TP0PP0DP0_GPU32 -->
<g id="node181" class="node">
<title>expert_1_L0_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="36712.5,-78 36567.5,-78 36567.5,-26 36712.5,-26 36712.5,-78"/>
<text text-anchor="middle" x="36640" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="36640" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="36640" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="36640" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L0_EP1TP0PP0DP0_GPU32 -->
<g id="node182" class="node">
<title>expert_2_L0_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="36893.5,-78 36748.5,-78 36748.5,-26 36893.5,-26 36893.5,-78"/>
<text text-anchor="middle" x="36821" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="36821" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="36821" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="36821" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L0_EP1TP0PP0DP0_GPU32 -->
<g id="node183" class="node">
<title>expert_3_L0_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="37074.5,-78 36929.5,-78 36929.5,-26 37074.5,-26 37074.5,-78"/>
<text text-anchor="middle" x="37002" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="37002" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="37002" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="37002" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L0_EP1TP0PP0DP0_GPU32 -->
<g id="node184" class="node">
<title>combine_L0_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="37213" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="37213" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="37213" y="-44" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP0_GPU32</text>
</g>
<!-- ffn_L0_EP1TP0PP0DP0_GPU32 -->
<g id="node185" class="node">
<title>ffn_L0_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="37522,-78 37352,-78 37352,-26 37522,-26 37522,-78"/>
<text text-anchor="middle" x="37437" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="37437" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="37437" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="37437" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L0_EP1TP0PP0DP0_GPU32 -->
<g id="node186" class="node">
<title>ffn_ar_L0_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="37661" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="37661" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="37661" y="-49.5" font-family="Arial" font-size="10.00">L0 EP1 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="37661" y="-38.5" font-family="Arial" font-size="10.00">GPU32</text>
</g>
<!-- residual2_L0_EP1TP0PP0DP0_GPU32 -->
<g id="node187" class="node">
<title>residual2_L0_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="37946,-78 37800,-78 37800,-26 37946,-26 37946,-78"/>
<text text-anchor="middle" x="37873" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="37873" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="37873" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="37873" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L0_EP1TP0PP0DP1_GPU33 -->
<g id="node188" class="node">
<title>ln1_L0_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="38127.5,-78 37982.5,-78 37982.5,-26 38127.5,-26 38127.5,-78"/>
<text text-anchor="middle" x="38055" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="38055" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="38055" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="38055" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L0_EP1TP0PP0DP1_GPU33 -->
<g id="node189" class="node">
<title>qkv_L0_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="38308.5,-78 38163.5,-78 38163.5,-26 38308.5,-26 38308.5,-78"/>
<text text-anchor="middle" x="38236" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="38236" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="38236" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="38236" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L0_EP1TP0PP0DP1_GPU33 -->
<g id="node190" class="node">
<title>attn_L0_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="38495.5,-78 38344.5,-78 38344.5,-26 38495.5,-26 38495.5,-78"/>
<text text-anchor="middle" x="38420" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="38420" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="38420" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="38420" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L0_EP1TP0PP0DP1_GPU33 -->
<g id="node191" class="node">
<title>attn_out_L0_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="38676.5,-78 38531.5,-78 38531.5,-26 38676.5,-26 38676.5,-78"/>
<text text-anchor="middle" x="38604" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="38604" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="38604" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="38604" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L0_EP1TP0PP0DP1_GPU33 -->
<g id="node192" class="node">
<title>attn_ar_L0_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="38816" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="38816" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="38816" y="-49.5" font-family="Arial" font-size="10.00">L0 EP1 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="38816" y="-38.5" font-family="Arial" font-size="10.00">GPU33</text>
</g>
<!-- residual1_L0_EP1TP0PP0DP1_GPU33 -->
<g id="node193" class="node">
<title>residual1_L0_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="39101,-78 38955,-78 38955,-26 39101,-26 39101,-78"/>
<text text-anchor="middle" x="39028" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="39028" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="39028" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="39028" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L0_EP1TP0PP0DP1_GPU33 -->
<g id="node194" class="node">
<title>ln2_L0_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="39282.5,-78 39137.5,-78 39137.5,-26 39282.5,-26 39282.5,-78"/>
<text text-anchor="middle" x="39210" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="39210" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="39210" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="39210" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L0_EP1TP0PP0DP1_GPU33 -->
<g id="node195" class="node">
<title>gate_L0_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightyellow" stroke="black" points="39619.16,-104 39380.29,-104 39318.84,0 39557.71,0 39619.16,-104"/>
<text text-anchor="middle" x="39469" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="39469" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="39469" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="39469" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L0_EP1TP0PP0DP1_GPU33 -->
<g id="node196" class="node">
<title>dispatch_L0_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="39758" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="39758" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="39758" y="-44" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP1_GPU33</text>
</g>
<!-- expert_0_L0_EP1TP0PP0DP1_GPU33 -->
<g id="node197" class="node">
<title>expert_0_L0_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="40041.5,-78 39896.5,-78 39896.5,-26 40041.5,-26 40041.5,-78"/>
<text text-anchor="middle" x="39969" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="39969" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="39969" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="39969" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L0_EP1TP0PP0DP1_GPU33 -->
<g id="node198" class="node">
<title>expert_1_L0_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="40222.5,-78 40077.5,-78 40077.5,-26 40222.5,-26 40222.5,-78"/>
<text text-anchor="middle" x="40150" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="40150" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="40150" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="40150" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L0_EP1TP0PP0DP1_GPU33 -->
<g id="node199" class="node">
<title>expert_2_L0_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="40403.5,-78 40258.5,-78 40258.5,-26 40403.5,-26 40403.5,-78"/>
<text text-anchor="middle" x="40331" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="40331" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="40331" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="40331" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L0_EP1TP0PP0DP1_GPU33 -->
<g id="node200" class="node">
<title>expert_3_L0_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="40584.5,-78 40439.5,-78 40439.5,-26 40584.5,-26 40584.5,-78"/>
<text text-anchor="middle" x="40512" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="40512" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="40512" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="40512" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L0_EP1TP0PP0DP1_GPU33 -->
<g id="node201" class="node">
<title>combine_L0_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="40723" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="40723" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="40723" y="-44" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP1_GPU33</text>
</g>
<!-- ffn_L0_EP1TP0PP0DP1_GPU33 -->
<g id="node202" class="node">
<title>ffn_L0_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="41032,-78 40862,-78 40862,-26 41032,-26 41032,-78"/>
<text text-anchor="middle" x="40947" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="40947" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="40947" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="40947" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L0_EP1TP0PP0DP1_GPU33 -->
<g id="node203" class="node">
<title>ffn_ar_L0_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="41171" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="41171" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="41171" y="-49.5" font-family="Arial" font-size="10.00">L0 EP1 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="41171" y="-38.5" font-family="Arial" font-size="10.00">GPU33</text>
</g>
<!-- residual2_L0_EP1TP0PP0DP1_GPU33 -->
<g id="node204" class="node">
<title>residual2_L0_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="41456,-78 41310,-78 41310,-26 41456,-26 41456,-78"/>
<text text-anchor="middle" x="41383" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="41383" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="41383" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="41383" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L0_EP1TP1PP0DP0_GPU40 -->
<g id="node205" class="node">
<title>ln1_L0_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="41637.5,-78 41492.5,-78 41492.5,-26 41637.5,-26 41637.5,-78"/>
<text text-anchor="middle" x="41565" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="41565" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="41565" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="41565" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L0_EP1TP1PP0DP0_GPU40 -->
<g id="node206" class="node">
<title>qkv_L0_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="41818.5,-78 41673.5,-78 41673.5,-26 41818.5,-26 41818.5,-78"/>
<text text-anchor="middle" x="41746" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="41746" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="41746" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="41746" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L0_EP1TP1PP0DP0_GPU40 -->
<g id="node207" class="node">
<title>attn_L0_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="42005.5,-78 41854.5,-78 41854.5,-26 42005.5,-26 42005.5,-78"/>
<text text-anchor="middle" x="41930" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="41930" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="41930" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="41930" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L0_EP1TP1PP0DP0_GPU40 -->
<g id="node208" class="node">
<title>attn_out_L0_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="42186.5,-78 42041.5,-78 42041.5,-26 42186.5,-26 42186.5,-78"/>
<text text-anchor="middle" x="42114" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="42114" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="42114" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="42114" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L0_EP1TP1PP0DP0_GPU40 -->
<g id="node209" class="node">
<title>attn_ar_L0_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="42326" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="42326" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="42326" y="-49.5" font-family="Arial" font-size="10.00">L0 EP1 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="42326" y="-38.5" font-family="Arial" font-size="10.00">GPU40</text>
</g>
<!-- residual1_L0_EP1TP1PP0DP0_GPU40 -->
<g id="node210" class="node">
<title>residual1_L0_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="42611,-78 42465,-78 42465,-26 42611,-26 42611,-78"/>
<text text-anchor="middle" x="42538" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="42538" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="42538" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="42538" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L0_EP1TP1PP0DP0_GPU40 -->
<g id="node211" class="node">
<title>ln2_L0_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="42792.5,-78 42647.5,-78 42647.5,-26 42792.5,-26 42792.5,-78"/>
<text text-anchor="middle" x="42720" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="42720" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="42720" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="42720" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L0_EP1TP1PP0DP0_GPU40 -->
<g id="node212" class="node">
<title>gate_L0_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightyellow" stroke="black" points="43129.16,-104 42890.29,-104 42828.84,0 43067.71,0 43129.16,-104"/>
<text text-anchor="middle" x="42979" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="42979" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="42979" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="42979" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L0_EP1TP1PP0DP0_GPU40 -->
<g id="node213" class="node">
<title>dispatch_L0_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="43268" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="43268" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="43268" y="-44" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP0_GPU40</text>
</g>
<!-- expert_0_L0_EP1TP1PP0DP0_GPU40 -->
<g id="node214" class="node">
<title>expert_0_L0_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="43551.5,-78 43406.5,-78 43406.5,-26 43551.5,-26 43551.5,-78"/>
<text text-anchor="middle" x="43479" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="43479" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="43479" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="43479" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L0_EP1TP1PP0DP0_GPU40 -->
<g id="node215" class="node">
<title>expert_1_L0_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="43732.5,-78 43587.5,-78 43587.5,-26 43732.5,-26 43732.5,-78"/>
<text text-anchor="middle" x="43660" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="43660" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="43660" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="43660" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L0_EP1TP1PP0DP0_GPU40 -->
<g id="node216" class="node">
<title>expert_2_L0_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="43913.5,-78 43768.5,-78 43768.5,-26 43913.5,-26 43913.5,-78"/>
<text text-anchor="middle" x="43841" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="43841" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="43841" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="43841" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L0_EP1TP1PP0DP0_GPU40 -->
<g id="node217" class="node">
<title>expert_3_L0_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="44094.5,-78 43949.5,-78 43949.5,-26 44094.5,-26 44094.5,-78"/>
<text text-anchor="middle" x="44022" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="44022" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="44022" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="44022" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L0_EP1TP1PP0DP0_GPU40 -->
<g id="node218" class="node">
<title>combine_L0_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="44233" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="44233" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="44233" y="-44" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP0_GPU40</text>
</g>
<!-- ffn_L0_EP1TP1PP0DP0_GPU40 -->
<g id="node219" class="node">
<title>ffn_L0_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="44542,-78 44372,-78 44372,-26 44542,-26 44542,-78"/>
<text text-anchor="middle" x="44457" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="44457" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="44457" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="44457" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L0_EP1TP1PP0DP0_GPU40 -->
<g id="node220" class="node">
<title>ffn_ar_L0_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="44681" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="44681" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="44681" y="-49.5" font-family="Arial" font-size="10.00">L0 EP1 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="44681" y="-38.5" font-family="Arial" font-size="10.00">GPU40</text>
</g>
<!-- residual2_L0_EP1TP1PP0DP0_GPU40 -->
<g id="node221" class="node">
<title>residual2_L0_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="44966,-78 44820,-78 44820,-26 44966,-26 44966,-78"/>
<text text-anchor="middle" x="44893" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="44893" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="44893" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="44893" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L0_EP1TP1PP0DP1_GPU41 -->
<g id="node222" class="node">
<title>ln1_L0_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="45147.5,-78 45002.5,-78 45002.5,-26 45147.5,-26 45147.5,-78"/>
<text text-anchor="middle" x="45075" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="45075" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="45075" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="45075" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L0_EP1TP1PP0DP1_GPU41 -->
<g id="node223" class="node">
<title>qkv_L0_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="45328.5,-78 45183.5,-78 45183.5,-26 45328.5,-26 45328.5,-78"/>
<text text-anchor="middle" x="45256" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="45256" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="45256" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="45256" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L0_EP1TP1PP0DP1_GPU41 -->
<g id="node224" class="node">
<title>attn_L0_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="45515.5,-78 45364.5,-78 45364.5,-26 45515.5,-26 45515.5,-78"/>
<text text-anchor="middle" x="45440" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="45440" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="45440" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="45440" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L0_EP1TP1PP0DP1_GPU41 -->
<g id="node225" class="node">
<title>attn_out_L0_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="45696.5,-78 45551.5,-78 45551.5,-26 45696.5,-26 45696.5,-78"/>
<text text-anchor="middle" x="45624" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="45624" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="45624" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="45624" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L0_EP1TP1PP0DP1_GPU41 -->
<g id="node226" class="node">
<title>attn_ar_L0_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="45836" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="45836" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="45836" y="-49.5" font-family="Arial" font-size="10.00">L0 EP1 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="45836" y="-38.5" font-family="Arial" font-size="10.00">GPU41</text>
</g>
<!-- residual1_L0_EP1TP1PP0DP1_GPU41 -->
<g id="node227" class="node">
<title>residual1_L0_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="46121,-78 45975,-78 45975,-26 46121,-26 46121,-78"/>
<text text-anchor="middle" x="46048" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="46048" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="46048" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="46048" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L0_EP1TP1PP0DP1_GPU41 -->
<g id="node228" class="node">
<title>ln2_L0_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="46302.5,-78 46157.5,-78 46157.5,-26 46302.5,-26 46302.5,-78"/>
<text text-anchor="middle" x="46230" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="46230" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="46230" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="46230" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L0_EP1TP1PP0DP1_GPU41 -->
<g id="node229" class="node">
<title>gate_L0_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightyellow" stroke="black" points="46639.16,-104 46400.29,-104 46338.84,0 46577.71,0 46639.16,-104"/>
<text text-anchor="middle" x="46489" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="46489" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="46489" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="46489" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L0_EP1TP1PP0DP1_GPU41 -->
<g id="node230" class="node">
<title>dispatch_L0_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="46778" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="46778" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="46778" y="-44" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP1_GPU41</text>
</g>
<!-- expert_0_L0_EP1TP1PP0DP1_GPU41 -->
<g id="node231" class="node">
<title>expert_0_L0_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="47061.5,-78 46916.5,-78 46916.5,-26 47061.5,-26 47061.5,-78"/>
<text text-anchor="middle" x="46989" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="46989" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="46989" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="46989" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L0_EP1TP1PP0DP1_GPU41 -->
<g id="node232" class="node">
<title>expert_1_L0_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="47242.5,-78 47097.5,-78 47097.5,-26 47242.5,-26 47242.5,-78"/>
<text text-anchor="middle" x="47170" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="47170" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="47170" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="47170" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L0_EP1TP1PP0DP1_GPU41 -->
<g id="node233" class="node">
<title>expert_2_L0_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="47423.5,-78 47278.5,-78 47278.5,-26 47423.5,-26 47423.5,-78"/>
<text text-anchor="middle" x="47351" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="47351" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="47351" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="47351" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L0_EP1TP1PP0DP1_GPU41 -->
<g id="node234" class="node">
<title>expert_3_L0_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="47604.5,-78 47459.5,-78 47459.5,-26 47604.5,-26 47604.5,-78"/>
<text text-anchor="middle" x="47532" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="47532" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="47532" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="47532" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L0_EP1TP1PP0DP1_GPU41 -->
<g id="node235" class="node">
<title>combine_L0_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="47743" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="47743" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="47743" y="-44" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP1_GPU41</text>
</g>
<!-- ffn_L0_EP1TP1PP0DP1_GPU41 -->
<g id="node236" class="node">
<title>ffn_L0_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="48052,-78 47882,-78 47882,-26 48052,-26 48052,-78"/>
<text text-anchor="middle" x="47967" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="47967" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="47967" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="47967" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L0_EP1TP1PP0DP1_GPU41 -->
<g id="node237" class="node">
<title>ffn_ar_L0_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="48191" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="48191" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="48191" y="-49.5" font-family="Arial" font-size="10.00">L0 EP1 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="48191" y="-38.5" font-family="Arial" font-size="10.00">GPU41</text>
</g>
<!-- residual2_L0_EP1TP1PP0DP1_GPU41 -->
<g id="node238" class="node">
<title>residual2_L0_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="48476,-78 48330,-78 48330,-26 48476,-26 48476,-78"/>
<text text-anchor="middle" x="48403" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="48403" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="48403" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="48403" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L0_EP1TP2PP0DP0_GPU48 -->
<g id="node239" class="node">
<title>ln1_L0_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="48657.5,-78 48512.5,-78 48512.5,-26 48657.5,-26 48657.5,-78"/>
<text text-anchor="middle" x="48585" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="48585" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="48585" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="48585" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L0_EP1TP2PP0DP0_GPU48 -->
<g id="node240" class="node">
<title>qkv_L0_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="48838.5,-78 48693.5,-78 48693.5,-26 48838.5,-26 48838.5,-78"/>
<text text-anchor="middle" x="48766" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="48766" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="48766" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="48766" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L0_EP1TP2PP0DP0_GPU48 -->
<g id="node241" class="node">
<title>attn_L0_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="49025.5,-78 48874.5,-78 48874.5,-26 49025.5,-26 49025.5,-78"/>
<text text-anchor="middle" x="48950" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="48950" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="48950" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="48950" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L0_EP1TP2PP0DP0_GPU48 -->
<g id="node242" class="node">
<title>attn_out_L0_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="49206.5,-78 49061.5,-78 49061.5,-26 49206.5,-26 49206.5,-78"/>
<text text-anchor="middle" x="49134" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="49134" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="49134" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="49134" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L0_EP1TP2PP0DP0_GPU48 -->
<g id="node243" class="node">
<title>attn_ar_L0_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="49346" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="49346" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="49346" y="-49.5" font-family="Arial" font-size="10.00">L0 EP1 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="49346" y="-38.5" font-family="Arial" font-size="10.00">GPU48</text>
</g>
<!-- residual1_L0_EP1TP2PP0DP0_GPU48 -->
<g id="node244" class="node">
<title>residual1_L0_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="49631,-78 49485,-78 49485,-26 49631,-26 49631,-78"/>
<text text-anchor="middle" x="49558" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="49558" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="49558" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="49558" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L0_EP1TP2PP0DP0_GPU48 -->
<g id="node245" class="node">
<title>ln2_L0_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="49812.5,-78 49667.5,-78 49667.5,-26 49812.5,-26 49812.5,-78"/>
<text text-anchor="middle" x="49740" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="49740" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="49740" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="49740" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L0_EP1TP2PP0DP0_GPU48 -->
<g id="node246" class="node">
<title>gate_L0_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightyellow" stroke="black" points="50149.16,-104 49910.29,-104 49848.84,0 50087.71,0 50149.16,-104"/>
<text text-anchor="middle" x="49999" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="49999" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="49999" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="49999" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L0_EP1TP2PP0DP0_GPU48 -->
<g id="node247" class="node">
<title>dispatch_L0_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="50288" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="50288" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="50288" y="-44" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP0_GPU48</text>
</g>
<!-- expert_0_L0_EP1TP2PP0DP0_GPU48 -->
<g id="node248" class="node">
<title>expert_0_L0_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="50571.5,-78 50426.5,-78 50426.5,-26 50571.5,-26 50571.5,-78"/>
<text text-anchor="middle" x="50499" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="50499" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="50499" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="50499" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L0_EP1TP2PP0DP0_GPU48 -->
<g id="node249" class="node">
<title>expert_1_L0_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="50752.5,-78 50607.5,-78 50607.5,-26 50752.5,-26 50752.5,-78"/>
<text text-anchor="middle" x="50680" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="50680" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="50680" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="50680" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L0_EP1TP2PP0DP0_GPU48 -->
<g id="node250" class="node">
<title>expert_2_L0_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="50933.5,-78 50788.5,-78 50788.5,-26 50933.5,-26 50933.5,-78"/>
<text text-anchor="middle" x="50861" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="50861" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="50861" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="50861" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L0_EP1TP2PP0DP0_GPU48 -->
<g id="node251" class="node">
<title>expert_3_L0_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="51114.5,-78 50969.5,-78 50969.5,-26 51114.5,-26 51114.5,-78"/>
<text text-anchor="middle" x="51042" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="51042" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="51042" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="51042" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L0_EP1TP2PP0DP0_GPU48 -->
<g id="node252" class="node">
<title>combine_L0_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="51253" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="51253" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="51253" y="-44" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP0_GPU48</text>
</g>
<!-- ffn_L0_EP1TP2PP0DP0_GPU48 -->
<g id="node253" class="node">
<title>ffn_L0_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="51562,-78 51392,-78 51392,-26 51562,-26 51562,-78"/>
<text text-anchor="middle" x="51477" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="51477" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="51477" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="51477" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L0_EP1TP2PP0DP0_GPU48 -->
<g id="node254" class="node">
<title>ffn_ar_L0_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="51701" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="51701" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="51701" y="-49.5" font-family="Arial" font-size="10.00">L0 EP1 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="51701" y="-38.5" font-family="Arial" font-size="10.00">GPU48</text>
</g>
<!-- residual2_L0_EP1TP2PP0DP0_GPU48 -->
<g id="node255" class="node">
<title>residual2_L0_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="51986,-78 51840,-78 51840,-26 51986,-26 51986,-78"/>
<text text-anchor="middle" x="51913" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="51913" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="51913" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="51913" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L0_EP1TP2PP0DP1_GPU49 -->
<g id="node256" class="node">
<title>ln1_L0_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="52167.5,-78 52022.5,-78 52022.5,-26 52167.5,-26 52167.5,-78"/>
<text text-anchor="middle" x="52095" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="52095" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="52095" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="52095" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L0_EP1TP2PP0DP1_GPU49 -->
<g id="node257" class="node">
<title>qkv_L0_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="52348.5,-78 52203.5,-78 52203.5,-26 52348.5,-26 52348.5,-78"/>
<text text-anchor="middle" x="52276" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="52276" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="52276" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="52276" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L0_EP1TP2PP0DP1_GPU49 -->
<g id="node258" class="node">
<title>attn_L0_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="52535.5,-78 52384.5,-78 52384.5,-26 52535.5,-26 52535.5,-78"/>
<text text-anchor="middle" x="52460" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="52460" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="52460" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="52460" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L0_EP1TP2PP0DP1_GPU49 -->
<g id="node259" class="node">
<title>attn_out_L0_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="52716.5,-78 52571.5,-78 52571.5,-26 52716.5,-26 52716.5,-78"/>
<text text-anchor="middle" x="52644" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="52644" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="52644" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="52644" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L0_EP1TP2PP0DP1_GPU49 -->
<g id="node260" class="node">
<title>attn_ar_L0_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="52856" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="52856" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="52856" y="-49.5" font-family="Arial" font-size="10.00">L0 EP1 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="52856" y="-38.5" font-family="Arial" font-size="10.00">GPU49</text>
</g>
<!-- residual1_L0_EP1TP2PP0DP1_GPU49 -->
<g id="node261" class="node">
<title>residual1_L0_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="53141,-78 52995,-78 52995,-26 53141,-26 53141,-78"/>
<text text-anchor="middle" x="53068" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="53068" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="53068" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="53068" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L0_EP1TP2PP0DP1_GPU49 -->
<g id="node262" class="node">
<title>ln2_L0_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="53322.5,-78 53177.5,-78 53177.5,-26 53322.5,-26 53322.5,-78"/>
<text text-anchor="middle" x="53250" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="53250" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="53250" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="53250" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L0_EP1TP2PP0DP1_GPU49 -->
<g id="node263" class="node">
<title>gate_L0_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightyellow" stroke="black" points="53659.16,-104 53420.29,-104 53358.84,0 53597.71,0 53659.16,-104"/>
<text text-anchor="middle" x="53509" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="53509" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="53509" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="53509" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L0_EP1TP2PP0DP1_GPU49 -->
<g id="node264" class="node">
<title>dispatch_L0_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="53798" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="53798" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="53798" y="-44" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP1_GPU49</text>
</g>
<!-- expert_0_L0_EP1TP2PP0DP1_GPU49 -->
<g id="node265" class="node">
<title>expert_0_L0_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="54081.5,-78 53936.5,-78 53936.5,-26 54081.5,-26 54081.5,-78"/>
<text text-anchor="middle" x="54009" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="54009" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="54009" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="54009" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L0_EP1TP2PP0DP1_GPU49 -->
<g id="node266" class="node">
<title>expert_1_L0_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="54262.5,-78 54117.5,-78 54117.5,-26 54262.5,-26 54262.5,-78"/>
<text text-anchor="middle" x="54190" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="54190" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="54190" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="54190" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L0_EP1TP2PP0DP1_GPU49 -->
<g id="node267" class="node">
<title>expert_2_L0_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="54443.5,-78 54298.5,-78 54298.5,-26 54443.5,-26 54443.5,-78"/>
<text text-anchor="middle" x="54371" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="54371" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="54371" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="54371" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L0_EP1TP2PP0DP1_GPU49 -->
<g id="node268" class="node">
<title>expert_3_L0_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="54624.5,-78 54479.5,-78 54479.5,-26 54624.5,-26 54624.5,-78"/>
<text text-anchor="middle" x="54552" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="54552" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="54552" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="54552" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L0_EP1TP2PP0DP1_GPU49 -->
<g id="node269" class="node">
<title>combine_L0_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="54763" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="54763" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="54763" y="-44" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP1_GPU49</text>
</g>
<!-- ffn_L0_EP1TP2PP0DP1_GPU49 -->
<g id="node270" class="node">
<title>ffn_L0_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="55072,-78 54902,-78 54902,-26 55072,-26 55072,-78"/>
<text text-anchor="middle" x="54987" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="54987" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="54987" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="54987" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L0_EP1TP2PP0DP1_GPU49 -->
<g id="node271" class="node">
<title>ffn_ar_L0_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="55211" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="55211" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="55211" y="-49.5" font-family="Arial" font-size="10.00">L0 EP1 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="55211" y="-38.5" font-family="Arial" font-size="10.00">GPU49</text>
</g>
<!-- residual2_L0_EP1TP2PP0DP1_GPU49 -->
<g id="node272" class="node">
<title>residual2_L0_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="55496,-78 55350,-78 55350,-26 55496,-26 55496,-78"/>
<text text-anchor="middle" x="55423" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="55423" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="55423" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="55423" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L0_EP1TP3PP0DP0_GPU56 -->
<g id="node273" class="node">
<title>ln1_L0_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="55677.5,-78 55532.5,-78 55532.5,-26 55677.5,-26 55677.5,-78"/>
<text text-anchor="middle" x="55605" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="55605" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="55605" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="55605" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L0_EP1TP3PP0DP0_GPU56 -->
<g id="node274" class="node">
<title>qkv_L0_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="55858.5,-78 55713.5,-78 55713.5,-26 55858.5,-26 55858.5,-78"/>
<text text-anchor="middle" x="55786" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="55786" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="55786" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="55786" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L0_EP1TP3PP0DP0_GPU56 -->
<g id="node275" class="node">
<title>attn_L0_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="56045.5,-78 55894.5,-78 55894.5,-26 56045.5,-26 56045.5,-78"/>
<text text-anchor="middle" x="55970" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="55970" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="55970" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="55970" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L0_EP1TP3PP0DP0_GPU56 -->
<g id="node276" class="node">
<title>attn_out_L0_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="56226.5,-78 56081.5,-78 56081.5,-26 56226.5,-26 56226.5,-78"/>
<text text-anchor="middle" x="56154" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="56154" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="56154" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="56154" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L0_EP1TP3PP0DP0_GPU56 -->
<g id="node277" class="node">
<title>attn_ar_L0_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="56366" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="56366" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="56366" y="-49.5" font-family="Arial" font-size="10.00">L0 EP1 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="56366" y="-38.5" font-family="Arial" font-size="10.00">GPU56</text>
</g>
<!-- residual1_L0_EP1TP3PP0DP0_GPU56 -->
<g id="node278" class="node">
<title>residual1_L0_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="56651,-78 56505,-78 56505,-26 56651,-26 56651,-78"/>
<text text-anchor="middle" x="56578" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="56578" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="56578" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="56578" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L0_EP1TP3PP0DP0_GPU56 -->
<g id="node279" class="node">
<title>ln2_L0_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="56832.5,-78 56687.5,-78 56687.5,-26 56832.5,-26 56832.5,-78"/>
<text text-anchor="middle" x="56760" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="56760" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="56760" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="56760" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L0_EP1TP3PP0DP0_GPU56 -->
<g id="node280" class="node">
<title>gate_L0_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightyellow" stroke="black" points="57169.16,-104 56930.29,-104 56868.84,0 57107.71,0 57169.16,-104"/>
<text text-anchor="middle" x="57019" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="57019" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="57019" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="57019" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L0_EP1TP3PP0DP0_GPU56 -->
<g id="node281" class="node">
<title>dispatch_L0_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="57308" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="57308" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="57308" y="-44" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP0_GPU56</text>
</g>
<!-- expert_0_L0_EP1TP3PP0DP0_GPU56 -->
<g id="node282" class="node">
<title>expert_0_L0_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="57591.5,-78 57446.5,-78 57446.5,-26 57591.5,-26 57591.5,-78"/>
<text text-anchor="middle" x="57519" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="57519" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="57519" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="57519" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L0_EP1TP3PP0DP0_GPU56 -->
<g id="node283" class="node">
<title>expert_1_L0_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="57772.5,-78 57627.5,-78 57627.5,-26 57772.5,-26 57772.5,-78"/>
<text text-anchor="middle" x="57700" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="57700" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="57700" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="57700" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L0_EP1TP3PP0DP0_GPU56 -->
<g id="node284" class="node">
<title>expert_2_L0_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="57953.5,-78 57808.5,-78 57808.5,-26 57953.5,-26 57953.5,-78"/>
<text text-anchor="middle" x="57881" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="57881" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="57881" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="57881" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L0_EP1TP3PP0DP0_GPU56 -->
<g id="node285" class="node">
<title>expert_3_L0_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="58134.5,-78 57989.5,-78 57989.5,-26 58134.5,-26 58134.5,-78"/>
<text text-anchor="middle" x="58062" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="58062" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="58062" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="58062" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L0_EP1TP3PP0DP0_GPU56 -->
<g id="node286" class="node">
<title>combine_L0_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="58273" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="58273" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="58273" y="-44" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP0_GPU56</text>
</g>
<!-- ffn_L0_EP1TP3PP0DP0_GPU56 -->
<g id="node287" class="node">
<title>ffn_L0_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="58582,-78 58412,-78 58412,-26 58582,-26 58582,-78"/>
<text text-anchor="middle" x="58497" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="58497" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="58497" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="58497" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L0_EP1TP3PP0DP0_GPU56 -->
<g id="node288" class="node">
<title>ffn_ar_L0_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="58721" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="58721" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="58721" y="-49.5" font-family="Arial" font-size="10.00">L0 EP1 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="58721" y="-38.5" font-family="Arial" font-size="10.00">GPU56</text>
</g>
<!-- residual2_L0_EP1TP3PP0DP0_GPU56 -->
<g id="node289" class="node">
<title>residual2_L0_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="59006,-78 58860,-78 58860,-26 59006,-26 59006,-78"/>
<text text-anchor="middle" x="58933" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="58933" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="58933" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="58933" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L0_EP1TP3PP0DP1_GPU57 -->
<g id="node290" class="node">
<title>ln1_L0_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="59187.5,-78 59042.5,-78 59042.5,-26 59187.5,-26 59187.5,-78"/>
<text text-anchor="middle" x="59115" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="59115" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="59115" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="59115" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L0_EP1TP3PP0DP1_GPU57 -->
<g id="node291" class="node">
<title>qkv_L0_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="59368.5,-78 59223.5,-78 59223.5,-26 59368.5,-26 59368.5,-78"/>
<text text-anchor="middle" x="59296" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="59296" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="59296" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="59296" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L0_EP1TP3PP0DP1_GPU57 -->
<g id="node292" class="node">
<title>attn_L0_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="59555.5,-78 59404.5,-78 59404.5,-26 59555.5,-26 59555.5,-78"/>
<text text-anchor="middle" x="59480" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="59480" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="59480" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="59480" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L0_EP1TP3PP0DP1_GPU57 -->
<g id="node293" class="node">
<title>attn_out_L0_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="59736.5,-78 59591.5,-78 59591.5,-26 59736.5,-26 59736.5,-78"/>
<text text-anchor="middle" x="59664" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="59664" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="59664" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="59664" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L0_EP1TP3PP0DP1_GPU57 -->
<g id="node294" class="node">
<title>attn_ar_L0_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="59876" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="59876" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="59876" y="-49.5" font-family="Arial" font-size="10.00">L0 EP1 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="59876" y="-38.5" font-family="Arial" font-size="10.00">GPU57</text>
</g>
<!-- residual1_L0_EP1TP3PP0DP1_GPU57 -->
<g id="node295" class="node">
<title>residual1_L0_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="60161,-78 60015,-78 60015,-26 60161,-26 60161,-78"/>
<text text-anchor="middle" x="60088" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="60088" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="60088" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="60088" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L0_EP1TP3PP0DP1_GPU57 -->
<g id="node296" class="node">
<title>ln2_L0_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="60342.5,-78 60197.5,-78 60197.5,-26 60342.5,-26 60342.5,-78"/>
<text text-anchor="middle" x="60270" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="60270" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="60270" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="60270" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L0_EP1TP3PP0DP1_GPU57 -->
<g id="node297" class="node">
<title>gate_L0_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightyellow" stroke="black" points="60679.16,-104 60440.29,-104 60378.84,0 60617.71,0 60679.16,-104"/>
<text text-anchor="middle" x="60529" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="60529" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="60529" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="60529" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L0_EP1TP3PP0DP1_GPU57 -->
<g id="node298" class="node">
<title>dispatch_L0_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="60818" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="60818" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="60818" y="-44" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP1_GPU57</text>
</g>
<!-- expert_0_L0_EP1TP3PP0DP1_GPU57 -->
<g id="node299" class="node">
<title>expert_0_L0_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="61101.5,-78 60956.5,-78 60956.5,-26 61101.5,-26 61101.5,-78"/>
<text text-anchor="middle" x="61029" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="61029" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="61029" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="61029" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L0_EP1TP3PP0DP1_GPU57 -->
<g id="node300" class="node">
<title>expert_1_L0_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="61282.5,-78 61137.5,-78 61137.5,-26 61282.5,-26 61282.5,-78"/>
<text text-anchor="middle" x="61210" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="61210" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="61210" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="61210" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L0_EP1TP3PP0DP1_GPU57 -->
<g id="node301" class="node">
<title>expert_2_L0_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="61463.5,-78 61318.5,-78 61318.5,-26 61463.5,-26 61463.5,-78"/>
<text text-anchor="middle" x="61391" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="61391" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="61391" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="61391" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L0_EP1TP3PP0DP1_GPU57 -->
<g id="node302" class="node">
<title>expert_3_L0_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="61644.5,-78 61499.5,-78 61499.5,-26 61644.5,-26 61644.5,-78"/>
<text text-anchor="middle" x="61572" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="61572" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="61572" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="61572" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L0_EP1TP3PP0DP1_GPU57 -->
<g id="node303" class="node">
<title>combine_L0_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="61783" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="61783" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="61783" y="-44" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP1_GPU57</text>
</g>
<!-- ffn_L0_EP1TP3PP0DP1_GPU57 -->
<g id="node304" class="node">
<title>ffn_L0_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="62092,-78 61922,-78 61922,-26 62092,-26 62092,-78"/>
<text text-anchor="middle" x="62007" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="62007" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="62007" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="62007" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L0_EP1TP3PP0DP1_GPU57 -->
<g id="node305" class="node">
<title>ffn_ar_L0_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="62231" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="62231" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="62231" y="-49.5" font-family="Arial" font-size="10.00">L0 EP1 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="62231" y="-38.5" font-family="Arial" font-size="10.00">GPU57</text>
</g>
<!-- residual2_L0_EP1TP3PP0DP1_GPU57 -->
<g id="node306" class="node">
<title>residual2_L0_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="62516,-78 62370,-78 62370,-26 62516,-26 62516,-78"/>
<text text-anchor="middle" x="62443" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="62443" y="-55" font-family="Arial" font-size="10.00">L0_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="62443" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="62443" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L1_EP0TP0PP0DP0_GPU0 -->
<g id="node307" class="node">
<title>ln1_L1_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="62694,-78 62552,-78 62552,-26 62694,-26 62694,-78"/>
<text text-anchor="middle" x="62623" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="62623" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="62623" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="62623" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L1_EP0TP0PP0DP0_GPU0 -->
<g id="node308" class="node">
<title>qkv_L1_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="62872,-78 62730,-78 62730,-26 62872,-26 62872,-78"/>
<text text-anchor="middle" x="62801" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="62801" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="62801" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="62801" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L1_EP0TP0PP0DP0_GPU0 -->
<g id="node309" class="node">
<title>attn_L1_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="63059.5,-78 62908.5,-78 62908.5,-26 63059.5,-26 63059.5,-78"/>
<text text-anchor="middle" x="62984" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="62984" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="62984" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="62984" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L1_EP0TP0PP0DP0_GPU0 -->
<g id="node310" class="node">
<title>attn_out_L1_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="63238,-78 63096,-78 63096,-26 63238,-26 63238,-78"/>
<text text-anchor="middle" x="63167" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="63167" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="63167" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="63167" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L1_EP0TP0PP0DP0_GPU0 -->
<g id="node311" class="node">
<title>attn_ar_L1_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="63377" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="63377" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="63377" y="-49.5" font-family="Arial" font-size="10.00">L1 EP0 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="63377" y="-38.5" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- residual1_L1_EP0TP0PP0DP0_GPU0 -->
<g id="node312" class="node">
<title>residual1_L1_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="63662,-78 63516,-78 63516,-26 63662,-26 63662,-78"/>
<text text-anchor="middle" x="63589" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="63589" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="63589" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="63589" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L1_EP0TP0PP0DP0_GPU0 -->
<g id="node313" class="node">
<title>ln2_L1_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="63840,-78 63698,-78 63698,-26 63840,-26 63840,-78"/>
<text text-anchor="middle" x="63769" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="63769" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="63769" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="63769" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L1_EP0TP0PP0DP0_GPU0 -->
<g id="node314" class="node">
<title>gate_L1_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightyellow" stroke="black" points="64166.29,-104 63935.17,-104 63875.71,0 64106.83,0 64166.29,-104"/>
<text text-anchor="middle" x="64021" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="64021" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="64021" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="64021" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L1_EP0TP0PP0DP0_GPU0 -->
<g id="node315" class="node">
<title>dispatch_L1_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="64301" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="64301" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="64301" y="-44" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP0_GPU0</text>
</g>
<!-- expert_0_L1_EP0TP0PP0DP0_GPU0 -->
<g id="node316" class="node">
<title>expert_0_L1_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="64576,-78 64436,-78 64436,-26 64576,-26 64576,-78"/>
<text text-anchor="middle" x="64506" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="64506" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="64506" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="64506" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L1_EP0TP0PP0DP0_GPU0 -->
<g id="node317" class="node">
<title>expert_1_L1_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="64752,-78 64612,-78 64612,-26 64752,-26 64752,-78"/>
<text text-anchor="middle" x="64682" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="64682" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="64682" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="64682" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L1_EP0TP0PP0DP0_GPU0 -->
<g id="node318" class="node">
<title>expert_2_L1_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="64928,-78 64788,-78 64788,-26 64928,-26 64928,-78"/>
<text text-anchor="middle" x="64858" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="64858" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="64858" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="64858" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L1_EP0TP0PP0DP0_GPU0 -->
<g id="node319" class="node">
<title>expert_3_L1_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="65104,-78 64964,-78 64964,-26 65104,-26 65104,-78"/>
<text text-anchor="middle" x="65034" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="65034" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="65034" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="65034" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L1_EP0TP0PP0DP0_GPU0 -->
<g id="node320" class="node">
<title>combine_L1_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="65239" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="65239" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="65239" y="-44" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP0_GPU0</text>
</g>
<!-- ffn_L1_EP0TP0PP0DP0_GPU0 -->
<g id="node321" class="node">
<title>ffn_L1_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="65544,-78 65374,-78 65374,-26 65544,-26 65544,-78"/>
<text text-anchor="middle" x="65459" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="65459" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="65459" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="65459" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L1_EP0TP0PP0DP0_GPU0 -->
<g id="node322" class="node">
<title>ffn_ar_L1_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="65683" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="65683" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="65683" y="-49.5" font-family="Arial" font-size="10.00">L1 EP0 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="65683" y="-38.5" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- residual2_L1_EP0TP0PP0DP0_GPU0 -->
<g id="node323" class="node">
<title>residual2_L1_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="65968,-78 65822,-78 65822,-26 65968,-26 65968,-78"/>
<text text-anchor="middle" x="65895" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="65895" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="65895" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="65895" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L1_EP0TP0PP0DP1_GPU1 -->
<g id="node324" class="node">
<title>ln1_L1_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="66146,-78 66004,-78 66004,-26 66146,-26 66146,-78"/>
<text text-anchor="middle" x="66075" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="66075" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="66075" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="66075" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L1_EP0TP0PP0DP1_GPU1 -->
<g id="node325" class="node">
<title>qkv_L1_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="66324,-78 66182,-78 66182,-26 66324,-26 66324,-78"/>
<text text-anchor="middle" x="66253" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="66253" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="66253" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="66253" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L1_EP0TP0PP0DP1_GPU1 -->
<g id="node326" class="node">
<title>attn_L1_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="66511.5,-78 66360.5,-78 66360.5,-26 66511.5,-26 66511.5,-78"/>
<text text-anchor="middle" x="66436" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="66436" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="66436" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="66436" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L1_EP0TP0PP0DP1_GPU1 -->
<g id="node327" class="node">
<title>attn_out_L1_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="66690,-78 66548,-78 66548,-26 66690,-26 66690,-78"/>
<text text-anchor="middle" x="66619" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="66619" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="66619" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="66619" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L1_EP0TP0PP0DP1_GPU1 -->
<g id="node328" class="node">
<title>attn_ar_L1_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="66829" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="66829" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="66829" y="-49.5" font-family="Arial" font-size="10.00">L1 EP0 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="66829" y="-38.5" font-family="Arial" font-size="10.00">GPU1</text>
</g>
<!-- residual1_L1_EP0TP0PP0DP1_GPU1 -->
<g id="node329" class="node">
<title>residual1_L1_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="67114,-78 66968,-78 66968,-26 67114,-26 67114,-78"/>
<text text-anchor="middle" x="67041" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="67041" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="67041" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="67041" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L1_EP0TP0PP0DP1_GPU1 -->
<g id="node330" class="node">
<title>ln2_L1_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="67292,-78 67150,-78 67150,-26 67292,-26 67292,-78"/>
<text text-anchor="middle" x="67221" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="67221" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="67221" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="67221" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L1_EP0TP0PP0DP1_GPU1 -->
<g id="node331" class="node">
<title>gate_L1_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightyellow" stroke="black" points="67618.29,-104 67387.17,-104 67327.71,0 67558.83,0 67618.29,-104"/>
<text text-anchor="middle" x="67473" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="67473" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="67473" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="67473" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L1_EP0TP0PP0DP1_GPU1 -->
<g id="node332" class="node">
<title>dispatch_L1_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="67753" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="67753" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="67753" y="-44" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP1_GPU1</text>
</g>
<!-- expert_0_L1_EP0TP0PP0DP1_GPU1 -->
<g id="node333" class="node">
<title>expert_0_L1_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="68028,-78 67888,-78 67888,-26 68028,-26 68028,-78"/>
<text text-anchor="middle" x="67958" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="67958" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="67958" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="67958" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L1_EP0TP0PP0DP1_GPU1 -->
<g id="node334" class="node">
<title>expert_1_L1_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="68204,-78 68064,-78 68064,-26 68204,-26 68204,-78"/>
<text text-anchor="middle" x="68134" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="68134" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="68134" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="68134" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L1_EP0TP0PP0DP1_GPU1 -->
<g id="node335" class="node">
<title>expert_2_L1_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="68380,-78 68240,-78 68240,-26 68380,-26 68380,-78"/>
<text text-anchor="middle" x="68310" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="68310" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="68310" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="68310" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L1_EP0TP0PP0DP1_GPU1 -->
<g id="node336" class="node">
<title>expert_3_L1_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="68556,-78 68416,-78 68416,-26 68556,-26 68556,-78"/>
<text text-anchor="middle" x="68486" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="68486" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="68486" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="68486" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L1_EP0TP0PP0DP1_GPU1 -->
<g id="node337" class="node">
<title>combine_L1_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="68691" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="68691" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="68691" y="-44" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP1_GPU1</text>
</g>
<!-- ffn_L1_EP0TP0PP0DP1_GPU1 -->
<g id="node338" class="node">
<title>ffn_L1_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="68996,-78 68826,-78 68826,-26 68996,-26 68996,-78"/>
<text text-anchor="middle" x="68911" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="68911" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="68911" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="68911" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L1_EP0TP0PP0DP1_GPU1 -->
<g id="node339" class="node">
<title>ffn_ar_L1_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="69135" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="69135" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="69135" y="-49.5" font-family="Arial" font-size="10.00">L1 EP0 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="69135" y="-38.5" font-family="Arial" font-size="10.00">GPU1</text>
</g>
<!-- residual2_L1_EP0TP0PP0DP1_GPU1 -->
<g id="node340" class="node">
<title>residual2_L1_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="69420,-78 69274,-78 69274,-26 69420,-26 69420,-78"/>
<text text-anchor="middle" x="69347" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="69347" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="69347" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="69347" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L1_EP0TP1PP0DP0_GPU8 -->
<g id="node341" class="node">
<title>ln1_L1_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="69598,-78 69456,-78 69456,-26 69598,-26 69598,-78"/>
<text text-anchor="middle" x="69527" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="69527" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="69527" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="69527" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L1_EP0TP1PP0DP0_GPU8 -->
<g id="node342" class="node">
<title>qkv_L1_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="69776,-78 69634,-78 69634,-26 69776,-26 69776,-78"/>
<text text-anchor="middle" x="69705" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="69705" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="69705" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="69705" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L1_EP0TP1PP0DP0_GPU8 -->
<g id="node343" class="node">
<title>attn_L1_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="69963.5,-78 69812.5,-78 69812.5,-26 69963.5,-26 69963.5,-78"/>
<text text-anchor="middle" x="69888" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="69888" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="69888" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="69888" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L1_EP0TP1PP0DP0_GPU8 -->
<g id="node344" class="node">
<title>attn_out_L1_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="70142,-78 70000,-78 70000,-26 70142,-26 70142,-78"/>
<text text-anchor="middle" x="70071" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="70071" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="70071" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="70071" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L1_EP0TP1PP0DP0_GPU8 -->
<g id="node345" class="node">
<title>attn_ar_L1_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="70281" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="70281" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="70281" y="-49.5" font-family="Arial" font-size="10.00">L1 EP0 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="70281" y="-38.5" font-family="Arial" font-size="10.00">GPU8</text>
</g>
<!-- residual1_L1_EP0TP1PP0DP0_GPU8 -->
<g id="node346" class="node">
<title>residual1_L1_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="70566,-78 70420,-78 70420,-26 70566,-26 70566,-78"/>
<text text-anchor="middle" x="70493" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="70493" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="70493" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="70493" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L1_EP0TP1PP0DP0_GPU8 -->
<g id="node347" class="node">
<title>ln2_L1_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="70744,-78 70602,-78 70602,-26 70744,-26 70744,-78"/>
<text text-anchor="middle" x="70673" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="70673" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="70673" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="70673" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L1_EP0TP1PP0DP0_GPU8 -->
<g id="node348" class="node">
<title>gate_L1_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightyellow" stroke="black" points="71070.29,-104 70839.17,-104 70779.71,0 71010.83,0 71070.29,-104"/>
<text text-anchor="middle" x="70925" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="70925" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="70925" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="70925" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L1_EP0TP1PP0DP0_GPU8 -->
<g id="node349" class="node">
<title>dispatch_L1_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="71205" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="71205" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="71205" y="-44" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP0_GPU8</text>
</g>
<!-- expert_0_L1_EP0TP1PP0DP0_GPU8 -->
<g id="node350" class="node">
<title>expert_0_L1_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="71480,-78 71340,-78 71340,-26 71480,-26 71480,-78"/>
<text text-anchor="middle" x="71410" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="71410" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="71410" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="71410" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L1_EP0TP1PP0DP0_GPU8 -->
<g id="node351" class="node">
<title>expert_1_L1_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="71656,-78 71516,-78 71516,-26 71656,-26 71656,-78"/>
<text text-anchor="middle" x="71586" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="71586" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="71586" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="71586" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L1_EP0TP1PP0DP0_GPU8 -->
<g id="node352" class="node">
<title>expert_2_L1_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="71832,-78 71692,-78 71692,-26 71832,-26 71832,-78"/>
<text text-anchor="middle" x="71762" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="71762" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="71762" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="71762" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L1_EP0TP1PP0DP0_GPU8 -->
<g id="node353" class="node">
<title>expert_3_L1_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="72008,-78 71868,-78 71868,-26 72008,-26 72008,-78"/>
<text text-anchor="middle" x="71938" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="71938" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="71938" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="71938" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L1_EP0TP1PP0DP0_GPU8 -->
<g id="node354" class="node">
<title>combine_L1_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="72143" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="72143" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="72143" y="-44" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP0_GPU8</text>
</g>
<!-- ffn_L1_EP0TP1PP0DP0_GPU8 -->
<g id="node355" class="node">
<title>ffn_L1_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="72448,-78 72278,-78 72278,-26 72448,-26 72448,-78"/>
<text text-anchor="middle" x="72363" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="72363" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="72363" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="72363" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L1_EP0TP1PP0DP0_GPU8 -->
<g id="node356" class="node">
<title>ffn_ar_L1_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="72587" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="72587" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="72587" y="-49.5" font-family="Arial" font-size="10.00">L1 EP0 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="72587" y="-38.5" font-family="Arial" font-size="10.00">GPU8</text>
</g>
<!-- residual2_L1_EP0TP1PP0DP0_GPU8 -->
<g id="node357" class="node">
<title>residual2_L1_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="72872,-78 72726,-78 72726,-26 72872,-26 72872,-78"/>
<text text-anchor="middle" x="72799" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="72799" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="72799" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="72799" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L1_EP0TP1PP0DP1_GPU9 -->
<g id="node358" class="node">
<title>ln1_L1_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="73050,-78 72908,-78 72908,-26 73050,-26 73050,-78"/>
<text text-anchor="middle" x="72979" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="72979" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="72979" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="72979" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L1_EP0TP1PP0DP1_GPU9 -->
<g id="node359" class="node">
<title>qkv_L1_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="73228,-78 73086,-78 73086,-26 73228,-26 73228,-78"/>
<text text-anchor="middle" x="73157" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="73157" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="73157" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="73157" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L1_EP0TP1PP0DP1_GPU9 -->
<g id="node360" class="node">
<title>attn_L1_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="73415.5,-78 73264.5,-78 73264.5,-26 73415.5,-26 73415.5,-78"/>
<text text-anchor="middle" x="73340" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="73340" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="73340" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="73340" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L1_EP0TP1PP0DP1_GPU9 -->
<g id="node361" class="node">
<title>attn_out_L1_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="73594,-78 73452,-78 73452,-26 73594,-26 73594,-78"/>
<text text-anchor="middle" x="73523" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="73523" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="73523" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="73523" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L1_EP0TP1PP0DP1_GPU9 -->
<g id="node362" class="node">
<title>attn_ar_L1_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="73733" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="73733" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="73733" y="-49.5" font-family="Arial" font-size="10.00">L1 EP0 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="73733" y="-38.5" font-family="Arial" font-size="10.00">GPU9</text>
</g>
<!-- residual1_L1_EP0TP1PP0DP1_GPU9 -->
<g id="node363" class="node">
<title>residual1_L1_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="74018,-78 73872,-78 73872,-26 74018,-26 74018,-78"/>
<text text-anchor="middle" x="73945" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="73945" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="73945" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="73945" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L1_EP0TP1PP0DP1_GPU9 -->
<g id="node364" class="node">
<title>ln2_L1_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="74196,-78 74054,-78 74054,-26 74196,-26 74196,-78"/>
<text text-anchor="middle" x="74125" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="74125" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="74125" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="74125" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L1_EP0TP1PP0DP1_GPU9 -->
<g id="node365" class="node">
<title>gate_L1_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightyellow" stroke="black" points="74522.29,-104 74291.17,-104 74231.71,0 74462.83,0 74522.29,-104"/>
<text text-anchor="middle" x="74377" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="74377" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="74377" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="74377" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L1_EP0TP1PP0DP1_GPU9 -->
<g id="node366" class="node">
<title>dispatch_L1_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="74657" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="74657" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="74657" y="-44" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP1_GPU9</text>
</g>
<!-- expert_0_L1_EP0TP1PP0DP1_GPU9 -->
<g id="node367" class="node">
<title>expert_0_L1_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="74932,-78 74792,-78 74792,-26 74932,-26 74932,-78"/>
<text text-anchor="middle" x="74862" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="74862" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="74862" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="74862" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L1_EP0TP1PP0DP1_GPU9 -->
<g id="node368" class="node">
<title>expert_1_L1_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="75108,-78 74968,-78 74968,-26 75108,-26 75108,-78"/>
<text text-anchor="middle" x="75038" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="75038" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="75038" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="75038" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L1_EP0TP1PP0DP1_GPU9 -->
<g id="node369" class="node">
<title>expert_2_L1_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="75284,-78 75144,-78 75144,-26 75284,-26 75284,-78"/>
<text text-anchor="middle" x="75214" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="75214" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="75214" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="75214" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L1_EP0TP1PP0DP1_GPU9 -->
<g id="node370" class="node">
<title>expert_3_L1_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="75460,-78 75320,-78 75320,-26 75460,-26 75460,-78"/>
<text text-anchor="middle" x="75390" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="75390" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="75390" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="75390" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L1_EP0TP1PP0DP1_GPU9 -->
<g id="node371" class="node">
<title>combine_L1_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="75595" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="75595" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="75595" y="-44" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP1_GPU9</text>
</g>
<!-- ffn_L1_EP0TP1PP0DP1_GPU9 -->
<g id="node372" class="node">
<title>ffn_L1_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="75900,-78 75730,-78 75730,-26 75900,-26 75900,-78"/>
<text text-anchor="middle" x="75815" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="75815" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="75815" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="75815" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L1_EP0TP1PP0DP1_GPU9 -->
<g id="node373" class="node">
<title>ffn_ar_L1_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="76039" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="76039" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="76039" y="-49.5" font-family="Arial" font-size="10.00">L1 EP0 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="76039" y="-38.5" font-family="Arial" font-size="10.00">GPU9</text>
</g>
<!-- residual2_L1_EP0TP1PP0DP1_GPU9 -->
<g id="node374" class="node">
<title>residual2_L1_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="76324,-78 76178,-78 76178,-26 76324,-26 76324,-78"/>
<text text-anchor="middle" x="76251" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="76251" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="76251" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="76251" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L1_EP0TP2PP0DP0_GPU16 -->
<g id="node375" class="node">
<title>ln1_L1_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="76505.5,-78 76360.5,-78 76360.5,-26 76505.5,-26 76505.5,-78"/>
<text text-anchor="middle" x="76433" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="76433" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="76433" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="76433" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L1_EP0TP2PP0DP0_GPU16 -->
<g id="node376" class="node">
<title>qkv_L1_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="76686.5,-78 76541.5,-78 76541.5,-26 76686.5,-26 76686.5,-78"/>
<text text-anchor="middle" x="76614" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="76614" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="76614" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="76614" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L1_EP0TP2PP0DP0_GPU16 -->
<g id="node377" class="node">
<title>attn_L1_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="76873.5,-78 76722.5,-78 76722.5,-26 76873.5,-26 76873.5,-78"/>
<text text-anchor="middle" x="76798" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="76798" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="76798" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="76798" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L1_EP0TP2PP0DP0_GPU16 -->
<g id="node378" class="node">
<title>attn_out_L1_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="77054.5,-78 76909.5,-78 76909.5,-26 77054.5,-26 77054.5,-78"/>
<text text-anchor="middle" x="76982" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="76982" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="76982" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="76982" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L1_EP0TP2PP0DP0_GPU16 -->
<g id="node379" class="node">
<title>attn_ar_L1_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="77194" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="77194" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="77194" y="-49.5" font-family="Arial" font-size="10.00">L1 EP0 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="77194" y="-38.5" font-family="Arial" font-size="10.00">GPU16</text>
</g>
<!-- residual1_L1_EP0TP2PP0DP0_GPU16 -->
<g id="node380" class="node">
<title>residual1_L1_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="77479,-78 77333,-78 77333,-26 77479,-26 77479,-78"/>
<text text-anchor="middle" x="77406" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="77406" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="77406" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="77406" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L1_EP0TP2PP0DP0_GPU16 -->
<g id="node381" class="node">
<title>ln2_L1_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="77660.5,-78 77515.5,-78 77515.5,-26 77660.5,-26 77660.5,-78"/>
<text text-anchor="middle" x="77588" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="77588" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="77588" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="77588" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L1_EP0TP2PP0DP0_GPU16 -->
<g id="node382" class="node">
<title>gate_L1_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightyellow" stroke="black" points="77997.16,-104 77758.29,-104 77696.84,0 77935.71,0 77997.16,-104"/>
<text text-anchor="middle" x="77847" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="77847" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="77847" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="77847" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L1_EP0TP2PP0DP0_GPU16 -->
<g id="node383" class="node">
<title>dispatch_L1_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="78136" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="78136" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="78136" y="-44" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP0_GPU16</text>
</g>
<!-- expert_0_L1_EP0TP2PP0DP0_GPU16 -->
<g id="node384" class="node">
<title>expert_0_L1_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="78419.5,-78 78274.5,-78 78274.5,-26 78419.5,-26 78419.5,-78"/>
<text text-anchor="middle" x="78347" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="78347" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="78347" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="78347" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L1_EP0TP2PP0DP0_GPU16 -->
<g id="node385" class="node">
<title>expert_1_L1_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="78600.5,-78 78455.5,-78 78455.5,-26 78600.5,-26 78600.5,-78"/>
<text text-anchor="middle" x="78528" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="78528" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="78528" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="78528" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L1_EP0TP2PP0DP0_GPU16 -->
<g id="node386" class="node">
<title>expert_2_L1_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="78781.5,-78 78636.5,-78 78636.5,-26 78781.5,-26 78781.5,-78"/>
<text text-anchor="middle" x="78709" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="78709" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="78709" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="78709" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L1_EP0TP2PP0DP0_GPU16 -->
<g id="node387" class="node">
<title>expert_3_L1_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="78962.5,-78 78817.5,-78 78817.5,-26 78962.5,-26 78962.5,-78"/>
<text text-anchor="middle" x="78890" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="78890" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="78890" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="78890" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L1_EP0TP2PP0DP0_GPU16 -->
<g id="node388" class="node">
<title>combine_L1_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="79101" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="79101" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="79101" y="-44" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP0_GPU16</text>
</g>
<!-- ffn_L1_EP0TP2PP0DP0_GPU16 -->
<g id="node389" class="node">
<title>ffn_L1_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="79410,-78 79240,-78 79240,-26 79410,-26 79410,-78"/>
<text text-anchor="middle" x="79325" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="79325" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="79325" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="79325" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L1_EP0TP2PP0DP0_GPU16 -->
<g id="node390" class="node">
<title>ffn_ar_L1_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="79549" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="79549" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="79549" y="-49.5" font-family="Arial" font-size="10.00">L1 EP0 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="79549" y="-38.5" font-family="Arial" font-size="10.00">GPU16</text>
</g>
<!-- residual2_L1_EP0TP2PP0DP0_GPU16 -->
<g id="node391" class="node">
<title>residual2_L1_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="79834,-78 79688,-78 79688,-26 79834,-26 79834,-78"/>
<text text-anchor="middle" x="79761" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="79761" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="79761" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="79761" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L1_EP0TP2PP0DP1_GPU17 -->
<g id="node392" class="node">
<title>ln1_L1_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="80015.5,-78 79870.5,-78 79870.5,-26 80015.5,-26 80015.5,-78"/>
<text text-anchor="middle" x="79943" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="79943" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="79943" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="79943" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L1_EP0TP2PP0DP1_GPU17 -->
<g id="node393" class="node">
<title>qkv_L1_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="80196.5,-78 80051.5,-78 80051.5,-26 80196.5,-26 80196.5,-78"/>
<text text-anchor="middle" x="80124" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="80124" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="80124" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="80124" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L1_EP0TP2PP0DP1_GPU17 -->
<g id="node394" class="node">
<title>attn_L1_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="80383.5,-78 80232.5,-78 80232.5,-26 80383.5,-26 80383.5,-78"/>
<text text-anchor="middle" x="80308" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="80308" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="80308" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="80308" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L1_EP0TP2PP0DP1_GPU17 -->
<g id="node395" class="node">
<title>attn_out_L1_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="80564.5,-78 80419.5,-78 80419.5,-26 80564.5,-26 80564.5,-78"/>
<text text-anchor="middle" x="80492" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="80492" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="80492" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="80492" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L1_EP0TP2PP0DP1_GPU17 -->
<g id="node396" class="node">
<title>attn_ar_L1_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="80704" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="80704" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="80704" y="-49.5" font-family="Arial" font-size="10.00">L1 EP0 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="80704" y="-38.5" font-family="Arial" font-size="10.00">GPU17</text>
</g>
<!-- residual1_L1_EP0TP2PP0DP1_GPU17 -->
<g id="node397" class="node">
<title>residual1_L1_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="80989,-78 80843,-78 80843,-26 80989,-26 80989,-78"/>
<text text-anchor="middle" x="80916" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="80916" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="80916" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="80916" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L1_EP0TP2PP0DP1_GPU17 -->
<g id="node398" class="node">
<title>ln2_L1_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="81170.5,-78 81025.5,-78 81025.5,-26 81170.5,-26 81170.5,-78"/>
<text text-anchor="middle" x="81098" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="81098" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="81098" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="81098" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L1_EP0TP2PP0DP1_GPU17 -->
<g id="node399" class="node">
<title>gate_L1_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightyellow" stroke="black" points="81507.16,-104 81268.29,-104 81206.84,0 81445.71,0 81507.16,-104"/>
<text text-anchor="middle" x="81357" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="81357" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="81357" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="81357" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L1_EP0TP2PP0DP1_GPU17 -->
<g id="node400" class="node">
<title>dispatch_L1_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="81646" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="81646" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="81646" y="-44" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP1_GPU17</text>
</g>
<!-- expert_0_L1_EP0TP2PP0DP1_GPU17 -->
<g id="node401" class="node">
<title>expert_0_L1_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="81929.5,-78 81784.5,-78 81784.5,-26 81929.5,-26 81929.5,-78"/>
<text text-anchor="middle" x="81857" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="81857" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="81857" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="81857" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L1_EP0TP2PP0DP1_GPU17 -->
<g id="node402" class="node">
<title>expert_1_L1_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="82110.5,-78 81965.5,-78 81965.5,-26 82110.5,-26 82110.5,-78"/>
<text text-anchor="middle" x="82038" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="82038" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="82038" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="82038" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L1_EP0TP2PP0DP1_GPU17 -->
<g id="node403" class="node">
<title>expert_2_L1_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="82291.5,-78 82146.5,-78 82146.5,-26 82291.5,-26 82291.5,-78"/>
<text text-anchor="middle" x="82219" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="82219" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="82219" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="82219" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L1_EP0TP2PP0DP1_GPU17 -->
<g id="node404" class="node">
<title>expert_3_L1_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="82472.5,-78 82327.5,-78 82327.5,-26 82472.5,-26 82472.5,-78"/>
<text text-anchor="middle" x="82400" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="82400" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="82400" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="82400" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L1_EP0TP2PP0DP1_GPU17 -->
<g id="node405" class="node">
<title>combine_L1_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="82611" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="82611" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="82611" y="-44" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP1_GPU17</text>
</g>
<!-- ffn_L1_EP0TP2PP0DP1_GPU17 -->
<g id="node406" class="node">
<title>ffn_L1_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="82920,-78 82750,-78 82750,-26 82920,-26 82920,-78"/>
<text text-anchor="middle" x="82835" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="82835" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="82835" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="82835" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L1_EP0TP2PP0DP1_GPU17 -->
<g id="node407" class="node">
<title>ffn_ar_L1_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="83059" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="83059" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="83059" y="-49.5" font-family="Arial" font-size="10.00">L1 EP0 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="83059" y="-38.5" font-family="Arial" font-size="10.00">GPU17</text>
</g>
<!-- residual2_L1_EP0TP2PP0DP1_GPU17 -->
<g id="node408" class="node">
<title>residual2_L1_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="83344,-78 83198,-78 83198,-26 83344,-26 83344,-78"/>
<text text-anchor="middle" x="83271" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="83271" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="83271" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="83271" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L1_EP0TP3PP0DP0_GPU24 -->
<g id="node409" class="node">
<title>ln1_L1_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="83525.5,-78 83380.5,-78 83380.5,-26 83525.5,-26 83525.5,-78"/>
<text text-anchor="middle" x="83453" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="83453" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="83453" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="83453" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L1_EP0TP3PP0DP0_GPU24 -->
<g id="node410" class="node">
<title>qkv_L1_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="83706.5,-78 83561.5,-78 83561.5,-26 83706.5,-26 83706.5,-78"/>
<text text-anchor="middle" x="83634" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="83634" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="83634" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="83634" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L1_EP0TP3PP0DP0_GPU24 -->
<g id="node411" class="node">
<title>attn_L1_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="83893.5,-78 83742.5,-78 83742.5,-26 83893.5,-26 83893.5,-78"/>
<text text-anchor="middle" x="83818" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="83818" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="83818" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="83818" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L1_EP0TP3PP0DP0_GPU24 -->
<g id="node412" class="node">
<title>attn_out_L1_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="84074.5,-78 83929.5,-78 83929.5,-26 84074.5,-26 84074.5,-78"/>
<text text-anchor="middle" x="84002" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="84002" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="84002" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="84002" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L1_EP0TP3PP0DP0_GPU24 -->
<g id="node413" class="node">
<title>attn_ar_L1_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="84214" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="84214" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="84214" y="-49.5" font-family="Arial" font-size="10.00">L1 EP0 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="84214" y="-38.5" font-family="Arial" font-size="10.00">GPU24</text>
</g>
<!-- residual1_L1_EP0TP3PP0DP0_GPU24 -->
<g id="node414" class="node">
<title>residual1_L1_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="84499,-78 84353,-78 84353,-26 84499,-26 84499,-78"/>
<text text-anchor="middle" x="84426" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="84426" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="84426" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="84426" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L1_EP0TP3PP0DP0_GPU24 -->
<g id="node415" class="node">
<title>ln2_L1_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="84680.5,-78 84535.5,-78 84535.5,-26 84680.5,-26 84680.5,-78"/>
<text text-anchor="middle" x="84608" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="84608" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="84608" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="84608" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L1_EP0TP3PP0DP0_GPU24 -->
<g id="node416" class="node">
<title>gate_L1_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightyellow" stroke="black" points="85017.16,-104 84778.29,-104 84716.84,0 84955.71,0 85017.16,-104"/>
<text text-anchor="middle" x="84867" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="84867" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="84867" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="84867" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L1_EP0TP3PP0DP0_GPU24 -->
<g id="node417" class="node">
<title>dispatch_L1_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="85156" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="85156" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="85156" y="-44" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP0_GPU24</text>
</g>
<!-- expert_0_L1_EP0TP3PP0DP0_GPU24 -->
<g id="node418" class="node">
<title>expert_0_L1_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="85439.5,-78 85294.5,-78 85294.5,-26 85439.5,-26 85439.5,-78"/>
<text text-anchor="middle" x="85367" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="85367" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="85367" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="85367" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L1_EP0TP3PP0DP0_GPU24 -->
<g id="node419" class="node">
<title>expert_1_L1_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="85620.5,-78 85475.5,-78 85475.5,-26 85620.5,-26 85620.5,-78"/>
<text text-anchor="middle" x="85548" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="85548" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="85548" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="85548" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L1_EP0TP3PP0DP0_GPU24 -->
<g id="node420" class="node">
<title>expert_2_L1_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="85801.5,-78 85656.5,-78 85656.5,-26 85801.5,-26 85801.5,-78"/>
<text text-anchor="middle" x="85729" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="85729" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="85729" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="85729" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L1_EP0TP3PP0DP0_GPU24 -->
<g id="node421" class="node">
<title>expert_3_L1_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="85982.5,-78 85837.5,-78 85837.5,-26 85982.5,-26 85982.5,-78"/>
<text text-anchor="middle" x="85910" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="85910" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="85910" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="85910" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L1_EP0TP3PP0DP0_GPU24 -->
<g id="node422" class="node">
<title>combine_L1_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="86121" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="86121" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="86121" y="-44" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP0_GPU24</text>
</g>
<!-- ffn_L1_EP0TP3PP0DP0_GPU24 -->
<g id="node423" class="node">
<title>ffn_L1_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="86430,-78 86260,-78 86260,-26 86430,-26 86430,-78"/>
<text text-anchor="middle" x="86345" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="86345" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="86345" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="86345" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L1_EP0TP3PP0DP0_GPU24 -->
<g id="node424" class="node">
<title>ffn_ar_L1_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="86569" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="86569" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="86569" y="-49.5" font-family="Arial" font-size="10.00">L1 EP0 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="86569" y="-38.5" font-family="Arial" font-size="10.00">GPU24</text>
</g>
<!-- residual2_L1_EP0TP3PP0DP0_GPU24 -->
<g id="node425" class="node">
<title>residual2_L1_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="86854,-78 86708,-78 86708,-26 86854,-26 86854,-78"/>
<text text-anchor="middle" x="86781" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="86781" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="86781" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="86781" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L1_EP0TP3PP0DP1_GPU25 -->
<g id="node426" class="node">
<title>ln1_L1_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="87035.5,-78 86890.5,-78 86890.5,-26 87035.5,-26 87035.5,-78"/>
<text text-anchor="middle" x="86963" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="86963" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="86963" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="86963" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L1_EP0TP3PP0DP1_GPU25 -->
<g id="node427" class="node">
<title>qkv_L1_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="87216.5,-78 87071.5,-78 87071.5,-26 87216.5,-26 87216.5,-78"/>
<text text-anchor="middle" x="87144" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="87144" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="87144" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="87144" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L1_EP0TP3PP0DP1_GPU25 -->
<g id="node428" class="node">
<title>attn_L1_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="87403.5,-78 87252.5,-78 87252.5,-26 87403.5,-26 87403.5,-78"/>
<text text-anchor="middle" x="87328" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="87328" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="87328" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="87328" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L1_EP0TP3PP0DP1_GPU25 -->
<g id="node429" class="node">
<title>attn_out_L1_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="87584.5,-78 87439.5,-78 87439.5,-26 87584.5,-26 87584.5,-78"/>
<text text-anchor="middle" x="87512" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="87512" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="87512" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="87512" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L1_EP0TP3PP0DP1_GPU25 -->
<g id="node430" class="node">
<title>attn_ar_L1_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="87724" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="87724" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="87724" y="-49.5" font-family="Arial" font-size="10.00">L1 EP0 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="87724" y="-38.5" font-family="Arial" font-size="10.00">GPU25</text>
</g>
<!-- residual1_L1_EP0TP3PP0DP1_GPU25 -->
<g id="node431" class="node">
<title>residual1_L1_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="88009,-78 87863,-78 87863,-26 88009,-26 88009,-78"/>
<text text-anchor="middle" x="87936" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="87936" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="87936" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="87936" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L1_EP0TP3PP0DP1_GPU25 -->
<g id="node432" class="node">
<title>ln2_L1_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="88190.5,-78 88045.5,-78 88045.5,-26 88190.5,-26 88190.5,-78"/>
<text text-anchor="middle" x="88118" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="88118" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="88118" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="88118" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L1_EP0TP3PP0DP1_GPU25 -->
<g id="node433" class="node">
<title>gate_L1_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightyellow" stroke="black" points="88527.16,-104 88288.29,-104 88226.84,0 88465.71,0 88527.16,-104"/>
<text text-anchor="middle" x="88377" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="88377" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="88377" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="88377" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L1_EP0TP3PP0DP1_GPU25 -->
<g id="node434" class="node">
<title>dispatch_L1_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="88666" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="88666" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="88666" y="-44" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP1_GPU25</text>
</g>
<!-- expert_0_L1_EP0TP3PP0DP1_GPU25 -->
<g id="node435" class="node">
<title>expert_0_L1_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="88949.5,-78 88804.5,-78 88804.5,-26 88949.5,-26 88949.5,-78"/>
<text text-anchor="middle" x="88877" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="88877" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="88877" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="88877" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L1_EP0TP3PP0DP1_GPU25 -->
<g id="node436" class="node">
<title>expert_1_L1_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="89130.5,-78 88985.5,-78 88985.5,-26 89130.5,-26 89130.5,-78"/>
<text text-anchor="middle" x="89058" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="89058" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="89058" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="89058" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L1_EP0TP3PP0DP1_GPU25 -->
<g id="node437" class="node">
<title>expert_2_L1_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="89311.5,-78 89166.5,-78 89166.5,-26 89311.5,-26 89311.5,-78"/>
<text text-anchor="middle" x="89239" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="89239" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="89239" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="89239" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L1_EP0TP3PP0DP1_GPU25 -->
<g id="node438" class="node">
<title>expert_3_L1_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="89492.5,-78 89347.5,-78 89347.5,-26 89492.5,-26 89492.5,-78"/>
<text text-anchor="middle" x="89420" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="89420" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="89420" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="89420" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L1_EP0TP3PP0DP1_GPU25 -->
<g id="node439" class="node">
<title>combine_L1_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="89631" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="89631" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="89631" y="-44" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP1_GPU25</text>
</g>
<!-- ffn_L1_EP0TP3PP0DP1_GPU25 -->
<g id="node440" class="node">
<title>ffn_L1_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="89940,-78 89770,-78 89770,-26 89940,-26 89940,-78"/>
<text text-anchor="middle" x="89855" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="89855" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="89855" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="89855" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L1_EP0TP3PP0DP1_GPU25 -->
<g id="node441" class="node">
<title>ffn_ar_L1_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="90079" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="90079" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="90079" y="-49.5" font-family="Arial" font-size="10.00">L1 EP0 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="90079" y="-38.5" font-family="Arial" font-size="10.00">GPU25</text>
</g>
<!-- residual2_L1_EP0TP3PP0DP1_GPU25 -->
<g id="node442" class="node">
<title>residual2_L1_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="90364,-78 90218,-78 90218,-26 90364,-26 90364,-78"/>
<text text-anchor="middle" x="90291" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="90291" y="-55" font-family="Arial" font-size="10.00">L1_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="90291" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="90291" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L1_EP1TP0PP0DP0_GPU32 -->
<g id="node443" class="node">
<title>ln1_L1_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="90545.5,-78 90400.5,-78 90400.5,-26 90545.5,-26 90545.5,-78"/>
<text text-anchor="middle" x="90473" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="90473" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="90473" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="90473" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L1_EP1TP0PP0DP0_GPU32 -->
<g id="node444" class="node">
<title>qkv_L1_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="90726.5,-78 90581.5,-78 90581.5,-26 90726.5,-26 90726.5,-78"/>
<text text-anchor="middle" x="90654" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="90654" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="90654" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="90654" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L1_EP1TP0PP0DP0_GPU32 -->
<g id="node445" class="node">
<title>attn_L1_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="90913.5,-78 90762.5,-78 90762.5,-26 90913.5,-26 90913.5,-78"/>
<text text-anchor="middle" x="90838" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="90838" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="90838" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="90838" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L1_EP1TP0PP0DP0_GPU32 -->
<g id="node446" class="node">
<title>attn_out_L1_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="91094.5,-78 90949.5,-78 90949.5,-26 91094.5,-26 91094.5,-78"/>
<text text-anchor="middle" x="91022" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="91022" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="91022" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="91022" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L1_EP1TP0PP0DP0_GPU32 -->
<g id="node447" class="node">
<title>attn_ar_L1_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="91234" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="91234" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="91234" y="-49.5" font-family="Arial" font-size="10.00">L1 EP1 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="91234" y="-38.5" font-family="Arial" font-size="10.00">GPU32</text>
</g>
<!-- residual1_L1_EP1TP0PP0DP0_GPU32 -->
<g id="node448" class="node">
<title>residual1_L1_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="91519,-78 91373,-78 91373,-26 91519,-26 91519,-78"/>
<text text-anchor="middle" x="91446" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="91446" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="91446" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="91446" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L1_EP1TP0PP0DP0_GPU32 -->
<g id="node449" class="node">
<title>ln2_L1_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="91700.5,-78 91555.5,-78 91555.5,-26 91700.5,-26 91700.5,-78"/>
<text text-anchor="middle" x="91628" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="91628" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="91628" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="91628" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L1_EP1TP0PP0DP0_GPU32 -->
<g id="node450" class="node">
<title>gate_L1_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightyellow" stroke="black" points="92037.16,-104 91798.29,-104 91736.84,0 91975.71,0 92037.16,-104"/>
<text text-anchor="middle" x="91887" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="91887" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="91887" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="91887" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L1_EP1TP0PP0DP0_GPU32 -->
<g id="node451" class="node">
<title>dispatch_L1_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="92176" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="92176" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="92176" y="-44" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP0_GPU32</text>
</g>
<!-- expert_0_L1_EP1TP0PP0DP0_GPU32 -->
<g id="node452" class="node">
<title>expert_0_L1_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="92459.5,-78 92314.5,-78 92314.5,-26 92459.5,-26 92459.5,-78"/>
<text text-anchor="middle" x="92387" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="92387" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="92387" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="92387" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L1_EP1TP0PP0DP0_GPU32 -->
<g id="node453" class="node">
<title>expert_1_L1_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="92640.5,-78 92495.5,-78 92495.5,-26 92640.5,-26 92640.5,-78"/>
<text text-anchor="middle" x="92568" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="92568" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="92568" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="92568" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L1_EP1TP0PP0DP0_GPU32 -->
<g id="node454" class="node">
<title>expert_2_L1_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="92821.5,-78 92676.5,-78 92676.5,-26 92821.5,-26 92821.5,-78"/>
<text text-anchor="middle" x="92749" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="92749" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="92749" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="92749" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L1_EP1TP0PP0DP0_GPU32 -->
<g id="node455" class="node">
<title>expert_3_L1_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="93002.5,-78 92857.5,-78 92857.5,-26 93002.5,-26 93002.5,-78"/>
<text text-anchor="middle" x="92930" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="92930" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="92930" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="92930" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L1_EP1TP0PP0DP0_GPU32 -->
<g id="node456" class="node">
<title>combine_L1_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="93141" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="93141" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="93141" y="-44" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP0_GPU32</text>
</g>
<!-- ffn_L1_EP1TP0PP0DP0_GPU32 -->
<g id="node457" class="node">
<title>ffn_L1_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="93450,-78 93280,-78 93280,-26 93450,-26 93450,-78"/>
<text text-anchor="middle" x="93365" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="93365" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="93365" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="93365" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L1_EP1TP0PP0DP0_GPU32 -->
<g id="node458" class="node">
<title>ffn_ar_L1_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="93589" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="93589" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="93589" y="-49.5" font-family="Arial" font-size="10.00">L1 EP1 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="93589" y="-38.5" font-family="Arial" font-size="10.00">GPU32</text>
</g>
<!-- residual2_L1_EP1TP0PP0DP0_GPU32 -->
<g id="node459" class="node">
<title>residual2_L1_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="93874,-78 93728,-78 93728,-26 93874,-26 93874,-78"/>
<text text-anchor="middle" x="93801" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="93801" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="93801" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="93801" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L1_EP1TP0PP0DP1_GPU33 -->
<g id="node460" class="node">
<title>ln1_L1_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="94055.5,-78 93910.5,-78 93910.5,-26 94055.5,-26 94055.5,-78"/>
<text text-anchor="middle" x="93983" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="93983" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="93983" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="93983" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L1_EP1TP0PP0DP1_GPU33 -->
<g id="node461" class="node">
<title>qkv_L1_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="94236.5,-78 94091.5,-78 94091.5,-26 94236.5,-26 94236.5,-78"/>
<text text-anchor="middle" x="94164" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="94164" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="94164" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="94164" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L1_EP1TP0PP0DP1_GPU33 -->
<g id="node462" class="node">
<title>attn_L1_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="94423.5,-78 94272.5,-78 94272.5,-26 94423.5,-26 94423.5,-78"/>
<text text-anchor="middle" x="94348" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="94348" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="94348" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="94348" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L1_EP1TP0PP0DP1_GPU33 -->
<g id="node463" class="node">
<title>attn_out_L1_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="94604.5,-78 94459.5,-78 94459.5,-26 94604.5,-26 94604.5,-78"/>
<text text-anchor="middle" x="94532" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="94532" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="94532" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="94532" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L1_EP1TP0PP0DP1_GPU33 -->
<g id="node464" class="node">
<title>attn_ar_L1_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="94744" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="94744" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="94744" y="-49.5" font-family="Arial" font-size="10.00">L1 EP1 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="94744" y="-38.5" font-family="Arial" font-size="10.00">GPU33</text>
</g>
<!-- residual1_L1_EP1TP0PP0DP1_GPU33 -->
<g id="node465" class="node">
<title>residual1_L1_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="95029,-78 94883,-78 94883,-26 95029,-26 95029,-78"/>
<text text-anchor="middle" x="94956" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="94956" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="94956" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="94956" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L1_EP1TP0PP0DP1_GPU33 -->
<g id="node466" class="node">
<title>ln2_L1_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="95210.5,-78 95065.5,-78 95065.5,-26 95210.5,-26 95210.5,-78"/>
<text text-anchor="middle" x="95138" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="95138" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="95138" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="95138" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L1_EP1TP0PP0DP1_GPU33 -->
<g id="node467" class="node">
<title>gate_L1_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightyellow" stroke="black" points="95547.16,-104 95308.29,-104 95246.84,0 95485.71,0 95547.16,-104"/>
<text text-anchor="middle" x="95397" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="95397" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="95397" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="95397" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L1_EP1TP0PP0DP1_GPU33 -->
<g id="node468" class="node">
<title>dispatch_L1_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="95686" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="95686" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="95686" y="-44" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP1_GPU33</text>
</g>
<!-- expert_0_L1_EP1TP0PP0DP1_GPU33 -->
<g id="node469" class="node">
<title>expert_0_L1_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="95969.5,-78 95824.5,-78 95824.5,-26 95969.5,-26 95969.5,-78"/>
<text text-anchor="middle" x="95897" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="95897" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="95897" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="95897" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L1_EP1TP0PP0DP1_GPU33 -->
<g id="node470" class="node">
<title>expert_1_L1_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="96150.5,-78 96005.5,-78 96005.5,-26 96150.5,-26 96150.5,-78"/>
<text text-anchor="middle" x="96078" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="96078" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="96078" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="96078" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L1_EP1TP0PP0DP1_GPU33 -->
<g id="node471" class="node">
<title>expert_2_L1_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="96331.5,-78 96186.5,-78 96186.5,-26 96331.5,-26 96331.5,-78"/>
<text text-anchor="middle" x="96259" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="96259" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="96259" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="96259" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L1_EP1TP0PP0DP1_GPU33 -->
<g id="node472" class="node">
<title>expert_3_L1_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="96512.5,-78 96367.5,-78 96367.5,-26 96512.5,-26 96512.5,-78"/>
<text text-anchor="middle" x="96440" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="96440" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="96440" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="96440" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L1_EP1TP0PP0DP1_GPU33 -->
<g id="node473" class="node">
<title>combine_L1_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="96651" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="96651" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="96651" y="-44" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP1_GPU33</text>
</g>
<!-- ffn_L1_EP1TP0PP0DP1_GPU33 -->
<g id="node474" class="node">
<title>ffn_L1_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="96960,-78 96790,-78 96790,-26 96960,-26 96960,-78"/>
<text text-anchor="middle" x="96875" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="96875" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="96875" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="96875" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L1_EP1TP0PP0DP1_GPU33 -->
<g id="node475" class="node">
<title>ffn_ar_L1_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="97099" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="97099" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="97099" y="-49.5" font-family="Arial" font-size="10.00">L1 EP1 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="97099" y="-38.5" font-family="Arial" font-size="10.00">GPU33</text>
</g>
<!-- residual2_L1_EP1TP0PP0DP1_GPU33 -->
<g id="node476" class="node">
<title>residual2_L1_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="97384,-78 97238,-78 97238,-26 97384,-26 97384,-78"/>
<text text-anchor="middle" x="97311" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="97311" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="97311" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="97311" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L1_EP1TP1PP0DP0_GPU40 -->
<g id="node477" class="node">
<title>ln1_L1_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="97565.5,-78 97420.5,-78 97420.5,-26 97565.5,-26 97565.5,-78"/>
<text text-anchor="middle" x="97493" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="97493" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="97493" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="97493" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L1_EP1TP1PP0DP0_GPU40 -->
<g id="node478" class="node">
<title>qkv_L1_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="97746.5,-78 97601.5,-78 97601.5,-26 97746.5,-26 97746.5,-78"/>
<text text-anchor="middle" x="97674" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="97674" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="97674" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="97674" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L1_EP1TP1PP0DP0_GPU40 -->
<g id="node479" class="node">
<title>attn_L1_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="97933.5,-78 97782.5,-78 97782.5,-26 97933.5,-26 97933.5,-78"/>
<text text-anchor="middle" x="97858" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="97858" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="97858" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="97858" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L1_EP1TP1PP0DP0_GPU40 -->
<g id="node480" class="node">
<title>attn_out_L1_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="98114.5,-78 97969.5,-78 97969.5,-26 98114.5,-26 98114.5,-78"/>
<text text-anchor="middle" x="98042" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="98042" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="98042" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="98042" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L1_EP1TP1PP0DP0_GPU40 -->
<g id="node481" class="node">
<title>attn_ar_L1_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="98254" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="98254" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="98254" y="-49.5" font-family="Arial" font-size="10.00">L1 EP1 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="98254" y="-38.5" font-family="Arial" font-size="10.00">GPU40</text>
</g>
<!-- residual1_L1_EP1TP1PP0DP0_GPU40 -->
<g id="node482" class="node">
<title>residual1_L1_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="98539,-78 98393,-78 98393,-26 98539,-26 98539,-78"/>
<text text-anchor="middle" x="98466" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="98466" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="98466" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="98466" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L1_EP1TP1PP0DP0_GPU40 -->
<g id="node483" class="node">
<title>ln2_L1_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="98720.5,-78 98575.5,-78 98575.5,-26 98720.5,-26 98720.5,-78"/>
<text text-anchor="middle" x="98648" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="98648" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="98648" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="98648" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L1_EP1TP1PP0DP0_GPU40 -->
<g id="node484" class="node">
<title>gate_L1_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightyellow" stroke="black" points="99057.16,-104 98818.29,-104 98756.84,0 98995.71,0 99057.16,-104"/>
<text text-anchor="middle" x="98907" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="98907" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="98907" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="98907" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L1_EP1TP1PP0DP0_GPU40 -->
<g id="node485" class="node">
<title>dispatch_L1_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="99196" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="99196" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="99196" y="-44" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP0_GPU40</text>
</g>
<!-- expert_0_L1_EP1TP1PP0DP0_GPU40 -->
<g id="node486" class="node">
<title>expert_0_L1_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="99479.5,-78 99334.5,-78 99334.5,-26 99479.5,-26 99479.5,-78"/>
<text text-anchor="middle" x="99407" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="99407" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="99407" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="99407" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L1_EP1TP1PP0DP0_GPU40 -->
<g id="node487" class="node">
<title>expert_1_L1_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="99660.5,-78 99515.5,-78 99515.5,-26 99660.5,-26 99660.5,-78"/>
<text text-anchor="middle" x="99588" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="99588" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="99588" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="99588" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L1_EP1TP1PP0DP0_GPU40 -->
<g id="node488" class="node">
<title>expert_2_L1_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="99841.5,-78 99696.5,-78 99696.5,-26 99841.5,-26 99841.5,-78"/>
<text text-anchor="middle" x="99769" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="99769" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="99769" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="99769" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L1_EP1TP1PP0DP0_GPU40 -->
<g id="node489" class="node">
<title>expert_3_L1_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="100022.5,-78 99877.5,-78 99877.5,-26 100022.5,-26 100022.5,-78"/>
<text text-anchor="middle" x="99950" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="99950" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="99950" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="99950" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L1_EP1TP1PP0DP0_GPU40 -->
<g id="node490" class="node">
<title>combine_L1_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="100161" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="100161" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="100161" y="-44" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP0_GPU40</text>
</g>
<!-- ffn_L1_EP1TP1PP0DP0_GPU40 -->
<g id="node491" class="node">
<title>ffn_L1_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="100470,-78 100300,-78 100300,-26 100470,-26 100470,-78"/>
<text text-anchor="middle" x="100385" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="100385" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="100385" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="100385" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L1_EP1TP1PP0DP0_GPU40 -->
<g id="node492" class="node">
<title>ffn_ar_L1_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="100609" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="100609" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="100609" y="-49.5" font-family="Arial" font-size="10.00">L1 EP1 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="100609" y="-38.5" font-family="Arial" font-size="10.00">GPU40</text>
</g>
<!-- residual2_L1_EP1TP1PP0DP0_GPU40 -->
<g id="node493" class="node">
<title>residual2_L1_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="100894,-78 100748,-78 100748,-26 100894,-26 100894,-78"/>
<text text-anchor="middle" x="100821" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="100821" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="100821" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="100821" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L1_EP1TP1PP0DP1_GPU41 -->
<g id="node494" class="node">
<title>ln1_L1_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="101075.5,-78 100930.5,-78 100930.5,-26 101075.5,-26 101075.5,-78"/>
<text text-anchor="middle" x="101003" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="101003" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="101003" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="101003" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L1_EP1TP1PP0DP1_GPU41 -->
<g id="node495" class="node">
<title>qkv_L1_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="101256.5,-78 101111.5,-78 101111.5,-26 101256.5,-26 101256.5,-78"/>
<text text-anchor="middle" x="101184" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="101184" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="101184" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="101184" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L1_EP1TP1PP0DP1_GPU41 -->
<g id="node496" class="node">
<title>attn_L1_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="101443.5,-78 101292.5,-78 101292.5,-26 101443.5,-26 101443.5,-78"/>
<text text-anchor="middle" x="101368" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="101368" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="101368" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="101368" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L1_EP1TP1PP0DP1_GPU41 -->
<g id="node497" class="node">
<title>attn_out_L1_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="101624.5,-78 101479.5,-78 101479.5,-26 101624.5,-26 101624.5,-78"/>
<text text-anchor="middle" x="101552" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="101552" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="101552" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="101552" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L1_EP1TP1PP0DP1_GPU41 -->
<g id="node498" class="node">
<title>attn_ar_L1_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="101764" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="101764" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="101764" y="-49.5" font-family="Arial" font-size="10.00">L1 EP1 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="101764" y="-38.5" font-family="Arial" font-size="10.00">GPU41</text>
</g>
<!-- residual1_L1_EP1TP1PP0DP1_GPU41 -->
<g id="node499" class="node">
<title>residual1_L1_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="102049,-78 101903,-78 101903,-26 102049,-26 102049,-78"/>
<text text-anchor="middle" x="101976" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="101976" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="101976" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="101976" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L1_EP1TP1PP0DP1_GPU41 -->
<g id="node500" class="node">
<title>ln2_L1_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="102230.5,-78 102085.5,-78 102085.5,-26 102230.5,-26 102230.5,-78"/>
<text text-anchor="middle" x="102158" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="102158" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="102158" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="102158" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L1_EP1TP1PP0DP1_GPU41 -->
<g id="node501" class="node">
<title>gate_L1_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightyellow" stroke="black" points="102567.16,-104 102328.29,-104 102266.84,0 102505.71,0 102567.16,-104"/>
<text text-anchor="middle" x="102417" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="102417" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="102417" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="102417" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L1_EP1TP1PP0DP1_GPU41 -->
<g id="node502" class="node">
<title>dispatch_L1_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="102706" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="102706" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="102706" y="-44" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP1_GPU41</text>
</g>
<!-- expert_0_L1_EP1TP1PP0DP1_GPU41 -->
<g id="node503" class="node">
<title>expert_0_L1_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="102989.5,-78 102844.5,-78 102844.5,-26 102989.5,-26 102989.5,-78"/>
<text text-anchor="middle" x="102917" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="102917" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="102917" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="102917" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L1_EP1TP1PP0DP1_GPU41 -->
<g id="node504" class="node">
<title>expert_1_L1_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="103170.5,-78 103025.5,-78 103025.5,-26 103170.5,-26 103170.5,-78"/>
<text text-anchor="middle" x="103098" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="103098" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="103098" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="103098" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L1_EP1TP1PP0DP1_GPU41 -->
<g id="node505" class="node">
<title>expert_2_L1_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="103351.5,-78 103206.5,-78 103206.5,-26 103351.5,-26 103351.5,-78"/>
<text text-anchor="middle" x="103279" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="103279" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="103279" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="103279" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L1_EP1TP1PP0DP1_GPU41 -->
<g id="node506" class="node">
<title>expert_3_L1_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="103532.5,-78 103387.5,-78 103387.5,-26 103532.5,-26 103532.5,-78"/>
<text text-anchor="middle" x="103460" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="103460" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="103460" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="103460" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L1_EP1TP1PP0DP1_GPU41 -->
<g id="node507" class="node">
<title>combine_L1_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="103671" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="103671" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="103671" y="-44" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP1_GPU41</text>
</g>
<!-- ffn_L1_EP1TP1PP0DP1_GPU41 -->
<g id="node508" class="node">
<title>ffn_L1_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="103980,-78 103810,-78 103810,-26 103980,-26 103980,-78"/>
<text text-anchor="middle" x="103895" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="103895" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="103895" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="103895" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L1_EP1TP1PP0DP1_GPU41 -->
<g id="node509" class="node">
<title>ffn_ar_L1_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="104119" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="104119" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="104119" y="-49.5" font-family="Arial" font-size="10.00">L1 EP1 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="104119" y="-38.5" font-family="Arial" font-size="10.00">GPU41</text>
</g>
<!-- residual2_L1_EP1TP1PP0DP1_GPU41 -->
<g id="node510" class="node">
<title>residual2_L1_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="104404,-78 104258,-78 104258,-26 104404,-26 104404,-78"/>
<text text-anchor="middle" x="104331" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="104331" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="104331" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="104331" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L1_EP1TP2PP0DP0_GPU48 -->
<g id="node511" class="node">
<title>ln1_L1_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="104585.5,-78 104440.5,-78 104440.5,-26 104585.5,-26 104585.5,-78"/>
<text text-anchor="middle" x="104513" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="104513" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="104513" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="104513" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L1_EP1TP2PP0DP0_GPU48 -->
<g id="node512" class="node">
<title>qkv_L1_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="104766.5,-78 104621.5,-78 104621.5,-26 104766.5,-26 104766.5,-78"/>
<text text-anchor="middle" x="104694" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="104694" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="104694" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="104694" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L1_EP1TP2PP0DP0_GPU48 -->
<g id="node513" class="node">
<title>attn_L1_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="104953.5,-78 104802.5,-78 104802.5,-26 104953.5,-26 104953.5,-78"/>
<text text-anchor="middle" x="104878" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="104878" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="104878" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="104878" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L1_EP1TP2PP0DP0_GPU48 -->
<g id="node514" class="node">
<title>attn_out_L1_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="105134.5,-78 104989.5,-78 104989.5,-26 105134.5,-26 105134.5,-78"/>
<text text-anchor="middle" x="105062" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="105062" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="105062" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="105062" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L1_EP1TP2PP0DP0_GPU48 -->
<g id="node515" class="node">
<title>attn_ar_L1_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="105274" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="105274" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="105274" y="-49.5" font-family="Arial" font-size="10.00">L1 EP1 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="105274" y="-38.5" font-family="Arial" font-size="10.00">GPU48</text>
</g>
<!-- residual1_L1_EP1TP2PP0DP0_GPU48 -->
<g id="node516" class="node">
<title>residual1_L1_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="105559,-78 105413,-78 105413,-26 105559,-26 105559,-78"/>
<text text-anchor="middle" x="105486" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="105486" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="105486" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="105486" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L1_EP1TP2PP0DP0_GPU48 -->
<g id="node517" class="node">
<title>ln2_L1_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="105740.5,-78 105595.5,-78 105595.5,-26 105740.5,-26 105740.5,-78"/>
<text text-anchor="middle" x="105668" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="105668" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="105668" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="105668" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L1_EP1TP2PP0DP0_GPU48 -->
<g id="node518" class="node">
<title>gate_L1_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightyellow" stroke="black" points="106077.16,-104 105838.29,-104 105776.84,0 106015.71,0 106077.16,-104"/>
<text text-anchor="middle" x="105927" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="105927" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="105927" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="105927" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L1_EP1TP2PP0DP0_GPU48 -->
<g id="node519" class="node">
<title>dispatch_L1_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="106216" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="106216" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="106216" y="-44" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP0_GPU48</text>
</g>
<!-- expert_0_L1_EP1TP2PP0DP0_GPU48 -->
<g id="node520" class="node">
<title>expert_0_L1_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="106499.5,-78 106354.5,-78 106354.5,-26 106499.5,-26 106499.5,-78"/>
<text text-anchor="middle" x="106427" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="106427" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="106427" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="106427" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L1_EP1TP2PP0DP0_GPU48 -->
<g id="node521" class="node">
<title>expert_1_L1_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="106680.5,-78 106535.5,-78 106535.5,-26 106680.5,-26 106680.5,-78"/>
<text text-anchor="middle" x="106608" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="106608" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="106608" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="106608" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L1_EP1TP2PP0DP0_GPU48 -->
<g id="node522" class="node">
<title>expert_2_L1_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="106861.5,-78 106716.5,-78 106716.5,-26 106861.5,-26 106861.5,-78"/>
<text text-anchor="middle" x="106789" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="106789" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="106789" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="106789" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L1_EP1TP2PP0DP0_GPU48 -->
<g id="node523" class="node">
<title>expert_3_L1_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="107042.5,-78 106897.5,-78 106897.5,-26 107042.5,-26 107042.5,-78"/>
<text text-anchor="middle" x="106970" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="106970" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="106970" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="106970" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L1_EP1TP2PP0DP0_GPU48 -->
<g id="node524" class="node">
<title>combine_L1_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="107181" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="107181" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="107181" y="-44" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP0_GPU48</text>
</g>
<!-- ffn_L1_EP1TP2PP0DP0_GPU48 -->
<g id="node525" class="node">
<title>ffn_L1_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="107490,-78 107320,-78 107320,-26 107490,-26 107490,-78"/>
<text text-anchor="middle" x="107405" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="107405" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="107405" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="107405" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L1_EP1TP2PP0DP0_GPU48 -->
<g id="node526" class="node">
<title>ffn_ar_L1_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="107629" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="107629" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="107629" y="-49.5" font-family="Arial" font-size="10.00">L1 EP1 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="107629" y="-38.5" font-family="Arial" font-size="10.00">GPU48</text>
</g>
<!-- residual2_L1_EP1TP2PP0DP0_GPU48 -->
<g id="node527" class="node">
<title>residual2_L1_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="107914,-78 107768,-78 107768,-26 107914,-26 107914,-78"/>
<text text-anchor="middle" x="107841" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="107841" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="107841" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="107841" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L1_EP1TP2PP0DP1_GPU49 -->
<g id="node528" class="node">
<title>ln1_L1_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="108095.5,-78 107950.5,-78 107950.5,-26 108095.5,-26 108095.5,-78"/>
<text text-anchor="middle" x="108023" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="108023" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="108023" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="108023" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L1_EP1TP2PP0DP1_GPU49 -->
<g id="node529" class="node">
<title>qkv_L1_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="108276.5,-78 108131.5,-78 108131.5,-26 108276.5,-26 108276.5,-78"/>
<text text-anchor="middle" x="108204" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="108204" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="108204" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="108204" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L1_EP1TP2PP0DP1_GPU49 -->
<g id="node530" class="node">
<title>attn_L1_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="108463.5,-78 108312.5,-78 108312.5,-26 108463.5,-26 108463.5,-78"/>
<text text-anchor="middle" x="108388" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="108388" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="108388" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="108388" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L1_EP1TP2PP0DP1_GPU49 -->
<g id="node531" class="node">
<title>attn_out_L1_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="108644.5,-78 108499.5,-78 108499.5,-26 108644.5,-26 108644.5,-78"/>
<text text-anchor="middle" x="108572" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="108572" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="108572" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="108572" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L1_EP1TP2PP0DP1_GPU49 -->
<g id="node532" class="node">
<title>attn_ar_L1_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="108784" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="108784" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="108784" y="-49.5" font-family="Arial" font-size="10.00">L1 EP1 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="108784" y="-38.5" font-family="Arial" font-size="10.00">GPU49</text>
</g>
<!-- residual1_L1_EP1TP2PP0DP1_GPU49 -->
<g id="node533" class="node">
<title>residual1_L1_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="109069,-78 108923,-78 108923,-26 109069,-26 109069,-78"/>
<text text-anchor="middle" x="108996" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="108996" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="108996" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="108996" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L1_EP1TP2PP0DP1_GPU49 -->
<g id="node534" class="node">
<title>ln2_L1_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="109250.5,-78 109105.5,-78 109105.5,-26 109250.5,-26 109250.5,-78"/>
<text text-anchor="middle" x="109178" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="109178" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="109178" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="109178" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L1_EP1TP2PP0DP1_GPU49 -->
<g id="node535" class="node">
<title>gate_L1_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightyellow" stroke="black" points="109587.16,-104 109348.29,-104 109286.84,0 109525.71,0 109587.16,-104"/>
<text text-anchor="middle" x="109437" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="109437" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="109437" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="109437" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L1_EP1TP2PP0DP1_GPU49 -->
<g id="node536" class="node">
<title>dispatch_L1_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="109726" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="109726" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="109726" y="-44" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP1_GPU49</text>
</g>
<!-- expert_0_L1_EP1TP2PP0DP1_GPU49 -->
<g id="node537" class="node">
<title>expert_0_L1_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="110009.5,-78 109864.5,-78 109864.5,-26 110009.5,-26 110009.5,-78"/>
<text text-anchor="middle" x="109937" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="109937" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="109937" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="109937" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L1_EP1TP2PP0DP1_GPU49 -->
<g id="node538" class="node">
<title>expert_1_L1_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="110190.5,-78 110045.5,-78 110045.5,-26 110190.5,-26 110190.5,-78"/>
<text text-anchor="middle" x="110118" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="110118" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="110118" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="110118" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L1_EP1TP2PP0DP1_GPU49 -->
<g id="node539" class="node">
<title>expert_2_L1_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="110371.5,-78 110226.5,-78 110226.5,-26 110371.5,-26 110371.5,-78"/>
<text text-anchor="middle" x="110299" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="110299" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="110299" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="110299" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L1_EP1TP2PP0DP1_GPU49 -->
<g id="node540" class="node">
<title>expert_3_L1_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="110552.5,-78 110407.5,-78 110407.5,-26 110552.5,-26 110552.5,-78"/>
<text text-anchor="middle" x="110480" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="110480" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="110480" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="110480" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L1_EP1TP2PP0DP1_GPU49 -->
<g id="node541" class="node">
<title>combine_L1_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="110691" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="110691" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="110691" y="-44" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP1_GPU49</text>
</g>
<!-- ffn_L1_EP1TP2PP0DP1_GPU49 -->
<g id="node542" class="node">
<title>ffn_L1_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="111000,-78 110830,-78 110830,-26 111000,-26 111000,-78"/>
<text text-anchor="middle" x="110915" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="110915" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="110915" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="110915" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L1_EP1TP2PP0DP1_GPU49 -->
<g id="node543" class="node">
<title>ffn_ar_L1_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="111139" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="111139" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="111139" y="-49.5" font-family="Arial" font-size="10.00">L1 EP1 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="111139" y="-38.5" font-family="Arial" font-size="10.00">GPU49</text>
</g>
<!-- residual2_L1_EP1TP2PP0DP1_GPU49 -->
<g id="node544" class="node">
<title>residual2_L1_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="111424,-78 111278,-78 111278,-26 111424,-26 111424,-78"/>
<text text-anchor="middle" x="111351" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="111351" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="111351" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="111351" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L1_EP1TP3PP0DP0_GPU56 -->
<g id="node545" class="node">
<title>ln1_L1_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="111605.5,-78 111460.5,-78 111460.5,-26 111605.5,-26 111605.5,-78"/>
<text text-anchor="middle" x="111533" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="111533" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="111533" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="111533" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L1_EP1TP3PP0DP0_GPU56 -->
<g id="node546" class="node">
<title>qkv_L1_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="111786.5,-78 111641.5,-78 111641.5,-26 111786.5,-26 111786.5,-78"/>
<text text-anchor="middle" x="111714" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="111714" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="111714" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="111714" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L1_EP1TP3PP0DP0_GPU56 -->
<g id="node547" class="node">
<title>attn_L1_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="111973.5,-78 111822.5,-78 111822.5,-26 111973.5,-26 111973.5,-78"/>
<text text-anchor="middle" x="111898" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="111898" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="111898" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="111898" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L1_EP1TP3PP0DP0_GPU56 -->
<g id="node548" class="node">
<title>attn_out_L1_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="112154.5,-78 112009.5,-78 112009.5,-26 112154.5,-26 112154.5,-78"/>
<text text-anchor="middle" x="112082" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="112082" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="112082" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="112082" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L1_EP1TP3PP0DP0_GPU56 -->
<g id="node549" class="node">
<title>attn_ar_L1_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="112294" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="112294" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="112294" y="-49.5" font-family="Arial" font-size="10.00">L1 EP1 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="112294" y="-38.5" font-family="Arial" font-size="10.00">GPU56</text>
</g>
<!-- residual1_L1_EP1TP3PP0DP0_GPU56 -->
<g id="node550" class="node">
<title>residual1_L1_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="112579,-78 112433,-78 112433,-26 112579,-26 112579,-78"/>
<text text-anchor="middle" x="112506" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="112506" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="112506" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="112506" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L1_EP1TP3PP0DP0_GPU56 -->
<g id="node551" class="node">
<title>ln2_L1_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="112760.5,-78 112615.5,-78 112615.5,-26 112760.5,-26 112760.5,-78"/>
<text text-anchor="middle" x="112688" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="112688" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="112688" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="112688" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L1_EP1TP3PP0DP0_GPU56 -->
<g id="node552" class="node">
<title>gate_L1_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightyellow" stroke="black" points="113097.16,-104 112858.29,-104 112796.84,0 113035.71,0 113097.16,-104"/>
<text text-anchor="middle" x="112947" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="112947" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="112947" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="112947" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L1_EP1TP3PP0DP0_GPU56 -->
<g id="node553" class="node">
<title>dispatch_L1_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="113236" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="113236" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="113236" y="-44" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP0_GPU56</text>
</g>
<!-- expert_0_L1_EP1TP3PP0DP0_GPU56 -->
<g id="node554" class="node">
<title>expert_0_L1_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="113519.5,-78 113374.5,-78 113374.5,-26 113519.5,-26 113519.5,-78"/>
<text text-anchor="middle" x="113447" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="113447" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="113447" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="113447" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L1_EP1TP3PP0DP0_GPU56 -->
<g id="node555" class="node">
<title>expert_1_L1_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="113700.5,-78 113555.5,-78 113555.5,-26 113700.5,-26 113700.5,-78"/>
<text text-anchor="middle" x="113628" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="113628" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="113628" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="113628" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L1_EP1TP3PP0DP0_GPU56 -->
<g id="node556" class="node">
<title>expert_2_L1_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="113881.5,-78 113736.5,-78 113736.5,-26 113881.5,-26 113881.5,-78"/>
<text text-anchor="middle" x="113809" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="113809" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="113809" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="113809" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L1_EP1TP3PP0DP0_GPU56 -->
<g id="node557" class="node">
<title>expert_3_L1_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="114062.5,-78 113917.5,-78 113917.5,-26 114062.5,-26 114062.5,-78"/>
<text text-anchor="middle" x="113990" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="113990" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="113990" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="113990" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L1_EP1TP3PP0DP0_GPU56 -->
<g id="node558" class="node">
<title>combine_L1_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="114201" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="114201" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="114201" y="-44" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP0_GPU56</text>
</g>
<!-- ffn_L1_EP1TP3PP0DP0_GPU56 -->
<g id="node559" class="node">
<title>ffn_L1_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="114510,-78 114340,-78 114340,-26 114510,-26 114510,-78"/>
<text text-anchor="middle" x="114425" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="114425" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="114425" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="114425" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L1_EP1TP3PP0DP0_GPU56 -->
<g id="node560" class="node">
<title>ffn_ar_L1_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="114649" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="114649" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="114649" y="-49.5" font-family="Arial" font-size="10.00">L1 EP1 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="114649" y="-38.5" font-family="Arial" font-size="10.00">GPU56</text>
</g>
<!-- residual2_L1_EP1TP3PP0DP0_GPU56 -->
<g id="node561" class="node">
<title>residual2_L1_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="114934,-78 114788,-78 114788,-26 114934,-26 114934,-78"/>
<text text-anchor="middle" x="114861" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="114861" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="114861" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="114861" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L1_EP1TP3PP0DP1_GPU57 -->
<g id="node562" class="node">
<title>ln1_L1_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="115115.5,-78 114970.5,-78 114970.5,-26 115115.5,-26 115115.5,-78"/>
<text text-anchor="middle" x="115043" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="115043" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="115043" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="115043" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L1_EP1TP3PP0DP1_GPU57 -->
<g id="node563" class="node">
<title>qkv_L1_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="115296.5,-78 115151.5,-78 115151.5,-26 115296.5,-26 115296.5,-78"/>
<text text-anchor="middle" x="115224" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="115224" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="115224" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="115224" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L1_EP1TP3PP0DP1_GPU57 -->
<g id="node564" class="node">
<title>attn_L1_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="115483.5,-78 115332.5,-78 115332.5,-26 115483.5,-26 115483.5,-78"/>
<text text-anchor="middle" x="115408" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="115408" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="115408" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="115408" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L1_EP1TP3PP0DP1_GPU57 -->
<g id="node565" class="node">
<title>attn_out_L1_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="115664.5,-78 115519.5,-78 115519.5,-26 115664.5,-26 115664.5,-78"/>
<text text-anchor="middle" x="115592" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="115592" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="115592" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="115592" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L1_EP1TP3PP0DP1_GPU57 -->
<g id="node566" class="node">
<title>attn_ar_L1_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="115804" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="115804" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="115804" y="-49.5" font-family="Arial" font-size="10.00">L1 EP1 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="115804" y="-38.5" font-family="Arial" font-size="10.00">GPU57</text>
</g>
<!-- residual1_L1_EP1TP3PP0DP1_GPU57 -->
<g id="node567" class="node">
<title>residual1_L1_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="116089,-78 115943,-78 115943,-26 116089,-26 116089,-78"/>
<text text-anchor="middle" x="116016" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="116016" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="116016" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="116016" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L1_EP1TP3PP0DP1_GPU57 -->
<g id="node568" class="node">
<title>ln2_L1_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="116270.5,-78 116125.5,-78 116125.5,-26 116270.5,-26 116270.5,-78"/>
<text text-anchor="middle" x="116198" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="116198" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="116198" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="116198" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L1_EP1TP3PP0DP1_GPU57 -->
<g id="node569" class="node">
<title>gate_L1_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightyellow" stroke="black" points="116607.16,-104 116368.29,-104 116306.84,0 116545.71,0 116607.16,-104"/>
<text text-anchor="middle" x="116457" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="116457" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="116457" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="116457" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L1_EP1TP3PP0DP1_GPU57 -->
<g id="node570" class="node">
<title>dispatch_L1_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="116746" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="116746" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="116746" y="-44" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP1_GPU57</text>
</g>
<!-- expert_0_L1_EP1TP3PP0DP1_GPU57 -->
<g id="node571" class="node">
<title>expert_0_L1_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="117029.5,-78 116884.5,-78 116884.5,-26 117029.5,-26 117029.5,-78"/>
<text text-anchor="middle" x="116957" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="116957" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="116957" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="116957" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L1_EP1TP3PP0DP1_GPU57 -->
<g id="node572" class="node">
<title>expert_1_L1_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="117210.5,-78 117065.5,-78 117065.5,-26 117210.5,-26 117210.5,-78"/>
<text text-anchor="middle" x="117138" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="117138" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="117138" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="117138" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L1_EP1TP3PP0DP1_GPU57 -->
<g id="node573" class="node">
<title>expert_2_L1_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="117391.5,-78 117246.5,-78 117246.5,-26 117391.5,-26 117391.5,-78"/>
<text text-anchor="middle" x="117319" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="117319" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="117319" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="117319" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L1_EP1TP3PP0DP1_GPU57 -->
<g id="node574" class="node">
<title>expert_3_L1_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="117572.5,-78 117427.5,-78 117427.5,-26 117572.5,-26 117572.5,-78"/>
<text text-anchor="middle" x="117500" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="117500" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="117500" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="117500" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L1_EP1TP3PP0DP1_GPU57 -->
<g id="node575" class="node">
<title>combine_L1_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="117711" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="117711" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="117711" y="-44" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP1_GPU57</text>
</g>
<!-- ffn_L1_EP1TP3PP0DP1_GPU57 -->
<g id="node576" class="node">
<title>ffn_L1_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="118020,-78 117850,-78 117850,-26 118020,-26 118020,-78"/>
<text text-anchor="middle" x="117935" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="117935" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="117935" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="117935" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L1_EP1TP3PP0DP1_GPU57 -->
<g id="node577" class="node">
<title>ffn_ar_L1_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="118159" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="118159" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="118159" y="-49.5" font-family="Arial" font-size="10.00">L1 EP1 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="118159" y="-38.5" font-family="Arial" font-size="10.00">GPU57</text>
</g>
<!-- residual2_L1_EP1TP3PP0DP1_GPU57 -->
<g id="node578" class="node">
<title>residual2_L1_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="118444,-78 118298,-78 118298,-26 118444,-26 118444,-78"/>
<text text-anchor="middle" x="118371" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="118371" y="-55" font-family="Arial" font-size="10.00">L1_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="118371" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="118371" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L2_EP0TP0PP0DP0_GPU0 -->
<g id="node579" class="node">
<title>ln1_L2_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="118622,-78 118480,-78 118480,-26 118622,-26 118622,-78"/>
<text text-anchor="middle" x="118551" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="118551" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="118551" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="118551" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L2_EP0TP0PP0DP0_GPU0 -->
<g id="node580" class="node">
<title>qkv_L2_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="118800,-78 118658,-78 118658,-26 118800,-26 118800,-78"/>
<text text-anchor="middle" x="118729" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="118729" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="118729" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="118729" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L2_EP0TP0PP0DP0_GPU0 -->
<g id="node581" class="node">
<title>attn_L2_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="118987.5,-78 118836.5,-78 118836.5,-26 118987.5,-26 118987.5,-78"/>
<text text-anchor="middle" x="118912" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="118912" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="118912" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="118912" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L2_EP0TP0PP0DP0_GPU0 -->
<g id="node582" class="node">
<title>attn_out_L2_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="119166,-78 119024,-78 119024,-26 119166,-26 119166,-78"/>
<text text-anchor="middle" x="119095" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="119095" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="119095" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="119095" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L2_EP0TP0PP0DP0_GPU0 -->
<g id="node583" class="node">
<title>attn_ar_L2_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="119305" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="119305" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="119305" y="-49.5" font-family="Arial" font-size="10.00">L2 EP0 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="119305" y="-38.5" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- residual1_L2_EP0TP0PP0DP0_GPU0 -->
<g id="node584" class="node">
<title>residual1_L2_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="119590,-78 119444,-78 119444,-26 119590,-26 119590,-78"/>
<text text-anchor="middle" x="119517" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="119517" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="119517" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="119517" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L2_EP0TP0PP0DP0_GPU0 -->
<g id="node585" class="node">
<title>ln2_L2_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="119768,-78 119626,-78 119626,-26 119768,-26 119768,-78"/>
<text text-anchor="middle" x="119697" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="119697" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="119697" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="119697" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L2_EP0TP0PP0DP0_GPU0 -->
<g id="node586" class="node">
<title>gate_L2_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightyellow" stroke="black" points="120094.29,-104 119863.17,-104 119803.71,0 120034.83,0 120094.29,-104"/>
<text text-anchor="middle" x="119949" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="119949" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="119949" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="119949" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L2_EP0TP0PP0DP0_GPU0 -->
<g id="node587" class="node">
<title>dispatch_L2_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="120229" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="120229" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="120229" y="-44" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP0_GPU0</text>
</g>
<!-- expert_0_L2_EP0TP0PP0DP0_GPU0 -->
<g id="node588" class="node">
<title>expert_0_L2_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="120504,-78 120364,-78 120364,-26 120504,-26 120504,-78"/>
<text text-anchor="middle" x="120434" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="120434" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="120434" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="120434" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L2_EP0TP0PP0DP0_GPU0 -->
<g id="node589" class="node">
<title>expert_1_L2_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="120680,-78 120540,-78 120540,-26 120680,-26 120680,-78"/>
<text text-anchor="middle" x="120610" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="120610" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="120610" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="120610" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L2_EP0TP0PP0DP0_GPU0 -->
<g id="node590" class="node">
<title>expert_2_L2_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="120856,-78 120716,-78 120716,-26 120856,-26 120856,-78"/>
<text text-anchor="middle" x="120786" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="120786" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="120786" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="120786" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L2_EP0TP0PP0DP0_GPU0 -->
<g id="node591" class="node">
<title>expert_3_L2_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="121032,-78 120892,-78 120892,-26 121032,-26 121032,-78"/>
<text text-anchor="middle" x="120962" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="120962" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="120962" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="120962" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L2_EP0TP0PP0DP0_GPU0 -->
<g id="node592" class="node">
<title>combine_L2_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="121167" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="121167" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="121167" y="-44" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP0_GPU0</text>
</g>
<!-- ffn_L2_EP0TP0PP0DP0_GPU0 -->
<g id="node593" class="node">
<title>ffn_L2_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="121472,-78 121302,-78 121302,-26 121472,-26 121472,-78"/>
<text text-anchor="middle" x="121387" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="121387" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="121387" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="121387" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L2_EP0TP0PP0DP0_GPU0 -->
<g id="node594" class="node">
<title>ffn_ar_L2_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="121611" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="121611" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="121611" y="-49.5" font-family="Arial" font-size="10.00">L2 EP0 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="121611" y="-38.5" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- residual2_L2_EP0TP0PP0DP0_GPU0 -->
<g id="node595" class="node">
<title>residual2_L2_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="121896,-78 121750,-78 121750,-26 121896,-26 121896,-78"/>
<text text-anchor="middle" x="121823" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="121823" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="121823" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="121823" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L2_EP0TP0PP0DP1_GPU1 -->
<g id="node596" class="node">
<title>ln1_L2_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="122074,-78 121932,-78 121932,-26 122074,-26 122074,-78"/>
<text text-anchor="middle" x="122003" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="122003" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="122003" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="122003" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L2_EP0TP0PP0DP1_GPU1 -->
<g id="node597" class="node">
<title>qkv_L2_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="122252,-78 122110,-78 122110,-26 122252,-26 122252,-78"/>
<text text-anchor="middle" x="122181" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="122181" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="122181" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="122181" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L2_EP0TP0PP0DP1_GPU1 -->
<g id="node598" class="node">
<title>attn_L2_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="122439.5,-78 122288.5,-78 122288.5,-26 122439.5,-26 122439.5,-78"/>
<text text-anchor="middle" x="122364" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="122364" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="122364" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="122364" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L2_EP0TP0PP0DP1_GPU1 -->
<g id="node599" class="node">
<title>attn_out_L2_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="122618,-78 122476,-78 122476,-26 122618,-26 122618,-78"/>
<text text-anchor="middle" x="122547" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="122547" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="122547" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="122547" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L2_EP0TP0PP0DP1_GPU1 -->
<g id="node600" class="node">
<title>attn_ar_L2_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="122757" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="122757" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="122757" y="-49.5" font-family="Arial" font-size="10.00">L2 EP0 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="122757" y="-38.5" font-family="Arial" font-size="10.00">GPU1</text>
</g>
<!-- residual1_L2_EP0TP0PP0DP1_GPU1 -->
<g id="node601" class="node">
<title>residual1_L2_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="123042,-78 122896,-78 122896,-26 123042,-26 123042,-78"/>
<text text-anchor="middle" x="122969" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="122969" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="122969" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="122969" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L2_EP0TP0PP0DP1_GPU1 -->
<g id="node602" class="node">
<title>ln2_L2_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="123220,-78 123078,-78 123078,-26 123220,-26 123220,-78"/>
<text text-anchor="middle" x="123149" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="123149" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="123149" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="123149" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L2_EP0TP0PP0DP1_GPU1 -->
<g id="node603" class="node">
<title>gate_L2_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightyellow" stroke="black" points="123546.29,-104 123315.17,-104 123255.71,0 123486.83,0 123546.29,-104"/>
<text text-anchor="middle" x="123401" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="123401" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="123401" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="123401" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L2_EP0TP0PP0DP1_GPU1 -->
<g id="node604" class="node">
<title>dispatch_L2_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="123681" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="123681" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="123681" y="-44" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP1_GPU1</text>
</g>
<!-- expert_0_L2_EP0TP0PP0DP1_GPU1 -->
<g id="node605" class="node">
<title>expert_0_L2_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="123956,-78 123816,-78 123816,-26 123956,-26 123956,-78"/>
<text text-anchor="middle" x="123886" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="123886" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="123886" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="123886" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L2_EP0TP0PP0DP1_GPU1 -->
<g id="node606" class="node">
<title>expert_1_L2_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="124132,-78 123992,-78 123992,-26 124132,-26 124132,-78"/>
<text text-anchor="middle" x="124062" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="124062" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="124062" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="124062" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L2_EP0TP0PP0DP1_GPU1 -->
<g id="node607" class="node">
<title>expert_2_L2_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="124308,-78 124168,-78 124168,-26 124308,-26 124308,-78"/>
<text text-anchor="middle" x="124238" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="124238" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="124238" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="124238" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L2_EP0TP0PP0DP1_GPU1 -->
<g id="node608" class="node">
<title>expert_3_L2_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="124484,-78 124344,-78 124344,-26 124484,-26 124484,-78"/>
<text text-anchor="middle" x="124414" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="124414" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="124414" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="124414" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L2_EP0TP0PP0DP1_GPU1 -->
<g id="node609" class="node">
<title>combine_L2_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="124619" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="124619" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="124619" y="-44" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP1_GPU1</text>
</g>
<!-- ffn_L2_EP0TP0PP0DP1_GPU1 -->
<g id="node610" class="node">
<title>ffn_L2_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="124924,-78 124754,-78 124754,-26 124924,-26 124924,-78"/>
<text text-anchor="middle" x="124839" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="124839" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="124839" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="124839" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L2_EP0TP0PP0DP1_GPU1 -->
<g id="node611" class="node">
<title>ffn_ar_L2_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="125063" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="125063" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="125063" y="-49.5" font-family="Arial" font-size="10.00">L2 EP0 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="125063" y="-38.5" font-family="Arial" font-size="10.00">GPU1</text>
</g>
<!-- residual2_L2_EP0TP0PP0DP1_GPU1 -->
<g id="node612" class="node">
<title>residual2_L2_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="125348,-78 125202,-78 125202,-26 125348,-26 125348,-78"/>
<text text-anchor="middle" x="125275" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="125275" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="125275" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="125275" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L2_EP0TP1PP0DP0_GPU8 -->
<g id="node613" class="node">
<title>ln1_L2_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="125526,-78 125384,-78 125384,-26 125526,-26 125526,-78"/>
<text text-anchor="middle" x="125455" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="125455" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="125455" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="125455" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L2_EP0TP1PP0DP0_GPU8 -->
<g id="node614" class="node">
<title>qkv_L2_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="125704,-78 125562,-78 125562,-26 125704,-26 125704,-78"/>
<text text-anchor="middle" x="125633" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="125633" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="125633" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="125633" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L2_EP0TP1PP0DP0_GPU8 -->
<g id="node615" class="node">
<title>attn_L2_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="125891.5,-78 125740.5,-78 125740.5,-26 125891.5,-26 125891.5,-78"/>
<text text-anchor="middle" x="125816" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="125816" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="125816" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="125816" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L2_EP0TP1PP0DP0_GPU8 -->
<g id="node616" class="node">
<title>attn_out_L2_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="126070,-78 125928,-78 125928,-26 126070,-26 126070,-78"/>
<text text-anchor="middle" x="125999" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="125999" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="125999" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="125999" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L2_EP0TP1PP0DP0_GPU8 -->
<g id="node617" class="node">
<title>attn_ar_L2_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="126209" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="126209" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="126209" y="-49.5" font-family="Arial" font-size="10.00">L2 EP0 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="126209" y="-38.5" font-family="Arial" font-size="10.00">GPU8</text>
</g>
<!-- residual1_L2_EP0TP1PP0DP0_GPU8 -->
<g id="node618" class="node">
<title>residual1_L2_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="126494,-78 126348,-78 126348,-26 126494,-26 126494,-78"/>
<text text-anchor="middle" x="126421" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="126421" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="126421" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="126421" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L2_EP0TP1PP0DP0_GPU8 -->
<g id="node619" class="node">
<title>ln2_L2_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="126672,-78 126530,-78 126530,-26 126672,-26 126672,-78"/>
<text text-anchor="middle" x="126601" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="126601" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="126601" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="126601" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L2_EP0TP1PP0DP0_GPU8 -->
<g id="node620" class="node">
<title>gate_L2_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightyellow" stroke="black" points="126998.29,-104 126767.17,-104 126707.71,0 126938.83,0 126998.29,-104"/>
<text text-anchor="middle" x="126853" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="126853" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="126853" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="126853" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L2_EP0TP1PP0DP0_GPU8 -->
<g id="node621" class="node">
<title>dispatch_L2_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="127133" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="127133" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="127133" y="-44" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP0_GPU8</text>
</g>
<!-- expert_0_L2_EP0TP1PP0DP0_GPU8 -->
<g id="node622" class="node">
<title>expert_0_L2_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="127408,-78 127268,-78 127268,-26 127408,-26 127408,-78"/>
<text text-anchor="middle" x="127338" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="127338" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="127338" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="127338" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L2_EP0TP1PP0DP0_GPU8 -->
<g id="node623" class="node">
<title>expert_1_L2_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="127584,-78 127444,-78 127444,-26 127584,-26 127584,-78"/>
<text text-anchor="middle" x="127514" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="127514" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="127514" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="127514" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L2_EP0TP1PP0DP0_GPU8 -->
<g id="node624" class="node">
<title>expert_2_L2_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="127760,-78 127620,-78 127620,-26 127760,-26 127760,-78"/>
<text text-anchor="middle" x="127690" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="127690" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="127690" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="127690" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L2_EP0TP1PP0DP0_GPU8 -->
<g id="node625" class="node">
<title>expert_3_L2_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="127936,-78 127796,-78 127796,-26 127936,-26 127936,-78"/>
<text text-anchor="middle" x="127866" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="127866" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="127866" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="127866" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L2_EP0TP1PP0DP0_GPU8 -->
<g id="node626" class="node">
<title>combine_L2_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="128071" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="128071" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="128071" y="-44" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP0_GPU8</text>
</g>
<!-- ffn_L2_EP0TP1PP0DP0_GPU8 -->
<g id="node627" class="node">
<title>ffn_L2_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="128376,-78 128206,-78 128206,-26 128376,-26 128376,-78"/>
<text text-anchor="middle" x="128291" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="128291" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="128291" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="128291" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L2_EP0TP1PP0DP0_GPU8 -->
<g id="node628" class="node">
<title>ffn_ar_L2_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="128515" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="128515" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="128515" y="-49.5" font-family="Arial" font-size="10.00">L2 EP0 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="128515" y="-38.5" font-family="Arial" font-size="10.00">GPU8</text>
</g>
<!-- residual2_L2_EP0TP1PP0DP0_GPU8 -->
<g id="node629" class="node">
<title>residual2_L2_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="128800,-78 128654,-78 128654,-26 128800,-26 128800,-78"/>
<text text-anchor="middle" x="128727" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="128727" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="128727" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="128727" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L2_EP0TP1PP0DP1_GPU9 -->
<g id="node630" class="node">
<title>ln1_L2_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="128978,-78 128836,-78 128836,-26 128978,-26 128978,-78"/>
<text text-anchor="middle" x="128907" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="128907" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="128907" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="128907" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L2_EP0TP1PP0DP1_GPU9 -->
<g id="node631" class="node">
<title>qkv_L2_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="129156,-78 129014,-78 129014,-26 129156,-26 129156,-78"/>
<text text-anchor="middle" x="129085" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="129085" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="129085" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="129085" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L2_EP0TP1PP0DP1_GPU9 -->
<g id="node632" class="node">
<title>attn_L2_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="129343.5,-78 129192.5,-78 129192.5,-26 129343.5,-26 129343.5,-78"/>
<text text-anchor="middle" x="129268" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="129268" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="129268" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="129268" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L2_EP0TP1PP0DP1_GPU9 -->
<g id="node633" class="node">
<title>attn_out_L2_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="129522,-78 129380,-78 129380,-26 129522,-26 129522,-78"/>
<text text-anchor="middle" x="129451" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="129451" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="129451" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="129451" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L2_EP0TP1PP0DP1_GPU9 -->
<g id="node634" class="node">
<title>attn_ar_L2_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="129661" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="129661" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="129661" y="-49.5" font-family="Arial" font-size="10.00">L2 EP0 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="129661" y="-38.5" font-family="Arial" font-size="10.00">GPU9</text>
</g>
<!-- residual1_L2_EP0TP1PP0DP1_GPU9 -->
<g id="node635" class="node">
<title>residual1_L2_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="129946,-78 129800,-78 129800,-26 129946,-26 129946,-78"/>
<text text-anchor="middle" x="129873" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="129873" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="129873" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="129873" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L2_EP0TP1PP0DP1_GPU9 -->
<g id="node636" class="node">
<title>ln2_L2_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="130124,-78 129982,-78 129982,-26 130124,-26 130124,-78"/>
<text text-anchor="middle" x="130053" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="130053" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="130053" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="130053" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L2_EP0TP1PP0DP1_GPU9 -->
<g id="node637" class="node">
<title>gate_L2_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightyellow" stroke="black" points="130450.29,-104 130219.17,-104 130159.71,0 130390.83,0 130450.29,-104"/>
<text text-anchor="middle" x="130305" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="130305" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="130305" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="130305" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L2_EP0TP1PP0DP1_GPU9 -->
<g id="node638" class="node">
<title>dispatch_L2_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="130585" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="130585" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="130585" y="-44" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP1_GPU9</text>
</g>
<!-- expert_0_L2_EP0TP1PP0DP1_GPU9 -->
<g id="node639" class="node">
<title>expert_0_L2_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="130860,-78 130720,-78 130720,-26 130860,-26 130860,-78"/>
<text text-anchor="middle" x="130790" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="130790" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="130790" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="130790" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L2_EP0TP1PP0DP1_GPU9 -->
<g id="node640" class="node">
<title>expert_1_L2_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="131036,-78 130896,-78 130896,-26 131036,-26 131036,-78"/>
<text text-anchor="middle" x="130966" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="130966" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="130966" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="130966" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L2_EP0TP1PP0DP1_GPU9 -->
<g id="node641" class="node">
<title>expert_2_L2_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="131212,-78 131072,-78 131072,-26 131212,-26 131212,-78"/>
<text text-anchor="middle" x="131142" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="131142" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="131142" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="131142" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L2_EP0TP1PP0DP1_GPU9 -->
<g id="node642" class="node">
<title>expert_3_L2_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="131388,-78 131248,-78 131248,-26 131388,-26 131388,-78"/>
<text text-anchor="middle" x="131318" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="131318" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="131318" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="131318" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L2_EP0TP1PP0DP1_GPU9 -->
<g id="node643" class="node">
<title>combine_L2_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="131523" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="131523" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="131523" y="-44" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP1_GPU9</text>
</g>
<!-- ffn_L2_EP0TP1PP0DP1_GPU9 -->
<g id="node644" class="node">
<title>ffn_L2_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="131828,-78 131658,-78 131658,-26 131828,-26 131828,-78"/>
<text text-anchor="middle" x="131743" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="131743" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="131743" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="131743" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L2_EP0TP1PP0DP1_GPU9 -->
<g id="node645" class="node">
<title>ffn_ar_L2_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="131967" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="131967" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="131967" y="-49.5" font-family="Arial" font-size="10.00">L2 EP0 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="131967" y="-38.5" font-family="Arial" font-size="10.00">GPU9</text>
</g>
<!-- residual2_L2_EP0TP1PP0DP1_GPU9 -->
<g id="node646" class="node">
<title>residual2_L2_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="132252,-78 132106,-78 132106,-26 132252,-26 132252,-78"/>
<text text-anchor="middle" x="132179" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="132179" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="132179" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="132179" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L2_EP0TP2PP0DP0_GPU16 -->
<g id="node647" class="node">
<title>ln1_L2_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="132433.5,-78 132288.5,-78 132288.5,-26 132433.5,-26 132433.5,-78"/>
<text text-anchor="middle" x="132361" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="132361" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="132361" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="132361" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L2_EP0TP2PP0DP0_GPU16 -->
<g id="node648" class="node">
<title>qkv_L2_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="132614.5,-78 132469.5,-78 132469.5,-26 132614.5,-26 132614.5,-78"/>
<text text-anchor="middle" x="132542" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="132542" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="132542" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="132542" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L2_EP0TP2PP0DP0_GPU16 -->
<g id="node649" class="node">
<title>attn_L2_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="132801.5,-78 132650.5,-78 132650.5,-26 132801.5,-26 132801.5,-78"/>
<text text-anchor="middle" x="132726" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="132726" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="132726" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="132726" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L2_EP0TP2PP0DP0_GPU16 -->
<g id="node650" class="node">
<title>attn_out_L2_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="132982.5,-78 132837.5,-78 132837.5,-26 132982.5,-26 132982.5,-78"/>
<text text-anchor="middle" x="132910" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="132910" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="132910" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="132910" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L2_EP0TP2PP0DP0_GPU16 -->
<g id="node651" class="node">
<title>attn_ar_L2_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="133122" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="133122" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="133122" y="-49.5" font-family="Arial" font-size="10.00">L2 EP0 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="133122" y="-38.5" font-family="Arial" font-size="10.00">GPU16</text>
</g>
<!-- residual1_L2_EP0TP2PP0DP0_GPU16 -->
<g id="node652" class="node">
<title>residual1_L2_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="133407,-78 133261,-78 133261,-26 133407,-26 133407,-78"/>
<text text-anchor="middle" x="133334" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="133334" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="133334" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="133334" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L2_EP0TP2PP0DP0_GPU16 -->
<g id="node653" class="node">
<title>ln2_L2_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="133588.5,-78 133443.5,-78 133443.5,-26 133588.5,-26 133588.5,-78"/>
<text text-anchor="middle" x="133516" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="133516" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="133516" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="133516" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L2_EP0TP2PP0DP0_GPU16 -->
<g id="node654" class="node">
<title>gate_L2_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightyellow" stroke="black" points="133925.16,-104 133686.29,-104 133624.84,0 133863.71,0 133925.16,-104"/>
<text text-anchor="middle" x="133775" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="133775" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="133775" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="133775" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L2_EP0TP2PP0DP0_GPU16 -->
<g id="node655" class="node">
<title>dispatch_L2_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="134064" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="134064" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="134064" y="-44" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP0_GPU16</text>
</g>
<!-- expert_0_L2_EP0TP2PP0DP0_GPU16 -->
<g id="node656" class="node">
<title>expert_0_L2_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="134347.5,-78 134202.5,-78 134202.5,-26 134347.5,-26 134347.5,-78"/>
<text text-anchor="middle" x="134275" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="134275" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="134275" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="134275" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L2_EP0TP2PP0DP0_GPU16 -->
<g id="node657" class="node">
<title>expert_1_L2_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="134528.5,-78 134383.5,-78 134383.5,-26 134528.5,-26 134528.5,-78"/>
<text text-anchor="middle" x="134456" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="134456" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="134456" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="134456" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L2_EP0TP2PP0DP0_GPU16 -->
<g id="node658" class="node">
<title>expert_2_L2_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="134709.5,-78 134564.5,-78 134564.5,-26 134709.5,-26 134709.5,-78"/>
<text text-anchor="middle" x="134637" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="134637" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="134637" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="134637" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L2_EP0TP2PP0DP0_GPU16 -->
<g id="node659" class="node">
<title>expert_3_L2_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="134890.5,-78 134745.5,-78 134745.5,-26 134890.5,-26 134890.5,-78"/>
<text text-anchor="middle" x="134818" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="134818" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="134818" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="134818" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L2_EP0TP2PP0DP0_GPU16 -->
<g id="node660" class="node">
<title>combine_L2_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="135029" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="135029" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="135029" y="-44" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP0_GPU16</text>
</g>
<!-- ffn_L2_EP0TP2PP0DP0_GPU16 -->
<g id="node661" class="node">
<title>ffn_L2_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="135338,-78 135168,-78 135168,-26 135338,-26 135338,-78"/>
<text text-anchor="middle" x="135253" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="135253" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="135253" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="135253" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L2_EP0TP2PP0DP0_GPU16 -->
<g id="node662" class="node">
<title>ffn_ar_L2_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="135477" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="135477" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="135477" y="-49.5" font-family="Arial" font-size="10.00">L2 EP0 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="135477" y="-38.5" font-family="Arial" font-size="10.00">GPU16</text>
</g>
<!-- residual2_L2_EP0TP2PP0DP0_GPU16 -->
<g id="node663" class="node">
<title>residual2_L2_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="135762,-78 135616,-78 135616,-26 135762,-26 135762,-78"/>
<text text-anchor="middle" x="135689" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="135689" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="135689" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="135689" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L2_EP0TP2PP0DP1_GPU17 -->
<g id="node664" class="node">
<title>ln1_L2_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="135943.5,-78 135798.5,-78 135798.5,-26 135943.5,-26 135943.5,-78"/>
<text text-anchor="middle" x="135871" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="135871" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="135871" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="135871" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L2_EP0TP2PP0DP1_GPU17 -->
<g id="node665" class="node">
<title>qkv_L2_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="136124.5,-78 135979.5,-78 135979.5,-26 136124.5,-26 136124.5,-78"/>
<text text-anchor="middle" x="136052" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="136052" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="136052" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="136052" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L2_EP0TP2PP0DP1_GPU17 -->
<g id="node666" class="node">
<title>attn_L2_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="136311.5,-78 136160.5,-78 136160.5,-26 136311.5,-26 136311.5,-78"/>
<text text-anchor="middle" x="136236" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="136236" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="136236" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="136236" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L2_EP0TP2PP0DP1_GPU17 -->
<g id="node667" class="node">
<title>attn_out_L2_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="136492.5,-78 136347.5,-78 136347.5,-26 136492.5,-26 136492.5,-78"/>
<text text-anchor="middle" x="136420" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="136420" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="136420" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="136420" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L2_EP0TP2PP0DP1_GPU17 -->
<g id="node668" class="node">
<title>attn_ar_L2_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="136632" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="136632" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="136632" y="-49.5" font-family="Arial" font-size="10.00">L2 EP0 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="136632" y="-38.5" font-family="Arial" font-size="10.00">GPU17</text>
</g>
<!-- residual1_L2_EP0TP2PP0DP1_GPU17 -->
<g id="node669" class="node">
<title>residual1_L2_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="136917,-78 136771,-78 136771,-26 136917,-26 136917,-78"/>
<text text-anchor="middle" x="136844" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="136844" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="136844" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="136844" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L2_EP0TP2PP0DP1_GPU17 -->
<g id="node670" class="node">
<title>ln2_L2_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="137098.5,-78 136953.5,-78 136953.5,-26 137098.5,-26 137098.5,-78"/>
<text text-anchor="middle" x="137026" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="137026" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="137026" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="137026" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L2_EP0TP2PP0DP1_GPU17 -->
<g id="node671" class="node">
<title>gate_L2_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightyellow" stroke="black" points="137435.16,-104 137196.29,-104 137134.84,0 137373.71,0 137435.16,-104"/>
<text text-anchor="middle" x="137285" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="137285" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="137285" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="137285" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L2_EP0TP2PP0DP1_GPU17 -->
<g id="node672" class="node">
<title>dispatch_L2_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="137574" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="137574" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="137574" y="-44" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP1_GPU17</text>
</g>
<!-- expert_0_L2_EP0TP2PP0DP1_GPU17 -->
<g id="node673" class="node">
<title>expert_0_L2_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="137857.5,-78 137712.5,-78 137712.5,-26 137857.5,-26 137857.5,-78"/>
<text text-anchor="middle" x="137785" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="137785" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="137785" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="137785" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L2_EP0TP2PP0DP1_GPU17 -->
<g id="node674" class="node">
<title>expert_1_L2_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="138038.5,-78 137893.5,-78 137893.5,-26 138038.5,-26 138038.5,-78"/>
<text text-anchor="middle" x="137966" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="137966" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="137966" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="137966" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L2_EP0TP2PP0DP1_GPU17 -->
<g id="node675" class="node">
<title>expert_2_L2_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="138219.5,-78 138074.5,-78 138074.5,-26 138219.5,-26 138219.5,-78"/>
<text text-anchor="middle" x="138147" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="138147" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="138147" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="138147" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L2_EP0TP2PP0DP1_GPU17 -->
<g id="node676" class="node">
<title>expert_3_L2_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="138400.5,-78 138255.5,-78 138255.5,-26 138400.5,-26 138400.5,-78"/>
<text text-anchor="middle" x="138328" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="138328" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="138328" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="138328" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L2_EP0TP2PP0DP1_GPU17 -->
<g id="node677" class="node">
<title>combine_L2_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="138539" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="138539" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="138539" y="-44" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP1_GPU17</text>
</g>
<!-- ffn_L2_EP0TP2PP0DP1_GPU17 -->
<g id="node678" class="node">
<title>ffn_L2_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="138848,-78 138678,-78 138678,-26 138848,-26 138848,-78"/>
<text text-anchor="middle" x="138763" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="138763" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="138763" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="138763" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L2_EP0TP2PP0DP1_GPU17 -->
<g id="node679" class="node">
<title>ffn_ar_L2_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="138987" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="138987" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="138987" y="-49.5" font-family="Arial" font-size="10.00">L2 EP0 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="138987" y="-38.5" font-family="Arial" font-size="10.00">GPU17</text>
</g>
<!-- residual2_L2_EP0TP2PP0DP1_GPU17 -->
<g id="node680" class="node">
<title>residual2_L2_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="139272,-78 139126,-78 139126,-26 139272,-26 139272,-78"/>
<text text-anchor="middle" x="139199" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="139199" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="139199" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="139199" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L2_EP0TP3PP0DP0_GPU24 -->
<g id="node681" class="node">
<title>ln1_L2_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="139453.5,-78 139308.5,-78 139308.5,-26 139453.5,-26 139453.5,-78"/>
<text text-anchor="middle" x="139381" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="139381" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="139381" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="139381" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L2_EP0TP3PP0DP0_GPU24 -->
<g id="node682" class="node">
<title>qkv_L2_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="139634.5,-78 139489.5,-78 139489.5,-26 139634.5,-26 139634.5,-78"/>
<text text-anchor="middle" x="139562" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="139562" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="139562" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="139562" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L2_EP0TP3PP0DP0_GPU24 -->
<g id="node683" class="node">
<title>attn_L2_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="139821.5,-78 139670.5,-78 139670.5,-26 139821.5,-26 139821.5,-78"/>
<text text-anchor="middle" x="139746" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="139746" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="139746" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="139746" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L2_EP0TP3PP0DP0_GPU24 -->
<g id="node684" class="node">
<title>attn_out_L2_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="140002.5,-78 139857.5,-78 139857.5,-26 140002.5,-26 140002.5,-78"/>
<text text-anchor="middle" x="139930" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="139930" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="139930" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="139930" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L2_EP0TP3PP0DP0_GPU24 -->
<g id="node685" class="node">
<title>attn_ar_L2_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="140142" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="140142" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="140142" y="-49.5" font-family="Arial" font-size="10.00">L2 EP0 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="140142" y="-38.5" font-family="Arial" font-size="10.00">GPU24</text>
</g>
<!-- residual1_L2_EP0TP3PP0DP0_GPU24 -->
<g id="node686" class="node">
<title>residual1_L2_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="140427,-78 140281,-78 140281,-26 140427,-26 140427,-78"/>
<text text-anchor="middle" x="140354" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="140354" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="140354" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="140354" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L2_EP0TP3PP0DP0_GPU24 -->
<g id="node687" class="node">
<title>ln2_L2_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="140608.5,-78 140463.5,-78 140463.5,-26 140608.5,-26 140608.5,-78"/>
<text text-anchor="middle" x="140536" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="140536" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="140536" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="140536" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L2_EP0TP3PP0DP0_GPU24 -->
<g id="node688" class="node">
<title>gate_L2_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightyellow" stroke="black" points="140945.16,-104 140706.29,-104 140644.84,0 140883.71,0 140945.16,-104"/>
<text text-anchor="middle" x="140795" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="140795" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="140795" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="140795" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L2_EP0TP3PP0DP0_GPU24 -->
<g id="node689" class="node">
<title>dispatch_L2_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="141084" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="141084" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="141084" y="-44" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP0_GPU24</text>
</g>
<!-- expert_0_L2_EP0TP3PP0DP0_GPU24 -->
<g id="node690" class="node">
<title>expert_0_L2_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="141367.5,-78 141222.5,-78 141222.5,-26 141367.5,-26 141367.5,-78"/>
<text text-anchor="middle" x="141295" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="141295" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="141295" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="141295" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L2_EP0TP3PP0DP0_GPU24 -->
<g id="node691" class="node">
<title>expert_1_L2_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="141548.5,-78 141403.5,-78 141403.5,-26 141548.5,-26 141548.5,-78"/>
<text text-anchor="middle" x="141476" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="141476" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="141476" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="141476" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L2_EP0TP3PP0DP0_GPU24 -->
<g id="node692" class="node">
<title>expert_2_L2_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="141729.5,-78 141584.5,-78 141584.5,-26 141729.5,-26 141729.5,-78"/>
<text text-anchor="middle" x="141657" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="141657" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="141657" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="141657" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L2_EP0TP3PP0DP0_GPU24 -->
<g id="node693" class="node">
<title>expert_3_L2_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="141910.5,-78 141765.5,-78 141765.5,-26 141910.5,-26 141910.5,-78"/>
<text text-anchor="middle" x="141838" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="141838" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="141838" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="141838" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L2_EP0TP3PP0DP0_GPU24 -->
<g id="node694" class="node">
<title>combine_L2_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="142049" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="142049" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="142049" y="-44" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP0_GPU24</text>
</g>
<!-- ffn_L2_EP0TP3PP0DP0_GPU24 -->
<g id="node695" class="node">
<title>ffn_L2_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="142358,-78 142188,-78 142188,-26 142358,-26 142358,-78"/>
<text text-anchor="middle" x="142273" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="142273" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="142273" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="142273" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L2_EP0TP3PP0DP0_GPU24 -->
<g id="node696" class="node">
<title>ffn_ar_L2_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="142497" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="142497" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="142497" y="-49.5" font-family="Arial" font-size="10.00">L2 EP0 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="142497" y="-38.5" font-family="Arial" font-size="10.00">GPU24</text>
</g>
<!-- residual2_L2_EP0TP3PP0DP0_GPU24 -->
<g id="node697" class="node">
<title>residual2_L2_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="142782,-78 142636,-78 142636,-26 142782,-26 142782,-78"/>
<text text-anchor="middle" x="142709" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="142709" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="142709" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="142709" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L2_EP0TP3PP0DP1_GPU25 -->
<g id="node698" class="node">
<title>ln1_L2_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="142963.5,-78 142818.5,-78 142818.5,-26 142963.5,-26 142963.5,-78"/>
<text text-anchor="middle" x="142891" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="142891" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="142891" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="142891" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L2_EP0TP3PP0DP1_GPU25 -->
<g id="node699" class="node">
<title>qkv_L2_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="143144.5,-78 142999.5,-78 142999.5,-26 143144.5,-26 143144.5,-78"/>
<text text-anchor="middle" x="143072" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="143072" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="143072" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="143072" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L2_EP0TP3PP0DP1_GPU25 -->
<g id="node700" class="node">
<title>attn_L2_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="143331.5,-78 143180.5,-78 143180.5,-26 143331.5,-26 143331.5,-78"/>
<text text-anchor="middle" x="143256" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="143256" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="143256" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="143256" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L2_EP0TP3PP0DP1_GPU25 -->
<g id="node701" class="node">
<title>attn_out_L2_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="143512.5,-78 143367.5,-78 143367.5,-26 143512.5,-26 143512.5,-78"/>
<text text-anchor="middle" x="143440" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="143440" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="143440" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="143440" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L2_EP0TP3PP0DP1_GPU25 -->
<g id="node702" class="node">
<title>attn_ar_L2_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="143652" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="143652" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="143652" y="-49.5" font-family="Arial" font-size="10.00">L2 EP0 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="143652" y="-38.5" font-family="Arial" font-size="10.00">GPU25</text>
</g>
<!-- residual1_L2_EP0TP3PP0DP1_GPU25 -->
<g id="node703" class="node">
<title>residual1_L2_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="143937,-78 143791,-78 143791,-26 143937,-26 143937,-78"/>
<text text-anchor="middle" x="143864" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="143864" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="143864" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="143864" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L2_EP0TP3PP0DP1_GPU25 -->
<g id="node704" class="node">
<title>ln2_L2_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="144118.5,-78 143973.5,-78 143973.5,-26 144118.5,-26 144118.5,-78"/>
<text text-anchor="middle" x="144046" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="144046" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="144046" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="144046" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L2_EP0TP3PP0DP1_GPU25 -->
<g id="node705" class="node">
<title>gate_L2_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightyellow" stroke="black" points="144455.16,-104 144216.29,-104 144154.84,0 144393.71,0 144455.16,-104"/>
<text text-anchor="middle" x="144305" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="144305" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="144305" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="144305" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L2_EP0TP3PP0DP1_GPU25 -->
<g id="node706" class="node">
<title>dispatch_L2_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="144594" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="144594" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="144594" y="-44" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP1_GPU25</text>
</g>
<!-- expert_0_L2_EP0TP3PP0DP1_GPU25 -->
<g id="node707" class="node">
<title>expert_0_L2_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="144877.5,-78 144732.5,-78 144732.5,-26 144877.5,-26 144877.5,-78"/>
<text text-anchor="middle" x="144805" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="144805" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="144805" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="144805" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L2_EP0TP3PP0DP1_GPU25 -->
<g id="node708" class="node">
<title>expert_1_L2_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="145058.5,-78 144913.5,-78 144913.5,-26 145058.5,-26 145058.5,-78"/>
<text text-anchor="middle" x="144986" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="144986" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="144986" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="144986" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L2_EP0TP3PP0DP1_GPU25 -->
<g id="node709" class="node">
<title>expert_2_L2_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="145239.5,-78 145094.5,-78 145094.5,-26 145239.5,-26 145239.5,-78"/>
<text text-anchor="middle" x="145167" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="145167" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="145167" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="145167" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L2_EP0TP3PP0DP1_GPU25 -->
<g id="node710" class="node">
<title>expert_3_L2_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="145420.5,-78 145275.5,-78 145275.5,-26 145420.5,-26 145420.5,-78"/>
<text text-anchor="middle" x="145348" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="145348" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="145348" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="145348" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L2_EP0TP3PP0DP1_GPU25 -->
<g id="node711" class="node">
<title>combine_L2_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="145559" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="145559" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="145559" y="-44" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP1_GPU25</text>
</g>
<!-- ffn_L2_EP0TP3PP0DP1_GPU25 -->
<g id="node712" class="node">
<title>ffn_L2_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="145868,-78 145698,-78 145698,-26 145868,-26 145868,-78"/>
<text text-anchor="middle" x="145783" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="145783" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="145783" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="145783" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L2_EP0TP3PP0DP1_GPU25 -->
<g id="node713" class="node">
<title>ffn_ar_L2_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="146007" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="146007" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="146007" y="-49.5" font-family="Arial" font-size="10.00">L2 EP0 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="146007" y="-38.5" font-family="Arial" font-size="10.00">GPU25</text>
</g>
<!-- residual2_L2_EP0TP3PP0DP1_GPU25 -->
<g id="node714" class="node">
<title>residual2_L2_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="146292,-78 146146,-78 146146,-26 146292,-26 146292,-78"/>
<text text-anchor="middle" x="146219" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="146219" y="-55" font-family="Arial" font-size="10.00">L2_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="146219" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="146219" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L2_EP1TP0PP0DP0_GPU32 -->
<g id="node715" class="node">
<title>ln1_L2_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="146473.5,-78 146328.5,-78 146328.5,-26 146473.5,-26 146473.5,-78"/>
<text text-anchor="middle" x="146401" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="146401" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="146401" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="146401" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L2_EP1TP0PP0DP0_GPU32 -->
<g id="node716" class="node">
<title>qkv_L2_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="146654.5,-78 146509.5,-78 146509.5,-26 146654.5,-26 146654.5,-78"/>
<text text-anchor="middle" x="146582" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="146582" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="146582" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="146582" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L2_EP1TP0PP0DP0_GPU32 -->
<g id="node717" class="node">
<title>attn_L2_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="146841.5,-78 146690.5,-78 146690.5,-26 146841.5,-26 146841.5,-78"/>
<text text-anchor="middle" x="146766" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="146766" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="146766" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="146766" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L2_EP1TP0PP0DP0_GPU32 -->
<g id="node718" class="node">
<title>attn_out_L2_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="147022.5,-78 146877.5,-78 146877.5,-26 147022.5,-26 147022.5,-78"/>
<text text-anchor="middle" x="146950" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="146950" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="146950" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="146950" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L2_EP1TP0PP0DP0_GPU32 -->
<g id="node719" class="node">
<title>attn_ar_L2_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="147162" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="147162" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="147162" y="-49.5" font-family="Arial" font-size="10.00">L2 EP1 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="147162" y="-38.5" font-family="Arial" font-size="10.00">GPU32</text>
</g>
<!-- residual1_L2_EP1TP0PP0DP0_GPU32 -->
<g id="node720" class="node">
<title>residual1_L2_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="147447,-78 147301,-78 147301,-26 147447,-26 147447,-78"/>
<text text-anchor="middle" x="147374" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="147374" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="147374" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="147374" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L2_EP1TP0PP0DP0_GPU32 -->
<g id="node721" class="node">
<title>ln2_L2_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="147628.5,-78 147483.5,-78 147483.5,-26 147628.5,-26 147628.5,-78"/>
<text text-anchor="middle" x="147556" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="147556" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="147556" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="147556" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L2_EP1TP0PP0DP0_GPU32 -->
<g id="node722" class="node">
<title>gate_L2_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightyellow" stroke="black" points="147965.16,-104 147726.29,-104 147664.84,0 147903.71,0 147965.16,-104"/>
<text text-anchor="middle" x="147815" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="147815" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="147815" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="147815" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L2_EP1TP0PP0DP0_GPU32 -->
<g id="node723" class="node">
<title>dispatch_L2_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="148104" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="148104" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="148104" y="-44" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP0_GPU32</text>
</g>
<!-- expert_0_L2_EP1TP0PP0DP0_GPU32 -->
<g id="node724" class="node">
<title>expert_0_L2_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="148387.5,-78 148242.5,-78 148242.5,-26 148387.5,-26 148387.5,-78"/>
<text text-anchor="middle" x="148315" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="148315" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="148315" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="148315" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L2_EP1TP0PP0DP0_GPU32 -->
<g id="node725" class="node">
<title>expert_1_L2_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="148568.5,-78 148423.5,-78 148423.5,-26 148568.5,-26 148568.5,-78"/>
<text text-anchor="middle" x="148496" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="148496" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="148496" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="148496" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L2_EP1TP0PP0DP0_GPU32 -->
<g id="node726" class="node">
<title>expert_2_L2_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="148749.5,-78 148604.5,-78 148604.5,-26 148749.5,-26 148749.5,-78"/>
<text text-anchor="middle" x="148677" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="148677" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="148677" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="148677" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L2_EP1TP0PP0DP0_GPU32 -->
<g id="node727" class="node">
<title>expert_3_L2_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="148930.5,-78 148785.5,-78 148785.5,-26 148930.5,-26 148930.5,-78"/>
<text text-anchor="middle" x="148858" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="148858" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="148858" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="148858" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L2_EP1TP0PP0DP0_GPU32 -->
<g id="node728" class="node">
<title>combine_L2_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="149069" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="149069" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="149069" y="-44" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP0_GPU32</text>
</g>
<!-- ffn_L2_EP1TP0PP0DP0_GPU32 -->
<g id="node729" class="node">
<title>ffn_L2_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="149378,-78 149208,-78 149208,-26 149378,-26 149378,-78"/>
<text text-anchor="middle" x="149293" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="149293" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="149293" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="149293" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L2_EP1TP0PP0DP0_GPU32 -->
<g id="node730" class="node">
<title>ffn_ar_L2_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="149517" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="149517" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="149517" y="-49.5" font-family="Arial" font-size="10.00">L2 EP1 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="149517" y="-38.5" font-family="Arial" font-size="10.00">GPU32</text>
</g>
<!-- residual2_L2_EP1TP0PP0DP0_GPU32 -->
<g id="node731" class="node">
<title>residual2_L2_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="149802,-78 149656,-78 149656,-26 149802,-26 149802,-78"/>
<text text-anchor="middle" x="149729" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="149729" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="149729" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="149729" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L2_EP1TP0PP0DP1_GPU33 -->
<g id="node732" class="node">
<title>ln1_L2_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="149983.5,-78 149838.5,-78 149838.5,-26 149983.5,-26 149983.5,-78"/>
<text text-anchor="middle" x="149911" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="149911" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="149911" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="149911" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L2_EP1TP0PP0DP1_GPU33 -->
<g id="node733" class="node">
<title>qkv_L2_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="150164.5,-78 150019.5,-78 150019.5,-26 150164.5,-26 150164.5,-78"/>
<text text-anchor="middle" x="150092" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="150092" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="150092" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="150092" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L2_EP1TP0PP0DP1_GPU33 -->
<g id="node734" class="node">
<title>attn_L2_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="150351.5,-78 150200.5,-78 150200.5,-26 150351.5,-26 150351.5,-78"/>
<text text-anchor="middle" x="150276" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="150276" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="150276" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="150276" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L2_EP1TP0PP0DP1_GPU33 -->
<g id="node735" class="node">
<title>attn_out_L2_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="150532.5,-78 150387.5,-78 150387.5,-26 150532.5,-26 150532.5,-78"/>
<text text-anchor="middle" x="150460" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="150460" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="150460" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="150460" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L2_EP1TP0PP0DP1_GPU33 -->
<g id="node736" class="node">
<title>attn_ar_L2_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="150672" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="150672" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="150672" y="-49.5" font-family="Arial" font-size="10.00">L2 EP1 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="150672" y="-38.5" font-family="Arial" font-size="10.00">GPU33</text>
</g>
<!-- residual1_L2_EP1TP0PP0DP1_GPU33 -->
<g id="node737" class="node">
<title>residual1_L2_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="150957,-78 150811,-78 150811,-26 150957,-26 150957,-78"/>
<text text-anchor="middle" x="150884" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="150884" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="150884" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="150884" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L2_EP1TP0PP0DP1_GPU33 -->
<g id="node738" class="node">
<title>ln2_L2_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="151138.5,-78 150993.5,-78 150993.5,-26 151138.5,-26 151138.5,-78"/>
<text text-anchor="middle" x="151066" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="151066" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="151066" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="151066" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L2_EP1TP0PP0DP1_GPU33 -->
<g id="node739" class="node">
<title>gate_L2_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightyellow" stroke="black" points="151475.16,-104 151236.29,-104 151174.84,0 151413.71,0 151475.16,-104"/>
<text text-anchor="middle" x="151325" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="151325" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="151325" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="151325" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L2_EP1TP0PP0DP1_GPU33 -->
<g id="node740" class="node">
<title>dispatch_L2_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="151614" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="151614" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="151614" y="-44" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP1_GPU33</text>
</g>
<!-- expert_0_L2_EP1TP0PP0DP1_GPU33 -->
<g id="node741" class="node">
<title>expert_0_L2_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="151897.5,-78 151752.5,-78 151752.5,-26 151897.5,-26 151897.5,-78"/>
<text text-anchor="middle" x="151825" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="151825" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="151825" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="151825" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L2_EP1TP0PP0DP1_GPU33 -->
<g id="node742" class="node">
<title>expert_1_L2_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="152078.5,-78 151933.5,-78 151933.5,-26 152078.5,-26 152078.5,-78"/>
<text text-anchor="middle" x="152006" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="152006" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="152006" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="152006" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L2_EP1TP0PP0DP1_GPU33 -->
<g id="node743" class="node">
<title>expert_2_L2_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="152259.5,-78 152114.5,-78 152114.5,-26 152259.5,-26 152259.5,-78"/>
<text text-anchor="middle" x="152187" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="152187" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="152187" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="152187" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L2_EP1TP0PP0DP1_GPU33 -->
<g id="node744" class="node">
<title>expert_3_L2_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="152440.5,-78 152295.5,-78 152295.5,-26 152440.5,-26 152440.5,-78"/>
<text text-anchor="middle" x="152368" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="152368" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="152368" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="152368" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L2_EP1TP0PP0DP1_GPU33 -->
<g id="node745" class="node">
<title>combine_L2_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="152579" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="152579" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="152579" y="-44" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP1_GPU33</text>
</g>
<!-- ffn_L2_EP1TP0PP0DP1_GPU33 -->
<g id="node746" class="node">
<title>ffn_L2_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="152888,-78 152718,-78 152718,-26 152888,-26 152888,-78"/>
<text text-anchor="middle" x="152803" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="152803" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="152803" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="152803" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L2_EP1TP0PP0DP1_GPU33 -->
<g id="node747" class="node">
<title>ffn_ar_L2_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="153027" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="153027" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="153027" y="-49.5" font-family="Arial" font-size="10.00">L2 EP1 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="153027" y="-38.5" font-family="Arial" font-size="10.00">GPU33</text>
</g>
<!-- residual2_L2_EP1TP0PP0DP1_GPU33 -->
<g id="node748" class="node">
<title>residual2_L2_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="153312,-78 153166,-78 153166,-26 153312,-26 153312,-78"/>
<text text-anchor="middle" x="153239" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="153239" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="153239" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="153239" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L2_EP1TP1PP0DP0_GPU40 -->
<g id="node749" class="node">
<title>ln1_L2_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="153493.5,-78 153348.5,-78 153348.5,-26 153493.5,-26 153493.5,-78"/>
<text text-anchor="middle" x="153421" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="153421" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="153421" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="153421" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L2_EP1TP1PP0DP0_GPU40 -->
<g id="node750" class="node">
<title>qkv_L2_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="153674.5,-78 153529.5,-78 153529.5,-26 153674.5,-26 153674.5,-78"/>
<text text-anchor="middle" x="153602" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="153602" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="153602" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="153602" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L2_EP1TP1PP0DP0_GPU40 -->
<g id="node751" class="node">
<title>attn_L2_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="153861.5,-78 153710.5,-78 153710.5,-26 153861.5,-26 153861.5,-78"/>
<text text-anchor="middle" x="153786" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="153786" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="153786" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="153786" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L2_EP1TP1PP0DP0_GPU40 -->
<g id="node752" class="node">
<title>attn_out_L2_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="154042.5,-78 153897.5,-78 153897.5,-26 154042.5,-26 154042.5,-78"/>
<text text-anchor="middle" x="153970" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="153970" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="153970" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="153970" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L2_EP1TP1PP0DP0_GPU40 -->
<g id="node753" class="node">
<title>attn_ar_L2_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="154182" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="154182" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="154182" y="-49.5" font-family="Arial" font-size="10.00">L2 EP1 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="154182" y="-38.5" font-family="Arial" font-size="10.00">GPU40</text>
</g>
<!-- residual1_L2_EP1TP1PP0DP0_GPU40 -->
<g id="node754" class="node">
<title>residual1_L2_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="154467,-78 154321,-78 154321,-26 154467,-26 154467,-78"/>
<text text-anchor="middle" x="154394" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="154394" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="154394" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="154394" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L2_EP1TP1PP0DP0_GPU40 -->
<g id="node755" class="node">
<title>ln2_L2_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="154648.5,-78 154503.5,-78 154503.5,-26 154648.5,-26 154648.5,-78"/>
<text text-anchor="middle" x="154576" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="154576" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="154576" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="154576" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L2_EP1TP1PP0DP0_GPU40 -->
<g id="node756" class="node">
<title>gate_L2_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightyellow" stroke="black" points="154985.16,-104 154746.29,-104 154684.84,0 154923.71,0 154985.16,-104"/>
<text text-anchor="middle" x="154835" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="154835" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="154835" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="154835" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L2_EP1TP1PP0DP0_GPU40 -->
<g id="node757" class="node">
<title>dispatch_L2_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="155124" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="155124" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="155124" y="-44" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP0_GPU40</text>
</g>
<!-- expert_0_L2_EP1TP1PP0DP0_GPU40 -->
<g id="node758" class="node">
<title>expert_0_L2_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="155407.5,-78 155262.5,-78 155262.5,-26 155407.5,-26 155407.5,-78"/>
<text text-anchor="middle" x="155335" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="155335" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="155335" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="155335" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L2_EP1TP1PP0DP0_GPU40 -->
<g id="node759" class="node">
<title>expert_1_L2_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="155588.5,-78 155443.5,-78 155443.5,-26 155588.5,-26 155588.5,-78"/>
<text text-anchor="middle" x="155516" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="155516" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="155516" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="155516" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L2_EP1TP1PP0DP0_GPU40 -->
<g id="node760" class="node">
<title>expert_2_L2_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="155769.5,-78 155624.5,-78 155624.5,-26 155769.5,-26 155769.5,-78"/>
<text text-anchor="middle" x="155697" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="155697" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="155697" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="155697" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L2_EP1TP1PP0DP0_GPU40 -->
<g id="node761" class="node">
<title>expert_3_L2_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="155950.5,-78 155805.5,-78 155805.5,-26 155950.5,-26 155950.5,-78"/>
<text text-anchor="middle" x="155878" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="155878" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="155878" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="155878" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L2_EP1TP1PP0DP0_GPU40 -->
<g id="node762" class="node">
<title>combine_L2_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="156089" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="156089" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="156089" y="-44" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP0_GPU40</text>
</g>
<!-- ffn_L2_EP1TP1PP0DP0_GPU40 -->
<g id="node763" class="node">
<title>ffn_L2_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="156398,-78 156228,-78 156228,-26 156398,-26 156398,-78"/>
<text text-anchor="middle" x="156313" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="156313" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="156313" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="156313" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L2_EP1TP1PP0DP0_GPU40 -->
<g id="node764" class="node">
<title>ffn_ar_L2_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="156537" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="156537" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="156537" y="-49.5" font-family="Arial" font-size="10.00">L2 EP1 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="156537" y="-38.5" font-family="Arial" font-size="10.00">GPU40</text>
</g>
<!-- residual2_L2_EP1TP1PP0DP0_GPU40 -->
<g id="node765" class="node">
<title>residual2_L2_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="156822,-78 156676,-78 156676,-26 156822,-26 156822,-78"/>
<text text-anchor="middle" x="156749" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="156749" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="156749" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="156749" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L2_EP1TP1PP0DP1_GPU41 -->
<g id="node766" class="node">
<title>ln1_L2_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="157003.5,-78 156858.5,-78 156858.5,-26 157003.5,-26 157003.5,-78"/>
<text text-anchor="middle" x="156931" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="156931" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="156931" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="156931" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L2_EP1TP1PP0DP1_GPU41 -->
<g id="node767" class="node">
<title>qkv_L2_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="157184.5,-78 157039.5,-78 157039.5,-26 157184.5,-26 157184.5,-78"/>
<text text-anchor="middle" x="157112" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="157112" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="157112" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="157112" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L2_EP1TP1PP0DP1_GPU41 -->
<g id="node768" class="node">
<title>attn_L2_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="157371.5,-78 157220.5,-78 157220.5,-26 157371.5,-26 157371.5,-78"/>
<text text-anchor="middle" x="157296" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="157296" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="157296" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="157296" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L2_EP1TP1PP0DP1_GPU41 -->
<g id="node769" class="node">
<title>attn_out_L2_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="157552.5,-78 157407.5,-78 157407.5,-26 157552.5,-26 157552.5,-78"/>
<text text-anchor="middle" x="157480" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="157480" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="157480" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="157480" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L2_EP1TP1PP0DP1_GPU41 -->
<g id="node770" class="node">
<title>attn_ar_L2_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="157692" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="157692" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="157692" y="-49.5" font-family="Arial" font-size="10.00">L2 EP1 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="157692" y="-38.5" font-family="Arial" font-size="10.00">GPU41</text>
</g>
<!-- residual1_L2_EP1TP1PP0DP1_GPU41 -->
<g id="node771" class="node">
<title>residual1_L2_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="157977,-78 157831,-78 157831,-26 157977,-26 157977,-78"/>
<text text-anchor="middle" x="157904" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="157904" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="157904" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="157904" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L2_EP1TP1PP0DP1_GPU41 -->
<g id="node772" class="node">
<title>ln2_L2_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="158158.5,-78 158013.5,-78 158013.5,-26 158158.5,-26 158158.5,-78"/>
<text text-anchor="middle" x="158086" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="158086" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="158086" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="158086" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L2_EP1TP1PP0DP1_GPU41 -->
<g id="node773" class="node">
<title>gate_L2_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightyellow" stroke="black" points="158495.16,-104 158256.29,-104 158194.84,0 158433.71,0 158495.16,-104"/>
<text text-anchor="middle" x="158345" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="158345" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="158345" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="158345" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L2_EP1TP1PP0DP1_GPU41 -->
<g id="node774" class="node">
<title>dispatch_L2_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="158634" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="158634" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="158634" y="-44" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP1_GPU41</text>
</g>
<!-- expert_0_L2_EP1TP1PP0DP1_GPU41 -->
<g id="node775" class="node">
<title>expert_0_L2_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="158917.5,-78 158772.5,-78 158772.5,-26 158917.5,-26 158917.5,-78"/>
<text text-anchor="middle" x="158845" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="158845" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="158845" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="158845" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L2_EP1TP1PP0DP1_GPU41 -->
<g id="node776" class="node">
<title>expert_1_L2_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="159098.5,-78 158953.5,-78 158953.5,-26 159098.5,-26 159098.5,-78"/>
<text text-anchor="middle" x="159026" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="159026" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="159026" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="159026" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L2_EP1TP1PP0DP1_GPU41 -->
<g id="node777" class="node">
<title>expert_2_L2_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="159279.5,-78 159134.5,-78 159134.5,-26 159279.5,-26 159279.5,-78"/>
<text text-anchor="middle" x="159207" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="159207" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="159207" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="159207" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L2_EP1TP1PP0DP1_GPU41 -->
<g id="node778" class="node">
<title>expert_3_L2_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="159460.5,-78 159315.5,-78 159315.5,-26 159460.5,-26 159460.5,-78"/>
<text text-anchor="middle" x="159388" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="159388" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="159388" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="159388" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L2_EP1TP1PP0DP1_GPU41 -->
<g id="node779" class="node">
<title>combine_L2_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="159599" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="159599" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="159599" y="-44" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP1_GPU41</text>
</g>
<!-- ffn_L2_EP1TP1PP0DP1_GPU41 -->
<g id="node780" class="node">
<title>ffn_L2_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="159908,-78 159738,-78 159738,-26 159908,-26 159908,-78"/>
<text text-anchor="middle" x="159823" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="159823" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="159823" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="159823" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L2_EP1TP1PP0DP1_GPU41 -->
<g id="node781" class="node">
<title>ffn_ar_L2_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="160047" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="160047" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="160047" y="-49.5" font-family="Arial" font-size="10.00">L2 EP1 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="160047" y="-38.5" font-family="Arial" font-size="10.00">GPU41</text>
</g>
<!-- residual2_L2_EP1TP1PP0DP1_GPU41 -->
<g id="node782" class="node">
<title>residual2_L2_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="160332,-78 160186,-78 160186,-26 160332,-26 160332,-78"/>
<text text-anchor="middle" x="160259" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="160259" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="160259" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="160259" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L2_EP1TP2PP0DP0_GPU48 -->
<g id="node783" class="node">
<title>ln1_L2_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="160513.5,-78 160368.5,-78 160368.5,-26 160513.5,-26 160513.5,-78"/>
<text text-anchor="middle" x="160441" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="160441" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="160441" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="160441" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L2_EP1TP2PP0DP0_GPU48 -->
<g id="node784" class="node">
<title>qkv_L2_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="160694.5,-78 160549.5,-78 160549.5,-26 160694.5,-26 160694.5,-78"/>
<text text-anchor="middle" x="160622" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="160622" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="160622" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="160622" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L2_EP1TP2PP0DP0_GPU48 -->
<g id="node785" class="node">
<title>attn_L2_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="160881.5,-78 160730.5,-78 160730.5,-26 160881.5,-26 160881.5,-78"/>
<text text-anchor="middle" x="160806" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="160806" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="160806" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="160806" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L2_EP1TP2PP0DP0_GPU48 -->
<g id="node786" class="node">
<title>attn_out_L2_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="161062.5,-78 160917.5,-78 160917.5,-26 161062.5,-26 161062.5,-78"/>
<text text-anchor="middle" x="160990" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="160990" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="160990" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="160990" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L2_EP1TP2PP0DP0_GPU48 -->
<g id="node787" class="node">
<title>attn_ar_L2_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="161202" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="161202" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="161202" y="-49.5" font-family="Arial" font-size="10.00">L2 EP1 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="161202" y="-38.5" font-family="Arial" font-size="10.00">GPU48</text>
</g>
<!-- residual1_L2_EP1TP2PP0DP0_GPU48 -->
<g id="node788" class="node">
<title>residual1_L2_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="161487,-78 161341,-78 161341,-26 161487,-26 161487,-78"/>
<text text-anchor="middle" x="161414" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="161414" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="161414" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="161414" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L2_EP1TP2PP0DP0_GPU48 -->
<g id="node789" class="node">
<title>ln2_L2_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="161668.5,-78 161523.5,-78 161523.5,-26 161668.5,-26 161668.5,-78"/>
<text text-anchor="middle" x="161596" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="161596" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="161596" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="161596" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L2_EP1TP2PP0DP0_GPU48 -->
<g id="node790" class="node">
<title>gate_L2_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightyellow" stroke="black" points="162005.16,-104 161766.29,-104 161704.84,0 161943.71,0 162005.16,-104"/>
<text text-anchor="middle" x="161855" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="161855" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="161855" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="161855" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L2_EP1TP2PP0DP0_GPU48 -->
<g id="node791" class="node">
<title>dispatch_L2_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="162144" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="162144" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="162144" y="-44" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP0_GPU48</text>
</g>
<!-- expert_0_L2_EP1TP2PP0DP0_GPU48 -->
<g id="node792" class="node">
<title>expert_0_L2_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="162427.5,-78 162282.5,-78 162282.5,-26 162427.5,-26 162427.5,-78"/>
<text text-anchor="middle" x="162355" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="162355" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="162355" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="162355" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L2_EP1TP2PP0DP0_GPU48 -->
<g id="node793" class="node">
<title>expert_1_L2_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="162608.5,-78 162463.5,-78 162463.5,-26 162608.5,-26 162608.5,-78"/>
<text text-anchor="middle" x="162536" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="162536" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="162536" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="162536" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L2_EP1TP2PP0DP0_GPU48 -->
<g id="node794" class="node">
<title>expert_2_L2_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="162789.5,-78 162644.5,-78 162644.5,-26 162789.5,-26 162789.5,-78"/>
<text text-anchor="middle" x="162717" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="162717" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="162717" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="162717" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L2_EP1TP2PP0DP0_GPU48 -->
<g id="node795" class="node">
<title>expert_3_L2_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="162970.5,-78 162825.5,-78 162825.5,-26 162970.5,-26 162970.5,-78"/>
<text text-anchor="middle" x="162898" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="162898" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="162898" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="162898" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L2_EP1TP2PP0DP0_GPU48 -->
<g id="node796" class="node">
<title>combine_L2_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="163109" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="163109" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="163109" y="-44" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP0_GPU48</text>
</g>
<!-- ffn_L2_EP1TP2PP0DP0_GPU48 -->
<g id="node797" class="node">
<title>ffn_L2_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="163418,-78 163248,-78 163248,-26 163418,-26 163418,-78"/>
<text text-anchor="middle" x="163333" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="163333" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="163333" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="163333" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L2_EP1TP2PP0DP0_GPU48 -->
<g id="node798" class="node">
<title>ffn_ar_L2_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="163557" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="163557" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="163557" y="-49.5" font-family="Arial" font-size="10.00">L2 EP1 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="163557" y="-38.5" font-family="Arial" font-size="10.00">GPU48</text>
</g>
<!-- residual2_L2_EP1TP2PP0DP0_GPU48 -->
<g id="node799" class="node">
<title>residual2_L2_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="163842,-78 163696,-78 163696,-26 163842,-26 163842,-78"/>
<text text-anchor="middle" x="163769" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="163769" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="163769" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="163769" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L2_EP1TP2PP0DP1_GPU49 -->
<g id="node800" class="node">
<title>ln1_L2_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="164023.5,-78 163878.5,-78 163878.5,-26 164023.5,-26 164023.5,-78"/>
<text text-anchor="middle" x="163951" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="163951" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="163951" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="163951" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L2_EP1TP2PP0DP1_GPU49 -->
<g id="node801" class="node">
<title>qkv_L2_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="164204.5,-78 164059.5,-78 164059.5,-26 164204.5,-26 164204.5,-78"/>
<text text-anchor="middle" x="164132" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="164132" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="164132" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="164132" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L2_EP1TP2PP0DP1_GPU49 -->
<g id="node802" class="node">
<title>attn_L2_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="164391.5,-78 164240.5,-78 164240.5,-26 164391.5,-26 164391.5,-78"/>
<text text-anchor="middle" x="164316" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="164316" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="164316" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="164316" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L2_EP1TP2PP0DP1_GPU49 -->
<g id="node803" class="node">
<title>attn_out_L2_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="164572.5,-78 164427.5,-78 164427.5,-26 164572.5,-26 164572.5,-78"/>
<text text-anchor="middle" x="164500" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="164500" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="164500" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="164500" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L2_EP1TP2PP0DP1_GPU49 -->
<g id="node804" class="node">
<title>attn_ar_L2_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="164712" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="164712" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="164712" y="-49.5" font-family="Arial" font-size="10.00">L2 EP1 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="164712" y="-38.5" font-family="Arial" font-size="10.00">GPU49</text>
</g>
<!-- residual1_L2_EP1TP2PP0DP1_GPU49 -->
<g id="node805" class="node">
<title>residual1_L2_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="164997,-78 164851,-78 164851,-26 164997,-26 164997,-78"/>
<text text-anchor="middle" x="164924" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="164924" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="164924" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="164924" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L2_EP1TP2PP0DP1_GPU49 -->
<g id="node806" class="node">
<title>ln2_L2_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="165178.5,-78 165033.5,-78 165033.5,-26 165178.5,-26 165178.5,-78"/>
<text text-anchor="middle" x="165106" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="165106" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="165106" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="165106" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L2_EP1TP2PP0DP1_GPU49 -->
<g id="node807" class="node">
<title>gate_L2_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightyellow" stroke="black" points="165515.16,-104 165276.29,-104 165214.84,0 165453.71,0 165515.16,-104"/>
<text text-anchor="middle" x="165365" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="165365" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="165365" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="165365" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L2_EP1TP2PP0DP1_GPU49 -->
<g id="node808" class="node">
<title>dispatch_L2_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="165654" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="165654" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="165654" y="-44" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP1_GPU49</text>
</g>
<!-- expert_0_L2_EP1TP2PP0DP1_GPU49 -->
<g id="node809" class="node">
<title>expert_0_L2_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="165937.5,-78 165792.5,-78 165792.5,-26 165937.5,-26 165937.5,-78"/>
<text text-anchor="middle" x="165865" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="165865" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="165865" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="165865" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L2_EP1TP2PP0DP1_GPU49 -->
<g id="node810" class="node">
<title>expert_1_L2_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="166118.5,-78 165973.5,-78 165973.5,-26 166118.5,-26 166118.5,-78"/>
<text text-anchor="middle" x="166046" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="166046" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="166046" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="166046" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L2_EP1TP2PP0DP1_GPU49 -->
<g id="node811" class="node">
<title>expert_2_L2_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="166299.5,-78 166154.5,-78 166154.5,-26 166299.5,-26 166299.5,-78"/>
<text text-anchor="middle" x="166227" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="166227" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="166227" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="166227" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L2_EP1TP2PP0DP1_GPU49 -->
<g id="node812" class="node">
<title>expert_3_L2_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="166480.5,-78 166335.5,-78 166335.5,-26 166480.5,-26 166480.5,-78"/>
<text text-anchor="middle" x="166408" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="166408" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="166408" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="166408" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L2_EP1TP2PP0DP1_GPU49 -->
<g id="node813" class="node">
<title>combine_L2_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="166619" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="166619" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="166619" y="-44" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP1_GPU49</text>
</g>
<!-- ffn_L2_EP1TP2PP0DP1_GPU49 -->
<g id="node814" class="node">
<title>ffn_L2_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="166928,-78 166758,-78 166758,-26 166928,-26 166928,-78"/>
<text text-anchor="middle" x="166843" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="166843" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="166843" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="166843" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L2_EP1TP2PP0DP1_GPU49 -->
<g id="node815" class="node">
<title>ffn_ar_L2_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="167067" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="167067" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="167067" y="-49.5" font-family="Arial" font-size="10.00">L2 EP1 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="167067" y="-38.5" font-family="Arial" font-size="10.00">GPU49</text>
</g>
<!-- residual2_L2_EP1TP2PP0DP1_GPU49 -->
<g id="node816" class="node">
<title>residual2_L2_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="167352,-78 167206,-78 167206,-26 167352,-26 167352,-78"/>
<text text-anchor="middle" x="167279" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="167279" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="167279" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="167279" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L2_EP1TP3PP0DP0_GPU56 -->
<g id="node817" class="node">
<title>ln1_L2_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="167533.5,-78 167388.5,-78 167388.5,-26 167533.5,-26 167533.5,-78"/>
<text text-anchor="middle" x="167461" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="167461" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="167461" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="167461" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L2_EP1TP3PP0DP0_GPU56 -->
<g id="node818" class="node">
<title>qkv_L2_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="167714.5,-78 167569.5,-78 167569.5,-26 167714.5,-26 167714.5,-78"/>
<text text-anchor="middle" x="167642" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="167642" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="167642" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="167642" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L2_EP1TP3PP0DP0_GPU56 -->
<g id="node819" class="node">
<title>attn_L2_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="167901.5,-78 167750.5,-78 167750.5,-26 167901.5,-26 167901.5,-78"/>
<text text-anchor="middle" x="167826" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="167826" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="167826" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="167826" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L2_EP1TP3PP0DP0_GPU56 -->
<g id="node820" class="node">
<title>attn_out_L2_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="168082.5,-78 167937.5,-78 167937.5,-26 168082.5,-26 168082.5,-78"/>
<text text-anchor="middle" x="168010" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="168010" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="168010" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="168010" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L2_EP1TP3PP0DP0_GPU56 -->
<g id="node821" class="node">
<title>attn_ar_L2_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="168222" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="168222" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="168222" y="-49.5" font-family="Arial" font-size="10.00">L2 EP1 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="168222" y="-38.5" font-family="Arial" font-size="10.00">GPU56</text>
</g>
<!-- residual1_L2_EP1TP3PP0DP0_GPU56 -->
<g id="node822" class="node">
<title>residual1_L2_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="168507,-78 168361,-78 168361,-26 168507,-26 168507,-78"/>
<text text-anchor="middle" x="168434" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="168434" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="168434" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="168434" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L2_EP1TP3PP0DP0_GPU56 -->
<g id="node823" class="node">
<title>ln2_L2_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="168688.5,-78 168543.5,-78 168543.5,-26 168688.5,-26 168688.5,-78"/>
<text text-anchor="middle" x="168616" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="168616" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="168616" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="168616" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L2_EP1TP3PP0DP0_GPU56 -->
<g id="node824" class="node">
<title>gate_L2_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightyellow" stroke="black" points="169025.16,-104 168786.29,-104 168724.84,0 168963.71,0 169025.16,-104"/>
<text text-anchor="middle" x="168875" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="168875" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="168875" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="168875" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L2_EP1TP3PP0DP0_GPU56 -->
<g id="node825" class="node">
<title>dispatch_L2_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="169164" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="169164" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="169164" y="-44" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP0_GPU56</text>
</g>
<!-- expert_0_L2_EP1TP3PP0DP0_GPU56 -->
<g id="node826" class="node">
<title>expert_0_L2_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="169447.5,-78 169302.5,-78 169302.5,-26 169447.5,-26 169447.5,-78"/>
<text text-anchor="middle" x="169375" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="169375" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="169375" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="169375" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L2_EP1TP3PP0DP0_GPU56 -->
<g id="node827" class="node">
<title>expert_1_L2_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="169628.5,-78 169483.5,-78 169483.5,-26 169628.5,-26 169628.5,-78"/>
<text text-anchor="middle" x="169556" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="169556" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="169556" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="169556" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L2_EP1TP3PP0DP0_GPU56 -->
<g id="node828" class="node">
<title>expert_2_L2_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="169809.5,-78 169664.5,-78 169664.5,-26 169809.5,-26 169809.5,-78"/>
<text text-anchor="middle" x="169737" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="169737" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="169737" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="169737" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L2_EP1TP3PP0DP0_GPU56 -->
<g id="node829" class="node">
<title>expert_3_L2_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="169990.5,-78 169845.5,-78 169845.5,-26 169990.5,-26 169990.5,-78"/>
<text text-anchor="middle" x="169918" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="169918" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="169918" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="169918" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L2_EP1TP3PP0DP0_GPU56 -->
<g id="node830" class="node">
<title>combine_L2_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="170129" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="170129" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="170129" y="-44" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP0_GPU56</text>
</g>
<!-- ffn_L2_EP1TP3PP0DP0_GPU56 -->
<g id="node831" class="node">
<title>ffn_L2_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="170438,-78 170268,-78 170268,-26 170438,-26 170438,-78"/>
<text text-anchor="middle" x="170353" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="170353" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="170353" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="170353" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L2_EP1TP3PP0DP0_GPU56 -->
<g id="node832" class="node">
<title>ffn_ar_L2_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="170577" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="170577" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="170577" y="-49.5" font-family="Arial" font-size="10.00">L2 EP1 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="170577" y="-38.5" font-family="Arial" font-size="10.00">GPU56</text>
</g>
<!-- residual2_L2_EP1TP3PP0DP0_GPU56 -->
<g id="node833" class="node">
<title>residual2_L2_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="170862,-78 170716,-78 170716,-26 170862,-26 170862,-78"/>
<text text-anchor="middle" x="170789" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="170789" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="170789" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="170789" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L2_EP1TP3PP0DP1_GPU57 -->
<g id="node834" class="node">
<title>ln1_L2_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="171043.5,-78 170898.5,-78 170898.5,-26 171043.5,-26 171043.5,-78"/>
<text text-anchor="middle" x="170971" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="170971" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="170971" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="170971" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L2_EP1TP3PP0DP1_GPU57 -->
<g id="node835" class="node">
<title>qkv_L2_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="171224.5,-78 171079.5,-78 171079.5,-26 171224.5,-26 171224.5,-78"/>
<text text-anchor="middle" x="171152" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="171152" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="171152" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="171152" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L2_EP1TP3PP0DP1_GPU57 -->
<g id="node836" class="node">
<title>attn_L2_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="171411.5,-78 171260.5,-78 171260.5,-26 171411.5,-26 171411.5,-78"/>
<text text-anchor="middle" x="171336" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="171336" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="171336" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="171336" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L2_EP1TP3PP0DP1_GPU57 -->
<g id="node837" class="node">
<title>attn_out_L2_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="171592.5,-78 171447.5,-78 171447.5,-26 171592.5,-26 171592.5,-78"/>
<text text-anchor="middle" x="171520" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="171520" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="171520" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="171520" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L2_EP1TP3PP0DP1_GPU57 -->
<g id="node838" class="node">
<title>attn_ar_L2_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="171732" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="171732" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="171732" y="-49.5" font-family="Arial" font-size="10.00">L2 EP1 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="171732" y="-38.5" font-family="Arial" font-size="10.00">GPU57</text>
</g>
<!-- residual1_L2_EP1TP3PP0DP1_GPU57 -->
<g id="node839" class="node">
<title>residual1_L2_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="172017,-78 171871,-78 171871,-26 172017,-26 172017,-78"/>
<text text-anchor="middle" x="171944" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="171944" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="171944" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="171944" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L2_EP1TP3PP0DP1_GPU57 -->
<g id="node840" class="node">
<title>ln2_L2_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="172198.5,-78 172053.5,-78 172053.5,-26 172198.5,-26 172198.5,-78"/>
<text text-anchor="middle" x="172126" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="172126" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="172126" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="172126" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L2_EP1TP3PP0DP1_GPU57 -->
<g id="node841" class="node">
<title>gate_L2_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightyellow" stroke="black" points="172535.16,-104 172296.29,-104 172234.84,0 172473.71,0 172535.16,-104"/>
<text text-anchor="middle" x="172385" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="172385" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="172385" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="172385" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L2_EP1TP3PP0DP1_GPU57 -->
<g id="node842" class="node">
<title>dispatch_L2_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="172674" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="172674" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="172674" y="-44" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP1_GPU57</text>
</g>
<!-- expert_0_L2_EP1TP3PP0DP1_GPU57 -->
<g id="node843" class="node">
<title>expert_0_L2_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="172957.5,-78 172812.5,-78 172812.5,-26 172957.5,-26 172957.5,-78"/>
<text text-anchor="middle" x="172885" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="172885" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="172885" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="172885" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L2_EP1TP3PP0DP1_GPU57 -->
<g id="node844" class="node">
<title>expert_1_L2_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="173138.5,-78 172993.5,-78 172993.5,-26 173138.5,-26 173138.5,-78"/>
<text text-anchor="middle" x="173066" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="173066" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="173066" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="173066" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L2_EP1TP3PP0DP1_GPU57 -->
<g id="node845" class="node">
<title>expert_2_L2_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="173319.5,-78 173174.5,-78 173174.5,-26 173319.5,-26 173319.5,-78"/>
<text text-anchor="middle" x="173247" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="173247" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="173247" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="173247" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L2_EP1TP3PP0DP1_GPU57 -->
<g id="node846" class="node">
<title>expert_3_L2_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="173500.5,-78 173355.5,-78 173355.5,-26 173500.5,-26 173500.5,-78"/>
<text text-anchor="middle" x="173428" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="173428" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="173428" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="173428" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L2_EP1TP3PP0DP1_GPU57 -->
<g id="node847" class="node">
<title>combine_L2_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="173639" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="173639" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="173639" y="-44" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP1_GPU57</text>
</g>
<!-- ffn_L2_EP1TP3PP0DP1_GPU57 -->
<g id="node848" class="node">
<title>ffn_L2_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="173948,-78 173778,-78 173778,-26 173948,-26 173948,-78"/>
<text text-anchor="middle" x="173863" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="173863" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="173863" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="173863" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L2_EP1TP3PP0DP1_GPU57 -->
<g id="node849" class="node">
<title>ffn_ar_L2_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="174087" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="174087" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="174087" y="-49.5" font-family="Arial" font-size="10.00">L2 EP1 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="174087" y="-38.5" font-family="Arial" font-size="10.00">GPU57</text>
</g>
<!-- residual2_L2_EP1TP3PP0DP1_GPU57 -->
<g id="node850" class="node">
<title>residual2_L2_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="174372,-78 174226,-78 174226,-26 174372,-26 174372,-78"/>
<text text-anchor="middle" x="174299" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="174299" y="-55" font-family="Arial" font-size="10.00">L2_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="174299" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="174299" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L3_EP0TP0PP0DP0_GPU0 -->
<g id="node851" class="node">
<title>ln1_L3_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="174550,-78 174408,-78 174408,-26 174550,-26 174550,-78"/>
<text text-anchor="middle" x="174479" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="174479" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="174479" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="174479" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L3_EP0TP0PP0DP0_GPU0 -->
<g id="node852" class="node">
<title>qkv_L3_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="174728,-78 174586,-78 174586,-26 174728,-26 174728,-78"/>
<text text-anchor="middle" x="174657" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="174657" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="174657" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="174657" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L3_EP0TP0PP0DP0_GPU0 -->
<g id="node853" class="node">
<title>attn_L3_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="174915.5,-78 174764.5,-78 174764.5,-26 174915.5,-26 174915.5,-78"/>
<text text-anchor="middle" x="174840" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="174840" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="174840" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="174840" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L3_EP0TP0PP0DP0_GPU0 -->
<g id="node854" class="node">
<title>attn_out_L3_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="175094,-78 174952,-78 174952,-26 175094,-26 175094,-78"/>
<text text-anchor="middle" x="175023" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="175023" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="175023" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="175023" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L3_EP0TP0PP0DP0_GPU0 -->
<g id="node855" class="node">
<title>attn_ar_L3_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="175233" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="175233" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="175233" y="-49.5" font-family="Arial" font-size="10.00">L3 EP0 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="175233" y="-38.5" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- residual1_L3_EP0TP0PP0DP0_GPU0 -->
<g id="node856" class="node">
<title>residual1_L3_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="175518,-78 175372,-78 175372,-26 175518,-26 175518,-78"/>
<text text-anchor="middle" x="175445" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="175445" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="175445" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="175445" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L3_EP0TP0PP0DP0_GPU0 -->
<g id="node857" class="node">
<title>ln2_L3_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="175696,-78 175554,-78 175554,-26 175696,-26 175696,-78"/>
<text text-anchor="middle" x="175625" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="175625" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="175625" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="175625" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L3_EP0TP0PP0DP0_GPU0 -->
<g id="node858" class="node">
<title>gate_L3_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightyellow" stroke="black" points="176022.29,-104 175791.17,-104 175731.71,0 175962.83,0 176022.29,-104"/>
<text text-anchor="middle" x="175877" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="175877" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="175877" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="175877" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L3_EP0TP0PP0DP0_GPU0 -->
<g id="node859" class="node">
<title>dispatch_L3_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="176157" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="176157" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="176157" y="-44" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP0_GPU0</text>
</g>
<!-- expert_0_L3_EP0TP0PP0DP0_GPU0 -->
<g id="node860" class="node">
<title>expert_0_L3_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="176432,-78 176292,-78 176292,-26 176432,-26 176432,-78"/>
<text text-anchor="middle" x="176362" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="176362" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="176362" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="176362" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L3_EP0TP0PP0DP0_GPU0 -->
<g id="node861" class="node">
<title>expert_1_L3_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="176608,-78 176468,-78 176468,-26 176608,-26 176608,-78"/>
<text text-anchor="middle" x="176538" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="176538" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="176538" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="176538" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L3_EP0TP0PP0DP0_GPU0 -->
<g id="node862" class="node">
<title>expert_2_L3_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="176784,-78 176644,-78 176644,-26 176784,-26 176784,-78"/>
<text text-anchor="middle" x="176714" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="176714" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="176714" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="176714" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L3_EP0TP0PP0DP0_GPU0 -->
<g id="node863" class="node">
<title>expert_3_L3_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="176960,-78 176820,-78 176820,-26 176960,-26 176960,-78"/>
<text text-anchor="middle" x="176890" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="176890" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="176890" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="176890" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L3_EP0TP0PP0DP0_GPU0 -->
<g id="node864" class="node">
<title>combine_L3_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="177095" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="177095" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="177095" y="-44" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP0_GPU0</text>
</g>
<!-- ffn_L3_EP0TP0PP0DP0_GPU0 -->
<g id="node865" class="node">
<title>ffn_L3_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="177400,-78 177230,-78 177230,-26 177400,-26 177400,-78"/>
<text text-anchor="middle" x="177315" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="177315" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="177315" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="177315" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L3_EP0TP0PP0DP0_GPU0 -->
<g id="node866" class="node">
<title>ffn_ar_L3_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="177539" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="177539" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="177539" y="-49.5" font-family="Arial" font-size="10.00">L3 EP0 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="177539" y="-38.5" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- residual2_L3_EP0TP0PP0DP0_GPU0 -->
<g id="node867" class="node">
<title>residual2_L3_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="177824,-78 177678,-78 177678,-26 177824,-26 177824,-78"/>
<text text-anchor="middle" x="177751" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="177751" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="177751" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="177751" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L3_EP0TP0PP0DP1_GPU1 -->
<g id="node868" class="node">
<title>ln1_L3_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="178002,-78 177860,-78 177860,-26 178002,-26 178002,-78"/>
<text text-anchor="middle" x="177931" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="177931" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="177931" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="177931" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L3_EP0TP0PP0DP1_GPU1 -->
<g id="node869" class="node">
<title>qkv_L3_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="178180,-78 178038,-78 178038,-26 178180,-26 178180,-78"/>
<text text-anchor="middle" x="178109" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="178109" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="178109" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="178109" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L3_EP0TP0PP0DP1_GPU1 -->
<g id="node870" class="node">
<title>attn_L3_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="178367.5,-78 178216.5,-78 178216.5,-26 178367.5,-26 178367.5,-78"/>
<text text-anchor="middle" x="178292" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="178292" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="178292" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="178292" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L3_EP0TP0PP0DP1_GPU1 -->
<g id="node871" class="node">
<title>attn_out_L3_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="178546,-78 178404,-78 178404,-26 178546,-26 178546,-78"/>
<text text-anchor="middle" x="178475" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="178475" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="178475" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="178475" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L3_EP0TP0PP0DP1_GPU1 -->
<g id="node872" class="node">
<title>attn_ar_L3_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="178685" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="178685" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="178685" y="-49.5" font-family="Arial" font-size="10.00">L3 EP0 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="178685" y="-38.5" font-family="Arial" font-size="10.00">GPU1</text>
</g>
<!-- residual1_L3_EP0TP0PP0DP1_GPU1 -->
<g id="node873" class="node">
<title>residual1_L3_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="178970,-78 178824,-78 178824,-26 178970,-26 178970,-78"/>
<text text-anchor="middle" x="178897" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="178897" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="178897" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="178897" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L3_EP0TP0PP0DP1_GPU1 -->
<g id="node874" class="node">
<title>ln2_L3_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="179148,-78 179006,-78 179006,-26 179148,-26 179148,-78"/>
<text text-anchor="middle" x="179077" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="179077" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="179077" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="179077" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L3_EP0TP0PP0DP1_GPU1 -->
<g id="node875" class="node">
<title>gate_L3_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightyellow" stroke="black" points="179474.29,-104 179243.17,-104 179183.71,0 179414.83,0 179474.29,-104"/>
<text text-anchor="middle" x="179329" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="179329" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="179329" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="179329" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L3_EP0TP0PP0DP1_GPU1 -->
<g id="node876" class="node">
<title>dispatch_L3_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="179609" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="179609" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="179609" y="-44" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP1_GPU1</text>
</g>
<!-- expert_0_L3_EP0TP0PP0DP1_GPU1 -->
<g id="node877" class="node">
<title>expert_0_L3_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="179884,-78 179744,-78 179744,-26 179884,-26 179884,-78"/>
<text text-anchor="middle" x="179814" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="179814" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="179814" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="179814" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L3_EP0TP0PP0DP1_GPU1 -->
<g id="node878" class="node">
<title>expert_1_L3_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="180060,-78 179920,-78 179920,-26 180060,-26 180060,-78"/>
<text text-anchor="middle" x="179990" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="179990" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="179990" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="179990" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L3_EP0TP0PP0DP1_GPU1 -->
<g id="node879" class="node">
<title>expert_2_L3_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="180236,-78 180096,-78 180096,-26 180236,-26 180236,-78"/>
<text text-anchor="middle" x="180166" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="180166" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="180166" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="180166" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L3_EP0TP0PP0DP1_GPU1 -->
<g id="node880" class="node">
<title>expert_3_L3_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="180412,-78 180272,-78 180272,-26 180412,-26 180412,-78"/>
<text text-anchor="middle" x="180342" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="180342" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="180342" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="180342" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L3_EP0TP0PP0DP1_GPU1 -->
<g id="node881" class="node">
<title>combine_L3_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="180547" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="180547" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="180547" y="-44" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP1_GPU1</text>
</g>
<!-- ffn_L3_EP0TP0PP0DP1_GPU1 -->
<g id="node882" class="node">
<title>ffn_L3_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="180852,-78 180682,-78 180682,-26 180852,-26 180852,-78"/>
<text text-anchor="middle" x="180767" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="180767" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="180767" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="180767" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L3_EP0TP0PP0DP1_GPU1 -->
<g id="node883" class="node">
<title>ffn_ar_L3_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="180991" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="180991" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="180991" y="-49.5" font-family="Arial" font-size="10.00">L3 EP0 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="180991" y="-38.5" font-family="Arial" font-size="10.00">GPU1</text>
</g>
<!-- residual2_L3_EP0TP0PP0DP1_GPU1 -->
<g id="node884" class="node">
<title>residual2_L3_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="181276,-78 181130,-78 181130,-26 181276,-26 181276,-78"/>
<text text-anchor="middle" x="181203" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="181203" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="181203" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="181203" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L3_EP0TP1PP0DP0_GPU8 -->
<g id="node885" class="node">
<title>ln1_L3_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="181454,-78 181312,-78 181312,-26 181454,-26 181454,-78"/>
<text text-anchor="middle" x="181383" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="181383" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="181383" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="181383" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L3_EP0TP1PP0DP0_GPU8 -->
<g id="node886" class="node">
<title>qkv_L3_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="181632,-78 181490,-78 181490,-26 181632,-26 181632,-78"/>
<text text-anchor="middle" x="181561" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="181561" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="181561" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="181561" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L3_EP0TP1PP0DP0_GPU8 -->
<g id="node887" class="node">
<title>attn_L3_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="181819.5,-78 181668.5,-78 181668.5,-26 181819.5,-26 181819.5,-78"/>
<text text-anchor="middle" x="181744" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="181744" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="181744" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="181744" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L3_EP0TP1PP0DP0_GPU8 -->
<g id="node888" class="node">
<title>attn_out_L3_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="181998,-78 181856,-78 181856,-26 181998,-26 181998,-78"/>
<text text-anchor="middle" x="181927" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="181927" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="181927" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="181927" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L3_EP0TP1PP0DP0_GPU8 -->
<g id="node889" class="node">
<title>attn_ar_L3_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="182137" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="182137" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="182137" y="-49.5" font-family="Arial" font-size="10.00">L3 EP0 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="182137" y="-38.5" font-family="Arial" font-size="10.00">GPU8</text>
</g>
<!-- residual1_L3_EP0TP1PP0DP0_GPU8 -->
<g id="node890" class="node">
<title>residual1_L3_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="182422,-78 182276,-78 182276,-26 182422,-26 182422,-78"/>
<text text-anchor="middle" x="182349" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="182349" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="182349" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="182349" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L3_EP0TP1PP0DP0_GPU8 -->
<g id="node891" class="node">
<title>ln2_L3_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="182600,-78 182458,-78 182458,-26 182600,-26 182600,-78"/>
<text text-anchor="middle" x="182529" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="182529" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="182529" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="182529" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L3_EP0TP1PP0DP0_GPU8 -->
<g id="node892" class="node">
<title>gate_L3_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightyellow" stroke="black" points="182926.29,-104 182695.17,-104 182635.71,0 182866.83,0 182926.29,-104"/>
<text text-anchor="middle" x="182781" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="182781" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="182781" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="182781" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L3_EP0TP1PP0DP0_GPU8 -->
<g id="node893" class="node">
<title>dispatch_L3_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="183061" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="183061" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="183061" y="-44" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP0_GPU8</text>
</g>
<!-- expert_0_L3_EP0TP1PP0DP0_GPU8 -->
<g id="node894" class="node">
<title>expert_0_L3_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="183336,-78 183196,-78 183196,-26 183336,-26 183336,-78"/>
<text text-anchor="middle" x="183266" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="183266" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="183266" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="183266" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L3_EP0TP1PP0DP0_GPU8 -->
<g id="node895" class="node">
<title>expert_1_L3_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="183512,-78 183372,-78 183372,-26 183512,-26 183512,-78"/>
<text text-anchor="middle" x="183442" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="183442" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="183442" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="183442" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L3_EP0TP1PP0DP0_GPU8 -->
<g id="node896" class="node">
<title>expert_2_L3_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="183688,-78 183548,-78 183548,-26 183688,-26 183688,-78"/>
<text text-anchor="middle" x="183618" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="183618" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="183618" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="183618" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L3_EP0TP1PP0DP0_GPU8 -->
<g id="node897" class="node">
<title>expert_3_L3_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="183864,-78 183724,-78 183724,-26 183864,-26 183864,-78"/>
<text text-anchor="middle" x="183794" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="183794" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="183794" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="183794" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L3_EP0TP1PP0DP0_GPU8 -->
<g id="node898" class="node">
<title>combine_L3_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="183999" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="183999" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="183999" y="-44" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP0_GPU8</text>
</g>
<!-- ffn_L3_EP0TP1PP0DP0_GPU8 -->
<g id="node899" class="node">
<title>ffn_L3_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="184304,-78 184134,-78 184134,-26 184304,-26 184304,-78"/>
<text text-anchor="middle" x="184219" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="184219" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="184219" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="184219" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L3_EP0TP1PP0DP0_GPU8 -->
<g id="node900" class="node">
<title>ffn_ar_L3_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="184443" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="184443" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="184443" y="-49.5" font-family="Arial" font-size="10.00">L3 EP0 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="184443" y="-38.5" font-family="Arial" font-size="10.00">GPU8</text>
</g>
<!-- residual2_L3_EP0TP1PP0DP0_GPU8 -->
<g id="node901" class="node">
<title>residual2_L3_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="184728,-78 184582,-78 184582,-26 184728,-26 184728,-78"/>
<text text-anchor="middle" x="184655" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="184655" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="184655" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="184655" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L3_EP0TP1PP0DP1_GPU9 -->
<g id="node902" class="node">
<title>ln1_L3_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="184906,-78 184764,-78 184764,-26 184906,-26 184906,-78"/>
<text text-anchor="middle" x="184835" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="184835" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="184835" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="184835" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L3_EP0TP1PP0DP1_GPU9 -->
<g id="node903" class="node">
<title>qkv_L3_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="185084,-78 184942,-78 184942,-26 185084,-26 185084,-78"/>
<text text-anchor="middle" x="185013" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="185013" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="185013" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="185013" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L3_EP0TP1PP0DP1_GPU9 -->
<g id="node904" class="node">
<title>attn_L3_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="185271.5,-78 185120.5,-78 185120.5,-26 185271.5,-26 185271.5,-78"/>
<text text-anchor="middle" x="185196" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="185196" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="185196" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="185196" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L3_EP0TP1PP0DP1_GPU9 -->
<g id="node905" class="node">
<title>attn_out_L3_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="185450,-78 185308,-78 185308,-26 185450,-26 185450,-78"/>
<text text-anchor="middle" x="185379" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="185379" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="185379" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="185379" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L3_EP0TP1PP0DP1_GPU9 -->
<g id="node906" class="node">
<title>attn_ar_L3_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="185589" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="185589" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="185589" y="-49.5" font-family="Arial" font-size="10.00">L3 EP0 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="185589" y="-38.5" font-family="Arial" font-size="10.00">GPU9</text>
</g>
<!-- residual1_L3_EP0TP1PP0DP1_GPU9 -->
<g id="node907" class="node">
<title>residual1_L3_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="185874,-78 185728,-78 185728,-26 185874,-26 185874,-78"/>
<text text-anchor="middle" x="185801" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="185801" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="185801" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="185801" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L3_EP0TP1PP0DP1_GPU9 -->
<g id="node908" class="node">
<title>ln2_L3_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="186052,-78 185910,-78 185910,-26 186052,-26 186052,-78"/>
<text text-anchor="middle" x="185981" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="185981" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="185981" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="185981" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L3_EP0TP1PP0DP1_GPU9 -->
<g id="node909" class="node">
<title>gate_L3_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightyellow" stroke="black" points="186378.29,-104 186147.17,-104 186087.71,0 186318.83,0 186378.29,-104"/>
<text text-anchor="middle" x="186233" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="186233" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="186233" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="186233" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L3_EP0TP1PP0DP1_GPU9 -->
<g id="node910" class="node">
<title>dispatch_L3_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="186513" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="186513" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="186513" y="-44" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP1_GPU9</text>
</g>
<!-- expert_0_L3_EP0TP1PP0DP1_GPU9 -->
<g id="node911" class="node">
<title>expert_0_L3_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="186788,-78 186648,-78 186648,-26 186788,-26 186788,-78"/>
<text text-anchor="middle" x="186718" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="186718" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="186718" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="186718" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L3_EP0TP1PP0DP1_GPU9 -->
<g id="node912" class="node">
<title>expert_1_L3_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="186964,-78 186824,-78 186824,-26 186964,-26 186964,-78"/>
<text text-anchor="middle" x="186894" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="186894" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="186894" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="186894" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L3_EP0TP1PP0DP1_GPU9 -->
<g id="node913" class="node">
<title>expert_2_L3_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="187140,-78 187000,-78 187000,-26 187140,-26 187140,-78"/>
<text text-anchor="middle" x="187070" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="187070" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="187070" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="187070" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L3_EP0TP1PP0DP1_GPU9 -->
<g id="node914" class="node">
<title>expert_3_L3_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="187316,-78 187176,-78 187176,-26 187316,-26 187316,-78"/>
<text text-anchor="middle" x="187246" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="187246" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="187246" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="187246" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L3_EP0TP1PP0DP1_GPU9 -->
<g id="node915" class="node">
<title>combine_L3_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="187451" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="187451" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="187451" y="-44" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP1_GPU9</text>
</g>
<!-- ffn_L3_EP0TP1PP0DP1_GPU9 -->
<g id="node916" class="node">
<title>ffn_L3_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="187756,-78 187586,-78 187586,-26 187756,-26 187756,-78"/>
<text text-anchor="middle" x="187671" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="187671" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="187671" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="187671" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L3_EP0TP1PP0DP1_GPU9 -->
<g id="node917" class="node">
<title>ffn_ar_L3_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="187895" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="187895" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="187895" y="-49.5" font-family="Arial" font-size="10.00">L3 EP0 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="187895" y="-38.5" font-family="Arial" font-size="10.00">GPU9</text>
</g>
<!-- residual2_L3_EP0TP1PP0DP1_GPU9 -->
<g id="node918" class="node">
<title>residual2_L3_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="188180,-78 188034,-78 188034,-26 188180,-26 188180,-78"/>
<text text-anchor="middle" x="188107" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="188107" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="188107" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="188107" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L3_EP0TP2PP0DP0_GPU16 -->
<g id="node919" class="node">
<title>ln1_L3_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="188361.5,-78 188216.5,-78 188216.5,-26 188361.5,-26 188361.5,-78"/>
<text text-anchor="middle" x="188289" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="188289" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="188289" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="188289" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L3_EP0TP2PP0DP0_GPU16 -->
<g id="node920" class="node">
<title>qkv_L3_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="188542.5,-78 188397.5,-78 188397.5,-26 188542.5,-26 188542.5,-78"/>
<text text-anchor="middle" x="188470" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="188470" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="188470" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="188470" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L3_EP0TP2PP0DP0_GPU16 -->
<g id="node921" class="node">
<title>attn_L3_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="188729.5,-78 188578.5,-78 188578.5,-26 188729.5,-26 188729.5,-78"/>
<text text-anchor="middle" x="188654" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="188654" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="188654" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="188654" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L3_EP0TP2PP0DP0_GPU16 -->
<g id="node922" class="node">
<title>attn_out_L3_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="188910.5,-78 188765.5,-78 188765.5,-26 188910.5,-26 188910.5,-78"/>
<text text-anchor="middle" x="188838" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="188838" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="188838" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="188838" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L3_EP0TP2PP0DP0_GPU16 -->
<g id="node923" class="node">
<title>attn_ar_L3_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="189050" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="189050" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="189050" y="-49.5" font-family="Arial" font-size="10.00">L3 EP0 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="189050" y="-38.5" font-family="Arial" font-size="10.00">GPU16</text>
</g>
<!-- residual1_L3_EP0TP2PP0DP0_GPU16 -->
<g id="node924" class="node">
<title>residual1_L3_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="189335,-78 189189,-78 189189,-26 189335,-26 189335,-78"/>
<text text-anchor="middle" x="189262" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="189262" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="189262" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="189262" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L3_EP0TP2PP0DP0_GPU16 -->
<g id="node925" class="node">
<title>ln2_L3_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="189516.5,-78 189371.5,-78 189371.5,-26 189516.5,-26 189516.5,-78"/>
<text text-anchor="middle" x="189444" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="189444" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="189444" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="189444" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L3_EP0TP2PP0DP0_GPU16 -->
<g id="node926" class="node">
<title>gate_L3_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightyellow" stroke="black" points="189853.16,-104 189614.29,-104 189552.84,0 189791.71,0 189853.16,-104"/>
<text text-anchor="middle" x="189703" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="189703" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="189703" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="189703" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L3_EP0TP2PP0DP0_GPU16 -->
<g id="node927" class="node">
<title>dispatch_L3_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="189992" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="189992" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="189992" y="-44" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP0_GPU16</text>
</g>
<!-- expert_0_L3_EP0TP2PP0DP0_GPU16 -->
<g id="node928" class="node">
<title>expert_0_L3_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="190275.5,-78 190130.5,-78 190130.5,-26 190275.5,-26 190275.5,-78"/>
<text text-anchor="middle" x="190203" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="190203" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="190203" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="190203" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L3_EP0TP2PP0DP0_GPU16 -->
<g id="node929" class="node">
<title>expert_1_L3_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="190456.5,-78 190311.5,-78 190311.5,-26 190456.5,-26 190456.5,-78"/>
<text text-anchor="middle" x="190384" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="190384" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="190384" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="190384" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L3_EP0TP2PP0DP0_GPU16 -->
<g id="node930" class="node">
<title>expert_2_L3_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="190637.5,-78 190492.5,-78 190492.5,-26 190637.5,-26 190637.5,-78"/>
<text text-anchor="middle" x="190565" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="190565" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="190565" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="190565" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L3_EP0TP2PP0DP0_GPU16 -->
<g id="node931" class="node">
<title>expert_3_L3_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="190818.5,-78 190673.5,-78 190673.5,-26 190818.5,-26 190818.5,-78"/>
<text text-anchor="middle" x="190746" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="190746" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="190746" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="190746" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L3_EP0TP2PP0DP0_GPU16 -->
<g id="node932" class="node">
<title>combine_L3_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="190957" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="190957" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="190957" y="-44" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP0_GPU16</text>
</g>
<!-- ffn_L3_EP0TP2PP0DP0_GPU16 -->
<g id="node933" class="node">
<title>ffn_L3_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="191266,-78 191096,-78 191096,-26 191266,-26 191266,-78"/>
<text text-anchor="middle" x="191181" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="191181" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="191181" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="191181" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L3_EP0TP2PP0DP0_GPU16 -->
<g id="node934" class="node">
<title>ffn_ar_L3_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="191405" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="191405" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="191405" y="-49.5" font-family="Arial" font-size="10.00">L3 EP0 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="191405" y="-38.5" font-family="Arial" font-size="10.00">GPU16</text>
</g>
<!-- residual2_L3_EP0TP2PP0DP0_GPU16 -->
<g id="node935" class="node">
<title>residual2_L3_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="191690,-78 191544,-78 191544,-26 191690,-26 191690,-78"/>
<text text-anchor="middle" x="191617" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="191617" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="191617" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="191617" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L3_EP0TP2PP0DP1_GPU17 -->
<g id="node936" class="node">
<title>ln1_L3_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="191871.5,-78 191726.5,-78 191726.5,-26 191871.5,-26 191871.5,-78"/>
<text text-anchor="middle" x="191799" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="191799" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="191799" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="191799" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L3_EP0TP2PP0DP1_GPU17 -->
<g id="node937" class="node">
<title>qkv_L3_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="192052.5,-78 191907.5,-78 191907.5,-26 192052.5,-26 192052.5,-78"/>
<text text-anchor="middle" x="191980" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="191980" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="191980" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="191980" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L3_EP0TP2PP0DP1_GPU17 -->
<g id="node938" class="node">
<title>attn_L3_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="192239.5,-78 192088.5,-78 192088.5,-26 192239.5,-26 192239.5,-78"/>
<text text-anchor="middle" x="192164" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="192164" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="192164" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="192164" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L3_EP0TP2PP0DP1_GPU17 -->
<g id="node939" class="node">
<title>attn_out_L3_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="192420.5,-78 192275.5,-78 192275.5,-26 192420.5,-26 192420.5,-78"/>
<text text-anchor="middle" x="192348" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="192348" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="192348" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="192348" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L3_EP0TP2PP0DP1_GPU17 -->
<g id="node940" class="node">
<title>attn_ar_L3_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="192560" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="192560" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="192560" y="-49.5" font-family="Arial" font-size="10.00">L3 EP0 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="192560" y="-38.5" font-family="Arial" font-size="10.00">GPU17</text>
</g>
<!-- residual1_L3_EP0TP2PP0DP1_GPU17 -->
<g id="node941" class="node">
<title>residual1_L3_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="192845,-78 192699,-78 192699,-26 192845,-26 192845,-78"/>
<text text-anchor="middle" x="192772" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="192772" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="192772" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="192772" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L3_EP0TP2PP0DP1_GPU17 -->
<g id="node942" class="node">
<title>ln2_L3_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="193026.5,-78 192881.5,-78 192881.5,-26 193026.5,-26 193026.5,-78"/>
<text text-anchor="middle" x="192954" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="192954" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="192954" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="192954" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L3_EP0TP2PP0DP1_GPU17 -->
<g id="node943" class="node">
<title>gate_L3_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightyellow" stroke="black" points="193363.16,-104 193124.29,-104 193062.84,0 193301.71,0 193363.16,-104"/>
<text text-anchor="middle" x="193213" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="193213" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="193213" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="193213" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L3_EP0TP2PP0DP1_GPU17 -->
<g id="node944" class="node">
<title>dispatch_L3_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="193502" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="193502" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="193502" y="-44" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP1_GPU17</text>
</g>
<!-- expert_0_L3_EP0TP2PP0DP1_GPU17 -->
<g id="node945" class="node">
<title>expert_0_L3_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="193785.5,-78 193640.5,-78 193640.5,-26 193785.5,-26 193785.5,-78"/>
<text text-anchor="middle" x="193713" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="193713" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="193713" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="193713" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L3_EP0TP2PP0DP1_GPU17 -->
<g id="node946" class="node">
<title>expert_1_L3_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="193966.5,-78 193821.5,-78 193821.5,-26 193966.5,-26 193966.5,-78"/>
<text text-anchor="middle" x="193894" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="193894" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="193894" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="193894" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L3_EP0TP2PP0DP1_GPU17 -->
<g id="node947" class="node">
<title>expert_2_L3_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="194147.5,-78 194002.5,-78 194002.5,-26 194147.5,-26 194147.5,-78"/>
<text text-anchor="middle" x="194075" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="194075" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="194075" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="194075" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L3_EP0TP2PP0DP1_GPU17 -->
<g id="node948" class="node">
<title>expert_3_L3_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="194328.5,-78 194183.5,-78 194183.5,-26 194328.5,-26 194328.5,-78"/>
<text text-anchor="middle" x="194256" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="194256" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="194256" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="194256" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L3_EP0TP2PP0DP1_GPU17 -->
<g id="node949" class="node">
<title>combine_L3_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="194467" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="194467" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="194467" y="-44" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP1_GPU17</text>
</g>
<!-- ffn_L3_EP0TP2PP0DP1_GPU17 -->
<g id="node950" class="node">
<title>ffn_L3_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="194776,-78 194606,-78 194606,-26 194776,-26 194776,-78"/>
<text text-anchor="middle" x="194691" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="194691" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="194691" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="194691" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L3_EP0TP2PP0DP1_GPU17 -->
<g id="node951" class="node">
<title>ffn_ar_L3_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="194915" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="194915" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="194915" y="-49.5" font-family="Arial" font-size="10.00">L3 EP0 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="194915" y="-38.5" font-family="Arial" font-size="10.00">GPU17</text>
</g>
<!-- residual2_L3_EP0TP2PP0DP1_GPU17 -->
<g id="node952" class="node">
<title>residual2_L3_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="195200,-78 195054,-78 195054,-26 195200,-26 195200,-78"/>
<text text-anchor="middle" x="195127" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="195127" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="195127" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="195127" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L3_EP0TP3PP0DP0_GPU24 -->
<g id="node953" class="node">
<title>ln1_L3_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="195381.5,-78 195236.5,-78 195236.5,-26 195381.5,-26 195381.5,-78"/>
<text text-anchor="middle" x="195309" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="195309" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="195309" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="195309" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L3_EP0TP3PP0DP0_GPU24 -->
<g id="node954" class="node">
<title>qkv_L3_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="195562.5,-78 195417.5,-78 195417.5,-26 195562.5,-26 195562.5,-78"/>
<text text-anchor="middle" x="195490" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="195490" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="195490" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="195490" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L3_EP0TP3PP0DP0_GPU24 -->
<g id="node955" class="node">
<title>attn_L3_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="195749.5,-78 195598.5,-78 195598.5,-26 195749.5,-26 195749.5,-78"/>
<text text-anchor="middle" x="195674" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="195674" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="195674" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="195674" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L3_EP0TP3PP0DP0_GPU24 -->
<g id="node956" class="node">
<title>attn_out_L3_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="195930.5,-78 195785.5,-78 195785.5,-26 195930.5,-26 195930.5,-78"/>
<text text-anchor="middle" x="195858" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="195858" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="195858" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="195858" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L3_EP0TP3PP0DP0_GPU24 -->
<g id="node957" class="node">
<title>attn_ar_L3_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="196070" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="196070" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="196070" y="-49.5" font-family="Arial" font-size="10.00">L3 EP0 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="196070" y="-38.5" font-family="Arial" font-size="10.00">GPU24</text>
</g>
<!-- residual1_L3_EP0TP3PP0DP0_GPU24 -->
<g id="node958" class="node">
<title>residual1_L3_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="196355,-78 196209,-78 196209,-26 196355,-26 196355,-78"/>
<text text-anchor="middle" x="196282" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="196282" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="196282" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="196282" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L3_EP0TP3PP0DP0_GPU24 -->
<g id="node959" class="node">
<title>ln2_L3_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="196536.5,-78 196391.5,-78 196391.5,-26 196536.5,-26 196536.5,-78"/>
<text text-anchor="middle" x="196464" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="196464" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="196464" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="196464" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L3_EP0TP3PP0DP0_GPU24 -->
<g id="node960" class="node">
<title>gate_L3_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightyellow" stroke="black" points="196873.16,-104 196634.29,-104 196572.84,0 196811.71,0 196873.16,-104"/>
<text text-anchor="middle" x="196723" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="196723" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="196723" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="196723" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L3_EP0TP3PP0DP0_GPU24 -->
<g id="node961" class="node">
<title>dispatch_L3_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="197012" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="197012" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="197012" y="-44" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP0_GPU24</text>
</g>
<!-- expert_0_L3_EP0TP3PP0DP0_GPU24 -->
<g id="node962" class="node">
<title>expert_0_L3_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="197295.5,-78 197150.5,-78 197150.5,-26 197295.5,-26 197295.5,-78"/>
<text text-anchor="middle" x="197223" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="197223" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="197223" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="197223" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L3_EP0TP3PP0DP0_GPU24 -->
<g id="node963" class="node">
<title>expert_1_L3_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="197476.5,-78 197331.5,-78 197331.5,-26 197476.5,-26 197476.5,-78"/>
<text text-anchor="middle" x="197404" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="197404" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="197404" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="197404" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L3_EP0TP3PP0DP0_GPU24 -->
<g id="node964" class="node">
<title>expert_2_L3_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="197657.5,-78 197512.5,-78 197512.5,-26 197657.5,-26 197657.5,-78"/>
<text text-anchor="middle" x="197585" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="197585" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="197585" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="197585" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L3_EP0TP3PP0DP0_GPU24 -->
<g id="node965" class="node">
<title>expert_3_L3_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="197838.5,-78 197693.5,-78 197693.5,-26 197838.5,-26 197838.5,-78"/>
<text text-anchor="middle" x="197766" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="197766" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="197766" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="197766" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L3_EP0TP3PP0DP0_GPU24 -->
<g id="node966" class="node">
<title>combine_L3_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="197977" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="197977" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="197977" y="-44" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP0_GPU24</text>
</g>
<!-- ffn_L3_EP0TP3PP0DP0_GPU24 -->
<g id="node967" class="node">
<title>ffn_L3_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="198286,-78 198116,-78 198116,-26 198286,-26 198286,-78"/>
<text text-anchor="middle" x="198201" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="198201" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="198201" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="198201" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L3_EP0TP3PP0DP0_GPU24 -->
<g id="node968" class="node">
<title>ffn_ar_L3_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="198425" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="198425" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="198425" y="-49.5" font-family="Arial" font-size="10.00">L3 EP0 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="198425" y="-38.5" font-family="Arial" font-size="10.00">GPU24</text>
</g>
<!-- residual2_L3_EP0TP3PP0DP0_GPU24 -->
<g id="node969" class="node">
<title>residual2_L3_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="198710,-78 198564,-78 198564,-26 198710,-26 198710,-78"/>
<text text-anchor="middle" x="198637" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="198637" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="198637" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="198637" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L3_EP0TP3PP0DP1_GPU25 -->
<g id="node970" class="node">
<title>ln1_L3_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="198891.5,-78 198746.5,-78 198746.5,-26 198891.5,-26 198891.5,-78"/>
<text text-anchor="middle" x="198819" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="198819" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="198819" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="198819" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L3_EP0TP3PP0DP1_GPU25 -->
<g id="node971" class="node">
<title>qkv_L3_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="199072.5,-78 198927.5,-78 198927.5,-26 199072.5,-26 199072.5,-78"/>
<text text-anchor="middle" x="199000" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="199000" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="199000" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="199000" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L3_EP0TP3PP0DP1_GPU25 -->
<g id="node972" class="node">
<title>attn_L3_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="199259.5,-78 199108.5,-78 199108.5,-26 199259.5,-26 199259.5,-78"/>
<text text-anchor="middle" x="199184" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="199184" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="199184" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="199184" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L3_EP0TP3PP0DP1_GPU25 -->
<g id="node973" class="node">
<title>attn_out_L3_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="199440.5,-78 199295.5,-78 199295.5,-26 199440.5,-26 199440.5,-78"/>
<text text-anchor="middle" x="199368" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="199368" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="199368" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="199368" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L3_EP0TP3PP0DP1_GPU25 -->
<g id="node974" class="node">
<title>attn_ar_L3_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="199580" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="199580" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="199580" y="-49.5" font-family="Arial" font-size="10.00">L3 EP0 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="199580" y="-38.5" font-family="Arial" font-size="10.00">GPU25</text>
</g>
<!-- residual1_L3_EP0TP3PP0DP1_GPU25 -->
<g id="node975" class="node">
<title>residual1_L3_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="199865,-78 199719,-78 199719,-26 199865,-26 199865,-78"/>
<text text-anchor="middle" x="199792" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="199792" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="199792" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="199792" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L3_EP0TP3PP0DP1_GPU25 -->
<g id="node976" class="node">
<title>ln2_L3_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="200046.5,-78 199901.5,-78 199901.5,-26 200046.5,-26 200046.5,-78"/>
<text text-anchor="middle" x="199974" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="199974" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="199974" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="199974" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L3_EP0TP3PP0DP1_GPU25 -->
<g id="node977" class="node">
<title>gate_L3_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightyellow" stroke="black" points="200383.16,-104 200144.29,-104 200082.84,0 200321.71,0 200383.16,-104"/>
<text text-anchor="middle" x="200233" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="200233" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="200233" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="200233" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L3_EP0TP3PP0DP1_GPU25 -->
<g id="node978" class="node">
<title>dispatch_L3_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="200522" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="200522" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="200522" y="-44" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP1_GPU25</text>
</g>
<!-- expert_0_L3_EP0TP3PP0DP1_GPU25 -->
<g id="node979" class="node">
<title>expert_0_L3_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="200805.5,-78 200660.5,-78 200660.5,-26 200805.5,-26 200805.5,-78"/>
<text text-anchor="middle" x="200733" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="200733" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="200733" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="200733" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L3_EP0TP3PP0DP1_GPU25 -->
<g id="node980" class="node">
<title>expert_1_L3_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="200986.5,-78 200841.5,-78 200841.5,-26 200986.5,-26 200986.5,-78"/>
<text text-anchor="middle" x="200914" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="200914" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="200914" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="200914" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L3_EP0TP3PP0DP1_GPU25 -->
<g id="node981" class="node">
<title>expert_2_L3_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="201167.5,-78 201022.5,-78 201022.5,-26 201167.5,-26 201167.5,-78"/>
<text text-anchor="middle" x="201095" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="201095" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="201095" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="201095" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L3_EP0TP3PP0DP1_GPU25 -->
<g id="node982" class="node">
<title>expert_3_L3_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="201348.5,-78 201203.5,-78 201203.5,-26 201348.5,-26 201348.5,-78"/>
<text text-anchor="middle" x="201276" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="201276" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="201276" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="201276" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L3_EP0TP3PP0DP1_GPU25 -->
<g id="node983" class="node">
<title>combine_L3_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="201487" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="201487" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="201487" y="-44" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP1_GPU25</text>
</g>
<!-- ffn_L3_EP0TP3PP0DP1_GPU25 -->
<g id="node984" class="node">
<title>ffn_L3_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="201796,-78 201626,-78 201626,-26 201796,-26 201796,-78"/>
<text text-anchor="middle" x="201711" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="201711" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="201711" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="201711" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L3_EP0TP3PP0DP1_GPU25 -->
<g id="node985" class="node">
<title>ffn_ar_L3_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="201935" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="201935" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="201935" y="-49.5" font-family="Arial" font-size="10.00">L3 EP0 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="201935" y="-38.5" font-family="Arial" font-size="10.00">GPU25</text>
</g>
<!-- residual2_L3_EP0TP3PP0DP1_GPU25 -->
<g id="node986" class="node">
<title>residual2_L3_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="202220,-78 202074,-78 202074,-26 202220,-26 202220,-78"/>
<text text-anchor="middle" x="202147" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="202147" y="-55" font-family="Arial" font-size="10.00">L3_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="202147" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="202147" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L3_EP1TP0PP0DP0_GPU32 -->
<g id="node987" class="node">
<title>ln1_L3_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="202401.5,-78 202256.5,-78 202256.5,-26 202401.5,-26 202401.5,-78"/>
<text text-anchor="middle" x="202329" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="202329" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="202329" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="202329" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L3_EP1TP0PP0DP0_GPU32 -->
<g id="node988" class="node">
<title>qkv_L3_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="202582.5,-78 202437.5,-78 202437.5,-26 202582.5,-26 202582.5,-78"/>
<text text-anchor="middle" x="202510" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="202510" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="202510" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="202510" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L3_EP1TP0PP0DP0_GPU32 -->
<g id="node989" class="node">
<title>attn_L3_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="202769.5,-78 202618.5,-78 202618.5,-26 202769.5,-26 202769.5,-78"/>
<text text-anchor="middle" x="202694" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="202694" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="202694" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="202694" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L3_EP1TP0PP0DP0_GPU32 -->
<g id="node990" class="node">
<title>attn_out_L3_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="202950.5,-78 202805.5,-78 202805.5,-26 202950.5,-26 202950.5,-78"/>
<text text-anchor="middle" x="202878" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="202878" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="202878" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="202878" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L3_EP1TP0PP0DP0_GPU32 -->
<g id="node991" class="node">
<title>attn_ar_L3_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="203090" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="203090" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="203090" y="-49.5" font-family="Arial" font-size="10.00">L3 EP1 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="203090" y="-38.5" font-family="Arial" font-size="10.00">GPU32</text>
</g>
<!-- residual1_L3_EP1TP0PP0DP0_GPU32 -->
<g id="node992" class="node">
<title>residual1_L3_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="203375,-78 203229,-78 203229,-26 203375,-26 203375,-78"/>
<text text-anchor="middle" x="203302" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="203302" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="203302" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="203302" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L3_EP1TP0PP0DP0_GPU32 -->
<g id="node993" class="node">
<title>ln2_L3_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="203556.5,-78 203411.5,-78 203411.5,-26 203556.5,-26 203556.5,-78"/>
<text text-anchor="middle" x="203484" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="203484" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="203484" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="203484" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L3_EP1TP0PP0DP0_GPU32 -->
<g id="node994" class="node">
<title>gate_L3_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightyellow" stroke="black" points="203893.16,-104 203654.29,-104 203592.84,0 203831.71,0 203893.16,-104"/>
<text text-anchor="middle" x="203743" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="203743" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="203743" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="203743" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L3_EP1TP0PP0DP0_GPU32 -->
<g id="node995" class="node">
<title>dispatch_L3_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="204032" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="204032" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="204032" y="-44" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP0_GPU32</text>
</g>
<!-- expert_0_L3_EP1TP0PP0DP0_GPU32 -->
<g id="node996" class="node">
<title>expert_0_L3_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="204315.5,-78 204170.5,-78 204170.5,-26 204315.5,-26 204315.5,-78"/>
<text text-anchor="middle" x="204243" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="204243" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="204243" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="204243" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L3_EP1TP0PP0DP0_GPU32 -->
<g id="node997" class="node">
<title>expert_1_L3_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="204496.5,-78 204351.5,-78 204351.5,-26 204496.5,-26 204496.5,-78"/>
<text text-anchor="middle" x="204424" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="204424" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="204424" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="204424" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L3_EP1TP0PP0DP0_GPU32 -->
<g id="node998" class="node">
<title>expert_2_L3_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="204677.5,-78 204532.5,-78 204532.5,-26 204677.5,-26 204677.5,-78"/>
<text text-anchor="middle" x="204605" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="204605" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="204605" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="204605" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L3_EP1TP0PP0DP0_GPU32 -->
<g id="node999" class="node">
<title>expert_3_L3_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="204858.5,-78 204713.5,-78 204713.5,-26 204858.5,-26 204858.5,-78"/>
<text text-anchor="middle" x="204786" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="204786" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="204786" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="204786" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L3_EP1TP0PP0DP0_GPU32 -->
<g id="node1000" class="node">
<title>combine_L3_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="204997" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="204997" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="204997" y="-44" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP0_GPU32</text>
</g>
<!-- ffn_L3_EP1TP0PP0DP0_GPU32 -->
<g id="node1001" class="node">
<title>ffn_L3_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="205306,-78 205136,-78 205136,-26 205306,-26 205306,-78"/>
<text text-anchor="middle" x="205221" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="205221" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="205221" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="205221" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L3_EP1TP0PP0DP0_GPU32 -->
<g id="node1002" class="node">
<title>ffn_ar_L3_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="205445" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="205445" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="205445" y="-49.5" font-family="Arial" font-size="10.00">L3 EP1 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="205445" y="-38.5" font-family="Arial" font-size="10.00">GPU32</text>
</g>
<!-- residual2_L3_EP1TP0PP0DP0_GPU32 -->
<g id="node1003" class="node">
<title>residual2_L3_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="205730,-78 205584,-78 205584,-26 205730,-26 205730,-78"/>
<text text-anchor="middle" x="205657" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="205657" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="205657" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="205657" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L3_EP1TP0PP0DP1_GPU33 -->
<g id="node1004" class="node">
<title>ln1_L3_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="205911.5,-78 205766.5,-78 205766.5,-26 205911.5,-26 205911.5,-78"/>
<text text-anchor="middle" x="205839" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="205839" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="205839" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="205839" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L3_EP1TP0PP0DP1_GPU33 -->
<g id="node1005" class="node">
<title>qkv_L3_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="206092.5,-78 205947.5,-78 205947.5,-26 206092.5,-26 206092.5,-78"/>
<text text-anchor="middle" x="206020" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="206020" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="206020" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="206020" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L3_EP1TP0PP0DP1_GPU33 -->
<g id="node1006" class="node">
<title>attn_L3_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="206279.5,-78 206128.5,-78 206128.5,-26 206279.5,-26 206279.5,-78"/>
<text text-anchor="middle" x="206204" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="206204" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="206204" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="206204" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L3_EP1TP0PP0DP1_GPU33 -->
<g id="node1007" class="node">
<title>attn_out_L3_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="206460.5,-78 206315.5,-78 206315.5,-26 206460.5,-26 206460.5,-78"/>
<text text-anchor="middle" x="206388" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="206388" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="206388" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="206388" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L3_EP1TP0PP0DP1_GPU33 -->
<g id="node1008" class="node">
<title>attn_ar_L3_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="206600" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="206600" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="206600" y="-49.5" font-family="Arial" font-size="10.00">L3 EP1 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="206600" y="-38.5" font-family="Arial" font-size="10.00">GPU33</text>
</g>
<!-- residual1_L3_EP1TP0PP0DP1_GPU33 -->
<g id="node1009" class="node">
<title>residual1_L3_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="206885,-78 206739,-78 206739,-26 206885,-26 206885,-78"/>
<text text-anchor="middle" x="206812" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="206812" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="206812" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="206812" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L3_EP1TP0PP0DP1_GPU33 -->
<g id="node1010" class="node">
<title>ln2_L3_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="207066.5,-78 206921.5,-78 206921.5,-26 207066.5,-26 207066.5,-78"/>
<text text-anchor="middle" x="206994" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="206994" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="206994" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="206994" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L3_EP1TP0PP0DP1_GPU33 -->
<g id="node1011" class="node">
<title>gate_L3_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightyellow" stroke="black" points="207403.16,-104 207164.29,-104 207102.84,0 207341.71,0 207403.16,-104"/>
<text text-anchor="middle" x="207253" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="207253" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="207253" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="207253" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L3_EP1TP0PP0DP1_GPU33 -->
<g id="node1012" class="node">
<title>dispatch_L3_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="207542" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="207542" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="207542" y="-44" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP1_GPU33</text>
</g>
<!-- expert_0_L3_EP1TP0PP0DP1_GPU33 -->
<g id="node1013" class="node">
<title>expert_0_L3_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="207825.5,-78 207680.5,-78 207680.5,-26 207825.5,-26 207825.5,-78"/>
<text text-anchor="middle" x="207753" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="207753" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="207753" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="207753" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L3_EP1TP0PP0DP1_GPU33 -->
<g id="node1014" class="node">
<title>expert_1_L3_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="208006.5,-78 207861.5,-78 207861.5,-26 208006.5,-26 208006.5,-78"/>
<text text-anchor="middle" x="207934" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="207934" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="207934" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="207934" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L3_EP1TP0PP0DP1_GPU33 -->
<g id="node1015" class="node">
<title>expert_2_L3_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="208187.5,-78 208042.5,-78 208042.5,-26 208187.5,-26 208187.5,-78"/>
<text text-anchor="middle" x="208115" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="208115" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="208115" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="208115" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L3_EP1TP0PP0DP1_GPU33 -->
<g id="node1016" class="node">
<title>expert_3_L3_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="208368.5,-78 208223.5,-78 208223.5,-26 208368.5,-26 208368.5,-78"/>
<text text-anchor="middle" x="208296" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="208296" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="208296" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="208296" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L3_EP1TP0PP0DP1_GPU33 -->
<g id="node1017" class="node">
<title>combine_L3_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="208507" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="208507" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="208507" y="-44" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP1_GPU33</text>
</g>
<!-- ffn_L3_EP1TP0PP0DP1_GPU33 -->
<g id="node1018" class="node">
<title>ffn_L3_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="208816,-78 208646,-78 208646,-26 208816,-26 208816,-78"/>
<text text-anchor="middle" x="208731" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="208731" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="208731" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="208731" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L3_EP1TP0PP0DP1_GPU33 -->
<g id="node1019" class="node">
<title>ffn_ar_L3_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="208955" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="208955" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="208955" y="-49.5" font-family="Arial" font-size="10.00">L3 EP1 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="208955" y="-38.5" font-family="Arial" font-size="10.00">GPU33</text>
</g>
<!-- residual2_L3_EP1TP0PP0DP1_GPU33 -->
<g id="node1020" class="node">
<title>residual2_L3_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="209240,-78 209094,-78 209094,-26 209240,-26 209240,-78"/>
<text text-anchor="middle" x="209167" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="209167" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="209167" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="209167" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L3_EP1TP1PP0DP0_GPU40 -->
<g id="node1021" class="node">
<title>ln1_L3_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="209421.5,-78 209276.5,-78 209276.5,-26 209421.5,-26 209421.5,-78"/>
<text text-anchor="middle" x="209349" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="209349" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="209349" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="209349" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L3_EP1TP1PP0DP0_GPU40 -->
<g id="node1022" class="node">
<title>qkv_L3_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="209602.5,-78 209457.5,-78 209457.5,-26 209602.5,-26 209602.5,-78"/>
<text text-anchor="middle" x="209530" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="209530" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="209530" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="209530" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L3_EP1TP1PP0DP0_GPU40 -->
<g id="node1023" class="node">
<title>attn_L3_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="209789.5,-78 209638.5,-78 209638.5,-26 209789.5,-26 209789.5,-78"/>
<text text-anchor="middle" x="209714" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="209714" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="209714" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="209714" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L3_EP1TP1PP0DP0_GPU40 -->
<g id="node1024" class="node">
<title>attn_out_L3_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="209970.5,-78 209825.5,-78 209825.5,-26 209970.5,-26 209970.5,-78"/>
<text text-anchor="middle" x="209898" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="209898" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="209898" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="209898" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L3_EP1TP1PP0DP0_GPU40 -->
<g id="node1025" class="node">
<title>attn_ar_L3_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="210110" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="210110" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="210110" y="-49.5" font-family="Arial" font-size="10.00">L3 EP1 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="210110" y="-38.5" font-family="Arial" font-size="10.00">GPU40</text>
</g>
<!-- residual1_L3_EP1TP1PP0DP0_GPU40 -->
<g id="node1026" class="node">
<title>residual1_L3_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="210395,-78 210249,-78 210249,-26 210395,-26 210395,-78"/>
<text text-anchor="middle" x="210322" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="210322" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="210322" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="210322" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L3_EP1TP1PP0DP0_GPU40 -->
<g id="node1027" class="node">
<title>ln2_L3_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="210576.5,-78 210431.5,-78 210431.5,-26 210576.5,-26 210576.5,-78"/>
<text text-anchor="middle" x="210504" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="210504" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="210504" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="210504" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L3_EP1TP1PP0DP0_GPU40 -->
<g id="node1028" class="node">
<title>gate_L3_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightyellow" stroke="black" points="210913.16,-104 210674.29,-104 210612.84,0 210851.71,0 210913.16,-104"/>
<text text-anchor="middle" x="210763" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="210763" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="210763" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="210763" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L3_EP1TP1PP0DP0_GPU40 -->
<g id="node1029" class="node">
<title>dispatch_L3_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="211052" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="211052" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="211052" y="-44" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP0_GPU40</text>
</g>
<!-- expert_0_L3_EP1TP1PP0DP0_GPU40 -->
<g id="node1030" class="node">
<title>expert_0_L3_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="211335.5,-78 211190.5,-78 211190.5,-26 211335.5,-26 211335.5,-78"/>
<text text-anchor="middle" x="211263" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="211263" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="211263" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="211263" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L3_EP1TP1PP0DP0_GPU40 -->
<g id="node1031" class="node">
<title>expert_1_L3_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="211516.5,-78 211371.5,-78 211371.5,-26 211516.5,-26 211516.5,-78"/>
<text text-anchor="middle" x="211444" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="211444" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="211444" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="211444" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L3_EP1TP1PP0DP0_GPU40 -->
<g id="node1032" class="node">
<title>expert_2_L3_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="211697.5,-78 211552.5,-78 211552.5,-26 211697.5,-26 211697.5,-78"/>
<text text-anchor="middle" x="211625" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="211625" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="211625" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="211625" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L3_EP1TP1PP0DP0_GPU40 -->
<g id="node1033" class="node">
<title>expert_3_L3_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="211878.5,-78 211733.5,-78 211733.5,-26 211878.5,-26 211878.5,-78"/>
<text text-anchor="middle" x="211806" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="211806" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="211806" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="211806" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L3_EP1TP1PP0DP0_GPU40 -->
<g id="node1034" class="node">
<title>combine_L3_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="212017" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="212017" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="212017" y="-44" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP0_GPU40</text>
</g>
<!-- ffn_L3_EP1TP1PP0DP0_GPU40 -->
<g id="node1035" class="node">
<title>ffn_L3_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="212326,-78 212156,-78 212156,-26 212326,-26 212326,-78"/>
<text text-anchor="middle" x="212241" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="212241" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="212241" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="212241" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L3_EP1TP1PP0DP0_GPU40 -->
<g id="node1036" class="node">
<title>ffn_ar_L3_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="212465" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="212465" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="212465" y="-49.5" font-family="Arial" font-size="10.00">L3 EP1 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="212465" y="-38.5" font-family="Arial" font-size="10.00">GPU40</text>
</g>
<!-- residual2_L3_EP1TP1PP0DP0_GPU40 -->
<g id="node1037" class="node">
<title>residual2_L3_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="212750,-78 212604,-78 212604,-26 212750,-26 212750,-78"/>
<text text-anchor="middle" x="212677" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="212677" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="212677" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="212677" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L3_EP1TP1PP0DP1_GPU41 -->
<g id="node1038" class="node">
<title>ln1_L3_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="212931.5,-78 212786.5,-78 212786.5,-26 212931.5,-26 212931.5,-78"/>
<text text-anchor="middle" x="212859" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="212859" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="212859" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="212859" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L3_EP1TP1PP0DP1_GPU41 -->
<g id="node1039" class="node">
<title>qkv_L3_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="213112.5,-78 212967.5,-78 212967.5,-26 213112.5,-26 213112.5,-78"/>
<text text-anchor="middle" x="213040" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="213040" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="213040" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="213040" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L3_EP1TP1PP0DP1_GPU41 -->
<g id="node1040" class="node">
<title>attn_L3_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="213299.5,-78 213148.5,-78 213148.5,-26 213299.5,-26 213299.5,-78"/>
<text text-anchor="middle" x="213224" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="213224" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="213224" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="213224" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L3_EP1TP1PP0DP1_GPU41 -->
<g id="node1041" class="node">
<title>attn_out_L3_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="213480.5,-78 213335.5,-78 213335.5,-26 213480.5,-26 213480.5,-78"/>
<text text-anchor="middle" x="213408" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="213408" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="213408" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="213408" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L3_EP1TP1PP0DP1_GPU41 -->
<g id="node1042" class="node">
<title>attn_ar_L3_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="213620" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="213620" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="213620" y="-49.5" font-family="Arial" font-size="10.00">L3 EP1 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="213620" y="-38.5" font-family="Arial" font-size="10.00">GPU41</text>
</g>
<!-- residual1_L3_EP1TP1PP0DP1_GPU41 -->
<g id="node1043" class="node">
<title>residual1_L3_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="213905,-78 213759,-78 213759,-26 213905,-26 213905,-78"/>
<text text-anchor="middle" x="213832" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="213832" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="213832" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="213832" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L3_EP1TP1PP0DP1_GPU41 -->
<g id="node1044" class="node">
<title>ln2_L3_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="214086.5,-78 213941.5,-78 213941.5,-26 214086.5,-26 214086.5,-78"/>
<text text-anchor="middle" x="214014" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="214014" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="214014" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="214014" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L3_EP1TP1PP0DP1_GPU41 -->
<g id="node1045" class="node">
<title>gate_L3_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightyellow" stroke="black" points="214423.16,-104 214184.29,-104 214122.84,0 214361.71,0 214423.16,-104"/>
<text text-anchor="middle" x="214273" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="214273" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="214273" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="214273" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L3_EP1TP1PP0DP1_GPU41 -->
<g id="node1046" class="node">
<title>dispatch_L3_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="214562" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="214562" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="214562" y="-44" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP1_GPU41</text>
</g>
<!-- expert_0_L3_EP1TP1PP0DP1_GPU41 -->
<g id="node1047" class="node">
<title>expert_0_L3_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="214845.5,-78 214700.5,-78 214700.5,-26 214845.5,-26 214845.5,-78"/>
<text text-anchor="middle" x="214773" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="214773" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="214773" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="214773" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L3_EP1TP1PP0DP1_GPU41 -->
<g id="node1048" class="node">
<title>expert_1_L3_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="215026.5,-78 214881.5,-78 214881.5,-26 215026.5,-26 215026.5,-78"/>
<text text-anchor="middle" x="214954" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="214954" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="214954" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="214954" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L3_EP1TP1PP0DP1_GPU41 -->
<g id="node1049" class="node">
<title>expert_2_L3_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="215207.5,-78 215062.5,-78 215062.5,-26 215207.5,-26 215207.5,-78"/>
<text text-anchor="middle" x="215135" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="215135" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="215135" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="215135" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L3_EP1TP1PP0DP1_GPU41 -->
<g id="node1050" class="node">
<title>expert_3_L3_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="215388.5,-78 215243.5,-78 215243.5,-26 215388.5,-26 215388.5,-78"/>
<text text-anchor="middle" x="215316" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="215316" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="215316" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="215316" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L3_EP1TP1PP0DP1_GPU41 -->
<g id="node1051" class="node">
<title>combine_L3_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="215527" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="215527" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="215527" y="-44" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP1_GPU41</text>
</g>
<!-- ffn_L3_EP1TP1PP0DP1_GPU41 -->
<g id="node1052" class="node">
<title>ffn_L3_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="215836,-78 215666,-78 215666,-26 215836,-26 215836,-78"/>
<text text-anchor="middle" x="215751" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="215751" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="215751" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="215751" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L3_EP1TP1PP0DP1_GPU41 -->
<g id="node1053" class="node">
<title>ffn_ar_L3_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="215975" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="215975" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="215975" y="-49.5" font-family="Arial" font-size="10.00">L3 EP1 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="215975" y="-38.5" font-family="Arial" font-size="10.00">GPU41</text>
</g>
<!-- residual2_L3_EP1TP1PP0DP1_GPU41 -->
<g id="node1054" class="node">
<title>residual2_L3_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="216260,-78 216114,-78 216114,-26 216260,-26 216260,-78"/>
<text text-anchor="middle" x="216187" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="216187" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="216187" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="216187" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L3_EP1TP2PP0DP0_GPU48 -->
<g id="node1055" class="node">
<title>ln1_L3_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="216441.5,-78 216296.5,-78 216296.5,-26 216441.5,-26 216441.5,-78"/>
<text text-anchor="middle" x="216369" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="216369" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="216369" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="216369" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L3_EP1TP2PP0DP0_GPU48 -->
<g id="node1056" class="node">
<title>qkv_L3_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="216622.5,-78 216477.5,-78 216477.5,-26 216622.5,-26 216622.5,-78"/>
<text text-anchor="middle" x="216550" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="216550" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="216550" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="216550" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L3_EP1TP2PP0DP0_GPU48 -->
<g id="node1057" class="node">
<title>attn_L3_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="216809.5,-78 216658.5,-78 216658.5,-26 216809.5,-26 216809.5,-78"/>
<text text-anchor="middle" x="216734" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="216734" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="216734" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="216734" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L3_EP1TP2PP0DP0_GPU48 -->
<g id="node1058" class="node">
<title>attn_out_L3_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="216990.5,-78 216845.5,-78 216845.5,-26 216990.5,-26 216990.5,-78"/>
<text text-anchor="middle" x="216918" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="216918" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="216918" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="216918" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L3_EP1TP2PP0DP0_GPU48 -->
<g id="node1059" class="node">
<title>attn_ar_L3_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="217130" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="217130" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="217130" y="-49.5" font-family="Arial" font-size="10.00">L3 EP1 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="217130" y="-38.5" font-family="Arial" font-size="10.00">GPU48</text>
</g>
<!-- residual1_L3_EP1TP2PP0DP0_GPU48 -->
<g id="node1060" class="node">
<title>residual1_L3_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="217415,-78 217269,-78 217269,-26 217415,-26 217415,-78"/>
<text text-anchor="middle" x="217342" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="217342" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="217342" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="217342" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L3_EP1TP2PP0DP0_GPU48 -->
<g id="node1061" class="node">
<title>ln2_L3_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="217596.5,-78 217451.5,-78 217451.5,-26 217596.5,-26 217596.5,-78"/>
<text text-anchor="middle" x="217524" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="217524" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="217524" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="217524" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L3_EP1TP2PP0DP0_GPU48 -->
<g id="node1062" class="node">
<title>gate_L3_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightyellow" stroke="black" points="217933.16,-104 217694.29,-104 217632.84,0 217871.71,0 217933.16,-104"/>
<text text-anchor="middle" x="217783" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="217783" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="217783" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="217783" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L3_EP1TP2PP0DP0_GPU48 -->
<g id="node1063" class="node">
<title>dispatch_L3_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="218072" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="218072" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="218072" y="-44" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP0_GPU48</text>
</g>
<!-- expert_0_L3_EP1TP2PP0DP0_GPU48 -->
<g id="node1064" class="node">
<title>expert_0_L3_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="218355.5,-78 218210.5,-78 218210.5,-26 218355.5,-26 218355.5,-78"/>
<text text-anchor="middle" x="218283" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="218283" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="218283" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="218283" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L3_EP1TP2PP0DP0_GPU48 -->
<g id="node1065" class="node">
<title>expert_1_L3_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="218536.5,-78 218391.5,-78 218391.5,-26 218536.5,-26 218536.5,-78"/>
<text text-anchor="middle" x="218464" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="218464" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="218464" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="218464" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L3_EP1TP2PP0DP0_GPU48 -->
<g id="node1066" class="node">
<title>expert_2_L3_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="218717.5,-78 218572.5,-78 218572.5,-26 218717.5,-26 218717.5,-78"/>
<text text-anchor="middle" x="218645" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="218645" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="218645" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="218645" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L3_EP1TP2PP0DP0_GPU48 -->
<g id="node1067" class="node">
<title>expert_3_L3_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="218898.5,-78 218753.5,-78 218753.5,-26 218898.5,-26 218898.5,-78"/>
<text text-anchor="middle" x="218826" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="218826" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="218826" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="218826" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L3_EP1TP2PP0DP0_GPU48 -->
<g id="node1068" class="node">
<title>combine_L3_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="219037" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="219037" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="219037" y="-44" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP0_GPU48</text>
</g>
<!-- ffn_L3_EP1TP2PP0DP0_GPU48 -->
<g id="node1069" class="node">
<title>ffn_L3_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="219346,-78 219176,-78 219176,-26 219346,-26 219346,-78"/>
<text text-anchor="middle" x="219261" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="219261" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="219261" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="219261" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L3_EP1TP2PP0DP0_GPU48 -->
<g id="node1070" class="node">
<title>ffn_ar_L3_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="219485" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="219485" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="219485" y="-49.5" font-family="Arial" font-size="10.00">L3 EP1 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="219485" y="-38.5" font-family="Arial" font-size="10.00">GPU48</text>
</g>
<!-- residual2_L3_EP1TP2PP0DP0_GPU48 -->
<g id="node1071" class="node">
<title>residual2_L3_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="219770,-78 219624,-78 219624,-26 219770,-26 219770,-78"/>
<text text-anchor="middle" x="219697" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="219697" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="219697" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="219697" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L3_EP1TP2PP0DP1_GPU49 -->
<g id="node1072" class="node">
<title>ln1_L3_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="219951.5,-78 219806.5,-78 219806.5,-26 219951.5,-26 219951.5,-78"/>
<text text-anchor="middle" x="219879" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="219879" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="219879" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="219879" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L3_EP1TP2PP0DP1_GPU49 -->
<g id="node1073" class="node">
<title>qkv_L3_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="220132.5,-78 219987.5,-78 219987.5,-26 220132.5,-26 220132.5,-78"/>
<text text-anchor="middle" x="220060" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="220060" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="220060" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="220060" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L3_EP1TP2PP0DP1_GPU49 -->
<g id="node1074" class="node">
<title>attn_L3_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="220319.5,-78 220168.5,-78 220168.5,-26 220319.5,-26 220319.5,-78"/>
<text text-anchor="middle" x="220244" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="220244" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="220244" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="220244" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L3_EP1TP2PP0DP1_GPU49 -->
<g id="node1075" class="node">
<title>attn_out_L3_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="220500.5,-78 220355.5,-78 220355.5,-26 220500.5,-26 220500.5,-78"/>
<text text-anchor="middle" x="220428" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="220428" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="220428" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="220428" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L3_EP1TP2PP0DP1_GPU49 -->
<g id="node1076" class="node">
<title>attn_ar_L3_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="220640" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="220640" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="220640" y="-49.5" font-family="Arial" font-size="10.00">L3 EP1 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="220640" y="-38.5" font-family="Arial" font-size="10.00">GPU49</text>
</g>
<!-- residual1_L3_EP1TP2PP0DP1_GPU49 -->
<g id="node1077" class="node">
<title>residual1_L3_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="220925,-78 220779,-78 220779,-26 220925,-26 220925,-78"/>
<text text-anchor="middle" x="220852" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="220852" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="220852" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="220852" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L3_EP1TP2PP0DP1_GPU49 -->
<g id="node1078" class="node">
<title>ln2_L3_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="221106.5,-78 220961.5,-78 220961.5,-26 221106.5,-26 221106.5,-78"/>
<text text-anchor="middle" x="221034" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="221034" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="221034" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="221034" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L3_EP1TP2PP0DP1_GPU49 -->
<g id="node1079" class="node">
<title>gate_L3_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightyellow" stroke="black" points="221443.16,-104 221204.29,-104 221142.84,0 221381.71,0 221443.16,-104"/>
<text text-anchor="middle" x="221293" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="221293" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="221293" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="221293" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L3_EP1TP2PP0DP1_GPU49 -->
<g id="node1080" class="node">
<title>dispatch_L3_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="221582" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="221582" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="221582" y="-44" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP1_GPU49</text>
</g>
<!-- expert_0_L3_EP1TP2PP0DP1_GPU49 -->
<g id="node1081" class="node">
<title>expert_0_L3_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="221865.5,-78 221720.5,-78 221720.5,-26 221865.5,-26 221865.5,-78"/>
<text text-anchor="middle" x="221793" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="221793" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="221793" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="221793" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L3_EP1TP2PP0DP1_GPU49 -->
<g id="node1082" class="node">
<title>expert_1_L3_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="222046.5,-78 221901.5,-78 221901.5,-26 222046.5,-26 222046.5,-78"/>
<text text-anchor="middle" x="221974" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="221974" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="221974" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="221974" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L3_EP1TP2PP0DP1_GPU49 -->
<g id="node1083" class="node">
<title>expert_2_L3_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="222227.5,-78 222082.5,-78 222082.5,-26 222227.5,-26 222227.5,-78"/>
<text text-anchor="middle" x="222155" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="222155" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="222155" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="222155" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L3_EP1TP2PP0DP1_GPU49 -->
<g id="node1084" class="node">
<title>expert_3_L3_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="222408.5,-78 222263.5,-78 222263.5,-26 222408.5,-26 222408.5,-78"/>
<text text-anchor="middle" x="222336" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="222336" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="222336" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="222336" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L3_EP1TP2PP0DP1_GPU49 -->
<g id="node1085" class="node">
<title>combine_L3_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="222547" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="222547" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="222547" y="-44" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP1_GPU49</text>
</g>
<!-- ffn_L3_EP1TP2PP0DP1_GPU49 -->
<g id="node1086" class="node">
<title>ffn_L3_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="222856,-78 222686,-78 222686,-26 222856,-26 222856,-78"/>
<text text-anchor="middle" x="222771" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="222771" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="222771" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="222771" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L3_EP1TP2PP0DP1_GPU49 -->
<g id="node1087" class="node">
<title>ffn_ar_L3_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="222995" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="222995" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="222995" y="-49.5" font-family="Arial" font-size="10.00">L3 EP1 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="222995" y="-38.5" font-family="Arial" font-size="10.00">GPU49</text>
</g>
<!-- residual2_L3_EP1TP2PP0DP1_GPU49 -->
<g id="node1088" class="node">
<title>residual2_L3_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="223280,-78 223134,-78 223134,-26 223280,-26 223280,-78"/>
<text text-anchor="middle" x="223207" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="223207" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="223207" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="223207" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L3_EP1TP3PP0DP0_GPU56 -->
<g id="node1089" class="node">
<title>ln1_L3_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="223461.5,-78 223316.5,-78 223316.5,-26 223461.5,-26 223461.5,-78"/>
<text text-anchor="middle" x="223389" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="223389" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="223389" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="223389" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L3_EP1TP3PP0DP0_GPU56 -->
<g id="node1090" class="node">
<title>qkv_L3_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="223642.5,-78 223497.5,-78 223497.5,-26 223642.5,-26 223642.5,-78"/>
<text text-anchor="middle" x="223570" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="223570" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="223570" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="223570" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L3_EP1TP3PP0DP0_GPU56 -->
<g id="node1091" class="node">
<title>attn_L3_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="223829.5,-78 223678.5,-78 223678.5,-26 223829.5,-26 223829.5,-78"/>
<text text-anchor="middle" x="223754" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="223754" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="223754" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="223754" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L3_EP1TP3PP0DP0_GPU56 -->
<g id="node1092" class="node">
<title>attn_out_L3_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="224010.5,-78 223865.5,-78 223865.5,-26 224010.5,-26 224010.5,-78"/>
<text text-anchor="middle" x="223938" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="223938" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="223938" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="223938" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L3_EP1TP3PP0DP0_GPU56 -->
<g id="node1093" class="node">
<title>attn_ar_L3_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="224150" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="224150" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="224150" y="-49.5" font-family="Arial" font-size="10.00">L3 EP1 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="224150" y="-38.5" font-family="Arial" font-size="10.00">GPU56</text>
</g>
<!-- residual1_L3_EP1TP3PP0DP0_GPU56 -->
<g id="node1094" class="node">
<title>residual1_L3_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="224435,-78 224289,-78 224289,-26 224435,-26 224435,-78"/>
<text text-anchor="middle" x="224362" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="224362" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="224362" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="224362" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L3_EP1TP3PP0DP0_GPU56 -->
<g id="node1095" class="node">
<title>ln2_L3_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="224616.5,-78 224471.5,-78 224471.5,-26 224616.5,-26 224616.5,-78"/>
<text text-anchor="middle" x="224544" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="224544" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="224544" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="224544" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L3_EP1TP3PP0DP0_GPU56 -->
<g id="node1096" class="node">
<title>gate_L3_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightyellow" stroke="black" points="224953.16,-104 224714.29,-104 224652.84,0 224891.71,0 224953.16,-104"/>
<text text-anchor="middle" x="224803" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="224803" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="224803" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="224803" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L3_EP1TP3PP0DP0_GPU56 -->
<g id="node1097" class="node">
<title>dispatch_L3_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="225092" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="225092" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="225092" y="-44" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP0_GPU56</text>
</g>
<!-- expert_0_L3_EP1TP3PP0DP0_GPU56 -->
<g id="node1098" class="node">
<title>expert_0_L3_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="225375.5,-78 225230.5,-78 225230.5,-26 225375.5,-26 225375.5,-78"/>
<text text-anchor="middle" x="225303" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="225303" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="225303" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="225303" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L3_EP1TP3PP0DP0_GPU56 -->
<g id="node1099" class="node">
<title>expert_1_L3_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="225556.5,-78 225411.5,-78 225411.5,-26 225556.5,-26 225556.5,-78"/>
<text text-anchor="middle" x="225484" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="225484" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="225484" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="225484" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L3_EP1TP3PP0DP0_GPU56 -->
<g id="node1100" class="node">
<title>expert_2_L3_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="225737.5,-78 225592.5,-78 225592.5,-26 225737.5,-26 225737.5,-78"/>
<text text-anchor="middle" x="225665" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="225665" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="225665" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="225665" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L3_EP1TP3PP0DP0_GPU56 -->
<g id="node1101" class="node">
<title>expert_3_L3_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="225918.5,-78 225773.5,-78 225773.5,-26 225918.5,-26 225918.5,-78"/>
<text text-anchor="middle" x="225846" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="225846" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="225846" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="225846" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L3_EP1TP3PP0DP0_GPU56 -->
<g id="node1102" class="node">
<title>combine_L3_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="226057" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="226057" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="226057" y="-44" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP0_GPU56</text>
</g>
<!-- ffn_L3_EP1TP3PP0DP0_GPU56 -->
<g id="node1103" class="node">
<title>ffn_L3_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="226366,-78 226196,-78 226196,-26 226366,-26 226366,-78"/>
<text text-anchor="middle" x="226281" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="226281" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="226281" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="226281" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L3_EP1TP3PP0DP0_GPU56 -->
<g id="node1104" class="node">
<title>ffn_ar_L3_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="226505" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="226505" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="226505" y="-49.5" font-family="Arial" font-size="10.00">L3 EP1 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="226505" y="-38.5" font-family="Arial" font-size="10.00">GPU56</text>
</g>
<!-- residual2_L3_EP1TP3PP0DP0_GPU56 -->
<g id="node1105" class="node">
<title>residual2_L3_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="226790,-78 226644,-78 226644,-26 226790,-26 226790,-78"/>
<text text-anchor="middle" x="226717" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="226717" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="226717" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="226717" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L3_EP1TP3PP0DP1_GPU57 -->
<g id="node1106" class="node">
<title>ln1_L3_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="226971.5,-78 226826.5,-78 226826.5,-26 226971.5,-26 226971.5,-78"/>
<text text-anchor="middle" x="226899" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="226899" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="226899" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="226899" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L3_EP1TP3PP0DP1_GPU57 -->
<g id="node1107" class="node">
<title>qkv_L3_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="227152.5,-78 227007.5,-78 227007.5,-26 227152.5,-26 227152.5,-78"/>
<text text-anchor="middle" x="227080" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="227080" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="227080" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="227080" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L3_EP1TP3PP0DP1_GPU57 -->
<g id="node1108" class="node">
<title>attn_L3_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="227339.5,-78 227188.5,-78 227188.5,-26 227339.5,-26 227339.5,-78"/>
<text text-anchor="middle" x="227264" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="227264" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="227264" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="227264" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L3_EP1TP3PP0DP1_GPU57 -->
<g id="node1109" class="node">
<title>attn_out_L3_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="227520.5,-78 227375.5,-78 227375.5,-26 227520.5,-26 227520.5,-78"/>
<text text-anchor="middle" x="227448" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="227448" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="227448" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="227448" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L3_EP1TP3PP0DP1_GPU57 -->
<g id="node1110" class="node">
<title>attn_ar_L3_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="227660" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="227660" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="227660" y="-49.5" font-family="Arial" font-size="10.00">L3 EP1 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="227660" y="-38.5" font-family="Arial" font-size="10.00">GPU57</text>
</g>
<!-- residual1_L3_EP1TP3PP0DP1_GPU57 -->
<g id="node1111" class="node">
<title>residual1_L3_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="227945,-78 227799,-78 227799,-26 227945,-26 227945,-78"/>
<text text-anchor="middle" x="227872" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="227872" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="227872" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="227872" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L3_EP1TP3PP0DP1_GPU57 -->
<g id="node1112" class="node">
<title>ln2_L3_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="228126.5,-78 227981.5,-78 227981.5,-26 228126.5,-26 228126.5,-78"/>
<text text-anchor="middle" x="228054" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="228054" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="228054" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="228054" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L3_EP1TP3PP0DP1_GPU57 -->
<g id="node1113" class="node">
<title>gate_L3_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightyellow" stroke="black" points="228463.16,-104 228224.29,-104 228162.84,0 228401.71,0 228463.16,-104"/>
<text text-anchor="middle" x="228313" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="228313" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="228313" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="228313" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L3_EP1TP3PP0DP1_GPU57 -->
<g id="node1114" class="node">
<title>dispatch_L3_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="228602" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="228602" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="228602" y="-44" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP1_GPU57</text>
</g>
<!-- expert_0_L3_EP1TP3PP0DP1_GPU57 -->
<g id="node1115" class="node">
<title>expert_0_L3_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="228885.5,-78 228740.5,-78 228740.5,-26 228885.5,-26 228885.5,-78"/>
<text text-anchor="middle" x="228813" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="228813" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="228813" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="228813" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L3_EP1TP3PP0DP1_GPU57 -->
<g id="node1116" class="node">
<title>expert_1_L3_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="229066.5,-78 228921.5,-78 228921.5,-26 229066.5,-26 229066.5,-78"/>
<text text-anchor="middle" x="228994" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="228994" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="228994" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="228994" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L3_EP1TP3PP0DP1_GPU57 -->
<g id="node1117" class="node">
<title>expert_2_L3_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="229247.5,-78 229102.5,-78 229102.5,-26 229247.5,-26 229247.5,-78"/>
<text text-anchor="middle" x="229175" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="229175" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="229175" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="229175" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L3_EP1TP3PP0DP1_GPU57 -->
<g id="node1118" class="node">
<title>expert_3_L3_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="229428.5,-78 229283.5,-78 229283.5,-26 229428.5,-26 229428.5,-78"/>
<text text-anchor="middle" x="229356" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="229356" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="229356" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="229356" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L3_EP1TP3PP0DP1_GPU57 -->
<g id="node1119" class="node">
<title>combine_L3_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="229567" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="229567" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="229567" y="-44" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP1_GPU57</text>
</g>
<!-- ffn_L3_EP1TP3PP0DP1_GPU57 -->
<g id="node1120" class="node">
<title>ffn_L3_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="229876,-78 229706,-78 229706,-26 229876,-26 229876,-78"/>
<text text-anchor="middle" x="229791" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="229791" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="229791" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="229791" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L3_EP1TP3PP0DP1_GPU57 -->
<g id="node1121" class="node">
<title>ffn_ar_L3_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="230015" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="230015" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="230015" y="-49.5" font-family="Arial" font-size="10.00">L3 EP1 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="230015" y="-38.5" font-family="Arial" font-size="10.00">GPU57</text>
</g>
<!-- residual2_L3_EP1TP3PP0DP1_GPU57 -->
<g id="node1122" class="node">
<title>residual2_L3_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="230300,-78 230154,-78 230154,-26 230300,-26 230300,-78"/>
<text text-anchor="middle" x="230227" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="230227" y="-55" font-family="Arial" font-size="10.00">L3_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="230227" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="230227" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L4_EP0TP0PP0DP0_GPU0 -->
<g id="node1123" class="node">
<title>ln1_L4_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="230478,-78 230336,-78 230336,-26 230478,-26 230478,-78"/>
<text text-anchor="middle" x="230407" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="230407" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="230407" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="230407" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L4_EP0TP0PP0DP0_GPU0 -->
<g id="node1124" class="node">
<title>qkv_L4_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="230656,-78 230514,-78 230514,-26 230656,-26 230656,-78"/>
<text text-anchor="middle" x="230585" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="230585" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="230585" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="230585" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L4_EP0TP0PP0DP0_GPU0 -->
<g id="node1125" class="node">
<title>attn_L4_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="230843.5,-78 230692.5,-78 230692.5,-26 230843.5,-26 230843.5,-78"/>
<text text-anchor="middle" x="230768" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="230768" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="230768" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="230768" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L4_EP0TP0PP0DP0_GPU0 -->
<g id="node1126" class="node">
<title>attn_out_L4_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="231022,-78 230880,-78 230880,-26 231022,-26 231022,-78"/>
<text text-anchor="middle" x="230951" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="230951" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="230951" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="230951" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L4_EP0TP0PP0DP0_GPU0 -->
<g id="node1127" class="node">
<title>attn_ar_L4_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="231161" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="231161" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="231161" y="-49.5" font-family="Arial" font-size="10.00">L4 EP0 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="231161" y="-38.5" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- residual1_L4_EP0TP0PP0DP0_GPU0 -->
<g id="node1128" class="node">
<title>residual1_L4_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="231446,-78 231300,-78 231300,-26 231446,-26 231446,-78"/>
<text text-anchor="middle" x="231373" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="231373" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="231373" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="231373" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L4_EP0TP0PP0DP0_GPU0 -->
<g id="node1129" class="node">
<title>ln2_L4_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="231624,-78 231482,-78 231482,-26 231624,-26 231624,-78"/>
<text text-anchor="middle" x="231553" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="231553" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="231553" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="231553" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L4_EP0TP0PP0DP0_GPU0 -->
<g id="node1130" class="node">
<title>gate_L4_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightyellow" stroke="black" points="231950.29,-104 231719.17,-104 231659.71,0 231890.83,0 231950.29,-104"/>
<text text-anchor="middle" x="231805" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="231805" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="231805" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="231805" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L4_EP0TP0PP0DP0_GPU0 -->
<g id="node1131" class="node">
<title>dispatch_L4_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="232085" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="232085" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="232085" y="-44" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP0_GPU0</text>
</g>
<!-- expert_0_L4_EP0TP0PP0DP0_GPU0 -->
<g id="node1132" class="node">
<title>expert_0_L4_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="232360,-78 232220,-78 232220,-26 232360,-26 232360,-78"/>
<text text-anchor="middle" x="232290" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="232290" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="232290" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="232290" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L4_EP0TP0PP0DP0_GPU0 -->
<g id="node1133" class="node">
<title>expert_1_L4_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="232536,-78 232396,-78 232396,-26 232536,-26 232536,-78"/>
<text text-anchor="middle" x="232466" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="232466" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="232466" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="232466" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L4_EP0TP0PP0DP0_GPU0 -->
<g id="node1134" class="node">
<title>expert_2_L4_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="232712,-78 232572,-78 232572,-26 232712,-26 232712,-78"/>
<text text-anchor="middle" x="232642" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="232642" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="232642" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="232642" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L4_EP0TP0PP0DP0_GPU0 -->
<g id="node1135" class="node">
<title>expert_3_L4_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="232888,-78 232748,-78 232748,-26 232888,-26 232888,-78"/>
<text text-anchor="middle" x="232818" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="232818" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="232818" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="232818" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L4_EP0TP0PP0DP0_GPU0 -->
<g id="node1136" class="node">
<title>combine_L4_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="233023" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="233023" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="233023" y="-44" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP0_GPU0</text>
</g>
<!-- ffn_L4_EP0TP0PP0DP0_GPU0 -->
<g id="node1137" class="node">
<title>ffn_L4_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="233328,-78 233158,-78 233158,-26 233328,-26 233328,-78"/>
<text text-anchor="middle" x="233243" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="233243" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="233243" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="233243" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L4_EP0TP0PP0DP0_GPU0 -->
<g id="node1138" class="node">
<title>ffn_ar_L4_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="233467" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="233467" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="233467" y="-49.5" font-family="Arial" font-size="10.00">L4 EP0 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="233467" y="-38.5" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- residual2_L4_EP0TP0PP0DP0_GPU0 -->
<g id="node1139" class="node">
<title>residual2_L4_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="233752,-78 233606,-78 233606,-26 233752,-26 233752,-78"/>
<text text-anchor="middle" x="233679" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="233679" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="233679" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="233679" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L4_EP0TP0PP0DP1_GPU1 -->
<g id="node1140" class="node">
<title>ln1_L4_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="233930,-78 233788,-78 233788,-26 233930,-26 233930,-78"/>
<text text-anchor="middle" x="233859" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="233859" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="233859" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="233859" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L4_EP0TP0PP0DP1_GPU1 -->
<g id="node1141" class="node">
<title>qkv_L4_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="234108,-78 233966,-78 233966,-26 234108,-26 234108,-78"/>
<text text-anchor="middle" x="234037" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="234037" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="234037" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="234037" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L4_EP0TP0PP0DP1_GPU1 -->
<g id="node1142" class="node">
<title>attn_L4_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="234295.5,-78 234144.5,-78 234144.5,-26 234295.5,-26 234295.5,-78"/>
<text text-anchor="middle" x="234220" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="234220" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="234220" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="234220" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L4_EP0TP0PP0DP1_GPU1 -->
<g id="node1143" class="node">
<title>attn_out_L4_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="234474,-78 234332,-78 234332,-26 234474,-26 234474,-78"/>
<text text-anchor="middle" x="234403" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="234403" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="234403" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="234403" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L4_EP0TP0PP0DP1_GPU1 -->
<g id="node1144" class="node">
<title>attn_ar_L4_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="234613" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="234613" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="234613" y="-49.5" font-family="Arial" font-size="10.00">L4 EP0 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="234613" y="-38.5" font-family="Arial" font-size="10.00">GPU1</text>
</g>
<!-- residual1_L4_EP0TP0PP0DP1_GPU1 -->
<g id="node1145" class="node">
<title>residual1_L4_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="234898,-78 234752,-78 234752,-26 234898,-26 234898,-78"/>
<text text-anchor="middle" x="234825" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="234825" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="234825" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="234825" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L4_EP0TP0PP0DP1_GPU1 -->
<g id="node1146" class="node">
<title>ln2_L4_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="235076,-78 234934,-78 234934,-26 235076,-26 235076,-78"/>
<text text-anchor="middle" x="235005" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="235005" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="235005" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="235005" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L4_EP0TP0PP0DP1_GPU1 -->
<g id="node1147" class="node">
<title>gate_L4_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightyellow" stroke="black" points="235402.29,-104 235171.17,-104 235111.71,0 235342.83,0 235402.29,-104"/>
<text text-anchor="middle" x="235257" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="235257" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="235257" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="235257" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L4_EP0TP0PP0DP1_GPU1 -->
<g id="node1148" class="node">
<title>dispatch_L4_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="235537" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="235537" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="235537" y="-44" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP1_GPU1</text>
</g>
<!-- expert_0_L4_EP0TP0PP0DP1_GPU1 -->
<g id="node1149" class="node">
<title>expert_0_L4_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="235812,-78 235672,-78 235672,-26 235812,-26 235812,-78"/>
<text text-anchor="middle" x="235742" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="235742" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="235742" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="235742" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L4_EP0TP0PP0DP1_GPU1 -->
<g id="node1150" class="node">
<title>expert_1_L4_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="235988,-78 235848,-78 235848,-26 235988,-26 235988,-78"/>
<text text-anchor="middle" x="235918" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="235918" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="235918" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="235918" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L4_EP0TP0PP0DP1_GPU1 -->
<g id="node1151" class="node">
<title>expert_2_L4_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="236164,-78 236024,-78 236024,-26 236164,-26 236164,-78"/>
<text text-anchor="middle" x="236094" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="236094" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="236094" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="236094" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L4_EP0TP0PP0DP1_GPU1 -->
<g id="node1152" class="node">
<title>expert_3_L4_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="236340,-78 236200,-78 236200,-26 236340,-26 236340,-78"/>
<text text-anchor="middle" x="236270" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="236270" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="236270" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="236270" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L4_EP0TP0PP0DP1_GPU1 -->
<g id="node1153" class="node">
<title>combine_L4_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="236475" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="236475" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="236475" y="-44" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP1_GPU1</text>
</g>
<!-- ffn_L4_EP0TP0PP0DP1_GPU1 -->
<g id="node1154" class="node">
<title>ffn_L4_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="236780,-78 236610,-78 236610,-26 236780,-26 236780,-78"/>
<text text-anchor="middle" x="236695" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="236695" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="236695" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="236695" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L4_EP0TP0PP0DP1_GPU1 -->
<g id="node1155" class="node">
<title>ffn_ar_L4_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="236919" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="236919" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="236919" y="-49.5" font-family="Arial" font-size="10.00">L4 EP0 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="236919" y="-38.5" font-family="Arial" font-size="10.00">GPU1</text>
</g>
<!-- residual2_L4_EP0TP0PP0DP1_GPU1 -->
<g id="node1156" class="node">
<title>residual2_L4_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="237204,-78 237058,-78 237058,-26 237204,-26 237204,-78"/>
<text text-anchor="middle" x="237131" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="237131" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="237131" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="237131" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L4_EP0TP1PP0DP0_GPU8 -->
<g id="node1157" class="node">
<title>ln1_L4_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="237382,-78 237240,-78 237240,-26 237382,-26 237382,-78"/>
<text text-anchor="middle" x="237311" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="237311" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="237311" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="237311" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L4_EP0TP1PP0DP0_GPU8 -->
<g id="node1158" class="node">
<title>qkv_L4_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="237560,-78 237418,-78 237418,-26 237560,-26 237560,-78"/>
<text text-anchor="middle" x="237489" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="237489" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="237489" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="237489" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L4_EP0TP1PP0DP0_GPU8 -->
<g id="node1159" class="node">
<title>attn_L4_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="237747.5,-78 237596.5,-78 237596.5,-26 237747.5,-26 237747.5,-78"/>
<text text-anchor="middle" x="237672" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="237672" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="237672" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="237672" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L4_EP0TP1PP0DP0_GPU8 -->
<g id="node1160" class="node">
<title>attn_out_L4_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="237926,-78 237784,-78 237784,-26 237926,-26 237926,-78"/>
<text text-anchor="middle" x="237855" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="237855" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="237855" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="237855" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L4_EP0TP1PP0DP0_GPU8 -->
<g id="node1161" class="node">
<title>attn_ar_L4_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="238065" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="238065" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="238065" y="-49.5" font-family="Arial" font-size="10.00">L4 EP0 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="238065" y="-38.5" font-family="Arial" font-size="10.00">GPU8</text>
</g>
<!-- residual1_L4_EP0TP1PP0DP0_GPU8 -->
<g id="node1162" class="node">
<title>residual1_L4_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="238350,-78 238204,-78 238204,-26 238350,-26 238350,-78"/>
<text text-anchor="middle" x="238277" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="238277" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="238277" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="238277" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L4_EP0TP1PP0DP0_GPU8 -->
<g id="node1163" class="node">
<title>ln2_L4_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="238528,-78 238386,-78 238386,-26 238528,-26 238528,-78"/>
<text text-anchor="middle" x="238457" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="238457" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="238457" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="238457" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L4_EP0TP1PP0DP0_GPU8 -->
<g id="node1164" class="node">
<title>gate_L4_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightyellow" stroke="black" points="238854.29,-104 238623.17,-104 238563.71,0 238794.83,0 238854.29,-104"/>
<text text-anchor="middle" x="238709" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="238709" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="238709" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="238709" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L4_EP0TP1PP0DP0_GPU8 -->
<g id="node1165" class="node">
<title>dispatch_L4_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="238989" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="238989" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="238989" y="-44" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP0_GPU8</text>
</g>
<!-- expert_0_L4_EP0TP1PP0DP0_GPU8 -->
<g id="node1166" class="node">
<title>expert_0_L4_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="239264,-78 239124,-78 239124,-26 239264,-26 239264,-78"/>
<text text-anchor="middle" x="239194" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="239194" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="239194" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="239194" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L4_EP0TP1PP0DP0_GPU8 -->
<g id="node1167" class="node">
<title>expert_1_L4_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="239440,-78 239300,-78 239300,-26 239440,-26 239440,-78"/>
<text text-anchor="middle" x="239370" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="239370" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="239370" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="239370" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L4_EP0TP1PP0DP0_GPU8 -->
<g id="node1168" class="node">
<title>expert_2_L4_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="239616,-78 239476,-78 239476,-26 239616,-26 239616,-78"/>
<text text-anchor="middle" x="239546" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="239546" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="239546" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="239546" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L4_EP0TP1PP0DP0_GPU8 -->
<g id="node1169" class="node">
<title>expert_3_L4_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="239792,-78 239652,-78 239652,-26 239792,-26 239792,-78"/>
<text text-anchor="middle" x="239722" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="239722" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="239722" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="239722" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L4_EP0TP1PP0DP0_GPU8 -->
<g id="node1170" class="node">
<title>combine_L4_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="239927" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="239927" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="239927" y="-44" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP0_GPU8</text>
</g>
<!-- ffn_L4_EP0TP1PP0DP0_GPU8 -->
<g id="node1171" class="node">
<title>ffn_L4_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="240232,-78 240062,-78 240062,-26 240232,-26 240232,-78"/>
<text text-anchor="middle" x="240147" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="240147" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="240147" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="240147" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L4_EP0TP1PP0DP0_GPU8 -->
<g id="node1172" class="node">
<title>ffn_ar_L4_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="240371" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="240371" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="240371" y="-49.5" font-family="Arial" font-size="10.00">L4 EP0 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="240371" y="-38.5" font-family="Arial" font-size="10.00">GPU8</text>
</g>
<!-- residual2_L4_EP0TP1PP0DP0_GPU8 -->
<g id="node1173" class="node">
<title>residual2_L4_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="240656,-78 240510,-78 240510,-26 240656,-26 240656,-78"/>
<text text-anchor="middle" x="240583" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="240583" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="240583" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="240583" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L4_EP0TP1PP0DP1_GPU9 -->
<g id="node1174" class="node">
<title>ln1_L4_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="240834,-78 240692,-78 240692,-26 240834,-26 240834,-78"/>
<text text-anchor="middle" x="240763" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="240763" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="240763" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="240763" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L4_EP0TP1PP0DP1_GPU9 -->
<g id="node1175" class="node">
<title>qkv_L4_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="241012,-78 240870,-78 240870,-26 241012,-26 241012,-78"/>
<text text-anchor="middle" x="240941" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="240941" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="240941" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="240941" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L4_EP0TP1PP0DP1_GPU9 -->
<g id="node1176" class="node">
<title>attn_L4_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="241199.5,-78 241048.5,-78 241048.5,-26 241199.5,-26 241199.5,-78"/>
<text text-anchor="middle" x="241124" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="241124" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="241124" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="241124" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L4_EP0TP1PP0DP1_GPU9 -->
<g id="node1177" class="node">
<title>attn_out_L4_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="241378,-78 241236,-78 241236,-26 241378,-26 241378,-78"/>
<text text-anchor="middle" x="241307" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="241307" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="241307" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="241307" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L4_EP0TP1PP0DP1_GPU9 -->
<g id="node1178" class="node">
<title>attn_ar_L4_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="241517" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="241517" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="241517" y="-49.5" font-family="Arial" font-size="10.00">L4 EP0 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="241517" y="-38.5" font-family="Arial" font-size="10.00">GPU9</text>
</g>
<!-- residual1_L4_EP0TP1PP0DP1_GPU9 -->
<g id="node1179" class="node">
<title>residual1_L4_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="241802,-78 241656,-78 241656,-26 241802,-26 241802,-78"/>
<text text-anchor="middle" x="241729" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="241729" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="241729" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="241729" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L4_EP0TP1PP0DP1_GPU9 -->
<g id="node1180" class="node">
<title>ln2_L4_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="241980,-78 241838,-78 241838,-26 241980,-26 241980,-78"/>
<text text-anchor="middle" x="241909" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="241909" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="241909" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="241909" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L4_EP0TP1PP0DP1_GPU9 -->
<g id="node1181" class="node">
<title>gate_L4_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightyellow" stroke="black" points="242306.29,-104 242075.17,-104 242015.71,0 242246.83,0 242306.29,-104"/>
<text text-anchor="middle" x="242161" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="242161" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="242161" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="242161" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L4_EP0TP1PP0DP1_GPU9 -->
<g id="node1182" class="node">
<title>dispatch_L4_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="242441" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="242441" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="242441" y="-44" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP1_GPU9</text>
</g>
<!-- expert_0_L4_EP0TP1PP0DP1_GPU9 -->
<g id="node1183" class="node">
<title>expert_0_L4_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="242716,-78 242576,-78 242576,-26 242716,-26 242716,-78"/>
<text text-anchor="middle" x="242646" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="242646" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="242646" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="242646" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L4_EP0TP1PP0DP1_GPU9 -->
<g id="node1184" class="node">
<title>expert_1_L4_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="242892,-78 242752,-78 242752,-26 242892,-26 242892,-78"/>
<text text-anchor="middle" x="242822" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="242822" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="242822" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="242822" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L4_EP0TP1PP0DP1_GPU9 -->
<g id="node1185" class="node">
<title>expert_2_L4_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="243068,-78 242928,-78 242928,-26 243068,-26 243068,-78"/>
<text text-anchor="middle" x="242998" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="242998" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="242998" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="242998" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L4_EP0TP1PP0DP1_GPU9 -->
<g id="node1186" class="node">
<title>expert_3_L4_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="243244,-78 243104,-78 243104,-26 243244,-26 243244,-78"/>
<text text-anchor="middle" x="243174" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="243174" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="243174" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="243174" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L4_EP0TP1PP0DP1_GPU9 -->
<g id="node1187" class="node">
<title>combine_L4_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="243379" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="243379" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="243379" y="-44" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP1_GPU9</text>
</g>
<!-- ffn_L4_EP0TP1PP0DP1_GPU9 -->
<g id="node1188" class="node">
<title>ffn_L4_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="243684,-78 243514,-78 243514,-26 243684,-26 243684,-78"/>
<text text-anchor="middle" x="243599" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="243599" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="243599" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="243599" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L4_EP0TP1PP0DP1_GPU9 -->
<g id="node1189" class="node">
<title>ffn_ar_L4_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="243823" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="243823" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="243823" y="-49.5" font-family="Arial" font-size="10.00">L4 EP0 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="243823" y="-38.5" font-family="Arial" font-size="10.00">GPU9</text>
</g>
<!-- residual2_L4_EP0TP1PP0DP1_GPU9 -->
<g id="node1190" class="node">
<title>residual2_L4_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="244108,-78 243962,-78 243962,-26 244108,-26 244108,-78"/>
<text text-anchor="middle" x="244035" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="244035" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="244035" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="244035" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L4_EP0TP2PP0DP0_GPU16 -->
<g id="node1191" class="node">
<title>ln1_L4_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="244289.5,-78 244144.5,-78 244144.5,-26 244289.5,-26 244289.5,-78"/>
<text text-anchor="middle" x="244217" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="244217" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="244217" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="244217" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L4_EP0TP2PP0DP0_GPU16 -->
<g id="node1192" class="node">
<title>qkv_L4_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="244470.5,-78 244325.5,-78 244325.5,-26 244470.5,-26 244470.5,-78"/>
<text text-anchor="middle" x="244398" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="244398" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="244398" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="244398" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L4_EP0TP2PP0DP0_GPU16 -->
<g id="node1193" class="node">
<title>attn_L4_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="244657.5,-78 244506.5,-78 244506.5,-26 244657.5,-26 244657.5,-78"/>
<text text-anchor="middle" x="244582" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="244582" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="244582" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="244582" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L4_EP0TP2PP0DP0_GPU16 -->
<g id="node1194" class="node">
<title>attn_out_L4_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="244838.5,-78 244693.5,-78 244693.5,-26 244838.5,-26 244838.5,-78"/>
<text text-anchor="middle" x="244766" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="244766" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="244766" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="244766" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L4_EP0TP2PP0DP0_GPU16 -->
<g id="node1195" class="node">
<title>attn_ar_L4_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="244978" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="244978" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="244978" y="-49.5" font-family="Arial" font-size="10.00">L4 EP0 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="244978" y="-38.5" font-family="Arial" font-size="10.00">GPU16</text>
</g>
<!-- residual1_L4_EP0TP2PP0DP0_GPU16 -->
<g id="node1196" class="node">
<title>residual1_L4_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="245263,-78 245117,-78 245117,-26 245263,-26 245263,-78"/>
<text text-anchor="middle" x="245190" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="245190" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="245190" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="245190" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L4_EP0TP2PP0DP0_GPU16 -->
<g id="node1197" class="node">
<title>ln2_L4_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="245444.5,-78 245299.5,-78 245299.5,-26 245444.5,-26 245444.5,-78"/>
<text text-anchor="middle" x="245372" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="245372" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="245372" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="245372" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L4_EP0TP2PP0DP0_GPU16 -->
<g id="node1198" class="node">
<title>gate_L4_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightyellow" stroke="black" points="245781.16,-104 245542.29,-104 245480.84,0 245719.71,0 245781.16,-104"/>
<text text-anchor="middle" x="245631" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="245631" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="245631" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="245631" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L4_EP0TP2PP0DP0_GPU16 -->
<g id="node1199" class="node">
<title>dispatch_L4_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="245920" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="245920" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="245920" y="-44" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP0_GPU16</text>
</g>
<!-- expert_0_L4_EP0TP2PP0DP0_GPU16 -->
<g id="node1200" class="node">
<title>expert_0_L4_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="246203.5,-78 246058.5,-78 246058.5,-26 246203.5,-26 246203.5,-78"/>
<text text-anchor="middle" x="246131" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="246131" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="246131" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="246131" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L4_EP0TP2PP0DP0_GPU16 -->
<g id="node1201" class="node">
<title>expert_1_L4_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="246384.5,-78 246239.5,-78 246239.5,-26 246384.5,-26 246384.5,-78"/>
<text text-anchor="middle" x="246312" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="246312" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="246312" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="246312" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L4_EP0TP2PP0DP0_GPU16 -->
<g id="node1202" class="node">
<title>expert_2_L4_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="246565.5,-78 246420.5,-78 246420.5,-26 246565.5,-26 246565.5,-78"/>
<text text-anchor="middle" x="246493" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="246493" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="246493" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="246493" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L4_EP0TP2PP0DP0_GPU16 -->
<g id="node1203" class="node">
<title>expert_3_L4_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="246746.5,-78 246601.5,-78 246601.5,-26 246746.5,-26 246746.5,-78"/>
<text text-anchor="middle" x="246674" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="246674" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="246674" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="246674" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L4_EP0TP2PP0DP0_GPU16 -->
<g id="node1204" class="node">
<title>combine_L4_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="246885" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="246885" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="246885" y="-44" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP0_GPU16</text>
</g>
<!-- ffn_L4_EP0TP2PP0DP0_GPU16 -->
<g id="node1205" class="node">
<title>ffn_L4_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="247194,-78 247024,-78 247024,-26 247194,-26 247194,-78"/>
<text text-anchor="middle" x="247109" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="247109" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="247109" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="247109" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L4_EP0TP2PP0DP0_GPU16 -->
<g id="node1206" class="node">
<title>ffn_ar_L4_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="247333" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="247333" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="247333" y="-49.5" font-family="Arial" font-size="10.00">L4 EP0 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="247333" y="-38.5" font-family="Arial" font-size="10.00">GPU16</text>
</g>
<!-- residual2_L4_EP0TP2PP0DP0_GPU16 -->
<g id="node1207" class="node">
<title>residual2_L4_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="247618,-78 247472,-78 247472,-26 247618,-26 247618,-78"/>
<text text-anchor="middle" x="247545" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="247545" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="247545" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="247545" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L4_EP0TP2PP0DP1_GPU17 -->
<g id="node1208" class="node">
<title>ln1_L4_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="247799.5,-78 247654.5,-78 247654.5,-26 247799.5,-26 247799.5,-78"/>
<text text-anchor="middle" x="247727" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="247727" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="247727" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="247727" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L4_EP0TP2PP0DP1_GPU17 -->
<g id="node1209" class="node">
<title>qkv_L4_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="247980.5,-78 247835.5,-78 247835.5,-26 247980.5,-26 247980.5,-78"/>
<text text-anchor="middle" x="247908" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="247908" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="247908" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="247908" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L4_EP0TP2PP0DP1_GPU17 -->
<g id="node1210" class="node">
<title>attn_L4_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="248167.5,-78 248016.5,-78 248016.5,-26 248167.5,-26 248167.5,-78"/>
<text text-anchor="middle" x="248092" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="248092" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="248092" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="248092" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L4_EP0TP2PP0DP1_GPU17 -->
<g id="node1211" class="node">
<title>attn_out_L4_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="248348.5,-78 248203.5,-78 248203.5,-26 248348.5,-26 248348.5,-78"/>
<text text-anchor="middle" x="248276" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="248276" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="248276" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="248276" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L4_EP0TP2PP0DP1_GPU17 -->
<g id="node1212" class="node">
<title>attn_ar_L4_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="248488" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="248488" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="248488" y="-49.5" font-family="Arial" font-size="10.00">L4 EP0 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="248488" y="-38.5" font-family="Arial" font-size="10.00">GPU17</text>
</g>
<!-- residual1_L4_EP0TP2PP0DP1_GPU17 -->
<g id="node1213" class="node">
<title>residual1_L4_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="248773,-78 248627,-78 248627,-26 248773,-26 248773,-78"/>
<text text-anchor="middle" x="248700" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="248700" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="248700" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="248700" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L4_EP0TP2PP0DP1_GPU17 -->
<g id="node1214" class="node">
<title>ln2_L4_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="248954.5,-78 248809.5,-78 248809.5,-26 248954.5,-26 248954.5,-78"/>
<text text-anchor="middle" x="248882" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="248882" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="248882" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="248882" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L4_EP0TP2PP0DP1_GPU17 -->
<g id="node1215" class="node">
<title>gate_L4_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightyellow" stroke="black" points="249291.16,-104 249052.29,-104 248990.84,0 249229.71,0 249291.16,-104"/>
<text text-anchor="middle" x="249141" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="249141" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="249141" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="249141" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L4_EP0TP2PP0DP1_GPU17 -->
<g id="node1216" class="node">
<title>dispatch_L4_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="249430" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="249430" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="249430" y="-44" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP1_GPU17</text>
</g>
<!-- expert_0_L4_EP0TP2PP0DP1_GPU17 -->
<g id="node1217" class="node">
<title>expert_0_L4_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="249713.5,-78 249568.5,-78 249568.5,-26 249713.5,-26 249713.5,-78"/>
<text text-anchor="middle" x="249641" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="249641" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="249641" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="249641" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L4_EP0TP2PP0DP1_GPU17 -->
<g id="node1218" class="node">
<title>expert_1_L4_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="249894.5,-78 249749.5,-78 249749.5,-26 249894.5,-26 249894.5,-78"/>
<text text-anchor="middle" x="249822" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="249822" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="249822" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="249822" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L4_EP0TP2PP0DP1_GPU17 -->
<g id="node1219" class="node">
<title>expert_2_L4_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="250075.5,-78 249930.5,-78 249930.5,-26 250075.5,-26 250075.5,-78"/>
<text text-anchor="middle" x="250003" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="250003" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="250003" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="250003" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L4_EP0TP2PP0DP1_GPU17 -->
<g id="node1220" class="node">
<title>expert_3_L4_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="250256.5,-78 250111.5,-78 250111.5,-26 250256.5,-26 250256.5,-78"/>
<text text-anchor="middle" x="250184" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="250184" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="250184" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="250184" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L4_EP0TP2PP0DP1_GPU17 -->
<g id="node1221" class="node">
<title>combine_L4_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="250395" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="250395" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="250395" y="-44" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP1_GPU17</text>
</g>
<!-- ffn_L4_EP0TP2PP0DP1_GPU17 -->
<g id="node1222" class="node">
<title>ffn_L4_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="250704,-78 250534,-78 250534,-26 250704,-26 250704,-78"/>
<text text-anchor="middle" x="250619" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="250619" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="250619" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="250619" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L4_EP0TP2PP0DP1_GPU17 -->
<g id="node1223" class="node">
<title>ffn_ar_L4_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="250843" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="250843" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="250843" y="-49.5" font-family="Arial" font-size="10.00">L4 EP0 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="250843" y="-38.5" font-family="Arial" font-size="10.00">GPU17</text>
</g>
<!-- residual2_L4_EP0TP2PP0DP1_GPU17 -->
<g id="node1224" class="node">
<title>residual2_L4_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="251128,-78 250982,-78 250982,-26 251128,-26 251128,-78"/>
<text text-anchor="middle" x="251055" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="251055" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="251055" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="251055" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L4_EP0TP3PP0DP0_GPU24 -->
<g id="node1225" class="node">
<title>ln1_L4_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="251309.5,-78 251164.5,-78 251164.5,-26 251309.5,-26 251309.5,-78"/>
<text text-anchor="middle" x="251237" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="251237" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="251237" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="251237" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L4_EP0TP3PP0DP0_GPU24 -->
<g id="node1226" class="node">
<title>qkv_L4_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="251490.5,-78 251345.5,-78 251345.5,-26 251490.5,-26 251490.5,-78"/>
<text text-anchor="middle" x="251418" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="251418" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="251418" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="251418" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L4_EP0TP3PP0DP0_GPU24 -->
<g id="node1227" class="node">
<title>attn_L4_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="251677.5,-78 251526.5,-78 251526.5,-26 251677.5,-26 251677.5,-78"/>
<text text-anchor="middle" x="251602" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="251602" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="251602" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="251602" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L4_EP0TP3PP0DP0_GPU24 -->
<g id="node1228" class="node">
<title>attn_out_L4_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="251858.5,-78 251713.5,-78 251713.5,-26 251858.5,-26 251858.5,-78"/>
<text text-anchor="middle" x="251786" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="251786" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="251786" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="251786" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L4_EP0TP3PP0DP0_GPU24 -->
<g id="node1229" class="node">
<title>attn_ar_L4_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="251998" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="251998" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="251998" y="-49.5" font-family="Arial" font-size="10.00">L4 EP0 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="251998" y="-38.5" font-family="Arial" font-size="10.00">GPU24</text>
</g>
<!-- residual1_L4_EP0TP3PP0DP0_GPU24 -->
<g id="node1230" class="node">
<title>residual1_L4_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="252283,-78 252137,-78 252137,-26 252283,-26 252283,-78"/>
<text text-anchor="middle" x="252210" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="252210" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="252210" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="252210" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L4_EP0TP3PP0DP0_GPU24 -->
<g id="node1231" class="node">
<title>ln2_L4_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="252464.5,-78 252319.5,-78 252319.5,-26 252464.5,-26 252464.5,-78"/>
<text text-anchor="middle" x="252392" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="252392" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="252392" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="252392" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L4_EP0TP3PP0DP0_GPU24 -->
<g id="node1232" class="node">
<title>gate_L4_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightyellow" stroke="black" points="252801.16,-104 252562.29,-104 252500.84,0 252739.71,0 252801.16,-104"/>
<text text-anchor="middle" x="252651" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="252651" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="252651" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="252651" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L4_EP0TP3PP0DP0_GPU24 -->
<g id="node1233" class="node">
<title>dispatch_L4_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="252940" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="252940" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="252940" y="-44" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP0_GPU24</text>
</g>
<!-- expert_0_L4_EP0TP3PP0DP0_GPU24 -->
<g id="node1234" class="node">
<title>expert_0_L4_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="253223.5,-78 253078.5,-78 253078.5,-26 253223.5,-26 253223.5,-78"/>
<text text-anchor="middle" x="253151" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="253151" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="253151" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="253151" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L4_EP0TP3PP0DP0_GPU24 -->
<g id="node1235" class="node">
<title>expert_1_L4_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="253404.5,-78 253259.5,-78 253259.5,-26 253404.5,-26 253404.5,-78"/>
<text text-anchor="middle" x="253332" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="253332" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="253332" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="253332" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L4_EP0TP3PP0DP0_GPU24 -->
<g id="node1236" class="node">
<title>expert_2_L4_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="253585.5,-78 253440.5,-78 253440.5,-26 253585.5,-26 253585.5,-78"/>
<text text-anchor="middle" x="253513" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="253513" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="253513" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="253513" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L4_EP0TP3PP0DP0_GPU24 -->
<g id="node1237" class="node">
<title>expert_3_L4_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="253766.5,-78 253621.5,-78 253621.5,-26 253766.5,-26 253766.5,-78"/>
<text text-anchor="middle" x="253694" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="253694" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="253694" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="253694" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L4_EP0TP3PP0DP0_GPU24 -->
<g id="node1238" class="node">
<title>combine_L4_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="253905" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="253905" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="253905" y="-44" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP0_GPU24</text>
</g>
<!-- ffn_L4_EP0TP3PP0DP0_GPU24 -->
<g id="node1239" class="node">
<title>ffn_L4_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="254214,-78 254044,-78 254044,-26 254214,-26 254214,-78"/>
<text text-anchor="middle" x="254129" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="254129" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="254129" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="254129" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L4_EP0TP3PP0DP0_GPU24 -->
<g id="node1240" class="node">
<title>ffn_ar_L4_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="254353" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="254353" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="254353" y="-49.5" font-family="Arial" font-size="10.00">L4 EP0 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="254353" y="-38.5" font-family="Arial" font-size="10.00">GPU24</text>
</g>
<!-- residual2_L4_EP0TP3PP0DP0_GPU24 -->
<g id="node1241" class="node">
<title>residual2_L4_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="254638,-78 254492,-78 254492,-26 254638,-26 254638,-78"/>
<text text-anchor="middle" x="254565" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="254565" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="254565" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="254565" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L4_EP0TP3PP0DP1_GPU25 -->
<g id="node1242" class="node">
<title>ln1_L4_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="254819.5,-78 254674.5,-78 254674.5,-26 254819.5,-26 254819.5,-78"/>
<text text-anchor="middle" x="254747" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="254747" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="254747" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="254747" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L4_EP0TP3PP0DP1_GPU25 -->
<g id="node1243" class="node">
<title>qkv_L4_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="255000.5,-78 254855.5,-78 254855.5,-26 255000.5,-26 255000.5,-78"/>
<text text-anchor="middle" x="254928" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="254928" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="254928" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="254928" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L4_EP0TP3PP0DP1_GPU25 -->
<g id="node1244" class="node">
<title>attn_L4_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="255187.5,-78 255036.5,-78 255036.5,-26 255187.5,-26 255187.5,-78"/>
<text text-anchor="middle" x="255112" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="255112" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="255112" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="255112" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L4_EP0TP3PP0DP1_GPU25 -->
<g id="node1245" class="node">
<title>attn_out_L4_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="255368.5,-78 255223.5,-78 255223.5,-26 255368.5,-26 255368.5,-78"/>
<text text-anchor="middle" x="255296" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="255296" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="255296" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="255296" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L4_EP0TP3PP0DP1_GPU25 -->
<g id="node1246" class="node">
<title>attn_ar_L4_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="255508" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="255508" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="255508" y="-49.5" font-family="Arial" font-size="10.00">L4 EP0 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="255508" y="-38.5" font-family="Arial" font-size="10.00">GPU25</text>
</g>
<!-- residual1_L4_EP0TP3PP0DP1_GPU25 -->
<g id="node1247" class="node">
<title>residual1_L4_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="255793,-78 255647,-78 255647,-26 255793,-26 255793,-78"/>
<text text-anchor="middle" x="255720" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="255720" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="255720" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="255720" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L4_EP0TP3PP0DP1_GPU25 -->
<g id="node1248" class="node">
<title>ln2_L4_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="255974.5,-78 255829.5,-78 255829.5,-26 255974.5,-26 255974.5,-78"/>
<text text-anchor="middle" x="255902" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="255902" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="255902" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="255902" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L4_EP0TP3PP0DP1_GPU25 -->
<g id="node1249" class="node">
<title>gate_L4_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightyellow" stroke="black" points="256311.16,-104 256072.29,-104 256010.84,0 256249.71,0 256311.16,-104"/>
<text text-anchor="middle" x="256161" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="256161" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="256161" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="256161" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L4_EP0TP3PP0DP1_GPU25 -->
<g id="node1250" class="node">
<title>dispatch_L4_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="256450" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="256450" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="256450" y="-44" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP1_GPU25</text>
</g>
<!-- expert_0_L4_EP0TP3PP0DP1_GPU25 -->
<g id="node1251" class="node">
<title>expert_0_L4_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="256733.5,-78 256588.5,-78 256588.5,-26 256733.5,-26 256733.5,-78"/>
<text text-anchor="middle" x="256661" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="256661" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="256661" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="256661" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L4_EP0TP3PP0DP1_GPU25 -->
<g id="node1252" class="node">
<title>expert_1_L4_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="256914.5,-78 256769.5,-78 256769.5,-26 256914.5,-26 256914.5,-78"/>
<text text-anchor="middle" x="256842" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="256842" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="256842" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="256842" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L4_EP0TP3PP0DP1_GPU25 -->
<g id="node1253" class="node">
<title>expert_2_L4_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="257095.5,-78 256950.5,-78 256950.5,-26 257095.5,-26 257095.5,-78"/>
<text text-anchor="middle" x="257023" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="257023" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="257023" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="257023" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L4_EP0TP3PP0DP1_GPU25 -->
<g id="node1254" class="node">
<title>expert_3_L4_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="257276.5,-78 257131.5,-78 257131.5,-26 257276.5,-26 257276.5,-78"/>
<text text-anchor="middle" x="257204" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="257204" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="257204" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="257204" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L4_EP0TP3PP0DP1_GPU25 -->
<g id="node1255" class="node">
<title>combine_L4_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="257415" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="257415" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="257415" y="-44" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP1_GPU25</text>
</g>
<!-- ffn_L4_EP0TP3PP0DP1_GPU25 -->
<g id="node1256" class="node">
<title>ffn_L4_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="257724,-78 257554,-78 257554,-26 257724,-26 257724,-78"/>
<text text-anchor="middle" x="257639" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="257639" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="257639" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="257639" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L4_EP0TP3PP0DP1_GPU25 -->
<g id="node1257" class="node">
<title>ffn_ar_L4_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="257863" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="257863" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="257863" y="-49.5" font-family="Arial" font-size="10.00">L4 EP0 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="257863" y="-38.5" font-family="Arial" font-size="10.00">GPU25</text>
</g>
<!-- residual2_L4_EP0TP3PP0DP1_GPU25 -->
<g id="node1258" class="node">
<title>residual2_L4_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="258148,-78 258002,-78 258002,-26 258148,-26 258148,-78"/>
<text text-anchor="middle" x="258075" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="258075" y="-55" font-family="Arial" font-size="10.00">L4_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="258075" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="258075" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L4_EP1TP0PP0DP0_GPU32 -->
<g id="node1259" class="node">
<title>ln1_L4_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="258329.5,-78 258184.5,-78 258184.5,-26 258329.5,-26 258329.5,-78"/>
<text text-anchor="middle" x="258257" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="258257" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="258257" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="258257" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L4_EP1TP0PP0DP0_GPU32 -->
<g id="node1260" class="node">
<title>qkv_L4_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="258510.5,-78 258365.5,-78 258365.5,-26 258510.5,-26 258510.5,-78"/>
<text text-anchor="middle" x="258438" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="258438" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="258438" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="258438" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L4_EP1TP0PP0DP0_GPU32 -->
<g id="node1261" class="node">
<title>attn_L4_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="258697.5,-78 258546.5,-78 258546.5,-26 258697.5,-26 258697.5,-78"/>
<text text-anchor="middle" x="258622" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="258622" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="258622" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="258622" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L4_EP1TP0PP0DP0_GPU32 -->
<g id="node1262" class="node">
<title>attn_out_L4_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="258878.5,-78 258733.5,-78 258733.5,-26 258878.5,-26 258878.5,-78"/>
<text text-anchor="middle" x="258806" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="258806" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="258806" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="258806" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L4_EP1TP0PP0DP0_GPU32 -->
<g id="node1263" class="node">
<title>attn_ar_L4_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="259018" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="259018" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="259018" y="-49.5" font-family="Arial" font-size="10.00">L4 EP1 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="259018" y="-38.5" font-family="Arial" font-size="10.00">GPU32</text>
</g>
<!-- residual1_L4_EP1TP0PP0DP0_GPU32 -->
<g id="node1264" class="node">
<title>residual1_L4_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="259303,-78 259157,-78 259157,-26 259303,-26 259303,-78"/>
<text text-anchor="middle" x="259230" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="259230" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="259230" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="259230" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L4_EP1TP0PP0DP0_GPU32 -->
<g id="node1265" class="node">
<title>ln2_L4_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="259484.5,-78 259339.5,-78 259339.5,-26 259484.5,-26 259484.5,-78"/>
<text text-anchor="middle" x="259412" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="259412" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="259412" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="259412" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L4_EP1TP0PP0DP0_GPU32 -->
<g id="node1266" class="node">
<title>gate_L4_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightyellow" stroke="black" points="259821.16,-104 259582.29,-104 259520.84,0 259759.71,0 259821.16,-104"/>
<text text-anchor="middle" x="259671" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="259671" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="259671" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="259671" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L4_EP1TP0PP0DP0_GPU32 -->
<g id="node1267" class="node">
<title>dispatch_L4_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="259960" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="259960" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="259960" y="-44" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP0_GPU32</text>
</g>
<!-- expert_0_L4_EP1TP0PP0DP0_GPU32 -->
<g id="node1268" class="node">
<title>expert_0_L4_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="260243.5,-78 260098.5,-78 260098.5,-26 260243.5,-26 260243.5,-78"/>
<text text-anchor="middle" x="260171" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="260171" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="260171" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="260171" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L4_EP1TP0PP0DP0_GPU32 -->
<g id="node1269" class="node">
<title>expert_1_L4_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="260424.5,-78 260279.5,-78 260279.5,-26 260424.5,-26 260424.5,-78"/>
<text text-anchor="middle" x="260352" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="260352" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="260352" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="260352" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L4_EP1TP0PP0DP0_GPU32 -->
<g id="node1270" class="node">
<title>expert_2_L4_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="260605.5,-78 260460.5,-78 260460.5,-26 260605.5,-26 260605.5,-78"/>
<text text-anchor="middle" x="260533" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="260533" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="260533" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="260533" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L4_EP1TP0PP0DP0_GPU32 -->
<g id="node1271" class="node">
<title>expert_3_L4_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="260786.5,-78 260641.5,-78 260641.5,-26 260786.5,-26 260786.5,-78"/>
<text text-anchor="middle" x="260714" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="260714" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="260714" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="260714" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L4_EP1TP0PP0DP0_GPU32 -->
<g id="node1272" class="node">
<title>combine_L4_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="260925" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="260925" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="260925" y="-44" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP0_GPU32</text>
</g>
<!-- ffn_L4_EP1TP0PP0DP0_GPU32 -->
<g id="node1273" class="node">
<title>ffn_L4_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="261234,-78 261064,-78 261064,-26 261234,-26 261234,-78"/>
<text text-anchor="middle" x="261149" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="261149" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="261149" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="261149" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L4_EP1TP0PP0DP0_GPU32 -->
<g id="node1274" class="node">
<title>ffn_ar_L4_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="261373" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="261373" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="261373" y="-49.5" font-family="Arial" font-size="10.00">L4 EP1 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="261373" y="-38.5" font-family="Arial" font-size="10.00">GPU32</text>
</g>
<!-- residual2_L4_EP1TP0PP0DP0_GPU32 -->
<g id="node1275" class="node">
<title>residual2_L4_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="261658,-78 261512,-78 261512,-26 261658,-26 261658,-78"/>
<text text-anchor="middle" x="261585" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="261585" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="261585" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="261585" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L4_EP1TP0PP0DP1_GPU33 -->
<g id="node1276" class="node">
<title>ln1_L4_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="261839.5,-78 261694.5,-78 261694.5,-26 261839.5,-26 261839.5,-78"/>
<text text-anchor="middle" x="261767" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="261767" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="261767" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="261767" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L4_EP1TP0PP0DP1_GPU33 -->
<g id="node1277" class="node">
<title>qkv_L4_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="262020.5,-78 261875.5,-78 261875.5,-26 262020.5,-26 262020.5,-78"/>
<text text-anchor="middle" x="261948" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="261948" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="261948" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="261948" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L4_EP1TP0PP0DP1_GPU33 -->
<g id="node1278" class="node">
<title>attn_L4_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="262207.5,-78 262056.5,-78 262056.5,-26 262207.5,-26 262207.5,-78"/>
<text text-anchor="middle" x="262132" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="262132" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="262132" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="262132" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L4_EP1TP0PP0DP1_GPU33 -->
<g id="node1279" class="node">
<title>attn_out_L4_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="262388.5,-78 262243.5,-78 262243.5,-26 262388.5,-26 262388.5,-78"/>
<text text-anchor="middle" x="262316" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="262316" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="262316" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="262316" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L4_EP1TP0PP0DP1_GPU33 -->
<g id="node1280" class="node">
<title>attn_ar_L4_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="262528" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="262528" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="262528" y="-49.5" font-family="Arial" font-size="10.00">L4 EP1 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="262528" y="-38.5" font-family="Arial" font-size="10.00">GPU33</text>
</g>
<!-- residual1_L4_EP1TP0PP0DP1_GPU33 -->
<g id="node1281" class="node">
<title>residual1_L4_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="262813,-78 262667,-78 262667,-26 262813,-26 262813,-78"/>
<text text-anchor="middle" x="262740" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="262740" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="262740" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="262740" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L4_EP1TP0PP0DP1_GPU33 -->
<g id="node1282" class="node">
<title>ln2_L4_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="262994.5,-78 262849.5,-78 262849.5,-26 262994.5,-26 262994.5,-78"/>
<text text-anchor="middle" x="262922" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="262922" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="262922" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="262922" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L4_EP1TP0PP0DP1_GPU33 -->
<g id="node1283" class="node">
<title>gate_L4_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightyellow" stroke="black" points="263331.16,-104 263092.29,-104 263030.84,0 263269.71,0 263331.16,-104"/>
<text text-anchor="middle" x="263181" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="263181" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="263181" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="263181" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L4_EP1TP0PP0DP1_GPU33 -->
<g id="node1284" class="node">
<title>dispatch_L4_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="263470" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="263470" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="263470" y="-44" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP1_GPU33</text>
</g>
<!-- expert_0_L4_EP1TP0PP0DP1_GPU33 -->
<g id="node1285" class="node">
<title>expert_0_L4_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="263753.5,-78 263608.5,-78 263608.5,-26 263753.5,-26 263753.5,-78"/>
<text text-anchor="middle" x="263681" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="263681" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="263681" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="263681" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L4_EP1TP0PP0DP1_GPU33 -->
<g id="node1286" class="node">
<title>expert_1_L4_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="263934.5,-78 263789.5,-78 263789.5,-26 263934.5,-26 263934.5,-78"/>
<text text-anchor="middle" x="263862" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="263862" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="263862" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="263862" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L4_EP1TP0PP0DP1_GPU33 -->
<g id="node1287" class="node">
<title>expert_2_L4_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="264115.5,-78 263970.5,-78 263970.5,-26 264115.5,-26 264115.5,-78"/>
<text text-anchor="middle" x="264043" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="264043" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="264043" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="264043" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L4_EP1TP0PP0DP1_GPU33 -->
<g id="node1288" class="node">
<title>expert_3_L4_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="264296.5,-78 264151.5,-78 264151.5,-26 264296.5,-26 264296.5,-78"/>
<text text-anchor="middle" x="264224" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="264224" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="264224" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="264224" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L4_EP1TP0PP0DP1_GPU33 -->
<g id="node1289" class="node">
<title>combine_L4_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="264435" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="264435" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="264435" y="-44" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP1_GPU33</text>
</g>
<!-- ffn_L4_EP1TP0PP0DP1_GPU33 -->
<g id="node1290" class="node">
<title>ffn_L4_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="264744,-78 264574,-78 264574,-26 264744,-26 264744,-78"/>
<text text-anchor="middle" x="264659" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="264659" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="264659" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="264659" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L4_EP1TP0PP0DP1_GPU33 -->
<g id="node1291" class="node">
<title>ffn_ar_L4_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="264883" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="264883" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="264883" y="-49.5" font-family="Arial" font-size="10.00">L4 EP1 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="264883" y="-38.5" font-family="Arial" font-size="10.00">GPU33</text>
</g>
<!-- residual2_L4_EP1TP0PP0DP1_GPU33 -->
<g id="node1292" class="node">
<title>residual2_L4_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="265168,-78 265022,-78 265022,-26 265168,-26 265168,-78"/>
<text text-anchor="middle" x="265095" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="265095" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="265095" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="265095" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L4_EP1TP1PP0DP0_GPU40 -->
<g id="node1293" class="node">
<title>ln1_L4_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="265349.5,-78 265204.5,-78 265204.5,-26 265349.5,-26 265349.5,-78"/>
<text text-anchor="middle" x="265277" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="265277" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="265277" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="265277" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L4_EP1TP1PP0DP0_GPU40 -->
<g id="node1294" class="node">
<title>qkv_L4_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="265530.5,-78 265385.5,-78 265385.5,-26 265530.5,-26 265530.5,-78"/>
<text text-anchor="middle" x="265458" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="265458" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="265458" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="265458" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L4_EP1TP1PP0DP0_GPU40 -->
<g id="node1295" class="node">
<title>attn_L4_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="265717.5,-78 265566.5,-78 265566.5,-26 265717.5,-26 265717.5,-78"/>
<text text-anchor="middle" x="265642" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="265642" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="265642" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="265642" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L4_EP1TP1PP0DP0_GPU40 -->
<g id="node1296" class="node">
<title>attn_out_L4_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="265898.5,-78 265753.5,-78 265753.5,-26 265898.5,-26 265898.5,-78"/>
<text text-anchor="middle" x="265826" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="265826" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="265826" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="265826" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L4_EP1TP1PP0DP0_GPU40 -->
<g id="node1297" class="node">
<title>attn_ar_L4_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="266038" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="266038" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="266038" y="-49.5" font-family="Arial" font-size="10.00">L4 EP1 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="266038" y="-38.5" font-family="Arial" font-size="10.00">GPU40</text>
</g>
<!-- residual1_L4_EP1TP1PP0DP0_GPU40 -->
<g id="node1298" class="node">
<title>residual1_L4_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="266323,-78 266177,-78 266177,-26 266323,-26 266323,-78"/>
<text text-anchor="middle" x="266250" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="266250" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="266250" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="266250" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L4_EP1TP1PP0DP0_GPU40 -->
<g id="node1299" class="node">
<title>ln2_L4_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="266504.5,-78 266359.5,-78 266359.5,-26 266504.5,-26 266504.5,-78"/>
<text text-anchor="middle" x="266432" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="266432" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="266432" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="266432" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L4_EP1TP1PP0DP0_GPU40 -->
<g id="node1300" class="node">
<title>gate_L4_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightyellow" stroke="black" points="266841.16,-104 266602.29,-104 266540.84,0 266779.71,0 266841.16,-104"/>
<text text-anchor="middle" x="266691" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="266691" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="266691" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="266691" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L4_EP1TP1PP0DP0_GPU40 -->
<g id="node1301" class="node">
<title>dispatch_L4_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="266980" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="266980" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="266980" y="-44" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP0_GPU40</text>
</g>
<!-- expert_0_L4_EP1TP1PP0DP0_GPU40 -->
<g id="node1302" class="node">
<title>expert_0_L4_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="267263.5,-78 267118.5,-78 267118.5,-26 267263.5,-26 267263.5,-78"/>
<text text-anchor="middle" x="267191" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="267191" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="267191" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="267191" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L4_EP1TP1PP0DP0_GPU40 -->
<g id="node1303" class="node">
<title>expert_1_L4_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="267444.5,-78 267299.5,-78 267299.5,-26 267444.5,-26 267444.5,-78"/>
<text text-anchor="middle" x="267372" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="267372" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="267372" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="267372" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L4_EP1TP1PP0DP0_GPU40 -->
<g id="node1304" class="node">
<title>expert_2_L4_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="267625.5,-78 267480.5,-78 267480.5,-26 267625.5,-26 267625.5,-78"/>
<text text-anchor="middle" x="267553" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="267553" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="267553" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="267553" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L4_EP1TP1PP0DP0_GPU40 -->
<g id="node1305" class="node">
<title>expert_3_L4_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="267806.5,-78 267661.5,-78 267661.5,-26 267806.5,-26 267806.5,-78"/>
<text text-anchor="middle" x="267734" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="267734" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="267734" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="267734" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L4_EP1TP1PP0DP0_GPU40 -->
<g id="node1306" class="node">
<title>combine_L4_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="267945" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="267945" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="267945" y="-44" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP0_GPU40</text>
</g>
<!-- ffn_L4_EP1TP1PP0DP0_GPU40 -->
<g id="node1307" class="node">
<title>ffn_L4_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="268254,-78 268084,-78 268084,-26 268254,-26 268254,-78"/>
<text text-anchor="middle" x="268169" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="268169" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="268169" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="268169" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L4_EP1TP1PP0DP0_GPU40 -->
<g id="node1308" class="node">
<title>ffn_ar_L4_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="268393" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="268393" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="268393" y="-49.5" font-family="Arial" font-size="10.00">L4 EP1 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="268393" y="-38.5" font-family="Arial" font-size="10.00">GPU40</text>
</g>
<!-- residual2_L4_EP1TP1PP0DP0_GPU40 -->
<g id="node1309" class="node">
<title>residual2_L4_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="268678,-78 268532,-78 268532,-26 268678,-26 268678,-78"/>
<text text-anchor="middle" x="268605" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="268605" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="268605" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="268605" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L4_EP1TP1PP0DP1_GPU41 -->
<g id="node1310" class="node">
<title>ln1_L4_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="268859.5,-78 268714.5,-78 268714.5,-26 268859.5,-26 268859.5,-78"/>
<text text-anchor="middle" x="268787" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="268787" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="268787" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="268787" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L4_EP1TP1PP0DP1_GPU41 -->
<g id="node1311" class="node">
<title>qkv_L4_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="269040.5,-78 268895.5,-78 268895.5,-26 269040.5,-26 269040.5,-78"/>
<text text-anchor="middle" x="268968" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="268968" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="268968" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="268968" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L4_EP1TP1PP0DP1_GPU41 -->
<g id="node1312" class="node">
<title>attn_L4_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="269227.5,-78 269076.5,-78 269076.5,-26 269227.5,-26 269227.5,-78"/>
<text text-anchor="middle" x="269152" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="269152" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="269152" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="269152" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L4_EP1TP1PP0DP1_GPU41 -->
<g id="node1313" class="node">
<title>attn_out_L4_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="269408.5,-78 269263.5,-78 269263.5,-26 269408.5,-26 269408.5,-78"/>
<text text-anchor="middle" x="269336" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="269336" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="269336" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="269336" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L4_EP1TP1PP0DP1_GPU41 -->
<g id="node1314" class="node">
<title>attn_ar_L4_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="269548" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="269548" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="269548" y="-49.5" font-family="Arial" font-size="10.00">L4 EP1 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="269548" y="-38.5" font-family="Arial" font-size="10.00">GPU41</text>
</g>
<!-- residual1_L4_EP1TP1PP0DP1_GPU41 -->
<g id="node1315" class="node">
<title>residual1_L4_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="269833,-78 269687,-78 269687,-26 269833,-26 269833,-78"/>
<text text-anchor="middle" x="269760" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="269760" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="269760" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="269760" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L4_EP1TP1PP0DP1_GPU41 -->
<g id="node1316" class="node">
<title>ln2_L4_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="270014.5,-78 269869.5,-78 269869.5,-26 270014.5,-26 270014.5,-78"/>
<text text-anchor="middle" x="269942" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="269942" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="269942" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="269942" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L4_EP1TP1PP0DP1_GPU41 -->
<g id="node1317" class="node">
<title>gate_L4_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightyellow" stroke="black" points="270351.16,-104 270112.29,-104 270050.84,0 270289.71,0 270351.16,-104"/>
<text text-anchor="middle" x="270201" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="270201" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="270201" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="270201" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L4_EP1TP1PP0DP1_GPU41 -->
<g id="node1318" class="node">
<title>dispatch_L4_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="270490" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="270490" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="270490" y="-44" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP1_GPU41</text>
</g>
<!-- expert_0_L4_EP1TP1PP0DP1_GPU41 -->
<g id="node1319" class="node">
<title>expert_0_L4_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="270773.5,-78 270628.5,-78 270628.5,-26 270773.5,-26 270773.5,-78"/>
<text text-anchor="middle" x="270701" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="270701" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="270701" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="270701" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L4_EP1TP1PP0DP1_GPU41 -->
<g id="node1320" class="node">
<title>expert_1_L4_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="270954.5,-78 270809.5,-78 270809.5,-26 270954.5,-26 270954.5,-78"/>
<text text-anchor="middle" x="270882" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="270882" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="270882" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="270882" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L4_EP1TP1PP0DP1_GPU41 -->
<g id="node1321" class="node">
<title>expert_2_L4_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="271135.5,-78 270990.5,-78 270990.5,-26 271135.5,-26 271135.5,-78"/>
<text text-anchor="middle" x="271063" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="271063" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="271063" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="271063" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L4_EP1TP1PP0DP1_GPU41 -->
<g id="node1322" class="node">
<title>expert_3_L4_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="271316.5,-78 271171.5,-78 271171.5,-26 271316.5,-26 271316.5,-78"/>
<text text-anchor="middle" x="271244" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="271244" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="271244" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="271244" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L4_EP1TP1PP0DP1_GPU41 -->
<g id="node1323" class="node">
<title>combine_L4_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="271455" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="271455" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="271455" y="-44" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP1_GPU41</text>
</g>
<!-- ffn_L4_EP1TP1PP0DP1_GPU41 -->
<g id="node1324" class="node">
<title>ffn_L4_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="271764,-78 271594,-78 271594,-26 271764,-26 271764,-78"/>
<text text-anchor="middle" x="271679" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="271679" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="271679" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="271679" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L4_EP1TP1PP0DP1_GPU41 -->
<g id="node1325" class="node">
<title>ffn_ar_L4_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="271903" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="271903" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="271903" y="-49.5" font-family="Arial" font-size="10.00">L4 EP1 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="271903" y="-38.5" font-family="Arial" font-size="10.00">GPU41</text>
</g>
<!-- residual2_L4_EP1TP1PP0DP1_GPU41 -->
<g id="node1326" class="node">
<title>residual2_L4_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="272188,-78 272042,-78 272042,-26 272188,-26 272188,-78"/>
<text text-anchor="middle" x="272115" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="272115" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="272115" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="272115" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L4_EP1TP2PP0DP0_GPU48 -->
<g id="node1327" class="node">
<title>ln1_L4_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="272369.5,-78 272224.5,-78 272224.5,-26 272369.5,-26 272369.5,-78"/>
<text text-anchor="middle" x="272297" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="272297" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="272297" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="272297" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L4_EP1TP2PP0DP0_GPU48 -->
<g id="node1328" class="node">
<title>qkv_L4_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="272550.5,-78 272405.5,-78 272405.5,-26 272550.5,-26 272550.5,-78"/>
<text text-anchor="middle" x="272478" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="272478" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="272478" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="272478" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L4_EP1TP2PP0DP0_GPU48 -->
<g id="node1329" class="node">
<title>attn_L4_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="272737.5,-78 272586.5,-78 272586.5,-26 272737.5,-26 272737.5,-78"/>
<text text-anchor="middle" x="272662" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="272662" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="272662" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="272662" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L4_EP1TP2PP0DP0_GPU48 -->
<g id="node1330" class="node">
<title>attn_out_L4_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="272918.5,-78 272773.5,-78 272773.5,-26 272918.5,-26 272918.5,-78"/>
<text text-anchor="middle" x="272846" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="272846" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="272846" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="272846" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L4_EP1TP2PP0DP0_GPU48 -->
<g id="node1331" class="node">
<title>attn_ar_L4_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="273058" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="273058" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="273058" y="-49.5" font-family="Arial" font-size="10.00">L4 EP1 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="273058" y="-38.5" font-family="Arial" font-size="10.00">GPU48</text>
</g>
<!-- residual1_L4_EP1TP2PP0DP0_GPU48 -->
<g id="node1332" class="node">
<title>residual1_L4_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="273343,-78 273197,-78 273197,-26 273343,-26 273343,-78"/>
<text text-anchor="middle" x="273270" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="273270" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="273270" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="273270" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L4_EP1TP2PP0DP0_GPU48 -->
<g id="node1333" class="node">
<title>ln2_L4_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="273524.5,-78 273379.5,-78 273379.5,-26 273524.5,-26 273524.5,-78"/>
<text text-anchor="middle" x="273452" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="273452" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="273452" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="273452" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L4_EP1TP2PP0DP0_GPU48 -->
<g id="node1334" class="node">
<title>gate_L4_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightyellow" stroke="black" points="273861.16,-104 273622.29,-104 273560.84,0 273799.71,0 273861.16,-104"/>
<text text-anchor="middle" x="273711" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="273711" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="273711" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="273711" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L4_EP1TP2PP0DP0_GPU48 -->
<g id="node1335" class="node">
<title>dispatch_L4_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="274000" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="274000" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="274000" y="-44" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP0_GPU48</text>
</g>
<!-- expert_0_L4_EP1TP2PP0DP0_GPU48 -->
<g id="node1336" class="node">
<title>expert_0_L4_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="274283.5,-78 274138.5,-78 274138.5,-26 274283.5,-26 274283.5,-78"/>
<text text-anchor="middle" x="274211" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="274211" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="274211" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="274211" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L4_EP1TP2PP0DP0_GPU48 -->
<g id="node1337" class="node">
<title>expert_1_L4_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="274464.5,-78 274319.5,-78 274319.5,-26 274464.5,-26 274464.5,-78"/>
<text text-anchor="middle" x="274392" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="274392" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="274392" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="274392" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L4_EP1TP2PP0DP0_GPU48 -->
<g id="node1338" class="node">
<title>expert_2_L4_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="274645.5,-78 274500.5,-78 274500.5,-26 274645.5,-26 274645.5,-78"/>
<text text-anchor="middle" x="274573" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="274573" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="274573" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="274573" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L4_EP1TP2PP0DP0_GPU48 -->
<g id="node1339" class="node">
<title>expert_3_L4_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="274826.5,-78 274681.5,-78 274681.5,-26 274826.5,-26 274826.5,-78"/>
<text text-anchor="middle" x="274754" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="274754" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="274754" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="274754" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L4_EP1TP2PP0DP0_GPU48 -->
<g id="node1340" class="node">
<title>combine_L4_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="274965" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="274965" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="274965" y="-44" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP0_GPU48</text>
</g>
<!-- ffn_L4_EP1TP2PP0DP0_GPU48 -->
<g id="node1341" class="node">
<title>ffn_L4_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="275274,-78 275104,-78 275104,-26 275274,-26 275274,-78"/>
<text text-anchor="middle" x="275189" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="275189" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="275189" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="275189" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L4_EP1TP2PP0DP0_GPU48 -->
<g id="node1342" class="node">
<title>ffn_ar_L4_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="275413" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="275413" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="275413" y="-49.5" font-family="Arial" font-size="10.00">L4 EP1 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="275413" y="-38.5" font-family="Arial" font-size="10.00">GPU48</text>
</g>
<!-- residual2_L4_EP1TP2PP0DP0_GPU48 -->
<g id="node1343" class="node">
<title>residual2_L4_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="275698,-78 275552,-78 275552,-26 275698,-26 275698,-78"/>
<text text-anchor="middle" x="275625" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="275625" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="275625" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="275625" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L4_EP1TP2PP0DP1_GPU49 -->
<g id="node1344" class="node">
<title>ln1_L4_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="275879.5,-78 275734.5,-78 275734.5,-26 275879.5,-26 275879.5,-78"/>
<text text-anchor="middle" x="275807" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="275807" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="275807" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="275807" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L4_EP1TP2PP0DP1_GPU49 -->
<g id="node1345" class="node">
<title>qkv_L4_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="276060.5,-78 275915.5,-78 275915.5,-26 276060.5,-26 276060.5,-78"/>
<text text-anchor="middle" x="275988" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="275988" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="275988" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="275988" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L4_EP1TP2PP0DP1_GPU49 -->
<g id="node1346" class="node">
<title>attn_L4_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="276247.5,-78 276096.5,-78 276096.5,-26 276247.5,-26 276247.5,-78"/>
<text text-anchor="middle" x="276172" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="276172" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="276172" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="276172" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L4_EP1TP2PP0DP1_GPU49 -->
<g id="node1347" class="node">
<title>attn_out_L4_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="276428.5,-78 276283.5,-78 276283.5,-26 276428.5,-26 276428.5,-78"/>
<text text-anchor="middle" x="276356" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="276356" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="276356" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="276356" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L4_EP1TP2PP0DP1_GPU49 -->
<g id="node1348" class="node">
<title>attn_ar_L4_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="276568" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="276568" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="276568" y="-49.5" font-family="Arial" font-size="10.00">L4 EP1 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="276568" y="-38.5" font-family="Arial" font-size="10.00">GPU49</text>
</g>
<!-- residual1_L4_EP1TP2PP0DP1_GPU49 -->
<g id="node1349" class="node">
<title>residual1_L4_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="276853,-78 276707,-78 276707,-26 276853,-26 276853,-78"/>
<text text-anchor="middle" x="276780" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="276780" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="276780" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="276780" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L4_EP1TP2PP0DP1_GPU49 -->
<g id="node1350" class="node">
<title>ln2_L4_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="277034.5,-78 276889.5,-78 276889.5,-26 277034.5,-26 277034.5,-78"/>
<text text-anchor="middle" x="276962" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="276962" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="276962" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="276962" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L4_EP1TP2PP0DP1_GPU49 -->
<g id="node1351" class="node">
<title>gate_L4_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightyellow" stroke="black" points="277371.16,-104 277132.29,-104 277070.84,0 277309.71,0 277371.16,-104"/>
<text text-anchor="middle" x="277221" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="277221" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="277221" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="277221" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L4_EP1TP2PP0DP1_GPU49 -->
<g id="node1352" class="node">
<title>dispatch_L4_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="277510" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="277510" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="277510" y="-44" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP1_GPU49</text>
</g>
<!-- expert_0_L4_EP1TP2PP0DP1_GPU49 -->
<g id="node1353" class="node">
<title>expert_0_L4_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="277793.5,-78 277648.5,-78 277648.5,-26 277793.5,-26 277793.5,-78"/>
<text text-anchor="middle" x="277721" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="277721" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="277721" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="277721" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L4_EP1TP2PP0DP1_GPU49 -->
<g id="node1354" class="node">
<title>expert_1_L4_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="277974.5,-78 277829.5,-78 277829.5,-26 277974.5,-26 277974.5,-78"/>
<text text-anchor="middle" x="277902" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="277902" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="277902" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="277902" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L4_EP1TP2PP0DP1_GPU49 -->
<g id="node1355" class="node">
<title>expert_2_L4_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="278155.5,-78 278010.5,-78 278010.5,-26 278155.5,-26 278155.5,-78"/>
<text text-anchor="middle" x="278083" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="278083" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="278083" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="278083" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L4_EP1TP2PP0DP1_GPU49 -->
<g id="node1356" class="node">
<title>expert_3_L4_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="278336.5,-78 278191.5,-78 278191.5,-26 278336.5,-26 278336.5,-78"/>
<text text-anchor="middle" x="278264" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="278264" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="278264" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="278264" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L4_EP1TP2PP0DP1_GPU49 -->
<g id="node1357" class="node">
<title>combine_L4_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="278475" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="278475" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="278475" y="-44" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP1_GPU49</text>
</g>
<!-- ffn_L4_EP1TP2PP0DP1_GPU49 -->
<g id="node1358" class="node">
<title>ffn_L4_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="278784,-78 278614,-78 278614,-26 278784,-26 278784,-78"/>
<text text-anchor="middle" x="278699" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="278699" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="278699" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="278699" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L4_EP1TP2PP0DP1_GPU49 -->
<g id="node1359" class="node">
<title>ffn_ar_L4_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="278923" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="278923" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="278923" y="-49.5" font-family="Arial" font-size="10.00">L4 EP1 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="278923" y="-38.5" font-family="Arial" font-size="10.00">GPU49</text>
</g>
<!-- residual2_L4_EP1TP2PP0DP1_GPU49 -->
<g id="node1360" class="node">
<title>residual2_L4_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="279208,-78 279062,-78 279062,-26 279208,-26 279208,-78"/>
<text text-anchor="middle" x="279135" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="279135" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="279135" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="279135" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L4_EP1TP3PP0DP0_GPU56 -->
<g id="node1361" class="node">
<title>ln1_L4_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="279389.5,-78 279244.5,-78 279244.5,-26 279389.5,-26 279389.5,-78"/>
<text text-anchor="middle" x="279317" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="279317" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="279317" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="279317" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L4_EP1TP3PP0DP0_GPU56 -->
<g id="node1362" class="node">
<title>qkv_L4_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="279570.5,-78 279425.5,-78 279425.5,-26 279570.5,-26 279570.5,-78"/>
<text text-anchor="middle" x="279498" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="279498" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="279498" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="279498" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L4_EP1TP3PP0DP0_GPU56 -->
<g id="node1363" class="node">
<title>attn_L4_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="279757.5,-78 279606.5,-78 279606.5,-26 279757.5,-26 279757.5,-78"/>
<text text-anchor="middle" x="279682" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="279682" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="279682" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="279682" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L4_EP1TP3PP0DP0_GPU56 -->
<g id="node1364" class="node">
<title>attn_out_L4_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="279938.5,-78 279793.5,-78 279793.5,-26 279938.5,-26 279938.5,-78"/>
<text text-anchor="middle" x="279866" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="279866" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="279866" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="279866" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L4_EP1TP3PP0DP0_GPU56 -->
<g id="node1365" class="node">
<title>attn_ar_L4_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="280078" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="280078" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="280078" y="-49.5" font-family="Arial" font-size="10.00">L4 EP1 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="280078" y="-38.5" font-family="Arial" font-size="10.00">GPU56</text>
</g>
<!-- residual1_L4_EP1TP3PP0DP0_GPU56 -->
<g id="node1366" class="node">
<title>residual1_L4_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="280363,-78 280217,-78 280217,-26 280363,-26 280363,-78"/>
<text text-anchor="middle" x="280290" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="280290" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="280290" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="280290" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L4_EP1TP3PP0DP0_GPU56 -->
<g id="node1367" class="node">
<title>ln2_L4_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="280544.5,-78 280399.5,-78 280399.5,-26 280544.5,-26 280544.5,-78"/>
<text text-anchor="middle" x="280472" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="280472" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="280472" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="280472" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L4_EP1TP3PP0DP0_GPU56 -->
<g id="node1368" class="node">
<title>gate_L4_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightyellow" stroke="black" points="280881.16,-104 280642.29,-104 280580.84,0 280819.71,0 280881.16,-104"/>
<text text-anchor="middle" x="280731" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="280731" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="280731" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="280731" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L4_EP1TP3PP0DP0_GPU56 -->
<g id="node1369" class="node">
<title>dispatch_L4_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="281020" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="281020" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="281020" y="-44" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP0_GPU56</text>
</g>
<!-- expert_0_L4_EP1TP3PP0DP0_GPU56 -->
<g id="node1370" class="node">
<title>expert_0_L4_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="281303.5,-78 281158.5,-78 281158.5,-26 281303.5,-26 281303.5,-78"/>
<text text-anchor="middle" x="281231" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="281231" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="281231" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="281231" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L4_EP1TP3PP0DP0_GPU56 -->
<g id="node1371" class="node">
<title>expert_1_L4_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="281484.5,-78 281339.5,-78 281339.5,-26 281484.5,-26 281484.5,-78"/>
<text text-anchor="middle" x="281412" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="281412" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="281412" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="281412" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L4_EP1TP3PP0DP0_GPU56 -->
<g id="node1372" class="node">
<title>expert_2_L4_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="281665.5,-78 281520.5,-78 281520.5,-26 281665.5,-26 281665.5,-78"/>
<text text-anchor="middle" x="281593" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="281593" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="281593" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="281593" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L4_EP1TP3PP0DP0_GPU56 -->
<g id="node1373" class="node">
<title>expert_3_L4_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="281846.5,-78 281701.5,-78 281701.5,-26 281846.5,-26 281846.5,-78"/>
<text text-anchor="middle" x="281774" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="281774" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="281774" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="281774" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L4_EP1TP3PP0DP0_GPU56 -->
<g id="node1374" class="node">
<title>combine_L4_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="281985" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="281985" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="281985" y="-44" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP0_GPU56</text>
</g>
<!-- ffn_L4_EP1TP3PP0DP0_GPU56 -->
<g id="node1375" class="node">
<title>ffn_L4_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="282294,-78 282124,-78 282124,-26 282294,-26 282294,-78"/>
<text text-anchor="middle" x="282209" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="282209" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="282209" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="282209" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L4_EP1TP3PP0DP0_GPU56 -->
<g id="node1376" class="node">
<title>ffn_ar_L4_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="282433" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="282433" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="282433" y="-49.5" font-family="Arial" font-size="10.00">L4 EP1 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="282433" y="-38.5" font-family="Arial" font-size="10.00">GPU56</text>
</g>
<!-- residual2_L4_EP1TP3PP0DP0_GPU56 -->
<g id="node1377" class="node">
<title>residual2_L4_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="282718,-78 282572,-78 282572,-26 282718,-26 282718,-78"/>
<text text-anchor="middle" x="282645" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="282645" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="282645" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="282645" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L4_EP1TP3PP0DP1_GPU57 -->
<g id="node1378" class="node">
<title>ln1_L4_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="282899.5,-78 282754.5,-78 282754.5,-26 282899.5,-26 282899.5,-78"/>
<text text-anchor="middle" x="282827" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="282827" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="282827" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="282827" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L4_EP1TP3PP0DP1_GPU57 -->
<g id="node1379" class="node">
<title>qkv_L4_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="283080.5,-78 282935.5,-78 282935.5,-26 283080.5,-26 283080.5,-78"/>
<text text-anchor="middle" x="283008" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="283008" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="283008" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="283008" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L4_EP1TP3PP0DP1_GPU57 -->
<g id="node1380" class="node">
<title>attn_L4_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="283267.5,-78 283116.5,-78 283116.5,-26 283267.5,-26 283267.5,-78"/>
<text text-anchor="middle" x="283192" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="283192" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="283192" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="283192" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L4_EP1TP3PP0DP1_GPU57 -->
<g id="node1381" class="node">
<title>attn_out_L4_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="283448.5,-78 283303.5,-78 283303.5,-26 283448.5,-26 283448.5,-78"/>
<text text-anchor="middle" x="283376" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="283376" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="283376" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="283376" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L4_EP1TP3PP0DP1_GPU57 -->
<g id="node1382" class="node">
<title>attn_ar_L4_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="283588" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="283588" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="283588" y="-49.5" font-family="Arial" font-size="10.00">L4 EP1 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="283588" y="-38.5" font-family="Arial" font-size="10.00">GPU57</text>
</g>
<!-- residual1_L4_EP1TP3PP0DP1_GPU57 -->
<g id="node1383" class="node">
<title>residual1_L4_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="283873,-78 283727,-78 283727,-26 283873,-26 283873,-78"/>
<text text-anchor="middle" x="283800" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="283800" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="283800" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="283800" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L4_EP1TP3PP0DP1_GPU57 -->
<g id="node1384" class="node">
<title>ln2_L4_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="284054.5,-78 283909.5,-78 283909.5,-26 284054.5,-26 284054.5,-78"/>
<text text-anchor="middle" x="283982" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="283982" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="283982" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="283982" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L4_EP1TP3PP0DP1_GPU57 -->
<g id="node1385" class="node">
<title>gate_L4_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightyellow" stroke="black" points="284391.16,-104 284152.29,-104 284090.84,0 284329.71,0 284391.16,-104"/>
<text text-anchor="middle" x="284241" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="284241" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="284241" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="284241" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L4_EP1TP3PP0DP1_GPU57 -->
<g id="node1386" class="node">
<title>dispatch_L4_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="284530" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="284530" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="284530" y="-44" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP1_GPU57</text>
</g>
<!-- expert_0_L4_EP1TP3PP0DP1_GPU57 -->
<g id="node1387" class="node">
<title>expert_0_L4_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="284813.5,-78 284668.5,-78 284668.5,-26 284813.5,-26 284813.5,-78"/>
<text text-anchor="middle" x="284741" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="284741" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="284741" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="284741" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L4_EP1TP3PP0DP1_GPU57 -->
<g id="node1388" class="node">
<title>expert_1_L4_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="284994.5,-78 284849.5,-78 284849.5,-26 284994.5,-26 284994.5,-78"/>
<text text-anchor="middle" x="284922" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="284922" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="284922" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="284922" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L4_EP1TP3PP0DP1_GPU57 -->
<g id="node1389" class="node">
<title>expert_2_L4_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="285175.5,-78 285030.5,-78 285030.5,-26 285175.5,-26 285175.5,-78"/>
<text text-anchor="middle" x="285103" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="285103" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="285103" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="285103" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L4_EP1TP3PP0DP1_GPU57 -->
<g id="node1390" class="node">
<title>expert_3_L4_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="285356.5,-78 285211.5,-78 285211.5,-26 285356.5,-26 285356.5,-78"/>
<text text-anchor="middle" x="285284" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="285284" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="285284" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="285284" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L4_EP1TP3PP0DP1_GPU57 -->
<g id="node1391" class="node">
<title>combine_L4_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="285495" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="285495" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="285495" y="-44" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP1_GPU57</text>
</g>
<!-- ffn_L4_EP1TP3PP0DP1_GPU57 -->
<g id="node1392" class="node">
<title>ffn_L4_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="285804,-78 285634,-78 285634,-26 285804,-26 285804,-78"/>
<text text-anchor="middle" x="285719" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="285719" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="285719" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="285719" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L4_EP1TP3PP0DP1_GPU57 -->
<g id="node1393" class="node">
<title>ffn_ar_L4_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="285943" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="285943" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="285943" y="-49.5" font-family="Arial" font-size="10.00">L4 EP1 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="285943" y="-38.5" font-family="Arial" font-size="10.00">GPU57</text>
</g>
<!-- residual2_L4_EP1TP3PP0DP1_GPU57 -->
<g id="node1394" class="node">
<title>residual2_L4_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="286228,-78 286082,-78 286082,-26 286228,-26 286228,-78"/>
<text text-anchor="middle" x="286155" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="286155" y="-55" font-family="Arial" font-size="10.00">L4_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="286155" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="286155" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L5_EP0TP0PP0DP0_GPU0 -->
<g id="node1395" class="node">
<title>ln1_L5_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="286406,-78 286264,-78 286264,-26 286406,-26 286406,-78"/>
<text text-anchor="middle" x="286335" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="286335" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="286335" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="286335" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L5_EP0TP0PP0DP0_GPU0 -->
<g id="node1396" class="node">
<title>qkv_L5_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="286584,-78 286442,-78 286442,-26 286584,-26 286584,-78"/>
<text text-anchor="middle" x="286513" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="286513" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="286513" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="286513" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L5_EP0TP0PP0DP0_GPU0 -->
<g id="node1397" class="node">
<title>attn_L5_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="286771.5,-78 286620.5,-78 286620.5,-26 286771.5,-26 286771.5,-78"/>
<text text-anchor="middle" x="286696" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="286696" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="286696" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="286696" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L5_EP0TP0PP0DP0_GPU0 -->
<g id="node1398" class="node">
<title>attn_out_L5_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="286950,-78 286808,-78 286808,-26 286950,-26 286950,-78"/>
<text text-anchor="middle" x="286879" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="286879" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="286879" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="286879" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L5_EP0TP0PP0DP0_GPU0 -->
<g id="node1399" class="node">
<title>attn_ar_L5_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="287089" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="287089" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="287089" y="-49.5" font-family="Arial" font-size="10.00">L5 EP0 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="287089" y="-38.5" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- residual1_L5_EP0TP0PP0DP0_GPU0 -->
<g id="node1400" class="node">
<title>residual1_L5_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="287374,-78 287228,-78 287228,-26 287374,-26 287374,-78"/>
<text text-anchor="middle" x="287301" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="287301" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="287301" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="287301" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L5_EP0TP0PP0DP0_GPU0 -->
<g id="node1401" class="node">
<title>ln2_L5_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="287552,-78 287410,-78 287410,-26 287552,-26 287552,-78"/>
<text text-anchor="middle" x="287481" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="287481" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="287481" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="287481" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L5_EP0TP0PP0DP0_GPU0 -->
<g id="node1402" class="node">
<title>gate_L5_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightyellow" stroke="black" points="287878.29,-104 287647.17,-104 287587.71,0 287818.83,0 287878.29,-104"/>
<text text-anchor="middle" x="287733" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="287733" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="287733" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="287733" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L5_EP0TP0PP0DP0_GPU0 -->
<g id="node1403" class="node">
<title>dispatch_L5_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="288013" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="288013" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="288013" y="-44" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP0_GPU0</text>
</g>
<!-- expert_0_L5_EP0TP0PP0DP0_GPU0 -->
<g id="node1404" class="node">
<title>expert_0_L5_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="288288,-78 288148,-78 288148,-26 288288,-26 288288,-78"/>
<text text-anchor="middle" x="288218" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="288218" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="288218" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="288218" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L5_EP0TP0PP0DP0_GPU0 -->
<g id="node1405" class="node">
<title>expert_1_L5_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="288464,-78 288324,-78 288324,-26 288464,-26 288464,-78"/>
<text text-anchor="middle" x="288394" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="288394" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="288394" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="288394" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L5_EP0TP0PP0DP0_GPU0 -->
<g id="node1406" class="node">
<title>expert_2_L5_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="288640,-78 288500,-78 288500,-26 288640,-26 288640,-78"/>
<text text-anchor="middle" x="288570" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="288570" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="288570" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="288570" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L5_EP0TP0PP0DP0_GPU0 -->
<g id="node1407" class="node">
<title>expert_3_L5_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="288816,-78 288676,-78 288676,-26 288816,-26 288816,-78"/>
<text text-anchor="middle" x="288746" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="288746" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="288746" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="288746" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L5_EP0TP0PP0DP0_GPU0 -->
<g id="node1408" class="node">
<title>combine_L5_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="288951" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="288951" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="288951" y="-44" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP0_GPU0</text>
</g>
<!-- ffn_L5_EP0TP0PP0DP0_GPU0 -->
<g id="node1409" class="node">
<title>ffn_L5_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="289256,-78 289086,-78 289086,-26 289256,-26 289256,-78"/>
<text text-anchor="middle" x="289171" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="289171" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="289171" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="289171" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L5_EP0TP0PP0DP0_GPU0 -->
<g id="node1410" class="node">
<title>ffn_ar_L5_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="289395" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="289395" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="289395" y="-49.5" font-family="Arial" font-size="10.00">L5 EP0 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="289395" y="-38.5" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- residual2_L5_EP0TP0PP0DP0_GPU0 -->
<g id="node1411" class="node">
<title>residual2_L5_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="289680,-78 289534,-78 289534,-26 289680,-26 289680,-78"/>
<text text-anchor="middle" x="289607" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="289607" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="289607" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="289607" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L5_EP0TP0PP0DP1_GPU1 -->
<g id="node1412" class="node">
<title>ln1_L5_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="289858,-78 289716,-78 289716,-26 289858,-26 289858,-78"/>
<text text-anchor="middle" x="289787" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="289787" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="289787" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="289787" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L5_EP0TP0PP0DP1_GPU1 -->
<g id="node1413" class="node">
<title>qkv_L5_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="290036,-78 289894,-78 289894,-26 290036,-26 290036,-78"/>
<text text-anchor="middle" x="289965" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="289965" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="289965" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="289965" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L5_EP0TP0PP0DP1_GPU1 -->
<g id="node1414" class="node">
<title>attn_L5_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="290223.5,-78 290072.5,-78 290072.5,-26 290223.5,-26 290223.5,-78"/>
<text text-anchor="middle" x="290148" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="290148" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="290148" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="290148" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L5_EP0TP0PP0DP1_GPU1 -->
<g id="node1415" class="node">
<title>attn_out_L5_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="290402,-78 290260,-78 290260,-26 290402,-26 290402,-78"/>
<text text-anchor="middle" x="290331" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="290331" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="290331" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="290331" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L5_EP0TP0PP0DP1_GPU1 -->
<g id="node1416" class="node">
<title>attn_ar_L5_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="290541" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="290541" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="290541" y="-49.5" font-family="Arial" font-size="10.00">L5 EP0 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="290541" y="-38.5" font-family="Arial" font-size="10.00">GPU1</text>
</g>
<!-- residual1_L5_EP0TP0PP0DP1_GPU1 -->
<g id="node1417" class="node">
<title>residual1_L5_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="290826,-78 290680,-78 290680,-26 290826,-26 290826,-78"/>
<text text-anchor="middle" x="290753" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="290753" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="290753" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="290753" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L5_EP0TP0PP0DP1_GPU1 -->
<g id="node1418" class="node">
<title>ln2_L5_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="291004,-78 290862,-78 290862,-26 291004,-26 291004,-78"/>
<text text-anchor="middle" x="290933" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="290933" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="290933" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="290933" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L5_EP0TP0PP0DP1_GPU1 -->
<g id="node1419" class="node">
<title>gate_L5_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightyellow" stroke="black" points="291330.29,-104 291099.17,-104 291039.71,0 291270.83,0 291330.29,-104"/>
<text text-anchor="middle" x="291185" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="291185" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="291185" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="291185" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L5_EP0TP0PP0DP1_GPU1 -->
<g id="node1420" class="node">
<title>dispatch_L5_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="291465" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="291465" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="291465" y="-44" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP1_GPU1</text>
</g>
<!-- expert_0_L5_EP0TP0PP0DP1_GPU1 -->
<g id="node1421" class="node">
<title>expert_0_L5_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="291740,-78 291600,-78 291600,-26 291740,-26 291740,-78"/>
<text text-anchor="middle" x="291670" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="291670" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="291670" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="291670" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L5_EP0TP0PP0DP1_GPU1 -->
<g id="node1422" class="node">
<title>expert_1_L5_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="291916,-78 291776,-78 291776,-26 291916,-26 291916,-78"/>
<text text-anchor="middle" x="291846" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="291846" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="291846" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="291846" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L5_EP0TP0PP0DP1_GPU1 -->
<g id="node1423" class="node">
<title>expert_2_L5_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="292092,-78 291952,-78 291952,-26 292092,-26 292092,-78"/>
<text text-anchor="middle" x="292022" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="292022" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="292022" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="292022" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L5_EP0TP0PP0DP1_GPU1 -->
<g id="node1424" class="node">
<title>expert_3_L5_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="292268,-78 292128,-78 292128,-26 292268,-26 292268,-78"/>
<text text-anchor="middle" x="292198" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="292198" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="292198" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="292198" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L5_EP0TP0PP0DP1_GPU1 -->
<g id="node1425" class="node">
<title>combine_L5_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="292403" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="292403" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="292403" y="-44" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP1_GPU1</text>
</g>
<!-- ffn_L5_EP0TP0PP0DP1_GPU1 -->
<g id="node1426" class="node">
<title>ffn_L5_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="292708,-78 292538,-78 292538,-26 292708,-26 292708,-78"/>
<text text-anchor="middle" x="292623" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="292623" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="292623" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="292623" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L5_EP0TP0PP0DP1_GPU1 -->
<g id="node1427" class="node">
<title>ffn_ar_L5_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="292847" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="292847" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="292847" y="-49.5" font-family="Arial" font-size="10.00">L5 EP0 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="292847" y="-38.5" font-family="Arial" font-size="10.00">GPU1</text>
</g>
<!-- residual2_L5_EP0TP0PP0DP1_GPU1 -->
<g id="node1428" class="node">
<title>residual2_L5_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="293132,-78 292986,-78 292986,-26 293132,-26 293132,-78"/>
<text text-anchor="middle" x="293059" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="293059" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="293059" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="293059" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L5_EP0TP1PP0DP0_GPU8 -->
<g id="node1429" class="node">
<title>ln1_L5_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="293310,-78 293168,-78 293168,-26 293310,-26 293310,-78"/>
<text text-anchor="middle" x="293239" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="293239" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="293239" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="293239" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L5_EP0TP1PP0DP0_GPU8 -->
<g id="node1430" class="node">
<title>qkv_L5_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="293488,-78 293346,-78 293346,-26 293488,-26 293488,-78"/>
<text text-anchor="middle" x="293417" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="293417" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="293417" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="293417" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L5_EP0TP1PP0DP0_GPU8 -->
<g id="node1431" class="node">
<title>attn_L5_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="293675.5,-78 293524.5,-78 293524.5,-26 293675.5,-26 293675.5,-78"/>
<text text-anchor="middle" x="293600" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="293600" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="293600" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="293600" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L5_EP0TP1PP0DP0_GPU8 -->
<g id="node1432" class="node">
<title>attn_out_L5_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="293854,-78 293712,-78 293712,-26 293854,-26 293854,-78"/>
<text text-anchor="middle" x="293783" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="293783" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="293783" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="293783" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L5_EP0TP1PP0DP0_GPU8 -->
<g id="node1433" class="node">
<title>attn_ar_L5_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="293993" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="293993" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="293993" y="-49.5" font-family="Arial" font-size="10.00">L5 EP0 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="293993" y="-38.5" font-family="Arial" font-size="10.00">GPU8</text>
</g>
<!-- residual1_L5_EP0TP1PP0DP0_GPU8 -->
<g id="node1434" class="node">
<title>residual1_L5_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="294278,-78 294132,-78 294132,-26 294278,-26 294278,-78"/>
<text text-anchor="middle" x="294205" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="294205" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="294205" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="294205" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L5_EP0TP1PP0DP0_GPU8 -->
<g id="node1435" class="node">
<title>ln2_L5_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="294456,-78 294314,-78 294314,-26 294456,-26 294456,-78"/>
<text text-anchor="middle" x="294385" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="294385" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="294385" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="294385" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L5_EP0TP1PP0DP0_GPU8 -->
<g id="node1436" class="node">
<title>gate_L5_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightyellow" stroke="black" points="294782.29,-104 294551.17,-104 294491.71,0 294722.83,0 294782.29,-104"/>
<text text-anchor="middle" x="294637" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="294637" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="294637" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="294637" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L5_EP0TP1PP0DP0_GPU8 -->
<g id="node1437" class="node">
<title>dispatch_L5_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="294917" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="294917" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="294917" y="-44" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP0_GPU8</text>
</g>
<!-- expert_0_L5_EP0TP1PP0DP0_GPU8 -->
<g id="node1438" class="node">
<title>expert_0_L5_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="295192,-78 295052,-78 295052,-26 295192,-26 295192,-78"/>
<text text-anchor="middle" x="295122" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="295122" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="295122" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="295122" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L5_EP0TP1PP0DP0_GPU8 -->
<g id="node1439" class="node">
<title>expert_1_L5_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="295368,-78 295228,-78 295228,-26 295368,-26 295368,-78"/>
<text text-anchor="middle" x="295298" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="295298" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="295298" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="295298" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L5_EP0TP1PP0DP0_GPU8 -->
<g id="node1440" class="node">
<title>expert_2_L5_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="295544,-78 295404,-78 295404,-26 295544,-26 295544,-78"/>
<text text-anchor="middle" x="295474" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="295474" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="295474" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="295474" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L5_EP0TP1PP0DP0_GPU8 -->
<g id="node1441" class="node">
<title>expert_3_L5_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="295720,-78 295580,-78 295580,-26 295720,-26 295720,-78"/>
<text text-anchor="middle" x="295650" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="295650" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="295650" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="295650" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L5_EP0TP1PP0DP0_GPU8 -->
<g id="node1442" class="node">
<title>combine_L5_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="295855" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="295855" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="295855" y="-44" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP0_GPU8</text>
</g>
<!-- ffn_L5_EP0TP1PP0DP0_GPU8 -->
<g id="node1443" class="node">
<title>ffn_L5_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="296160,-78 295990,-78 295990,-26 296160,-26 296160,-78"/>
<text text-anchor="middle" x="296075" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="296075" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="296075" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="296075" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L5_EP0TP1PP0DP0_GPU8 -->
<g id="node1444" class="node">
<title>ffn_ar_L5_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="296299" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="296299" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="296299" y="-49.5" font-family="Arial" font-size="10.00">L5 EP0 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="296299" y="-38.5" font-family="Arial" font-size="10.00">GPU8</text>
</g>
<!-- residual2_L5_EP0TP1PP0DP0_GPU8 -->
<g id="node1445" class="node">
<title>residual2_L5_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="296584,-78 296438,-78 296438,-26 296584,-26 296584,-78"/>
<text text-anchor="middle" x="296511" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="296511" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="296511" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="296511" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L5_EP0TP1PP0DP1_GPU9 -->
<g id="node1446" class="node">
<title>ln1_L5_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="296762,-78 296620,-78 296620,-26 296762,-26 296762,-78"/>
<text text-anchor="middle" x="296691" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="296691" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="296691" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="296691" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L5_EP0TP1PP0DP1_GPU9 -->
<g id="node1447" class="node">
<title>qkv_L5_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="296940,-78 296798,-78 296798,-26 296940,-26 296940,-78"/>
<text text-anchor="middle" x="296869" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="296869" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="296869" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="296869" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L5_EP0TP1PP0DP1_GPU9 -->
<g id="node1448" class="node">
<title>attn_L5_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="297127.5,-78 296976.5,-78 296976.5,-26 297127.5,-26 297127.5,-78"/>
<text text-anchor="middle" x="297052" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="297052" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="297052" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="297052" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L5_EP0TP1PP0DP1_GPU9 -->
<g id="node1449" class="node">
<title>attn_out_L5_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="297306,-78 297164,-78 297164,-26 297306,-26 297306,-78"/>
<text text-anchor="middle" x="297235" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="297235" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="297235" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="297235" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L5_EP0TP1PP0DP1_GPU9 -->
<g id="node1450" class="node">
<title>attn_ar_L5_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="297445" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="297445" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="297445" y="-49.5" font-family="Arial" font-size="10.00">L5 EP0 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="297445" y="-38.5" font-family="Arial" font-size="10.00">GPU9</text>
</g>
<!-- residual1_L5_EP0TP1PP0DP1_GPU9 -->
<g id="node1451" class="node">
<title>residual1_L5_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="297730,-78 297584,-78 297584,-26 297730,-26 297730,-78"/>
<text text-anchor="middle" x="297657" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="297657" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="297657" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="297657" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L5_EP0TP1PP0DP1_GPU9 -->
<g id="node1452" class="node">
<title>ln2_L5_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="297908,-78 297766,-78 297766,-26 297908,-26 297908,-78"/>
<text text-anchor="middle" x="297837" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="297837" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="297837" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="297837" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L5_EP0TP1PP0DP1_GPU9 -->
<g id="node1453" class="node">
<title>gate_L5_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightyellow" stroke="black" points="298234.29,-104 298003.17,-104 297943.71,0 298174.83,0 298234.29,-104"/>
<text text-anchor="middle" x="298089" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="298089" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="298089" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="298089" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L5_EP0TP1PP0DP1_GPU9 -->
<g id="node1454" class="node">
<title>dispatch_L5_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="298369" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="298369" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="298369" y="-44" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP1_GPU9</text>
</g>
<!-- expert_0_L5_EP0TP1PP0DP1_GPU9 -->
<g id="node1455" class="node">
<title>expert_0_L5_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="298644,-78 298504,-78 298504,-26 298644,-26 298644,-78"/>
<text text-anchor="middle" x="298574" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="298574" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="298574" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="298574" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L5_EP0TP1PP0DP1_GPU9 -->
<g id="node1456" class="node">
<title>expert_1_L5_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="298820,-78 298680,-78 298680,-26 298820,-26 298820,-78"/>
<text text-anchor="middle" x="298750" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="298750" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="298750" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="298750" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L5_EP0TP1PP0DP1_GPU9 -->
<g id="node1457" class="node">
<title>expert_2_L5_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="298996,-78 298856,-78 298856,-26 298996,-26 298996,-78"/>
<text text-anchor="middle" x="298926" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="298926" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="298926" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="298926" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L5_EP0TP1PP0DP1_GPU9 -->
<g id="node1458" class="node">
<title>expert_3_L5_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="299172,-78 299032,-78 299032,-26 299172,-26 299172,-78"/>
<text text-anchor="middle" x="299102" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="299102" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="299102" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="299102" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L5_EP0TP1PP0DP1_GPU9 -->
<g id="node1459" class="node">
<title>combine_L5_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="299307" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="299307" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="299307" y="-44" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP1_GPU9</text>
</g>
<!-- ffn_L5_EP0TP1PP0DP1_GPU9 -->
<g id="node1460" class="node">
<title>ffn_L5_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="299612,-78 299442,-78 299442,-26 299612,-26 299612,-78"/>
<text text-anchor="middle" x="299527" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="299527" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="299527" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="299527" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L5_EP0TP1PP0DP1_GPU9 -->
<g id="node1461" class="node">
<title>ffn_ar_L5_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="299751" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="299751" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="299751" y="-49.5" font-family="Arial" font-size="10.00">L5 EP0 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="299751" y="-38.5" font-family="Arial" font-size="10.00">GPU9</text>
</g>
<!-- residual2_L5_EP0TP1PP0DP1_GPU9 -->
<g id="node1462" class="node">
<title>residual2_L5_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="300036,-78 299890,-78 299890,-26 300036,-26 300036,-78"/>
<text text-anchor="middle" x="299963" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="299963" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="299963" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="299963" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L5_EP0TP2PP0DP0_GPU16 -->
<g id="node1463" class="node">
<title>ln1_L5_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="300217.5,-78 300072.5,-78 300072.5,-26 300217.5,-26 300217.5,-78"/>
<text text-anchor="middle" x="300145" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="300145" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="300145" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="300145" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L5_EP0TP2PP0DP0_GPU16 -->
<g id="node1464" class="node">
<title>qkv_L5_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="300398.5,-78 300253.5,-78 300253.5,-26 300398.5,-26 300398.5,-78"/>
<text text-anchor="middle" x="300326" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="300326" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="300326" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="300326" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L5_EP0TP2PP0DP0_GPU16 -->
<g id="node1465" class="node">
<title>attn_L5_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="300585.5,-78 300434.5,-78 300434.5,-26 300585.5,-26 300585.5,-78"/>
<text text-anchor="middle" x="300510" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="300510" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="300510" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="300510" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L5_EP0TP2PP0DP0_GPU16 -->
<g id="node1466" class="node">
<title>attn_out_L5_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="300766.5,-78 300621.5,-78 300621.5,-26 300766.5,-26 300766.5,-78"/>
<text text-anchor="middle" x="300694" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="300694" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="300694" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="300694" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L5_EP0TP2PP0DP0_GPU16 -->
<g id="node1467" class="node">
<title>attn_ar_L5_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="300906" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="300906" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="300906" y="-49.5" font-family="Arial" font-size="10.00">L5 EP0 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="300906" y="-38.5" font-family="Arial" font-size="10.00">GPU16</text>
</g>
<!-- residual1_L5_EP0TP2PP0DP0_GPU16 -->
<g id="node1468" class="node">
<title>residual1_L5_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="301191,-78 301045,-78 301045,-26 301191,-26 301191,-78"/>
<text text-anchor="middle" x="301118" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="301118" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="301118" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="301118" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L5_EP0TP2PP0DP0_GPU16 -->
<g id="node1469" class="node">
<title>ln2_L5_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="301372.5,-78 301227.5,-78 301227.5,-26 301372.5,-26 301372.5,-78"/>
<text text-anchor="middle" x="301300" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="301300" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="301300" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="301300" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L5_EP0TP2PP0DP0_GPU16 -->
<g id="node1470" class="node">
<title>gate_L5_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightyellow" stroke="black" points="301709.16,-104 301470.29,-104 301408.84,0 301647.71,0 301709.16,-104"/>
<text text-anchor="middle" x="301559" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="301559" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="301559" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="301559" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L5_EP0TP2PP0DP0_GPU16 -->
<g id="node1471" class="node">
<title>dispatch_L5_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="301848" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="301848" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="301848" y="-44" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP0_GPU16</text>
</g>
<!-- expert_0_L5_EP0TP2PP0DP0_GPU16 -->
<g id="node1472" class="node">
<title>expert_0_L5_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="302131.5,-78 301986.5,-78 301986.5,-26 302131.5,-26 302131.5,-78"/>
<text text-anchor="middle" x="302059" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="302059" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="302059" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="302059" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L5_EP0TP2PP0DP0_GPU16 -->
<g id="node1473" class="node">
<title>expert_1_L5_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="302312.5,-78 302167.5,-78 302167.5,-26 302312.5,-26 302312.5,-78"/>
<text text-anchor="middle" x="302240" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="302240" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="302240" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="302240" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L5_EP0TP2PP0DP0_GPU16 -->
<g id="node1474" class="node">
<title>expert_2_L5_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="302493.5,-78 302348.5,-78 302348.5,-26 302493.5,-26 302493.5,-78"/>
<text text-anchor="middle" x="302421" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="302421" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="302421" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="302421" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L5_EP0TP2PP0DP0_GPU16 -->
<g id="node1475" class="node">
<title>expert_3_L5_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="302674.5,-78 302529.5,-78 302529.5,-26 302674.5,-26 302674.5,-78"/>
<text text-anchor="middle" x="302602" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="302602" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="302602" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="302602" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L5_EP0TP2PP0DP0_GPU16 -->
<g id="node1476" class="node">
<title>combine_L5_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="302813" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="302813" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="302813" y="-44" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP0_GPU16</text>
</g>
<!-- ffn_L5_EP0TP2PP0DP0_GPU16 -->
<g id="node1477" class="node">
<title>ffn_L5_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="303122,-78 302952,-78 302952,-26 303122,-26 303122,-78"/>
<text text-anchor="middle" x="303037" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="303037" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="303037" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="303037" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L5_EP0TP2PP0DP0_GPU16 -->
<g id="node1478" class="node">
<title>ffn_ar_L5_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="303261" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="303261" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="303261" y="-49.5" font-family="Arial" font-size="10.00">L5 EP0 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="303261" y="-38.5" font-family="Arial" font-size="10.00">GPU16</text>
</g>
<!-- residual2_L5_EP0TP2PP0DP0_GPU16 -->
<g id="node1479" class="node">
<title>residual2_L5_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="303546,-78 303400,-78 303400,-26 303546,-26 303546,-78"/>
<text text-anchor="middle" x="303473" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="303473" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="303473" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="303473" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L5_EP0TP2PP0DP1_GPU17 -->
<g id="node1480" class="node">
<title>ln1_L5_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="303727.5,-78 303582.5,-78 303582.5,-26 303727.5,-26 303727.5,-78"/>
<text text-anchor="middle" x="303655" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="303655" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="303655" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="303655" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L5_EP0TP2PP0DP1_GPU17 -->
<g id="node1481" class="node">
<title>qkv_L5_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="303908.5,-78 303763.5,-78 303763.5,-26 303908.5,-26 303908.5,-78"/>
<text text-anchor="middle" x="303836" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="303836" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="303836" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="303836" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L5_EP0TP2PP0DP1_GPU17 -->
<g id="node1482" class="node">
<title>attn_L5_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="304095.5,-78 303944.5,-78 303944.5,-26 304095.5,-26 304095.5,-78"/>
<text text-anchor="middle" x="304020" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="304020" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="304020" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="304020" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L5_EP0TP2PP0DP1_GPU17 -->
<g id="node1483" class="node">
<title>attn_out_L5_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="304276.5,-78 304131.5,-78 304131.5,-26 304276.5,-26 304276.5,-78"/>
<text text-anchor="middle" x="304204" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="304204" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="304204" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="304204" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L5_EP0TP2PP0DP1_GPU17 -->
<g id="node1484" class="node">
<title>attn_ar_L5_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="304416" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="304416" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="304416" y="-49.5" font-family="Arial" font-size="10.00">L5 EP0 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="304416" y="-38.5" font-family="Arial" font-size="10.00">GPU17</text>
</g>
<!-- residual1_L5_EP0TP2PP0DP1_GPU17 -->
<g id="node1485" class="node">
<title>residual1_L5_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="304701,-78 304555,-78 304555,-26 304701,-26 304701,-78"/>
<text text-anchor="middle" x="304628" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="304628" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="304628" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="304628" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L5_EP0TP2PP0DP1_GPU17 -->
<g id="node1486" class="node">
<title>ln2_L5_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="304882.5,-78 304737.5,-78 304737.5,-26 304882.5,-26 304882.5,-78"/>
<text text-anchor="middle" x="304810" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="304810" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="304810" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="304810" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L5_EP0TP2PP0DP1_GPU17 -->
<g id="node1487" class="node">
<title>gate_L5_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightyellow" stroke="black" points="305219.16,-104 304980.29,-104 304918.84,0 305157.71,0 305219.16,-104"/>
<text text-anchor="middle" x="305069" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="305069" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="305069" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="305069" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L5_EP0TP2PP0DP1_GPU17 -->
<g id="node1488" class="node">
<title>dispatch_L5_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="305358" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="305358" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="305358" y="-44" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP1_GPU17</text>
</g>
<!-- expert_0_L5_EP0TP2PP0DP1_GPU17 -->
<g id="node1489" class="node">
<title>expert_0_L5_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="305641.5,-78 305496.5,-78 305496.5,-26 305641.5,-26 305641.5,-78"/>
<text text-anchor="middle" x="305569" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="305569" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="305569" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="305569" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L5_EP0TP2PP0DP1_GPU17 -->
<g id="node1490" class="node">
<title>expert_1_L5_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="305822.5,-78 305677.5,-78 305677.5,-26 305822.5,-26 305822.5,-78"/>
<text text-anchor="middle" x="305750" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="305750" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="305750" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="305750" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L5_EP0TP2PP0DP1_GPU17 -->
<g id="node1491" class="node">
<title>expert_2_L5_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="306003.5,-78 305858.5,-78 305858.5,-26 306003.5,-26 306003.5,-78"/>
<text text-anchor="middle" x="305931" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="305931" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="305931" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="305931" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L5_EP0TP2PP0DP1_GPU17 -->
<g id="node1492" class="node">
<title>expert_3_L5_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="306184.5,-78 306039.5,-78 306039.5,-26 306184.5,-26 306184.5,-78"/>
<text text-anchor="middle" x="306112" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="306112" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="306112" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="306112" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L5_EP0TP2PP0DP1_GPU17 -->
<g id="node1493" class="node">
<title>combine_L5_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="306323" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="306323" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="306323" y="-44" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP1_GPU17</text>
</g>
<!-- ffn_L5_EP0TP2PP0DP1_GPU17 -->
<g id="node1494" class="node">
<title>ffn_L5_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="306632,-78 306462,-78 306462,-26 306632,-26 306632,-78"/>
<text text-anchor="middle" x="306547" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="306547" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="306547" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="306547" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L5_EP0TP2PP0DP1_GPU17 -->
<g id="node1495" class="node">
<title>ffn_ar_L5_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="306771" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="306771" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="306771" y="-49.5" font-family="Arial" font-size="10.00">L5 EP0 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="306771" y="-38.5" font-family="Arial" font-size="10.00">GPU17</text>
</g>
<!-- residual2_L5_EP0TP2PP0DP1_GPU17 -->
<g id="node1496" class="node">
<title>residual2_L5_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="307056,-78 306910,-78 306910,-26 307056,-26 307056,-78"/>
<text text-anchor="middle" x="306983" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="306983" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="306983" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="306983" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L5_EP0TP3PP0DP0_GPU24 -->
<g id="node1497" class="node">
<title>ln1_L5_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="307237.5,-78 307092.5,-78 307092.5,-26 307237.5,-26 307237.5,-78"/>
<text text-anchor="middle" x="307165" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="307165" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="307165" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="307165" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L5_EP0TP3PP0DP0_GPU24 -->
<g id="node1498" class="node">
<title>qkv_L5_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="307418.5,-78 307273.5,-78 307273.5,-26 307418.5,-26 307418.5,-78"/>
<text text-anchor="middle" x="307346" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="307346" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="307346" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="307346" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L5_EP0TP3PP0DP0_GPU24 -->
<g id="node1499" class="node">
<title>attn_L5_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="307605.5,-78 307454.5,-78 307454.5,-26 307605.5,-26 307605.5,-78"/>
<text text-anchor="middle" x="307530" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="307530" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="307530" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="307530" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L5_EP0TP3PP0DP0_GPU24 -->
<g id="node1500" class="node">
<title>attn_out_L5_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="307786.5,-78 307641.5,-78 307641.5,-26 307786.5,-26 307786.5,-78"/>
<text text-anchor="middle" x="307714" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="307714" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="307714" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="307714" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L5_EP0TP3PP0DP0_GPU24 -->
<g id="node1501" class="node">
<title>attn_ar_L5_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="307926" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="307926" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="307926" y="-49.5" font-family="Arial" font-size="10.00">L5 EP0 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="307926" y="-38.5" font-family="Arial" font-size="10.00">GPU24</text>
</g>
<!-- residual1_L5_EP0TP3PP0DP0_GPU24 -->
<g id="node1502" class="node">
<title>residual1_L5_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="308211,-78 308065,-78 308065,-26 308211,-26 308211,-78"/>
<text text-anchor="middle" x="308138" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="308138" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="308138" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="308138" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L5_EP0TP3PP0DP0_GPU24 -->
<g id="node1503" class="node">
<title>ln2_L5_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="308392.5,-78 308247.5,-78 308247.5,-26 308392.5,-26 308392.5,-78"/>
<text text-anchor="middle" x="308320" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="308320" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="308320" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="308320" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L5_EP0TP3PP0DP0_GPU24 -->
<g id="node1504" class="node">
<title>gate_L5_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightyellow" stroke="black" points="308729.16,-104 308490.29,-104 308428.84,0 308667.71,0 308729.16,-104"/>
<text text-anchor="middle" x="308579" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="308579" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="308579" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="308579" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L5_EP0TP3PP0DP0_GPU24 -->
<g id="node1505" class="node">
<title>dispatch_L5_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="308868" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="308868" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="308868" y="-44" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP0_GPU24</text>
</g>
<!-- expert_0_L5_EP0TP3PP0DP0_GPU24 -->
<g id="node1506" class="node">
<title>expert_0_L5_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="309151.5,-78 309006.5,-78 309006.5,-26 309151.5,-26 309151.5,-78"/>
<text text-anchor="middle" x="309079" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="309079" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="309079" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="309079" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L5_EP0TP3PP0DP0_GPU24 -->
<g id="node1507" class="node">
<title>expert_1_L5_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="309332.5,-78 309187.5,-78 309187.5,-26 309332.5,-26 309332.5,-78"/>
<text text-anchor="middle" x="309260" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="309260" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="309260" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="309260" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L5_EP0TP3PP0DP0_GPU24 -->
<g id="node1508" class="node">
<title>expert_2_L5_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="309513.5,-78 309368.5,-78 309368.5,-26 309513.5,-26 309513.5,-78"/>
<text text-anchor="middle" x="309441" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="309441" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="309441" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="309441" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L5_EP0TP3PP0DP0_GPU24 -->
<g id="node1509" class="node">
<title>expert_3_L5_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="309694.5,-78 309549.5,-78 309549.5,-26 309694.5,-26 309694.5,-78"/>
<text text-anchor="middle" x="309622" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="309622" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="309622" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="309622" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L5_EP0TP3PP0DP0_GPU24 -->
<g id="node1510" class="node">
<title>combine_L5_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="309833" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="309833" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="309833" y="-44" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP0_GPU24</text>
</g>
<!-- ffn_L5_EP0TP3PP0DP0_GPU24 -->
<g id="node1511" class="node">
<title>ffn_L5_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="310142,-78 309972,-78 309972,-26 310142,-26 310142,-78"/>
<text text-anchor="middle" x="310057" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="310057" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="310057" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="310057" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L5_EP0TP3PP0DP0_GPU24 -->
<g id="node1512" class="node">
<title>ffn_ar_L5_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="310281" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="310281" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="310281" y="-49.5" font-family="Arial" font-size="10.00">L5 EP0 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="310281" y="-38.5" font-family="Arial" font-size="10.00">GPU24</text>
</g>
<!-- residual2_L5_EP0TP3PP0DP0_GPU24 -->
<g id="node1513" class="node">
<title>residual2_L5_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="310566,-78 310420,-78 310420,-26 310566,-26 310566,-78"/>
<text text-anchor="middle" x="310493" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="310493" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="310493" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="310493" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L5_EP0TP3PP0DP1_GPU25 -->
<g id="node1514" class="node">
<title>ln1_L5_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="310747.5,-78 310602.5,-78 310602.5,-26 310747.5,-26 310747.5,-78"/>
<text text-anchor="middle" x="310675" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="310675" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="310675" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="310675" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L5_EP0TP3PP0DP1_GPU25 -->
<g id="node1515" class="node">
<title>qkv_L5_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="310928.5,-78 310783.5,-78 310783.5,-26 310928.5,-26 310928.5,-78"/>
<text text-anchor="middle" x="310856" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="310856" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="310856" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="310856" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L5_EP0TP3PP0DP1_GPU25 -->
<g id="node1516" class="node">
<title>attn_L5_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="311115.5,-78 310964.5,-78 310964.5,-26 311115.5,-26 311115.5,-78"/>
<text text-anchor="middle" x="311040" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="311040" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="311040" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="311040" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L5_EP0TP3PP0DP1_GPU25 -->
<g id="node1517" class="node">
<title>attn_out_L5_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="311296.5,-78 311151.5,-78 311151.5,-26 311296.5,-26 311296.5,-78"/>
<text text-anchor="middle" x="311224" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="311224" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="311224" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="311224" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L5_EP0TP3PP0DP1_GPU25 -->
<g id="node1518" class="node">
<title>attn_ar_L5_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="311436" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="311436" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="311436" y="-49.5" font-family="Arial" font-size="10.00">L5 EP0 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="311436" y="-38.5" font-family="Arial" font-size="10.00">GPU25</text>
</g>
<!-- residual1_L5_EP0TP3PP0DP1_GPU25 -->
<g id="node1519" class="node">
<title>residual1_L5_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="311721,-78 311575,-78 311575,-26 311721,-26 311721,-78"/>
<text text-anchor="middle" x="311648" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="311648" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="311648" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="311648" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L5_EP0TP3PP0DP1_GPU25 -->
<g id="node1520" class="node">
<title>ln2_L5_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="311902.5,-78 311757.5,-78 311757.5,-26 311902.5,-26 311902.5,-78"/>
<text text-anchor="middle" x="311830" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="311830" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="311830" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="311830" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L5_EP0TP3PP0DP1_GPU25 -->
<g id="node1521" class="node">
<title>gate_L5_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightyellow" stroke="black" points="312239.16,-104 312000.29,-104 311938.84,0 312177.71,0 312239.16,-104"/>
<text text-anchor="middle" x="312089" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="312089" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="312089" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="312089" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L5_EP0TP3PP0DP1_GPU25 -->
<g id="node1522" class="node">
<title>dispatch_L5_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="312378" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="312378" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="312378" y="-44" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP1_GPU25</text>
</g>
<!-- expert_0_L5_EP0TP3PP0DP1_GPU25 -->
<g id="node1523" class="node">
<title>expert_0_L5_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="312661.5,-78 312516.5,-78 312516.5,-26 312661.5,-26 312661.5,-78"/>
<text text-anchor="middle" x="312589" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="312589" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="312589" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="312589" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L5_EP0TP3PP0DP1_GPU25 -->
<g id="node1524" class="node">
<title>expert_1_L5_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="312842.5,-78 312697.5,-78 312697.5,-26 312842.5,-26 312842.5,-78"/>
<text text-anchor="middle" x="312770" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="312770" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="312770" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="312770" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L5_EP0TP3PP0DP1_GPU25 -->
<g id="node1525" class="node">
<title>expert_2_L5_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="313023.5,-78 312878.5,-78 312878.5,-26 313023.5,-26 313023.5,-78"/>
<text text-anchor="middle" x="312951" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="312951" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="312951" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="312951" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L5_EP0TP3PP0DP1_GPU25 -->
<g id="node1526" class="node">
<title>expert_3_L5_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="313204.5,-78 313059.5,-78 313059.5,-26 313204.5,-26 313204.5,-78"/>
<text text-anchor="middle" x="313132" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="313132" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="313132" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="313132" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L5_EP0TP3PP0DP1_GPU25 -->
<g id="node1527" class="node">
<title>combine_L5_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="313343" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="313343" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="313343" y="-44" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP1_GPU25</text>
</g>
<!-- ffn_L5_EP0TP3PP0DP1_GPU25 -->
<g id="node1528" class="node">
<title>ffn_L5_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="313652,-78 313482,-78 313482,-26 313652,-26 313652,-78"/>
<text text-anchor="middle" x="313567" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="313567" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="313567" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="313567" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L5_EP0TP3PP0DP1_GPU25 -->
<g id="node1529" class="node">
<title>ffn_ar_L5_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="313791" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="313791" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="313791" y="-49.5" font-family="Arial" font-size="10.00">L5 EP0 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="313791" y="-38.5" font-family="Arial" font-size="10.00">GPU25</text>
</g>
<!-- residual2_L5_EP0TP3PP0DP1_GPU25 -->
<g id="node1530" class="node">
<title>residual2_L5_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="314076,-78 313930,-78 313930,-26 314076,-26 314076,-78"/>
<text text-anchor="middle" x="314003" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="314003" y="-55" font-family="Arial" font-size="10.00">L5_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="314003" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="314003" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L5_EP1TP0PP0DP0_GPU32 -->
<g id="node1531" class="node">
<title>ln1_L5_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="314257.5,-78 314112.5,-78 314112.5,-26 314257.5,-26 314257.5,-78"/>
<text text-anchor="middle" x="314185" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="314185" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="314185" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="314185" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L5_EP1TP0PP0DP0_GPU32 -->
<g id="node1532" class="node">
<title>qkv_L5_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="314438.5,-78 314293.5,-78 314293.5,-26 314438.5,-26 314438.5,-78"/>
<text text-anchor="middle" x="314366" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="314366" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="314366" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="314366" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L5_EP1TP0PP0DP0_GPU32 -->
<g id="node1533" class="node">
<title>attn_L5_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="314625.5,-78 314474.5,-78 314474.5,-26 314625.5,-26 314625.5,-78"/>
<text text-anchor="middle" x="314550" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="314550" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="314550" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="314550" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L5_EP1TP0PP0DP0_GPU32 -->
<g id="node1534" class="node">
<title>attn_out_L5_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="314806.5,-78 314661.5,-78 314661.5,-26 314806.5,-26 314806.5,-78"/>
<text text-anchor="middle" x="314734" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="314734" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="314734" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="314734" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L5_EP1TP0PP0DP0_GPU32 -->
<g id="node1535" class="node">
<title>attn_ar_L5_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="314946" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="314946" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="314946" y="-49.5" font-family="Arial" font-size="10.00">L5 EP1 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="314946" y="-38.5" font-family="Arial" font-size="10.00">GPU32</text>
</g>
<!-- residual1_L5_EP1TP0PP0DP0_GPU32 -->
<g id="node1536" class="node">
<title>residual1_L5_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="315231,-78 315085,-78 315085,-26 315231,-26 315231,-78"/>
<text text-anchor="middle" x="315158" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="315158" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="315158" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="315158" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L5_EP1TP0PP0DP0_GPU32 -->
<g id="node1537" class="node">
<title>ln2_L5_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="315412.5,-78 315267.5,-78 315267.5,-26 315412.5,-26 315412.5,-78"/>
<text text-anchor="middle" x="315340" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="315340" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="315340" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="315340" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L5_EP1TP0PP0DP0_GPU32 -->
<g id="node1538" class="node">
<title>gate_L5_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightyellow" stroke="black" points="315749.16,-104 315510.29,-104 315448.84,0 315687.71,0 315749.16,-104"/>
<text text-anchor="middle" x="315599" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="315599" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="315599" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="315599" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L5_EP1TP0PP0DP0_GPU32 -->
<g id="node1539" class="node">
<title>dispatch_L5_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="315888" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="315888" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="315888" y="-44" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP0_GPU32</text>
</g>
<!-- expert_0_L5_EP1TP0PP0DP0_GPU32 -->
<g id="node1540" class="node">
<title>expert_0_L5_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="316171.5,-78 316026.5,-78 316026.5,-26 316171.5,-26 316171.5,-78"/>
<text text-anchor="middle" x="316099" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="316099" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="316099" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="316099" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L5_EP1TP0PP0DP0_GPU32 -->
<g id="node1541" class="node">
<title>expert_1_L5_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="316352.5,-78 316207.5,-78 316207.5,-26 316352.5,-26 316352.5,-78"/>
<text text-anchor="middle" x="316280" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="316280" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="316280" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="316280" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L5_EP1TP0PP0DP0_GPU32 -->
<g id="node1542" class="node">
<title>expert_2_L5_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="316533.5,-78 316388.5,-78 316388.5,-26 316533.5,-26 316533.5,-78"/>
<text text-anchor="middle" x="316461" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="316461" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="316461" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="316461" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L5_EP1TP0PP0DP0_GPU32 -->
<g id="node1543" class="node">
<title>expert_3_L5_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="316714.5,-78 316569.5,-78 316569.5,-26 316714.5,-26 316714.5,-78"/>
<text text-anchor="middle" x="316642" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="316642" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="316642" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="316642" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L5_EP1TP0PP0DP0_GPU32 -->
<g id="node1544" class="node">
<title>combine_L5_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="316853" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="316853" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="316853" y="-44" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP0_GPU32</text>
</g>
<!-- ffn_L5_EP1TP0PP0DP0_GPU32 -->
<g id="node1545" class="node">
<title>ffn_L5_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="317162,-78 316992,-78 316992,-26 317162,-26 317162,-78"/>
<text text-anchor="middle" x="317077" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="317077" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="317077" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="317077" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L5_EP1TP0PP0DP0_GPU32 -->
<g id="node1546" class="node">
<title>ffn_ar_L5_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="317301" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="317301" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="317301" y="-49.5" font-family="Arial" font-size="10.00">L5 EP1 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="317301" y="-38.5" font-family="Arial" font-size="10.00">GPU32</text>
</g>
<!-- residual2_L5_EP1TP0PP0DP0_GPU32 -->
<g id="node1547" class="node">
<title>residual2_L5_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="317586,-78 317440,-78 317440,-26 317586,-26 317586,-78"/>
<text text-anchor="middle" x="317513" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="317513" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="317513" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="317513" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L5_EP1TP0PP0DP1_GPU33 -->
<g id="node1548" class="node">
<title>ln1_L5_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="317767.5,-78 317622.5,-78 317622.5,-26 317767.5,-26 317767.5,-78"/>
<text text-anchor="middle" x="317695" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="317695" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="317695" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="317695" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L5_EP1TP0PP0DP1_GPU33 -->
<g id="node1549" class="node">
<title>qkv_L5_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="317948.5,-78 317803.5,-78 317803.5,-26 317948.5,-26 317948.5,-78"/>
<text text-anchor="middle" x="317876" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="317876" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="317876" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="317876" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L5_EP1TP0PP0DP1_GPU33 -->
<g id="node1550" class="node">
<title>attn_L5_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="318135.5,-78 317984.5,-78 317984.5,-26 318135.5,-26 318135.5,-78"/>
<text text-anchor="middle" x="318060" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="318060" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="318060" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="318060" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L5_EP1TP0PP0DP1_GPU33 -->
<g id="node1551" class="node">
<title>attn_out_L5_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="318316.5,-78 318171.5,-78 318171.5,-26 318316.5,-26 318316.5,-78"/>
<text text-anchor="middle" x="318244" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="318244" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="318244" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="318244" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L5_EP1TP0PP0DP1_GPU33 -->
<g id="node1552" class="node">
<title>attn_ar_L5_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="318456" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="318456" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="318456" y="-49.5" font-family="Arial" font-size="10.00">L5 EP1 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="318456" y="-38.5" font-family="Arial" font-size="10.00">GPU33</text>
</g>
<!-- residual1_L5_EP1TP0PP0DP1_GPU33 -->
<g id="node1553" class="node">
<title>residual1_L5_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="318741,-78 318595,-78 318595,-26 318741,-26 318741,-78"/>
<text text-anchor="middle" x="318668" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="318668" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="318668" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="318668" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L5_EP1TP0PP0DP1_GPU33 -->
<g id="node1554" class="node">
<title>ln2_L5_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="318922.5,-78 318777.5,-78 318777.5,-26 318922.5,-26 318922.5,-78"/>
<text text-anchor="middle" x="318850" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="318850" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="318850" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="318850" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L5_EP1TP0PP0DP1_GPU33 -->
<g id="node1555" class="node">
<title>gate_L5_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightyellow" stroke="black" points="319259.16,-104 319020.29,-104 318958.84,0 319197.71,0 319259.16,-104"/>
<text text-anchor="middle" x="319109" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="319109" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="319109" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="319109" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L5_EP1TP0PP0DP1_GPU33 -->
<g id="node1556" class="node">
<title>dispatch_L5_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="319398" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="319398" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="319398" y="-44" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP1_GPU33</text>
</g>
<!-- expert_0_L5_EP1TP0PP0DP1_GPU33 -->
<g id="node1557" class="node">
<title>expert_0_L5_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="319681.5,-78 319536.5,-78 319536.5,-26 319681.5,-26 319681.5,-78"/>
<text text-anchor="middle" x="319609" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="319609" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="319609" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="319609" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L5_EP1TP0PP0DP1_GPU33 -->
<g id="node1558" class="node">
<title>expert_1_L5_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="319862.5,-78 319717.5,-78 319717.5,-26 319862.5,-26 319862.5,-78"/>
<text text-anchor="middle" x="319790" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="319790" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="319790" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="319790" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L5_EP1TP0PP0DP1_GPU33 -->
<g id="node1559" class="node">
<title>expert_2_L5_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="320043.5,-78 319898.5,-78 319898.5,-26 320043.5,-26 320043.5,-78"/>
<text text-anchor="middle" x="319971" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="319971" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="319971" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="319971" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L5_EP1TP0PP0DP1_GPU33 -->
<g id="node1560" class="node">
<title>expert_3_L5_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="320224.5,-78 320079.5,-78 320079.5,-26 320224.5,-26 320224.5,-78"/>
<text text-anchor="middle" x="320152" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="320152" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="320152" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="320152" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L5_EP1TP0PP0DP1_GPU33 -->
<g id="node1561" class="node">
<title>combine_L5_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="320363" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="320363" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="320363" y="-44" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP1_GPU33</text>
</g>
<!-- ffn_L5_EP1TP0PP0DP1_GPU33 -->
<g id="node1562" class="node">
<title>ffn_L5_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="320672,-78 320502,-78 320502,-26 320672,-26 320672,-78"/>
<text text-anchor="middle" x="320587" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="320587" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="320587" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="320587" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L5_EP1TP0PP0DP1_GPU33 -->
<g id="node1563" class="node">
<title>ffn_ar_L5_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="320811" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="320811" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="320811" y="-49.5" font-family="Arial" font-size="10.00">L5 EP1 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="320811" y="-38.5" font-family="Arial" font-size="10.00">GPU33</text>
</g>
<!-- residual2_L5_EP1TP0PP0DP1_GPU33 -->
<g id="node1564" class="node">
<title>residual2_L5_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="321096,-78 320950,-78 320950,-26 321096,-26 321096,-78"/>
<text text-anchor="middle" x="321023" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="321023" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="321023" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="321023" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L5_EP1TP1PP0DP0_GPU40 -->
<g id="node1565" class="node">
<title>ln1_L5_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="321277.5,-78 321132.5,-78 321132.5,-26 321277.5,-26 321277.5,-78"/>
<text text-anchor="middle" x="321205" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="321205" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="321205" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="321205" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L5_EP1TP1PP0DP0_GPU40 -->
<g id="node1566" class="node">
<title>qkv_L5_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="321458.5,-78 321313.5,-78 321313.5,-26 321458.5,-26 321458.5,-78"/>
<text text-anchor="middle" x="321386" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="321386" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="321386" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="321386" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L5_EP1TP1PP0DP0_GPU40 -->
<g id="node1567" class="node">
<title>attn_L5_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="321645.5,-78 321494.5,-78 321494.5,-26 321645.5,-26 321645.5,-78"/>
<text text-anchor="middle" x="321570" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="321570" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="321570" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="321570" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L5_EP1TP1PP0DP0_GPU40 -->
<g id="node1568" class="node">
<title>attn_out_L5_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="321826.5,-78 321681.5,-78 321681.5,-26 321826.5,-26 321826.5,-78"/>
<text text-anchor="middle" x="321754" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="321754" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="321754" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="321754" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L5_EP1TP1PP0DP0_GPU40 -->
<g id="node1569" class="node">
<title>attn_ar_L5_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="321966" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="321966" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="321966" y="-49.5" font-family="Arial" font-size="10.00">L5 EP1 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="321966" y="-38.5" font-family="Arial" font-size="10.00">GPU40</text>
</g>
<!-- residual1_L5_EP1TP1PP0DP0_GPU40 -->
<g id="node1570" class="node">
<title>residual1_L5_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="322251,-78 322105,-78 322105,-26 322251,-26 322251,-78"/>
<text text-anchor="middle" x="322178" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="322178" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="322178" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="322178" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L5_EP1TP1PP0DP0_GPU40 -->
<g id="node1571" class="node">
<title>ln2_L5_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="322432.5,-78 322287.5,-78 322287.5,-26 322432.5,-26 322432.5,-78"/>
<text text-anchor="middle" x="322360" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="322360" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="322360" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="322360" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L5_EP1TP1PP0DP0_GPU40 -->
<g id="node1572" class="node">
<title>gate_L5_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightyellow" stroke="black" points="322769.16,-104 322530.29,-104 322468.84,0 322707.71,0 322769.16,-104"/>
<text text-anchor="middle" x="322619" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="322619" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="322619" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="322619" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L5_EP1TP1PP0DP0_GPU40 -->
<g id="node1573" class="node">
<title>dispatch_L5_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="322908" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="322908" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="322908" y="-44" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP0_GPU40</text>
</g>
<!-- expert_0_L5_EP1TP1PP0DP0_GPU40 -->
<g id="node1574" class="node">
<title>expert_0_L5_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="323191.5,-78 323046.5,-78 323046.5,-26 323191.5,-26 323191.5,-78"/>
<text text-anchor="middle" x="323119" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="323119" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="323119" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="323119" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L5_EP1TP1PP0DP0_GPU40 -->
<g id="node1575" class="node">
<title>expert_1_L5_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="323372.5,-78 323227.5,-78 323227.5,-26 323372.5,-26 323372.5,-78"/>
<text text-anchor="middle" x="323300" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="323300" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="323300" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="323300" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L5_EP1TP1PP0DP0_GPU40 -->
<g id="node1576" class="node">
<title>expert_2_L5_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="323553.5,-78 323408.5,-78 323408.5,-26 323553.5,-26 323553.5,-78"/>
<text text-anchor="middle" x="323481" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="323481" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="323481" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="323481" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L5_EP1TP1PP0DP0_GPU40 -->
<g id="node1577" class="node">
<title>expert_3_L5_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="323734.5,-78 323589.5,-78 323589.5,-26 323734.5,-26 323734.5,-78"/>
<text text-anchor="middle" x="323662" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="323662" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="323662" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="323662" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L5_EP1TP1PP0DP0_GPU40 -->
<g id="node1578" class="node">
<title>combine_L5_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="323873" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="323873" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="323873" y="-44" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP0_GPU40</text>
</g>
<!-- ffn_L5_EP1TP1PP0DP0_GPU40 -->
<g id="node1579" class="node">
<title>ffn_L5_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="324182,-78 324012,-78 324012,-26 324182,-26 324182,-78"/>
<text text-anchor="middle" x="324097" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="324097" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="324097" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="324097" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L5_EP1TP1PP0DP0_GPU40 -->
<g id="node1580" class="node">
<title>ffn_ar_L5_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="324321" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="324321" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="324321" y="-49.5" font-family="Arial" font-size="10.00">L5 EP1 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="324321" y="-38.5" font-family="Arial" font-size="10.00">GPU40</text>
</g>
<!-- residual2_L5_EP1TP1PP0DP0_GPU40 -->
<g id="node1581" class="node">
<title>residual2_L5_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="324606,-78 324460,-78 324460,-26 324606,-26 324606,-78"/>
<text text-anchor="middle" x="324533" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="324533" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="324533" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="324533" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L5_EP1TP1PP0DP1_GPU41 -->
<g id="node1582" class="node">
<title>ln1_L5_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="324787.5,-78 324642.5,-78 324642.5,-26 324787.5,-26 324787.5,-78"/>
<text text-anchor="middle" x="324715" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="324715" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="324715" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="324715" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L5_EP1TP1PP0DP1_GPU41 -->
<g id="node1583" class="node">
<title>qkv_L5_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="324968.5,-78 324823.5,-78 324823.5,-26 324968.5,-26 324968.5,-78"/>
<text text-anchor="middle" x="324896" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="324896" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="324896" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="324896" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L5_EP1TP1PP0DP1_GPU41 -->
<g id="node1584" class="node">
<title>attn_L5_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="325155.5,-78 325004.5,-78 325004.5,-26 325155.5,-26 325155.5,-78"/>
<text text-anchor="middle" x="325080" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="325080" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="325080" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="325080" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L5_EP1TP1PP0DP1_GPU41 -->
<g id="node1585" class="node">
<title>attn_out_L5_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="325336.5,-78 325191.5,-78 325191.5,-26 325336.5,-26 325336.5,-78"/>
<text text-anchor="middle" x="325264" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="325264" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="325264" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="325264" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L5_EP1TP1PP0DP1_GPU41 -->
<g id="node1586" class="node">
<title>attn_ar_L5_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="325476" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="325476" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="325476" y="-49.5" font-family="Arial" font-size="10.00">L5 EP1 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="325476" y="-38.5" font-family="Arial" font-size="10.00">GPU41</text>
</g>
<!-- residual1_L5_EP1TP1PP0DP1_GPU41 -->
<g id="node1587" class="node">
<title>residual1_L5_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="325761,-78 325615,-78 325615,-26 325761,-26 325761,-78"/>
<text text-anchor="middle" x="325688" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="325688" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="325688" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="325688" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L5_EP1TP1PP0DP1_GPU41 -->
<g id="node1588" class="node">
<title>ln2_L5_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="325942.5,-78 325797.5,-78 325797.5,-26 325942.5,-26 325942.5,-78"/>
<text text-anchor="middle" x="325870" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="325870" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="325870" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="325870" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L5_EP1TP1PP0DP1_GPU41 -->
<g id="node1589" class="node">
<title>gate_L5_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightyellow" stroke="black" points="326279.16,-104 326040.29,-104 325978.84,0 326217.71,0 326279.16,-104"/>
<text text-anchor="middle" x="326129" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="326129" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="326129" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="326129" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L5_EP1TP1PP0DP1_GPU41 -->
<g id="node1590" class="node">
<title>dispatch_L5_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="326418" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="326418" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="326418" y="-44" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP1_GPU41</text>
</g>
<!-- expert_0_L5_EP1TP1PP0DP1_GPU41 -->
<g id="node1591" class="node">
<title>expert_0_L5_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="326701.5,-78 326556.5,-78 326556.5,-26 326701.5,-26 326701.5,-78"/>
<text text-anchor="middle" x="326629" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="326629" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="326629" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="326629" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L5_EP1TP1PP0DP1_GPU41 -->
<g id="node1592" class="node">
<title>expert_1_L5_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="326882.5,-78 326737.5,-78 326737.5,-26 326882.5,-26 326882.5,-78"/>
<text text-anchor="middle" x="326810" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="326810" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="326810" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="326810" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L5_EP1TP1PP0DP1_GPU41 -->
<g id="node1593" class="node">
<title>expert_2_L5_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="327063.5,-78 326918.5,-78 326918.5,-26 327063.5,-26 327063.5,-78"/>
<text text-anchor="middle" x="326991" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="326991" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="326991" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="326991" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L5_EP1TP1PP0DP1_GPU41 -->
<g id="node1594" class="node">
<title>expert_3_L5_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="327244.5,-78 327099.5,-78 327099.5,-26 327244.5,-26 327244.5,-78"/>
<text text-anchor="middle" x="327172" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="327172" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="327172" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="327172" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L5_EP1TP1PP0DP1_GPU41 -->
<g id="node1595" class="node">
<title>combine_L5_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="327383" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="327383" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="327383" y="-44" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP1_GPU41</text>
</g>
<!-- ffn_L5_EP1TP1PP0DP1_GPU41 -->
<g id="node1596" class="node">
<title>ffn_L5_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="327692,-78 327522,-78 327522,-26 327692,-26 327692,-78"/>
<text text-anchor="middle" x="327607" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="327607" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="327607" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="327607" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L5_EP1TP1PP0DP1_GPU41 -->
<g id="node1597" class="node">
<title>ffn_ar_L5_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="327831" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="327831" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="327831" y="-49.5" font-family="Arial" font-size="10.00">L5 EP1 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="327831" y="-38.5" font-family="Arial" font-size="10.00">GPU41</text>
</g>
<!-- residual2_L5_EP1TP1PP0DP1_GPU41 -->
<g id="node1598" class="node">
<title>residual2_L5_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="328116,-78 327970,-78 327970,-26 328116,-26 328116,-78"/>
<text text-anchor="middle" x="328043" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="328043" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="328043" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="328043" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L5_EP1TP2PP0DP0_GPU48 -->
<g id="node1599" class="node">
<title>ln1_L5_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="328297.5,-78 328152.5,-78 328152.5,-26 328297.5,-26 328297.5,-78"/>
<text text-anchor="middle" x="328225" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="328225" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="328225" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="328225" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L5_EP1TP2PP0DP0_GPU48 -->
<g id="node1600" class="node">
<title>qkv_L5_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="328478.5,-78 328333.5,-78 328333.5,-26 328478.5,-26 328478.5,-78"/>
<text text-anchor="middle" x="328406" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="328406" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="328406" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="328406" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L5_EP1TP2PP0DP0_GPU48 -->
<g id="node1601" class="node">
<title>attn_L5_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="328665.5,-78 328514.5,-78 328514.5,-26 328665.5,-26 328665.5,-78"/>
<text text-anchor="middle" x="328590" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="328590" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="328590" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="328590" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L5_EP1TP2PP0DP0_GPU48 -->
<g id="node1602" class="node">
<title>attn_out_L5_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="328846.5,-78 328701.5,-78 328701.5,-26 328846.5,-26 328846.5,-78"/>
<text text-anchor="middle" x="328774" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="328774" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="328774" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="328774" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L5_EP1TP2PP0DP0_GPU48 -->
<g id="node1603" class="node">
<title>attn_ar_L5_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="328986" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="328986" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="328986" y="-49.5" font-family="Arial" font-size="10.00">L5 EP1 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="328986" y="-38.5" font-family="Arial" font-size="10.00">GPU48</text>
</g>
<!-- residual1_L5_EP1TP2PP0DP0_GPU48 -->
<g id="node1604" class="node">
<title>residual1_L5_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="329271,-78 329125,-78 329125,-26 329271,-26 329271,-78"/>
<text text-anchor="middle" x="329198" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="329198" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="329198" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="329198" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L5_EP1TP2PP0DP0_GPU48 -->
<g id="node1605" class="node">
<title>ln2_L5_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="329452.5,-78 329307.5,-78 329307.5,-26 329452.5,-26 329452.5,-78"/>
<text text-anchor="middle" x="329380" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="329380" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="329380" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="329380" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L5_EP1TP2PP0DP0_GPU48 -->
<g id="node1606" class="node">
<title>gate_L5_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightyellow" stroke="black" points="329789.16,-104 329550.29,-104 329488.84,0 329727.71,0 329789.16,-104"/>
<text text-anchor="middle" x="329639" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="329639" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="329639" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="329639" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L5_EP1TP2PP0DP0_GPU48 -->
<g id="node1607" class="node">
<title>dispatch_L5_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="329928" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="329928" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="329928" y="-44" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP0_GPU48</text>
</g>
<!-- expert_0_L5_EP1TP2PP0DP0_GPU48 -->
<g id="node1608" class="node">
<title>expert_0_L5_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="330211.5,-78 330066.5,-78 330066.5,-26 330211.5,-26 330211.5,-78"/>
<text text-anchor="middle" x="330139" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="330139" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="330139" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="330139" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L5_EP1TP2PP0DP0_GPU48 -->
<g id="node1609" class="node">
<title>expert_1_L5_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="330392.5,-78 330247.5,-78 330247.5,-26 330392.5,-26 330392.5,-78"/>
<text text-anchor="middle" x="330320" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="330320" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="330320" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="330320" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L5_EP1TP2PP0DP0_GPU48 -->
<g id="node1610" class="node">
<title>expert_2_L5_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="330573.5,-78 330428.5,-78 330428.5,-26 330573.5,-26 330573.5,-78"/>
<text text-anchor="middle" x="330501" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="330501" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="330501" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="330501" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L5_EP1TP2PP0DP0_GPU48 -->
<g id="node1611" class="node">
<title>expert_3_L5_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="330754.5,-78 330609.5,-78 330609.5,-26 330754.5,-26 330754.5,-78"/>
<text text-anchor="middle" x="330682" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="330682" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="330682" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="330682" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L5_EP1TP2PP0DP0_GPU48 -->
<g id="node1612" class="node">
<title>combine_L5_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="330893" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="330893" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="330893" y="-44" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP0_GPU48</text>
</g>
<!-- ffn_L5_EP1TP2PP0DP0_GPU48 -->
<g id="node1613" class="node">
<title>ffn_L5_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="331202,-78 331032,-78 331032,-26 331202,-26 331202,-78"/>
<text text-anchor="middle" x="331117" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="331117" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="331117" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="331117" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L5_EP1TP2PP0DP0_GPU48 -->
<g id="node1614" class="node">
<title>ffn_ar_L5_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="331341" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="331341" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="331341" y="-49.5" font-family="Arial" font-size="10.00">L5 EP1 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="331341" y="-38.5" font-family="Arial" font-size="10.00">GPU48</text>
</g>
<!-- residual2_L5_EP1TP2PP0DP0_GPU48 -->
<g id="node1615" class="node">
<title>residual2_L5_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="331626,-78 331480,-78 331480,-26 331626,-26 331626,-78"/>
<text text-anchor="middle" x="331553" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="331553" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="331553" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="331553" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L5_EP1TP2PP0DP1_GPU49 -->
<g id="node1616" class="node">
<title>ln1_L5_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="331807.5,-78 331662.5,-78 331662.5,-26 331807.5,-26 331807.5,-78"/>
<text text-anchor="middle" x="331735" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="331735" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="331735" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="331735" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L5_EP1TP2PP0DP1_GPU49 -->
<g id="node1617" class="node">
<title>qkv_L5_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="331988.5,-78 331843.5,-78 331843.5,-26 331988.5,-26 331988.5,-78"/>
<text text-anchor="middle" x="331916" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="331916" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="331916" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="331916" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L5_EP1TP2PP0DP1_GPU49 -->
<g id="node1618" class="node">
<title>attn_L5_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="332175.5,-78 332024.5,-78 332024.5,-26 332175.5,-26 332175.5,-78"/>
<text text-anchor="middle" x="332100" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="332100" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="332100" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="332100" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L5_EP1TP2PP0DP1_GPU49 -->
<g id="node1619" class="node">
<title>attn_out_L5_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="332356.5,-78 332211.5,-78 332211.5,-26 332356.5,-26 332356.5,-78"/>
<text text-anchor="middle" x="332284" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="332284" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="332284" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="332284" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L5_EP1TP2PP0DP1_GPU49 -->
<g id="node1620" class="node">
<title>attn_ar_L5_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="332496" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="332496" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="332496" y="-49.5" font-family="Arial" font-size="10.00">L5 EP1 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="332496" y="-38.5" font-family="Arial" font-size="10.00">GPU49</text>
</g>
<!-- residual1_L5_EP1TP2PP0DP1_GPU49 -->
<g id="node1621" class="node">
<title>residual1_L5_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="332781,-78 332635,-78 332635,-26 332781,-26 332781,-78"/>
<text text-anchor="middle" x="332708" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="332708" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="332708" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="332708" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L5_EP1TP2PP0DP1_GPU49 -->
<g id="node1622" class="node">
<title>ln2_L5_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="332962.5,-78 332817.5,-78 332817.5,-26 332962.5,-26 332962.5,-78"/>
<text text-anchor="middle" x="332890" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="332890" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="332890" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="332890" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L5_EP1TP2PP0DP1_GPU49 -->
<g id="node1623" class="node">
<title>gate_L5_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightyellow" stroke="black" points="333299.16,-104 333060.29,-104 332998.84,0 333237.71,0 333299.16,-104"/>
<text text-anchor="middle" x="333149" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="333149" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="333149" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="333149" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L5_EP1TP2PP0DP1_GPU49 -->
<g id="node1624" class="node">
<title>dispatch_L5_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="333438" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="333438" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="333438" y="-44" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP1_GPU49</text>
</g>
<!-- expert_0_L5_EP1TP2PP0DP1_GPU49 -->
<g id="node1625" class="node">
<title>expert_0_L5_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="333721.5,-78 333576.5,-78 333576.5,-26 333721.5,-26 333721.5,-78"/>
<text text-anchor="middle" x="333649" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="333649" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="333649" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="333649" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L5_EP1TP2PP0DP1_GPU49 -->
<g id="node1626" class="node">
<title>expert_1_L5_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="333902.5,-78 333757.5,-78 333757.5,-26 333902.5,-26 333902.5,-78"/>
<text text-anchor="middle" x="333830" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="333830" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="333830" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="333830" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L5_EP1TP2PP0DP1_GPU49 -->
<g id="node1627" class="node">
<title>expert_2_L5_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="334083.5,-78 333938.5,-78 333938.5,-26 334083.5,-26 334083.5,-78"/>
<text text-anchor="middle" x="334011" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="334011" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="334011" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="334011" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L5_EP1TP2PP0DP1_GPU49 -->
<g id="node1628" class="node">
<title>expert_3_L5_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="334264.5,-78 334119.5,-78 334119.5,-26 334264.5,-26 334264.5,-78"/>
<text text-anchor="middle" x="334192" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="334192" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="334192" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="334192" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L5_EP1TP2PP0DP1_GPU49 -->
<g id="node1629" class="node">
<title>combine_L5_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="334403" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="334403" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="334403" y="-44" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP1_GPU49</text>
</g>
<!-- ffn_L5_EP1TP2PP0DP1_GPU49 -->
<g id="node1630" class="node">
<title>ffn_L5_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="334712,-78 334542,-78 334542,-26 334712,-26 334712,-78"/>
<text text-anchor="middle" x="334627" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="334627" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="334627" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="334627" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L5_EP1TP2PP0DP1_GPU49 -->
<g id="node1631" class="node">
<title>ffn_ar_L5_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="334851" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="334851" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="334851" y="-49.5" font-family="Arial" font-size="10.00">L5 EP1 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="334851" y="-38.5" font-family="Arial" font-size="10.00">GPU49</text>
</g>
<!-- residual2_L5_EP1TP2PP0DP1_GPU49 -->
<g id="node1632" class="node">
<title>residual2_L5_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="335136,-78 334990,-78 334990,-26 335136,-26 335136,-78"/>
<text text-anchor="middle" x="335063" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="335063" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="335063" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="335063" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L5_EP1TP3PP0DP0_GPU56 -->
<g id="node1633" class="node">
<title>ln1_L5_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="335317.5,-78 335172.5,-78 335172.5,-26 335317.5,-26 335317.5,-78"/>
<text text-anchor="middle" x="335245" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="335245" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="335245" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="335245" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L5_EP1TP3PP0DP0_GPU56 -->
<g id="node1634" class="node">
<title>qkv_L5_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="335498.5,-78 335353.5,-78 335353.5,-26 335498.5,-26 335498.5,-78"/>
<text text-anchor="middle" x="335426" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="335426" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="335426" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="335426" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L5_EP1TP3PP0DP0_GPU56 -->
<g id="node1635" class="node">
<title>attn_L5_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="335685.5,-78 335534.5,-78 335534.5,-26 335685.5,-26 335685.5,-78"/>
<text text-anchor="middle" x="335610" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="335610" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="335610" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="335610" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L5_EP1TP3PP0DP0_GPU56 -->
<g id="node1636" class="node">
<title>attn_out_L5_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="335866.5,-78 335721.5,-78 335721.5,-26 335866.5,-26 335866.5,-78"/>
<text text-anchor="middle" x="335794" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="335794" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="335794" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="335794" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L5_EP1TP3PP0DP0_GPU56 -->
<g id="node1637" class="node">
<title>attn_ar_L5_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="336006" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="336006" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="336006" y="-49.5" font-family="Arial" font-size="10.00">L5 EP1 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="336006" y="-38.5" font-family="Arial" font-size="10.00">GPU56</text>
</g>
<!-- residual1_L5_EP1TP3PP0DP0_GPU56 -->
<g id="node1638" class="node">
<title>residual1_L5_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="336291,-78 336145,-78 336145,-26 336291,-26 336291,-78"/>
<text text-anchor="middle" x="336218" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="336218" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="336218" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="336218" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L5_EP1TP3PP0DP0_GPU56 -->
<g id="node1639" class="node">
<title>ln2_L5_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="336472.5,-78 336327.5,-78 336327.5,-26 336472.5,-26 336472.5,-78"/>
<text text-anchor="middle" x="336400" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="336400" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="336400" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="336400" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L5_EP1TP3PP0DP0_GPU56 -->
<g id="node1640" class="node">
<title>gate_L5_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightyellow" stroke="black" points="336809.16,-104 336570.29,-104 336508.84,0 336747.71,0 336809.16,-104"/>
<text text-anchor="middle" x="336659" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="336659" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="336659" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="336659" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L5_EP1TP3PP0DP0_GPU56 -->
<g id="node1641" class="node">
<title>dispatch_L5_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="336948" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="336948" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="336948" y="-44" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP0_GPU56</text>
</g>
<!-- expert_0_L5_EP1TP3PP0DP0_GPU56 -->
<g id="node1642" class="node">
<title>expert_0_L5_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="337231.5,-78 337086.5,-78 337086.5,-26 337231.5,-26 337231.5,-78"/>
<text text-anchor="middle" x="337159" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="337159" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="337159" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="337159" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L5_EP1TP3PP0DP0_GPU56 -->
<g id="node1643" class="node">
<title>expert_1_L5_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="337412.5,-78 337267.5,-78 337267.5,-26 337412.5,-26 337412.5,-78"/>
<text text-anchor="middle" x="337340" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="337340" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="337340" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="337340" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L5_EP1TP3PP0DP0_GPU56 -->
<g id="node1644" class="node">
<title>expert_2_L5_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="337593.5,-78 337448.5,-78 337448.5,-26 337593.5,-26 337593.5,-78"/>
<text text-anchor="middle" x="337521" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="337521" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="337521" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="337521" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L5_EP1TP3PP0DP0_GPU56 -->
<g id="node1645" class="node">
<title>expert_3_L5_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="337774.5,-78 337629.5,-78 337629.5,-26 337774.5,-26 337774.5,-78"/>
<text text-anchor="middle" x="337702" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="337702" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="337702" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="337702" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L5_EP1TP3PP0DP0_GPU56 -->
<g id="node1646" class="node">
<title>combine_L5_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="337913" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="337913" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="337913" y="-44" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP0_GPU56</text>
</g>
<!-- ffn_L5_EP1TP3PP0DP0_GPU56 -->
<g id="node1647" class="node">
<title>ffn_L5_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="338222,-78 338052,-78 338052,-26 338222,-26 338222,-78"/>
<text text-anchor="middle" x="338137" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="338137" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="338137" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="338137" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L5_EP1TP3PP0DP0_GPU56 -->
<g id="node1648" class="node">
<title>ffn_ar_L5_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="338361" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="338361" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="338361" y="-49.5" font-family="Arial" font-size="10.00">L5 EP1 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="338361" y="-38.5" font-family="Arial" font-size="10.00">GPU56</text>
</g>
<!-- residual2_L5_EP1TP3PP0DP0_GPU56 -->
<g id="node1649" class="node">
<title>residual2_L5_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="338646,-78 338500,-78 338500,-26 338646,-26 338646,-78"/>
<text text-anchor="middle" x="338573" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="338573" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="338573" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="338573" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L5_EP1TP3PP0DP1_GPU57 -->
<g id="node1650" class="node">
<title>ln1_L5_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="338827.5,-78 338682.5,-78 338682.5,-26 338827.5,-26 338827.5,-78"/>
<text text-anchor="middle" x="338755" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="338755" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="338755" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="338755" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L5_EP1TP3PP0DP1_GPU57 -->
<g id="node1651" class="node">
<title>qkv_L5_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="339008.5,-78 338863.5,-78 338863.5,-26 339008.5,-26 339008.5,-78"/>
<text text-anchor="middle" x="338936" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="338936" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="338936" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="338936" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L5_EP1TP3PP0DP1_GPU57 -->
<g id="node1652" class="node">
<title>attn_L5_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="339195.5,-78 339044.5,-78 339044.5,-26 339195.5,-26 339195.5,-78"/>
<text text-anchor="middle" x="339120" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="339120" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="339120" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="339120" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L5_EP1TP3PP0DP1_GPU57 -->
<g id="node1653" class="node">
<title>attn_out_L5_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="339376.5,-78 339231.5,-78 339231.5,-26 339376.5,-26 339376.5,-78"/>
<text text-anchor="middle" x="339304" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="339304" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="339304" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="339304" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L5_EP1TP3PP0DP1_GPU57 -->
<g id="node1654" class="node">
<title>attn_ar_L5_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="339516" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="339516" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="339516" y="-49.5" font-family="Arial" font-size="10.00">L5 EP1 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="339516" y="-38.5" font-family="Arial" font-size="10.00">GPU57</text>
</g>
<!-- residual1_L5_EP1TP3PP0DP1_GPU57 -->
<g id="node1655" class="node">
<title>residual1_L5_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="339801,-78 339655,-78 339655,-26 339801,-26 339801,-78"/>
<text text-anchor="middle" x="339728" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="339728" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="339728" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="339728" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L5_EP1TP3PP0DP1_GPU57 -->
<g id="node1656" class="node">
<title>ln2_L5_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="339982.5,-78 339837.5,-78 339837.5,-26 339982.5,-26 339982.5,-78"/>
<text text-anchor="middle" x="339910" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="339910" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="339910" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="339910" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L5_EP1TP3PP0DP1_GPU57 -->
<g id="node1657" class="node">
<title>gate_L5_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightyellow" stroke="black" points="340319.16,-104 340080.29,-104 340018.84,0 340257.71,0 340319.16,-104"/>
<text text-anchor="middle" x="340169" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="340169" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="340169" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="340169" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L5_EP1TP3PP0DP1_GPU57 -->
<g id="node1658" class="node">
<title>dispatch_L5_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="340458" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="340458" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="340458" y="-44" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP1_GPU57</text>
</g>
<!-- expert_0_L5_EP1TP3PP0DP1_GPU57 -->
<g id="node1659" class="node">
<title>expert_0_L5_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="340741.5,-78 340596.5,-78 340596.5,-26 340741.5,-26 340741.5,-78"/>
<text text-anchor="middle" x="340669" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="340669" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="340669" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="340669" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L5_EP1TP3PP0DP1_GPU57 -->
<g id="node1660" class="node">
<title>expert_1_L5_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="340922.5,-78 340777.5,-78 340777.5,-26 340922.5,-26 340922.5,-78"/>
<text text-anchor="middle" x="340850" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="340850" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="340850" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="340850" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L5_EP1TP3PP0DP1_GPU57 -->
<g id="node1661" class="node">
<title>expert_2_L5_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="341103.5,-78 340958.5,-78 340958.5,-26 341103.5,-26 341103.5,-78"/>
<text text-anchor="middle" x="341031" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="341031" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="341031" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="341031" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L5_EP1TP3PP0DP1_GPU57 -->
<g id="node1662" class="node">
<title>expert_3_L5_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="341284.5,-78 341139.5,-78 341139.5,-26 341284.5,-26 341284.5,-78"/>
<text text-anchor="middle" x="341212" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="341212" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="341212" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="341212" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L5_EP1TP3PP0DP1_GPU57 -->
<g id="node1663" class="node">
<title>combine_L5_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="341423" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="341423" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="341423" y="-44" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP1_GPU57</text>
</g>
<!-- ffn_L5_EP1TP3PP0DP1_GPU57 -->
<g id="node1664" class="node">
<title>ffn_L5_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="341732,-78 341562,-78 341562,-26 341732,-26 341732,-78"/>
<text text-anchor="middle" x="341647" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="341647" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="341647" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="341647" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L5_EP1TP3PP0DP1_GPU57 -->
<g id="node1665" class="node">
<title>ffn_ar_L5_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="341871" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="341871" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="341871" y="-49.5" font-family="Arial" font-size="10.00">L5 EP1 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="341871" y="-38.5" font-family="Arial" font-size="10.00">GPU57</text>
</g>
<!-- residual2_L5_EP1TP3PP0DP1_GPU57 -->
<g id="node1666" class="node">
<title>residual2_L5_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="342156,-78 342010,-78 342010,-26 342156,-26 342156,-78"/>
<text text-anchor="middle" x="342083" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="342083" y="-55" font-family="Arial" font-size="10.00">L5_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="342083" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="342083" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L6_EP0TP0PP0DP0_GPU0 -->
<g id="node1667" class="node">
<title>ln1_L6_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="342334,-78 342192,-78 342192,-26 342334,-26 342334,-78"/>
<text text-anchor="middle" x="342263" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="342263" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="342263" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="342263" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L6_EP0TP0PP0DP0_GPU0 -->
<g id="node1668" class="node">
<title>qkv_L6_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="342512,-78 342370,-78 342370,-26 342512,-26 342512,-78"/>
<text text-anchor="middle" x="342441" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="342441" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="342441" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="342441" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L6_EP0TP0PP0DP0_GPU0 -->
<g id="node1669" class="node">
<title>attn_L6_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="342699.5,-78 342548.5,-78 342548.5,-26 342699.5,-26 342699.5,-78"/>
<text text-anchor="middle" x="342624" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="342624" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="342624" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="342624" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L6_EP0TP0PP0DP0_GPU0 -->
<g id="node1670" class="node">
<title>attn_out_L6_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="342878,-78 342736,-78 342736,-26 342878,-26 342878,-78"/>
<text text-anchor="middle" x="342807" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="342807" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="342807" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="342807" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L6_EP0TP0PP0DP0_GPU0 -->
<g id="node1671" class="node">
<title>attn_ar_L6_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="343017" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="343017" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="343017" y="-49.5" font-family="Arial" font-size="10.00">L6 EP0 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="343017" y="-38.5" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- residual1_L6_EP0TP0PP0DP0_GPU0 -->
<g id="node1672" class="node">
<title>residual1_L6_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="343302,-78 343156,-78 343156,-26 343302,-26 343302,-78"/>
<text text-anchor="middle" x="343229" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="343229" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="343229" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="343229" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L6_EP0TP0PP0DP0_GPU0 -->
<g id="node1673" class="node">
<title>ln2_L6_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="343480,-78 343338,-78 343338,-26 343480,-26 343480,-78"/>
<text text-anchor="middle" x="343409" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="343409" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="343409" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="343409" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L6_EP0TP0PP0DP0_GPU0 -->
<g id="node1674" class="node">
<title>gate_L6_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightyellow" stroke="black" points="343806.29,-104 343575.17,-104 343515.71,0 343746.83,0 343806.29,-104"/>
<text text-anchor="middle" x="343661" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="343661" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="343661" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="343661" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L6_EP0TP0PP0DP0_GPU0 -->
<g id="node1675" class="node">
<title>dispatch_L6_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="343941" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="343941" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="343941" y="-44" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP0_GPU0</text>
</g>
<!-- expert_0_L6_EP0TP0PP0DP0_GPU0 -->
<g id="node1676" class="node">
<title>expert_0_L6_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="344216,-78 344076,-78 344076,-26 344216,-26 344216,-78"/>
<text text-anchor="middle" x="344146" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="344146" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="344146" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="344146" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L6_EP0TP0PP0DP0_GPU0 -->
<g id="node1677" class="node">
<title>expert_1_L6_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="344392,-78 344252,-78 344252,-26 344392,-26 344392,-78"/>
<text text-anchor="middle" x="344322" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="344322" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="344322" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="344322" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L6_EP0TP0PP0DP0_GPU0 -->
<g id="node1678" class="node">
<title>expert_2_L6_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="344568,-78 344428,-78 344428,-26 344568,-26 344568,-78"/>
<text text-anchor="middle" x="344498" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="344498" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="344498" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="344498" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L6_EP0TP0PP0DP0_GPU0 -->
<g id="node1679" class="node">
<title>expert_3_L6_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="344744,-78 344604,-78 344604,-26 344744,-26 344744,-78"/>
<text text-anchor="middle" x="344674" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="344674" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="344674" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="344674" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L6_EP0TP0PP0DP0_GPU0 -->
<g id="node1680" class="node">
<title>combine_L6_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="344879" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="344879" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="344879" y="-44" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP0_GPU0</text>
</g>
<!-- ffn_L6_EP0TP0PP0DP0_GPU0 -->
<g id="node1681" class="node">
<title>ffn_L6_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="345184,-78 345014,-78 345014,-26 345184,-26 345184,-78"/>
<text text-anchor="middle" x="345099" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="345099" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="345099" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="345099" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L6_EP0TP0PP0DP0_GPU0 -->
<g id="node1682" class="node">
<title>ffn_ar_L6_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="345323" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="345323" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="345323" y="-49.5" font-family="Arial" font-size="10.00">L6 EP0 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="345323" y="-38.5" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- residual2_L6_EP0TP0PP0DP0_GPU0 -->
<g id="node1683" class="node">
<title>residual2_L6_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="345608,-78 345462,-78 345462,-26 345608,-26 345608,-78"/>
<text text-anchor="middle" x="345535" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="345535" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="345535" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="345535" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L6_EP0TP0PP0DP1_GPU1 -->
<g id="node1684" class="node">
<title>ln1_L6_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="345786,-78 345644,-78 345644,-26 345786,-26 345786,-78"/>
<text text-anchor="middle" x="345715" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="345715" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="345715" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="345715" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L6_EP0TP0PP0DP1_GPU1 -->
<g id="node1685" class="node">
<title>qkv_L6_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="345964,-78 345822,-78 345822,-26 345964,-26 345964,-78"/>
<text text-anchor="middle" x="345893" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="345893" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="345893" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="345893" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L6_EP0TP0PP0DP1_GPU1 -->
<g id="node1686" class="node">
<title>attn_L6_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="346151.5,-78 346000.5,-78 346000.5,-26 346151.5,-26 346151.5,-78"/>
<text text-anchor="middle" x="346076" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="346076" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="346076" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="346076" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L6_EP0TP0PP0DP1_GPU1 -->
<g id="node1687" class="node">
<title>attn_out_L6_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="346330,-78 346188,-78 346188,-26 346330,-26 346330,-78"/>
<text text-anchor="middle" x="346259" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="346259" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="346259" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="346259" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L6_EP0TP0PP0DP1_GPU1 -->
<g id="node1688" class="node">
<title>attn_ar_L6_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="346469" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="346469" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="346469" y="-49.5" font-family="Arial" font-size="10.00">L6 EP0 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="346469" y="-38.5" font-family="Arial" font-size="10.00">GPU1</text>
</g>
<!-- residual1_L6_EP0TP0PP0DP1_GPU1 -->
<g id="node1689" class="node">
<title>residual1_L6_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="346754,-78 346608,-78 346608,-26 346754,-26 346754,-78"/>
<text text-anchor="middle" x="346681" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="346681" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="346681" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="346681" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L6_EP0TP0PP0DP1_GPU1 -->
<g id="node1690" class="node">
<title>ln2_L6_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="346932,-78 346790,-78 346790,-26 346932,-26 346932,-78"/>
<text text-anchor="middle" x="346861" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="346861" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="346861" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="346861" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L6_EP0TP0PP0DP1_GPU1 -->
<g id="node1691" class="node">
<title>gate_L6_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightyellow" stroke="black" points="347258.29,-104 347027.17,-104 346967.71,0 347198.83,0 347258.29,-104"/>
<text text-anchor="middle" x="347113" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="347113" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="347113" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="347113" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L6_EP0TP0PP0DP1_GPU1 -->
<g id="node1692" class="node">
<title>dispatch_L6_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="347393" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="347393" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="347393" y="-44" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP1_GPU1</text>
</g>
<!-- expert_0_L6_EP0TP0PP0DP1_GPU1 -->
<g id="node1693" class="node">
<title>expert_0_L6_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="347668,-78 347528,-78 347528,-26 347668,-26 347668,-78"/>
<text text-anchor="middle" x="347598" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="347598" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="347598" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="347598" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L6_EP0TP0PP0DP1_GPU1 -->
<g id="node1694" class="node">
<title>expert_1_L6_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="347844,-78 347704,-78 347704,-26 347844,-26 347844,-78"/>
<text text-anchor="middle" x="347774" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="347774" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="347774" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="347774" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L6_EP0TP0PP0DP1_GPU1 -->
<g id="node1695" class="node">
<title>expert_2_L6_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="348020,-78 347880,-78 347880,-26 348020,-26 348020,-78"/>
<text text-anchor="middle" x="347950" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="347950" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="347950" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="347950" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L6_EP0TP0PP0DP1_GPU1 -->
<g id="node1696" class="node">
<title>expert_3_L6_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="348196,-78 348056,-78 348056,-26 348196,-26 348196,-78"/>
<text text-anchor="middle" x="348126" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="348126" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="348126" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="348126" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L6_EP0TP0PP0DP1_GPU1 -->
<g id="node1697" class="node">
<title>combine_L6_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="348331" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="348331" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="348331" y="-44" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP1_GPU1</text>
</g>
<!-- ffn_L6_EP0TP0PP0DP1_GPU1 -->
<g id="node1698" class="node">
<title>ffn_L6_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="348636,-78 348466,-78 348466,-26 348636,-26 348636,-78"/>
<text text-anchor="middle" x="348551" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="348551" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="348551" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="348551" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L6_EP0TP0PP0DP1_GPU1 -->
<g id="node1699" class="node">
<title>ffn_ar_L6_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="348775" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="348775" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="348775" y="-49.5" font-family="Arial" font-size="10.00">L6 EP0 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="348775" y="-38.5" font-family="Arial" font-size="10.00">GPU1</text>
</g>
<!-- residual2_L6_EP0TP0PP0DP1_GPU1 -->
<g id="node1700" class="node">
<title>residual2_L6_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="349060,-78 348914,-78 348914,-26 349060,-26 349060,-78"/>
<text text-anchor="middle" x="348987" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="348987" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="348987" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="348987" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L6_EP0TP1PP0DP0_GPU8 -->
<g id="node1701" class="node">
<title>ln1_L6_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="349238,-78 349096,-78 349096,-26 349238,-26 349238,-78"/>
<text text-anchor="middle" x="349167" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="349167" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="349167" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="349167" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L6_EP0TP1PP0DP0_GPU8 -->
<g id="node1702" class="node">
<title>qkv_L6_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="349416,-78 349274,-78 349274,-26 349416,-26 349416,-78"/>
<text text-anchor="middle" x="349345" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="349345" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="349345" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="349345" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L6_EP0TP1PP0DP0_GPU8 -->
<g id="node1703" class="node">
<title>attn_L6_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="349603.5,-78 349452.5,-78 349452.5,-26 349603.5,-26 349603.5,-78"/>
<text text-anchor="middle" x="349528" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="349528" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="349528" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="349528" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L6_EP0TP1PP0DP0_GPU8 -->
<g id="node1704" class="node">
<title>attn_out_L6_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="349782,-78 349640,-78 349640,-26 349782,-26 349782,-78"/>
<text text-anchor="middle" x="349711" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="349711" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="349711" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="349711" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L6_EP0TP1PP0DP0_GPU8 -->
<g id="node1705" class="node">
<title>attn_ar_L6_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="349921" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="349921" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="349921" y="-49.5" font-family="Arial" font-size="10.00">L6 EP0 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="349921" y="-38.5" font-family="Arial" font-size="10.00">GPU8</text>
</g>
<!-- residual1_L6_EP0TP1PP0DP0_GPU8 -->
<g id="node1706" class="node">
<title>residual1_L6_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="350206,-78 350060,-78 350060,-26 350206,-26 350206,-78"/>
<text text-anchor="middle" x="350133" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="350133" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="350133" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="350133" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L6_EP0TP1PP0DP0_GPU8 -->
<g id="node1707" class="node">
<title>ln2_L6_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="350384,-78 350242,-78 350242,-26 350384,-26 350384,-78"/>
<text text-anchor="middle" x="350313" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="350313" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="350313" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="350313" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L6_EP0TP1PP0DP0_GPU8 -->
<g id="node1708" class="node">
<title>gate_L6_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightyellow" stroke="black" points="350710.29,-104 350479.17,-104 350419.71,0 350650.83,0 350710.29,-104"/>
<text text-anchor="middle" x="350565" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="350565" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="350565" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="350565" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L6_EP0TP1PP0DP0_GPU8 -->
<g id="node1709" class="node">
<title>dispatch_L6_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="350845" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="350845" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="350845" y="-44" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP0_GPU8</text>
</g>
<!-- expert_0_L6_EP0TP1PP0DP0_GPU8 -->
<g id="node1710" class="node">
<title>expert_0_L6_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="351120,-78 350980,-78 350980,-26 351120,-26 351120,-78"/>
<text text-anchor="middle" x="351050" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="351050" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="351050" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="351050" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L6_EP0TP1PP0DP0_GPU8 -->
<g id="node1711" class="node">
<title>expert_1_L6_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="351296,-78 351156,-78 351156,-26 351296,-26 351296,-78"/>
<text text-anchor="middle" x="351226" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="351226" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="351226" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="351226" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L6_EP0TP1PP0DP0_GPU8 -->
<g id="node1712" class="node">
<title>expert_2_L6_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="351472,-78 351332,-78 351332,-26 351472,-26 351472,-78"/>
<text text-anchor="middle" x="351402" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="351402" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="351402" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="351402" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L6_EP0TP1PP0DP0_GPU8 -->
<g id="node1713" class="node">
<title>expert_3_L6_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="351648,-78 351508,-78 351508,-26 351648,-26 351648,-78"/>
<text text-anchor="middle" x="351578" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="351578" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="351578" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="351578" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L6_EP0TP1PP0DP0_GPU8 -->
<g id="node1714" class="node">
<title>combine_L6_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="351783" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="351783" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="351783" y="-44" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP0_GPU8</text>
</g>
<!-- ffn_L6_EP0TP1PP0DP0_GPU8 -->
<g id="node1715" class="node">
<title>ffn_L6_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="352088,-78 351918,-78 351918,-26 352088,-26 352088,-78"/>
<text text-anchor="middle" x="352003" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="352003" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="352003" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="352003" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L6_EP0TP1PP0DP0_GPU8 -->
<g id="node1716" class="node">
<title>ffn_ar_L6_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="352227" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="352227" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="352227" y="-49.5" font-family="Arial" font-size="10.00">L6 EP0 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="352227" y="-38.5" font-family="Arial" font-size="10.00">GPU8</text>
</g>
<!-- residual2_L6_EP0TP1PP0DP0_GPU8 -->
<g id="node1717" class="node">
<title>residual2_L6_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="352512,-78 352366,-78 352366,-26 352512,-26 352512,-78"/>
<text text-anchor="middle" x="352439" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="352439" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="352439" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="352439" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L6_EP0TP1PP0DP1_GPU9 -->
<g id="node1718" class="node">
<title>ln1_L6_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="352690,-78 352548,-78 352548,-26 352690,-26 352690,-78"/>
<text text-anchor="middle" x="352619" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="352619" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="352619" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="352619" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L6_EP0TP1PP0DP1_GPU9 -->
<g id="node1719" class="node">
<title>qkv_L6_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="352868,-78 352726,-78 352726,-26 352868,-26 352868,-78"/>
<text text-anchor="middle" x="352797" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="352797" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="352797" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="352797" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L6_EP0TP1PP0DP1_GPU9 -->
<g id="node1720" class="node">
<title>attn_L6_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="353055.5,-78 352904.5,-78 352904.5,-26 353055.5,-26 353055.5,-78"/>
<text text-anchor="middle" x="352980" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="352980" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="352980" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="352980" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L6_EP0TP1PP0DP1_GPU9 -->
<g id="node1721" class="node">
<title>attn_out_L6_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="353234,-78 353092,-78 353092,-26 353234,-26 353234,-78"/>
<text text-anchor="middle" x="353163" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="353163" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="353163" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="353163" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L6_EP0TP1PP0DP1_GPU9 -->
<g id="node1722" class="node">
<title>attn_ar_L6_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="353373" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="353373" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="353373" y="-49.5" font-family="Arial" font-size="10.00">L6 EP0 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="353373" y="-38.5" font-family="Arial" font-size="10.00">GPU9</text>
</g>
<!-- residual1_L6_EP0TP1PP0DP1_GPU9 -->
<g id="node1723" class="node">
<title>residual1_L6_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="353658,-78 353512,-78 353512,-26 353658,-26 353658,-78"/>
<text text-anchor="middle" x="353585" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="353585" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="353585" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="353585" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L6_EP0TP1PP0DP1_GPU9 -->
<g id="node1724" class="node">
<title>ln2_L6_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="353836,-78 353694,-78 353694,-26 353836,-26 353836,-78"/>
<text text-anchor="middle" x="353765" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="353765" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="353765" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="353765" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L6_EP0TP1PP0DP1_GPU9 -->
<g id="node1725" class="node">
<title>gate_L6_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightyellow" stroke="black" points="354162.29,-104 353931.17,-104 353871.71,0 354102.83,0 354162.29,-104"/>
<text text-anchor="middle" x="354017" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="354017" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="354017" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="354017" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L6_EP0TP1PP0DP1_GPU9 -->
<g id="node1726" class="node">
<title>dispatch_L6_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="354297" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="354297" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="354297" y="-44" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP1_GPU9</text>
</g>
<!-- expert_0_L6_EP0TP1PP0DP1_GPU9 -->
<g id="node1727" class="node">
<title>expert_0_L6_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="354572,-78 354432,-78 354432,-26 354572,-26 354572,-78"/>
<text text-anchor="middle" x="354502" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="354502" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="354502" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="354502" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L6_EP0TP1PP0DP1_GPU9 -->
<g id="node1728" class="node">
<title>expert_1_L6_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="354748,-78 354608,-78 354608,-26 354748,-26 354748,-78"/>
<text text-anchor="middle" x="354678" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="354678" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="354678" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="354678" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L6_EP0TP1PP0DP1_GPU9 -->
<g id="node1729" class="node">
<title>expert_2_L6_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="354924,-78 354784,-78 354784,-26 354924,-26 354924,-78"/>
<text text-anchor="middle" x="354854" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="354854" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="354854" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="354854" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L6_EP0TP1PP0DP1_GPU9 -->
<g id="node1730" class="node">
<title>expert_3_L6_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="355100,-78 354960,-78 354960,-26 355100,-26 355100,-78"/>
<text text-anchor="middle" x="355030" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="355030" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="355030" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="355030" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L6_EP0TP1PP0DP1_GPU9 -->
<g id="node1731" class="node">
<title>combine_L6_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="355235" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="355235" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="355235" y="-44" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP1_GPU9</text>
</g>
<!-- ffn_L6_EP0TP1PP0DP1_GPU9 -->
<g id="node1732" class="node">
<title>ffn_L6_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="355540,-78 355370,-78 355370,-26 355540,-26 355540,-78"/>
<text text-anchor="middle" x="355455" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="355455" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="355455" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="355455" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L6_EP0TP1PP0DP1_GPU9 -->
<g id="node1733" class="node">
<title>ffn_ar_L6_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="355679" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="355679" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="355679" y="-49.5" font-family="Arial" font-size="10.00">L6 EP0 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="355679" y="-38.5" font-family="Arial" font-size="10.00">GPU9</text>
</g>
<!-- residual2_L6_EP0TP1PP0DP1_GPU9 -->
<g id="node1734" class="node">
<title>residual2_L6_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="355964,-78 355818,-78 355818,-26 355964,-26 355964,-78"/>
<text text-anchor="middle" x="355891" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="355891" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="355891" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="355891" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L6_EP0TP2PP0DP0_GPU16 -->
<g id="node1735" class="node">
<title>ln1_L6_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="356145.5,-78 356000.5,-78 356000.5,-26 356145.5,-26 356145.5,-78"/>
<text text-anchor="middle" x="356073" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="356073" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="356073" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="356073" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L6_EP0TP2PP0DP0_GPU16 -->
<g id="node1736" class="node">
<title>qkv_L6_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="356326.5,-78 356181.5,-78 356181.5,-26 356326.5,-26 356326.5,-78"/>
<text text-anchor="middle" x="356254" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="356254" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="356254" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="356254" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L6_EP0TP2PP0DP0_GPU16 -->
<g id="node1737" class="node">
<title>attn_L6_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="356513.5,-78 356362.5,-78 356362.5,-26 356513.5,-26 356513.5,-78"/>
<text text-anchor="middle" x="356438" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="356438" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="356438" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="356438" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L6_EP0TP2PP0DP0_GPU16 -->
<g id="node1738" class="node">
<title>attn_out_L6_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="356694.5,-78 356549.5,-78 356549.5,-26 356694.5,-26 356694.5,-78"/>
<text text-anchor="middle" x="356622" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="356622" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="356622" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="356622" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L6_EP0TP2PP0DP0_GPU16 -->
<g id="node1739" class="node">
<title>attn_ar_L6_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="356834" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="356834" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="356834" y="-49.5" font-family="Arial" font-size="10.00">L6 EP0 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="356834" y="-38.5" font-family="Arial" font-size="10.00">GPU16</text>
</g>
<!-- residual1_L6_EP0TP2PP0DP0_GPU16 -->
<g id="node1740" class="node">
<title>residual1_L6_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="357119,-78 356973,-78 356973,-26 357119,-26 357119,-78"/>
<text text-anchor="middle" x="357046" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="357046" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="357046" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="357046" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L6_EP0TP2PP0DP0_GPU16 -->
<g id="node1741" class="node">
<title>ln2_L6_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="357300.5,-78 357155.5,-78 357155.5,-26 357300.5,-26 357300.5,-78"/>
<text text-anchor="middle" x="357228" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="357228" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="357228" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="357228" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L6_EP0TP2PP0DP0_GPU16 -->
<g id="node1742" class="node">
<title>gate_L6_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightyellow" stroke="black" points="357637.16,-104 357398.29,-104 357336.84,0 357575.71,0 357637.16,-104"/>
<text text-anchor="middle" x="357487" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="357487" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="357487" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="357487" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L6_EP0TP2PP0DP0_GPU16 -->
<g id="node1743" class="node">
<title>dispatch_L6_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="357776" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="357776" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="357776" y="-44" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP0_GPU16</text>
</g>
<!-- expert_0_L6_EP0TP2PP0DP0_GPU16 -->
<g id="node1744" class="node">
<title>expert_0_L6_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="358059.5,-78 357914.5,-78 357914.5,-26 358059.5,-26 358059.5,-78"/>
<text text-anchor="middle" x="357987" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="357987" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="357987" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="357987" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L6_EP0TP2PP0DP0_GPU16 -->
<g id="node1745" class="node">
<title>expert_1_L6_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="358240.5,-78 358095.5,-78 358095.5,-26 358240.5,-26 358240.5,-78"/>
<text text-anchor="middle" x="358168" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="358168" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="358168" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="358168" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L6_EP0TP2PP0DP0_GPU16 -->
<g id="node1746" class="node">
<title>expert_2_L6_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="358421.5,-78 358276.5,-78 358276.5,-26 358421.5,-26 358421.5,-78"/>
<text text-anchor="middle" x="358349" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="358349" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="358349" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="358349" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L6_EP0TP2PP0DP0_GPU16 -->
<g id="node1747" class="node">
<title>expert_3_L6_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="358602.5,-78 358457.5,-78 358457.5,-26 358602.5,-26 358602.5,-78"/>
<text text-anchor="middle" x="358530" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="358530" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="358530" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="358530" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L6_EP0TP2PP0DP0_GPU16 -->
<g id="node1748" class="node">
<title>combine_L6_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="358741" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="358741" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="358741" y="-44" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP0_GPU16</text>
</g>
<!-- ffn_L6_EP0TP2PP0DP0_GPU16 -->
<g id="node1749" class="node">
<title>ffn_L6_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="359050,-78 358880,-78 358880,-26 359050,-26 359050,-78"/>
<text text-anchor="middle" x="358965" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="358965" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="358965" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="358965" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L6_EP0TP2PP0DP0_GPU16 -->
<g id="node1750" class="node">
<title>ffn_ar_L6_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="359189" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="359189" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="359189" y="-49.5" font-family="Arial" font-size="10.00">L6 EP0 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="359189" y="-38.5" font-family="Arial" font-size="10.00">GPU16</text>
</g>
<!-- residual2_L6_EP0TP2PP0DP0_GPU16 -->
<g id="node1751" class="node">
<title>residual2_L6_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="359474,-78 359328,-78 359328,-26 359474,-26 359474,-78"/>
<text text-anchor="middle" x="359401" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="359401" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="359401" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="359401" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L6_EP0TP2PP0DP1_GPU17 -->
<g id="node1752" class="node">
<title>ln1_L6_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="359655.5,-78 359510.5,-78 359510.5,-26 359655.5,-26 359655.5,-78"/>
<text text-anchor="middle" x="359583" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="359583" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="359583" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="359583" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L6_EP0TP2PP0DP1_GPU17 -->
<g id="node1753" class="node">
<title>qkv_L6_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="359836.5,-78 359691.5,-78 359691.5,-26 359836.5,-26 359836.5,-78"/>
<text text-anchor="middle" x="359764" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="359764" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="359764" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="359764" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L6_EP0TP2PP0DP1_GPU17 -->
<g id="node1754" class="node">
<title>attn_L6_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="360023.5,-78 359872.5,-78 359872.5,-26 360023.5,-26 360023.5,-78"/>
<text text-anchor="middle" x="359948" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="359948" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="359948" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="359948" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L6_EP0TP2PP0DP1_GPU17 -->
<g id="node1755" class="node">
<title>attn_out_L6_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="360204.5,-78 360059.5,-78 360059.5,-26 360204.5,-26 360204.5,-78"/>
<text text-anchor="middle" x="360132" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="360132" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="360132" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="360132" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L6_EP0TP2PP0DP1_GPU17 -->
<g id="node1756" class="node">
<title>attn_ar_L6_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="360344" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="360344" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="360344" y="-49.5" font-family="Arial" font-size="10.00">L6 EP0 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="360344" y="-38.5" font-family="Arial" font-size="10.00">GPU17</text>
</g>
<!-- residual1_L6_EP0TP2PP0DP1_GPU17 -->
<g id="node1757" class="node">
<title>residual1_L6_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="360629,-78 360483,-78 360483,-26 360629,-26 360629,-78"/>
<text text-anchor="middle" x="360556" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="360556" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="360556" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="360556" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L6_EP0TP2PP0DP1_GPU17 -->
<g id="node1758" class="node">
<title>ln2_L6_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="360810.5,-78 360665.5,-78 360665.5,-26 360810.5,-26 360810.5,-78"/>
<text text-anchor="middle" x="360738" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="360738" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="360738" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="360738" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L6_EP0TP2PP0DP1_GPU17 -->
<g id="node1759" class="node">
<title>gate_L6_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightyellow" stroke="black" points="361147.16,-104 360908.29,-104 360846.84,0 361085.71,0 361147.16,-104"/>
<text text-anchor="middle" x="360997" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="360997" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="360997" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="360997" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L6_EP0TP2PP0DP1_GPU17 -->
<g id="node1760" class="node">
<title>dispatch_L6_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="361286" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="361286" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="361286" y="-44" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP1_GPU17</text>
</g>
<!-- expert_0_L6_EP0TP2PP0DP1_GPU17 -->
<g id="node1761" class="node">
<title>expert_0_L6_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="361569.5,-78 361424.5,-78 361424.5,-26 361569.5,-26 361569.5,-78"/>
<text text-anchor="middle" x="361497" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="361497" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="361497" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="361497" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L6_EP0TP2PP0DP1_GPU17 -->
<g id="node1762" class="node">
<title>expert_1_L6_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="361750.5,-78 361605.5,-78 361605.5,-26 361750.5,-26 361750.5,-78"/>
<text text-anchor="middle" x="361678" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="361678" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="361678" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="361678" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L6_EP0TP2PP0DP1_GPU17 -->
<g id="node1763" class="node">
<title>expert_2_L6_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="361931.5,-78 361786.5,-78 361786.5,-26 361931.5,-26 361931.5,-78"/>
<text text-anchor="middle" x="361859" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="361859" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="361859" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="361859" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L6_EP0TP2PP0DP1_GPU17 -->
<g id="node1764" class="node">
<title>expert_3_L6_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="362112.5,-78 361967.5,-78 361967.5,-26 362112.5,-26 362112.5,-78"/>
<text text-anchor="middle" x="362040" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="362040" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="362040" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="362040" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L6_EP0TP2PP0DP1_GPU17 -->
<g id="node1765" class="node">
<title>combine_L6_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="362251" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="362251" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="362251" y="-44" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP1_GPU17</text>
</g>
<!-- ffn_L6_EP0TP2PP0DP1_GPU17 -->
<g id="node1766" class="node">
<title>ffn_L6_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="362560,-78 362390,-78 362390,-26 362560,-26 362560,-78"/>
<text text-anchor="middle" x="362475" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="362475" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="362475" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="362475" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L6_EP0TP2PP0DP1_GPU17 -->
<g id="node1767" class="node">
<title>ffn_ar_L6_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="362699" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="362699" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="362699" y="-49.5" font-family="Arial" font-size="10.00">L6 EP0 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="362699" y="-38.5" font-family="Arial" font-size="10.00">GPU17</text>
</g>
<!-- residual2_L6_EP0TP2PP0DP1_GPU17 -->
<g id="node1768" class="node">
<title>residual2_L6_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="362984,-78 362838,-78 362838,-26 362984,-26 362984,-78"/>
<text text-anchor="middle" x="362911" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="362911" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="362911" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="362911" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L6_EP0TP3PP0DP0_GPU24 -->
<g id="node1769" class="node">
<title>ln1_L6_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="363165.5,-78 363020.5,-78 363020.5,-26 363165.5,-26 363165.5,-78"/>
<text text-anchor="middle" x="363093" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="363093" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="363093" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="363093" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L6_EP0TP3PP0DP0_GPU24 -->
<g id="node1770" class="node">
<title>qkv_L6_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="363346.5,-78 363201.5,-78 363201.5,-26 363346.5,-26 363346.5,-78"/>
<text text-anchor="middle" x="363274" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="363274" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="363274" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="363274" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L6_EP0TP3PP0DP0_GPU24 -->
<g id="node1771" class="node">
<title>attn_L6_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="363533.5,-78 363382.5,-78 363382.5,-26 363533.5,-26 363533.5,-78"/>
<text text-anchor="middle" x="363458" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="363458" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="363458" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="363458" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L6_EP0TP3PP0DP0_GPU24 -->
<g id="node1772" class="node">
<title>attn_out_L6_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="363714.5,-78 363569.5,-78 363569.5,-26 363714.5,-26 363714.5,-78"/>
<text text-anchor="middle" x="363642" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="363642" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="363642" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="363642" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L6_EP0TP3PP0DP0_GPU24 -->
<g id="node1773" class="node">
<title>attn_ar_L6_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="363854" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="363854" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="363854" y="-49.5" font-family="Arial" font-size="10.00">L6 EP0 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="363854" y="-38.5" font-family="Arial" font-size="10.00">GPU24</text>
</g>
<!-- residual1_L6_EP0TP3PP0DP0_GPU24 -->
<g id="node1774" class="node">
<title>residual1_L6_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="364139,-78 363993,-78 363993,-26 364139,-26 364139,-78"/>
<text text-anchor="middle" x="364066" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="364066" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="364066" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="364066" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L6_EP0TP3PP0DP0_GPU24 -->
<g id="node1775" class="node">
<title>ln2_L6_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="364320.5,-78 364175.5,-78 364175.5,-26 364320.5,-26 364320.5,-78"/>
<text text-anchor="middle" x="364248" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="364248" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="364248" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="364248" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L6_EP0TP3PP0DP0_GPU24 -->
<g id="node1776" class="node">
<title>gate_L6_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightyellow" stroke="black" points="364657.16,-104 364418.29,-104 364356.84,0 364595.71,0 364657.16,-104"/>
<text text-anchor="middle" x="364507" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="364507" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="364507" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="364507" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L6_EP0TP3PP0DP0_GPU24 -->
<g id="node1777" class="node">
<title>dispatch_L6_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="364796" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="364796" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="364796" y="-44" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP0_GPU24</text>
</g>
<!-- expert_0_L6_EP0TP3PP0DP0_GPU24 -->
<g id="node1778" class="node">
<title>expert_0_L6_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="365079.5,-78 364934.5,-78 364934.5,-26 365079.5,-26 365079.5,-78"/>
<text text-anchor="middle" x="365007" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="365007" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="365007" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="365007" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L6_EP0TP3PP0DP0_GPU24 -->
<g id="node1779" class="node">
<title>expert_1_L6_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="365260.5,-78 365115.5,-78 365115.5,-26 365260.5,-26 365260.5,-78"/>
<text text-anchor="middle" x="365188" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="365188" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="365188" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="365188" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L6_EP0TP3PP0DP0_GPU24 -->
<g id="node1780" class="node">
<title>expert_2_L6_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="365441.5,-78 365296.5,-78 365296.5,-26 365441.5,-26 365441.5,-78"/>
<text text-anchor="middle" x="365369" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="365369" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="365369" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="365369" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L6_EP0TP3PP0DP0_GPU24 -->
<g id="node1781" class="node">
<title>expert_3_L6_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="365622.5,-78 365477.5,-78 365477.5,-26 365622.5,-26 365622.5,-78"/>
<text text-anchor="middle" x="365550" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="365550" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="365550" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="365550" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L6_EP0TP3PP0DP0_GPU24 -->
<g id="node1782" class="node">
<title>combine_L6_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="365761" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="365761" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="365761" y="-44" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP0_GPU24</text>
</g>
<!-- ffn_L6_EP0TP3PP0DP0_GPU24 -->
<g id="node1783" class="node">
<title>ffn_L6_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="366070,-78 365900,-78 365900,-26 366070,-26 366070,-78"/>
<text text-anchor="middle" x="365985" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="365985" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="365985" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="365985" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L6_EP0TP3PP0DP0_GPU24 -->
<g id="node1784" class="node">
<title>ffn_ar_L6_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="366209" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="366209" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="366209" y="-49.5" font-family="Arial" font-size="10.00">L6 EP0 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="366209" y="-38.5" font-family="Arial" font-size="10.00">GPU24</text>
</g>
<!-- residual2_L6_EP0TP3PP0DP0_GPU24 -->
<g id="node1785" class="node">
<title>residual2_L6_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="366494,-78 366348,-78 366348,-26 366494,-26 366494,-78"/>
<text text-anchor="middle" x="366421" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="366421" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="366421" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="366421" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L6_EP0TP3PP0DP1_GPU25 -->
<g id="node1786" class="node">
<title>ln1_L6_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="366675.5,-78 366530.5,-78 366530.5,-26 366675.5,-26 366675.5,-78"/>
<text text-anchor="middle" x="366603" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="366603" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="366603" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="366603" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L6_EP0TP3PP0DP1_GPU25 -->
<g id="node1787" class="node">
<title>qkv_L6_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="366856.5,-78 366711.5,-78 366711.5,-26 366856.5,-26 366856.5,-78"/>
<text text-anchor="middle" x="366784" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="366784" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="366784" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="366784" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L6_EP0TP3PP0DP1_GPU25 -->
<g id="node1788" class="node">
<title>attn_L6_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="367043.5,-78 366892.5,-78 366892.5,-26 367043.5,-26 367043.5,-78"/>
<text text-anchor="middle" x="366968" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="366968" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="366968" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="366968" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L6_EP0TP3PP0DP1_GPU25 -->
<g id="node1789" class="node">
<title>attn_out_L6_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="367224.5,-78 367079.5,-78 367079.5,-26 367224.5,-26 367224.5,-78"/>
<text text-anchor="middle" x="367152" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="367152" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="367152" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="367152" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L6_EP0TP3PP0DP1_GPU25 -->
<g id="node1790" class="node">
<title>attn_ar_L6_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="367364" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="367364" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="367364" y="-49.5" font-family="Arial" font-size="10.00">L6 EP0 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="367364" y="-38.5" font-family="Arial" font-size="10.00">GPU25</text>
</g>
<!-- residual1_L6_EP0TP3PP0DP1_GPU25 -->
<g id="node1791" class="node">
<title>residual1_L6_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="367649,-78 367503,-78 367503,-26 367649,-26 367649,-78"/>
<text text-anchor="middle" x="367576" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="367576" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="367576" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="367576" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L6_EP0TP3PP0DP1_GPU25 -->
<g id="node1792" class="node">
<title>ln2_L6_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="367830.5,-78 367685.5,-78 367685.5,-26 367830.5,-26 367830.5,-78"/>
<text text-anchor="middle" x="367758" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="367758" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="367758" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="367758" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L6_EP0TP3PP0DP1_GPU25 -->
<g id="node1793" class="node">
<title>gate_L6_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightyellow" stroke="black" points="368167.16,-104 367928.29,-104 367866.84,0 368105.71,0 368167.16,-104"/>
<text text-anchor="middle" x="368017" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="368017" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="368017" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="368017" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L6_EP0TP3PP0DP1_GPU25 -->
<g id="node1794" class="node">
<title>dispatch_L6_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="368306" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="368306" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="368306" y="-44" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP1_GPU25</text>
</g>
<!-- expert_0_L6_EP0TP3PP0DP1_GPU25 -->
<g id="node1795" class="node">
<title>expert_0_L6_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="368589.5,-78 368444.5,-78 368444.5,-26 368589.5,-26 368589.5,-78"/>
<text text-anchor="middle" x="368517" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="368517" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="368517" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="368517" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L6_EP0TP3PP0DP1_GPU25 -->
<g id="node1796" class="node">
<title>expert_1_L6_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="368770.5,-78 368625.5,-78 368625.5,-26 368770.5,-26 368770.5,-78"/>
<text text-anchor="middle" x="368698" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="368698" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="368698" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="368698" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L6_EP0TP3PP0DP1_GPU25 -->
<g id="node1797" class="node">
<title>expert_2_L6_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="368951.5,-78 368806.5,-78 368806.5,-26 368951.5,-26 368951.5,-78"/>
<text text-anchor="middle" x="368879" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="368879" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="368879" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="368879" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L6_EP0TP3PP0DP1_GPU25 -->
<g id="node1798" class="node">
<title>expert_3_L6_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="369132.5,-78 368987.5,-78 368987.5,-26 369132.5,-26 369132.5,-78"/>
<text text-anchor="middle" x="369060" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="369060" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="369060" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="369060" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L6_EP0TP3PP0DP1_GPU25 -->
<g id="node1799" class="node">
<title>combine_L6_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="369271" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="369271" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="369271" y="-44" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP1_GPU25</text>
</g>
<!-- ffn_L6_EP0TP3PP0DP1_GPU25 -->
<g id="node1800" class="node">
<title>ffn_L6_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="369580,-78 369410,-78 369410,-26 369580,-26 369580,-78"/>
<text text-anchor="middle" x="369495" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="369495" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="369495" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="369495" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L6_EP0TP3PP0DP1_GPU25 -->
<g id="node1801" class="node">
<title>ffn_ar_L6_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="369719" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="369719" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="369719" y="-49.5" font-family="Arial" font-size="10.00">L6 EP0 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="369719" y="-38.5" font-family="Arial" font-size="10.00">GPU25</text>
</g>
<!-- residual2_L6_EP0TP3PP0DP1_GPU25 -->
<g id="node1802" class="node">
<title>residual2_L6_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="370004,-78 369858,-78 369858,-26 370004,-26 370004,-78"/>
<text text-anchor="middle" x="369931" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="369931" y="-55" font-family="Arial" font-size="10.00">L6_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="369931" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="369931" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L6_EP1TP0PP0DP0_GPU32 -->
<g id="node1803" class="node">
<title>ln1_L6_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="370185.5,-78 370040.5,-78 370040.5,-26 370185.5,-26 370185.5,-78"/>
<text text-anchor="middle" x="370113" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="370113" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="370113" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="370113" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L6_EP1TP0PP0DP0_GPU32 -->
<g id="node1804" class="node">
<title>qkv_L6_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="370366.5,-78 370221.5,-78 370221.5,-26 370366.5,-26 370366.5,-78"/>
<text text-anchor="middle" x="370294" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="370294" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="370294" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="370294" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L6_EP1TP0PP0DP0_GPU32 -->
<g id="node1805" class="node">
<title>attn_L6_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="370553.5,-78 370402.5,-78 370402.5,-26 370553.5,-26 370553.5,-78"/>
<text text-anchor="middle" x="370478" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="370478" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="370478" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="370478" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L6_EP1TP0PP0DP0_GPU32 -->
<g id="node1806" class="node">
<title>attn_out_L6_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="370734.5,-78 370589.5,-78 370589.5,-26 370734.5,-26 370734.5,-78"/>
<text text-anchor="middle" x="370662" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="370662" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="370662" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="370662" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L6_EP1TP0PP0DP0_GPU32 -->
<g id="node1807" class="node">
<title>attn_ar_L6_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="370874" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="370874" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="370874" y="-49.5" font-family="Arial" font-size="10.00">L6 EP1 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="370874" y="-38.5" font-family="Arial" font-size="10.00">GPU32</text>
</g>
<!-- residual1_L6_EP1TP0PP0DP0_GPU32 -->
<g id="node1808" class="node">
<title>residual1_L6_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="371159,-78 371013,-78 371013,-26 371159,-26 371159,-78"/>
<text text-anchor="middle" x="371086" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="371086" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="371086" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="371086" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L6_EP1TP0PP0DP0_GPU32 -->
<g id="node1809" class="node">
<title>ln2_L6_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="371340.5,-78 371195.5,-78 371195.5,-26 371340.5,-26 371340.5,-78"/>
<text text-anchor="middle" x="371268" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="371268" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="371268" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="371268" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L6_EP1TP0PP0DP0_GPU32 -->
<g id="node1810" class="node">
<title>gate_L6_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightyellow" stroke="black" points="371677.16,-104 371438.29,-104 371376.84,0 371615.71,0 371677.16,-104"/>
<text text-anchor="middle" x="371527" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="371527" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="371527" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="371527" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L6_EP1TP0PP0DP0_GPU32 -->
<g id="node1811" class="node">
<title>dispatch_L6_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="371816" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="371816" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="371816" y="-44" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP0_GPU32</text>
</g>
<!-- expert_0_L6_EP1TP0PP0DP0_GPU32 -->
<g id="node1812" class="node">
<title>expert_0_L6_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="372099.5,-78 371954.5,-78 371954.5,-26 372099.5,-26 372099.5,-78"/>
<text text-anchor="middle" x="372027" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="372027" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="372027" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="372027" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L6_EP1TP0PP0DP0_GPU32 -->
<g id="node1813" class="node">
<title>expert_1_L6_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="372280.5,-78 372135.5,-78 372135.5,-26 372280.5,-26 372280.5,-78"/>
<text text-anchor="middle" x="372208" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="372208" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="372208" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="372208" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L6_EP1TP0PP0DP0_GPU32 -->
<g id="node1814" class="node">
<title>expert_2_L6_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="372461.5,-78 372316.5,-78 372316.5,-26 372461.5,-26 372461.5,-78"/>
<text text-anchor="middle" x="372389" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="372389" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="372389" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="372389" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L6_EP1TP0PP0DP0_GPU32 -->
<g id="node1815" class="node">
<title>expert_3_L6_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="372642.5,-78 372497.5,-78 372497.5,-26 372642.5,-26 372642.5,-78"/>
<text text-anchor="middle" x="372570" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="372570" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="372570" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="372570" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L6_EP1TP0PP0DP0_GPU32 -->
<g id="node1816" class="node">
<title>combine_L6_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="372781" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="372781" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="372781" y="-44" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP0_GPU32</text>
</g>
<!-- ffn_L6_EP1TP0PP0DP0_GPU32 -->
<g id="node1817" class="node">
<title>ffn_L6_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="373090,-78 372920,-78 372920,-26 373090,-26 373090,-78"/>
<text text-anchor="middle" x="373005" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="373005" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="373005" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="373005" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L6_EP1TP0PP0DP0_GPU32 -->
<g id="node1818" class="node">
<title>ffn_ar_L6_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="373229" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="373229" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="373229" y="-49.5" font-family="Arial" font-size="10.00">L6 EP1 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="373229" y="-38.5" font-family="Arial" font-size="10.00">GPU32</text>
</g>
<!-- residual2_L6_EP1TP0PP0DP0_GPU32 -->
<g id="node1819" class="node">
<title>residual2_L6_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="373514,-78 373368,-78 373368,-26 373514,-26 373514,-78"/>
<text text-anchor="middle" x="373441" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="373441" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="373441" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="373441" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L6_EP1TP0PP0DP1_GPU33 -->
<g id="node1820" class="node">
<title>ln1_L6_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="373695.5,-78 373550.5,-78 373550.5,-26 373695.5,-26 373695.5,-78"/>
<text text-anchor="middle" x="373623" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="373623" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="373623" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="373623" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L6_EP1TP0PP0DP1_GPU33 -->
<g id="node1821" class="node">
<title>qkv_L6_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="373876.5,-78 373731.5,-78 373731.5,-26 373876.5,-26 373876.5,-78"/>
<text text-anchor="middle" x="373804" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="373804" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="373804" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="373804" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L6_EP1TP0PP0DP1_GPU33 -->
<g id="node1822" class="node">
<title>attn_L6_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="374063.5,-78 373912.5,-78 373912.5,-26 374063.5,-26 374063.5,-78"/>
<text text-anchor="middle" x="373988" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="373988" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="373988" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="373988" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L6_EP1TP0PP0DP1_GPU33 -->
<g id="node1823" class="node">
<title>attn_out_L6_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="374244.5,-78 374099.5,-78 374099.5,-26 374244.5,-26 374244.5,-78"/>
<text text-anchor="middle" x="374172" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="374172" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="374172" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="374172" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L6_EP1TP0PP0DP1_GPU33 -->
<g id="node1824" class="node">
<title>attn_ar_L6_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="374384" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="374384" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="374384" y="-49.5" font-family="Arial" font-size="10.00">L6 EP1 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="374384" y="-38.5" font-family="Arial" font-size="10.00">GPU33</text>
</g>
<!-- residual1_L6_EP1TP0PP0DP1_GPU33 -->
<g id="node1825" class="node">
<title>residual1_L6_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="374669,-78 374523,-78 374523,-26 374669,-26 374669,-78"/>
<text text-anchor="middle" x="374596" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="374596" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="374596" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="374596" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L6_EP1TP0PP0DP1_GPU33 -->
<g id="node1826" class="node">
<title>ln2_L6_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="374850.5,-78 374705.5,-78 374705.5,-26 374850.5,-26 374850.5,-78"/>
<text text-anchor="middle" x="374778" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="374778" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="374778" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="374778" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L6_EP1TP0PP0DP1_GPU33 -->
<g id="node1827" class="node">
<title>gate_L6_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightyellow" stroke="black" points="375187.16,-104 374948.29,-104 374886.84,0 375125.71,0 375187.16,-104"/>
<text text-anchor="middle" x="375037" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="375037" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="375037" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="375037" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L6_EP1TP0PP0DP1_GPU33 -->
<g id="node1828" class="node">
<title>dispatch_L6_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="375326" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="375326" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="375326" y="-44" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP1_GPU33</text>
</g>
<!-- expert_0_L6_EP1TP0PP0DP1_GPU33 -->
<g id="node1829" class="node">
<title>expert_0_L6_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="375609.5,-78 375464.5,-78 375464.5,-26 375609.5,-26 375609.5,-78"/>
<text text-anchor="middle" x="375537" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="375537" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="375537" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="375537" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L6_EP1TP0PP0DP1_GPU33 -->
<g id="node1830" class="node">
<title>expert_1_L6_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="375790.5,-78 375645.5,-78 375645.5,-26 375790.5,-26 375790.5,-78"/>
<text text-anchor="middle" x="375718" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="375718" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="375718" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="375718" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L6_EP1TP0PP0DP1_GPU33 -->
<g id="node1831" class="node">
<title>expert_2_L6_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="375971.5,-78 375826.5,-78 375826.5,-26 375971.5,-26 375971.5,-78"/>
<text text-anchor="middle" x="375899" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="375899" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="375899" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="375899" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L6_EP1TP0PP0DP1_GPU33 -->
<g id="node1832" class="node">
<title>expert_3_L6_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="376152.5,-78 376007.5,-78 376007.5,-26 376152.5,-26 376152.5,-78"/>
<text text-anchor="middle" x="376080" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="376080" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="376080" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="376080" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L6_EP1TP0PP0DP1_GPU33 -->
<g id="node1833" class="node">
<title>combine_L6_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="376291" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="376291" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="376291" y="-44" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP1_GPU33</text>
</g>
<!-- ffn_L6_EP1TP0PP0DP1_GPU33 -->
<g id="node1834" class="node">
<title>ffn_L6_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="376600,-78 376430,-78 376430,-26 376600,-26 376600,-78"/>
<text text-anchor="middle" x="376515" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="376515" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="376515" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="376515" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L6_EP1TP0PP0DP1_GPU33 -->
<g id="node1835" class="node">
<title>ffn_ar_L6_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="376739" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="376739" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="376739" y="-49.5" font-family="Arial" font-size="10.00">L6 EP1 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="376739" y="-38.5" font-family="Arial" font-size="10.00">GPU33</text>
</g>
<!-- residual2_L6_EP1TP0PP0DP1_GPU33 -->
<g id="node1836" class="node">
<title>residual2_L6_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="377024,-78 376878,-78 376878,-26 377024,-26 377024,-78"/>
<text text-anchor="middle" x="376951" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="376951" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="376951" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="376951" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L6_EP1TP1PP0DP0_GPU40 -->
<g id="node1837" class="node">
<title>ln1_L6_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="377205.5,-78 377060.5,-78 377060.5,-26 377205.5,-26 377205.5,-78"/>
<text text-anchor="middle" x="377133" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="377133" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="377133" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="377133" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L6_EP1TP1PP0DP0_GPU40 -->
<g id="node1838" class="node">
<title>qkv_L6_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="377386.5,-78 377241.5,-78 377241.5,-26 377386.5,-26 377386.5,-78"/>
<text text-anchor="middle" x="377314" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="377314" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="377314" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="377314" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L6_EP1TP1PP0DP0_GPU40 -->
<g id="node1839" class="node">
<title>attn_L6_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="377573.5,-78 377422.5,-78 377422.5,-26 377573.5,-26 377573.5,-78"/>
<text text-anchor="middle" x="377498" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="377498" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="377498" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="377498" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L6_EP1TP1PP0DP0_GPU40 -->
<g id="node1840" class="node">
<title>attn_out_L6_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="377754.5,-78 377609.5,-78 377609.5,-26 377754.5,-26 377754.5,-78"/>
<text text-anchor="middle" x="377682" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="377682" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="377682" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="377682" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L6_EP1TP1PP0DP0_GPU40 -->
<g id="node1841" class="node">
<title>attn_ar_L6_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="377894" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="377894" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="377894" y="-49.5" font-family="Arial" font-size="10.00">L6 EP1 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="377894" y="-38.5" font-family="Arial" font-size="10.00">GPU40</text>
</g>
<!-- residual1_L6_EP1TP1PP0DP0_GPU40 -->
<g id="node1842" class="node">
<title>residual1_L6_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="378179,-78 378033,-78 378033,-26 378179,-26 378179,-78"/>
<text text-anchor="middle" x="378106" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="378106" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="378106" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="378106" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L6_EP1TP1PP0DP0_GPU40 -->
<g id="node1843" class="node">
<title>ln2_L6_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="378360.5,-78 378215.5,-78 378215.5,-26 378360.5,-26 378360.5,-78"/>
<text text-anchor="middle" x="378288" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="378288" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="378288" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="378288" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L6_EP1TP1PP0DP0_GPU40 -->
<g id="node1844" class="node">
<title>gate_L6_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightyellow" stroke="black" points="378697.16,-104 378458.29,-104 378396.84,0 378635.71,0 378697.16,-104"/>
<text text-anchor="middle" x="378547" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="378547" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="378547" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="378547" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L6_EP1TP1PP0DP0_GPU40 -->
<g id="node1845" class="node">
<title>dispatch_L6_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="378836" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="378836" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="378836" y="-44" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP0_GPU40</text>
</g>
<!-- expert_0_L6_EP1TP1PP0DP0_GPU40 -->
<g id="node1846" class="node">
<title>expert_0_L6_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="379119.5,-78 378974.5,-78 378974.5,-26 379119.5,-26 379119.5,-78"/>
<text text-anchor="middle" x="379047" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="379047" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="379047" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="379047" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L6_EP1TP1PP0DP0_GPU40 -->
<g id="node1847" class="node">
<title>expert_1_L6_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="379300.5,-78 379155.5,-78 379155.5,-26 379300.5,-26 379300.5,-78"/>
<text text-anchor="middle" x="379228" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="379228" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="379228" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="379228" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L6_EP1TP1PP0DP0_GPU40 -->
<g id="node1848" class="node">
<title>expert_2_L6_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="379481.5,-78 379336.5,-78 379336.5,-26 379481.5,-26 379481.5,-78"/>
<text text-anchor="middle" x="379409" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="379409" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="379409" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="379409" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L6_EP1TP1PP0DP0_GPU40 -->
<g id="node1849" class="node">
<title>expert_3_L6_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="379662.5,-78 379517.5,-78 379517.5,-26 379662.5,-26 379662.5,-78"/>
<text text-anchor="middle" x="379590" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="379590" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="379590" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="379590" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L6_EP1TP1PP0DP0_GPU40 -->
<g id="node1850" class="node">
<title>combine_L6_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="379801" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="379801" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="379801" y="-44" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP0_GPU40</text>
</g>
<!-- ffn_L6_EP1TP1PP0DP0_GPU40 -->
<g id="node1851" class="node">
<title>ffn_L6_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="380110,-78 379940,-78 379940,-26 380110,-26 380110,-78"/>
<text text-anchor="middle" x="380025" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="380025" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="380025" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="380025" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L6_EP1TP1PP0DP0_GPU40 -->
<g id="node1852" class="node">
<title>ffn_ar_L6_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="380249" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="380249" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="380249" y="-49.5" font-family="Arial" font-size="10.00">L6 EP1 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="380249" y="-38.5" font-family="Arial" font-size="10.00">GPU40</text>
</g>
<!-- residual2_L6_EP1TP1PP0DP0_GPU40 -->
<g id="node1853" class="node">
<title>residual2_L6_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="380534,-78 380388,-78 380388,-26 380534,-26 380534,-78"/>
<text text-anchor="middle" x="380461" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="380461" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="380461" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="380461" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L6_EP1TP1PP0DP1_GPU41 -->
<g id="node1854" class="node">
<title>ln1_L6_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="380715.5,-78 380570.5,-78 380570.5,-26 380715.5,-26 380715.5,-78"/>
<text text-anchor="middle" x="380643" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="380643" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="380643" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="380643" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L6_EP1TP1PP0DP1_GPU41 -->
<g id="node1855" class="node">
<title>qkv_L6_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="380896.5,-78 380751.5,-78 380751.5,-26 380896.5,-26 380896.5,-78"/>
<text text-anchor="middle" x="380824" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="380824" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="380824" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="380824" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L6_EP1TP1PP0DP1_GPU41 -->
<g id="node1856" class="node">
<title>attn_L6_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="381083.5,-78 380932.5,-78 380932.5,-26 381083.5,-26 381083.5,-78"/>
<text text-anchor="middle" x="381008" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="381008" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="381008" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="381008" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L6_EP1TP1PP0DP1_GPU41 -->
<g id="node1857" class="node">
<title>attn_out_L6_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="381264.5,-78 381119.5,-78 381119.5,-26 381264.5,-26 381264.5,-78"/>
<text text-anchor="middle" x="381192" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="381192" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="381192" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="381192" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L6_EP1TP1PP0DP1_GPU41 -->
<g id="node1858" class="node">
<title>attn_ar_L6_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="381404" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="381404" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="381404" y="-49.5" font-family="Arial" font-size="10.00">L6 EP1 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="381404" y="-38.5" font-family="Arial" font-size="10.00">GPU41</text>
</g>
<!-- residual1_L6_EP1TP1PP0DP1_GPU41 -->
<g id="node1859" class="node">
<title>residual1_L6_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="381689,-78 381543,-78 381543,-26 381689,-26 381689,-78"/>
<text text-anchor="middle" x="381616" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="381616" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="381616" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="381616" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L6_EP1TP1PP0DP1_GPU41 -->
<g id="node1860" class="node">
<title>ln2_L6_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="381870.5,-78 381725.5,-78 381725.5,-26 381870.5,-26 381870.5,-78"/>
<text text-anchor="middle" x="381798" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="381798" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="381798" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="381798" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L6_EP1TP1PP0DP1_GPU41 -->
<g id="node1861" class="node">
<title>gate_L6_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightyellow" stroke="black" points="382207.16,-104 381968.29,-104 381906.84,0 382145.71,0 382207.16,-104"/>
<text text-anchor="middle" x="382057" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="382057" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="382057" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="382057" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L6_EP1TP1PP0DP1_GPU41 -->
<g id="node1862" class="node">
<title>dispatch_L6_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="382346" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="382346" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="382346" y="-44" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP1_GPU41</text>
</g>
<!-- expert_0_L6_EP1TP1PP0DP1_GPU41 -->
<g id="node1863" class="node">
<title>expert_0_L6_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="382629.5,-78 382484.5,-78 382484.5,-26 382629.5,-26 382629.5,-78"/>
<text text-anchor="middle" x="382557" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="382557" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="382557" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="382557" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L6_EP1TP1PP0DP1_GPU41 -->
<g id="node1864" class="node">
<title>expert_1_L6_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="382810.5,-78 382665.5,-78 382665.5,-26 382810.5,-26 382810.5,-78"/>
<text text-anchor="middle" x="382738" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="382738" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="382738" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="382738" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L6_EP1TP1PP0DP1_GPU41 -->
<g id="node1865" class="node">
<title>expert_2_L6_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="382991.5,-78 382846.5,-78 382846.5,-26 382991.5,-26 382991.5,-78"/>
<text text-anchor="middle" x="382919" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="382919" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="382919" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="382919" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L6_EP1TP1PP0DP1_GPU41 -->
<g id="node1866" class="node">
<title>expert_3_L6_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="383172.5,-78 383027.5,-78 383027.5,-26 383172.5,-26 383172.5,-78"/>
<text text-anchor="middle" x="383100" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="383100" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="383100" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="383100" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L6_EP1TP1PP0DP1_GPU41 -->
<g id="node1867" class="node">
<title>combine_L6_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="383311" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="383311" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="383311" y="-44" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP1_GPU41</text>
</g>
<!-- ffn_L6_EP1TP1PP0DP1_GPU41 -->
<g id="node1868" class="node">
<title>ffn_L6_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="383620,-78 383450,-78 383450,-26 383620,-26 383620,-78"/>
<text text-anchor="middle" x="383535" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="383535" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="383535" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="383535" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L6_EP1TP1PP0DP1_GPU41 -->
<g id="node1869" class="node">
<title>ffn_ar_L6_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="383759" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="383759" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="383759" y="-49.5" font-family="Arial" font-size="10.00">L6 EP1 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="383759" y="-38.5" font-family="Arial" font-size="10.00">GPU41</text>
</g>
<!-- residual2_L6_EP1TP1PP0DP1_GPU41 -->
<g id="node1870" class="node">
<title>residual2_L6_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="384044,-78 383898,-78 383898,-26 384044,-26 384044,-78"/>
<text text-anchor="middle" x="383971" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="383971" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="383971" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="383971" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L6_EP1TP2PP0DP0_GPU48 -->
<g id="node1871" class="node">
<title>ln1_L6_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="384225.5,-78 384080.5,-78 384080.5,-26 384225.5,-26 384225.5,-78"/>
<text text-anchor="middle" x="384153" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="384153" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="384153" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="384153" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L6_EP1TP2PP0DP0_GPU48 -->
<g id="node1872" class="node">
<title>qkv_L6_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="384406.5,-78 384261.5,-78 384261.5,-26 384406.5,-26 384406.5,-78"/>
<text text-anchor="middle" x="384334" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="384334" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="384334" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="384334" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L6_EP1TP2PP0DP0_GPU48 -->
<g id="node1873" class="node">
<title>attn_L6_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="384593.5,-78 384442.5,-78 384442.5,-26 384593.5,-26 384593.5,-78"/>
<text text-anchor="middle" x="384518" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="384518" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="384518" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="384518" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L6_EP1TP2PP0DP0_GPU48 -->
<g id="node1874" class="node">
<title>attn_out_L6_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="384774.5,-78 384629.5,-78 384629.5,-26 384774.5,-26 384774.5,-78"/>
<text text-anchor="middle" x="384702" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="384702" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="384702" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="384702" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L6_EP1TP2PP0DP0_GPU48 -->
<g id="node1875" class="node">
<title>attn_ar_L6_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="384914" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="384914" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="384914" y="-49.5" font-family="Arial" font-size="10.00">L6 EP1 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="384914" y="-38.5" font-family="Arial" font-size="10.00">GPU48</text>
</g>
<!-- residual1_L6_EP1TP2PP0DP0_GPU48 -->
<g id="node1876" class="node">
<title>residual1_L6_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="385199,-78 385053,-78 385053,-26 385199,-26 385199,-78"/>
<text text-anchor="middle" x="385126" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="385126" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="385126" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="385126" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L6_EP1TP2PP0DP0_GPU48 -->
<g id="node1877" class="node">
<title>ln2_L6_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="385380.5,-78 385235.5,-78 385235.5,-26 385380.5,-26 385380.5,-78"/>
<text text-anchor="middle" x="385308" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="385308" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="385308" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="385308" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L6_EP1TP2PP0DP0_GPU48 -->
<g id="node1878" class="node">
<title>gate_L6_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightyellow" stroke="black" points="385717.16,-104 385478.29,-104 385416.84,0 385655.71,0 385717.16,-104"/>
<text text-anchor="middle" x="385567" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="385567" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="385567" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="385567" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L6_EP1TP2PP0DP0_GPU48 -->
<g id="node1879" class="node">
<title>dispatch_L6_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="385856" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="385856" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="385856" y="-44" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP0_GPU48</text>
</g>
<!-- expert_0_L6_EP1TP2PP0DP0_GPU48 -->
<g id="node1880" class="node">
<title>expert_0_L6_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="386139.5,-78 385994.5,-78 385994.5,-26 386139.5,-26 386139.5,-78"/>
<text text-anchor="middle" x="386067" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="386067" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="386067" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="386067" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L6_EP1TP2PP0DP0_GPU48 -->
<g id="node1881" class="node">
<title>expert_1_L6_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="386320.5,-78 386175.5,-78 386175.5,-26 386320.5,-26 386320.5,-78"/>
<text text-anchor="middle" x="386248" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="386248" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="386248" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="386248" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L6_EP1TP2PP0DP0_GPU48 -->
<g id="node1882" class="node">
<title>expert_2_L6_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="386501.5,-78 386356.5,-78 386356.5,-26 386501.5,-26 386501.5,-78"/>
<text text-anchor="middle" x="386429" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="386429" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="386429" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="386429" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L6_EP1TP2PP0DP0_GPU48 -->
<g id="node1883" class="node">
<title>expert_3_L6_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="386682.5,-78 386537.5,-78 386537.5,-26 386682.5,-26 386682.5,-78"/>
<text text-anchor="middle" x="386610" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="386610" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="386610" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="386610" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L6_EP1TP2PP0DP0_GPU48 -->
<g id="node1884" class="node">
<title>combine_L6_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="386821" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="386821" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="386821" y="-44" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP0_GPU48</text>
</g>
<!-- ffn_L6_EP1TP2PP0DP0_GPU48 -->
<g id="node1885" class="node">
<title>ffn_L6_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="387130,-78 386960,-78 386960,-26 387130,-26 387130,-78"/>
<text text-anchor="middle" x="387045" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="387045" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="387045" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="387045" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L6_EP1TP2PP0DP0_GPU48 -->
<g id="node1886" class="node">
<title>ffn_ar_L6_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="387269" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="387269" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="387269" y="-49.5" font-family="Arial" font-size="10.00">L6 EP1 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="387269" y="-38.5" font-family="Arial" font-size="10.00">GPU48</text>
</g>
<!-- residual2_L6_EP1TP2PP0DP0_GPU48 -->
<g id="node1887" class="node">
<title>residual2_L6_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="387554,-78 387408,-78 387408,-26 387554,-26 387554,-78"/>
<text text-anchor="middle" x="387481" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="387481" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="387481" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="387481" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L6_EP1TP2PP0DP1_GPU49 -->
<g id="node1888" class="node">
<title>ln1_L6_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="387735.5,-78 387590.5,-78 387590.5,-26 387735.5,-26 387735.5,-78"/>
<text text-anchor="middle" x="387663" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="387663" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="387663" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="387663" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L6_EP1TP2PP0DP1_GPU49 -->
<g id="node1889" class="node">
<title>qkv_L6_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="387916.5,-78 387771.5,-78 387771.5,-26 387916.5,-26 387916.5,-78"/>
<text text-anchor="middle" x="387844" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="387844" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="387844" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="387844" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L6_EP1TP2PP0DP1_GPU49 -->
<g id="node1890" class="node">
<title>attn_L6_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="388103.5,-78 387952.5,-78 387952.5,-26 388103.5,-26 388103.5,-78"/>
<text text-anchor="middle" x="388028" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="388028" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="388028" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="388028" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L6_EP1TP2PP0DP1_GPU49 -->
<g id="node1891" class="node">
<title>attn_out_L6_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="388284.5,-78 388139.5,-78 388139.5,-26 388284.5,-26 388284.5,-78"/>
<text text-anchor="middle" x="388212" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="388212" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="388212" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="388212" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L6_EP1TP2PP0DP1_GPU49 -->
<g id="node1892" class="node">
<title>attn_ar_L6_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="388424" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="388424" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="388424" y="-49.5" font-family="Arial" font-size="10.00">L6 EP1 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="388424" y="-38.5" font-family="Arial" font-size="10.00">GPU49</text>
</g>
<!-- residual1_L6_EP1TP2PP0DP1_GPU49 -->
<g id="node1893" class="node">
<title>residual1_L6_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="388709,-78 388563,-78 388563,-26 388709,-26 388709,-78"/>
<text text-anchor="middle" x="388636" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="388636" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="388636" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="388636" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L6_EP1TP2PP0DP1_GPU49 -->
<g id="node1894" class="node">
<title>ln2_L6_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="388890.5,-78 388745.5,-78 388745.5,-26 388890.5,-26 388890.5,-78"/>
<text text-anchor="middle" x="388818" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="388818" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="388818" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="388818" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L6_EP1TP2PP0DP1_GPU49 -->
<g id="node1895" class="node">
<title>gate_L6_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightyellow" stroke="black" points="389227.16,-104 388988.29,-104 388926.84,0 389165.71,0 389227.16,-104"/>
<text text-anchor="middle" x="389077" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="389077" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="389077" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="389077" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L6_EP1TP2PP0DP1_GPU49 -->
<g id="node1896" class="node">
<title>dispatch_L6_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="389366" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="389366" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="389366" y="-44" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP1_GPU49</text>
</g>
<!-- expert_0_L6_EP1TP2PP0DP1_GPU49 -->
<g id="node1897" class="node">
<title>expert_0_L6_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="389649.5,-78 389504.5,-78 389504.5,-26 389649.5,-26 389649.5,-78"/>
<text text-anchor="middle" x="389577" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="389577" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="389577" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="389577" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L6_EP1TP2PP0DP1_GPU49 -->
<g id="node1898" class="node">
<title>expert_1_L6_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="389830.5,-78 389685.5,-78 389685.5,-26 389830.5,-26 389830.5,-78"/>
<text text-anchor="middle" x="389758" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="389758" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="389758" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="389758" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L6_EP1TP2PP0DP1_GPU49 -->
<g id="node1899" class="node">
<title>expert_2_L6_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="390011.5,-78 389866.5,-78 389866.5,-26 390011.5,-26 390011.5,-78"/>
<text text-anchor="middle" x="389939" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="389939" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="389939" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="389939" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L6_EP1TP2PP0DP1_GPU49 -->
<g id="node1900" class="node">
<title>expert_3_L6_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="390192.5,-78 390047.5,-78 390047.5,-26 390192.5,-26 390192.5,-78"/>
<text text-anchor="middle" x="390120" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="390120" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="390120" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="390120" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L6_EP1TP2PP0DP1_GPU49 -->
<g id="node1901" class="node">
<title>combine_L6_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="390331" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="390331" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="390331" y="-44" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP1_GPU49</text>
</g>
<!-- ffn_L6_EP1TP2PP0DP1_GPU49 -->
<g id="node1902" class="node">
<title>ffn_L6_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="390640,-78 390470,-78 390470,-26 390640,-26 390640,-78"/>
<text text-anchor="middle" x="390555" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="390555" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="390555" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="390555" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L6_EP1TP2PP0DP1_GPU49 -->
<g id="node1903" class="node">
<title>ffn_ar_L6_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="390779" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="390779" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="390779" y="-49.5" font-family="Arial" font-size="10.00">L6 EP1 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="390779" y="-38.5" font-family="Arial" font-size="10.00">GPU49</text>
</g>
<!-- residual2_L6_EP1TP2PP0DP1_GPU49 -->
<g id="node1904" class="node">
<title>residual2_L6_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="391064,-78 390918,-78 390918,-26 391064,-26 391064,-78"/>
<text text-anchor="middle" x="390991" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="390991" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="390991" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="390991" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L6_EP1TP3PP0DP0_GPU56 -->
<g id="node1905" class="node">
<title>ln1_L6_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="391245.5,-78 391100.5,-78 391100.5,-26 391245.5,-26 391245.5,-78"/>
<text text-anchor="middle" x="391173" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="391173" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="391173" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="391173" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L6_EP1TP3PP0DP0_GPU56 -->
<g id="node1906" class="node">
<title>qkv_L6_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="391426.5,-78 391281.5,-78 391281.5,-26 391426.5,-26 391426.5,-78"/>
<text text-anchor="middle" x="391354" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="391354" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="391354" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="391354" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L6_EP1TP3PP0DP0_GPU56 -->
<g id="node1907" class="node">
<title>attn_L6_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="391613.5,-78 391462.5,-78 391462.5,-26 391613.5,-26 391613.5,-78"/>
<text text-anchor="middle" x="391538" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="391538" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="391538" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="391538" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L6_EP1TP3PP0DP0_GPU56 -->
<g id="node1908" class="node">
<title>attn_out_L6_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="391794.5,-78 391649.5,-78 391649.5,-26 391794.5,-26 391794.5,-78"/>
<text text-anchor="middle" x="391722" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="391722" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="391722" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="391722" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L6_EP1TP3PP0DP0_GPU56 -->
<g id="node1909" class="node">
<title>attn_ar_L6_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="391934" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="391934" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="391934" y="-49.5" font-family="Arial" font-size="10.00">L6 EP1 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="391934" y="-38.5" font-family="Arial" font-size="10.00">GPU56</text>
</g>
<!-- residual1_L6_EP1TP3PP0DP0_GPU56 -->
<g id="node1910" class="node">
<title>residual1_L6_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="392219,-78 392073,-78 392073,-26 392219,-26 392219,-78"/>
<text text-anchor="middle" x="392146" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="392146" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="392146" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="392146" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L6_EP1TP3PP0DP0_GPU56 -->
<g id="node1911" class="node">
<title>ln2_L6_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="392400.5,-78 392255.5,-78 392255.5,-26 392400.5,-26 392400.5,-78"/>
<text text-anchor="middle" x="392328" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="392328" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="392328" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="392328" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L6_EP1TP3PP0DP0_GPU56 -->
<g id="node1912" class="node">
<title>gate_L6_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightyellow" stroke="black" points="392737.16,-104 392498.29,-104 392436.84,0 392675.71,0 392737.16,-104"/>
<text text-anchor="middle" x="392587" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="392587" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="392587" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="392587" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L6_EP1TP3PP0DP0_GPU56 -->
<g id="node1913" class="node">
<title>dispatch_L6_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="392876" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="392876" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="392876" y="-44" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP0_GPU56</text>
</g>
<!-- expert_0_L6_EP1TP3PP0DP0_GPU56 -->
<g id="node1914" class="node">
<title>expert_0_L6_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="393159.5,-78 393014.5,-78 393014.5,-26 393159.5,-26 393159.5,-78"/>
<text text-anchor="middle" x="393087" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="393087" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="393087" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="393087" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L6_EP1TP3PP0DP0_GPU56 -->
<g id="node1915" class="node">
<title>expert_1_L6_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="393340.5,-78 393195.5,-78 393195.5,-26 393340.5,-26 393340.5,-78"/>
<text text-anchor="middle" x="393268" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="393268" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="393268" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="393268" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L6_EP1TP3PP0DP0_GPU56 -->
<g id="node1916" class="node">
<title>expert_2_L6_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="393521.5,-78 393376.5,-78 393376.5,-26 393521.5,-26 393521.5,-78"/>
<text text-anchor="middle" x="393449" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="393449" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="393449" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="393449" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L6_EP1TP3PP0DP0_GPU56 -->
<g id="node1917" class="node">
<title>expert_3_L6_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="393702.5,-78 393557.5,-78 393557.5,-26 393702.5,-26 393702.5,-78"/>
<text text-anchor="middle" x="393630" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="393630" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="393630" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="393630" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L6_EP1TP3PP0DP0_GPU56 -->
<g id="node1918" class="node">
<title>combine_L6_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="393841" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="393841" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="393841" y="-44" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP0_GPU56</text>
</g>
<!-- ffn_L6_EP1TP3PP0DP0_GPU56 -->
<g id="node1919" class="node">
<title>ffn_L6_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="394150,-78 393980,-78 393980,-26 394150,-26 394150,-78"/>
<text text-anchor="middle" x="394065" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="394065" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="394065" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="394065" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L6_EP1TP3PP0DP0_GPU56 -->
<g id="node1920" class="node">
<title>ffn_ar_L6_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="394289" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="394289" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="394289" y="-49.5" font-family="Arial" font-size="10.00">L6 EP1 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="394289" y="-38.5" font-family="Arial" font-size="10.00">GPU56</text>
</g>
<!-- residual2_L6_EP1TP3PP0DP0_GPU56 -->
<g id="node1921" class="node">
<title>residual2_L6_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="394574,-78 394428,-78 394428,-26 394574,-26 394574,-78"/>
<text text-anchor="middle" x="394501" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="394501" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="394501" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="394501" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L6_EP1TP3PP0DP1_GPU57 -->
<g id="node1922" class="node">
<title>ln1_L6_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="394755.5,-78 394610.5,-78 394610.5,-26 394755.5,-26 394755.5,-78"/>
<text text-anchor="middle" x="394683" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="394683" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="394683" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="394683" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L6_EP1TP3PP0DP1_GPU57 -->
<g id="node1923" class="node">
<title>qkv_L6_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="394936.5,-78 394791.5,-78 394791.5,-26 394936.5,-26 394936.5,-78"/>
<text text-anchor="middle" x="394864" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="394864" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="394864" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="394864" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L6_EP1TP3PP0DP1_GPU57 -->
<g id="node1924" class="node">
<title>attn_L6_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="395123.5,-78 394972.5,-78 394972.5,-26 395123.5,-26 395123.5,-78"/>
<text text-anchor="middle" x="395048" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="395048" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="395048" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="395048" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L6_EP1TP3PP0DP1_GPU57 -->
<g id="node1925" class="node">
<title>attn_out_L6_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="395304.5,-78 395159.5,-78 395159.5,-26 395304.5,-26 395304.5,-78"/>
<text text-anchor="middle" x="395232" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="395232" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="395232" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="395232" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L6_EP1TP3PP0DP1_GPU57 -->
<g id="node1926" class="node">
<title>attn_ar_L6_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="395444" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="395444" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="395444" y="-49.5" font-family="Arial" font-size="10.00">L6 EP1 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="395444" y="-38.5" font-family="Arial" font-size="10.00">GPU57</text>
</g>
<!-- residual1_L6_EP1TP3PP0DP1_GPU57 -->
<g id="node1927" class="node">
<title>residual1_L6_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="395729,-78 395583,-78 395583,-26 395729,-26 395729,-78"/>
<text text-anchor="middle" x="395656" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="395656" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="395656" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="395656" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L6_EP1TP3PP0DP1_GPU57 -->
<g id="node1928" class="node">
<title>ln2_L6_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="395910.5,-78 395765.5,-78 395765.5,-26 395910.5,-26 395910.5,-78"/>
<text text-anchor="middle" x="395838" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="395838" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="395838" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="395838" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L6_EP1TP3PP0DP1_GPU57 -->
<g id="node1929" class="node">
<title>gate_L6_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightyellow" stroke="black" points="396247.16,-104 396008.29,-104 395946.84,0 396185.71,0 396247.16,-104"/>
<text text-anchor="middle" x="396097" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="396097" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="396097" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="396097" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L6_EP1TP3PP0DP1_GPU57 -->
<g id="node1930" class="node">
<title>dispatch_L6_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="396386" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="396386" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="396386" y="-44" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP1_GPU57</text>
</g>
<!-- expert_0_L6_EP1TP3PP0DP1_GPU57 -->
<g id="node1931" class="node">
<title>expert_0_L6_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="396669.5,-78 396524.5,-78 396524.5,-26 396669.5,-26 396669.5,-78"/>
<text text-anchor="middle" x="396597" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="396597" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="396597" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="396597" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L6_EP1TP3PP0DP1_GPU57 -->
<g id="node1932" class="node">
<title>expert_1_L6_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="396850.5,-78 396705.5,-78 396705.5,-26 396850.5,-26 396850.5,-78"/>
<text text-anchor="middle" x="396778" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="396778" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="396778" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="396778" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L6_EP1TP3PP0DP1_GPU57 -->
<g id="node1933" class="node">
<title>expert_2_L6_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="397031.5,-78 396886.5,-78 396886.5,-26 397031.5,-26 397031.5,-78"/>
<text text-anchor="middle" x="396959" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="396959" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="396959" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="396959" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L6_EP1TP3PP0DP1_GPU57 -->
<g id="node1934" class="node">
<title>expert_3_L6_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="397212.5,-78 397067.5,-78 397067.5,-26 397212.5,-26 397212.5,-78"/>
<text text-anchor="middle" x="397140" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="397140" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="397140" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="397140" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L6_EP1TP3PP0DP1_GPU57 -->
<g id="node1935" class="node">
<title>combine_L6_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="397351" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="397351" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="397351" y="-44" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP1_GPU57</text>
</g>
<!-- ffn_L6_EP1TP3PP0DP1_GPU57 -->
<g id="node1936" class="node">
<title>ffn_L6_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="397660,-78 397490,-78 397490,-26 397660,-26 397660,-78"/>
<text text-anchor="middle" x="397575" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="397575" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="397575" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="397575" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L6_EP1TP3PP0DP1_GPU57 -->
<g id="node1937" class="node">
<title>ffn_ar_L6_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="397799" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="397799" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="397799" y="-49.5" font-family="Arial" font-size="10.00">L6 EP1 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="397799" y="-38.5" font-family="Arial" font-size="10.00">GPU57</text>
</g>
<!-- residual2_L6_EP1TP3PP0DP1_GPU57 -->
<g id="node1938" class="node">
<title>residual2_L6_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="398084,-78 397938,-78 397938,-26 398084,-26 398084,-78"/>
<text text-anchor="middle" x="398011" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="398011" y="-55" font-family="Arial" font-size="10.00">L6_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="398011" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="398011" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L7_EP0TP0PP0DP0_GPU0 -->
<g id="node1939" class="node">
<title>ln1_L7_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="398262,-78 398120,-78 398120,-26 398262,-26 398262,-78"/>
<text text-anchor="middle" x="398191" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="398191" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="398191" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="398191" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L7_EP0TP0PP0DP0_GPU0 -->
<g id="node1940" class="node">
<title>qkv_L7_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="398440,-78 398298,-78 398298,-26 398440,-26 398440,-78"/>
<text text-anchor="middle" x="398369" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="398369" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="398369" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="398369" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L7_EP0TP0PP0DP0_GPU0 -->
<g id="node1941" class="node">
<title>attn_L7_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="398627.5,-78 398476.5,-78 398476.5,-26 398627.5,-26 398627.5,-78"/>
<text text-anchor="middle" x="398552" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="398552" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="398552" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="398552" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L7_EP0TP0PP0DP0_GPU0 -->
<g id="node1942" class="node">
<title>attn_out_L7_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="398806,-78 398664,-78 398664,-26 398806,-26 398806,-78"/>
<text text-anchor="middle" x="398735" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="398735" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="398735" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="398735" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L7_EP0TP0PP0DP0_GPU0 -->
<g id="node1943" class="node">
<title>attn_ar_L7_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="398945" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="398945" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="398945" y="-49.5" font-family="Arial" font-size="10.00">L7 EP0 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="398945" y="-38.5" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- residual1_L7_EP0TP0PP0DP0_GPU0 -->
<g id="node1944" class="node">
<title>residual1_L7_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="399230,-78 399084,-78 399084,-26 399230,-26 399230,-78"/>
<text text-anchor="middle" x="399157" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="399157" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="399157" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="399157" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L7_EP0TP0PP0DP0_GPU0 -->
<g id="node1945" class="node">
<title>ln2_L7_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="399408,-78 399266,-78 399266,-26 399408,-26 399408,-78"/>
<text text-anchor="middle" x="399337" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="399337" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="399337" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="399337" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L7_EP0TP0PP0DP0_GPU0 -->
<g id="node1946" class="node">
<title>gate_L7_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightyellow" stroke="black" points="399734.29,-104 399503.17,-104 399443.71,0 399674.83,0 399734.29,-104"/>
<text text-anchor="middle" x="399589" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="399589" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="399589" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="399589" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L7_EP0TP0PP0DP0_GPU0 -->
<g id="node1947" class="node">
<title>dispatch_L7_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="399869" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="399869" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="399869" y="-44" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP0_GPU0</text>
</g>
<!-- expert_0_L7_EP0TP0PP0DP0_GPU0 -->
<g id="node1948" class="node">
<title>expert_0_L7_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="400144,-78 400004,-78 400004,-26 400144,-26 400144,-78"/>
<text text-anchor="middle" x="400074" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="400074" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="400074" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="400074" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L7_EP0TP0PP0DP0_GPU0 -->
<g id="node1949" class="node">
<title>expert_1_L7_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="400320,-78 400180,-78 400180,-26 400320,-26 400320,-78"/>
<text text-anchor="middle" x="400250" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="400250" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="400250" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="400250" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L7_EP0TP0PP0DP0_GPU0 -->
<g id="node1950" class="node">
<title>expert_2_L7_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="400496,-78 400356,-78 400356,-26 400496,-26 400496,-78"/>
<text text-anchor="middle" x="400426" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="400426" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="400426" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="400426" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L7_EP0TP0PP0DP0_GPU0 -->
<g id="node1951" class="node">
<title>expert_3_L7_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="400672,-78 400532,-78 400532,-26 400672,-26 400672,-78"/>
<text text-anchor="middle" x="400602" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="400602" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="400602" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="400602" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L7_EP0TP0PP0DP0_GPU0 -->
<g id="node1952" class="node">
<title>combine_L7_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="400807" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="400807" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="400807" y="-44" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP0_GPU0</text>
</g>
<!-- ffn_L7_EP0TP0PP0DP0_GPU0 -->
<g id="node1953" class="node">
<title>ffn_L7_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="401112,-78 400942,-78 400942,-26 401112,-26 401112,-78"/>
<text text-anchor="middle" x="401027" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="401027" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="401027" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="401027" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L7_EP0TP0PP0DP0_GPU0 -->
<g id="node1954" class="node">
<title>ffn_ar_L7_EP0TP0PP0DP0_GPU0</title>
<ellipse fill="lightblue" stroke="black" cx="401251" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="401251" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="401251" y="-49.5" font-family="Arial" font-size="10.00">L7 EP0 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="401251" y="-38.5" font-family="Arial" font-size="10.00">GPU0</text>
</g>
<!-- residual2_L7_EP0TP0PP0DP0_GPU0 -->
<g id="node1955" class="node">
<title>residual2_L7_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="401536,-78 401390,-78 401390,-26 401536,-26 401536,-78"/>
<text text-anchor="middle" x="401463" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="401463" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="401463" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="401463" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L7_EP0TP0PP0DP1_GPU1 -->
<g id="node1956" class="node">
<title>ln1_L7_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="401714,-78 401572,-78 401572,-26 401714,-26 401714,-78"/>
<text text-anchor="middle" x="401643" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="401643" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="401643" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="401643" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L7_EP0TP0PP0DP1_GPU1 -->
<g id="node1957" class="node">
<title>qkv_L7_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="401892,-78 401750,-78 401750,-26 401892,-26 401892,-78"/>
<text text-anchor="middle" x="401821" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="401821" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="401821" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="401821" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L7_EP0TP0PP0DP1_GPU1 -->
<g id="node1958" class="node">
<title>attn_L7_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="402079.5,-78 401928.5,-78 401928.5,-26 402079.5,-26 402079.5,-78"/>
<text text-anchor="middle" x="402004" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="402004" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="402004" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="402004" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L7_EP0TP0PP0DP1_GPU1 -->
<g id="node1959" class="node">
<title>attn_out_L7_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="402258,-78 402116,-78 402116,-26 402258,-26 402258,-78"/>
<text text-anchor="middle" x="402187" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="402187" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="402187" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="402187" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L7_EP0TP0PP0DP1_GPU1 -->
<g id="node1960" class="node">
<title>attn_ar_L7_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="402397" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="402397" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="402397" y="-49.5" font-family="Arial" font-size="10.00">L7 EP0 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="402397" y="-38.5" font-family="Arial" font-size="10.00">GPU1</text>
</g>
<!-- residual1_L7_EP0TP0PP0DP1_GPU1 -->
<g id="node1961" class="node">
<title>residual1_L7_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="402682,-78 402536,-78 402536,-26 402682,-26 402682,-78"/>
<text text-anchor="middle" x="402609" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="402609" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="402609" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="402609" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L7_EP0TP0PP0DP1_GPU1 -->
<g id="node1962" class="node">
<title>ln2_L7_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="402860,-78 402718,-78 402718,-26 402860,-26 402860,-78"/>
<text text-anchor="middle" x="402789" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="402789" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="402789" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="402789" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L7_EP0TP0PP0DP1_GPU1 -->
<g id="node1963" class="node">
<title>gate_L7_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightyellow" stroke="black" points="403186.29,-104 402955.17,-104 402895.71,0 403126.83,0 403186.29,-104"/>
<text text-anchor="middle" x="403041" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="403041" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="403041" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="403041" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L7_EP0TP0PP0DP1_GPU1 -->
<g id="node1964" class="node">
<title>dispatch_L7_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="403321" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="403321" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="403321" y="-44" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP1_GPU1</text>
</g>
<!-- expert_0_L7_EP0TP0PP0DP1_GPU1 -->
<g id="node1965" class="node">
<title>expert_0_L7_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="403596,-78 403456,-78 403456,-26 403596,-26 403596,-78"/>
<text text-anchor="middle" x="403526" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="403526" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="403526" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="403526" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L7_EP0TP0PP0DP1_GPU1 -->
<g id="node1966" class="node">
<title>expert_1_L7_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="403772,-78 403632,-78 403632,-26 403772,-26 403772,-78"/>
<text text-anchor="middle" x="403702" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="403702" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="403702" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="403702" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L7_EP0TP0PP0DP1_GPU1 -->
<g id="node1967" class="node">
<title>expert_2_L7_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="403948,-78 403808,-78 403808,-26 403948,-26 403948,-78"/>
<text text-anchor="middle" x="403878" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="403878" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="403878" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="403878" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L7_EP0TP0PP0DP1_GPU1 -->
<g id="node1968" class="node">
<title>expert_3_L7_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="404124,-78 403984,-78 403984,-26 404124,-26 404124,-78"/>
<text text-anchor="middle" x="404054" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="404054" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="404054" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="404054" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L7_EP0TP0PP0DP1_GPU1 -->
<g id="node1969" class="node">
<title>combine_L7_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="404259" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="404259" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="404259" y="-44" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP1_GPU1</text>
</g>
<!-- ffn_L7_EP0TP0PP0DP1_GPU1 -->
<g id="node1970" class="node">
<title>ffn_L7_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="404564,-78 404394,-78 404394,-26 404564,-26 404564,-78"/>
<text text-anchor="middle" x="404479" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="404479" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="404479" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="404479" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L7_EP0TP0PP0DP1_GPU1 -->
<g id="node1971" class="node">
<title>ffn_ar_L7_EP0TP0PP0DP1_GPU1</title>
<ellipse fill="lightblue" stroke="black" cx="404703" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="404703" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="404703" y="-49.5" font-family="Arial" font-size="10.00">L7 EP0 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="404703" y="-38.5" font-family="Arial" font-size="10.00">GPU1</text>
</g>
<!-- residual2_L7_EP0TP0PP0DP1_GPU1 -->
<g id="node1972" class="node">
<title>residual2_L7_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="404988,-78 404842,-78 404842,-26 404988,-26 404988,-78"/>
<text text-anchor="middle" x="404915" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="404915" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="404915" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="404915" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L7_EP0TP1PP0DP0_GPU8 -->
<g id="node1973" class="node">
<title>ln1_L7_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="405166,-78 405024,-78 405024,-26 405166,-26 405166,-78"/>
<text text-anchor="middle" x="405095" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="405095" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="405095" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="405095" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L7_EP0TP1PP0DP0_GPU8 -->
<g id="node1974" class="node">
<title>qkv_L7_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="405344,-78 405202,-78 405202,-26 405344,-26 405344,-78"/>
<text text-anchor="middle" x="405273" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="405273" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="405273" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="405273" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L7_EP0TP1PP0DP0_GPU8 -->
<g id="node1975" class="node">
<title>attn_L7_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="405531.5,-78 405380.5,-78 405380.5,-26 405531.5,-26 405531.5,-78"/>
<text text-anchor="middle" x="405456" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="405456" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="405456" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="405456" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L7_EP0TP1PP0DP0_GPU8 -->
<g id="node1976" class="node">
<title>attn_out_L7_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="405710,-78 405568,-78 405568,-26 405710,-26 405710,-78"/>
<text text-anchor="middle" x="405639" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="405639" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="405639" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="405639" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L7_EP0TP1PP0DP0_GPU8 -->
<g id="node1977" class="node">
<title>attn_ar_L7_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="405849" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="405849" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="405849" y="-49.5" font-family="Arial" font-size="10.00">L7 EP0 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="405849" y="-38.5" font-family="Arial" font-size="10.00">GPU8</text>
</g>
<!-- residual1_L7_EP0TP1PP0DP0_GPU8 -->
<g id="node1978" class="node">
<title>residual1_L7_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="406134,-78 405988,-78 405988,-26 406134,-26 406134,-78"/>
<text text-anchor="middle" x="406061" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="406061" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="406061" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="406061" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L7_EP0TP1PP0DP0_GPU8 -->
<g id="node1979" class="node">
<title>ln2_L7_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="406312,-78 406170,-78 406170,-26 406312,-26 406312,-78"/>
<text text-anchor="middle" x="406241" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="406241" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="406241" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="406241" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L7_EP0TP1PP0DP0_GPU8 -->
<g id="node1980" class="node">
<title>gate_L7_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightyellow" stroke="black" points="406638.29,-104 406407.17,-104 406347.71,0 406578.83,0 406638.29,-104"/>
<text text-anchor="middle" x="406493" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="406493" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="406493" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="406493" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L7_EP0TP1PP0DP0_GPU8 -->
<g id="node1981" class="node">
<title>dispatch_L7_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="406773" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="406773" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="406773" y="-44" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP0_GPU8</text>
</g>
<!-- expert_0_L7_EP0TP1PP0DP0_GPU8 -->
<g id="node1982" class="node">
<title>expert_0_L7_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="407048,-78 406908,-78 406908,-26 407048,-26 407048,-78"/>
<text text-anchor="middle" x="406978" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="406978" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="406978" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="406978" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L7_EP0TP1PP0DP0_GPU8 -->
<g id="node1983" class="node">
<title>expert_1_L7_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="407224,-78 407084,-78 407084,-26 407224,-26 407224,-78"/>
<text text-anchor="middle" x="407154" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="407154" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="407154" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="407154" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L7_EP0TP1PP0DP0_GPU8 -->
<g id="node1984" class="node">
<title>expert_2_L7_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="407400,-78 407260,-78 407260,-26 407400,-26 407400,-78"/>
<text text-anchor="middle" x="407330" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="407330" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="407330" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="407330" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L7_EP0TP1PP0DP0_GPU8 -->
<g id="node1985" class="node">
<title>expert_3_L7_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="407576,-78 407436,-78 407436,-26 407576,-26 407576,-78"/>
<text text-anchor="middle" x="407506" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="407506" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="407506" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="407506" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L7_EP0TP1PP0DP0_GPU8 -->
<g id="node1986" class="node">
<title>combine_L7_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="407711" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="407711" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="407711" y="-44" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP0_GPU8</text>
</g>
<!-- ffn_L7_EP0TP1PP0DP0_GPU8 -->
<g id="node1987" class="node">
<title>ffn_L7_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="408016,-78 407846,-78 407846,-26 408016,-26 408016,-78"/>
<text text-anchor="middle" x="407931" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="407931" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="407931" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="407931" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L7_EP0TP1PP0DP0_GPU8 -->
<g id="node1988" class="node">
<title>ffn_ar_L7_EP0TP1PP0DP0_GPU8</title>
<ellipse fill="lightblue" stroke="black" cx="408155" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="408155" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="408155" y="-49.5" font-family="Arial" font-size="10.00">L7 EP0 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="408155" y="-38.5" font-family="Arial" font-size="10.00">GPU8</text>
</g>
<!-- residual2_L7_EP0TP1PP0DP0_GPU8 -->
<g id="node1989" class="node">
<title>residual2_L7_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="408440,-78 408294,-78 408294,-26 408440,-26 408440,-78"/>
<text text-anchor="middle" x="408367" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="408367" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="408367" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="408367" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L7_EP0TP1PP0DP1_GPU9 -->
<g id="node1990" class="node">
<title>ln1_L7_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="408618,-78 408476,-78 408476,-26 408618,-26 408618,-78"/>
<text text-anchor="middle" x="408547" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="408547" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="408547" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="408547" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L7_EP0TP1PP0DP1_GPU9 -->
<g id="node1991" class="node">
<title>qkv_L7_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="408796,-78 408654,-78 408654,-26 408796,-26 408796,-78"/>
<text text-anchor="middle" x="408725" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="408725" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="408725" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="408725" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L7_EP0TP1PP0DP1_GPU9 -->
<g id="node1992" class="node">
<title>attn_L7_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="408983.5,-78 408832.5,-78 408832.5,-26 408983.5,-26 408983.5,-78"/>
<text text-anchor="middle" x="408908" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="408908" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="408908" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="408908" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L7_EP0TP1PP0DP1_GPU9 -->
<g id="node1993" class="node">
<title>attn_out_L7_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="409162,-78 409020,-78 409020,-26 409162,-26 409162,-78"/>
<text text-anchor="middle" x="409091" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="409091" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="409091" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="409091" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L7_EP0TP1PP0DP1_GPU9 -->
<g id="node1994" class="node">
<title>attn_ar_L7_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="409301" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="409301" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="409301" y="-49.5" font-family="Arial" font-size="10.00">L7 EP0 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="409301" y="-38.5" font-family="Arial" font-size="10.00">GPU9</text>
</g>
<!-- residual1_L7_EP0TP1PP0DP1_GPU9 -->
<g id="node1995" class="node">
<title>residual1_L7_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="409586,-78 409440,-78 409440,-26 409586,-26 409586,-78"/>
<text text-anchor="middle" x="409513" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="409513" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="409513" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="409513" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L7_EP0TP1PP0DP1_GPU9 -->
<g id="node1996" class="node">
<title>ln2_L7_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="409764,-78 409622,-78 409622,-26 409764,-26 409764,-78"/>
<text text-anchor="middle" x="409693" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="409693" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="409693" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="409693" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L7_EP0TP1PP0DP1_GPU9 -->
<g id="node1997" class="node">
<title>gate_L7_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightyellow" stroke="black" points="410090.29,-104 409859.17,-104 409799.71,0 410030.83,0 410090.29,-104"/>
<text text-anchor="middle" x="409945" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="409945" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="409945" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="409945" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L7_EP0TP1PP0DP1_GPU9 -->
<g id="node1998" class="node">
<title>dispatch_L7_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="410225" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="410225" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="410225" y="-44" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP1_GPU9</text>
</g>
<!-- expert_0_L7_EP0TP1PP0DP1_GPU9 -->
<g id="node1999" class="node">
<title>expert_0_L7_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="410500,-78 410360,-78 410360,-26 410500,-26 410500,-78"/>
<text text-anchor="middle" x="410430" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="410430" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="410430" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="410430" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L7_EP0TP1PP0DP1_GPU9 -->
<g id="node2000" class="node">
<title>expert_1_L7_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="410676,-78 410536,-78 410536,-26 410676,-26 410676,-78"/>
<text text-anchor="middle" x="410606" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="410606" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="410606" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="410606" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L7_EP0TP1PP0DP1_GPU9 -->
<g id="node2001" class="node">
<title>expert_2_L7_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="410852,-78 410712,-78 410712,-26 410852,-26 410852,-78"/>
<text text-anchor="middle" x="410782" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="410782" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="410782" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="410782" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L7_EP0TP1PP0DP1_GPU9 -->
<g id="node2002" class="node">
<title>expert_3_L7_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="411028,-78 410888,-78 410888,-26 411028,-26 411028,-78"/>
<text text-anchor="middle" x="410958" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="410958" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="410958" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="410958" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L7_EP0TP1PP0DP1_GPU9 -->
<g id="node2003" class="node">
<title>combine_L7_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="411163" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="411163" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="411163" y="-44" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP1_GPU9</text>
</g>
<!-- ffn_L7_EP0TP1PP0DP1_GPU9 -->
<g id="node2004" class="node">
<title>ffn_L7_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="411468,-78 411298,-78 411298,-26 411468,-26 411468,-78"/>
<text text-anchor="middle" x="411383" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="411383" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="411383" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="411383" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L7_EP0TP1PP0DP1_GPU9 -->
<g id="node2005" class="node">
<title>ffn_ar_L7_EP0TP1PP0DP1_GPU9</title>
<ellipse fill="lightblue" stroke="black" cx="411607" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="411607" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="411607" y="-49.5" font-family="Arial" font-size="10.00">L7 EP0 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="411607" y="-38.5" font-family="Arial" font-size="10.00">GPU9</text>
</g>
<!-- residual2_L7_EP0TP1PP0DP1_GPU9 -->
<g id="node2006" class="node">
<title>residual2_L7_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="411892,-78 411746,-78 411746,-26 411892,-26 411892,-78"/>
<text text-anchor="middle" x="411819" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="411819" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="411819" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="411819" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L7_EP0TP2PP0DP0_GPU16 -->
<g id="node2007" class="node">
<title>ln1_L7_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="412073.5,-78 411928.5,-78 411928.5,-26 412073.5,-26 412073.5,-78"/>
<text text-anchor="middle" x="412001" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="412001" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="412001" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="412001" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L7_EP0TP2PP0DP0_GPU16 -->
<g id="node2008" class="node">
<title>qkv_L7_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="412254.5,-78 412109.5,-78 412109.5,-26 412254.5,-26 412254.5,-78"/>
<text text-anchor="middle" x="412182" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="412182" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="412182" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="412182" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L7_EP0TP2PP0DP0_GPU16 -->
<g id="node2009" class="node">
<title>attn_L7_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="412441.5,-78 412290.5,-78 412290.5,-26 412441.5,-26 412441.5,-78"/>
<text text-anchor="middle" x="412366" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="412366" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="412366" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="412366" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L7_EP0TP2PP0DP0_GPU16 -->
<g id="node2010" class="node">
<title>attn_out_L7_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="412622.5,-78 412477.5,-78 412477.5,-26 412622.5,-26 412622.5,-78"/>
<text text-anchor="middle" x="412550" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="412550" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="412550" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="412550" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L7_EP0TP2PP0DP0_GPU16 -->
<g id="node2011" class="node">
<title>attn_ar_L7_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="412762" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="412762" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="412762" y="-49.5" font-family="Arial" font-size="10.00">L7 EP0 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="412762" y="-38.5" font-family="Arial" font-size="10.00">GPU16</text>
</g>
<!-- residual1_L7_EP0TP2PP0DP0_GPU16 -->
<g id="node2012" class="node">
<title>residual1_L7_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="413047,-78 412901,-78 412901,-26 413047,-26 413047,-78"/>
<text text-anchor="middle" x="412974" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="412974" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="412974" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="412974" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L7_EP0TP2PP0DP0_GPU16 -->
<g id="node2013" class="node">
<title>ln2_L7_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="413228.5,-78 413083.5,-78 413083.5,-26 413228.5,-26 413228.5,-78"/>
<text text-anchor="middle" x="413156" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="413156" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="413156" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="413156" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L7_EP0TP2PP0DP0_GPU16 -->
<g id="node2014" class="node">
<title>gate_L7_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightyellow" stroke="black" points="413565.16,-104 413326.29,-104 413264.84,0 413503.71,0 413565.16,-104"/>
<text text-anchor="middle" x="413415" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="413415" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="413415" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="413415" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L7_EP0TP2PP0DP0_GPU16 -->
<g id="node2015" class="node">
<title>dispatch_L7_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="413704" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="413704" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="413704" y="-44" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP0_GPU16</text>
</g>
<!-- expert_0_L7_EP0TP2PP0DP0_GPU16 -->
<g id="node2016" class="node">
<title>expert_0_L7_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="413987.5,-78 413842.5,-78 413842.5,-26 413987.5,-26 413987.5,-78"/>
<text text-anchor="middle" x="413915" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="413915" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="413915" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="413915" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L7_EP0TP2PP0DP0_GPU16 -->
<g id="node2017" class="node">
<title>expert_1_L7_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="414168.5,-78 414023.5,-78 414023.5,-26 414168.5,-26 414168.5,-78"/>
<text text-anchor="middle" x="414096" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="414096" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="414096" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="414096" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L7_EP0TP2PP0DP0_GPU16 -->
<g id="node2018" class="node">
<title>expert_2_L7_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="414349.5,-78 414204.5,-78 414204.5,-26 414349.5,-26 414349.5,-78"/>
<text text-anchor="middle" x="414277" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="414277" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="414277" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="414277" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L7_EP0TP2PP0DP0_GPU16 -->
<g id="node2019" class="node">
<title>expert_3_L7_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="414530.5,-78 414385.5,-78 414385.5,-26 414530.5,-26 414530.5,-78"/>
<text text-anchor="middle" x="414458" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="414458" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="414458" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="414458" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L7_EP0TP2PP0DP0_GPU16 -->
<g id="node2020" class="node">
<title>combine_L7_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="414669" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="414669" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="414669" y="-44" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP0_GPU16</text>
</g>
<!-- ffn_L7_EP0TP2PP0DP0_GPU16 -->
<g id="node2021" class="node">
<title>ffn_L7_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="414978,-78 414808,-78 414808,-26 414978,-26 414978,-78"/>
<text text-anchor="middle" x="414893" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="414893" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="414893" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="414893" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L7_EP0TP2PP0DP0_GPU16 -->
<g id="node2022" class="node">
<title>ffn_ar_L7_EP0TP2PP0DP0_GPU16</title>
<ellipse fill="lightblue" stroke="black" cx="415117" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="415117" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="415117" y="-49.5" font-family="Arial" font-size="10.00">L7 EP0 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="415117" y="-38.5" font-family="Arial" font-size="10.00">GPU16</text>
</g>
<!-- residual2_L7_EP0TP2PP0DP0_GPU16 -->
<g id="node2023" class="node">
<title>residual2_L7_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="415402,-78 415256,-78 415256,-26 415402,-26 415402,-78"/>
<text text-anchor="middle" x="415329" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="415329" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="415329" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="415329" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L7_EP0TP2PP0DP1_GPU17 -->
<g id="node2024" class="node">
<title>ln1_L7_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="415583.5,-78 415438.5,-78 415438.5,-26 415583.5,-26 415583.5,-78"/>
<text text-anchor="middle" x="415511" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="415511" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="415511" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="415511" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L7_EP0TP2PP0DP1_GPU17 -->
<g id="node2025" class="node">
<title>qkv_L7_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="415764.5,-78 415619.5,-78 415619.5,-26 415764.5,-26 415764.5,-78"/>
<text text-anchor="middle" x="415692" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="415692" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="415692" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="415692" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L7_EP0TP2PP0DP1_GPU17 -->
<g id="node2026" class="node">
<title>attn_L7_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="415951.5,-78 415800.5,-78 415800.5,-26 415951.5,-26 415951.5,-78"/>
<text text-anchor="middle" x="415876" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="415876" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="415876" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="415876" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L7_EP0TP2PP0DP1_GPU17 -->
<g id="node2027" class="node">
<title>attn_out_L7_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="416132.5,-78 415987.5,-78 415987.5,-26 416132.5,-26 416132.5,-78"/>
<text text-anchor="middle" x="416060" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="416060" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="416060" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="416060" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L7_EP0TP2PP0DP1_GPU17 -->
<g id="node2028" class="node">
<title>attn_ar_L7_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="416272" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="416272" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="416272" y="-49.5" font-family="Arial" font-size="10.00">L7 EP0 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="416272" y="-38.5" font-family="Arial" font-size="10.00">GPU17</text>
</g>
<!-- residual1_L7_EP0TP2PP0DP1_GPU17 -->
<g id="node2029" class="node">
<title>residual1_L7_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="416557,-78 416411,-78 416411,-26 416557,-26 416557,-78"/>
<text text-anchor="middle" x="416484" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="416484" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="416484" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="416484" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L7_EP0TP2PP0DP1_GPU17 -->
<g id="node2030" class="node">
<title>ln2_L7_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="416738.5,-78 416593.5,-78 416593.5,-26 416738.5,-26 416738.5,-78"/>
<text text-anchor="middle" x="416666" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="416666" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="416666" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="416666" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L7_EP0TP2PP0DP1_GPU17 -->
<g id="node2031" class="node">
<title>gate_L7_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightyellow" stroke="black" points="417075.16,-104 416836.29,-104 416774.84,0 417013.71,0 417075.16,-104"/>
<text text-anchor="middle" x="416925" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="416925" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="416925" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="416925" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L7_EP0TP2PP0DP1_GPU17 -->
<g id="node2032" class="node">
<title>dispatch_L7_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="417214" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="417214" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="417214" y="-44" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP1_GPU17</text>
</g>
<!-- expert_0_L7_EP0TP2PP0DP1_GPU17 -->
<g id="node2033" class="node">
<title>expert_0_L7_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="417497.5,-78 417352.5,-78 417352.5,-26 417497.5,-26 417497.5,-78"/>
<text text-anchor="middle" x="417425" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="417425" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="417425" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="417425" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L7_EP0TP2PP0DP1_GPU17 -->
<g id="node2034" class="node">
<title>expert_1_L7_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="417678.5,-78 417533.5,-78 417533.5,-26 417678.5,-26 417678.5,-78"/>
<text text-anchor="middle" x="417606" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="417606" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="417606" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="417606" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L7_EP0TP2PP0DP1_GPU17 -->
<g id="node2035" class="node">
<title>expert_2_L7_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="417859.5,-78 417714.5,-78 417714.5,-26 417859.5,-26 417859.5,-78"/>
<text text-anchor="middle" x="417787" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="417787" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="417787" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="417787" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L7_EP0TP2PP0DP1_GPU17 -->
<g id="node2036" class="node">
<title>expert_3_L7_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="418040.5,-78 417895.5,-78 417895.5,-26 418040.5,-26 418040.5,-78"/>
<text text-anchor="middle" x="417968" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="417968" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="417968" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="417968" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L7_EP0TP2PP0DP1_GPU17 -->
<g id="node2037" class="node">
<title>combine_L7_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="418179" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="418179" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="418179" y="-44" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP1_GPU17</text>
</g>
<!-- ffn_L7_EP0TP2PP0DP1_GPU17 -->
<g id="node2038" class="node">
<title>ffn_L7_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="418488,-78 418318,-78 418318,-26 418488,-26 418488,-78"/>
<text text-anchor="middle" x="418403" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="418403" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="418403" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="418403" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L7_EP0TP2PP0DP1_GPU17 -->
<g id="node2039" class="node">
<title>ffn_ar_L7_EP0TP2PP0DP1_GPU17</title>
<ellipse fill="lightblue" stroke="black" cx="418627" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="418627" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="418627" y="-49.5" font-family="Arial" font-size="10.00">L7 EP0 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="418627" y="-38.5" font-family="Arial" font-size="10.00">GPU17</text>
</g>
<!-- residual2_L7_EP0TP2PP0DP1_GPU17 -->
<g id="node2040" class="node">
<title>residual2_L7_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="418912,-78 418766,-78 418766,-26 418912,-26 418912,-78"/>
<text text-anchor="middle" x="418839" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="418839" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="418839" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="418839" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L7_EP0TP3PP0DP0_GPU24 -->
<g id="node2041" class="node">
<title>ln1_L7_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="419093.5,-78 418948.5,-78 418948.5,-26 419093.5,-26 419093.5,-78"/>
<text text-anchor="middle" x="419021" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="419021" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="419021" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="419021" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L7_EP0TP3PP0DP0_GPU24 -->
<g id="node2042" class="node">
<title>qkv_L7_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="419274.5,-78 419129.5,-78 419129.5,-26 419274.5,-26 419274.5,-78"/>
<text text-anchor="middle" x="419202" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="419202" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="419202" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="419202" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L7_EP0TP3PP0DP0_GPU24 -->
<g id="node2043" class="node">
<title>attn_L7_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="419461.5,-78 419310.5,-78 419310.5,-26 419461.5,-26 419461.5,-78"/>
<text text-anchor="middle" x="419386" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="419386" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="419386" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="419386" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L7_EP0TP3PP0DP0_GPU24 -->
<g id="node2044" class="node">
<title>attn_out_L7_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="419642.5,-78 419497.5,-78 419497.5,-26 419642.5,-26 419642.5,-78"/>
<text text-anchor="middle" x="419570" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="419570" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="419570" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="419570" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L7_EP0TP3PP0DP0_GPU24 -->
<g id="node2045" class="node">
<title>attn_ar_L7_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="419782" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="419782" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="419782" y="-49.5" font-family="Arial" font-size="10.00">L7 EP0 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="419782" y="-38.5" font-family="Arial" font-size="10.00">GPU24</text>
</g>
<!-- residual1_L7_EP0TP3PP0DP0_GPU24 -->
<g id="node2046" class="node">
<title>residual1_L7_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="420067,-78 419921,-78 419921,-26 420067,-26 420067,-78"/>
<text text-anchor="middle" x="419994" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="419994" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="419994" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="419994" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L7_EP0TP3PP0DP0_GPU24 -->
<g id="node2047" class="node">
<title>ln2_L7_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="420248.5,-78 420103.5,-78 420103.5,-26 420248.5,-26 420248.5,-78"/>
<text text-anchor="middle" x="420176" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="420176" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="420176" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="420176" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L7_EP0TP3PP0DP0_GPU24 -->
<g id="node2048" class="node">
<title>gate_L7_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightyellow" stroke="black" points="420585.16,-104 420346.29,-104 420284.84,0 420523.71,0 420585.16,-104"/>
<text text-anchor="middle" x="420435" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="420435" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="420435" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="420435" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L7_EP0TP3PP0DP0_GPU24 -->
<g id="node2049" class="node">
<title>dispatch_L7_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="420724" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="420724" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="420724" y="-44" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP0_GPU24</text>
</g>
<!-- expert_0_L7_EP0TP3PP0DP0_GPU24 -->
<g id="node2050" class="node">
<title>expert_0_L7_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="421007.5,-78 420862.5,-78 420862.5,-26 421007.5,-26 421007.5,-78"/>
<text text-anchor="middle" x="420935" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="420935" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="420935" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="420935" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L7_EP0TP3PP0DP0_GPU24 -->
<g id="node2051" class="node">
<title>expert_1_L7_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="421188.5,-78 421043.5,-78 421043.5,-26 421188.5,-26 421188.5,-78"/>
<text text-anchor="middle" x="421116" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="421116" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="421116" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="421116" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L7_EP0TP3PP0DP0_GPU24 -->
<g id="node2052" class="node">
<title>expert_2_L7_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="421369.5,-78 421224.5,-78 421224.5,-26 421369.5,-26 421369.5,-78"/>
<text text-anchor="middle" x="421297" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="421297" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="421297" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="421297" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L7_EP0TP3PP0DP0_GPU24 -->
<g id="node2053" class="node">
<title>expert_3_L7_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="421550.5,-78 421405.5,-78 421405.5,-26 421550.5,-26 421550.5,-78"/>
<text text-anchor="middle" x="421478" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="421478" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="421478" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="421478" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L7_EP0TP3PP0DP0_GPU24 -->
<g id="node2054" class="node">
<title>combine_L7_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="421689" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="421689" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="421689" y="-44" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP0_GPU24</text>
</g>
<!-- ffn_L7_EP0TP3PP0DP0_GPU24 -->
<g id="node2055" class="node">
<title>ffn_L7_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="421998,-78 421828,-78 421828,-26 421998,-26 421998,-78"/>
<text text-anchor="middle" x="421913" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="421913" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="421913" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="421913" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L7_EP0TP3PP0DP0_GPU24 -->
<g id="node2056" class="node">
<title>ffn_ar_L7_EP0TP3PP0DP0_GPU24</title>
<ellipse fill="lightblue" stroke="black" cx="422137" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="422137" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="422137" y="-49.5" font-family="Arial" font-size="10.00">L7 EP0 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="422137" y="-38.5" font-family="Arial" font-size="10.00">GPU24</text>
</g>
<!-- residual2_L7_EP0TP3PP0DP0_GPU24 -->
<g id="node2057" class="node">
<title>residual2_L7_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="422422,-78 422276,-78 422276,-26 422422,-26 422422,-78"/>
<text text-anchor="middle" x="422349" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="422349" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="422349" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="422349" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L7_EP0TP3PP0DP1_GPU25 -->
<g id="node2058" class="node">
<title>ln1_L7_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="422603.5,-78 422458.5,-78 422458.5,-26 422603.5,-26 422603.5,-78"/>
<text text-anchor="middle" x="422531" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="422531" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="422531" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="422531" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L7_EP0TP3PP0DP1_GPU25 -->
<g id="node2059" class="node">
<title>qkv_L7_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="422784.5,-78 422639.5,-78 422639.5,-26 422784.5,-26 422784.5,-78"/>
<text text-anchor="middle" x="422712" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="422712" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="422712" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="422712" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L7_EP0TP3PP0DP1_GPU25 -->
<g id="node2060" class="node">
<title>attn_L7_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="422971.5,-78 422820.5,-78 422820.5,-26 422971.5,-26 422971.5,-78"/>
<text text-anchor="middle" x="422896" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="422896" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="422896" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="422896" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L7_EP0TP3PP0DP1_GPU25 -->
<g id="node2061" class="node">
<title>attn_out_L7_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="423152.5,-78 423007.5,-78 423007.5,-26 423152.5,-26 423152.5,-78"/>
<text text-anchor="middle" x="423080" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="423080" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="423080" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="423080" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L7_EP0TP3PP0DP1_GPU25 -->
<g id="node2062" class="node">
<title>attn_ar_L7_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="423292" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="423292" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="423292" y="-49.5" font-family="Arial" font-size="10.00">L7 EP0 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="423292" y="-38.5" font-family="Arial" font-size="10.00">GPU25</text>
</g>
<!-- residual1_L7_EP0TP3PP0DP1_GPU25 -->
<g id="node2063" class="node">
<title>residual1_L7_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="423577,-78 423431,-78 423431,-26 423577,-26 423577,-78"/>
<text text-anchor="middle" x="423504" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="423504" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="423504" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="423504" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L7_EP0TP3PP0DP1_GPU25 -->
<g id="node2064" class="node">
<title>ln2_L7_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="423758.5,-78 423613.5,-78 423613.5,-26 423758.5,-26 423758.5,-78"/>
<text text-anchor="middle" x="423686" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="423686" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="423686" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="423686" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L7_EP0TP3PP0DP1_GPU25 -->
<g id="node2065" class="node">
<title>gate_L7_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightyellow" stroke="black" points="424095.16,-104 423856.29,-104 423794.84,0 424033.71,0 424095.16,-104"/>
<text text-anchor="middle" x="423945" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="423945" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="423945" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="423945" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L7_EP0TP3PP0DP1_GPU25 -->
<g id="node2066" class="node">
<title>dispatch_L7_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="424234" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="424234" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="424234" y="-44" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP1_GPU25</text>
</g>
<!-- expert_0_L7_EP0TP3PP0DP1_GPU25 -->
<g id="node2067" class="node">
<title>expert_0_L7_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="424517.5,-78 424372.5,-78 424372.5,-26 424517.5,-26 424517.5,-78"/>
<text text-anchor="middle" x="424445" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="424445" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="424445" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="424445" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L7_EP0TP3PP0DP1_GPU25 -->
<g id="node2068" class="node">
<title>expert_1_L7_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="424698.5,-78 424553.5,-78 424553.5,-26 424698.5,-26 424698.5,-78"/>
<text text-anchor="middle" x="424626" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="424626" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="424626" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="424626" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L7_EP0TP3PP0DP1_GPU25 -->
<g id="node2069" class="node">
<title>expert_2_L7_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="424879.5,-78 424734.5,-78 424734.5,-26 424879.5,-26 424879.5,-78"/>
<text text-anchor="middle" x="424807" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="424807" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="424807" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="424807" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L7_EP0TP3PP0DP1_GPU25 -->
<g id="node2070" class="node">
<title>expert_3_L7_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="425060.5,-78 424915.5,-78 424915.5,-26 425060.5,-26 425060.5,-78"/>
<text text-anchor="middle" x="424988" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="424988" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="424988" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="424988" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L7_EP0TP3PP0DP1_GPU25 -->
<g id="node2071" class="node">
<title>combine_L7_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="425199" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="425199" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="425199" y="-44" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP1_GPU25</text>
</g>
<!-- ffn_L7_EP0TP3PP0DP1_GPU25 -->
<g id="node2072" class="node">
<title>ffn_L7_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="425508,-78 425338,-78 425338,-26 425508,-26 425508,-78"/>
<text text-anchor="middle" x="425423" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="425423" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="425423" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="425423" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L7_EP0TP3PP0DP1_GPU25 -->
<g id="node2073" class="node">
<title>ffn_ar_L7_EP0TP3PP0DP1_GPU25</title>
<ellipse fill="lightblue" stroke="black" cx="425647" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="425647" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="425647" y="-49.5" font-family="Arial" font-size="10.00">L7 EP0 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="425647" y="-38.5" font-family="Arial" font-size="10.00">GPU25</text>
</g>
<!-- residual2_L7_EP0TP3PP0DP1_GPU25 -->
<g id="node2074" class="node">
<title>residual2_L7_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="425932,-78 425786,-78 425786,-26 425932,-26 425932,-78"/>
<text text-anchor="middle" x="425859" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="425859" y="-55" font-family="Arial" font-size="10.00">L7_EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="425859" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="425859" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L7_EP1TP0PP0DP0_GPU32 -->
<g id="node2075" class="node">
<title>ln1_L7_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="426113.5,-78 425968.5,-78 425968.5,-26 426113.5,-26 426113.5,-78"/>
<text text-anchor="middle" x="426041" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="426041" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="426041" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="426041" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L7_EP1TP0PP0DP0_GPU32 -->
<g id="node2076" class="node">
<title>qkv_L7_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="426294.5,-78 426149.5,-78 426149.5,-26 426294.5,-26 426294.5,-78"/>
<text text-anchor="middle" x="426222" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="426222" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="426222" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="426222" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L7_EP1TP0PP0DP0_GPU32 -->
<g id="node2077" class="node">
<title>attn_L7_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="426481.5,-78 426330.5,-78 426330.5,-26 426481.5,-26 426481.5,-78"/>
<text text-anchor="middle" x="426406" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="426406" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="426406" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="426406" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L7_EP1TP0PP0DP0_GPU32 -->
<g id="node2078" class="node">
<title>attn_out_L7_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="426662.5,-78 426517.5,-78 426517.5,-26 426662.5,-26 426662.5,-78"/>
<text text-anchor="middle" x="426590" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="426590" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="426590" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="426590" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L7_EP1TP0PP0DP0_GPU32 -->
<g id="node2079" class="node">
<title>attn_ar_L7_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="426802" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="426802" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="426802" y="-49.5" font-family="Arial" font-size="10.00">L7 EP1 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="426802" y="-38.5" font-family="Arial" font-size="10.00">GPU32</text>
</g>
<!-- residual1_L7_EP1TP0PP0DP0_GPU32 -->
<g id="node2080" class="node">
<title>residual1_L7_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="427087,-78 426941,-78 426941,-26 427087,-26 427087,-78"/>
<text text-anchor="middle" x="427014" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="427014" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="427014" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="427014" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L7_EP1TP0PP0DP0_GPU32 -->
<g id="node2081" class="node">
<title>ln2_L7_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="427268.5,-78 427123.5,-78 427123.5,-26 427268.5,-26 427268.5,-78"/>
<text text-anchor="middle" x="427196" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="427196" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="427196" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="427196" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L7_EP1TP0PP0DP0_GPU32 -->
<g id="node2082" class="node">
<title>gate_L7_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightyellow" stroke="black" points="427605.16,-104 427366.29,-104 427304.84,0 427543.71,0 427605.16,-104"/>
<text text-anchor="middle" x="427455" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="427455" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="427455" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="427455" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L7_EP1TP0PP0DP0_GPU32 -->
<g id="node2083" class="node">
<title>dispatch_L7_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="427744" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="427744" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="427744" y="-44" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP0_GPU32</text>
</g>
<!-- expert_0_L7_EP1TP0PP0DP0_GPU32 -->
<g id="node2084" class="node">
<title>expert_0_L7_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="428027.5,-78 427882.5,-78 427882.5,-26 428027.5,-26 428027.5,-78"/>
<text text-anchor="middle" x="427955" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="427955" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="427955" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="427955" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L7_EP1TP0PP0DP0_GPU32 -->
<g id="node2085" class="node">
<title>expert_1_L7_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="428208.5,-78 428063.5,-78 428063.5,-26 428208.5,-26 428208.5,-78"/>
<text text-anchor="middle" x="428136" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="428136" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="428136" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="428136" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L7_EP1TP0PP0DP0_GPU32 -->
<g id="node2086" class="node">
<title>expert_2_L7_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="428389.5,-78 428244.5,-78 428244.5,-26 428389.5,-26 428389.5,-78"/>
<text text-anchor="middle" x="428317" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="428317" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="428317" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="428317" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L7_EP1TP0PP0DP0_GPU32 -->
<g id="node2087" class="node">
<title>expert_3_L7_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="428570.5,-78 428425.5,-78 428425.5,-26 428570.5,-26 428570.5,-78"/>
<text text-anchor="middle" x="428498" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="428498" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="428498" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="428498" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L7_EP1TP0PP0DP0_GPU32 -->
<g id="node2088" class="node">
<title>combine_L7_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="428709" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="428709" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="428709" y="-44" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP0_GPU32</text>
</g>
<!-- ffn_L7_EP1TP0PP0DP0_GPU32 -->
<g id="node2089" class="node">
<title>ffn_L7_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="429018,-78 428848,-78 428848,-26 429018,-26 429018,-78"/>
<text text-anchor="middle" x="428933" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="428933" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="428933" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="428933" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L7_EP1TP0PP0DP0_GPU32 -->
<g id="node2090" class="node">
<title>ffn_ar_L7_EP1TP0PP0DP0_GPU32</title>
<ellipse fill="lightblue" stroke="black" cx="429157" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="429157" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="429157" y="-49.5" font-family="Arial" font-size="10.00">L7 EP1 TP Group 0 PP0 DP0</text>
<text text-anchor="middle" x="429157" y="-38.5" font-family="Arial" font-size="10.00">GPU32</text>
</g>
<!-- residual2_L7_EP1TP0PP0DP0_GPU32 -->
<g id="node2091" class="node">
<title>residual2_L7_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="429442,-78 429296,-78 429296,-26 429442,-26 429442,-78"/>
<text text-anchor="middle" x="429369" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="429369" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="429369" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="429369" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L7_EP1TP0PP0DP1_GPU33 -->
<g id="node2092" class="node">
<title>ln1_L7_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="429623.5,-78 429478.5,-78 429478.5,-26 429623.5,-26 429623.5,-78"/>
<text text-anchor="middle" x="429551" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="429551" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="429551" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="429551" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L7_EP1TP0PP0DP1_GPU33 -->
<g id="node2093" class="node">
<title>qkv_L7_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="429804.5,-78 429659.5,-78 429659.5,-26 429804.5,-26 429804.5,-78"/>
<text text-anchor="middle" x="429732" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="429732" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="429732" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="429732" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L7_EP1TP0PP0DP1_GPU33 -->
<g id="node2094" class="node">
<title>attn_L7_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="429991.5,-78 429840.5,-78 429840.5,-26 429991.5,-26 429991.5,-78"/>
<text text-anchor="middle" x="429916" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="429916" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="429916" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="429916" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L7_EP1TP0PP0DP1_GPU33 -->
<g id="node2095" class="node">
<title>attn_out_L7_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="430172.5,-78 430027.5,-78 430027.5,-26 430172.5,-26 430172.5,-78"/>
<text text-anchor="middle" x="430100" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="430100" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="430100" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="430100" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L7_EP1TP0PP0DP1_GPU33 -->
<g id="node2096" class="node">
<title>attn_ar_L7_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="430312" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="430312" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="430312" y="-49.5" font-family="Arial" font-size="10.00">L7 EP1 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="430312" y="-38.5" font-family="Arial" font-size="10.00">GPU33</text>
</g>
<!-- residual1_L7_EP1TP0PP0DP1_GPU33 -->
<g id="node2097" class="node">
<title>residual1_L7_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="430597,-78 430451,-78 430451,-26 430597,-26 430597,-78"/>
<text text-anchor="middle" x="430524" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="430524" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="430524" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="430524" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L7_EP1TP0PP0DP1_GPU33 -->
<g id="node2098" class="node">
<title>ln2_L7_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="430778.5,-78 430633.5,-78 430633.5,-26 430778.5,-26 430778.5,-78"/>
<text text-anchor="middle" x="430706" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="430706" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="430706" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="430706" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L7_EP1TP0PP0DP1_GPU33 -->
<g id="node2099" class="node">
<title>gate_L7_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightyellow" stroke="black" points="431115.16,-104 430876.29,-104 430814.84,0 431053.71,0 431115.16,-104"/>
<text text-anchor="middle" x="430965" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="430965" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="430965" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="430965" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L7_EP1TP0PP0DP1_GPU33 -->
<g id="node2100" class="node">
<title>dispatch_L7_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="431254" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="431254" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="431254" y="-44" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP1_GPU33</text>
</g>
<!-- expert_0_L7_EP1TP0PP0DP1_GPU33 -->
<g id="node2101" class="node">
<title>expert_0_L7_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="431537.5,-78 431392.5,-78 431392.5,-26 431537.5,-26 431537.5,-78"/>
<text text-anchor="middle" x="431465" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="431465" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="431465" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="431465" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L7_EP1TP0PP0DP1_GPU33 -->
<g id="node2102" class="node">
<title>expert_1_L7_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="431718.5,-78 431573.5,-78 431573.5,-26 431718.5,-26 431718.5,-78"/>
<text text-anchor="middle" x="431646" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="431646" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="431646" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="431646" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L7_EP1TP0PP0DP1_GPU33 -->
<g id="node2103" class="node">
<title>expert_2_L7_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="431899.5,-78 431754.5,-78 431754.5,-26 431899.5,-26 431899.5,-78"/>
<text text-anchor="middle" x="431827" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="431827" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="431827" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="431827" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L7_EP1TP0PP0DP1_GPU33 -->
<g id="node2104" class="node">
<title>expert_3_L7_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="432080.5,-78 431935.5,-78 431935.5,-26 432080.5,-26 432080.5,-78"/>
<text text-anchor="middle" x="432008" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="432008" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="432008" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="432008" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L7_EP1TP0PP0DP1_GPU33 -->
<g id="node2105" class="node">
<title>combine_L7_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="432219" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="432219" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="432219" y="-44" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP1_GPU33</text>
</g>
<!-- ffn_L7_EP1TP0PP0DP1_GPU33 -->
<g id="node2106" class="node">
<title>ffn_L7_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="432528,-78 432358,-78 432358,-26 432528,-26 432528,-78"/>
<text text-anchor="middle" x="432443" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="432443" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="432443" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="432443" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L7_EP1TP0PP0DP1_GPU33 -->
<g id="node2107" class="node">
<title>ffn_ar_L7_EP1TP0PP0DP1_GPU33</title>
<ellipse fill="lightblue" stroke="black" cx="432667" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="432667" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="432667" y="-49.5" font-family="Arial" font-size="10.00">L7 EP1 TP Group 0 PP0 DP1</text>
<text text-anchor="middle" x="432667" y="-38.5" font-family="Arial" font-size="10.00">GPU33</text>
</g>
<!-- residual2_L7_EP1TP0PP0DP1_GPU33 -->
<g id="node2108" class="node">
<title>residual2_L7_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="432952,-78 432806,-78 432806,-26 432952,-26 432952,-78"/>
<text text-anchor="middle" x="432879" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="432879" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="432879" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="432879" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L7_EP1TP1PP0DP0_GPU40 -->
<g id="node2109" class="node">
<title>ln1_L7_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="433133.5,-78 432988.5,-78 432988.5,-26 433133.5,-26 433133.5,-78"/>
<text text-anchor="middle" x="433061" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="433061" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="433061" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="433061" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L7_EP1TP1PP0DP0_GPU40 -->
<g id="node2110" class="node">
<title>qkv_L7_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="433314.5,-78 433169.5,-78 433169.5,-26 433314.5,-26 433314.5,-78"/>
<text text-anchor="middle" x="433242" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="433242" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="433242" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="433242" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L7_EP1TP1PP0DP0_GPU40 -->
<g id="node2111" class="node">
<title>attn_L7_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="433501.5,-78 433350.5,-78 433350.5,-26 433501.5,-26 433501.5,-78"/>
<text text-anchor="middle" x="433426" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="433426" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="433426" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="433426" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L7_EP1TP1PP0DP0_GPU40 -->
<g id="node2112" class="node">
<title>attn_out_L7_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="433682.5,-78 433537.5,-78 433537.5,-26 433682.5,-26 433682.5,-78"/>
<text text-anchor="middle" x="433610" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="433610" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="433610" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="433610" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L7_EP1TP1PP0DP0_GPU40 -->
<g id="node2113" class="node">
<title>attn_ar_L7_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="433822" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="433822" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="433822" y="-49.5" font-family="Arial" font-size="10.00">L7 EP1 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="433822" y="-38.5" font-family="Arial" font-size="10.00">GPU40</text>
</g>
<!-- residual1_L7_EP1TP1PP0DP0_GPU40 -->
<g id="node2114" class="node">
<title>residual1_L7_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="434107,-78 433961,-78 433961,-26 434107,-26 434107,-78"/>
<text text-anchor="middle" x="434034" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="434034" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="434034" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="434034" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L7_EP1TP1PP0DP0_GPU40 -->
<g id="node2115" class="node">
<title>ln2_L7_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="434288.5,-78 434143.5,-78 434143.5,-26 434288.5,-26 434288.5,-78"/>
<text text-anchor="middle" x="434216" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="434216" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="434216" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="434216" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L7_EP1TP1PP0DP0_GPU40 -->
<g id="node2116" class="node">
<title>gate_L7_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightyellow" stroke="black" points="434625.16,-104 434386.29,-104 434324.84,0 434563.71,0 434625.16,-104"/>
<text text-anchor="middle" x="434475" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="434475" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="434475" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="434475" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L7_EP1TP1PP0DP0_GPU40 -->
<g id="node2117" class="node">
<title>dispatch_L7_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="434764" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="434764" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="434764" y="-44" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP0_GPU40</text>
</g>
<!-- expert_0_L7_EP1TP1PP0DP0_GPU40 -->
<g id="node2118" class="node">
<title>expert_0_L7_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="435047.5,-78 434902.5,-78 434902.5,-26 435047.5,-26 435047.5,-78"/>
<text text-anchor="middle" x="434975" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="434975" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="434975" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="434975" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L7_EP1TP1PP0DP0_GPU40 -->
<g id="node2119" class="node">
<title>expert_1_L7_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="435228.5,-78 435083.5,-78 435083.5,-26 435228.5,-26 435228.5,-78"/>
<text text-anchor="middle" x="435156" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="435156" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="435156" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="435156" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L7_EP1TP1PP0DP0_GPU40 -->
<g id="node2120" class="node">
<title>expert_2_L7_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="435409.5,-78 435264.5,-78 435264.5,-26 435409.5,-26 435409.5,-78"/>
<text text-anchor="middle" x="435337" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="435337" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="435337" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="435337" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L7_EP1TP1PP0DP0_GPU40 -->
<g id="node2121" class="node">
<title>expert_3_L7_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="435590.5,-78 435445.5,-78 435445.5,-26 435590.5,-26 435590.5,-78"/>
<text text-anchor="middle" x="435518" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="435518" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="435518" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="435518" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L7_EP1TP1PP0DP0_GPU40 -->
<g id="node2122" class="node">
<title>combine_L7_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="435729" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="435729" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="435729" y="-44" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP0_GPU40</text>
</g>
<!-- ffn_L7_EP1TP1PP0DP0_GPU40 -->
<g id="node2123" class="node">
<title>ffn_L7_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="436038,-78 435868,-78 435868,-26 436038,-26 436038,-78"/>
<text text-anchor="middle" x="435953" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="435953" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="435953" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="435953" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L7_EP1TP1PP0DP0_GPU40 -->
<g id="node2124" class="node">
<title>ffn_ar_L7_EP1TP1PP0DP0_GPU40</title>
<ellipse fill="lightblue" stroke="black" cx="436177" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="436177" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="436177" y="-49.5" font-family="Arial" font-size="10.00">L7 EP1 TP Group 1 PP0 DP0</text>
<text text-anchor="middle" x="436177" y="-38.5" font-family="Arial" font-size="10.00">GPU40</text>
</g>
<!-- residual2_L7_EP1TP1PP0DP0_GPU40 -->
<g id="node2125" class="node">
<title>residual2_L7_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="436462,-78 436316,-78 436316,-26 436462,-26 436462,-78"/>
<text text-anchor="middle" x="436389" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="436389" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="436389" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="436389" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L7_EP1TP1PP0DP1_GPU41 -->
<g id="node2126" class="node">
<title>ln1_L7_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="436643.5,-78 436498.5,-78 436498.5,-26 436643.5,-26 436643.5,-78"/>
<text text-anchor="middle" x="436571" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="436571" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="436571" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="436571" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L7_EP1TP1PP0DP1_GPU41 -->
<g id="node2127" class="node">
<title>qkv_L7_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="436824.5,-78 436679.5,-78 436679.5,-26 436824.5,-26 436824.5,-78"/>
<text text-anchor="middle" x="436752" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="436752" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="436752" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="436752" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L7_EP1TP1PP0DP1_GPU41 -->
<g id="node2128" class="node">
<title>attn_L7_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="437011.5,-78 436860.5,-78 436860.5,-26 437011.5,-26 437011.5,-78"/>
<text text-anchor="middle" x="436936" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="436936" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="436936" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="436936" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L7_EP1TP1PP0DP1_GPU41 -->
<g id="node2129" class="node">
<title>attn_out_L7_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="437192.5,-78 437047.5,-78 437047.5,-26 437192.5,-26 437192.5,-78"/>
<text text-anchor="middle" x="437120" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="437120" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="437120" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="437120" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L7_EP1TP1PP0DP1_GPU41 -->
<g id="node2130" class="node">
<title>attn_ar_L7_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="437332" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="437332" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="437332" y="-49.5" font-family="Arial" font-size="10.00">L7 EP1 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="437332" y="-38.5" font-family="Arial" font-size="10.00">GPU41</text>
</g>
<!-- residual1_L7_EP1TP1PP0DP1_GPU41 -->
<g id="node2131" class="node">
<title>residual1_L7_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="437617,-78 437471,-78 437471,-26 437617,-26 437617,-78"/>
<text text-anchor="middle" x="437544" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="437544" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="437544" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="437544" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L7_EP1TP1PP0DP1_GPU41 -->
<g id="node2132" class="node">
<title>ln2_L7_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="437798.5,-78 437653.5,-78 437653.5,-26 437798.5,-26 437798.5,-78"/>
<text text-anchor="middle" x="437726" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="437726" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="437726" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="437726" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L7_EP1TP1PP0DP1_GPU41 -->
<g id="node2133" class="node">
<title>gate_L7_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightyellow" stroke="black" points="438135.16,-104 437896.29,-104 437834.84,0 438073.71,0 438135.16,-104"/>
<text text-anchor="middle" x="437985" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="437985" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="437985" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="437985" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L7_EP1TP1PP0DP1_GPU41 -->
<g id="node2134" class="node">
<title>dispatch_L7_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="438274" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="438274" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="438274" y="-44" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP1_GPU41</text>
</g>
<!-- expert_0_L7_EP1TP1PP0DP1_GPU41 -->
<g id="node2135" class="node">
<title>expert_0_L7_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="438557.5,-78 438412.5,-78 438412.5,-26 438557.5,-26 438557.5,-78"/>
<text text-anchor="middle" x="438485" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="438485" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="438485" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="438485" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L7_EP1TP1PP0DP1_GPU41 -->
<g id="node2136" class="node">
<title>expert_1_L7_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="438738.5,-78 438593.5,-78 438593.5,-26 438738.5,-26 438738.5,-78"/>
<text text-anchor="middle" x="438666" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="438666" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="438666" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="438666" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L7_EP1TP1PP0DP1_GPU41 -->
<g id="node2137" class="node">
<title>expert_2_L7_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="438919.5,-78 438774.5,-78 438774.5,-26 438919.5,-26 438919.5,-78"/>
<text text-anchor="middle" x="438847" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="438847" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="438847" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="438847" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L7_EP1TP1PP0DP1_GPU41 -->
<g id="node2138" class="node">
<title>expert_3_L7_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="439100.5,-78 438955.5,-78 438955.5,-26 439100.5,-26 439100.5,-78"/>
<text text-anchor="middle" x="439028" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="439028" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="439028" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="439028" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L7_EP1TP1PP0DP1_GPU41 -->
<g id="node2139" class="node">
<title>combine_L7_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="439239" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="439239" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="439239" y="-44" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP1_GPU41</text>
</g>
<!-- ffn_L7_EP1TP1PP0DP1_GPU41 -->
<g id="node2140" class="node">
<title>ffn_L7_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="439548,-78 439378,-78 439378,-26 439548,-26 439548,-78"/>
<text text-anchor="middle" x="439463" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="439463" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="439463" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="439463" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L7_EP1TP1PP0DP1_GPU41 -->
<g id="node2141" class="node">
<title>ffn_ar_L7_EP1TP1PP0DP1_GPU41</title>
<ellipse fill="lightblue" stroke="black" cx="439687" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="439687" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="439687" y="-49.5" font-family="Arial" font-size="10.00">L7 EP1 TP Group 1 PP0 DP1</text>
<text text-anchor="middle" x="439687" y="-38.5" font-family="Arial" font-size="10.00">GPU41</text>
</g>
<!-- residual2_L7_EP1TP1PP0DP1_GPU41 -->
<g id="node2142" class="node">
<title>residual2_L7_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="439972,-78 439826,-78 439826,-26 439972,-26 439972,-78"/>
<text text-anchor="middle" x="439899" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="439899" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="439899" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="439899" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L7_EP1TP2PP0DP0_GPU48 -->
<g id="node2143" class="node">
<title>ln1_L7_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="440153.5,-78 440008.5,-78 440008.5,-26 440153.5,-26 440153.5,-78"/>
<text text-anchor="middle" x="440081" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="440081" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="440081" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="440081" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L7_EP1TP2PP0DP0_GPU48 -->
<g id="node2144" class="node">
<title>qkv_L7_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="440334.5,-78 440189.5,-78 440189.5,-26 440334.5,-26 440334.5,-78"/>
<text text-anchor="middle" x="440262" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="440262" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="440262" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="440262" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L7_EP1TP2PP0DP0_GPU48 -->
<g id="node2145" class="node">
<title>attn_L7_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="440521.5,-78 440370.5,-78 440370.5,-26 440521.5,-26 440521.5,-78"/>
<text text-anchor="middle" x="440446" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="440446" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="440446" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="440446" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L7_EP1TP2PP0DP0_GPU48 -->
<g id="node2146" class="node">
<title>attn_out_L7_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="440702.5,-78 440557.5,-78 440557.5,-26 440702.5,-26 440702.5,-78"/>
<text text-anchor="middle" x="440630" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="440630" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="440630" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="440630" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L7_EP1TP2PP0DP0_GPU48 -->
<g id="node2147" class="node">
<title>attn_ar_L7_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="440842" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="440842" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="440842" y="-49.5" font-family="Arial" font-size="10.00">L7 EP1 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="440842" y="-38.5" font-family="Arial" font-size="10.00">GPU48</text>
</g>
<!-- residual1_L7_EP1TP2PP0DP0_GPU48 -->
<g id="node2148" class="node">
<title>residual1_L7_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="441127,-78 440981,-78 440981,-26 441127,-26 441127,-78"/>
<text text-anchor="middle" x="441054" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="441054" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="441054" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="441054" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L7_EP1TP2PP0DP0_GPU48 -->
<g id="node2149" class="node">
<title>ln2_L7_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="441308.5,-78 441163.5,-78 441163.5,-26 441308.5,-26 441308.5,-78"/>
<text text-anchor="middle" x="441236" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="441236" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="441236" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="441236" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L7_EP1TP2PP0DP0_GPU48 -->
<g id="node2150" class="node">
<title>gate_L7_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightyellow" stroke="black" points="441645.16,-104 441406.29,-104 441344.84,0 441583.71,0 441645.16,-104"/>
<text text-anchor="middle" x="441495" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="441495" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="441495" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="441495" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L7_EP1TP2PP0DP0_GPU48 -->
<g id="node2151" class="node">
<title>dispatch_L7_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="441784" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="441784" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="441784" y="-44" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP0_GPU48</text>
</g>
<!-- expert_0_L7_EP1TP2PP0DP0_GPU48 -->
<g id="node2152" class="node">
<title>expert_0_L7_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="442067.5,-78 441922.5,-78 441922.5,-26 442067.5,-26 442067.5,-78"/>
<text text-anchor="middle" x="441995" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="441995" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="441995" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="441995" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L7_EP1TP2PP0DP0_GPU48 -->
<g id="node2153" class="node">
<title>expert_1_L7_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="442248.5,-78 442103.5,-78 442103.5,-26 442248.5,-26 442248.5,-78"/>
<text text-anchor="middle" x="442176" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="442176" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="442176" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="442176" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L7_EP1TP2PP0DP0_GPU48 -->
<g id="node2154" class="node">
<title>expert_2_L7_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="442429.5,-78 442284.5,-78 442284.5,-26 442429.5,-26 442429.5,-78"/>
<text text-anchor="middle" x="442357" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="442357" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="442357" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="442357" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L7_EP1TP2PP0DP0_GPU48 -->
<g id="node2155" class="node">
<title>expert_3_L7_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="442610.5,-78 442465.5,-78 442465.5,-26 442610.5,-26 442610.5,-78"/>
<text text-anchor="middle" x="442538" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="442538" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="442538" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="442538" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L7_EP1TP2PP0DP0_GPU48 -->
<g id="node2156" class="node">
<title>combine_L7_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="442749" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="442749" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="442749" y="-44" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP0_GPU48</text>
</g>
<!-- ffn_L7_EP1TP2PP0DP0_GPU48 -->
<g id="node2157" class="node">
<title>ffn_L7_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="443058,-78 442888,-78 442888,-26 443058,-26 443058,-78"/>
<text text-anchor="middle" x="442973" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="442973" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="442973" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="442973" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L7_EP1TP2PP0DP0_GPU48 -->
<g id="node2158" class="node">
<title>ffn_ar_L7_EP1TP2PP0DP0_GPU48</title>
<ellipse fill="lightblue" stroke="black" cx="443197" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="443197" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="443197" y="-49.5" font-family="Arial" font-size="10.00">L7 EP1 TP Group 2 PP0 DP0</text>
<text text-anchor="middle" x="443197" y="-38.5" font-family="Arial" font-size="10.00">GPU48</text>
</g>
<!-- residual2_L7_EP1TP2PP0DP0_GPU48 -->
<g id="node2159" class="node">
<title>residual2_L7_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="443482,-78 443336,-78 443336,-26 443482,-26 443482,-78"/>
<text text-anchor="middle" x="443409" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="443409" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="443409" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="443409" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L7_EP1TP2PP0DP1_GPU49 -->
<g id="node2160" class="node">
<title>ln1_L7_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="443663.5,-78 443518.5,-78 443518.5,-26 443663.5,-26 443663.5,-78"/>
<text text-anchor="middle" x="443591" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="443591" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="443591" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="443591" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L7_EP1TP2PP0DP1_GPU49 -->
<g id="node2161" class="node">
<title>qkv_L7_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="443844.5,-78 443699.5,-78 443699.5,-26 443844.5,-26 443844.5,-78"/>
<text text-anchor="middle" x="443772" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="443772" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="443772" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="443772" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L7_EP1TP2PP0DP1_GPU49 -->
<g id="node2162" class="node">
<title>attn_L7_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="444031.5,-78 443880.5,-78 443880.5,-26 444031.5,-26 444031.5,-78"/>
<text text-anchor="middle" x="443956" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="443956" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="443956" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="443956" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L7_EP1TP2PP0DP1_GPU49 -->
<g id="node2163" class="node">
<title>attn_out_L7_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="444212.5,-78 444067.5,-78 444067.5,-26 444212.5,-26 444212.5,-78"/>
<text text-anchor="middle" x="444140" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="444140" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="444140" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="444140" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L7_EP1TP2PP0DP1_GPU49 -->
<g id="node2164" class="node">
<title>attn_ar_L7_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="444352" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="444352" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="444352" y="-49.5" font-family="Arial" font-size="10.00">L7 EP1 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="444352" y="-38.5" font-family="Arial" font-size="10.00">GPU49</text>
</g>
<!-- residual1_L7_EP1TP2PP0DP1_GPU49 -->
<g id="node2165" class="node">
<title>residual1_L7_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="444637,-78 444491,-78 444491,-26 444637,-26 444637,-78"/>
<text text-anchor="middle" x="444564" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="444564" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="444564" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="444564" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L7_EP1TP2PP0DP1_GPU49 -->
<g id="node2166" class="node">
<title>ln2_L7_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="444818.5,-78 444673.5,-78 444673.5,-26 444818.5,-26 444818.5,-78"/>
<text text-anchor="middle" x="444746" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="444746" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="444746" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="444746" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L7_EP1TP2PP0DP1_GPU49 -->
<g id="node2167" class="node">
<title>gate_L7_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightyellow" stroke="black" points="445155.16,-104 444916.29,-104 444854.84,0 445093.71,0 445155.16,-104"/>
<text text-anchor="middle" x="445005" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="445005" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="445005" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="445005" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L7_EP1TP2PP0DP1_GPU49 -->
<g id="node2168" class="node">
<title>dispatch_L7_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="445294" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="445294" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="445294" y="-44" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP1_GPU49</text>
</g>
<!-- expert_0_L7_EP1TP2PP0DP1_GPU49 -->
<g id="node2169" class="node">
<title>expert_0_L7_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="445577.5,-78 445432.5,-78 445432.5,-26 445577.5,-26 445577.5,-78"/>
<text text-anchor="middle" x="445505" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="445505" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="445505" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="445505" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L7_EP1TP2PP0DP1_GPU49 -->
<g id="node2170" class="node">
<title>expert_1_L7_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="445758.5,-78 445613.5,-78 445613.5,-26 445758.5,-26 445758.5,-78"/>
<text text-anchor="middle" x="445686" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="445686" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="445686" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="445686" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L7_EP1TP2PP0DP1_GPU49 -->
<g id="node2171" class="node">
<title>expert_2_L7_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="445939.5,-78 445794.5,-78 445794.5,-26 445939.5,-26 445939.5,-78"/>
<text text-anchor="middle" x="445867" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="445867" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="445867" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="445867" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L7_EP1TP2PP0DP1_GPU49 -->
<g id="node2172" class="node">
<title>expert_3_L7_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="446120.5,-78 445975.5,-78 445975.5,-26 446120.5,-26 446120.5,-78"/>
<text text-anchor="middle" x="446048" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="446048" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="446048" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="446048" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L7_EP1TP2PP0DP1_GPU49 -->
<g id="node2173" class="node">
<title>combine_L7_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="446259" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="446259" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="446259" y="-44" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP1_GPU49</text>
</g>
<!-- ffn_L7_EP1TP2PP0DP1_GPU49 -->
<g id="node2174" class="node">
<title>ffn_L7_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="446568,-78 446398,-78 446398,-26 446568,-26 446568,-78"/>
<text text-anchor="middle" x="446483" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="446483" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="446483" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="446483" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L7_EP1TP2PP0DP1_GPU49 -->
<g id="node2175" class="node">
<title>ffn_ar_L7_EP1TP2PP0DP1_GPU49</title>
<ellipse fill="lightblue" stroke="black" cx="446707" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="446707" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="446707" y="-49.5" font-family="Arial" font-size="10.00">L7 EP1 TP Group 2 PP0 DP1</text>
<text text-anchor="middle" x="446707" y="-38.5" font-family="Arial" font-size="10.00">GPU49</text>
</g>
<!-- residual2_L7_EP1TP2PP0DP1_GPU49 -->
<g id="node2176" class="node">
<title>residual2_L7_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="446992,-78 446846,-78 446846,-26 446992,-26 446992,-78"/>
<text text-anchor="middle" x="446919" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="446919" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="446919" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="446919" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L7_EP1TP3PP0DP0_GPU56 -->
<g id="node2177" class="node">
<title>ln1_L7_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="447173.5,-78 447028.5,-78 447028.5,-26 447173.5,-26 447173.5,-78"/>
<text text-anchor="middle" x="447101" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="447101" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="447101" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="447101" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L7_EP1TP3PP0DP0_GPU56 -->
<g id="node2178" class="node">
<title>qkv_L7_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="447354.5,-78 447209.5,-78 447209.5,-26 447354.5,-26 447354.5,-78"/>
<text text-anchor="middle" x="447282" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="447282" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="447282" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="447282" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L7_EP1TP3PP0DP0_GPU56 -->
<g id="node2179" class="node">
<title>attn_L7_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="447541.5,-78 447390.5,-78 447390.5,-26 447541.5,-26 447541.5,-78"/>
<text text-anchor="middle" x="447466" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="447466" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="447466" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="447466" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L7_EP1TP3PP0DP0_GPU56 -->
<g id="node2180" class="node">
<title>attn_out_L7_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="447722.5,-78 447577.5,-78 447577.5,-26 447722.5,-26 447722.5,-78"/>
<text text-anchor="middle" x="447650" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="447650" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="447650" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="447650" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L7_EP1TP3PP0DP0_GPU56 -->
<g id="node2181" class="node">
<title>attn_ar_L7_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="447862" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="447862" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="447862" y="-49.5" font-family="Arial" font-size="10.00">L7 EP1 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="447862" y="-38.5" font-family="Arial" font-size="10.00">GPU56</text>
</g>
<!-- residual1_L7_EP1TP3PP0DP0_GPU56 -->
<g id="node2182" class="node">
<title>residual1_L7_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="448147,-78 448001,-78 448001,-26 448147,-26 448147,-78"/>
<text text-anchor="middle" x="448074" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="448074" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="448074" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="448074" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L7_EP1TP3PP0DP0_GPU56 -->
<g id="node2183" class="node">
<title>ln2_L7_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="448328.5,-78 448183.5,-78 448183.5,-26 448328.5,-26 448328.5,-78"/>
<text text-anchor="middle" x="448256" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="448256" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="448256" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="448256" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L7_EP1TP3PP0DP0_GPU56 -->
<g id="node2184" class="node">
<title>gate_L7_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightyellow" stroke="black" points="448665.16,-104 448426.29,-104 448364.84,0 448603.71,0 448665.16,-104"/>
<text text-anchor="middle" x="448515" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="448515" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="448515" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="448515" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L7_EP1TP3PP0DP0_GPU56 -->
<g id="node2185" class="node">
<title>dispatch_L7_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="448804" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="448804" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="448804" y="-44" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP0_GPU56</text>
</g>
<!-- expert_0_L7_EP1TP3PP0DP0_GPU56 -->
<g id="node2186" class="node">
<title>expert_0_L7_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="449087.5,-78 448942.5,-78 448942.5,-26 449087.5,-26 449087.5,-78"/>
<text text-anchor="middle" x="449015" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="449015" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="449015" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="449015" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L7_EP1TP3PP0DP0_GPU56 -->
<g id="node2187" class="node">
<title>expert_1_L7_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="449268.5,-78 449123.5,-78 449123.5,-26 449268.5,-26 449268.5,-78"/>
<text text-anchor="middle" x="449196" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="449196" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="449196" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="449196" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L7_EP1TP3PP0DP0_GPU56 -->
<g id="node2188" class="node">
<title>expert_2_L7_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="449449.5,-78 449304.5,-78 449304.5,-26 449449.5,-26 449449.5,-78"/>
<text text-anchor="middle" x="449377" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="449377" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="449377" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="449377" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L7_EP1TP3PP0DP0_GPU56 -->
<g id="node2189" class="node">
<title>expert_3_L7_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="449630.5,-78 449485.5,-78 449485.5,-26 449630.5,-26 449630.5,-78"/>
<text text-anchor="middle" x="449558" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="449558" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="449558" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="449558" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L7_EP1TP3PP0DP0_GPU56 -->
<g id="node2190" class="node">
<title>combine_L7_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="449769" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="449769" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="449769" y="-44" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP0_GPU56</text>
</g>
<!-- ffn_L7_EP1TP3PP0DP0_GPU56 -->
<g id="node2191" class="node">
<title>ffn_L7_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="450078,-78 449908,-78 449908,-26 450078,-26 450078,-78"/>
<text text-anchor="middle" x="449993" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="449993" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="449993" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="449993" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L7_EP1TP3PP0DP0_GPU56 -->
<g id="node2192" class="node">
<title>ffn_ar_L7_EP1TP3PP0DP0_GPU56</title>
<ellipse fill="lightblue" stroke="black" cx="450217" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="450217" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="450217" y="-49.5" font-family="Arial" font-size="10.00">L7 EP1 TP Group 3 PP0 DP0</text>
<text text-anchor="middle" x="450217" y="-38.5" font-family="Arial" font-size="10.00">GPU56</text>
</g>
<!-- residual2_L7_EP1TP3PP0DP0_GPU56 -->
<g id="node2193" class="node">
<title>residual2_L7_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="450502,-78 450356,-78 450356,-26 450502,-26 450502,-78"/>
<text text-anchor="middle" x="450429" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="450429" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="450429" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="450429" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L7_EP1TP3PP0DP1_GPU57 -->
<g id="node2194" class="node">
<title>ln1_L7_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="450683.5,-78 450538.5,-78 450538.5,-26 450683.5,-26 450683.5,-78"/>
<text text-anchor="middle" x="450611" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="450611" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="450611" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="450611" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L7_EP1TP3PP0DP1_GPU57 -->
<g id="node2195" class="node">
<title>qkv_L7_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="450864.5,-78 450719.5,-78 450719.5,-26 450864.5,-26 450864.5,-78"/>
<text text-anchor="middle" x="450792" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="450792" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="450792" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="450792" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L7_EP1TP3PP0DP1_GPU57 -->
<g id="node2196" class="node">
<title>attn_L7_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="451051.5,-78 450900.5,-78 450900.5,-26 451051.5,-26 451051.5,-78"/>
<text text-anchor="middle" x="450976" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="450976" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="450976" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="450976" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L7_EP1TP3PP0DP1_GPU57 -->
<g id="node2197" class="node">
<title>attn_out_L7_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="451232.5,-78 451087.5,-78 451087.5,-26 451232.5,-26 451232.5,-78"/>
<text text-anchor="middle" x="451160" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="451160" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="451160" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="451160" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L7_EP1TP3PP0DP1_GPU57 -->
<g id="node2198" class="node">
<title>attn_ar_L7_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="451372" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="451372" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="451372" y="-49.5" font-family="Arial" font-size="10.00">L7 EP1 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="451372" y="-38.5" font-family="Arial" font-size="10.00">GPU57</text>
</g>
<!-- residual1_L7_EP1TP3PP0DP1_GPU57 -->
<g id="node2199" class="node">
<title>residual1_L7_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="451657,-78 451511,-78 451511,-26 451657,-26 451657,-78"/>
<text text-anchor="middle" x="451584" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="451584" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="451584" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="451584" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L7_EP1TP3PP0DP1_GPU57 -->
<g id="node2200" class="node">
<title>ln2_L7_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="451838.5,-78 451693.5,-78 451693.5,-26 451838.5,-26 451838.5,-78"/>
<text text-anchor="middle" x="451766" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="451766" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="451766" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="451766" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L7_EP1TP3PP0DP1_GPU57 -->
<g id="node2201" class="node">
<title>gate_L7_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightyellow" stroke="black" points="452175.16,-104 451936.29,-104 451874.84,0 452113.71,0 452175.16,-104"/>
<text text-anchor="middle" x="452025" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="452025" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="452025" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="452025" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L7_EP1TP3PP0DP1_GPU57 -->
<g id="node2202" class="node">
<title>dispatch_L7_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="452314" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="452314" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="452314" y="-44" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP1_GPU57</text>
</g>
<!-- expert_0_L7_EP1TP3PP0DP1_GPU57 -->
<g id="node2203" class="node">
<title>expert_0_L7_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="452597.5,-78 452452.5,-78 452452.5,-26 452597.5,-26 452597.5,-78"/>
<text text-anchor="middle" x="452525" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="452525" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="452525" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="452525" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L7_EP1TP3PP0DP1_GPU57 -->
<g id="node2204" class="node">
<title>expert_1_L7_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="452778.5,-78 452633.5,-78 452633.5,-26 452778.5,-26 452778.5,-78"/>
<text text-anchor="middle" x="452706" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="452706" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="452706" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="452706" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L7_EP1TP3PP0DP1_GPU57 -->
<g id="node2205" class="node">
<title>expert_2_L7_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="452959.5,-78 452814.5,-78 452814.5,-26 452959.5,-26 452959.5,-78"/>
<text text-anchor="middle" x="452887" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="452887" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="452887" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="452887" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L7_EP1TP3PP0DP1_GPU57 -->
<g id="node2206" class="node">
<title>expert_3_L7_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="453140.5,-78 452995.5,-78 452995.5,-26 453140.5,-26 453140.5,-78"/>
<text text-anchor="middle" x="453068" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="453068" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="453068" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="453068" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L7_EP1TP3PP0DP1_GPU57 -->
<g id="node2207" class="node">
<title>combine_L7_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="453279" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="453279" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="453279" y="-44" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP1_GPU57</text>
</g>
<!-- ffn_L7_EP1TP3PP0DP1_GPU57 -->
<g id="node2208" class="node">
<title>ffn_L7_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="453588,-78 453418,-78 453418,-26 453588,-26 453588,-78"/>
<text text-anchor="middle" x="453503" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="453503" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="453503" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="453503" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L7_EP1TP3PP0DP1_GPU57 -->
<g id="node2209" class="node">
<title>ffn_ar_L7_EP1TP3PP0DP1_GPU57</title>
<ellipse fill="lightblue" stroke="black" cx="453727" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="453727" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="453727" y="-49.5" font-family="Arial" font-size="10.00">L7 EP1 TP Group 3 PP0 DP1</text>
<text text-anchor="middle" x="453727" y="-38.5" font-family="Arial" font-size="10.00">GPU57</text>
</g>
<!-- residual2_L7_EP1TP3PP0DP1_GPU57 -->
<g id="node2210" class="node">
<title>residual2_L7_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="454012,-78 453866,-78 453866,-26 454012,-26 454012,-78"/>
<text text-anchor="middle" x="453939" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="453939" y="-55" font-family="Arial" font-size="10.00">L7_EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="453939" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="453939" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L8_EP0TP0PP1DP0_GPU4 -->
<g id="node2211" class="node">
<title>ln1_L8_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="454190,-78 454048,-78 454048,-26 454190,-26 454190,-78"/>
<text text-anchor="middle" x="454119" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="454119" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="454119" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="454119" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L8_EP0TP0PP1DP0_GPU4 -->
<g id="node2212" class="node">
<title>qkv_L8_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="454368,-78 454226,-78 454226,-26 454368,-26 454368,-78"/>
<text text-anchor="middle" x="454297" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="454297" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="454297" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="454297" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L8_EP0TP0PP1DP0_GPU4 -->
<g id="node2213" class="node">
<title>attn_L8_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="454555.5,-78 454404.5,-78 454404.5,-26 454555.5,-26 454555.5,-78"/>
<text text-anchor="middle" x="454480" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="454480" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="454480" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="454480" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L8_EP0TP0PP1DP0_GPU4 -->
<g id="node2214" class="node">
<title>attn_out_L8_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="454734,-78 454592,-78 454592,-26 454734,-26 454734,-78"/>
<text text-anchor="middle" x="454663" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="454663" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="454663" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="454663" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L8_EP0TP0PP1DP0_GPU4 -->
<g id="node2215" class="node">
<title>attn_ar_L8_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="454873" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="454873" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="454873" y="-49.5" font-family="Arial" font-size="10.00">L8 EP0 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="454873" y="-38.5" font-family="Arial" font-size="10.00">GPU4</text>
</g>
<!-- residual1_L8_EP0TP0PP1DP0_GPU4 -->
<g id="node2216" class="node">
<title>residual1_L8_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="455158,-78 455012,-78 455012,-26 455158,-26 455158,-78"/>
<text text-anchor="middle" x="455085" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="455085" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="455085" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="455085" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L8_EP0TP0PP1DP0_GPU4 -->
<g id="node2217" class="node">
<title>ln2_L8_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="455336,-78 455194,-78 455194,-26 455336,-26 455336,-78"/>
<text text-anchor="middle" x="455265" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="455265" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="455265" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="455265" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L8_EP0TP0PP1DP0_GPU4 -->
<g id="node2218" class="node">
<title>gate_L8_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightyellow" stroke="black" points="455662.29,-104 455431.17,-104 455371.71,0 455602.83,0 455662.29,-104"/>
<text text-anchor="middle" x="455517" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="455517" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="455517" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="455517" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L8_EP0TP0PP1DP0_GPU4 -->
<g id="node2219" class="node">
<title>dispatch_L8_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="455797" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="455797" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="455797" y="-44" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP0_GPU4</text>
</g>
<!-- expert_0_L8_EP0TP0PP1DP0_GPU4 -->
<g id="node2220" class="node">
<title>expert_0_L8_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="456072,-78 455932,-78 455932,-26 456072,-26 456072,-78"/>
<text text-anchor="middle" x="456002" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="456002" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="456002" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="456002" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L8_EP0TP0PP1DP0_GPU4 -->
<g id="node2221" class="node">
<title>expert_1_L8_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="456248,-78 456108,-78 456108,-26 456248,-26 456248,-78"/>
<text text-anchor="middle" x="456178" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="456178" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="456178" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="456178" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L8_EP0TP0PP1DP0_GPU4 -->
<g id="node2222" class="node">
<title>expert_2_L8_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="456424,-78 456284,-78 456284,-26 456424,-26 456424,-78"/>
<text text-anchor="middle" x="456354" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="456354" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="456354" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="456354" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L8_EP0TP0PP1DP0_GPU4 -->
<g id="node2223" class="node">
<title>expert_3_L8_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="456600,-78 456460,-78 456460,-26 456600,-26 456600,-78"/>
<text text-anchor="middle" x="456530" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="456530" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="456530" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="456530" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L8_EP0TP0PP1DP0_GPU4 -->
<g id="node2224" class="node">
<title>combine_L8_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="456735" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="456735" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="456735" y="-44" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP0_GPU4</text>
</g>
<!-- ffn_L8_EP0TP0PP1DP0_GPU4 -->
<g id="node2225" class="node">
<title>ffn_L8_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="457040,-78 456870,-78 456870,-26 457040,-26 457040,-78"/>
<text text-anchor="middle" x="456955" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="456955" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="456955" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="456955" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L8_EP0TP0PP1DP0_GPU4 -->
<g id="node2226" class="node">
<title>ffn_ar_L8_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="457179" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="457179" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="457179" y="-49.5" font-family="Arial" font-size="10.00">L8 EP0 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="457179" y="-38.5" font-family="Arial" font-size="10.00">GPU4</text>
</g>
<!-- residual2_L8_EP0TP0PP1DP0_GPU4 -->
<g id="node2227" class="node">
<title>residual2_L8_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="457464,-78 457318,-78 457318,-26 457464,-26 457464,-78"/>
<text text-anchor="middle" x="457391" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="457391" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="457391" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="457391" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L8_EP0TP0PP1DP1_GPU5 -->
<g id="node2228" class="node">
<title>ln1_L8_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="457642,-78 457500,-78 457500,-26 457642,-26 457642,-78"/>
<text text-anchor="middle" x="457571" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="457571" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="457571" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="457571" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L8_EP0TP0PP1DP1_GPU5 -->
<g id="node2229" class="node">
<title>qkv_L8_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="457820,-78 457678,-78 457678,-26 457820,-26 457820,-78"/>
<text text-anchor="middle" x="457749" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="457749" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="457749" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="457749" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L8_EP0TP0PP1DP1_GPU5 -->
<g id="node2230" class="node">
<title>attn_L8_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="458007.5,-78 457856.5,-78 457856.5,-26 458007.5,-26 458007.5,-78"/>
<text text-anchor="middle" x="457932" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="457932" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="457932" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="457932" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L8_EP0TP0PP1DP1_GPU5 -->
<g id="node2231" class="node">
<title>attn_out_L8_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="458186,-78 458044,-78 458044,-26 458186,-26 458186,-78"/>
<text text-anchor="middle" x="458115" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="458115" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="458115" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="458115" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L8_EP0TP0PP1DP1_GPU5 -->
<g id="node2232" class="node">
<title>attn_ar_L8_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="458325" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="458325" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="458325" y="-49.5" font-family="Arial" font-size="10.00">L8 EP0 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="458325" y="-38.5" font-family="Arial" font-size="10.00">GPU5</text>
</g>
<!-- residual1_L8_EP0TP0PP1DP1_GPU5 -->
<g id="node2233" class="node">
<title>residual1_L8_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="458610,-78 458464,-78 458464,-26 458610,-26 458610,-78"/>
<text text-anchor="middle" x="458537" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="458537" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="458537" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="458537" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L8_EP0TP0PP1DP1_GPU5 -->
<g id="node2234" class="node">
<title>ln2_L8_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="458788,-78 458646,-78 458646,-26 458788,-26 458788,-78"/>
<text text-anchor="middle" x="458717" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="458717" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="458717" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="458717" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L8_EP0TP0PP1DP1_GPU5 -->
<g id="node2235" class="node">
<title>gate_L8_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightyellow" stroke="black" points="459114.29,-104 458883.17,-104 458823.71,0 459054.83,0 459114.29,-104"/>
<text text-anchor="middle" x="458969" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="458969" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="458969" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="458969" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L8_EP0TP0PP1DP1_GPU5 -->
<g id="node2236" class="node">
<title>dispatch_L8_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="459249" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="459249" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="459249" y="-44" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP1_GPU5</text>
</g>
<!-- expert_0_L8_EP0TP0PP1DP1_GPU5 -->
<g id="node2237" class="node">
<title>expert_0_L8_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="459524,-78 459384,-78 459384,-26 459524,-26 459524,-78"/>
<text text-anchor="middle" x="459454" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="459454" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="459454" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="459454" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L8_EP0TP0PP1DP1_GPU5 -->
<g id="node2238" class="node">
<title>expert_1_L8_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="459700,-78 459560,-78 459560,-26 459700,-26 459700,-78"/>
<text text-anchor="middle" x="459630" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="459630" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="459630" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="459630" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L8_EP0TP0PP1DP1_GPU5 -->
<g id="node2239" class="node">
<title>expert_2_L8_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="459876,-78 459736,-78 459736,-26 459876,-26 459876,-78"/>
<text text-anchor="middle" x="459806" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="459806" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="459806" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="459806" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L8_EP0TP0PP1DP1_GPU5 -->
<g id="node2240" class="node">
<title>expert_3_L8_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="460052,-78 459912,-78 459912,-26 460052,-26 460052,-78"/>
<text text-anchor="middle" x="459982" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="459982" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="459982" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="459982" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L8_EP0TP0PP1DP1_GPU5 -->
<g id="node2241" class="node">
<title>combine_L8_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="460187" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="460187" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="460187" y="-44" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP1_GPU5</text>
</g>
<!-- ffn_L8_EP0TP0PP1DP1_GPU5 -->
<g id="node2242" class="node">
<title>ffn_L8_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="460492,-78 460322,-78 460322,-26 460492,-26 460492,-78"/>
<text text-anchor="middle" x="460407" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="460407" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="460407" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="460407" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L8_EP0TP0PP1DP1_GPU5 -->
<g id="node2243" class="node">
<title>ffn_ar_L8_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="460631" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="460631" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="460631" y="-49.5" font-family="Arial" font-size="10.00">L8 EP0 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="460631" y="-38.5" font-family="Arial" font-size="10.00">GPU5</text>
</g>
<!-- residual2_L8_EP0TP0PP1DP1_GPU5 -->
<g id="node2244" class="node">
<title>residual2_L8_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="460916,-78 460770,-78 460770,-26 460916,-26 460916,-78"/>
<text text-anchor="middle" x="460843" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="460843" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="460843" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="460843" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L8_EP0TP1PP1DP0_GPU12 -->
<g id="node2245" class="node">
<title>ln1_L8_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="461097.5,-78 460952.5,-78 460952.5,-26 461097.5,-26 461097.5,-78"/>
<text text-anchor="middle" x="461025" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="461025" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="461025" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="461025" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L8_EP0TP1PP1DP0_GPU12 -->
<g id="node2246" class="node">
<title>qkv_L8_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="461278.5,-78 461133.5,-78 461133.5,-26 461278.5,-26 461278.5,-78"/>
<text text-anchor="middle" x="461206" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="461206" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="461206" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="461206" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L8_EP0TP1PP1DP0_GPU12 -->
<g id="node2247" class="node">
<title>attn_L8_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="461465.5,-78 461314.5,-78 461314.5,-26 461465.5,-26 461465.5,-78"/>
<text text-anchor="middle" x="461390" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="461390" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="461390" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="461390" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L8_EP0TP1PP1DP0_GPU12 -->
<g id="node2248" class="node">
<title>attn_out_L8_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="461646.5,-78 461501.5,-78 461501.5,-26 461646.5,-26 461646.5,-78"/>
<text text-anchor="middle" x="461574" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="461574" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="461574" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="461574" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L8_EP0TP1PP1DP0_GPU12 -->
<g id="node2249" class="node">
<title>attn_ar_L8_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="461786" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="461786" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="461786" y="-49.5" font-family="Arial" font-size="10.00">L8 EP0 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="461786" y="-38.5" font-family="Arial" font-size="10.00">GPU12</text>
</g>
<!-- residual1_L8_EP0TP1PP1DP0_GPU12 -->
<g id="node2250" class="node">
<title>residual1_L8_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="462071,-78 461925,-78 461925,-26 462071,-26 462071,-78"/>
<text text-anchor="middle" x="461998" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="461998" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="461998" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="461998" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L8_EP0TP1PP1DP0_GPU12 -->
<g id="node2251" class="node">
<title>ln2_L8_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="462252.5,-78 462107.5,-78 462107.5,-26 462252.5,-26 462252.5,-78"/>
<text text-anchor="middle" x="462180" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="462180" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="462180" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="462180" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L8_EP0TP1PP1DP0_GPU12 -->
<g id="node2252" class="node">
<title>gate_L8_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightyellow" stroke="black" points="462589.16,-104 462350.29,-104 462288.84,0 462527.71,0 462589.16,-104"/>
<text text-anchor="middle" x="462439" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="462439" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="462439" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="462439" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L8_EP0TP1PP1DP0_GPU12 -->
<g id="node2253" class="node">
<title>dispatch_L8_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="462728" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="462728" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="462728" y="-44" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP0_GPU12</text>
</g>
<!-- expert_0_L8_EP0TP1PP1DP0_GPU12 -->
<g id="node2254" class="node">
<title>expert_0_L8_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="463011.5,-78 462866.5,-78 462866.5,-26 463011.5,-26 463011.5,-78"/>
<text text-anchor="middle" x="462939" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="462939" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="462939" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="462939" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L8_EP0TP1PP1DP0_GPU12 -->
<g id="node2255" class="node">
<title>expert_1_L8_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="463192.5,-78 463047.5,-78 463047.5,-26 463192.5,-26 463192.5,-78"/>
<text text-anchor="middle" x="463120" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="463120" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="463120" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="463120" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L8_EP0TP1PP1DP0_GPU12 -->
<g id="node2256" class="node">
<title>expert_2_L8_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="463373.5,-78 463228.5,-78 463228.5,-26 463373.5,-26 463373.5,-78"/>
<text text-anchor="middle" x="463301" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="463301" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="463301" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="463301" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L8_EP0TP1PP1DP0_GPU12 -->
<g id="node2257" class="node">
<title>expert_3_L8_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="463554.5,-78 463409.5,-78 463409.5,-26 463554.5,-26 463554.5,-78"/>
<text text-anchor="middle" x="463482" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="463482" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="463482" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="463482" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L8_EP0TP1PP1DP0_GPU12 -->
<g id="node2258" class="node">
<title>combine_L8_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="463693" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="463693" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="463693" y="-44" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP0_GPU12</text>
</g>
<!-- ffn_L8_EP0TP1PP1DP0_GPU12 -->
<g id="node2259" class="node">
<title>ffn_L8_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="464002,-78 463832,-78 463832,-26 464002,-26 464002,-78"/>
<text text-anchor="middle" x="463917" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="463917" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="463917" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="463917" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L8_EP0TP1PP1DP0_GPU12 -->
<g id="node2260" class="node">
<title>ffn_ar_L8_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="464141" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="464141" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="464141" y="-49.5" font-family="Arial" font-size="10.00">L8 EP0 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="464141" y="-38.5" font-family="Arial" font-size="10.00">GPU12</text>
</g>
<!-- residual2_L8_EP0TP1PP1DP0_GPU12 -->
<g id="node2261" class="node">
<title>residual2_L8_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="464426,-78 464280,-78 464280,-26 464426,-26 464426,-78"/>
<text text-anchor="middle" x="464353" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="464353" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="464353" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="464353" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L8_EP0TP1PP1DP1_GPU13 -->
<g id="node2262" class="node">
<title>ln1_L8_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="464607.5,-78 464462.5,-78 464462.5,-26 464607.5,-26 464607.5,-78"/>
<text text-anchor="middle" x="464535" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="464535" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="464535" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="464535" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L8_EP0TP1PP1DP1_GPU13 -->
<g id="node2263" class="node">
<title>qkv_L8_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="464788.5,-78 464643.5,-78 464643.5,-26 464788.5,-26 464788.5,-78"/>
<text text-anchor="middle" x="464716" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="464716" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="464716" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="464716" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L8_EP0TP1PP1DP1_GPU13 -->
<g id="node2264" class="node">
<title>attn_L8_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="464975.5,-78 464824.5,-78 464824.5,-26 464975.5,-26 464975.5,-78"/>
<text text-anchor="middle" x="464900" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="464900" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="464900" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="464900" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L8_EP0TP1PP1DP1_GPU13 -->
<g id="node2265" class="node">
<title>attn_out_L8_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="465156.5,-78 465011.5,-78 465011.5,-26 465156.5,-26 465156.5,-78"/>
<text text-anchor="middle" x="465084" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="465084" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="465084" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="465084" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L8_EP0TP1PP1DP1_GPU13 -->
<g id="node2266" class="node">
<title>attn_ar_L8_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="465296" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="465296" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="465296" y="-49.5" font-family="Arial" font-size="10.00">L8 EP0 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="465296" y="-38.5" font-family="Arial" font-size="10.00">GPU13</text>
</g>
<!-- residual1_L8_EP0TP1PP1DP1_GPU13 -->
<g id="node2267" class="node">
<title>residual1_L8_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="465581,-78 465435,-78 465435,-26 465581,-26 465581,-78"/>
<text text-anchor="middle" x="465508" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="465508" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="465508" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="465508" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L8_EP0TP1PP1DP1_GPU13 -->
<g id="node2268" class="node">
<title>ln2_L8_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="465762.5,-78 465617.5,-78 465617.5,-26 465762.5,-26 465762.5,-78"/>
<text text-anchor="middle" x="465690" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="465690" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="465690" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="465690" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L8_EP0TP1PP1DP1_GPU13 -->
<g id="node2269" class="node">
<title>gate_L8_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightyellow" stroke="black" points="466099.16,-104 465860.29,-104 465798.84,0 466037.71,0 466099.16,-104"/>
<text text-anchor="middle" x="465949" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="465949" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="465949" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="465949" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L8_EP0TP1PP1DP1_GPU13 -->
<g id="node2270" class="node">
<title>dispatch_L8_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="466238" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="466238" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="466238" y="-44" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP1_GPU13</text>
</g>
<!-- expert_0_L8_EP0TP1PP1DP1_GPU13 -->
<g id="node2271" class="node">
<title>expert_0_L8_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="466521.5,-78 466376.5,-78 466376.5,-26 466521.5,-26 466521.5,-78"/>
<text text-anchor="middle" x="466449" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="466449" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="466449" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="466449" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L8_EP0TP1PP1DP1_GPU13 -->
<g id="node2272" class="node">
<title>expert_1_L8_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="466702.5,-78 466557.5,-78 466557.5,-26 466702.5,-26 466702.5,-78"/>
<text text-anchor="middle" x="466630" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="466630" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="466630" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="466630" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L8_EP0TP1PP1DP1_GPU13 -->
<g id="node2273" class="node">
<title>expert_2_L8_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="466883.5,-78 466738.5,-78 466738.5,-26 466883.5,-26 466883.5,-78"/>
<text text-anchor="middle" x="466811" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="466811" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="466811" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="466811" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L8_EP0TP1PP1DP1_GPU13 -->
<g id="node2274" class="node">
<title>expert_3_L8_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="467064.5,-78 466919.5,-78 466919.5,-26 467064.5,-26 467064.5,-78"/>
<text text-anchor="middle" x="466992" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="466992" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="466992" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="466992" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L8_EP0TP1PP1DP1_GPU13 -->
<g id="node2275" class="node">
<title>combine_L8_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="467203" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="467203" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="467203" y="-44" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP1_GPU13</text>
</g>
<!-- ffn_L8_EP0TP1PP1DP1_GPU13 -->
<g id="node2276" class="node">
<title>ffn_L8_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="467512,-78 467342,-78 467342,-26 467512,-26 467512,-78"/>
<text text-anchor="middle" x="467427" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="467427" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="467427" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="467427" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L8_EP0TP1PP1DP1_GPU13 -->
<g id="node2277" class="node">
<title>ffn_ar_L8_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="467651" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="467651" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="467651" y="-49.5" font-family="Arial" font-size="10.00">L8 EP0 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="467651" y="-38.5" font-family="Arial" font-size="10.00">GPU13</text>
</g>
<!-- residual2_L8_EP0TP1PP1DP1_GPU13 -->
<g id="node2278" class="node">
<title>residual2_L8_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="467936,-78 467790,-78 467790,-26 467936,-26 467936,-78"/>
<text text-anchor="middle" x="467863" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="467863" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="467863" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="467863" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L8_EP0TP2PP1DP0_GPU20 -->
<g id="node2279" class="node">
<title>ln1_L8_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="468117.5,-78 467972.5,-78 467972.5,-26 468117.5,-26 468117.5,-78"/>
<text text-anchor="middle" x="468045" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="468045" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="468045" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="468045" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L8_EP0TP2PP1DP0_GPU20 -->
<g id="node2280" class="node">
<title>qkv_L8_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="468298.5,-78 468153.5,-78 468153.5,-26 468298.5,-26 468298.5,-78"/>
<text text-anchor="middle" x="468226" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="468226" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="468226" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="468226" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L8_EP0TP2PP1DP0_GPU20 -->
<g id="node2281" class="node">
<title>attn_L8_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="468485.5,-78 468334.5,-78 468334.5,-26 468485.5,-26 468485.5,-78"/>
<text text-anchor="middle" x="468410" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="468410" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="468410" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="468410" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L8_EP0TP2PP1DP0_GPU20 -->
<g id="node2282" class="node">
<title>attn_out_L8_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="468666.5,-78 468521.5,-78 468521.5,-26 468666.5,-26 468666.5,-78"/>
<text text-anchor="middle" x="468594" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="468594" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="468594" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="468594" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L8_EP0TP2PP1DP0_GPU20 -->
<g id="node2283" class="node">
<title>attn_ar_L8_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="468806" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="468806" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="468806" y="-49.5" font-family="Arial" font-size="10.00">L8 EP0 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="468806" y="-38.5" font-family="Arial" font-size="10.00">GPU20</text>
</g>
<!-- residual1_L8_EP0TP2PP1DP0_GPU20 -->
<g id="node2284" class="node">
<title>residual1_L8_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="469091,-78 468945,-78 468945,-26 469091,-26 469091,-78"/>
<text text-anchor="middle" x="469018" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="469018" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="469018" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="469018" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L8_EP0TP2PP1DP0_GPU20 -->
<g id="node2285" class="node">
<title>ln2_L8_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="469272.5,-78 469127.5,-78 469127.5,-26 469272.5,-26 469272.5,-78"/>
<text text-anchor="middle" x="469200" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="469200" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="469200" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="469200" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L8_EP0TP2PP1DP0_GPU20 -->
<g id="node2286" class="node">
<title>gate_L8_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightyellow" stroke="black" points="469609.16,-104 469370.29,-104 469308.84,0 469547.71,0 469609.16,-104"/>
<text text-anchor="middle" x="469459" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="469459" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="469459" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="469459" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L8_EP0TP2PP1DP0_GPU20 -->
<g id="node2287" class="node">
<title>dispatch_L8_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="469748" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="469748" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="469748" y="-44" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP0_GPU20</text>
</g>
<!-- expert_0_L8_EP0TP2PP1DP0_GPU20 -->
<g id="node2288" class="node">
<title>expert_0_L8_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="470031.5,-78 469886.5,-78 469886.5,-26 470031.5,-26 470031.5,-78"/>
<text text-anchor="middle" x="469959" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="469959" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="469959" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="469959" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L8_EP0TP2PP1DP0_GPU20 -->
<g id="node2289" class="node">
<title>expert_1_L8_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="470212.5,-78 470067.5,-78 470067.5,-26 470212.5,-26 470212.5,-78"/>
<text text-anchor="middle" x="470140" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="470140" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="470140" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="470140" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L8_EP0TP2PP1DP0_GPU20 -->
<g id="node2290" class="node">
<title>expert_2_L8_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="470393.5,-78 470248.5,-78 470248.5,-26 470393.5,-26 470393.5,-78"/>
<text text-anchor="middle" x="470321" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="470321" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="470321" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="470321" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L8_EP0TP2PP1DP0_GPU20 -->
<g id="node2291" class="node">
<title>expert_3_L8_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="470574.5,-78 470429.5,-78 470429.5,-26 470574.5,-26 470574.5,-78"/>
<text text-anchor="middle" x="470502" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="470502" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="470502" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="470502" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L8_EP0TP2PP1DP0_GPU20 -->
<g id="node2292" class="node">
<title>combine_L8_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="470713" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="470713" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="470713" y="-44" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP0_GPU20</text>
</g>
<!-- ffn_L8_EP0TP2PP1DP0_GPU20 -->
<g id="node2293" class="node">
<title>ffn_L8_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="471022,-78 470852,-78 470852,-26 471022,-26 471022,-78"/>
<text text-anchor="middle" x="470937" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="470937" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="470937" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="470937" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L8_EP0TP2PP1DP0_GPU20 -->
<g id="node2294" class="node">
<title>ffn_ar_L8_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="471161" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="471161" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="471161" y="-49.5" font-family="Arial" font-size="10.00">L8 EP0 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="471161" y="-38.5" font-family="Arial" font-size="10.00">GPU20</text>
</g>
<!-- residual2_L8_EP0TP2PP1DP0_GPU20 -->
<g id="node2295" class="node">
<title>residual2_L8_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="471446,-78 471300,-78 471300,-26 471446,-26 471446,-78"/>
<text text-anchor="middle" x="471373" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="471373" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="471373" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="471373" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L8_EP0TP2PP1DP1_GPU21 -->
<g id="node2296" class="node">
<title>ln1_L8_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="471627.5,-78 471482.5,-78 471482.5,-26 471627.5,-26 471627.5,-78"/>
<text text-anchor="middle" x="471555" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="471555" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="471555" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="471555" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L8_EP0TP2PP1DP1_GPU21 -->
<g id="node2297" class="node">
<title>qkv_L8_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="471808.5,-78 471663.5,-78 471663.5,-26 471808.5,-26 471808.5,-78"/>
<text text-anchor="middle" x="471736" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="471736" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="471736" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="471736" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L8_EP0TP2PP1DP1_GPU21 -->
<g id="node2298" class="node">
<title>attn_L8_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="471995.5,-78 471844.5,-78 471844.5,-26 471995.5,-26 471995.5,-78"/>
<text text-anchor="middle" x="471920" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="471920" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="471920" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="471920" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L8_EP0TP2PP1DP1_GPU21 -->
<g id="node2299" class="node">
<title>attn_out_L8_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="472176.5,-78 472031.5,-78 472031.5,-26 472176.5,-26 472176.5,-78"/>
<text text-anchor="middle" x="472104" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="472104" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="472104" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="472104" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L8_EP0TP2PP1DP1_GPU21 -->
<g id="node2300" class="node">
<title>attn_ar_L8_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="472316" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="472316" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="472316" y="-49.5" font-family="Arial" font-size="10.00">L8 EP0 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="472316" y="-38.5" font-family="Arial" font-size="10.00">GPU21</text>
</g>
<!-- residual1_L8_EP0TP2PP1DP1_GPU21 -->
<g id="node2301" class="node">
<title>residual1_L8_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="472601,-78 472455,-78 472455,-26 472601,-26 472601,-78"/>
<text text-anchor="middle" x="472528" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="472528" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="472528" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="472528" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L8_EP0TP2PP1DP1_GPU21 -->
<g id="node2302" class="node">
<title>ln2_L8_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="472782.5,-78 472637.5,-78 472637.5,-26 472782.5,-26 472782.5,-78"/>
<text text-anchor="middle" x="472710" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="472710" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="472710" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="472710" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L8_EP0TP2PP1DP1_GPU21 -->
<g id="node2303" class="node">
<title>gate_L8_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightyellow" stroke="black" points="473119.16,-104 472880.29,-104 472818.84,0 473057.71,0 473119.16,-104"/>
<text text-anchor="middle" x="472969" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="472969" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="472969" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="472969" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L8_EP0TP2PP1DP1_GPU21 -->
<g id="node2304" class="node">
<title>dispatch_L8_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="473258" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="473258" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="473258" y="-44" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP1_GPU21</text>
</g>
<!-- expert_0_L8_EP0TP2PP1DP1_GPU21 -->
<g id="node2305" class="node">
<title>expert_0_L8_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="473541.5,-78 473396.5,-78 473396.5,-26 473541.5,-26 473541.5,-78"/>
<text text-anchor="middle" x="473469" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="473469" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="473469" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="473469" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L8_EP0TP2PP1DP1_GPU21 -->
<g id="node2306" class="node">
<title>expert_1_L8_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="473722.5,-78 473577.5,-78 473577.5,-26 473722.5,-26 473722.5,-78"/>
<text text-anchor="middle" x="473650" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="473650" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="473650" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="473650" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L8_EP0TP2PP1DP1_GPU21 -->
<g id="node2307" class="node">
<title>expert_2_L8_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="473903.5,-78 473758.5,-78 473758.5,-26 473903.5,-26 473903.5,-78"/>
<text text-anchor="middle" x="473831" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="473831" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="473831" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="473831" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L8_EP0TP2PP1DP1_GPU21 -->
<g id="node2308" class="node">
<title>expert_3_L8_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="474084.5,-78 473939.5,-78 473939.5,-26 474084.5,-26 474084.5,-78"/>
<text text-anchor="middle" x="474012" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="474012" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="474012" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="474012" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L8_EP0TP2PP1DP1_GPU21 -->
<g id="node2309" class="node">
<title>combine_L8_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="474223" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="474223" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="474223" y="-44" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP1_GPU21</text>
</g>
<!-- ffn_L8_EP0TP2PP1DP1_GPU21 -->
<g id="node2310" class="node">
<title>ffn_L8_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="474532,-78 474362,-78 474362,-26 474532,-26 474532,-78"/>
<text text-anchor="middle" x="474447" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="474447" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="474447" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="474447" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L8_EP0TP2PP1DP1_GPU21 -->
<g id="node2311" class="node">
<title>ffn_ar_L8_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="474671" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="474671" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="474671" y="-49.5" font-family="Arial" font-size="10.00">L8 EP0 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="474671" y="-38.5" font-family="Arial" font-size="10.00">GPU21</text>
</g>
<!-- residual2_L8_EP0TP2PP1DP1_GPU21 -->
<g id="node2312" class="node">
<title>residual2_L8_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="474956,-78 474810,-78 474810,-26 474956,-26 474956,-78"/>
<text text-anchor="middle" x="474883" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="474883" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="474883" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="474883" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L8_EP0TP3PP1DP0_GPU28 -->
<g id="node2313" class="node">
<title>ln1_L8_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="475137.5,-78 474992.5,-78 474992.5,-26 475137.5,-26 475137.5,-78"/>
<text text-anchor="middle" x="475065" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="475065" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="475065" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="475065" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L8_EP0TP3PP1DP0_GPU28 -->
<g id="node2314" class="node">
<title>qkv_L8_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="475318.5,-78 475173.5,-78 475173.5,-26 475318.5,-26 475318.5,-78"/>
<text text-anchor="middle" x="475246" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="475246" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="475246" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="475246" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L8_EP0TP3PP1DP0_GPU28 -->
<g id="node2315" class="node">
<title>attn_L8_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="475505.5,-78 475354.5,-78 475354.5,-26 475505.5,-26 475505.5,-78"/>
<text text-anchor="middle" x="475430" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="475430" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="475430" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="475430" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L8_EP0TP3PP1DP0_GPU28 -->
<g id="node2316" class="node">
<title>attn_out_L8_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="475686.5,-78 475541.5,-78 475541.5,-26 475686.5,-26 475686.5,-78"/>
<text text-anchor="middle" x="475614" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="475614" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="475614" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="475614" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L8_EP0TP3PP1DP0_GPU28 -->
<g id="node2317" class="node">
<title>attn_ar_L8_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="475826" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="475826" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="475826" y="-49.5" font-family="Arial" font-size="10.00">L8 EP0 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="475826" y="-38.5" font-family="Arial" font-size="10.00">GPU28</text>
</g>
<!-- residual1_L8_EP0TP3PP1DP0_GPU28 -->
<g id="node2318" class="node">
<title>residual1_L8_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="476111,-78 475965,-78 475965,-26 476111,-26 476111,-78"/>
<text text-anchor="middle" x="476038" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="476038" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="476038" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="476038" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L8_EP0TP3PP1DP0_GPU28 -->
<g id="node2319" class="node">
<title>ln2_L8_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="476292.5,-78 476147.5,-78 476147.5,-26 476292.5,-26 476292.5,-78"/>
<text text-anchor="middle" x="476220" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="476220" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="476220" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="476220" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L8_EP0TP3PP1DP0_GPU28 -->
<g id="node2320" class="node">
<title>gate_L8_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightyellow" stroke="black" points="476629.16,-104 476390.29,-104 476328.84,0 476567.71,0 476629.16,-104"/>
<text text-anchor="middle" x="476479" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="476479" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="476479" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="476479" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L8_EP0TP3PP1DP0_GPU28 -->
<g id="node2321" class="node">
<title>dispatch_L8_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="476768" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="476768" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="476768" y="-44" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP0_GPU28</text>
</g>
<!-- expert_0_L8_EP0TP3PP1DP0_GPU28 -->
<g id="node2322" class="node">
<title>expert_0_L8_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="477051.5,-78 476906.5,-78 476906.5,-26 477051.5,-26 477051.5,-78"/>
<text text-anchor="middle" x="476979" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="476979" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="476979" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="476979" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L8_EP0TP3PP1DP0_GPU28 -->
<g id="node2323" class="node">
<title>expert_1_L8_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="477232.5,-78 477087.5,-78 477087.5,-26 477232.5,-26 477232.5,-78"/>
<text text-anchor="middle" x="477160" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="477160" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="477160" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="477160" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L8_EP0TP3PP1DP0_GPU28 -->
<g id="node2324" class="node">
<title>expert_2_L8_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="477413.5,-78 477268.5,-78 477268.5,-26 477413.5,-26 477413.5,-78"/>
<text text-anchor="middle" x="477341" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="477341" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="477341" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="477341" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L8_EP0TP3PP1DP0_GPU28 -->
<g id="node2325" class="node">
<title>expert_3_L8_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="477594.5,-78 477449.5,-78 477449.5,-26 477594.5,-26 477594.5,-78"/>
<text text-anchor="middle" x="477522" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="477522" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="477522" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="477522" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L8_EP0TP3PP1DP0_GPU28 -->
<g id="node2326" class="node">
<title>combine_L8_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="477733" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="477733" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="477733" y="-44" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP0_GPU28</text>
</g>
<!-- ffn_L8_EP0TP3PP1DP0_GPU28 -->
<g id="node2327" class="node">
<title>ffn_L8_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="478042,-78 477872,-78 477872,-26 478042,-26 478042,-78"/>
<text text-anchor="middle" x="477957" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="477957" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="477957" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="477957" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L8_EP0TP3PP1DP0_GPU28 -->
<g id="node2328" class="node">
<title>ffn_ar_L8_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="478181" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="478181" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="478181" y="-49.5" font-family="Arial" font-size="10.00">L8 EP0 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="478181" y="-38.5" font-family="Arial" font-size="10.00">GPU28</text>
</g>
<!-- residual2_L8_EP0TP3PP1DP0_GPU28 -->
<g id="node2329" class="node">
<title>residual2_L8_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="478466,-78 478320,-78 478320,-26 478466,-26 478466,-78"/>
<text text-anchor="middle" x="478393" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="478393" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="478393" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="478393" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L8_EP0TP3PP1DP1_GPU29 -->
<g id="node2330" class="node">
<title>ln1_L8_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="478647.5,-78 478502.5,-78 478502.5,-26 478647.5,-26 478647.5,-78"/>
<text text-anchor="middle" x="478575" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="478575" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="478575" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="478575" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L8_EP0TP3PP1DP1_GPU29 -->
<g id="node2331" class="node">
<title>qkv_L8_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="478828.5,-78 478683.5,-78 478683.5,-26 478828.5,-26 478828.5,-78"/>
<text text-anchor="middle" x="478756" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="478756" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="478756" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="478756" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L8_EP0TP3PP1DP1_GPU29 -->
<g id="node2332" class="node">
<title>attn_L8_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="479015.5,-78 478864.5,-78 478864.5,-26 479015.5,-26 479015.5,-78"/>
<text text-anchor="middle" x="478940" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="478940" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="478940" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="478940" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L8_EP0TP3PP1DP1_GPU29 -->
<g id="node2333" class="node">
<title>attn_out_L8_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="479196.5,-78 479051.5,-78 479051.5,-26 479196.5,-26 479196.5,-78"/>
<text text-anchor="middle" x="479124" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="479124" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="479124" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="479124" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L8_EP0TP3PP1DP1_GPU29 -->
<g id="node2334" class="node">
<title>attn_ar_L8_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="479336" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="479336" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="479336" y="-49.5" font-family="Arial" font-size="10.00">L8 EP0 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="479336" y="-38.5" font-family="Arial" font-size="10.00">GPU29</text>
</g>
<!-- residual1_L8_EP0TP3PP1DP1_GPU29 -->
<g id="node2335" class="node">
<title>residual1_L8_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="479621,-78 479475,-78 479475,-26 479621,-26 479621,-78"/>
<text text-anchor="middle" x="479548" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="479548" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="479548" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="479548" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L8_EP0TP3PP1DP1_GPU29 -->
<g id="node2336" class="node">
<title>ln2_L8_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="479802.5,-78 479657.5,-78 479657.5,-26 479802.5,-26 479802.5,-78"/>
<text text-anchor="middle" x="479730" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="479730" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="479730" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="479730" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L8_EP0TP3PP1DP1_GPU29 -->
<g id="node2337" class="node">
<title>gate_L8_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightyellow" stroke="black" points="480139.16,-104 479900.29,-104 479838.84,0 480077.71,0 480139.16,-104"/>
<text text-anchor="middle" x="479989" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="479989" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="479989" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="479989" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L8_EP0TP3PP1DP1_GPU29 -->
<g id="node2338" class="node">
<title>dispatch_L8_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="480278" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="480278" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="480278" y="-44" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP1_GPU29</text>
</g>
<!-- expert_0_L8_EP0TP3PP1DP1_GPU29 -->
<g id="node2339" class="node">
<title>expert_0_L8_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="480561.5,-78 480416.5,-78 480416.5,-26 480561.5,-26 480561.5,-78"/>
<text text-anchor="middle" x="480489" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="480489" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="480489" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="480489" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L8_EP0TP3PP1DP1_GPU29 -->
<g id="node2340" class="node">
<title>expert_1_L8_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="480742.5,-78 480597.5,-78 480597.5,-26 480742.5,-26 480742.5,-78"/>
<text text-anchor="middle" x="480670" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="480670" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="480670" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="480670" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L8_EP0TP3PP1DP1_GPU29 -->
<g id="node2341" class="node">
<title>expert_2_L8_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="480923.5,-78 480778.5,-78 480778.5,-26 480923.5,-26 480923.5,-78"/>
<text text-anchor="middle" x="480851" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="480851" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="480851" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="480851" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L8_EP0TP3PP1DP1_GPU29 -->
<g id="node2342" class="node">
<title>expert_3_L8_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="481104.5,-78 480959.5,-78 480959.5,-26 481104.5,-26 481104.5,-78"/>
<text text-anchor="middle" x="481032" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="481032" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="481032" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="481032" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L8_EP0TP3PP1DP1_GPU29 -->
<g id="node2343" class="node">
<title>combine_L8_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="481243" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="481243" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="481243" y="-44" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP1_GPU29</text>
</g>
<!-- ffn_L8_EP0TP3PP1DP1_GPU29 -->
<g id="node2344" class="node">
<title>ffn_L8_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="481552,-78 481382,-78 481382,-26 481552,-26 481552,-78"/>
<text text-anchor="middle" x="481467" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="481467" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="481467" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="481467" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L8_EP0TP3PP1DP1_GPU29 -->
<g id="node2345" class="node">
<title>ffn_ar_L8_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="481691" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="481691" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="481691" y="-49.5" font-family="Arial" font-size="10.00">L8 EP0 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="481691" y="-38.5" font-family="Arial" font-size="10.00">GPU29</text>
</g>
<!-- residual2_L8_EP0TP3PP1DP1_GPU29 -->
<g id="node2346" class="node">
<title>residual2_L8_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="481976,-78 481830,-78 481830,-26 481976,-26 481976,-78"/>
<text text-anchor="middle" x="481903" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="481903" y="-55" font-family="Arial" font-size="10.00">L8_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="481903" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="481903" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L8_EP1TP0PP1DP0_GPU36 -->
<g id="node2347" class="node">
<title>ln1_L8_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="482157.5,-78 482012.5,-78 482012.5,-26 482157.5,-26 482157.5,-78"/>
<text text-anchor="middle" x="482085" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="482085" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="482085" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="482085" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L8_EP1TP0PP1DP0_GPU36 -->
<g id="node2348" class="node">
<title>qkv_L8_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="482338.5,-78 482193.5,-78 482193.5,-26 482338.5,-26 482338.5,-78"/>
<text text-anchor="middle" x="482266" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="482266" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="482266" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="482266" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L8_EP1TP0PP1DP0_GPU36 -->
<g id="node2349" class="node">
<title>attn_L8_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="482525.5,-78 482374.5,-78 482374.5,-26 482525.5,-26 482525.5,-78"/>
<text text-anchor="middle" x="482450" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="482450" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="482450" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="482450" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L8_EP1TP0PP1DP0_GPU36 -->
<g id="node2350" class="node">
<title>attn_out_L8_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="482706.5,-78 482561.5,-78 482561.5,-26 482706.5,-26 482706.5,-78"/>
<text text-anchor="middle" x="482634" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="482634" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="482634" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="482634" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L8_EP1TP0PP1DP0_GPU36 -->
<g id="node2351" class="node">
<title>attn_ar_L8_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="482846" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="482846" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="482846" y="-49.5" font-family="Arial" font-size="10.00">L8 EP1 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="482846" y="-38.5" font-family="Arial" font-size="10.00">GPU36</text>
</g>
<!-- residual1_L8_EP1TP0PP1DP0_GPU36 -->
<g id="node2352" class="node">
<title>residual1_L8_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="483131,-78 482985,-78 482985,-26 483131,-26 483131,-78"/>
<text text-anchor="middle" x="483058" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="483058" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="483058" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="483058" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L8_EP1TP0PP1DP0_GPU36 -->
<g id="node2353" class="node">
<title>ln2_L8_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="483312.5,-78 483167.5,-78 483167.5,-26 483312.5,-26 483312.5,-78"/>
<text text-anchor="middle" x="483240" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="483240" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="483240" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="483240" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L8_EP1TP0PP1DP0_GPU36 -->
<g id="node2354" class="node">
<title>gate_L8_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightyellow" stroke="black" points="483649.16,-104 483410.29,-104 483348.84,0 483587.71,0 483649.16,-104"/>
<text text-anchor="middle" x="483499" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="483499" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="483499" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="483499" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L8_EP1TP0PP1DP0_GPU36 -->
<g id="node2355" class="node">
<title>dispatch_L8_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="483788" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="483788" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="483788" y="-44" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP0_GPU36</text>
</g>
<!-- expert_0_L8_EP1TP0PP1DP0_GPU36 -->
<g id="node2356" class="node">
<title>expert_0_L8_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="484071.5,-78 483926.5,-78 483926.5,-26 484071.5,-26 484071.5,-78"/>
<text text-anchor="middle" x="483999" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="483999" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="483999" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="483999" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L8_EP1TP0PP1DP0_GPU36 -->
<g id="node2357" class="node">
<title>expert_1_L8_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="484252.5,-78 484107.5,-78 484107.5,-26 484252.5,-26 484252.5,-78"/>
<text text-anchor="middle" x="484180" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="484180" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="484180" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="484180" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L8_EP1TP0PP1DP0_GPU36 -->
<g id="node2358" class="node">
<title>expert_2_L8_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="484433.5,-78 484288.5,-78 484288.5,-26 484433.5,-26 484433.5,-78"/>
<text text-anchor="middle" x="484361" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="484361" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="484361" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="484361" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L8_EP1TP0PP1DP0_GPU36 -->
<g id="node2359" class="node">
<title>expert_3_L8_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="484614.5,-78 484469.5,-78 484469.5,-26 484614.5,-26 484614.5,-78"/>
<text text-anchor="middle" x="484542" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="484542" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="484542" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="484542" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L8_EP1TP0PP1DP0_GPU36 -->
<g id="node2360" class="node">
<title>combine_L8_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="484753" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="484753" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="484753" y="-44" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP0_GPU36</text>
</g>
<!-- ffn_L8_EP1TP0PP1DP0_GPU36 -->
<g id="node2361" class="node">
<title>ffn_L8_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="485062,-78 484892,-78 484892,-26 485062,-26 485062,-78"/>
<text text-anchor="middle" x="484977" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="484977" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="484977" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="484977" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L8_EP1TP0PP1DP0_GPU36 -->
<g id="node2362" class="node">
<title>ffn_ar_L8_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="485201" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="485201" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="485201" y="-49.5" font-family="Arial" font-size="10.00">L8 EP1 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="485201" y="-38.5" font-family="Arial" font-size="10.00">GPU36</text>
</g>
<!-- residual2_L8_EP1TP0PP1DP0_GPU36 -->
<g id="node2363" class="node">
<title>residual2_L8_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="485486,-78 485340,-78 485340,-26 485486,-26 485486,-78"/>
<text text-anchor="middle" x="485413" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="485413" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="485413" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="485413" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L8_EP1TP0PP1DP1_GPU37 -->
<g id="node2364" class="node">
<title>ln1_L8_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="485667.5,-78 485522.5,-78 485522.5,-26 485667.5,-26 485667.5,-78"/>
<text text-anchor="middle" x="485595" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="485595" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="485595" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="485595" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L8_EP1TP0PP1DP1_GPU37 -->
<g id="node2365" class="node">
<title>qkv_L8_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="485848.5,-78 485703.5,-78 485703.5,-26 485848.5,-26 485848.5,-78"/>
<text text-anchor="middle" x="485776" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="485776" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="485776" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="485776" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L8_EP1TP0PP1DP1_GPU37 -->
<g id="node2366" class="node">
<title>attn_L8_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="486035.5,-78 485884.5,-78 485884.5,-26 486035.5,-26 486035.5,-78"/>
<text text-anchor="middle" x="485960" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="485960" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="485960" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="485960" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L8_EP1TP0PP1DP1_GPU37 -->
<g id="node2367" class="node">
<title>attn_out_L8_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="486216.5,-78 486071.5,-78 486071.5,-26 486216.5,-26 486216.5,-78"/>
<text text-anchor="middle" x="486144" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="486144" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="486144" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="486144" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L8_EP1TP0PP1DP1_GPU37 -->
<g id="node2368" class="node">
<title>attn_ar_L8_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="486356" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="486356" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="486356" y="-49.5" font-family="Arial" font-size="10.00">L8 EP1 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="486356" y="-38.5" font-family="Arial" font-size="10.00">GPU37</text>
</g>
<!-- residual1_L8_EP1TP0PP1DP1_GPU37 -->
<g id="node2369" class="node">
<title>residual1_L8_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="486641,-78 486495,-78 486495,-26 486641,-26 486641,-78"/>
<text text-anchor="middle" x="486568" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="486568" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="486568" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="486568" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L8_EP1TP0PP1DP1_GPU37 -->
<g id="node2370" class="node">
<title>ln2_L8_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="486822.5,-78 486677.5,-78 486677.5,-26 486822.5,-26 486822.5,-78"/>
<text text-anchor="middle" x="486750" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="486750" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="486750" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="486750" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L8_EP1TP0PP1DP1_GPU37 -->
<g id="node2371" class="node">
<title>gate_L8_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightyellow" stroke="black" points="487159.16,-104 486920.29,-104 486858.84,0 487097.71,0 487159.16,-104"/>
<text text-anchor="middle" x="487009" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="487009" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="487009" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="487009" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L8_EP1TP0PP1DP1_GPU37 -->
<g id="node2372" class="node">
<title>dispatch_L8_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="487298" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="487298" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="487298" y="-44" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP1_GPU37</text>
</g>
<!-- expert_0_L8_EP1TP0PP1DP1_GPU37 -->
<g id="node2373" class="node">
<title>expert_0_L8_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="487581.5,-78 487436.5,-78 487436.5,-26 487581.5,-26 487581.5,-78"/>
<text text-anchor="middle" x="487509" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="487509" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="487509" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="487509" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L8_EP1TP0PP1DP1_GPU37 -->
<g id="node2374" class="node">
<title>expert_1_L8_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="487762.5,-78 487617.5,-78 487617.5,-26 487762.5,-26 487762.5,-78"/>
<text text-anchor="middle" x="487690" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="487690" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="487690" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="487690" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L8_EP1TP0PP1DP1_GPU37 -->
<g id="node2375" class="node">
<title>expert_2_L8_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="487943.5,-78 487798.5,-78 487798.5,-26 487943.5,-26 487943.5,-78"/>
<text text-anchor="middle" x="487871" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="487871" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="487871" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="487871" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L8_EP1TP0PP1DP1_GPU37 -->
<g id="node2376" class="node">
<title>expert_3_L8_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="488124.5,-78 487979.5,-78 487979.5,-26 488124.5,-26 488124.5,-78"/>
<text text-anchor="middle" x="488052" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="488052" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="488052" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="488052" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L8_EP1TP0PP1DP1_GPU37 -->
<g id="node2377" class="node">
<title>combine_L8_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="488263" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="488263" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="488263" y="-44" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP1_GPU37</text>
</g>
<!-- ffn_L8_EP1TP0PP1DP1_GPU37 -->
<g id="node2378" class="node">
<title>ffn_L8_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="488572,-78 488402,-78 488402,-26 488572,-26 488572,-78"/>
<text text-anchor="middle" x="488487" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="488487" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="488487" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="488487" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L8_EP1TP0PP1DP1_GPU37 -->
<g id="node2379" class="node">
<title>ffn_ar_L8_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="488711" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="488711" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="488711" y="-49.5" font-family="Arial" font-size="10.00">L8 EP1 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="488711" y="-38.5" font-family="Arial" font-size="10.00">GPU37</text>
</g>
<!-- residual2_L8_EP1TP0PP1DP1_GPU37 -->
<g id="node2380" class="node">
<title>residual2_L8_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="488996,-78 488850,-78 488850,-26 488996,-26 488996,-78"/>
<text text-anchor="middle" x="488923" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="488923" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="488923" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="488923" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L8_EP1TP1PP1DP0_GPU44 -->
<g id="node2381" class="node">
<title>ln1_L8_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="489177.5,-78 489032.5,-78 489032.5,-26 489177.5,-26 489177.5,-78"/>
<text text-anchor="middle" x="489105" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="489105" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="489105" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="489105" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L8_EP1TP1PP1DP0_GPU44 -->
<g id="node2382" class="node">
<title>qkv_L8_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="489358.5,-78 489213.5,-78 489213.5,-26 489358.5,-26 489358.5,-78"/>
<text text-anchor="middle" x="489286" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="489286" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="489286" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="489286" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L8_EP1TP1PP1DP0_GPU44 -->
<g id="node2383" class="node">
<title>attn_L8_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="489545.5,-78 489394.5,-78 489394.5,-26 489545.5,-26 489545.5,-78"/>
<text text-anchor="middle" x="489470" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="489470" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="489470" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="489470" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L8_EP1TP1PP1DP0_GPU44 -->
<g id="node2384" class="node">
<title>attn_out_L8_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="489726.5,-78 489581.5,-78 489581.5,-26 489726.5,-26 489726.5,-78"/>
<text text-anchor="middle" x="489654" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="489654" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="489654" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="489654" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L8_EP1TP1PP1DP0_GPU44 -->
<g id="node2385" class="node">
<title>attn_ar_L8_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="489866" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="489866" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="489866" y="-49.5" font-family="Arial" font-size="10.00">L8 EP1 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="489866" y="-38.5" font-family="Arial" font-size="10.00">GPU44</text>
</g>
<!-- residual1_L8_EP1TP1PP1DP0_GPU44 -->
<g id="node2386" class="node">
<title>residual1_L8_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="490151,-78 490005,-78 490005,-26 490151,-26 490151,-78"/>
<text text-anchor="middle" x="490078" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="490078" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="490078" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="490078" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L8_EP1TP1PP1DP0_GPU44 -->
<g id="node2387" class="node">
<title>ln2_L8_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="490332.5,-78 490187.5,-78 490187.5,-26 490332.5,-26 490332.5,-78"/>
<text text-anchor="middle" x="490260" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="490260" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="490260" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="490260" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L8_EP1TP1PP1DP0_GPU44 -->
<g id="node2388" class="node">
<title>gate_L8_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightyellow" stroke="black" points="490669.16,-104 490430.29,-104 490368.84,0 490607.71,0 490669.16,-104"/>
<text text-anchor="middle" x="490519" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="490519" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="490519" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="490519" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L8_EP1TP1PP1DP0_GPU44 -->
<g id="node2389" class="node">
<title>dispatch_L8_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="490808" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="490808" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="490808" y="-44" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP0_GPU44</text>
</g>
<!-- expert_0_L8_EP1TP1PP1DP0_GPU44 -->
<g id="node2390" class="node">
<title>expert_0_L8_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="491091.5,-78 490946.5,-78 490946.5,-26 491091.5,-26 491091.5,-78"/>
<text text-anchor="middle" x="491019" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="491019" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="491019" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="491019" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L8_EP1TP1PP1DP0_GPU44 -->
<g id="node2391" class="node">
<title>expert_1_L8_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="491272.5,-78 491127.5,-78 491127.5,-26 491272.5,-26 491272.5,-78"/>
<text text-anchor="middle" x="491200" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="491200" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="491200" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="491200" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L8_EP1TP1PP1DP0_GPU44 -->
<g id="node2392" class="node">
<title>expert_2_L8_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="491453.5,-78 491308.5,-78 491308.5,-26 491453.5,-26 491453.5,-78"/>
<text text-anchor="middle" x="491381" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="491381" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="491381" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="491381" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L8_EP1TP1PP1DP0_GPU44 -->
<g id="node2393" class="node">
<title>expert_3_L8_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="491634.5,-78 491489.5,-78 491489.5,-26 491634.5,-26 491634.5,-78"/>
<text text-anchor="middle" x="491562" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="491562" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="491562" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="491562" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L8_EP1TP1PP1DP0_GPU44 -->
<g id="node2394" class="node">
<title>combine_L8_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="491773" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="491773" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="491773" y="-44" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP0_GPU44</text>
</g>
<!-- ffn_L8_EP1TP1PP1DP0_GPU44 -->
<g id="node2395" class="node">
<title>ffn_L8_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="492082,-78 491912,-78 491912,-26 492082,-26 492082,-78"/>
<text text-anchor="middle" x="491997" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="491997" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="491997" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="491997" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L8_EP1TP1PP1DP0_GPU44 -->
<g id="node2396" class="node">
<title>ffn_ar_L8_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="492221" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="492221" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="492221" y="-49.5" font-family="Arial" font-size="10.00">L8 EP1 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="492221" y="-38.5" font-family="Arial" font-size="10.00">GPU44</text>
</g>
<!-- residual2_L8_EP1TP1PP1DP0_GPU44 -->
<g id="node2397" class="node">
<title>residual2_L8_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="492506,-78 492360,-78 492360,-26 492506,-26 492506,-78"/>
<text text-anchor="middle" x="492433" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="492433" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="492433" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="492433" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L8_EP1TP1PP1DP1_GPU45 -->
<g id="node2398" class="node">
<title>ln1_L8_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="492687.5,-78 492542.5,-78 492542.5,-26 492687.5,-26 492687.5,-78"/>
<text text-anchor="middle" x="492615" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="492615" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="492615" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="492615" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L8_EP1TP1PP1DP1_GPU45 -->
<g id="node2399" class="node">
<title>qkv_L8_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="492868.5,-78 492723.5,-78 492723.5,-26 492868.5,-26 492868.5,-78"/>
<text text-anchor="middle" x="492796" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="492796" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="492796" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="492796" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L8_EP1TP1PP1DP1_GPU45 -->
<g id="node2400" class="node">
<title>attn_L8_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="493055.5,-78 492904.5,-78 492904.5,-26 493055.5,-26 493055.5,-78"/>
<text text-anchor="middle" x="492980" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="492980" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="492980" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="492980" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L8_EP1TP1PP1DP1_GPU45 -->
<g id="node2401" class="node">
<title>attn_out_L8_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="493236.5,-78 493091.5,-78 493091.5,-26 493236.5,-26 493236.5,-78"/>
<text text-anchor="middle" x="493164" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="493164" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="493164" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="493164" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L8_EP1TP1PP1DP1_GPU45 -->
<g id="node2402" class="node">
<title>attn_ar_L8_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="493376" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="493376" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="493376" y="-49.5" font-family="Arial" font-size="10.00">L8 EP1 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="493376" y="-38.5" font-family="Arial" font-size="10.00">GPU45</text>
</g>
<!-- residual1_L8_EP1TP1PP1DP1_GPU45 -->
<g id="node2403" class="node">
<title>residual1_L8_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="493661,-78 493515,-78 493515,-26 493661,-26 493661,-78"/>
<text text-anchor="middle" x="493588" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="493588" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="493588" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="493588" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L8_EP1TP1PP1DP1_GPU45 -->
<g id="node2404" class="node">
<title>ln2_L8_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="493842.5,-78 493697.5,-78 493697.5,-26 493842.5,-26 493842.5,-78"/>
<text text-anchor="middle" x="493770" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="493770" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="493770" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="493770" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L8_EP1TP1PP1DP1_GPU45 -->
<g id="node2405" class="node">
<title>gate_L8_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightyellow" stroke="black" points="494179.16,-104 493940.29,-104 493878.84,0 494117.71,0 494179.16,-104"/>
<text text-anchor="middle" x="494029" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="494029" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="494029" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="494029" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L8_EP1TP1PP1DP1_GPU45 -->
<g id="node2406" class="node">
<title>dispatch_L8_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="494318" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="494318" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="494318" y="-44" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP1_GPU45</text>
</g>
<!-- expert_0_L8_EP1TP1PP1DP1_GPU45 -->
<g id="node2407" class="node">
<title>expert_0_L8_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="494601.5,-78 494456.5,-78 494456.5,-26 494601.5,-26 494601.5,-78"/>
<text text-anchor="middle" x="494529" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="494529" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="494529" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="494529" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L8_EP1TP1PP1DP1_GPU45 -->
<g id="node2408" class="node">
<title>expert_1_L8_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="494782.5,-78 494637.5,-78 494637.5,-26 494782.5,-26 494782.5,-78"/>
<text text-anchor="middle" x="494710" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="494710" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="494710" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="494710" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L8_EP1TP1PP1DP1_GPU45 -->
<g id="node2409" class="node">
<title>expert_2_L8_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="494963.5,-78 494818.5,-78 494818.5,-26 494963.5,-26 494963.5,-78"/>
<text text-anchor="middle" x="494891" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="494891" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="494891" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="494891" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L8_EP1TP1PP1DP1_GPU45 -->
<g id="node2410" class="node">
<title>expert_3_L8_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="495144.5,-78 494999.5,-78 494999.5,-26 495144.5,-26 495144.5,-78"/>
<text text-anchor="middle" x="495072" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="495072" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="495072" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="495072" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L8_EP1TP1PP1DP1_GPU45 -->
<g id="node2411" class="node">
<title>combine_L8_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="495283" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="495283" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="495283" y="-44" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP1_GPU45</text>
</g>
<!-- ffn_L8_EP1TP1PP1DP1_GPU45 -->
<g id="node2412" class="node">
<title>ffn_L8_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="495592,-78 495422,-78 495422,-26 495592,-26 495592,-78"/>
<text text-anchor="middle" x="495507" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="495507" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="495507" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="495507" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L8_EP1TP1PP1DP1_GPU45 -->
<g id="node2413" class="node">
<title>ffn_ar_L8_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="495731" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="495731" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="495731" y="-49.5" font-family="Arial" font-size="10.00">L8 EP1 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="495731" y="-38.5" font-family="Arial" font-size="10.00">GPU45</text>
</g>
<!-- residual2_L8_EP1TP1PP1DP1_GPU45 -->
<g id="node2414" class="node">
<title>residual2_L8_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="496016,-78 495870,-78 495870,-26 496016,-26 496016,-78"/>
<text text-anchor="middle" x="495943" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="495943" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="495943" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="495943" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L8_EP1TP2PP1DP0_GPU52 -->
<g id="node2415" class="node">
<title>ln1_L8_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="496197.5,-78 496052.5,-78 496052.5,-26 496197.5,-26 496197.5,-78"/>
<text text-anchor="middle" x="496125" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="496125" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="496125" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="496125" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L8_EP1TP2PP1DP0_GPU52 -->
<g id="node2416" class="node">
<title>qkv_L8_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="496378.5,-78 496233.5,-78 496233.5,-26 496378.5,-26 496378.5,-78"/>
<text text-anchor="middle" x="496306" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="496306" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="496306" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="496306" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L8_EP1TP2PP1DP0_GPU52 -->
<g id="node2417" class="node">
<title>attn_L8_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="496565.5,-78 496414.5,-78 496414.5,-26 496565.5,-26 496565.5,-78"/>
<text text-anchor="middle" x="496490" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="496490" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="496490" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="496490" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L8_EP1TP2PP1DP0_GPU52 -->
<g id="node2418" class="node">
<title>attn_out_L8_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="496746.5,-78 496601.5,-78 496601.5,-26 496746.5,-26 496746.5,-78"/>
<text text-anchor="middle" x="496674" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="496674" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="496674" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="496674" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L8_EP1TP2PP1DP0_GPU52 -->
<g id="node2419" class="node">
<title>attn_ar_L8_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="496886" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="496886" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="496886" y="-49.5" font-family="Arial" font-size="10.00">L8 EP1 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="496886" y="-38.5" font-family="Arial" font-size="10.00">GPU52</text>
</g>
<!-- residual1_L8_EP1TP2PP1DP0_GPU52 -->
<g id="node2420" class="node">
<title>residual1_L8_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="497171,-78 497025,-78 497025,-26 497171,-26 497171,-78"/>
<text text-anchor="middle" x="497098" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="497098" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="497098" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="497098" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L8_EP1TP2PP1DP0_GPU52 -->
<g id="node2421" class="node">
<title>ln2_L8_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="497352.5,-78 497207.5,-78 497207.5,-26 497352.5,-26 497352.5,-78"/>
<text text-anchor="middle" x="497280" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="497280" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="497280" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="497280" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L8_EP1TP2PP1DP0_GPU52 -->
<g id="node2422" class="node">
<title>gate_L8_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightyellow" stroke="black" points="497689.16,-104 497450.29,-104 497388.84,0 497627.71,0 497689.16,-104"/>
<text text-anchor="middle" x="497539" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="497539" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="497539" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="497539" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L8_EP1TP2PP1DP0_GPU52 -->
<g id="node2423" class="node">
<title>dispatch_L8_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="497828" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="497828" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="497828" y="-44" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP0_GPU52</text>
</g>
<!-- expert_0_L8_EP1TP2PP1DP0_GPU52 -->
<g id="node2424" class="node">
<title>expert_0_L8_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="498111.5,-78 497966.5,-78 497966.5,-26 498111.5,-26 498111.5,-78"/>
<text text-anchor="middle" x="498039" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="498039" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="498039" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="498039" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L8_EP1TP2PP1DP0_GPU52 -->
<g id="node2425" class="node">
<title>expert_1_L8_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="498292.5,-78 498147.5,-78 498147.5,-26 498292.5,-26 498292.5,-78"/>
<text text-anchor="middle" x="498220" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="498220" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="498220" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="498220" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L8_EP1TP2PP1DP0_GPU52 -->
<g id="node2426" class="node">
<title>expert_2_L8_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="498473.5,-78 498328.5,-78 498328.5,-26 498473.5,-26 498473.5,-78"/>
<text text-anchor="middle" x="498401" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="498401" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="498401" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="498401" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L8_EP1TP2PP1DP0_GPU52 -->
<g id="node2427" class="node">
<title>expert_3_L8_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="498654.5,-78 498509.5,-78 498509.5,-26 498654.5,-26 498654.5,-78"/>
<text text-anchor="middle" x="498582" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="498582" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="498582" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="498582" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L8_EP1TP2PP1DP0_GPU52 -->
<g id="node2428" class="node">
<title>combine_L8_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="498793" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="498793" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="498793" y="-44" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP0_GPU52</text>
</g>
<!-- ffn_L8_EP1TP2PP1DP0_GPU52 -->
<g id="node2429" class="node">
<title>ffn_L8_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="499102,-78 498932,-78 498932,-26 499102,-26 499102,-78"/>
<text text-anchor="middle" x="499017" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="499017" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="499017" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="499017" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L8_EP1TP2PP1DP0_GPU52 -->
<g id="node2430" class="node">
<title>ffn_ar_L8_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="499241" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="499241" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="499241" y="-49.5" font-family="Arial" font-size="10.00">L8 EP1 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="499241" y="-38.5" font-family="Arial" font-size="10.00">GPU52</text>
</g>
<!-- residual2_L8_EP1TP2PP1DP0_GPU52 -->
<g id="node2431" class="node">
<title>residual2_L8_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="499526,-78 499380,-78 499380,-26 499526,-26 499526,-78"/>
<text text-anchor="middle" x="499453" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="499453" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="499453" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="499453" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L8_EP1TP2PP1DP1_GPU53 -->
<g id="node2432" class="node">
<title>ln1_L8_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="499707.5,-78 499562.5,-78 499562.5,-26 499707.5,-26 499707.5,-78"/>
<text text-anchor="middle" x="499635" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="499635" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="499635" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="499635" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L8_EP1TP2PP1DP1_GPU53 -->
<g id="node2433" class="node">
<title>qkv_L8_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="499888.5,-78 499743.5,-78 499743.5,-26 499888.5,-26 499888.5,-78"/>
<text text-anchor="middle" x="499816" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="499816" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="499816" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="499816" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L8_EP1TP2PP1DP1_GPU53 -->
<g id="node2434" class="node">
<title>attn_L8_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="500075.5,-78 499924.5,-78 499924.5,-26 500075.5,-26 500075.5,-78"/>
<text text-anchor="middle" x="500000" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="500000" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="500000" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="500000" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L8_EP1TP2PP1DP1_GPU53 -->
<g id="node2435" class="node">
<title>attn_out_L8_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="500256.5,-78 500111.5,-78 500111.5,-26 500256.5,-26 500256.5,-78"/>
<text text-anchor="middle" x="500184" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="500184" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="500184" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="500184" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L8_EP1TP2PP1DP1_GPU53 -->
<g id="node2436" class="node">
<title>attn_ar_L8_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="500396" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="500396" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="500396" y="-49.5" font-family="Arial" font-size="10.00">L8 EP1 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="500396" y="-38.5" font-family="Arial" font-size="10.00">GPU53</text>
</g>
<!-- residual1_L8_EP1TP2PP1DP1_GPU53 -->
<g id="node2437" class="node">
<title>residual1_L8_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="500681,-78 500535,-78 500535,-26 500681,-26 500681,-78"/>
<text text-anchor="middle" x="500608" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="500608" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="500608" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="500608" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L8_EP1TP2PP1DP1_GPU53 -->
<g id="node2438" class="node">
<title>ln2_L8_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="500862.5,-78 500717.5,-78 500717.5,-26 500862.5,-26 500862.5,-78"/>
<text text-anchor="middle" x="500790" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="500790" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="500790" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="500790" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L8_EP1TP2PP1DP1_GPU53 -->
<g id="node2439" class="node">
<title>gate_L8_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightyellow" stroke="black" points="501199.16,-104 500960.29,-104 500898.84,0 501137.71,0 501199.16,-104"/>
<text text-anchor="middle" x="501049" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="501049" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="501049" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="501049" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L8_EP1TP2PP1DP1_GPU53 -->
<g id="node2440" class="node">
<title>dispatch_L8_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="501338" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="501338" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="501338" y="-44" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP1_GPU53</text>
</g>
<!-- expert_0_L8_EP1TP2PP1DP1_GPU53 -->
<g id="node2441" class="node">
<title>expert_0_L8_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="501621.5,-78 501476.5,-78 501476.5,-26 501621.5,-26 501621.5,-78"/>
<text text-anchor="middle" x="501549" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="501549" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="501549" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="501549" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L8_EP1TP2PP1DP1_GPU53 -->
<g id="node2442" class="node">
<title>expert_1_L8_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="501802.5,-78 501657.5,-78 501657.5,-26 501802.5,-26 501802.5,-78"/>
<text text-anchor="middle" x="501730" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="501730" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="501730" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="501730" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L8_EP1TP2PP1DP1_GPU53 -->
<g id="node2443" class="node">
<title>expert_2_L8_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="501983.5,-78 501838.5,-78 501838.5,-26 501983.5,-26 501983.5,-78"/>
<text text-anchor="middle" x="501911" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="501911" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="501911" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="501911" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L8_EP1TP2PP1DP1_GPU53 -->
<g id="node2444" class="node">
<title>expert_3_L8_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="502164.5,-78 502019.5,-78 502019.5,-26 502164.5,-26 502164.5,-78"/>
<text text-anchor="middle" x="502092" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="502092" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="502092" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="502092" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L8_EP1TP2PP1DP1_GPU53 -->
<g id="node2445" class="node">
<title>combine_L8_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="502303" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="502303" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="502303" y="-44" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP1_GPU53</text>
</g>
<!-- ffn_L8_EP1TP2PP1DP1_GPU53 -->
<g id="node2446" class="node">
<title>ffn_L8_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="502612,-78 502442,-78 502442,-26 502612,-26 502612,-78"/>
<text text-anchor="middle" x="502527" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="502527" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="502527" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="502527" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L8_EP1TP2PP1DP1_GPU53 -->
<g id="node2447" class="node">
<title>ffn_ar_L8_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="502751" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="502751" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="502751" y="-49.5" font-family="Arial" font-size="10.00">L8 EP1 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="502751" y="-38.5" font-family="Arial" font-size="10.00">GPU53</text>
</g>
<!-- residual2_L8_EP1TP2PP1DP1_GPU53 -->
<g id="node2448" class="node">
<title>residual2_L8_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="503036,-78 502890,-78 502890,-26 503036,-26 503036,-78"/>
<text text-anchor="middle" x="502963" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="502963" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="502963" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="502963" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L8_EP1TP3PP1DP0_GPU60 -->
<g id="node2449" class="node">
<title>ln1_L8_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="503217.5,-78 503072.5,-78 503072.5,-26 503217.5,-26 503217.5,-78"/>
<text text-anchor="middle" x="503145" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="503145" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="503145" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="503145" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L8_EP1TP3PP1DP0_GPU60 -->
<g id="node2450" class="node">
<title>qkv_L8_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="503398.5,-78 503253.5,-78 503253.5,-26 503398.5,-26 503398.5,-78"/>
<text text-anchor="middle" x="503326" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="503326" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="503326" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="503326" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L8_EP1TP3PP1DP0_GPU60 -->
<g id="node2451" class="node">
<title>attn_L8_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="503585.5,-78 503434.5,-78 503434.5,-26 503585.5,-26 503585.5,-78"/>
<text text-anchor="middle" x="503510" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="503510" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="503510" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="503510" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L8_EP1TP3PP1DP0_GPU60 -->
<g id="node2452" class="node">
<title>attn_out_L8_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="503766.5,-78 503621.5,-78 503621.5,-26 503766.5,-26 503766.5,-78"/>
<text text-anchor="middle" x="503694" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="503694" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="503694" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="503694" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L8_EP1TP3PP1DP0_GPU60 -->
<g id="node2453" class="node">
<title>attn_ar_L8_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="503906" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="503906" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="503906" y="-49.5" font-family="Arial" font-size="10.00">L8 EP1 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="503906" y="-38.5" font-family="Arial" font-size="10.00">GPU60</text>
</g>
<!-- residual1_L8_EP1TP3PP1DP0_GPU60 -->
<g id="node2454" class="node">
<title>residual1_L8_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="504191,-78 504045,-78 504045,-26 504191,-26 504191,-78"/>
<text text-anchor="middle" x="504118" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="504118" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="504118" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="504118" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L8_EP1TP3PP1DP0_GPU60 -->
<g id="node2455" class="node">
<title>ln2_L8_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="504372.5,-78 504227.5,-78 504227.5,-26 504372.5,-26 504372.5,-78"/>
<text text-anchor="middle" x="504300" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="504300" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="504300" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="504300" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L8_EP1TP3PP1DP0_GPU60 -->
<g id="node2456" class="node">
<title>gate_L8_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightyellow" stroke="black" points="504709.16,-104 504470.29,-104 504408.84,0 504647.71,0 504709.16,-104"/>
<text text-anchor="middle" x="504559" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="504559" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="504559" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="504559" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L8_EP1TP3PP1DP0_GPU60 -->
<g id="node2457" class="node">
<title>dispatch_L8_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="504848" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="504848" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="504848" y="-44" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP0_GPU60</text>
</g>
<!-- expert_0_L8_EP1TP3PP1DP0_GPU60 -->
<g id="node2458" class="node">
<title>expert_0_L8_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="505131.5,-78 504986.5,-78 504986.5,-26 505131.5,-26 505131.5,-78"/>
<text text-anchor="middle" x="505059" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="505059" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="505059" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="505059" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L8_EP1TP3PP1DP0_GPU60 -->
<g id="node2459" class="node">
<title>expert_1_L8_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="505312.5,-78 505167.5,-78 505167.5,-26 505312.5,-26 505312.5,-78"/>
<text text-anchor="middle" x="505240" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="505240" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="505240" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="505240" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L8_EP1TP3PP1DP0_GPU60 -->
<g id="node2460" class="node">
<title>expert_2_L8_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="505493.5,-78 505348.5,-78 505348.5,-26 505493.5,-26 505493.5,-78"/>
<text text-anchor="middle" x="505421" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="505421" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="505421" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="505421" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L8_EP1TP3PP1DP0_GPU60 -->
<g id="node2461" class="node">
<title>expert_3_L8_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="505674.5,-78 505529.5,-78 505529.5,-26 505674.5,-26 505674.5,-78"/>
<text text-anchor="middle" x="505602" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="505602" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="505602" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="505602" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L8_EP1TP3PP1DP0_GPU60 -->
<g id="node2462" class="node">
<title>combine_L8_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="505813" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="505813" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="505813" y="-44" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP0_GPU60</text>
</g>
<!-- ffn_L8_EP1TP3PP1DP0_GPU60 -->
<g id="node2463" class="node">
<title>ffn_L8_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="506122,-78 505952,-78 505952,-26 506122,-26 506122,-78"/>
<text text-anchor="middle" x="506037" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="506037" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="506037" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="506037" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L8_EP1TP3PP1DP0_GPU60 -->
<g id="node2464" class="node">
<title>ffn_ar_L8_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="506261" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="506261" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="506261" y="-49.5" font-family="Arial" font-size="10.00">L8 EP1 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="506261" y="-38.5" font-family="Arial" font-size="10.00">GPU60</text>
</g>
<!-- residual2_L8_EP1TP3PP1DP0_GPU60 -->
<g id="node2465" class="node">
<title>residual2_L8_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="506546,-78 506400,-78 506400,-26 506546,-26 506546,-78"/>
<text text-anchor="middle" x="506473" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="506473" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="506473" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="506473" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L8_EP1TP3PP1DP1_GPU61 -->
<g id="node2466" class="node">
<title>ln1_L8_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="506727.5,-78 506582.5,-78 506582.5,-26 506727.5,-26 506727.5,-78"/>
<text text-anchor="middle" x="506655" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="506655" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="506655" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="506655" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L8_EP1TP3PP1DP1_GPU61 -->
<g id="node2467" class="node">
<title>qkv_L8_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="506908.5,-78 506763.5,-78 506763.5,-26 506908.5,-26 506908.5,-78"/>
<text text-anchor="middle" x="506836" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="506836" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="506836" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="506836" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L8_EP1TP3PP1DP1_GPU61 -->
<g id="node2468" class="node">
<title>attn_L8_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="507095.5,-78 506944.5,-78 506944.5,-26 507095.5,-26 507095.5,-78"/>
<text text-anchor="middle" x="507020" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="507020" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="507020" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="507020" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L8_EP1TP3PP1DP1_GPU61 -->
<g id="node2469" class="node">
<title>attn_out_L8_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="507276.5,-78 507131.5,-78 507131.5,-26 507276.5,-26 507276.5,-78"/>
<text text-anchor="middle" x="507204" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="507204" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="507204" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="507204" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L8_EP1TP3PP1DP1_GPU61 -->
<g id="node2470" class="node">
<title>attn_ar_L8_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="507416" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="507416" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="507416" y="-49.5" font-family="Arial" font-size="10.00">L8 EP1 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="507416" y="-38.5" font-family="Arial" font-size="10.00">GPU61</text>
</g>
<!-- residual1_L8_EP1TP3PP1DP1_GPU61 -->
<g id="node2471" class="node">
<title>residual1_L8_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="507701,-78 507555,-78 507555,-26 507701,-26 507701,-78"/>
<text text-anchor="middle" x="507628" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="507628" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="507628" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="507628" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L8_EP1TP3PP1DP1_GPU61 -->
<g id="node2472" class="node">
<title>ln2_L8_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="507882.5,-78 507737.5,-78 507737.5,-26 507882.5,-26 507882.5,-78"/>
<text text-anchor="middle" x="507810" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="507810" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="507810" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="507810" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L8_EP1TP3PP1DP1_GPU61 -->
<g id="node2473" class="node">
<title>gate_L8_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightyellow" stroke="black" points="508219.16,-104 507980.29,-104 507918.84,0 508157.71,0 508219.16,-104"/>
<text text-anchor="middle" x="508069" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="508069" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="508069" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="508069" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L8_EP1TP3PP1DP1_GPU61 -->
<g id="node2474" class="node">
<title>dispatch_L8_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="508358" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="508358" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="508358" y="-44" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP1_GPU61</text>
</g>
<!-- expert_0_L8_EP1TP3PP1DP1_GPU61 -->
<g id="node2475" class="node">
<title>expert_0_L8_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="508641.5,-78 508496.5,-78 508496.5,-26 508641.5,-26 508641.5,-78"/>
<text text-anchor="middle" x="508569" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="508569" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="508569" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="508569" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L8_EP1TP3PP1DP1_GPU61 -->
<g id="node2476" class="node">
<title>expert_1_L8_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="508822.5,-78 508677.5,-78 508677.5,-26 508822.5,-26 508822.5,-78"/>
<text text-anchor="middle" x="508750" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="508750" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="508750" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="508750" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L8_EP1TP3PP1DP1_GPU61 -->
<g id="node2477" class="node">
<title>expert_2_L8_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="509003.5,-78 508858.5,-78 508858.5,-26 509003.5,-26 509003.5,-78"/>
<text text-anchor="middle" x="508931" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="508931" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="508931" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="508931" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L8_EP1TP3PP1DP1_GPU61 -->
<g id="node2478" class="node">
<title>expert_3_L8_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="509184.5,-78 509039.5,-78 509039.5,-26 509184.5,-26 509184.5,-78"/>
<text text-anchor="middle" x="509112" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="509112" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="509112" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="509112" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L8_EP1TP3PP1DP1_GPU61 -->
<g id="node2479" class="node">
<title>combine_L8_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="509323" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="509323" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="509323" y="-44" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP1_GPU61</text>
</g>
<!-- ffn_L8_EP1TP3PP1DP1_GPU61 -->
<g id="node2480" class="node">
<title>ffn_L8_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="509632,-78 509462,-78 509462,-26 509632,-26 509632,-78"/>
<text text-anchor="middle" x="509547" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="509547" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="509547" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="509547" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L8_EP1TP3PP1DP1_GPU61 -->
<g id="node2481" class="node">
<title>ffn_ar_L8_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="509771" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="509771" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="509771" y="-49.5" font-family="Arial" font-size="10.00">L8 EP1 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="509771" y="-38.5" font-family="Arial" font-size="10.00">GPU61</text>
</g>
<!-- residual2_L8_EP1TP3PP1DP1_GPU61 -->
<g id="node2482" class="node">
<title>residual2_L8_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="510056,-78 509910,-78 509910,-26 510056,-26 510056,-78"/>
<text text-anchor="middle" x="509983" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="509983" y="-55" font-family="Arial" font-size="10.00">L8_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="509983" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="509983" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L9_EP0TP0PP1DP0_GPU4 -->
<g id="node2483" class="node">
<title>ln1_L9_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="510234,-78 510092,-78 510092,-26 510234,-26 510234,-78"/>
<text text-anchor="middle" x="510163" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="510163" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="510163" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="510163" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L9_EP0TP0PP1DP0_GPU4 -->
<g id="node2484" class="node">
<title>qkv_L9_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="510412,-78 510270,-78 510270,-26 510412,-26 510412,-78"/>
<text text-anchor="middle" x="510341" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="510341" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="510341" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="510341" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L9_EP0TP0PP1DP0_GPU4 -->
<g id="node2485" class="node">
<title>attn_L9_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="510599.5,-78 510448.5,-78 510448.5,-26 510599.5,-26 510599.5,-78"/>
<text text-anchor="middle" x="510524" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="510524" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="510524" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="510524" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L9_EP0TP0PP1DP0_GPU4 -->
<g id="node2486" class="node">
<title>attn_out_L9_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="510778,-78 510636,-78 510636,-26 510778,-26 510778,-78"/>
<text text-anchor="middle" x="510707" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="510707" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="510707" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="510707" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L9_EP0TP0PP1DP0_GPU4 -->
<g id="node2487" class="node">
<title>attn_ar_L9_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="510917" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="510917" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="510917" y="-49.5" font-family="Arial" font-size="10.00">L9 EP0 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="510917" y="-38.5" font-family="Arial" font-size="10.00">GPU4</text>
</g>
<!-- residual1_L9_EP0TP0PP1DP0_GPU4 -->
<g id="node2488" class="node">
<title>residual1_L9_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="511202,-78 511056,-78 511056,-26 511202,-26 511202,-78"/>
<text text-anchor="middle" x="511129" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="511129" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="511129" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="511129" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L9_EP0TP0PP1DP0_GPU4 -->
<g id="node2489" class="node">
<title>ln2_L9_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="511380,-78 511238,-78 511238,-26 511380,-26 511380,-78"/>
<text text-anchor="middle" x="511309" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="511309" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="511309" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="511309" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L9_EP0TP0PP1DP0_GPU4 -->
<g id="node2490" class="node">
<title>gate_L9_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightyellow" stroke="black" points="511706.29,-104 511475.17,-104 511415.71,0 511646.83,0 511706.29,-104"/>
<text text-anchor="middle" x="511561" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="511561" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="511561" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="511561" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L9_EP0TP0PP1DP0_GPU4 -->
<g id="node2491" class="node">
<title>dispatch_L9_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="511841" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="511841" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="511841" y="-44" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP0_GPU4</text>
</g>
<!-- expert_0_L9_EP0TP0PP1DP0_GPU4 -->
<g id="node2492" class="node">
<title>expert_0_L9_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="512116,-78 511976,-78 511976,-26 512116,-26 512116,-78"/>
<text text-anchor="middle" x="512046" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="512046" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="512046" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="512046" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L9_EP0TP0PP1DP0_GPU4 -->
<g id="node2493" class="node">
<title>expert_1_L9_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="512292,-78 512152,-78 512152,-26 512292,-26 512292,-78"/>
<text text-anchor="middle" x="512222" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="512222" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="512222" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="512222" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L9_EP0TP0PP1DP0_GPU4 -->
<g id="node2494" class="node">
<title>expert_2_L9_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="512468,-78 512328,-78 512328,-26 512468,-26 512468,-78"/>
<text text-anchor="middle" x="512398" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="512398" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="512398" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="512398" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L9_EP0TP0PP1DP0_GPU4 -->
<g id="node2495" class="node">
<title>expert_3_L9_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="512644,-78 512504,-78 512504,-26 512644,-26 512644,-78"/>
<text text-anchor="middle" x="512574" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="512574" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="512574" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="512574" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L9_EP0TP0PP1DP0_GPU4 -->
<g id="node2496" class="node">
<title>combine_L9_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="512779" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="512779" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="512779" y="-44" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP0_GPU4</text>
</g>
<!-- ffn_L9_EP0TP0PP1DP0_GPU4 -->
<g id="node2497" class="node">
<title>ffn_L9_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="513084,-78 512914,-78 512914,-26 513084,-26 513084,-78"/>
<text text-anchor="middle" x="512999" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="512999" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="512999" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="512999" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L9_EP0TP0PP1DP0_GPU4 -->
<g id="node2498" class="node">
<title>ffn_ar_L9_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="513223" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="513223" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="513223" y="-49.5" font-family="Arial" font-size="10.00">L9 EP0 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="513223" y="-38.5" font-family="Arial" font-size="10.00">GPU4</text>
</g>
<!-- residual2_L9_EP0TP0PP1DP0_GPU4 -->
<g id="node2499" class="node">
<title>residual2_L9_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="513508,-78 513362,-78 513362,-26 513508,-26 513508,-78"/>
<text text-anchor="middle" x="513435" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="513435" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="513435" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="513435" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L9_EP0TP0PP1DP1_GPU5 -->
<g id="node2500" class="node">
<title>ln1_L9_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="513686,-78 513544,-78 513544,-26 513686,-26 513686,-78"/>
<text text-anchor="middle" x="513615" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="513615" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="513615" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="513615" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L9_EP0TP0PP1DP1_GPU5 -->
<g id="node2501" class="node">
<title>qkv_L9_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="513864,-78 513722,-78 513722,-26 513864,-26 513864,-78"/>
<text text-anchor="middle" x="513793" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="513793" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="513793" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="513793" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L9_EP0TP0PP1DP1_GPU5 -->
<g id="node2502" class="node">
<title>attn_L9_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="514051.5,-78 513900.5,-78 513900.5,-26 514051.5,-26 514051.5,-78"/>
<text text-anchor="middle" x="513976" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="513976" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="513976" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="513976" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L9_EP0TP0PP1DP1_GPU5 -->
<g id="node2503" class="node">
<title>attn_out_L9_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="514230,-78 514088,-78 514088,-26 514230,-26 514230,-78"/>
<text text-anchor="middle" x="514159" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="514159" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="514159" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="514159" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L9_EP0TP0PP1DP1_GPU5 -->
<g id="node2504" class="node">
<title>attn_ar_L9_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="514369" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="514369" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="514369" y="-49.5" font-family="Arial" font-size="10.00">L9 EP0 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="514369" y="-38.5" font-family="Arial" font-size="10.00">GPU5</text>
</g>
<!-- residual1_L9_EP0TP0PP1DP1_GPU5 -->
<g id="node2505" class="node">
<title>residual1_L9_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="514654,-78 514508,-78 514508,-26 514654,-26 514654,-78"/>
<text text-anchor="middle" x="514581" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="514581" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="514581" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="514581" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L9_EP0TP0PP1DP1_GPU5 -->
<g id="node2506" class="node">
<title>ln2_L9_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="514832,-78 514690,-78 514690,-26 514832,-26 514832,-78"/>
<text text-anchor="middle" x="514761" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="514761" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="514761" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="514761" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L9_EP0TP0PP1DP1_GPU5 -->
<g id="node2507" class="node">
<title>gate_L9_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightyellow" stroke="black" points="515158.29,-104 514927.17,-104 514867.71,0 515098.83,0 515158.29,-104"/>
<text text-anchor="middle" x="515013" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="515013" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="515013" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="515013" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L9_EP0TP0PP1DP1_GPU5 -->
<g id="node2508" class="node">
<title>dispatch_L9_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="515293" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="515293" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="515293" y="-44" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP1_GPU5</text>
</g>
<!-- expert_0_L9_EP0TP0PP1DP1_GPU5 -->
<g id="node2509" class="node">
<title>expert_0_L9_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="515568,-78 515428,-78 515428,-26 515568,-26 515568,-78"/>
<text text-anchor="middle" x="515498" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="515498" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="515498" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="515498" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L9_EP0TP0PP1DP1_GPU5 -->
<g id="node2510" class="node">
<title>expert_1_L9_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="515744,-78 515604,-78 515604,-26 515744,-26 515744,-78"/>
<text text-anchor="middle" x="515674" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="515674" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="515674" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="515674" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L9_EP0TP0PP1DP1_GPU5 -->
<g id="node2511" class="node">
<title>expert_2_L9_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="515920,-78 515780,-78 515780,-26 515920,-26 515920,-78"/>
<text text-anchor="middle" x="515850" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="515850" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="515850" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="515850" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L9_EP0TP0PP1DP1_GPU5 -->
<g id="node2512" class="node">
<title>expert_3_L9_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="516096,-78 515956,-78 515956,-26 516096,-26 516096,-78"/>
<text text-anchor="middle" x="516026" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="516026" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="516026" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="516026" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L9_EP0TP0PP1DP1_GPU5 -->
<g id="node2513" class="node">
<title>combine_L9_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="516231" cy="-52" rx="98.99" ry="21.43"/>
<text text-anchor="middle" x="516231" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="516231" y="-44" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP1_GPU5</text>
</g>
<!-- ffn_L9_EP0TP0PP1DP1_GPU5 -->
<g id="node2514" class="node">
<title>ffn_L9_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="516536,-78 516366,-78 516366,-26 516536,-26 516536,-78"/>
<text text-anchor="middle" x="516451" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="516451" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="516451" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="516451" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L9_EP0TP0PP1DP1_GPU5 -->
<g id="node2515" class="node">
<title>ffn_ar_L9_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="516675" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="516675" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="516675" y="-49.5" font-family="Arial" font-size="10.00">L9 EP0 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="516675" y="-38.5" font-family="Arial" font-size="10.00">GPU5</text>
</g>
<!-- residual2_L9_EP0TP0PP1DP1_GPU5 -->
<g id="node2516" class="node">
<title>residual2_L9_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="516960,-78 516814,-78 516814,-26 516960,-26 516960,-78"/>
<text text-anchor="middle" x="516887" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="516887" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="516887" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="516887" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L9_EP0TP1PP1DP0_GPU12 -->
<g id="node2517" class="node">
<title>ln1_L9_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="517141.5,-78 516996.5,-78 516996.5,-26 517141.5,-26 517141.5,-78"/>
<text text-anchor="middle" x="517069" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="517069" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="517069" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="517069" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L9_EP0TP1PP1DP0_GPU12 -->
<g id="node2518" class="node">
<title>qkv_L9_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="517322.5,-78 517177.5,-78 517177.5,-26 517322.5,-26 517322.5,-78"/>
<text text-anchor="middle" x="517250" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="517250" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="517250" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="517250" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L9_EP0TP1PP1DP0_GPU12 -->
<g id="node2519" class="node">
<title>attn_L9_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="517509.5,-78 517358.5,-78 517358.5,-26 517509.5,-26 517509.5,-78"/>
<text text-anchor="middle" x="517434" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="517434" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="517434" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="517434" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L9_EP0TP1PP1DP0_GPU12 -->
<g id="node2520" class="node">
<title>attn_out_L9_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="517690.5,-78 517545.5,-78 517545.5,-26 517690.5,-26 517690.5,-78"/>
<text text-anchor="middle" x="517618" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="517618" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="517618" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="517618" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L9_EP0TP1PP1DP0_GPU12 -->
<g id="node2521" class="node">
<title>attn_ar_L9_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="517830" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="517830" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="517830" y="-49.5" font-family="Arial" font-size="10.00">L9 EP0 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="517830" y="-38.5" font-family="Arial" font-size="10.00">GPU12</text>
</g>
<!-- residual1_L9_EP0TP1PP1DP0_GPU12 -->
<g id="node2522" class="node">
<title>residual1_L9_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="518115,-78 517969,-78 517969,-26 518115,-26 518115,-78"/>
<text text-anchor="middle" x="518042" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="518042" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="518042" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="518042" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L9_EP0TP1PP1DP0_GPU12 -->
<g id="node2523" class="node">
<title>ln2_L9_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="518296.5,-78 518151.5,-78 518151.5,-26 518296.5,-26 518296.5,-78"/>
<text text-anchor="middle" x="518224" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="518224" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="518224" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="518224" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L9_EP0TP1PP1DP0_GPU12 -->
<g id="node2524" class="node">
<title>gate_L9_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightyellow" stroke="black" points="518633.16,-104 518394.29,-104 518332.84,0 518571.71,0 518633.16,-104"/>
<text text-anchor="middle" x="518483" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="518483" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="518483" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="518483" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L9_EP0TP1PP1DP0_GPU12 -->
<g id="node2525" class="node">
<title>dispatch_L9_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="518772" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="518772" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="518772" y="-44" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP0_GPU12</text>
</g>
<!-- expert_0_L9_EP0TP1PP1DP0_GPU12 -->
<g id="node2526" class="node">
<title>expert_0_L9_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="519055.5,-78 518910.5,-78 518910.5,-26 519055.5,-26 519055.5,-78"/>
<text text-anchor="middle" x="518983" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="518983" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="518983" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="518983" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L9_EP0TP1PP1DP0_GPU12 -->
<g id="node2527" class="node">
<title>expert_1_L9_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="519236.5,-78 519091.5,-78 519091.5,-26 519236.5,-26 519236.5,-78"/>
<text text-anchor="middle" x="519164" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="519164" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="519164" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="519164" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L9_EP0TP1PP1DP0_GPU12 -->
<g id="node2528" class="node">
<title>expert_2_L9_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="519417.5,-78 519272.5,-78 519272.5,-26 519417.5,-26 519417.5,-78"/>
<text text-anchor="middle" x="519345" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="519345" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="519345" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="519345" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L9_EP0TP1PP1DP0_GPU12 -->
<g id="node2529" class="node">
<title>expert_3_L9_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="519598.5,-78 519453.5,-78 519453.5,-26 519598.5,-26 519598.5,-78"/>
<text text-anchor="middle" x="519526" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="519526" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="519526" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="519526" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L9_EP0TP1PP1DP0_GPU12 -->
<g id="node2530" class="node">
<title>combine_L9_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="519737" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="519737" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="519737" y="-44" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP0_GPU12</text>
</g>
<!-- ffn_L9_EP0TP1PP1DP0_GPU12 -->
<g id="node2531" class="node">
<title>ffn_L9_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="520046,-78 519876,-78 519876,-26 520046,-26 520046,-78"/>
<text text-anchor="middle" x="519961" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="519961" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="519961" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="519961" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L9_EP0TP1PP1DP0_GPU12 -->
<g id="node2532" class="node">
<title>ffn_ar_L9_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="520185" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="520185" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="520185" y="-49.5" font-family="Arial" font-size="10.00">L9 EP0 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="520185" y="-38.5" font-family="Arial" font-size="10.00">GPU12</text>
</g>
<!-- residual2_L9_EP0TP1PP1DP0_GPU12 -->
<g id="node2533" class="node">
<title>residual2_L9_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="520470,-78 520324,-78 520324,-26 520470,-26 520470,-78"/>
<text text-anchor="middle" x="520397" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="520397" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="520397" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="520397" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L9_EP0TP1PP1DP1_GPU13 -->
<g id="node2534" class="node">
<title>ln1_L9_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="520651.5,-78 520506.5,-78 520506.5,-26 520651.5,-26 520651.5,-78"/>
<text text-anchor="middle" x="520579" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="520579" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="520579" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="520579" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L9_EP0TP1PP1DP1_GPU13 -->
<g id="node2535" class="node">
<title>qkv_L9_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="520832.5,-78 520687.5,-78 520687.5,-26 520832.5,-26 520832.5,-78"/>
<text text-anchor="middle" x="520760" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="520760" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="520760" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="520760" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L9_EP0TP1PP1DP1_GPU13 -->
<g id="node2536" class="node">
<title>attn_L9_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="521019.5,-78 520868.5,-78 520868.5,-26 521019.5,-26 521019.5,-78"/>
<text text-anchor="middle" x="520944" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="520944" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="520944" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="520944" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L9_EP0TP1PP1DP1_GPU13 -->
<g id="node2537" class="node">
<title>attn_out_L9_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="521200.5,-78 521055.5,-78 521055.5,-26 521200.5,-26 521200.5,-78"/>
<text text-anchor="middle" x="521128" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="521128" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="521128" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="521128" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L9_EP0TP1PP1DP1_GPU13 -->
<g id="node2538" class="node">
<title>attn_ar_L9_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="521340" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="521340" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="521340" y="-49.5" font-family="Arial" font-size="10.00">L9 EP0 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="521340" y="-38.5" font-family="Arial" font-size="10.00">GPU13</text>
</g>
<!-- residual1_L9_EP0TP1PP1DP1_GPU13 -->
<g id="node2539" class="node">
<title>residual1_L9_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="521625,-78 521479,-78 521479,-26 521625,-26 521625,-78"/>
<text text-anchor="middle" x="521552" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="521552" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="521552" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="521552" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L9_EP0TP1PP1DP1_GPU13 -->
<g id="node2540" class="node">
<title>ln2_L9_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="521806.5,-78 521661.5,-78 521661.5,-26 521806.5,-26 521806.5,-78"/>
<text text-anchor="middle" x="521734" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="521734" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="521734" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="521734" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L9_EP0TP1PP1DP1_GPU13 -->
<g id="node2541" class="node">
<title>gate_L9_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightyellow" stroke="black" points="522143.16,-104 521904.29,-104 521842.84,0 522081.71,0 522143.16,-104"/>
<text text-anchor="middle" x="521993" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="521993" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="521993" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="521993" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L9_EP0TP1PP1DP1_GPU13 -->
<g id="node2542" class="node">
<title>dispatch_L9_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="522282" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="522282" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="522282" y="-44" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP1_GPU13</text>
</g>
<!-- expert_0_L9_EP0TP1PP1DP1_GPU13 -->
<g id="node2543" class="node">
<title>expert_0_L9_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="522565.5,-78 522420.5,-78 522420.5,-26 522565.5,-26 522565.5,-78"/>
<text text-anchor="middle" x="522493" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="522493" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="522493" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="522493" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L9_EP0TP1PP1DP1_GPU13 -->
<g id="node2544" class="node">
<title>expert_1_L9_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="522746.5,-78 522601.5,-78 522601.5,-26 522746.5,-26 522746.5,-78"/>
<text text-anchor="middle" x="522674" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="522674" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="522674" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="522674" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L9_EP0TP1PP1DP1_GPU13 -->
<g id="node2545" class="node">
<title>expert_2_L9_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="522927.5,-78 522782.5,-78 522782.5,-26 522927.5,-26 522927.5,-78"/>
<text text-anchor="middle" x="522855" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="522855" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="522855" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="522855" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L9_EP0TP1PP1DP1_GPU13 -->
<g id="node2546" class="node">
<title>expert_3_L9_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="523108.5,-78 522963.5,-78 522963.5,-26 523108.5,-26 523108.5,-78"/>
<text text-anchor="middle" x="523036" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="523036" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="523036" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="523036" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L9_EP0TP1PP1DP1_GPU13 -->
<g id="node2547" class="node">
<title>combine_L9_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="523247" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="523247" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="523247" y="-44" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP1_GPU13</text>
</g>
<!-- ffn_L9_EP0TP1PP1DP1_GPU13 -->
<g id="node2548" class="node">
<title>ffn_L9_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="523556,-78 523386,-78 523386,-26 523556,-26 523556,-78"/>
<text text-anchor="middle" x="523471" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="523471" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="523471" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="523471" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L9_EP0TP1PP1DP1_GPU13 -->
<g id="node2549" class="node">
<title>ffn_ar_L9_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="523695" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="523695" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="523695" y="-49.5" font-family="Arial" font-size="10.00">L9 EP0 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="523695" y="-38.5" font-family="Arial" font-size="10.00">GPU13</text>
</g>
<!-- residual2_L9_EP0TP1PP1DP1_GPU13 -->
<g id="node2550" class="node">
<title>residual2_L9_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="523980,-78 523834,-78 523834,-26 523980,-26 523980,-78"/>
<text text-anchor="middle" x="523907" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="523907" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="523907" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="523907" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L9_EP0TP2PP1DP0_GPU20 -->
<g id="node2551" class="node">
<title>ln1_L9_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="524161.5,-78 524016.5,-78 524016.5,-26 524161.5,-26 524161.5,-78"/>
<text text-anchor="middle" x="524089" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="524089" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="524089" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="524089" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L9_EP0TP2PP1DP0_GPU20 -->
<g id="node2552" class="node">
<title>qkv_L9_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="524342.5,-78 524197.5,-78 524197.5,-26 524342.5,-26 524342.5,-78"/>
<text text-anchor="middle" x="524270" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="524270" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="524270" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="524270" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L9_EP0TP2PP1DP0_GPU20 -->
<g id="node2553" class="node">
<title>attn_L9_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="524529.5,-78 524378.5,-78 524378.5,-26 524529.5,-26 524529.5,-78"/>
<text text-anchor="middle" x="524454" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="524454" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="524454" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="524454" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L9_EP0TP2PP1DP0_GPU20 -->
<g id="node2554" class="node">
<title>attn_out_L9_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="524710.5,-78 524565.5,-78 524565.5,-26 524710.5,-26 524710.5,-78"/>
<text text-anchor="middle" x="524638" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="524638" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="524638" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="524638" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L9_EP0TP2PP1DP0_GPU20 -->
<g id="node2555" class="node">
<title>attn_ar_L9_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="524850" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="524850" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="524850" y="-49.5" font-family="Arial" font-size="10.00">L9 EP0 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="524850" y="-38.5" font-family="Arial" font-size="10.00">GPU20</text>
</g>
<!-- residual1_L9_EP0TP2PP1DP0_GPU20 -->
<g id="node2556" class="node">
<title>residual1_L9_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="525135,-78 524989,-78 524989,-26 525135,-26 525135,-78"/>
<text text-anchor="middle" x="525062" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="525062" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="525062" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="525062" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L9_EP0TP2PP1DP0_GPU20 -->
<g id="node2557" class="node">
<title>ln2_L9_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="525316.5,-78 525171.5,-78 525171.5,-26 525316.5,-26 525316.5,-78"/>
<text text-anchor="middle" x="525244" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="525244" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="525244" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="525244" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L9_EP0TP2PP1DP0_GPU20 -->
<g id="node2558" class="node">
<title>gate_L9_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightyellow" stroke="black" points="525653.16,-104 525414.29,-104 525352.84,0 525591.71,0 525653.16,-104"/>
<text text-anchor="middle" x="525503" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="525503" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="525503" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="525503" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L9_EP0TP2PP1DP0_GPU20 -->
<g id="node2559" class="node">
<title>dispatch_L9_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="525792" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="525792" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="525792" y="-44" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP0_GPU20</text>
</g>
<!-- expert_0_L9_EP0TP2PP1DP0_GPU20 -->
<g id="node2560" class="node">
<title>expert_0_L9_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="526075.5,-78 525930.5,-78 525930.5,-26 526075.5,-26 526075.5,-78"/>
<text text-anchor="middle" x="526003" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="526003" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="526003" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="526003" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L9_EP0TP2PP1DP0_GPU20 -->
<g id="node2561" class="node">
<title>expert_1_L9_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="526256.5,-78 526111.5,-78 526111.5,-26 526256.5,-26 526256.5,-78"/>
<text text-anchor="middle" x="526184" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="526184" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="526184" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="526184" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L9_EP0TP2PP1DP0_GPU20 -->
<g id="node2562" class="node">
<title>expert_2_L9_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="526437.5,-78 526292.5,-78 526292.5,-26 526437.5,-26 526437.5,-78"/>
<text text-anchor="middle" x="526365" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="526365" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="526365" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="526365" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L9_EP0TP2PP1DP0_GPU20 -->
<g id="node2563" class="node">
<title>expert_3_L9_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="526618.5,-78 526473.5,-78 526473.5,-26 526618.5,-26 526618.5,-78"/>
<text text-anchor="middle" x="526546" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="526546" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="526546" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="526546" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L9_EP0TP2PP1DP0_GPU20 -->
<g id="node2564" class="node">
<title>combine_L9_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="526757" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="526757" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="526757" y="-44" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP0_GPU20</text>
</g>
<!-- ffn_L9_EP0TP2PP1DP0_GPU20 -->
<g id="node2565" class="node">
<title>ffn_L9_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="527066,-78 526896,-78 526896,-26 527066,-26 527066,-78"/>
<text text-anchor="middle" x="526981" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="526981" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="526981" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="526981" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L9_EP0TP2PP1DP0_GPU20 -->
<g id="node2566" class="node">
<title>ffn_ar_L9_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="527205" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="527205" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="527205" y="-49.5" font-family="Arial" font-size="10.00">L9 EP0 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="527205" y="-38.5" font-family="Arial" font-size="10.00">GPU20</text>
</g>
<!-- residual2_L9_EP0TP2PP1DP0_GPU20 -->
<g id="node2567" class="node">
<title>residual2_L9_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="527490,-78 527344,-78 527344,-26 527490,-26 527490,-78"/>
<text text-anchor="middle" x="527417" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="527417" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="527417" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="527417" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L9_EP0TP2PP1DP1_GPU21 -->
<g id="node2568" class="node">
<title>ln1_L9_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="527671.5,-78 527526.5,-78 527526.5,-26 527671.5,-26 527671.5,-78"/>
<text text-anchor="middle" x="527599" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="527599" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="527599" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="527599" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L9_EP0TP2PP1DP1_GPU21 -->
<g id="node2569" class="node">
<title>qkv_L9_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="527852.5,-78 527707.5,-78 527707.5,-26 527852.5,-26 527852.5,-78"/>
<text text-anchor="middle" x="527780" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="527780" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="527780" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="527780" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L9_EP0TP2PP1DP1_GPU21 -->
<g id="node2570" class="node">
<title>attn_L9_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="528039.5,-78 527888.5,-78 527888.5,-26 528039.5,-26 528039.5,-78"/>
<text text-anchor="middle" x="527964" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="527964" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="527964" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="527964" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L9_EP0TP2PP1DP1_GPU21 -->
<g id="node2571" class="node">
<title>attn_out_L9_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="528220.5,-78 528075.5,-78 528075.5,-26 528220.5,-26 528220.5,-78"/>
<text text-anchor="middle" x="528148" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="528148" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="528148" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="528148" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L9_EP0TP2PP1DP1_GPU21 -->
<g id="node2572" class="node">
<title>attn_ar_L9_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="528360" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="528360" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="528360" y="-49.5" font-family="Arial" font-size="10.00">L9 EP0 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="528360" y="-38.5" font-family="Arial" font-size="10.00">GPU21</text>
</g>
<!-- residual1_L9_EP0TP2PP1DP1_GPU21 -->
<g id="node2573" class="node">
<title>residual1_L9_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="528645,-78 528499,-78 528499,-26 528645,-26 528645,-78"/>
<text text-anchor="middle" x="528572" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="528572" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="528572" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="528572" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L9_EP0TP2PP1DP1_GPU21 -->
<g id="node2574" class="node">
<title>ln2_L9_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="528826.5,-78 528681.5,-78 528681.5,-26 528826.5,-26 528826.5,-78"/>
<text text-anchor="middle" x="528754" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="528754" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="528754" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="528754" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L9_EP0TP2PP1DP1_GPU21 -->
<g id="node2575" class="node">
<title>gate_L9_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightyellow" stroke="black" points="529163.16,-104 528924.29,-104 528862.84,0 529101.71,0 529163.16,-104"/>
<text text-anchor="middle" x="529013" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="529013" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="529013" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="529013" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L9_EP0TP2PP1DP1_GPU21 -->
<g id="node2576" class="node">
<title>dispatch_L9_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="529302" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="529302" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="529302" y="-44" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP1_GPU21</text>
</g>
<!-- expert_0_L9_EP0TP2PP1DP1_GPU21 -->
<g id="node2577" class="node">
<title>expert_0_L9_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="529585.5,-78 529440.5,-78 529440.5,-26 529585.5,-26 529585.5,-78"/>
<text text-anchor="middle" x="529513" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="529513" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="529513" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="529513" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L9_EP0TP2PP1DP1_GPU21 -->
<g id="node2578" class="node">
<title>expert_1_L9_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="529766.5,-78 529621.5,-78 529621.5,-26 529766.5,-26 529766.5,-78"/>
<text text-anchor="middle" x="529694" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="529694" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="529694" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="529694" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L9_EP0TP2PP1DP1_GPU21 -->
<g id="node2579" class="node">
<title>expert_2_L9_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="529947.5,-78 529802.5,-78 529802.5,-26 529947.5,-26 529947.5,-78"/>
<text text-anchor="middle" x="529875" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="529875" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="529875" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="529875" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L9_EP0TP2PP1DP1_GPU21 -->
<g id="node2580" class="node">
<title>expert_3_L9_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="530128.5,-78 529983.5,-78 529983.5,-26 530128.5,-26 530128.5,-78"/>
<text text-anchor="middle" x="530056" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="530056" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="530056" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="530056" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L9_EP0TP2PP1DP1_GPU21 -->
<g id="node2581" class="node">
<title>combine_L9_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="530267" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="530267" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="530267" y="-44" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP1_GPU21</text>
</g>
<!-- ffn_L9_EP0TP2PP1DP1_GPU21 -->
<g id="node2582" class="node">
<title>ffn_L9_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="530576,-78 530406,-78 530406,-26 530576,-26 530576,-78"/>
<text text-anchor="middle" x="530491" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="530491" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="530491" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="530491" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L9_EP0TP2PP1DP1_GPU21 -->
<g id="node2583" class="node">
<title>ffn_ar_L9_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="530715" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="530715" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="530715" y="-49.5" font-family="Arial" font-size="10.00">L9 EP0 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="530715" y="-38.5" font-family="Arial" font-size="10.00">GPU21</text>
</g>
<!-- residual2_L9_EP0TP2PP1DP1_GPU21 -->
<g id="node2584" class="node">
<title>residual2_L9_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="531000,-78 530854,-78 530854,-26 531000,-26 531000,-78"/>
<text text-anchor="middle" x="530927" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="530927" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="530927" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="530927" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L9_EP0TP3PP1DP0_GPU28 -->
<g id="node2585" class="node">
<title>ln1_L9_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="531181.5,-78 531036.5,-78 531036.5,-26 531181.5,-26 531181.5,-78"/>
<text text-anchor="middle" x="531109" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="531109" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="531109" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="531109" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L9_EP0TP3PP1DP0_GPU28 -->
<g id="node2586" class="node">
<title>qkv_L9_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="531362.5,-78 531217.5,-78 531217.5,-26 531362.5,-26 531362.5,-78"/>
<text text-anchor="middle" x="531290" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="531290" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="531290" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="531290" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L9_EP0TP3PP1DP0_GPU28 -->
<g id="node2587" class="node">
<title>attn_L9_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="531549.5,-78 531398.5,-78 531398.5,-26 531549.5,-26 531549.5,-78"/>
<text text-anchor="middle" x="531474" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="531474" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="531474" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="531474" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L9_EP0TP3PP1DP0_GPU28 -->
<g id="node2588" class="node">
<title>attn_out_L9_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="531730.5,-78 531585.5,-78 531585.5,-26 531730.5,-26 531730.5,-78"/>
<text text-anchor="middle" x="531658" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="531658" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="531658" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="531658" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L9_EP0TP3PP1DP0_GPU28 -->
<g id="node2589" class="node">
<title>attn_ar_L9_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="531870" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="531870" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="531870" y="-49.5" font-family="Arial" font-size="10.00">L9 EP0 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="531870" y="-38.5" font-family="Arial" font-size="10.00">GPU28</text>
</g>
<!-- residual1_L9_EP0TP3PP1DP0_GPU28 -->
<g id="node2590" class="node">
<title>residual1_L9_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="532155,-78 532009,-78 532009,-26 532155,-26 532155,-78"/>
<text text-anchor="middle" x="532082" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="532082" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="532082" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="532082" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L9_EP0TP3PP1DP0_GPU28 -->
<g id="node2591" class="node">
<title>ln2_L9_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="532336.5,-78 532191.5,-78 532191.5,-26 532336.5,-26 532336.5,-78"/>
<text text-anchor="middle" x="532264" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="532264" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="532264" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="532264" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L9_EP0TP3PP1DP0_GPU28 -->
<g id="node2592" class="node">
<title>gate_L9_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightyellow" stroke="black" points="532673.16,-104 532434.29,-104 532372.84,0 532611.71,0 532673.16,-104"/>
<text text-anchor="middle" x="532523" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="532523" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="532523" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="532523" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L9_EP0TP3PP1DP0_GPU28 -->
<g id="node2593" class="node">
<title>dispatch_L9_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="532812" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="532812" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="532812" y="-44" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP0_GPU28</text>
</g>
<!-- expert_0_L9_EP0TP3PP1DP0_GPU28 -->
<g id="node2594" class="node">
<title>expert_0_L9_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="533095.5,-78 532950.5,-78 532950.5,-26 533095.5,-26 533095.5,-78"/>
<text text-anchor="middle" x="533023" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="533023" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="533023" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="533023" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L9_EP0TP3PP1DP0_GPU28 -->
<g id="node2595" class="node">
<title>expert_1_L9_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="533276.5,-78 533131.5,-78 533131.5,-26 533276.5,-26 533276.5,-78"/>
<text text-anchor="middle" x="533204" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="533204" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="533204" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="533204" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L9_EP0TP3PP1DP0_GPU28 -->
<g id="node2596" class="node">
<title>expert_2_L9_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="533457.5,-78 533312.5,-78 533312.5,-26 533457.5,-26 533457.5,-78"/>
<text text-anchor="middle" x="533385" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="533385" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="533385" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="533385" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L9_EP0TP3PP1DP0_GPU28 -->
<g id="node2597" class="node">
<title>expert_3_L9_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="533638.5,-78 533493.5,-78 533493.5,-26 533638.5,-26 533638.5,-78"/>
<text text-anchor="middle" x="533566" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="533566" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="533566" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="533566" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L9_EP0TP3PP1DP0_GPU28 -->
<g id="node2598" class="node">
<title>combine_L9_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="533777" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="533777" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="533777" y="-44" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP0_GPU28</text>
</g>
<!-- ffn_L9_EP0TP3PP1DP0_GPU28 -->
<g id="node2599" class="node">
<title>ffn_L9_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="534086,-78 533916,-78 533916,-26 534086,-26 534086,-78"/>
<text text-anchor="middle" x="534001" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="534001" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="534001" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="534001" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L9_EP0TP3PP1DP0_GPU28 -->
<g id="node2600" class="node">
<title>ffn_ar_L9_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="534225" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="534225" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="534225" y="-49.5" font-family="Arial" font-size="10.00">L9 EP0 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="534225" y="-38.5" font-family="Arial" font-size="10.00">GPU28</text>
</g>
<!-- residual2_L9_EP0TP3PP1DP0_GPU28 -->
<g id="node2601" class="node">
<title>residual2_L9_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="534510,-78 534364,-78 534364,-26 534510,-26 534510,-78"/>
<text text-anchor="middle" x="534437" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="534437" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="534437" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="534437" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L9_EP0TP3PP1DP1_GPU29 -->
<g id="node2602" class="node">
<title>ln1_L9_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="534691.5,-78 534546.5,-78 534546.5,-26 534691.5,-26 534691.5,-78"/>
<text text-anchor="middle" x="534619" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="534619" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="534619" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="534619" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L9_EP0TP3PP1DP1_GPU29 -->
<g id="node2603" class="node">
<title>qkv_L9_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="534872.5,-78 534727.5,-78 534727.5,-26 534872.5,-26 534872.5,-78"/>
<text text-anchor="middle" x="534800" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="534800" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="534800" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="534800" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L9_EP0TP3PP1DP1_GPU29 -->
<g id="node2604" class="node">
<title>attn_L9_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="535059.5,-78 534908.5,-78 534908.5,-26 535059.5,-26 535059.5,-78"/>
<text text-anchor="middle" x="534984" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="534984" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="534984" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="534984" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L9_EP0TP3PP1DP1_GPU29 -->
<g id="node2605" class="node">
<title>attn_out_L9_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="535240.5,-78 535095.5,-78 535095.5,-26 535240.5,-26 535240.5,-78"/>
<text text-anchor="middle" x="535168" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="535168" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="535168" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="535168" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L9_EP0TP3PP1DP1_GPU29 -->
<g id="node2606" class="node">
<title>attn_ar_L9_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="535380" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="535380" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="535380" y="-49.5" font-family="Arial" font-size="10.00">L9 EP0 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="535380" y="-38.5" font-family="Arial" font-size="10.00">GPU29</text>
</g>
<!-- residual1_L9_EP0TP3PP1DP1_GPU29 -->
<g id="node2607" class="node">
<title>residual1_L9_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="535665,-78 535519,-78 535519,-26 535665,-26 535665,-78"/>
<text text-anchor="middle" x="535592" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="535592" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="535592" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="535592" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L9_EP0TP3PP1DP1_GPU29 -->
<g id="node2608" class="node">
<title>ln2_L9_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="535846.5,-78 535701.5,-78 535701.5,-26 535846.5,-26 535846.5,-78"/>
<text text-anchor="middle" x="535774" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="535774" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="535774" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="535774" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L9_EP0TP3PP1DP1_GPU29 -->
<g id="node2609" class="node">
<title>gate_L9_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightyellow" stroke="black" points="536183.16,-104 535944.29,-104 535882.84,0 536121.71,0 536183.16,-104"/>
<text text-anchor="middle" x="536033" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="536033" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="536033" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="536033" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L9_EP0TP3PP1DP1_GPU29 -->
<g id="node2610" class="node">
<title>dispatch_L9_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="536322" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="536322" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="536322" y="-44" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP1_GPU29</text>
</g>
<!-- expert_0_L9_EP0TP3PP1DP1_GPU29 -->
<g id="node2611" class="node">
<title>expert_0_L9_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="536605.5,-78 536460.5,-78 536460.5,-26 536605.5,-26 536605.5,-78"/>
<text text-anchor="middle" x="536533" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="536533" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="536533" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="536533" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L9_EP0TP3PP1DP1_GPU29 -->
<g id="node2612" class="node">
<title>expert_1_L9_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="536786.5,-78 536641.5,-78 536641.5,-26 536786.5,-26 536786.5,-78"/>
<text text-anchor="middle" x="536714" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="536714" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="536714" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="536714" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L9_EP0TP3PP1DP1_GPU29 -->
<g id="node2613" class="node">
<title>expert_2_L9_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="536967.5,-78 536822.5,-78 536822.5,-26 536967.5,-26 536967.5,-78"/>
<text text-anchor="middle" x="536895" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="536895" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="536895" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="536895" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L9_EP0TP3PP1DP1_GPU29 -->
<g id="node2614" class="node">
<title>expert_3_L9_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="537148.5,-78 537003.5,-78 537003.5,-26 537148.5,-26 537148.5,-78"/>
<text text-anchor="middle" x="537076" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="537076" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="537076" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="537076" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L9_EP0TP3PP1DP1_GPU29 -->
<g id="node2615" class="node">
<title>combine_L9_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="537287" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="537287" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="537287" y="-44" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP1_GPU29</text>
</g>
<!-- ffn_L9_EP0TP3PP1DP1_GPU29 -->
<g id="node2616" class="node">
<title>ffn_L9_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="537596,-78 537426,-78 537426,-26 537596,-26 537596,-78"/>
<text text-anchor="middle" x="537511" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="537511" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="537511" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="537511" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L9_EP0TP3PP1DP1_GPU29 -->
<g id="node2617" class="node">
<title>ffn_ar_L9_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="537735" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="537735" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="537735" y="-49.5" font-family="Arial" font-size="10.00">L9 EP0 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="537735" y="-38.5" font-family="Arial" font-size="10.00">GPU29</text>
</g>
<!-- residual2_L9_EP0TP3PP1DP1_GPU29 -->
<g id="node2618" class="node">
<title>residual2_L9_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="538020,-78 537874,-78 537874,-26 538020,-26 538020,-78"/>
<text text-anchor="middle" x="537947" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="537947" y="-55" font-family="Arial" font-size="10.00">L9_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="537947" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="537947" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L9_EP1TP0PP1DP0_GPU36 -->
<g id="node2619" class="node">
<title>ln1_L9_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="538201.5,-78 538056.5,-78 538056.5,-26 538201.5,-26 538201.5,-78"/>
<text text-anchor="middle" x="538129" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="538129" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="538129" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="538129" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L9_EP1TP0PP1DP0_GPU36 -->
<g id="node2620" class="node">
<title>qkv_L9_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="538382.5,-78 538237.5,-78 538237.5,-26 538382.5,-26 538382.5,-78"/>
<text text-anchor="middle" x="538310" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="538310" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="538310" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="538310" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L9_EP1TP0PP1DP0_GPU36 -->
<g id="node2621" class="node">
<title>attn_L9_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="538569.5,-78 538418.5,-78 538418.5,-26 538569.5,-26 538569.5,-78"/>
<text text-anchor="middle" x="538494" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="538494" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="538494" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="538494" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L9_EP1TP0PP1DP0_GPU36 -->
<g id="node2622" class="node">
<title>attn_out_L9_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="538750.5,-78 538605.5,-78 538605.5,-26 538750.5,-26 538750.5,-78"/>
<text text-anchor="middle" x="538678" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="538678" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="538678" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="538678" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L9_EP1TP0PP1DP0_GPU36 -->
<g id="node2623" class="node">
<title>attn_ar_L9_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="538890" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="538890" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="538890" y="-49.5" font-family="Arial" font-size="10.00">L9 EP1 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="538890" y="-38.5" font-family="Arial" font-size="10.00">GPU36</text>
</g>
<!-- residual1_L9_EP1TP0PP1DP0_GPU36 -->
<g id="node2624" class="node">
<title>residual1_L9_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="539175,-78 539029,-78 539029,-26 539175,-26 539175,-78"/>
<text text-anchor="middle" x="539102" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="539102" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="539102" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="539102" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L9_EP1TP0PP1DP0_GPU36 -->
<g id="node2625" class="node">
<title>ln2_L9_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="539356.5,-78 539211.5,-78 539211.5,-26 539356.5,-26 539356.5,-78"/>
<text text-anchor="middle" x="539284" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="539284" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="539284" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="539284" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L9_EP1TP0PP1DP0_GPU36 -->
<g id="node2626" class="node">
<title>gate_L9_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightyellow" stroke="black" points="539693.16,-104 539454.29,-104 539392.84,0 539631.71,0 539693.16,-104"/>
<text text-anchor="middle" x="539543" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="539543" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="539543" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="539543" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L9_EP1TP0PP1DP0_GPU36 -->
<g id="node2627" class="node">
<title>dispatch_L9_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="539832" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="539832" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="539832" y="-44" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP0_GPU36</text>
</g>
<!-- expert_0_L9_EP1TP0PP1DP0_GPU36 -->
<g id="node2628" class="node">
<title>expert_0_L9_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="540115.5,-78 539970.5,-78 539970.5,-26 540115.5,-26 540115.5,-78"/>
<text text-anchor="middle" x="540043" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="540043" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="540043" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="540043" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L9_EP1TP0PP1DP0_GPU36 -->
<g id="node2629" class="node">
<title>expert_1_L9_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="540296.5,-78 540151.5,-78 540151.5,-26 540296.5,-26 540296.5,-78"/>
<text text-anchor="middle" x="540224" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="540224" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="540224" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="540224" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L9_EP1TP0PP1DP0_GPU36 -->
<g id="node2630" class="node">
<title>expert_2_L9_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="540477.5,-78 540332.5,-78 540332.5,-26 540477.5,-26 540477.5,-78"/>
<text text-anchor="middle" x="540405" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="540405" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="540405" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="540405" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L9_EP1TP0PP1DP0_GPU36 -->
<g id="node2631" class="node">
<title>expert_3_L9_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="540658.5,-78 540513.5,-78 540513.5,-26 540658.5,-26 540658.5,-78"/>
<text text-anchor="middle" x="540586" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="540586" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="540586" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="540586" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L9_EP1TP0PP1DP0_GPU36 -->
<g id="node2632" class="node">
<title>combine_L9_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="540797" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="540797" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="540797" y="-44" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP0_GPU36</text>
</g>
<!-- ffn_L9_EP1TP0PP1DP0_GPU36 -->
<g id="node2633" class="node">
<title>ffn_L9_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="541106,-78 540936,-78 540936,-26 541106,-26 541106,-78"/>
<text text-anchor="middle" x="541021" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="541021" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="541021" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="541021" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L9_EP1TP0PP1DP0_GPU36 -->
<g id="node2634" class="node">
<title>ffn_ar_L9_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="541245" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="541245" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="541245" y="-49.5" font-family="Arial" font-size="10.00">L9 EP1 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="541245" y="-38.5" font-family="Arial" font-size="10.00">GPU36</text>
</g>
<!-- residual2_L9_EP1TP0PP1DP0_GPU36 -->
<g id="node2635" class="node">
<title>residual2_L9_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="541530,-78 541384,-78 541384,-26 541530,-26 541530,-78"/>
<text text-anchor="middle" x="541457" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="541457" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="541457" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="541457" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L9_EP1TP0PP1DP1_GPU37 -->
<g id="node2636" class="node">
<title>ln1_L9_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="541711.5,-78 541566.5,-78 541566.5,-26 541711.5,-26 541711.5,-78"/>
<text text-anchor="middle" x="541639" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="541639" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="541639" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="541639" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L9_EP1TP0PP1DP1_GPU37 -->
<g id="node2637" class="node">
<title>qkv_L9_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="541892.5,-78 541747.5,-78 541747.5,-26 541892.5,-26 541892.5,-78"/>
<text text-anchor="middle" x="541820" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="541820" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="541820" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="541820" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L9_EP1TP0PP1DP1_GPU37 -->
<g id="node2638" class="node">
<title>attn_L9_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="542079.5,-78 541928.5,-78 541928.5,-26 542079.5,-26 542079.5,-78"/>
<text text-anchor="middle" x="542004" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="542004" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="542004" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="542004" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L9_EP1TP0PP1DP1_GPU37 -->
<g id="node2639" class="node">
<title>attn_out_L9_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="542260.5,-78 542115.5,-78 542115.5,-26 542260.5,-26 542260.5,-78"/>
<text text-anchor="middle" x="542188" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="542188" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="542188" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="542188" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L9_EP1TP0PP1DP1_GPU37 -->
<g id="node2640" class="node">
<title>attn_ar_L9_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="542400" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="542400" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="542400" y="-49.5" font-family="Arial" font-size="10.00">L9 EP1 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="542400" y="-38.5" font-family="Arial" font-size="10.00">GPU37</text>
</g>
<!-- residual1_L9_EP1TP0PP1DP1_GPU37 -->
<g id="node2641" class="node">
<title>residual1_L9_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="542685,-78 542539,-78 542539,-26 542685,-26 542685,-78"/>
<text text-anchor="middle" x="542612" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="542612" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="542612" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="542612" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L9_EP1TP0PP1DP1_GPU37 -->
<g id="node2642" class="node">
<title>ln2_L9_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="542866.5,-78 542721.5,-78 542721.5,-26 542866.5,-26 542866.5,-78"/>
<text text-anchor="middle" x="542794" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="542794" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="542794" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="542794" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L9_EP1TP0PP1DP1_GPU37 -->
<g id="node2643" class="node">
<title>gate_L9_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightyellow" stroke="black" points="543203.16,-104 542964.29,-104 542902.84,0 543141.71,0 543203.16,-104"/>
<text text-anchor="middle" x="543053" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="543053" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="543053" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="543053" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L9_EP1TP0PP1DP1_GPU37 -->
<g id="node2644" class="node">
<title>dispatch_L9_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="543342" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="543342" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="543342" y="-44" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP1_GPU37</text>
</g>
<!-- expert_0_L9_EP1TP0PP1DP1_GPU37 -->
<g id="node2645" class="node">
<title>expert_0_L9_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="543625.5,-78 543480.5,-78 543480.5,-26 543625.5,-26 543625.5,-78"/>
<text text-anchor="middle" x="543553" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="543553" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="543553" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="543553" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L9_EP1TP0PP1DP1_GPU37 -->
<g id="node2646" class="node">
<title>expert_1_L9_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="543806.5,-78 543661.5,-78 543661.5,-26 543806.5,-26 543806.5,-78"/>
<text text-anchor="middle" x="543734" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="543734" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="543734" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="543734" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L9_EP1TP0PP1DP1_GPU37 -->
<g id="node2647" class="node">
<title>expert_2_L9_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="543987.5,-78 543842.5,-78 543842.5,-26 543987.5,-26 543987.5,-78"/>
<text text-anchor="middle" x="543915" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="543915" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="543915" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="543915" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L9_EP1TP0PP1DP1_GPU37 -->
<g id="node2648" class="node">
<title>expert_3_L9_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="544168.5,-78 544023.5,-78 544023.5,-26 544168.5,-26 544168.5,-78"/>
<text text-anchor="middle" x="544096" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="544096" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="544096" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="544096" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L9_EP1TP0PP1DP1_GPU37 -->
<g id="node2649" class="node">
<title>combine_L9_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="544307" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="544307" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="544307" y="-44" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP1_GPU37</text>
</g>
<!-- ffn_L9_EP1TP0PP1DP1_GPU37 -->
<g id="node2650" class="node">
<title>ffn_L9_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="544616,-78 544446,-78 544446,-26 544616,-26 544616,-78"/>
<text text-anchor="middle" x="544531" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="544531" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="544531" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="544531" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L9_EP1TP0PP1DP1_GPU37 -->
<g id="node2651" class="node">
<title>ffn_ar_L9_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="544755" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="544755" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="544755" y="-49.5" font-family="Arial" font-size="10.00">L9 EP1 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="544755" y="-38.5" font-family="Arial" font-size="10.00">GPU37</text>
</g>
<!-- residual2_L9_EP1TP0PP1DP1_GPU37 -->
<g id="node2652" class="node">
<title>residual2_L9_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="545040,-78 544894,-78 544894,-26 545040,-26 545040,-78"/>
<text text-anchor="middle" x="544967" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="544967" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="544967" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="544967" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L9_EP1TP1PP1DP0_GPU44 -->
<g id="node2653" class="node">
<title>ln1_L9_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="545221.5,-78 545076.5,-78 545076.5,-26 545221.5,-26 545221.5,-78"/>
<text text-anchor="middle" x="545149" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="545149" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="545149" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="545149" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L9_EP1TP1PP1DP0_GPU44 -->
<g id="node2654" class="node">
<title>qkv_L9_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="545402.5,-78 545257.5,-78 545257.5,-26 545402.5,-26 545402.5,-78"/>
<text text-anchor="middle" x="545330" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="545330" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="545330" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="545330" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L9_EP1TP1PP1DP0_GPU44 -->
<g id="node2655" class="node">
<title>attn_L9_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="545589.5,-78 545438.5,-78 545438.5,-26 545589.5,-26 545589.5,-78"/>
<text text-anchor="middle" x="545514" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="545514" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="545514" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="545514" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L9_EP1TP1PP1DP0_GPU44 -->
<g id="node2656" class="node">
<title>attn_out_L9_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="545770.5,-78 545625.5,-78 545625.5,-26 545770.5,-26 545770.5,-78"/>
<text text-anchor="middle" x="545698" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="545698" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="545698" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="545698" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L9_EP1TP1PP1DP0_GPU44 -->
<g id="node2657" class="node">
<title>attn_ar_L9_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="545910" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="545910" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="545910" y="-49.5" font-family="Arial" font-size="10.00">L9 EP1 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="545910" y="-38.5" font-family="Arial" font-size="10.00">GPU44</text>
</g>
<!-- residual1_L9_EP1TP1PP1DP0_GPU44 -->
<g id="node2658" class="node">
<title>residual1_L9_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="546195,-78 546049,-78 546049,-26 546195,-26 546195,-78"/>
<text text-anchor="middle" x="546122" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="546122" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="546122" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="546122" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L9_EP1TP1PP1DP0_GPU44 -->
<g id="node2659" class="node">
<title>ln2_L9_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="546376.5,-78 546231.5,-78 546231.5,-26 546376.5,-26 546376.5,-78"/>
<text text-anchor="middle" x="546304" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="546304" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="546304" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="546304" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L9_EP1TP1PP1DP0_GPU44 -->
<g id="node2660" class="node">
<title>gate_L9_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightyellow" stroke="black" points="546713.16,-104 546474.29,-104 546412.84,0 546651.71,0 546713.16,-104"/>
<text text-anchor="middle" x="546563" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="546563" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="546563" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="546563" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L9_EP1TP1PP1DP0_GPU44 -->
<g id="node2661" class="node">
<title>dispatch_L9_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="546852" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="546852" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="546852" y="-44" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP0_GPU44</text>
</g>
<!-- expert_0_L9_EP1TP1PP1DP0_GPU44 -->
<g id="node2662" class="node">
<title>expert_0_L9_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="547135.5,-78 546990.5,-78 546990.5,-26 547135.5,-26 547135.5,-78"/>
<text text-anchor="middle" x="547063" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="547063" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="547063" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="547063" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L9_EP1TP1PP1DP0_GPU44 -->
<g id="node2663" class="node">
<title>expert_1_L9_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="547316.5,-78 547171.5,-78 547171.5,-26 547316.5,-26 547316.5,-78"/>
<text text-anchor="middle" x="547244" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="547244" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="547244" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="547244" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L9_EP1TP1PP1DP0_GPU44 -->
<g id="node2664" class="node">
<title>expert_2_L9_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="547497.5,-78 547352.5,-78 547352.5,-26 547497.5,-26 547497.5,-78"/>
<text text-anchor="middle" x="547425" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="547425" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="547425" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="547425" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L9_EP1TP1PP1DP0_GPU44 -->
<g id="node2665" class="node">
<title>expert_3_L9_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="547678.5,-78 547533.5,-78 547533.5,-26 547678.5,-26 547678.5,-78"/>
<text text-anchor="middle" x="547606" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="547606" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="547606" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="547606" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L9_EP1TP1PP1DP0_GPU44 -->
<g id="node2666" class="node">
<title>combine_L9_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="547817" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="547817" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="547817" y="-44" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP0_GPU44</text>
</g>
<!-- ffn_L9_EP1TP1PP1DP0_GPU44 -->
<g id="node2667" class="node">
<title>ffn_L9_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="548126,-78 547956,-78 547956,-26 548126,-26 548126,-78"/>
<text text-anchor="middle" x="548041" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="548041" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="548041" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="548041" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L9_EP1TP1PP1DP0_GPU44 -->
<g id="node2668" class="node">
<title>ffn_ar_L9_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="548265" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="548265" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="548265" y="-49.5" font-family="Arial" font-size="10.00">L9 EP1 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="548265" y="-38.5" font-family="Arial" font-size="10.00">GPU44</text>
</g>
<!-- residual2_L9_EP1TP1PP1DP0_GPU44 -->
<g id="node2669" class="node">
<title>residual2_L9_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="548550,-78 548404,-78 548404,-26 548550,-26 548550,-78"/>
<text text-anchor="middle" x="548477" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="548477" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="548477" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="548477" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L9_EP1TP1PP1DP1_GPU45 -->
<g id="node2670" class="node">
<title>ln1_L9_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="548731.5,-78 548586.5,-78 548586.5,-26 548731.5,-26 548731.5,-78"/>
<text text-anchor="middle" x="548659" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="548659" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="548659" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="548659" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L9_EP1TP1PP1DP1_GPU45 -->
<g id="node2671" class="node">
<title>qkv_L9_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="548912.5,-78 548767.5,-78 548767.5,-26 548912.5,-26 548912.5,-78"/>
<text text-anchor="middle" x="548840" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="548840" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="548840" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="548840" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L9_EP1TP1PP1DP1_GPU45 -->
<g id="node2672" class="node">
<title>attn_L9_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="549099.5,-78 548948.5,-78 548948.5,-26 549099.5,-26 549099.5,-78"/>
<text text-anchor="middle" x="549024" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="549024" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="549024" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="549024" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L9_EP1TP1PP1DP1_GPU45 -->
<g id="node2673" class="node">
<title>attn_out_L9_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="549280.5,-78 549135.5,-78 549135.5,-26 549280.5,-26 549280.5,-78"/>
<text text-anchor="middle" x="549208" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="549208" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="549208" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="549208" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L9_EP1TP1PP1DP1_GPU45 -->
<g id="node2674" class="node">
<title>attn_ar_L9_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="549420" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="549420" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="549420" y="-49.5" font-family="Arial" font-size="10.00">L9 EP1 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="549420" y="-38.5" font-family="Arial" font-size="10.00">GPU45</text>
</g>
<!-- residual1_L9_EP1TP1PP1DP1_GPU45 -->
<g id="node2675" class="node">
<title>residual1_L9_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="549705,-78 549559,-78 549559,-26 549705,-26 549705,-78"/>
<text text-anchor="middle" x="549632" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="549632" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="549632" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="549632" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L9_EP1TP1PP1DP1_GPU45 -->
<g id="node2676" class="node">
<title>ln2_L9_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="549886.5,-78 549741.5,-78 549741.5,-26 549886.5,-26 549886.5,-78"/>
<text text-anchor="middle" x="549814" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="549814" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="549814" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="549814" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L9_EP1TP1PP1DP1_GPU45 -->
<g id="node2677" class="node">
<title>gate_L9_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightyellow" stroke="black" points="550223.16,-104 549984.29,-104 549922.84,0 550161.71,0 550223.16,-104"/>
<text text-anchor="middle" x="550073" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="550073" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="550073" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="550073" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L9_EP1TP1PP1DP1_GPU45 -->
<g id="node2678" class="node">
<title>dispatch_L9_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="550362" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="550362" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="550362" y="-44" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP1_GPU45</text>
</g>
<!-- expert_0_L9_EP1TP1PP1DP1_GPU45 -->
<g id="node2679" class="node">
<title>expert_0_L9_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="550645.5,-78 550500.5,-78 550500.5,-26 550645.5,-26 550645.5,-78"/>
<text text-anchor="middle" x="550573" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="550573" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="550573" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="550573" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L9_EP1TP1PP1DP1_GPU45 -->
<g id="node2680" class="node">
<title>expert_1_L9_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="550826.5,-78 550681.5,-78 550681.5,-26 550826.5,-26 550826.5,-78"/>
<text text-anchor="middle" x="550754" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="550754" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="550754" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="550754" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L9_EP1TP1PP1DP1_GPU45 -->
<g id="node2681" class="node">
<title>expert_2_L9_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="551007.5,-78 550862.5,-78 550862.5,-26 551007.5,-26 551007.5,-78"/>
<text text-anchor="middle" x="550935" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="550935" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="550935" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="550935" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L9_EP1TP1PP1DP1_GPU45 -->
<g id="node2682" class="node">
<title>expert_3_L9_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="551188.5,-78 551043.5,-78 551043.5,-26 551188.5,-26 551188.5,-78"/>
<text text-anchor="middle" x="551116" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="551116" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="551116" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="551116" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L9_EP1TP1PP1DP1_GPU45 -->
<g id="node2683" class="node">
<title>combine_L9_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="551327" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="551327" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="551327" y="-44" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP1_GPU45</text>
</g>
<!-- ffn_L9_EP1TP1PP1DP1_GPU45 -->
<g id="node2684" class="node">
<title>ffn_L9_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="551636,-78 551466,-78 551466,-26 551636,-26 551636,-78"/>
<text text-anchor="middle" x="551551" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="551551" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="551551" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="551551" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L9_EP1TP1PP1DP1_GPU45 -->
<g id="node2685" class="node">
<title>ffn_ar_L9_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="551775" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="551775" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="551775" y="-49.5" font-family="Arial" font-size="10.00">L9 EP1 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="551775" y="-38.5" font-family="Arial" font-size="10.00">GPU45</text>
</g>
<!-- residual2_L9_EP1TP1PP1DP1_GPU45 -->
<g id="node2686" class="node">
<title>residual2_L9_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="552060,-78 551914,-78 551914,-26 552060,-26 552060,-78"/>
<text text-anchor="middle" x="551987" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="551987" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="551987" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="551987" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L9_EP1TP2PP1DP0_GPU52 -->
<g id="node2687" class="node">
<title>ln1_L9_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="552241.5,-78 552096.5,-78 552096.5,-26 552241.5,-26 552241.5,-78"/>
<text text-anchor="middle" x="552169" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="552169" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="552169" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="552169" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L9_EP1TP2PP1DP0_GPU52 -->
<g id="node2688" class="node">
<title>qkv_L9_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="552422.5,-78 552277.5,-78 552277.5,-26 552422.5,-26 552422.5,-78"/>
<text text-anchor="middle" x="552350" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="552350" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="552350" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="552350" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L9_EP1TP2PP1DP0_GPU52 -->
<g id="node2689" class="node">
<title>attn_L9_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="552609.5,-78 552458.5,-78 552458.5,-26 552609.5,-26 552609.5,-78"/>
<text text-anchor="middle" x="552534" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="552534" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="552534" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="552534" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L9_EP1TP2PP1DP0_GPU52 -->
<g id="node2690" class="node">
<title>attn_out_L9_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="552790.5,-78 552645.5,-78 552645.5,-26 552790.5,-26 552790.5,-78"/>
<text text-anchor="middle" x="552718" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="552718" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="552718" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="552718" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L9_EP1TP2PP1DP0_GPU52 -->
<g id="node2691" class="node">
<title>attn_ar_L9_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="552930" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="552930" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="552930" y="-49.5" font-family="Arial" font-size="10.00">L9 EP1 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="552930" y="-38.5" font-family="Arial" font-size="10.00">GPU52</text>
</g>
<!-- residual1_L9_EP1TP2PP1DP0_GPU52 -->
<g id="node2692" class="node">
<title>residual1_L9_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="553215,-78 553069,-78 553069,-26 553215,-26 553215,-78"/>
<text text-anchor="middle" x="553142" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="553142" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="553142" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="553142" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L9_EP1TP2PP1DP0_GPU52 -->
<g id="node2693" class="node">
<title>ln2_L9_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="553396.5,-78 553251.5,-78 553251.5,-26 553396.5,-26 553396.5,-78"/>
<text text-anchor="middle" x="553324" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="553324" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="553324" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="553324" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L9_EP1TP2PP1DP0_GPU52 -->
<g id="node2694" class="node">
<title>gate_L9_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightyellow" stroke="black" points="553733.16,-104 553494.29,-104 553432.84,0 553671.71,0 553733.16,-104"/>
<text text-anchor="middle" x="553583" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="553583" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="553583" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="553583" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L9_EP1TP2PP1DP0_GPU52 -->
<g id="node2695" class="node">
<title>dispatch_L9_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="553872" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="553872" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="553872" y="-44" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP0_GPU52</text>
</g>
<!-- expert_0_L9_EP1TP2PP1DP0_GPU52 -->
<g id="node2696" class="node">
<title>expert_0_L9_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="554155.5,-78 554010.5,-78 554010.5,-26 554155.5,-26 554155.5,-78"/>
<text text-anchor="middle" x="554083" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="554083" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="554083" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="554083" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L9_EP1TP2PP1DP0_GPU52 -->
<g id="node2697" class="node">
<title>expert_1_L9_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="554336.5,-78 554191.5,-78 554191.5,-26 554336.5,-26 554336.5,-78"/>
<text text-anchor="middle" x="554264" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="554264" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="554264" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="554264" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L9_EP1TP2PP1DP0_GPU52 -->
<g id="node2698" class="node">
<title>expert_2_L9_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="554517.5,-78 554372.5,-78 554372.5,-26 554517.5,-26 554517.5,-78"/>
<text text-anchor="middle" x="554445" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="554445" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="554445" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="554445" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L9_EP1TP2PP1DP0_GPU52 -->
<g id="node2699" class="node">
<title>expert_3_L9_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="554698.5,-78 554553.5,-78 554553.5,-26 554698.5,-26 554698.5,-78"/>
<text text-anchor="middle" x="554626" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="554626" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="554626" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="554626" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L9_EP1TP2PP1DP0_GPU52 -->
<g id="node2700" class="node">
<title>combine_L9_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="554837" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="554837" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="554837" y="-44" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP0_GPU52</text>
</g>
<!-- ffn_L9_EP1TP2PP1DP0_GPU52 -->
<g id="node2701" class="node">
<title>ffn_L9_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="555146,-78 554976,-78 554976,-26 555146,-26 555146,-78"/>
<text text-anchor="middle" x="555061" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="555061" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="555061" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="555061" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L9_EP1TP2PP1DP0_GPU52 -->
<g id="node2702" class="node">
<title>ffn_ar_L9_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="555285" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="555285" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="555285" y="-49.5" font-family="Arial" font-size="10.00">L9 EP1 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="555285" y="-38.5" font-family="Arial" font-size="10.00">GPU52</text>
</g>
<!-- residual2_L9_EP1TP2PP1DP0_GPU52 -->
<g id="node2703" class="node">
<title>residual2_L9_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="555570,-78 555424,-78 555424,-26 555570,-26 555570,-78"/>
<text text-anchor="middle" x="555497" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="555497" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="555497" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="555497" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L9_EP1TP2PP1DP1_GPU53 -->
<g id="node2704" class="node">
<title>ln1_L9_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="555751.5,-78 555606.5,-78 555606.5,-26 555751.5,-26 555751.5,-78"/>
<text text-anchor="middle" x="555679" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="555679" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="555679" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="555679" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L9_EP1TP2PP1DP1_GPU53 -->
<g id="node2705" class="node">
<title>qkv_L9_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="555932.5,-78 555787.5,-78 555787.5,-26 555932.5,-26 555932.5,-78"/>
<text text-anchor="middle" x="555860" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="555860" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="555860" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="555860" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L9_EP1TP2PP1DP1_GPU53 -->
<g id="node2706" class="node">
<title>attn_L9_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="556119.5,-78 555968.5,-78 555968.5,-26 556119.5,-26 556119.5,-78"/>
<text text-anchor="middle" x="556044" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="556044" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="556044" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="556044" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L9_EP1TP2PP1DP1_GPU53 -->
<g id="node2707" class="node">
<title>attn_out_L9_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="556300.5,-78 556155.5,-78 556155.5,-26 556300.5,-26 556300.5,-78"/>
<text text-anchor="middle" x="556228" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="556228" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="556228" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="556228" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L9_EP1TP2PP1DP1_GPU53 -->
<g id="node2708" class="node">
<title>attn_ar_L9_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="556440" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="556440" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="556440" y="-49.5" font-family="Arial" font-size="10.00">L9 EP1 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="556440" y="-38.5" font-family="Arial" font-size="10.00">GPU53</text>
</g>
<!-- residual1_L9_EP1TP2PP1DP1_GPU53 -->
<g id="node2709" class="node">
<title>residual1_L9_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="556725,-78 556579,-78 556579,-26 556725,-26 556725,-78"/>
<text text-anchor="middle" x="556652" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="556652" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="556652" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="556652" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L9_EP1TP2PP1DP1_GPU53 -->
<g id="node2710" class="node">
<title>ln2_L9_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="556906.5,-78 556761.5,-78 556761.5,-26 556906.5,-26 556906.5,-78"/>
<text text-anchor="middle" x="556834" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="556834" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="556834" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="556834" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L9_EP1TP2PP1DP1_GPU53 -->
<g id="node2711" class="node">
<title>gate_L9_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightyellow" stroke="black" points="557243.16,-104 557004.29,-104 556942.84,0 557181.71,0 557243.16,-104"/>
<text text-anchor="middle" x="557093" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="557093" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="557093" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="557093" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L9_EP1TP2PP1DP1_GPU53 -->
<g id="node2712" class="node">
<title>dispatch_L9_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="557382" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="557382" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="557382" y="-44" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP1_GPU53</text>
</g>
<!-- expert_0_L9_EP1TP2PP1DP1_GPU53 -->
<g id="node2713" class="node">
<title>expert_0_L9_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="557665.5,-78 557520.5,-78 557520.5,-26 557665.5,-26 557665.5,-78"/>
<text text-anchor="middle" x="557593" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="557593" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="557593" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="557593" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L9_EP1TP2PP1DP1_GPU53 -->
<g id="node2714" class="node">
<title>expert_1_L9_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="557846.5,-78 557701.5,-78 557701.5,-26 557846.5,-26 557846.5,-78"/>
<text text-anchor="middle" x="557774" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="557774" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="557774" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="557774" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L9_EP1TP2PP1DP1_GPU53 -->
<g id="node2715" class="node">
<title>expert_2_L9_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="558027.5,-78 557882.5,-78 557882.5,-26 558027.5,-26 558027.5,-78"/>
<text text-anchor="middle" x="557955" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="557955" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="557955" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="557955" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L9_EP1TP2PP1DP1_GPU53 -->
<g id="node2716" class="node">
<title>expert_3_L9_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="558208.5,-78 558063.5,-78 558063.5,-26 558208.5,-26 558208.5,-78"/>
<text text-anchor="middle" x="558136" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="558136" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="558136" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="558136" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L9_EP1TP2PP1DP1_GPU53 -->
<g id="node2717" class="node">
<title>combine_L9_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="558347" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="558347" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="558347" y="-44" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP1_GPU53</text>
</g>
<!-- ffn_L9_EP1TP2PP1DP1_GPU53 -->
<g id="node2718" class="node">
<title>ffn_L9_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="558656,-78 558486,-78 558486,-26 558656,-26 558656,-78"/>
<text text-anchor="middle" x="558571" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="558571" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="558571" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="558571" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L9_EP1TP2PP1DP1_GPU53 -->
<g id="node2719" class="node">
<title>ffn_ar_L9_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="558795" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="558795" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="558795" y="-49.5" font-family="Arial" font-size="10.00">L9 EP1 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="558795" y="-38.5" font-family="Arial" font-size="10.00">GPU53</text>
</g>
<!-- residual2_L9_EP1TP2PP1DP1_GPU53 -->
<g id="node2720" class="node">
<title>residual2_L9_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="559080,-78 558934,-78 558934,-26 559080,-26 559080,-78"/>
<text text-anchor="middle" x="559007" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="559007" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="559007" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="559007" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L9_EP1TP3PP1DP0_GPU60 -->
<g id="node2721" class="node">
<title>ln1_L9_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="559261.5,-78 559116.5,-78 559116.5,-26 559261.5,-26 559261.5,-78"/>
<text text-anchor="middle" x="559189" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="559189" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="559189" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="559189" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L9_EP1TP3PP1DP0_GPU60 -->
<g id="node2722" class="node">
<title>qkv_L9_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="559442.5,-78 559297.5,-78 559297.5,-26 559442.5,-26 559442.5,-78"/>
<text text-anchor="middle" x="559370" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="559370" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="559370" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="559370" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L9_EP1TP3PP1DP0_GPU60 -->
<g id="node2723" class="node">
<title>attn_L9_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="559629.5,-78 559478.5,-78 559478.5,-26 559629.5,-26 559629.5,-78"/>
<text text-anchor="middle" x="559554" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="559554" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="559554" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="559554" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L9_EP1TP3PP1DP0_GPU60 -->
<g id="node2724" class="node">
<title>attn_out_L9_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="559810.5,-78 559665.5,-78 559665.5,-26 559810.5,-26 559810.5,-78"/>
<text text-anchor="middle" x="559738" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="559738" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="559738" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="559738" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L9_EP1TP3PP1DP0_GPU60 -->
<g id="node2725" class="node">
<title>attn_ar_L9_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="559950" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="559950" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="559950" y="-49.5" font-family="Arial" font-size="10.00">L9 EP1 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="559950" y="-38.5" font-family="Arial" font-size="10.00">GPU60</text>
</g>
<!-- residual1_L9_EP1TP3PP1DP0_GPU60 -->
<g id="node2726" class="node">
<title>residual1_L9_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="560235,-78 560089,-78 560089,-26 560235,-26 560235,-78"/>
<text text-anchor="middle" x="560162" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="560162" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="560162" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="560162" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L9_EP1TP3PP1DP0_GPU60 -->
<g id="node2727" class="node">
<title>ln2_L9_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="560416.5,-78 560271.5,-78 560271.5,-26 560416.5,-26 560416.5,-78"/>
<text text-anchor="middle" x="560344" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="560344" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="560344" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="560344" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L9_EP1TP3PP1DP0_GPU60 -->
<g id="node2728" class="node">
<title>gate_L9_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightyellow" stroke="black" points="560753.16,-104 560514.29,-104 560452.84,0 560691.71,0 560753.16,-104"/>
<text text-anchor="middle" x="560603" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="560603" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="560603" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="560603" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L9_EP1TP3PP1DP0_GPU60 -->
<g id="node2729" class="node">
<title>dispatch_L9_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="560892" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="560892" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="560892" y="-44" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP0_GPU60</text>
</g>
<!-- expert_0_L9_EP1TP3PP1DP0_GPU60 -->
<g id="node2730" class="node">
<title>expert_0_L9_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="561175.5,-78 561030.5,-78 561030.5,-26 561175.5,-26 561175.5,-78"/>
<text text-anchor="middle" x="561103" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="561103" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="561103" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="561103" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L9_EP1TP3PP1DP0_GPU60 -->
<g id="node2731" class="node">
<title>expert_1_L9_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="561356.5,-78 561211.5,-78 561211.5,-26 561356.5,-26 561356.5,-78"/>
<text text-anchor="middle" x="561284" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="561284" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="561284" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="561284" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L9_EP1TP3PP1DP0_GPU60 -->
<g id="node2732" class="node">
<title>expert_2_L9_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="561537.5,-78 561392.5,-78 561392.5,-26 561537.5,-26 561537.5,-78"/>
<text text-anchor="middle" x="561465" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="561465" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="561465" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="561465" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L9_EP1TP3PP1DP0_GPU60 -->
<g id="node2733" class="node">
<title>expert_3_L9_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="561718.5,-78 561573.5,-78 561573.5,-26 561718.5,-26 561718.5,-78"/>
<text text-anchor="middle" x="561646" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="561646" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="561646" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="561646" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L9_EP1TP3PP1DP0_GPU60 -->
<g id="node2734" class="node">
<title>combine_L9_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="561857" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="561857" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="561857" y="-44" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP0_GPU60</text>
</g>
<!-- ffn_L9_EP1TP3PP1DP0_GPU60 -->
<g id="node2735" class="node">
<title>ffn_L9_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="562166,-78 561996,-78 561996,-26 562166,-26 562166,-78"/>
<text text-anchor="middle" x="562081" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="562081" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="562081" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="562081" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L9_EP1TP3PP1DP0_GPU60 -->
<g id="node2736" class="node">
<title>ffn_ar_L9_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="562305" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="562305" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="562305" y="-49.5" font-family="Arial" font-size="10.00">L9 EP1 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="562305" y="-38.5" font-family="Arial" font-size="10.00">GPU60</text>
</g>
<!-- residual2_L9_EP1TP3PP1DP0_GPU60 -->
<g id="node2737" class="node">
<title>residual2_L9_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="562590,-78 562444,-78 562444,-26 562590,-26 562590,-78"/>
<text text-anchor="middle" x="562517" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="562517" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="562517" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="562517" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L9_EP1TP3PP1DP1_GPU61 -->
<g id="node2738" class="node">
<title>ln1_L9_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="562771.5,-78 562626.5,-78 562626.5,-26 562771.5,-26 562771.5,-78"/>
<text text-anchor="middle" x="562699" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="562699" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="562699" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="562699" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L9_EP1TP3PP1DP1_GPU61 -->
<g id="node2739" class="node">
<title>qkv_L9_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="562952.5,-78 562807.5,-78 562807.5,-26 562952.5,-26 562952.5,-78"/>
<text text-anchor="middle" x="562880" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="562880" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="562880" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="562880" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L9_EP1TP3PP1DP1_GPU61 -->
<g id="node2740" class="node">
<title>attn_L9_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="563139.5,-78 562988.5,-78 562988.5,-26 563139.5,-26 563139.5,-78"/>
<text text-anchor="middle" x="563064" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="563064" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="563064" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="563064" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L9_EP1TP3PP1DP1_GPU61 -->
<g id="node2741" class="node">
<title>attn_out_L9_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="563320.5,-78 563175.5,-78 563175.5,-26 563320.5,-26 563320.5,-78"/>
<text text-anchor="middle" x="563248" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="563248" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="563248" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="563248" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L9_EP1TP3PP1DP1_GPU61 -->
<g id="node2742" class="node">
<title>attn_ar_L9_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="563460" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="563460" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="563460" y="-49.5" font-family="Arial" font-size="10.00">L9 EP1 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="563460" y="-38.5" font-family="Arial" font-size="10.00">GPU61</text>
</g>
<!-- residual1_L9_EP1TP3PP1DP1_GPU61 -->
<g id="node2743" class="node">
<title>residual1_L9_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="563745,-78 563599,-78 563599,-26 563745,-26 563745,-78"/>
<text text-anchor="middle" x="563672" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="563672" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="563672" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="563672" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L9_EP1TP3PP1DP1_GPU61 -->
<g id="node2744" class="node">
<title>ln2_L9_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="563926.5,-78 563781.5,-78 563781.5,-26 563926.5,-26 563926.5,-78"/>
<text text-anchor="middle" x="563854" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="563854" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="563854" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="563854" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L9_EP1TP3PP1DP1_GPU61 -->
<g id="node2745" class="node">
<title>gate_L9_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightyellow" stroke="black" points="564263.16,-104 564024.29,-104 563962.84,0 564201.71,0 564263.16,-104"/>
<text text-anchor="middle" x="564113" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="564113" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="564113" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="564113" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L9_EP1TP3PP1DP1_GPU61 -->
<g id="node2746" class="node">
<title>dispatch_L9_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="564402" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="564402" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="564402" y="-44" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP1_GPU61</text>
</g>
<!-- expert_0_L9_EP1TP3PP1DP1_GPU61 -->
<g id="node2747" class="node">
<title>expert_0_L9_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="564685.5,-78 564540.5,-78 564540.5,-26 564685.5,-26 564685.5,-78"/>
<text text-anchor="middle" x="564613" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="564613" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="564613" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="564613" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L9_EP1TP3PP1DP1_GPU61 -->
<g id="node2748" class="node">
<title>expert_1_L9_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="564866.5,-78 564721.5,-78 564721.5,-26 564866.5,-26 564866.5,-78"/>
<text text-anchor="middle" x="564794" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="564794" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="564794" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="564794" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L9_EP1TP3PP1DP1_GPU61 -->
<g id="node2749" class="node">
<title>expert_2_L9_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="565047.5,-78 564902.5,-78 564902.5,-26 565047.5,-26 565047.5,-78"/>
<text text-anchor="middle" x="564975" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="564975" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="564975" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="564975" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L9_EP1TP3PP1DP1_GPU61 -->
<g id="node2750" class="node">
<title>expert_3_L9_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="565228.5,-78 565083.5,-78 565083.5,-26 565228.5,-26 565228.5,-78"/>
<text text-anchor="middle" x="565156" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="565156" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="565156" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="565156" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L9_EP1TP3PP1DP1_GPU61 -->
<g id="node2751" class="node">
<title>combine_L9_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="565367" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="565367" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="565367" y="-44" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP1_GPU61</text>
</g>
<!-- ffn_L9_EP1TP3PP1DP1_GPU61 -->
<g id="node2752" class="node">
<title>ffn_L9_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="565676,-78 565506,-78 565506,-26 565676,-26 565676,-78"/>
<text text-anchor="middle" x="565591" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="565591" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="565591" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="565591" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L9_EP1TP3PP1DP1_GPU61 -->
<g id="node2753" class="node">
<title>ffn_ar_L9_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="565815" cy="-52" rx="103.48" ry="28.98"/>
<text text-anchor="middle" x="565815" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="565815" y="-49.5" font-family="Arial" font-size="10.00">L9 EP1 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="565815" y="-38.5" font-family="Arial" font-size="10.00">GPU61</text>
</g>
<!-- residual2_L9_EP1TP3PP1DP1_GPU61 -->
<g id="node2754" class="node">
<title>residual2_L9_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="566100,-78 565954,-78 565954,-26 566100,-26 566100,-78"/>
<text text-anchor="middle" x="566027" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="566027" y="-55" font-family="Arial" font-size="10.00">L9_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="566027" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="566027" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L10_EP0TP0PP1DP0_GPU4 -->
<g id="node2755" class="node">
<title>ln1_L10_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="566281.5,-78 566136.5,-78 566136.5,-26 566281.5,-26 566281.5,-78"/>
<text text-anchor="middle" x="566209" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="566209" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="566209" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="566209" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L10_EP0TP0PP1DP0_GPU4 -->
<g id="node2756" class="node">
<title>qkv_L10_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="566462.5,-78 566317.5,-78 566317.5,-26 566462.5,-26 566462.5,-78"/>
<text text-anchor="middle" x="566390" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="566390" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="566390" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="566390" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L10_EP0TP0PP1DP0_GPU4 -->
<g id="node2757" class="node">
<title>attn_L10_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="566649.5,-78 566498.5,-78 566498.5,-26 566649.5,-26 566649.5,-78"/>
<text text-anchor="middle" x="566574" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="566574" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="566574" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="566574" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L10_EP0TP0PP1DP0_GPU4 -->
<g id="node2758" class="node">
<title>attn_out_L10_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="566830.5,-78 566685.5,-78 566685.5,-26 566830.5,-26 566830.5,-78"/>
<text text-anchor="middle" x="566758" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="566758" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="566758" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="566758" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L10_EP0TP0PP1DP0_GPU4 -->
<g id="node2759" class="node">
<title>attn_ar_L10_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="566973" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="566973" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="566973" y="-49.5" font-family="Arial" font-size="10.00">L10 EP0 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="566973" y="-38.5" font-family="Arial" font-size="10.00">GPU4</text>
</g>
<!-- residual1_L10_EP0TP0PP1DP0_GPU4 -->
<g id="node2760" class="node">
<title>residual1_L10_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="567262,-78 567116,-78 567116,-26 567262,-26 567262,-78"/>
<text text-anchor="middle" x="567189" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="567189" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="567189" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="567189" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L10_EP0TP0PP1DP0_GPU4 -->
<g id="node2761" class="node">
<title>ln2_L10_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="567443.5,-78 567298.5,-78 567298.5,-26 567443.5,-26 567443.5,-78"/>
<text text-anchor="middle" x="567371" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="567371" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="567371" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="567371" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L10_EP0TP0PP1DP0_GPU4 -->
<g id="node2762" class="node">
<title>gate_L10_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightyellow" stroke="black" points="567780.16,-104 567541.29,-104 567479.84,0 567718.71,0 567780.16,-104"/>
<text text-anchor="middle" x="567630" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="567630" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="567630" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="567630" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L10_EP0TP0PP1DP0_GPU4 -->
<g id="node2763" class="node">
<title>dispatch_L10_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="567919" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="567919" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="567919" y="-44" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP0_GPU4</text>
</g>
<!-- expert_0_L10_EP0TP0PP1DP0_GPU4 -->
<g id="node2764" class="node">
<title>expert_0_L10_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="568202.5,-78 568057.5,-78 568057.5,-26 568202.5,-26 568202.5,-78"/>
<text text-anchor="middle" x="568130" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="568130" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="568130" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="568130" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L10_EP0TP0PP1DP0_GPU4 -->
<g id="node2765" class="node">
<title>expert_1_L10_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="568383.5,-78 568238.5,-78 568238.5,-26 568383.5,-26 568383.5,-78"/>
<text text-anchor="middle" x="568311" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="568311" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="568311" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="568311" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L10_EP0TP0PP1DP0_GPU4 -->
<g id="node2766" class="node">
<title>expert_2_L10_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="568564.5,-78 568419.5,-78 568419.5,-26 568564.5,-26 568564.5,-78"/>
<text text-anchor="middle" x="568492" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="568492" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="568492" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="568492" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L10_EP0TP0PP1DP0_GPU4 -->
<g id="node2767" class="node">
<title>expert_3_L10_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="568745.5,-78 568600.5,-78 568600.5,-26 568745.5,-26 568745.5,-78"/>
<text text-anchor="middle" x="568673" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="568673" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="568673" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="568673" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L10_EP0TP0PP1DP0_GPU4 -->
<g id="node2768" class="node">
<title>combine_L10_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="568884" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="568884" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="568884" y="-44" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP0_GPU4</text>
</g>
<!-- ffn_L10_EP0TP0PP1DP0_GPU4 -->
<g id="node2769" class="node">
<title>ffn_L10_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="569193,-78 569023,-78 569023,-26 569193,-26 569193,-78"/>
<text text-anchor="middle" x="569108" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="569108" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="569108" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="569108" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L10_EP0TP0PP1DP0_GPU4 -->
<g id="node2770" class="node">
<title>ffn_ar_L10_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="569336" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="569336" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="569336" y="-49.5" font-family="Arial" font-size="10.00">L10 EP0 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="569336" y="-38.5" font-family="Arial" font-size="10.00">GPU4</text>
</g>
<!-- residual2_L10_EP0TP0PP1DP0_GPU4 -->
<g id="node2771" class="node">
<title>residual2_L10_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="569625,-78 569479,-78 569479,-26 569625,-26 569625,-78"/>
<text text-anchor="middle" x="569552" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="569552" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="569552" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="569552" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L10_EP0TP0PP1DP1_GPU5 -->
<g id="node2772" class="node">
<title>ln1_L10_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="569806.5,-78 569661.5,-78 569661.5,-26 569806.5,-26 569806.5,-78"/>
<text text-anchor="middle" x="569734" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="569734" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="569734" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="569734" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L10_EP0TP0PP1DP1_GPU5 -->
<g id="node2773" class="node">
<title>qkv_L10_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="569987.5,-78 569842.5,-78 569842.5,-26 569987.5,-26 569987.5,-78"/>
<text text-anchor="middle" x="569915" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="569915" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="569915" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="569915" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L10_EP0TP0PP1DP1_GPU5 -->
<g id="node2774" class="node">
<title>attn_L10_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="570174.5,-78 570023.5,-78 570023.5,-26 570174.5,-26 570174.5,-78"/>
<text text-anchor="middle" x="570099" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="570099" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="570099" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="570099" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L10_EP0TP0PP1DP1_GPU5 -->
<g id="node2775" class="node">
<title>attn_out_L10_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="570355.5,-78 570210.5,-78 570210.5,-26 570355.5,-26 570355.5,-78"/>
<text text-anchor="middle" x="570283" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="570283" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="570283" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="570283" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L10_EP0TP0PP1DP1_GPU5 -->
<g id="node2776" class="node">
<title>attn_ar_L10_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="570498" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="570498" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="570498" y="-49.5" font-family="Arial" font-size="10.00">L10 EP0 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="570498" y="-38.5" font-family="Arial" font-size="10.00">GPU5</text>
</g>
<!-- residual1_L10_EP0TP0PP1DP1_GPU5 -->
<g id="node2777" class="node">
<title>residual1_L10_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="570787,-78 570641,-78 570641,-26 570787,-26 570787,-78"/>
<text text-anchor="middle" x="570714" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="570714" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="570714" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="570714" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L10_EP0TP0PP1DP1_GPU5 -->
<g id="node2778" class="node">
<title>ln2_L10_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="570968.5,-78 570823.5,-78 570823.5,-26 570968.5,-26 570968.5,-78"/>
<text text-anchor="middle" x="570896" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="570896" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="570896" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="570896" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L10_EP0TP0PP1DP1_GPU5 -->
<g id="node2779" class="node">
<title>gate_L10_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightyellow" stroke="black" points="571305.16,-104 571066.29,-104 571004.84,0 571243.71,0 571305.16,-104"/>
<text text-anchor="middle" x="571155" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="571155" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="571155" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="571155" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L10_EP0TP0PP1DP1_GPU5 -->
<g id="node2780" class="node">
<title>dispatch_L10_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="571444" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="571444" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="571444" y="-44" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP1_GPU5</text>
</g>
<!-- expert_0_L10_EP0TP0PP1DP1_GPU5 -->
<g id="node2781" class="node">
<title>expert_0_L10_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="571727.5,-78 571582.5,-78 571582.5,-26 571727.5,-26 571727.5,-78"/>
<text text-anchor="middle" x="571655" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="571655" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="571655" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="571655" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L10_EP0TP0PP1DP1_GPU5 -->
<g id="node2782" class="node">
<title>expert_1_L10_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="571908.5,-78 571763.5,-78 571763.5,-26 571908.5,-26 571908.5,-78"/>
<text text-anchor="middle" x="571836" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="571836" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="571836" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="571836" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L10_EP0TP0PP1DP1_GPU5 -->
<g id="node2783" class="node">
<title>expert_2_L10_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="572089.5,-78 571944.5,-78 571944.5,-26 572089.5,-26 572089.5,-78"/>
<text text-anchor="middle" x="572017" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="572017" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="572017" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="572017" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L10_EP0TP0PP1DP1_GPU5 -->
<g id="node2784" class="node">
<title>expert_3_L10_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="572270.5,-78 572125.5,-78 572125.5,-26 572270.5,-26 572270.5,-78"/>
<text text-anchor="middle" x="572198" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="572198" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="572198" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="572198" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L10_EP0TP0PP1DP1_GPU5 -->
<g id="node2785" class="node">
<title>combine_L10_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="572409" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="572409" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="572409" y="-44" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP1_GPU5</text>
</g>
<!-- ffn_L10_EP0TP0PP1DP1_GPU5 -->
<g id="node2786" class="node">
<title>ffn_L10_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="572718,-78 572548,-78 572548,-26 572718,-26 572718,-78"/>
<text text-anchor="middle" x="572633" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="572633" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="572633" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="572633" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L10_EP0TP0PP1DP1_GPU5 -->
<g id="node2787" class="node">
<title>ffn_ar_L10_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="572861" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="572861" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="572861" y="-49.5" font-family="Arial" font-size="10.00">L10 EP0 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="572861" y="-38.5" font-family="Arial" font-size="10.00">GPU5</text>
</g>
<!-- residual2_L10_EP0TP0PP1DP1_GPU5 -->
<g id="node2788" class="node">
<title>residual2_L10_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="573150,-78 573004,-78 573004,-26 573150,-26 573150,-78"/>
<text text-anchor="middle" x="573077" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="573077" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="573077" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="573077" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L10_EP0TP1PP1DP0_GPU12 -->
<g id="node2789" class="node">
<title>ln1_L10_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="573336,-78 573186,-78 573186,-26 573336,-26 573336,-78"/>
<text text-anchor="middle" x="573261" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="573261" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="573261" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="573261" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L10_EP0TP1PP1DP0_GPU12 -->
<g id="node2790" class="node">
<title>qkv_L10_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="573522,-78 573372,-78 573372,-26 573522,-26 573522,-78"/>
<text text-anchor="middle" x="573447" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="573447" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="573447" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="573447" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L10_EP0TP1PP1DP0_GPU12 -->
<g id="node2791" class="node">
<title>attn_L10_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="573709.5,-78 573558.5,-78 573558.5,-26 573709.5,-26 573709.5,-78"/>
<text text-anchor="middle" x="573634" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="573634" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="573634" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="573634" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L10_EP0TP1PP1DP0_GPU12 -->
<g id="node2792" class="node">
<title>attn_out_L10_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="573896,-78 573746,-78 573746,-26 573896,-26 573896,-78"/>
<text text-anchor="middle" x="573821" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="573821" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="573821" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="573821" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L10_EP0TP1PP1DP0_GPU12 -->
<g id="node2793" class="node">
<title>attn_ar_L10_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="574039" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="574039" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="574039" y="-49.5" font-family="Arial" font-size="10.00">L10 EP0 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="574039" y="-38.5" font-family="Arial" font-size="10.00">GPU12</text>
</g>
<!-- residual1_L10_EP0TP1PP1DP0_GPU12 -->
<g id="node2794" class="node">
<title>residual1_L10_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="574332,-78 574182,-78 574182,-26 574332,-26 574332,-78"/>
<text text-anchor="middle" x="574257" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="574257" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="574257" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="574257" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L10_EP0TP1PP1DP0_GPU12 -->
<g id="node2795" class="node">
<title>ln2_L10_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="574518,-78 574368,-78 574368,-26 574518,-26 574518,-78"/>
<text text-anchor="middle" x="574443" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="574443" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="574443" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="574443" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L10_EP0TP1PP1DP0_GPU12 -->
<g id="node2796" class="node">
<title>gate_L10_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightyellow" stroke="black" points="574865.53,-104 574618.12,-104 574554.47,0 574801.88,0 574865.53,-104"/>
<text text-anchor="middle" x="574710" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="574710" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="574710" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="574710" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L10_EP0TP1PP1DP0_GPU12 -->
<g id="node2797" class="node">
<title>dispatch_L10_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="575008" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="575008" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="575008" y="-44" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP0_GPU12</text>
</g>
<!-- expert_0_L10_EP0TP1PP1DP0_GPU12 -->
<g id="node2798" class="node">
<title>expert_0_L10_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="575300,-78 575150,-78 575150,-26 575300,-26 575300,-78"/>
<text text-anchor="middle" x="575225" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="575225" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="575225" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="575225" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L10_EP0TP1PP1DP0_GPU12 -->
<g id="node2799" class="node">
<title>expert_1_L10_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="575486,-78 575336,-78 575336,-26 575486,-26 575486,-78"/>
<text text-anchor="middle" x="575411" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="575411" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="575411" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="575411" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L10_EP0TP1PP1DP0_GPU12 -->
<g id="node2800" class="node">
<title>expert_2_L10_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="575672,-78 575522,-78 575522,-26 575672,-26 575672,-78"/>
<text text-anchor="middle" x="575597" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="575597" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="575597" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="575597" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L10_EP0TP1PP1DP0_GPU12 -->
<g id="node2801" class="node">
<title>expert_3_L10_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="575858,-78 575708,-78 575708,-26 575858,-26 575858,-78"/>
<text text-anchor="middle" x="575783" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="575783" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="575783" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="575783" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L10_EP0TP1PP1DP0_GPU12 -->
<g id="node2802" class="node">
<title>combine_L10_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="576000" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="576000" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="576000" y="-44" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP0_GPU12</text>
</g>
<!-- ffn_L10_EP0TP1PP1DP0_GPU12 -->
<g id="node2803" class="node">
<title>ffn_L10_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="576312,-78 576142,-78 576142,-26 576312,-26 576312,-78"/>
<text text-anchor="middle" x="576227" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="576227" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="576227" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="576227" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L10_EP0TP1PP1DP0_GPU12 -->
<g id="node2804" class="node">
<title>ffn_ar_L10_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="576455" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="576455" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="576455" y="-49.5" font-family="Arial" font-size="10.00">L10 EP0 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="576455" y="-38.5" font-family="Arial" font-size="10.00">GPU12</text>
</g>
<!-- residual2_L10_EP0TP1PP1DP0_GPU12 -->
<g id="node2805" class="node">
<title>residual2_L10_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="576748,-78 576598,-78 576598,-26 576748,-26 576748,-78"/>
<text text-anchor="middle" x="576673" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="576673" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="576673" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="576673" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L10_EP0TP1PP1DP1_GPU13 -->
<g id="node2806" class="node">
<title>ln1_L10_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="576934,-78 576784,-78 576784,-26 576934,-26 576934,-78"/>
<text text-anchor="middle" x="576859" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="576859" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="576859" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="576859" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L10_EP0TP1PP1DP1_GPU13 -->
<g id="node2807" class="node">
<title>qkv_L10_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="577120,-78 576970,-78 576970,-26 577120,-26 577120,-78"/>
<text text-anchor="middle" x="577045" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="577045" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="577045" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="577045" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L10_EP0TP1PP1DP1_GPU13 -->
<g id="node2808" class="node">
<title>attn_L10_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="577307.5,-78 577156.5,-78 577156.5,-26 577307.5,-26 577307.5,-78"/>
<text text-anchor="middle" x="577232" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="577232" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="577232" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="577232" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L10_EP0TP1PP1DP1_GPU13 -->
<g id="node2809" class="node">
<title>attn_out_L10_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="577494,-78 577344,-78 577344,-26 577494,-26 577494,-78"/>
<text text-anchor="middle" x="577419" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="577419" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="577419" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="577419" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L10_EP0TP1PP1DP1_GPU13 -->
<g id="node2810" class="node">
<title>attn_ar_L10_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="577637" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="577637" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="577637" y="-49.5" font-family="Arial" font-size="10.00">L10 EP0 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="577637" y="-38.5" font-family="Arial" font-size="10.00">GPU13</text>
</g>
<!-- residual1_L10_EP0TP1PP1DP1_GPU13 -->
<g id="node2811" class="node">
<title>residual1_L10_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="577930,-78 577780,-78 577780,-26 577930,-26 577930,-78"/>
<text text-anchor="middle" x="577855" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="577855" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="577855" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="577855" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L10_EP0TP1PP1DP1_GPU13 -->
<g id="node2812" class="node">
<title>ln2_L10_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="578116,-78 577966,-78 577966,-26 578116,-26 578116,-78"/>
<text text-anchor="middle" x="578041" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="578041" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="578041" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="578041" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L10_EP0TP1PP1DP1_GPU13 -->
<g id="node2813" class="node">
<title>gate_L10_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightyellow" stroke="black" points="578463.53,-104 578216.12,-104 578152.47,0 578399.88,0 578463.53,-104"/>
<text text-anchor="middle" x="578308" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="578308" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="578308" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="578308" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L10_EP0TP1PP1DP1_GPU13 -->
<g id="node2814" class="node">
<title>dispatch_L10_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="578606" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="578606" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="578606" y="-44" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP1_GPU13</text>
</g>
<!-- expert_0_L10_EP0TP1PP1DP1_GPU13 -->
<g id="node2815" class="node">
<title>expert_0_L10_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="578898,-78 578748,-78 578748,-26 578898,-26 578898,-78"/>
<text text-anchor="middle" x="578823" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="578823" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="578823" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="578823" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L10_EP0TP1PP1DP1_GPU13 -->
<g id="node2816" class="node">
<title>expert_1_L10_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="579084,-78 578934,-78 578934,-26 579084,-26 579084,-78"/>
<text text-anchor="middle" x="579009" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="579009" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="579009" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="579009" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L10_EP0TP1PP1DP1_GPU13 -->
<g id="node2817" class="node">
<title>expert_2_L10_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="579270,-78 579120,-78 579120,-26 579270,-26 579270,-78"/>
<text text-anchor="middle" x="579195" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="579195" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="579195" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="579195" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L10_EP0TP1PP1DP1_GPU13 -->
<g id="node2818" class="node">
<title>expert_3_L10_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="579456,-78 579306,-78 579306,-26 579456,-26 579456,-78"/>
<text text-anchor="middle" x="579381" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="579381" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="579381" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="579381" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L10_EP0TP1PP1DP1_GPU13 -->
<g id="node2819" class="node">
<title>combine_L10_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="579598" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="579598" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="579598" y="-44" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP1_GPU13</text>
</g>
<!-- ffn_L10_EP0TP1PP1DP1_GPU13 -->
<g id="node2820" class="node">
<title>ffn_L10_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="579910,-78 579740,-78 579740,-26 579910,-26 579910,-78"/>
<text text-anchor="middle" x="579825" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="579825" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="579825" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="579825" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L10_EP0TP1PP1DP1_GPU13 -->
<g id="node2821" class="node">
<title>ffn_ar_L10_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="580053" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="580053" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="580053" y="-49.5" font-family="Arial" font-size="10.00">L10 EP0 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="580053" y="-38.5" font-family="Arial" font-size="10.00">GPU13</text>
</g>
<!-- residual2_L10_EP0TP1PP1DP1_GPU13 -->
<g id="node2822" class="node">
<title>residual2_L10_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="580346,-78 580196,-78 580196,-26 580346,-26 580346,-78"/>
<text text-anchor="middle" x="580271" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="580271" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="580271" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="580271" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L10_EP0TP2PP1DP0_GPU20 -->
<g id="node2823" class="node">
<title>ln1_L10_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="580532,-78 580382,-78 580382,-26 580532,-26 580532,-78"/>
<text text-anchor="middle" x="580457" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="580457" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="580457" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="580457" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L10_EP0TP2PP1DP0_GPU20 -->
<g id="node2824" class="node">
<title>qkv_L10_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="580718,-78 580568,-78 580568,-26 580718,-26 580718,-78"/>
<text text-anchor="middle" x="580643" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="580643" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="580643" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="580643" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L10_EP0TP2PP1DP0_GPU20 -->
<g id="node2825" class="node">
<title>attn_L10_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="580905.5,-78 580754.5,-78 580754.5,-26 580905.5,-26 580905.5,-78"/>
<text text-anchor="middle" x="580830" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="580830" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="580830" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="580830" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L10_EP0TP2PP1DP0_GPU20 -->
<g id="node2826" class="node">
<title>attn_out_L10_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="581092,-78 580942,-78 580942,-26 581092,-26 581092,-78"/>
<text text-anchor="middle" x="581017" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="581017" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="581017" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="581017" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L10_EP0TP2PP1DP0_GPU20 -->
<g id="node2827" class="node">
<title>attn_ar_L10_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="581235" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="581235" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="581235" y="-49.5" font-family="Arial" font-size="10.00">L10 EP0 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="581235" y="-38.5" font-family="Arial" font-size="10.00">GPU20</text>
</g>
<!-- residual1_L10_EP0TP2PP1DP0_GPU20 -->
<g id="node2828" class="node">
<title>residual1_L10_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="581528,-78 581378,-78 581378,-26 581528,-26 581528,-78"/>
<text text-anchor="middle" x="581453" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="581453" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="581453" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="581453" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L10_EP0TP2PP1DP0_GPU20 -->
<g id="node2829" class="node">
<title>ln2_L10_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="581714,-78 581564,-78 581564,-26 581714,-26 581714,-78"/>
<text text-anchor="middle" x="581639" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="581639" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="581639" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="581639" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L10_EP0TP2PP1DP0_GPU20 -->
<g id="node2830" class="node">
<title>gate_L10_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightyellow" stroke="black" points="582061.53,-104 581814.12,-104 581750.47,0 581997.88,0 582061.53,-104"/>
<text text-anchor="middle" x="581906" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="581906" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="581906" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="581906" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L10_EP0TP2PP1DP0_GPU20 -->
<g id="node2831" class="node">
<title>dispatch_L10_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="582204" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="582204" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="582204" y="-44" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP0_GPU20</text>
</g>
<!-- expert_0_L10_EP0TP2PP1DP0_GPU20 -->
<g id="node2832" class="node">
<title>expert_0_L10_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="582496,-78 582346,-78 582346,-26 582496,-26 582496,-78"/>
<text text-anchor="middle" x="582421" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="582421" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="582421" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="582421" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L10_EP0TP2PP1DP0_GPU20 -->
<g id="node2833" class="node">
<title>expert_1_L10_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="582682,-78 582532,-78 582532,-26 582682,-26 582682,-78"/>
<text text-anchor="middle" x="582607" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="582607" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="582607" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="582607" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L10_EP0TP2PP1DP0_GPU20 -->
<g id="node2834" class="node">
<title>expert_2_L10_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="582868,-78 582718,-78 582718,-26 582868,-26 582868,-78"/>
<text text-anchor="middle" x="582793" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="582793" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="582793" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="582793" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L10_EP0TP2PP1DP0_GPU20 -->
<g id="node2835" class="node">
<title>expert_3_L10_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="583054,-78 582904,-78 582904,-26 583054,-26 583054,-78"/>
<text text-anchor="middle" x="582979" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="582979" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="582979" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="582979" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L10_EP0TP2PP1DP0_GPU20 -->
<g id="node2836" class="node">
<title>combine_L10_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="583196" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="583196" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="583196" y="-44" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP0_GPU20</text>
</g>
<!-- ffn_L10_EP0TP2PP1DP0_GPU20 -->
<g id="node2837" class="node">
<title>ffn_L10_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="583508,-78 583338,-78 583338,-26 583508,-26 583508,-78"/>
<text text-anchor="middle" x="583423" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="583423" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="583423" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="583423" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L10_EP0TP2PP1DP0_GPU20 -->
<g id="node2838" class="node">
<title>ffn_ar_L10_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="583651" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="583651" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="583651" y="-49.5" font-family="Arial" font-size="10.00">L10 EP0 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="583651" y="-38.5" font-family="Arial" font-size="10.00">GPU20</text>
</g>
<!-- residual2_L10_EP0TP2PP1DP0_GPU20 -->
<g id="node2839" class="node">
<title>residual2_L10_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="583944,-78 583794,-78 583794,-26 583944,-26 583944,-78"/>
<text text-anchor="middle" x="583869" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="583869" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="583869" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="583869" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L10_EP0TP2PP1DP1_GPU21 -->
<g id="node2840" class="node">
<title>ln1_L10_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="584130,-78 583980,-78 583980,-26 584130,-26 584130,-78"/>
<text text-anchor="middle" x="584055" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="584055" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="584055" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="584055" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L10_EP0TP2PP1DP1_GPU21 -->
<g id="node2841" class="node">
<title>qkv_L10_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="584316,-78 584166,-78 584166,-26 584316,-26 584316,-78"/>
<text text-anchor="middle" x="584241" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="584241" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="584241" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="584241" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L10_EP0TP2PP1DP1_GPU21 -->
<g id="node2842" class="node">
<title>attn_L10_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="584503.5,-78 584352.5,-78 584352.5,-26 584503.5,-26 584503.5,-78"/>
<text text-anchor="middle" x="584428" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="584428" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="584428" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="584428" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L10_EP0TP2PP1DP1_GPU21 -->
<g id="node2843" class="node">
<title>attn_out_L10_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="584690,-78 584540,-78 584540,-26 584690,-26 584690,-78"/>
<text text-anchor="middle" x="584615" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="584615" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="584615" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="584615" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L10_EP0TP2PP1DP1_GPU21 -->
<g id="node2844" class="node">
<title>attn_ar_L10_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="584833" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="584833" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="584833" y="-49.5" font-family="Arial" font-size="10.00">L10 EP0 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="584833" y="-38.5" font-family="Arial" font-size="10.00">GPU21</text>
</g>
<!-- residual1_L10_EP0TP2PP1DP1_GPU21 -->
<g id="node2845" class="node">
<title>residual1_L10_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="585126,-78 584976,-78 584976,-26 585126,-26 585126,-78"/>
<text text-anchor="middle" x="585051" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="585051" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="585051" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="585051" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L10_EP0TP2PP1DP1_GPU21 -->
<g id="node2846" class="node">
<title>ln2_L10_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="585312,-78 585162,-78 585162,-26 585312,-26 585312,-78"/>
<text text-anchor="middle" x="585237" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="585237" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="585237" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="585237" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L10_EP0TP2PP1DP1_GPU21 -->
<g id="node2847" class="node">
<title>gate_L10_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightyellow" stroke="black" points="585659.53,-104 585412.12,-104 585348.47,0 585595.88,0 585659.53,-104"/>
<text text-anchor="middle" x="585504" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="585504" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="585504" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="585504" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L10_EP0TP2PP1DP1_GPU21 -->
<g id="node2848" class="node">
<title>dispatch_L10_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="585802" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="585802" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="585802" y="-44" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP1_GPU21</text>
</g>
<!-- expert_0_L10_EP0TP2PP1DP1_GPU21 -->
<g id="node2849" class="node">
<title>expert_0_L10_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="586094,-78 585944,-78 585944,-26 586094,-26 586094,-78"/>
<text text-anchor="middle" x="586019" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="586019" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="586019" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="586019" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L10_EP0TP2PP1DP1_GPU21 -->
<g id="node2850" class="node">
<title>expert_1_L10_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="586280,-78 586130,-78 586130,-26 586280,-26 586280,-78"/>
<text text-anchor="middle" x="586205" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="586205" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="586205" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="586205" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L10_EP0TP2PP1DP1_GPU21 -->
<g id="node2851" class="node">
<title>expert_2_L10_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="586466,-78 586316,-78 586316,-26 586466,-26 586466,-78"/>
<text text-anchor="middle" x="586391" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="586391" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="586391" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="586391" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L10_EP0TP2PP1DP1_GPU21 -->
<g id="node2852" class="node">
<title>expert_3_L10_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="586652,-78 586502,-78 586502,-26 586652,-26 586652,-78"/>
<text text-anchor="middle" x="586577" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="586577" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="586577" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="586577" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L10_EP0TP2PP1DP1_GPU21 -->
<g id="node2853" class="node">
<title>combine_L10_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="586794" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="586794" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="586794" y="-44" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP1_GPU21</text>
</g>
<!-- ffn_L10_EP0TP2PP1DP1_GPU21 -->
<g id="node2854" class="node">
<title>ffn_L10_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="587106,-78 586936,-78 586936,-26 587106,-26 587106,-78"/>
<text text-anchor="middle" x="587021" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="587021" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="587021" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="587021" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L10_EP0TP2PP1DP1_GPU21 -->
<g id="node2855" class="node">
<title>ffn_ar_L10_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="587249" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="587249" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="587249" y="-49.5" font-family="Arial" font-size="10.00">L10 EP0 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="587249" y="-38.5" font-family="Arial" font-size="10.00">GPU21</text>
</g>
<!-- residual2_L10_EP0TP2PP1DP1_GPU21 -->
<g id="node2856" class="node">
<title>residual2_L10_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="587542,-78 587392,-78 587392,-26 587542,-26 587542,-78"/>
<text text-anchor="middle" x="587467" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="587467" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="587467" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="587467" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L10_EP0TP3PP1DP0_GPU28 -->
<g id="node2857" class="node">
<title>ln1_L10_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="587728,-78 587578,-78 587578,-26 587728,-26 587728,-78"/>
<text text-anchor="middle" x="587653" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="587653" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="587653" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="587653" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L10_EP0TP3PP1DP0_GPU28 -->
<g id="node2858" class="node">
<title>qkv_L10_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="587914,-78 587764,-78 587764,-26 587914,-26 587914,-78"/>
<text text-anchor="middle" x="587839" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="587839" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="587839" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="587839" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L10_EP0TP3PP1DP0_GPU28 -->
<g id="node2859" class="node">
<title>attn_L10_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="588101.5,-78 587950.5,-78 587950.5,-26 588101.5,-26 588101.5,-78"/>
<text text-anchor="middle" x="588026" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="588026" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="588026" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="588026" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L10_EP0TP3PP1DP0_GPU28 -->
<g id="node2860" class="node">
<title>attn_out_L10_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="588288,-78 588138,-78 588138,-26 588288,-26 588288,-78"/>
<text text-anchor="middle" x="588213" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="588213" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="588213" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="588213" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L10_EP0TP3PP1DP0_GPU28 -->
<g id="node2861" class="node">
<title>attn_ar_L10_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="588431" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="588431" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="588431" y="-49.5" font-family="Arial" font-size="10.00">L10 EP0 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="588431" y="-38.5" font-family="Arial" font-size="10.00">GPU28</text>
</g>
<!-- residual1_L10_EP0TP3PP1DP0_GPU28 -->
<g id="node2862" class="node">
<title>residual1_L10_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="588724,-78 588574,-78 588574,-26 588724,-26 588724,-78"/>
<text text-anchor="middle" x="588649" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="588649" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="588649" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="588649" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L10_EP0TP3PP1DP0_GPU28 -->
<g id="node2863" class="node">
<title>ln2_L10_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="588910,-78 588760,-78 588760,-26 588910,-26 588910,-78"/>
<text text-anchor="middle" x="588835" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="588835" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="588835" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="588835" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L10_EP0TP3PP1DP0_GPU28 -->
<g id="node2864" class="node">
<title>gate_L10_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightyellow" stroke="black" points="589257.53,-104 589010.12,-104 588946.47,0 589193.88,0 589257.53,-104"/>
<text text-anchor="middle" x="589102" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="589102" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="589102" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="589102" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L10_EP0TP3PP1DP0_GPU28 -->
<g id="node2865" class="node">
<title>dispatch_L10_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="589400" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="589400" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="589400" y="-44" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP0_GPU28</text>
</g>
<!-- expert_0_L10_EP0TP3PP1DP0_GPU28 -->
<g id="node2866" class="node">
<title>expert_0_L10_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="589692,-78 589542,-78 589542,-26 589692,-26 589692,-78"/>
<text text-anchor="middle" x="589617" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="589617" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="589617" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="589617" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L10_EP0TP3PP1DP0_GPU28 -->
<g id="node2867" class="node">
<title>expert_1_L10_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="589878,-78 589728,-78 589728,-26 589878,-26 589878,-78"/>
<text text-anchor="middle" x="589803" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="589803" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="589803" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="589803" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L10_EP0TP3PP1DP0_GPU28 -->
<g id="node2868" class="node">
<title>expert_2_L10_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="590064,-78 589914,-78 589914,-26 590064,-26 590064,-78"/>
<text text-anchor="middle" x="589989" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="589989" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="589989" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="589989" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L10_EP0TP3PP1DP0_GPU28 -->
<g id="node2869" class="node">
<title>expert_3_L10_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="590250,-78 590100,-78 590100,-26 590250,-26 590250,-78"/>
<text text-anchor="middle" x="590175" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="590175" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="590175" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="590175" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L10_EP0TP3PP1DP0_GPU28 -->
<g id="node2870" class="node">
<title>combine_L10_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="590392" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="590392" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="590392" y="-44" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP0_GPU28</text>
</g>
<!-- ffn_L10_EP0TP3PP1DP0_GPU28 -->
<g id="node2871" class="node">
<title>ffn_L10_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="590704,-78 590534,-78 590534,-26 590704,-26 590704,-78"/>
<text text-anchor="middle" x="590619" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="590619" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="590619" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="590619" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L10_EP0TP3PP1DP0_GPU28 -->
<g id="node2872" class="node">
<title>ffn_ar_L10_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="590847" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="590847" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="590847" y="-49.5" font-family="Arial" font-size="10.00">L10 EP0 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="590847" y="-38.5" font-family="Arial" font-size="10.00">GPU28</text>
</g>
<!-- residual2_L10_EP0TP3PP1DP0_GPU28 -->
<g id="node2873" class="node">
<title>residual2_L10_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="591140,-78 590990,-78 590990,-26 591140,-26 591140,-78"/>
<text text-anchor="middle" x="591065" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="591065" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="591065" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="591065" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L10_EP0TP3PP1DP1_GPU29 -->
<g id="node2874" class="node">
<title>ln1_L10_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="591326,-78 591176,-78 591176,-26 591326,-26 591326,-78"/>
<text text-anchor="middle" x="591251" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="591251" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="591251" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="591251" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L10_EP0TP3PP1DP1_GPU29 -->
<g id="node2875" class="node">
<title>qkv_L10_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="591512,-78 591362,-78 591362,-26 591512,-26 591512,-78"/>
<text text-anchor="middle" x="591437" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="591437" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="591437" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="591437" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L10_EP0TP3PP1DP1_GPU29 -->
<g id="node2876" class="node">
<title>attn_L10_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="591699.5,-78 591548.5,-78 591548.5,-26 591699.5,-26 591699.5,-78"/>
<text text-anchor="middle" x="591624" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="591624" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="591624" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="591624" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L10_EP0TP3PP1DP1_GPU29 -->
<g id="node2877" class="node">
<title>attn_out_L10_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="591886,-78 591736,-78 591736,-26 591886,-26 591886,-78"/>
<text text-anchor="middle" x="591811" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="591811" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="591811" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="591811" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L10_EP0TP3PP1DP1_GPU29 -->
<g id="node2878" class="node">
<title>attn_ar_L10_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="592029" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="592029" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="592029" y="-49.5" font-family="Arial" font-size="10.00">L10 EP0 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="592029" y="-38.5" font-family="Arial" font-size="10.00">GPU29</text>
</g>
<!-- residual1_L10_EP0TP3PP1DP1_GPU29 -->
<g id="node2879" class="node">
<title>residual1_L10_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="592322,-78 592172,-78 592172,-26 592322,-26 592322,-78"/>
<text text-anchor="middle" x="592247" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="592247" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="592247" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="592247" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L10_EP0TP3PP1DP1_GPU29 -->
<g id="node2880" class="node">
<title>ln2_L10_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="592508,-78 592358,-78 592358,-26 592508,-26 592508,-78"/>
<text text-anchor="middle" x="592433" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="592433" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="592433" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="592433" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L10_EP0TP3PP1DP1_GPU29 -->
<g id="node2881" class="node">
<title>gate_L10_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightyellow" stroke="black" points="592855.53,-104 592608.12,-104 592544.47,0 592791.88,0 592855.53,-104"/>
<text text-anchor="middle" x="592700" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="592700" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="592700" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="592700" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L10_EP0TP3PP1DP1_GPU29 -->
<g id="node2882" class="node">
<title>dispatch_L10_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="592998" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="592998" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="592998" y="-44" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP1_GPU29</text>
</g>
<!-- expert_0_L10_EP0TP3PP1DP1_GPU29 -->
<g id="node2883" class="node">
<title>expert_0_L10_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="593290,-78 593140,-78 593140,-26 593290,-26 593290,-78"/>
<text text-anchor="middle" x="593215" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="593215" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="593215" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="593215" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L10_EP0TP3PP1DP1_GPU29 -->
<g id="node2884" class="node">
<title>expert_1_L10_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="593476,-78 593326,-78 593326,-26 593476,-26 593476,-78"/>
<text text-anchor="middle" x="593401" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="593401" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="593401" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="593401" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L10_EP0TP3PP1DP1_GPU29 -->
<g id="node2885" class="node">
<title>expert_2_L10_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="593662,-78 593512,-78 593512,-26 593662,-26 593662,-78"/>
<text text-anchor="middle" x="593587" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="593587" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="593587" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="593587" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L10_EP0TP3PP1DP1_GPU29 -->
<g id="node2886" class="node">
<title>expert_3_L10_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="593848,-78 593698,-78 593698,-26 593848,-26 593848,-78"/>
<text text-anchor="middle" x="593773" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="593773" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="593773" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="593773" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L10_EP0TP3PP1DP1_GPU29 -->
<g id="node2887" class="node">
<title>combine_L10_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="593990" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="593990" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="593990" y="-44" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP1_GPU29</text>
</g>
<!-- ffn_L10_EP0TP3PP1DP1_GPU29 -->
<g id="node2888" class="node">
<title>ffn_L10_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="594302,-78 594132,-78 594132,-26 594302,-26 594302,-78"/>
<text text-anchor="middle" x="594217" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="594217" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="594217" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="594217" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L10_EP0TP3PP1DP1_GPU29 -->
<g id="node2889" class="node">
<title>ffn_ar_L10_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="594445" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="594445" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="594445" y="-49.5" font-family="Arial" font-size="10.00">L10 EP0 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="594445" y="-38.5" font-family="Arial" font-size="10.00">GPU29</text>
</g>
<!-- residual2_L10_EP0TP3PP1DP1_GPU29 -->
<g id="node2890" class="node">
<title>residual2_L10_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="594738,-78 594588,-78 594588,-26 594738,-26 594738,-78"/>
<text text-anchor="middle" x="594663" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="594663" y="-55" font-family="Arial" font-size="10.00">L10_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="594663" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="594663" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L10_EP1TP0PP1DP0_GPU36 -->
<g id="node2891" class="node">
<title>ln1_L10_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="594924,-78 594774,-78 594774,-26 594924,-26 594924,-78"/>
<text text-anchor="middle" x="594849" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="594849" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="594849" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="594849" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L10_EP1TP0PP1DP0_GPU36 -->
<g id="node2892" class="node">
<title>qkv_L10_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="595110,-78 594960,-78 594960,-26 595110,-26 595110,-78"/>
<text text-anchor="middle" x="595035" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="595035" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="595035" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="595035" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L10_EP1TP0PP1DP0_GPU36 -->
<g id="node2893" class="node">
<title>attn_L10_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="595297.5,-78 595146.5,-78 595146.5,-26 595297.5,-26 595297.5,-78"/>
<text text-anchor="middle" x="595222" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="595222" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="595222" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="595222" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L10_EP1TP0PP1DP0_GPU36 -->
<g id="node2894" class="node">
<title>attn_out_L10_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="595484,-78 595334,-78 595334,-26 595484,-26 595484,-78"/>
<text text-anchor="middle" x="595409" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="595409" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="595409" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="595409" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L10_EP1TP0PP1DP0_GPU36 -->
<g id="node2895" class="node">
<title>attn_ar_L10_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="595627" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="595627" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="595627" y="-49.5" font-family="Arial" font-size="10.00">L10 EP1 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="595627" y="-38.5" font-family="Arial" font-size="10.00">GPU36</text>
</g>
<!-- residual1_L10_EP1TP0PP1DP0_GPU36 -->
<g id="node2896" class="node">
<title>residual1_L10_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="595920,-78 595770,-78 595770,-26 595920,-26 595920,-78"/>
<text text-anchor="middle" x="595845" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="595845" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="595845" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="595845" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L10_EP1TP0PP1DP0_GPU36 -->
<g id="node2897" class="node">
<title>ln2_L10_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="596106,-78 595956,-78 595956,-26 596106,-26 596106,-78"/>
<text text-anchor="middle" x="596031" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="596031" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="596031" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="596031" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L10_EP1TP0PP1DP0_GPU36 -->
<g id="node2898" class="node">
<title>gate_L10_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightyellow" stroke="black" points="596453.53,-104 596206.12,-104 596142.47,0 596389.88,0 596453.53,-104"/>
<text text-anchor="middle" x="596298" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="596298" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="596298" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="596298" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L10_EP1TP0PP1DP0_GPU36 -->
<g id="node2899" class="node">
<title>dispatch_L10_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="596596" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="596596" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="596596" y="-44" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP0_GPU36</text>
</g>
<!-- expert_0_L10_EP1TP0PP1DP0_GPU36 -->
<g id="node2900" class="node">
<title>expert_0_L10_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="596888,-78 596738,-78 596738,-26 596888,-26 596888,-78"/>
<text text-anchor="middle" x="596813" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="596813" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="596813" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="596813" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L10_EP1TP0PP1DP0_GPU36 -->
<g id="node2901" class="node">
<title>expert_1_L10_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="597074,-78 596924,-78 596924,-26 597074,-26 597074,-78"/>
<text text-anchor="middle" x="596999" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="596999" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="596999" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="596999" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L10_EP1TP0PP1DP0_GPU36 -->
<g id="node2902" class="node">
<title>expert_2_L10_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="597260,-78 597110,-78 597110,-26 597260,-26 597260,-78"/>
<text text-anchor="middle" x="597185" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="597185" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="597185" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="597185" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L10_EP1TP0PP1DP0_GPU36 -->
<g id="node2903" class="node">
<title>expert_3_L10_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="597446,-78 597296,-78 597296,-26 597446,-26 597446,-78"/>
<text text-anchor="middle" x="597371" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="597371" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="597371" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="597371" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L10_EP1TP0PP1DP0_GPU36 -->
<g id="node2904" class="node">
<title>combine_L10_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="597588" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="597588" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="597588" y="-44" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP0_GPU36</text>
</g>
<!-- ffn_L10_EP1TP0PP1DP0_GPU36 -->
<g id="node2905" class="node">
<title>ffn_L10_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="597900,-78 597730,-78 597730,-26 597900,-26 597900,-78"/>
<text text-anchor="middle" x="597815" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="597815" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="597815" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="597815" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L10_EP1TP0PP1DP0_GPU36 -->
<g id="node2906" class="node">
<title>ffn_ar_L10_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="598043" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="598043" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="598043" y="-49.5" font-family="Arial" font-size="10.00">L10 EP1 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="598043" y="-38.5" font-family="Arial" font-size="10.00">GPU36</text>
</g>
<!-- residual2_L10_EP1TP0PP1DP0_GPU36 -->
<g id="node2907" class="node">
<title>residual2_L10_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="598336,-78 598186,-78 598186,-26 598336,-26 598336,-78"/>
<text text-anchor="middle" x="598261" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="598261" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="598261" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="598261" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L10_EP1TP0PP1DP1_GPU37 -->
<g id="node2908" class="node">
<title>ln1_L10_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="598522,-78 598372,-78 598372,-26 598522,-26 598522,-78"/>
<text text-anchor="middle" x="598447" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="598447" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="598447" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="598447" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L10_EP1TP0PP1DP1_GPU37 -->
<g id="node2909" class="node">
<title>qkv_L10_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="598708,-78 598558,-78 598558,-26 598708,-26 598708,-78"/>
<text text-anchor="middle" x="598633" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="598633" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="598633" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="598633" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L10_EP1TP0PP1DP1_GPU37 -->
<g id="node2910" class="node">
<title>attn_L10_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="598895.5,-78 598744.5,-78 598744.5,-26 598895.5,-26 598895.5,-78"/>
<text text-anchor="middle" x="598820" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="598820" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="598820" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="598820" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L10_EP1TP0PP1DP1_GPU37 -->
<g id="node2911" class="node">
<title>attn_out_L10_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="599082,-78 598932,-78 598932,-26 599082,-26 599082,-78"/>
<text text-anchor="middle" x="599007" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="599007" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="599007" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="599007" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L10_EP1TP0PP1DP1_GPU37 -->
<g id="node2912" class="node">
<title>attn_ar_L10_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="599225" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="599225" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="599225" y="-49.5" font-family="Arial" font-size="10.00">L10 EP1 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="599225" y="-38.5" font-family="Arial" font-size="10.00">GPU37</text>
</g>
<!-- residual1_L10_EP1TP0PP1DP1_GPU37 -->
<g id="node2913" class="node">
<title>residual1_L10_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="599518,-78 599368,-78 599368,-26 599518,-26 599518,-78"/>
<text text-anchor="middle" x="599443" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="599443" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="599443" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="599443" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L10_EP1TP0PP1DP1_GPU37 -->
<g id="node2914" class="node">
<title>ln2_L10_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="599704,-78 599554,-78 599554,-26 599704,-26 599704,-78"/>
<text text-anchor="middle" x="599629" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="599629" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="599629" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="599629" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L10_EP1TP0PP1DP1_GPU37 -->
<g id="node2915" class="node">
<title>gate_L10_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightyellow" stroke="black" points="600051.53,-104 599804.12,-104 599740.47,0 599987.88,0 600051.53,-104"/>
<text text-anchor="middle" x="599896" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="599896" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="599896" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="599896" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L10_EP1TP0PP1DP1_GPU37 -->
<g id="node2916" class="node">
<title>dispatch_L10_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="600194" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="600194" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="600194" y="-44" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP1_GPU37</text>
</g>
<!-- expert_0_L10_EP1TP0PP1DP1_GPU37 -->
<g id="node2917" class="node">
<title>expert_0_L10_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="600486,-78 600336,-78 600336,-26 600486,-26 600486,-78"/>
<text text-anchor="middle" x="600411" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="600411" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="600411" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="600411" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L10_EP1TP0PP1DP1_GPU37 -->
<g id="node2918" class="node">
<title>expert_1_L10_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="600672,-78 600522,-78 600522,-26 600672,-26 600672,-78"/>
<text text-anchor="middle" x="600597" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="600597" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="600597" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="600597" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L10_EP1TP0PP1DP1_GPU37 -->
<g id="node2919" class="node">
<title>expert_2_L10_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="600858,-78 600708,-78 600708,-26 600858,-26 600858,-78"/>
<text text-anchor="middle" x="600783" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="600783" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="600783" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="600783" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L10_EP1TP0PP1DP1_GPU37 -->
<g id="node2920" class="node">
<title>expert_3_L10_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="601044,-78 600894,-78 600894,-26 601044,-26 601044,-78"/>
<text text-anchor="middle" x="600969" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="600969" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="600969" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="600969" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L10_EP1TP0PP1DP1_GPU37 -->
<g id="node2921" class="node">
<title>combine_L10_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="601186" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="601186" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="601186" y="-44" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP1_GPU37</text>
</g>
<!-- ffn_L10_EP1TP0PP1DP1_GPU37 -->
<g id="node2922" class="node">
<title>ffn_L10_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="601498,-78 601328,-78 601328,-26 601498,-26 601498,-78"/>
<text text-anchor="middle" x="601413" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="601413" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="601413" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="601413" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L10_EP1TP0PP1DP1_GPU37 -->
<g id="node2923" class="node">
<title>ffn_ar_L10_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="601641" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="601641" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="601641" y="-49.5" font-family="Arial" font-size="10.00">L10 EP1 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="601641" y="-38.5" font-family="Arial" font-size="10.00">GPU37</text>
</g>
<!-- residual2_L10_EP1TP0PP1DP1_GPU37 -->
<g id="node2924" class="node">
<title>residual2_L10_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="601934,-78 601784,-78 601784,-26 601934,-26 601934,-78"/>
<text text-anchor="middle" x="601859" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="601859" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="601859" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="601859" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L10_EP1TP1PP1DP0_GPU44 -->
<g id="node2925" class="node">
<title>ln1_L10_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="602120,-78 601970,-78 601970,-26 602120,-26 602120,-78"/>
<text text-anchor="middle" x="602045" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="602045" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="602045" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="602045" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L10_EP1TP1PP1DP0_GPU44 -->
<g id="node2926" class="node">
<title>qkv_L10_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="602306,-78 602156,-78 602156,-26 602306,-26 602306,-78"/>
<text text-anchor="middle" x="602231" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="602231" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="602231" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="602231" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L10_EP1TP1PP1DP0_GPU44 -->
<g id="node2927" class="node">
<title>attn_L10_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="602493.5,-78 602342.5,-78 602342.5,-26 602493.5,-26 602493.5,-78"/>
<text text-anchor="middle" x="602418" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="602418" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="602418" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="602418" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L10_EP1TP1PP1DP0_GPU44 -->
<g id="node2928" class="node">
<title>attn_out_L10_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="602680,-78 602530,-78 602530,-26 602680,-26 602680,-78"/>
<text text-anchor="middle" x="602605" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="602605" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="602605" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="602605" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L10_EP1TP1PP1DP0_GPU44 -->
<g id="node2929" class="node">
<title>attn_ar_L10_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="602823" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="602823" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="602823" y="-49.5" font-family="Arial" font-size="10.00">L10 EP1 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="602823" y="-38.5" font-family="Arial" font-size="10.00">GPU44</text>
</g>
<!-- residual1_L10_EP1TP1PP1DP0_GPU44 -->
<g id="node2930" class="node">
<title>residual1_L10_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="603116,-78 602966,-78 602966,-26 603116,-26 603116,-78"/>
<text text-anchor="middle" x="603041" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="603041" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="603041" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="603041" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L10_EP1TP1PP1DP0_GPU44 -->
<g id="node2931" class="node">
<title>ln2_L10_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="603302,-78 603152,-78 603152,-26 603302,-26 603302,-78"/>
<text text-anchor="middle" x="603227" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="603227" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="603227" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="603227" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L10_EP1TP1PP1DP0_GPU44 -->
<g id="node2932" class="node">
<title>gate_L10_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightyellow" stroke="black" points="603649.53,-104 603402.12,-104 603338.47,0 603585.88,0 603649.53,-104"/>
<text text-anchor="middle" x="603494" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="603494" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="603494" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="603494" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L10_EP1TP1PP1DP0_GPU44 -->
<g id="node2933" class="node">
<title>dispatch_L10_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="603792" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="603792" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="603792" y="-44" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP0_GPU44</text>
</g>
<!-- expert_0_L10_EP1TP1PP1DP0_GPU44 -->
<g id="node2934" class="node">
<title>expert_0_L10_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="604084,-78 603934,-78 603934,-26 604084,-26 604084,-78"/>
<text text-anchor="middle" x="604009" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="604009" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="604009" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="604009" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L10_EP1TP1PP1DP0_GPU44 -->
<g id="node2935" class="node">
<title>expert_1_L10_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="604270,-78 604120,-78 604120,-26 604270,-26 604270,-78"/>
<text text-anchor="middle" x="604195" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="604195" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="604195" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="604195" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L10_EP1TP1PP1DP0_GPU44 -->
<g id="node2936" class="node">
<title>expert_2_L10_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="604456,-78 604306,-78 604306,-26 604456,-26 604456,-78"/>
<text text-anchor="middle" x="604381" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="604381" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="604381" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="604381" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L10_EP1TP1PP1DP0_GPU44 -->
<g id="node2937" class="node">
<title>expert_3_L10_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="604642,-78 604492,-78 604492,-26 604642,-26 604642,-78"/>
<text text-anchor="middle" x="604567" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="604567" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="604567" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="604567" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L10_EP1TP1PP1DP0_GPU44 -->
<g id="node2938" class="node">
<title>combine_L10_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="604784" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="604784" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="604784" y="-44" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP0_GPU44</text>
</g>
<!-- ffn_L10_EP1TP1PP1DP0_GPU44 -->
<g id="node2939" class="node">
<title>ffn_L10_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="605096,-78 604926,-78 604926,-26 605096,-26 605096,-78"/>
<text text-anchor="middle" x="605011" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="605011" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="605011" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="605011" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L10_EP1TP1PP1DP0_GPU44 -->
<g id="node2940" class="node">
<title>ffn_ar_L10_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="605239" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="605239" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="605239" y="-49.5" font-family="Arial" font-size="10.00">L10 EP1 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="605239" y="-38.5" font-family="Arial" font-size="10.00">GPU44</text>
</g>
<!-- residual2_L10_EP1TP1PP1DP0_GPU44 -->
<g id="node2941" class="node">
<title>residual2_L10_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="605532,-78 605382,-78 605382,-26 605532,-26 605532,-78"/>
<text text-anchor="middle" x="605457" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="605457" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="605457" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="605457" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L10_EP1TP1PP1DP1_GPU45 -->
<g id="node2942" class="node">
<title>ln1_L10_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="605718,-78 605568,-78 605568,-26 605718,-26 605718,-78"/>
<text text-anchor="middle" x="605643" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="605643" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="605643" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="605643" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L10_EP1TP1PP1DP1_GPU45 -->
<g id="node2943" class="node">
<title>qkv_L10_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="605904,-78 605754,-78 605754,-26 605904,-26 605904,-78"/>
<text text-anchor="middle" x="605829" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="605829" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="605829" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="605829" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L10_EP1TP1PP1DP1_GPU45 -->
<g id="node2944" class="node">
<title>attn_L10_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="606091.5,-78 605940.5,-78 605940.5,-26 606091.5,-26 606091.5,-78"/>
<text text-anchor="middle" x="606016" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="606016" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="606016" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="606016" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L10_EP1TP1PP1DP1_GPU45 -->
<g id="node2945" class="node">
<title>attn_out_L10_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="606278,-78 606128,-78 606128,-26 606278,-26 606278,-78"/>
<text text-anchor="middle" x="606203" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="606203" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="606203" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="606203" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L10_EP1TP1PP1DP1_GPU45 -->
<g id="node2946" class="node">
<title>attn_ar_L10_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="606421" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="606421" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="606421" y="-49.5" font-family="Arial" font-size="10.00">L10 EP1 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="606421" y="-38.5" font-family="Arial" font-size="10.00">GPU45</text>
</g>
<!-- residual1_L10_EP1TP1PP1DP1_GPU45 -->
<g id="node2947" class="node">
<title>residual1_L10_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="606714,-78 606564,-78 606564,-26 606714,-26 606714,-78"/>
<text text-anchor="middle" x="606639" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="606639" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="606639" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="606639" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L10_EP1TP1PP1DP1_GPU45 -->
<g id="node2948" class="node">
<title>ln2_L10_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="606900,-78 606750,-78 606750,-26 606900,-26 606900,-78"/>
<text text-anchor="middle" x="606825" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="606825" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="606825" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="606825" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L10_EP1TP1PP1DP1_GPU45 -->
<g id="node2949" class="node">
<title>gate_L10_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightyellow" stroke="black" points="607247.53,-104 607000.12,-104 606936.47,0 607183.88,0 607247.53,-104"/>
<text text-anchor="middle" x="607092" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="607092" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="607092" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="607092" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L10_EP1TP1PP1DP1_GPU45 -->
<g id="node2950" class="node">
<title>dispatch_L10_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="607390" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="607390" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="607390" y="-44" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP1_GPU45</text>
</g>
<!-- expert_0_L10_EP1TP1PP1DP1_GPU45 -->
<g id="node2951" class="node">
<title>expert_0_L10_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="607682,-78 607532,-78 607532,-26 607682,-26 607682,-78"/>
<text text-anchor="middle" x="607607" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="607607" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="607607" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="607607" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L10_EP1TP1PP1DP1_GPU45 -->
<g id="node2952" class="node">
<title>expert_1_L10_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="607868,-78 607718,-78 607718,-26 607868,-26 607868,-78"/>
<text text-anchor="middle" x="607793" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="607793" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="607793" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="607793" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L10_EP1TP1PP1DP1_GPU45 -->
<g id="node2953" class="node">
<title>expert_2_L10_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="608054,-78 607904,-78 607904,-26 608054,-26 608054,-78"/>
<text text-anchor="middle" x="607979" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="607979" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="607979" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="607979" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L10_EP1TP1PP1DP1_GPU45 -->
<g id="node2954" class="node">
<title>expert_3_L10_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="608240,-78 608090,-78 608090,-26 608240,-26 608240,-78"/>
<text text-anchor="middle" x="608165" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="608165" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="608165" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="608165" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L10_EP1TP1PP1DP1_GPU45 -->
<g id="node2955" class="node">
<title>combine_L10_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="608382" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="608382" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="608382" y="-44" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP1_GPU45</text>
</g>
<!-- ffn_L10_EP1TP1PP1DP1_GPU45 -->
<g id="node2956" class="node">
<title>ffn_L10_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="608694,-78 608524,-78 608524,-26 608694,-26 608694,-78"/>
<text text-anchor="middle" x="608609" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="608609" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="608609" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="608609" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L10_EP1TP1PP1DP1_GPU45 -->
<g id="node2957" class="node">
<title>ffn_ar_L10_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="608837" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="608837" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="608837" y="-49.5" font-family="Arial" font-size="10.00">L10 EP1 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="608837" y="-38.5" font-family="Arial" font-size="10.00">GPU45</text>
</g>
<!-- residual2_L10_EP1TP1PP1DP1_GPU45 -->
<g id="node2958" class="node">
<title>residual2_L10_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="609130,-78 608980,-78 608980,-26 609130,-26 609130,-78"/>
<text text-anchor="middle" x="609055" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="609055" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="609055" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="609055" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L10_EP1TP2PP1DP0_GPU52 -->
<g id="node2959" class="node">
<title>ln1_L10_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="609316,-78 609166,-78 609166,-26 609316,-26 609316,-78"/>
<text text-anchor="middle" x="609241" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="609241" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="609241" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="609241" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L10_EP1TP2PP1DP0_GPU52 -->
<g id="node2960" class="node">
<title>qkv_L10_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="609502,-78 609352,-78 609352,-26 609502,-26 609502,-78"/>
<text text-anchor="middle" x="609427" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="609427" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="609427" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="609427" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L10_EP1TP2PP1DP0_GPU52 -->
<g id="node2961" class="node">
<title>attn_L10_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="609689.5,-78 609538.5,-78 609538.5,-26 609689.5,-26 609689.5,-78"/>
<text text-anchor="middle" x="609614" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="609614" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="609614" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="609614" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L10_EP1TP2PP1DP0_GPU52 -->
<g id="node2962" class="node">
<title>attn_out_L10_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="609876,-78 609726,-78 609726,-26 609876,-26 609876,-78"/>
<text text-anchor="middle" x="609801" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="609801" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="609801" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="609801" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L10_EP1TP2PP1DP0_GPU52 -->
<g id="node2963" class="node">
<title>attn_ar_L10_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="610019" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="610019" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="610019" y="-49.5" font-family="Arial" font-size="10.00">L10 EP1 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="610019" y="-38.5" font-family="Arial" font-size="10.00">GPU52</text>
</g>
<!-- residual1_L10_EP1TP2PP1DP0_GPU52 -->
<g id="node2964" class="node">
<title>residual1_L10_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="610312,-78 610162,-78 610162,-26 610312,-26 610312,-78"/>
<text text-anchor="middle" x="610237" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="610237" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="610237" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="610237" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L10_EP1TP2PP1DP0_GPU52 -->
<g id="node2965" class="node">
<title>ln2_L10_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="610498,-78 610348,-78 610348,-26 610498,-26 610498,-78"/>
<text text-anchor="middle" x="610423" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="610423" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="610423" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="610423" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L10_EP1TP2PP1DP0_GPU52 -->
<g id="node2966" class="node">
<title>gate_L10_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightyellow" stroke="black" points="610845.53,-104 610598.12,-104 610534.47,0 610781.88,0 610845.53,-104"/>
<text text-anchor="middle" x="610690" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="610690" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="610690" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="610690" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L10_EP1TP2PP1DP0_GPU52 -->
<g id="node2967" class="node">
<title>dispatch_L10_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="610988" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="610988" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="610988" y="-44" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP0_GPU52</text>
</g>
<!-- expert_0_L10_EP1TP2PP1DP0_GPU52 -->
<g id="node2968" class="node">
<title>expert_0_L10_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="611280,-78 611130,-78 611130,-26 611280,-26 611280,-78"/>
<text text-anchor="middle" x="611205" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="611205" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="611205" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="611205" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L10_EP1TP2PP1DP0_GPU52 -->
<g id="node2969" class="node">
<title>expert_1_L10_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="611466,-78 611316,-78 611316,-26 611466,-26 611466,-78"/>
<text text-anchor="middle" x="611391" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="611391" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="611391" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="611391" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L10_EP1TP2PP1DP0_GPU52 -->
<g id="node2970" class="node">
<title>expert_2_L10_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="611652,-78 611502,-78 611502,-26 611652,-26 611652,-78"/>
<text text-anchor="middle" x="611577" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="611577" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="611577" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="611577" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L10_EP1TP2PP1DP0_GPU52 -->
<g id="node2971" class="node">
<title>expert_3_L10_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="611838,-78 611688,-78 611688,-26 611838,-26 611838,-78"/>
<text text-anchor="middle" x="611763" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="611763" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="611763" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="611763" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L10_EP1TP2PP1DP0_GPU52 -->
<g id="node2972" class="node">
<title>combine_L10_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="611980" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="611980" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="611980" y="-44" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP0_GPU52</text>
</g>
<!-- ffn_L10_EP1TP2PP1DP0_GPU52 -->
<g id="node2973" class="node">
<title>ffn_L10_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="612292,-78 612122,-78 612122,-26 612292,-26 612292,-78"/>
<text text-anchor="middle" x="612207" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="612207" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="612207" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="612207" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L10_EP1TP2PP1DP0_GPU52 -->
<g id="node2974" class="node">
<title>ffn_ar_L10_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="612435" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="612435" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="612435" y="-49.5" font-family="Arial" font-size="10.00">L10 EP1 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="612435" y="-38.5" font-family="Arial" font-size="10.00">GPU52</text>
</g>
<!-- residual2_L10_EP1TP2PP1DP0_GPU52 -->
<g id="node2975" class="node">
<title>residual2_L10_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="612728,-78 612578,-78 612578,-26 612728,-26 612728,-78"/>
<text text-anchor="middle" x="612653" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="612653" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="612653" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="612653" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L10_EP1TP2PP1DP1_GPU53 -->
<g id="node2976" class="node">
<title>ln1_L10_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="612914,-78 612764,-78 612764,-26 612914,-26 612914,-78"/>
<text text-anchor="middle" x="612839" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="612839" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="612839" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="612839" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L10_EP1TP2PP1DP1_GPU53 -->
<g id="node2977" class="node">
<title>qkv_L10_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="613100,-78 612950,-78 612950,-26 613100,-26 613100,-78"/>
<text text-anchor="middle" x="613025" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="613025" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="613025" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="613025" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L10_EP1TP2PP1DP1_GPU53 -->
<g id="node2978" class="node">
<title>attn_L10_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="613287.5,-78 613136.5,-78 613136.5,-26 613287.5,-26 613287.5,-78"/>
<text text-anchor="middle" x="613212" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="613212" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="613212" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="613212" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L10_EP1TP2PP1DP1_GPU53 -->
<g id="node2979" class="node">
<title>attn_out_L10_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="613474,-78 613324,-78 613324,-26 613474,-26 613474,-78"/>
<text text-anchor="middle" x="613399" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="613399" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="613399" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="613399" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L10_EP1TP2PP1DP1_GPU53 -->
<g id="node2980" class="node">
<title>attn_ar_L10_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="613617" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="613617" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="613617" y="-49.5" font-family="Arial" font-size="10.00">L10 EP1 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="613617" y="-38.5" font-family="Arial" font-size="10.00">GPU53</text>
</g>
<!-- residual1_L10_EP1TP2PP1DP1_GPU53 -->
<g id="node2981" class="node">
<title>residual1_L10_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="613910,-78 613760,-78 613760,-26 613910,-26 613910,-78"/>
<text text-anchor="middle" x="613835" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="613835" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="613835" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="613835" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L10_EP1TP2PP1DP1_GPU53 -->
<g id="node2982" class="node">
<title>ln2_L10_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="614096,-78 613946,-78 613946,-26 614096,-26 614096,-78"/>
<text text-anchor="middle" x="614021" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="614021" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="614021" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="614021" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L10_EP1TP2PP1DP1_GPU53 -->
<g id="node2983" class="node">
<title>gate_L10_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightyellow" stroke="black" points="614443.53,-104 614196.12,-104 614132.47,0 614379.88,0 614443.53,-104"/>
<text text-anchor="middle" x="614288" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="614288" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="614288" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="614288" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L10_EP1TP2PP1DP1_GPU53 -->
<g id="node2984" class="node">
<title>dispatch_L10_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="614586" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="614586" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="614586" y="-44" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP1_GPU53</text>
</g>
<!-- expert_0_L10_EP1TP2PP1DP1_GPU53 -->
<g id="node2985" class="node">
<title>expert_0_L10_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="614878,-78 614728,-78 614728,-26 614878,-26 614878,-78"/>
<text text-anchor="middle" x="614803" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="614803" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="614803" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="614803" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L10_EP1TP2PP1DP1_GPU53 -->
<g id="node2986" class="node">
<title>expert_1_L10_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="615064,-78 614914,-78 614914,-26 615064,-26 615064,-78"/>
<text text-anchor="middle" x="614989" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="614989" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="614989" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="614989" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L10_EP1TP2PP1DP1_GPU53 -->
<g id="node2987" class="node">
<title>expert_2_L10_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="615250,-78 615100,-78 615100,-26 615250,-26 615250,-78"/>
<text text-anchor="middle" x="615175" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="615175" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="615175" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="615175" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L10_EP1TP2PP1DP1_GPU53 -->
<g id="node2988" class="node">
<title>expert_3_L10_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="615436,-78 615286,-78 615286,-26 615436,-26 615436,-78"/>
<text text-anchor="middle" x="615361" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="615361" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="615361" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="615361" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L10_EP1TP2PP1DP1_GPU53 -->
<g id="node2989" class="node">
<title>combine_L10_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="615578" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="615578" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="615578" y="-44" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP1_GPU53</text>
</g>
<!-- ffn_L10_EP1TP2PP1DP1_GPU53 -->
<g id="node2990" class="node">
<title>ffn_L10_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="615890,-78 615720,-78 615720,-26 615890,-26 615890,-78"/>
<text text-anchor="middle" x="615805" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="615805" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="615805" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="615805" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L10_EP1TP2PP1DP1_GPU53 -->
<g id="node2991" class="node">
<title>ffn_ar_L10_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="616033" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="616033" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="616033" y="-49.5" font-family="Arial" font-size="10.00">L10 EP1 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="616033" y="-38.5" font-family="Arial" font-size="10.00">GPU53</text>
</g>
<!-- residual2_L10_EP1TP2PP1DP1_GPU53 -->
<g id="node2992" class="node">
<title>residual2_L10_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="616326,-78 616176,-78 616176,-26 616326,-26 616326,-78"/>
<text text-anchor="middle" x="616251" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="616251" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="616251" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="616251" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L10_EP1TP3PP1DP0_GPU60 -->
<g id="node2993" class="node">
<title>ln1_L10_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="616512,-78 616362,-78 616362,-26 616512,-26 616512,-78"/>
<text text-anchor="middle" x="616437" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="616437" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="616437" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="616437" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L10_EP1TP3PP1DP0_GPU60 -->
<g id="node2994" class="node">
<title>qkv_L10_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="616698,-78 616548,-78 616548,-26 616698,-26 616698,-78"/>
<text text-anchor="middle" x="616623" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="616623" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="616623" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="616623" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L10_EP1TP3PP1DP0_GPU60 -->
<g id="node2995" class="node">
<title>attn_L10_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="616885.5,-78 616734.5,-78 616734.5,-26 616885.5,-26 616885.5,-78"/>
<text text-anchor="middle" x="616810" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="616810" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="616810" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="616810" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L10_EP1TP3PP1DP0_GPU60 -->
<g id="node2996" class="node">
<title>attn_out_L10_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="617072,-78 616922,-78 616922,-26 617072,-26 617072,-78"/>
<text text-anchor="middle" x="616997" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="616997" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="616997" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="616997" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L10_EP1TP3PP1DP0_GPU60 -->
<g id="node2997" class="node">
<title>attn_ar_L10_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="617215" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="617215" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="617215" y="-49.5" font-family="Arial" font-size="10.00">L10 EP1 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="617215" y="-38.5" font-family="Arial" font-size="10.00">GPU60</text>
</g>
<!-- residual1_L10_EP1TP3PP1DP0_GPU60 -->
<g id="node2998" class="node">
<title>residual1_L10_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="617508,-78 617358,-78 617358,-26 617508,-26 617508,-78"/>
<text text-anchor="middle" x="617433" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="617433" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="617433" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="617433" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L10_EP1TP3PP1DP0_GPU60 -->
<g id="node2999" class="node">
<title>ln2_L10_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="617694,-78 617544,-78 617544,-26 617694,-26 617694,-78"/>
<text text-anchor="middle" x="617619" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="617619" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="617619" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="617619" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L10_EP1TP3PP1DP0_GPU60 -->
<g id="node3000" class="node">
<title>gate_L10_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightyellow" stroke="black" points="618041.53,-104 617794.12,-104 617730.47,0 617977.88,0 618041.53,-104"/>
<text text-anchor="middle" x="617886" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="617886" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="617886" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="617886" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L10_EP1TP3PP1DP0_GPU60 -->
<g id="node3001" class="node">
<title>dispatch_L10_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="618184" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="618184" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="618184" y="-44" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP0_GPU60</text>
</g>
<!-- expert_0_L10_EP1TP3PP1DP0_GPU60 -->
<g id="node3002" class="node">
<title>expert_0_L10_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="618476,-78 618326,-78 618326,-26 618476,-26 618476,-78"/>
<text text-anchor="middle" x="618401" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="618401" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="618401" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="618401" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L10_EP1TP3PP1DP0_GPU60 -->
<g id="node3003" class="node">
<title>expert_1_L10_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="618662,-78 618512,-78 618512,-26 618662,-26 618662,-78"/>
<text text-anchor="middle" x="618587" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="618587" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="618587" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="618587" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L10_EP1TP3PP1DP0_GPU60 -->
<g id="node3004" class="node">
<title>expert_2_L10_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="618848,-78 618698,-78 618698,-26 618848,-26 618848,-78"/>
<text text-anchor="middle" x="618773" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="618773" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="618773" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="618773" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L10_EP1TP3PP1DP0_GPU60 -->
<g id="node3005" class="node">
<title>expert_3_L10_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="619034,-78 618884,-78 618884,-26 619034,-26 619034,-78"/>
<text text-anchor="middle" x="618959" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="618959" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="618959" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="618959" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L10_EP1TP3PP1DP0_GPU60 -->
<g id="node3006" class="node">
<title>combine_L10_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="619176" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="619176" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="619176" y="-44" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP0_GPU60</text>
</g>
<!-- ffn_L10_EP1TP3PP1DP0_GPU60 -->
<g id="node3007" class="node">
<title>ffn_L10_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="619488,-78 619318,-78 619318,-26 619488,-26 619488,-78"/>
<text text-anchor="middle" x="619403" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="619403" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="619403" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="619403" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L10_EP1TP3PP1DP0_GPU60 -->
<g id="node3008" class="node">
<title>ffn_ar_L10_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="619631" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="619631" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="619631" y="-49.5" font-family="Arial" font-size="10.00">L10 EP1 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="619631" y="-38.5" font-family="Arial" font-size="10.00">GPU60</text>
</g>
<!-- residual2_L10_EP1TP3PP1DP0_GPU60 -->
<g id="node3009" class="node">
<title>residual2_L10_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="619924,-78 619774,-78 619774,-26 619924,-26 619924,-78"/>
<text text-anchor="middle" x="619849" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="619849" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="619849" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="619849" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L10_EP1TP3PP1DP1_GPU61 -->
<g id="node3010" class="node">
<title>ln1_L10_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="620110,-78 619960,-78 619960,-26 620110,-26 620110,-78"/>
<text text-anchor="middle" x="620035" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="620035" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="620035" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="620035" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L10_EP1TP3PP1DP1_GPU61 -->
<g id="node3011" class="node">
<title>qkv_L10_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="620296,-78 620146,-78 620146,-26 620296,-26 620296,-78"/>
<text text-anchor="middle" x="620221" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="620221" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="620221" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="620221" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L10_EP1TP3PP1DP1_GPU61 -->
<g id="node3012" class="node">
<title>attn_L10_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="620483.5,-78 620332.5,-78 620332.5,-26 620483.5,-26 620483.5,-78"/>
<text text-anchor="middle" x="620408" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="620408" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="620408" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="620408" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L10_EP1TP3PP1DP1_GPU61 -->
<g id="node3013" class="node">
<title>attn_out_L10_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="620670,-78 620520,-78 620520,-26 620670,-26 620670,-78"/>
<text text-anchor="middle" x="620595" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="620595" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="620595" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="620595" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L10_EP1TP3PP1DP1_GPU61 -->
<g id="node3014" class="node">
<title>attn_ar_L10_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="620813" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="620813" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="620813" y="-49.5" font-family="Arial" font-size="10.00">L10 EP1 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="620813" y="-38.5" font-family="Arial" font-size="10.00">GPU61</text>
</g>
<!-- residual1_L10_EP1TP3PP1DP1_GPU61 -->
<g id="node3015" class="node">
<title>residual1_L10_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="621106,-78 620956,-78 620956,-26 621106,-26 621106,-78"/>
<text text-anchor="middle" x="621031" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="621031" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="621031" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="621031" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L10_EP1TP3PP1DP1_GPU61 -->
<g id="node3016" class="node">
<title>ln2_L10_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="621292,-78 621142,-78 621142,-26 621292,-26 621292,-78"/>
<text text-anchor="middle" x="621217" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="621217" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="621217" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="621217" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L10_EP1TP3PP1DP1_GPU61 -->
<g id="node3017" class="node">
<title>gate_L10_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightyellow" stroke="black" points="621639.53,-104 621392.12,-104 621328.47,0 621575.88,0 621639.53,-104"/>
<text text-anchor="middle" x="621484" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="621484" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="621484" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="621484" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L10_EP1TP3PP1DP1_GPU61 -->
<g id="node3018" class="node">
<title>dispatch_L10_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="621782" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="621782" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="621782" y="-44" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP1_GPU61</text>
</g>
<!-- expert_0_L10_EP1TP3PP1DP1_GPU61 -->
<g id="node3019" class="node">
<title>expert_0_L10_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="622074,-78 621924,-78 621924,-26 622074,-26 622074,-78"/>
<text text-anchor="middle" x="621999" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="621999" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="621999" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="621999" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L10_EP1TP3PP1DP1_GPU61 -->
<g id="node3020" class="node">
<title>expert_1_L10_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="622260,-78 622110,-78 622110,-26 622260,-26 622260,-78"/>
<text text-anchor="middle" x="622185" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="622185" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="622185" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="622185" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L10_EP1TP3PP1DP1_GPU61 -->
<g id="node3021" class="node">
<title>expert_2_L10_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="622446,-78 622296,-78 622296,-26 622446,-26 622446,-78"/>
<text text-anchor="middle" x="622371" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="622371" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="622371" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="622371" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L10_EP1TP3PP1DP1_GPU61 -->
<g id="node3022" class="node">
<title>expert_3_L10_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="622632,-78 622482,-78 622482,-26 622632,-26 622632,-78"/>
<text text-anchor="middle" x="622557" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="622557" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="622557" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="622557" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L10_EP1TP3PP1DP1_GPU61 -->
<g id="node3023" class="node">
<title>combine_L10_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="622774" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="622774" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="622774" y="-44" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP1_GPU61</text>
</g>
<!-- ffn_L10_EP1TP3PP1DP1_GPU61 -->
<g id="node3024" class="node">
<title>ffn_L10_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="623086,-78 622916,-78 622916,-26 623086,-26 623086,-78"/>
<text text-anchor="middle" x="623001" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="623001" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="623001" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="623001" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L10_EP1TP3PP1DP1_GPU61 -->
<g id="node3025" class="node">
<title>ffn_ar_L10_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="623229" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="623229" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="623229" y="-49.5" font-family="Arial" font-size="10.00">L10 EP1 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="623229" y="-38.5" font-family="Arial" font-size="10.00">GPU61</text>
</g>
<!-- residual2_L10_EP1TP3PP1DP1_GPU61 -->
<g id="node3026" class="node">
<title>residual2_L10_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="623522,-78 623372,-78 623372,-26 623522,-26 623522,-78"/>
<text text-anchor="middle" x="623447" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="623447" y="-55" font-family="Arial" font-size="10.00">L10_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="623447" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="623447" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L11_EP0TP0PP1DP0_GPU4 -->
<g id="node3027" class="node">
<title>ln1_L11_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="623703.5,-78 623558.5,-78 623558.5,-26 623703.5,-26 623703.5,-78"/>
<text text-anchor="middle" x="623631" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="623631" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="623631" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="623631" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L11_EP0TP0PP1DP0_GPU4 -->
<g id="node3028" class="node">
<title>qkv_L11_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="623884.5,-78 623739.5,-78 623739.5,-26 623884.5,-26 623884.5,-78"/>
<text text-anchor="middle" x="623812" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="623812" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="623812" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="623812" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L11_EP0TP0PP1DP0_GPU4 -->
<g id="node3029" class="node">
<title>attn_L11_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="624071.5,-78 623920.5,-78 623920.5,-26 624071.5,-26 624071.5,-78"/>
<text text-anchor="middle" x="623996" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="623996" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="623996" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="623996" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L11_EP0TP0PP1DP0_GPU4 -->
<g id="node3030" class="node">
<title>attn_out_L11_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="624252.5,-78 624107.5,-78 624107.5,-26 624252.5,-26 624252.5,-78"/>
<text text-anchor="middle" x="624180" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="624180" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="624180" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="624180" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L11_EP0TP0PP1DP0_GPU4 -->
<g id="node3031" class="node">
<title>attn_ar_L11_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="624395" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="624395" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="624395" y="-49.5" font-family="Arial" font-size="10.00">L11 EP0 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="624395" y="-38.5" font-family="Arial" font-size="10.00">GPU4</text>
</g>
<!-- residual1_L11_EP0TP0PP1DP0_GPU4 -->
<g id="node3032" class="node">
<title>residual1_L11_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="624684,-78 624538,-78 624538,-26 624684,-26 624684,-78"/>
<text text-anchor="middle" x="624611" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="624611" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="624611" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="624611" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L11_EP0TP0PP1DP0_GPU4 -->
<g id="node3033" class="node">
<title>ln2_L11_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="624865.5,-78 624720.5,-78 624720.5,-26 624865.5,-26 624865.5,-78"/>
<text text-anchor="middle" x="624793" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="624793" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="624793" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="624793" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L11_EP0TP0PP1DP0_GPU4 -->
<g id="node3034" class="node">
<title>gate_L11_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightyellow" stroke="black" points="625202.16,-104 624963.29,-104 624901.84,0 625140.71,0 625202.16,-104"/>
<text text-anchor="middle" x="625052" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="625052" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="625052" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="625052" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L11_EP0TP0PP1DP0_GPU4 -->
<g id="node3035" class="node">
<title>dispatch_L11_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="625341" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="625341" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="625341" y="-44" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP0_GPU4</text>
</g>
<!-- expert_0_L11_EP0TP0PP1DP0_GPU4 -->
<g id="node3036" class="node">
<title>expert_0_L11_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="625624.5,-78 625479.5,-78 625479.5,-26 625624.5,-26 625624.5,-78"/>
<text text-anchor="middle" x="625552" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="625552" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="625552" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="625552" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L11_EP0TP0PP1DP0_GPU4 -->
<g id="node3037" class="node">
<title>expert_1_L11_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="625805.5,-78 625660.5,-78 625660.5,-26 625805.5,-26 625805.5,-78"/>
<text text-anchor="middle" x="625733" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="625733" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="625733" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="625733" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L11_EP0TP0PP1DP0_GPU4 -->
<g id="node3038" class="node">
<title>expert_2_L11_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="625986.5,-78 625841.5,-78 625841.5,-26 625986.5,-26 625986.5,-78"/>
<text text-anchor="middle" x="625914" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="625914" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="625914" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="625914" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L11_EP0TP0PP1DP0_GPU4 -->
<g id="node3039" class="node">
<title>expert_3_L11_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="626167.5,-78 626022.5,-78 626022.5,-26 626167.5,-26 626167.5,-78"/>
<text text-anchor="middle" x="626095" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="626095" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="626095" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="626095" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L11_EP0TP0PP1DP0_GPU4 -->
<g id="node3040" class="node">
<title>combine_L11_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="626306" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="626306" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="626306" y="-44" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP0_GPU4</text>
</g>
<!-- ffn_L11_EP0TP0PP1DP0_GPU4 -->
<g id="node3041" class="node">
<title>ffn_L11_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="626615,-78 626445,-78 626445,-26 626615,-26 626615,-78"/>
<text text-anchor="middle" x="626530" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="626530" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="626530" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="626530" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L11_EP0TP0PP1DP0_GPU4 -->
<g id="node3042" class="node">
<title>ffn_ar_L11_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="626758" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="626758" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="626758" y="-49.5" font-family="Arial" font-size="10.00">L11 EP0 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="626758" y="-38.5" font-family="Arial" font-size="10.00">GPU4</text>
</g>
<!-- residual2_L11_EP0TP0PP1DP0_GPU4 -->
<g id="node3043" class="node">
<title>residual2_L11_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="627047,-78 626901,-78 626901,-26 627047,-26 627047,-78"/>
<text text-anchor="middle" x="626974" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="626974" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="626974" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="626974" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L11_EP0TP0PP1DP1_GPU5 -->
<g id="node3044" class="node">
<title>ln1_L11_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="627228.5,-78 627083.5,-78 627083.5,-26 627228.5,-26 627228.5,-78"/>
<text text-anchor="middle" x="627156" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="627156" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="627156" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="627156" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L11_EP0TP0PP1DP1_GPU5 -->
<g id="node3045" class="node">
<title>qkv_L11_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="627409.5,-78 627264.5,-78 627264.5,-26 627409.5,-26 627409.5,-78"/>
<text text-anchor="middle" x="627337" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="627337" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="627337" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="627337" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L11_EP0TP0PP1DP1_GPU5 -->
<g id="node3046" class="node">
<title>attn_L11_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="627596.5,-78 627445.5,-78 627445.5,-26 627596.5,-26 627596.5,-78"/>
<text text-anchor="middle" x="627521" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="627521" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="627521" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="627521" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L11_EP0TP0PP1DP1_GPU5 -->
<g id="node3047" class="node">
<title>attn_out_L11_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="627777.5,-78 627632.5,-78 627632.5,-26 627777.5,-26 627777.5,-78"/>
<text text-anchor="middle" x="627705" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="627705" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="627705" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="627705" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L11_EP0TP0PP1DP1_GPU5 -->
<g id="node3048" class="node">
<title>attn_ar_L11_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="627920" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="627920" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="627920" y="-49.5" font-family="Arial" font-size="10.00">L11 EP0 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="627920" y="-38.5" font-family="Arial" font-size="10.00">GPU5</text>
</g>
<!-- residual1_L11_EP0TP0PP1DP1_GPU5 -->
<g id="node3049" class="node">
<title>residual1_L11_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="628209,-78 628063,-78 628063,-26 628209,-26 628209,-78"/>
<text text-anchor="middle" x="628136" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="628136" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="628136" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="628136" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L11_EP0TP0PP1DP1_GPU5 -->
<g id="node3050" class="node">
<title>ln2_L11_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="628390.5,-78 628245.5,-78 628245.5,-26 628390.5,-26 628390.5,-78"/>
<text text-anchor="middle" x="628318" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="628318" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="628318" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="628318" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L11_EP0TP0PP1DP1_GPU5 -->
<g id="node3051" class="node">
<title>gate_L11_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightyellow" stroke="black" points="628727.16,-104 628488.29,-104 628426.84,0 628665.71,0 628727.16,-104"/>
<text text-anchor="middle" x="628577" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="628577" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="628577" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="628577" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L11_EP0TP0PP1DP1_GPU5 -->
<g id="node3052" class="node">
<title>dispatch_L11_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="628866" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="628866" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="628866" y="-44" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP1_GPU5</text>
</g>
<!-- expert_0_L11_EP0TP0PP1DP1_GPU5 -->
<g id="node3053" class="node">
<title>expert_0_L11_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="629149.5,-78 629004.5,-78 629004.5,-26 629149.5,-26 629149.5,-78"/>
<text text-anchor="middle" x="629077" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="629077" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="629077" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="629077" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L11_EP0TP0PP1DP1_GPU5 -->
<g id="node3054" class="node">
<title>expert_1_L11_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="629330.5,-78 629185.5,-78 629185.5,-26 629330.5,-26 629330.5,-78"/>
<text text-anchor="middle" x="629258" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="629258" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="629258" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="629258" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L11_EP0TP0PP1DP1_GPU5 -->
<g id="node3055" class="node">
<title>expert_2_L11_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="629511.5,-78 629366.5,-78 629366.5,-26 629511.5,-26 629511.5,-78"/>
<text text-anchor="middle" x="629439" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="629439" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="629439" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="629439" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L11_EP0TP0PP1DP1_GPU5 -->
<g id="node3056" class="node">
<title>expert_3_L11_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="629692.5,-78 629547.5,-78 629547.5,-26 629692.5,-26 629692.5,-78"/>
<text text-anchor="middle" x="629620" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="629620" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="629620" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="629620" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L11_EP0TP0PP1DP1_GPU5 -->
<g id="node3057" class="node">
<title>combine_L11_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="629831" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="629831" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="629831" y="-44" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP1_GPU5</text>
</g>
<!-- ffn_L11_EP0TP0PP1DP1_GPU5 -->
<g id="node3058" class="node">
<title>ffn_L11_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="630140,-78 629970,-78 629970,-26 630140,-26 630140,-78"/>
<text text-anchor="middle" x="630055" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="630055" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="630055" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="630055" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L11_EP0TP0PP1DP1_GPU5 -->
<g id="node3059" class="node">
<title>ffn_ar_L11_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="630283" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="630283" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="630283" y="-49.5" font-family="Arial" font-size="10.00">L11 EP0 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="630283" y="-38.5" font-family="Arial" font-size="10.00">GPU5</text>
</g>
<!-- residual2_L11_EP0TP0PP1DP1_GPU5 -->
<g id="node3060" class="node">
<title>residual2_L11_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="630572,-78 630426,-78 630426,-26 630572,-26 630572,-78"/>
<text text-anchor="middle" x="630499" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="630499" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="630499" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="630499" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L11_EP0TP1PP1DP0_GPU12 -->
<g id="node3061" class="node">
<title>ln1_L11_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="630758,-78 630608,-78 630608,-26 630758,-26 630758,-78"/>
<text text-anchor="middle" x="630683" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="630683" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="630683" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="630683" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L11_EP0TP1PP1DP0_GPU12 -->
<g id="node3062" class="node">
<title>qkv_L11_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="630944,-78 630794,-78 630794,-26 630944,-26 630944,-78"/>
<text text-anchor="middle" x="630869" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="630869" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="630869" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="630869" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L11_EP0TP1PP1DP0_GPU12 -->
<g id="node3063" class="node">
<title>attn_L11_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="631131.5,-78 630980.5,-78 630980.5,-26 631131.5,-26 631131.5,-78"/>
<text text-anchor="middle" x="631056" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="631056" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="631056" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="631056" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L11_EP0TP1PP1DP0_GPU12 -->
<g id="node3064" class="node">
<title>attn_out_L11_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="631318,-78 631168,-78 631168,-26 631318,-26 631318,-78"/>
<text text-anchor="middle" x="631243" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="631243" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="631243" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="631243" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L11_EP0TP1PP1DP0_GPU12 -->
<g id="node3065" class="node">
<title>attn_ar_L11_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="631461" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="631461" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="631461" y="-49.5" font-family="Arial" font-size="10.00">L11 EP0 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="631461" y="-38.5" font-family="Arial" font-size="10.00">GPU12</text>
</g>
<!-- residual1_L11_EP0TP1PP1DP0_GPU12 -->
<g id="node3066" class="node">
<title>residual1_L11_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="631754,-78 631604,-78 631604,-26 631754,-26 631754,-78"/>
<text text-anchor="middle" x="631679" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="631679" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="631679" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="631679" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L11_EP0TP1PP1DP0_GPU12 -->
<g id="node3067" class="node">
<title>ln2_L11_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="631940,-78 631790,-78 631790,-26 631940,-26 631940,-78"/>
<text text-anchor="middle" x="631865" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="631865" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="631865" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="631865" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L11_EP0TP1PP1DP0_GPU12 -->
<g id="node3068" class="node">
<title>gate_L11_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightyellow" stroke="black" points="632287.53,-104 632040.12,-104 631976.47,0 632223.88,0 632287.53,-104"/>
<text text-anchor="middle" x="632132" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="632132" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="632132" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="632132" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L11_EP0TP1PP1DP0_GPU12 -->
<g id="node3069" class="node">
<title>dispatch_L11_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="632430" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="632430" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="632430" y="-44" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP0_GPU12</text>
</g>
<!-- expert_0_L11_EP0TP1PP1DP0_GPU12 -->
<g id="node3070" class="node">
<title>expert_0_L11_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="632722,-78 632572,-78 632572,-26 632722,-26 632722,-78"/>
<text text-anchor="middle" x="632647" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="632647" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="632647" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="632647" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L11_EP0TP1PP1DP0_GPU12 -->
<g id="node3071" class="node">
<title>expert_1_L11_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="632908,-78 632758,-78 632758,-26 632908,-26 632908,-78"/>
<text text-anchor="middle" x="632833" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="632833" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="632833" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="632833" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L11_EP0TP1PP1DP0_GPU12 -->
<g id="node3072" class="node">
<title>expert_2_L11_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="633094,-78 632944,-78 632944,-26 633094,-26 633094,-78"/>
<text text-anchor="middle" x="633019" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="633019" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="633019" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="633019" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L11_EP0TP1PP1DP0_GPU12 -->
<g id="node3073" class="node">
<title>expert_3_L11_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="633280,-78 633130,-78 633130,-26 633280,-26 633280,-78"/>
<text text-anchor="middle" x="633205" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="633205" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="633205" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="633205" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L11_EP0TP1PP1DP0_GPU12 -->
<g id="node3074" class="node">
<title>combine_L11_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="633422" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="633422" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="633422" y="-44" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP0_GPU12</text>
</g>
<!-- ffn_L11_EP0TP1PP1DP0_GPU12 -->
<g id="node3075" class="node">
<title>ffn_L11_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="633734,-78 633564,-78 633564,-26 633734,-26 633734,-78"/>
<text text-anchor="middle" x="633649" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="633649" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="633649" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="633649" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L11_EP0TP1PP1DP0_GPU12 -->
<g id="node3076" class="node">
<title>ffn_ar_L11_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="633877" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="633877" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="633877" y="-49.5" font-family="Arial" font-size="10.00">L11 EP0 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="633877" y="-38.5" font-family="Arial" font-size="10.00">GPU12</text>
</g>
<!-- residual2_L11_EP0TP1PP1DP0_GPU12 -->
<g id="node3077" class="node">
<title>residual2_L11_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="634170,-78 634020,-78 634020,-26 634170,-26 634170,-78"/>
<text text-anchor="middle" x="634095" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="634095" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="634095" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="634095" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L11_EP0TP1PP1DP1_GPU13 -->
<g id="node3078" class="node">
<title>ln1_L11_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="634356,-78 634206,-78 634206,-26 634356,-26 634356,-78"/>
<text text-anchor="middle" x="634281" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="634281" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="634281" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="634281" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L11_EP0TP1PP1DP1_GPU13 -->
<g id="node3079" class="node">
<title>qkv_L11_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="634542,-78 634392,-78 634392,-26 634542,-26 634542,-78"/>
<text text-anchor="middle" x="634467" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="634467" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="634467" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="634467" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L11_EP0TP1PP1DP1_GPU13 -->
<g id="node3080" class="node">
<title>attn_L11_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="634729.5,-78 634578.5,-78 634578.5,-26 634729.5,-26 634729.5,-78"/>
<text text-anchor="middle" x="634654" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="634654" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="634654" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="634654" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L11_EP0TP1PP1DP1_GPU13 -->
<g id="node3081" class="node">
<title>attn_out_L11_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="634916,-78 634766,-78 634766,-26 634916,-26 634916,-78"/>
<text text-anchor="middle" x="634841" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="634841" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="634841" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="634841" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L11_EP0TP1PP1DP1_GPU13 -->
<g id="node3082" class="node">
<title>attn_ar_L11_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="635059" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="635059" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="635059" y="-49.5" font-family="Arial" font-size="10.00">L11 EP0 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="635059" y="-38.5" font-family="Arial" font-size="10.00">GPU13</text>
</g>
<!-- residual1_L11_EP0TP1PP1DP1_GPU13 -->
<g id="node3083" class="node">
<title>residual1_L11_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="635352,-78 635202,-78 635202,-26 635352,-26 635352,-78"/>
<text text-anchor="middle" x="635277" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="635277" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="635277" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="635277" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L11_EP0TP1PP1DP1_GPU13 -->
<g id="node3084" class="node">
<title>ln2_L11_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="635538,-78 635388,-78 635388,-26 635538,-26 635538,-78"/>
<text text-anchor="middle" x="635463" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="635463" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="635463" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="635463" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L11_EP0TP1PP1DP1_GPU13 -->
<g id="node3085" class="node">
<title>gate_L11_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightyellow" stroke="black" points="635885.53,-104 635638.12,-104 635574.47,0 635821.88,0 635885.53,-104"/>
<text text-anchor="middle" x="635730" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="635730" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="635730" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="635730" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L11_EP0TP1PP1DP1_GPU13 -->
<g id="node3086" class="node">
<title>dispatch_L11_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="636028" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="636028" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="636028" y="-44" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP1_GPU13</text>
</g>
<!-- expert_0_L11_EP0TP1PP1DP1_GPU13 -->
<g id="node3087" class="node">
<title>expert_0_L11_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="636320,-78 636170,-78 636170,-26 636320,-26 636320,-78"/>
<text text-anchor="middle" x="636245" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="636245" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="636245" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="636245" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L11_EP0TP1PP1DP1_GPU13 -->
<g id="node3088" class="node">
<title>expert_1_L11_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="636506,-78 636356,-78 636356,-26 636506,-26 636506,-78"/>
<text text-anchor="middle" x="636431" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="636431" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="636431" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="636431" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L11_EP0TP1PP1DP1_GPU13 -->
<g id="node3089" class="node">
<title>expert_2_L11_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="636692,-78 636542,-78 636542,-26 636692,-26 636692,-78"/>
<text text-anchor="middle" x="636617" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="636617" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="636617" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="636617" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L11_EP0TP1PP1DP1_GPU13 -->
<g id="node3090" class="node">
<title>expert_3_L11_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="636878,-78 636728,-78 636728,-26 636878,-26 636878,-78"/>
<text text-anchor="middle" x="636803" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="636803" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="636803" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="636803" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L11_EP0TP1PP1DP1_GPU13 -->
<g id="node3091" class="node">
<title>combine_L11_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="637020" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="637020" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="637020" y="-44" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP1_GPU13</text>
</g>
<!-- ffn_L11_EP0TP1PP1DP1_GPU13 -->
<g id="node3092" class="node">
<title>ffn_L11_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="637332,-78 637162,-78 637162,-26 637332,-26 637332,-78"/>
<text text-anchor="middle" x="637247" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="637247" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="637247" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="637247" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L11_EP0TP1PP1DP1_GPU13 -->
<g id="node3093" class="node">
<title>ffn_ar_L11_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="637475" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="637475" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="637475" y="-49.5" font-family="Arial" font-size="10.00">L11 EP0 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="637475" y="-38.5" font-family="Arial" font-size="10.00">GPU13</text>
</g>
<!-- residual2_L11_EP0TP1PP1DP1_GPU13 -->
<g id="node3094" class="node">
<title>residual2_L11_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="637768,-78 637618,-78 637618,-26 637768,-26 637768,-78"/>
<text text-anchor="middle" x="637693" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="637693" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="637693" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="637693" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L11_EP0TP2PP1DP0_GPU20 -->
<g id="node3095" class="node">
<title>ln1_L11_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="637954,-78 637804,-78 637804,-26 637954,-26 637954,-78"/>
<text text-anchor="middle" x="637879" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="637879" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="637879" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="637879" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L11_EP0TP2PP1DP0_GPU20 -->
<g id="node3096" class="node">
<title>qkv_L11_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="638140,-78 637990,-78 637990,-26 638140,-26 638140,-78"/>
<text text-anchor="middle" x="638065" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="638065" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="638065" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="638065" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L11_EP0TP2PP1DP0_GPU20 -->
<g id="node3097" class="node">
<title>attn_L11_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="638327.5,-78 638176.5,-78 638176.5,-26 638327.5,-26 638327.5,-78"/>
<text text-anchor="middle" x="638252" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="638252" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="638252" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="638252" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L11_EP0TP2PP1DP0_GPU20 -->
<g id="node3098" class="node">
<title>attn_out_L11_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="638514,-78 638364,-78 638364,-26 638514,-26 638514,-78"/>
<text text-anchor="middle" x="638439" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="638439" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="638439" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="638439" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L11_EP0TP2PP1DP0_GPU20 -->
<g id="node3099" class="node">
<title>attn_ar_L11_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="638657" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="638657" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="638657" y="-49.5" font-family="Arial" font-size="10.00">L11 EP0 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="638657" y="-38.5" font-family="Arial" font-size="10.00">GPU20</text>
</g>
<!-- residual1_L11_EP0TP2PP1DP0_GPU20 -->
<g id="node3100" class="node">
<title>residual1_L11_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="638950,-78 638800,-78 638800,-26 638950,-26 638950,-78"/>
<text text-anchor="middle" x="638875" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="638875" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="638875" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="638875" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L11_EP0TP2PP1DP0_GPU20 -->
<g id="node3101" class="node">
<title>ln2_L11_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="639136,-78 638986,-78 638986,-26 639136,-26 639136,-78"/>
<text text-anchor="middle" x="639061" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="639061" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="639061" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="639061" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L11_EP0TP2PP1DP0_GPU20 -->
<g id="node3102" class="node">
<title>gate_L11_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightyellow" stroke="black" points="639483.53,-104 639236.12,-104 639172.47,0 639419.88,0 639483.53,-104"/>
<text text-anchor="middle" x="639328" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="639328" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="639328" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="639328" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L11_EP0TP2PP1DP0_GPU20 -->
<g id="node3103" class="node">
<title>dispatch_L11_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="639626" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="639626" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="639626" y="-44" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP0_GPU20</text>
</g>
<!-- expert_0_L11_EP0TP2PP1DP0_GPU20 -->
<g id="node3104" class="node">
<title>expert_0_L11_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="639918,-78 639768,-78 639768,-26 639918,-26 639918,-78"/>
<text text-anchor="middle" x="639843" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="639843" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="639843" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="639843" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L11_EP0TP2PP1DP0_GPU20 -->
<g id="node3105" class="node">
<title>expert_1_L11_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="640104,-78 639954,-78 639954,-26 640104,-26 640104,-78"/>
<text text-anchor="middle" x="640029" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="640029" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="640029" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="640029" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L11_EP0TP2PP1DP0_GPU20 -->
<g id="node3106" class="node">
<title>expert_2_L11_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="640290,-78 640140,-78 640140,-26 640290,-26 640290,-78"/>
<text text-anchor="middle" x="640215" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="640215" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="640215" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="640215" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L11_EP0TP2PP1DP0_GPU20 -->
<g id="node3107" class="node">
<title>expert_3_L11_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="640476,-78 640326,-78 640326,-26 640476,-26 640476,-78"/>
<text text-anchor="middle" x="640401" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="640401" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="640401" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="640401" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L11_EP0TP2PP1DP0_GPU20 -->
<g id="node3108" class="node">
<title>combine_L11_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="640618" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="640618" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="640618" y="-44" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP0_GPU20</text>
</g>
<!-- ffn_L11_EP0TP2PP1DP0_GPU20 -->
<g id="node3109" class="node">
<title>ffn_L11_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="640930,-78 640760,-78 640760,-26 640930,-26 640930,-78"/>
<text text-anchor="middle" x="640845" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="640845" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="640845" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="640845" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L11_EP0TP2PP1DP0_GPU20 -->
<g id="node3110" class="node">
<title>ffn_ar_L11_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="641073" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="641073" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="641073" y="-49.5" font-family="Arial" font-size="10.00">L11 EP0 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="641073" y="-38.5" font-family="Arial" font-size="10.00">GPU20</text>
</g>
<!-- residual2_L11_EP0TP2PP1DP0_GPU20 -->
<g id="node3111" class="node">
<title>residual2_L11_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="641366,-78 641216,-78 641216,-26 641366,-26 641366,-78"/>
<text text-anchor="middle" x="641291" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="641291" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="641291" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="641291" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L11_EP0TP2PP1DP1_GPU21 -->
<g id="node3112" class="node">
<title>ln1_L11_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="641552,-78 641402,-78 641402,-26 641552,-26 641552,-78"/>
<text text-anchor="middle" x="641477" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="641477" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="641477" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="641477" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L11_EP0TP2PP1DP1_GPU21 -->
<g id="node3113" class="node">
<title>qkv_L11_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="641738,-78 641588,-78 641588,-26 641738,-26 641738,-78"/>
<text text-anchor="middle" x="641663" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="641663" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="641663" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="641663" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L11_EP0TP2PP1DP1_GPU21 -->
<g id="node3114" class="node">
<title>attn_L11_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="641925.5,-78 641774.5,-78 641774.5,-26 641925.5,-26 641925.5,-78"/>
<text text-anchor="middle" x="641850" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="641850" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="641850" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="641850" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L11_EP0TP2PP1DP1_GPU21 -->
<g id="node3115" class="node">
<title>attn_out_L11_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="642112,-78 641962,-78 641962,-26 642112,-26 642112,-78"/>
<text text-anchor="middle" x="642037" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="642037" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="642037" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="642037" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L11_EP0TP2PP1DP1_GPU21 -->
<g id="node3116" class="node">
<title>attn_ar_L11_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="642255" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="642255" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="642255" y="-49.5" font-family="Arial" font-size="10.00">L11 EP0 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="642255" y="-38.5" font-family="Arial" font-size="10.00">GPU21</text>
</g>
<!-- residual1_L11_EP0TP2PP1DP1_GPU21 -->
<g id="node3117" class="node">
<title>residual1_L11_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="642548,-78 642398,-78 642398,-26 642548,-26 642548,-78"/>
<text text-anchor="middle" x="642473" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="642473" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="642473" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="642473" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L11_EP0TP2PP1DP1_GPU21 -->
<g id="node3118" class="node">
<title>ln2_L11_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="642734,-78 642584,-78 642584,-26 642734,-26 642734,-78"/>
<text text-anchor="middle" x="642659" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="642659" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="642659" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="642659" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L11_EP0TP2PP1DP1_GPU21 -->
<g id="node3119" class="node">
<title>gate_L11_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightyellow" stroke="black" points="643081.53,-104 642834.12,-104 642770.47,0 643017.88,0 643081.53,-104"/>
<text text-anchor="middle" x="642926" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="642926" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="642926" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="642926" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L11_EP0TP2PP1DP1_GPU21 -->
<g id="node3120" class="node">
<title>dispatch_L11_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="643224" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="643224" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="643224" y="-44" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP1_GPU21</text>
</g>
<!-- expert_0_L11_EP0TP2PP1DP1_GPU21 -->
<g id="node3121" class="node">
<title>expert_0_L11_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="643516,-78 643366,-78 643366,-26 643516,-26 643516,-78"/>
<text text-anchor="middle" x="643441" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="643441" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="643441" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="643441" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L11_EP0TP2PP1DP1_GPU21 -->
<g id="node3122" class="node">
<title>expert_1_L11_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="643702,-78 643552,-78 643552,-26 643702,-26 643702,-78"/>
<text text-anchor="middle" x="643627" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="643627" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="643627" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="643627" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L11_EP0TP2PP1DP1_GPU21 -->
<g id="node3123" class="node">
<title>expert_2_L11_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="643888,-78 643738,-78 643738,-26 643888,-26 643888,-78"/>
<text text-anchor="middle" x="643813" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="643813" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="643813" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="643813" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L11_EP0TP2PP1DP1_GPU21 -->
<g id="node3124" class="node">
<title>expert_3_L11_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="644074,-78 643924,-78 643924,-26 644074,-26 644074,-78"/>
<text text-anchor="middle" x="643999" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="643999" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="643999" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="643999" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L11_EP0TP2PP1DP1_GPU21 -->
<g id="node3125" class="node">
<title>combine_L11_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="644216" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="644216" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="644216" y="-44" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP1_GPU21</text>
</g>
<!-- ffn_L11_EP0TP2PP1DP1_GPU21 -->
<g id="node3126" class="node">
<title>ffn_L11_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="644528,-78 644358,-78 644358,-26 644528,-26 644528,-78"/>
<text text-anchor="middle" x="644443" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="644443" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="644443" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="644443" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L11_EP0TP2PP1DP1_GPU21 -->
<g id="node3127" class="node">
<title>ffn_ar_L11_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="644671" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="644671" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="644671" y="-49.5" font-family="Arial" font-size="10.00">L11 EP0 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="644671" y="-38.5" font-family="Arial" font-size="10.00">GPU21</text>
</g>
<!-- residual2_L11_EP0TP2PP1DP1_GPU21 -->
<g id="node3128" class="node">
<title>residual2_L11_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="644964,-78 644814,-78 644814,-26 644964,-26 644964,-78"/>
<text text-anchor="middle" x="644889" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="644889" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="644889" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="644889" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L11_EP0TP3PP1DP0_GPU28 -->
<g id="node3129" class="node">
<title>ln1_L11_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="645150,-78 645000,-78 645000,-26 645150,-26 645150,-78"/>
<text text-anchor="middle" x="645075" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="645075" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="645075" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="645075" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L11_EP0TP3PP1DP0_GPU28 -->
<g id="node3130" class="node">
<title>qkv_L11_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="645336,-78 645186,-78 645186,-26 645336,-26 645336,-78"/>
<text text-anchor="middle" x="645261" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="645261" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="645261" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="645261" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L11_EP0TP3PP1DP0_GPU28 -->
<g id="node3131" class="node">
<title>attn_L11_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="645523.5,-78 645372.5,-78 645372.5,-26 645523.5,-26 645523.5,-78"/>
<text text-anchor="middle" x="645448" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="645448" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="645448" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="645448" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L11_EP0TP3PP1DP0_GPU28 -->
<g id="node3132" class="node">
<title>attn_out_L11_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="645710,-78 645560,-78 645560,-26 645710,-26 645710,-78"/>
<text text-anchor="middle" x="645635" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="645635" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="645635" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="645635" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L11_EP0TP3PP1DP0_GPU28 -->
<g id="node3133" class="node">
<title>attn_ar_L11_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="645853" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="645853" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="645853" y="-49.5" font-family="Arial" font-size="10.00">L11 EP0 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="645853" y="-38.5" font-family="Arial" font-size="10.00">GPU28</text>
</g>
<!-- residual1_L11_EP0TP3PP1DP0_GPU28 -->
<g id="node3134" class="node">
<title>residual1_L11_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="646146,-78 645996,-78 645996,-26 646146,-26 646146,-78"/>
<text text-anchor="middle" x="646071" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="646071" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="646071" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="646071" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L11_EP0TP3PP1DP0_GPU28 -->
<g id="node3135" class="node">
<title>ln2_L11_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="646332,-78 646182,-78 646182,-26 646332,-26 646332,-78"/>
<text text-anchor="middle" x="646257" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="646257" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="646257" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="646257" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L11_EP0TP3PP1DP0_GPU28 -->
<g id="node3136" class="node">
<title>gate_L11_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightyellow" stroke="black" points="646679.53,-104 646432.12,-104 646368.47,0 646615.88,0 646679.53,-104"/>
<text text-anchor="middle" x="646524" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="646524" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="646524" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="646524" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L11_EP0TP3PP1DP0_GPU28 -->
<g id="node3137" class="node">
<title>dispatch_L11_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="646822" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="646822" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="646822" y="-44" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP0_GPU28</text>
</g>
<!-- expert_0_L11_EP0TP3PP1DP0_GPU28 -->
<g id="node3138" class="node">
<title>expert_0_L11_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="647114,-78 646964,-78 646964,-26 647114,-26 647114,-78"/>
<text text-anchor="middle" x="647039" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="647039" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="647039" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="647039" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L11_EP0TP3PP1DP0_GPU28 -->
<g id="node3139" class="node">
<title>expert_1_L11_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="647300,-78 647150,-78 647150,-26 647300,-26 647300,-78"/>
<text text-anchor="middle" x="647225" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="647225" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="647225" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="647225" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L11_EP0TP3PP1DP0_GPU28 -->
<g id="node3140" class="node">
<title>expert_2_L11_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="647486,-78 647336,-78 647336,-26 647486,-26 647486,-78"/>
<text text-anchor="middle" x="647411" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="647411" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="647411" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="647411" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L11_EP0TP3PP1DP0_GPU28 -->
<g id="node3141" class="node">
<title>expert_3_L11_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="647672,-78 647522,-78 647522,-26 647672,-26 647672,-78"/>
<text text-anchor="middle" x="647597" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="647597" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="647597" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="647597" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L11_EP0TP3PP1DP0_GPU28 -->
<g id="node3142" class="node">
<title>combine_L11_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="647814" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="647814" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="647814" y="-44" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP0_GPU28</text>
</g>
<!-- ffn_L11_EP0TP3PP1DP0_GPU28 -->
<g id="node3143" class="node">
<title>ffn_L11_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="648126,-78 647956,-78 647956,-26 648126,-26 648126,-78"/>
<text text-anchor="middle" x="648041" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="648041" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="648041" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="648041" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L11_EP0TP3PP1DP0_GPU28 -->
<g id="node3144" class="node">
<title>ffn_ar_L11_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="648269" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="648269" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="648269" y="-49.5" font-family="Arial" font-size="10.00">L11 EP0 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="648269" y="-38.5" font-family="Arial" font-size="10.00">GPU28</text>
</g>
<!-- residual2_L11_EP0TP3PP1DP0_GPU28 -->
<g id="node3145" class="node">
<title>residual2_L11_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="648562,-78 648412,-78 648412,-26 648562,-26 648562,-78"/>
<text text-anchor="middle" x="648487" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="648487" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="648487" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="648487" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L11_EP0TP3PP1DP1_GPU29 -->
<g id="node3146" class="node">
<title>ln1_L11_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="648748,-78 648598,-78 648598,-26 648748,-26 648748,-78"/>
<text text-anchor="middle" x="648673" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="648673" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="648673" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="648673" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L11_EP0TP3PP1DP1_GPU29 -->
<g id="node3147" class="node">
<title>qkv_L11_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="648934,-78 648784,-78 648784,-26 648934,-26 648934,-78"/>
<text text-anchor="middle" x="648859" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="648859" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="648859" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="648859" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L11_EP0TP3PP1DP1_GPU29 -->
<g id="node3148" class="node">
<title>attn_L11_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="649121.5,-78 648970.5,-78 648970.5,-26 649121.5,-26 649121.5,-78"/>
<text text-anchor="middle" x="649046" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="649046" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="649046" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="649046" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L11_EP0TP3PP1DP1_GPU29 -->
<g id="node3149" class="node">
<title>attn_out_L11_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="649308,-78 649158,-78 649158,-26 649308,-26 649308,-78"/>
<text text-anchor="middle" x="649233" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="649233" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="649233" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="649233" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L11_EP0TP3PP1DP1_GPU29 -->
<g id="node3150" class="node">
<title>attn_ar_L11_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="649451" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="649451" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="649451" y="-49.5" font-family="Arial" font-size="10.00">L11 EP0 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="649451" y="-38.5" font-family="Arial" font-size="10.00">GPU29</text>
</g>
<!-- residual1_L11_EP0TP3PP1DP1_GPU29 -->
<g id="node3151" class="node">
<title>residual1_L11_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="649744,-78 649594,-78 649594,-26 649744,-26 649744,-78"/>
<text text-anchor="middle" x="649669" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="649669" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="649669" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="649669" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L11_EP0TP3PP1DP1_GPU29 -->
<g id="node3152" class="node">
<title>ln2_L11_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="649930,-78 649780,-78 649780,-26 649930,-26 649930,-78"/>
<text text-anchor="middle" x="649855" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="649855" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="649855" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="649855" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L11_EP0TP3PP1DP1_GPU29 -->
<g id="node3153" class="node">
<title>gate_L11_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightyellow" stroke="black" points="650277.53,-104 650030.12,-104 649966.47,0 650213.88,0 650277.53,-104"/>
<text text-anchor="middle" x="650122" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="650122" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="650122" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="650122" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L11_EP0TP3PP1DP1_GPU29 -->
<g id="node3154" class="node">
<title>dispatch_L11_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="650420" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="650420" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="650420" y="-44" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP1_GPU29</text>
</g>
<!-- expert_0_L11_EP0TP3PP1DP1_GPU29 -->
<g id="node3155" class="node">
<title>expert_0_L11_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="650712,-78 650562,-78 650562,-26 650712,-26 650712,-78"/>
<text text-anchor="middle" x="650637" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="650637" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="650637" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="650637" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L11_EP0TP3PP1DP1_GPU29 -->
<g id="node3156" class="node">
<title>expert_1_L11_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="650898,-78 650748,-78 650748,-26 650898,-26 650898,-78"/>
<text text-anchor="middle" x="650823" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="650823" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="650823" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="650823" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L11_EP0TP3PP1DP1_GPU29 -->
<g id="node3157" class="node">
<title>expert_2_L11_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="651084,-78 650934,-78 650934,-26 651084,-26 651084,-78"/>
<text text-anchor="middle" x="651009" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="651009" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="651009" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="651009" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L11_EP0TP3PP1DP1_GPU29 -->
<g id="node3158" class="node">
<title>expert_3_L11_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="651270,-78 651120,-78 651120,-26 651270,-26 651270,-78"/>
<text text-anchor="middle" x="651195" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="651195" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="651195" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="651195" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L11_EP0TP3PP1DP1_GPU29 -->
<g id="node3159" class="node">
<title>combine_L11_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="651412" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="651412" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="651412" y="-44" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP1_GPU29</text>
</g>
<!-- ffn_L11_EP0TP3PP1DP1_GPU29 -->
<g id="node3160" class="node">
<title>ffn_L11_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="651724,-78 651554,-78 651554,-26 651724,-26 651724,-78"/>
<text text-anchor="middle" x="651639" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="651639" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="651639" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="651639" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L11_EP0TP3PP1DP1_GPU29 -->
<g id="node3161" class="node">
<title>ffn_ar_L11_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="651867" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="651867" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="651867" y="-49.5" font-family="Arial" font-size="10.00">L11 EP0 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="651867" y="-38.5" font-family="Arial" font-size="10.00">GPU29</text>
</g>
<!-- residual2_L11_EP0TP3PP1DP1_GPU29 -->
<g id="node3162" class="node">
<title>residual2_L11_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="652160,-78 652010,-78 652010,-26 652160,-26 652160,-78"/>
<text text-anchor="middle" x="652085" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="652085" y="-55" font-family="Arial" font-size="10.00">L11_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="652085" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="652085" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L11_EP1TP0PP1DP0_GPU36 -->
<g id="node3163" class="node">
<title>ln1_L11_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="652346,-78 652196,-78 652196,-26 652346,-26 652346,-78"/>
<text text-anchor="middle" x="652271" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="652271" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="652271" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="652271" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L11_EP1TP0PP1DP0_GPU36 -->
<g id="node3164" class="node">
<title>qkv_L11_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="652532,-78 652382,-78 652382,-26 652532,-26 652532,-78"/>
<text text-anchor="middle" x="652457" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="652457" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="652457" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="652457" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L11_EP1TP0PP1DP0_GPU36 -->
<g id="node3165" class="node">
<title>attn_L11_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="652719.5,-78 652568.5,-78 652568.5,-26 652719.5,-26 652719.5,-78"/>
<text text-anchor="middle" x="652644" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="652644" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="652644" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="652644" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L11_EP1TP0PP1DP0_GPU36 -->
<g id="node3166" class="node">
<title>attn_out_L11_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="652906,-78 652756,-78 652756,-26 652906,-26 652906,-78"/>
<text text-anchor="middle" x="652831" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="652831" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="652831" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="652831" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L11_EP1TP0PP1DP0_GPU36 -->
<g id="node3167" class="node">
<title>attn_ar_L11_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="653049" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="653049" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="653049" y="-49.5" font-family="Arial" font-size="10.00">L11 EP1 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="653049" y="-38.5" font-family="Arial" font-size="10.00">GPU36</text>
</g>
<!-- residual1_L11_EP1TP0PP1DP0_GPU36 -->
<g id="node3168" class="node">
<title>residual1_L11_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="653342,-78 653192,-78 653192,-26 653342,-26 653342,-78"/>
<text text-anchor="middle" x="653267" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="653267" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="653267" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="653267" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L11_EP1TP0PP1DP0_GPU36 -->
<g id="node3169" class="node">
<title>ln2_L11_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="653528,-78 653378,-78 653378,-26 653528,-26 653528,-78"/>
<text text-anchor="middle" x="653453" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="653453" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="653453" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="653453" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L11_EP1TP0PP1DP0_GPU36 -->
<g id="node3170" class="node">
<title>gate_L11_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightyellow" stroke="black" points="653875.53,-104 653628.12,-104 653564.47,0 653811.88,0 653875.53,-104"/>
<text text-anchor="middle" x="653720" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="653720" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="653720" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="653720" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L11_EP1TP0PP1DP0_GPU36 -->
<g id="node3171" class="node">
<title>dispatch_L11_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="654018" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="654018" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="654018" y="-44" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP0_GPU36</text>
</g>
<!-- expert_0_L11_EP1TP0PP1DP0_GPU36 -->
<g id="node3172" class="node">
<title>expert_0_L11_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="654310,-78 654160,-78 654160,-26 654310,-26 654310,-78"/>
<text text-anchor="middle" x="654235" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="654235" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="654235" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="654235" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L11_EP1TP0PP1DP0_GPU36 -->
<g id="node3173" class="node">
<title>expert_1_L11_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="654496,-78 654346,-78 654346,-26 654496,-26 654496,-78"/>
<text text-anchor="middle" x="654421" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="654421" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="654421" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="654421" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L11_EP1TP0PP1DP0_GPU36 -->
<g id="node3174" class="node">
<title>expert_2_L11_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="654682,-78 654532,-78 654532,-26 654682,-26 654682,-78"/>
<text text-anchor="middle" x="654607" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="654607" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="654607" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="654607" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L11_EP1TP0PP1DP0_GPU36 -->
<g id="node3175" class="node">
<title>expert_3_L11_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="654868,-78 654718,-78 654718,-26 654868,-26 654868,-78"/>
<text text-anchor="middle" x="654793" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="654793" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="654793" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="654793" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L11_EP1TP0PP1DP0_GPU36 -->
<g id="node3176" class="node">
<title>combine_L11_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="655010" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="655010" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="655010" y="-44" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP0_GPU36</text>
</g>
<!-- ffn_L11_EP1TP0PP1DP0_GPU36 -->
<g id="node3177" class="node">
<title>ffn_L11_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="655322,-78 655152,-78 655152,-26 655322,-26 655322,-78"/>
<text text-anchor="middle" x="655237" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="655237" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="655237" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="655237" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L11_EP1TP0PP1DP0_GPU36 -->
<g id="node3178" class="node">
<title>ffn_ar_L11_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="655465" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="655465" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="655465" y="-49.5" font-family="Arial" font-size="10.00">L11 EP1 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="655465" y="-38.5" font-family="Arial" font-size="10.00">GPU36</text>
</g>
<!-- residual2_L11_EP1TP0PP1DP0_GPU36 -->
<g id="node3179" class="node">
<title>residual2_L11_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="655758,-78 655608,-78 655608,-26 655758,-26 655758,-78"/>
<text text-anchor="middle" x="655683" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="655683" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="655683" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="655683" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L11_EP1TP0PP1DP1_GPU37 -->
<g id="node3180" class="node">
<title>ln1_L11_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="655944,-78 655794,-78 655794,-26 655944,-26 655944,-78"/>
<text text-anchor="middle" x="655869" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="655869" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="655869" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="655869" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L11_EP1TP0PP1DP1_GPU37 -->
<g id="node3181" class="node">
<title>qkv_L11_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="656130,-78 655980,-78 655980,-26 656130,-26 656130,-78"/>
<text text-anchor="middle" x="656055" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="656055" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="656055" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="656055" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L11_EP1TP0PP1DP1_GPU37 -->
<g id="node3182" class="node">
<title>attn_L11_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="656317.5,-78 656166.5,-78 656166.5,-26 656317.5,-26 656317.5,-78"/>
<text text-anchor="middle" x="656242" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="656242" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="656242" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="656242" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L11_EP1TP0PP1DP1_GPU37 -->
<g id="node3183" class="node">
<title>attn_out_L11_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="656504,-78 656354,-78 656354,-26 656504,-26 656504,-78"/>
<text text-anchor="middle" x="656429" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="656429" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="656429" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="656429" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L11_EP1TP0PP1DP1_GPU37 -->
<g id="node3184" class="node">
<title>attn_ar_L11_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="656647" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="656647" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="656647" y="-49.5" font-family="Arial" font-size="10.00">L11 EP1 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="656647" y="-38.5" font-family="Arial" font-size="10.00">GPU37</text>
</g>
<!-- residual1_L11_EP1TP0PP1DP1_GPU37 -->
<g id="node3185" class="node">
<title>residual1_L11_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="656940,-78 656790,-78 656790,-26 656940,-26 656940,-78"/>
<text text-anchor="middle" x="656865" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="656865" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="656865" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="656865" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L11_EP1TP0PP1DP1_GPU37 -->
<g id="node3186" class="node">
<title>ln2_L11_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="657126,-78 656976,-78 656976,-26 657126,-26 657126,-78"/>
<text text-anchor="middle" x="657051" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="657051" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="657051" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="657051" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L11_EP1TP0PP1DP1_GPU37 -->
<g id="node3187" class="node">
<title>gate_L11_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightyellow" stroke="black" points="657473.53,-104 657226.12,-104 657162.47,0 657409.88,0 657473.53,-104"/>
<text text-anchor="middle" x="657318" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="657318" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="657318" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="657318" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L11_EP1TP0PP1DP1_GPU37 -->
<g id="node3188" class="node">
<title>dispatch_L11_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="657616" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="657616" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="657616" y="-44" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP1_GPU37</text>
</g>
<!-- expert_0_L11_EP1TP0PP1DP1_GPU37 -->
<g id="node3189" class="node">
<title>expert_0_L11_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="657908,-78 657758,-78 657758,-26 657908,-26 657908,-78"/>
<text text-anchor="middle" x="657833" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="657833" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="657833" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="657833" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L11_EP1TP0PP1DP1_GPU37 -->
<g id="node3190" class="node">
<title>expert_1_L11_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="658094,-78 657944,-78 657944,-26 658094,-26 658094,-78"/>
<text text-anchor="middle" x="658019" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="658019" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="658019" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="658019" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L11_EP1TP0PP1DP1_GPU37 -->
<g id="node3191" class="node">
<title>expert_2_L11_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="658280,-78 658130,-78 658130,-26 658280,-26 658280,-78"/>
<text text-anchor="middle" x="658205" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="658205" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="658205" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="658205" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L11_EP1TP0PP1DP1_GPU37 -->
<g id="node3192" class="node">
<title>expert_3_L11_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="658466,-78 658316,-78 658316,-26 658466,-26 658466,-78"/>
<text text-anchor="middle" x="658391" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="658391" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="658391" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="658391" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L11_EP1TP0PP1DP1_GPU37 -->
<g id="node3193" class="node">
<title>combine_L11_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="658608" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="658608" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="658608" y="-44" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP1_GPU37</text>
</g>
<!-- ffn_L11_EP1TP0PP1DP1_GPU37 -->
<g id="node3194" class="node">
<title>ffn_L11_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="658920,-78 658750,-78 658750,-26 658920,-26 658920,-78"/>
<text text-anchor="middle" x="658835" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="658835" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="658835" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="658835" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L11_EP1TP0PP1DP1_GPU37 -->
<g id="node3195" class="node">
<title>ffn_ar_L11_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="659063" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="659063" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="659063" y="-49.5" font-family="Arial" font-size="10.00">L11 EP1 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="659063" y="-38.5" font-family="Arial" font-size="10.00">GPU37</text>
</g>
<!-- residual2_L11_EP1TP0PP1DP1_GPU37 -->
<g id="node3196" class="node">
<title>residual2_L11_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="659356,-78 659206,-78 659206,-26 659356,-26 659356,-78"/>
<text text-anchor="middle" x="659281" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="659281" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="659281" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="659281" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L11_EP1TP1PP1DP0_GPU44 -->
<g id="node3197" class="node">
<title>ln1_L11_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="659542,-78 659392,-78 659392,-26 659542,-26 659542,-78"/>
<text text-anchor="middle" x="659467" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="659467" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="659467" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="659467" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L11_EP1TP1PP1DP0_GPU44 -->
<g id="node3198" class="node">
<title>qkv_L11_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="659728,-78 659578,-78 659578,-26 659728,-26 659728,-78"/>
<text text-anchor="middle" x="659653" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="659653" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="659653" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="659653" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L11_EP1TP1PP1DP0_GPU44 -->
<g id="node3199" class="node">
<title>attn_L11_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="659915.5,-78 659764.5,-78 659764.5,-26 659915.5,-26 659915.5,-78"/>
<text text-anchor="middle" x="659840" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="659840" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="659840" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="659840" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L11_EP1TP1PP1DP0_GPU44 -->
<g id="node3200" class="node">
<title>attn_out_L11_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="660102,-78 659952,-78 659952,-26 660102,-26 660102,-78"/>
<text text-anchor="middle" x="660027" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="660027" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="660027" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="660027" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L11_EP1TP1PP1DP0_GPU44 -->
<g id="node3201" class="node">
<title>attn_ar_L11_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="660245" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="660245" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="660245" y="-49.5" font-family="Arial" font-size="10.00">L11 EP1 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="660245" y="-38.5" font-family="Arial" font-size="10.00">GPU44</text>
</g>
<!-- residual1_L11_EP1TP1PP1DP0_GPU44 -->
<g id="node3202" class="node">
<title>residual1_L11_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="660538,-78 660388,-78 660388,-26 660538,-26 660538,-78"/>
<text text-anchor="middle" x="660463" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="660463" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="660463" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="660463" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L11_EP1TP1PP1DP0_GPU44 -->
<g id="node3203" class="node">
<title>ln2_L11_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="660724,-78 660574,-78 660574,-26 660724,-26 660724,-78"/>
<text text-anchor="middle" x="660649" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="660649" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="660649" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="660649" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L11_EP1TP1PP1DP0_GPU44 -->
<g id="node3204" class="node">
<title>gate_L11_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightyellow" stroke="black" points="661071.53,-104 660824.12,-104 660760.47,0 661007.88,0 661071.53,-104"/>
<text text-anchor="middle" x="660916" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="660916" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="660916" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="660916" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L11_EP1TP1PP1DP0_GPU44 -->
<g id="node3205" class="node">
<title>dispatch_L11_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="661214" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="661214" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="661214" y="-44" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP0_GPU44</text>
</g>
<!-- expert_0_L11_EP1TP1PP1DP0_GPU44 -->
<g id="node3206" class="node">
<title>expert_0_L11_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="661506,-78 661356,-78 661356,-26 661506,-26 661506,-78"/>
<text text-anchor="middle" x="661431" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="661431" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="661431" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="661431" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L11_EP1TP1PP1DP0_GPU44 -->
<g id="node3207" class="node">
<title>expert_1_L11_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="661692,-78 661542,-78 661542,-26 661692,-26 661692,-78"/>
<text text-anchor="middle" x="661617" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="661617" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="661617" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="661617" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L11_EP1TP1PP1DP0_GPU44 -->
<g id="node3208" class="node">
<title>expert_2_L11_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="661878,-78 661728,-78 661728,-26 661878,-26 661878,-78"/>
<text text-anchor="middle" x="661803" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="661803" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="661803" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="661803" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L11_EP1TP1PP1DP0_GPU44 -->
<g id="node3209" class="node">
<title>expert_3_L11_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="662064,-78 661914,-78 661914,-26 662064,-26 662064,-78"/>
<text text-anchor="middle" x="661989" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="661989" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="661989" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="661989" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L11_EP1TP1PP1DP0_GPU44 -->
<g id="node3210" class="node">
<title>combine_L11_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="662206" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="662206" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="662206" y="-44" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP0_GPU44</text>
</g>
<!-- ffn_L11_EP1TP1PP1DP0_GPU44 -->
<g id="node3211" class="node">
<title>ffn_L11_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="662518,-78 662348,-78 662348,-26 662518,-26 662518,-78"/>
<text text-anchor="middle" x="662433" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="662433" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="662433" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="662433" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L11_EP1TP1PP1DP0_GPU44 -->
<g id="node3212" class="node">
<title>ffn_ar_L11_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="662661" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="662661" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="662661" y="-49.5" font-family="Arial" font-size="10.00">L11 EP1 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="662661" y="-38.5" font-family="Arial" font-size="10.00">GPU44</text>
</g>
<!-- residual2_L11_EP1TP1PP1DP0_GPU44 -->
<g id="node3213" class="node">
<title>residual2_L11_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="662954,-78 662804,-78 662804,-26 662954,-26 662954,-78"/>
<text text-anchor="middle" x="662879" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="662879" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="662879" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="662879" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L11_EP1TP1PP1DP1_GPU45 -->
<g id="node3214" class="node">
<title>ln1_L11_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="663140,-78 662990,-78 662990,-26 663140,-26 663140,-78"/>
<text text-anchor="middle" x="663065" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="663065" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="663065" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="663065" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L11_EP1TP1PP1DP1_GPU45 -->
<g id="node3215" class="node">
<title>qkv_L11_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="663326,-78 663176,-78 663176,-26 663326,-26 663326,-78"/>
<text text-anchor="middle" x="663251" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="663251" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="663251" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="663251" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L11_EP1TP1PP1DP1_GPU45 -->
<g id="node3216" class="node">
<title>attn_L11_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="663513.5,-78 663362.5,-78 663362.5,-26 663513.5,-26 663513.5,-78"/>
<text text-anchor="middle" x="663438" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="663438" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="663438" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="663438" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L11_EP1TP1PP1DP1_GPU45 -->
<g id="node3217" class="node">
<title>attn_out_L11_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="663700,-78 663550,-78 663550,-26 663700,-26 663700,-78"/>
<text text-anchor="middle" x="663625" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="663625" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="663625" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="663625" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L11_EP1TP1PP1DP1_GPU45 -->
<g id="node3218" class="node">
<title>attn_ar_L11_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="663843" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="663843" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="663843" y="-49.5" font-family="Arial" font-size="10.00">L11 EP1 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="663843" y="-38.5" font-family="Arial" font-size="10.00">GPU45</text>
</g>
<!-- residual1_L11_EP1TP1PP1DP1_GPU45 -->
<g id="node3219" class="node">
<title>residual1_L11_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="664136,-78 663986,-78 663986,-26 664136,-26 664136,-78"/>
<text text-anchor="middle" x="664061" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="664061" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="664061" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="664061" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L11_EP1TP1PP1DP1_GPU45 -->
<g id="node3220" class="node">
<title>ln2_L11_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="664322,-78 664172,-78 664172,-26 664322,-26 664322,-78"/>
<text text-anchor="middle" x="664247" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="664247" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="664247" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="664247" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L11_EP1TP1PP1DP1_GPU45 -->
<g id="node3221" class="node">
<title>gate_L11_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightyellow" stroke="black" points="664669.53,-104 664422.12,-104 664358.47,0 664605.88,0 664669.53,-104"/>
<text text-anchor="middle" x="664514" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="664514" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="664514" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="664514" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L11_EP1TP1PP1DP1_GPU45 -->
<g id="node3222" class="node">
<title>dispatch_L11_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="664812" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="664812" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="664812" y="-44" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP1_GPU45</text>
</g>
<!-- expert_0_L11_EP1TP1PP1DP1_GPU45 -->
<g id="node3223" class="node">
<title>expert_0_L11_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="665104,-78 664954,-78 664954,-26 665104,-26 665104,-78"/>
<text text-anchor="middle" x="665029" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="665029" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="665029" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="665029" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L11_EP1TP1PP1DP1_GPU45 -->
<g id="node3224" class="node">
<title>expert_1_L11_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="665290,-78 665140,-78 665140,-26 665290,-26 665290,-78"/>
<text text-anchor="middle" x="665215" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="665215" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="665215" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="665215" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L11_EP1TP1PP1DP1_GPU45 -->
<g id="node3225" class="node">
<title>expert_2_L11_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="665476,-78 665326,-78 665326,-26 665476,-26 665476,-78"/>
<text text-anchor="middle" x="665401" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="665401" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="665401" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="665401" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L11_EP1TP1PP1DP1_GPU45 -->
<g id="node3226" class="node">
<title>expert_3_L11_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="665662,-78 665512,-78 665512,-26 665662,-26 665662,-78"/>
<text text-anchor="middle" x="665587" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="665587" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="665587" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="665587" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L11_EP1TP1PP1DP1_GPU45 -->
<g id="node3227" class="node">
<title>combine_L11_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="665804" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="665804" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="665804" y="-44" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP1_GPU45</text>
</g>
<!-- ffn_L11_EP1TP1PP1DP1_GPU45 -->
<g id="node3228" class="node">
<title>ffn_L11_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="666116,-78 665946,-78 665946,-26 666116,-26 666116,-78"/>
<text text-anchor="middle" x="666031" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="666031" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="666031" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="666031" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L11_EP1TP1PP1DP1_GPU45 -->
<g id="node3229" class="node">
<title>ffn_ar_L11_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="666259" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="666259" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="666259" y="-49.5" font-family="Arial" font-size="10.00">L11 EP1 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="666259" y="-38.5" font-family="Arial" font-size="10.00">GPU45</text>
</g>
<!-- residual2_L11_EP1TP1PP1DP1_GPU45 -->
<g id="node3230" class="node">
<title>residual2_L11_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="666552,-78 666402,-78 666402,-26 666552,-26 666552,-78"/>
<text text-anchor="middle" x="666477" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="666477" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="666477" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="666477" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L11_EP1TP2PP1DP0_GPU52 -->
<g id="node3231" class="node">
<title>ln1_L11_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="666738,-78 666588,-78 666588,-26 666738,-26 666738,-78"/>
<text text-anchor="middle" x="666663" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="666663" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="666663" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="666663" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L11_EP1TP2PP1DP0_GPU52 -->
<g id="node3232" class="node">
<title>qkv_L11_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="666924,-78 666774,-78 666774,-26 666924,-26 666924,-78"/>
<text text-anchor="middle" x="666849" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="666849" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="666849" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="666849" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L11_EP1TP2PP1DP0_GPU52 -->
<g id="node3233" class="node">
<title>attn_L11_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="667111.5,-78 666960.5,-78 666960.5,-26 667111.5,-26 667111.5,-78"/>
<text text-anchor="middle" x="667036" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="667036" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="667036" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="667036" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L11_EP1TP2PP1DP0_GPU52 -->
<g id="node3234" class="node">
<title>attn_out_L11_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="667298,-78 667148,-78 667148,-26 667298,-26 667298,-78"/>
<text text-anchor="middle" x="667223" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="667223" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="667223" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="667223" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L11_EP1TP2PP1DP0_GPU52 -->
<g id="node3235" class="node">
<title>attn_ar_L11_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="667441" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="667441" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="667441" y="-49.5" font-family="Arial" font-size="10.00">L11 EP1 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="667441" y="-38.5" font-family="Arial" font-size="10.00">GPU52</text>
</g>
<!-- residual1_L11_EP1TP2PP1DP0_GPU52 -->
<g id="node3236" class="node">
<title>residual1_L11_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="667734,-78 667584,-78 667584,-26 667734,-26 667734,-78"/>
<text text-anchor="middle" x="667659" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="667659" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="667659" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="667659" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L11_EP1TP2PP1DP0_GPU52 -->
<g id="node3237" class="node">
<title>ln2_L11_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="667920,-78 667770,-78 667770,-26 667920,-26 667920,-78"/>
<text text-anchor="middle" x="667845" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="667845" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="667845" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="667845" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L11_EP1TP2PP1DP0_GPU52 -->
<g id="node3238" class="node">
<title>gate_L11_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightyellow" stroke="black" points="668267.53,-104 668020.12,-104 667956.47,0 668203.88,0 668267.53,-104"/>
<text text-anchor="middle" x="668112" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="668112" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="668112" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="668112" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L11_EP1TP2PP1DP0_GPU52 -->
<g id="node3239" class="node">
<title>dispatch_L11_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="668410" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="668410" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="668410" y="-44" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP0_GPU52</text>
</g>
<!-- expert_0_L11_EP1TP2PP1DP0_GPU52 -->
<g id="node3240" class="node">
<title>expert_0_L11_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="668702,-78 668552,-78 668552,-26 668702,-26 668702,-78"/>
<text text-anchor="middle" x="668627" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="668627" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="668627" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="668627" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L11_EP1TP2PP1DP0_GPU52 -->
<g id="node3241" class="node">
<title>expert_1_L11_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="668888,-78 668738,-78 668738,-26 668888,-26 668888,-78"/>
<text text-anchor="middle" x="668813" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="668813" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="668813" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="668813" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L11_EP1TP2PP1DP0_GPU52 -->
<g id="node3242" class="node">
<title>expert_2_L11_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="669074,-78 668924,-78 668924,-26 669074,-26 669074,-78"/>
<text text-anchor="middle" x="668999" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="668999" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="668999" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="668999" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L11_EP1TP2PP1DP0_GPU52 -->
<g id="node3243" class="node">
<title>expert_3_L11_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="669260,-78 669110,-78 669110,-26 669260,-26 669260,-78"/>
<text text-anchor="middle" x="669185" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="669185" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="669185" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="669185" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L11_EP1TP2PP1DP0_GPU52 -->
<g id="node3244" class="node">
<title>combine_L11_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="669402" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="669402" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="669402" y="-44" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP0_GPU52</text>
</g>
<!-- ffn_L11_EP1TP2PP1DP0_GPU52 -->
<g id="node3245" class="node">
<title>ffn_L11_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="669714,-78 669544,-78 669544,-26 669714,-26 669714,-78"/>
<text text-anchor="middle" x="669629" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="669629" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="669629" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="669629" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L11_EP1TP2PP1DP0_GPU52 -->
<g id="node3246" class="node">
<title>ffn_ar_L11_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="669857" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="669857" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="669857" y="-49.5" font-family="Arial" font-size="10.00">L11 EP1 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="669857" y="-38.5" font-family="Arial" font-size="10.00">GPU52</text>
</g>
<!-- residual2_L11_EP1TP2PP1DP0_GPU52 -->
<g id="node3247" class="node">
<title>residual2_L11_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="670150,-78 670000,-78 670000,-26 670150,-26 670150,-78"/>
<text text-anchor="middle" x="670075" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="670075" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="670075" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="670075" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L11_EP1TP2PP1DP1_GPU53 -->
<g id="node3248" class="node">
<title>ln1_L11_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="670336,-78 670186,-78 670186,-26 670336,-26 670336,-78"/>
<text text-anchor="middle" x="670261" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="670261" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="670261" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="670261" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L11_EP1TP2PP1DP1_GPU53 -->
<g id="node3249" class="node">
<title>qkv_L11_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="670522,-78 670372,-78 670372,-26 670522,-26 670522,-78"/>
<text text-anchor="middle" x="670447" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="670447" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="670447" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="670447" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L11_EP1TP2PP1DP1_GPU53 -->
<g id="node3250" class="node">
<title>attn_L11_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="670709.5,-78 670558.5,-78 670558.5,-26 670709.5,-26 670709.5,-78"/>
<text text-anchor="middle" x="670634" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="670634" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="670634" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="670634" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L11_EP1TP2PP1DP1_GPU53 -->
<g id="node3251" class="node">
<title>attn_out_L11_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="670896,-78 670746,-78 670746,-26 670896,-26 670896,-78"/>
<text text-anchor="middle" x="670821" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="670821" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="670821" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="670821" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L11_EP1TP2PP1DP1_GPU53 -->
<g id="node3252" class="node">
<title>attn_ar_L11_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="671039" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="671039" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="671039" y="-49.5" font-family="Arial" font-size="10.00">L11 EP1 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="671039" y="-38.5" font-family="Arial" font-size="10.00">GPU53</text>
</g>
<!-- residual1_L11_EP1TP2PP1DP1_GPU53 -->
<g id="node3253" class="node">
<title>residual1_L11_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="671332,-78 671182,-78 671182,-26 671332,-26 671332,-78"/>
<text text-anchor="middle" x="671257" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="671257" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="671257" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="671257" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L11_EP1TP2PP1DP1_GPU53 -->
<g id="node3254" class="node">
<title>ln2_L11_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="671518,-78 671368,-78 671368,-26 671518,-26 671518,-78"/>
<text text-anchor="middle" x="671443" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="671443" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="671443" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="671443" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L11_EP1TP2PP1DP1_GPU53 -->
<g id="node3255" class="node">
<title>gate_L11_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightyellow" stroke="black" points="671865.53,-104 671618.12,-104 671554.47,0 671801.88,0 671865.53,-104"/>
<text text-anchor="middle" x="671710" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="671710" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="671710" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="671710" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L11_EP1TP2PP1DP1_GPU53 -->
<g id="node3256" class="node">
<title>dispatch_L11_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="672008" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="672008" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="672008" y="-44" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP1_GPU53</text>
</g>
<!-- expert_0_L11_EP1TP2PP1DP1_GPU53 -->
<g id="node3257" class="node">
<title>expert_0_L11_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="672300,-78 672150,-78 672150,-26 672300,-26 672300,-78"/>
<text text-anchor="middle" x="672225" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="672225" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="672225" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="672225" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L11_EP1TP2PP1DP1_GPU53 -->
<g id="node3258" class="node">
<title>expert_1_L11_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="672486,-78 672336,-78 672336,-26 672486,-26 672486,-78"/>
<text text-anchor="middle" x="672411" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="672411" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="672411" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="672411" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L11_EP1TP2PP1DP1_GPU53 -->
<g id="node3259" class="node">
<title>expert_2_L11_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="672672,-78 672522,-78 672522,-26 672672,-26 672672,-78"/>
<text text-anchor="middle" x="672597" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="672597" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="672597" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="672597" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L11_EP1TP2PP1DP1_GPU53 -->
<g id="node3260" class="node">
<title>expert_3_L11_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="672858,-78 672708,-78 672708,-26 672858,-26 672858,-78"/>
<text text-anchor="middle" x="672783" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="672783" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="672783" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="672783" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L11_EP1TP2PP1DP1_GPU53 -->
<g id="node3261" class="node">
<title>combine_L11_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="673000" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="673000" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="673000" y="-44" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP1_GPU53</text>
</g>
<!-- ffn_L11_EP1TP2PP1DP1_GPU53 -->
<g id="node3262" class="node">
<title>ffn_L11_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="673312,-78 673142,-78 673142,-26 673312,-26 673312,-78"/>
<text text-anchor="middle" x="673227" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="673227" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="673227" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="673227" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L11_EP1TP2PP1DP1_GPU53 -->
<g id="node3263" class="node">
<title>ffn_ar_L11_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="673455" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="673455" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="673455" y="-49.5" font-family="Arial" font-size="10.00">L11 EP1 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="673455" y="-38.5" font-family="Arial" font-size="10.00">GPU53</text>
</g>
<!-- residual2_L11_EP1TP2PP1DP1_GPU53 -->
<g id="node3264" class="node">
<title>residual2_L11_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="673748,-78 673598,-78 673598,-26 673748,-26 673748,-78"/>
<text text-anchor="middle" x="673673" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="673673" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="673673" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="673673" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L11_EP1TP3PP1DP0_GPU60 -->
<g id="node3265" class="node">
<title>ln1_L11_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="673934,-78 673784,-78 673784,-26 673934,-26 673934,-78"/>
<text text-anchor="middle" x="673859" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="673859" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="673859" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="673859" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L11_EP1TP3PP1DP0_GPU60 -->
<g id="node3266" class="node">
<title>qkv_L11_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="674120,-78 673970,-78 673970,-26 674120,-26 674120,-78"/>
<text text-anchor="middle" x="674045" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="674045" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="674045" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="674045" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L11_EP1TP3PP1DP0_GPU60 -->
<g id="node3267" class="node">
<title>attn_L11_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="674307.5,-78 674156.5,-78 674156.5,-26 674307.5,-26 674307.5,-78"/>
<text text-anchor="middle" x="674232" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="674232" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="674232" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="674232" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L11_EP1TP3PP1DP0_GPU60 -->
<g id="node3268" class="node">
<title>attn_out_L11_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="674494,-78 674344,-78 674344,-26 674494,-26 674494,-78"/>
<text text-anchor="middle" x="674419" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="674419" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="674419" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="674419" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L11_EP1TP3PP1DP0_GPU60 -->
<g id="node3269" class="node">
<title>attn_ar_L11_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="674637" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="674637" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="674637" y="-49.5" font-family="Arial" font-size="10.00">L11 EP1 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="674637" y="-38.5" font-family="Arial" font-size="10.00">GPU60</text>
</g>
<!-- residual1_L11_EP1TP3PP1DP0_GPU60 -->
<g id="node3270" class="node">
<title>residual1_L11_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="674930,-78 674780,-78 674780,-26 674930,-26 674930,-78"/>
<text text-anchor="middle" x="674855" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="674855" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="674855" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="674855" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L11_EP1TP3PP1DP0_GPU60 -->
<g id="node3271" class="node">
<title>ln2_L11_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="675116,-78 674966,-78 674966,-26 675116,-26 675116,-78"/>
<text text-anchor="middle" x="675041" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="675041" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="675041" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="675041" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L11_EP1TP3PP1DP0_GPU60 -->
<g id="node3272" class="node">
<title>gate_L11_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightyellow" stroke="black" points="675463.53,-104 675216.12,-104 675152.47,0 675399.88,0 675463.53,-104"/>
<text text-anchor="middle" x="675308" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="675308" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="675308" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="675308" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L11_EP1TP3PP1DP0_GPU60 -->
<g id="node3273" class="node">
<title>dispatch_L11_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="675606" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="675606" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="675606" y="-44" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP0_GPU60</text>
</g>
<!-- expert_0_L11_EP1TP3PP1DP0_GPU60 -->
<g id="node3274" class="node">
<title>expert_0_L11_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="675898,-78 675748,-78 675748,-26 675898,-26 675898,-78"/>
<text text-anchor="middle" x="675823" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="675823" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="675823" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="675823" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L11_EP1TP3PP1DP0_GPU60 -->
<g id="node3275" class="node">
<title>expert_1_L11_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="676084,-78 675934,-78 675934,-26 676084,-26 676084,-78"/>
<text text-anchor="middle" x="676009" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="676009" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="676009" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="676009" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L11_EP1TP3PP1DP0_GPU60 -->
<g id="node3276" class="node">
<title>expert_2_L11_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="676270,-78 676120,-78 676120,-26 676270,-26 676270,-78"/>
<text text-anchor="middle" x="676195" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="676195" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="676195" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="676195" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L11_EP1TP3PP1DP0_GPU60 -->
<g id="node3277" class="node">
<title>expert_3_L11_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="676456,-78 676306,-78 676306,-26 676456,-26 676456,-78"/>
<text text-anchor="middle" x="676381" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="676381" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="676381" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="676381" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L11_EP1TP3PP1DP0_GPU60 -->
<g id="node3278" class="node">
<title>combine_L11_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="676598" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="676598" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="676598" y="-44" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP0_GPU60</text>
</g>
<!-- ffn_L11_EP1TP3PP1DP0_GPU60 -->
<g id="node3279" class="node">
<title>ffn_L11_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="676910,-78 676740,-78 676740,-26 676910,-26 676910,-78"/>
<text text-anchor="middle" x="676825" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="676825" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="676825" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="676825" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L11_EP1TP3PP1DP0_GPU60 -->
<g id="node3280" class="node">
<title>ffn_ar_L11_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="677053" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="677053" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="677053" y="-49.5" font-family="Arial" font-size="10.00">L11 EP1 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="677053" y="-38.5" font-family="Arial" font-size="10.00">GPU60</text>
</g>
<!-- residual2_L11_EP1TP3PP1DP0_GPU60 -->
<g id="node3281" class="node">
<title>residual2_L11_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="677346,-78 677196,-78 677196,-26 677346,-26 677346,-78"/>
<text text-anchor="middle" x="677271" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="677271" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="677271" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="677271" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L11_EP1TP3PP1DP1_GPU61 -->
<g id="node3282" class="node">
<title>ln1_L11_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="677532,-78 677382,-78 677382,-26 677532,-26 677532,-78"/>
<text text-anchor="middle" x="677457" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="677457" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="677457" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="677457" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L11_EP1TP3PP1DP1_GPU61 -->
<g id="node3283" class="node">
<title>qkv_L11_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="677718,-78 677568,-78 677568,-26 677718,-26 677718,-78"/>
<text text-anchor="middle" x="677643" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="677643" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="677643" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="677643" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L11_EP1TP3PP1DP1_GPU61 -->
<g id="node3284" class="node">
<title>attn_L11_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="677905.5,-78 677754.5,-78 677754.5,-26 677905.5,-26 677905.5,-78"/>
<text text-anchor="middle" x="677830" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="677830" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="677830" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="677830" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L11_EP1TP3PP1DP1_GPU61 -->
<g id="node3285" class="node">
<title>attn_out_L11_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="678092,-78 677942,-78 677942,-26 678092,-26 678092,-78"/>
<text text-anchor="middle" x="678017" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="678017" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="678017" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="678017" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L11_EP1TP3PP1DP1_GPU61 -->
<g id="node3286" class="node">
<title>attn_ar_L11_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="678235" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="678235" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="678235" y="-49.5" font-family="Arial" font-size="10.00">L11 EP1 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="678235" y="-38.5" font-family="Arial" font-size="10.00">GPU61</text>
</g>
<!-- residual1_L11_EP1TP3PP1DP1_GPU61 -->
<g id="node3287" class="node">
<title>residual1_L11_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="678528,-78 678378,-78 678378,-26 678528,-26 678528,-78"/>
<text text-anchor="middle" x="678453" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="678453" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="678453" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="678453" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L11_EP1TP3PP1DP1_GPU61 -->
<g id="node3288" class="node">
<title>ln2_L11_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="678714,-78 678564,-78 678564,-26 678714,-26 678714,-78"/>
<text text-anchor="middle" x="678639" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="678639" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="678639" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="678639" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L11_EP1TP3PP1DP1_GPU61 -->
<g id="node3289" class="node">
<title>gate_L11_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightyellow" stroke="black" points="679061.53,-104 678814.12,-104 678750.47,0 678997.88,0 679061.53,-104"/>
<text text-anchor="middle" x="678906" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="678906" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="678906" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="678906" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L11_EP1TP3PP1DP1_GPU61 -->
<g id="node3290" class="node">
<title>dispatch_L11_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="679204" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="679204" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="679204" y="-44" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP1_GPU61</text>
</g>
<!-- expert_0_L11_EP1TP3PP1DP1_GPU61 -->
<g id="node3291" class="node">
<title>expert_0_L11_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="679496,-78 679346,-78 679346,-26 679496,-26 679496,-78"/>
<text text-anchor="middle" x="679421" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="679421" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="679421" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="679421" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L11_EP1TP3PP1DP1_GPU61 -->
<g id="node3292" class="node">
<title>expert_1_L11_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="679682,-78 679532,-78 679532,-26 679682,-26 679682,-78"/>
<text text-anchor="middle" x="679607" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="679607" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="679607" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="679607" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L11_EP1TP3PP1DP1_GPU61 -->
<g id="node3293" class="node">
<title>expert_2_L11_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="679868,-78 679718,-78 679718,-26 679868,-26 679868,-78"/>
<text text-anchor="middle" x="679793" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="679793" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="679793" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="679793" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L11_EP1TP3PP1DP1_GPU61 -->
<g id="node3294" class="node">
<title>expert_3_L11_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="680054,-78 679904,-78 679904,-26 680054,-26 680054,-78"/>
<text text-anchor="middle" x="679979" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="679979" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="679979" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="679979" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L11_EP1TP3PP1DP1_GPU61 -->
<g id="node3295" class="node">
<title>combine_L11_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="680196" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="680196" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="680196" y="-44" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP1_GPU61</text>
</g>
<!-- ffn_L11_EP1TP3PP1DP1_GPU61 -->
<g id="node3296" class="node">
<title>ffn_L11_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="680508,-78 680338,-78 680338,-26 680508,-26 680508,-78"/>
<text text-anchor="middle" x="680423" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="680423" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="680423" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="680423" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L11_EP1TP3PP1DP1_GPU61 -->
<g id="node3297" class="node">
<title>ffn_ar_L11_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="680651" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="680651" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="680651" y="-49.5" font-family="Arial" font-size="10.00">L11 EP1 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="680651" y="-38.5" font-family="Arial" font-size="10.00">GPU61</text>
</g>
<!-- residual2_L11_EP1TP3PP1DP1_GPU61 -->
<g id="node3298" class="node">
<title>residual2_L11_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="680944,-78 680794,-78 680794,-26 680944,-26 680944,-78"/>
<text text-anchor="middle" x="680869" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="680869" y="-55" font-family="Arial" font-size="10.00">L11_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="680869" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="680869" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L12_EP0TP0PP1DP0_GPU4 -->
<g id="node3299" class="node">
<title>ln1_L12_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="681125.5,-78 680980.5,-78 680980.5,-26 681125.5,-26 681125.5,-78"/>
<text text-anchor="middle" x="681053" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="681053" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="681053" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="681053" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L12_EP0TP0PP1DP0_GPU4 -->
<g id="node3300" class="node">
<title>qkv_L12_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="681306.5,-78 681161.5,-78 681161.5,-26 681306.5,-26 681306.5,-78"/>
<text text-anchor="middle" x="681234" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="681234" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="681234" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="681234" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L12_EP0TP0PP1DP0_GPU4 -->
<g id="node3301" class="node">
<title>attn_L12_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="681493.5,-78 681342.5,-78 681342.5,-26 681493.5,-26 681493.5,-78"/>
<text text-anchor="middle" x="681418" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="681418" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="681418" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="681418" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L12_EP0TP0PP1DP0_GPU4 -->
<g id="node3302" class="node">
<title>attn_out_L12_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="681674.5,-78 681529.5,-78 681529.5,-26 681674.5,-26 681674.5,-78"/>
<text text-anchor="middle" x="681602" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="681602" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="681602" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="681602" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L12_EP0TP0PP1DP0_GPU4 -->
<g id="node3303" class="node">
<title>attn_ar_L12_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="681817" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="681817" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="681817" y="-49.5" font-family="Arial" font-size="10.00">L12 EP0 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="681817" y="-38.5" font-family="Arial" font-size="10.00">GPU4</text>
</g>
<!-- residual1_L12_EP0TP0PP1DP0_GPU4 -->
<g id="node3304" class="node">
<title>residual1_L12_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="682106,-78 681960,-78 681960,-26 682106,-26 682106,-78"/>
<text text-anchor="middle" x="682033" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="682033" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="682033" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="682033" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L12_EP0TP0PP1DP0_GPU4 -->
<g id="node3305" class="node">
<title>ln2_L12_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="682287.5,-78 682142.5,-78 682142.5,-26 682287.5,-26 682287.5,-78"/>
<text text-anchor="middle" x="682215" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="682215" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="682215" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="682215" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L12_EP0TP0PP1DP0_GPU4 -->
<g id="node3306" class="node">
<title>gate_L12_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightyellow" stroke="black" points="682624.16,-104 682385.29,-104 682323.84,0 682562.71,0 682624.16,-104"/>
<text text-anchor="middle" x="682474" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="682474" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="682474" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="682474" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L12_EP0TP0PP1DP0_GPU4 -->
<g id="node3307" class="node">
<title>dispatch_L12_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="682763" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="682763" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="682763" y="-44" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP0_GPU4</text>
</g>
<!-- expert_0_L12_EP0TP0PP1DP0_GPU4 -->
<g id="node3308" class="node">
<title>expert_0_L12_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="683046.5,-78 682901.5,-78 682901.5,-26 683046.5,-26 683046.5,-78"/>
<text text-anchor="middle" x="682974" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="682974" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="682974" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="682974" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L12_EP0TP0PP1DP0_GPU4 -->
<g id="node3309" class="node">
<title>expert_1_L12_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="683227.5,-78 683082.5,-78 683082.5,-26 683227.5,-26 683227.5,-78"/>
<text text-anchor="middle" x="683155" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="683155" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="683155" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="683155" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L12_EP0TP0PP1DP0_GPU4 -->
<g id="node3310" class="node">
<title>expert_2_L12_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="683408.5,-78 683263.5,-78 683263.5,-26 683408.5,-26 683408.5,-78"/>
<text text-anchor="middle" x="683336" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="683336" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="683336" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="683336" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L12_EP0TP0PP1DP0_GPU4 -->
<g id="node3311" class="node">
<title>expert_3_L12_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="683589.5,-78 683444.5,-78 683444.5,-26 683589.5,-26 683589.5,-78"/>
<text text-anchor="middle" x="683517" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="683517" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="683517" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="683517" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L12_EP0TP0PP1DP0_GPU4 -->
<g id="node3312" class="node">
<title>combine_L12_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="683728" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="683728" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="683728" y="-44" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP0_GPU4</text>
</g>
<!-- ffn_L12_EP0TP0PP1DP0_GPU4 -->
<g id="node3313" class="node">
<title>ffn_L12_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="684037,-78 683867,-78 683867,-26 684037,-26 684037,-78"/>
<text text-anchor="middle" x="683952" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="683952" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="683952" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="683952" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L12_EP0TP0PP1DP0_GPU4 -->
<g id="node3314" class="node">
<title>ffn_ar_L12_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="684180" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="684180" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="684180" y="-49.5" font-family="Arial" font-size="10.00">L12 EP0 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="684180" y="-38.5" font-family="Arial" font-size="10.00">GPU4</text>
</g>
<!-- residual2_L12_EP0TP0PP1DP0_GPU4 -->
<g id="node3315" class="node">
<title>residual2_L12_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="684469,-78 684323,-78 684323,-26 684469,-26 684469,-78"/>
<text text-anchor="middle" x="684396" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="684396" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="684396" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="684396" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L12_EP0TP0PP1DP1_GPU5 -->
<g id="node3316" class="node">
<title>ln1_L12_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="684650.5,-78 684505.5,-78 684505.5,-26 684650.5,-26 684650.5,-78"/>
<text text-anchor="middle" x="684578" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="684578" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="684578" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="684578" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L12_EP0TP0PP1DP1_GPU5 -->
<g id="node3317" class="node">
<title>qkv_L12_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="684831.5,-78 684686.5,-78 684686.5,-26 684831.5,-26 684831.5,-78"/>
<text text-anchor="middle" x="684759" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="684759" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="684759" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="684759" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L12_EP0TP0PP1DP1_GPU5 -->
<g id="node3318" class="node">
<title>attn_L12_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="685018.5,-78 684867.5,-78 684867.5,-26 685018.5,-26 685018.5,-78"/>
<text text-anchor="middle" x="684943" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="684943" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="684943" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="684943" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L12_EP0TP0PP1DP1_GPU5 -->
<g id="node3319" class="node">
<title>attn_out_L12_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="685199.5,-78 685054.5,-78 685054.5,-26 685199.5,-26 685199.5,-78"/>
<text text-anchor="middle" x="685127" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="685127" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="685127" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="685127" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L12_EP0TP0PP1DP1_GPU5 -->
<g id="node3320" class="node">
<title>attn_ar_L12_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="685342" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="685342" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="685342" y="-49.5" font-family="Arial" font-size="10.00">L12 EP0 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="685342" y="-38.5" font-family="Arial" font-size="10.00">GPU5</text>
</g>
<!-- residual1_L12_EP0TP0PP1DP1_GPU5 -->
<g id="node3321" class="node">
<title>residual1_L12_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="685631,-78 685485,-78 685485,-26 685631,-26 685631,-78"/>
<text text-anchor="middle" x="685558" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="685558" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="685558" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="685558" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L12_EP0TP0PP1DP1_GPU5 -->
<g id="node3322" class="node">
<title>ln2_L12_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="685812.5,-78 685667.5,-78 685667.5,-26 685812.5,-26 685812.5,-78"/>
<text text-anchor="middle" x="685740" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="685740" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="685740" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="685740" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L12_EP0TP0PP1DP1_GPU5 -->
<g id="node3323" class="node">
<title>gate_L12_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightyellow" stroke="black" points="686149.16,-104 685910.29,-104 685848.84,0 686087.71,0 686149.16,-104"/>
<text text-anchor="middle" x="685999" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="685999" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="685999" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="685999" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L12_EP0TP0PP1DP1_GPU5 -->
<g id="node3324" class="node">
<title>dispatch_L12_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="686288" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="686288" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="686288" y="-44" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP1_GPU5</text>
</g>
<!-- expert_0_L12_EP0TP0PP1DP1_GPU5 -->
<g id="node3325" class="node">
<title>expert_0_L12_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="686571.5,-78 686426.5,-78 686426.5,-26 686571.5,-26 686571.5,-78"/>
<text text-anchor="middle" x="686499" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="686499" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="686499" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="686499" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L12_EP0TP0PP1DP1_GPU5 -->
<g id="node3326" class="node">
<title>expert_1_L12_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="686752.5,-78 686607.5,-78 686607.5,-26 686752.5,-26 686752.5,-78"/>
<text text-anchor="middle" x="686680" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="686680" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="686680" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="686680" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L12_EP0TP0PP1DP1_GPU5 -->
<g id="node3327" class="node">
<title>expert_2_L12_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="686933.5,-78 686788.5,-78 686788.5,-26 686933.5,-26 686933.5,-78"/>
<text text-anchor="middle" x="686861" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="686861" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="686861" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="686861" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L12_EP0TP0PP1DP1_GPU5 -->
<g id="node3328" class="node">
<title>expert_3_L12_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="687114.5,-78 686969.5,-78 686969.5,-26 687114.5,-26 687114.5,-78"/>
<text text-anchor="middle" x="687042" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="687042" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="687042" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="687042" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L12_EP0TP0PP1DP1_GPU5 -->
<g id="node3329" class="node">
<title>combine_L12_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="687253" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="687253" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="687253" y="-44" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP1_GPU5</text>
</g>
<!-- ffn_L12_EP0TP0PP1DP1_GPU5 -->
<g id="node3330" class="node">
<title>ffn_L12_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="687562,-78 687392,-78 687392,-26 687562,-26 687562,-78"/>
<text text-anchor="middle" x="687477" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="687477" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="687477" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="687477" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L12_EP0TP0PP1DP1_GPU5 -->
<g id="node3331" class="node">
<title>ffn_ar_L12_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="687705" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="687705" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="687705" y="-49.5" font-family="Arial" font-size="10.00">L12 EP0 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="687705" y="-38.5" font-family="Arial" font-size="10.00">GPU5</text>
</g>
<!-- residual2_L12_EP0TP0PP1DP1_GPU5 -->
<g id="node3332" class="node">
<title>residual2_L12_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="687994,-78 687848,-78 687848,-26 687994,-26 687994,-78"/>
<text text-anchor="middle" x="687921" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="687921" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="687921" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="687921" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L12_EP0TP1PP1DP0_GPU12 -->
<g id="node3333" class="node">
<title>ln1_L12_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="688180,-78 688030,-78 688030,-26 688180,-26 688180,-78"/>
<text text-anchor="middle" x="688105" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="688105" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="688105" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="688105" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L12_EP0TP1PP1DP0_GPU12 -->
<g id="node3334" class="node">
<title>qkv_L12_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="688366,-78 688216,-78 688216,-26 688366,-26 688366,-78"/>
<text text-anchor="middle" x="688291" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="688291" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="688291" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="688291" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L12_EP0TP1PP1DP0_GPU12 -->
<g id="node3335" class="node">
<title>attn_L12_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="688553.5,-78 688402.5,-78 688402.5,-26 688553.5,-26 688553.5,-78"/>
<text text-anchor="middle" x="688478" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="688478" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="688478" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="688478" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L12_EP0TP1PP1DP0_GPU12 -->
<g id="node3336" class="node">
<title>attn_out_L12_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="688740,-78 688590,-78 688590,-26 688740,-26 688740,-78"/>
<text text-anchor="middle" x="688665" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="688665" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="688665" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="688665" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L12_EP0TP1PP1DP0_GPU12 -->
<g id="node3337" class="node">
<title>attn_ar_L12_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="688883" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="688883" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="688883" y="-49.5" font-family="Arial" font-size="10.00">L12 EP0 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="688883" y="-38.5" font-family="Arial" font-size="10.00">GPU12</text>
</g>
<!-- residual1_L12_EP0TP1PP1DP0_GPU12 -->
<g id="node3338" class="node">
<title>residual1_L12_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="689176,-78 689026,-78 689026,-26 689176,-26 689176,-78"/>
<text text-anchor="middle" x="689101" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="689101" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="689101" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="689101" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L12_EP0TP1PP1DP0_GPU12 -->
<g id="node3339" class="node">
<title>ln2_L12_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="689362,-78 689212,-78 689212,-26 689362,-26 689362,-78"/>
<text text-anchor="middle" x="689287" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="689287" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="689287" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="689287" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L12_EP0TP1PP1DP0_GPU12 -->
<g id="node3340" class="node">
<title>gate_L12_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightyellow" stroke="black" points="689709.53,-104 689462.12,-104 689398.47,0 689645.88,0 689709.53,-104"/>
<text text-anchor="middle" x="689554" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="689554" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="689554" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="689554" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L12_EP0TP1PP1DP0_GPU12 -->
<g id="node3341" class="node">
<title>dispatch_L12_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="689852" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="689852" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="689852" y="-44" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP0_GPU12</text>
</g>
<!-- expert_0_L12_EP0TP1PP1DP0_GPU12 -->
<g id="node3342" class="node">
<title>expert_0_L12_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="690144,-78 689994,-78 689994,-26 690144,-26 690144,-78"/>
<text text-anchor="middle" x="690069" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="690069" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="690069" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="690069" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L12_EP0TP1PP1DP0_GPU12 -->
<g id="node3343" class="node">
<title>expert_1_L12_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="690330,-78 690180,-78 690180,-26 690330,-26 690330,-78"/>
<text text-anchor="middle" x="690255" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="690255" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="690255" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="690255" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L12_EP0TP1PP1DP0_GPU12 -->
<g id="node3344" class="node">
<title>expert_2_L12_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="690516,-78 690366,-78 690366,-26 690516,-26 690516,-78"/>
<text text-anchor="middle" x="690441" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="690441" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="690441" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="690441" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L12_EP0TP1PP1DP0_GPU12 -->
<g id="node3345" class="node">
<title>expert_3_L12_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="690702,-78 690552,-78 690552,-26 690702,-26 690702,-78"/>
<text text-anchor="middle" x="690627" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="690627" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="690627" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="690627" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L12_EP0TP1PP1DP0_GPU12 -->
<g id="node3346" class="node">
<title>combine_L12_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="690844" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="690844" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="690844" y="-44" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP0_GPU12</text>
</g>
<!-- ffn_L12_EP0TP1PP1DP0_GPU12 -->
<g id="node3347" class="node">
<title>ffn_L12_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="691156,-78 690986,-78 690986,-26 691156,-26 691156,-78"/>
<text text-anchor="middle" x="691071" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="691071" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="691071" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="691071" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L12_EP0TP1PP1DP0_GPU12 -->
<g id="node3348" class="node">
<title>ffn_ar_L12_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="691299" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="691299" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="691299" y="-49.5" font-family="Arial" font-size="10.00">L12 EP0 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="691299" y="-38.5" font-family="Arial" font-size="10.00">GPU12</text>
</g>
<!-- residual2_L12_EP0TP1PP1DP0_GPU12 -->
<g id="node3349" class="node">
<title>residual2_L12_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="691592,-78 691442,-78 691442,-26 691592,-26 691592,-78"/>
<text text-anchor="middle" x="691517" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="691517" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="691517" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="691517" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L12_EP0TP1PP1DP1_GPU13 -->
<g id="node3350" class="node">
<title>ln1_L12_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="691778,-78 691628,-78 691628,-26 691778,-26 691778,-78"/>
<text text-anchor="middle" x="691703" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="691703" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="691703" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="691703" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L12_EP0TP1PP1DP1_GPU13 -->
<g id="node3351" class="node">
<title>qkv_L12_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="691964,-78 691814,-78 691814,-26 691964,-26 691964,-78"/>
<text text-anchor="middle" x="691889" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="691889" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="691889" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="691889" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L12_EP0TP1PP1DP1_GPU13 -->
<g id="node3352" class="node">
<title>attn_L12_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="692151.5,-78 692000.5,-78 692000.5,-26 692151.5,-26 692151.5,-78"/>
<text text-anchor="middle" x="692076" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="692076" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="692076" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="692076" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L12_EP0TP1PP1DP1_GPU13 -->
<g id="node3353" class="node">
<title>attn_out_L12_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="692338,-78 692188,-78 692188,-26 692338,-26 692338,-78"/>
<text text-anchor="middle" x="692263" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="692263" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="692263" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="692263" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L12_EP0TP1PP1DP1_GPU13 -->
<g id="node3354" class="node">
<title>attn_ar_L12_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="692481" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="692481" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="692481" y="-49.5" font-family="Arial" font-size="10.00">L12 EP0 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="692481" y="-38.5" font-family="Arial" font-size="10.00">GPU13</text>
</g>
<!-- residual1_L12_EP0TP1PP1DP1_GPU13 -->
<g id="node3355" class="node">
<title>residual1_L12_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="692774,-78 692624,-78 692624,-26 692774,-26 692774,-78"/>
<text text-anchor="middle" x="692699" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="692699" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="692699" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="692699" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L12_EP0TP1PP1DP1_GPU13 -->
<g id="node3356" class="node">
<title>ln2_L12_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="692960,-78 692810,-78 692810,-26 692960,-26 692960,-78"/>
<text text-anchor="middle" x="692885" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="692885" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="692885" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="692885" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L12_EP0TP1PP1DP1_GPU13 -->
<g id="node3357" class="node">
<title>gate_L12_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightyellow" stroke="black" points="693307.53,-104 693060.12,-104 692996.47,0 693243.88,0 693307.53,-104"/>
<text text-anchor="middle" x="693152" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="693152" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="693152" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="693152" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L12_EP0TP1PP1DP1_GPU13 -->
<g id="node3358" class="node">
<title>dispatch_L12_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="693450" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="693450" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="693450" y="-44" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP1_GPU13</text>
</g>
<!-- expert_0_L12_EP0TP1PP1DP1_GPU13 -->
<g id="node3359" class="node">
<title>expert_0_L12_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="693742,-78 693592,-78 693592,-26 693742,-26 693742,-78"/>
<text text-anchor="middle" x="693667" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="693667" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="693667" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="693667" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L12_EP0TP1PP1DP1_GPU13 -->
<g id="node3360" class="node">
<title>expert_1_L12_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="693928,-78 693778,-78 693778,-26 693928,-26 693928,-78"/>
<text text-anchor="middle" x="693853" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="693853" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="693853" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="693853" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L12_EP0TP1PP1DP1_GPU13 -->
<g id="node3361" class="node">
<title>expert_2_L12_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="694114,-78 693964,-78 693964,-26 694114,-26 694114,-78"/>
<text text-anchor="middle" x="694039" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="694039" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="694039" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="694039" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L12_EP0TP1PP1DP1_GPU13 -->
<g id="node3362" class="node">
<title>expert_3_L12_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="694300,-78 694150,-78 694150,-26 694300,-26 694300,-78"/>
<text text-anchor="middle" x="694225" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="694225" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="694225" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="694225" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L12_EP0TP1PP1DP1_GPU13 -->
<g id="node3363" class="node">
<title>combine_L12_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="694442" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="694442" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="694442" y="-44" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP1_GPU13</text>
</g>
<!-- ffn_L12_EP0TP1PP1DP1_GPU13 -->
<g id="node3364" class="node">
<title>ffn_L12_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="694754,-78 694584,-78 694584,-26 694754,-26 694754,-78"/>
<text text-anchor="middle" x="694669" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="694669" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="694669" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="694669" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L12_EP0TP1PP1DP1_GPU13 -->
<g id="node3365" class="node">
<title>ffn_ar_L12_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="694897" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="694897" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="694897" y="-49.5" font-family="Arial" font-size="10.00">L12 EP0 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="694897" y="-38.5" font-family="Arial" font-size="10.00">GPU13</text>
</g>
<!-- residual2_L12_EP0TP1PP1DP1_GPU13 -->
<g id="node3366" class="node">
<title>residual2_L12_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="695190,-78 695040,-78 695040,-26 695190,-26 695190,-78"/>
<text text-anchor="middle" x="695115" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="695115" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="695115" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="695115" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L12_EP0TP2PP1DP0_GPU20 -->
<g id="node3367" class="node">
<title>ln1_L12_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="695376,-78 695226,-78 695226,-26 695376,-26 695376,-78"/>
<text text-anchor="middle" x="695301" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="695301" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="695301" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="695301" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L12_EP0TP2PP1DP0_GPU20 -->
<g id="node3368" class="node">
<title>qkv_L12_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="695562,-78 695412,-78 695412,-26 695562,-26 695562,-78"/>
<text text-anchor="middle" x="695487" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="695487" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="695487" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="695487" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L12_EP0TP2PP1DP0_GPU20 -->
<g id="node3369" class="node">
<title>attn_L12_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="695749.5,-78 695598.5,-78 695598.5,-26 695749.5,-26 695749.5,-78"/>
<text text-anchor="middle" x="695674" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="695674" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="695674" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="695674" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L12_EP0TP2PP1DP0_GPU20 -->
<g id="node3370" class="node">
<title>attn_out_L12_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="695936,-78 695786,-78 695786,-26 695936,-26 695936,-78"/>
<text text-anchor="middle" x="695861" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="695861" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="695861" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="695861" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L12_EP0TP2PP1DP0_GPU20 -->
<g id="node3371" class="node">
<title>attn_ar_L12_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="696079" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="696079" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="696079" y="-49.5" font-family="Arial" font-size="10.00">L12 EP0 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="696079" y="-38.5" font-family="Arial" font-size="10.00">GPU20</text>
</g>
<!-- residual1_L12_EP0TP2PP1DP0_GPU20 -->
<g id="node3372" class="node">
<title>residual1_L12_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="696372,-78 696222,-78 696222,-26 696372,-26 696372,-78"/>
<text text-anchor="middle" x="696297" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="696297" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="696297" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="696297" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L12_EP0TP2PP1DP0_GPU20 -->
<g id="node3373" class="node">
<title>ln2_L12_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="696558,-78 696408,-78 696408,-26 696558,-26 696558,-78"/>
<text text-anchor="middle" x="696483" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="696483" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="696483" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="696483" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L12_EP0TP2PP1DP0_GPU20 -->
<g id="node3374" class="node">
<title>gate_L12_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightyellow" stroke="black" points="696905.53,-104 696658.12,-104 696594.47,0 696841.88,0 696905.53,-104"/>
<text text-anchor="middle" x="696750" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="696750" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="696750" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="696750" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L12_EP0TP2PP1DP0_GPU20 -->
<g id="node3375" class="node">
<title>dispatch_L12_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="697048" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="697048" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="697048" y="-44" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP0_GPU20</text>
</g>
<!-- expert_0_L12_EP0TP2PP1DP0_GPU20 -->
<g id="node3376" class="node">
<title>expert_0_L12_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="697340,-78 697190,-78 697190,-26 697340,-26 697340,-78"/>
<text text-anchor="middle" x="697265" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="697265" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="697265" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="697265" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L12_EP0TP2PP1DP0_GPU20 -->
<g id="node3377" class="node">
<title>expert_1_L12_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="697526,-78 697376,-78 697376,-26 697526,-26 697526,-78"/>
<text text-anchor="middle" x="697451" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="697451" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="697451" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="697451" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L12_EP0TP2PP1DP0_GPU20 -->
<g id="node3378" class="node">
<title>expert_2_L12_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="697712,-78 697562,-78 697562,-26 697712,-26 697712,-78"/>
<text text-anchor="middle" x="697637" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="697637" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="697637" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="697637" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L12_EP0TP2PP1DP0_GPU20 -->
<g id="node3379" class="node">
<title>expert_3_L12_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="697898,-78 697748,-78 697748,-26 697898,-26 697898,-78"/>
<text text-anchor="middle" x="697823" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="697823" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="697823" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="697823" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L12_EP0TP2PP1DP0_GPU20 -->
<g id="node3380" class="node">
<title>combine_L12_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="698040" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="698040" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="698040" y="-44" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP0_GPU20</text>
</g>
<!-- ffn_L12_EP0TP2PP1DP0_GPU20 -->
<g id="node3381" class="node">
<title>ffn_L12_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="698352,-78 698182,-78 698182,-26 698352,-26 698352,-78"/>
<text text-anchor="middle" x="698267" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="698267" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="698267" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="698267" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L12_EP0TP2PP1DP0_GPU20 -->
<g id="node3382" class="node">
<title>ffn_ar_L12_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="698495" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="698495" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="698495" y="-49.5" font-family="Arial" font-size="10.00">L12 EP0 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="698495" y="-38.5" font-family="Arial" font-size="10.00">GPU20</text>
</g>
<!-- residual2_L12_EP0TP2PP1DP0_GPU20 -->
<g id="node3383" class="node">
<title>residual2_L12_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="698788,-78 698638,-78 698638,-26 698788,-26 698788,-78"/>
<text text-anchor="middle" x="698713" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="698713" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="698713" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="698713" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L12_EP0TP2PP1DP1_GPU21 -->
<g id="node3384" class="node">
<title>ln1_L12_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="698974,-78 698824,-78 698824,-26 698974,-26 698974,-78"/>
<text text-anchor="middle" x="698899" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="698899" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="698899" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="698899" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L12_EP0TP2PP1DP1_GPU21 -->
<g id="node3385" class="node">
<title>qkv_L12_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="699160,-78 699010,-78 699010,-26 699160,-26 699160,-78"/>
<text text-anchor="middle" x="699085" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="699085" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="699085" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="699085" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L12_EP0TP2PP1DP1_GPU21 -->
<g id="node3386" class="node">
<title>attn_L12_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="699347.5,-78 699196.5,-78 699196.5,-26 699347.5,-26 699347.5,-78"/>
<text text-anchor="middle" x="699272" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="699272" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="699272" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="699272" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L12_EP0TP2PP1DP1_GPU21 -->
<g id="node3387" class="node">
<title>attn_out_L12_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="699534,-78 699384,-78 699384,-26 699534,-26 699534,-78"/>
<text text-anchor="middle" x="699459" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="699459" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="699459" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="699459" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L12_EP0TP2PP1DP1_GPU21 -->
<g id="node3388" class="node">
<title>attn_ar_L12_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="699677" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="699677" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="699677" y="-49.5" font-family="Arial" font-size="10.00">L12 EP0 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="699677" y="-38.5" font-family="Arial" font-size="10.00">GPU21</text>
</g>
<!-- residual1_L12_EP0TP2PP1DP1_GPU21 -->
<g id="node3389" class="node">
<title>residual1_L12_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="699970,-78 699820,-78 699820,-26 699970,-26 699970,-78"/>
<text text-anchor="middle" x="699895" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="699895" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="699895" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="699895" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L12_EP0TP2PP1DP1_GPU21 -->
<g id="node3390" class="node">
<title>ln2_L12_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="700156,-78 700006,-78 700006,-26 700156,-26 700156,-78"/>
<text text-anchor="middle" x="700081" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="700081" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="700081" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="700081" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L12_EP0TP2PP1DP1_GPU21 -->
<g id="node3391" class="node">
<title>gate_L12_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightyellow" stroke="black" points="700503.53,-104 700256.12,-104 700192.47,0 700439.88,0 700503.53,-104"/>
<text text-anchor="middle" x="700348" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="700348" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="700348" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="700348" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L12_EP0TP2PP1DP1_GPU21 -->
<g id="node3392" class="node">
<title>dispatch_L12_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="700646" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="700646" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="700646" y="-44" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP1_GPU21</text>
</g>
<!-- expert_0_L12_EP0TP2PP1DP1_GPU21 -->
<g id="node3393" class="node">
<title>expert_0_L12_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="700938,-78 700788,-78 700788,-26 700938,-26 700938,-78"/>
<text text-anchor="middle" x="700863" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="700863" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="700863" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="700863" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L12_EP0TP2PP1DP1_GPU21 -->
<g id="node3394" class="node">
<title>expert_1_L12_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="701124,-78 700974,-78 700974,-26 701124,-26 701124,-78"/>
<text text-anchor="middle" x="701049" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="701049" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="701049" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="701049" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L12_EP0TP2PP1DP1_GPU21 -->
<g id="node3395" class="node">
<title>expert_2_L12_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="701310,-78 701160,-78 701160,-26 701310,-26 701310,-78"/>
<text text-anchor="middle" x="701235" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="701235" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="701235" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="701235" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L12_EP0TP2PP1DP1_GPU21 -->
<g id="node3396" class="node">
<title>expert_3_L12_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="701496,-78 701346,-78 701346,-26 701496,-26 701496,-78"/>
<text text-anchor="middle" x="701421" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="701421" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="701421" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="701421" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L12_EP0TP2PP1DP1_GPU21 -->
<g id="node3397" class="node">
<title>combine_L12_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="701638" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="701638" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="701638" y="-44" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP1_GPU21</text>
</g>
<!-- ffn_L12_EP0TP2PP1DP1_GPU21 -->
<g id="node3398" class="node">
<title>ffn_L12_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="701950,-78 701780,-78 701780,-26 701950,-26 701950,-78"/>
<text text-anchor="middle" x="701865" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="701865" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="701865" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="701865" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L12_EP0TP2PP1DP1_GPU21 -->
<g id="node3399" class="node">
<title>ffn_ar_L12_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="702093" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="702093" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="702093" y="-49.5" font-family="Arial" font-size="10.00">L12 EP0 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="702093" y="-38.5" font-family="Arial" font-size="10.00">GPU21</text>
</g>
<!-- residual2_L12_EP0TP2PP1DP1_GPU21 -->
<g id="node3400" class="node">
<title>residual2_L12_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="702386,-78 702236,-78 702236,-26 702386,-26 702386,-78"/>
<text text-anchor="middle" x="702311" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="702311" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="702311" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="702311" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L12_EP0TP3PP1DP0_GPU28 -->
<g id="node3401" class="node">
<title>ln1_L12_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="702572,-78 702422,-78 702422,-26 702572,-26 702572,-78"/>
<text text-anchor="middle" x="702497" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="702497" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="702497" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="702497" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L12_EP0TP3PP1DP0_GPU28 -->
<g id="node3402" class="node">
<title>qkv_L12_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="702758,-78 702608,-78 702608,-26 702758,-26 702758,-78"/>
<text text-anchor="middle" x="702683" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="702683" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="702683" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="702683" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L12_EP0TP3PP1DP0_GPU28 -->
<g id="node3403" class="node">
<title>attn_L12_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="702945.5,-78 702794.5,-78 702794.5,-26 702945.5,-26 702945.5,-78"/>
<text text-anchor="middle" x="702870" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="702870" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="702870" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="702870" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L12_EP0TP3PP1DP0_GPU28 -->
<g id="node3404" class="node">
<title>attn_out_L12_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="703132,-78 702982,-78 702982,-26 703132,-26 703132,-78"/>
<text text-anchor="middle" x="703057" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="703057" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="703057" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="703057" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L12_EP0TP3PP1DP0_GPU28 -->
<g id="node3405" class="node">
<title>attn_ar_L12_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="703275" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="703275" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="703275" y="-49.5" font-family="Arial" font-size="10.00">L12 EP0 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="703275" y="-38.5" font-family="Arial" font-size="10.00">GPU28</text>
</g>
<!-- residual1_L12_EP0TP3PP1DP0_GPU28 -->
<g id="node3406" class="node">
<title>residual1_L12_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="703568,-78 703418,-78 703418,-26 703568,-26 703568,-78"/>
<text text-anchor="middle" x="703493" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="703493" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="703493" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="703493" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L12_EP0TP3PP1DP0_GPU28 -->
<g id="node3407" class="node">
<title>ln2_L12_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="703754,-78 703604,-78 703604,-26 703754,-26 703754,-78"/>
<text text-anchor="middle" x="703679" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="703679" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="703679" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="703679" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L12_EP0TP3PP1DP0_GPU28 -->
<g id="node3408" class="node">
<title>gate_L12_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightyellow" stroke="black" points="704101.53,-104 703854.12,-104 703790.47,0 704037.88,0 704101.53,-104"/>
<text text-anchor="middle" x="703946" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="703946" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="703946" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="703946" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L12_EP0TP3PP1DP0_GPU28 -->
<g id="node3409" class="node">
<title>dispatch_L12_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="704244" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="704244" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="704244" y="-44" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP0_GPU28</text>
</g>
<!-- expert_0_L12_EP0TP3PP1DP0_GPU28 -->
<g id="node3410" class="node">
<title>expert_0_L12_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="704536,-78 704386,-78 704386,-26 704536,-26 704536,-78"/>
<text text-anchor="middle" x="704461" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="704461" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="704461" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="704461" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L12_EP0TP3PP1DP0_GPU28 -->
<g id="node3411" class="node">
<title>expert_1_L12_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="704722,-78 704572,-78 704572,-26 704722,-26 704722,-78"/>
<text text-anchor="middle" x="704647" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="704647" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="704647" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="704647" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L12_EP0TP3PP1DP0_GPU28 -->
<g id="node3412" class="node">
<title>expert_2_L12_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="704908,-78 704758,-78 704758,-26 704908,-26 704908,-78"/>
<text text-anchor="middle" x="704833" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="704833" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="704833" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="704833" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L12_EP0TP3PP1DP0_GPU28 -->
<g id="node3413" class="node">
<title>expert_3_L12_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="705094,-78 704944,-78 704944,-26 705094,-26 705094,-78"/>
<text text-anchor="middle" x="705019" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="705019" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="705019" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="705019" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L12_EP0TP3PP1DP0_GPU28 -->
<g id="node3414" class="node">
<title>combine_L12_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="705236" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="705236" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="705236" y="-44" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP0_GPU28</text>
</g>
<!-- ffn_L12_EP0TP3PP1DP0_GPU28 -->
<g id="node3415" class="node">
<title>ffn_L12_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="705548,-78 705378,-78 705378,-26 705548,-26 705548,-78"/>
<text text-anchor="middle" x="705463" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="705463" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="705463" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="705463" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L12_EP0TP3PP1DP0_GPU28 -->
<g id="node3416" class="node">
<title>ffn_ar_L12_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="705691" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="705691" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="705691" y="-49.5" font-family="Arial" font-size="10.00">L12 EP0 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="705691" y="-38.5" font-family="Arial" font-size="10.00">GPU28</text>
</g>
<!-- residual2_L12_EP0TP3PP1DP0_GPU28 -->
<g id="node3417" class="node">
<title>residual2_L12_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="705984,-78 705834,-78 705834,-26 705984,-26 705984,-78"/>
<text text-anchor="middle" x="705909" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="705909" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="705909" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="705909" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L12_EP0TP3PP1DP1_GPU29 -->
<g id="node3418" class="node">
<title>ln1_L12_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="706170,-78 706020,-78 706020,-26 706170,-26 706170,-78"/>
<text text-anchor="middle" x="706095" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="706095" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="706095" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="706095" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L12_EP0TP3PP1DP1_GPU29 -->
<g id="node3419" class="node">
<title>qkv_L12_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="706356,-78 706206,-78 706206,-26 706356,-26 706356,-78"/>
<text text-anchor="middle" x="706281" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="706281" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="706281" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="706281" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L12_EP0TP3PP1DP1_GPU29 -->
<g id="node3420" class="node">
<title>attn_L12_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="706543.5,-78 706392.5,-78 706392.5,-26 706543.5,-26 706543.5,-78"/>
<text text-anchor="middle" x="706468" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="706468" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="706468" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="706468" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L12_EP0TP3PP1DP1_GPU29 -->
<g id="node3421" class="node">
<title>attn_out_L12_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="706730,-78 706580,-78 706580,-26 706730,-26 706730,-78"/>
<text text-anchor="middle" x="706655" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="706655" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="706655" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="706655" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L12_EP0TP3PP1DP1_GPU29 -->
<g id="node3422" class="node">
<title>attn_ar_L12_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="706873" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="706873" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="706873" y="-49.5" font-family="Arial" font-size="10.00">L12 EP0 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="706873" y="-38.5" font-family="Arial" font-size="10.00">GPU29</text>
</g>
<!-- residual1_L12_EP0TP3PP1DP1_GPU29 -->
<g id="node3423" class="node">
<title>residual1_L12_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="707166,-78 707016,-78 707016,-26 707166,-26 707166,-78"/>
<text text-anchor="middle" x="707091" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="707091" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="707091" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="707091" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L12_EP0TP3PP1DP1_GPU29 -->
<g id="node3424" class="node">
<title>ln2_L12_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="707352,-78 707202,-78 707202,-26 707352,-26 707352,-78"/>
<text text-anchor="middle" x="707277" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="707277" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="707277" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="707277" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L12_EP0TP3PP1DP1_GPU29 -->
<g id="node3425" class="node">
<title>gate_L12_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightyellow" stroke="black" points="707699.53,-104 707452.12,-104 707388.47,0 707635.88,0 707699.53,-104"/>
<text text-anchor="middle" x="707544" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="707544" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="707544" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="707544" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L12_EP0TP3PP1DP1_GPU29 -->
<g id="node3426" class="node">
<title>dispatch_L12_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="707842" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="707842" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="707842" y="-44" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP1_GPU29</text>
</g>
<!-- expert_0_L12_EP0TP3PP1DP1_GPU29 -->
<g id="node3427" class="node">
<title>expert_0_L12_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="708134,-78 707984,-78 707984,-26 708134,-26 708134,-78"/>
<text text-anchor="middle" x="708059" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="708059" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="708059" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="708059" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L12_EP0TP3PP1DP1_GPU29 -->
<g id="node3428" class="node">
<title>expert_1_L12_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="708320,-78 708170,-78 708170,-26 708320,-26 708320,-78"/>
<text text-anchor="middle" x="708245" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="708245" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="708245" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="708245" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L12_EP0TP3PP1DP1_GPU29 -->
<g id="node3429" class="node">
<title>expert_2_L12_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="708506,-78 708356,-78 708356,-26 708506,-26 708506,-78"/>
<text text-anchor="middle" x="708431" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="708431" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="708431" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="708431" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L12_EP0TP3PP1DP1_GPU29 -->
<g id="node3430" class="node">
<title>expert_3_L12_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="708692,-78 708542,-78 708542,-26 708692,-26 708692,-78"/>
<text text-anchor="middle" x="708617" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="708617" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="708617" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="708617" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L12_EP0TP3PP1DP1_GPU29 -->
<g id="node3431" class="node">
<title>combine_L12_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="708834" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="708834" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="708834" y="-44" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP1_GPU29</text>
</g>
<!-- ffn_L12_EP0TP3PP1DP1_GPU29 -->
<g id="node3432" class="node">
<title>ffn_L12_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="709146,-78 708976,-78 708976,-26 709146,-26 709146,-78"/>
<text text-anchor="middle" x="709061" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="709061" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="709061" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="709061" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L12_EP0TP3PP1DP1_GPU29 -->
<g id="node3433" class="node">
<title>ffn_ar_L12_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="709289" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="709289" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="709289" y="-49.5" font-family="Arial" font-size="10.00">L12 EP0 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="709289" y="-38.5" font-family="Arial" font-size="10.00">GPU29</text>
</g>
<!-- residual2_L12_EP0TP3PP1DP1_GPU29 -->
<g id="node3434" class="node">
<title>residual2_L12_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="709582,-78 709432,-78 709432,-26 709582,-26 709582,-78"/>
<text text-anchor="middle" x="709507" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="709507" y="-55" font-family="Arial" font-size="10.00">L12_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="709507" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="709507" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L12_EP1TP0PP1DP0_GPU36 -->
<g id="node3435" class="node">
<title>ln1_L12_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="709768,-78 709618,-78 709618,-26 709768,-26 709768,-78"/>
<text text-anchor="middle" x="709693" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="709693" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="709693" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="709693" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L12_EP1TP0PP1DP0_GPU36 -->
<g id="node3436" class="node">
<title>qkv_L12_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="709954,-78 709804,-78 709804,-26 709954,-26 709954,-78"/>
<text text-anchor="middle" x="709879" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="709879" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="709879" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="709879" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L12_EP1TP0PP1DP0_GPU36 -->
<g id="node3437" class="node">
<title>attn_L12_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="710141.5,-78 709990.5,-78 709990.5,-26 710141.5,-26 710141.5,-78"/>
<text text-anchor="middle" x="710066" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="710066" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="710066" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="710066" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L12_EP1TP0PP1DP0_GPU36 -->
<g id="node3438" class="node">
<title>attn_out_L12_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="710328,-78 710178,-78 710178,-26 710328,-26 710328,-78"/>
<text text-anchor="middle" x="710253" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="710253" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="710253" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="710253" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L12_EP1TP0PP1DP0_GPU36 -->
<g id="node3439" class="node">
<title>attn_ar_L12_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="710471" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="710471" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="710471" y="-49.5" font-family="Arial" font-size="10.00">L12 EP1 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="710471" y="-38.5" font-family="Arial" font-size="10.00">GPU36</text>
</g>
<!-- residual1_L12_EP1TP0PP1DP0_GPU36 -->
<g id="node3440" class="node">
<title>residual1_L12_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="710764,-78 710614,-78 710614,-26 710764,-26 710764,-78"/>
<text text-anchor="middle" x="710689" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="710689" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="710689" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="710689" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L12_EP1TP0PP1DP0_GPU36 -->
<g id="node3441" class="node">
<title>ln2_L12_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="710950,-78 710800,-78 710800,-26 710950,-26 710950,-78"/>
<text text-anchor="middle" x="710875" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="710875" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="710875" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="710875" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L12_EP1TP0PP1DP0_GPU36 -->
<g id="node3442" class="node">
<title>gate_L12_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightyellow" stroke="black" points="711297.53,-104 711050.12,-104 710986.47,0 711233.88,0 711297.53,-104"/>
<text text-anchor="middle" x="711142" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="711142" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="711142" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="711142" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L12_EP1TP0PP1DP0_GPU36 -->
<g id="node3443" class="node">
<title>dispatch_L12_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="711440" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="711440" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="711440" y="-44" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP0_GPU36</text>
</g>
<!-- expert_0_L12_EP1TP0PP1DP0_GPU36 -->
<g id="node3444" class="node">
<title>expert_0_L12_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="711732,-78 711582,-78 711582,-26 711732,-26 711732,-78"/>
<text text-anchor="middle" x="711657" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="711657" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="711657" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="711657" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L12_EP1TP0PP1DP0_GPU36 -->
<g id="node3445" class="node">
<title>expert_1_L12_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="711918,-78 711768,-78 711768,-26 711918,-26 711918,-78"/>
<text text-anchor="middle" x="711843" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="711843" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="711843" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="711843" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L12_EP1TP0PP1DP0_GPU36 -->
<g id="node3446" class="node">
<title>expert_2_L12_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="712104,-78 711954,-78 711954,-26 712104,-26 712104,-78"/>
<text text-anchor="middle" x="712029" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="712029" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="712029" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="712029" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L12_EP1TP0PP1DP0_GPU36 -->
<g id="node3447" class="node">
<title>expert_3_L12_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="712290,-78 712140,-78 712140,-26 712290,-26 712290,-78"/>
<text text-anchor="middle" x="712215" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="712215" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="712215" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="712215" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L12_EP1TP0PP1DP0_GPU36 -->
<g id="node3448" class="node">
<title>combine_L12_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="712432" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="712432" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="712432" y="-44" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP0_GPU36</text>
</g>
<!-- ffn_L12_EP1TP0PP1DP0_GPU36 -->
<g id="node3449" class="node">
<title>ffn_L12_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="712744,-78 712574,-78 712574,-26 712744,-26 712744,-78"/>
<text text-anchor="middle" x="712659" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="712659" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="712659" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="712659" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L12_EP1TP0PP1DP0_GPU36 -->
<g id="node3450" class="node">
<title>ffn_ar_L12_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="712887" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="712887" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="712887" y="-49.5" font-family="Arial" font-size="10.00">L12 EP1 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="712887" y="-38.5" font-family="Arial" font-size="10.00">GPU36</text>
</g>
<!-- residual2_L12_EP1TP0PP1DP0_GPU36 -->
<g id="node3451" class="node">
<title>residual2_L12_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="713180,-78 713030,-78 713030,-26 713180,-26 713180,-78"/>
<text text-anchor="middle" x="713105" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="713105" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="713105" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="713105" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L12_EP1TP0PP1DP1_GPU37 -->
<g id="node3452" class="node">
<title>ln1_L12_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="713366,-78 713216,-78 713216,-26 713366,-26 713366,-78"/>
<text text-anchor="middle" x="713291" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="713291" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="713291" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="713291" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L12_EP1TP0PP1DP1_GPU37 -->
<g id="node3453" class="node">
<title>qkv_L12_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="713552,-78 713402,-78 713402,-26 713552,-26 713552,-78"/>
<text text-anchor="middle" x="713477" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="713477" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="713477" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="713477" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L12_EP1TP0PP1DP1_GPU37 -->
<g id="node3454" class="node">
<title>attn_L12_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="713739.5,-78 713588.5,-78 713588.5,-26 713739.5,-26 713739.5,-78"/>
<text text-anchor="middle" x="713664" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="713664" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="713664" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="713664" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L12_EP1TP0PP1DP1_GPU37 -->
<g id="node3455" class="node">
<title>attn_out_L12_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="713926,-78 713776,-78 713776,-26 713926,-26 713926,-78"/>
<text text-anchor="middle" x="713851" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="713851" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="713851" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="713851" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L12_EP1TP0PP1DP1_GPU37 -->
<g id="node3456" class="node">
<title>attn_ar_L12_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="714069" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="714069" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="714069" y="-49.5" font-family="Arial" font-size="10.00">L12 EP1 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="714069" y="-38.5" font-family="Arial" font-size="10.00">GPU37</text>
</g>
<!-- residual1_L12_EP1TP0PP1DP1_GPU37 -->
<g id="node3457" class="node">
<title>residual1_L12_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="714362,-78 714212,-78 714212,-26 714362,-26 714362,-78"/>
<text text-anchor="middle" x="714287" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="714287" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="714287" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="714287" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L12_EP1TP0PP1DP1_GPU37 -->
<g id="node3458" class="node">
<title>ln2_L12_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="714548,-78 714398,-78 714398,-26 714548,-26 714548,-78"/>
<text text-anchor="middle" x="714473" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="714473" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="714473" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="714473" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L12_EP1TP0PP1DP1_GPU37 -->
<g id="node3459" class="node">
<title>gate_L12_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightyellow" stroke="black" points="714895.53,-104 714648.12,-104 714584.47,0 714831.88,0 714895.53,-104"/>
<text text-anchor="middle" x="714740" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="714740" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="714740" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="714740" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L12_EP1TP0PP1DP1_GPU37 -->
<g id="node3460" class="node">
<title>dispatch_L12_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="715038" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="715038" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="715038" y="-44" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP1_GPU37</text>
</g>
<!-- expert_0_L12_EP1TP0PP1DP1_GPU37 -->
<g id="node3461" class="node">
<title>expert_0_L12_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="715330,-78 715180,-78 715180,-26 715330,-26 715330,-78"/>
<text text-anchor="middle" x="715255" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="715255" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="715255" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="715255" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L12_EP1TP0PP1DP1_GPU37 -->
<g id="node3462" class="node">
<title>expert_1_L12_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="715516,-78 715366,-78 715366,-26 715516,-26 715516,-78"/>
<text text-anchor="middle" x="715441" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="715441" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="715441" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="715441" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L12_EP1TP0PP1DP1_GPU37 -->
<g id="node3463" class="node">
<title>expert_2_L12_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="715702,-78 715552,-78 715552,-26 715702,-26 715702,-78"/>
<text text-anchor="middle" x="715627" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="715627" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="715627" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="715627" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L12_EP1TP0PP1DP1_GPU37 -->
<g id="node3464" class="node">
<title>expert_3_L12_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="715888,-78 715738,-78 715738,-26 715888,-26 715888,-78"/>
<text text-anchor="middle" x="715813" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="715813" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="715813" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="715813" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L12_EP1TP0PP1DP1_GPU37 -->
<g id="node3465" class="node">
<title>combine_L12_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="716030" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="716030" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="716030" y="-44" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP1_GPU37</text>
</g>
<!-- ffn_L12_EP1TP0PP1DP1_GPU37 -->
<g id="node3466" class="node">
<title>ffn_L12_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="716342,-78 716172,-78 716172,-26 716342,-26 716342,-78"/>
<text text-anchor="middle" x="716257" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="716257" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="716257" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="716257" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L12_EP1TP0PP1DP1_GPU37 -->
<g id="node3467" class="node">
<title>ffn_ar_L12_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="716485" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="716485" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="716485" y="-49.5" font-family="Arial" font-size="10.00">L12 EP1 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="716485" y="-38.5" font-family="Arial" font-size="10.00">GPU37</text>
</g>
<!-- residual2_L12_EP1TP0PP1DP1_GPU37 -->
<g id="node3468" class="node">
<title>residual2_L12_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="716778,-78 716628,-78 716628,-26 716778,-26 716778,-78"/>
<text text-anchor="middle" x="716703" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="716703" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="716703" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="716703" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L12_EP1TP1PP1DP0_GPU44 -->
<g id="node3469" class="node">
<title>ln1_L12_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="716964,-78 716814,-78 716814,-26 716964,-26 716964,-78"/>
<text text-anchor="middle" x="716889" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="716889" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="716889" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="716889" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L12_EP1TP1PP1DP0_GPU44 -->
<g id="node3470" class="node">
<title>qkv_L12_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="717150,-78 717000,-78 717000,-26 717150,-26 717150,-78"/>
<text text-anchor="middle" x="717075" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="717075" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="717075" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="717075" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L12_EP1TP1PP1DP0_GPU44 -->
<g id="node3471" class="node">
<title>attn_L12_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="717337.5,-78 717186.5,-78 717186.5,-26 717337.5,-26 717337.5,-78"/>
<text text-anchor="middle" x="717262" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="717262" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="717262" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="717262" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L12_EP1TP1PP1DP0_GPU44 -->
<g id="node3472" class="node">
<title>attn_out_L12_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="717524,-78 717374,-78 717374,-26 717524,-26 717524,-78"/>
<text text-anchor="middle" x="717449" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="717449" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="717449" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="717449" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L12_EP1TP1PP1DP0_GPU44 -->
<g id="node3473" class="node">
<title>attn_ar_L12_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="717667" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="717667" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="717667" y="-49.5" font-family="Arial" font-size="10.00">L12 EP1 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="717667" y="-38.5" font-family="Arial" font-size="10.00">GPU44</text>
</g>
<!-- residual1_L12_EP1TP1PP1DP0_GPU44 -->
<g id="node3474" class="node">
<title>residual1_L12_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="717960,-78 717810,-78 717810,-26 717960,-26 717960,-78"/>
<text text-anchor="middle" x="717885" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="717885" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="717885" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="717885" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L12_EP1TP1PP1DP0_GPU44 -->
<g id="node3475" class="node">
<title>ln2_L12_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="718146,-78 717996,-78 717996,-26 718146,-26 718146,-78"/>
<text text-anchor="middle" x="718071" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="718071" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="718071" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="718071" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L12_EP1TP1PP1DP0_GPU44 -->
<g id="node3476" class="node">
<title>gate_L12_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightyellow" stroke="black" points="718493.53,-104 718246.12,-104 718182.47,0 718429.88,0 718493.53,-104"/>
<text text-anchor="middle" x="718338" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="718338" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="718338" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="718338" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L12_EP1TP1PP1DP0_GPU44 -->
<g id="node3477" class="node">
<title>dispatch_L12_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="718636" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="718636" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="718636" y="-44" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP0_GPU44</text>
</g>
<!-- expert_0_L12_EP1TP1PP1DP0_GPU44 -->
<g id="node3478" class="node">
<title>expert_0_L12_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="718928,-78 718778,-78 718778,-26 718928,-26 718928,-78"/>
<text text-anchor="middle" x="718853" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="718853" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="718853" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="718853" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L12_EP1TP1PP1DP0_GPU44 -->
<g id="node3479" class="node">
<title>expert_1_L12_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="719114,-78 718964,-78 718964,-26 719114,-26 719114,-78"/>
<text text-anchor="middle" x="719039" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="719039" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="719039" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="719039" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L12_EP1TP1PP1DP0_GPU44 -->
<g id="node3480" class="node">
<title>expert_2_L12_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="719300,-78 719150,-78 719150,-26 719300,-26 719300,-78"/>
<text text-anchor="middle" x="719225" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="719225" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="719225" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="719225" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L12_EP1TP1PP1DP0_GPU44 -->
<g id="node3481" class="node">
<title>expert_3_L12_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="719486,-78 719336,-78 719336,-26 719486,-26 719486,-78"/>
<text text-anchor="middle" x="719411" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="719411" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="719411" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="719411" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L12_EP1TP1PP1DP0_GPU44 -->
<g id="node3482" class="node">
<title>combine_L12_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="719628" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="719628" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="719628" y="-44" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP0_GPU44</text>
</g>
<!-- ffn_L12_EP1TP1PP1DP0_GPU44 -->
<g id="node3483" class="node">
<title>ffn_L12_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="719940,-78 719770,-78 719770,-26 719940,-26 719940,-78"/>
<text text-anchor="middle" x="719855" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="719855" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="719855" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="719855" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L12_EP1TP1PP1DP0_GPU44 -->
<g id="node3484" class="node">
<title>ffn_ar_L12_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="720083" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="720083" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="720083" y="-49.5" font-family="Arial" font-size="10.00">L12 EP1 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="720083" y="-38.5" font-family="Arial" font-size="10.00">GPU44</text>
</g>
<!-- residual2_L12_EP1TP1PP1DP0_GPU44 -->
<g id="node3485" class="node">
<title>residual2_L12_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="720376,-78 720226,-78 720226,-26 720376,-26 720376,-78"/>
<text text-anchor="middle" x="720301" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="720301" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="720301" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="720301" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L12_EP1TP1PP1DP1_GPU45 -->
<g id="node3486" class="node">
<title>ln1_L12_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="720562,-78 720412,-78 720412,-26 720562,-26 720562,-78"/>
<text text-anchor="middle" x="720487" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="720487" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="720487" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="720487" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L12_EP1TP1PP1DP1_GPU45 -->
<g id="node3487" class="node">
<title>qkv_L12_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="720748,-78 720598,-78 720598,-26 720748,-26 720748,-78"/>
<text text-anchor="middle" x="720673" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="720673" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="720673" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="720673" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L12_EP1TP1PP1DP1_GPU45 -->
<g id="node3488" class="node">
<title>attn_L12_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="720935.5,-78 720784.5,-78 720784.5,-26 720935.5,-26 720935.5,-78"/>
<text text-anchor="middle" x="720860" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="720860" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="720860" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="720860" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L12_EP1TP1PP1DP1_GPU45 -->
<g id="node3489" class="node">
<title>attn_out_L12_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="721122,-78 720972,-78 720972,-26 721122,-26 721122,-78"/>
<text text-anchor="middle" x="721047" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="721047" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="721047" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="721047" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L12_EP1TP1PP1DP1_GPU45 -->
<g id="node3490" class="node">
<title>attn_ar_L12_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="721265" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="721265" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="721265" y="-49.5" font-family="Arial" font-size="10.00">L12 EP1 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="721265" y="-38.5" font-family="Arial" font-size="10.00">GPU45</text>
</g>
<!-- residual1_L12_EP1TP1PP1DP1_GPU45 -->
<g id="node3491" class="node">
<title>residual1_L12_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="721558,-78 721408,-78 721408,-26 721558,-26 721558,-78"/>
<text text-anchor="middle" x="721483" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="721483" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="721483" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="721483" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L12_EP1TP1PP1DP1_GPU45 -->
<g id="node3492" class="node">
<title>ln2_L12_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="721744,-78 721594,-78 721594,-26 721744,-26 721744,-78"/>
<text text-anchor="middle" x="721669" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="721669" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="721669" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="721669" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L12_EP1TP1PP1DP1_GPU45 -->
<g id="node3493" class="node">
<title>gate_L12_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightyellow" stroke="black" points="722091.53,-104 721844.12,-104 721780.47,0 722027.88,0 722091.53,-104"/>
<text text-anchor="middle" x="721936" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="721936" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="721936" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="721936" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L12_EP1TP1PP1DP1_GPU45 -->
<g id="node3494" class="node">
<title>dispatch_L12_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="722234" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="722234" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="722234" y="-44" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP1_GPU45</text>
</g>
<!-- expert_0_L12_EP1TP1PP1DP1_GPU45 -->
<g id="node3495" class="node">
<title>expert_0_L12_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="722526,-78 722376,-78 722376,-26 722526,-26 722526,-78"/>
<text text-anchor="middle" x="722451" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="722451" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="722451" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="722451" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L12_EP1TP1PP1DP1_GPU45 -->
<g id="node3496" class="node">
<title>expert_1_L12_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="722712,-78 722562,-78 722562,-26 722712,-26 722712,-78"/>
<text text-anchor="middle" x="722637" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="722637" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="722637" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="722637" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L12_EP1TP1PP1DP1_GPU45 -->
<g id="node3497" class="node">
<title>expert_2_L12_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="722898,-78 722748,-78 722748,-26 722898,-26 722898,-78"/>
<text text-anchor="middle" x="722823" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="722823" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="722823" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="722823" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L12_EP1TP1PP1DP1_GPU45 -->
<g id="node3498" class="node">
<title>expert_3_L12_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="723084,-78 722934,-78 722934,-26 723084,-26 723084,-78"/>
<text text-anchor="middle" x="723009" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="723009" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="723009" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="723009" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L12_EP1TP1PP1DP1_GPU45 -->
<g id="node3499" class="node">
<title>combine_L12_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="723226" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="723226" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="723226" y="-44" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP1_GPU45</text>
</g>
<!-- ffn_L12_EP1TP1PP1DP1_GPU45 -->
<g id="node3500" class="node">
<title>ffn_L12_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="723538,-78 723368,-78 723368,-26 723538,-26 723538,-78"/>
<text text-anchor="middle" x="723453" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="723453" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="723453" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="723453" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L12_EP1TP1PP1DP1_GPU45 -->
<g id="node3501" class="node">
<title>ffn_ar_L12_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="723681" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="723681" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="723681" y="-49.5" font-family="Arial" font-size="10.00">L12 EP1 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="723681" y="-38.5" font-family="Arial" font-size="10.00">GPU45</text>
</g>
<!-- residual2_L12_EP1TP1PP1DP1_GPU45 -->
<g id="node3502" class="node">
<title>residual2_L12_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="723974,-78 723824,-78 723824,-26 723974,-26 723974,-78"/>
<text text-anchor="middle" x="723899" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="723899" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="723899" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="723899" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L12_EP1TP2PP1DP0_GPU52 -->
<g id="node3503" class="node">
<title>ln1_L12_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="724160,-78 724010,-78 724010,-26 724160,-26 724160,-78"/>
<text text-anchor="middle" x="724085" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="724085" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="724085" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="724085" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L12_EP1TP2PP1DP0_GPU52 -->
<g id="node3504" class="node">
<title>qkv_L12_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="724346,-78 724196,-78 724196,-26 724346,-26 724346,-78"/>
<text text-anchor="middle" x="724271" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="724271" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="724271" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="724271" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L12_EP1TP2PP1DP0_GPU52 -->
<g id="node3505" class="node">
<title>attn_L12_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="724533.5,-78 724382.5,-78 724382.5,-26 724533.5,-26 724533.5,-78"/>
<text text-anchor="middle" x="724458" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="724458" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="724458" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="724458" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L12_EP1TP2PP1DP0_GPU52 -->
<g id="node3506" class="node">
<title>attn_out_L12_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="724720,-78 724570,-78 724570,-26 724720,-26 724720,-78"/>
<text text-anchor="middle" x="724645" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="724645" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="724645" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="724645" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L12_EP1TP2PP1DP0_GPU52 -->
<g id="node3507" class="node">
<title>attn_ar_L12_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="724863" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="724863" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="724863" y="-49.5" font-family="Arial" font-size="10.00">L12 EP1 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="724863" y="-38.5" font-family="Arial" font-size="10.00">GPU52</text>
</g>
<!-- residual1_L12_EP1TP2PP1DP0_GPU52 -->
<g id="node3508" class="node">
<title>residual1_L12_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="725156,-78 725006,-78 725006,-26 725156,-26 725156,-78"/>
<text text-anchor="middle" x="725081" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="725081" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="725081" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="725081" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L12_EP1TP2PP1DP0_GPU52 -->
<g id="node3509" class="node">
<title>ln2_L12_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="725342,-78 725192,-78 725192,-26 725342,-26 725342,-78"/>
<text text-anchor="middle" x="725267" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="725267" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="725267" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="725267" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L12_EP1TP2PP1DP0_GPU52 -->
<g id="node3510" class="node">
<title>gate_L12_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightyellow" stroke="black" points="725689.53,-104 725442.12,-104 725378.47,0 725625.88,0 725689.53,-104"/>
<text text-anchor="middle" x="725534" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="725534" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="725534" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="725534" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L12_EP1TP2PP1DP0_GPU52 -->
<g id="node3511" class="node">
<title>dispatch_L12_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="725832" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="725832" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="725832" y="-44" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP0_GPU52</text>
</g>
<!-- expert_0_L12_EP1TP2PP1DP0_GPU52 -->
<g id="node3512" class="node">
<title>expert_0_L12_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="726124,-78 725974,-78 725974,-26 726124,-26 726124,-78"/>
<text text-anchor="middle" x="726049" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="726049" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="726049" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="726049" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L12_EP1TP2PP1DP0_GPU52 -->
<g id="node3513" class="node">
<title>expert_1_L12_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="726310,-78 726160,-78 726160,-26 726310,-26 726310,-78"/>
<text text-anchor="middle" x="726235" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="726235" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="726235" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="726235" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L12_EP1TP2PP1DP0_GPU52 -->
<g id="node3514" class="node">
<title>expert_2_L12_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="726496,-78 726346,-78 726346,-26 726496,-26 726496,-78"/>
<text text-anchor="middle" x="726421" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="726421" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="726421" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="726421" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L12_EP1TP2PP1DP0_GPU52 -->
<g id="node3515" class="node">
<title>expert_3_L12_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="726682,-78 726532,-78 726532,-26 726682,-26 726682,-78"/>
<text text-anchor="middle" x="726607" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="726607" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="726607" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="726607" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L12_EP1TP2PP1DP0_GPU52 -->
<g id="node3516" class="node">
<title>combine_L12_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="726824" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="726824" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="726824" y="-44" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP0_GPU52</text>
</g>
<!-- ffn_L12_EP1TP2PP1DP0_GPU52 -->
<g id="node3517" class="node">
<title>ffn_L12_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="727136,-78 726966,-78 726966,-26 727136,-26 727136,-78"/>
<text text-anchor="middle" x="727051" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="727051" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="727051" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="727051" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L12_EP1TP2PP1DP0_GPU52 -->
<g id="node3518" class="node">
<title>ffn_ar_L12_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="727279" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="727279" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="727279" y="-49.5" font-family="Arial" font-size="10.00">L12 EP1 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="727279" y="-38.5" font-family="Arial" font-size="10.00">GPU52</text>
</g>
<!-- residual2_L12_EP1TP2PP1DP0_GPU52 -->
<g id="node3519" class="node">
<title>residual2_L12_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="727572,-78 727422,-78 727422,-26 727572,-26 727572,-78"/>
<text text-anchor="middle" x="727497" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="727497" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="727497" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="727497" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L12_EP1TP2PP1DP1_GPU53 -->
<g id="node3520" class="node">
<title>ln1_L12_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="727758,-78 727608,-78 727608,-26 727758,-26 727758,-78"/>
<text text-anchor="middle" x="727683" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="727683" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="727683" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="727683" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L12_EP1TP2PP1DP1_GPU53 -->
<g id="node3521" class="node">
<title>qkv_L12_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="727944,-78 727794,-78 727794,-26 727944,-26 727944,-78"/>
<text text-anchor="middle" x="727869" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="727869" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="727869" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="727869" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L12_EP1TP2PP1DP1_GPU53 -->
<g id="node3522" class="node">
<title>attn_L12_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="728131.5,-78 727980.5,-78 727980.5,-26 728131.5,-26 728131.5,-78"/>
<text text-anchor="middle" x="728056" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="728056" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="728056" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="728056" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L12_EP1TP2PP1DP1_GPU53 -->
<g id="node3523" class="node">
<title>attn_out_L12_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="728318,-78 728168,-78 728168,-26 728318,-26 728318,-78"/>
<text text-anchor="middle" x="728243" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="728243" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="728243" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="728243" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L12_EP1TP2PP1DP1_GPU53 -->
<g id="node3524" class="node">
<title>attn_ar_L12_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="728461" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="728461" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="728461" y="-49.5" font-family="Arial" font-size="10.00">L12 EP1 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="728461" y="-38.5" font-family="Arial" font-size="10.00">GPU53</text>
</g>
<!-- residual1_L12_EP1TP2PP1DP1_GPU53 -->
<g id="node3525" class="node">
<title>residual1_L12_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="728754,-78 728604,-78 728604,-26 728754,-26 728754,-78"/>
<text text-anchor="middle" x="728679" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="728679" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="728679" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="728679" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L12_EP1TP2PP1DP1_GPU53 -->
<g id="node3526" class="node">
<title>ln2_L12_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="728940,-78 728790,-78 728790,-26 728940,-26 728940,-78"/>
<text text-anchor="middle" x="728865" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="728865" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="728865" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="728865" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L12_EP1TP2PP1DP1_GPU53 -->
<g id="node3527" class="node">
<title>gate_L12_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightyellow" stroke="black" points="729287.53,-104 729040.12,-104 728976.47,0 729223.88,0 729287.53,-104"/>
<text text-anchor="middle" x="729132" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="729132" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="729132" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="729132" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L12_EP1TP2PP1DP1_GPU53 -->
<g id="node3528" class="node">
<title>dispatch_L12_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="729430" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="729430" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="729430" y="-44" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP1_GPU53</text>
</g>
<!-- expert_0_L12_EP1TP2PP1DP1_GPU53 -->
<g id="node3529" class="node">
<title>expert_0_L12_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="729722,-78 729572,-78 729572,-26 729722,-26 729722,-78"/>
<text text-anchor="middle" x="729647" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="729647" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="729647" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="729647" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L12_EP1TP2PP1DP1_GPU53 -->
<g id="node3530" class="node">
<title>expert_1_L12_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="729908,-78 729758,-78 729758,-26 729908,-26 729908,-78"/>
<text text-anchor="middle" x="729833" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="729833" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="729833" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="729833" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L12_EP1TP2PP1DP1_GPU53 -->
<g id="node3531" class="node">
<title>expert_2_L12_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="730094,-78 729944,-78 729944,-26 730094,-26 730094,-78"/>
<text text-anchor="middle" x="730019" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="730019" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="730019" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="730019" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L12_EP1TP2PP1DP1_GPU53 -->
<g id="node3532" class="node">
<title>expert_3_L12_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="730280,-78 730130,-78 730130,-26 730280,-26 730280,-78"/>
<text text-anchor="middle" x="730205" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="730205" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="730205" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="730205" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L12_EP1TP2PP1DP1_GPU53 -->
<g id="node3533" class="node">
<title>combine_L12_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="730422" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="730422" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="730422" y="-44" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP1_GPU53</text>
</g>
<!-- ffn_L12_EP1TP2PP1DP1_GPU53 -->
<g id="node3534" class="node">
<title>ffn_L12_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="730734,-78 730564,-78 730564,-26 730734,-26 730734,-78"/>
<text text-anchor="middle" x="730649" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="730649" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="730649" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="730649" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L12_EP1TP2PP1DP1_GPU53 -->
<g id="node3535" class="node">
<title>ffn_ar_L12_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="730877" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="730877" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="730877" y="-49.5" font-family="Arial" font-size="10.00">L12 EP1 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="730877" y="-38.5" font-family="Arial" font-size="10.00">GPU53</text>
</g>
<!-- residual2_L12_EP1TP2PP1DP1_GPU53 -->
<g id="node3536" class="node">
<title>residual2_L12_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="731170,-78 731020,-78 731020,-26 731170,-26 731170,-78"/>
<text text-anchor="middle" x="731095" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="731095" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="731095" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="731095" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L12_EP1TP3PP1DP0_GPU60 -->
<g id="node3537" class="node">
<title>ln1_L12_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="731356,-78 731206,-78 731206,-26 731356,-26 731356,-78"/>
<text text-anchor="middle" x="731281" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="731281" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="731281" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="731281" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L12_EP1TP3PP1DP0_GPU60 -->
<g id="node3538" class="node">
<title>qkv_L12_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="731542,-78 731392,-78 731392,-26 731542,-26 731542,-78"/>
<text text-anchor="middle" x="731467" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="731467" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="731467" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="731467" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L12_EP1TP3PP1DP0_GPU60 -->
<g id="node3539" class="node">
<title>attn_L12_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="731729.5,-78 731578.5,-78 731578.5,-26 731729.5,-26 731729.5,-78"/>
<text text-anchor="middle" x="731654" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="731654" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="731654" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="731654" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L12_EP1TP3PP1DP0_GPU60 -->
<g id="node3540" class="node">
<title>attn_out_L12_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="731916,-78 731766,-78 731766,-26 731916,-26 731916,-78"/>
<text text-anchor="middle" x="731841" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="731841" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="731841" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="731841" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L12_EP1TP3PP1DP0_GPU60 -->
<g id="node3541" class="node">
<title>attn_ar_L12_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="732059" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="732059" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="732059" y="-49.5" font-family="Arial" font-size="10.00">L12 EP1 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="732059" y="-38.5" font-family="Arial" font-size="10.00">GPU60</text>
</g>
<!-- residual1_L12_EP1TP3PP1DP0_GPU60 -->
<g id="node3542" class="node">
<title>residual1_L12_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="732352,-78 732202,-78 732202,-26 732352,-26 732352,-78"/>
<text text-anchor="middle" x="732277" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="732277" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="732277" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="732277" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L12_EP1TP3PP1DP0_GPU60 -->
<g id="node3543" class="node">
<title>ln2_L12_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="732538,-78 732388,-78 732388,-26 732538,-26 732538,-78"/>
<text text-anchor="middle" x="732463" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="732463" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="732463" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="732463" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L12_EP1TP3PP1DP0_GPU60 -->
<g id="node3544" class="node">
<title>gate_L12_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightyellow" stroke="black" points="732885.53,-104 732638.12,-104 732574.47,0 732821.88,0 732885.53,-104"/>
<text text-anchor="middle" x="732730" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="732730" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="732730" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="732730" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L12_EP1TP3PP1DP0_GPU60 -->
<g id="node3545" class="node">
<title>dispatch_L12_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="733028" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="733028" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="733028" y="-44" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP0_GPU60</text>
</g>
<!-- expert_0_L12_EP1TP3PP1DP0_GPU60 -->
<g id="node3546" class="node">
<title>expert_0_L12_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="733320,-78 733170,-78 733170,-26 733320,-26 733320,-78"/>
<text text-anchor="middle" x="733245" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="733245" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="733245" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="733245" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L12_EP1TP3PP1DP0_GPU60 -->
<g id="node3547" class="node">
<title>expert_1_L12_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="733506,-78 733356,-78 733356,-26 733506,-26 733506,-78"/>
<text text-anchor="middle" x="733431" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="733431" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="733431" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="733431" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L12_EP1TP3PP1DP0_GPU60 -->
<g id="node3548" class="node">
<title>expert_2_L12_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="733692,-78 733542,-78 733542,-26 733692,-26 733692,-78"/>
<text text-anchor="middle" x="733617" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="733617" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="733617" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="733617" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L12_EP1TP3PP1DP0_GPU60 -->
<g id="node3549" class="node">
<title>expert_3_L12_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="733878,-78 733728,-78 733728,-26 733878,-26 733878,-78"/>
<text text-anchor="middle" x="733803" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="733803" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="733803" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="733803" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L12_EP1TP3PP1DP0_GPU60 -->
<g id="node3550" class="node">
<title>combine_L12_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="734020" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="734020" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="734020" y="-44" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP0_GPU60</text>
</g>
<!-- ffn_L12_EP1TP3PP1DP0_GPU60 -->
<g id="node3551" class="node">
<title>ffn_L12_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="734332,-78 734162,-78 734162,-26 734332,-26 734332,-78"/>
<text text-anchor="middle" x="734247" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="734247" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="734247" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="734247" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L12_EP1TP3PP1DP0_GPU60 -->
<g id="node3552" class="node">
<title>ffn_ar_L12_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="734475" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="734475" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="734475" y="-49.5" font-family="Arial" font-size="10.00">L12 EP1 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="734475" y="-38.5" font-family="Arial" font-size="10.00">GPU60</text>
</g>
<!-- residual2_L12_EP1TP3PP1DP0_GPU60 -->
<g id="node3553" class="node">
<title>residual2_L12_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="734768,-78 734618,-78 734618,-26 734768,-26 734768,-78"/>
<text text-anchor="middle" x="734693" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="734693" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="734693" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="734693" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L12_EP1TP3PP1DP1_GPU61 -->
<g id="node3554" class="node">
<title>ln1_L12_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="734954,-78 734804,-78 734804,-26 734954,-26 734954,-78"/>
<text text-anchor="middle" x="734879" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="734879" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="734879" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="734879" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L12_EP1TP3PP1DP1_GPU61 -->
<g id="node3555" class="node">
<title>qkv_L12_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="735140,-78 734990,-78 734990,-26 735140,-26 735140,-78"/>
<text text-anchor="middle" x="735065" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="735065" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="735065" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="735065" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L12_EP1TP3PP1DP1_GPU61 -->
<g id="node3556" class="node">
<title>attn_L12_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="735327.5,-78 735176.5,-78 735176.5,-26 735327.5,-26 735327.5,-78"/>
<text text-anchor="middle" x="735252" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="735252" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="735252" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="735252" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L12_EP1TP3PP1DP1_GPU61 -->
<g id="node3557" class="node">
<title>attn_out_L12_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="735514,-78 735364,-78 735364,-26 735514,-26 735514,-78"/>
<text text-anchor="middle" x="735439" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="735439" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="735439" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="735439" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L12_EP1TP3PP1DP1_GPU61 -->
<g id="node3558" class="node">
<title>attn_ar_L12_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="735657" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="735657" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="735657" y="-49.5" font-family="Arial" font-size="10.00">L12 EP1 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="735657" y="-38.5" font-family="Arial" font-size="10.00">GPU61</text>
</g>
<!-- residual1_L12_EP1TP3PP1DP1_GPU61 -->
<g id="node3559" class="node">
<title>residual1_L12_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="735950,-78 735800,-78 735800,-26 735950,-26 735950,-78"/>
<text text-anchor="middle" x="735875" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="735875" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="735875" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="735875" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L12_EP1TP3PP1DP1_GPU61 -->
<g id="node3560" class="node">
<title>ln2_L12_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="736136,-78 735986,-78 735986,-26 736136,-26 736136,-78"/>
<text text-anchor="middle" x="736061" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="736061" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="736061" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="736061" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L12_EP1TP3PP1DP1_GPU61 -->
<g id="node3561" class="node">
<title>gate_L12_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightyellow" stroke="black" points="736483.53,-104 736236.12,-104 736172.47,0 736419.88,0 736483.53,-104"/>
<text text-anchor="middle" x="736328" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="736328" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="736328" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="736328" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L12_EP1TP3PP1DP1_GPU61 -->
<g id="node3562" class="node">
<title>dispatch_L12_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="736626" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="736626" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="736626" y="-44" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP1_GPU61</text>
</g>
<!-- expert_0_L12_EP1TP3PP1DP1_GPU61 -->
<g id="node3563" class="node">
<title>expert_0_L12_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="736918,-78 736768,-78 736768,-26 736918,-26 736918,-78"/>
<text text-anchor="middle" x="736843" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="736843" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="736843" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="736843" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L12_EP1TP3PP1DP1_GPU61 -->
<g id="node3564" class="node">
<title>expert_1_L12_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="737104,-78 736954,-78 736954,-26 737104,-26 737104,-78"/>
<text text-anchor="middle" x="737029" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="737029" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="737029" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="737029" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L12_EP1TP3PP1DP1_GPU61 -->
<g id="node3565" class="node">
<title>expert_2_L12_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="737290,-78 737140,-78 737140,-26 737290,-26 737290,-78"/>
<text text-anchor="middle" x="737215" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="737215" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="737215" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="737215" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L12_EP1TP3PP1DP1_GPU61 -->
<g id="node3566" class="node">
<title>expert_3_L12_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="737476,-78 737326,-78 737326,-26 737476,-26 737476,-78"/>
<text text-anchor="middle" x="737401" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="737401" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="737401" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="737401" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L12_EP1TP3PP1DP1_GPU61 -->
<g id="node3567" class="node">
<title>combine_L12_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="737618" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="737618" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="737618" y="-44" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP1_GPU61</text>
</g>
<!-- ffn_L12_EP1TP3PP1DP1_GPU61 -->
<g id="node3568" class="node">
<title>ffn_L12_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="737930,-78 737760,-78 737760,-26 737930,-26 737930,-78"/>
<text text-anchor="middle" x="737845" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="737845" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="737845" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="737845" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L12_EP1TP3PP1DP1_GPU61 -->
<g id="node3569" class="node">
<title>ffn_ar_L12_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="738073" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="738073" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="738073" y="-49.5" font-family="Arial" font-size="10.00">L12 EP1 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="738073" y="-38.5" font-family="Arial" font-size="10.00">GPU61</text>
</g>
<!-- residual2_L12_EP1TP3PP1DP1_GPU61 -->
<g id="node3570" class="node">
<title>residual2_L12_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="738366,-78 738216,-78 738216,-26 738366,-26 738366,-78"/>
<text text-anchor="middle" x="738291" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="738291" y="-55" font-family="Arial" font-size="10.00">L12_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="738291" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="738291" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L13_EP0TP0PP1DP0_GPU4 -->
<g id="node3571" class="node">
<title>ln1_L13_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="738547.5,-78 738402.5,-78 738402.5,-26 738547.5,-26 738547.5,-78"/>
<text text-anchor="middle" x="738475" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="738475" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="738475" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="738475" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L13_EP0TP0PP1DP0_GPU4 -->
<g id="node3572" class="node">
<title>qkv_L13_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="738728.5,-78 738583.5,-78 738583.5,-26 738728.5,-26 738728.5,-78"/>
<text text-anchor="middle" x="738656" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="738656" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="738656" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="738656" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L13_EP0TP0PP1DP0_GPU4 -->
<g id="node3573" class="node">
<title>attn_L13_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="738915.5,-78 738764.5,-78 738764.5,-26 738915.5,-26 738915.5,-78"/>
<text text-anchor="middle" x="738840" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="738840" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="738840" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="738840" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L13_EP0TP0PP1DP0_GPU4 -->
<g id="node3574" class="node">
<title>attn_out_L13_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="739096.5,-78 738951.5,-78 738951.5,-26 739096.5,-26 739096.5,-78"/>
<text text-anchor="middle" x="739024" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="739024" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="739024" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="739024" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L13_EP0TP0PP1DP0_GPU4 -->
<g id="node3575" class="node">
<title>attn_ar_L13_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="739239" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="739239" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="739239" y="-49.5" font-family="Arial" font-size="10.00">L13 EP0 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="739239" y="-38.5" font-family="Arial" font-size="10.00">GPU4</text>
</g>
<!-- residual1_L13_EP0TP0PP1DP0_GPU4 -->
<g id="node3576" class="node">
<title>residual1_L13_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="739528,-78 739382,-78 739382,-26 739528,-26 739528,-78"/>
<text text-anchor="middle" x="739455" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="739455" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="739455" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="739455" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L13_EP0TP0PP1DP0_GPU4 -->
<g id="node3577" class="node">
<title>ln2_L13_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="739709.5,-78 739564.5,-78 739564.5,-26 739709.5,-26 739709.5,-78"/>
<text text-anchor="middle" x="739637" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="739637" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="739637" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="739637" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L13_EP0TP0PP1DP0_GPU4 -->
<g id="node3578" class="node">
<title>gate_L13_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightyellow" stroke="black" points="740046.16,-104 739807.29,-104 739745.84,0 739984.71,0 740046.16,-104"/>
<text text-anchor="middle" x="739896" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="739896" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="739896" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="739896" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L13_EP0TP0PP1DP0_GPU4 -->
<g id="node3579" class="node">
<title>dispatch_L13_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="740185" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="740185" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="740185" y="-44" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP0_GPU4</text>
</g>
<!-- expert_0_L13_EP0TP0PP1DP0_GPU4 -->
<g id="node3580" class="node">
<title>expert_0_L13_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="740468.5,-78 740323.5,-78 740323.5,-26 740468.5,-26 740468.5,-78"/>
<text text-anchor="middle" x="740396" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="740396" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="740396" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="740396" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L13_EP0TP0PP1DP0_GPU4 -->
<g id="node3581" class="node">
<title>expert_1_L13_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="740649.5,-78 740504.5,-78 740504.5,-26 740649.5,-26 740649.5,-78"/>
<text text-anchor="middle" x="740577" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="740577" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="740577" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="740577" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L13_EP0TP0PP1DP0_GPU4 -->
<g id="node3582" class="node">
<title>expert_2_L13_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="740830.5,-78 740685.5,-78 740685.5,-26 740830.5,-26 740830.5,-78"/>
<text text-anchor="middle" x="740758" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="740758" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="740758" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="740758" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L13_EP0TP0PP1DP0_GPU4 -->
<g id="node3583" class="node">
<title>expert_3_L13_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="741011.5,-78 740866.5,-78 740866.5,-26 741011.5,-26 741011.5,-78"/>
<text text-anchor="middle" x="740939" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="740939" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="740939" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="740939" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L13_EP0TP0PP1DP0_GPU4 -->
<g id="node3584" class="node">
<title>combine_L13_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="741150" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="741150" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="741150" y="-44" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP0_GPU4</text>
</g>
<!-- ffn_L13_EP0TP0PP1DP0_GPU4 -->
<g id="node3585" class="node">
<title>ffn_L13_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="741459,-78 741289,-78 741289,-26 741459,-26 741459,-78"/>
<text text-anchor="middle" x="741374" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="741374" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="741374" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="741374" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L13_EP0TP0PP1DP0_GPU4 -->
<g id="node3586" class="node">
<title>ffn_ar_L13_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="741602" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="741602" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="741602" y="-49.5" font-family="Arial" font-size="10.00">L13 EP0 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="741602" y="-38.5" font-family="Arial" font-size="10.00">GPU4</text>
</g>
<!-- residual2_L13_EP0TP0PP1DP0_GPU4 -->
<g id="node3587" class="node">
<title>residual2_L13_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="741891,-78 741745,-78 741745,-26 741891,-26 741891,-78"/>
<text text-anchor="middle" x="741818" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="741818" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="741818" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="741818" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L13_EP0TP0PP1DP1_GPU5 -->
<g id="node3588" class="node">
<title>ln1_L13_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="742072.5,-78 741927.5,-78 741927.5,-26 742072.5,-26 742072.5,-78"/>
<text text-anchor="middle" x="742000" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="742000" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="742000" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="742000" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L13_EP0TP0PP1DP1_GPU5 -->
<g id="node3589" class="node">
<title>qkv_L13_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="742253.5,-78 742108.5,-78 742108.5,-26 742253.5,-26 742253.5,-78"/>
<text text-anchor="middle" x="742181" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="742181" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="742181" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="742181" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L13_EP0TP0PP1DP1_GPU5 -->
<g id="node3590" class="node">
<title>attn_L13_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="742440.5,-78 742289.5,-78 742289.5,-26 742440.5,-26 742440.5,-78"/>
<text text-anchor="middle" x="742365" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="742365" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="742365" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="742365" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L13_EP0TP0PP1DP1_GPU5 -->
<g id="node3591" class="node">
<title>attn_out_L13_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="742621.5,-78 742476.5,-78 742476.5,-26 742621.5,-26 742621.5,-78"/>
<text text-anchor="middle" x="742549" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="742549" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="742549" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="742549" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L13_EP0TP0PP1DP1_GPU5 -->
<g id="node3592" class="node">
<title>attn_ar_L13_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="742764" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="742764" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="742764" y="-49.5" font-family="Arial" font-size="10.00">L13 EP0 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="742764" y="-38.5" font-family="Arial" font-size="10.00">GPU5</text>
</g>
<!-- residual1_L13_EP0TP0PP1DP1_GPU5 -->
<g id="node3593" class="node">
<title>residual1_L13_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="743053,-78 742907,-78 742907,-26 743053,-26 743053,-78"/>
<text text-anchor="middle" x="742980" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="742980" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="742980" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="742980" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L13_EP0TP0PP1DP1_GPU5 -->
<g id="node3594" class="node">
<title>ln2_L13_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="743234.5,-78 743089.5,-78 743089.5,-26 743234.5,-26 743234.5,-78"/>
<text text-anchor="middle" x="743162" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="743162" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="743162" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="743162" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L13_EP0TP0PP1DP1_GPU5 -->
<g id="node3595" class="node">
<title>gate_L13_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightyellow" stroke="black" points="743571.16,-104 743332.29,-104 743270.84,0 743509.71,0 743571.16,-104"/>
<text text-anchor="middle" x="743421" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="743421" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="743421" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="743421" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L13_EP0TP0PP1DP1_GPU5 -->
<g id="node3596" class="node">
<title>dispatch_L13_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="743710" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="743710" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="743710" y="-44" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP1_GPU5</text>
</g>
<!-- expert_0_L13_EP0TP0PP1DP1_GPU5 -->
<g id="node3597" class="node">
<title>expert_0_L13_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="743993.5,-78 743848.5,-78 743848.5,-26 743993.5,-26 743993.5,-78"/>
<text text-anchor="middle" x="743921" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="743921" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="743921" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="743921" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L13_EP0TP0PP1DP1_GPU5 -->
<g id="node3598" class="node">
<title>expert_1_L13_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="744174.5,-78 744029.5,-78 744029.5,-26 744174.5,-26 744174.5,-78"/>
<text text-anchor="middle" x="744102" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="744102" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="744102" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="744102" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L13_EP0TP0PP1DP1_GPU5 -->
<g id="node3599" class="node">
<title>expert_2_L13_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="744355.5,-78 744210.5,-78 744210.5,-26 744355.5,-26 744355.5,-78"/>
<text text-anchor="middle" x="744283" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="744283" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="744283" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="744283" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L13_EP0TP0PP1DP1_GPU5 -->
<g id="node3600" class="node">
<title>expert_3_L13_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="744536.5,-78 744391.5,-78 744391.5,-26 744536.5,-26 744536.5,-78"/>
<text text-anchor="middle" x="744464" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="744464" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="744464" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="744464" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L13_EP0TP0PP1DP1_GPU5 -->
<g id="node3601" class="node">
<title>combine_L13_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="744675" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="744675" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="744675" y="-44" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP1_GPU5</text>
</g>
<!-- ffn_L13_EP0TP0PP1DP1_GPU5 -->
<g id="node3602" class="node">
<title>ffn_L13_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="744984,-78 744814,-78 744814,-26 744984,-26 744984,-78"/>
<text text-anchor="middle" x="744899" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="744899" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="744899" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="744899" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L13_EP0TP0PP1DP1_GPU5 -->
<g id="node3603" class="node">
<title>ffn_ar_L13_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="745127" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="745127" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="745127" y="-49.5" font-family="Arial" font-size="10.00">L13 EP0 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="745127" y="-38.5" font-family="Arial" font-size="10.00">GPU5</text>
</g>
<!-- residual2_L13_EP0TP0PP1DP1_GPU5 -->
<g id="node3604" class="node">
<title>residual2_L13_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="745416,-78 745270,-78 745270,-26 745416,-26 745416,-78"/>
<text text-anchor="middle" x="745343" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="745343" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="745343" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="745343" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L13_EP0TP1PP1DP0_GPU12 -->
<g id="node3605" class="node">
<title>ln1_L13_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="745602,-78 745452,-78 745452,-26 745602,-26 745602,-78"/>
<text text-anchor="middle" x="745527" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="745527" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="745527" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="745527" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L13_EP0TP1PP1DP0_GPU12 -->
<g id="node3606" class="node">
<title>qkv_L13_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="745788,-78 745638,-78 745638,-26 745788,-26 745788,-78"/>
<text text-anchor="middle" x="745713" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="745713" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="745713" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="745713" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L13_EP0TP1PP1DP0_GPU12 -->
<g id="node3607" class="node">
<title>attn_L13_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="745975.5,-78 745824.5,-78 745824.5,-26 745975.5,-26 745975.5,-78"/>
<text text-anchor="middle" x="745900" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="745900" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="745900" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="745900" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L13_EP0TP1PP1DP0_GPU12 -->
<g id="node3608" class="node">
<title>attn_out_L13_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="746162,-78 746012,-78 746012,-26 746162,-26 746162,-78"/>
<text text-anchor="middle" x="746087" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="746087" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="746087" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="746087" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L13_EP0TP1PP1DP0_GPU12 -->
<g id="node3609" class="node">
<title>attn_ar_L13_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="746305" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="746305" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="746305" y="-49.5" font-family="Arial" font-size="10.00">L13 EP0 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="746305" y="-38.5" font-family="Arial" font-size="10.00">GPU12</text>
</g>
<!-- residual1_L13_EP0TP1PP1DP0_GPU12 -->
<g id="node3610" class="node">
<title>residual1_L13_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="746598,-78 746448,-78 746448,-26 746598,-26 746598,-78"/>
<text text-anchor="middle" x="746523" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="746523" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="746523" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="746523" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L13_EP0TP1PP1DP0_GPU12 -->
<g id="node3611" class="node">
<title>ln2_L13_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="746784,-78 746634,-78 746634,-26 746784,-26 746784,-78"/>
<text text-anchor="middle" x="746709" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="746709" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="746709" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="746709" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L13_EP0TP1PP1DP0_GPU12 -->
<g id="node3612" class="node">
<title>gate_L13_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightyellow" stroke="black" points="747131.53,-104 746884.12,-104 746820.47,0 747067.88,0 747131.53,-104"/>
<text text-anchor="middle" x="746976" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="746976" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="746976" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="746976" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L13_EP0TP1PP1DP0_GPU12 -->
<g id="node3613" class="node">
<title>dispatch_L13_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="747274" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="747274" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="747274" y="-44" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP0_GPU12</text>
</g>
<!-- expert_0_L13_EP0TP1PP1DP0_GPU12 -->
<g id="node3614" class="node">
<title>expert_0_L13_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="747566,-78 747416,-78 747416,-26 747566,-26 747566,-78"/>
<text text-anchor="middle" x="747491" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="747491" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="747491" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="747491" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L13_EP0TP1PP1DP0_GPU12 -->
<g id="node3615" class="node">
<title>expert_1_L13_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="747752,-78 747602,-78 747602,-26 747752,-26 747752,-78"/>
<text text-anchor="middle" x="747677" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="747677" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="747677" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="747677" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L13_EP0TP1PP1DP0_GPU12 -->
<g id="node3616" class="node">
<title>expert_2_L13_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="747938,-78 747788,-78 747788,-26 747938,-26 747938,-78"/>
<text text-anchor="middle" x="747863" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="747863" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="747863" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="747863" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L13_EP0TP1PP1DP0_GPU12 -->
<g id="node3617" class="node">
<title>expert_3_L13_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="748124,-78 747974,-78 747974,-26 748124,-26 748124,-78"/>
<text text-anchor="middle" x="748049" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="748049" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="748049" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="748049" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L13_EP0TP1PP1DP0_GPU12 -->
<g id="node3618" class="node">
<title>combine_L13_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="748266" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="748266" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="748266" y="-44" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP0_GPU12</text>
</g>
<!-- ffn_L13_EP0TP1PP1DP0_GPU12 -->
<g id="node3619" class="node">
<title>ffn_L13_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="748578,-78 748408,-78 748408,-26 748578,-26 748578,-78"/>
<text text-anchor="middle" x="748493" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="748493" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="748493" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="748493" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L13_EP0TP1PP1DP0_GPU12 -->
<g id="node3620" class="node">
<title>ffn_ar_L13_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="748721" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="748721" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="748721" y="-49.5" font-family="Arial" font-size="10.00">L13 EP0 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="748721" y="-38.5" font-family="Arial" font-size="10.00">GPU12</text>
</g>
<!-- residual2_L13_EP0TP1PP1DP0_GPU12 -->
<g id="node3621" class="node">
<title>residual2_L13_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="749014,-78 748864,-78 748864,-26 749014,-26 749014,-78"/>
<text text-anchor="middle" x="748939" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="748939" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="748939" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="748939" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L13_EP0TP1PP1DP1_GPU13 -->
<g id="node3622" class="node">
<title>ln1_L13_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="749200,-78 749050,-78 749050,-26 749200,-26 749200,-78"/>
<text text-anchor="middle" x="749125" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="749125" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="749125" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="749125" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L13_EP0TP1PP1DP1_GPU13 -->
<g id="node3623" class="node">
<title>qkv_L13_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="749386,-78 749236,-78 749236,-26 749386,-26 749386,-78"/>
<text text-anchor="middle" x="749311" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="749311" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="749311" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="749311" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L13_EP0TP1PP1DP1_GPU13 -->
<g id="node3624" class="node">
<title>attn_L13_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="749573.5,-78 749422.5,-78 749422.5,-26 749573.5,-26 749573.5,-78"/>
<text text-anchor="middle" x="749498" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="749498" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="749498" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="749498" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L13_EP0TP1PP1DP1_GPU13 -->
<g id="node3625" class="node">
<title>attn_out_L13_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="749760,-78 749610,-78 749610,-26 749760,-26 749760,-78"/>
<text text-anchor="middle" x="749685" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="749685" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="749685" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="749685" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L13_EP0TP1PP1DP1_GPU13 -->
<g id="node3626" class="node">
<title>attn_ar_L13_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="749903" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="749903" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="749903" y="-49.5" font-family="Arial" font-size="10.00">L13 EP0 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="749903" y="-38.5" font-family="Arial" font-size="10.00">GPU13</text>
</g>
<!-- residual1_L13_EP0TP1PP1DP1_GPU13 -->
<g id="node3627" class="node">
<title>residual1_L13_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="750196,-78 750046,-78 750046,-26 750196,-26 750196,-78"/>
<text text-anchor="middle" x="750121" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="750121" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="750121" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="750121" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L13_EP0TP1PP1DP1_GPU13 -->
<g id="node3628" class="node">
<title>ln2_L13_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="750382,-78 750232,-78 750232,-26 750382,-26 750382,-78"/>
<text text-anchor="middle" x="750307" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="750307" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="750307" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="750307" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L13_EP0TP1PP1DP1_GPU13 -->
<g id="node3629" class="node">
<title>gate_L13_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightyellow" stroke="black" points="750729.53,-104 750482.12,-104 750418.47,0 750665.88,0 750729.53,-104"/>
<text text-anchor="middle" x="750574" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="750574" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="750574" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="750574" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L13_EP0TP1PP1DP1_GPU13 -->
<g id="node3630" class="node">
<title>dispatch_L13_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="750872" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="750872" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="750872" y="-44" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP1_GPU13</text>
</g>
<!-- expert_0_L13_EP0TP1PP1DP1_GPU13 -->
<g id="node3631" class="node">
<title>expert_0_L13_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="751164,-78 751014,-78 751014,-26 751164,-26 751164,-78"/>
<text text-anchor="middle" x="751089" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="751089" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="751089" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="751089" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L13_EP0TP1PP1DP1_GPU13 -->
<g id="node3632" class="node">
<title>expert_1_L13_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="751350,-78 751200,-78 751200,-26 751350,-26 751350,-78"/>
<text text-anchor="middle" x="751275" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="751275" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="751275" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="751275" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L13_EP0TP1PP1DP1_GPU13 -->
<g id="node3633" class="node">
<title>expert_2_L13_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="751536,-78 751386,-78 751386,-26 751536,-26 751536,-78"/>
<text text-anchor="middle" x="751461" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="751461" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="751461" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="751461" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L13_EP0TP1PP1DP1_GPU13 -->
<g id="node3634" class="node">
<title>expert_3_L13_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="751722,-78 751572,-78 751572,-26 751722,-26 751722,-78"/>
<text text-anchor="middle" x="751647" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="751647" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="751647" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="751647" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L13_EP0TP1PP1DP1_GPU13 -->
<g id="node3635" class="node">
<title>combine_L13_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="751864" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="751864" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="751864" y="-44" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP1_GPU13</text>
</g>
<!-- ffn_L13_EP0TP1PP1DP1_GPU13 -->
<g id="node3636" class="node">
<title>ffn_L13_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="752176,-78 752006,-78 752006,-26 752176,-26 752176,-78"/>
<text text-anchor="middle" x="752091" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="752091" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="752091" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="752091" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L13_EP0TP1PP1DP1_GPU13 -->
<g id="node3637" class="node">
<title>ffn_ar_L13_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="752319" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="752319" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="752319" y="-49.5" font-family="Arial" font-size="10.00">L13 EP0 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="752319" y="-38.5" font-family="Arial" font-size="10.00">GPU13</text>
</g>
<!-- residual2_L13_EP0TP1PP1DP1_GPU13 -->
<g id="node3638" class="node">
<title>residual2_L13_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="752612,-78 752462,-78 752462,-26 752612,-26 752612,-78"/>
<text text-anchor="middle" x="752537" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="752537" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="752537" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="752537" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L13_EP0TP2PP1DP0_GPU20 -->
<g id="node3639" class="node">
<title>ln1_L13_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="752798,-78 752648,-78 752648,-26 752798,-26 752798,-78"/>
<text text-anchor="middle" x="752723" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="752723" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="752723" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="752723" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L13_EP0TP2PP1DP0_GPU20 -->
<g id="node3640" class="node">
<title>qkv_L13_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="752984,-78 752834,-78 752834,-26 752984,-26 752984,-78"/>
<text text-anchor="middle" x="752909" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="752909" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="752909" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="752909" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L13_EP0TP2PP1DP0_GPU20 -->
<g id="node3641" class="node">
<title>attn_L13_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="753171.5,-78 753020.5,-78 753020.5,-26 753171.5,-26 753171.5,-78"/>
<text text-anchor="middle" x="753096" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="753096" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="753096" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="753096" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L13_EP0TP2PP1DP0_GPU20 -->
<g id="node3642" class="node">
<title>attn_out_L13_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="753358,-78 753208,-78 753208,-26 753358,-26 753358,-78"/>
<text text-anchor="middle" x="753283" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="753283" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="753283" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="753283" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L13_EP0TP2PP1DP0_GPU20 -->
<g id="node3643" class="node">
<title>attn_ar_L13_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="753501" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="753501" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="753501" y="-49.5" font-family="Arial" font-size="10.00">L13 EP0 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="753501" y="-38.5" font-family="Arial" font-size="10.00">GPU20</text>
</g>
<!-- residual1_L13_EP0TP2PP1DP0_GPU20 -->
<g id="node3644" class="node">
<title>residual1_L13_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="753794,-78 753644,-78 753644,-26 753794,-26 753794,-78"/>
<text text-anchor="middle" x="753719" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="753719" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="753719" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="753719" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L13_EP0TP2PP1DP0_GPU20 -->
<g id="node3645" class="node">
<title>ln2_L13_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="753980,-78 753830,-78 753830,-26 753980,-26 753980,-78"/>
<text text-anchor="middle" x="753905" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="753905" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="753905" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="753905" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L13_EP0TP2PP1DP0_GPU20 -->
<g id="node3646" class="node">
<title>gate_L13_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightyellow" stroke="black" points="754327.53,-104 754080.12,-104 754016.47,0 754263.88,0 754327.53,-104"/>
<text text-anchor="middle" x="754172" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="754172" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="754172" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="754172" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L13_EP0TP2PP1DP0_GPU20 -->
<g id="node3647" class="node">
<title>dispatch_L13_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="754470" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="754470" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="754470" y="-44" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP0_GPU20</text>
</g>
<!-- expert_0_L13_EP0TP2PP1DP0_GPU20 -->
<g id="node3648" class="node">
<title>expert_0_L13_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="754762,-78 754612,-78 754612,-26 754762,-26 754762,-78"/>
<text text-anchor="middle" x="754687" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="754687" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="754687" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="754687" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L13_EP0TP2PP1DP0_GPU20 -->
<g id="node3649" class="node">
<title>expert_1_L13_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="754948,-78 754798,-78 754798,-26 754948,-26 754948,-78"/>
<text text-anchor="middle" x="754873" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="754873" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="754873" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="754873" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L13_EP0TP2PP1DP0_GPU20 -->
<g id="node3650" class="node">
<title>expert_2_L13_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="755134,-78 754984,-78 754984,-26 755134,-26 755134,-78"/>
<text text-anchor="middle" x="755059" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="755059" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="755059" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="755059" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L13_EP0TP2PP1DP0_GPU20 -->
<g id="node3651" class="node">
<title>expert_3_L13_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="755320,-78 755170,-78 755170,-26 755320,-26 755320,-78"/>
<text text-anchor="middle" x="755245" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="755245" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="755245" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="755245" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L13_EP0TP2PP1DP0_GPU20 -->
<g id="node3652" class="node">
<title>combine_L13_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="755462" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="755462" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="755462" y="-44" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP0_GPU20</text>
</g>
<!-- ffn_L13_EP0TP2PP1DP0_GPU20 -->
<g id="node3653" class="node">
<title>ffn_L13_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="755774,-78 755604,-78 755604,-26 755774,-26 755774,-78"/>
<text text-anchor="middle" x="755689" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="755689" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="755689" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="755689" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L13_EP0TP2PP1DP0_GPU20 -->
<g id="node3654" class="node">
<title>ffn_ar_L13_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="755917" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="755917" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="755917" y="-49.5" font-family="Arial" font-size="10.00">L13 EP0 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="755917" y="-38.5" font-family="Arial" font-size="10.00">GPU20</text>
</g>
<!-- residual2_L13_EP0TP2PP1DP0_GPU20 -->
<g id="node3655" class="node">
<title>residual2_L13_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="756210,-78 756060,-78 756060,-26 756210,-26 756210,-78"/>
<text text-anchor="middle" x="756135" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="756135" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="756135" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="756135" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L13_EP0TP2PP1DP1_GPU21 -->
<g id="node3656" class="node">
<title>ln1_L13_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="756396,-78 756246,-78 756246,-26 756396,-26 756396,-78"/>
<text text-anchor="middle" x="756321" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="756321" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="756321" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="756321" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L13_EP0TP2PP1DP1_GPU21 -->
<g id="node3657" class="node">
<title>qkv_L13_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="756582,-78 756432,-78 756432,-26 756582,-26 756582,-78"/>
<text text-anchor="middle" x="756507" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="756507" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="756507" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="756507" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L13_EP0TP2PP1DP1_GPU21 -->
<g id="node3658" class="node">
<title>attn_L13_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="756769.5,-78 756618.5,-78 756618.5,-26 756769.5,-26 756769.5,-78"/>
<text text-anchor="middle" x="756694" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="756694" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="756694" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="756694" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L13_EP0TP2PP1DP1_GPU21 -->
<g id="node3659" class="node">
<title>attn_out_L13_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="756956,-78 756806,-78 756806,-26 756956,-26 756956,-78"/>
<text text-anchor="middle" x="756881" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="756881" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="756881" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="756881" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L13_EP0TP2PP1DP1_GPU21 -->
<g id="node3660" class="node">
<title>attn_ar_L13_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="757099" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="757099" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="757099" y="-49.5" font-family="Arial" font-size="10.00">L13 EP0 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="757099" y="-38.5" font-family="Arial" font-size="10.00">GPU21</text>
</g>
<!-- residual1_L13_EP0TP2PP1DP1_GPU21 -->
<g id="node3661" class="node">
<title>residual1_L13_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="757392,-78 757242,-78 757242,-26 757392,-26 757392,-78"/>
<text text-anchor="middle" x="757317" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="757317" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="757317" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="757317" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L13_EP0TP2PP1DP1_GPU21 -->
<g id="node3662" class="node">
<title>ln2_L13_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="757578,-78 757428,-78 757428,-26 757578,-26 757578,-78"/>
<text text-anchor="middle" x="757503" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="757503" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="757503" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="757503" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L13_EP0TP2PP1DP1_GPU21 -->
<g id="node3663" class="node">
<title>gate_L13_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightyellow" stroke="black" points="757925.53,-104 757678.12,-104 757614.47,0 757861.88,0 757925.53,-104"/>
<text text-anchor="middle" x="757770" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="757770" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="757770" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="757770" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L13_EP0TP2PP1DP1_GPU21 -->
<g id="node3664" class="node">
<title>dispatch_L13_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="758068" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="758068" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="758068" y="-44" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP1_GPU21</text>
</g>
<!-- expert_0_L13_EP0TP2PP1DP1_GPU21 -->
<g id="node3665" class="node">
<title>expert_0_L13_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="758360,-78 758210,-78 758210,-26 758360,-26 758360,-78"/>
<text text-anchor="middle" x="758285" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="758285" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="758285" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="758285" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L13_EP0TP2PP1DP1_GPU21 -->
<g id="node3666" class="node">
<title>expert_1_L13_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="758546,-78 758396,-78 758396,-26 758546,-26 758546,-78"/>
<text text-anchor="middle" x="758471" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="758471" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="758471" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="758471" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L13_EP0TP2PP1DP1_GPU21 -->
<g id="node3667" class="node">
<title>expert_2_L13_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="758732,-78 758582,-78 758582,-26 758732,-26 758732,-78"/>
<text text-anchor="middle" x="758657" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="758657" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="758657" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="758657" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L13_EP0TP2PP1DP1_GPU21 -->
<g id="node3668" class="node">
<title>expert_3_L13_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="758918,-78 758768,-78 758768,-26 758918,-26 758918,-78"/>
<text text-anchor="middle" x="758843" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="758843" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="758843" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="758843" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L13_EP0TP2PP1DP1_GPU21 -->
<g id="node3669" class="node">
<title>combine_L13_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="759060" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="759060" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="759060" y="-44" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP1_GPU21</text>
</g>
<!-- ffn_L13_EP0TP2PP1DP1_GPU21 -->
<g id="node3670" class="node">
<title>ffn_L13_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="759372,-78 759202,-78 759202,-26 759372,-26 759372,-78"/>
<text text-anchor="middle" x="759287" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="759287" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="759287" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="759287" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L13_EP0TP2PP1DP1_GPU21 -->
<g id="node3671" class="node">
<title>ffn_ar_L13_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="759515" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="759515" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="759515" y="-49.5" font-family="Arial" font-size="10.00">L13 EP0 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="759515" y="-38.5" font-family="Arial" font-size="10.00">GPU21</text>
</g>
<!-- residual2_L13_EP0TP2PP1DP1_GPU21 -->
<g id="node3672" class="node">
<title>residual2_L13_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="759808,-78 759658,-78 759658,-26 759808,-26 759808,-78"/>
<text text-anchor="middle" x="759733" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="759733" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="759733" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="759733" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L13_EP0TP3PP1DP0_GPU28 -->
<g id="node3673" class="node">
<title>ln1_L13_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="759994,-78 759844,-78 759844,-26 759994,-26 759994,-78"/>
<text text-anchor="middle" x="759919" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="759919" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="759919" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="759919" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L13_EP0TP3PP1DP0_GPU28 -->
<g id="node3674" class="node">
<title>qkv_L13_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="760180,-78 760030,-78 760030,-26 760180,-26 760180,-78"/>
<text text-anchor="middle" x="760105" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="760105" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="760105" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="760105" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L13_EP0TP3PP1DP0_GPU28 -->
<g id="node3675" class="node">
<title>attn_L13_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="760367.5,-78 760216.5,-78 760216.5,-26 760367.5,-26 760367.5,-78"/>
<text text-anchor="middle" x="760292" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="760292" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="760292" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="760292" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L13_EP0TP3PP1DP0_GPU28 -->
<g id="node3676" class="node">
<title>attn_out_L13_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="760554,-78 760404,-78 760404,-26 760554,-26 760554,-78"/>
<text text-anchor="middle" x="760479" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="760479" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="760479" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="760479" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L13_EP0TP3PP1DP0_GPU28 -->
<g id="node3677" class="node">
<title>attn_ar_L13_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="760697" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="760697" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="760697" y="-49.5" font-family="Arial" font-size="10.00">L13 EP0 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="760697" y="-38.5" font-family="Arial" font-size="10.00">GPU28</text>
</g>
<!-- residual1_L13_EP0TP3PP1DP0_GPU28 -->
<g id="node3678" class="node">
<title>residual1_L13_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="760990,-78 760840,-78 760840,-26 760990,-26 760990,-78"/>
<text text-anchor="middle" x="760915" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="760915" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="760915" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="760915" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L13_EP0TP3PP1DP0_GPU28 -->
<g id="node3679" class="node">
<title>ln2_L13_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="761176,-78 761026,-78 761026,-26 761176,-26 761176,-78"/>
<text text-anchor="middle" x="761101" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="761101" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="761101" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="761101" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L13_EP0TP3PP1DP0_GPU28 -->
<g id="node3680" class="node">
<title>gate_L13_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightyellow" stroke="black" points="761523.53,-104 761276.12,-104 761212.47,0 761459.88,0 761523.53,-104"/>
<text text-anchor="middle" x="761368" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="761368" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="761368" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="761368" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L13_EP0TP3PP1DP0_GPU28 -->
<g id="node3681" class="node">
<title>dispatch_L13_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="761666" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="761666" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="761666" y="-44" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP0_GPU28</text>
</g>
<!-- expert_0_L13_EP0TP3PP1DP0_GPU28 -->
<g id="node3682" class="node">
<title>expert_0_L13_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="761958,-78 761808,-78 761808,-26 761958,-26 761958,-78"/>
<text text-anchor="middle" x="761883" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="761883" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="761883" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="761883" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L13_EP0TP3PP1DP0_GPU28 -->
<g id="node3683" class="node">
<title>expert_1_L13_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="762144,-78 761994,-78 761994,-26 762144,-26 762144,-78"/>
<text text-anchor="middle" x="762069" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="762069" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="762069" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="762069" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L13_EP0TP3PP1DP0_GPU28 -->
<g id="node3684" class="node">
<title>expert_2_L13_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="762330,-78 762180,-78 762180,-26 762330,-26 762330,-78"/>
<text text-anchor="middle" x="762255" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="762255" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="762255" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="762255" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L13_EP0TP3PP1DP0_GPU28 -->
<g id="node3685" class="node">
<title>expert_3_L13_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="762516,-78 762366,-78 762366,-26 762516,-26 762516,-78"/>
<text text-anchor="middle" x="762441" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="762441" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="762441" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="762441" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L13_EP0TP3PP1DP0_GPU28 -->
<g id="node3686" class="node">
<title>combine_L13_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="762658" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="762658" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="762658" y="-44" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP0_GPU28</text>
</g>
<!-- ffn_L13_EP0TP3PP1DP0_GPU28 -->
<g id="node3687" class="node">
<title>ffn_L13_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="762970,-78 762800,-78 762800,-26 762970,-26 762970,-78"/>
<text text-anchor="middle" x="762885" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="762885" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="762885" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="762885" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L13_EP0TP3PP1DP0_GPU28 -->
<g id="node3688" class="node">
<title>ffn_ar_L13_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="763113" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="763113" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="763113" y="-49.5" font-family="Arial" font-size="10.00">L13 EP0 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="763113" y="-38.5" font-family="Arial" font-size="10.00">GPU28</text>
</g>
<!-- residual2_L13_EP0TP3PP1DP0_GPU28 -->
<g id="node3689" class="node">
<title>residual2_L13_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="763406,-78 763256,-78 763256,-26 763406,-26 763406,-78"/>
<text text-anchor="middle" x="763331" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="763331" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="763331" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="763331" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L13_EP0TP3PP1DP1_GPU29 -->
<g id="node3690" class="node">
<title>ln1_L13_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="763592,-78 763442,-78 763442,-26 763592,-26 763592,-78"/>
<text text-anchor="middle" x="763517" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="763517" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="763517" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="763517" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L13_EP0TP3PP1DP1_GPU29 -->
<g id="node3691" class="node">
<title>qkv_L13_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="763778,-78 763628,-78 763628,-26 763778,-26 763778,-78"/>
<text text-anchor="middle" x="763703" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="763703" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="763703" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="763703" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L13_EP0TP3PP1DP1_GPU29 -->
<g id="node3692" class="node">
<title>attn_L13_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="763965.5,-78 763814.5,-78 763814.5,-26 763965.5,-26 763965.5,-78"/>
<text text-anchor="middle" x="763890" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="763890" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="763890" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="763890" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L13_EP0TP3PP1DP1_GPU29 -->
<g id="node3693" class="node">
<title>attn_out_L13_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="764152,-78 764002,-78 764002,-26 764152,-26 764152,-78"/>
<text text-anchor="middle" x="764077" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="764077" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="764077" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="764077" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L13_EP0TP3PP1DP1_GPU29 -->
<g id="node3694" class="node">
<title>attn_ar_L13_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="764295" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="764295" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="764295" y="-49.5" font-family="Arial" font-size="10.00">L13 EP0 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="764295" y="-38.5" font-family="Arial" font-size="10.00">GPU29</text>
</g>
<!-- residual1_L13_EP0TP3PP1DP1_GPU29 -->
<g id="node3695" class="node">
<title>residual1_L13_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="764588,-78 764438,-78 764438,-26 764588,-26 764588,-78"/>
<text text-anchor="middle" x="764513" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="764513" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="764513" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="764513" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L13_EP0TP3PP1DP1_GPU29 -->
<g id="node3696" class="node">
<title>ln2_L13_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="764774,-78 764624,-78 764624,-26 764774,-26 764774,-78"/>
<text text-anchor="middle" x="764699" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="764699" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="764699" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="764699" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L13_EP0TP3PP1DP1_GPU29 -->
<g id="node3697" class="node">
<title>gate_L13_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightyellow" stroke="black" points="765121.53,-104 764874.12,-104 764810.47,0 765057.88,0 765121.53,-104"/>
<text text-anchor="middle" x="764966" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="764966" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="764966" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="764966" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L13_EP0TP3PP1DP1_GPU29 -->
<g id="node3698" class="node">
<title>dispatch_L13_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="765264" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="765264" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="765264" y="-44" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP1_GPU29</text>
</g>
<!-- expert_0_L13_EP0TP3PP1DP1_GPU29 -->
<g id="node3699" class="node">
<title>expert_0_L13_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="765556,-78 765406,-78 765406,-26 765556,-26 765556,-78"/>
<text text-anchor="middle" x="765481" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="765481" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="765481" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="765481" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L13_EP0TP3PP1DP1_GPU29 -->
<g id="node3700" class="node">
<title>expert_1_L13_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="765742,-78 765592,-78 765592,-26 765742,-26 765742,-78"/>
<text text-anchor="middle" x="765667" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="765667" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="765667" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="765667" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L13_EP0TP3PP1DP1_GPU29 -->
<g id="node3701" class="node">
<title>expert_2_L13_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="765928,-78 765778,-78 765778,-26 765928,-26 765928,-78"/>
<text text-anchor="middle" x="765853" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="765853" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="765853" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="765853" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L13_EP0TP3PP1DP1_GPU29 -->
<g id="node3702" class="node">
<title>expert_3_L13_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="766114,-78 765964,-78 765964,-26 766114,-26 766114,-78"/>
<text text-anchor="middle" x="766039" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="766039" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="766039" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="766039" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L13_EP0TP3PP1DP1_GPU29 -->
<g id="node3703" class="node">
<title>combine_L13_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="766256" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="766256" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="766256" y="-44" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP1_GPU29</text>
</g>
<!-- ffn_L13_EP0TP3PP1DP1_GPU29 -->
<g id="node3704" class="node">
<title>ffn_L13_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="766568,-78 766398,-78 766398,-26 766568,-26 766568,-78"/>
<text text-anchor="middle" x="766483" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="766483" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="766483" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="766483" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L13_EP0TP3PP1DP1_GPU29 -->
<g id="node3705" class="node">
<title>ffn_ar_L13_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="766711" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="766711" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="766711" y="-49.5" font-family="Arial" font-size="10.00">L13 EP0 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="766711" y="-38.5" font-family="Arial" font-size="10.00">GPU29</text>
</g>
<!-- residual2_L13_EP0TP3PP1DP1_GPU29 -->
<g id="node3706" class="node">
<title>residual2_L13_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="767004,-78 766854,-78 766854,-26 767004,-26 767004,-78"/>
<text text-anchor="middle" x="766929" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="766929" y="-55" font-family="Arial" font-size="10.00">L13_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="766929" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="766929" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L13_EP1TP0PP1DP0_GPU36 -->
<g id="node3707" class="node">
<title>ln1_L13_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="767190,-78 767040,-78 767040,-26 767190,-26 767190,-78"/>
<text text-anchor="middle" x="767115" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="767115" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="767115" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="767115" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L13_EP1TP0PP1DP0_GPU36 -->
<g id="node3708" class="node">
<title>qkv_L13_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="767376,-78 767226,-78 767226,-26 767376,-26 767376,-78"/>
<text text-anchor="middle" x="767301" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="767301" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="767301" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="767301" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L13_EP1TP0PP1DP0_GPU36 -->
<g id="node3709" class="node">
<title>attn_L13_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="767563.5,-78 767412.5,-78 767412.5,-26 767563.5,-26 767563.5,-78"/>
<text text-anchor="middle" x="767488" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="767488" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="767488" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="767488" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L13_EP1TP0PP1DP0_GPU36 -->
<g id="node3710" class="node">
<title>attn_out_L13_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="767750,-78 767600,-78 767600,-26 767750,-26 767750,-78"/>
<text text-anchor="middle" x="767675" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="767675" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="767675" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="767675" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L13_EP1TP0PP1DP0_GPU36 -->
<g id="node3711" class="node">
<title>attn_ar_L13_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="767893" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="767893" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="767893" y="-49.5" font-family="Arial" font-size="10.00">L13 EP1 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="767893" y="-38.5" font-family="Arial" font-size="10.00">GPU36</text>
</g>
<!-- residual1_L13_EP1TP0PP1DP0_GPU36 -->
<g id="node3712" class="node">
<title>residual1_L13_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="768186,-78 768036,-78 768036,-26 768186,-26 768186,-78"/>
<text text-anchor="middle" x="768111" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="768111" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="768111" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="768111" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L13_EP1TP0PP1DP0_GPU36 -->
<g id="node3713" class="node">
<title>ln2_L13_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="768372,-78 768222,-78 768222,-26 768372,-26 768372,-78"/>
<text text-anchor="middle" x="768297" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="768297" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="768297" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="768297" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L13_EP1TP0PP1DP0_GPU36 -->
<g id="node3714" class="node">
<title>gate_L13_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightyellow" stroke="black" points="768719.53,-104 768472.12,-104 768408.47,0 768655.88,0 768719.53,-104"/>
<text text-anchor="middle" x="768564" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="768564" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="768564" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="768564" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L13_EP1TP0PP1DP0_GPU36 -->
<g id="node3715" class="node">
<title>dispatch_L13_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="768862" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="768862" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="768862" y="-44" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP0_GPU36</text>
</g>
<!-- expert_0_L13_EP1TP0PP1DP0_GPU36 -->
<g id="node3716" class="node">
<title>expert_0_L13_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="769154,-78 769004,-78 769004,-26 769154,-26 769154,-78"/>
<text text-anchor="middle" x="769079" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="769079" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="769079" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="769079" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L13_EP1TP0PP1DP0_GPU36 -->
<g id="node3717" class="node">
<title>expert_1_L13_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="769340,-78 769190,-78 769190,-26 769340,-26 769340,-78"/>
<text text-anchor="middle" x="769265" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="769265" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="769265" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="769265" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L13_EP1TP0PP1DP0_GPU36 -->
<g id="node3718" class="node">
<title>expert_2_L13_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="769526,-78 769376,-78 769376,-26 769526,-26 769526,-78"/>
<text text-anchor="middle" x="769451" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="769451" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="769451" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="769451" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L13_EP1TP0PP1DP0_GPU36 -->
<g id="node3719" class="node">
<title>expert_3_L13_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="769712,-78 769562,-78 769562,-26 769712,-26 769712,-78"/>
<text text-anchor="middle" x="769637" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="769637" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="769637" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="769637" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L13_EP1TP0PP1DP0_GPU36 -->
<g id="node3720" class="node">
<title>combine_L13_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="769854" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="769854" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="769854" y="-44" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP0_GPU36</text>
</g>
<!-- ffn_L13_EP1TP0PP1DP0_GPU36 -->
<g id="node3721" class="node">
<title>ffn_L13_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="770166,-78 769996,-78 769996,-26 770166,-26 770166,-78"/>
<text text-anchor="middle" x="770081" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="770081" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="770081" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="770081" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L13_EP1TP0PP1DP0_GPU36 -->
<g id="node3722" class="node">
<title>ffn_ar_L13_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="770309" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="770309" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="770309" y="-49.5" font-family="Arial" font-size="10.00">L13 EP1 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="770309" y="-38.5" font-family="Arial" font-size="10.00">GPU36</text>
</g>
<!-- residual2_L13_EP1TP0PP1DP0_GPU36 -->
<g id="node3723" class="node">
<title>residual2_L13_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="770602,-78 770452,-78 770452,-26 770602,-26 770602,-78"/>
<text text-anchor="middle" x="770527" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="770527" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="770527" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="770527" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L13_EP1TP0PP1DP1_GPU37 -->
<g id="node3724" class="node">
<title>ln1_L13_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="770788,-78 770638,-78 770638,-26 770788,-26 770788,-78"/>
<text text-anchor="middle" x="770713" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="770713" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="770713" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="770713" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L13_EP1TP0PP1DP1_GPU37 -->
<g id="node3725" class="node">
<title>qkv_L13_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="770974,-78 770824,-78 770824,-26 770974,-26 770974,-78"/>
<text text-anchor="middle" x="770899" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="770899" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="770899" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="770899" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L13_EP1TP0PP1DP1_GPU37 -->
<g id="node3726" class="node">
<title>attn_L13_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="771161.5,-78 771010.5,-78 771010.5,-26 771161.5,-26 771161.5,-78"/>
<text text-anchor="middle" x="771086" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="771086" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="771086" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="771086" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L13_EP1TP0PP1DP1_GPU37 -->
<g id="node3727" class="node">
<title>attn_out_L13_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="771348,-78 771198,-78 771198,-26 771348,-26 771348,-78"/>
<text text-anchor="middle" x="771273" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="771273" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="771273" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="771273" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L13_EP1TP0PP1DP1_GPU37 -->
<g id="node3728" class="node">
<title>attn_ar_L13_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="771491" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="771491" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="771491" y="-49.5" font-family="Arial" font-size="10.00">L13 EP1 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="771491" y="-38.5" font-family="Arial" font-size="10.00">GPU37</text>
</g>
<!-- residual1_L13_EP1TP0PP1DP1_GPU37 -->
<g id="node3729" class="node">
<title>residual1_L13_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="771784,-78 771634,-78 771634,-26 771784,-26 771784,-78"/>
<text text-anchor="middle" x="771709" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="771709" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="771709" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="771709" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L13_EP1TP0PP1DP1_GPU37 -->
<g id="node3730" class="node">
<title>ln2_L13_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="771970,-78 771820,-78 771820,-26 771970,-26 771970,-78"/>
<text text-anchor="middle" x="771895" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="771895" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="771895" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="771895" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L13_EP1TP0PP1DP1_GPU37 -->
<g id="node3731" class="node">
<title>gate_L13_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightyellow" stroke="black" points="772317.53,-104 772070.12,-104 772006.47,0 772253.88,0 772317.53,-104"/>
<text text-anchor="middle" x="772162" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="772162" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="772162" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="772162" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L13_EP1TP0PP1DP1_GPU37 -->
<g id="node3732" class="node">
<title>dispatch_L13_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="772460" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="772460" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="772460" y="-44" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP1_GPU37</text>
</g>
<!-- expert_0_L13_EP1TP0PP1DP1_GPU37 -->
<g id="node3733" class="node">
<title>expert_0_L13_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="772752,-78 772602,-78 772602,-26 772752,-26 772752,-78"/>
<text text-anchor="middle" x="772677" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="772677" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="772677" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="772677" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L13_EP1TP0PP1DP1_GPU37 -->
<g id="node3734" class="node">
<title>expert_1_L13_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="772938,-78 772788,-78 772788,-26 772938,-26 772938,-78"/>
<text text-anchor="middle" x="772863" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="772863" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="772863" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="772863" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L13_EP1TP0PP1DP1_GPU37 -->
<g id="node3735" class="node">
<title>expert_2_L13_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="773124,-78 772974,-78 772974,-26 773124,-26 773124,-78"/>
<text text-anchor="middle" x="773049" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="773049" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="773049" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="773049" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L13_EP1TP0PP1DP1_GPU37 -->
<g id="node3736" class="node">
<title>expert_3_L13_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="773310,-78 773160,-78 773160,-26 773310,-26 773310,-78"/>
<text text-anchor="middle" x="773235" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="773235" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="773235" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="773235" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L13_EP1TP0PP1DP1_GPU37 -->
<g id="node3737" class="node">
<title>combine_L13_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="773452" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="773452" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="773452" y="-44" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP1_GPU37</text>
</g>
<!-- ffn_L13_EP1TP0PP1DP1_GPU37 -->
<g id="node3738" class="node">
<title>ffn_L13_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="773764,-78 773594,-78 773594,-26 773764,-26 773764,-78"/>
<text text-anchor="middle" x="773679" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="773679" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="773679" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="773679" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L13_EP1TP0PP1DP1_GPU37 -->
<g id="node3739" class="node">
<title>ffn_ar_L13_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="773907" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="773907" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="773907" y="-49.5" font-family="Arial" font-size="10.00">L13 EP1 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="773907" y="-38.5" font-family="Arial" font-size="10.00">GPU37</text>
</g>
<!-- residual2_L13_EP1TP0PP1DP1_GPU37 -->
<g id="node3740" class="node">
<title>residual2_L13_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="774200,-78 774050,-78 774050,-26 774200,-26 774200,-78"/>
<text text-anchor="middle" x="774125" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="774125" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="774125" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="774125" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L13_EP1TP1PP1DP0_GPU44 -->
<g id="node3741" class="node">
<title>ln1_L13_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="774386,-78 774236,-78 774236,-26 774386,-26 774386,-78"/>
<text text-anchor="middle" x="774311" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="774311" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="774311" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="774311" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L13_EP1TP1PP1DP0_GPU44 -->
<g id="node3742" class="node">
<title>qkv_L13_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="774572,-78 774422,-78 774422,-26 774572,-26 774572,-78"/>
<text text-anchor="middle" x="774497" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="774497" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="774497" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="774497" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L13_EP1TP1PP1DP0_GPU44 -->
<g id="node3743" class="node">
<title>attn_L13_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="774759.5,-78 774608.5,-78 774608.5,-26 774759.5,-26 774759.5,-78"/>
<text text-anchor="middle" x="774684" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="774684" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="774684" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="774684" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L13_EP1TP1PP1DP0_GPU44 -->
<g id="node3744" class="node">
<title>attn_out_L13_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="774946,-78 774796,-78 774796,-26 774946,-26 774946,-78"/>
<text text-anchor="middle" x="774871" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="774871" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="774871" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="774871" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L13_EP1TP1PP1DP0_GPU44 -->
<g id="node3745" class="node">
<title>attn_ar_L13_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="775089" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="775089" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="775089" y="-49.5" font-family="Arial" font-size="10.00">L13 EP1 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="775089" y="-38.5" font-family="Arial" font-size="10.00">GPU44</text>
</g>
<!-- residual1_L13_EP1TP1PP1DP0_GPU44 -->
<g id="node3746" class="node">
<title>residual1_L13_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="775382,-78 775232,-78 775232,-26 775382,-26 775382,-78"/>
<text text-anchor="middle" x="775307" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="775307" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="775307" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="775307" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L13_EP1TP1PP1DP0_GPU44 -->
<g id="node3747" class="node">
<title>ln2_L13_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="775568,-78 775418,-78 775418,-26 775568,-26 775568,-78"/>
<text text-anchor="middle" x="775493" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="775493" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="775493" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="775493" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L13_EP1TP1PP1DP0_GPU44 -->
<g id="node3748" class="node">
<title>gate_L13_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightyellow" stroke="black" points="775915.53,-104 775668.12,-104 775604.47,0 775851.88,0 775915.53,-104"/>
<text text-anchor="middle" x="775760" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="775760" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="775760" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="775760" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L13_EP1TP1PP1DP0_GPU44 -->
<g id="node3749" class="node">
<title>dispatch_L13_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="776058" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="776058" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="776058" y="-44" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP0_GPU44</text>
</g>
<!-- expert_0_L13_EP1TP1PP1DP0_GPU44 -->
<g id="node3750" class="node">
<title>expert_0_L13_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="776350,-78 776200,-78 776200,-26 776350,-26 776350,-78"/>
<text text-anchor="middle" x="776275" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="776275" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="776275" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="776275" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L13_EP1TP1PP1DP0_GPU44 -->
<g id="node3751" class="node">
<title>expert_1_L13_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="776536,-78 776386,-78 776386,-26 776536,-26 776536,-78"/>
<text text-anchor="middle" x="776461" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="776461" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="776461" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="776461" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L13_EP1TP1PP1DP0_GPU44 -->
<g id="node3752" class="node">
<title>expert_2_L13_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="776722,-78 776572,-78 776572,-26 776722,-26 776722,-78"/>
<text text-anchor="middle" x="776647" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="776647" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="776647" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="776647" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L13_EP1TP1PP1DP0_GPU44 -->
<g id="node3753" class="node">
<title>expert_3_L13_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="776908,-78 776758,-78 776758,-26 776908,-26 776908,-78"/>
<text text-anchor="middle" x="776833" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="776833" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="776833" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="776833" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L13_EP1TP1PP1DP0_GPU44 -->
<g id="node3754" class="node">
<title>combine_L13_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="777050" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="777050" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="777050" y="-44" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP0_GPU44</text>
</g>
<!-- ffn_L13_EP1TP1PP1DP0_GPU44 -->
<g id="node3755" class="node">
<title>ffn_L13_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="777362,-78 777192,-78 777192,-26 777362,-26 777362,-78"/>
<text text-anchor="middle" x="777277" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="777277" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="777277" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="777277" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L13_EP1TP1PP1DP0_GPU44 -->
<g id="node3756" class="node">
<title>ffn_ar_L13_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="777505" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="777505" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="777505" y="-49.5" font-family="Arial" font-size="10.00">L13 EP1 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="777505" y="-38.5" font-family="Arial" font-size="10.00">GPU44</text>
</g>
<!-- residual2_L13_EP1TP1PP1DP0_GPU44 -->
<g id="node3757" class="node">
<title>residual2_L13_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="777798,-78 777648,-78 777648,-26 777798,-26 777798,-78"/>
<text text-anchor="middle" x="777723" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="777723" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="777723" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="777723" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L13_EP1TP1PP1DP1_GPU45 -->
<g id="node3758" class="node">
<title>ln1_L13_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="777984,-78 777834,-78 777834,-26 777984,-26 777984,-78"/>
<text text-anchor="middle" x="777909" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="777909" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="777909" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="777909" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L13_EP1TP1PP1DP1_GPU45 -->
<g id="node3759" class="node">
<title>qkv_L13_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="778170,-78 778020,-78 778020,-26 778170,-26 778170,-78"/>
<text text-anchor="middle" x="778095" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="778095" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="778095" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="778095" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L13_EP1TP1PP1DP1_GPU45 -->
<g id="node3760" class="node">
<title>attn_L13_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="778357.5,-78 778206.5,-78 778206.5,-26 778357.5,-26 778357.5,-78"/>
<text text-anchor="middle" x="778282" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="778282" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="778282" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="778282" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L13_EP1TP1PP1DP1_GPU45 -->
<g id="node3761" class="node">
<title>attn_out_L13_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="778544,-78 778394,-78 778394,-26 778544,-26 778544,-78"/>
<text text-anchor="middle" x="778469" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="778469" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="778469" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="778469" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L13_EP1TP1PP1DP1_GPU45 -->
<g id="node3762" class="node">
<title>attn_ar_L13_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="778687" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="778687" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="778687" y="-49.5" font-family="Arial" font-size="10.00">L13 EP1 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="778687" y="-38.5" font-family="Arial" font-size="10.00">GPU45</text>
</g>
<!-- residual1_L13_EP1TP1PP1DP1_GPU45 -->
<g id="node3763" class="node">
<title>residual1_L13_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="778980,-78 778830,-78 778830,-26 778980,-26 778980,-78"/>
<text text-anchor="middle" x="778905" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="778905" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="778905" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="778905" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L13_EP1TP1PP1DP1_GPU45 -->
<g id="node3764" class="node">
<title>ln2_L13_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="779166,-78 779016,-78 779016,-26 779166,-26 779166,-78"/>
<text text-anchor="middle" x="779091" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="779091" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="779091" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="779091" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L13_EP1TP1PP1DP1_GPU45 -->
<g id="node3765" class="node">
<title>gate_L13_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightyellow" stroke="black" points="779513.53,-104 779266.12,-104 779202.47,0 779449.88,0 779513.53,-104"/>
<text text-anchor="middle" x="779358" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="779358" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="779358" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="779358" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L13_EP1TP1PP1DP1_GPU45 -->
<g id="node3766" class="node">
<title>dispatch_L13_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="779656" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="779656" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="779656" y="-44" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP1_GPU45</text>
</g>
<!-- expert_0_L13_EP1TP1PP1DP1_GPU45 -->
<g id="node3767" class="node">
<title>expert_0_L13_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="779948,-78 779798,-78 779798,-26 779948,-26 779948,-78"/>
<text text-anchor="middle" x="779873" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="779873" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="779873" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="779873" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L13_EP1TP1PP1DP1_GPU45 -->
<g id="node3768" class="node">
<title>expert_1_L13_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="780134,-78 779984,-78 779984,-26 780134,-26 780134,-78"/>
<text text-anchor="middle" x="780059" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="780059" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="780059" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="780059" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L13_EP1TP1PP1DP1_GPU45 -->
<g id="node3769" class="node">
<title>expert_2_L13_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="780320,-78 780170,-78 780170,-26 780320,-26 780320,-78"/>
<text text-anchor="middle" x="780245" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="780245" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="780245" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="780245" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L13_EP1TP1PP1DP1_GPU45 -->
<g id="node3770" class="node">
<title>expert_3_L13_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="780506,-78 780356,-78 780356,-26 780506,-26 780506,-78"/>
<text text-anchor="middle" x="780431" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="780431" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="780431" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="780431" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L13_EP1TP1PP1DP1_GPU45 -->
<g id="node3771" class="node">
<title>combine_L13_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="780648" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="780648" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="780648" y="-44" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP1_GPU45</text>
</g>
<!-- ffn_L13_EP1TP1PP1DP1_GPU45 -->
<g id="node3772" class="node">
<title>ffn_L13_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="780960,-78 780790,-78 780790,-26 780960,-26 780960,-78"/>
<text text-anchor="middle" x="780875" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="780875" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="780875" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="780875" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L13_EP1TP1PP1DP1_GPU45 -->
<g id="node3773" class="node">
<title>ffn_ar_L13_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="781103" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="781103" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="781103" y="-49.5" font-family="Arial" font-size="10.00">L13 EP1 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="781103" y="-38.5" font-family="Arial" font-size="10.00">GPU45</text>
</g>
<!-- residual2_L13_EP1TP1PP1DP1_GPU45 -->
<g id="node3774" class="node">
<title>residual2_L13_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="781396,-78 781246,-78 781246,-26 781396,-26 781396,-78"/>
<text text-anchor="middle" x="781321" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="781321" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="781321" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="781321" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L13_EP1TP2PP1DP0_GPU52 -->
<g id="node3775" class="node">
<title>ln1_L13_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="781582,-78 781432,-78 781432,-26 781582,-26 781582,-78"/>
<text text-anchor="middle" x="781507" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="781507" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="781507" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="781507" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L13_EP1TP2PP1DP0_GPU52 -->
<g id="node3776" class="node">
<title>qkv_L13_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="781768,-78 781618,-78 781618,-26 781768,-26 781768,-78"/>
<text text-anchor="middle" x="781693" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="781693" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="781693" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="781693" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L13_EP1TP2PP1DP0_GPU52 -->
<g id="node3777" class="node">
<title>attn_L13_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="781955.5,-78 781804.5,-78 781804.5,-26 781955.5,-26 781955.5,-78"/>
<text text-anchor="middle" x="781880" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="781880" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="781880" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="781880" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L13_EP1TP2PP1DP0_GPU52 -->
<g id="node3778" class="node">
<title>attn_out_L13_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="782142,-78 781992,-78 781992,-26 782142,-26 782142,-78"/>
<text text-anchor="middle" x="782067" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="782067" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="782067" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="782067" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L13_EP1TP2PP1DP0_GPU52 -->
<g id="node3779" class="node">
<title>attn_ar_L13_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="782285" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="782285" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="782285" y="-49.5" font-family="Arial" font-size="10.00">L13 EP1 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="782285" y="-38.5" font-family="Arial" font-size="10.00">GPU52</text>
</g>
<!-- residual1_L13_EP1TP2PP1DP0_GPU52 -->
<g id="node3780" class="node">
<title>residual1_L13_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="782578,-78 782428,-78 782428,-26 782578,-26 782578,-78"/>
<text text-anchor="middle" x="782503" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="782503" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="782503" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="782503" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L13_EP1TP2PP1DP0_GPU52 -->
<g id="node3781" class="node">
<title>ln2_L13_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="782764,-78 782614,-78 782614,-26 782764,-26 782764,-78"/>
<text text-anchor="middle" x="782689" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="782689" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="782689" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="782689" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L13_EP1TP2PP1DP0_GPU52 -->
<g id="node3782" class="node">
<title>gate_L13_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightyellow" stroke="black" points="783111.53,-104 782864.12,-104 782800.47,0 783047.88,0 783111.53,-104"/>
<text text-anchor="middle" x="782956" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="782956" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="782956" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="782956" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L13_EP1TP2PP1DP0_GPU52 -->
<g id="node3783" class="node">
<title>dispatch_L13_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="783254" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="783254" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="783254" y="-44" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP0_GPU52</text>
</g>
<!-- expert_0_L13_EP1TP2PP1DP0_GPU52 -->
<g id="node3784" class="node">
<title>expert_0_L13_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="783546,-78 783396,-78 783396,-26 783546,-26 783546,-78"/>
<text text-anchor="middle" x="783471" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="783471" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="783471" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="783471" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L13_EP1TP2PP1DP0_GPU52 -->
<g id="node3785" class="node">
<title>expert_1_L13_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="783732,-78 783582,-78 783582,-26 783732,-26 783732,-78"/>
<text text-anchor="middle" x="783657" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="783657" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="783657" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="783657" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L13_EP1TP2PP1DP0_GPU52 -->
<g id="node3786" class="node">
<title>expert_2_L13_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="783918,-78 783768,-78 783768,-26 783918,-26 783918,-78"/>
<text text-anchor="middle" x="783843" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="783843" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="783843" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="783843" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L13_EP1TP2PP1DP0_GPU52 -->
<g id="node3787" class="node">
<title>expert_3_L13_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="784104,-78 783954,-78 783954,-26 784104,-26 784104,-78"/>
<text text-anchor="middle" x="784029" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="784029" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="784029" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="784029" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L13_EP1TP2PP1DP0_GPU52 -->
<g id="node3788" class="node">
<title>combine_L13_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="784246" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="784246" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="784246" y="-44" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP0_GPU52</text>
</g>
<!-- ffn_L13_EP1TP2PP1DP0_GPU52 -->
<g id="node3789" class="node">
<title>ffn_L13_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="784558,-78 784388,-78 784388,-26 784558,-26 784558,-78"/>
<text text-anchor="middle" x="784473" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="784473" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="784473" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="784473" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L13_EP1TP2PP1DP0_GPU52 -->
<g id="node3790" class="node">
<title>ffn_ar_L13_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="784701" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="784701" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="784701" y="-49.5" font-family="Arial" font-size="10.00">L13 EP1 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="784701" y="-38.5" font-family="Arial" font-size="10.00">GPU52</text>
</g>
<!-- residual2_L13_EP1TP2PP1DP0_GPU52 -->
<g id="node3791" class="node">
<title>residual2_L13_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="784994,-78 784844,-78 784844,-26 784994,-26 784994,-78"/>
<text text-anchor="middle" x="784919" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="784919" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="784919" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="784919" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L13_EP1TP2PP1DP1_GPU53 -->
<g id="node3792" class="node">
<title>ln1_L13_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="785180,-78 785030,-78 785030,-26 785180,-26 785180,-78"/>
<text text-anchor="middle" x="785105" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="785105" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="785105" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="785105" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L13_EP1TP2PP1DP1_GPU53 -->
<g id="node3793" class="node">
<title>qkv_L13_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="785366,-78 785216,-78 785216,-26 785366,-26 785366,-78"/>
<text text-anchor="middle" x="785291" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="785291" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="785291" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="785291" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L13_EP1TP2PP1DP1_GPU53 -->
<g id="node3794" class="node">
<title>attn_L13_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="785553.5,-78 785402.5,-78 785402.5,-26 785553.5,-26 785553.5,-78"/>
<text text-anchor="middle" x="785478" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="785478" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="785478" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="785478" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L13_EP1TP2PP1DP1_GPU53 -->
<g id="node3795" class="node">
<title>attn_out_L13_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="785740,-78 785590,-78 785590,-26 785740,-26 785740,-78"/>
<text text-anchor="middle" x="785665" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="785665" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="785665" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="785665" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L13_EP1TP2PP1DP1_GPU53 -->
<g id="node3796" class="node">
<title>attn_ar_L13_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="785883" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="785883" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="785883" y="-49.5" font-family="Arial" font-size="10.00">L13 EP1 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="785883" y="-38.5" font-family="Arial" font-size="10.00">GPU53</text>
</g>
<!-- residual1_L13_EP1TP2PP1DP1_GPU53 -->
<g id="node3797" class="node">
<title>residual1_L13_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="786176,-78 786026,-78 786026,-26 786176,-26 786176,-78"/>
<text text-anchor="middle" x="786101" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="786101" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="786101" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="786101" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L13_EP1TP2PP1DP1_GPU53 -->
<g id="node3798" class="node">
<title>ln2_L13_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="786362,-78 786212,-78 786212,-26 786362,-26 786362,-78"/>
<text text-anchor="middle" x="786287" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="786287" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="786287" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="786287" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L13_EP1TP2PP1DP1_GPU53 -->
<g id="node3799" class="node">
<title>gate_L13_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightyellow" stroke="black" points="786709.53,-104 786462.12,-104 786398.47,0 786645.88,0 786709.53,-104"/>
<text text-anchor="middle" x="786554" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="786554" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="786554" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="786554" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L13_EP1TP2PP1DP1_GPU53 -->
<g id="node3800" class="node">
<title>dispatch_L13_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="786852" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="786852" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="786852" y="-44" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP1_GPU53</text>
</g>
<!-- expert_0_L13_EP1TP2PP1DP1_GPU53 -->
<g id="node3801" class="node">
<title>expert_0_L13_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="787144,-78 786994,-78 786994,-26 787144,-26 787144,-78"/>
<text text-anchor="middle" x="787069" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="787069" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="787069" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="787069" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L13_EP1TP2PP1DP1_GPU53 -->
<g id="node3802" class="node">
<title>expert_1_L13_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="787330,-78 787180,-78 787180,-26 787330,-26 787330,-78"/>
<text text-anchor="middle" x="787255" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="787255" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="787255" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="787255" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L13_EP1TP2PP1DP1_GPU53 -->
<g id="node3803" class="node">
<title>expert_2_L13_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="787516,-78 787366,-78 787366,-26 787516,-26 787516,-78"/>
<text text-anchor="middle" x="787441" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="787441" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="787441" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="787441" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L13_EP1TP2PP1DP1_GPU53 -->
<g id="node3804" class="node">
<title>expert_3_L13_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="787702,-78 787552,-78 787552,-26 787702,-26 787702,-78"/>
<text text-anchor="middle" x="787627" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="787627" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="787627" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="787627" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L13_EP1TP2PP1DP1_GPU53 -->
<g id="node3805" class="node">
<title>combine_L13_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="787844" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="787844" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="787844" y="-44" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP1_GPU53</text>
</g>
<!-- ffn_L13_EP1TP2PP1DP1_GPU53 -->
<g id="node3806" class="node">
<title>ffn_L13_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="788156,-78 787986,-78 787986,-26 788156,-26 788156,-78"/>
<text text-anchor="middle" x="788071" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="788071" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="788071" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="788071" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L13_EP1TP2PP1DP1_GPU53 -->
<g id="node3807" class="node">
<title>ffn_ar_L13_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="788299" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="788299" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="788299" y="-49.5" font-family="Arial" font-size="10.00">L13 EP1 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="788299" y="-38.5" font-family="Arial" font-size="10.00">GPU53</text>
</g>
<!-- residual2_L13_EP1TP2PP1DP1_GPU53 -->
<g id="node3808" class="node">
<title>residual2_L13_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="788592,-78 788442,-78 788442,-26 788592,-26 788592,-78"/>
<text text-anchor="middle" x="788517" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="788517" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="788517" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="788517" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L13_EP1TP3PP1DP0_GPU60 -->
<g id="node3809" class="node">
<title>ln1_L13_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="788778,-78 788628,-78 788628,-26 788778,-26 788778,-78"/>
<text text-anchor="middle" x="788703" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="788703" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="788703" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="788703" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L13_EP1TP3PP1DP0_GPU60 -->
<g id="node3810" class="node">
<title>qkv_L13_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="788964,-78 788814,-78 788814,-26 788964,-26 788964,-78"/>
<text text-anchor="middle" x="788889" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="788889" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="788889" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="788889" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L13_EP1TP3PP1DP0_GPU60 -->
<g id="node3811" class="node">
<title>attn_L13_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="789151.5,-78 789000.5,-78 789000.5,-26 789151.5,-26 789151.5,-78"/>
<text text-anchor="middle" x="789076" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="789076" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="789076" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="789076" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L13_EP1TP3PP1DP0_GPU60 -->
<g id="node3812" class="node">
<title>attn_out_L13_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="789338,-78 789188,-78 789188,-26 789338,-26 789338,-78"/>
<text text-anchor="middle" x="789263" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="789263" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="789263" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="789263" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L13_EP1TP3PP1DP0_GPU60 -->
<g id="node3813" class="node">
<title>attn_ar_L13_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="789481" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="789481" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="789481" y="-49.5" font-family="Arial" font-size="10.00">L13 EP1 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="789481" y="-38.5" font-family="Arial" font-size="10.00">GPU60</text>
</g>
<!-- residual1_L13_EP1TP3PP1DP0_GPU60 -->
<g id="node3814" class="node">
<title>residual1_L13_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="789774,-78 789624,-78 789624,-26 789774,-26 789774,-78"/>
<text text-anchor="middle" x="789699" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="789699" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="789699" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="789699" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L13_EP1TP3PP1DP0_GPU60 -->
<g id="node3815" class="node">
<title>ln2_L13_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="789960,-78 789810,-78 789810,-26 789960,-26 789960,-78"/>
<text text-anchor="middle" x="789885" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="789885" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="789885" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="789885" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L13_EP1TP3PP1DP0_GPU60 -->
<g id="node3816" class="node">
<title>gate_L13_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightyellow" stroke="black" points="790307.53,-104 790060.12,-104 789996.47,0 790243.88,0 790307.53,-104"/>
<text text-anchor="middle" x="790152" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="790152" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="790152" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="790152" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L13_EP1TP3PP1DP0_GPU60 -->
<g id="node3817" class="node">
<title>dispatch_L13_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="790450" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="790450" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="790450" y="-44" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP0_GPU60</text>
</g>
<!-- expert_0_L13_EP1TP3PP1DP0_GPU60 -->
<g id="node3818" class="node">
<title>expert_0_L13_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="790742,-78 790592,-78 790592,-26 790742,-26 790742,-78"/>
<text text-anchor="middle" x="790667" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="790667" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="790667" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="790667" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L13_EP1TP3PP1DP0_GPU60 -->
<g id="node3819" class="node">
<title>expert_1_L13_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="790928,-78 790778,-78 790778,-26 790928,-26 790928,-78"/>
<text text-anchor="middle" x="790853" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="790853" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="790853" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="790853" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L13_EP1TP3PP1DP0_GPU60 -->
<g id="node3820" class="node">
<title>expert_2_L13_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="791114,-78 790964,-78 790964,-26 791114,-26 791114,-78"/>
<text text-anchor="middle" x="791039" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="791039" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="791039" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="791039" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L13_EP1TP3PP1DP0_GPU60 -->
<g id="node3821" class="node">
<title>expert_3_L13_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="791300,-78 791150,-78 791150,-26 791300,-26 791300,-78"/>
<text text-anchor="middle" x="791225" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="791225" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="791225" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="791225" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L13_EP1TP3PP1DP0_GPU60 -->
<g id="node3822" class="node">
<title>combine_L13_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="791442" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="791442" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="791442" y="-44" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP0_GPU60</text>
</g>
<!-- ffn_L13_EP1TP3PP1DP0_GPU60 -->
<g id="node3823" class="node">
<title>ffn_L13_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="791754,-78 791584,-78 791584,-26 791754,-26 791754,-78"/>
<text text-anchor="middle" x="791669" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="791669" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="791669" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="791669" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L13_EP1TP3PP1DP0_GPU60 -->
<g id="node3824" class="node">
<title>ffn_ar_L13_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="791897" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="791897" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="791897" y="-49.5" font-family="Arial" font-size="10.00">L13 EP1 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="791897" y="-38.5" font-family="Arial" font-size="10.00">GPU60</text>
</g>
<!-- residual2_L13_EP1TP3PP1DP0_GPU60 -->
<g id="node3825" class="node">
<title>residual2_L13_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="792190,-78 792040,-78 792040,-26 792190,-26 792190,-78"/>
<text text-anchor="middle" x="792115" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="792115" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="792115" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="792115" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L13_EP1TP3PP1DP1_GPU61 -->
<g id="node3826" class="node">
<title>ln1_L13_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="792376,-78 792226,-78 792226,-26 792376,-26 792376,-78"/>
<text text-anchor="middle" x="792301" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="792301" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="792301" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="792301" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L13_EP1TP3PP1DP1_GPU61 -->
<g id="node3827" class="node">
<title>qkv_L13_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="792562,-78 792412,-78 792412,-26 792562,-26 792562,-78"/>
<text text-anchor="middle" x="792487" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="792487" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="792487" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="792487" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L13_EP1TP3PP1DP1_GPU61 -->
<g id="node3828" class="node">
<title>attn_L13_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="792749.5,-78 792598.5,-78 792598.5,-26 792749.5,-26 792749.5,-78"/>
<text text-anchor="middle" x="792674" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="792674" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="792674" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="792674" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L13_EP1TP3PP1DP1_GPU61 -->
<g id="node3829" class="node">
<title>attn_out_L13_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="792936,-78 792786,-78 792786,-26 792936,-26 792936,-78"/>
<text text-anchor="middle" x="792861" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="792861" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="792861" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="792861" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L13_EP1TP3PP1DP1_GPU61 -->
<g id="node3830" class="node">
<title>attn_ar_L13_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="793079" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="793079" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="793079" y="-49.5" font-family="Arial" font-size="10.00">L13 EP1 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="793079" y="-38.5" font-family="Arial" font-size="10.00">GPU61</text>
</g>
<!-- residual1_L13_EP1TP3PP1DP1_GPU61 -->
<g id="node3831" class="node">
<title>residual1_L13_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="793372,-78 793222,-78 793222,-26 793372,-26 793372,-78"/>
<text text-anchor="middle" x="793297" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="793297" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="793297" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="793297" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L13_EP1TP3PP1DP1_GPU61 -->
<g id="node3832" class="node">
<title>ln2_L13_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="793558,-78 793408,-78 793408,-26 793558,-26 793558,-78"/>
<text text-anchor="middle" x="793483" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="793483" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="793483" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="793483" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L13_EP1TP3PP1DP1_GPU61 -->
<g id="node3833" class="node">
<title>gate_L13_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightyellow" stroke="black" points="793905.53,-104 793658.12,-104 793594.47,0 793841.88,0 793905.53,-104"/>
<text text-anchor="middle" x="793750" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="793750" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="793750" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="793750" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L13_EP1TP3PP1DP1_GPU61 -->
<g id="node3834" class="node">
<title>dispatch_L13_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="794048" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="794048" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="794048" y="-44" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP1_GPU61</text>
</g>
<!-- expert_0_L13_EP1TP3PP1DP1_GPU61 -->
<g id="node3835" class="node">
<title>expert_0_L13_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="794340,-78 794190,-78 794190,-26 794340,-26 794340,-78"/>
<text text-anchor="middle" x="794265" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="794265" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="794265" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="794265" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L13_EP1TP3PP1DP1_GPU61 -->
<g id="node3836" class="node">
<title>expert_1_L13_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="794526,-78 794376,-78 794376,-26 794526,-26 794526,-78"/>
<text text-anchor="middle" x="794451" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="794451" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="794451" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="794451" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L13_EP1TP3PP1DP1_GPU61 -->
<g id="node3837" class="node">
<title>expert_2_L13_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="794712,-78 794562,-78 794562,-26 794712,-26 794712,-78"/>
<text text-anchor="middle" x="794637" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="794637" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="794637" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="794637" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L13_EP1TP3PP1DP1_GPU61 -->
<g id="node3838" class="node">
<title>expert_3_L13_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="794898,-78 794748,-78 794748,-26 794898,-26 794898,-78"/>
<text text-anchor="middle" x="794823" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="794823" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="794823" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="794823" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L13_EP1TP3PP1DP1_GPU61 -->
<g id="node3839" class="node">
<title>combine_L13_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="795040" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="795040" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="795040" y="-44" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP1_GPU61</text>
</g>
<!-- ffn_L13_EP1TP3PP1DP1_GPU61 -->
<g id="node3840" class="node">
<title>ffn_L13_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="795352,-78 795182,-78 795182,-26 795352,-26 795352,-78"/>
<text text-anchor="middle" x="795267" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="795267" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="795267" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="795267" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L13_EP1TP3PP1DP1_GPU61 -->
<g id="node3841" class="node">
<title>ffn_ar_L13_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="795495" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="795495" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="795495" y="-49.5" font-family="Arial" font-size="10.00">L13 EP1 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="795495" y="-38.5" font-family="Arial" font-size="10.00">GPU61</text>
</g>
<!-- residual2_L13_EP1TP3PP1DP1_GPU61 -->
<g id="node3842" class="node">
<title>residual2_L13_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="795788,-78 795638,-78 795638,-26 795788,-26 795788,-78"/>
<text text-anchor="middle" x="795713" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="795713" y="-55" font-family="Arial" font-size="10.00">L13_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="795713" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="795713" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L14_EP0TP0PP1DP0_GPU4 -->
<g id="node3843" class="node">
<title>ln1_L14_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="795969.5,-78 795824.5,-78 795824.5,-26 795969.5,-26 795969.5,-78"/>
<text text-anchor="middle" x="795897" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="795897" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="795897" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="795897" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L14_EP0TP0PP1DP0_GPU4 -->
<g id="node3844" class="node">
<title>qkv_L14_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="796150.5,-78 796005.5,-78 796005.5,-26 796150.5,-26 796150.5,-78"/>
<text text-anchor="middle" x="796078" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="796078" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="796078" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="796078" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L14_EP0TP0PP1DP0_GPU4 -->
<g id="node3845" class="node">
<title>attn_L14_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="796337.5,-78 796186.5,-78 796186.5,-26 796337.5,-26 796337.5,-78"/>
<text text-anchor="middle" x="796262" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="796262" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="796262" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="796262" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L14_EP0TP0PP1DP0_GPU4 -->
<g id="node3846" class="node">
<title>attn_out_L14_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="796518.5,-78 796373.5,-78 796373.5,-26 796518.5,-26 796518.5,-78"/>
<text text-anchor="middle" x="796446" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="796446" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="796446" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="796446" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L14_EP0TP0PP1DP0_GPU4 -->
<g id="node3847" class="node">
<title>attn_ar_L14_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="796661" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="796661" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="796661" y="-49.5" font-family="Arial" font-size="10.00">L14 EP0 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="796661" y="-38.5" font-family="Arial" font-size="10.00">GPU4</text>
</g>
<!-- residual1_L14_EP0TP0PP1DP0_GPU4 -->
<g id="node3848" class="node">
<title>residual1_L14_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="796950,-78 796804,-78 796804,-26 796950,-26 796950,-78"/>
<text text-anchor="middle" x="796877" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="796877" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="796877" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="796877" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L14_EP0TP0PP1DP0_GPU4 -->
<g id="node3849" class="node">
<title>ln2_L14_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="797131.5,-78 796986.5,-78 796986.5,-26 797131.5,-26 797131.5,-78"/>
<text text-anchor="middle" x="797059" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="797059" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="797059" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="797059" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L14_EP0TP0PP1DP0_GPU4 -->
<g id="node3850" class="node">
<title>gate_L14_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightyellow" stroke="black" points="797468.16,-104 797229.29,-104 797167.84,0 797406.71,0 797468.16,-104"/>
<text text-anchor="middle" x="797318" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="797318" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="797318" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="797318" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L14_EP0TP0PP1DP0_GPU4 -->
<g id="node3851" class="node">
<title>dispatch_L14_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="797607" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="797607" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="797607" y="-44" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP0_GPU4</text>
</g>
<!-- expert_0_L14_EP0TP0PP1DP0_GPU4 -->
<g id="node3852" class="node">
<title>expert_0_L14_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="797890.5,-78 797745.5,-78 797745.5,-26 797890.5,-26 797890.5,-78"/>
<text text-anchor="middle" x="797818" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="797818" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="797818" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="797818" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L14_EP0TP0PP1DP0_GPU4 -->
<g id="node3853" class="node">
<title>expert_1_L14_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="798071.5,-78 797926.5,-78 797926.5,-26 798071.5,-26 798071.5,-78"/>
<text text-anchor="middle" x="797999" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="797999" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="797999" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="797999" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L14_EP0TP0PP1DP0_GPU4 -->
<g id="node3854" class="node">
<title>expert_2_L14_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="798252.5,-78 798107.5,-78 798107.5,-26 798252.5,-26 798252.5,-78"/>
<text text-anchor="middle" x="798180" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="798180" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="798180" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="798180" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L14_EP0TP0PP1DP0_GPU4 -->
<g id="node3855" class="node">
<title>expert_3_L14_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="798433.5,-78 798288.5,-78 798288.5,-26 798433.5,-26 798433.5,-78"/>
<text text-anchor="middle" x="798361" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="798361" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="798361" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="798361" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L14_EP0TP0PP1DP0_GPU4 -->
<g id="node3856" class="node">
<title>combine_L14_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="798572" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="798572" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="798572" y="-44" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP0_GPU4</text>
</g>
<!-- ffn_L14_EP0TP0PP1DP0_GPU4 -->
<g id="node3857" class="node">
<title>ffn_L14_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="798881,-78 798711,-78 798711,-26 798881,-26 798881,-78"/>
<text text-anchor="middle" x="798796" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="798796" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="798796" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="798796" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L14_EP0TP0PP1DP0_GPU4 -->
<g id="node3858" class="node">
<title>ffn_ar_L14_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="799024" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="799024" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="799024" y="-49.5" font-family="Arial" font-size="10.00">L14 EP0 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="799024" y="-38.5" font-family="Arial" font-size="10.00">GPU4</text>
</g>
<!-- residual2_L14_EP0TP0PP1DP0_GPU4 -->
<g id="node3859" class="node">
<title>residual2_L14_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="799313,-78 799167,-78 799167,-26 799313,-26 799313,-78"/>
<text text-anchor="middle" x="799240" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="799240" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="799240" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="799240" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L14_EP0TP0PP1DP1_GPU5 -->
<g id="node3860" class="node">
<title>ln1_L14_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="799494.5,-78 799349.5,-78 799349.5,-26 799494.5,-26 799494.5,-78"/>
<text text-anchor="middle" x="799422" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="799422" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="799422" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="799422" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L14_EP0TP0PP1DP1_GPU5 -->
<g id="node3861" class="node">
<title>qkv_L14_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="799675.5,-78 799530.5,-78 799530.5,-26 799675.5,-26 799675.5,-78"/>
<text text-anchor="middle" x="799603" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="799603" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="799603" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="799603" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L14_EP0TP0PP1DP1_GPU5 -->
<g id="node3862" class="node">
<title>attn_L14_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="799862.5,-78 799711.5,-78 799711.5,-26 799862.5,-26 799862.5,-78"/>
<text text-anchor="middle" x="799787" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="799787" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="799787" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="799787" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L14_EP0TP0PP1DP1_GPU5 -->
<g id="node3863" class="node">
<title>attn_out_L14_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="800043.5,-78 799898.5,-78 799898.5,-26 800043.5,-26 800043.5,-78"/>
<text text-anchor="middle" x="799971" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="799971" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="799971" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="799971" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L14_EP0TP0PP1DP1_GPU5 -->
<g id="node3864" class="node">
<title>attn_ar_L14_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="800186" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="800186" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="800186" y="-49.5" font-family="Arial" font-size="10.00">L14 EP0 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="800186" y="-38.5" font-family="Arial" font-size="10.00">GPU5</text>
</g>
<!-- residual1_L14_EP0TP0PP1DP1_GPU5 -->
<g id="node3865" class="node">
<title>residual1_L14_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="800475,-78 800329,-78 800329,-26 800475,-26 800475,-78"/>
<text text-anchor="middle" x="800402" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="800402" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="800402" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="800402" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L14_EP0TP0PP1DP1_GPU5 -->
<g id="node3866" class="node">
<title>ln2_L14_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="800656.5,-78 800511.5,-78 800511.5,-26 800656.5,-26 800656.5,-78"/>
<text text-anchor="middle" x="800584" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="800584" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="800584" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="800584" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L14_EP0TP0PP1DP1_GPU5 -->
<g id="node3867" class="node">
<title>gate_L14_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightyellow" stroke="black" points="800993.16,-104 800754.29,-104 800692.84,0 800931.71,0 800993.16,-104"/>
<text text-anchor="middle" x="800843" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="800843" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="800843" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="800843" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L14_EP0TP0PP1DP1_GPU5 -->
<g id="node3868" class="node">
<title>dispatch_L14_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="801132" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="801132" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="801132" y="-44" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP1_GPU5</text>
</g>
<!-- expert_0_L14_EP0TP0PP1DP1_GPU5 -->
<g id="node3869" class="node">
<title>expert_0_L14_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="801415.5,-78 801270.5,-78 801270.5,-26 801415.5,-26 801415.5,-78"/>
<text text-anchor="middle" x="801343" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="801343" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="801343" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="801343" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L14_EP0TP0PP1DP1_GPU5 -->
<g id="node3870" class="node">
<title>expert_1_L14_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="801596.5,-78 801451.5,-78 801451.5,-26 801596.5,-26 801596.5,-78"/>
<text text-anchor="middle" x="801524" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="801524" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="801524" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="801524" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L14_EP0TP0PP1DP1_GPU5 -->
<g id="node3871" class="node">
<title>expert_2_L14_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="801777.5,-78 801632.5,-78 801632.5,-26 801777.5,-26 801777.5,-78"/>
<text text-anchor="middle" x="801705" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="801705" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="801705" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="801705" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L14_EP0TP0PP1DP1_GPU5 -->
<g id="node3872" class="node">
<title>expert_3_L14_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="801958.5,-78 801813.5,-78 801813.5,-26 801958.5,-26 801958.5,-78"/>
<text text-anchor="middle" x="801886" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="801886" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="801886" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="801886" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L14_EP0TP0PP1DP1_GPU5 -->
<g id="node3873" class="node">
<title>combine_L14_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="802097" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="802097" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="802097" y="-44" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP1_GPU5</text>
</g>
<!-- ffn_L14_EP0TP0PP1DP1_GPU5 -->
<g id="node3874" class="node">
<title>ffn_L14_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="802406,-78 802236,-78 802236,-26 802406,-26 802406,-78"/>
<text text-anchor="middle" x="802321" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="802321" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="802321" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="802321" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L14_EP0TP0PP1DP1_GPU5 -->
<g id="node3875" class="node">
<title>ffn_ar_L14_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="802549" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="802549" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="802549" y="-49.5" font-family="Arial" font-size="10.00">L14 EP0 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="802549" y="-38.5" font-family="Arial" font-size="10.00">GPU5</text>
</g>
<!-- residual2_L14_EP0TP0PP1DP1_GPU5 -->
<g id="node3876" class="node">
<title>residual2_L14_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="802838,-78 802692,-78 802692,-26 802838,-26 802838,-78"/>
<text text-anchor="middle" x="802765" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="802765" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="802765" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="802765" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L14_EP0TP1PP1DP0_GPU12 -->
<g id="node3877" class="node">
<title>ln1_L14_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="803024,-78 802874,-78 802874,-26 803024,-26 803024,-78"/>
<text text-anchor="middle" x="802949" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="802949" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="802949" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="802949" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L14_EP0TP1PP1DP0_GPU12 -->
<g id="node3878" class="node">
<title>qkv_L14_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="803210,-78 803060,-78 803060,-26 803210,-26 803210,-78"/>
<text text-anchor="middle" x="803135" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="803135" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="803135" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="803135" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L14_EP0TP1PP1DP0_GPU12 -->
<g id="node3879" class="node">
<title>attn_L14_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="803397.5,-78 803246.5,-78 803246.5,-26 803397.5,-26 803397.5,-78"/>
<text text-anchor="middle" x="803322" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="803322" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="803322" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="803322" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L14_EP0TP1PP1DP0_GPU12 -->
<g id="node3880" class="node">
<title>attn_out_L14_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="803584,-78 803434,-78 803434,-26 803584,-26 803584,-78"/>
<text text-anchor="middle" x="803509" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="803509" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="803509" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="803509" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L14_EP0TP1PP1DP0_GPU12 -->
<g id="node3881" class="node">
<title>attn_ar_L14_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="803727" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="803727" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="803727" y="-49.5" font-family="Arial" font-size="10.00">L14 EP0 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="803727" y="-38.5" font-family="Arial" font-size="10.00">GPU12</text>
</g>
<!-- residual1_L14_EP0TP1PP1DP0_GPU12 -->
<g id="node3882" class="node">
<title>residual1_L14_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="804020,-78 803870,-78 803870,-26 804020,-26 804020,-78"/>
<text text-anchor="middle" x="803945" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="803945" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="803945" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="803945" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L14_EP0TP1PP1DP0_GPU12 -->
<g id="node3883" class="node">
<title>ln2_L14_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="804206,-78 804056,-78 804056,-26 804206,-26 804206,-78"/>
<text text-anchor="middle" x="804131" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="804131" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="804131" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="804131" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L14_EP0TP1PP1DP0_GPU12 -->
<g id="node3884" class="node">
<title>gate_L14_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightyellow" stroke="black" points="804553.53,-104 804306.12,-104 804242.47,0 804489.88,0 804553.53,-104"/>
<text text-anchor="middle" x="804398" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="804398" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="804398" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="804398" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L14_EP0TP1PP1DP0_GPU12 -->
<g id="node3885" class="node">
<title>dispatch_L14_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="804696" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="804696" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="804696" y="-44" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP0_GPU12</text>
</g>
<!-- expert_0_L14_EP0TP1PP1DP0_GPU12 -->
<g id="node3886" class="node">
<title>expert_0_L14_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="804988,-78 804838,-78 804838,-26 804988,-26 804988,-78"/>
<text text-anchor="middle" x="804913" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="804913" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="804913" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="804913" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L14_EP0TP1PP1DP0_GPU12 -->
<g id="node3887" class="node">
<title>expert_1_L14_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="805174,-78 805024,-78 805024,-26 805174,-26 805174,-78"/>
<text text-anchor="middle" x="805099" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="805099" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="805099" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="805099" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L14_EP0TP1PP1DP0_GPU12 -->
<g id="node3888" class="node">
<title>expert_2_L14_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="805360,-78 805210,-78 805210,-26 805360,-26 805360,-78"/>
<text text-anchor="middle" x="805285" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="805285" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="805285" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="805285" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L14_EP0TP1PP1DP0_GPU12 -->
<g id="node3889" class="node">
<title>expert_3_L14_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="805546,-78 805396,-78 805396,-26 805546,-26 805546,-78"/>
<text text-anchor="middle" x="805471" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="805471" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="805471" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="805471" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L14_EP0TP1PP1DP0_GPU12 -->
<g id="node3890" class="node">
<title>combine_L14_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="805688" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="805688" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="805688" y="-44" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP0_GPU12</text>
</g>
<!-- ffn_L14_EP0TP1PP1DP0_GPU12 -->
<g id="node3891" class="node">
<title>ffn_L14_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="806000,-78 805830,-78 805830,-26 806000,-26 806000,-78"/>
<text text-anchor="middle" x="805915" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="805915" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="805915" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="805915" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L14_EP0TP1PP1DP0_GPU12 -->
<g id="node3892" class="node">
<title>ffn_ar_L14_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="806143" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="806143" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="806143" y="-49.5" font-family="Arial" font-size="10.00">L14 EP0 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="806143" y="-38.5" font-family="Arial" font-size="10.00">GPU12</text>
</g>
<!-- residual2_L14_EP0TP1PP1DP0_GPU12 -->
<g id="node3893" class="node">
<title>residual2_L14_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="806436,-78 806286,-78 806286,-26 806436,-26 806436,-78"/>
<text text-anchor="middle" x="806361" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="806361" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="806361" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="806361" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L14_EP0TP1PP1DP1_GPU13 -->
<g id="node3894" class="node">
<title>ln1_L14_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="806622,-78 806472,-78 806472,-26 806622,-26 806622,-78"/>
<text text-anchor="middle" x="806547" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="806547" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="806547" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="806547" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L14_EP0TP1PP1DP1_GPU13 -->
<g id="node3895" class="node">
<title>qkv_L14_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="806808,-78 806658,-78 806658,-26 806808,-26 806808,-78"/>
<text text-anchor="middle" x="806733" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="806733" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="806733" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="806733" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L14_EP0TP1PP1DP1_GPU13 -->
<g id="node3896" class="node">
<title>attn_L14_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="806995.5,-78 806844.5,-78 806844.5,-26 806995.5,-26 806995.5,-78"/>
<text text-anchor="middle" x="806920" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="806920" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="806920" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="806920" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L14_EP0TP1PP1DP1_GPU13 -->
<g id="node3897" class="node">
<title>attn_out_L14_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="807182,-78 807032,-78 807032,-26 807182,-26 807182,-78"/>
<text text-anchor="middle" x="807107" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="807107" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="807107" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="807107" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L14_EP0TP1PP1DP1_GPU13 -->
<g id="node3898" class="node">
<title>attn_ar_L14_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="807325" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="807325" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="807325" y="-49.5" font-family="Arial" font-size="10.00">L14 EP0 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="807325" y="-38.5" font-family="Arial" font-size="10.00">GPU13</text>
</g>
<!-- residual1_L14_EP0TP1PP1DP1_GPU13 -->
<g id="node3899" class="node">
<title>residual1_L14_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="807618,-78 807468,-78 807468,-26 807618,-26 807618,-78"/>
<text text-anchor="middle" x="807543" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="807543" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="807543" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="807543" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L14_EP0TP1PP1DP1_GPU13 -->
<g id="node3900" class="node">
<title>ln2_L14_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="807804,-78 807654,-78 807654,-26 807804,-26 807804,-78"/>
<text text-anchor="middle" x="807729" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="807729" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="807729" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="807729" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L14_EP0TP1PP1DP1_GPU13 -->
<g id="node3901" class="node">
<title>gate_L14_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightyellow" stroke="black" points="808151.53,-104 807904.12,-104 807840.47,0 808087.88,0 808151.53,-104"/>
<text text-anchor="middle" x="807996" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="807996" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="807996" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="807996" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L14_EP0TP1PP1DP1_GPU13 -->
<g id="node3902" class="node">
<title>dispatch_L14_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="808294" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="808294" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="808294" y="-44" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP1_GPU13</text>
</g>
<!-- expert_0_L14_EP0TP1PP1DP1_GPU13 -->
<g id="node3903" class="node">
<title>expert_0_L14_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="808586,-78 808436,-78 808436,-26 808586,-26 808586,-78"/>
<text text-anchor="middle" x="808511" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="808511" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="808511" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="808511" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L14_EP0TP1PP1DP1_GPU13 -->
<g id="node3904" class="node">
<title>expert_1_L14_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="808772,-78 808622,-78 808622,-26 808772,-26 808772,-78"/>
<text text-anchor="middle" x="808697" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="808697" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="808697" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="808697" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L14_EP0TP1PP1DP1_GPU13 -->
<g id="node3905" class="node">
<title>expert_2_L14_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="808958,-78 808808,-78 808808,-26 808958,-26 808958,-78"/>
<text text-anchor="middle" x="808883" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="808883" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="808883" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="808883" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L14_EP0TP1PP1DP1_GPU13 -->
<g id="node3906" class="node">
<title>expert_3_L14_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="809144,-78 808994,-78 808994,-26 809144,-26 809144,-78"/>
<text text-anchor="middle" x="809069" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="809069" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="809069" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="809069" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L14_EP0TP1PP1DP1_GPU13 -->
<g id="node3907" class="node">
<title>combine_L14_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="809286" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="809286" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="809286" y="-44" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP1_GPU13</text>
</g>
<!-- ffn_L14_EP0TP1PP1DP1_GPU13 -->
<g id="node3908" class="node">
<title>ffn_L14_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="809598,-78 809428,-78 809428,-26 809598,-26 809598,-78"/>
<text text-anchor="middle" x="809513" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="809513" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="809513" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="809513" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L14_EP0TP1PP1DP1_GPU13 -->
<g id="node3909" class="node">
<title>ffn_ar_L14_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="809741" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="809741" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="809741" y="-49.5" font-family="Arial" font-size="10.00">L14 EP0 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="809741" y="-38.5" font-family="Arial" font-size="10.00">GPU13</text>
</g>
<!-- residual2_L14_EP0TP1PP1DP1_GPU13 -->
<g id="node3910" class="node">
<title>residual2_L14_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="810034,-78 809884,-78 809884,-26 810034,-26 810034,-78"/>
<text text-anchor="middle" x="809959" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="809959" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="809959" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="809959" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L14_EP0TP2PP1DP0_GPU20 -->
<g id="node3911" class="node">
<title>ln1_L14_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="810220,-78 810070,-78 810070,-26 810220,-26 810220,-78"/>
<text text-anchor="middle" x="810145" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="810145" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="810145" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="810145" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L14_EP0TP2PP1DP0_GPU20 -->
<g id="node3912" class="node">
<title>qkv_L14_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="810406,-78 810256,-78 810256,-26 810406,-26 810406,-78"/>
<text text-anchor="middle" x="810331" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="810331" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="810331" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="810331" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L14_EP0TP2PP1DP0_GPU20 -->
<g id="node3913" class="node">
<title>attn_L14_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="810593.5,-78 810442.5,-78 810442.5,-26 810593.5,-26 810593.5,-78"/>
<text text-anchor="middle" x="810518" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="810518" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="810518" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="810518" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L14_EP0TP2PP1DP0_GPU20 -->
<g id="node3914" class="node">
<title>attn_out_L14_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="810780,-78 810630,-78 810630,-26 810780,-26 810780,-78"/>
<text text-anchor="middle" x="810705" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="810705" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="810705" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="810705" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L14_EP0TP2PP1DP0_GPU20 -->
<g id="node3915" class="node">
<title>attn_ar_L14_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="810923" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="810923" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="810923" y="-49.5" font-family="Arial" font-size="10.00">L14 EP0 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="810923" y="-38.5" font-family="Arial" font-size="10.00">GPU20</text>
</g>
<!-- residual1_L14_EP0TP2PP1DP0_GPU20 -->
<g id="node3916" class="node">
<title>residual1_L14_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="811216,-78 811066,-78 811066,-26 811216,-26 811216,-78"/>
<text text-anchor="middle" x="811141" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="811141" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="811141" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="811141" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L14_EP0TP2PP1DP0_GPU20 -->
<g id="node3917" class="node">
<title>ln2_L14_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="811402,-78 811252,-78 811252,-26 811402,-26 811402,-78"/>
<text text-anchor="middle" x="811327" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="811327" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="811327" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="811327" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L14_EP0TP2PP1DP0_GPU20 -->
<g id="node3918" class="node">
<title>gate_L14_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightyellow" stroke="black" points="811749.53,-104 811502.12,-104 811438.47,0 811685.88,0 811749.53,-104"/>
<text text-anchor="middle" x="811594" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="811594" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="811594" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="811594" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L14_EP0TP2PP1DP0_GPU20 -->
<g id="node3919" class="node">
<title>dispatch_L14_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="811892" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="811892" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="811892" y="-44" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP0_GPU20</text>
</g>
<!-- expert_0_L14_EP0TP2PP1DP0_GPU20 -->
<g id="node3920" class="node">
<title>expert_0_L14_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="812184,-78 812034,-78 812034,-26 812184,-26 812184,-78"/>
<text text-anchor="middle" x="812109" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="812109" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="812109" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="812109" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L14_EP0TP2PP1DP0_GPU20 -->
<g id="node3921" class="node">
<title>expert_1_L14_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="812370,-78 812220,-78 812220,-26 812370,-26 812370,-78"/>
<text text-anchor="middle" x="812295" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="812295" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="812295" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="812295" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L14_EP0TP2PP1DP0_GPU20 -->
<g id="node3922" class="node">
<title>expert_2_L14_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="812556,-78 812406,-78 812406,-26 812556,-26 812556,-78"/>
<text text-anchor="middle" x="812481" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="812481" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="812481" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="812481" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L14_EP0TP2PP1DP0_GPU20 -->
<g id="node3923" class="node">
<title>expert_3_L14_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="812742,-78 812592,-78 812592,-26 812742,-26 812742,-78"/>
<text text-anchor="middle" x="812667" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="812667" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="812667" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="812667" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L14_EP0TP2PP1DP0_GPU20 -->
<g id="node3924" class="node">
<title>combine_L14_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="812884" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="812884" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="812884" y="-44" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP0_GPU20</text>
</g>
<!-- ffn_L14_EP0TP2PP1DP0_GPU20 -->
<g id="node3925" class="node">
<title>ffn_L14_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="813196,-78 813026,-78 813026,-26 813196,-26 813196,-78"/>
<text text-anchor="middle" x="813111" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="813111" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="813111" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="813111" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L14_EP0TP2PP1DP0_GPU20 -->
<g id="node3926" class="node">
<title>ffn_ar_L14_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="813339" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="813339" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="813339" y="-49.5" font-family="Arial" font-size="10.00">L14 EP0 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="813339" y="-38.5" font-family="Arial" font-size="10.00">GPU20</text>
</g>
<!-- residual2_L14_EP0TP2PP1DP0_GPU20 -->
<g id="node3927" class="node">
<title>residual2_L14_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="813632,-78 813482,-78 813482,-26 813632,-26 813632,-78"/>
<text text-anchor="middle" x="813557" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="813557" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="813557" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="813557" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L14_EP0TP2PP1DP1_GPU21 -->
<g id="node3928" class="node">
<title>ln1_L14_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="813818,-78 813668,-78 813668,-26 813818,-26 813818,-78"/>
<text text-anchor="middle" x="813743" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="813743" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="813743" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="813743" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L14_EP0TP2PP1DP1_GPU21 -->
<g id="node3929" class="node">
<title>qkv_L14_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="814004,-78 813854,-78 813854,-26 814004,-26 814004,-78"/>
<text text-anchor="middle" x="813929" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="813929" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="813929" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="813929" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L14_EP0TP2PP1DP1_GPU21 -->
<g id="node3930" class="node">
<title>attn_L14_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="814191.5,-78 814040.5,-78 814040.5,-26 814191.5,-26 814191.5,-78"/>
<text text-anchor="middle" x="814116" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="814116" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="814116" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="814116" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L14_EP0TP2PP1DP1_GPU21 -->
<g id="node3931" class="node">
<title>attn_out_L14_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="814378,-78 814228,-78 814228,-26 814378,-26 814378,-78"/>
<text text-anchor="middle" x="814303" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="814303" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="814303" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="814303" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L14_EP0TP2PP1DP1_GPU21 -->
<g id="node3932" class="node">
<title>attn_ar_L14_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="814521" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="814521" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="814521" y="-49.5" font-family="Arial" font-size="10.00">L14 EP0 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="814521" y="-38.5" font-family="Arial" font-size="10.00">GPU21</text>
</g>
<!-- residual1_L14_EP0TP2PP1DP1_GPU21 -->
<g id="node3933" class="node">
<title>residual1_L14_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="814814,-78 814664,-78 814664,-26 814814,-26 814814,-78"/>
<text text-anchor="middle" x="814739" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="814739" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="814739" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="814739" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L14_EP0TP2PP1DP1_GPU21 -->
<g id="node3934" class="node">
<title>ln2_L14_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="815000,-78 814850,-78 814850,-26 815000,-26 815000,-78"/>
<text text-anchor="middle" x="814925" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="814925" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="814925" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="814925" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L14_EP0TP2PP1DP1_GPU21 -->
<g id="node3935" class="node">
<title>gate_L14_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightyellow" stroke="black" points="815347.53,-104 815100.12,-104 815036.47,0 815283.88,0 815347.53,-104"/>
<text text-anchor="middle" x="815192" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="815192" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="815192" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="815192" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L14_EP0TP2PP1DP1_GPU21 -->
<g id="node3936" class="node">
<title>dispatch_L14_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="815490" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="815490" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="815490" y="-44" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP1_GPU21</text>
</g>
<!-- expert_0_L14_EP0TP2PP1DP1_GPU21 -->
<g id="node3937" class="node">
<title>expert_0_L14_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="815782,-78 815632,-78 815632,-26 815782,-26 815782,-78"/>
<text text-anchor="middle" x="815707" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="815707" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="815707" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="815707" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L14_EP0TP2PP1DP1_GPU21 -->
<g id="node3938" class="node">
<title>expert_1_L14_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="815968,-78 815818,-78 815818,-26 815968,-26 815968,-78"/>
<text text-anchor="middle" x="815893" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="815893" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="815893" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="815893" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L14_EP0TP2PP1DP1_GPU21 -->
<g id="node3939" class="node">
<title>expert_2_L14_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="816154,-78 816004,-78 816004,-26 816154,-26 816154,-78"/>
<text text-anchor="middle" x="816079" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="816079" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="816079" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="816079" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L14_EP0TP2PP1DP1_GPU21 -->
<g id="node3940" class="node">
<title>expert_3_L14_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="816340,-78 816190,-78 816190,-26 816340,-26 816340,-78"/>
<text text-anchor="middle" x="816265" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="816265" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="816265" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="816265" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L14_EP0TP2PP1DP1_GPU21 -->
<g id="node3941" class="node">
<title>combine_L14_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="816482" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="816482" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="816482" y="-44" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP1_GPU21</text>
</g>
<!-- ffn_L14_EP0TP2PP1DP1_GPU21 -->
<g id="node3942" class="node">
<title>ffn_L14_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="816794,-78 816624,-78 816624,-26 816794,-26 816794,-78"/>
<text text-anchor="middle" x="816709" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="816709" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="816709" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="816709" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L14_EP0TP2PP1DP1_GPU21 -->
<g id="node3943" class="node">
<title>ffn_ar_L14_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="816937" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="816937" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="816937" y="-49.5" font-family="Arial" font-size="10.00">L14 EP0 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="816937" y="-38.5" font-family="Arial" font-size="10.00">GPU21</text>
</g>
<!-- residual2_L14_EP0TP2PP1DP1_GPU21 -->
<g id="node3944" class="node">
<title>residual2_L14_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="817230,-78 817080,-78 817080,-26 817230,-26 817230,-78"/>
<text text-anchor="middle" x="817155" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="817155" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="817155" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="817155" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L14_EP0TP3PP1DP0_GPU28 -->
<g id="node3945" class="node">
<title>ln1_L14_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="817416,-78 817266,-78 817266,-26 817416,-26 817416,-78"/>
<text text-anchor="middle" x="817341" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="817341" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="817341" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="817341" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L14_EP0TP3PP1DP0_GPU28 -->
<g id="node3946" class="node">
<title>qkv_L14_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="817602,-78 817452,-78 817452,-26 817602,-26 817602,-78"/>
<text text-anchor="middle" x="817527" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="817527" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="817527" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="817527" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L14_EP0TP3PP1DP0_GPU28 -->
<g id="node3947" class="node">
<title>attn_L14_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="817789.5,-78 817638.5,-78 817638.5,-26 817789.5,-26 817789.5,-78"/>
<text text-anchor="middle" x="817714" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="817714" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="817714" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="817714" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L14_EP0TP3PP1DP0_GPU28 -->
<g id="node3948" class="node">
<title>attn_out_L14_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="817976,-78 817826,-78 817826,-26 817976,-26 817976,-78"/>
<text text-anchor="middle" x="817901" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="817901" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="817901" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="817901" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L14_EP0TP3PP1DP0_GPU28 -->
<g id="node3949" class="node">
<title>attn_ar_L14_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="818119" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="818119" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="818119" y="-49.5" font-family="Arial" font-size="10.00">L14 EP0 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="818119" y="-38.5" font-family="Arial" font-size="10.00">GPU28</text>
</g>
<!-- residual1_L14_EP0TP3PP1DP0_GPU28 -->
<g id="node3950" class="node">
<title>residual1_L14_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="818412,-78 818262,-78 818262,-26 818412,-26 818412,-78"/>
<text text-anchor="middle" x="818337" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="818337" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="818337" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="818337" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L14_EP0TP3PP1DP0_GPU28 -->
<g id="node3951" class="node">
<title>ln2_L14_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="818598,-78 818448,-78 818448,-26 818598,-26 818598,-78"/>
<text text-anchor="middle" x="818523" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="818523" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="818523" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="818523" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L14_EP0TP3PP1DP0_GPU28 -->
<g id="node3952" class="node">
<title>gate_L14_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightyellow" stroke="black" points="818945.53,-104 818698.12,-104 818634.47,0 818881.88,0 818945.53,-104"/>
<text text-anchor="middle" x="818790" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="818790" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="818790" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="818790" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L14_EP0TP3PP1DP0_GPU28 -->
<g id="node3953" class="node">
<title>dispatch_L14_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="819088" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="819088" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="819088" y="-44" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP0_GPU28</text>
</g>
<!-- expert_0_L14_EP0TP3PP1DP0_GPU28 -->
<g id="node3954" class="node">
<title>expert_0_L14_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="819380,-78 819230,-78 819230,-26 819380,-26 819380,-78"/>
<text text-anchor="middle" x="819305" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="819305" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="819305" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="819305" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L14_EP0TP3PP1DP0_GPU28 -->
<g id="node3955" class="node">
<title>expert_1_L14_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="819566,-78 819416,-78 819416,-26 819566,-26 819566,-78"/>
<text text-anchor="middle" x="819491" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="819491" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="819491" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="819491" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L14_EP0TP3PP1DP0_GPU28 -->
<g id="node3956" class="node">
<title>expert_2_L14_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="819752,-78 819602,-78 819602,-26 819752,-26 819752,-78"/>
<text text-anchor="middle" x="819677" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="819677" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="819677" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="819677" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L14_EP0TP3PP1DP0_GPU28 -->
<g id="node3957" class="node">
<title>expert_3_L14_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="819938,-78 819788,-78 819788,-26 819938,-26 819938,-78"/>
<text text-anchor="middle" x="819863" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="819863" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="819863" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="819863" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L14_EP0TP3PP1DP0_GPU28 -->
<g id="node3958" class="node">
<title>combine_L14_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="820080" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="820080" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="820080" y="-44" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP0_GPU28</text>
</g>
<!-- ffn_L14_EP0TP3PP1DP0_GPU28 -->
<g id="node3959" class="node">
<title>ffn_L14_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="820392,-78 820222,-78 820222,-26 820392,-26 820392,-78"/>
<text text-anchor="middle" x="820307" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="820307" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="820307" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="820307" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L14_EP0TP3PP1DP0_GPU28 -->
<g id="node3960" class="node">
<title>ffn_ar_L14_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="820535" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="820535" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="820535" y="-49.5" font-family="Arial" font-size="10.00">L14 EP0 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="820535" y="-38.5" font-family="Arial" font-size="10.00">GPU28</text>
</g>
<!-- residual2_L14_EP0TP3PP1DP0_GPU28 -->
<g id="node3961" class="node">
<title>residual2_L14_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="820828,-78 820678,-78 820678,-26 820828,-26 820828,-78"/>
<text text-anchor="middle" x="820753" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="820753" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="820753" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="820753" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L14_EP0TP3PP1DP1_GPU29 -->
<g id="node3962" class="node">
<title>ln1_L14_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="821014,-78 820864,-78 820864,-26 821014,-26 821014,-78"/>
<text text-anchor="middle" x="820939" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="820939" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="820939" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="820939" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L14_EP0TP3PP1DP1_GPU29 -->
<g id="node3963" class="node">
<title>qkv_L14_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="821200,-78 821050,-78 821050,-26 821200,-26 821200,-78"/>
<text text-anchor="middle" x="821125" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="821125" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="821125" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="821125" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L14_EP0TP3PP1DP1_GPU29 -->
<g id="node3964" class="node">
<title>attn_L14_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="821387.5,-78 821236.5,-78 821236.5,-26 821387.5,-26 821387.5,-78"/>
<text text-anchor="middle" x="821312" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="821312" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="821312" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="821312" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L14_EP0TP3PP1DP1_GPU29 -->
<g id="node3965" class="node">
<title>attn_out_L14_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="821574,-78 821424,-78 821424,-26 821574,-26 821574,-78"/>
<text text-anchor="middle" x="821499" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="821499" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="821499" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="821499" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L14_EP0TP3PP1DP1_GPU29 -->
<g id="node3966" class="node">
<title>attn_ar_L14_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="821717" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="821717" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="821717" y="-49.5" font-family="Arial" font-size="10.00">L14 EP0 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="821717" y="-38.5" font-family="Arial" font-size="10.00">GPU29</text>
</g>
<!-- residual1_L14_EP0TP3PP1DP1_GPU29 -->
<g id="node3967" class="node">
<title>residual1_L14_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="822010,-78 821860,-78 821860,-26 822010,-26 822010,-78"/>
<text text-anchor="middle" x="821935" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="821935" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="821935" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="821935" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L14_EP0TP3PP1DP1_GPU29 -->
<g id="node3968" class="node">
<title>ln2_L14_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="822196,-78 822046,-78 822046,-26 822196,-26 822196,-78"/>
<text text-anchor="middle" x="822121" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="822121" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="822121" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="822121" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L14_EP0TP3PP1DP1_GPU29 -->
<g id="node3969" class="node">
<title>gate_L14_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightyellow" stroke="black" points="822543.53,-104 822296.12,-104 822232.47,0 822479.88,0 822543.53,-104"/>
<text text-anchor="middle" x="822388" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="822388" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="822388" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="822388" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L14_EP0TP3PP1DP1_GPU29 -->
<g id="node3970" class="node">
<title>dispatch_L14_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="822686" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="822686" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="822686" y="-44" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP1_GPU29</text>
</g>
<!-- expert_0_L14_EP0TP3PP1DP1_GPU29 -->
<g id="node3971" class="node">
<title>expert_0_L14_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="822978,-78 822828,-78 822828,-26 822978,-26 822978,-78"/>
<text text-anchor="middle" x="822903" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="822903" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="822903" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="822903" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L14_EP0TP3PP1DP1_GPU29 -->
<g id="node3972" class="node">
<title>expert_1_L14_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="823164,-78 823014,-78 823014,-26 823164,-26 823164,-78"/>
<text text-anchor="middle" x="823089" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="823089" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="823089" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="823089" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L14_EP0TP3PP1DP1_GPU29 -->
<g id="node3973" class="node">
<title>expert_2_L14_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="823350,-78 823200,-78 823200,-26 823350,-26 823350,-78"/>
<text text-anchor="middle" x="823275" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="823275" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="823275" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="823275" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L14_EP0TP3PP1DP1_GPU29 -->
<g id="node3974" class="node">
<title>expert_3_L14_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="823536,-78 823386,-78 823386,-26 823536,-26 823536,-78"/>
<text text-anchor="middle" x="823461" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="823461" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="823461" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="823461" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L14_EP0TP3PP1DP1_GPU29 -->
<g id="node3975" class="node">
<title>combine_L14_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="823678" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="823678" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="823678" y="-44" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP1_GPU29</text>
</g>
<!-- ffn_L14_EP0TP3PP1DP1_GPU29 -->
<g id="node3976" class="node">
<title>ffn_L14_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="823990,-78 823820,-78 823820,-26 823990,-26 823990,-78"/>
<text text-anchor="middle" x="823905" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="823905" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="823905" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="823905" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L14_EP0TP3PP1DP1_GPU29 -->
<g id="node3977" class="node">
<title>ffn_ar_L14_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="824133" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="824133" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="824133" y="-49.5" font-family="Arial" font-size="10.00">L14 EP0 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="824133" y="-38.5" font-family="Arial" font-size="10.00">GPU29</text>
</g>
<!-- residual2_L14_EP0TP3PP1DP1_GPU29 -->
<g id="node3978" class="node">
<title>residual2_L14_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="824426,-78 824276,-78 824276,-26 824426,-26 824426,-78"/>
<text text-anchor="middle" x="824351" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="824351" y="-55" font-family="Arial" font-size="10.00">L14_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="824351" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="824351" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L14_EP1TP0PP1DP0_GPU36 -->
<g id="node3979" class="node">
<title>ln1_L14_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="824612,-78 824462,-78 824462,-26 824612,-26 824612,-78"/>
<text text-anchor="middle" x="824537" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="824537" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="824537" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="824537" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L14_EP1TP0PP1DP0_GPU36 -->
<g id="node3980" class="node">
<title>qkv_L14_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="824798,-78 824648,-78 824648,-26 824798,-26 824798,-78"/>
<text text-anchor="middle" x="824723" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="824723" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="824723" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="824723" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L14_EP1TP0PP1DP0_GPU36 -->
<g id="node3981" class="node">
<title>attn_L14_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="824985.5,-78 824834.5,-78 824834.5,-26 824985.5,-26 824985.5,-78"/>
<text text-anchor="middle" x="824910" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="824910" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="824910" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="824910" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L14_EP1TP0PP1DP0_GPU36 -->
<g id="node3982" class="node">
<title>attn_out_L14_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="825172,-78 825022,-78 825022,-26 825172,-26 825172,-78"/>
<text text-anchor="middle" x="825097" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="825097" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="825097" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="825097" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L14_EP1TP0PP1DP0_GPU36 -->
<g id="node3983" class="node">
<title>attn_ar_L14_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="825315" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="825315" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="825315" y="-49.5" font-family="Arial" font-size="10.00">L14 EP1 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="825315" y="-38.5" font-family="Arial" font-size="10.00">GPU36</text>
</g>
<!-- residual1_L14_EP1TP0PP1DP0_GPU36 -->
<g id="node3984" class="node">
<title>residual1_L14_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="825608,-78 825458,-78 825458,-26 825608,-26 825608,-78"/>
<text text-anchor="middle" x="825533" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="825533" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="825533" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="825533" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L14_EP1TP0PP1DP0_GPU36 -->
<g id="node3985" class="node">
<title>ln2_L14_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="825794,-78 825644,-78 825644,-26 825794,-26 825794,-78"/>
<text text-anchor="middle" x="825719" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="825719" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="825719" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="825719" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L14_EP1TP0PP1DP0_GPU36 -->
<g id="node3986" class="node">
<title>gate_L14_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightyellow" stroke="black" points="826141.53,-104 825894.12,-104 825830.47,0 826077.88,0 826141.53,-104"/>
<text text-anchor="middle" x="825986" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="825986" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="825986" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="825986" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L14_EP1TP0PP1DP0_GPU36 -->
<g id="node3987" class="node">
<title>dispatch_L14_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="826284" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="826284" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="826284" y="-44" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP0_GPU36</text>
</g>
<!-- expert_0_L14_EP1TP0PP1DP0_GPU36 -->
<g id="node3988" class="node">
<title>expert_0_L14_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="826576,-78 826426,-78 826426,-26 826576,-26 826576,-78"/>
<text text-anchor="middle" x="826501" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="826501" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="826501" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="826501" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L14_EP1TP0PP1DP0_GPU36 -->
<g id="node3989" class="node">
<title>expert_1_L14_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="826762,-78 826612,-78 826612,-26 826762,-26 826762,-78"/>
<text text-anchor="middle" x="826687" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="826687" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="826687" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="826687" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L14_EP1TP0PP1DP0_GPU36 -->
<g id="node3990" class="node">
<title>expert_2_L14_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="826948,-78 826798,-78 826798,-26 826948,-26 826948,-78"/>
<text text-anchor="middle" x="826873" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="826873" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="826873" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="826873" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L14_EP1TP0PP1DP0_GPU36 -->
<g id="node3991" class="node">
<title>expert_3_L14_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="827134,-78 826984,-78 826984,-26 827134,-26 827134,-78"/>
<text text-anchor="middle" x="827059" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="827059" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="827059" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="827059" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L14_EP1TP0PP1DP0_GPU36 -->
<g id="node3992" class="node">
<title>combine_L14_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="827276" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="827276" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="827276" y="-44" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP0_GPU36</text>
</g>
<!-- ffn_L14_EP1TP0PP1DP0_GPU36 -->
<g id="node3993" class="node">
<title>ffn_L14_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="827588,-78 827418,-78 827418,-26 827588,-26 827588,-78"/>
<text text-anchor="middle" x="827503" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="827503" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="827503" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="827503" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L14_EP1TP0PP1DP0_GPU36 -->
<g id="node3994" class="node">
<title>ffn_ar_L14_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="827731" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="827731" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="827731" y="-49.5" font-family="Arial" font-size="10.00">L14 EP1 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="827731" y="-38.5" font-family="Arial" font-size="10.00">GPU36</text>
</g>
<!-- residual2_L14_EP1TP0PP1DP0_GPU36 -->
<g id="node3995" class="node">
<title>residual2_L14_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="828024,-78 827874,-78 827874,-26 828024,-26 828024,-78"/>
<text text-anchor="middle" x="827949" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="827949" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="827949" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="827949" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L14_EP1TP0PP1DP1_GPU37 -->
<g id="node3996" class="node">
<title>ln1_L14_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="828210,-78 828060,-78 828060,-26 828210,-26 828210,-78"/>
<text text-anchor="middle" x="828135" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="828135" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="828135" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="828135" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L14_EP1TP0PP1DP1_GPU37 -->
<g id="node3997" class="node">
<title>qkv_L14_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="828396,-78 828246,-78 828246,-26 828396,-26 828396,-78"/>
<text text-anchor="middle" x="828321" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="828321" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="828321" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="828321" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L14_EP1TP0PP1DP1_GPU37 -->
<g id="node3998" class="node">
<title>attn_L14_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="828583.5,-78 828432.5,-78 828432.5,-26 828583.5,-26 828583.5,-78"/>
<text text-anchor="middle" x="828508" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="828508" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="828508" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="828508" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L14_EP1TP0PP1DP1_GPU37 -->
<g id="node3999" class="node">
<title>attn_out_L14_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="828770,-78 828620,-78 828620,-26 828770,-26 828770,-78"/>
<text text-anchor="middle" x="828695" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="828695" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="828695" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="828695" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L14_EP1TP0PP1DP1_GPU37 -->
<g id="node4000" class="node">
<title>attn_ar_L14_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="828913" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="828913" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="828913" y="-49.5" font-family="Arial" font-size="10.00">L14 EP1 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="828913" y="-38.5" font-family="Arial" font-size="10.00">GPU37</text>
</g>
<!-- residual1_L14_EP1TP0PP1DP1_GPU37 -->
<g id="node4001" class="node">
<title>residual1_L14_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="829206,-78 829056,-78 829056,-26 829206,-26 829206,-78"/>
<text text-anchor="middle" x="829131" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="829131" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="829131" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="829131" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L14_EP1TP0PP1DP1_GPU37 -->
<g id="node4002" class="node">
<title>ln2_L14_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="829392,-78 829242,-78 829242,-26 829392,-26 829392,-78"/>
<text text-anchor="middle" x="829317" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="829317" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="829317" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="829317" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L14_EP1TP0PP1DP1_GPU37 -->
<g id="node4003" class="node">
<title>gate_L14_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightyellow" stroke="black" points="829739.53,-104 829492.12,-104 829428.47,0 829675.88,0 829739.53,-104"/>
<text text-anchor="middle" x="829584" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="829584" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="829584" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="829584" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L14_EP1TP0PP1DP1_GPU37 -->
<g id="node4004" class="node">
<title>dispatch_L14_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="829882" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="829882" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="829882" y="-44" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP1_GPU37</text>
</g>
<!-- expert_0_L14_EP1TP0PP1DP1_GPU37 -->
<g id="node4005" class="node">
<title>expert_0_L14_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="830174,-78 830024,-78 830024,-26 830174,-26 830174,-78"/>
<text text-anchor="middle" x="830099" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="830099" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="830099" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="830099" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L14_EP1TP0PP1DP1_GPU37 -->
<g id="node4006" class="node">
<title>expert_1_L14_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="830360,-78 830210,-78 830210,-26 830360,-26 830360,-78"/>
<text text-anchor="middle" x="830285" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="830285" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="830285" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="830285" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L14_EP1TP0PP1DP1_GPU37 -->
<g id="node4007" class="node">
<title>expert_2_L14_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="830546,-78 830396,-78 830396,-26 830546,-26 830546,-78"/>
<text text-anchor="middle" x="830471" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="830471" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="830471" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="830471" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L14_EP1TP0PP1DP1_GPU37 -->
<g id="node4008" class="node">
<title>expert_3_L14_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="830732,-78 830582,-78 830582,-26 830732,-26 830732,-78"/>
<text text-anchor="middle" x="830657" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="830657" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="830657" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="830657" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L14_EP1TP0PP1DP1_GPU37 -->
<g id="node4009" class="node">
<title>combine_L14_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="830874" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="830874" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="830874" y="-44" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP1_GPU37</text>
</g>
<!-- ffn_L14_EP1TP0PP1DP1_GPU37 -->
<g id="node4010" class="node">
<title>ffn_L14_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="831186,-78 831016,-78 831016,-26 831186,-26 831186,-78"/>
<text text-anchor="middle" x="831101" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="831101" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="831101" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="831101" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L14_EP1TP0PP1DP1_GPU37 -->
<g id="node4011" class="node">
<title>ffn_ar_L14_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="831329" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="831329" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="831329" y="-49.5" font-family="Arial" font-size="10.00">L14 EP1 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="831329" y="-38.5" font-family="Arial" font-size="10.00">GPU37</text>
</g>
<!-- residual2_L14_EP1TP0PP1DP1_GPU37 -->
<g id="node4012" class="node">
<title>residual2_L14_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="831622,-78 831472,-78 831472,-26 831622,-26 831622,-78"/>
<text text-anchor="middle" x="831547" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="831547" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="831547" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="831547" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L14_EP1TP1PP1DP0_GPU44 -->
<g id="node4013" class="node">
<title>ln1_L14_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="831808,-78 831658,-78 831658,-26 831808,-26 831808,-78"/>
<text text-anchor="middle" x="831733" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="831733" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="831733" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="831733" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L14_EP1TP1PP1DP0_GPU44 -->
<g id="node4014" class="node">
<title>qkv_L14_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="831994,-78 831844,-78 831844,-26 831994,-26 831994,-78"/>
<text text-anchor="middle" x="831919" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="831919" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="831919" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="831919" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L14_EP1TP1PP1DP0_GPU44 -->
<g id="node4015" class="node">
<title>attn_L14_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="832181.5,-78 832030.5,-78 832030.5,-26 832181.5,-26 832181.5,-78"/>
<text text-anchor="middle" x="832106" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="832106" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="832106" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="832106" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L14_EP1TP1PP1DP0_GPU44 -->
<g id="node4016" class="node">
<title>attn_out_L14_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="832368,-78 832218,-78 832218,-26 832368,-26 832368,-78"/>
<text text-anchor="middle" x="832293" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="832293" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="832293" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="832293" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L14_EP1TP1PP1DP0_GPU44 -->
<g id="node4017" class="node">
<title>attn_ar_L14_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="832511" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="832511" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="832511" y="-49.5" font-family="Arial" font-size="10.00">L14 EP1 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="832511" y="-38.5" font-family="Arial" font-size="10.00">GPU44</text>
</g>
<!-- residual1_L14_EP1TP1PP1DP0_GPU44 -->
<g id="node4018" class="node">
<title>residual1_L14_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="832804,-78 832654,-78 832654,-26 832804,-26 832804,-78"/>
<text text-anchor="middle" x="832729" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="832729" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="832729" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="832729" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L14_EP1TP1PP1DP0_GPU44 -->
<g id="node4019" class="node">
<title>ln2_L14_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="832990,-78 832840,-78 832840,-26 832990,-26 832990,-78"/>
<text text-anchor="middle" x="832915" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="832915" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="832915" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="832915" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L14_EP1TP1PP1DP0_GPU44 -->
<g id="node4020" class="node">
<title>gate_L14_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightyellow" stroke="black" points="833337.53,-104 833090.12,-104 833026.47,0 833273.88,0 833337.53,-104"/>
<text text-anchor="middle" x="833182" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="833182" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="833182" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="833182" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L14_EP1TP1PP1DP0_GPU44 -->
<g id="node4021" class="node">
<title>dispatch_L14_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="833480" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="833480" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="833480" y="-44" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP0_GPU44</text>
</g>
<!-- expert_0_L14_EP1TP1PP1DP0_GPU44 -->
<g id="node4022" class="node">
<title>expert_0_L14_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="833772,-78 833622,-78 833622,-26 833772,-26 833772,-78"/>
<text text-anchor="middle" x="833697" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="833697" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="833697" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="833697" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L14_EP1TP1PP1DP0_GPU44 -->
<g id="node4023" class="node">
<title>expert_1_L14_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="833958,-78 833808,-78 833808,-26 833958,-26 833958,-78"/>
<text text-anchor="middle" x="833883" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="833883" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="833883" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="833883" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L14_EP1TP1PP1DP0_GPU44 -->
<g id="node4024" class="node">
<title>expert_2_L14_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="834144,-78 833994,-78 833994,-26 834144,-26 834144,-78"/>
<text text-anchor="middle" x="834069" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="834069" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="834069" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="834069" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L14_EP1TP1PP1DP0_GPU44 -->
<g id="node4025" class="node">
<title>expert_3_L14_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="834330,-78 834180,-78 834180,-26 834330,-26 834330,-78"/>
<text text-anchor="middle" x="834255" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="834255" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="834255" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="834255" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L14_EP1TP1PP1DP0_GPU44 -->
<g id="node4026" class="node">
<title>combine_L14_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="834472" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="834472" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="834472" y="-44" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP0_GPU44</text>
</g>
<!-- ffn_L14_EP1TP1PP1DP0_GPU44 -->
<g id="node4027" class="node">
<title>ffn_L14_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="834784,-78 834614,-78 834614,-26 834784,-26 834784,-78"/>
<text text-anchor="middle" x="834699" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="834699" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="834699" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="834699" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L14_EP1TP1PP1DP0_GPU44 -->
<g id="node4028" class="node">
<title>ffn_ar_L14_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="834927" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="834927" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="834927" y="-49.5" font-family="Arial" font-size="10.00">L14 EP1 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="834927" y="-38.5" font-family="Arial" font-size="10.00">GPU44</text>
</g>
<!-- residual2_L14_EP1TP1PP1DP0_GPU44 -->
<g id="node4029" class="node">
<title>residual2_L14_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="835220,-78 835070,-78 835070,-26 835220,-26 835220,-78"/>
<text text-anchor="middle" x="835145" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="835145" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="835145" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="835145" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L14_EP1TP1PP1DP1_GPU45 -->
<g id="node4030" class="node">
<title>ln1_L14_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="835406,-78 835256,-78 835256,-26 835406,-26 835406,-78"/>
<text text-anchor="middle" x="835331" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="835331" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="835331" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="835331" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L14_EP1TP1PP1DP1_GPU45 -->
<g id="node4031" class="node">
<title>qkv_L14_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="835592,-78 835442,-78 835442,-26 835592,-26 835592,-78"/>
<text text-anchor="middle" x="835517" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="835517" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="835517" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="835517" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L14_EP1TP1PP1DP1_GPU45 -->
<g id="node4032" class="node">
<title>attn_L14_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="835779.5,-78 835628.5,-78 835628.5,-26 835779.5,-26 835779.5,-78"/>
<text text-anchor="middle" x="835704" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="835704" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="835704" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="835704" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L14_EP1TP1PP1DP1_GPU45 -->
<g id="node4033" class="node">
<title>attn_out_L14_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="835966,-78 835816,-78 835816,-26 835966,-26 835966,-78"/>
<text text-anchor="middle" x="835891" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="835891" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="835891" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="835891" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L14_EP1TP1PP1DP1_GPU45 -->
<g id="node4034" class="node">
<title>attn_ar_L14_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="836109" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="836109" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="836109" y="-49.5" font-family="Arial" font-size="10.00">L14 EP1 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="836109" y="-38.5" font-family="Arial" font-size="10.00">GPU45</text>
</g>
<!-- residual1_L14_EP1TP1PP1DP1_GPU45 -->
<g id="node4035" class="node">
<title>residual1_L14_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="836402,-78 836252,-78 836252,-26 836402,-26 836402,-78"/>
<text text-anchor="middle" x="836327" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="836327" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="836327" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="836327" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L14_EP1TP1PP1DP1_GPU45 -->
<g id="node4036" class="node">
<title>ln2_L14_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="836588,-78 836438,-78 836438,-26 836588,-26 836588,-78"/>
<text text-anchor="middle" x="836513" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="836513" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="836513" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="836513" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L14_EP1TP1PP1DP1_GPU45 -->
<g id="node4037" class="node">
<title>gate_L14_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightyellow" stroke="black" points="836935.53,-104 836688.12,-104 836624.47,0 836871.88,0 836935.53,-104"/>
<text text-anchor="middle" x="836780" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="836780" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="836780" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="836780" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L14_EP1TP1PP1DP1_GPU45 -->
<g id="node4038" class="node">
<title>dispatch_L14_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="837078" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="837078" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="837078" y="-44" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP1_GPU45</text>
</g>
<!-- expert_0_L14_EP1TP1PP1DP1_GPU45 -->
<g id="node4039" class="node">
<title>expert_0_L14_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="837370,-78 837220,-78 837220,-26 837370,-26 837370,-78"/>
<text text-anchor="middle" x="837295" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="837295" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="837295" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="837295" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L14_EP1TP1PP1DP1_GPU45 -->
<g id="node4040" class="node">
<title>expert_1_L14_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="837556,-78 837406,-78 837406,-26 837556,-26 837556,-78"/>
<text text-anchor="middle" x="837481" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="837481" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="837481" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="837481" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L14_EP1TP1PP1DP1_GPU45 -->
<g id="node4041" class="node">
<title>expert_2_L14_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="837742,-78 837592,-78 837592,-26 837742,-26 837742,-78"/>
<text text-anchor="middle" x="837667" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="837667" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="837667" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="837667" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L14_EP1TP1PP1DP1_GPU45 -->
<g id="node4042" class="node">
<title>expert_3_L14_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="837928,-78 837778,-78 837778,-26 837928,-26 837928,-78"/>
<text text-anchor="middle" x="837853" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="837853" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="837853" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="837853" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L14_EP1TP1PP1DP1_GPU45 -->
<g id="node4043" class="node">
<title>combine_L14_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="838070" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="838070" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="838070" y="-44" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP1_GPU45</text>
</g>
<!-- ffn_L14_EP1TP1PP1DP1_GPU45 -->
<g id="node4044" class="node">
<title>ffn_L14_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="838382,-78 838212,-78 838212,-26 838382,-26 838382,-78"/>
<text text-anchor="middle" x="838297" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="838297" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="838297" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="838297" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L14_EP1TP1PP1DP1_GPU45 -->
<g id="node4045" class="node">
<title>ffn_ar_L14_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="838525" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="838525" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="838525" y="-49.5" font-family="Arial" font-size="10.00">L14 EP1 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="838525" y="-38.5" font-family="Arial" font-size="10.00">GPU45</text>
</g>
<!-- residual2_L14_EP1TP1PP1DP1_GPU45 -->
<g id="node4046" class="node">
<title>residual2_L14_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="838818,-78 838668,-78 838668,-26 838818,-26 838818,-78"/>
<text text-anchor="middle" x="838743" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="838743" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="838743" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="838743" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L14_EP1TP2PP1DP0_GPU52 -->
<g id="node4047" class="node">
<title>ln1_L14_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="839004,-78 838854,-78 838854,-26 839004,-26 839004,-78"/>
<text text-anchor="middle" x="838929" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="838929" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="838929" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="838929" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L14_EP1TP2PP1DP0_GPU52 -->
<g id="node4048" class="node">
<title>qkv_L14_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="839190,-78 839040,-78 839040,-26 839190,-26 839190,-78"/>
<text text-anchor="middle" x="839115" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="839115" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="839115" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="839115" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L14_EP1TP2PP1DP0_GPU52 -->
<g id="node4049" class="node">
<title>attn_L14_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="839377.5,-78 839226.5,-78 839226.5,-26 839377.5,-26 839377.5,-78"/>
<text text-anchor="middle" x="839302" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="839302" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="839302" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="839302" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L14_EP1TP2PP1DP0_GPU52 -->
<g id="node4050" class="node">
<title>attn_out_L14_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="839564,-78 839414,-78 839414,-26 839564,-26 839564,-78"/>
<text text-anchor="middle" x="839489" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="839489" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="839489" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="839489" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L14_EP1TP2PP1DP0_GPU52 -->
<g id="node4051" class="node">
<title>attn_ar_L14_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="839707" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="839707" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="839707" y="-49.5" font-family="Arial" font-size="10.00">L14 EP1 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="839707" y="-38.5" font-family="Arial" font-size="10.00">GPU52</text>
</g>
<!-- residual1_L14_EP1TP2PP1DP0_GPU52 -->
<g id="node4052" class="node">
<title>residual1_L14_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="840000,-78 839850,-78 839850,-26 840000,-26 840000,-78"/>
<text text-anchor="middle" x="839925" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="839925" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="839925" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="839925" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L14_EP1TP2PP1DP0_GPU52 -->
<g id="node4053" class="node">
<title>ln2_L14_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="840186,-78 840036,-78 840036,-26 840186,-26 840186,-78"/>
<text text-anchor="middle" x="840111" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="840111" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="840111" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="840111" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L14_EP1TP2PP1DP0_GPU52 -->
<g id="node4054" class="node">
<title>gate_L14_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightyellow" stroke="black" points="840533.53,-104 840286.12,-104 840222.47,0 840469.88,0 840533.53,-104"/>
<text text-anchor="middle" x="840378" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="840378" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="840378" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="840378" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L14_EP1TP2PP1DP0_GPU52 -->
<g id="node4055" class="node">
<title>dispatch_L14_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="840676" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="840676" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="840676" y="-44" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP0_GPU52</text>
</g>
<!-- expert_0_L14_EP1TP2PP1DP0_GPU52 -->
<g id="node4056" class="node">
<title>expert_0_L14_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="840968,-78 840818,-78 840818,-26 840968,-26 840968,-78"/>
<text text-anchor="middle" x="840893" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="840893" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="840893" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="840893" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L14_EP1TP2PP1DP0_GPU52 -->
<g id="node4057" class="node">
<title>expert_1_L14_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="841154,-78 841004,-78 841004,-26 841154,-26 841154,-78"/>
<text text-anchor="middle" x="841079" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="841079" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="841079" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="841079" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L14_EP1TP2PP1DP0_GPU52 -->
<g id="node4058" class="node">
<title>expert_2_L14_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="841340,-78 841190,-78 841190,-26 841340,-26 841340,-78"/>
<text text-anchor="middle" x="841265" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="841265" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="841265" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="841265" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L14_EP1TP2PP1DP0_GPU52 -->
<g id="node4059" class="node">
<title>expert_3_L14_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="841526,-78 841376,-78 841376,-26 841526,-26 841526,-78"/>
<text text-anchor="middle" x="841451" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="841451" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="841451" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="841451" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L14_EP1TP2PP1DP0_GPU52 -->
<g id="node4060" class="node">
<title>combine_L14_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="841668" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="841668" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="841668" y="-44" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP0_GPU52</text>
</g>
<!-- ffn_L14_EP1TP2PP1DP0_GPU52 -->
<g id="node4061" class="node">
<title>ffn_L14_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="841980,-78 841810,-78 841810,-26 841980,-26 841980,-78"/>
<text text-anchor="middle" x="841895" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="841895" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="841895" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="841895" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L14_EP1TP2PP1DP0_GPU52 -->
<g id="node4062" class="node">
<title>ffn_ar_L14_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="842123" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="842123" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="842123" y="-49.5" font-family="Arial" font-size="10.00">L14 EP1 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="842123" y="-38.5" font-family="Arial" font-size="10.00">GPU52</text>
</g>
<!-- residual2_L14_EP1TP2PP1DP0_GPU52 -->
<g id="node4063" class="node">
<title>residual2_L14_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="842416,-78 842266,-78 842266,-26 842416,-26 842416,-78"/>
<text text-anchor="middle" x="842341" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="842341" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="842341" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="842341" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L14_EP1TP2PP1DP1_GPU53 -->
<g id="node4064" class="node">
<title>ln1_L14_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="842602,-78 842452,-78 842452,-26 842602,-26 842602,-78"/>
<text text-anchor="middle" x="842527" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="842527" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="842527" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="842527" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L14_EP1TP2PP1DP1_GPU53 -->
<g id="node4065" class="node">
<title>qkv_L14_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="842788,-78 842638,-78 842638,-26 842788,-26 842788,-78"/>
<text text-anchor="middle" x="842713" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="842713" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="842713" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="842713" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L14_EP1TP2PP1DP1_GPU53 -->
<g id="node4066" class="node">
<title>attn_L14_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="842975.5,-78 842824.5,-78 842824.5,-26 842975.5,-26 842975.5,-78"/>
<text text-anchor="middle" x="842900" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="842900" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="842900" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="842900" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L14_EP1TP2PP1DP1_GPU53 -->
<g id="node4067" class="node">
<title>attn_out_L14_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="843162,-78 843012,-78 843012,-26 843162,-26 843162,-78"/>
<text text-anchor="middle" x="843087" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="843087" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="843087" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="843087" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L14_EP1TP2PP1DP1_GPU53 -->
<g id="node4068" class="node">
<title>attn_ar_L14_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="843305" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="843305" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="843305" y="-49.5" font-family="Arial" font-size="10.00">L14 EP1 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="843305" y="-38.5" font-family="Arial" font-size="10.00">GPU53</text>
</g>
<!-- residual1_L14_EP1TP2PP1DP1_GPU53 -->
<g id="node4069" class="node">
<title>residual1_L14_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="843598,-78 843448,-78 843448,-26 843598,-26 843598,-78"/>
<text text-anchor="middle" x="843523" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="843523" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="843523" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="843523" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L14_EP1TP2PP1DP1_GPU53 -->
<g id="node4070" class="node">
<title>ln2_L14_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="843784,-78 843634,-78 843634,-26 843784,-26 843784,-78"/>
<text text-anchor="middle" x="843709" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="843709" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="843709" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="843709" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L14_EP1TP2PP1DP1_GPU53 -->
<g id="node4071" class="node">
<title>gate_L14_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightyellow" stroke="black" points="844131.53,-104 843884.12,-104 843820.47,0 844067.88,0 844131.53,-104"/>
<text text-anchor="middle" x="843976" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="843976" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="843976" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="843976" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L14_EP1TP2PP1DP1_GPU53 -->
<g id="node4072" class="node">
<title>dispatch_L14_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="844274" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="844274" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="844274" y="-44" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP1_GPU53</text>
</g>
<!-- expert_0_L14_EP1TP2PP1DP1_GPU53 -->
<g id="node4073" class="node">
<title>expert_0_L14_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="844566,-78 844416,-78 844416,-26 844566,-26 844566,-78"/>
<text text-anchor="middle" x="844491" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="844491" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="844491" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="844491" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L14_EP1TP2PP1DP1_GPU53 -->
<g id="node4074" class="node">
<title>expert_1_L14_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="844752,-78 844602,-78 844602,-26 844752,-26 844752,-78"/>
<text text-anchor="middle" x="844677" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="844677" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="844677" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="844677" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L14_EP1TP2PP1DP1_GPU53 -->
<g id="node4075" class="node">
<title>expert_2_L14_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="844938,-78 844788,-78 844788,-26 844938,-26 844938,-78"/>
<text text-anchor="middle" x="844863" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="844863" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="844863" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="844863" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L14_EP1TP2PP1DP1_GPU53 -->
<g id="node4076" class="node">
<title>expert_3_L14_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="845124,-78 844974,-78 844974,-26 845124,-26 845124,-78"/>
<text text-anchor="middle" x="845049" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="845049" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="845049" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="845049" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L14_EP1TP2PP1DP1_GPU53 -->
<g id="node4077" class="node">
<title>combine_L14_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="845266" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="845266" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="845266" y="-44" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP1_GPU53</text>
</g>
<!-- ffn_L14_EP1TP2PP1DP1_GPU53 -->
<g id="node4078" class="node">
<title>ffn_L14_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="845578,-78 845408,-78 845408,-26 845578,-26 845578,-78"/>
<text text-anchor="middle" x="845493" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="845493" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="845493" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="845493" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L14_EP1TP2PP1DP1_GPU53 -->
<g id="node4079" class="node">
<title>ffn_ar_L14_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="845721" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="845721" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="845721" y="-49.5" font-family="Arial" font-size="10.00">L14 EP1 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="845721" y="-38.5" font-family="Arial" font-size="10.00">GPU53</text>
</g>
<!-- residual2_L14_EP1TP2PP1DP1_GPU53 -->
<g id="node4080" class="node">
<title>residual2_L14_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="846014,-78 845864,-78 845864,-26 846014,-26 846014,-78"/>
<text text-anchor="middle" x="845939" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="845939" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="845939" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="845939" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L14_EP1TP3PP1DP0_GPU60 -->
<g id="node4081" class="node">
<title>ln1_L14_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="846200,-78 846050,-78 846050,-26 846200,-26 846200,-78"/>
<text text-anchor="middle" x="846125" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="846125" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="846125" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="846125" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L14_EP1TP3PP1DP0_GPU60 -->
<g id="node4082" class="node">
<title>qkv_L14_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="846386,-78 846236,-78 846236,-26 846386,-26 846386,-78"/>
<text text-anchor="middle" x="846311" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="846311" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="846311" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="846311" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L14_EP1TP3PP1DP0_GPU60 -->
<g id="node4083" class="node">
<title>attn_L14_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="846573.5,-78 846422.5,-78 846422.5,-26 846573.5,-26 846573.5,-78"/>
<text text-anchor="middle" x="846498" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="846498" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="846498" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="846498" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L14_EP1TP3PP1DP0_GPU60 -->
<g id="node4084" class="node">
<title>attn_out_L14_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="846760,-78 846610,-78 846610,-26 846760,-26 846760,-78"/>
<text text-anchor="middle" x="846685" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="846685" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="846685" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="846685" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L14_EP1TP3PP1DP0_GPU60 -->
<g id="node4085" class="node">
<title>attn_ar_L14_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="846903" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="846903" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="846903" y="-49.5" font-family="Arial" font-size="10.00">L14 EP1 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="846903" y="-38.5" font-family="Arial" font-size="10.00">GPU60</text>
</g>
<!-- residual1_L14_EP1TP3PP1DP0_GPU60 -->
<g id="node4086" class="node">
<title>residual1_L14_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="847196,-78 847046,-78 847046,-26 847196,-26 847196,-78"/>
<text text-anchor="middle" x="847121" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="847121" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="847121" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="847121" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L14_EP1TP3PP1DP0_GPU60 -->
<g id="node4087" class="node">
<title>ln2_L14_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="847382,-78 847232,-78 847232,-26 847382,-26 847382,-78"/>
<text text-anchor="middle" x="847307" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="847307" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="847307" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="847307" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L14_EP1TP3PP1DP0_GPU60 -->
<g id="node4088" class="node">
<title>gate_L14_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightyellow" stroke="black" points="847729.53,-104 847482.12,-104 847418.47,0 847665.88,0 847729.53,-104"/>
<text text-anchor="middle" x="847574" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="847574" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="847574" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="847574" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L14_EP1TP3PP1DP0_GPU60 -->
<g id="node4089" class="node">
<title>dispatch_L14_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="847872" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="847872" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="847872" y="-44" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP0_GPU60</text>
</g>
<!-- expert_0_L14_EP1TP3PP1DP0_GPU60 -->
<g id="node4090" class="node">
<title>expert_0_L14_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="848164,-78 848014,-78 848014,-26 848164,-26 848164,-78"/>
<text text-anchor="middle" x="848089" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="848089" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="848089" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="848089" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L14_EP1TP3PP1DP0_GPU60 -->
<g id="node4091" class="node">
<title>expert_1_L14_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="848350,-78 848200,-78 848200,-26 848350,-26 848350,-78"/>
<text text-anchor="middle" x="848275" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="848275" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="848275" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="848275" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L14_EP1TP3PP1DP0_GPU60 -->
<g id="node4092" class="node">
<title>expert_2_L14_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="848536,-78 848386,-78 848386,-26 848536,-26 848536,-78"/>
<text text-anchor="middle" x="848461" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="848461" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="848461" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="848461" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L14_EP1TP3PP1DP0_GPU60 -->
<g id="node4093" class="node">
<title>expert_3_L14_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="848722,-78 848572,-78 848572,-26 848722,-26 848722,-78"/>
<text text-anchor="middle" x="848647" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="848647" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="848647" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="848647" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L14_EP1TP3PP1DP0_GPU60 -->
<g id="node4094" class="node">
<title>combine_L14_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="848864" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="848864" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="848864" y="-44" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP0_GPU60</text>
</g>
<!-- ffn_L14_EP1TP3PP1DP0_GPU60 -->
<g id="node4095" class="node">
<title>ffn_L14_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="849176,-78 849006,-78 849006,-26 849176,-26 849176,-78"/>
<text text-anchor="middle" x="849091" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="849091" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="849091" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="849091" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L14_EP1TP3PP1DP0_GPU60 -->
<g id="node4096" class="node">
<title>ffn_ar_L14_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="849319" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="849319" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="849319" y="-49.5" font-family="Arial" font-size="10.00">L14 EP1 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="849319" y="-38.5" font-family="Arial" font-size="10.00">GPU60</text>
</g>
<!-- residual2_L14_EP1TP3PP1DP0_GPU60 -->
<g id="node4097" class="node">
<title>residual2_L14_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="849612,-78 849462,-78 849462,-26 849612,-26 849612,-78"/>
<text text-anchor="middle" x="849537" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="849537" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="849537" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="849537" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L14_EP1TP3PP1DP1_GPU61 -->
<g id="node4098" class="node">
<title>ln1_L14_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="849798,-78 849648,-78 849648,-26 849798,-26 849798,-78"/>
<text text-anchor="middle" x="849723" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="849723" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="849723" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="849723" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L14_EP1TP3PP1DP1_GPU61 -->
<g id="node4099" class="node">
<title>qkv_L14_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="849984,-78 849834,-78 849834,-26 849984,-26 849984,-78"/>
<text text-anchor="middle" x="849909" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="849909" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="849909" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="849909" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L14_EP1TP3PP1DP1_GPU61 -->
<g id="node4100" class="node">
<title>attn_L14_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="850171.5,-78 850020.5,-78 850020.5,-26 850171.5,-26 850171.5,-78"/>
<text text-anchor="middle" x="850096" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="850096" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="850096" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="850096" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L14_EP1TP3PP1DP1_GPU61 -->
<g id="node4101" class="node">
<title>attn_out_L14_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="850358,-78 850208,-78 850208,-26 850358,-26 850358,-78"/>
<text text-anchor="middle" x="850283" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="850283" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="850283" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="850283" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L14_EP1TP3PP1DP1_GPU61 -->
<g id="node4102" class="node">
<title>attn_ar_L14_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="850501" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="850501" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="850501" y="-49.5" font-family="Arial" font-size="10.00">L14 EP1 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="850501" y="-38.5" font-family="Arial" font-size="10.00">GPU61</text>
</g>
<!-- residual1_L14_EP1TP3PP1DP1_GPU61 -->
<g id="node4103" class="node">
<title>residual1_L14_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="850794,-78 850644,-78 850644,-26 850794,-26 850794,-78"/>
<text text-anchor="middle" x="850719" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="850719" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="850719" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="850719" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L14_EP1TP3PP1DP1_GPU61 -->
<g id="node4104" class="node">
<title>ln2_L14_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="850980,-78 850830,-78 850830,-26 850980,-26 850980,-78"/>
<text text-anchor="middle" x="850905" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="850905" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="850905" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="850905" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L14_EP1TP3PP1DP1_GPU61 -->
<g id="node4105" class="node">
<title>gate_L14_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightyellow" stroke="black" points="851327.53,-104 851080.12,-104 851016.47,0 851263.88,0 851327.53,-104"/>
<text text-anchor="middle" x="851172" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="851172" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="851172" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="851172" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L14_EP1TP3PP1DP1_GPU61 -->
<g id="node4106" class="node">
<title>dispatch_L14_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="851470" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="851470" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="851470" y="-44" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP1_GPU61</text>
</g>
<!-- expert_0_L14_EP1TP3PP1DP1_GPU61 -->
<g id="node4107" class="node">
<title>expert_0_L14_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="851762,-78 851612,-78 851612,-26 851762,-26 851762,-78"/>
<text text-anchor="middle" x="851687" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="851687" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="851687" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="851687" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L14_EP1TP3PP1DP1_GPU61 -->
<g id="node4108" class="node">
<title>expert_1_L14_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="851948,-78 851798,-78 851798,-26 851948,-26 851948,-78"/>
<text text-anchor="middle" x="851873" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="851873" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="851873" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="851873" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L14_EP1TP3PP1DP1_GPU61 -->
<g id="node4109" class="node">
<title>expert_2_L14_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="852134,-78 851984,-78 851984,-26 852134,-26 852134,-78"/>
<text text-anchor="middle" x="852059" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="852059" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="852059" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="852059" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L14_EP1TP3PP1DP1_GPU61 -->
<g id="node4110" class="node">
<title>expert_3_L14_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="852320,-78 852170,-78 852170,-26 852320,-26 852320,-78"/>
<text text-anchor="middle" x="852245" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="852245" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="852245" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="852245" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L14_EP1TP3PP1DP1_GPU61 -->
<g id="node4111" class="node">
<title>combine_L14_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="852462" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="852462" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="852462" y="-44" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP1_GPU61</text>
</g>
<!-- ffn_L14_EP1TP3PP1DP1_GPU61 -->
<g id="node4112" class="node">
<title>ffn_L14_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="852774,-78 852604,-78 852604,-26 852774,-26 852774,-78"/>
<text text-anchor="middle" x="852689" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="852689" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="852689" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="852689" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L14_EP1TP3PP1DP1_GPU61 -->
<g id="node4113" class="node">
<title>ffn_ar_L14_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="852917" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="852917" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="852917" y="-49.5" font-family="Arial" font-size="10.00">L14 EP1 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="852917" y="-38.5" font-family="Arial" font-size="10.00">GPU61</text>
</g>
<!-- residual2_L14_EP1TP3PP1DP1_GPU61 -->
<g id="node4114" class="node">
<title>residual2_L14_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="853210,-78 853060,-78 853060,-26 853210,-26 853210,-78"/>
<text text-anchor="middle" x="853135" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="853135" y="-55" font-family="Arial" font-size="10.00">L14_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="853135" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="853135" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L15_EP0TP0PP1DP0_GPU4 -->
<g id="node4115" class="node">
<title>ln1_L15_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="853391.5,-78 853246.5,-78 853246.5,-26 853391.5,-26 853391.5,-78"/>
<text text-anchor="middle" x="853319" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="853319" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="853319" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="853319" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L15_EP0TP0PP1DP0_GPU4 -->
<g id="node4116" class="node">
<title>qkv_L15_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="853572.5,-78 853427.5,-78 853427.5,-26 853572.5,-26 853572.5,-78"/>
<text text-anchor="middle" x="853500" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="853500" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="853500" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="853500" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L15_EP0TP0PP1DP0_GPU4 -->
<g id="node4117" class="node">
<title>attn_L15_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="853759.5,-78 853608.5,-78 853608.5,-26 853759.5,-26 853759.5,-78"/>
<text text-anchor="middle" x="853684" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="853684" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="853684" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="853684" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L15_EP0TP0PP1DP0_GPU4 -->
<g id="node4118" class="node">
<title>attn_out_L15_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="853940.5,-78 853795.5,-78 853795.5,-26 853940.5,-26 853940.5,-78"/>
<text text-anchor="middle" x="853868" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="853868" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="853868" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="853868" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L15_EP0TP0PP1DP0_GPU4 -->
<g id="node4119" class="node">
<title>attn_ar_L15_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="854083" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="854083" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="854083" y="-49.5" font-family="Arial" font-size="10.00">L15 EP0 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="854083" y="-38.5" font-family="Arial" font-size="10.00">GPU4</text>
</g>
<!-- residual1_L15_EP0TP0PP1DP0_GPU4 -->
<g id="node4120" class="node">
<title>residual1_L15_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="854372,-78 854226,-78 854226,-26 854372,-26 854372,-78"/>
<text text-anchor="middle" x="854299" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="854299" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="854299" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="854299" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L15_EP0TP0PP1DP0_GPU4 -->
<g id="node4121" class="node">
<title>ln2_L15_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="854553.5,-78 854408.5,-78 854408.5,-26 854553.5,-26 854553.5,-78"/>
<text text-anchor="middle" x="854481" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="854481" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="854481" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="854481" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L15_EP0TP0PP1DP0_GPU4 -->
<g id="node4122" class="node">
<title>gate_L15_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightyellow" stroke="black" points="854890.16,-104 854651.29,-104 854589.84,0 854828.71,0 854890.16,-104"/>
<text text-anchor="middle" x="854740" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="854740" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="854740" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="854740" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L15_EP0TP0PP1DP0_GPU4 -->
<g id="node4123" class="node">
<title>dispatch_L15_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="855029" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="855029" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="855029" y="-44" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP0_GPU4</text>
</g>
<!-- expert_0_L15_EP0TP0PP1DP0_GPU4 -->
<g id="node4124" class="node">
<title>expert_0_L15_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="855312.5,-78 855167.5,-78 855167.5,-26 855312.5,-26 855312.5,-78"/>
<text text-anchor="middle" x="855240" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="855240" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="855240" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="855240" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L15_EP0TP0PP1DP0_GPU4 -->
<g id="node4125" class="node">
<title>expert_1_L15_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="855493.5,-78 855348.5,-78 855348.5,-26 855493.5,-26 855493.5,-78"/>
<text text-anchor="middle" x="855421" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="855421" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="855421" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="855421" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L15_EP0TP0PP1DP0_GPU4 -->
<g id="node4126" class="node">
<title>expert_2_L15_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="855674.5,-78 855529.5,-78 855529.5,-26 855674.5,-26 855674.5,-78"/>
<text text-anchor="middle" x="855602" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="855602" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="855602" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="855602" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L15_EP0TP0PP1DP0_GPU4 -->
<g id="node4127" class="node">
<title>expert_3_L15_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="855855.5,-78 855710.5,-78 855710.5,-26 855855.5,-26 855855.5,-78"/>
<text text-anchor="middle" x="855783" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="855783" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="855783" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="855783" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L15_EP0TP0PP1DP0_GPU4 -->
<g id="node4128" class="node">
<title>combine_L15_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="855994" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="855994" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="855994" y="-44" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP0_GPU4</text>
</g>
<!-- ffn_L15_EP0TP0PP1DP0_GPU4 -->
<g id="node4129" class="node">
<title>ffn_L15_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="856303,-78 856133,-78 856133,-26 856303,-26 856303,-78"/>
<text text-anchor="middle" x="856218" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="856218" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="856218" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="856218" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L15_EP0TP0PP1DP0_GPU4 -->
<g id="node4130" class="node">
<title>ffn_ar_L15_EP0TP0PP1DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="856446" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="856446" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="856446" y="-49.5" font-family="Arial" font-size="10.00">L15 EP0 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="856446" y="-38.5" font-family="Arial" font-size="10.00">GPU4</text>
</g>
<!-- residual2_L15_EP0TP0PP1DP0_GPU4 -->
<g id="node4131" class="node">
<title>residual2_L15_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="856735,-78 856589,-78 856589,-26 856735,-26 856735,-78"/>
<text text-anchor="middle" x="856662" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="856662" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="856662" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="856662" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L15_EP0TP0PP1DP1_GPU5 -->
<g id="node4132" class="node">
<title>ln1_L15_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="856916.5,-78 856771.5,-78 856771.5,-26 856916.5,-26 856916.5,-78"/>
<text text-anchor="middle" x="856844" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="856844" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="856844" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="856844" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L15_EP0TP0PP1DP1_GPU5 -->
<g id="node4133" class="node">
<title>qkv_L15_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="857097.5,-78 856952.5,-78 856952.5,-26 857097.5,-26 857097.5,-78"/>
<text text-anchor="middle" x="857025" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="857025" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="857025" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="857025" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L15_EP0TP0PP1DP1_GPU5 -->
<g id="node4134" class="node">
<title>attn_L15_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="857284.5,-78 857133.5,-78 857133.5,-26 857284.5,-26 857284.5,-78"/>
<text text-anchor="middle" x="857209" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="857209" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="857209" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="857209" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L15_EP0TP0PP1DP1_GPU5 -->
<g id="node4135" class="node">
<title>attn_out_L15_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="857465.5,-78 857320.5,-78 857320.5,-26 857465.5,-26 857465.5,-78"/>
<text text-anchor="middle" x="857393" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="857393" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="857393" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="857393" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L15_EP0TP0PP1DP1_GPU5 -->
<g id="node4136" class="node">
<title>attn_ar_L15_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="857608" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="857608" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="857608" y="-49.5" font-family="Arial" font-size="10.00">L15 EP0 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="857608" y="-38.5" font-family="Arial" font-size="10.00">GPU5</text>
</g>
<!-- residual1_L15_EP0TP0PP1DP1_GPU5 -->
<g id="node4137" class="node">
<title>residual1_L15_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="857897,-78 857751,-78 857751,-26 857897,-26 857897,-78"/>
<text text-anchor="middle" x="857824" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="857824" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="857824" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="857824" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L15_EP0TP0PP1DP1_GPU5 -->
<g id="node4138" class="node">
<title>ln2_L15_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="858078.5,-78 857933.5,-78 857933.5,-26 858078.5,-26 858078.5,-78"/>
<text text-anchor="middle" x="858006" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="858006" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="858006" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="858006" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L15_EP0TP0PP1DP1_GPU5 -->
<g id="node4139" class="node">
<title>gate_L15_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightyellow" stroke="black" points="858415.16,-104 858176.29,-104 858114.84,0 858353.71,0 858415.16,-104"/>
<text text-anchor="middle" x="858265" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="858265" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="858265" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="858265" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L15_EP0TP0PP1DP1_GPU5 -->
<g id="node4140" class="node">
<title>dispatch_L15_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="858554" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="858554" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="858554" y="-44" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP1_GPU5</text>
</g>
<!-- expert_0_L15_EP0TP0PP1DP1_GPU5 -->
<g id="node4141" class="node">
<title>expert_0_L15_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="858837.5,-78 858692.5,-78 858692.5,-26 858837.5,-26 858837.5,-78"/>
<text text-anchor="middle" x="858765" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="858765" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="858765" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="858765" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L15_EP0TP0PP1DP1_GPU5 -->
<g id="node4142" class="node">
<title>expert_1_L15_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="859018.5,-78 858873.5,-78 858873.5,-26 859018.5,-26 859018.5,-78"/>
<text text-anchor="middle" x="858946" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="858946" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="858946" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="858946" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L15_EP0TP0PP1DP1_GPU5 -->
<g id="node4143" class="node">
<title>expert_2_L15_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="859199.5,-78 859054.5,-78 859054.5,-26 859199.5,-26 859199.5,-78"/>
<text text-anchor="middle" x="859127" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="859127" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="859127" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="859127" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L15_EP0TP0PP1DP1_GPU5 -->
<g id="node4144" class="node">
<title>expert_3_L15_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="859380.5,-78 859235.5,-78 859235.5,-26 859380.5,-26 859380.5,-78"/>
<text text-anchor="middle" x="859308" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="859308" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="859308" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="859308" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L15_EP0TP0PP1DP1_GPU5 -->
<g id="node4145" class="node">
<title>combine_L15_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="859519" cy="-52" rx="102.56" ry="21.43"/>
<text text-anchor="middle" x="859519" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="859519" y="-44" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP1_GPU5</text>
</g>
<!-- ffn_L15_EP0TP0PP1DP1_GPU5 -->
<g id="node4146" class="node">
<title>ffn_L15_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="859828,-78 859658,-78 859658,-26 859828,-26 859828,-78"/>
<text text-anchor="middle" x="859743" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="859743" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="859743" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="859743" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L15_EP0TP0PP1DP1_GPU5 -->
<g id="node4147" class="node">
<title>ffn_ar_L15_EP0TP0PP1DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="859971" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="859971" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="859971" y="-49.5" font-family="Arial" font-size="10.00">L15 EP0 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="859971" y="-38.5" font-family="Arial" font-size="10.00">GPU5</text>
</g>
<!-- residual2_L15_EP0TP0PP1DP1_GPU5 -->
<g id="node4148" class="node">
<title>residual2_L15_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="860260,-78 860114,-78 860114,-26 860260,-26 860260,-78"/>
<text text-anchor="middle" x="860187" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="860187" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="860187" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="860187" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L15_EP0TP1PP1DP0_GPU12 -->
<g id="node4149" class="node">
<title>ln1_L15_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="860446,-78 860296,-78 860296,-26 860446,-26 860446,-78"/>
<text text-anchor="middle" x="860371" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="860371" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="860371" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="860371" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L15_EP0TP1PP1DP0_GPU12 -->
<g id="node4150" class="node">
<title>qkv_L15_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="860632,-78 860482,-78 860482,-26 860632,-26 860632,-78"/>
<text text-anchor="middle" x="860557" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="860557" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="860557" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="860557" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L15_EP0TP1PP1DP0_GPU12 -->
<g id="node4151" class="node">
<title>attn_L15_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="860819.5,-78 860668.5,-78 860668.5,-26 860819.5,-26 860819.5,-78"/>
<text text-anchor="middle" x="860744" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="860744" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="860744" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="860744" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L15_EP0TP1PP1DP0_GPU12 -->
<g id="node4152" class="node">
<title>attn_out_L15_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="861006,-78 860856,-78 860856,-26 861006,-26 861006,-78"/>
<text text-anchor="middle" x="860931" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="860931" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="860931" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="860931" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L15_EP0TP1PP1DP0_GPU12 -->
<g id="node4153" class="node">
<title>attn_ar_L15_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="861149" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="861149" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="861149" y="-49.5" font-family="Arial" font-size="10.00">L15 EP0 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="861149" y="-38.5" font-family="Arial" font-size="10.00">GPU12</text>
</g>
<!-- residual1_L15_EP0TP1PP1DP0_GPU12 -->
<g id="node4154" class="node">
<title>residual1_L15_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="861442,-78 861292,-78 861292,-26 861442,-26 861442,-78"/>
<text text-anchor="middle" x="861367" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="861367" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="861367" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="861367" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L15_EP0TP1PP1DP0_GPU12 -->
<g id="node4155" class="node">
<title>ln2_L15_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="861628,-78 861478,-78 861478,-26 861628,-26 861628,-78"/>
<text text-anchor="middle" x="861553" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="861553" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="861553" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="861553" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L15_EP0TP1PP1DP0_GPU12 -->
<g id="node4156" class="node">
<title>gate_L15_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightyellow" stroke="black" points="861975.53,-104 861728.12,-104 861664.47,0 861911.88,0 861975.53,-104"/>
<text text-anchor="middle" x="861820" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="861820" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="861820" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="861820" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L15_EP0TP1PP1DP0_GPU12 -->
<g id="node4157" class="node">
<title>dispatch_L15_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="862118" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="862118" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="862118" y="-44" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP0_GPU12</text>
</g>
<!-- expert_0_L15_EP0TP1PP1DP0_GPU12 -->
<g id="node4158" class="node">
<title>expert_0_L15_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="862410,-78 862260,-78 862260,-26 862410,-26 862410,-78"/>
<text text-anchor="middle" x="862335" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="862335" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="862335" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="862335" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L15_EP0TP1PP1DP0_GPU12 -->
<g id="node4159" class="node">
<title>expert_1_L15_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="862596,-78 862446,-78 862446,-26 862596,-26 862596,-78"/>
<text text-anchor="middle" x="862521" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="862521" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="862521" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="862521" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L15_EP0TP1PP1DP0_GPU12 -->
<g id="node4160" class="node">
<title>expert_2_L15_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="862782,-78 862632,-78 862632,-26 862782,-26 862782,-78"/>
<text text-anchor="middle" x="862707" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="862707" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="862707" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="862707" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L15_EP0TP1PP1DP0_GPU12 -->
<g id="node4161" class="node">
<title>expert_3_L15_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="862968,-78 862818,-78 862818,-26 862968,-26 862968,-78"/>
<text text-anchor="middle" x="862893" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="862893" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="862893" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="862893" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L15_EP0TP1PP1DP0_GPU12 -->
<g id="node4162" class="node">
<title>combine_L15_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="863110" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="863110" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="863110" y="-44" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP0_GPU12</text>
</g>
<!-- ffn_L15_EP0TP1PP1DP0_GPU12 -->
<g id="node4163" class="node">
<title>ffn_L15_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="863422,-78 863252,-78 863252,-26 863422,-26 863422,-78"/>
<text text-anchor="middle" x="863337" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="863337" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="863337" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="863337" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L15_EP0TP1PP1DP0_GPU12 -->
<g id="node4164" class="node">
<title>ffn_ar_L15_EP0TP1PP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="863565" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="863565" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="863565" y="-49.5" font-family="Arial" font-size="10.00">L15 EP0 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="863565" y="-38.5" font-family="Arial" font-size="10.00">GPU12</text>
</g>
<!-- residual2_L15_EP0TP1PP1DP0_GPU12 -->
<g id="node4165" class="node">
<title>residual2_L15_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="863858,-78 863708,-78 863708,-26 863858,-26 863858,-78"/>
<text text-anchor="middle" x="863783" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="863783" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="863783" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="863783" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L15_EP0TP1PP1DP1_GPU13 -->
<g id="node4166" class="node">
<title>ln1_L15_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="864044,-78 863894,-78 863894,-26 864044,-26 864044,-78"/>
<text text-anchor="middle" x="863969" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="863969" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="863969" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="863969" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L15_EP0TP1PP1DP1_GPU13 -->
<g id="node4167" class="node">
<title>qkv_L15_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="864230,-78 864080,-78 864080,-26 864230,-26 864230,-78"/>
<text text-anchor="middle" x="864155" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="864155" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="864155" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="864155" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L15_EP0TP1PP1DP1_GPU13 -->
<g id="node4168" class="node">
<title>attn_L15_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="864417.5,-78 864266.5,-78 864266.5,-26 864417.5,-26 864417.5,-78"/>
<text text-anchor="middle" x="864342" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="864342" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="864342" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="864342" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L15_EP0TP1PP1DP1_GPU13 -->
<g id="node4169" class="node">
<title>attn_out_L15_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="864604,-78 864454,-78 864454,-26 864604,-26 864604,-78"/>
<text text-anchor="middle" x="864529" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="864529" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="864529" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="864529" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L15_EP0TP1PP1DP1_GPU13 -->
<g id="node4170" class="node">
<title>attn_ar_L15_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="864747" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="864747" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="864747" y="-49.5" font-family="Arial" font-size="10.00">L15 EP0 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="864747" y="-38.5" font-family="Arial" font-size="10.00">GPU13</text>
</g>
<!-- residual1_L15_EP0TP1PP1DP1_GPU13 -->
<g id="node4171" class="node">
<title>residual1_L15_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="865040,-78 864890,-78 864890,-26 865040,-26 865040,-78"/>
<text text-anchor="middle" x="864965" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="864965" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="864965" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="864965" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L15_EP0TP1PP1DP1_GPU13 -->
<g id="node4172" class="node">
<title>ln2_L15_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="865226,-78 865076,-78 865076,-26 865226,-26 865226,-78"/>
<text text-anchor="middle" x="865151" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="865151" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="865151" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="865151" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L15_EP0TP1PP1DP1_GPU13 -->
<g id="node4173" class="node">
<title>gate_L15_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightyellow" stroke="black" points="865573.53,-104 865326.12,-104 865262.47,0 865509.88,0 865573.53,-104"/>
<text text-anchor="middle" x="865418" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="865418" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="865418" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="865418" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L15_EP0TP1PP1DP1_GPU13 -->
<g id="node4174" class="node">
<title>dispatch_L15_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="865716" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="865716" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="865716" y="-44" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP1_GPU13</text>
</g>
<!-- expert_0_L15_EP0TP1PP1DP1_GPU13 -->
<g id="node4175" class="node">
<title>expert_0_L15_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="866008,-78 865858,-78 865858,-26 866008,-26 866008,-78"/>
<text text-anchor="middle" x="865933" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="865933" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="865933" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="865933" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L15_EP0TP1PP1DP1_GPU13 -->
<g id="node4176" class="node">
<title>expert_1_L15_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="866194,-78 866044,-78 866044,-26 866194,-26 866194,-78"/>
<text text-anchor="middle" x="866119" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="866119" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="866119" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="866119" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L15_EP0TP1PP1DP1_GPU13 -->
<g id="node4177" class="node">
<title>expert_2_L15_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="866380,-78 866230,-78 866230,-26 866380,-26 866380,-78"/>
<text text-anchor="middle" x="866305" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="866305" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="866305" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="866305" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L15_EP0TP1PP1DP1_GPU13 -->
<g id="node4178" class="node">
<title>expert_3_L15_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="866566,-78 866416,-78 866416,-26 866566,-26 866566,-78"/>
<text text-anchor="middle" x="866491" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="866491" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="866491" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="866491" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L15_EP0TP1PP1DP1_GPU13 -->
<g id="node4179" class="node">
<title>combine_L15_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="866708" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="866708" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="866708" y="-44" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP1_GPU13</text>
</g>
<!-- ffn_L15_EP0TP1PP1DP1_GPU13 -->
<g id="node4180" class="node">
<title>ffn_L15_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="867020,-78 866850,-78 866850,-26 867020,-26 867020,-78"/>
<text text-anchor="middle" x="866935" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="866935" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="866935" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="866935" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L15_EP0TP1PP1DP1_GPU13 -->
<g id="node4181" class="node">
<title>ffn_ar_L15_EP0TP1PP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="867163" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="867163" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="867163" y="-49.5" font-family="Arial" font-size="10.00">L15 EP0 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="867163" y="-38.5" font-family="Arial" font-size="10.00">GPU13</text>
</g>
<!-- residual2_L15_EP0TP1PP1DP1_GPU13 -->
<g id="node4182" class="node">
<title>residual2_L15_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="867456,-78 867306,-78 867306,-26 867456,-26 867456,-78"/>
<text text-anchor="middle" x="867381" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="867381" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="867381" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="867381" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L15_EP0TP2PP1DP0_GPU20 -->
<g id="node4183" class="node">
<title>ln1_L15_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="867642,-78 867492,-78 867492,-26 867642,-26 867642,-78"/>
<text text-anchor="middle" x="867567" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="867567" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="867567" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="867567" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L15_EP0TP2PP1DP0_GPU20 -->
<g id="node4184" class="node">
<title>qkv_L15_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="867828,-78 867678,-78 867678,-26 867828,-26 867828,-78"/>
<text text-anchor="middle" x="867753" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="867753" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="867753" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="867753" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L15_EP0TP2PP1DP0_GPU20 -->
<g id="node4185" class="node">
<title>attn_L15_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="868015.5,-78 867864.5,-78 867864.5,-26 868015.5,-26 868015.5,-78"/>
<text text-anchor="middle" x="867940" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="867940" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="867940" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="867940" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L15_EP0TP2PP1DP0_GPU20 -->
<g id="node4186" class="node">
<title>attn_out_L15_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="868202,-78 868052,-78 868052,-26 868202,-26 868202,-78"/>
<text text-anchor="middle" x="868127" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="868127" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="868127" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="868127" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L15_EP0TP2PP1DP0_GPU20 -->
<g id="node4187" class="node">
<title>attn_ar_L15_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="868345" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="868345" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="868345" y="-49.5" font-family="Arial" font-size="10.00">L15 EP0 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="868345" y="-38.5" font-family="Arial" font-size="10.00">GPU20</text>
</g>
<!-- residual1_L15_EP0TP2PP1DP0_GPU20 -->
<g id="node4188" class="node">
<title>residual1_L15_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="868638,-78 868488,-78 868488,-26 868638,-26 868638,-78"/>
<text text-anchor="middle" x="868563" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="868563" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="868563" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="868563" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L15_EP0TP2PP1DP0_GPU20 -->
<g id="node4189" class="node">
<title>ln2_L15_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="868824,-78 868674,-78 868674,-26 868824,-26 868824,-78"/>
<text text-anchor="middle" x="868749" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="868749" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="868749" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="868749" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L15_EP0TP2PP1DP0_GPU20 -->
<g id="node4190" class="node">
<title>gate_L15_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightyellow" stroke="black" points="869171.53,-104 868924.12,-104 868860.47,0 869107.88,0 869171.53,-104"/>
<text text-anchor="middle" x="869016" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="869016" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="869016" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="869016" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L15_EP0TP2PP1DP0_GPU20 -->
<g id="node4191" class="node">
<title>dispatch_L15_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="869314" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="869314" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="869314" y="-44" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP0_GPU20</text>
</g>
<!-- expert_0_L15_EP0TP2PP1DP0_GPU20 -->
<g id="node4192" class="node">
<title>expert_0_L15_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="869606,-78 869456,-78 869456,-26 869606,-26 869606,-78"/>
<text text-anchor="middle" x="869531" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="869531" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="869531" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="869531" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L15_EP0TP2PP1DP0_GPU20 -->
<g id="node4193" class="node">
<title>expert_1_L15_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="869792,-78 869642,-78 869642,-26 869792,-26 869792,-78"/>
<text text-anchor="middle" x="869717" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="869717" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="869717" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="869717" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L15_EP0TP2PP1DP0_GPU20 -->
<g id="node4194" class="node">
<title>expert_2_L15_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="869978,-78 869828,-78 869828,-26 869978,-26 869978,-78"/>
<text text-anchor="middle" x="869903" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="869903" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="869903" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="869903" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L15_EP0TP2PP1DP0_GPU20 -->
<g id="node4195" class="node">
<title>expert_3_L15_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="870164,-78 870014,-78 870014,-26 870164,-26 870164,-78"/>
<text text-anchor="middle" x="870089" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="870089" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="870089" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="870089" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L15_EP0TP2PP1DP0_GPU20 -->
<g id="node4196" class="node">
<title>combine_L15_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="870306" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="870306" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="870306" y="-44" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP0_GPU20</text>
</g>
<!-- ffn_L15_EP0TP2PP1DP0_GPU20 -->
<g id="node4197" class="node">
<title>ffn_L15_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="870618,-78 870448,-78 870448,-26 870618,-26 870618,-78"/>
<text text-anchor="middle" x="870533" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="870533" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="870533" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="870533" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L15_EP0TP2PP1DP0_GPU20 -->
<g id="node4198" class="node">
<title>ffn_ar_L15_EP0TP2PP1DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="870761" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="870761" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="870761" y="-49.5" font-family="Arial" font-size="10.00">L15 EP0 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="870761" y="-38.5" font-family="Arial" font-size="10.00">GPU20</text>
</g>
<!-- residual2_L15_EP0TP2PP1DP0_GPU20 -->
<g id="node4199" class="node">
<title>residual2_L15_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="871054,-78 870904,-78 870904,-26 871054,-26 871054,-78"/>
<text text-anchor="middle" x="870979" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="870979" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="870979" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="870979" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L15_EP0TP2PP1DP1_GPU21 -->
<g id="node4200" class="node">
<title>ln1_L15_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="871240,-78 871090,-78 871090,-26 871240,-26 871240,-78"/>
<text text-anchor="middle" x="871165" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="871165" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="871165" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="871165" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L15_EP0TP2PP1DP1_GPU21 -->
<g id="node4201" class="node">
<title>qkv_L15_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="871426,-78 871276,-78 871276,-26 871426,-26 871426,-78"/>
<text text-anchor="middle" x="871351" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="871351" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="871351" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="871351" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L15_EP0TP2PP1DP1_GPU21 -->
<g id="node4202" class="node">
<title>attn_L15_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="871613.5,-78 871462.5,-78 871462.5,-26 871613.5,-26 871613.5,-78"/>
<text text-anchor="middle" x="871538" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="871538" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="871538" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="871538" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L15_EP0TP2PP1DP1_GPU21 -->
<g id="node4203" class="node">
<title>attn_out_L15_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="871800,-78 871650,-78 871650,-26 871800,-26 871800,-78"/>
<text text-anchor="middle" x="871725" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="871725" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="871725" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="871725" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L15_EP0TP2PP1DP1_GPU21 -->
<g id="node4204" class="node">
<title>attn_ar_L15_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="871943" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="871943" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="871943" y="-49.5" font-family="Arial" font-size="10.00">L15 EP0 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="871943" y="-38.5" font-family="Arial" font-size="10.00">GPU21</text>
</g>
<!-- residual1_L15_EP0TP2PP1DP1_GPU21 -->
<g id="node4205" class="node">
<title>residual1_L15_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="872236,-78 872086,-78 872086,-26 872236,-26 872236,-78"/>
<text text-anchor="middle" x="872161" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="872161" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="872161" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="872161" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L15_EP0TP2PP1DP1_GPU21 -->
<g id="node4206" class="node">
<title>ln2_L15_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="872422,-78 872272,-78 872272,-26 872422,-26 872422,-78"/>
<text text-anchor="middle" x="872347" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="872347" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="872347" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="872347" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L15_EP0TP2PP1DP1_GPU21 -->
<g id="node4207" class="node">
<title>gate_L15_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightyellow" stroke="black" points="872769.53,-104 872522.12,-104 872458.47,0 872705.88,0 872769.53,-104"/>
<text text-anchor="middle" x="872614" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="872614" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="872614" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="872614" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L15_EP0TP2PP1DP1_GPU21 -->
<g id="node4208" class="node">
<title>dispatch_L15_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="872912" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="872912" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="872912" y="-44" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP1_GPU21</text>
</g>
<!-- expert_0_L15_EP0TP2PP1DP1_GPU21 -->
<g id="node4209" class="node">
<title>expert_0_L15_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="873204,-78 873054,-78 873054,-26 873204,-26 873204,-78"/>
<text text-anchor="middle" x="873129" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="873129" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="873129" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="873129" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L15_EP0TP2PP1DP1_GPU21 -->
<g id="node4210" class="node">
<title>expert_1_L15_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="873390,-78 873240,-78 873240,-26 873390,-26 873390,-78"/>
<text text-anchor="middle" x="873315" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="873315" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="873315" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="873315" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L15_EP0TP2PP1DP1_GPU21 -->
<g id="node4211" class="node">
<title>expert_2_L15_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="873576,-78 873426,-78 873426,-26 873576,-26 873576,-78"/>
<text text-anchor="middle" x="873501" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="873501" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="873501" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="873501" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L15_EP0TP2PP1DP1_GPU21 -->
<g id="node4212" class="node">
<title>expert_3_L15_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="873762,-78 873612,-78 873612,-26 873762,-26 873762,-78"/>
<text text-anchor="middle" x="873687" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="873687" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="873687" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="873687" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L15_EP0TP2PP1DP1_GPU21 -->
<g id="node4213" class="node">
<title>combine_L15_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="873904" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="873904" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="873904" y="-44" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP1_GPU21</text>
</g>
<!-- ffn_L15_EP0TP2PP1DP1_GPU21 -->
<g id="node4214" class="node">
<title>ffn_L15_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="874216,-78 874046,-78 874046,-26 874216,-26 874216,-78"/>
<text text-anchor="middle" x="874131" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="874131" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="874131" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="874131" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L15_EP0TP2PP1DP1_GPU21 -->
<g id="node4215" class="node">
<title>ffn_ar_L15_EP0TP2PP1DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="874359" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="874359" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="874359" y="-49.5" font-family="Arial" font-size="10.00">L15 EP0 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="874359" y="-38.5" font-family="Arial" font-size="10.00">GPU21</text>
</g>
<!-- residual2_L15_EP0TP2PP1DP1_GPU21 -->
<g id="node4216" class="node">
<title>residual2_L15_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="874652,-78 874502,-78 874502,-26 874652,-26 874652,-78"/>
<text text-anchor="middle" x="874577" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="874577" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="874577" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="874577" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L15_EP0TP3PP1DP0_GPU28 -->
<g id="node4217" class="node">
<title>ln1_L15_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="874838,-78 874688,-78 874688,-26 874838,-26 874838,-78"/>
<text text-anchor="middle" x="874763" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="874763" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="874763" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="874763" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L15_EP0TP3PP1DP0_GPU28 -->
<g id="node4218" class="node">
<title>qkv_L15_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="875024,-78 874874,-78 874874,-26 875024,-26 875024,-78"/>
<text text-anchor="middle" x="874949" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="874949" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="874949" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="874949" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L15_EP0TP3PP1DP0_GPU28 -->
<g id="node4219" class="node">
<title>attn_L15_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="875211.5,-78 875060.5,-78 875060.5,-26 875211.5,-26 875211.5,-78"/>
<text text-anchor="middle" x="875136" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="875136" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="875136" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="875136" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L15_EP0TP3PP1DP0_GPU28 -->
<g id="node4220" class="node">
<title>attn_out_L15_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="875398,-78 875248,-78 875248,-26 875398,-26 875398,-78"/>
<text text-anchor="middle" x="875323" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="875323" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="875323" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="875323" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L15_EP0TP3PP1DP0_GPU28 -->
<g id="node4221" class="node">
<title>attn_ar_L15_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="875541" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="875541" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="875541" y="-49.5" font-family="Arial" font-size="10.00">L15 EP0 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="875541" y="-38.5" font-family="Arial" font-size="10.00">GPU28</text>
</g>
<!-- residual1_L15_EP0TP3PP1DP0_GPU28 -->
<g id="node4222" class="node">
<title>residual1_L15_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="875834,-78 875684,-78 875684,-26 875834,-26 875834,-78"/>
<text text-anchor="middle" x="875759" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="875759" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="875759" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="875759" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L15_EP0TP3PP1DP0_GPU28 -->
<g id="node4223" class="node">
<title>ln2_L15_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="876020,-78 875870,-78 875870,-26 876020,-26 876020,-78"/>
<text text-anchor="middle" x="875945" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="875945" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="875945" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="875945" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L15_EP0TP3PP1DP0_GPU28 -->
<g id="node4224" class="node">
<title>gate_L15_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightyellow" stroke="black" points="876367.53,-104 876120.12,-104 876056.47,0 876303.88,0 876367.53,-104"/>
<text text-anchor="middle" x="876212" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="876212" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="876212" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="876212" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L15_EP0TP3PP1DP0_GPU28 -->
<g id="node4225" class="node">
<title>dispatch_L15_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="876510" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="876510" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="876510" y="-44" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP0_GPU28</text>
</g>
<!-- expert_0_L15_EP0TP3PP1DP0_GPU28 -->
<g id="node4226" class="node">
<title>expert_0_L15_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="876802,-78 876652,-78 876652,-26 876802,-26 876802,-78"/>
<text text-anchor="middle" x="876727" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="876727" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="876727" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="876727" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L15_EP0TP3PP1DP0_GPU28 -->
<g id="node4227" class="node">
<title>expert_1_L15_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="876988,-78 876838,-78 876838,-26 876988,-26 876988,-78"/>
<text text-anchor="middle" x="876913" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="876913" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="876913" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="876913" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L15_EP0TP3PP1DP0_GPU28 -->
<g id="node4228" class="node">
<title>expert_2_L15_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="877174,-78 877024,-78 877024,-26 877174,-26 877174,-78"/>
<text text-anchor="middle" x="877099" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="877099" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="877099" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="877099" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L15_EP0TP3PP1DP0_GPU28 -->
<g id="node4229" class="node">
<title>expert_3_L15_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="877360,-78 877210,-78 877210,-26 877360,-26 877360,-78"/>
<text text-anchor="middle" x="877285" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="877285" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="877285" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="877285" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L15_EP0TP3PP1DP0_GPU28 -->
<g id="node4230" class="node">
<title>combine_L15_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="877502" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="877502" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="877502" y="-44" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP0_GPU28</text>
</g>
<!-- ffn_L15_EP0TP3PP1DP0_GPU28 -->
<g id="node4231" class="node">
<title>ffn_L15_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="877814,-78 877644,-78 877644,-26 877814,-26 877814,-78"/>
<text text-anchor="middle" x="877729" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="877729" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="877729" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="877729" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L15_EP0TP3PP1DP0_GPU28 -->
<g id="node4232" class="node">
<title>ffn_ar_L15_EP0TP3PP1DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="877957" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="877957" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="877957" y="-49.5" font-family="Arial" font-size="10.00">L15 EP0 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="877957" y="-38.5" font-family="Arial" font-size="10.00">GPU28</text>
</g>
<!-- residual2_L15_EP0TP3PP1DP0_GPU28 -->
<g id="node4233" class="node">
<title>residual2_L15_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="878250,-78 878100,-78 878100,-26 878250,-26 878250,-78"/>
<text text-anchor="middle" x="878175" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="878175" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="878175" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="878175" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L15_EP0TP3PP1DP1_GPU29 -->
<g id="node4234" class="node">
<title>ln1_L15_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="878436,-78 878286,-78 878286,-26 878436,-26 878436,-78"/>
<text text-anchor="middle" x="878361" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="878361" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="878361" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="878361" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L15_EP0TP3PP1DP1_GPU29 -->
<g id="node4235" class="node">
<title>qkv_L15_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="878622,-78 878472,-78 878472,-26 878622,-26 878622,-78"/>
<text text-anchor="middle" x="878547" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="878547" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="878547" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="878547" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L15_EP0TP3PP1DP1_GPU29 -->
<g id="node4236" class="node">
<title>attn_L15_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="878809.5,-78 878658.5,-78 878658.5,-26 878809.5,-26 878809.5,-78"/>
<text text-anchor="middle" x="878734" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="878734" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="878734" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="878734" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L15_EP0TP3PP1DP1_GPU29 -->
<g id="node4237" class="node">
<title>attn_out_L15_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="878996,-78 878846,-78 878846,-26 878996,-26 878996,-78"/>
<text text-anchor="middle" x="878921" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="878921" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="878921" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="878921" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L15_EP0TP3PP1DP1_GPU29 -->
<g id="node4238" class="node">
<title>attn_ar_L15_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="879139" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="879139" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="879139" y="-49.5" font-family="Arial" font-size="10.00">L15 EP0 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="879139" y="-38.5" font-family="Arial" font-size="10.00">GPU29</text>
</g>
<!-- residual1_L15_EP0TP3PP1DP1_GPU29 -->
<g id="node4239" class="node">
<title>residual1_L15_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="879432,-78 879282,-78 879282,-26 879432,-26 879432,-78"/>
<text text-anchor="middle" x="879357" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="879357" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="879357" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="879357" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L15_EP0TP3PP1DP1_GPU29 -->
<g id="node4240" class="node">
<title>ln2_L15_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="879618,-78 879468,-78 879468,-26 879618,-26 879618,-78"/>
<text text-anchor="middle" x="879543" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="879543" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="879543" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="879543" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L15_EP0TP3PP1DP1_GPU29 -->
<g id="node4241" class="node">
<title>gate_L15_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightyellow" stroke="black" points="879965.53,-104 879718.12,-104 879654.47,0 879901.88,0 879965.53,-104"/>
<text text-anchor="middle" x="879810" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="879810" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="879810" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="879810" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L15_EP0TP3PP1DP1_GPU29 -->
<g id="node4242" class="node">
<title>dispatch_L15_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="880108" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="880108" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="880108" y="-44" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP1_GPU29</text>
</g>
<!-- expert_0_L15_EP0TP3PP1DP1_GPU29 -->
<g id="node4243" class="node">
<title>expert_0_L15_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="880400,-78 880250,-78 880250,-26 880400,-26 880400,-78"/>
<text text-anchor="middle" x="880325" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="880325" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="880325" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="880325" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L15_EP0TP3PP1DP1_GPU29 -->
<g id="node4244" class="node">
<title>expert_1_L15_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="880586,-78 880436,-78 880436,-26 880586,-26 880586,-78"/>
<text text-anchor="middle" x="880511" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="880511" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="880511" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="880511" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L15_EP0TP3PP1DP1_GPU29 -->
<g id="node4245" class="node">
<title>expert_2_L15_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="880772,-78 880622,-78 880622,-26 880772,-26 880772,-78"/>
<text text-anchor="middle" x="880697" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="880697" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="880697" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="880697" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L15_EP0TP3PP1DP1_GPU29 -->
<g id="node4246" class="node">
<title>expert_3_L15_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="880958,-78 880808,-78 880808,-26 880958,-26 880958,-78"/>
<text text-anchor="middle" x="880883" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="880883" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="880883" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="880883" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L15_EP0TP3PP1DP1_GPU29 -->
<g id="node4247" class="node">
<title>combine_L15_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="881100" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="881100" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="881100" y="-44" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP1_GPU29</text>
</g>
<!-- ffn_L15_EP0TP3PP1DP1_GPU29 -->
<g id="node4248" class="node">
<title>ffn_L15_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="881412,-78 881242,-78 881242,-26 881412,-26 881412,-78"/>
<text text-anchor="middle" x="881327" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="881327" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="881327" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="881327" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L15_EP0TP3PP1DP1_GPU29 -->
<g id="node4249" class="node">
<title>ffn_ar_L15_EP0TP3PP1DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="881555" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="881555" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="881555" y="-49.5" font-family="Arial" font-size="10.00">L15 EP0 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="881555" y="-38.5" font-family="Arial" font-size="10.00">GPU29</text>
</g>
<!-- residual2_L15_EP0TP3PP1DP1_GPU29 -->
<g id="node4250" class="node">
<title>residual2_L15_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="881848,-78 881698,-78 881698,-26 881848,-26 881848,-78"/>
<text text-anchor="middle" x="881773" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="881773" y="-55" font-family="Arial" font-size="10.00">L15_EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="881773" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="881773" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L15_EP1TP0PP1DP0_GPU36 -->
<g id="node4251" class="node">
<title>ln1_L15_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="882034,-78 881884,-78 881884,-26 882034,-26 882034,-78"/>
<text text-anchor="middle" x="881959" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="881959" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="881959" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="881959" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L15_EP1TP0PP1DP0_GPU36 -->
<g id="node4252" class="node">
<title>qkv_L15_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="882220,-78 882070,-78 882070,-26 882220,-26 882220,-78"/>
<text text-anchor="middle" x="882145" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="882145" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="882145" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="882145" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L15_EP1TP0PP1DP0_GPU36 -->
<g id="node4253" class="node">
<title>attn_L15_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="882407.5,-78 882256.5,-78 882256.5,-26 882407.5,-26 882407.5,-78"/>
<text text-anchor="middle" x="882332" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="882332" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="882332" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="882332" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L15_EP1TP0PP1DP0_GPU36 -->
<g id="node4254" class="node">
<title>attn_out_L15_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="882594,-78 882444,-78 882444,-26 882594,-26 882594,-78"/>
<text text-anchor="middle" x="882519" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="882519" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="882519" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="882519" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L15_EP1TP0PP1DP0_GPU36 -->
<g id="node4255" class="node">
<title>attn_ar_L15_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="882737" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="882737" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="882737" y="-49.5" font-family="Arial" font-size="10.00">L15 EP1 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="882737" y="-38.5" font-family="Arial" font-size="10.00">GPU36</text>
</g>
<!-- residual1_L15_EP1TP0PP1DP0_GPU36 -->
<g id="node4256" class="node">
<title>residual1_L15_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="883030,-78 882880,-78 882880,-26 883030,-26 883030,-78"/>
<text text-anchor="middle" x="882955" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="882955" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="882955" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="882955" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L15_EP1TP0PP1DP0_GPU36 -->
<g id="node4257" class="node">
<title>ln2_L15_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="883216,-78 883066,-78 883066,-26 883216,-26 883216,-78"/>
<text text-anchor="middle" x="883141" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="883141" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="883141" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="883141" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L15_EP1TP0PP1DP0_GPU36 -->
<g id="node4258" class="node">
<title>gate_L15_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightyellow" stroke="black" points="883563.53,-104 883316.12,-104 883252.47,0 883499.88,0 883563.53,-104"/>
<text text-anchor="middle" x="883408" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="883408" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="883408" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="883408" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L15_EP1TP0PP1DP0_GPU36 -->
<g id="node4259" class="node">
<title>dispatch_L15_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="883706" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="883706" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="883706" y="-44" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP0_GPU36</text>
</g>
<!-- expert_0_L15_EP1TP0PP1DP0_GPU36 -->
<g id="node4260" class="node">
<title>expert_0_L15_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="883998,-78 883848,-78 883848,-26 883998,-26 883998,-78"/>
<text text-anchor="middle" x="883923" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="883923" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="883923" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="883923" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L15_EP1TP0PP1DP0_GPU36 -->
<g id="node4261" class="node">
<title>expert_1_L15_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="884184,-78 884034,-78 884034,-26 884184,-26 884184,-78"/>
<text text-anchor="middle" x="884109" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="884109" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="884109" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="884109" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L15_EP1TP0PP1DP0_GPU36 -->
<g id="node4262" class="node">
<title>expert_2_L15_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="884370,-78 884220,-78 884220,-26 884370,-26 884370,-78"/>
<text text-anchor="middle" x="884295" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="884295" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="884295" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="884295" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L15_EP1TP0PP1DP0_GPU36 -->
<g id="node4263" class="node">
<title>expert_3_L15_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="884556,-78 884406,-78 884406,-26 884556,-26 884556,-78"/>
<text text-anchor="middle" x="884481" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="884481" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="884481" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="884481" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L15_EP1TP0PP1DP0_GPU36 -->
<g id="node4264" class="node">
<title>combine_L15_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="884698" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="884698" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="884698" y="-44" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP0_GPU36</text>
</g>
<!-- ffn_L15_EP1TP0PP1DP0_GPU36 -->
<g id="node4265" class="node">
<title>ffn_L15_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="885010,-78 884840,-78 884840,-26 885010,-26 885010,-78"/>
<text text-anchor="middle" x="884925" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="884925" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="884925" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="884925" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L15_EP1TP0PP1DP0_GPU36 -->
<g id="node4266" class="node">
<title>ffn_ar_L15_EP1TP0PP1DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="885153" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="885153" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="885153" y="-49.5" font-family="Arial" font-size="10.00">L15 EP1 TP Group 0 PP1 DP0</text>
<text text-anchor="middle" x="885153" y="-38.5" font-family="Arial" font-size="10.00">GPU36</text>
</g>
<!-- residual2_L15_EP1TP0PP1DP0_GPU36 -->
<g id="node4267" class="node">
<title>residual2_L15_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="885446,-78 885296,-78 885296,-26 885446,-26 885446,-78"/>
<text text-anchor="middle" x="885371" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="885371" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="885371" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="885371" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L15_EP1TP0PP1DP1_GPU37 -->
<g id="node4268" class="node">
<title>ln1_L15_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="885632,-78 885482,-78 885482,-26 885632,-26 885632,-78"/>
<text text-anchor="middle" x="885557" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="885557" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="885557" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="885557" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L15_EP1TP0PP1DP1_GPU37 -->
<g id="node4269" class="node">
<title>qkv_L15_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="885818,-78 885668,-78 885668,-26 885818,-26 885818,-78"/>
<text text-anchor="middle" x="885743" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="885743" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="885743" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="885743" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L15_EP1TP0PP1DP1_GPU37 -->
<g id="node4270" class="node">
<title>attn_L15_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="886005.5,-78 885854.5,-78 885854.5,-26 886005.5,-26 886005.5,-78"/>
<text text-anchor="middle" x="885930" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="885930" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="885930" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="885930" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L15_EP1TP0PP1DP1_GPU37 -->
<g id="node4271" class="node">
<title>attn_out_L15_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="886192,-78 886042,-78 886042,-26 886192,-26 886192,-78"/>
<text text-anchor="middle" x="886117" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="886117" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="886117" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="886117" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L15_EP1TP0PP1DP1_GPU37 -->
<g id="node4272" class="node">
<title>attn_ar_L15_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="886335" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="886335" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="886335" y="-49.5" font-family="Arial" font-size="10.00">L15 EP1 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="886335" y="-38.5" font-family="Arial" font-size="10.00">GPU37</text>
</g>
<!-- residual1_L15_EP1TP0PP1DP1_GPU37 -->
<g id="node4273" class="node">
<title>residual1_L15_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="886628,-78 886478,-78 886478,-26 886628,-26 886628,-78"/>
<text text-anchor="middle" x="886553" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="886553" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="886553" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="886553" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L15_EP1TP0PP1DP1_GPU37 -->
<g id="node4274" class="node">
<title>ln2_L15_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="886814,-78 886664,-78 886664,-26 886814,-26 886814,-78"/>
<text text-anchor="middle" x="886739" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="886739" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="886739" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="886739" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L15_EP1TP0PP1DP1_GPU37 -->
<g id="node4275" class="node">
<title>gate_L15_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightyellow" stroke="black" points="887161.53,-104 886914.12,-104 886850.47,0 887097.88,0 887161.53,-104"/>
<text text-anchor="middle" x="887006" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="887006" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="887006" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="887006" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L15_EP1TP0PP1DP1_GPU37 -->
<g id="node4276" class="node">
<title>dispatch_L15_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="887304" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="887304" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="887304" y="-44" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP1_GPU37</text>
</g>
<!-- expert_0_L15_EP1TP0PP1DP1_GPU37 -->
<g id="node4277" class="node">
<title>expert_0_L15_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="887596,-78 887446,-78 887446,-26 887596,-26 887596,-78"/>
<text text-anchor="middle" x="887521" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="887521" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="887521" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="887521" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L15_EP1TP0PP1DP1_GPU37 -->
<g id="node4278" class="node">
<title>expert_1_L15_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="887782,-78 887632,-78 887632,-26 887782,-26 887782,-78"/>
<text text-anchor="middle" x="887707" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="887707" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="887707" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="887707" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L15_EP1TP0PP1DP1_GPU37 -->
<g id="node4279" class="node">
<title>expert_2_L15_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="887968,-78 887818,-78 887818,-26 887968,-26 887968,-78"/>
<text text-anchor="middle" x="887893" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="887893" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="887893" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="887893" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L15_EP1TP0PP1DP1_GPU37 -->
<g id="node4280" class="node">
<title>expert_3_L15_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="888154,-78 888004,-78 888004,-26 888154,-26 888154,-78"/>
<text text-anchor="middle" x="888079" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="888079" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="888079" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="888079" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L15_EP1TP0PP1DP1_GPU37 -->
<g id="node4281" class="node">
<title>combine_L15_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="888296" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="888296" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="888296" y="-44" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP1_GPU37</text>
</g>
<!-- ffn_L15_EP1TP0PP1DP1_GPU37 -->
<g id="node4282" class="node">
<title>ffn_L15_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="888608,-78 888438,-78 888438,-26 888608,-26 888608,-78"/>
<text text-anchor="middle" x="888523" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="888523" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="888523" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="888523" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L15_EP1TP0PP1DP1_GPU37 -->
<g id="node4283" class="node">
<title>ffn_ar_L15_EP1TP0PP1DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="888751" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="888751" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="888751" y="-49.5" font-family="Arial" font-size="10.00">L15 EP1 TP Group 0 PP1 DP1</text>
<text text-anchor="middle" x="888751" y="-38.5" font-family="Arial" font-size="10.00">GPU37</text>
</g>
<!-- residual2_L15_EP1TP0PP1DP1_GPU37 -->
<g id="node4284" class="node">
<title>residual2_L15_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="889044,-78 888894,-78 888894,-26 889044,-26 889044,-78"/>
<text text-anchor="middle" x="888969" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="888969" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="888969" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="888969" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L15_EP1TP1PP1DP0_GPU44 -->
<g id="node4285" class="node">
<title>ln1_L15_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="889230,-78 889080,-78 889080,-26 889230,-26 889230,-78"/>
<text text-anchor="middle" x="889155" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="889155" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="889155" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="889155" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L15_EP1TP1PP1DP0_GPU44 -->
<g id="node4286" class="node">
<title>qkv_L15_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="889416,-78 889266,-78 889266,-26 889416,-26 889416,-78"/>
<text text-anchor="middle" x="889341" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="889341" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="889341" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="889341" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L15_EP1TP1PP1DP0_GPU44 -->
<g id="node4287" class="node">
<title>attn_L15_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="889603.5,-78 889452.5,-78 889452.5,-26 889603.5,-26 889603.5,-78"/>
<text text-anchor="middle" x="889528" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="889528" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="889528" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="889528" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L15_EP1TP1PP1DP0_GPU44 -->
<g id="node4288" class="node">
<title>attn_out_L15_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="889790,-78 889640,-78 889640,-26 889790,-26 889790,-78"/>
<text text-anchor="middle" x="889715" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="889715" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="889715" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="889715" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L15_EP1TP1PP1DP0_GPU44 -->
<g id="node4289" class="node">
<title>attn_ar_L15_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="889933" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="889933" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="889933" y="-49.5" font-family="Arial" font-size="10.00">L15 EP1 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="889933" y="-38.5" font-family="Arial" font-size="10.00">GPU44</text>
</g>
<!-- residual1_L15_EP1TP1PP1DP0_GPU44 -->
<g id="node4290" class="node">
<title>residual1_L15_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="890226,-78 890076,-78 890076,-26 890226,-26 890226,-78"/>
<text text-anchor="middle" x="890151" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="890151" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="890151" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="890151" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L15_EP1TP1PP1DP0_GPU44 -->
<g id="node4291" class="node">
<title>ln2_L15_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="890412,-78 890262,-78 890262,-26 890412,-26 890412,-78"/>
<text text-anchor="middle" x="890337" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="890337" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="890337" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="890337" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L15_EP1TP1PP1DP0_GPU44 -->
<g id="node4292" class="node">
<title>gate_L15_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightyellow" stroke="black" points="890759.53,-104 890512.12,-104 890448.47,0 890695.88,0 890759.53,-104"/>
<text text-anchor="middle" x="890604" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="890604" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="890604" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="890604" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L15_EP1TP1PP1DP0_GPU44 -->
<g id="node4293" class="node">
<title>dispatch_L15_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="890902" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="890902" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="890902" y="-44" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP0_GPU44</text>
</g>
<!-- expert_0_L15_EP1TP1PP1DP0_GPU44 -->
<g id="node4294" class="node">
<title>expert_0_L15_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="891194,-78 891044,-78 891044,-26 891194,-26 891194,-78"/>
<text text-anchor="middle" x="891119" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="891119" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="891119" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="891119" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L15_EP1TP1PP1DP0_GPU44 -->
<g id="node4295" class="node">
<title>expert_1_L15_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="891380,-78 891230,-78 891230,-26 891380,-26 891380,-78"/>
<text text-anchor="middle" x="891305" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="891305" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="891305" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="891305" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L15_EP1TP1PP1DP0_GPU44 -->
<g id="node4296" class="node">
<title>expert_2_L15_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="891566,-78 891416,-78 891416,-26 891566,-26 891566,-78"/>
<text text-anchor="middle" x="891491" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="891491" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="891491" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="891491" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L15_EP1TP1PP1DP0_GPU44 -->
<g id="node4297" class="node">
<title>expert_3_L15_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="891752,-78 891602,-78 891602,-26 891752,-26 891752,-78"/>
<text text-anchor="middle" x="891677" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="891677" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="891677" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="891677" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L15_EP1TP1PP1DP0_GPU44 -->
<g id="node4298" class="node">
<title>combine_L15_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="891894" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="891894" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="891894" y="-44" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP0_GPU44</text>
</g>
<!-- ffn_L15_EP1TP1PP1DP0_GPU44 -->
<g id="node4299" class="node">
<title>ffn_L15_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="892206,-78 892036,-78 892036,-26 892206,-26 892206,-78"/>
<text text-anchor="middle" x="892121" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="892121" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="892121" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="892121" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L15_EP1TP1PP1DP0_GPU44 -->
<g id="node4300" class="node">
<title>ffn_ar_L15_EP1TP1PP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="892349" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="892349" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="892349" y="-49.5" font-family="Arial" font-size="10.00">L15 EP1 TP Group 1 PP1 DP0</text>
<text text-anchor="middle" x="892349" y="-38.5" font-family="Arial" font-size="10.00">GPU44</text>
</g>
<!-- residual2_L15_EP1TP1PP1DP0_GPU44 -->
<g id="node4301" class="node">
<title>residual2_L15_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="892642,-78 892492,-78 892492,-26 892642,-26 892642,-78"/>
<text text-anchor="middle" x="892567" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="892567" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="892567" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="892567" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L15_EP1TP1PP1DP1_GPU45 -->
<g id="node4302" class="node">
<title>ln1_L15_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="892828,-78 892678,-78 892678,-26 892828,-26 892828,-78"/>
<text text-anchor="middle" x="892753" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="892753" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="892753" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="892753" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L15_EP1TP1PP1DP1_GPU45 -->
<g id="node4303" class="node">
<title>qkv_L15_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="893014,-78 892864,-78 892864,-26 893014,-26 893014,-78"/>
<text text-anchor="middle" x="892939" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="892939" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="892939" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="892939" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L15_EP1TP1PP1DP1_GPU45 -->
<g id="node4304" class="node">
<title>attn_L15_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="893201.5,-78 893050.5,-78 893050.5,-26 893201.5,-26 893201.5,-78"/>
<text text-anchor="middle" x="893126" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="893126" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="893126" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="893126" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L15_EP1TP1PP1DP1_GPU45 -->
<g id="node4305" class="node">
<title>attn_out_L15_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="893388,-78 893238,-78 893238,-26 893388,-26 893388,-78"/>
<text text-anchor="middle" x="893313" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="893313" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="893313" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="893313" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L15_EP1TP1PP1DP1_GPU45 -->
<g id="node4306" class="node">
<title>attn_ar_L15_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="893531" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="893531" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="893531" y="-49.5" font-family="Arial" font-size="10.00">L15 EP1 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="893531" y="-38.5" font-family="Arial" font-size="10.00">GPU45</text>
</g>
<!-- residual1_L15_EP1TP1PP1DP1_GPU45 -->
<g id="node4307" class="node">
<title>residual1_L15_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="893824,-78 893674,-78 893674,-26 893824,-26 893824,-78"/>
<text text-anchor="middle" x="893749" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="893749" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="893749" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="893749" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L15_EP1TP1PP1DP1_GPU45 -->
<g id="node4308" class="node">
<title>ln2_L15_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="894010,-78 893860,-78 893860,-26 894010,-26 894010,-78"/>
<text text-anchor="middle" x="893935" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="893935" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="893935" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="893935" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L15_EP1TP1PP1DP1_GPU45 -->
<g id="node4309" class="node">
<title>gate_L15_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightyellow" stroke="black" points="894357.53,-104 894110.12,-104 894046.47,0 894293.88,0 894357.53,-104"/>
<text text-anchor="middle" x="894202" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="894202" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="894202" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="894202" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L15_EP1TP1PP1DP1_GPU45 -->
<g id="node4310" class="node">
<title>dispatch_L15_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="894500" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="894500" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="894500" y="-44" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP1_GPU45</text>
</g>
<!-- expert_0_L15_EP1TP1PP1DP1_GPU45 -->
<g id="node4311" class="node">
<title>expert_0_L15_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="894792,-78 894642,-78 894642,-26 894792,-26 894792,-78"/>
<text text-anchor="middle" x="894717" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="894717" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="894717" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="894717" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L15_EP1TP1PP1DP1_GPU45 -->
<g id="node4312" class="node">
<title>expert_1_L15_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="894978,-78 894828,-78 894828,-26 894978,-26 894978,-78"/>
<text text-anchor="middle" x="894903" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="894903" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="894903" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="894903" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L15_EP1TP1PP1DP1_GPU45 -->
<g id="node4313" class="node">
<title>expert_2_L15_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="895164,-78 895014,-78 895014,-26 895164,-26 895164,-78"/>
<text text-anchor="middle" x="895089" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="895089" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="895089" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="895089" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L15_EP1TP1PP1DP1_GPU45 -->
<g id="node4314" class="node">
<title>expert_3_L15_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="895350,-78 895200,-78 895200,-26 895350,-26 895350,-78"/>
<text text-anchor="middle" x="895275" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="895275" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="895275" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="895275" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L15_EP1TP1PP1DP1_GPU45 -->
<g id="node4315" class="node">
<title>combine_L15_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="895492" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="895492" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="895492" y="-44" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP1_GPU45</text>
</g>
<!-- ffn_L15_EP1TP1PP1DP1_GPU45 -->
<g id="node4316" class="node">
<title>ffn_L15_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="895804,-78 895634,-78 895634,-26 895804,-26 895804,-78"/>
<text text-anchor="middle" x="895719" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="895719" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="895719" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="895719" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L15_EP1TP1PP1DP1_GPU45 -->
<g id="node4317" class="node">
<title>ffn_ar_L15_EP1TP1PP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="895947" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="895947" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="895947" y="-49.5" font-family="Arial" font-size="10.00">L15 EP1 TP Group 1 PP1 DP1</text>
<text text-anchor="middle" x="895947" y="-38.5" font-family="Arial" font-size="10.00">GPU45</text>
</g>
<!-- residual2_L15_EP1TP1PP1DP1_GPU45 -->
<g id="node4318" class="node">
<title>residual2_L15_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="896240,-78 896090,-78 896090,-26 896240,-26 896240,-78"/>
<text text-anchor="middle" x="896165" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="896165" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="896165" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="896165" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L15_EP1TP2PP1DP0_GPU52 -->
<g id="node4319" class="node">
<title>ln1_L15_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="896426,-78 896276,-78 896276,-26 896426,-26 896426,-78"/>
<text text-anchor="middle" x="896351" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="896351" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="896351" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="896351" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L15_EP1TP2PP1DP0_GPU52 -->
<g id="node4320" class="node">
<title>qkv_L15_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="896612,-78 896462,-78 896462,-26 896612,-26 896612,-78"/>
<text text-anchor="middle" x="896537" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="896537" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="896537" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="896537" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L15_EP1TP2PP1DP0_GPU52 -->
<g id="node4321" class="node">
<title>attn_L15_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="896799.5,-78 896648.5,-78 896648.5,-26 896799.5,-26 896799.5,-78"/>
<text text-anchor="middle" x="896724" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="896724" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="896724" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="896724" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L15_EP1TP2PP1DP0_GPU52 -->
<g id="node4322" class="node">
<title>attn_out_L15_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="896986,-78 896836,-78 896836,-26 896986,-26 896986,-78"/>
<text text-anchor="middle" x="896911" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="896911" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="896911" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="896911" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L15_EP1TP2PP1DP0_GPU52 -->
<g id="node4323" class="node">
<title>attn_ar_L15_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="897129" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="897129" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="897129" y="-49.5" font-family="Arial" font-size="10.00">L15 EP1 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="897129" y="-38.5" font-family="Arial" font-size="10.00">GPU52</text>
</g>
<!-- residual1_L15_EP1TP2PP1DP0_GPU52 -->
<g id="node4324" class="node">
<title>residual1_L15_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="897422,-78 897272,-78 897272,-26 897422,-26 897422,-78"/>
<text text-anchor="middle" x="897347" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="897347" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="897347" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="897347" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L15_EP1TP2PP1DP0_GPU52 -->
<g id="node4325" class="node">
<title>ln2_L15_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="897608,-78 897458,-78 897458,-26 897608,-26 897608,-78"/>
<text text-anchor="middle" x="897533" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="897533" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="897533" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="897533" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L15_EP1TP2PP1DP0_GPU52 -->
<g id="node4326" class="node">
<title>gate_L15_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightyellow" stroke="black" points="897955.53,-104 897708.12,-104 897644.47,0 897891.88,0 897955.53,-104"/>
<text text-anchor="middle" x="897800" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="897800" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="897800" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="897800" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L15_EP1TP2PP1DP0_GPU52 -->
<g id="node4327" class="node">
<title>dispatch_L15_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="898098" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="898098" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="898098" y="-44" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP0_GPU52</text>
</g>
<!-- expert_0_L15_EP1TP2PP1DP0_GPU52 -->
<g id="node4328" class="node">
<title>expert_0_L15_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="898390,-78 898240,-78 898240,-26 898390,-26 898390,-78"/>
<text text-anchor="middle" x="898315" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="898315" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="898315" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="898315" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L15_EP1TP2PP1DP0_GPU52 -->
<g id="node4329" class="node">
<title>expert_1_L15_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="898576,-78 898426,-78 898426,-26 898576,-26 898576,-78"/>
<text text-anchor="middle" x="898501" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="898501" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="898501" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="898501" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L15_EP1TP2PP1DP0_GPU52 -->
<g id="node4330" class="node">
<title>expert_2_L15_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="898762,-78 898612,-78 898612,-26 898762,-26 898762,-78"/>
<text text-anchor="middle" x="898687" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="898687" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="898687" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="898687" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L15_EP1TP2PP1DP0_GPU52 -->
<g id="node4331" class="node">
<title>expert_3_L15_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="898948,-78 898798,-78 898798,-26 898948,-26 898948,-78"/>
<text text-anchor="middle" x="898873" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="898873" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="898873" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="898873" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L15_EP1TP2PP1DP0_GPU52 -->
<g id="node4332" class="node">
<title>combine_L15_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="899090" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="899090" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="899090" y="-44" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP0_GPU52</text>
</g>
<!-- ffn_L15_EP1TP2PP1DP0_GPU52 -->
<g id="node4333" class="node">
<title>ffn_L15_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="899402,-78 899232,-78 899232,-26 899402,-26 899402,-78"/>
<text text-anchor="middle" x="899317" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="899317" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="899317" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="899317" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L15_EP1TP2PP1DP0_GPU52 -->
<g id="node4334" class="node">
<title>ffn_ar_L15_EP1TP2PP1DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="899545" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="899545" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="899545" y="-49.5" font-family="Arial" font-size="10.00">L15 EP1 TP Group 2 PP1 DP0</text>
<text text-anchor="middle" x="899545" y="-38.5" font-family="Arial" font-size="10.00">GPU52</text>
</g>
<!-- residual2_L15_EP1TP2PP1DP0_GPU52 -->
<g id="node4335" class="node">
<title>residual2_L15_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="899838,-78 899688,-78 899688,-26 899838,-26 899838,-78"/>
<text text-anchor="middle" x="899763" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="899763" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="899763" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="899763" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L15_EP1TP2PP1DP1_GPU53 -->
<g id="node4336" class="node">
<title>ln1_L15_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="900024,-78 899874,-78 899874,-26 900024,-26 900024,-78"/>
<text text-anchor="middle" x="899949" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="899949" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="899949" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="899949" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L15_EP1TP2PP1DP1_GPU53 -->
<g id="node4337" class="node">
<title>qkv_L15_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="900210,-78 900060,-78 900060,-26 900210,-26 900210,-78"/>
<text text-anchor="middle" x="900135" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="900135" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="900135" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="900135" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L15_EP1TP2PP1DP1_GPU53 -->
<g id="node4338" class="node">
<title>attn_L15_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="900397.5,-78 900246.5,-78 900246.5,-26 900397.5,-26 900397.5,-78"/>
<text text-anchor="middle" x="900322" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="900322" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="900322" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="900322" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L15_EP1TP2PP1DP1_GPU53 -->
<g id="node4339" class="node">
<title>attn_out_L15_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="900584,-78 900434,-78 900434,-26 900584,-26 900584,-78"/>
<text text-anchor="middle" x="900509" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="900509" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="900509" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="900509" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L15_EP1TP2PP1DP1_GPU53 -->
<g id="node4340" class="node">
<title>attn_ar_L15_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="900727" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="900727" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="900727" y="-49.5" font-family="Arial" font-size="10.00">L15 EP1 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="900727" y="-38.5" font-family="Arial" font-size="10.00">GPU53</text>
</g>
<!-- residual1_L15_EP1TP2PP1DP1_GPU53 -->
<g id="node4341" class="node">
<title>residual1_L15_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="901020,-78 900870,-78 900870,-26 901020,-26 901020,-78"/>
<text text-anchor="middle" x="900945" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="900945" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="900945" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="900945" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L15_EP1TP2PP1DP1_GPU53 -->
<g id="node4342" class="node">
<title>ln2_L15_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="901206,-78 901056,-78 901056,-26 901206,-26 901206,-78"/>
<text text-anchor="middle" x="901131" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="901131" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="901131" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="901131" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L15_EP1TP2PP1DP1_GPU53 -->
<g id="node4343" class="node">
<title>gate_L15_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightyellow" stroke="black" points="901553.53,-104 901306.12,-104 901242.47,0 901489.88,0 901553.53,-104"/>
<text text-anchor="middle" x="901398" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="901398" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="901398" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="901398" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L15_EP1TP2PP1DP1_GPU53 -->
<g id="node4344" class="node">
<title>dispatch_L15_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="901696" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="901696" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="901696" y="-44" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP1_GPU53</text>
</g>
<!-- expert_0_L15_EP1TP2PP1DP1_GPU53 -->
<g id="node4345" class="node">
<title>expert_0_L15_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="901988,-78 901838,-78 901838,-26 901988,-26 901988,-78"/>
<text text-anchor="middle" x="901913" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="901913" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="901913" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="901913" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L15_EP1TP2PP1DP1_GPU53 -->
<g id="node4346" class="node">
<title>expert_1_L15_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="902174,-78 902024,-78 902024,-26 902174,-26 902174,-78"/>
<text text-anchor="middle" x="902099" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="902099" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="902099" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="902099" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L15_EP1TP2PP1DP1_GPU53 -->
<g id="node4347" class="node">
<title>expert_2_L15_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="902360,-78 902210,-78 902210,-26 902360,-26 902360,-78"/>
<text text-anchor="middle" x="902285" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="902285" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="902285" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="902285" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L15_EP1TP2PP1DP1_GPU53 -->
<g id="node4348" class="node">
<title>expert_3_L15_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="902546,-78 902396,-78 902396,-26 902546,-26 902546,-78"/>
<text text-anchor="middle" x="902471" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="902471" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="902471" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="902471" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L15_EP1TP2PP1DP1_GPU53 -->
<g id="node4349" class="node">
<title>combine_L15_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="902688" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="902688" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="902688" y="-44" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP1_GPU53</text>
</g>
<!-- ffn_L15_EP1TP2PP1DP1_GPU53 -->
<g id="node4350" class="node">
<title>ffn_L15_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="903000,-78 902830,-78 902830,-26 903000,-26 903000,-78"/>
<text text-anchor="middle" x="902915" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="902915" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="902915" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="902915" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L15_EP1TP2PP1DP1_GPU53 -->
<g id="node4351" class="node">
<title>ffn_ar_L15_EP1TP2PP1DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="903143" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="903143" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="903143" y="-49.5" font-family="Arial" font-size="10.00">L15 EP1 TP Group 2 PP1 DP1</text>
<text text-anchor="middle" x="903143" y="-38.5" font-family="Arial" font-size="10.00">GPU53</text>
</g>
<!-- residual2_L15_EP1TP2PP1DP1_GPU53 -->
<g id="node4352" class="node">
<title>residual2_L15_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="903436,-78 903286,-78 903286,-26 903436,-26 903436,-78"/>
<text text-anchor="middle" x="903361" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="903361" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="903361" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="903361" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L15_EP1TP3PP1DP0_GPU60 -->
<g id="node4353" class="node">
<title>ln1_L15_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="903622,-78 903472,-78 903472,-26 903622,-26 903622,-78"/>
<text text-anchor="middle" x="903547" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="903547" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="903547" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="903547" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L15_EP1TP3PP1DP0_GPU60 -->
<g id="node4354" class="node">
<title>qkv_L15_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="903808,-78 903658,-78 903658,-26 903808,-26 903808,-78"/>
<text text-anchor="middle" x="903733" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="903733" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="903733" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="903733" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L15_EP1TP3PP1DP0_GPU60 -->
<g id="node4355" class="node">
<title>attn_L15_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="903995.5,-78 903844.5,-78 903844.5,-26 903995.5,-26 903995.5,-78"/>
<text text-anchor="middle" x="903920" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="903920" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="903920" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="903920" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L15_EP1TP3PP1DP0_GPU60 -->
<g id="node4356" class="node">
<title>attn_out_L15_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="904182,-78 904032,-78 904032,-26 904182,-26 904182,-78"/>
<text text-anchor="middle" x="904107" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="904107" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="904107" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="904107" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L15_EP1TP3PP1DP0_GPU60 -->
<g id="node4357" class="node">
<title>attn_ar_L15_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="904325" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="904325" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="904325" y="-49.5" font-family="Arial" font-size="10.00">L15 EP1 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="904325" y="-38.5" font-family="Arial" font-size="10.00">GPU60</text>
</g>
<!-- residual1_L15_EP1TP3PP1DP0_GPU60 -->
<g id="node4358" class="node">
<title>residual1_L15_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="904618,-78 904468,-78 904468,-26 904618,-26 904618,-78"/>
<text text-anchor="middle" x="904543" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="904543" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="904543" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="904543" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L15_EP1TP3PP1DP0_GPU60 -->
<g id="node4359" class="node">
<title>ln2_L15_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="904804,-78 904654,-78 904654,-26 904804,-26 904804,-78"/>
<text text-anchor="middle" x="904729" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="904729" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="904729" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="904729" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L15_EP1TP3PP1DP0_GPU60 -->
<g id="node4360" class="node">
<title>gate_L15_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightyellow" stroke="black" points="905151.53,-104 904904.12,-104 904840.47,0 905087.88,0 905151.53,-104"/>
<text text-anchor="middle" x="904996" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="904996" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="904996" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="904996" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L15_EP1TP3PP1DP0_GPU60 -->
<g id="node4361" class="node">
<title>dispatch_L15_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="905294" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="905294" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="905294" y="-44" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP0_GPU60</text>
</g>
<!-- expert_0_L15_EP1TP3PP1DP0_GPU60 -->
<g id="node4362" class="node">
<title>expert_0_L15_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="905586,-78 905436,-78 905436,-26 905586,-26 905586,-78"/>
<text text-anchor="middle" x="905511" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="905511" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="905511" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="905511" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L15_EP1TP3PP1DP0_GPU60 -->
<g id="node4363" class="node">
<title>expert_1_L15_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="905772,-78 905622,-78 905622,-26 905772,-26 905772,-78"/>
<text text-anchor="middle" x="905697" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="905697" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="905697" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="905697" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L15_EP1TP3PP1DP0_GPU60 -->
<g id="node4364" class="node">
<title>expert_2_L15_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="905958,-78 905808,-78 905808,-26 905958,-26 905958,-78"/>
<text text-anchor="middle" x="905883" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="905883" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="905883" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="905883" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L15_EP1TP3PP1DP0_GPU60 -->
<g id="node4365" class="node">
<title>expert_3_L15_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="906144,-78 905994,-78 905994,-26 906144,-26 906144,-78"/>
<text text-anchor="middle" x="906069" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="906069" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="906069" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="906069" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L15_EP1TP3PP1DP0_GPU60 -->
<g id="node4366" class="node">
<title>combine_L15_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="906286" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="906286" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="906286" y="-44" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP0_GPU60</text>
</g>
<!-- ffn_L15_EP1TP3PP1DP0_GPU60 -->
<g id="node4367" class="node">
<title>ffn_L15_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="906598,-78 906428,-78 906428,-26 906598,-26 906598,-78"/>
<text text-anchor="middle" x="906513" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="906513" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="906513" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="906513" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L15_EP1TP3PP1DP0_GPU60 -->
<g id="node4368" class="node">
<title>ffn_ar_L15_EP1TP3PP1DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="906741" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="906741" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="906741" y="-49.5" font-family="Arial" font-size="10.00">L15 EP1 TP Group 3 PP1 DP0</text>
<text text-anchor="middle" x="906741" y="-38.5" font-family="Arial" font-size="10.00">GPU60</text>
</g>
<!-- residual2_L15_EP1TP3PP1DP0_GPU60 -->
<g id="node4369" class="node">
<title>residual2_L15_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="907034,-78 906884,-78 906884,-26 907034,-26 907034,-78"/>
<text text-anchor="middle" x="906959" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="906959" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="906959" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="906959" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln1_L15_EP1TP3PP1DP1_GPU61 -->
<g id="node4370" class="node">
<title>ln1_L15_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="907220,-78 907070,-78 907070,-26 907220,-26 907220,-78"/>
<text text-anchor="middle" x="907145" y="-66" font-family="Arial" font-size="10.00">Layer Norm 1</text>
<text text-anchor="middle" x="907145" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="907145" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="907145" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- qkv_L15_EP1TP3PP1DP1_GPU61 -->
<g id="node4371" class="node">
<title>qkv_L15_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="907406,-78 907256,-78 907256,-26 907406,-26 907406,-78"/>
<text text-anchor="middle" x="907331" y="-66" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="907331" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="907331" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="907331" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_L15_EP1TP3PP1DP1_GPU61 -->
<g id="node4372" class="node">
<title>attn_L15_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="907593.5,-78 907442.5,-78 907442.5,-26 907593.5,-26 907593.5,-78"/>
<text text-anchor="middle" x="907518" y="-66" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="907518" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="907518" y="-44" font-family="Arial" font-size="10.00">In: [B=32,H=4,S=10240,D=64]</text>
<text text-anchor="middle" x="907518" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_out_L15_EP1TP3PP1DP1_GPU61 -->
<g id="node4373" class="node">
<title>attn_out_L15_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="907780,-78 907630,-78 907630,-26 907780,-26 907780,-78"/>
<text text-anchor="middle" x="907705" y="-66" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="907705" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="907705" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="907705" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- attn_ar_L15_EP1TP3PP1DP1_GPU61 -->
<g id="node4374" class="node">
<title>attn_ar_L15_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="907923" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="907923" y="-60.5" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="907923" y="-49.5" font-family="Arial" font-size="10.00">L15 EP1 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="907923" y="-38.5" font-family="Arial" font-size="10.00">GPU61</text>
</g>
<!-- residual1_L15_EP1TP3PP1DP1_GPU61 -->
<g id="node4375" class="node">
<title>residual1_L15_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="908216,-78 908066,-78 908066,-26 908216,-26 908216,-78"/>
<text text-anchor="middle" x="908141" y="-66" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="908141" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="908141" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="908141" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ln2_L15_EP1TP3PP1DP1_GPU61 -->
<g id="node4376" class="node">
<title>ln2_L15_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="908402,-78 908252,-78 908252,-26 908402,-26 908402,-78"/>
<text text-anchor="middle" x="908327" y="-66" font-family="Arial" font-size="10.00">Layer Norm 2</text>
<text text-anchor="middle" x="908327" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="908327" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="908327" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- gate_L15_EP1TP3PP1DP1_GPU61 -->
<g id="node4377" class="node">
<title>gate_L15_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightyellow" stroke="black" points="908749.53,-104 908502.12,-104 908438.47,0 908685.88,0 908749.53,-104"/>
<text text-anchor="middle" x="908594" y="-66" font-family="Arial" font-size="10.00">MoE Gate (Routing)</text>
<text text-anchor="middle" x="908594" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="908594" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="908594" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,K=2]</text>
</g>
<!-- dispatch_L15_EP1TP3PP1DP1_GPU61 -->
<g id="node4378" class="node">
<title>dispatch_L15_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="908892" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="908892" y="-55" font-family="Arial" font-size="10.00">Expert Dispatch</text>
<text text-anchor="middle" x="908892" y="-44" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP1_GPU61</text>
</g>
<!-- expert_0_L15_EP1TP3PP1DP1_GPU61 -->
<g id="node4379" class="node">
<title>expert_0_L15_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="909184,-78 909034,-78 909034,-26 909184,-26 909184,-78"/>
<text text-anchor="middle" x="909109" y="-66" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="909109" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="909109" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="909109" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_1_L15_EP1TP3PP1DP1_GPU61 -->
<g id="node4380" class="node">
<title>expert_1_L15_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="909370,-78 909220,-78 909220,-26 909370,-26 909370,-78"/>
<text text-anchor="middle" x="909295" y="-66" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="909295" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="909295" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="909295" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_2_L15_EP1TP3PP1DP1_GPU61 -->
<g id="node4381" class="node">
<title>expert_2_L15_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="909556,-78 909406,-78 909406,-26 909556,-26 909556,-78"/>
<text text-anchor="middle" x="909481" y="-66" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="909481" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="909481" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="909481" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- expert_3_L15_EP1TP3PP1DP1_GPU61 -->
<g id="node4382" class="node">
<title>expert_3_L15_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="909742,-78 909592,-78 909592,-26 909742,-26 909742,-78"/>
<text text-anchor="middle" x="909667" y="-66" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="909667" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="909667" y="-44" font-family="Arial" font-size="10.00">In: [B=4,S=10240,H=512]</text>
<text text-anchor="middle" x="909667" y="-33" font-family="Arial" font-size="10.00">Out: [B=4,S=10240,H=512]</text>
</g>
<!-- combine_L15_EP1TP3PP1DP1_GPU61 -->
<g id="node4383" class="node">
<title>combine_L15_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="909884" cy="-52" rx="106.13" ry="21.43"/>
<text text-anchor="middle" x="909884" y="-55" font-family="Arial" font-size="10.00">Expert Combine</text>
<text text-anchor="middle" x="909884" y="-44" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP1_GPU61</text>
</g>
<!-- ffn_L15_EP1TP3PP1DP1_GPU61 -->
<g id="node4384" class="node">
<title>ffn_L15_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="910196,-78 910026,-78 910026,-26 910196,-26 910196,-78"/>
<text text-anchor="middle" x="910111" y="-66" font-family="Arial" font-size="10.00">FFN (Up&#45;proj + GeLU + Down&#45;proj)</text>
<text text-anchor="middle" x="910111" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="910111" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]</text>
<text text-anchor="middle" x="910111" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- ffn_ar_L15_EP1TP3PP1DP1_GPU61 -->
<g id="node4385" class="node">
<title>ffn_ar_L15_EP1TP3PP1DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="910339" cy="-52" rx="106.55" ry="28.98"/>
<text text-anchor="middle" x="910339" y="-60.5" font-family="Arial" font-size="10.00">FFN All&#45;Reduce</text>
<text text-anchor="middle" x="910339" y="-49.5" font-family="Arial" font-size="10.00">L15 EP1 TP Group 3 PP1 DP1</text>
<text text-anchor="middle" x="910339" y="-38.5" font-family="Arial" font-size="10.00">GPU61</text>
</g>
<!-- residual2_L15_EP1TP3PP1DP1_GPU61 -->
<g id="node4386" class="node">
<title>residual2_L15_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="910632,-78 910482,-78 910482,-26 910632,-26 910632,-78"/>
<text text-anchor="middle" x="910557" y="-66" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="910557" y="-55" font-family="Arial" font-size="10.00">L15_EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="910557" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=10240,H=512]×2</text>
<text text-anchor="middle" x="910557" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=10240,H=512]</text>
</g>
<!-- decode_start -->
<g id="node4387" class="node">
<title>decode_start</title>
<polygon fill="lightblue" stroke="black" points="910956,-70 910668,-70 910668,-34 910956,-34 910956,-70"/>
<text text-anchor="middle" x="910812" y="-55" font-family="Arial" font-size="10.00">Decode Phase Start</text>
<text text-anchor="middle" x="910812" y="-44" font-family="Arial" font-size="10.00">Single Token Processing</text>
</g>
<!-- kv_read_EP0TP0PP0DP0_GPU0 -->
<g id="node4388" class="node">
<title>kv_read_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="911116,-78 910992,-78 910992,-26 911116,-26 911116,-78"/>
<text text-anchor="middle" x="911054" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="911054" y="-55" font-family="Arial" font-size="10.00">EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="911054" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="911054" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP0TP0PP0DP0_GPU0 -->
<g id="node4389" class="node">
<title>decode_attn_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="911284,-78 911152,-78 911152,-26 911284,-26 911284,-78"/>
<text text-anchor="middle" x="911218" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="911218" y="-55" font-family="Arial" font-size="10.00">EP0TP0PP0DP0_GPU0</text>
<text text-anchor="middle" x="911218" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="911218" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP0TP0PP0DP0_GPU0 -->
<g id="node4390" class="node">
<title>kv_write_EP0TP0PP0DP0_GPU0</title>
<polygon fill="lightgreen" stroke="black" points="911444,-70 911320,-70 911320,-34 911444,-34 911444,-70"/>
<text text-anchor="middle" x="911382" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="911382" y="-44" font-family="Arial" font-size="10.00">EP0TP0PP0DP0_GPU0</text>
</g>
<!-- kv_read_EP0TP0PP0DP1_GPU1 -->
<g id="node4391" class="node">
<title>kv_read_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="911604,-78 911480,-78 911480,-26 911604,-26 911604,-78"/>
<text text-anchor="middle" x="911542" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="911542" y="-55" font-family="Arial" font-size="10.00">EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="911542" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="911542" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP0TP0PP0DP1_GPU1 -->
<g id="node4392" class="node">
<title>decode_attn_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="911772,-78 911640,-78 911640,-26 911772,-26 911772,-78"/>
<text text-anchor="middle" x="911706" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="911706" y="-55" font-family="Arial" font-size="10.00">EP0TP0PP0DP1_GPU1</text>
<text text-anchor="middle" x="911706" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="911706" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP0TP0PP0DP1_GPU1 -->
<g id="node4393" class="node">
<title>kv_write_EP0TP0PP0DP1_GPU1</title>
<polygon fill="lightgreen" stroke="black" points="911932,-70 911808,-70 911808,-34 911932,-34 911932,-70"/>
<text text-anchor="middle" x="911870" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="911870" y="-44" font-family="Arial" font-size="10.00">EP0TP0PP0DP1_GPU1</text>
</g>
<!-- kv_read_EP0TP0PP1DP0_GPU4 -->
<g id="node4394" class="node">
<title>kv_read_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="912092,-78 911968,-78 911968,-26 912092,-26 912092,-78"/>
<text text-anchor="middle" x="912030" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="912030" y="-55" font-family="Arial" font-size="10.00">EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="912030" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="912030" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP0TP0PP1DP0_GPU4 -->
<g id="node4395" class="node">
<title>decode_attn_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="912260,-78 912128,-78 912128,-26 912260,-26 912260,-78"/>
<text text-anchor="middle" x="912194" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="912194" y="-55" font-family="Arial" font-size="10.00">EP0TP0PP1DP0_GPU4</text>
<text text-anchor="middle" x="912194" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="912194" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP0TP0PP1DP0_GPU4 -->
<g id="node4396" class="node">
<title>kv_write_EP0TP0PP1DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="912420,-70 912296,-70 912296,-34 912420,-34 912420,-70"/>
<text text-anchor="middle" x="912358" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="912358" y="-44" font-family="Arial" font-size="10.00">EP0TP0PP1DP0_GPU4</text>
</g>
<!-- kv_read_EP0TP0PP1DP1_GPU5 -->
<g id="node4397" class="node">
<title>kv_read_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="912580,-78 912456,-78 912456,-26 912580,-26 912580,-78"/>
<text text-anchor="middle" x="912518" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="912518" y="-55" font-family="Arial" font-size="10.00">EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="912518" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="912518" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP0TP0PP1DP1_GPU5 -->
<g id="node4398" class="node">
<title>decode_attn_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="912748,-78 912616,-78 912616,-26 912748,-26 912748,-78"/>
<text text-anchor="middle" x="912682" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="912682" y="-55" font-family="Arial" font-size="10.00">EP0TP0PP1DP1_GPU5</text>
<text text-anchor="middle" x="912682" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="912682" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP0TP0PP1DP1_GPU5 -->
<g id="node4399" class="node">
<title>kv_write_EP0TP0PP1DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="912908,-70 912784,-70 912784,-34 912908,-34 912908,-70"/>
<text text-anchor="middle" x="912846" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="912846" y="-44" font-family="Arial" font-size="10.00">EP0TP0PP1DP1_GPU5</text>
</g>
<!-- kv_read_EP0TP1PP0DP0_GPU8 -->
<g id="node4400" class="node">
<title>kv_read_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="913068,-78 912944,-78 912944,-26 913068,-26 913068,-78"/>
<text text-anchor="middle" x="913006" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="913006" y="-55" font-family="Arial" font-size="10.00">EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="913006" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="913006" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP0TP1PP0DP0_GPU8 -->
<g id="node4401" class="node">
<title>decode_attn_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="913236,-78 913104,-78 913104,-26 913236,-26 913236,-78"/>
<text text-anchor="middle" x="913170" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="913170" y="-55" font-family="Arial" font-size="10.00">EP0TP1PP0DP0_GPU8</text>
<text text-anchor="middle" x="913170" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="913170" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP0TP1PP0DP0_GPU8 -->
<g id="node4402" class="node">
<title>kv_write_EP0TP1PP0DP0_GPU8</title>
<polygon fill="lightgreen" stroke="black" points="913396,-70 913272,-70 913272,-34 913396,-34 913396,-70"/>
<text text-anchor="middle" x="913334" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="913334" y="-44" font-family="Arial" font-size="10.00">EP0TP1PP0DP0_GPU8</text>
</g>
<!-- kv_read_EP0TP1PP0DP1_GPU9 -->
<g id="node4403" class="node">
<title>kv_read_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="913556,-78 913432,-78 913432,-26 913556,-26 913556,-78"/>
<text text-anchor="middle" x="913494" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="913494" y="-55" font-family="Arial" font-size="10.00">EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="913494" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="913494" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP0TP1PP0DP1_GPU9 -->
<g id="node4404" class="node">
<title>decode_attn_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="913724,-78 913592,-78 913592,-26 913724,-26 913724,-78"/>
<text text-anchor="middle" x="913658" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="913658" y="-55" font-family="Arial" font-size="10.00">EP0TP1PP0DP1_GPU9</text>
<text text-anchor="middle" x="913658" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="913658" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP0TP1PP0DP1_GPU9 -->
<g id="node4405" class="node">
<title>kv_write_EP0TP1PP0DP1_GPU9</title>
<polygon fill="lightgreen" stroke="black" points="913884,-70 913760,-70 913760,-34 913884,-34 913884,-70"/>
<text text-anchor="middle" x="913822" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="913822" y="-44" font-family="Arial" font-size="10.00">EP0TP1PP0DP1_GPU9</text>
</g>
<!-- kv_read_EP0TP1PP1DP0_GPU12 -->
<g id="node4406" class="node">
<title>kv_read_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="914049.5,-78 913920.5,-78 913920.5,-26 914049.5,-26 914049.5,-78"/>
<text text-anchor="middle" x="913985" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="913985" y="-55" font-family="Arial" font-size="10.00">EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="913985" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="913985" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP0TP1PP1DP0_GPU12 -->
<g id="node4407" class="node">
<title>decode_attn_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="914218,-78 914086,-78 914086,-26 914218,-26 914218,-78"/>
<text text-anchor="middle" x="914152" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="914152" y="-55" font-family="Arial" font-size="10.00">EP0TP1PP1DP0_GPU12</text>
<text text-anchor="middle" x="914152" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="914152" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP0TP1PP1DP0_GPU12 -->
<g id="node4408" class="node">
<title>kv_write_EP0TP1PP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="914383.5,-70 914254.5,-70 914254.5,-34 914383.5,-34 914383.5,-70"/>
<text text-anchor="middle" x="914319" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="914319" y="-44" font-family="Arial" font-size="10.00">EP0TP1PP1DP0_GPU12</text>
</g>
<!-- kv_read_EP0TP1PP1DP1_GPU13 -->
<g id="node4409" class="node">
<title>kv_read_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="914548.5,-78 914419.5,-78 914419.5,-26 914548.5,-26 914548.5,-78"/>
<text text-anchor="middle" x="914484" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="914484" y="-55" font-family="Arial" font-size="10.00">EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="914484" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="914484" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP0TP1PP1DP1_GPU13 -->
<g id="node4410" class="node">
<title>decode_attn_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="914717,-78 914585,-78 914585,-26 914717,-26 914717,-78"/>
<text text-anchor="middle" x="914651" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="914651" y="-55" font-family="Arial" font-size="10.00">EP0TP1PP1DP1_GPU13</text>
<text text-anchor="middle" x="914651" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="914651" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP0TP1PP1DP1_GPU13 -->
<g id="node4411" class="node">
<title>kv_write_EP0TP1PP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="914882.5,-70 914753.5,-70 914753.5,-34 914882.5,-34 914882.5,-70"/>
<text text-anchor="middle" x="914818" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="914818" y="-44" font-family="Arial" font-size="10.00">EP0TP1PP1DP1_GPU13</text>
</g>
<!-- kv_read_EP0TP2PP0DP0_GPU16 -->
<g id="node4412" class="node">
<title>kv_read_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="915047.5,-78 914918.5,-78 914918.5,-26 915047.5,-26 915047.5,-78"/>
<text text-anchor="middle" x="914983" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="914983" y="-55" font-family="Arial" font-size="10.00">EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="914983" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="914983" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP0TP2PP0DP0_GPU16 -->
<g id="node4413" class="node">
<title>decode_attn_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="915216,-78 915084,-78 915084,-26 915216,-26 915216,-78"/>
<text text-anchor="middle" x="915150" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="915150" y="-55" font-family="Arial" font-size="10.00">EP0TP2PP0DP0_GPU16</text>
<text text-anchor="middle" x="915150" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="915150" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP0TP2PP0DP0_GPU16 -->
<g id="node4414" class="node">
<title>kv_write_EP0TP2PP0DP0_GPU16</title>
<polygon fill="lightgreen" stroke="black" points="915381.5,-70 915252.5,-70 915252.5,-34 915381.5,-34 915381.5,-70"/>
<text text-anchor="middle" x="915317" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="915317" y="-44" font-family="Arial" font-size="10.00">EP0TP2PP0DP0_GPU16</text>
</g>
<!-- kv_read_EP0TP2PP0DP1_GPU17 -->
<g id="node4415" class="node">
<title>kv_read_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="915546.5,-78 915417.5,-78 915417.5,-26 915546.5,-26 915546.5,-78"/>
<text text-anchor="middle" x="915482" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="915482" y="-55" font-family="Arial" font-size="10.00">EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="915482" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="915482" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP0TP2PP0DP1_GPU17 -->
<g id="node4416" class="node">
<title>decode_attn_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="915715,-78 915583,-78 915583,-26 915715,-26 915715,-78"/>
<text text-anchor="middle" x="915649" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="915649" y="-55" font-family="Arial" font-size="10.00">EP0TP2PP0DP1_GPU17</text>
<text text-anchor="middle" x="915649" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="915649" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP0TP2PP0DP1_GPU17 -->
<g id="node4417" class="node">
<title>kv_write_EP0TP2PP0DP1_GPU17</title>
<polygon fill="lightgreen" stroke="black" points="915880.5,-70 915751.5,-70 915751.5,-34 915880.5,-34 915880.5,-70"/>
<text text-anchor="middle" x="915816" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="915816" y="-44" font-family="Arial" font-size="10.00">EP0TP2PP0DP1_GPU17</text>
</g>
<!-- kv_read_EP0TP2PP1DP0_GPU20 -->
<g id="node4418" class="node">
<title>kv_read_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="916045.5,-78 915916.5,-78 915916.5,-26 916045.5,-26 916045.5,-78"/>
<text text-anchor="middle" x="915981" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="915981" y="-55" font-family="Arial" font-size="10.00">EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="915981" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="915981" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP0TP2PP1DP0_GPU20 -->
<g id="node4419" class="node">
<title>decode_attn_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="916214,-78 916082,-78 916082,-26 916214,-26 916214,-78"/>
<text text-anchor="middle" x="916148" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="916148" y="-55" font-family="Arial" font-size="10.00">EP0TP2PP1DP0_GPU20</text>
<text text-anchor="middle" x="916148" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="916148" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP0TP2PP1DP0_GPU20 -->
<g id="node4420" class="node">
<title>kv_write_EP0TP2PP1DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="916379.5,-70 916250.5,-70 916250.5,-34 916379.5,-34 916379.5,-70"/>
<text text-anchor="middle" x="916315" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="916315" y="-44" font-family="Arial" font-size="10.00">EP0TP2PP1DP0_GPU20</text>
</g>
<!-- kv_read_EP0TP2PP1DP1_GPU21 -->
<g id="node4421" class="node">
<title>kv_read_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="916544.5,-78 916415.5,-78 916415.5,-26 916544.5,-26 916544.5,-78"/>
<text text-anchor="middle" x="916480" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="916480" y="-55" font-family="Arial" font-size="10.00">EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="916480" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="916480" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP0TP2PP1DP1_GPU21 -->
<g id="node4422" class="node">
<title>decode_attn_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="916713,-78 916581,-78 916581,-26 916713,-26 916713,-78"/>
<text text-anchor="middle" x="916647" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="916647" y="-55" font-family="Arial" font-size="10.00">EP0TP2PP1DP1_GPU21</text>
<text text-anchor="middle" x="916647" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="916647" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP0TP2PP1DP1_GPU21 -->
<g id="node4423" class="node">
<title>kv_write_EP0TP2PP1DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="916878.5,-70 916749.5,-70 916749.5,-34 916878.5,-34 916878.5,-70"/>
<text text-anchor="middle" x="916814" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="916814" y="-44" font-family="Arial" font-size="10.00">EP0TP2PP1DP1_GPU21</text>
</g>
<!-- kv_read_EP0TP3PP0DP0_GPU24 -->
<g id="node4424" class="node">
<title>kv_read_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="917043.5,-78 916914.5,-78 916914.5,-26 917043.5,-26 917043.5,-78"/>
<text text-anchor="middle" x="916979" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="916979" y="-55" font-family="Arial" font-size="10.00">EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="916979" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="916979" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP0TP3PP0DP0_GPU24 -->
<g id="node4425" class="node">
<title>decode_attn_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="917212,-78 917080,-78 917080,-26 917212,-26 917212,-78"/>
<text text-anchor="middle" x="917146" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="917146" y="-55" font-family="Arial" font-size="10.00">EP0TP3PP0DP0_GPU24</text>
<text text-anchor="middle" x="917146" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="917146" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP0TP3PP0DP0_GPU24 -->
<g id="node4426" class="node">
<title>kv_write_EP0TP3PP0DP0_GPU24</title>
<polygon fill="lightgreen" stroke="black" points="917377.5,-70 917248.5,-70 917248.5,-34 917377.5,-34 917377.5,-70"/>
<text text-anchor="middle" x="917313" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="917313" y="-44" font-family="Arial" font-size="10.00">EP0TP3PP0DP0_GPU24</text>
</g>
<!-- kv_read_EP0TP3PP0DP1_GPU25 -->
<g id="node4427" class="node">
<title>kv_read_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="917542.5,-78 917413.5,-78 917413.5,-26 917542.5,-26 917542.5,-78"/>
<text text-anchor="middle" x="917478" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="917478" y="-55" font-family="Arial" font-size="10.00">EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="917478" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="917478" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP0TP3PP0DP1_GPU25 -->
<g id="node4428" class="node">
<title>decode_attn_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="917711,-78 917579,-78 917579,-26 917711,-26 917711,-78"/>
<text text-anchor="middle" x="917645" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="917645" y="-55" font-family="Arial" font-size="10.00">EP0TP3PP0DP1_GPU25</text>
<text text-anchor="middle" x="917645" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="917645" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP0TP3PP0DP1_GPU25 -->
<g id="node4429" class="node">
<title>kv_write_EP0TP3PP0DP1_GPU25</title>
<polygon fill="lightgreen" stroke="black" points="917876.5,-70 917747.5,-70 917747.5,-34 917876.5,-34 917876.5,-70"/>
<text text-anchor="middle" x="917812" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="917812" y="-44" font-family="Arial" font-size="10.00">EP0TP3PP0DP1_GPU25</text>
</g>
<!-- kv_read_EP0TP3PP1DP0_GPU28 -->
<g id="node4430" class="node">
<title>kv_read_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="918041.5,-78 917912.5,-78 917912.5,-26 918041.5,-26 918041.5,-78"/>
<text text-anchor="middle" x="917977" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="917977" y="-55" font-family="Arial" font-size="10.00">EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="917977" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="917977" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP0TP3PP1DP0_GPU28 -->
<g id="node4431" class="node">
<title>decode_attn_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="918210,-78 918078,-78 918078,-26 918210,-26 918210,-78"/>
<text text-anchor="middle" x="918144" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="918144" y="-55" font-family="Arial" font-size="10.00">EP0TP3PP1DP0_GPU28</text>
<text text-anchor="middle" x="918144" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="918144" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP0TP3PP1DP0_GPU28 -->
<g id="node4432" class="node">
<title>kv_write_EP0TP3PP1DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="918375.5,-70 918246.5,-70 918246.5,-34 918375.5,-34 918375.5,-70"/>
<text text-anchor="middle" x="918311" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="918311" y="-44" font-family="Arial" font-size="10.00">EP0TP3PP1DP0_GPU28</text>
</g>
<!-- kv_read_EP0TP3PP1DP1_GPU29 -->
<g id="node4433" class="node">
<title>kv_read_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="918540.5,-78 918411.5,-78 918411.5,-26 918540.5,-26 918540.5,-78"/>
<text text-anchor="middle" x="918476" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="918476" y="-55" font-family="Arial" font-size="10.00">EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="918476" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="918476" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP0TP3PP1DP1_GPU29 -->
<g id="node4434" class="node">
<title>decode_attn_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="918709,-78 918577,-78 918577,-26 918709,-26 918709,-78"/>
<text text-anchor="middle" x="918643" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="918643" y="-55" font-family="Arial" font-size="10.00">EP0TP3PP1DP1_GPU29</text>
<text text-anchor="middle" x="918643" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="918643" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP0TP3PP1DP1_GPU29 -->
<g id="node4435" class="node">
<title>kv_write_EP0TP3PP1DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="918874.5,-70 918745.5,-70 918745.5,-34 918874.5,-34 918874.5,-70"/>
<text text-anchor="middle" x="918810" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="918810" y="-44" font-family="Arial" font-size="10.00">EP0TP3PP1DP1_GPU29</text>
</g>
<!-- kv_read_EP1TP0PP0DP0_GPU32 -->
<g id="node4436" class="node">
<title>kv_read_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="919039.5,-78 918910.5,-78 918910.5,-26 919039.5,-26 919039.5,-78"/>
<text text-anchor="middle" x="918975" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="918975" y="-55" font-family="Arial" font-size="10.00">EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="918975" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="918975" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP1TP0PP0DP0_GPU32 -->
<g id="node4437" class="node">
<title>decode_attn_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="919208,-78 919076,-78 919076,-26 919208,-26 919208,-78"/>
<text text-anchor="middle" x="919142" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="919142" y="-55" font-family="Arial" font-size="10.00">EP1TP0PP0DP0_GPU32</text>
<text text-anchor="middle" x="919142" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="919142" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP1TP0PP0DP0_GPU32 -->
<g id="node4438" class="node">
<title>kv_write_EP1TP0PP0DP0_GPU32</title>
<polygon fill="lightgreen" stroke="black" points="919373.5,-70 919244.5,-70 919244.5,-34 919373.5,-34 919373.5,-70"/>
<text text-anchor="middle" x="919309" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="919309" y="-44" font-family="Arial" font-size="10.00">EP1TP0PP0DP0_GPU32</text>
</g>
<!-- kv_read_EP1TP0PP0DP1_GPU33 -->
<g id="node4439" class="node">
<title>kv_read_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="919538.5,-78 919409.5,-78 919409.5,-26 919538.5,-26 919538.5,-78"/>
<text text-anchor="middle" x="919474" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="919474" y="-55" font-family="Arial" font-size="10.00">EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="919474" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="919474" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP1TP0PP0DP1_GPU33 -->
<g id="node4440" class="node">
<title>decode_attn_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="919707,-78 919575,-78 919575,-26 919707,-26 919707,-78"/>
<text text-anchor="middle" x="919641" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="919641" y="-55" font-family="Arial" font-size="10.00">EP1TP0PP0DP1_GPU33</text>
<text text-anchor="middle" x="919641" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="919641" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP1TP0PP0DP1_GPU33 -->
<g id="node4441" class="node">
<title>kv_write_EP1TP0PP0DP1_GPU33</title>
<polygon fill="lightgreen" stroke="black" points="919872.5,-70 919743.5,-70 919743.5,-34 919872.5,-34 919872.5,-70"/>
<text text-anchor="middle" x="919808" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="919808" y="-44" font-family="Arial" font-size="10.00">EP1TP0PP0DP1_GPU33</text>
</g>
<!-- kv_read_EP1TP0PP1DP0_GPU36 -->
<g id="node4442" class="node">
<title>kv_read_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="920037.5,-78 919908.5,-78 919908.5,-26 920037.5,-26 920037.5,-78"/>
<text text-anchor="middle" x="919973" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="919973" y="-55" font-family="Arial" font-size="10.00">EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="919973" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="919973" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP1TP0PP1DP0_GPU36 -->
<g id="node4443" class="node">
<title>decode_attn_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="920206,-78 920074,-78 920074,-26 920206,-26 920206,-78"/>
<text text-anchor="middle" x="920140" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="920140" y="-55" font-family="Arial" font-size="10.00">EP1TP0PP1DP0_GPU36</text>
<text text-anchor="middle" x="920140" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="920140" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP1TP0PP1DP0_GPU36 -->
<g id="node4444" class="node">
<title>kv_write_EP1TP0PP1DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="920371.5,-70 920242.5,-70 920242.5,-34 920371.5,-34 920371.5,-70"/>
<text text-anchor="middle" x="920307" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="920307" y="-44" font-family="Arial" font-size="10.00">EP1TP0PP1DP0_GPU36</text>
</g>
<!-- kv_read_EP1TP0PP1DP1_GPU37 -->
<g id="node4445" class="node">
<title>kv_read_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="920536.5,-78 920407.5,-78 920407.5,-26 920536.5,-26 920536.5,-78"/>
<text text-anchor="middle" x="920472" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="920472" y="-55" font-family="Arial" font-size="10.00">EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="920472" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="920472" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP1TP0PP1DP1_GPU37 -->
<g id="node4446" class="node">
<title>decode_attn_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="920705,-78 920573,-78 920573,-26 920705,-26 920705,-78"/>
<text text-anchor="middle" x="920639" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="920639" y="-55" font-family="Arial" font-size="10.00">EP1TP0PP1DP1_GPU37</text>
<text text-anchor="middle" x="920639" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="920639" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP1TP0PP1DP1_GPU37 -->
<g id="node4447" class="node">
<title>kv_write_EP1TP0PP1DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="920870.5,-70 920741.5,-70 920741.5,-34 920870.5,-34 920870.5,-70"/>
<text text-anchor="middle" x="920806" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="920806" y="-44" font-family="Arial" font-size="10.00">EP1TP0PP1DP1_GPU37</text>
</g>
<!-- kv_read_EP1TP1PP0DP0_GPU40 -->
<g id="node4448" class="node">
<title>kv_read_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="921035.5,-78 920906.5,-78 920906.5,-26 921035.5,-26 921035.5,-78"/>
<text text-anchor="middle" x="920971" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="920971" y="-55" font-family="Arial" font-size="10.00">EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="920971" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="920971" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP1TP1PP0DP0_GPU40 -->
<g id="node4449" class="node">
<title>decode_attn_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="921204,-78 921072,-78 921072,-26 921204,-26 921204,-78"/>
<text text-anchor="middle" x="921138" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="921138" y="-55" font-family="Arial" font-size="10.00">EP1TP1PP0DP0_GPU40</text>
<text text-anchor="middle" x="921138" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="921138" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP1TP1PP0DP0_GPU40 -->
<g id="node4450" class="node">
<title>kv_write_EP1TP1PP0DP0_GPU40</title>
<polygon fill="lightgreen" stroke="black" points="921369.5,-70 921240.5,-70 921240.5,-34 921369.5,-34 921369.5,-70"/>
<text text-anchor="middle" x="921305" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="921305" y="-44" font-family="Arial" font-size="10.00">EP1TP1PP0DP0_GPU40</text>
</g>
<!-- kv_read_EP1TP1PP0DP1_GPU41 -->
<g id="node4451" class="node">
<title>kv_read_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="921534.5,-78 921405.5,-78 921405.5,-26 921534.5,-26 921534.5,-78"/>
<text text-anchor="middle" x="921470" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="921470" y="-55" font-family="Arial" font-size="10.00">EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="921470" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="921470" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP1TP1PP0DP1_GPU41 -->
<g id="node4452" class="node">
<title>decode_attn_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="921703,-78 921571,-78 921571,-26 921703,-26 921703,-78"/>
<text text-anchor="middle" x="921637" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="921637" y="-55" font-family="Arial" font-size="10.00">EP1TP1PP0DP1_GPU41</text>
<text text-anchor="middle" x="921637" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="921637" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP1TP1PP0DP1_GPU41 -->
<g id="node4453" class="node">
<title>kv_write_EP1TP1PP0DP1_GPU41</title>
<polygon fill="lightgreen" stroke="black" points="921868.5,-70 921739.5,-70 921739.5,-34 921868.5,-34 921868.5,-70"/>
<text text-anchor="middle" x="921804" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="921804" y="-44" font-family="Arial" font-size="10.00">EP1TP1PP0DP1_GPU41</text>
</g>
<!-- kv_read_EP1TP1PP1DP0_GPU44 -->
<g id="node4454" class="node">
<title>kv_read_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="922033.5,-78 921904.5,-78 921904.5,-26 922033.5,-26 922033.5,-78"/>
<text text-anchor="middle" x="921969" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="921969" y="-55" font-family="Arial" font-size="10.00">EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="921969" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="921969" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP1TP1PP1DP0_GPU44 -->
<g id="node4455" class="node">
<title>decode_attn_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="922202,-78 922070,-78 922070,-26 922202,-26 922202,-78"/>
<text text-anchor="middle" x="922136" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="922136" y="-55" font-family="Arial" font-size="10.00">EP1TP1PP1DP0_GPU44</text>
<text text-anchor="middle" x="922136" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="922136" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP1TP1PP1DP0_GPU44 -->
<g id="node4456" class="node">
<title>kv_write_EP1TP1PP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="922367.5,-70 922238.5,-70 922238.5,-34 922367.5,-34 922367.5,-70"/>
<text text-anchor="middle" x="922303" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="922303" y="-44" font-family="Arial" font-size="10.00">EP1TP1PP1DP0_GPU44</text>
</g>
<!-- kv_read_EP1TP1PP1DP1_GPU45 -->
<g id="node4457" class="node">
<title>kv_read_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="922532.5,-78 922403.5,-78 922403.5,-26 922532.5,-26 922532.5,-78"/>
<text text-anchor="middle" x="922468" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="922468" y="-55" font-family="Arial" font-size="10.00">EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="922468" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="922468" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP1TP1PP1DP1_GPU45 -->
<g id="node4458" class="node">
<title>decode_attn_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="922701,-78 922569,-78 922569,-26 922701,-26 922701,-78"/>
<text text-anchor="middle" x="922635" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="922635" y="-55" font-family="Arial" font-size="10.00">EP1TP1PP1DP1_GPU45</text>
<text text-anchor="middle" x="922635" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="922635" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP1TP1PP1DP1_GPU45 -->
<g id="node4459" class="node">
<title>kv_write_EP1TP1PP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="922866.5,-70 922737.5,-70 922737.5,-34 922866.5,-34 922866.5,-70"/>
<text text-anchor="middle" x="922802" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="922802" y="-44" font-family="Arial" font-size="10.00">EP1TP1PP1DP1_GPU45</text>
</g>
<!-- kv_read_EP1TP2PP0DP0_GPU48 -->
<g id="node4460" class="node">
<title>kv_read_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="923031.5,-78 922902.5,-78 922902.5,-26 923031.5,-26 923031.5,-78"/>
<text text-anchor="middle" x="922967" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="922967" y="-55" font-family="Arial" font-size="10.00">EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="922967" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="922967" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP1TP2PP0DP0_GPU48 -->
<g id="node4461" class="node">
<title>decode_attn_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="923200,-78 923068,-78 923068,-26 923200,-26 923200,-78"/>
<text text-anchor="middle" x="923134" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="923134" y="-55" font-family="Arial" font-size="10.00">EP1TP2PP0DP0_GPU48</text>
<text text-anchor="middle" x="923134" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="923134" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP1TP2PP0DP0_GPU48 -->
<g id="node4462" class="node">
<title>kv_write_EP1TP2PP0DP0_GPU48</title>
<polygon fill="lightgreen" stroke="black" points="923365.5,-70 923236.5,-70 923236.5,-34 923365.5,-34 923365.5,-70"/>
<text text-anchor="middle" x="923301" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="923301" y="-44" font-family="Arial" font-size="10.00">EP1TP2PP0DP0_GPU48</text>
</g>
<!-- kv_read_EP1TP2PP0DP1_GPU49 -->
<g id="node4463" class="node">
<title>kv_read_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="923530.5,-78 923401.5,-78 923401.5,-26 923530.5,-26 923530.5,-78"/>
<text text-anchor="middle" x="923466" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="923466" y="-55" font-family="Arial" font-size="10.00">EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="923466" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="923466" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP1TP2PP0DP1_GPU49 -->
<g id="node4464" class="node">
<title>decode_attn_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="923699,-78 923567,-78 923567,-26 923699,-26 923699,-78"/>
<text text-anchor="middle" x="923633" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="923633" y="-55" font-family="Arial" font-size="10.00">EP1TP2PP0DP1_GPU49</text>
<text text-anchor="middle" x="923633" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="923633" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP1TP2PP0DP1_GPU49 -->
<g id="node4465" class="node">
<title>kv_write_EP1TP2PP0DP1_GPU49</title>
<polygon fill="lightgreen" stroke="black" points="923864.5,-70 923735.5,-70 923735.5,-34 923864.5,-34 923864.5,-70"/>
<text text-anchor="middle" x="923800" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="923800" y="-44" font-family="Arial" font-size="10.00">EP1TP2PP0DP1_GPU49</text>
</g>
<!-- kv_read_EP1TP2PP1DP0_GPU52 -->
<g id="node4466" class="node">
<title>kv_read_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="924029.5,-78 923900.5,-78 923900.5,-26 924029.5,-26 924029.5,-78"/>
<text text-anchor="middle" x="923965" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="923965" y="-55" font-family="Arial" font-size="10.00">EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="923965" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="923965" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP1TP2PP1DP0_GPU52 -->
<g id="node4467" class="node">
<title>decode_attn_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="924198,-78 924066,-78 924066,-26 924198,-26 924198,-78"/>
<text text-anchor="middle" x="924132" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="924132" y="-55" font-family="Arial" font-size="10.00">EP1TP2PP1DP0_GPU52</text>
<text text-anchor="middle" x="924132" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="924132" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP1TP2PP1DP0_GPU52 -->
<g id="node4468" class="node">
<title>kv_write_EP1TP2PP1DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="924363.5,-70 924234.5,-70 924234.5,-34 924363.5,-34 924363.5,-70"/>
<text text-anchor="middle" x="924299" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="924299" y="-44" font-family="Arial" font-size="10.00">EP1TP2PP1DP0_GPU52</text>
</g>
<!-- kv_read_EP1TP2PP1DP1_GPU53 -->
<g id="node4469" class="node">
<title>kv_read_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="924528.5,-78 924399.5,-78 924399.5,-26 924528.5,-26 924528.5,-78"/>
<text text-anchor="middle" x="924464" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="924464" y="-55" font-family="Arial" font-size="10.00">EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="924464" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="924464" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP1TP2PP1DP1_GPU53 -->
<g id="node4470" class="node">
<title>decode_attn_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="924697,-78 924565,-78 924565,-26 924697,-26 924697,-78"/>
<text text-anchor="middle" x="924631" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="924631" y="-55" font-family="Arial" font-size="10.00">EP1TP2PP1DP1_GPU53</text>
<text text-anchor="middle" x="924631" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="924631" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP1TP2PP1DP1_GPU53 -->
<g id="node4471" class="node">
<title>kv_write_EP1TP2PP1DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="924862.5,-70 924733.5,-70 924733.5,-34 924862.5,-34 924862.5,-70"/>
<text text-anchor="middle" x="924798" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="924798" y="-44" font-family="Arial" font-size="10.00">EP1TP2PP1DP1_GPU53</text>
</g>
<!-- kv_read_EP1TP3PP0DP0_GPU56 -->
<g id="node4472" class="node">
<title>kv_read_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="925027.5,-78 924898.5,-78 924898.5,-26 925027.5,-26 925027.5,-78"/>
<text text-anchor="middle" x="924963" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="924963" y="-55" font-family="Arial" font-size="10.00">EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="924963" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="924963" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP1TP3PP0DP0_GPU56 -->
<g id="node4473" class="node">
<title>decode_attn_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="925196,-78 925064,-78 925064,-26 925196,-26 925196,-78"/>
<text text-anchor="middle" x="925130" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="925130" y="-55" font-family="Arial" font-size="10.00">EP1TP3PP0DP0_GPU56</text>
<text text-anchor="middle" x="925130" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="925130" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP1TP3PP0DP0_GPU56 -->
<g id="node4474" class="node">
<title>kv_write_EP1TP3PP0DP0_GPU56</title>
<polygon fill="lightgreen" stroke="black" points="925361.5,-70 925232.5,-70 925232.5,-34 925361.5,-34 925361.5,-70"/>
<text text-anchor="middle" x="925297" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="925297" y="-44" font-family="Arial" font-size="10.00">EP1TP3PP0DP0_GPU56</text>
</g>
<!-- kv_read_EP1TP3PP0DP1_GPU57 -->
<g id="node4475" class="node">
<title>kv_read_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="925526.5,-78 925397.5,-78 925397.5,-26 925526.5,-26 925526.5,-78"/>
<text text-anchor="middle" x="925462" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="925462" y="-55" font-family="Arial" font-size="10.00">EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="925462" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="925462" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP1TP3PP0DP1_GPU57 -->
<g id="node4476" class="node">
<title>decode_attn_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="925695,-78 925563,-78 925563,-26 925695,-26 925695,-78"/>
<text text-anchor="middle" x="925629" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="925629" y="-55" font-family="Arial" font-size="10.00">EP1TP3PP0DP1_GPU57</text>
<text text-anchor="middle" x="925629" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="925629" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP1TP3PP0DP1_GPU57 -->
<g id="node4477" class="node">
<title>kv_write_EP1TP3PP0DP1_GPU57</title>
<polygon fill="lightgreen" stroke="black" points="925860.5,-70 925731.5,-70 925731.5,-34 925860.5,-34 925860.5,-70"/>
<text text-anchor="middle" x="925796" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="925796" y="-44" font-family="Arial" font-size="10.00">EP1TP3PP0DP1_GPU57</text>
</g>
<!-- kv_read_EP1TP3PP1DP0_GPU60 -->
<g id="node4478" class="node">
<title>kv_read_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="926025.5,-78 925896.5,-78 925896.5,-26 926025.5,-26 926025.5,-78"/>
<text text-anchor="middle" x="925961" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="925961" y="-55" font-family="Arial" font-size="10.00">EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="925961" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="925961" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP1TP3PP1DP0_GPU60 -->
<g id="node4479" class="node">
<title>decode_attn_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="926194,-78 926062,-78 926062,-26 926194,-26 926194,-78"/>
<text text-anchor="middle" x="926128" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="926128" y="-55" font-family="Arial" font-size="10.00">EP1TP3PP1DP0_GPU60</text>
<text text-anchor="middle" x="926128" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="926128" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP1TP3PP1DP0_GPU60 -->
<g id="node4480" class="node">
<title>kv_write_EP1TP3PP1DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="926359.5,-70 926230.5,-70 926230.5,-34 926359.5,-34 926359.5,-70"/>
<text text-anchor="middle" x="926295" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="926295" y="-44" font-family="Arial" font-size="10.00">EP1TP3PP1DP0_GPU60</text>
</g>
<!-- kv_read_EP1TP3PP1DP1_GPU61 -->
<g id="node4481" class="node">
<title>kv_read_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="926524.5,-78 926395.5,-78 926395.5,-26 926524.5,-26 926524.5,-78"/>
<text text-anchor="middle" x="926460" y="-66" font-family="Arial" font-size="10.00">KV Cache Read</text>
<text text-anchor="middle" x="926460" y="-55" font-family="Arial" font-size="10.00">EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="926460" y="-44" font-family="Arial" font-size="10.00">In: [B=1,S=1,H=512]</text>
<text text-anchor="middle" x="926460" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,S=1,H=512]</text>
</g>
<!-- decode_attn_EP1TP3PP1DP1_GPU61 -->
<g id="node4482" class="node">
<title>decode_attn_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="926693,-78 926561,-78 926561,-26 926693,-26 926693,-78"/>
<text text-anchor="middle" x="926627" y="-66" font-family="Arial" font-size="10.00">Decode Attention</text>
<text text-anchor="middle" x="926627" y="-55" font-family="Arial" font-size="10.00">EP1TP3PP1DP1_GPU61</text>
<text text-anchor="middle" x="926627" y="-44" font-family="Arial" font-size="10.00">In: [B=1,H=4,S=1,D=64]</text>
<text text-anchor="middle" x="926627" y="-33" font-family="Arial" font-size="10.00">Out: [B=1,H=4,S=1,D=64]</text>
</g>
<!-- kv_write_EP1TP3PP1DP1_GPU61 -->
<g id="node4483" class="node">
<title>kv_write_EP1TP3PP1DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="926858.5,-70 926729.5,-70 926729.5,-34 926858.5,-34 926858.5,-70"/>
<text text-anchor="middle" x="926794" y="-55" font-family="Arial" font-size="10.00">KV Cache Update</text>
<text text-anchor="middle" x="926794" y="-44" font-family="Arial" font-size="10.00">EP1TP3PP1DP1_GPU61</text>
</g>
<!-- decode_end -->
<g id="node4484" class="node">
<title>decode_end</title>
<polygon fill="lightblue" stroke="black" points="927183,-70 926895,-70 926895,-34 927183,-34 927183,-70"/>
<text text-anchor="middle" x="927039" y="-55" font-family="Arial" font-size="10.00">Decode Phase End</text>
<text text-anchor="middle" x="927039" y="-44" font-family="Arial" font-size="10.00">All Tokens Processed</text>
</g>
<!-- output_start -->
<g id="node4485" class="node">
<title>output_start</title>
<polygon fill="lightblue" stroke="black" points="927320.5,-70 927219.5,-70 927219.5,-34 927320.5,-34 927320.5,-70"/>
<text text-anchor="middle" x="927270" y="-49.5" font-family="Arial" font-size="10.00">Output Phase Start</text>
</g>
<!-- final_ln_EP0TP0DP0_GPU4 -->
<g id="node4486" class="node">
<title>final_ln_EP0TP0DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="927477.5,-78 927356.5,-78 927356.5,-26 927477.5,-26 927477.5,-78"/>
<text text-anchor="middle" x="927417" y="-66" font-family="Arial" font-size="10.00">Final Layer Norm</text>
<text text-anchor="middle" x="927417" y="-55" font-family="Arial" font-size="10.00">EP0TP0DP0_GPU4</text>
<text text-anchor="middle" x="927417" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="927417" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,H=512]</text>
</g>
<!-- output_proj_EP0TP0DP0_GPU4 -->
<g id="node4487" class="node">
<title>output_proj_EP0TP0DP0_GPU4</title>
<polygon fill="lightgreen" stroke="black" points="927638.5,-78 927513.5,-78 927513.5,-26 927638.5,-26 927638.5,-78"/>
<text text-anchor="middle" x="927576" y="-66" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="927576" y="-55" font-family="Arial" font-size="10.00">EP0TP0DP0_GPU4</text>
<text text-anchor="middle" x="927576" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="927576" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,V=8000]</text>
</g>
<!-- final_ar_EP0TP0DP0_GPU4 -->
<g id="node4488" class="node">
<title>final_ar_EP0TP0DP0_GPU4</title>
<ellipse fill="lightblue" stroke="black" cx="927752" cy="-52" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="927752" y="-60.5" font-family="Arial" font-size="10.00">Final All&#45;Reduce</text>
<text text-anchor="middle" x="927752" y="-49.5" font-family="Arial" font-size="10.00">EP0 TP Group 0 DP0</text>
<text text-anchor="middle" x="927752" y="-38.5" font-family="Arial" font-size="10.00">GPU4</text>
</g>
<!-- final_ln_EP0TP0DP1_GPU5 -->
<g id="node4489" class="node">
<title>final_ln_EP0TP0DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="927986.5,-78 927865.5,-78 927865.5,-26 927986.5,-26 927986.5,-78"/>
<text text-anchor="middle" x="927926" y="-66" font-family="Arial" font-size="10.00">Final Layer Norm</text>
<text text-anchor="middle" x="927926" y="-55" font-family="Arial" font-size="10.00">EP0TP0DP1_GPU5</text>
<text text-anchor="middle" x="927926" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="927926" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,H=512]</text>
</g>
<!-- output_proj_EP0TP0DP1_GPU5 -->
<g id="node4490" class="node">
<title>output_proj_EP0TP0DP1_GPU5</title>
<polygon fill="lightgreen" stroke="black" points="928147.5,-78 928022.5,-78 928022.5,-26 928147.5,-26 928147.5,-78"/>
<text text-anchor="middle" x="928085" y="-66" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="928085" y="-55" font-family="Arial" font-size="10.00">EP0TP0DP1_GPU5</text>
<text text-anchor="middle" x="928085" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="928085" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,V=8000]</text>
</g>
<!-- final_ar_EP0TP0DP1_GPU5 -->
<g id="node4491" class="node">
<title>final_ar_EP0TP0DP1_GPU5</title>
<ellipse fill="lightblue" stroke="black" cx="928261" cy="-52" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="928261" y="-60.5" font-family="Arial" font-size="10.00">Final All&#45;Reduce</text>
<text text-anchor="middle" x="928261" y="-49.5" font-family="Arial" font-size="10.00">EP0 TP Group 0 DP1</text>
<text text-anchor="middle" x="928261" y="-38.5" font-family="Arial" font-size="10.00">GPU5</text>
</g>
<!-- final_ln_EP0TP1DP0_GPU12 -->
<g id="node4492" class="node">
<title>final_ln_EP0TP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="928495.5,-78 928374.5,-78 928374.5,-26 928495.5,-26 928495.5,-78"/>
<text text-anchor="middle" x="928435" y="-66" font-family="Arial" font-size="10.00">Final Layer Norm</text>
<text text-anchor="middle" x="928435" y="-55" font-family="Arial" font-size="10.00">EP0TP1DP0_GPU12</text>
<text text-anchor="middle" x="928435" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="928435" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,H=512]</text>
</g>
<!-- output_proj_EP0TP1DP0_GPU12 -->
<g id="node4493" class="node">
<title>output_proj_EP0TP1DP0_GPU12</title>
<polygon fill="lightgreen" stroke="black" points="928656.5,-78 928531.5,-78 928531.5,-26 928656.5,-26 928656.5,-78"/>
<text text-anchor="middle" x="928594" y="-66" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="928594" y="-55" font-family="Arial" font-size="10.00">EP0TP1DP0_GPU12</text>
<text text-anchor="middle" x="928594" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="928594" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,V=8000]</text>
</g>
<!-- final_ar_EP0TP1DP0_GPU12 -->
<g id="node4494" class="node">
<title>final_ar_EP0TP1DP0_GPU12</title>
<ellipse fill="lightblue" stroke="black" cx="928770" cy="-52" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="928770" y="-60.5" font-family="Arial" font-size="10.00">Final All&#45;Reduce</text>
<text text-anchor="middle" x="928770" y="-49.5" font-family="Arial" font-size="10.00">EP0 TP Group 1 DP0</text>
<text text-anchor="middle" x="928770" y="-38.5" font-family="Arial" font-size="10.00">GPU12</text>
</g>
<!-- final_ln_EP0TP1DP1_GPU13 -->
<g id="node4495" class="node">
<title>final_ln_EP0TP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="929004.5,-78 928883.5,-78 928883.5,-26 929004.5,-26 929004.5,-78"/>
<text text-anchor="middle" x="928944" y="-66" font-family="Arial" font-size="10.00">Final Layer Norm</text>
<text text-anchor="middle" x="928944" y="-55" font-family="Arial" font-size="10.00">EP0TP1DP1_GPU13</text>
<text text-anchor="middle" x="928944" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="928944" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,H=512]</text>
</g>
<!-- output_proj_EP0TP1DP1_GPU13 -->
<g id="node4496" class="node">
<title>output_proj_EP0TP1DP1_GPU13</title>
<polygon fill="lightgreen" stroke="black" points="929165.5,-78 929040.5,-78 929040.5,-26 929165.5,-26 929165.5,-78"/>
<text text-anchor="middle" x="929103" y="-66" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="929103" y="-55" font-family="Arial" font-size="10.00">EP0TP1DP1_GPU13</text>
<text text-anchor="middle" x="929103" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="929103" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,V=8000]</text>
</g>
<!-- final_ar_EP0TP1DP1_GPU13 -->
<g id="node4497" class="node">
<title>final_ar_EP0TP1DP1_GPU13</title>
<ellipse fill="lightblue" stroke="black" cx="929279" cy="-52" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="929279" y="-60.5" font-family="Arial" font-size="10.00">Final All&#45;Reduce</text>
<text text-anchor="middle" x="929279" y="-49.5" font-family="Arial" font-size="10.00">EP0 TP Group 1 DP1</text>
<text text-anchor="middle" x="929279" y="-38.5" font-family="Arial" font-size="10.00">GPU13</text>
</g>
<!-- final_ln_EP0TP2DP0_GPU20 -->
<g id="node4498" class="node">
<title>final_ln_EP0TP2DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="929513.5,-78 929392.5,-78 929392.5,-26 929513.5,-26 929513.5,-78"/>
<text text-anchor="middle" x="929453" y="-66" font-family="Arial" font-size="10.00">Final Layer Norm</text>
<text text-anchor="middle" x="929453" y="-55" font-family="Arial" font-size="10.00">EP0TP2DP0_GPU20</text>
<text text-anchor="middle" x="929453" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="929453" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,H=512]</text>
</g>
<!-- output_proj_EP0TP2DP0_GPU20 -->
<g id="node4499" class="node">
<title>output_proj_EP0TP2DP0_GPU20</title>
<polygon fill="lightgreen" stroke="black" points="929674.5,-78 929549.5,-78 929549.5,-26 929674.5,-26 929674.5,-78"/>
<text text-anchor="middle" x="929612" y="-66" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="929612" y="-55" font-family="Arial" font-size="10.00">EP0TP2DP0_GPU20</text>
<text text-anchor="middle" x="929612" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="929612" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,V=8000]</text>
</g>
<!-- final_ar_EP0TP2DP0_GPU20 -->
<g id="node4500" class="node">
<title>final_ar_EP0TP2DP0_GPU20</title>
<ellipse fill="lightblue" stroke="black" cx="929788" cy="-52" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="929788" y="-60.5" font-family="Arial" font-size="10.00">Final All&#45;Reduce</text>
<text text-anchor="middle" x="929788" y="-49.5" font-family="Arial" font-size="10.00">EP0 TP Group 2 DP0</text>
<text text-anchor="middle" x="929788" y="-38.5" font-family="Arial" font-size="10.00">GPU20</text>
</g>
<!-- final_ln_EP0TP2DP1_GPU21 -->
<g id="node4501" class="node">
<title>final_ln_EP0TP2DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="930022.5,-78 929901.5,-78 929901.5,-26 930022.5,-26 930022.5,-78"/>
<text text-anchor="middle" x="929962" y="-66" font-family="Arial" font-size="10.00">Final Layer Norm</text>
<text text-anchor="middle" x="929962" y="-55" font-family="Arial" font-size="10.00">EP0TP2DP1_GPU21</text>
<text text-anchor="middle" x="929962" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="929962" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,H=512]</text>
</g>
<!-- output_proj_EP0TP2DP1_GPU21 -->
<g id="node4502" class="node">
<title>output_proj_EP0TP2DP1_GPU21</title>
<polygon fill="lightgreen" stroke="black" points="930183.5,-78 930058.5,-78 930058.5,-26 930183.5,-26 930183.5,-78"/>
<text text-anchor="middle" x="930121" y="-66" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="930121" y="-55" font-family="Arial" font-size="10.00">EP0TP2DP1_GPU21</text>
<text text-anchor="middle" x="930121" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="930121" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,V=8000]</text>
</g>
<!-- final_ar_EP0TP2DP1_GPU21 -->
<g id="node4503" class="node">
<title>final_ar_EP0TP2DP1_GPU21</title>
<ellipse fill="lightblue" stroke="black" cx="930297" cy="-52" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="930297" y="-60.5" font-family="Arial" font-size="10.00">Final All&#45;Reduce</text>
<text text-anchor="middle" x="930297" y="-49.5" font-family="Arial" font-size="10.00">EP0 TP Group 2 DP1</text>
<text text-anchor="middle" x="930297" y="-38.5" font-family="Arial" font-size="10.00">GPU21</text>
</g>
<!-- final_ln_EP0TP3DP0_GPU28 -->
<g id="node4504" class="node">
<title>final_ln_EP0TP3DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="930531.5,-78 930410.5,-78 930410.5,-26 930531.5,-26 930531.5,-78"/>
<text text-anchor="middle" x="930471" y="-66" font-family="Arial" font-size="10.00">Final Layer Norm</text>
<text text-anchor="middle" x="930471" y="-55" font-family="Arial" font-size="10.00">EP0TP3DP0_GPU28</text>
<text text-anchor="middle" x="930471" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="930471" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,H=512]</text>
</g>
<!-- output_proj_EP0TP3DP0_GPU28 -->
<g id="node4505" class="node">
<title>output_proj_EP0TP3DP0_GPU28</title>
<polygon fill="lightgreen" stroke="black" points="930692.5,-78 930567.5,-78 930567.5,-26 930692.5,-26 930692.5,-78"/>
<text text-anchor="middle" x="930630" y="-66" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="930630" y="-55" font-family="Arial" font-size="10.00">EP0TP3DP0_GPU28</text>
<text text-anchor="middle" x="930630" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="930630" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,V=8000]</text>
</g>
<!-- final_ar_EP0TP3DP0_GPU28 -->
<g id="node4506" class="node">
<title>final_ar_EP0TP3DP0_GPU28</title>
<ellipse fill="lightblue" stroke="black" cx="930806" cy="-52" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="930806" y="-60.5" font-family="Arial" font-size="10.00">Final All&#45;Reduce</text>
<text text-anchor="middle" x="930806" y="-49.5" font-family="Arial" font-size="10.00">EP0 TP Group 3 DP0</text>
<text text-anchor="middle" x="930806" y="-38.5" font-family="Arial" font-size="10.00">GPU28</text>
</g>
<!-- final_ln_EP0TP3DP1_GPU29 -->
<g id="node4507" class="node">
<title>final_ln_EP0TP3DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="931040.5,-78 930919.5,-78 930919.5,-26 931040.5,-26 931040.5,-78"/>
<text text-anchor="middle" x="930980" y="-66" font-family="Arial" font-size="10.00">Final Layer Norm</text>
<text text-anchor="middle" x="930980" y="-55" font-family="Arial" font-size="10.00">EP0TP3DP1_GPU29</text>
<text text-anchor="middle" x="930980" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="930980" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,H=512]</text>
</g>
<!-- output_proj_EP0TP3DP1_GPU29 -->
<g id="node4508" class="node">
<title>output_proj_EP0TP3DP1_GPU29</title>
<polygon fill="lightgreen" stroke="black" points="931201.5,-78 931076.5,-78 931076.5,-26 931201.5,-26 931201.5,-78"/>
<text text-anchor="middle" x="931139" y="-66" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="931139" y="-55" font-family="Arial" font-size="10.00">EP0TP3DP1_GPU29</text>
<text text-anchor="middle" x="931139" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="931139" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,V=8000]</text>
</g>
<!-- final_ar_EP0TP3DP1_GPU29 -->
<g id="node4509" class="node">
<title>final_ar_EP0TP3DP1_GPU29</title>
<ellipse fill="lightblue" stroke="black" cx="931315" cy="-52" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="931315" y="-60.5" font-family="Arial" font-size="10.00">Final All&#45;Reduce</text>
<text text-anchor="middle" x="931315" y="-49.5" font-family="Arial" font-size="10.00">EP0 TP Group 3 DP1</text>
<text text-anchor="middle" x="931315" y="-38.5" font-family="Arial" font-size="10.00">GPU29</text>
</g>
<!-- final_ln_EP1TP0DP0_GPU36 -->
<g id="node4510" class="node">
<title>final_ln_EP1TP0DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="931549.5,-78 931428.5,-78 931428.5,-26 931549.5,-26 931549.5,-78"/>
<text text-anchor="middle" x="931489" y="-66" font-family="Arial" font-size="10.00">Final Layer Norm</text>
<text text-anchor="middle" x="931489" y="-55" font-family="Arial" font-size="10.00">EP1TP0DP0_GPU36</text>
<text text-anchor="middle" x="931489" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="931489" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,H=512]</text>
</g>
<!-- output_proj_EP1TP0DP0_GPU36 -->
<g id="node4511" class="node">
<title>output_proj_EP1TP0DP0_GPU36</title>
<polygon fill="lightgreen" stroke="black" points="931710.5,-78 931585.5,-78 931585.5,-26 931710.5,-26 931710.5,-78"/>
<text text-anchor="middle" x="931648" y="-66" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="931648" y="-55" font-family="Arial" font-size="10.00">EP1TP0DP0_GPU36</text>
<text text-anchor="middle" x="931648" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="931648" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,V=8000]</text>
</g>
<!-- final_ar_EP1TP0DP0_GPU36 -->
<g id="node4512" class="node">
<title>final_ar_EP1TP0DP0_GPU36</title>
<ellipse fill="lightblue" stroke="black" cx="931824" cy="-52" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="931824" y="-60.5" font-family="Arial" font-size="10.00">Final All&#45;Reduce</text>
<text text-anchor="middle" x="931824" y="-49.5" font-family="Arial" font-size="10.00">EP1 TP Group 0 DP0</text>
<text text-anchor="middle" x="931824" y="-38.5" font-family="Arial" font-size="10.00">GPU36</text>
</g>
<!-- final_ln_EP1TP0DP1_GPU37 -->
<g id="node4513" class="node">
<title>final_ln_EP1TP0DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="932058.5,-78 931937.5,-78 931937.5,-26 932058.5,-26 932058.5,-78"/>
<text text-anchor="middle" x="931998" y="-66" font-family="Arial" font-size="10.00">Final Layer Norm</text>
<text text-anchor="middle" x="931998" y="-55" font-family="Arial" font-size="10.00">EP1TP0DP1_GPU37</text>
<text text-anchor="middle" x="931998" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="931998" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,H=512]</text>
</g>
<!-- output_proj_EP1TP0DP1_GPU37 -->
<g id="node4514" class="node">
<title>output_proj_EP1TP0DP1_GPU37</title>
<polygon fill="lightgreen" stroke="black" points="932219.5,-78 932094.5,-78 932094.5,-26 932219.5,-26 932219.5,-78"/>
<text text-anchor="middle" x="932157" y="-66" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="932157" y="-55" font-family="Arial" font-size="10.00">EP1TP0DP1_GPU37</text>
<text text-anchor="middle" x="932157" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="932157" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,V=8000]</text>
</g>
<!-- final_ar_EP1TP0DP1_GPU37 -->
<g id="node4515" class="node">
<title>final_ar_EP1TP0DP1_GPU37</title>
<ellipse fill="lightblue" stroke="black" cx="932333" cy="-52" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="932333" y="-60.5" font-family="Arial" font-size="10.00">Final All&#45;Reduce</text>
<text text-anchor="middle" x="932333" y="-49.5" font-family="Arial" font-size="10.00">EP1 TP Group 0 DP1</text>
<text text-anchor="middle" x="932333" y="-38.5" font-family="Arial" font-size="10.00">GPU37</text>
</g>
<!-- final_ln_EP1TP1DP0_GPU44 -->
<g id="node4516" class="node">
<title>final_ln_EP1TP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="932567.5,-78 932446.5,-78 932446.5,-26 932567.5,-26 932567.5,-78"/>
<text text-anchor="middle" x="932507" y="-66" font-family="Arial" font-size="10.00">Final Layer Norm</text>
<text text-anchor="middle" x="932507" y="-55" font-family="Arial" font-size="10.00">EP1TP1DP0_GPU44</text>
<text text-anchor="middle" x="932507" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="932507" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,H=512]</text>
</g>
<!-- output_proj_EP1TP1DP0_GPU44 -->
<g id="node4517" class="node">
<title>output_proj_EP1TP1DP0_GPU44</title>
<polygon fill="lightgreen" stroke="black" points="932728.5,-78 932603.5,-78 932603.5,-26 932728.5,-26 932728.5,-78"/>
<text text-anchor="middle" x="932666" y="-66" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="932666" y="-55" font-family="Arial" font-size="10.00">EP1TP1DP0_GPU44</text>
<text text-anchor="middle" x="932666" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="932666" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,V=8000]</text>
</g>
<!-- final_ar_EP1TP1DP0_GPU44 -->
<g id="node4518" class="node">
<title>final_ar_EP1TP1DP0_GPU44</title>
<ellipse fill="lightblue" stroke="black" cx="932842" cy="-52" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="932842" y="-60.5" font-family="Arial" font-size="10.00">Final All&#45;Reduce</text>
<text text-anchor="middle" x="932842" y="-49.5" font-family="Arial" font-size="10.00">EP1 TP Group 1 DP0</text>
<text text-anchor="middle" x="932842" y="-38.5" font-family="Arial" font-size="10.00">GPU44</text>
</g>
<!-- final_ln_EP1TP1DP1_GPU45 -->
<g id="node4519" class="node">
<title>final_ln_EP1TP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="933076.5,-78 932955.5,-78 932955.5,-26 933076.5,-26 933076.5,-78"/>
<text text-anchor="middle" x="933016" y="-66" font-family="Arial" font-size="10.00">Final Layer Norm</text>
<text text-anchor="middle" x="933016" y="-55" font-family="Arial" font-size="10.00">EP1TP1DP1_GPU45</text>
<text text-anchor="middle" x="933016" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="933016" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,H=512]</text>
</g>
<!-- output_proj_EP1TP1DP1_GPU45 -->
<g id="node4520" class="node">
<title>output_proj_EP1TP1DP1_GPU45</title>
<polygon fill="lightgreen" stroke="black" points="933237.5,-78 933112.5,-78 933112.5,-26 933237.5,-26 933237.5,-78"/>
<text text-anchor="middle" x="933175" y="-66" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="933175" y="-55" font-family="Arial" font-size="10.00">EP1TP1DP1_GPU45</text>
<text text-anchor="middle" x="933175" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="933175" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,V=8000]</text>
</g>
<!-- final_ar_EP1TP1DP1_GPU45 -->
<g id="node4521" class="node">
<title>final_ar_EP1TP1DP1_GPU45</title>
<ellipse fill="lightblue" stroke="black" cx="933351" cy="-52" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="933351" y="-60.5" font-family="Arial" font-size="10.00">Final All&#45;Reduce</text>
<text text-anchor="middle" x="933351" y="-49.5" font-family="Arial" font-size="10.00">EP1 TP Group 1 DP1</text>
<text text-anchor="middle" x="933351" y="-38.5" font-family="Arial" font-size="10.00">GPU45</text>
</g>
<!-- final_ln_EP1TP2DP0_GPU52 -->
<g id="node4522" class="node">
<title>final_ln_EP1TP2DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="933585.5,-78 933464.5,-78 933464.5,-26 933585.5,-26 933585.5,-78"/>
<text text-anchor="middle" x="933525" y="-66" font-family="Arial" font-size="10.00">Final Layer Norm</text>
<text text-anchor="middle" x="933525" y="-55" font-family="Arial" font-size="10.00">EP1TP2DP0_GPU52</text>
<text text-anchor="middle" x="933525" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="933525" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,H=512]</text>
</g>
<!-- output_proj_EP1TP2DP0_GPU52 -->
<g id="node4523" class="node">
<title>output_proj_EP1TP2DP0_GPU52</title>
<polygon fill="lightgreen" stroke="black" points="933746.5,-78 933621.5,-78 933621.5,-26 933746.5,-26 933746.5,-78"/>
<text text-anchor="middle" x="933684" y="-66" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="933684" y="-55" font-family="Arial" font-size="10.00">EP1TP2DP0_GPU52</text>
<text text-anchor="middle" x="933684" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="933684" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,V=8000]</text>
</g>
<!-- final_ar_EP1TP2DP0_GPU52 -->
<g id="node4524" class="node">
<title>final_ar_EP1TP2DP0_GPU52</title>
<ellipse fill="lightblue" stroke="black" cx="933860" cy="-52" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="933860" y="-60.5" font-family="Arial" font-size="10.00">Final All&#45;Reduce</text>
<text text-anchor="middle" x="933860" y="-49.5" font-family="Arial" font-size="10.00">EP1 TP Group 2 DP0</text>
<text text-anchor="middle" x="933860" y="-38.5" font-family="Arial" font-size="10.00">GPU52</text>
</g>
<!-- final_ln_EP1TP2DP1_GPU53 -->
<g id="node4525" class="node">
<title>final_ln_EP1TP2DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="934094.5,-78 933973.5,-78 933973.5,-26 934094.5,-26 934094.5,-78"/>
<text text-anchor="middle" x="934034" y="-66" font-family="Arial" font-size="10.00">Final Layer Norm</text>
<text text-anchor="middle" x="934034" y="-55" font-family="Arial" font-size="10.00">EP1TP2DP1_GPU53</text>
<text text-anchor="middle" x="934034" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="934034" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,H=512]</text>
</g>
<!-- output_proj_EP1TP2DP1_GPU53 -->
<g id="node4526" class="node">
<title>output_proj_EP1TP2DP1_GPU53</title>
<polygon fill="lightgreen" stroke="black" points="934255.5,-78 934130.5,-78 934130.5,-26 934255.5,-26 934255.5,-78"/>
<text text-anchor="middle" x="934193" y="-66" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="934193" y="-55" font-family="Arial" font-size="10.00">EP1TP2DP1_GPU53</text>
<text text-anchor="middle" x="934193" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="934193" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,V=8000]</text>
</g>
<!-- final_ar_EP1TP2DP1_GPU53 -->
<g id="node4527" class="node">
<title>final_ar_EP1TP2DP1_GPU53</title>
<ellipse fill="lightblue" stroke="black" cx="934369" cy="-52" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="934369" y="-60.5" font-family="Arial" font-size="10.00">Final All&#45;Reduce</text>
<text text-anchor="middle" x="934369" y="-49.5" font-family="Arial" font-size="10.00">EP1 TP Group 2 DP1</text>
<text text-anchor="middle" x="934369" y="-38.5" font-family="Arial" font-size="10.00">GPU53</text>
</g>
<!-- final_ln_EP1TP3DP0_GPU60 -->
<g id="node4528" class="node">
<title>final_ln_EP1TP3DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="934603.5,-78 934482.5,-78 934482.5,-26 934603.5,-26 934603.5,-78"/>
<text text-anchor="middle" x="934543" y="-66" font-family="Arial" font-size="10.00">Final Layer Norm</text>
<text text-anchor="middle" x="934543" y="-55" font-family="Arial" font-size="10.00">EP1TP3DP0_GPU60</text>
<text text-anchor="middle" x="934543" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="934543" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,H=512]</text>
</g>
<!-- output_proj_EP1TP3DP0_GPU60 -->
<g id="node4529" class="node">
<title>output_proj_EP1TP3DP0_GPU60</title>
<polygon fill="lightgreen" stroke="black" points="934764.5,-78 934639.5,-78 934639.5,-26 934764.5,-26 934764.5,-78"/>
<text text-anchor="middle" x="934702" y="-66" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="934702" y="-55" font-family="Arial" font-size="10.00">EP1TP3DP0_GPU60</text>
<text text-anchor="middle" x="934702" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="934702" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,V=8000]</text>
</g>
<!-- final_ar_EP1TP3DP0_GPU60 -->
<g id="node4530" class="node">
<title>final_ar_EP1TP3DP0_GPU60</title>
<ellipse fill="lightblue" stroke="black" cx="934878" cy="-52" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="934878" y="-60.5" font-family="Arial" font-size="10.00">Final All&#45;Reduce</text>
<text text-anchor="middle" x="934878" y="-49.5" font-family="Arial" font-size="10.00">EP1 TP Group 3 DP0</text>
<text text-anchor="middle" x="934878" y="-38.5" font-family="Arial" font-size="10.00">GPU60</text>
</g>
<!-- final_ln_EP1TP3DP1_GPU61 -->
<g id="node4531" class="node">
<title>final_ln_EP1TP3DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="935112.5,-78 934991.5,-78 934991.5,-26 935112.5,-26 935112.5,-78"/>
<text text-anchor="middle" x="935052" y="-66" font-family="Arial" font-size="10.00">Final Layer Norm</text>
<text text-anchor="middle" x="935052" y="-55" font-family="Arial" font-size="10.00">EP1TP3DP1_GPU61</text>
<text text-anchor="middle" x="935052" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="935052" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,H=512]</text>
</g>
<!-- output_proj_EP1TP3DP1_GPU61 -->
<g id="node4532" class="node">
<title>output_proj_EP1TP3DP1_GPU61</title>
<polygon fill="lightgreen" stroke="black" points="935273.5,-78 935148.5,-78 935148.5,-26 935273.5,-26 935273.5,-78"/>
<text text-anchor="middle" x="935211" y="-66" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="935211" y="-55" font-family="Arial" font-size="10.00">EP1TP3DP1_GPU61</text>
<text text-anchor="middle" x="935211" y="-44" font-family="Arial" font-size="10.00">In: [B=32,S=1,H=512]</text>
<text text-anchor="middle" x="935211" y="-33" font-family="Arial" font-size="10.00">Out: [B=32,S=1,V=8000]</text>
</g>
<!-- final_ar_EP1TP3DP1_GPU61 -->
<g id="node4533" class="node">
<title>final_ar_EP1TP3DP1_GPU61</title>
<ellipse fill="lightblue" stroke="black" cx="935387" cy="-52" rx="77.56" ry="28.98"/>
<text text-anchor="middle" x="935387" y="-60.5" font-family="Arial" font-size="10.00">Final All&#45;Reduce</text>
<text text-anchor="middle" x="935387" y="-49.5" font-family="Arial" font-size="10.00">EP1 TP Group 3 DP1</text>
<text text-anchor="middle" x="935387" y="-38.5" font-family="Arial" font-size="10.00">GPU61</text>
</g>
<!-- final_output -->
<g id="node4534" class="node">
<title>final_output</title>
<polygon fill="lightgreen" stroke="black" points="935789,-70 935501,-70 935501,-34 935789,-34 935789,-70"/>
<text text-anchor="middle" x="935645" y="-55" font-family="Arial" font-size="10.00">Final Output</text>
<text text-anchor="middle" x="935645" y="-44" font-family="Arial" font-size="10.00">Batch: 128, Vocab: 32000</text>
</g>
</g>
</svg>
