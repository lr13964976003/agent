<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="68pt" height="1440pt"
 viewBox="0.00 0.00 68.38 1440.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.06 0.06) rotate(0) translate(4 22171.33)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-22171.33 1049,-22171.33 1049,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_pipeline_stage_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="15,-11100.17 15,-22159.33 1037,-22159.33 1037,-11100.17 15,-11100.17"/>
<text text-anchor="middle" x="526" y="-22144.13" font-family="Times,serif" font-size="14.00">Pipeline Stage 0: Layers 0&#45;7</text>
<text text-anchor="middle" x="526" y="-22129.13" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7 (TP=8)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="23,-20667.17 23,-21990.17 1029,-21990.17 1029,-20667.17 23,-20667.17"/>
<text text-anchor="middle" x="526" y="-21974.97" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="23,-19325.17 23,-20648.17 1029,-20648.17 1029,-19325.17 23,-19325.17"/>
<text text-anchor="middle" x="526" y="-20632.97" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="23,-17983.17 23,-19306.17 1029,-19306.17 1029,-17983.17 23,-17983.17"/>
<text text-anchor="middle" x="526" y="-19290.97" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="23,-16641.17 23,-17964.17 1029,-17964.17 1029,-16641.17 23,-16641.17"/>
<text text-anchor="middle" x="526" y="-17948.97" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer_4</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="23,-15299.17 23,-16622.17 1029,-16622.17 1029,-15299.17 23,-15299.17"/>
<text text-anchor="middle" x="526" y="-16606.97" font-family="Times,serif" font-size="14.00">Layer 4</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer_5</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="23,-13957.17 23,-15280.17 1029,-15280.17 1029,-13957.17 23,-13957.17"/>
<text text-anchor="middle" x="526" y="-15264.97" font-family="Times,serif" font-size="14.00">Layer 5</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer_6</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="23,-12615.17 23,-13938.17 1029,-13938.17 1029,-12615.17 23,-12615.17"/>
<text text-anchor="middle" x="526" y="-13922.97" font-family="Times,serif" font-size="14.00">Layer 6</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer_7</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="23,-11273.17 23,-12596.17 1029,-12596.17 1029,-11273.17 23,-11273.17"/>
<text text-anchor="middle" x="526" y="-12580.97" font-family="Times,serif" font-size="14.00">Layer 7</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_pipeline_stage_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-8 8,-11067.17 1030,-11067.17 1030,-8 8,-8"/>
<text text-anchor="middle" x="519" y="-11051.97" font-family="Times,serif" font-size="14.00">Pipeline Stage 1: Layers 8&#45;15</text>
<text text-anchor="middle" x="519" y="-11036.97" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15 (TP=8)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="16,-9535.17 16,-10858.17 1022,-10858.17 1022,-9535.17 16,-9535.17"/>
<text text-anchor="middle" x="519" y="-10842.97" font-family="Times,serif" font-size="14.00">Layer 8</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_layer_9</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="16,-8193.17 16,-9516.17 1022,-9516.17 1022,-8193.17 16,-8193.17"/>
<text text-anchor="middle" x="519" y="-9500.97" font-family="Times,serif" font-size="14.00">Layer 9</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_layer_10</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="16,-6851.17 16,-8174.17 1022,-8174.17 1022,-6851.17 16,-6851.17"/>
<text text-anchor="middle" x="519" y="-8158.97" font-family="Times,serif" font-size="14.00">Layer 10</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_layer_11</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="16,-5509.17 16,-6832.17 1022,-6832.17 1022,-5509.17 16,-5509.17"/>
<text text-anchor="middle" x="519" y="-6816.97" font-family="Times,serif" font-size="14.00">Layer 11</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_layer_12</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="16,-4167.17 16,-5490.17 1022,-5490.17 1022,-4167.17 16,-4167.17"/>
<text text-anchor="middle" x="519" y="-5474.97" font-family="Times,serif" font-size="14.00">Layer 12</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_layer_13</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="16,-2825.17 16,-4148.17 1022,-4148.17 1022,-2825.17 16,-2825.17"/>
<text text-anchor="middle" x="519" y="-4132.97" font-family="Times,serif" font-size="14.00">Layer 13</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_layer_14</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="16,-1483.17 16,-2806.17 1022,-2806.17 1022,-1483.17 16,-1483.17"/>
<text text-anchor="middle" x="519" y="-2790.97" font-family="Times,serif" font-size="14.00">Layer 14</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_layer_15</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="16,-141.17 16,-1464.17 1022,-1464.17 1022,-141.17 16,-141.17"/>
<text text-anchor="middle" x="519" y="-1448.97" font-family="Times,serif" font-size="14.00">Layer 15</text>
</g>
<!-- input_p0 -->
<g id="node1" class="node">
<title>input_p0</title>
<ellipse fill="yellow" stroke="black" cx="695" cy="-22065.25" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="695" y="-22084.05" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="695" y="-22069.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="695" y="-22054.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="695" y="-22039.05" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer0_ln1 -->
<g id="node2" class="node">
<title>layer0_ln1</title>
<polygon fill="yellow" stroke="black" points="866,-21959.17 398,-21959.17 398,-21891.17 866,-21891.17 866,-21959.17"/>
<text text-anchor="middle" x="632" y="-21943.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="632" y="-21928.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="632" y="-21913.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="632" y="-21898.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- input_p0&#45;&gt;layer0_ln1 -->
<g id="edge1" class="edge">
<title>input_p0&#45;&gt;layer0_ln1</title>
<path fill="none" stroke="black" d="M673.5,-22017.12C666.29,-22001.33 658.31,-21983.84 651.29,-21968.45"/>
<polygon fill="black" stroke="black" points="654.39,-21966.81 647.06,-21959.17 648.02,-21969.72 654.39,-21966.81"/>
</g>
<!-- layer0_res1 -->
<g id="node6" class="node">
<title>layer0_res1</title>
<polygon fill="yellow" stroke="black" points="949,-21471.17 481,-21471.17 481,-21388.17 949,-21388.17 949,-21471.17"/>
<text text-anchor="middle" x="715" y="-21455.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="715" y="-21440.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="715" y="-21425.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="715" y="-21410.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="715" y="-21395.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- input_p0&#45;&gt;layer0_res1 -->
<g id="edge5" class="edge">
<title>input_p0&#45;&gt;layer0_res1</title>
<path fill="none" stroke="black" d="M938.42,-22032.57C987.3,-22012.12 1024,-21979.13 1024,-21926.17 1024,-21926.17 1024,-21926.17 1024,-21575.17 1024,-21545.06 1034.14,-21530.55 1014,-21508.17 1002.38,-21495.25 977.49,-21483.91 946.78,-21474.17"/>
<polygon fill="black" stroke="black" points="947.66,-21470.78 937.08,-21471.2 945.61,-21477.47 947.66,-21470.78"/>
</g>
<!-- layer0_qkv -->
<g id="node3" class="node">
<title>layer0_qkv</title>
<polygon fill="yellow" stroke="black" points="917.5,-21854.17 298.5,-21854.17 298.5,-21786.17 917.5,-21786.17 917.5,-21854.17"/>
<text text-anchor="middle" x="608" y="-21838.97" font-family="Times,serif" font-size="14.00">QKV Linear (Column&#45;Parallel)</text>
<text text-anchor="middle" x="608" y="-21823.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="608" y="-21808.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="608" y="-21793.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer0_ln1&#45;&gt;layer0_qkv -->
<g id="edge2" class="edge">
<title>layer0_ln1&#45;&gt;layer0_qkv</title>
<path fill="none" stroke="black" d="M624.27,-21891.01C622.28,-21882.46 620.11,-21873.14 618.02,-21864.18"/>
<polygon fill="black" stroke="black" points="621.39,-21863.21 615.71,-21854.26 614.57,-21864.79 621.39,-21863.21"/>
</g>
<!-- layer0_attn -->
<g id="node4" class="node">
<title>layer0_attn</title>
<polygon fill="yellow" stroke="black" points="856.5,-21749.17 249.5,-21749.17 249.5,-21681.17 856.5,-21681.17 856.5,-21749.17"/>
<text text-anchor="middle" x="553" y="-21733.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="553" y="-21718.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="553" y="-21703.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="553" y="-21688.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer0_qkv&#45;&gt;layer0_attn -->
<g id="edge3" class="edge">
<title>layer0_qkv&#45;&gt;layer0_attn</title>
<path fill="none" stroke="black" d="M580.01,-21785.99C575.96,-21780.27 572.11,-21774.21 569,-21768.17 567.49,-21765.23 566.09,-21762.12 564.8,-21758.95"/>
<polygon fill="black" stroke="black" points="568,-21757.5 561.27,-21749.32 561.43,-21759.91 568,-21757.5"/>
</g>
<!-- layer0_attn_ar -->
<g id="node5" class="node">
<title>layer0_attn_ar</title>
<polygon fill="yellow" stroke="black" points="1005.4,-21644.17 233.24,-21644.17 34.6,-21508.17 806.76,-21508.17 1005.4,-21644.17"/>
<text text-anchor="middle" x="520" y="-21594.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="520" y="-21579.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-21564.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-21549.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer0_attn&#45;&gt;layer0_attn_ar -->
<g id="edge4" class="edge">
<title>layer0_attn&#45;&gt;layer0_attn_ar</title>
<path fill="none" stroke="black" d="M541.18,-21680.89C539.3,-21675.03 537.49,-21668.95 536,-21663.17 535.27,-21660.34 534.56,-21657.45 533.87,-21654.53"/>
<polygon fill="black" stroke="black" points="537.22,-21653.48 531.6,-21644.5 530.39,-21655.02 537.22,-21653.48"/>
</g>
<!-- layer0_attn_ar&#45;&gt;layer0_res1 -->
<g id="edge6" class="edge">
<title>layer0_attn_ar&#45;&gt;layer0_res1</title>
<path fill="none" stroke="black" d="M598.18,-21508.13C606.44,-21501.58 614.82,-21495.15 623,-21489.17 628.54,-21485.11 634.37,-21481.04 640.27,-21477.02"/>
<polygon fill="black" stroke="black" points="642.61,-21479.67 648.97,-21471.19 638.71,-21473.85 642.61,-21479.67"/>
</g>
<!-- layer0_ln2 -->
<g id="node7" class="node">
<title>layer0_ln2</title>
<polygon fill="yellow" stroke="black" points="912,-21351.17 444,-21351.17 444,-21283.17 912,-21283.17 912,-21351.17"/>
<text text-anchor="middle" x="678" y="-21335.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="678" y="-21320.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="678" y="-21305.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="678" y="-21290.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer0_res1&#45;&gt;layer0_ln2 -->
<g id="edge7" class="edge">
<title>layer0_res1&#45;&gt;layer0_ln2</title>
<path fill="none" stroke="black" d="M701.43,-21388.15C698.46,-21379.28 695.31,-21369.87 692.32,-21360.92"/>
<polygon fill="black" stroke="black" points="695.63,-21359.81 689.14,-21351.44 689,-21362.03 695.63,-21359.81"/>
</g>
<!-- layer0_res2 -->
<g id="node12" class="node">
<title>layer0_res2</title>
<polygon fill="yellow" stroke="black" points="1008,-20758.17 540,-20758.17 540,-20675.17 1008,-20675.17 1008,-20758.17"/>
<text text-anchor="middle" x="774" y="-20742.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="774" y="-20727.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="774" y="-20712.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="774" y="-20697.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="774" y="-20682.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer0_res1&#45;&gt;layer0_res2 -->
<g id="edge12" class="edge">
<title>layer0_res1&#45;&gt;layer0_res2</title>
<path fill="none" stroke="black" d="M912.9,-21388.13C971.34,-21370.38 1020,-21346.96 1020,-21318.17 1020,-21318.17 1020,-21318.17 1020,-20862.17 1020,-20832.06 1029.41,-20818.18 1010,-20795.17 999.52,-20782.75 987.02,-20772.3 973.3,-20763.53"/>
<polygon fill="black" stroke="black" points="974.99,-20760.45 964.62,-20758.27 971.36,-20766.44 974.99,-20760.45"/>
</g>
<!-- layer0_mlp1 -->
<g id="node8" class="node">
<title>layer0_mlp1</title>
<polygon fill="yellow" stroke="black" points="884.5,-21246.17 381.5,-21246.17 381.5,-21178.17 884.5,-21178.17 884.5,-21246.17"/>
<text text-anchor="middle" x="633" y="-21230.97" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column&#45;Parallel)</text>
<text text-anchor="middle" x="633" y="-21215.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="633" y="-21200.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="633" y="-21185.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer0_ln2&#45;&gt;layer0_mlp1 -->
<g id="edge8" class="edge">
<title>layer0_ln2&#45;&gt;layer0_mlp1</title>
<path fill="none" stroke="black" d="M663.51,-21283.01C659.7,-21274.28 655.53,-21264.74 651.54,-21255.6"/>
<polygon fill="black" stroke="black" points="654.67,-21254.02 647.46,-21246.26 648.26,-21256.83 654.67,-21254.02"/>
</g>
<!-- layer0_gelu -->
<g id="node9" class="node">
<title>layer0_gelu</title>
<polygon fill="yellow" stroke="black" points="876.5,-21141.17 373.5,-21141.17 373.5,-21073.17 876.5,-21073.17 876.5,-21141.17"/>
<text text-anchor="middle" x="625" y="-21125.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="625" y="-21110.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="625" y="-21095.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="625" y="-21080.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer0_mlp1&#45;&gt;layer0_gelu -->
<g id="edge9" class="edge">
<title>layer0_mlp1&#45;&gt;layer0_gelu</title>
<path fill="none" stroke="black" d="M630.42,-21178.01C629.77,-21169.56 629.05,-21160.34 628.36,-21151.47"/>
<polygon fill="black" stroke="black" points="631.83,-21150.96 627.57,-21141.26 624.86,-21151.5 631.83,-21150.96"/>
</g>
<!-- layer0_mlp2 -->
<g id="node10" class="node">
<title>layer0_mlp2</title>
<polygon fill="yellow" stroke="black" points="805.5,-21036.17 314.5,-21036.17 314.5,-20968.17 805.5,-20968.17 805.5,-21036.17"/>
<text text-anchor="middle" x="560" y="-21020.97" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row&#45;Parallel)</text>
<text text-anchor="middle" x="560" y="-21005.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="560" y="-20990.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="560" y="-20975.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer0_gelu&#45;&gt;layer0_mlp2 -->
<g id="edge10" class="edge">
<title>layer0_gelu&#45;&gt;layer0_mlp2</title>
<path fill="none" stroke="black" d="M604.08,-21073.01C598.39,-21064 592.17,-21054.14 586.23,-21044.73"/>
<polygon fill="black" stroke="black" points="589.18,-21042.85 580.88,-21036.26 583.26,-21046.59 589.18,-21042.85"/>
</g>
<!-- layer0_mlp_ar -->
<g id="node11" class="node">
<title>layer0_mlp_ar</title>
<polygon fill="yellow" stroke="black" points="1001.4,-20931.17 229.24,-20931.17 30.6,-20795.17 802.76,-20795.17 1001.4,-20931.17"/>
<text text-anchor="middle" x="516" y="-20881.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="516" y="-20866.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="516" y="-20851.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="516" y="-20836.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer0_mlp2&#45;&gt;layer0_mlp_ar -->
<g id="edge11" class="edge">
<title>layer0_mlp2&#45;&gt;layer0_mlp_ar</title>
<path fill="none" stroke="black" d="M549.35,-20968C546.68,-20959.69 543.7,-20950.42 540.65,-20940.93"/>
<polygon fill="black" stroke="black" points="543.98,-20939.85 537.59,-20931.4 537.32,-20941.99 543.98,-20939.85"/>
</g>
<!-- layer0_mlp_ar&#45;&gt;layer0_res2 -->
<g id="edge13" class="edge">
<title>layer0_mlp_ar&#45;&gt;layer0_res2</title>
<path fill="none" stroke="black" d="M635.94,-20794.99C655.16,-20784.23 674.66,-20773.31 692.7,-20763.2"/>
<polygon fill="black" stroke="black" points="694.42,-20766.25 701.44,-20758.31 691,-20760.14 694.42,-20766.25"/>
</g>
<!-- layer1_ln1 -->
<g id="node13" class="node">
<title>layer1_ln1</title>
<polygon fill="yellow" stroke="black" points="967,-20617.17 499,-20617.17 499,-20549.17 967,-20549.17 967,-20617.17"/>
<text text-anchor="middle" x="733" y="-20601.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="733" y="-20586.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="733" y="-20571.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="733" y="-20556.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer0_res2&#45;&gt;layer1_ln1 -->
<g id="edge14" class="edge">
<title>layer0_res2&#45;&gt;layer1_ln1</title>
<path fill="none" stroke="black" d="M761.36,-20675.14C756.62,-20659.91 751.2,-20642.55 746.39,-20627.11"/>
<polygon fill="black" stroke="black" points="749.64,-20625.79 743.33,-20617.28 742.96,-20627.87 749.64,-20625.79"/>
</g>
<!-- layer1_res1 -->
<g id="node17" class="node">
<title>layer1_res1</title>
<polygon fill="yellow" stroke="black" points="1007,-20129.17 539,-20129.17 539,-20046.17 1007,-20046.17 1007,-20129.17"/>
<text text-anchor="middle" x="773" y="-20113.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="773" y="-20098.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="773" y="-20083.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="773" y="-20068.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="773" y="-20053.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer0_res2&#45;&gt;layer1_res1 -->
<g id="edge18" class="edge">
<title>layer0_res2&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M957.33,-20675.02C995.29,-20655.52 1024,-20626.71 1024,-20584.17 1024,-20584.17 1024,-20584.17 1024,-20233.17 1024,-20203.06 1033.49,-20189.12 1014,-20166.17 1003.46,-20153.75 990.92,-20143.3 977.18,-20134.52"/>
<polygon fill="black" stroke="black" points="978.85,-20131.44 968.48,-20129.26 975.23,-20137.43 978.85,-20131.44"/>
</g>
<!-- layer1_qkv -->
<g id="node14" class="node">
<title>layer1_qkv</title>
<polygon fill="yellow" stroke="black" points="917.5,-20512.17 298.5,-20512.17 298.5,-20444.17 917.5,-20444.17 917.5,-20512.17"/>
<text text-anchor="middle" x="608" y="-20496.97" font-family="Times,serif" font-size="14.00">QKV Linear (Column&#45;Parallel)</text>
<text text-anchor="middle" x="608" y="-20481.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="608" y="-20466.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="608" y="-20451.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_qkv -->
<g id="edge15" class="edge">
<title>layer1_ln1&#45;&gt;layer1_qkv</title>
<path fill="none" stroke="black" d="M692.76,-20549.01C681.05,-20539.36 668.14,-20528.72 656.01,-20518.72"/>
<polygon fill="black" stroke="black" points="658.11,-20515.92 648.16,-20512.26 653.66,-20521.32 658.11,-20515.92"/>
</g>
<!-- layer1_attn -->
<g id="node15" class="node">
<title>layer1_attn</title>
<polygon fill="yellow" stroke="black" points="856.5,-20407.17 249.5,-20407.17 249.5,-20339.17 856.5,-20339.17 856.5,-20407.17"/>
<text text-anchor="middle" x="553" y="-20391.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="553" y="-20376.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="553" y="-20361.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="553" y="-20346.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer1_qkv&#45;&gt;layer1_attn -->
<g id="edge16" class="edge">
<title>layer1_qkv&#45;&gt;layer1_attn</title>
<path fill="none" stroke="black" d="M590.29,-20444.01C585.58,-20435.19 580.43,-20425.54 575.5,-20416.31"/>
<polygon fill="black" stroke="black" points="578.47,-20414.43 570.67,-20407.26 572.29,-20417.73 578.47,-20414.43"/>
</g>
<!-- layer1_attn_ar -->
<g id="node16" class="node">
<title>layer1_attn_ar</title>
<polygon fill="yellow" stroke="black" points="1005.4,-20302.17 233.24,-20302.17 34.6,-20166.17 806.76,-20166.17 1005.4,-20302.17"/>
<text text-anchor="middle" x="520" y="-20252.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="520" y="-20237.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-20222.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-20207.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer1_attn&#45;&gt;layer1_attn_ar -->
<g id="edge17" class="edge">
<title>layer1_attn&#45;&gt;layer1_attn_ar</title>
<path fill="none" stroke="black" d="M545.01,-20339C543.03,-20330.77 540.82,-20321.61 538.56,-20312.23"/>
<polygon fill="black" stroke="black" points="541.94,-20311.3 536.19,-20302.4 535.13,-20312.94 541.94,-20311.3"/>
</g>
<!-- layer1_attn_ar&#45;&gt;layer1_res1 -->
<g id="edge19" class="edge">
<title>layer1_attn_ar&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M637.61,-20165.99C656.29,-20155.32 675.23,-20144.51 692.79,-20134.48"/>
<polygon fill="black" stroke="black" points="694.89,-20137.31 701.84,-20129.31 691.42,-20131.23 694.89,-20137.31"/>
</g>
<!-- layer1_ln2 -->
<g id="node18" class="node">
<title>layer1_ln2</title>
<polygon fill="yellow" stroke="black" points="992,-20009.17 524,-20009.17 524,-19941.17 992,-19941.17 992,-20009.17"/>
<text text-anchor="middle" x="758" y="-19993.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="758" y="-19978.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="758" y="-19963.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="758" y="-19948.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln2 -->
<g id="edge20" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln2</title>
<path fill="none" stroke="black" d="M767.5,-20046.15C766.32,-20037.47 765.07,-20028.27 763.88,-20019.49"/>
<polygon fill="black" stroke="black" points="767.33,-20018.88 762.52,-20009.44 760.39,-20019.82 767.33,-20018.88"/>
</g>
<!-- layer1_res2 -->
<g id="node23" class="node">
<title>layer1_res2</title>
<polygon fill="yellow" stroke="black" points="994,-19416.17 526,-19416.17 526,-19333.17 994,-19333.17 994,-19416.17"/>
<text text-anchor="middle" x="760" y="-19400.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="760" y="-19385.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="760" y="-19370.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="760" y="-19355.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="760" y="-19340.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_res2 -->
<g id="edge25" class="edge">
<title>layer1_res1&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M978.66,-20046.02C1003.33,-20029.87 1020,-20007.41 1020,-19976.17 1020,-19976.17 1020,-19976.17 1020,-19520.17 1020,-19490.06 1029.61,-19476.02 1010,-19453.17 999.34,-19440.74 986.73,-19430.28 972.93,-19421.48"/>
<polygon fill="black" stroke="black" points="974.56,-19418.37 964.19,-19416.21 970.95,-19424.37 974.56,-19418.37"/>
</g>
<!-- layer1_mlp1 -->
<g id="node19" class="node">
<title>layer1_mlp1</title>
<polygon fill="yellow" stroke="black" points="1000.5,-19904.17 497.5,-19904.17 497.5,-19836.17 1000.5,-19836.17 1000.5,-19904.17"/>
<text text-anchor="middle" x="749" y="-19888.97" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column&#45;Parallel)</text>
<text text-anchor="middle" x="749" y="-19873.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="749" y="-19858.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="749" y="-19843.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer1_ln2&#45;&gt;layer1_mlp1 -->
<g id="edge21" class="edge">
<title>layer1_ln2&#45;&gt;layer1_mlp1</title>
<path fill="none" stroke="black" d="M755.1,-19941.01C754.36,-19932.56 753.56,-19923.34 752.78,-19914.47"/>
<polygon fill="black" stroke="black" points="756.25,-19913.92 751.89,-19904.26 749.28,-19914.53 756.25,-19913.92"/>
</g>
<!-- layer1_gelu -->
<g id="node20" class="node">
<title>layer1_gelu</title>
<polygon fill="yellow" stroke="black" points="884.5,-19799.17 381.5,-19799.17 381.5,-19731.17 884.5,-19731.17 884.5,-19799.17"/>
<text text-anchor="middle" x="633" y="-19783.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="633" y="-19768.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="633" y="-19753.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="633" y="-19738.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer1_mlp1&#45;&gt;layer1_gelu -->
<g id="edge22" class="edge">
<title>layer1_mlp1&#45;&gt;layer1_gelu</title>
<path fill="none" stroke="black" d="M711.66,-19836.01C700.9,-19826.45 689.04,-19815.93 677.87,-19806.01"/>
<polygon fill="black" stroke="black" points="680.07,-19803.28 670.27,-19799.26 675.43,-19808.52 680.07,-19803.28"/>
</g>
<!-- layer1_mlp2 -->
<g id="node21" class="node">
<title>layer1_mlp2</title>
<polygon fill="yellow" stroke="black" points="805.5,-19694.17 314.5,-19694.17 314.5,-19626.17 805.5,-19626.17 805.5,-19694.17"/>
<text text-anchor="middle" x="560" y="-19678.97" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row&#45;Parallel)</text>
<text text-anchor="middle" x="560" y="-19663.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="560" y="-19648.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="560" y="-19633.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer1_gelu&#45;&gt;layer1_mlp2 -->
<g id="edge23" class="edge">
<title>layer1_gelu&#45;&gt;layer1_mlp2</title>
<path fill="none" stroke="black" d="M609.5,-19731.01C603.05,-19721.91 595.98,-19711.94 589.26,-19702.44"/>
<polygon fill="black" stroke="black" points="592.09,-19700.4 583.46,-19694.26 586.38,-19704.44 592.09,-19700.4"/>
</g>
<!-- layer1_mlp_ar -->
<g id="node22" class="node">
<title>layer1_mlp_ar</title>
<polygon fill="yellow" stroke="black" points="1001.4,-19589.17 229.24,-19589.17 30.6,-19453.17 802.76,-19453.17 1001.4,-19589.17"/>
<text text-anchor="middle" x="516" y="-19539.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="516" y="-19524.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="516" y="-19509.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="516" y="-19494.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer1_mlp2&#45;&gt;layer1_mlp_ar -->
<g id="edge24" class="edge">
<title>layer1_mlp2&#45;&gt;layer1_mlp_ar</title>
<path fill="none" stroke="black" d="M549.35,-19626C546.68,-19617.69 543.7,-19608.42 540.65,-19598.93"/>
<polygon fill="black" stroke="black" points="543.98,-19597.85 537.59,-19589.4 537.32,-19599.99 543.98,-19597.85"/>
</g>
<!-- layer1_mlp_ar&#45;&gt;layer1_res2 -->
<g id="edge26" class="edge">
<title>layer1_mlp_ar&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M629.43,-19452.99C647.44,-19442.32 665.71,-19431.51 682.65,-19421.48"/>
<polygon fill="black" stroke="black" points="684.55,-19424.42 691.37,-19416.31 680.99,-19418.39 684.55,-19424.42"/>
</g>
<!-- layer2_ln1 -->
<g id="node24" class="node">
<title>layer2_ln1</title>
<polygon fill="yellow" stroke="black" points="967,-19275.17 499,-19275.17 499,-19207.17 967,-19207.17 967,-19275.17"/>
<text text-anchor="middle" x="733" y="-19259.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="733" y="-19244.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="733" y="-19229.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="733" y="-19214.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_ln1 -->
<g id="edge27" class="edge">
<title>layer1_res2&#45;&gt;layer2_ln1</title>
<path fill="none" stroke="black" d="M751.68,-19333.14C748.55,-19317.91 744.99,-19300.55 741.82,-19285.11"/>
<polygon fill="black" stroke="black" points="745.24,-19284.38 739.8,-19275.28 738.38,-19285.78 745.24,-19284.38"/>
</g>
<!-- layer2_res1 -->
<g id="node28" class="node">
<title>layer2_res1</title>
<polygon fill="yellow" stroke="black" points="1007,-18787.17 539,-18787.17 539,-18704.17 1007,-18704.17 1007,-18787.17"/>
<text text-anchor="middle" x="773" y="-18771.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="773" y="-18756.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="773" y="-18741.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="773" y="-18726.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="773" y="-18711.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer1_res2&#45;&gt;layer2_res1 -->
<g id="edge31" class="edge">
<title>layer1_res2&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M958.4,-19333.07C996.08,-19313.6 1024,-19284.79 1024,-19242.17 1024,-19242.17 1024,-19242.17 1024,-18891.17 1024,-18861.06 1033.49,-18847.12 1014,-18824.17 1003.46,-18811.75 990.92,-18801.3 977.18,-18792.52"/>
<polygon fill="black" stroke="black" points="978.85,-18789.44 968.48,-18787.26 975.23,-18795.43 978.85,-18789.44"/>
</g>
<!-- layer2_qkv -->
<g id="node25" class="node">
<title>layer2_qkv</title>
<polygon fill="yellow" stroke="black" points="917.5,-19170.17 298.5,-19170.17 298.5,-19102.17 917.5,-19102.17 917.5,-19170.17"/>
<text text-anchor="middle" x="608" y="-19154.97" font-family="Times,serif" font-size="14.00">QKV Linear (Column&#45;Parallel)</text>
<text text-anchor="middle" x="608" y="-19139.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="608" y="-19124.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="608" y="-19109.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_qkv -->
<g id="edge28" class="edge">
<title>layer2_ln1&#45;&gt;layer2_qkv</title>
<path fill="none" stroke="black" d="M692.76,-19207.01C681.05,-19197.36 668.14,-19186.72 656.01,-19176.72"/>
<polygon fill="black" stroke="black" points="658.11,-19173.92 648.16,-19170.26 653.66,-19179.32 658.11,-19173.92"/>
</g>
<!-- layer2_attn -->
<g id="node26" class="node">
<title>layer2_attn</title>
<polygon fill="yellow" stroke="black" points="856.5,-19065.17 249.5,-19065.17 249.5,-18997.17 856.5,-18997.17 856.5,-19065.17"/>
<text text-anchor="middle" x="553" y="-19049.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="553" y="-19034.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="553" y="-19019.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="553" y="-19004.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer2_qkv&#45;&gt;layer2_attn -->
<g id="edge29" class="edge">
<title>layer2_qkv&#45;&gt;layer2_attn</title>
<path fill="none" stroke="black" d="M590.29,-19102.01C585.58,-19093.19 580.43,-19083.54 575.5,-19074.31"/>
<polygon fill="black" stroke="black" points="578.47,-19072.43 570.67,-19065.26 572.29,-19075.73 578.47,-19072.43"/>
</g>
<!-- layer2_attn_ar -->
<g id="node27" class="node">
<title>layer2_attn_ar</title>
<polygon fill="yellow" stroke="black" points="1005.4,-18960.17 233.24,-18960.17 34.6,-18824.17 806.76,-18824.17 1005.4,-18960.17"/>
<text text-anchor="middle" x="520" y="-18910.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="520" y="-18895.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-18880.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-18865.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer2_attn&#45;&gt;layer2_attn_ar -->
<g id="edge30" class="edge">
<title>layer2_attn&#45;&gt;layer2_attn_ar</title>
<path fill="none" stroke="black" d="M545.01,-18997C543.03,-18988.77 540.82,-18979.61 538.56,-18970.23"/>
<polygon fill="black" stroke="black" points="541.94,-18969.3 536.19,-18960.4 535.13,-18970.94 541.94,-18969.3"/>
</g>
<!-- layer2_attn_ar&#45;&gt;layer2_res1 -->
<g id="edge32" class="edge">
<title>layer2_attn_ar&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M637.61,-18823.99C656.29,-18813.32 675.23,-18802.51 692.79,-18792.48"/>
<polygon fill="black" stroke="black" points="694.89,-18795.31 701.84,-18787.31 691.42,-18789.23 694.89,-18795.31"/>
</g>
<!-- layer2_ln2 -->
<g id="node29" class="node">
<title>layer2_ln2</title>
<polygon fill="yellow" stroke="black" points="992,-18667.17 524,-18667.17 524,-18599.17 992,-18599.17 992,-18667.17"/>
<text text-anchor="middle" x="758" y="-18651.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="758" y="-18636.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="758" y="-18621.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="758" y="-18606.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln2 -->
<g id="edge33" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln2</title>
<path fill="none" stroke="black" d="M767.5,-18704.15C766.32,-18695.47 765.07,-18686.27 763.88,-18677.49"/>
<polygon fill="black" stroke="black" points="767.33,-18676.88 762.52,-18667.44 760.39,-18677.82 767.33,-18676.88"/>
</g>
<!-- layer2_res2 -->
<g id="node34" class="node">
<title>layer2_res2</title>
<polygon fill="yellow" stroke="black" points="994,-18074.17 526,-18074.17 526,-17991.17 994,-17991.17 994,-18074.17"/>
<text text-anchor="middle" x="760" y="-18058.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="760" y="-18043.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="760" y="-18028.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="760" y="-18013.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="760" y="-17998.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_res2 -->
<g id="edge38" class="edge">
<title>layer2_res1&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M978.66,-18704.02C1003.33,-18687.87 1020,-18665.41 1020,-18634.17 1020,-18634.17 1020,-18634.17 1020,-18178.17 1020,-18148.06 1029.61,-18134.02 1010,-18111.17 999.34,-18098.74 986.73,-18088.28 972.93,-18079.48"/>
<polygon fill="black" stroke="black" points="974.56,-18076.37 964.19,-18074.21 970.95,-18082.37 974.56,-18076.37"/>
</g>
<!-- layer2_mlp1 -->
<g id="node30" class="node">
<title>layer2_mlp1</title>
<polygon fill="yellow" stroke="black" points="1000.5,-18562.17 497.5,-18562.17 497.5,-18494.17 1000.5,-18494.17 1000.5,-18562.17"/>
<text text-anchor="middle" x="749" y="-18546.97" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column&#45;Parallel)</text>
<text text-anchor="middle" x="749" y="-18531.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="749" y="-18516.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="749" y="-18501.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer2_ln2&#45;&gt;layer2_mlp1 -->
<g id="edge34" class="edge">
<title>layer2_ln2&#45;&gt;layer2_mlp1</title>
<path fill="none" stroke="black" d="M755.1,-18599.01C754.36,-18590.56 753.56,-18581.34 752.78,-18572.47"/>
<polygon fill="black" stroke="black" points="756.25,-18571.92 751.89,-18562.26 749.28,-18572.53 756.25,-18571.92"/>
</g>
<!-- layer2_gelu -->
<g id="node31" class="node">
<title>layer2_gelu</title>
<polygon fill="yellow" stroke="black" points="1000.5,-18457.17 497.5,-18457.17 497.5,-18389.17 1000.5,-18389.17 1000.5,-18457.17"/>
<text text-anchor="middle" x="749" y="-18441.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="749" y="-18426.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="749" y="-18411.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="749" y="-18396.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer2_mlp1&#45;&gt;layer2_gelu -->
<g id="edge35" class="edge">
<title>layer2_mlp1&#45;&gt;layer2_gelu</title>
<path fill="none" stroke="black" d="M749,-18494.01C749,-18485.56 749,-18476.34 749,-18467.47"/>
<polygon fill="black" stroke="black" points="752.5,-18467.26 749,-18457.26 745.5,-18467.26 752.5,-18467.26"/>
</g>
<!-- layer2_mlp2 -->
<g id="node32" class="node">
<title>layer2_mlp2</title>
<polygon fill="yellow" stroke="black" points="849.5,-18352.17 358.5,-18352.17 358.5,-18284.17 849.5,-18284.17 849.5,-18352.17"/>
<text text-anchor="middle" x="604" y="-18336.97" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row&#45;Parallel)</text>
<text text-anchor="middle" x="604" y="-18321.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="604" y="-18306.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="604" y="-18291.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer2_gelu&#45;&gt;layer2_mlp2 -->
<g id="edge36" class="edge">
<title>layer2_gelu&#45;&gt;layer2_mlp2</title>
<path fill="none" stroke="black" d="M702.32,-18389.01C688.48,-18379.18 673.2,-18368.32 658.88,-18358.15"/>
<polygon fill="black" stroke="black" points="660.77,-18355.2 650.59,-18352.26 656.72,-18360.91 660.77,-18355.2"/>
</g>
<!-- layer2_mlp_ar -->
<g id="node33" class="node">
<title>layer2_mlp_ar</title>
<polygon fill="yellow" stroke="black" points="1001.4,-18247.17 229.24,-18247.17 30.6,-18111.17 802.76,-18111.17 1001.4,-18247.17"/>
<text text-anchor="middle" x="516" y="-18197.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="516" y="-18182.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="516" y="-18167.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="516" y="-18152.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer2_mlp2&#45;&gt;layer2_mlp_ar -->
<g id="edge37" class="edge">
<title>layer2_mlp2&#45;&gt;layer2_mlp_ar</title>
<path fill="none" stroke="black" d="M582.7,-18284C577.19,-18275.43 571.03,-18265.84 564.74,-18256.04"/>
<polygon fill="black" stroke="black" points="567.54,-18253.92 559.19,-18247.4 561.65,-18257.71 567.54,-18253.92"/>
</g>
<!-- layer2_mlp_ar&#45;&gt;layer2_res2 -->
<g id="edge39" class="edge">
<title>layer2_mlp_ar&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M629.43,-18110.99C647.44,-18100.32 665.71,-18089.51 682.65,-18079.48"/>
<polygon fill="black" stroke="black" points="684.55,-18082.42 691.37,-18074.31 680.99,-18076.39 684.55,-18082.42"/>
</g>
<!-- layer3_ln1 -->
<g id="node35" class="node">
<title>layer3_ln1</title>
<polygon fill="yellow" stroke="black" points="967,-17933.17 499,-17933.17 499,-17865.17 967,-17865.17 967,-17933.17"/>
<text text-anchor="middle" x="733" y="-17917.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="733" y="-17902.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="733" y="-17887.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="733" y="-17872.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_ln1 -->
<g id="edge40" class="edge">
<title>layer2_res2&#45;&gt;layer3_ln1</title>
<path fill="none" stroke="black" d="M751.68,-17991.14C748.55,-17975.91 744.99,-17958.55 741.82,-17943.11"/>
<polygon fill="black" stroke="black" points="745.24,-17942.38 739.8,-17933.28 738.38,-17943.78 745.24,-17942.38"/>
</g>
<!-- layer3_res1 -->
<g id="node39" class="node">
<title>layer3_res1</title>
<polygon fill="yellow" stroke="black" points="1007,-17445.17 539,-17445.17 539,-17362.17 1007,-17362.17 1007,-17445.17"/>
<text text-anchor="middle" x="773" y="-17429.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="773" y="-17414.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="773" y="-17399.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="773" y="-17384.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="773" y="-17369.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer2_res2&#45;&gt;layer3_res1 -->
<g id="edge44" class="edge">
<title>layer2_res2&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M958.4,-17991.07C996.08,-17971.6 1024,-17942.79 1024,-17900.17 1024,-17900.17 1024,-17900.17 1024,-17549.17 1024,-17519.06 1033.49,-17505.12 1014,-17482.17 1003.46,-17469.75 990.92,-17459.3 977.18,-17450.52"/>
<polygon fill="black" stroke="black" points="978.85,-17447.44 968.48,-17445.26 975.23,-17453.43 978.85,-17447.44"/>
</g>
<!-- layer3_qkv -->
<g id="node36" class="node">
<title>layer3_qkv</title>
<polygon fill="yellow" stroke="black" points="917.5,-17828.17 298.5,-17828.17 298.5,-17760.17 917.5,-17760.17 917.5,-17828.17"/>
<text text-anchor="middle" x="608" y="-17812.97" font-family="Times,serif" font-size="14.00">QKV Linear (Column&#45;Parallel)</text>
<text text-anchor="middle" x="608" y="-17797.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="608" y="-17782.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="608" y="-17767.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_qkv -->
<g id="edge41" class="edge">
<title>layer3_ln1&#45;&gt;layer3_qkv</title>
<path fill="none" stroke="black" d="M692.76,-17865.01C681.05,-17855.36 668.14,-17844.72 656.01,-17834.72"/>
<polygon fill="black" stroke="black" points="658.11,-17831.92 648.16,-17828.26 653.66,-17837.32 658.11,-17831.92"/>
</g>
<!-- layer3_attn -->
<g id="node37" class="node">
<title>layer3_attn</title>
<polygon fill="yellow" stroke="black" points="856.5,-17723.17 249.5,-17723.17 249.5,-17655.17 856.5,-17655.17 856.5,-17723.17"/>
<text text-anchor="middle" x="553" y="-17707.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="553" y="-17692.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="553" y="-17677.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="553" y="-17662.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer3_qkv&#45;&gt;layer3_attn -->
<g id="edge42" class="edge">
<title>layer3_qkv&#45;&gt;layer3_attn</title>
<path fill="none" stroke="black" d="M590.29,-17760.01C585.58,-17751.19 580.43,-17741.54 575.5,-17732.31"/>
<polygon fill="black" stroke="black" points="578.47,-17730.43 570.67,-17723.26 572.29,-17733.73 578.47,-17730.43"/>
</g>
<!-- layer3_attn_ar -->
<g id="node38" class="node">
<title>layer3_attn_ar</title>
<polygon fill="yellow" stroke="black" points="1005.4,-17618.17 233.24,-17618.17 34.6,-17482.17 806.76,-17482.17 1005.4,-17618.17"/>
<text text-anchor="middle" x="520" y="-17568.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="520" y="-17553.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-17538.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-17523.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer3_attn&#45;&gt;layer3_attn_ar -->
<g id="edge43" class="edge">
<title>layer3_attn&#45;&gt;layer3_attn_ar</title>
<path fill="none" stroke="black" d="M545.01,-17655C543.03,-17646.77 540.82,-17637.61 538.56,-17628.23"/>
<polygon fill="black" stroke="black" points="541.94,-17627.3 536.19,-17618.4 535.13,-17628.94 541.94,-17627.3"/>
</g>
<!-- layer3_attn_ar&#45;&gt;layer3_res1 -->
<g id="edge45" class="edge">
<title>layer3_attn_ar&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M637.61,-17481.99C656.29,-17471.32 675.23,-17460.51 692.79,-17450.48"/>
<polygon fill="black" stroke="black" points="694.89,-17453.31 701.84,-17445.31 691.42,-17447.23 694.89,-17453.31"/>
</g>
<!-- layer3_ln2 -->
<g id="node40" class="node">
<title>layer3_ln2</title>
<polygon fill="yellow" stroke="black" points="992,-17325.17 524,-17325.17 524,-17257.17 992,-17257.17 992,-17325.17"/>
<text text-anchor="middle" x="758" y="-17309.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="758" y="-17294.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="758" y="-17279.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="758" y="-17264.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln2 -->
<g id="edge46" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln2</title>
<path fill="none" stroke="black" d="M767.5,-17362.15C766.32,-17353.47 765.07,-17344.27 763.88,-17335.49"/>
<polygon fill="black" stroke="black" points="767.33,-17334.88 762.52,-17325.44 760.39,-17335.82 767.33,-17334.88"/>
</g>
<!-- layer3_res2 -->
<g id="node45" class="node">
<title>layer3_res2</title>
<polygon fill="yellow" stroke="black" points="951,-16732.17 483,-16732.17 483,-16649.17 951,-16649.17 951,-16732.17"/>
<text text-anchor="middle" x="717" y="-16716.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="717" y="-16701.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="717" y="-16686.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="717" y="-16671.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="717" y="-16656.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_res2 -->
<g id="edge51" class="edge">
<title>layer3_res1&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M978.66,-17362.02C1003.33,-17345.87 1020,-17323.41 1020,-17292.17 1020,-17292.17 1020,-17292.17 1020,-16836.17 1020,-16806.06 1030.08,-16791.6 1010,-16769.17 998.51,-16756.33 973.73,-16744.99 943.21,-16735.22"/>
<polygon fill="black" stroke="black" points="944.15,-16731.85 933.56,-16732.24 942.08,-16738.54 944.15,-16731.85"/>
</g>
<!-- layer3_mlp1 -->
<g id="node41" class="node">
<title>layer3_mlp1</title>
<polygon fill="yellow" stroke="black" points="884.5,-17220.17 381.5,-17220.17 381.5,-17152.17 884.5,-17152.17 884.5,-17220.17"/>
<text text-anchor="middle" x="633" y="-17204.97" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column&#45;Parallel)</text>
<text text-anchor="middle" x="633" y="-17189.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="633" y="-17174.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="633" y="-17159.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer3_ln2&#45;&gt;layer3_mlp1 -->
<g id="edge47" class="edge">
<title>layer3_ln2&#45;&gt;layer3_mlp1</title>
<path fill="none" stroke="black" d="M717.76,-17257.01C706.05,-17247.36 693.14,-17236.72 681.01,-17226.72"/>
<polygon fill="black" stroke="black" points="683.11,-17223.92 673.16,-17220.26 678.66,-17229.32 683.11,-17223.92"/>
</g>
<!-- layer3_gelu -->
<g id="node42" class="node">
<title>layer3_gelu</title>
<polygon fill="yellow" stroke="black" points="822.5,-17115.17 319.5,-17115.17 319.5,-17047.17 822.5,-17047.17 822.5,-17115.17"/>
<text text-anchor="middle" x="571" y="-17099.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="571" y="-17084.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="571" y="-17069.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="571" y="-17054.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer3_mlp1&#45;&gt;layer3_gelu -->
<g id="edge48" class="edge">
<title>layer3_mlp1&#45;&gt;layer3_gelu</title>
<path fill="none" stroke="black" d="M613.04,-17152.01C607.68,-17143.1 601.8,-17133.34 596.19,-17124.02"/>
<polygon fill="black" stroke="black" points="599.08,-17122.02 590.92,-17115.26 593.08,-17125.63 599.08,-17122.02"/>
</g>
<!-- layer3_mlp2 -->
<g id="node43" class="node">
<title>layer3_mlp2</title>
<polygon fill="yellow" stroke="black" points="780.5,-17010.17 289.5,-17010.17 289.5,-16942.17 780.5,-16942.17 780.5,-17010.17"/>
<text text-anchor="middle" x="535" y="-16994.97" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row&#45;Parallel)</text>
<text text-anchor="middle" x="535" y="-16979.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="535" y="-16964.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="535" y="-16949.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer3_gelu&#45;&gt;layer3_mlp2 -->
<g id="edge49" class="edge">
<title>layer3_gelu&#45;&gt;layer3_mlp2</title>
<path fill="none" stroke="black" d="M559.41,-17047.01C556.39,-17038.37 553.1,-17028.94 549.93,-17019.89"/>
<polygon fill="black" stroke="black" points="553.17,-17018.55 546.57,-17010.26 546.56,-17020.86 553.17,-17018.55"/>
</g>
<!-- layer3_mlp_ar -->
<g id="node44" class="node">
<title>layer3_mlp_ar</title>
<polygon fill="yellow" stroke="black" points="1001.4,-16905.17 229.24,-16905.17 30.6,-16769.17 802.76,-16769.17 1001.4,-16905.17"/>
<text text-anchor="middle" x="516" y="-16855.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="516" y="-16840.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="516" y="-16825.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="516" y="-16810.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer3_mlp2&#45;&gt;layer3_mlp_ar -->
<g id="edge50" class="edge">
<title>layer3_mlp2&#45;&gt;layer3_mlp_ar</title>
<path fill="none" stroke="black" d="M530.4,-16942C529.27,-16933.86 528.02,-16924.8 526.73,-16915.52"/>
<polygon fill="black" stroke="black" points="530.16,-16914.82 525.32,-16905.4 523.23,-16915.79 530.16,-16914.82"/>
</g>
<!-- layer3_mlp_ar&#45;&gt;layer3_res2 -->
<g id="edge52" class="edge">
<title>layer3_mlp_ar&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M609.44,-16768.99C623.87,-16758.62 638.5,-16748.1 652.12,-16738.31"/>
<polygon fill="black" stroke="black" points="654.39,-16740.99 660.47,-16732.31 650.3,-16735.3 654.39,-16740.99"/>
</g>
<!-- layer4_ln1 -->
<g id="node46" class="node">
<title>layer4_ln1</title>
<polygon fill="yellow" stroke="black" points="915,-16591.17 447,-16591.17 447,-16523.17 915,-16523.17 915,-16591.17"/>
<text text-anchor="middle" x="681" y="-16575.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="681" y="-16560.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="681" y="-16545.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="681" y="-16530.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_ln1 -->
<g id="edge53" class="edge">
<title>layer3_res2&#45;&gt;layer4_ln1</title>
<path fill="none" stroke="black" d="M705.91,-16649.14C701.74,-16633.91 696.98,-16616.55 692.76,-16601.11"/>
<polygon fill="black" stroke="black" points="696.08,-16600.01 690.07,-16591.28 689.33,-16601.85 696.08,-16600.01"/>
</g>
<!-- layer4_res1 -->
<g id="node50" class="node">
<title>layer4_res1</title>
<polygon fill="yellow" stroke="black" points="949,-16103.17 481,-16103.17 481,-16020.17 949,-16020.17 949,-16103.17"/>
<text text-anchor="middle" x="715" y="-16087.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="715" y="-16072.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="715" y="-16057.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="715" y="-16042.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="715" y="-16027.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer3_res2&#45;&gt;layer4_res1 -->
<g id="edge57" class="edge">
<title>layer3_res2&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M951.25,-16655.17C993.27,-16635.54 1024,-16605.13 1024,-16558.17 1024,-16558.17 1024,-16558.17 1024,-16207.17 1024,-16177.06 1034.14,-16162.55 1014,-16140.17 1002.38,-16127.25 977.49,-16115.91 946.78,-16106.17"/>
<polygon fill="black" stroke="black" points="947.66,-16102.78 937.08,-16103.2 945.61,-16109.47 947.66,-16102.78"/>
</g>
<!-- layer4_qkv -->
<g id="node47" class="node">
<title>layer4_qkv</title>
<polygon fill="yellow" stroke="black" points="917.5,-16486.17 298.5,-16486.17 298.5,-16418.17 917.5,-16418.17 917.5,-16486.17"/>
<text text-anchor="middle" x="608" y="-16470.97" font-family="Times,serif" font-size="14.00">QKV Linear (Column&#45;Parallel)</text>
<text text-anchor="middle" x="608" y="-16455.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="608" y="-16440.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="608" y="-16425.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_qkv -->
<g id="edge54" class="edge">
<title>layer4_ln1&#45;&gt;layer4_qkv</title>
<path fill="none" stroke="black" d="M657.5,-16523.01C651.05,-16513.91 643.98,-16503.94 637.26,-16494.44"/>
<polygon fill="black" stroke="black" points="640.09,-16492.4 631.46,-16486.26 634.38,-16496.44 640.09,-16492.4"/>
</g>
<!-- layer4_attn -->
<g id="node48" class="node">
<title>layer4_attn</title>
<polygon fill="yellow" stroke="black" points="856.5,-16381.17 249.5,-16381.17 249.5,-16313.17 856.5,-16313.17 856.5,-16381.17"/>
<text text-anchor="middle" x="553" y="-16365.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="553" y="-16350.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="553" y="-16335.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="553" y="-16320.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer4_qkv&#45;&gt;layer4_attn -->
<g id="edge55" class="edge">
<title>layer4_qkv&#45;&gt;layer4_attn</title>
<path fill="none" stroke="black" d="M590.29,-16418.01C585.58,-16409.19 580.43,-16399.54 575.5,-16390.31"/>
<polygon fill="black" stroke="black" points="578.47,-16388.43 570.67,-16381.26 572.29,-16391.73 578.47,-16388.43"/>
</g>
<!-- layer4_attn_ar -->
<g id="node49" class="node">
<title>layer4_attn_ar</title>
<polygon fill="yellow" stroke="black" points="1005.4,-16276.17 233.24,-16276.17 34.6,-16140.17 806.76,-16140.17 1005.4,-16276.17"/>
<text text-anchor="middle" x="520" y="-16226.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="520" y="-16211.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-16196.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-16181.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer4_attn&#45;&gt;layer4_attn_ar -->
<g id="edge56" class="edge">
<title>layer4_attn&#45;&gt;layer4_attn_ar</title>
<path fill="none" stroke="black" d="M545.01,-16313C543.03,-16304.77 540.82,-16295.61 538.56,-16286.23"/>
<polygon fill="black" stroke="black" points="541.94,-16285.3 536.19,-16276.4 535.13,-16286.94 541.94,-16285.3"/>
</g>
<!-- layer4_attn_ar&#45;&gt;layer4_res1 -->
<g id="edge58" class="edge">
<title>layer4_attn_ar&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M610.65,-16139.99C624.65,-16129.62 638.84,-16119.1 652.06,-16109.31"/>
<polygon fill="black" stroke="black" points="654.2,-16112.07 660.15,-16103.31 650.04,-16106.45 654.2,-16112.07"/>
</g>
<!-- layer4_ln2 -->
<g id="node51" class="node">
<title>layer4_ln2</title>
<polygon fill="yellow" stroke="black" points="912,-15983.17 444,-15983.17 444,-15915.17 912,-15915.17 912,-15983.17"/>
<text text-anchor="middle" x="678" y="-15967.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="678" y="-15952.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="678" y="-15937.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="678" y="-15922.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln2 -->
<g id="edge59" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln2</title>
<path fill="none" stroke="black" d="M701.43,-16020.15C698.46,-16011.28 695.31,-16001.87 692.32,-15992.92"/>
<polygon fill="black" stroke="black" points="695.63,-15991.81 689.14,-15983.44 689,-15994.03 695.63,-15991.81"/>
</g>
<!-- layer4_res2 -->
<g id="node56" class="node">
<title>layer4_res2</title>
<polygon fill="yellow" stroke="black" points="994,-15390.17 526,-15390.17 526,-15307.17 994,-15307.17 994,-15390.17"/>
<text text-anchor="middle" x="760" y="-15374.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="760" y="-15359.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="760" y="-15344.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="760" y="-15329.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="760" y="-15314.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_res2 -->
<g id="edge64" class="edge">
<title>layer4_res1&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M912.9,-16020.13C971.34,-16002.38 1020,-15978.96 1020,-15950.17 1020,-15950.17 1020,-15950.17 1020,-15494.17 1020,-15464.06 1029.61,-15450.02 1010,-15427.17 999.34,-15414.74 986.73,-15404.28 972.93,-15395.48"/>
<polygon fill="black" stroke="black" points="974.56,-15392.37 964.19,-15390.21 970.95,-15398.37 974.56,-15392.37"/>
</g>
<!-- layer4_mlp1 -->
<g id="node52" class="node">
<title>layer4_mlp1</title>
<polygon fill="yellow" stroke="black" points="884.5,-15878.17 381.5,-15878.17 381.5,-15810.17 884.5,-15810.17 884.5,-15878.17"/>
<text text-anchor="middle" x="633" y="-15862.97" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column&#45;Parallel)</text>
<text text-anchor="middle" x="633" y="-15847.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="633" y="-15832.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="633" y="-15817.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer4_ln2&#45;&gt;layer4_mlp1 -->
<g id="edge60" class="edge">
<title>layer4_ln2&#45;&gt;layer4_mlp1</title>
<path fill="none" stroke="black" d="M663.51,-15915.01C659.7,-15906.28 655.53,-15896.74 651.54,-15887.6"/>
<polygon fill="black" stroke="black" points="654.67,-15886.02 647.46,-15878.26 648.26,-15888.83 654.67,-15886.02"/>
</g>
<!-- layer4_gelu -->
<g id="node53" class="node">
<title>layer4_gelu</title>
<polygon fill="yellow" stroke="black" points="822.5,-15773.17 319.5,-15773.17 319.5,-15705.17 822.5,-15705.17 822.5,-15773.17"/>
<text text-anchor="middle" x="571" y="-15757.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="571" y="-15742.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="571" y="-15727.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="571" y="-15712.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer4_mlp1&#45;&gt;layer4_gelu -->
<g id="edge61" class="edge">
<title>layer4_mlp1&#45;&gt;layer4_gelu</title>
<path fill="none" stroke="black" d="M613.04,-15810.01C607.68,-15801.1 601.8,-15791.34 596.19,-15782.02"/>
<polygon fill="black" stroke="black" points="599.08,-15780.02 590.92,-15773.26 593.08,-15783.63 599.08,-15780.02"/>
</g>
<!-- layer4_mlp2 -->
<g id="node54" class="node">
<title>layer4_mlp2</title>
<polygon fill="yellow" stroke="black" points="780.5,-15668.17 289.5,-15668.17 289.5,-15600.17 780.5,-15600.17 780.5,-15668.17"/>
<text text-anchor="middle" x="535" y="-15652.97" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row&#45;Parallel)</text>
<text text-anchor="middle" x="535" y="-15637.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="535" y="-15622.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="535" y="-15607.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer4_gelu&#45;&gt;layer4_mlp2 -->
<g id="edge62" class="edge">
<title>layer4_gelu&#45;&gt;layer4_mlp2</title>
<path fill="none" stroke="black" d="M559.41,-15705.01C556.39,-15696.37 553.1,-15686.94 549.93,-15677.89"/>
<polygon fill="black" stroke="black" points="553.17,-15676.55 546.57,-15668.26 546.56,-15678.86 553.17,-15676.55"/>
</g>
<!-- layer4_mlp_ar -->
<g id="node55" class="node">
<title>layer4_mlp_ar</title>
<polygon fill="yellow" stroke="black" points="1001.4,-15563.17 229.24,-15563.17 30.6,-15427.17 802.76,-15427.17 1001.4,-15563.17"/>
<text text-anchor="middle" x="516" y="-15513.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="516" y="-15498.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="516" y="-15483.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="516" y="-15468.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer4_mlp2&#45;&gt;layer4_mlp_ar -->
<g id="edge63" class="edge">
<title>layer4_mlp2&#45;&gt;layer4_mlp_ar</title>
<path fill="none" stroke="black" d="M530.4,-15600C529.27,-15591.86 528.02,-15582.8 526.73,-15573.52"/>
<polygon fill="black" stroke="black" points="530.16,-15572.82 525.32,-15563.4 523.23,-15573.79 530.16,-15572.82"/>
</g>
<!-- layer4_mlp_ar&#45;&gt;layer4_res2 -->
<g id="edge65" class="edge">
<title>layer4_mlp_ar&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M629.43,-15426.99C647.44,-15416.32 665.71,-15405.51 682.65,-15395.48"/>
<polygon fill="black" stroke="black" points="684.55,-15398.42 691.37,-15390.31 680.99,-15392.39 684.55,-15398.42"/>
</g>
<!-- layer5_ln1 -->
<g id="node57" class="node">
<title>layer5_ln1</title>
<polygon fill="yellow" stroke="black" points="967,-15249.17 499,-15249.17 499,-15181.17 967,-15181.17 967,-15249.17"/>
<text text-anchor="middle" x="733" y="-15233.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="733" y="-15218.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="733" y="-15203.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="733" y="-15188.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer4_res2&#45;&gt;layer5_ln1 -->
<g id="edge66" class="edge">
<title>layer4_res2&#45;&gt;layer5_ln1</title>
<path fill="none" stroke="black" d="M751.68,-15307.14C748.55,-15291.91 744.99,-15274.55 741.82,-15259.11"/>
<polygon fill="black" stroke="black" points="745.24,-15258.38 739.8,-15249.28 738.38,-15259.78 745.24,-15258.38"/>
</g>
<!-- layer5_res1 -->
<g id="node61" class="node">
<title>layer5_res1</title>
<polygon fill="yellow" stroke="black" points="949,-14761.17 481,-14761.17 481,-14678.17 949,-14678.17 949,-14761.17"/>
<text text-anchor="middle" x="715" y="-14745.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="715" y="-14730.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="715" y="-14715.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="715" y="-14700.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="715" y="-14685.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer4_res2&#45;&gt;layer5_res1 -->
<g id="edge70" class="edge">
<title>layer4_res2&#45;&gt;layer5_res1</title>
<path fill="none" stroke="black" d="M958.4,-15307.07C996.08,-15287.6 1024,-15258.79 1024,-15216.17 1024,-15216.17 1024,-15216.17 1024,-14865.17 1024,-14835.06 1034.14,-14820.55 1014,-14798.17 1002.38,-14785.25 977.49,-14773.91 946.78,-14764.17"/>
<polygon fill="black" stroke="black" points="947.66,-14760.78 937.08,-14761.2 945.61,-14767.47 947.66,-14760.78"/>
</g>
<!-- layer5_qkv -->
<g id="node58" class="node">
<title>layer5_qkv</title>
<polygon fill="yellow" stroke="black" points="917.5,-15144.17 298.5,-15144.17 298.5,-15076.17 917.5,-15076.17 917.5,-15144.17"/>
<text text-anchor="middle" x="608" y="-15128.97" font-family="Times,serif" font-size="14.00">QKV Linear (Column&#45;Parallel)</text>
<text text-anchor="middle" x="608" y="-15113.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="608" y="-15098.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="608" y="-15083.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer5_ln1&#45;&gt;layer5_qkv -->
<g id="edge67" class="edge">
<title>layer5_ln1&#45;&gt;layer5_qkv</title>
<path fill="none" stroke="black" d="M692.76,-15181.01C681.05,-15171.36 668.14,-15160.72 656.01,-15150.72"/>
<polygon fill="black" stroke="black" points="658.11,-15147.92 648.16,-15144.26 653.66,-15153.32 658.11,-15147.92"/>
</g>
<!-- layer5_attn -->
<g id="node59" class="node">
<title>layer5_attn</title>
<polygon fill="yellow" stroke="black" points="856.5,-15039.17 249.5,-15039.17 249.5,-14971.17 856.5,-14971.17 856.5,-15039.17"/>
<text text-anchor="middle" x="553" y="-15023.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="553" y="-15008.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="553" y="-14993.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="553" y="-14978.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer5_qkv&#45;&gt;layer5_attn -->
<g id="edge68" class="edge">
<title>layer5_qkv&#45;&gt;layer5_attn</title>
<path fill="none" stroke="black" d="M590.29,-15076.01C585.58,-15067.19 580.43,-15057.54 575.5,-15048.31"/>
<polygon fill="black" stroke="black" points="578.47,-15046.43 570.67,-15039.26 572.29,-15049.73 578.47,-15046.43"/>
</g>
<!-- layer5_attn_ar -->
<g id="node60" class="node">
<title>layer5_attn_ar</title>
<polygon fill="yellow" stroke="black" points="1005.4,-14934.17 233.24,-14934.17 34.6,-14798.17 806.76,-14798.17 1005.4,-14934.17"/>
<text text-anchor="middle" x="520" y="-14884.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="520" y="-14869.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-14854.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-14839.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer5_attn&#45;&gt;layer5_attn_ar -->
<g id="edge69" class="edge">
<title>layer5_attn&#45;&gt;layer5_attn_ar</title>
<path fill="none" stroke="black" d="M545.01,-14971C543.03,-14962.77 540.82,-14953.61 538.56,-14944.23"/>
<polygon fill="black" stroke="black" points="541.94,-14943.3 536.19,-14934.4 535.13,-14944.94 541.94,-14943.3"/>
</g>
<!-- layer5_attn_ar&#45;&gt;layer5_res1 -->
<g id="edge71" class="edge">
<title>layer5_attn_ar&#45;&gt;layer5_res1</title>
<path fill="none" stroke="black" d="M610.65,-14797.99C624.65,-14787.62 638.84,-14777.1 652.06,-14767.31"/>
<polygon fill="black" stroke="black" points="654.2,-14770.07 660.15,-14761.31 650.04,-14764.45 654.2,-14770.07"/>
</g>
<!-- layer5_ln2 -->
<g id="node62" class="node">
<title>layer5_ln2</title>
<polygon fill="yellow" stroke="black" points="912,-14641.17 444,-14641.17 444,-14573.17 912,-14573.17 912,-14641.17"/>
<text text-anchor="middle" x="678" y="-14625.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="678" y="-14610.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="678" y="-14595.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="678" y="-14580.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer5_res1&#45;&gt;layer5_ln2 -->
<g id="edge72" class="edge">
<title>layer5_res1&#45;&gt;layer5_ln2</title>
<path fill="none" stroke="black" d="M701.43,-14678.15C698.46,-14669.28 695.31,-14659.87 692.32,-14650.92"/>
<polygon fill="black" stroke="black" points="695.63,-14649.81 689.14,-14641.44 689,-14652.03 695.63,-14649.81"/>
</g>
<!-- layer5_res2 -->
<g id="node67" class="node">
<title>layer5_res2</title>
<polygon fill="yellow" stroke="black" points="994,-14048.17 526,-14048.17 526,-13965.17 994,-13965.17 994,-14048.17"/>
<text text-anchor="middle" x="760" y="-14032.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="760" y="-14017.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="760" y="-14002.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="760" y="-13987.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="760" y="-13972.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer5_res1&#45;&gt;layer5_res2 -->
<g id="edge77" class="edge">
<title>layer5_res1&#45;&gt;layer5_res2</title>
<path fill="none" stroke="black" d="M912.9,-14678.13C971.34,-14660.38 1020,-14636.96 1020,-14608.17 1020,-14608.17 1020,-14608.17 1020,-14152.17 1020,-14122.06 1029.61,-14108.02 1010,-14085.17 999.34,-14072.74 986.73,-14062.28 972.93,-14053.48"/>
<polygon fill="black" stroke="black" points="974.56,-14050.37 964.19,-14048.21 970.95,-14056.37 974.56,-14050.37"/>
</g>
<!-- layer5_mlp1 -->
<g id="node63" class="node">
<title>layer5_mlp1</title>
<polygon fill="yellow" stroke="black" points="884.5,-14536.17 381.5,-14536.17 381.5,-14468.17 884.5,-14468.17 884.5,-14536.17"/>
<text text-anchor="middle" x="633" y="-14520.97" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column&#45;Parallel)</text>
<text text-anchor="middle" x="633" y="-14505.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="633" y="-14490.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="633" y="-14475.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer5_ln2&#45;&gt;layer5_mlp1 -->
<g id="edge73" class="edge">
<title>layer5_ln2&#45;&gt;layer5_mlp1</title>
<path fill="none" stroke="black" d="M663.51,-14573.01C659.7,-14564.28 655.53,-14554.74 651.54,-14545.6"/>
<polygon fill="black" stroke="black" points="654.67,-14544.02 647.46,-14536.26 648.26,-14546.83 654.67,-14544.02"/>
</g>
<!-- layer5_gelu -->
<g id="node64" class="node">
<title>layer5_gelu</title>
<polygon fill="yellow" stroke="black" points="822.5,-14431.17 319.5,-14431.17 319.5,-14363.17 822.5,-14363.17 822.5,-14431.17"/>
<text text-anchor="middle" x="571" y="-14415.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="571" y="-14400.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="571" y="-14385.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="571" y="-14370.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer5_mlp1&#45;&gt;layer5_gelu -->
<g id="edge74" class="edge">
<title>layer5_mlp1&#45;&gt;layer5_gelu</title>
<path fill="none" stroke="black" d="M613.04,-14468.01C607.68,-14459.1 601.8,-14449.34 596.19,-14440.02"/>
<polygon fill="black" stroke="black" points="599.08,-14438.02 590.92,-14431.26 593.08,-14441.63 599.08,-14438.02"/>
</g>
<!-- layer5_mlp2 -->
<g id="node65" class="node">
<title>layer5_mlp2</title>
<polygon fill="yellow" stroke="black" points="783.5,-14326.17 292.5,-14326.17 292.5,-14258.17 783.5,-14258.17 783.5,-14326.17"/>
<text text-anchor="middle" x="538" y="-14310.97" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row&#45;Parallel)</text>
<text text-anchor="middle" x="538" y="-14295.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="538" y="-14280.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="538" y="-14265.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer5_gelu&#45;&gt;layer5_mlp2 -->
<g id="edge75" class="edge">
<title>layer5_gelu&#45;&gt;layer5_mlp2</title>
<path fill="none" stroke="black" d="M560.38,-14363.01C557.61,-14354.37 554.59,-14344.94 551.69,-14335.89"/>
<polygon fill="black" stroke="black" points="554.99,-14334.72 548.6,-14326.26 548.32,-14336.85 554.99,-14334.72"/>
</g>
<!-- layer5_mlp_ar -->
<g id="node66" class="node">
<title>layer5_mlp_ar</title>
<polygon fill="yellow" stroke="black" points="1001.4,-14221.17 229.24,-14221.17 30.6,-14085.17 802.76,-14085.17 1001.4,-14221.17"/>
<text text-anchor="middle" x="516" y="-14171.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="516" y="-14156.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="516" y="-14141.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="516" y="-14126.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer5_mlp2&#45;&gt;layer5_mlp_ar -->
<g id="edge76" class="edge">
<title>layer5_mlp2&#45;&gt;layer5_mlp_ar</title>
<path fill="none" stroke="black" d="M532.67,-14258C531.37,-14249.86 529.91,-14240.8 528.42,-14231.52"/>
<polygon fill="black" stroke="black" points="531.84,-14230.72 526.8,-14221.4 524.93,-14231.83 531.84,-14230.72"/>
</g>
<!-- layer5_mlp_ar&#45;&gt;layer5_res2 -->
<g id="edge78" class="edge">
<title>layer5_mlp_ar&#45;&gt;layer5_res2</title>
<path fill="none" stroke="black" d="M629.43,-14084.99C647.44,-14074.32 665.71,-14063.51 682.65,-14053.48"/>
<polygon fill="black" stroke="black" points="684.55,-14056.42 691.37,-14048.31 680.99,-14050.39 684.55,-14056.42"/>
</g>
<!-- layer6_ln1 -->
<g id="node68" class="node">
<title>layer6_ln1</title>
<polygon fill="yellow" stroke="black" points="967,-13907.17 499,-13907.17 499,-13839.17 967,-13839.17 967,-13907.17"/>
<text text-anchor="middle" x="733" y="-13891.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="733" y="-13876.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="733" y="-13861.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="733" y="-13846.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer5_res2&#45;&gt;layer6_ln1 -->
<g id="edge79" class="edge">
<title>layer5_res2&#45;&gt;layer6_ln1</title>
<path fill="none" stroke="black" d="M751.68,-13965.14C748.55,-13949.91 744.99,-13932.55 741.82,-13917.11"/>
<polygon fill="black" stroke="black" points="745.24,-13916.38 739.8,-13907.28 738.38,-13917.78 745.24,-13916.38"/>
</g>
<!-- layer6_res1 -->
<g id="node72" class="node">
<title>layer6_res1</title>
<polygon fill="yellow" stroke="black" points="1007,-13419.17 539,-13419.17 539,-13336.17 1007,-13336.17 1007,-13419.17"/>
<text text-anchor="middle" x="773" y="-13403.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="773" y="-13388.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="773" y="-13373.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="773" y="-13358.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="773" y="-13343.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer5_res2&#45;&gt;layer6_res1 -->
<g id="edge83" class="edge">
<title>layer5_res2&#45;&gt;layer6_res1</title>
<path fill="none" stroke="black" d="M958.4,-13965.07C996.08,-13945.6 1024,-13916.79 1024,-13874.17 1024,-13874.17 1024,-13874.17 1024,-13523.17 1024,-13493.06 1033.49,-13479.12 1014,-13456.17 1003.46,-13443.75 990.92,-13433.3 977.18,-13424.52"/>
<polygon fill="black" stroke="black" points="978.85,-13421.44 968.48,-13419.26 975.23,-13427.43 978.85,-13421.44"/>
</g>
<!-- layer6_qkv -->
<g id="node69" class="node">
<title>layer6_qkv</title>
<polygon fill="yellow" stroke="black" points="917.5,-13802.17 298.5,-13802.17 298.5,-13734.17 917.5,-13734.17 917.5,-13802.17"/>
<text text-anchor="middle" x="608" y="-13786.97" font-family="Times,serif" font-size="14.00">QKV Linear (Column&#45;Parallel)</text>
<text text-anchor="middle" x="608" y="-13771.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="608" y="-13756.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="608" y="-13741.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer6_ln1&#45;&gt;layer6_qkv -->
<g id="edge80" class="edge">
<title>layer6_ln1&#45;&gt;layer6_qkv</title>
<path fill="none" stroke="black" d="M692.76,-13839.01C681.05,-13829.36 668.14,-13818.72 656.01,-13808.72"/>
<polygon fill="black" stroke="black" points="658.11,-13805.92 648.16,-13802.26 653.66,-13811.32 658.11,-13805.92"/>
</g>
<!-- layer6_attn -->
<g id="node70" class="node">
<title>layer6_attn</title>
<polygon fill="yellow" stroke="black" points="856.5,-13697.17 249.5,-13697.17 249.5,-13629.17 856.5,-13629.17 856.5,-13697.17"/>
<text text-anchor="middle" x="553" y="-13681.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="553" y="-13666.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="553" y="-13651.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="553" y="-13636.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer6_qkv&#45;&gt;layer6_attn -->
<g id="edge81" class="edge">
<title>layer6_qkv&#45;&gt;layer6_attn</title>
<path fill="none" stroke="black" d="M590.29,-13734.01C585.58,-13725.19 580.43,-13715.54 575.5,-13706.31"/>
<polygon fill="black" stroke="black" points="578.47,-13704.43 570.67,-13697.26 572.29,-13707.73 578.47,-13704.43"/>
</g>
<!-- layer6_attn_ar -->
<g id="node71" class="node">
<title>layer6_attn_ar</title>
<polygon fill="yellow" stroke="black" points="1005.4,-13592.17 233.24,-13592.17 34.6,-13456.17 806.76,-13456.17 1005.4,-13592.17"/>
<text text-anchor="middle" x="520" y="-13542.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="520" y="-13527.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-13512.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-13497.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer6_attn&#45;&gt;layer6_attn_ar -->
<g id="edge82" class="edge">
<title>layer6_attn&#45;&gt;layer6_attn_ar</title>
<path fill="none" stroke="black" d="M545.01,-13629C543.03,-13620.77 540.82,-13611.61 538.56,-13602.23"/>
<polygon fill="black" stroke="black" points="541.94,-13601.3 536.19,-13592.4 535.13,-13602.94 541.94,-13601.3"/>
</g>
<!-- layer6_attn_ar&#45;&gt;layer6_res1 -->
<g id="edge84" class="edge">
<title>layer6_attn_ar&#45;&gt;layer6_res1</title>
<path fill="none" stroke="black" d="M637.61,-13455.99C656.29,-13445.32 675.23,-13434.51 692.79,-13424.48"/>
<polygon fill="black" stroke="black" points="694.89,-13427.31 701.84,-13419.31 691.42,-13421.23 694.89,-13427.31"/>
</g>
<!-- layer6_ln2 -->
<g id="node73" class="node">
<title>layer6_ln2</title>
<polygon fill="yellow" stroke="black" points="992,-13299.17 524,-13299.17 524,-13231.17 992,-13231.17 992,-13299.17"/>
<text text-anchor="middle" x="758" y="-13283.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="758" y="-13268.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="758" y="-13253.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="758" y="-13238.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer6_res1&#45;&gt;layer6_ln2 -->
<g id="edge85" class="edge">
<title>layer6_res1&#45;&gt;layer6_ln2</title>
<path fill="none" stroke="black" d="M767.5,-13336.15C766.32,-13327.47 765.07,-13318.27 763.88,-13309.49"/>
<polygon fill="black" stroke="black" points="767.33,-13308.88 762.52,-13299.44 760.39,-13309.82 767.33,-13308.88"/>
</g>
<!-- layer6_res2 -->
<g id="node78" class="node">
<title>layer6_res2</title>
<polygon fill="yellow" stroke="black" points="994,-12706.17 526,-12706.17 526,-12623.17 994,-12623.17 994,-12706.17"/>
<text text-anchor="middle" x="760" y="-12690.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="760" y="-12675.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="760" y="-12660.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="760" y="-12645.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="760" y="-12630.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer6_res1&#45;&gt;layer6_res2 -->
<g id="edge90" class="edge">
<title>layer6_res1&#45;&gt;layer6_res2</title>
<path fill="none" stroke="black" d="M978.66,-13336.02C1003.33,-13319.87 1020,-13297.41 1020,-13266.17 1020,-13266.17 1020,-13266.17 1020,-12810.17 1020,-12780.06 1029.61,-12766.02 1010,-12743.17 999.34,-12730.74 986.73,-12720.28 972.93,-12711.48"/>
<polygon fill="black" stroke="black" points="974.56,-12708.37 964.19,-12706.21 970.95,-12714.37 974.56,-12708.37"/>
</g>
<!-- layer6_mlp1 -->
<g id="node74" class="node">
<title>layer6_mlp1</title>
<polygon fill="yellow" stroke="black" points="884.5,-13194.17 381.5,-13194.17 381.5,-13126.17 884.5,-13126.17 884.5,-13194.17"/>
<text text-anchor="middle" x="633" y="-13178.97" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column&#45;Parallel)</text>
<text text-anchor="middle" x="633" y="-13163.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="633" y="-13148.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="633" y="-13133.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer6_ln2&#45;&gt;layer6_mlp1 -->
<g id="edge86" class="edge">
<title>layer6_ln2&#45;&gt;layer6_mlp1</title>
<path fill="none" stroke="black" d="M717.76,-13231.01C706.05,-13221.36 693.14,-13210.72 681.01,-13200.72"/>
<polygon fill="black" stroke="black" points="683.11,-13197.92 673.16,-13194.26 678.66,-13203.32 683.11,-13197.92"/>
</g>
<!-- layer6_gelu -->
<g id="node75" class="node">
<title>layer6_gelu</title>
<polygon fill="yellow" stroke="black" points="822.5,-13089.17 319.5,-13089.17 319.5,-13021.17 822.5,-13021.17 822.5,-13089.17"/>
<text text-anchor="middle" x="571" y="-13073.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="571" y="-13058.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="571" y="-13043.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="571" y="-13028.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer6_mlp1&#45;&gt;layer6_gelu -->
<g id="edge87" class="edge">
<title>layer6_mlp1&#45;&gt;layer6_gelu</title>
<path fill="none" stroke="black" d="M613.04,-13126.01C607.68,-13117.1 601.8,-13107.34 596.19,-13098.02"/>
<polygon fill="black" stroke="black" points="599.08,-13096.02 590.92,-13089.26 593.08,-13099.63 599.08,-13096.02"/>
</g>
<!-- layer6_mlp2 -->
<g id="node76" class="node">
<title>layer6_mlp2</title>
<polygon fill="yellow" stroke="black" points="780.5,-12984.17 289.5,-12984.17 289.5,-12916.17 780.5,-12916.17 780.5,-12984.17"/>
<text text-anchor="middle" x="535" y="-12968.97" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row&#45;Parallel)</text>
<text text-anchor="middle" x="535" y="-12953.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="535" y="-12938.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="535" y="-12923.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer6_gelu&#45;&gt;layer6_mlp2 -->
<g id="edge88" class="edge">
<title>layer6_gelu&#45;&gt;layer6_mlp2</title>
<path fill="none" stroke="black" d="M559.41,-13021.01C556.39,-13012.37 553.1,-13002.94 549.93,-12993.89"/>
<polygon fill="black" stroke="black" points="553.17,-12992.55 546.57,-12984.26 546.56,-12994.86 553.17,-12992.55"/>
</g>
<!-- layer6_mlp_ar -->
<g id="node77" class="node">
<title>layer6_mlp_ar</title>
<polygon fill="yellow" stroke="black" points="1001.4,-12879.17 229.24,-12879.17 30.6,-12743.17 802.76,-12743.17 1001.4,-12879.17"/>
<text text-anchor="middle" x="516" y="-12829.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="516" y="-12814.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="516" y="-12799.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="516" y="-12784.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer6_mlp2&#45;&gt;layer6_mlp_ar -->
<g id="edge89" class="edge">
<title>layer6_mlp2&#45;&gt;layer6_mlp_ar</title>
<path fill="none" stroke="black" d="M530.4,-12916C529.27,-12907.86 528.02,-12898.8 526.73,-12889.52"/>
<polygon fill="black" stroke="black" points="530.16,-12888.82 525.32,-12879.4 523.23,-12889.79 530.16,-12888.82"/>
</g>
<!-- layer6_mlp_ar&#45;&gt;layer6_res2 -->
<g id="edge91" class="edge">
<title>layer6_mlp_ar&#45;&gt;layer6_res2</title>
<path fill="none" stroke="black" d="M629.43,-12742.99C647.44,-12732.32 665.71,-12721.51 682.65,-12711.48"/>
<polygon fill="black" stroke="black" points="684.55,-12714.42 691.37,-12706.31 680.99,-12708.39 684.55,-12714.42"/>
</g>
<!-- layer7_ln1 -->
<g id="node79" class="node">
<title>layer7_ln1</title>
<polygon fill="yellow" stroke="black" points="967,-12565.17 499,-12565.17 499,-12497.17 967,-12497.17 967,-12565.17"/>
<text text-anchor="middle" x="733" y="-12549.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="733" y="-12534.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="733" y="-12519.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="733" y="-12504.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer6_res2&#45;&gt;layer7_ln1 -->
<g id="edge92" class="edge">
<title>layer6_res2&#45;&gt;layer7_ln1</title>
<path fill="none" stroke="black" d="M751.68,-12623.14C748.55,-12607.91 744.99,-12590.55 741.82,-12575.11"/>
<polygon fill="black" stroke="black" points="745.24,-12574.38 739.8,-12565.28 738.38,-12575.78 745.24,-12574.38"/>
</g>
<!-- layer7_res1 -->
<g id="node83" class="node">
<title>layer7_res1</title>
<polygon fill="yellow" stroke="black" points="1007,-12077.17 539,-12077.17 539,-11994.17 1007,-11994.17 1007,-12077.17"/>
<text text-anchor="middle" x="773" y="-12061.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="773" y="-12046.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="773" y="-12031.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="773" y="-12016.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="773" y="-12001.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer6_res2&#45;&gt;layer7_res1 -->
<g id="edge96" class="edge">
<title>layer6_res2&#45;&gt;layer7_res1</title>
<path fill="none" stroke="black" d="M958.4,-12623.07C996.08,-12603.6 1024,-12574.79 1024,-12532.17 1024,-12532.17 1024,-12532.17 1024,-12181.17 1024,-12151.06 1033.49,-12137.12 1014,-12114.17 1003.46,-12101.75 990.92,-12091.3 977.18,-12082.52"/>
<polygon fill="black" stroke="black" points="978.85,-12079.44 968.48,-12077.26 975.23,-12085.43 978.85,-12079.44"/>
</g>
<!-- layer7_qkv -->
<g id="node80" class="node">
<title>layer7_qkv</title>
<polygon fill="yellow" stroke="black" points="917.5,-12460.17 298.5,-12460.17 298.5,-12392.17 917.5,-12392.17 917.5,-12460.17"/>
<text text-anchor="middle" x="608" y="-12444.97" font-family="Times,serif" font-size="14.00">QKV Linear (Column&#45;Parallel)</text>
<text text-anchor="middle" x="608" y="-12429.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="608" y="-12414.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="608" y="-12399.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer7_ln1&#45;&gt;layer7_qkv -->
<g id="edge93" class="edge">
<title>layer7_ln1&#45;&gt;layer7_qkv</title>
<path fill="none" stroke="black" d="M692.76,-12497.01C681.05,-12487.36 668.14,-12476.72 656.01,-12466.72"/>
<polygon fill="black" stroke="black" points="658.11,-12463.92 648.16,-12460.26 653.66,-12469.32 658.11,-12463.92"/>
</g>
<!-- layer7_attn -->
<g id="node81" class="node">
<title>layer7_attn</title>
<polygon fill="yellow" stroke="black" points="856.5,-12355.17 249.5,-12355.17 249.5,-12287.17 856.5,-12287.17 856.5,-12355.17"/>
<text text-anchor="middle" x="553" y="-12339.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="553" y="-12324.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="553" y="-12309.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="553" y="-12294.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer7_qkv&#45;&gt;layer7_attn -->
<g id="edge94" class="edge">
<title>layer7_qkv&#45;&gt;layer7_attn</title>
<path fill="none" stroke="black" d="M590.29,-12392.01C585.58,-12383.19 580.43,-12373.54 575.5,-12364.31"/>
<polygon fill="black" stroke="black" points="578.47,-12362.43 570.67,-12355.26 572.29,-12365.73 578.47,-12362.43"/>
</g>
<!-- layer7_attn_ar -->
<g id="node82" class="node">
<title>layer7_attn_ar</title>
<polygon fill="yellow" stroke="black" points="1005.4,-12250.17 233.24,-12250.17 34.6,-12114.17 806.76,-12114.17 1005.4,-12250.17"/>
<text text-anchor="middle" x="520" y="-12200.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="520" y="-12185.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-12170.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="520" y="-12155.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer7_attn&#45;&gt;layer7_attn_ar -->
<g id="edge95" class="edge">
<title>layer7_attn&#45;&gt;layer7_attn_ar</title>
<path fill="none" stroke="black" d="M545.01,-12287C543.03,-12278.77 540.82,-12269.61 538.56,-12260.23"/>
<polygon fill="black" stroke="black" points="541.94,-12259.3 536.19,-12250.4 535.13,-12260.94 541.94,-12259.3"/>
</g>
<!-- layer7_attn_ar&#45;&gt;layer7_res1 -->
<g id="edge97" class="edge">
<title>layer7_attn_ar&#45;&gt;layer7_res1</title>
<path fill="none" stroke="black" d="M637.61,-12113.99C656.29,-12103.32 675.23,-12092.51 692.79,-12082.48"/>
<polygon fill="black" stroke="black" points="694.89,-12085.31 701.84,-12077.31 691.42,-12079.23 694.89,-12085.31"/>
</g>
<!-- layer7_ln2 -->
<g id="node84" class="node">
<title>layer7_ln2</title>
<polygon fill="yellow" stroke="black" points="992,-11957.17 524,-11957.17 524,-11889.17 992,-11889.17 992,-11957.17"/>
<text text-anchor="middle" x="758" y="-11941.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="758" y="-11926.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="758" y="-11911.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="758" y="-11896.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer7_res1&#45;&gt;layer7_ln2 -->
<g id="edge98" class="edge">
<title>layer7_res1&#45;&gt;layer7_ln2</title>
<path fill="none" stroke="black" d="M767.5,-11994.15C766.32,-11985.47 765.07,-11976.27 763.88,-11967.49"/>
<polygon fill="black" stroke="black" points="767.33,-11966.88 762.52,-11957.44 760.39,-11967.82 767.33,-11966.88"/>
</g>
<!-- layer7_res2 -->
<g id="node89" class="node">
<title>layer7_res2</title>
<polygon fill="yellow" stroke="black" points="765,-11364.17 297,-11364.17 297,-11281.17 765,-11281.17 765,-11364.17"/>
<text text-anchor="middle" x="531" y="-11348.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="531" y="-11333.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="531" y="-11318.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="531" y="-11303.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="531" y="-11288.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer7_res1&#45;&gt;layer7_res2 -->
<g id="edge103" class="edge">
<title>layer7_res1&#45;&gt;layer7_res2</title>
<path fill="none" stroke="black" d="M978.66,-11994.02C1003.33,-11977.87 1020,-11955.41 1020,-11924.17 1020,-11924.17 1020,-11924.17 1020,-11468.17 1020,-11438.06 1031.16,-11422.59 1010,-11401.17 975.87,-11366.62 875.34,-11347.47 775.14,-11336.86"/>
<polygon fill="black" stroke="black" points="775.43,-11333.37 765.13,-11335.83 774.72,-11340.33 775.43,-11333.37"/>
</g>
<!-- layer7_mlp1 -->
<g id="node85" class="node">
<title>layer7_mlp1</title>
<polygon fill="yellow" stroke="black" points="1000.5,-11852.17 497.5,-11852.17 497.5,-11784.17 1000.5,-11784.17 1000.5,-11852.17"/>
<text text-anchor="middle" x="749" y="-11836.97" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column&#45;Parallel)</text>
<text text-anchor="middle" x="749" y="-11821.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="749" y="-11806.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="749" y="-11791.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer7_ln2&#45;&gt;layer7_mlp1 -->
<g id="edge99" class="edge">
<title>layer7_ln2&#45;&gt;layer7_mlp1</title>
<path fill="none" stroke="black" d="M755.1,-11889.01C754.36,-11880.56 753.56,-11871.34 752.78,-11862.47"/>
<polygon fill="black" stroke="black" points="756.25,-11861.92 751.89,-11852.26 749.28,-11862.53 756.25,-11861.92"/>
</g>
<!-- layer7_gelu -->
<g id="node86" class="node">
<title>layer7_gelu</title>
<polygon fill="yellow" stroke="black" points="884.5,-11747.17 381.5,-11747.17 381.5,-11679.17 884.5,-11679.17 884.5,-11747.17"/>
<text text-anchor="middle" x="633" y="-11731.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="633" y="-11716.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="633" y="-11701.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="633" y="-11686.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer7_mlp1&#45;&gt;layer7_gelu -->
<g id="edge100" class="edge">
<title>layer7_mlp1&#45;&gt;layer7_gelu</title>
<path fill="none" stroke="black" d="M711.66,-11784.01C700.9,-11774.45 689.04,-11763.93 677.87,-11754.01"/>
<polygon fill="black" stroke="black" points="680.07,-11751.28 670.27,-11747.26 675.43,-11756.52 680.07,-11751.28"/>
</g>
<!-- layer7_mlp2 -->
<g id="node87" class="node">
<title>layer7_mlp2</title>
<polygon fill="yellow" stroke="black" points="805.5,-11642.17 314.5,-11642.17 314.5,-11574.17 805.5,-11574.17 805.5,-11642.17"/>
<text text-anchor="middle" x="560" y="-11626.97" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row&#45;Parallel)</text>
<text text-anchor="middle" x="560" y="-11611.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="560" y="-11596.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="560" y="-11581.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer7_gelu&#45;&gt;layer7_mlp2 -->
<g id="edge101" class="edge">
<title>layer7_gelu&#45;&gt;layer7_mlp2</title>
<path fill="none" stroke="black" d="M609.5,-11679.01C603.05,-11669.91 595.98,-11659.94 589.26,-11650.44"/>
<polygon fill="black" stroke="black" points="592.09,-11648.4 583.46,-11642.26 586.38,-11652.44 592.09,-11648.4"/>
</g>
<!-- layer7_mlp_ar -->
<g id="node88" class="node">
<title>layer7_mlp_ar</title>
<polygon fill="yellow" stroke="black" points="1001.4,-11537.17 229.24,-11537.17 30.6,-11401.17 802.76,-11401.17 1001.4,-11537.17"/>
<text text-anchor="middle" x="516" y="-11487.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="516" y="-11472.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="516" y="-11457.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="516" y="-11442.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7</text>
</g>
<!-- layer7_mlp2&#45;&gt;layer7_mlp_ar -->
<g id="edge102" class="edge">
<title>layer7_mlp2&#45;&gt;layer7_mlp_ar</title>
<path fill="none" stroke="black" d="M549.35,-11574C546.68,-11565.69 543.7,-11556.42 540.65,-11546.93"/>
<polygon fill="black" stroke="black" points="543.98,-11545.85 537.59,-11537.4 537.32,-11547.99 543.98,-11545.85"/>
</g>
<!-- layer7_mlp_ar&#45;&gt;layer7_res2 -->
<g id="edge104" class="edge">
<title>layer7_mlp_ar&#45;&gt;layer7_res2</title>
<path fill="none" stroke="black" d="M522.97,-11400.99C523.9,-11392.09 524.83,-11383.07 525.72,-11374.51"/>
<polygon fill="black" stroke="black" points="529.23,-11374.62 526.78,-11364.31 522.27,-11373.89 529.23,-11374.62"/>
</g>
<!-- send_to_stage1 -->
<g id="node90" class="node">
<title>send_to_stage1</title>
<polygon fill="yellow" stroke="black" points="1016.4,-11244.17 244.24,-11244.17 45.6,-11108.17 817.76,-11108.17 1016.4,-11244.17"/>
<text text-anchor="middle" x="531" y="-11194.97" font-family="Times,serif" font-size="14.00">Pipeline Send</text>
<text text-anchor="middle" x="531" y="-11179.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="531" y="-11164.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="531" y="-11149.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 0&#45;7  GPUs 8&#45;15</text>
</g>
<!-- layer7_res2&#45;&gt;send_to_stage1 -->
<g id="edge105" class="edge">
<title>layer7_res2&#45;&gt;send_to_stage1</title>
<path fill="none" stroke="black" d="M531,-11281.03C531,-11272.63 531,-11263.52 531,-11254.31"/>
<polygon fill="black" stroke="black" points="534.5,-11254.3 531,-11244.3 527.5,-11254.3 534.5,-11254.3"/>
</g>
<!-- recv_from_stage0 -->
<g id="node91" class="node">
<title>recv_from_stage0</title>
<polygon fill="yellow" stroke="black" points="1016.4,-11021.17 244.24,-11021.17 45.6,-10885.17 817.76,-10885.17 1016.4,-11021.17"/>
<text text-anchor="middle" x="531" y="-10971.97" font-family="Times,serif" font-size="14.00">Pipeline Receive</text>
<text text-anchor="middle" x="531" y="-10956.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="531" y="-10941.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="531" y="-10926.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- send_to_stage1&#45;&gt;recv_from_stage0 -->
<g id="edge211" class="edge">
<title>send_to_stage1&#45;&gt;recv_from_stage0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M531,-11107.96C531,-11083.85 531,-11056.48 531,-11031.57"/>
<polygon fill="black" stroke="black" points="534.5,-11031.43 531,-11021.43 527.5,-11031.44 534.5,-11031.43"/>
<text text-anchor="middle" x="618.5" y="-11078.97" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
</g>
<!-- layer8_ln1 -->
<g id="node92" class="node">
<title>layer8_ln1</title>
<polygon fill="yellow" stroke="black" points="765,-10827.17 297,-10827.17 297,-10759.17 765,-10759.17 765,-10827.17"/>
<text text-anchor="middle" x="531" y="-10811.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="531" y="-10796.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="531" y="-10781.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="531" y="-10766.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- recv_from_stage0&#45;&gt;layer8_ln1 -->
<g id="edge106" class="edge">
<title>recv_from_stage0&#45;&gt;layer8_ln1</title>
<path fill="none" stroke="black" d="M531,-10885.16C531,-10869.05 531,-10852.26 531,-10837.56"/>
<polygon fill="black" stroke="black" points="534.5,-10837.26 531,-10827.26 527.5,-10837.26 534.5,-10837.26"/>
</g>
<!-- layer8_res1 -->
<g id="node96" class="node">
<title>layer8_res1</title>
<polygon fill="yellow" stroke="black" points="1000,-10339.17 532,-10339.17 532,-10256.17 1000,-10256.17 1000,-10339.17"/>
<text text-anchor="middle" x="766" y="-10323.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="766" y="-10308.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-10293.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-10278.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-10263.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- recv_from_stage0&#45;&gt;layer8_res1 -->
<g id="edge110" class="edge">
<title>recv_from_stage0&#45;&gt;layer8_res1</title>
<path fill="none" stroke="black" d="M838.99,-10899.64C933.45,-10874.62 1013,-10839.96 1013,-10794.17 1013,-10794.17 1013,-10794.17 1013,-10443.17 1013,-10413.06 1022.43,-10399.17 1003,-10376.17 992.47,-10363.71 979.91,-10353.23 966.14,-10344.44"/>
<polygon fill="black" stroke="black" points="967.79,-10341.34 957.42,-10339.17 964.17,-10347.34 967.79,-10341.34"/>
</g>
<!-- layer8_qkv -->
<g id="node93" class="node">
<title>layer8_qkv</title>
<polygon fill="yellow" stroke="black" points="837.5,-10722.17 218.5,-10722.17 218.5,-10654.17 837.5,-10654.17 837.5,-10722.17"/>
<text text-anchor="middle" x="528" y="-10706.97" font-family="Times,serif" font-size="14.00">QKV Linear (Column&#45;Parallel)</text>
<text text-anchor="middle" x="528" y="-10691.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="528" y="-10676.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="528" y="-10661.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer8_ln1&#45;&gt;layer8_qkv -->
<g id="edge107" class="edge">
<title>layer8_ln1&#45;&gt;layer8_qkv</title>
<path fill="none" stroke="black" d="M530.03,-10759.01C529.79,-10750.56 529.52,-10741.34 529.26,-10732.47"/>
<polygon fill="black" stroke="black" points="532.75,-10732.16 528.96,-10722.26 525.76,-10732.36 532.75,-10732.16"/>
</g>
<!-- layer8_attn -->
<g id="node94" class="node">
<title>layer8_attn</title>
<polygon fill="yellow" stroke="black" points="829.5,-10617.17 222.5,-10617.17 222.5,-10549.17 829.5,-10549.17 829.5,-10617.17"/>
<text text-anchor="middle" x="526" y="-10601.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="526" y="-10586.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="526" y="-10571.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="526" y="-10556.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer8_qkv&#45;&gt;layer8_attn -->
<g id="edge108" class="edge">
<title>layer8_qkv&#45;&gt;layer8_attn</title>
<path fill="none" stroke="black" d="M527.36,-10654.01C527.19,-10645.56 527.01,-10636.34 526.84,-10627.47"/>
<polygon fill="black" stroke="black" points="530.34,-10627.19 526.64,-10617.26 523.34,-10627.33 530.34,-10627.19"/>
</g>
<!-- layer8_attn_ar -->
<g id="node95" class="node">
<title>layer8_attn_ar</title>
<polygon fill="yellow" stroke="black" points="994.4,-10512.17 222.24,-10512.17 23.6,-10376.17 795.76,-10376.17 994.4,-10512.17"/>
<text text-anchor="middle" x="509" y="-10462.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="509" y="-10447.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-10432.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-10417.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer8_attn&#45;&gt;layer8_attn_ar -->
<g id="edge109" class="edge">
<title>layer8_attn&#45;&gt;layer8_attn_ar</title>
<path fill="none" stroke="black" d="M521.88,-10549C520.87,-10540.86 519.75,-10531.8 518.6,-10522.52"/>
<polygon fill="black" stroke="black" points="522.05,-10521.89 517.34,-10512.4 515.1,-10522.75 522.05,-10521.89"/>
</g>
<!-- layer8_attn_ar&#45;&gt;layer8_res1 -->
<g id="edge111" class="edge">
<title>layer8_attn_ar&#45;&gt;layer8_res1</title>
<path fill="none" stroke="black" d="M610.61,-10376.07C621.43,-10369.49 632.37,-10363.08 643,-10357.17 651.13,-10352.65 659.67,-10348.14 668.29,-10343.74"/>
<polygon fill="black" stroke="black" points="669.94,-10346.82 677.3,-10339.2 666.79,-10340.57 669.94,-10346.82"/>
</g>
<!-- layer8_ln2 -->
<g id="node97" class="node">
<title>layer8_ln2</title>
<polygon fill="yellow" stroke="black" points="985,-10219.17 517,-10219.17 517,-10151.17 985,-10151.17 985,-10219.17"/>
<text text-anchor="middle" x="751" y="-10203.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="751" y="-10188.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="751" y="-10173.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="751" y="-10158.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer8_res1&#45;&gt;layer8_ln2 -->
<g id="edge112" class="edge">
<title>layer8_res1&#45;&gt;layer8_ln2</title>
<path fill="none" stroke="black" d="M760.5,-10256.15C759.32,-10247.47 758.07,-10238.27 756.88,-10229.49"/>
<polygon fill="black" stroke="black" points="760.33,-10228.88 755.52,-10219.44 753.39,-10229.82 760.33,-10228.88"/>
</g>
<!-- layer8_res2 -->
<g id="node102" class="node">
<title>layer8_res2</title>
<polygon fill="yellow" stroke="black" points="987,-9626.17 519,-9626.17 519,-9543.17 987,-9543.17 987,-9626.17"/>
<text text-anchor="middle" x="753" y="-9610.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="753" y="-9595.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="753" y="-9580.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="753" y="-9565.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="753" y="-9550.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer8_res1&#45;&gt;layer8_res2 -->
<g id="edge117" class="edge">
<title>layer8_res1&#45;&gt;layer8_res2</title>
<path fill="none" stroke="black" d="M971.66,-10256.02C996.33,-10239.87 1013,-10217.41 1013,-10186.17 1013,-10186.17 1013,-10186.17 1013,-9730.17 1013,-9700.06 1022.61,-9686.02 1003,-9663.17 992.34,-9650.74 979.73,-9640.28 965.93,-9631.48"/>
<polygon fill="black" stroke="black" points="967.56,-9628.37 957.19,-9626.21 963.95,-9634.37 967.56,-9628.37"/>
</g>
<!-- layer8_mlp1 -->
<g id="node98" class="node">
<title>layer8_mlp1</title>
<polygon fill="yellow" stroke="black" points="993.5,-10114.17 490.5,-10114.17 490.5,-10046.17 993.5,-10046.17 993.5,-10114.17"/>
<text text-anchor="middle" x="742" y="-10098.97" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column&#45;Parallel)</text>
<text text-anchor="middle" x="742" y="-10083.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="742" y="-10068.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="742" y="-10053.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer8_ln2&#45;&gt;layer8_mlp1 -->
<g id="edge113" class="edge">
<title>layer8_ln2&#45;&gt;layer8_mlp1</title>
<path fill="none" stroke="black" d="M748.1,-10151.01C747.36,-10142.56 746.56,-10133.34 745.78,-10124.47"/>
<polygon fill="black" stroke="black" points="749.25,-10123.92 744.89,-10114.26 742.28,-10124.53 749.25,-10123.92"/>
</g>
<!-- layer8_gelu -->
<g id="node99" class="node">
<title>layer8_gelu</title>
<polygon fill="yellow" stroke="black" points="877.5,-10009.17 374.5,-10009.17 374.5,-9941.17 877.5,-9941.17 877.5,-10009.17"/>
<text text-anchor="middle" x="626" y="-9993.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="626" y="-9978.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="626" y="-9963.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="626" y="-9948.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer8_mlp1&#45;&gt;layer8_gelu -->
<g id="edge114" class="edge">
<title>layer8_mlp1&#45;&gt;layer8_gelu</title>
<path fill="none" stroke="black" d="M704.66,-10046.01C693.9,-10036.45 682.04,-10025.93 670.87,-10016.01"/>
<polygon fill="black" stroke="black" points="673.07,-10013.28 663.27,-10009.26 668.43,-10018.52 673.07,-10013.28"/>
</g>
<!-- layer8_mlp2 -->
<g id="node100" class="node">
<title>layer8_mlp2</title>
<polygon fill="yellow" stroke="black" points="798.5,-9904.17 307.5,-9904.17 307.5,-9836.17 798.5,-9836.17 798.5,-9904.17"/>
<text text-anchor="middle" x="553" y="-9888.97" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row&#45;Parallel)</text>
<text text-anchor="middle" x="553" y="-9873.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="553" y="-9858.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="553" y="-9843.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer8_gelu&#45;&gt;layer8_mlp2 -->
<g id="edge115" class="edge">
<title>layer8_gelu&#45;&gt;layer8_mlp2</title>
<path fill="none" stroke="black" d="M602.5,-9941.01C596.05,-9931.91 588.98,-9921.94 582.26,-9912.44"/>
<polygon fill="black" stroke="black" points="585.09,-9910.4 576.46,-9904.26 579.38,-9914.44 585.09,-9910.4"/>
</g>
<!-- layer8_mlp_ar -->
<g id="node101" class="node">
<title>layer8_mlp_ar</title>
<polygon fill="yellow" stroke="black" points="994.4,-9799.17 222.24,-9799.17 23.6,-9663.17 795.76,-9663.17 994.4,-9799.17"/>
<text text-anchor="middle" x="509" y="-9749.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="509" y="-9734.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-9719.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-9704.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer8_mlp2&#45;&gt;layer8_mlp_ar -->
<g id="edge116" class="edge">
<title>layer8_mlp2&#45;&gt;layer8_mlp_ar</title>
<path fill="none" stroke="black" d="M542.35,-9836C539.68,-9827.69 536.7,-9818.42 533.65,-9808.93"/>
<polygon fill="black" stroke="black" points="536.98,-9807.85 530.59,-9799.4 530.32,-9809.99 536.98,-9807.85"/>
</g>
<!-- layer8_mlp_ar&#45;&gt;layer8_res2 -->
<g id="edge118" class="edge">
<title>layer8_mlp_ar&#45;&gt;layer8_res2</title>
<path fill="none" stroke="black" d="M622.43,-9662.99C640.44,-9652.32 658.71,-9641.51 675.65,-9631.48"/>
<polygon fill="black" stroke="black" points="677.55,-9634.42 684.37,-9626.31 673.99,-9628.39 677.55,-9634.42"/>
</g>
<!-- layer9_ln1 -->
<g id="node103" class="node">
<title>layer9_ln1</title>
<polygon fill="yellow" stroke="black" points="960,-9485.17 492,-9485.17 492,-9417.17 960,-9417.17 960,-9485.17"/>
<text text-anchor="middle" x="726" y="-9469.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="726" y="-9454.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="726" y="-9439.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="726" y="-9424.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer8_res2&#45;&gt;layer9_ln1 -->
<g id="edge119" class="edge">
<title>layer8_res2&#45;&gt;layer9_ln1</title>
<path fill="none" stroke="black" d="M744.68,-9543.14C741.55,-9527.91 737.99,-9510.55 734.82,-9495.11"/>
<polygon fill="black" stroke="black" points="738.24,-9494.38 732.8,-9485.28 731.38,-9495.78 738.24,-9494.38"/>
</g>
<!-- layer9_res1 -->
<g id="node107" class="node">
<title>layer9_res1</title>
<polygon fill="yellow" stroke="black" points="1000,-8997.17 532,-8997.17 532,-8914.17 1000,-8914.17 1000,-8997.17"/>
<text text-anchor="middle" x="766" y="-8981.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="766" y="-8966.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-8951.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-8936.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-8921.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer8_res2&#45;&gt;layer9_res1 -->
<g id="edge123" class="edge">
<title>layer8_res2&#45;&gt;layer9_res1</title>
<path fill="none" stroke="black" d="M951.4,-9543.07C989.08,-9523.6 1017,-9494.79 1017,-9452.17 1017,-9452.17 1017,-9452.17 1017,-9101.17 1017,-9071.06 1026.49,-9057.12 1007,-9034.17 996.46,-9021.75 983.92,-9011.3 970.18,-9002.52"/>
<polygon fill="black" stroke="black" points="971.85,-8999.44 961.48,-8997.26 968.23,-9005.43 971.85,-8999.44"/>
</g>
<!-- layer9_qkv -->
<g id="node104" class="node">
<title>layer9_qkv</title>
<polygon fill="yellow" stroke="black" points="910.5,-9380.17 291.5,-9380.17 291.5,-9312.17 910.5,-9312.17 910.5,-9380.17"/>
<text text-anchor="middle" x="601" y="-9364.97" font-family="Times,serif" font-size="14.00">QKV Linear (Column&#45;Parallel)</text>
<text text-anchor="middle" x="601" y="-9349.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="601" y="-9334.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="601" y="-9319.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer9_ln1&#45;&gt;layer9_qkv -->
<g id="edge120" class="edge">
<title>layer9_ln1&#45;&gt;layer9_qkv</title>
<path fill="none" stroke="black" d="M685.76,-9417.01C674.05,-9407.36 661.14,-9396.72 649.01,-9386.72"/>
<polygon fill="black" stroke="black" points="651.11,-9383.92 641.16,-9380.26 646.66,-9389.32 651.11,-9383.92"/>
</g>
<!-- layer9_attn -->
<g id="node105" class="node">
<title>layer9_attn</title>
<polygon fill="yellow" stroke="black" points="849.5,-9275.17 242.5,-9275.17 242.5,-9207.17 849.5,-9207.17 849.5,-9275.17"/>
<text text-anchor="middle" x="546" y="-9259.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="546" y="-9244.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="546" y="-9229.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="546" y="-9214.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer9_qkv&#45;&gt;layer9_attn -->
<g id="edge121" class="edge">
<title>layer9_qkv&#45;&gt;layer9_attn</title>
<path fill="none" stroke="black" d="M583.29,-9312.01C578.58,-9303.19 573.43,-9293.54 568.5,-9284.31"/>
<polygon fill="black" stroke="black" points="571.47,-9282.43 563.67,-9275.26 565.29,-9285.73 571.47,-9282.43"/>
</g>
<!-- layer9_attn_ar -->
<g id="node106" class="node">
<title>layer9_attn_ar</title>
<polygon fill="yellow" stroke="black" points="998.4,-9170.17 226.24,-9170.17 27.6,-9034.17 799.76,-9034.17 998.4,-9170.17"/>
<text text-anchor="middle" x="513" y="-9120.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="513" y="-9105.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="513" y="-9090.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="513" y="-9075.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer9_attn&#45;&gt;layer9_attn_ar -->
<g id="edge122" class="edge">
<title>layer9_attn&#45;&gt;layer9_attn_ar</title>
<path fill="none" stroke="black" d="M538.01,-9207C536.03,-9198.77 533.82,-9189.61 531.56,-9180.23"/>
<polygon fill="black" stroke="black" points="534.94,-9179.3 529.19,-9170.4 528.13,-9180.94 534.94,-9179.3"/>
</g>
<!-- layer9_attn_ar&#45;&gt;layer9_res1 -->
<g id="edge124" class="edge">
<title>layer9_attn_ar&#45;&gt;layer9_res1</title>
<path fill="none" stroke="black" d="M630.61,-9033.99C649.29,-9023.32 668.23,-9012.51 685.79,-9002.48"/>
<polygon fill="black" stroke="black" points="687.89,-9005.31 694.84,-8997.31 684.42,-8999.23 687.89,-9005.31"/>
</g>
<!-- layer9_ln2 -->
<g id="node108" class="node">
<title>layer9_ln2</title>
<polygon fill="yellow" stroke="black" points="985,-8877.17 517,-8877.17 517,-8809.17 985,-8809.17 985,-8877.17"/>
<text text-anchor="middle" x="751" y="-8861.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="751" y="-8846.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="751" y="-8831.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="751" y="-8816.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer9_res1&#45;&gt;layer9_ln2 -->
<g id="edge125" class="edge">
<title>layer9_res1&#45;&gt;layer9_ln2</title>
<path fill="none" stroke="black" d="M760.5,-8914.15C759.32,-8905.47 758.07,-8896.27 756.88,-8887.49"/>
<polygon fill="black" stroke="black" points="760.33,-8886.88 755.52,-8877.44 753.39,-8887.82 760.33,-8886.88"/>
</g>
<!-- layer9_res2 -->
<g id="node113" class="node">
<title>layer9_res2</title>
<polygon fill="yellow" stroke="black" points="1001,-8284.17 533,-8284.17 533,-8201.17 1001,-8201.17 1001,-8284.17"/>
<text text-anchor="middle" x="767" y="-8268.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="767" y="-8253.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="767" y="-8238.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="767" y="-8223.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="767" y="-8208.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer9_res1&#45;&gt;layer9_res2 -->
<g id="edge130" class="edge">
<title>layer9_res1&#45;&gt;layer9_res2</title>
<path fill="none" stroke="black" d="M971.66,-8914.02C996.33,-8897.87 1013,-8875.41 1013,-8844.17 1013,-8844.17 1013,-8844.17 1013,-8388.17 1013,-8358.06 1022.41,-8344.18 1003,-8321.17 992.52,-8308.75 980.02,-8298.3 966.3,-8289.53"/>
<polygon fill="black" stroke="black" points="967.99,-8286.45 957.62,-8284.27 964.36,-8292.44 967.99,-8286.45"/>
</g>
<!-- layer9_mlp1 -->
<g id="node109" class="node">
<title>layer9_mlp1</title>
<polygon fill="yellow" stroke="black" points="877.5,-8772.17 374.5,-8772.17 374.5,-8704.17 877.5,-8704.17 877.5,-8772.17"/>
<text text-anchor="middle" x="626" y="-8756.97" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column&#45;Parallel)</text>
<text text-anchor="middle" x="626" y="-8741.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="626" y="-8726.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="626" y="-8711.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer9_ln2&#45;&gt;layer9_mlp1 -->
<g id="edge126" class="edge">
<title>layer9_ln2&#45;&gt;layer9_mlp1</title>
<path fill="none" stroke="black" d="M710.76,-8809.01C699.05,-8799.36 686.14,-8788.72 674.01,-8778.72"/>
<polygon fill="black" stroke="black" points="676.11,-8775.92 666.16,-8772.26 671.66,-8781.32 676.11,-8775.92"/>
</g>
<!-- layer9_gelu -->
<g id="node110" class="node">
<title>layer9_gelu</title>
<polygon fill="yellow" stroke="black" points="815.5,-8667.17 312.5,-8667.17 312.5,-8599.17 815.5,-8599.17 815.5,-8667.17"/>
<text text-anchor="middle" x="564" y="-8651.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="564" y="-8636.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="564" y="-8621.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="564" y="-8606.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer9_mlp1&#45;&gt;layer9_gelu -->
<g id="edge127" class="edge">
<title>layer9_mlp1&#45;&gt;layer9_gelu</title>
<path fill="none" stroke="black" d="M606.04,-8704.01C600.68,-8695.1 594.8,-8685.34 589.19,-8676.02"/>
<polygon fill="black" stroke="black" points="592.08,-8674.02 583.92,-8667.26 586.08,-8677.63 592.08,-8674.02"/>
</g>
<!-- layer9_mlp2 -->
<g id="node111" class="node">
<title>layer9_mlp2</title>
<polygon fill="yellow" stroke="black" points="773.5,-8562.17 282.5,-8562.17 282.5,-8494.17 773.5,-8494.17 773.5,-8562.17"/>
<text text-anchor="middle" x="528" y="-8546.97" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row&#45;Parallel)</text>
<text text-anchor="middle" x="528" y="-8531.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="528" y="-8516.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="528" y="-8501.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer9_gelu&#45;&gt;layer9_mlp2 -->
<g id="edge128" class="edge">
<title>layer9_gelu&#45;&gt;layer9_mlp2</title>
<path fill="none" stroke="black" d="M552.41,-8599.01C549.39,-8590.37 546.1,-8580.94 542.93,-8571.89"/>
<polygon fill="black" stroke="black" points="546.17,-8570.55 539.57,-8562.26 539.56,-8572.86 546.17,-8570.55"/>
</g>
<!-- layer9_mlp_ar -->
<g id="node112" class="node">
<title>layer9_mlp_ar</title>
<polygon fill="yellow" stroke="black" points="994.4,-8457.17 222.24,-8457.17 23.6,-8321.17 795.76,-8321.17 994.4,-8457.17"/>
<text text-anchor="middle" x="509" y="-8407.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="509" y="-8392.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-8377.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-8362.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer9_mlp2&#45;&gt;layer9_mlp_ar -->
<g id="edge129" class="edge">
<title>layer9_mlp2&#45;&gt;layer9_mlp_ar</title>
<path fill="none" stroke="black" d="M523.4,-8494C522.27,-8485.86 521.02,-8476.8 519.73,-8467.52"/>
<polygon fill="black" stroke="black" points="523.16,-8466.82 518.32,-8457.4 516.23,-8467.79 523.16,-8466.82"/>
</g>
<!-- layer9_mlp_ar&#45;&gt;layer9_res2 -->
<g id="edge131" class="edge">
<title>layer9_mlp_ar&#45;&gt;layer9_res2</title>
<path fill="none" stroke="black" d="M628.94,-8320.99C648.16,-8310.23 667.66,-8299.31 685.7,-8289.2"/>
<polygon fill="black" stroke="black" points="687.42,-8292.25 694.44,-8284.31 684,-8286.14 687.42,-8292.25"/>
</g>
<!-- layer10_ln1 -->
<g id="node114" class="node">
<title>layer10_ln1</title>
<polygon fill="yellow" stroke="black" points="960,-8143.17 492,-8143.17 492,-8075.17 960,-8075.17 960,-8143.17"/>
<text text-anchor="middle" x="726" y="-8127.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="726" y="-8112.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="726" y="-8097.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="726" y="-8082.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer9_res2&#45;&gt;layer10_ln1 -->
<g id="edge132" class="edge">
<title>layer9_res2&#45;&gt;layer10_ln1</title>
<path fill="none" stroke="black" d="M754.36,-8201.14C749.62,-8185.91 744.2,-8168.55 739.39,-8153.11"/>
<polygon fill="black" stroke="black" points="742.64,-8151.79 736.33,-8143.28 735.96,-8153.87 742.64,-8151.79"/>
</g>
<!-- layer10_res1 -->
<g id="node118" class="node">
<title>layer10_res1</title>
<polygon fill="yellow" stroke="black" points="1000,-7655.17 532,-7655.17 532,-7572.17 1000,-7572.17 1000,-7655.17"/>
<text text-anchor="middle" x="766" y="-7639.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="766" y="-7624.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-7609.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-7594.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-7579.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer9_res2&#45;&gt;layer10_res1 -->
<g id="edge136" class="edge">
<title>layer9_res2&#45;&gt;layer10_res1</title>
<path fill="none" stroke="black" d="M950.33,-8201.02C988.29,-8181.52 1017,-8152.71 1017,-8110.17 1017,-8110.17 1017,-8110.17 1017,-7759.17 1017,-7729.06 1026.49,-7715.12 1007,-7692.17 996.46,-7679.75 983.92,-7669.3 970.18,-7660.52"/>
<polygon fill="black" stroke="black" points="971.85,-7657.44 961.48,-7655.26 968.23,-7663.43 971.85,-7657.44"/>
</g>
<!-- layer10_qkv -->
<g id="node115" class="node">
<title>layer10_qkv</title>
<polygon fill="yellow" stroke="black" points="910.5,-8038.17 291.5,-8038.17 291.5,-7970.17 910.5,-7970.17 910.5,-8038.17"/>
<text text-anchor="middle" x="601" y="-8022.97" font-family="Times,serif" font-size="14.00">QKV Linear (Column&#45;Parallel)</text>
<text text-anchor="middle" x="601" y="-8007.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="601" y="-7992.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="601" y="-7977.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer10_ln1&#45;&gt;layer10_qkv -->
<g id="edge133" class="edge">
<title>layer10_ln1&#45;&gt;layer10_qkv</title>
<path fill="none" stroke="black" d="M685.76,-8075.01C674.05,-8065.36 661.14,-8054.72 649.01,-8044.72"/>
<polygon fill="black" stroke="black" points="651.11,-8041.92 641.16,-8038.26 646.66,-8047.32 651.11,-8041.92"/>
</g>
<!-- layer10_attn -->
<g id="node116" class="node">
<title>layer10_attn</title>
<polygon fill="yellow" stroke="black" points="849.5,-7933.17 242.5,-7933.17 242.5,-7865.17 849.5,-7865.17 849.5,-7933.17"/>
<text text-anchor="middle" x="546" y="-7917.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="546" y="-7902.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="546" y="-7887.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="546" y="-7872.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer10_qkv&#45;&gt;layer10_attn -->
<g id="edge134" class="edge">
<title>layer10_qkv&#45;&gt;layer10_attn</title>
<path fill="none" stroke="black" d="M583.29,-7970.01C578.58,-7961.19 573.43,-7951.54 568.5,-7942.31"/>
<polygon fill="black" stroke="black" points="571.47,-7940.43 563.67,-7933.26 565.29,-7943.73 571.47,-7940.43"/>
</g>
<!-- layer10_attn_ar -->
<g id="node117" class="node">
<title>layer10_attn_ar</title>
<polygon fill="yellow" stroke="black" points="998.4,-7828.17 226.24,-7828.17 27.6,-7692.17 799.76,-7692.17 998.4,-7828.17"/>
<text text-anchor="middle" x="513" y="-7778.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="513" y="-7763.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="513" y="-7748.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="513" y="-7733.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer10_attn&#45;&gt;layer10_attn_ar -->
<g id="edge135" class="edge">
<title>layer10_attn&#45;&gt;layer10_attn_ar</title>
<path fill="none" stroke="black" d="M538.01,-7865C536.03,-7856.77 533.82,-7847.61 531.56,-7838.23"/>
<polygon fill="black" stroke="black" points="534.94,-7837.3 529.19,-7828.4 528.13,-7838.94 534.94,-7837.3"/>
</g>
<!-- layer10_attn_ar&#45;&gt;layer10_res1 -->
<g id="edge137" class="edge">
<title>layer10_attn_ar&#45;&gt;layer10_res1</title>
<path fill="none" stroke="black" d="M630.61,-7691.99C649.29,-7681.32 668.23,-7670.51 685.79,-7660.48"/>
<polygon fill="black" stroke="black" points="687.89,-7663.31 694.84,-7655.31 684.42,-7657.23 687.89,-7663.31"/>
</g>
<!-- layer10_ln2 -->
<g id="node119" class="node">
<title>layer10_ln2</title>
<polygon fill="yellow" stroke="black" points="985,-7535.17 517,-7535.17 517,-7467.17 985,-7467.17 985,-7535.17"/>
<text text-anchor="middle" x="751" y="-7519.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="751" y="-7504.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="751" y="-7489.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="751" y="-7474.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer10_res1&#45;&gt;layer10_ln2 -->
<g id="edge138" class="edge">
<title>layer10_res1&#45;&gt;layer10_ln2</title>
<path fill="none" stroke="black" d="M760.5,-7572.15C759.32,-7563.47 758.07,-7554.27 756.88,-7545.49"/>
<polygon fill="black" stroke="black" points="760.33,-7544.88 755.52,-7535.44 753.39,-7545.82 760.33,-7544.88"/>
</g>
<!-- layer10_res2 -->
<g id="node124" class="node">
<title>layer10_res2</title>
<polygon fill="yellow" stroke="black" points="944,-6942.17 476,-6942.17 476,-6859.17 944,-6859.17 944,-6942.17"/>
<text text-anchor="middle" x="710" y="-6926.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="710" y="-6911.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="710" y="-6896.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="710" y="-6881.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="710" y="-6866.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer10_res1&#45;&gt;layer10_res2 -->
<g id="edge143" class="edge">
<title>layer10_res1&#45;&gt;layer10_res2</title>
<path fill="none" stroke="black" d="M971.66,-7572.02C996.33,-7555.87 1013,-7533.41 1013,-7502.17 1013,-7502.17 1013,-7502.17 1013,-7046.17 1013,-7016.06 1023.08,-7001.6 1003,-6979.17 991.51,-6966.33 966.73,-6954.99 936.21,-6945.22"/>
<polygon fill="black" stroke="black" points="937.15,-6941.85 926.56,-6942.24 935.08,-6948.54 937.15,-6941.85"/>
</g>
<!-- layer10_mlp1 -->
<g id="node120" class="node">
<title>layer10_mlp1</title>
<polygon fill="yellow" stroke="black" points="877.5,-7430.17 374.5,-7430.17 374.5,-7362.17 877.5,-7362.17 877.5,-7430.17"/>
<text text-anchor="middle" x="626" y="-7414.97" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column&#45;Parallel)</text>
<text text-anchor="middle" x="626" y="-7399.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="626" y="-7384.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="626" y="-7369.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer10_ln2&#45;&gt;layer10_mlp1 -->
<g id="edge139" class="edge">
<title>layer10_ln2&#45;&gt;layer10_mlp1</title>
<path fill="none" stroke="black" d="M710.76,-7467.01C699.05,-7457.36 686.14,-7446.72 674.01,-7436.72"/>
<polygon fill="black" stroke="black" points="676.11,-7433.92 666.16,-7430.26 671.66,-7439.32 676.11,-7433.92"/>
</g>
<!-- layer10_gelu -->
<g id="node121" class="node">
<title>layer10_gelu</title>
<polygon fill="yellow" stroke="black" points="815.5,-7325.17 312.5,-7325.17 312.5,-7257.17 815.5,-7257.17 815.5,-7325.17"/>
<text text-anchor="middle" x="564" y="-7309.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="564" y="-7294.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="564" y="-7279.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="564" y="-7264.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer10_mlp1&#45;&gt;layer10_gelu -->
<g id="edge140" class="edge">
<title>layer10_mlp1&#45;&gt;layer10_gelu</title>
<path fill="none" stroke="black" d="M606.04,-7362.01C600.68,-7353.1 594.8,-7343.34 589.19,-7334.02"/>
<polygon fill="black" stroke="black" points="592.08,-7332.02 583.92,-7325.26 586.08,-7335.63 592.08,-7332.02"/>
</g>
<!-- layer10_mlp2 -->
<g id="node122" class="node">
<title>layer10_mlp2</title>
<polygon fill="yellow" stroke="black" points="773.5,-7220.17 282.5,-7220.17 282.5,-7152.17 773.5,-7152.17 773.5,-7220.17"/>
<text text-anchor="middle" x="528" y="-7204.97" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row&#45;Parallel)</text>
<text text-anchor="middle" x="528" y="-7189.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="528" y="-7174.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="528" y="-7159.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer10_gelu&#45;&gt;layer10_mlp2 -->
<g id="edge141" class="edge">
<title>layer10_gelu&#45;&gt;layer10_mlp2</title>
<path fill="none" stroke="black" d="M552.41,-7257.01C549.39,-7248.37 546.1,-7238.94 542.93,-7229.89"/>
<polygon fill="black" stroke="black" points="546.17,-7228.55 539.57,-7220.26 539.56,-7230.86 546.17,-7228.55"/>
</g>
<!-- layer10_mlp_ar -->
<g id="node123" class="node">
<title>layer10_mlp_ar</title>
<polygon fill="yellow" stroke="black" points="994.4,-7115.17 222.24,-7115.17 23.6,-6979.17 795.76,-6979.17 994.4,-7115.17"/>
<text text-anchor="middle" x="509" y="-7065.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="509" y="-7050.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-7035.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-7020.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer10_mlp2&#45;&gt;layer10_mlp_ar -->
<g id="edge142" class="edge">
<title>layer10_mlp2&#45;&gt;layer10_mlp_ar</title>
<path fill="none" stroke="black" d="M523.4,-7152C522.27,-7143.86 521.02,-7134.8 519.73,-7125.52"/>
<polygon fill="black" stroke="black" points="523.16,-7124.82 518.32,-7115.4 516.23,-7125.79 523.16,-7124.82"/>
</g>
<!-- layer10_mlp_ar&#45;&gt;layer10_res2 -->
<g id="edge144" class="edge">
<title>layer10_mlp_ar&#45;&gt;layer10_res2</title>
<path fill="none" stroke="black" d="M602.44,-6978.99C616.87,-6968.62 631.5,-6958.1 645.12,-6948.31"/>
<polygon fill="black" stroke="black" points="647.39,-6950.99 653.47,-6942.31 643.3,-6945.3 647.39,-6950.99"/>
</g>
<!-- layer11_ln1 -->
<g id="node125" class="node">
<title>layer11_ln1</title>
<polygon fill="yellow" stroke="black" points="908,-6801.17 440,-6801.17 440,-6733.17 908,-6733.17 908,-6801.17"/>
<text text-anchor="middle" x="674" y="-6785.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="674" y="-6770.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="674" y="-6755.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="674" y="-6740.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer10_res2&#45;&gt;layer11_ln1 -->
<g id="edge145" class="edge">
<title>layer10_res2&#45;&gt;layer11_ln1</title>
<path fill="none" stroke="black" d="M698.91,-6859.14C694.74,-6843.91 689.98,-6826.55 685.76,-6811.11"/>
<polygon fill="black" stroke="black" points="689.08,-6810.01 683.07,-6801.28 682.33,-6811.85 689.08,-6810.01"/>
</g>
<!-- layer11_res1 -->
<g id="node129" class="node">
<title>layer11_res1</title>
<polygon fill="yellow" stroke="black" points="1000,-6313.17 532,-6313.17 532,-6230.17 1000,-6230.17 1000,-6313.17"/>
<text text-anchor="middle" x="766" y="-6297.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="766" y="-6282.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-6267.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-6252.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-6237.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer10_res2&#45;&gt;layer11_res1 -->
<g id="edge149" class="edge">
<title>layer10_res2&#45;&gt;layer11_res1</title>
<path fill="none" stroke="black" d="M944.25,-6865.17C986.27,-6845.54 1017,-6815.13 1017,-6768.17 1017,-6768.17 1017,-6768.17 1017,-6417.17 1017,-6387.06 1026.49,-6373.12 1007,-6350.17 996.46,-6337.75 983.92,-6327.3 970.18,-6318.52"/>
<polygon fill="black" stroke="black" points="971.85,-6315.44 961.48,-6313.26 968.23,-6321.43 971.85,-6315.44"/>
</g>
<!-- layer11_qkv -->
<g id="node126" class="node">
<title>layer11_qkv</title>
<polygon fill="yellow" stroke="black" points="910.5,-6696.17 291.5,-6696.17 291.5,-6628.17 910.5,-6628.17 910.5,-6696.17"/>
<text text-anchor="middle" x="601" y="-6680.97" font-family="Times,serif" font-size="14.00">QKV Linear (Column&#45;Parallel)</text>
<text text-anchor="middle" x="601" y="-6665.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="601" y="-6650.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="601" y="-6635.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer11_ln1&#45;&gt;layer11_qkv -->
<g id="edge146" class="edge">
<title>layer11_ln1&#45;&gt;layer11_qkv</title>
<path fill="none" stroke="black" d="M650.5,-6733.01C644.05,-6723.91 636.98,-6713.94 630.26,-6704.44"/>
<polygon fill="black" stroke="black" points="633.09,-6702.4 624.46,-6696.26 627.38,-6706.44 633.09,-6702.4"/>
</g>
<!-- layer11_attn -->
<g id="node127" class="node">
<title>layer11_attn</title>
<polygon fill="yellow" stroke="black" points="849.5,-6591.17 242.5,-6591.17 242.5,-6523.17 849.5,-6523.17 849.5,-6591.17"/>
<text text-anchor="middle" x="546" y="-6575.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="546" y="-6560.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="546" y="-6545.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="546" y="-6530.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer11_qkv&#45;&gt;layer11_attn -->
<g id="edge147" class="edge">
<title>layer11_qkv&#45;&gt;layer11_attn</title>
<path fill="none" stroke="black" d="M583.29,-6628.01C578.58,-6619.19 573.43,-6609.54 568.5,-6600.31"/>
<polygon fill="black" stroke="black" points="571.47,-6598.43 563.67,-6591.26 565.29,-6601.73 571.47,-6598.43"/>
</g>
<!-- layer11_attn_ar -->
<g id="node128" class="node">
<title>layer11_attn_ar</title>
<polygon fill="yellow" stroke="black" points="998.4,-6486.17 226.24,-6486.17 27.6,-6350.17 799.76,-6350.17 998.4,-6486.17"/>
<text text-anchor="middle" x="513" y="-6436.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="513" y="-6421.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="513" y="-6406.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="513" y="-6391.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer11_attn&#45;&gt;layer11_attn_ar -->
<g id="edge148" class="edge">
<title>layer11_attn&#45;&gt;layer11_attn_ar</title>
<path fill="none" stroke="black" d="M538.01,-6523C536.03,-6514.77 533.82,-6505.61 531.56,-6496.23"/>
<polygon fill="black" stroke="black" points="534.94,-6495.3 529.19,-6486.4 528.13,-6496.94 534.94,-6495.3"/>
</g>
<!-- layer11_attn_ar&#45;&gt;layer11_res1 -->
<g id="edge150" class="edge">
<title>layer11_attn_ar&#45;&gt;layer11_res1</title>
<path fill="none" stroke="black" d="M630.61,-6349.99C649.29,-6339.32 668.23,-6328.51 685.79,-6318.48"/>
<polygon fill="black" stroke="black" points="687.89,-6321.31 694.84,-6313.31 684.42,-6315.23 687.89,-6321.31"/>
</g>
<!-- layer11_ln2 -->
<g id="node130" class="node">
<title>layer11_ln2</title>
<polygon fill="yellow" stroke="black" points="985,-6193.17 517,-6193.17 517,-6125.17 985,-6125.17 985,-6193.17"/>
<text text-anchor="middle" x="751" y="-6177.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="751" y="-6162.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="751" y="-6147.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="751" y="-6132.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer11_res1&#45;&gt;layer11_ln2 -->
<g id="edge151" class="edge">
<title>layer11_res1&#45;&gt;layer11_ln2</title>
<path fill="none" stroke="black" d="M760.5,-6230.15C759.32,-6221.47 758.07,-6212.27 756.88,-6203.49"/>
<polygon fill="black" stroke="black" points="760.33,-6202.88 755.52,-6193.44 753.39,-6203.82 760.33,-6202.88"/>
</g>
<!-- layer11_res2 -->
<g id="node135" class="node">
<title>layer11_res2</title>
<polygon fill="yellow" stroke="black" points="987,-5600.17 519,-5600.17 519,-5517.17 987,-5517.17 987,-5600.17"/>
<text text-anchor="middle" x="753" y="-5584.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="753" y="-5569.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="753" y="-5554.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="753" y="-5539.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="753" y="-5524.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer11_res1&#45;&gt;layer11_res2 -->
<g id="edge156" class="edge">
<title>layer11_res1&#45;&gt;layer11_res2</title>
<path fill="none" stroke="black" d="M971.66,-6230.02C996.33,-6213.87 1013,-6191.41 1013,-6160.17 1013,-6160.17 1013,-6160.17 1013,-5704.17 1013,-5674.06 1022.61,-5660.02 1003,-5637.17 992.34,-5624.74 979.73,-5614.28 965.93,-5605.48"/>
<polygon fill="black" stroke="black" points="967.56,-5602.37 957.19,-5600.21 963.95,-5608.37 967.56,-5602.37"/>
</g>
<!-- layer11_mlp1 -->
<g id="node131" class="node">
<title>layer11_mlp1</title>
<polygon fill="yellow" stroke="black" points="877.5,-6088.17 374.5,-6088.17 374.5,-6020.17 877.5,-6020.17 877.5,-6088.17"/>
<text text-anchor="middle" x="626" y="-6072.97" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column&#45;Parallel)</text>
<text text-anchor="middle" x="626" y="-6057.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="626" y="-6042.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="626" y="-6027.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer11_ln2&#45;&gt;layer11_mlp1 -->
<g id="edge152" class="edge">
<title>layer11_ln2&#45;&gt;layer11_mlp1</title>
<path fill="none" stroke="black" d="M710.76,-6125.01C699.05,-6115.36 686.14,-6104.72 674.01,-6094.72"/>
<polygon fill="black" stroke="black" points="676.11,-6091.92 666.16,-6088.26 671.66,-6097.32 676.11,-6091.92"/>
</g>
<!-- layer11_gelu -->
<g id="node132" class="node">
<title>layer11_gelu</title>
<polygon fill="yellow" stroke="black" points="815.5,-5983.17 312.5,-5983.17 312.5,-5915.17 815.5,-5915.17 815.5,-5983.17"/>
<text text-anchor="middle" x="564" y="-5967.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="564" y="-5952.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="564" y="-5937.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="564" y="-5922.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer11_mlp1&#45;&gt;layer11_gelu -->
<g id="edge153" class="edge">
<title>layer11_mlp1&#45;&gt;layer11_gelu</title>
<path fill="none" stroke="black" d="M606.04,-6020.01C600.68,-6011.1 594.8,-6001.34 589.19,-5992.02"/>
<polygon fill="black" stroke="black" points="592.08,-5990.02 583.92,-5983.26 586.08,-5993.63 592.08,-5990.02"/>
</g>
<!-- layer11_mlp2 -->
<g id="node133" class="node">
<title>layer11_mlp2</title>
<polygon fill="yellow" stroke="black" points="773.5,-5878.17 282.5,-5878.17 282.5,-5810.17 773.5,-5810.17 773.5,-5878.17"/>
<text text-anchor="middle" x="528" y="-5862.97" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row&#45;Parallel)</text>
<text text-anchor="middle" x="528" y="-5847.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="528" y="-5832.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="528" y="-5817.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer11_gelu&#45;&gt;layer11_mlp2 -->
<g id="edge154" class="edge">
<title>layer11_gelu&#45;&gt;layer11_mlp2</title>
<path fill="none" stroke="black" d="M552.41,-5915.01C549.39,-5906.37 546.1,-5896.94 542.93,-5887.89"/>
<polygon fill="black" stroke="black" points="546.17,-5886.55 539.57,-5878.26 539.56,-5888.86 546.17,-5886.55"/>
</g>
<!-- layer11_mlp_ar -->
<g id="node134" class="node">
<title>layer11_mlp_ar</title>
<polygon fill="yellow" stroke="black" points="994.4,-5773.17 222.24,-5773.17 23.6,-5637.17 795.76,-5637.17 994.4,-5773.17"/>
<text text-anchor="middle" x="509" y="-5723.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="509" y="-5708.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-5693.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-5678.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer11_mlp2&#45;&gt;layer11_mlp_ar -->
<g id="edge155" class="edge">
<title>layer11_mlp2&#45;&gt;layer11_mlp_ar</title>
<path fill="none" stroke="black" d="M523.4,-5810C522.27,-5801.86 521.02,-5792.8 519.73,-5783.52"/>
<polygon fill="black" stroke="black" points="523.16,-5782.82 518.32,-5773.4 516.23,-5783.79 523.16,-5782.82"/>
</g>
<!-- layer11_mlp_ar&#45;&gt;layer11_res2 -->
<g id="edge157" class="edge">
<title>layer11_mlp_ar&#45;&gt;layer11_res2</title>
<path fill="none" stroke="black" d="M622.43,-5636.99C640.44,-5626.32 658.71,-5615.51 675.65,-5605.48"/>
<polygon fill="black" stroke="black" points="677.55,-5608.42 684.37,-5600.31 673.99,-5602.39 677.55,-5608.42"/>
</g>
<!-- layer12_ln1 -->
<g id="node136" class="node">
<title>layer12_ln1</title>
<polygon fill="yellow" stroke="black" points="960,-5459.17 492,-5459.17 492,-5391.17 960,-5391.17 960,-5459.17"/>
<text text-anchor="middle" x="726" y="-5443.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="726" y="-5428.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="726" y="-5413.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="726" y="-5398.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer11_res2&#45;&gt;layer12_ln1 -->
<g id="edge158" class="edge">
<title>layer11_res2&#45;&gt;layer12_ln1</title>
<path fill="none" stroke="black" d="M744.68,-5517.14C741.55,-5501.91 737.99,-5484.55 734.82,-5469.11"/>
<polygon fill="black" stroke="black" points="738.24,-5468.38 732.8,-5459.28 731.38,-5469.78 738.24,-5468.38"/>
</g>
<!-- layer12_res1 -->
<g id="node140" class="node">
<title>layer12_res1</title>
<polygon fill="yellow" stroke="black" points="1000,-4971.17 532,-4971.17 532,-4888.17 1000,-4888.17 1000,-4971.17"/>
<text text-anchor="middle" x="766" y="-4955.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="766" y="-4940.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-4925.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-4910.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-4895.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer11_res2&#45;&gt;layer12_res1 -->
<g id="edge162" class="edge">
<title>layer11_res2&#45;&gt;layer12_res1</title>
<path fill="none" stroke="black" d="M951.4,-5517.07C989.08,-5497.6 1017,-5468.79 1017,-5426.17 1017,-5426.17 1017,-5426.17 1017,-5075.17 1017,-5045.06 1026.49,-5031.12 1007,-5008.17 996.46,-4995.75 983.92,-4985.3 970.18,-4976.52"/>
<polygon fill="black" stroke="black" points="971.85,-4973.44 961.48,-4971.26 968.23,-4979.43 971.85,-4973.44"/>
</g>
<!-- layer12_qkv -->
<g id="node137" class="node">
<title>layer12_qkv</title>
<polygon fill="yellow" stroke="black" points="910.5,-5354.17 291.5,-5354.17 291.5,-5286.17 910.5,-5286.17 910.5,-5354.17"/>
<text text-anchor="middle" x="601" y="-5338.97" font-family="Times,serif" font-size="14.00">QKV Linear (Column&#45;Parallel)</text>
<text text-anchor="middle" x="601" y="-5323.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="601" y="-5308.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="601" y="-5293.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer12_ln1&#45;&gt;layer12_qkv -->
<g id="edge159" class="edge">
<title>layer12_ln1&#45;&gt;layer12_qkv</title>
<path fill="none" stroke="black" d="M685.76,-5391.01C674.05,-5381.36 661.14,-5370.72 649.01,-5360.72"/>
<polygon fill="black" stroke="black" points="651.11,-5357.92 641.16,-5354.26 646.66,-5363.32 651.11,-5357.92"/>
</g>
<!-- layer12_attn -->
<g id="node138" class="node">
<title>layer12_attn</title>
<polygon fill="yellow" stroke="black" points="849.5,-5249.17 242.5,-5249.17 242.5,-5181.17 849.5,-5181.17 849.5,-5249.17"/>
<text text-anchor="middle" x="546" y="-5233.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="546" y="-5218.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="546" y="-5203.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="546" y="-5188.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer12_qkv&#45;&gt;layer12_attn -->
<g id="edge160" class="edge">
<title>layer12_qkv&#45;&gt;layer12_attn</title>
<path fill="none" stroke="black" d="M583.29,-5286.01C578.58,-5277.19 573.43,-5267.54 568.5,-5258.31"/>
<polygon fill="black" stroke="black" points="571.47,-5256.43 563.67,-5249.26 565.29,-5259.73 571.47,-5256.43"/>
</g>
<!-- layer12_attn_ar -->
<g id="node139" class="node">
<title>layer12_attn_ar</title>
<polygon fill="yellow" stroke="black" points="998.4,-5144.17 226.24,-5144.17 27.6,-5008.17 799.76,-5008.17 998.4,-5144.17"/>
<text text-anchor="middle" x="513" y="-5094.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="513" y="-5079.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="513" y="-5064.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="513" y="-5049.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer12_attn&#45;&gt;layer12_attn_ar -->
<g id="edge161" class="edge">
<title>layer12_attn&#45;&gt;layer12_attn_ar</title>
<path fill="none" stroke="black" d="M538.01,-5181C536.03,-5172.77 533.82,-5163.61 531.56,-5154.23"/>
<polygon fill="black" stroke="black" points="534.94,-5153.3 529.19,-5144.4 528.13,-5154.94 534.94,-5153.3"/>
</g>
<!-- layer12_attn_ar&#45;&gt;layer12_res1 -->
<g id="edge163" class="edge">
<title>layer12_attn_ar&#45;&gt;layer12_res1</title>
<path fill="none" stroke="black" d="M630.61,-5007.99C649.29,-4997.32 668.23,-4986.51 685.79,-4976.48"/>
<polygon fill="black" stroke="black" points="687.89,-4979.31 694.84,-4971.31 684.42,-4973.23 687.89,-4979.31"/>
</g>
<!-- layer12_ln2 -->
<g id="node141" class="node">
<title>layer12_ln2</title>
<polygon fill="yellow" stroke="black" points="985,-4851.17 517,-4851.17 517,-4783.17 985,-4783.17 985,-4851.17"/>
<text text-anchor="middle" x="751" y="-4835.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="751" y="-4820.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="751" y="-4805.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="751" y="-4790.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer12_res1&#45;&gt;layer12_ln2 -->
<g id="edge164" class="edge">
<title>layer12_res1&#45;&gt;layer12_ln2</title>
<path fill="none" stroke="black" d="M760.5,-4888.15C759.32,-4879.47 758.07,-4870.27 756.88,-4861.49"/>
<polygon fill="black" stroke="black" points="760.33,-4860.88 755.52,-4851.44 753.39,-4861.82 760.33,-4860.88"/>
</g>
<!-- layer12_res2 -->
<g id="node146" class="node">
<title>layer12_res2</title>
<polygon fill="yellow" stroke="black" points="1004,-4258.17 536,-4258.17 536,-4175.17 1004,-4175.17 1004,-4258.17"/>
<text text-anchor="middle" x="770" y="-4242.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="770" y="-4227.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="770" y="-4212.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="770" y="-4197.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="770" y="-4182.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer12_res1&#45;&gt;layer12_res2 -->
<g id="edge169" class="edge">
<title>layer12_res1&#45;&gt;layer12_res2</title>
<path fill="none" stroke="black" d="M971.66,-4888.02C996.33,-4871.87 1013,-4849.41 1013,-4818.17 1013,-4818.17 1013,-4818.17 1013,-4362.17 1013,-4332.06 1022.37,-4318.21 1003,-4295.17 992.55,-4282.73 980.05,-4272.29 966.35,-4263.51"/>
<polygon fill="black" stroke="black" points="968.03,-4260.44 957.66,-4258.25 964.41,-4266.42 968.03,-4260.44"/>
</g>
<!-- layer12_mlp1 -->
<g id="node142" class="node">
<title>layer12_mlp1</title>
<polygon fill="yellow" stroke="black" points="993.5,-4746.17 490.5,-4746.17 490.5,-4678.17 993.5,-4678.17 993.5,-4746.17"/>
<text text-anchor="middle" x="742" y="-4730.97" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column&#45;Parallel)</text>
<text text-anchor="middle" x="742" y="-4715.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="742" y="-4700.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="742" y="-4685.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer12_ln2&#45;&gt;layer12_mlp1 -->
<g id="edge165" class="edge">
<title>layer12_ln2&#45;&gt;layer12_mlp1</title>
<path fill="none" stroke="black" d="M748.1,-4783.01C747.36,-4774.56 746.56,-4765.34 745.78,-4756.47"/>
<polygon fill="black" stroke="black" points="749.25,-4755.92 744.89,-4746.26 742.28,-4756.53 749.25,-4755.92"/>
</g>
<!-- layer12_gelu -->
<g id="node143" class="node">
<title>layer12_gelu</title>
<polygon fill="yellow" stroke="black" points="877.5,-4641.17 374.5,-4641.17 374.5,-4573.17 877.5,-4573.17 877.5,-4641.17"/>
<text text-anchor="middle" x="626" y="-4625.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="626" y="-4610.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="626" y="-4595.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="626" y="-4580.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer12_mlp1&#45;&gt;layer12_gelu -->
<g id="edge166" class="edge">
<title>layer12_mlp1&#45;&gt;layer12_gelu</title>
<path fill="none" stroke="black" d="M704.66,-4678.01C693.9,-4668.45 682.04,-4657.93 670.87,-4648.01"/>
<polygon fill="black" stroke="black" points="673.07,-4645.28 663.27,-4641.26 668.43,-4650.52 673.07,-4645.28"/>
</g>
<!-- layer12_mlp2 -->
<g id="node144" class="node">
<title>layer12_mlp2</title>
<polygon fill="yellow" stroke="black" points="841.5,-4536.17 350.5,-4536.17 350.5,-4468.17 841.5,-4468.17 841.5,-4536.17"/>
<text text-anchor="middle" x="596" y="-4520.97" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row&#45;Parallel)</text>
<text text-anchor="middle" x="596" y="-4505.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="596" y="-4490.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="596" y="-4475.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer12_gelu&#45;&gt;layer12_mlp2 -->
<g id="edge167" class="edge">
<title>layer12_gelu&#45;&gt;layer12_mlp2</title>
<path fill="none" stroke="black" d="M616.34,-4573.01C613.83,-4564.37 611.08,-4554.94 608.44,-4545.89"/>
<polygon fill="black" stroke="black" points="611.8,-4544.88 605.64,-4536.26 605.08,-4546.84 611.8,-4544.88"/>
</g>
<!-- layer12_mlp_ar -->
<g id="node145" class="node">
<title>layer12_mlp_ar</title>
<polygon fill="yellow" stroke="black" points="994.4,-4431.17 222.24,-4431.17 23.6,-4295.17 795.76,-4295.17 994.4,-4431.17"/>
<text text-anchor="middle" x="509" y="-4381.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="509" y="-4366.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-4351.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-4336.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer12_mlp2&#45;&gt;layer12_mlp_ar -->
<g id="edge168" class="edge">
<title>layer12_mlp2&#45;&gt;layer12_mlp_ar</title>
<path fill="none" stroke="black" d="M574.94,-4468C569.49,-4459.43 563.4,-4449.84 557.18,-4440.04"/>
<polygon fill="black" stroke="black" points="560.01,-4437.97 551.7,-4431.4 554.1,-4441.72 560.01,-4437.97"/>
</g>
<!-- layer12_mlp_ar&#45;&gt;layer12_res2 -->
<g id="edge170" class="edge">
<title>layer12_mlp_ar&#45;&gt;layer12_res2</title>
<path fill="none" stroke="black" d="M630.33,-4294.99C649.78,-4284.23 669.5,-4273.31 687.76,-4263.2"/>
<polygon fill="black" stroke="black" points="689.54,-4266.21 696.59,-4258.31 686.15,-4260.09 689.54,-4266.21"/>
</g>
<!-- layer13_ln1 -->
<g id="node147" class="node">
<title>layer13_ln1</title>
<polygon fill="yellow" stroke="black" points="960,-4117.17 492,-4117.17 492,-4049.17 960,-4049.17 960,-4117.17"/>
<text text-anchor="middle" x="726" y="-4101.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="726" y="-4086.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="726" y="-4071.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="726" y="-4056.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer12_res2&#45;&gt;layer13_ln1 -->
<g id="edge171" class="edge">
<title>layer12_res2&#45;&gt;layer13_ln1</title>
<path fill="none" stroke="black" d="M756.44,-4175.14C751.34,-4159.91 745.54,-4142.55 740.37,-4127.11"/>
<polygon fill="black" stroke="black" points="743.57,-4125.66 737.08,-4117.28 736.94,-4127.88 743.57,-4125.66"/>
</g>
<!-- layer13_res1 -->
<g id="node151" class="node">
<title>layer13_res1</title>
<polygon fill="yellow" stroke="black" points="1000,-3629.17 532,-3629.17 532,-3546.17 1000,-3546.17 1000,-3629.17"/>
<text text-anchor="middle" x="766" y="-3613.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="766" y="-3598.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-3583.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-3568.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-3553.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer12_res2&#45;&gt;layer13_res1 -->
<g id="edge175" class="edge">
<title>layer12_res2&#45;&gt;layer13_res1</title>
<path fill="none" stroke="black" d="M950.16,-4175C988.14,-4155.49 1017,-4126.67 1017,-4084.17 1017,-4084.17 1017,-4084.17 1017,-3733.17 1017,-3703.06 1026.49,-3689.12 1007,-3666.17 996.46,-3653.75 983.92,-3643.3 970.18,-3634.52"/>
<polygon fill="black" stroke="black" points="971.85,-3631.44 961.48,-3629.26 968.23,-3637.43 971.85,-3631.44"/>
</g>
<!-- layer13_qkv -->
<g id="node148" class="node">
<title>layer13_qkv</title>
<polygon fill="yellow" stroke="black" points="910.5,-4012.17 291.5,-4012.17 291.5,-3944.17 910.5,-3944.17 910.5,-4012.17"/>
<text text-anchor="middle" x="601" y="-3996.97" font-family="Times,serif" font-size="14.00">QKV Linear (Column&#45;Parallel)</text>
<text text-anchor="middle" x="601" y="-3981.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="601" y="-3966.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="601" y="-3951.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer13_ln1&#45;&gt;layer13_qkv -->
<g id="edge172" class="edge">
<title>layer13_ln1&#45;&gt;layer13_qkv</title>
<path fill="none" stroke="black" d="M685.76,-4049.01C674.05,-4039.36 661.14,-4028.72 649.01,-4018.72"/>
<polygon fill="black" stroke="black" points="651.11,-4015.92 641.16,-4012.26 646.66,-4021.32 651.11,-4015.92"/>
</g>
<!-- layer13_attn -->
<g id="node149" class="node">
<title>layer13_attn</title>
<polygon fill="yellow" stroke="black" points="849.5,-3907.17 242.5,-3907.17 242.5,-3839.17 849.5,-3839.17 849.5,-3907.17"/>
<text text-anchor="middle" x="546" y="-3891.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="546" y="-3876.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="546" y="-3861.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="546" y="-3846.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer13_qkv&#45;&gt;layer13_attn -->
<g id="edge173" class="edge">
<title>layer13_qkv&#45;&gt;layer13_attn</title>
<path fill="none" stroke="black" d="M583.29,-3944.01C578.58,-3935.19 573.43,-3925.54 568.5,-3916.31"/>
<polygon fill="black" stroke="black" points="571.47,-3914.43 563.67,-3907.26 565.29,-3917.73 571.47,-3914.43"/>
</g>
<!-- layer13_attn_ar -->
<g id="node150" class="node">
<title>layer13_attn_ar</title>
<polygon fill="yellow" stroke="black" points="998.4,-3802.17 226.24,-3802.17 27.6,-3666.17 799.76,-3666.17 998.4,-3802.17"/>
<text text-anchor="middle" x="513" y="-3752.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="513" y="-3737.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="513" y="-3722.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="513" y="-3707.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer13_attn&#45;&gt;layer13_attn_ar -->
<g id="edge174" class="edge">
<title>layer13_attn&#45;&gt;layer13_attn_ar</title>
<path fill="none" stroke="black" d="M538.01,-3839C536.03,-3830.77 533.82,-3821.61 531.56,-3812.23"/>
<polygon fill="black" stroke="black" points="534.94,-3811.3 529.19,-3802.4 528.13,-3812.94 534.94,-3811.3"/>
</g>
<!-- layer13_attn_ar&#45;&gt;layer13_res1 -->
<g id="edge176" class="edge">
<title>layer13_attn_ar&#45;&gt;layer13_res1</title>
<path fill="none" stroke="black" d="M630.61,-3665.99C649.29,-3655.32 668.23,-3644.51 685.79,-3634.48"/>
<polygon fill="black" stroke="black" points="687.89,-3637.31 694.84,-3629.31 684.42,-3631.23 687.89,-3637.31"/>
</g>
<!-- layer13_ln2 -->
<g id="node152" class="node">
<title>layer13_ln2</title>
<polygon fill="yellow" stroke="black" points="985,-3509.17 517,-3509.17 517,-3441.17 985,-3441.17 985,-3509.17"/>
<text text-anchor="middle" x="751" y="-3493.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="751" y="-3478.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="751" y="-3463.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="751" y="-3448.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer13_res1&#45;&gt;layer13_ln2 -->
<g id="edge177" class="edge">
<title>layer13_res1&#45;&gt;layer13_ln2</title>
<path fill="none" stroke="black" d="M760.5,-3546.15C759.32,-3537.47 758.07,-3528.27 756.88,-3519.49"/>
<polygon fill="black" stroke="black" points="760.33,-3518.88 755.52,-3509.44 753.39,-3519.82 760.33,-3518.88"/>
</g>
<!-- layer13_res2 -->
<g id="node157" class="node">
<title>layer13_res2</title>
<polygon fill="yellow" stroke="black" points="987,-2916.17 519,-2916.17 519,-2833.17 987,-2833.17 987,-2916.17"/>
<text text-anchor="middle" x="753" y="-2900.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="753" y="-2885.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="753" y="-2870.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="753" y="-2855.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="753" y="-2840.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer13_res1&#45;&gt;layer13_res2 -->
<g id="edge182" class="edge">
<title>layer13_res1&#45;&gt;layer13_res2</title>
<path fill="none" stroke="black" d="M971.66,-3546.02C996.33,-3529.87 1013,-3507.41 1013,-3476.17 1013,-3476.17 1013,-3476.17 1013,-3020.17 1013,-2990.06 1022.61,-2976.02 1003,-2953.17 992.34,-2940.74 979.73,-2930.28 965.93,-2921.48"/>
<polygon fill="black" stroke="black" points="967.56,-2918.37 957.19,-2916.21 963.95,-2924.37 967.56,-2918.37"/>
</g>
<!-- layer13_mlp1 -->
<g id="node153" class="node">
<title>layer13_mlp1</title>
<polygon fill="yellow" stroke="black" points="877.5,-3404.17 374.5,-3404.17 374.5,-3336.17 877.5,-3336.17 877.5,-3404.17"/>
<text text-anchor="middle" x="626" y="-3388.97" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column&#45;Parallel)</text>
<text text-anchor="middle" x="626" y="-3373.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="626" y="-3358.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="626" y="-3343.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer13_ln2&#45;&gt;layer13_mlp1 -->
<g id="edge178" class="edge">
<title>layer13_ln2&#45;&gt;layer13_mlp1</title>
<path fill="none" stroke="black" d="M710.76,-3441.01C699.05,-3431.36 686.14,-3420.72 674.01,-3410.72"/>
<polygon fill="black" stroke="black" points="676.11,-3407.92 666.16,-3404.26 671.66,-3413.32 676.11,-3407.92"/>
</g>
<!-- layer13_gelu -->
<g id="node154" class="node">
<title>layer13_gelu</title>
<polygon fill="yellow" stroke="black" points="815.5,-3299.17 312.5,-3299.17 312.5,-3231.17 815.5,-3231.17 815.5,-3299.17"/>
<text text-anchor="middle" x="564" y="-3283.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="564" y="-3268.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="564" y="-3253.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="564" y="-3238.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer13_mlp1&#45;&gt;layer13_gelu -->
<g id="edge179" class="edge">
<title>layer13_mlp1&#45;&gt;layer13_gelu</title>
<path fill="none" stroke="black" d="M606.04,-3336.01C600.68,-3327.1 594.8,-3317.34 589.19,-3308.02"/>
<polygon fill="black" stroke="black" points="592.08,-3306.02 583.92,-3299.26 586.08,-3309.63 592.08,-3306.02"/>
</g>
<!-- layer13_mlp2 -->
<g id="node155" class="node">
<title>layer13_mlp2</title>
<polygon fill="yellow" stroke="black" points="773.5,-3194.17 282.5,-3194.17 282.5,-3126.17 773.5,-3126.17 773.5,-3194.17"/>
<text text-anchor="middle" x="528" y="-3178.97" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row&#45;Parallel)</text>
<text text-anchor="middle" x="528" y="-3163.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="528" y="-3148.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="528" y="-3133.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer13_gelu&#45;&gt;layer13_mlp2 -->
<g id="edge180" class="edge">
<title>layer13_gelu&#45;&gt;layer13_mlp2</title>
<path fill="none" stroke="black" d="M552.41,-3231.01C549.39,-3222.37 546.1,-3212.94 542.93,-3203.89"/>
<polygon fill="black" stroke="black" points="546.17,-3202.55 539.57,-3194.26 539.56,-3204.86 546.17,-3202.55"/>
</g>
<!-- layer13_mlp_ar -->
<g id="node156" class="node">
<title>layer13_mlp_ar</title>
<polygon fill="yellow" stroke="black" points="994.4,-3089.17 222.24,-3089.17 23.6,-2953.17 795.76,-2953.17 994.4,-3089.17"/>
<text text-anchor="middle" x="509" y="-3039.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="509" y="-3024.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-3009.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-2994.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer13_mlp2&#45;&gt;layer13_mlp_ar -->
<g id="edge181" class="edge">
<title>layer13_mlp2&#45;&gt;layer13_mlp_ar</title>
<path fill="none" stroke="black" d="M523.4,-3126C522.27,-3117.86 521.02,-3108.8 519.73,-3099.52"/>
<polygon fill="black" stroke="black" points="523.16,-3098.82 518.32,-3089.4 516.23,-3099.79 523.16,-3098.82"/>
</g>
<!-- layer13_mlp_ar&#45;&gt;layer13_res2 -->
<g id="edge183" class="edge">
<title>layer13_mlp_ar&#45;&gt;layer13_res2</title>
<path fill="none" stroke="black" d="M622.43,-2952.99C640.44,-2942.32 658.71,-2931.51 675.65,-2921.48"/>
<polygon fill="black" stroke="black" points="677.55,-2924.42 684.37,-2916.31 673.99,-2918.39 677.55,-2924.42"/>
</g>
<!-- layer14_ln1 -->
<g id="node158" class="node">
<title>layer14_ln1</title>
<polygon fill="yellow" stroke="black" points="960,-2775.17 492,-2775.17 492,-2707.17 960,-2707.17 960,-2775.17"/>
<text text-anchor="middle" x="726" y="-2759.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="726" y="-2744.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="726" y="-2729.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="726" y="-2714.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer13_res2&#45;&gt;layer14_ln1 -->
<g id="edge184" class="edge">
<title>layer13_res2&#45;&gt;layer14_ln1</title>
<path fill="none" stroke="black" d="M744.68,-2833.14C741.55,-2817.91 737.99,-2800.55 734.82,-2785.11"/>
<polygon fill="black" stroke="black" points="738.24,-2784.38 732.8,-2775.28 731.38,-2785.78 738.24,-2784.38"/>
</g>
<!-- layer14_res1 -->
<g id="node162" class="node">
<title>layer14_res1</title>
<polygon fill="yellow" stroke="black" points="1000,-2287.17 532,-2287.17 532,-2204.17 1000,-2204.17 1000,-2287.17"/>
<text text-anchor="middle" x="766" y="-2271.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="766" y="-2256.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-2241.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-2226.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-2211.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer13_res2&#45;&gt;layer14_res1 -->
<g id="edge188" class="edge">
<title>layer13_res2&#45;&gt;layer14_res1</title>
<path fill="none" stroke="black" d="M951.4,-2833.07C989.08,-2813.6 1017,-2784.79 1017,-2742.17 1017,-2742.17 1017,-2742.17 1017,-2391.17 1017,-2361.06 1026.49,-2347.12 1007,-2324.17 996.46,-2311.75 983.92,-2301.3 970.18,-2292.52"/>
<polygon fill="black" stroke="black" points="971.85,-2289.44 961.48,-2287.26 968.23,-2295.43 971.85,-2289.44"/>
</g>
<!-- layer14_qkv -->
<g id="node159" class="node">
<title>layer14_qkv</title>
<polygon fill="yellow" stroke="black" points="910.5,-2670.17 291.5,-2670.17 291.5,-2602.17 910.5,-2602.17 910.5,-2670.17"/>
<text text-anchor="middle" x="601" y="-2654.97" font-family="Times,serif" font-size="14.00">QKV Linear (Column&#45;Parallel)</text>
<text text-anchor="middle" x="601" y="-2639.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="601" y="-2624.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="601" y="-2609.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer14_ln1&#45;&gt;layer14_qkv -->
<g id="edge185" class="edge">
<title>layer14_ln1&#45;&gt;layer14_qkv</title>
<path fill="none" stroke="black" d="M685.76,-2707.01C674.05,-2697.36 661.14,-2686.72 649.01,-2676.72"/>
<polygon fill="black" stroke="black" points="651.11,-2673.92 641.16,-2670.26 646.66,-2679.32 651.11,-2673.92"/>
</g>
<!-- layer14_attn -->
<g id="node160" class="node">
<title>layer14_attn</title>
<polygon fill="yellow" stroke="black" points="882.5,-2565.17 275.5,-2565.17 275.5,-2497.17 882.5,-2497.17 882.5,-2565.17"/>
<text text-anchor="middle" x="579" y="-2549.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="579" y="-2534.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="579" y="-2519.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="579" y="-2504.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer14_qkv&#45;&gt;layer14_attn -->
<g id="edge186" class="edge">
<title>layer14_qkv&#45;&gt;layer14_attn</title>
<path fill="none" stroke="black" d="M593.92,-2602.01C592.09,-2593.46 590.1,-2584.14 588.19,-2575.18"/>
<polygon fill="black" stroke="black" points="591.58,-2574.31 586.07,-2565.26 584.73,-2575.77 591.58,-2574.31"/>
</g>
<!-- layer14_attn_ar -->
<g id="node161" class="node">
<title>layer14_attn_ar</title>
<polygon fill="yellow" stroke="black" points="998.4,-2460.17 226.24,-2460.17 27.6,-2324.17 799.76,-2324.17 998.4,-2460.17"/>
<text text-anchor="middle" x="513" y="-2410.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="513" y="-2395.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="513" y="-2380.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="513" y="-2365.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer14_attn&#45;&gt;layer14_attn_ar -->
<g id="edge187" class="edge">
<title>layer14_attn&#45;&gt;layer14_attn_ar</title>
<path fill="none" stroke="black" d="M563.02,-2497C558.98,-2488.6 554.46,-2479.22 549.84,-2469.63"/>
<polygon fill="black" stroke="black" points="552.88,-2467.89 545.39,-2460.4 546.58,-2470.93 552.88,-2467.89"/>
</g>
<!-- layer14_attn_ar&#45;&gt;layer14_res1 -->
<g id="edge189" class="edge">
<title>layer14_attn_ar&#45;&gt;layer14_res1</title>
<path fill="none" stroke="black" d="M630.61,-2323.99C649.29,-2313.32 668.23,-2302.51 685.79,-2292.48"/>
<polygon fill="black" stroke="black" points="687.89,-2295.31 694.84,-2287.31 684.42,-2289.23 687.89,-2295.31"/>
</g>
<!-- layer14_ln2 -->
<g id="node163" class="node">
<title>layer14_ln2</title>
<polygon fill="yellow" stroke="black" points="985,-2167.17 517,-2167.17 517,-2099.17 985,-2099.17 985,-2167.17"/>
<text text-anchor="middle" x="751" y="-2151.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="751" y="-2136.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="751" y="-2121.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="751" y="-2106.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer14_res1&#45;&gt;layer14_ln2 -->
<g id="edge190" class="edge">
<title>layer14_res1&#45;&gt;layer14_ln2</title>
<path fill="none" stroke="black" d="M760.5,-2204.15C759.32,-2195.47 758.07,-2186.27 756.88,-2177.49"/>
<polygon fill="black" stroke="black" points="760.33,-2176.88 755.52,-2167.44 753.39,-2177.82 760.33,-2176.88"/>
</g>
<!-- layer14_res2 -->
<g id="node168" class="node">
<title>layer14_res2</title>
<polygon fill="yellow" stroke="black" points="985,-1574.17 517,-1574.17 517,-1491.17 985,-1491.17 985,-1574.17"/>
<text text-anchor="middle" x="751" y="-1558.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="751" y="-1543.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="751" y="-1528.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="751" y="-1513.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="751" y="-1498.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer14_res1&#45;&gt;layer14_res2 -->
<g id="edge195" class="edge">
<title>layer14_res1&#45;&gt;layer14_res2</title>
<path fill="none" stroke="black" d="M971.66,-2204.02C996.33,-2187.87 1013,-2165.41 1013,-2134.17 1013,-2134.17 1013,-2134.17 1013,-1678.17 1013,-1648.06 1022.63,-1633.99 1003,-1611.17 992.31,-1598.74 979.68,-1588.27 965.86,-1579.46"/>
<polygon fill="black" stroke="black" points="967.48,-1576.35 957.11,-1574.18 963.86,-1582.34 967.48,-1576.35"/>
</g>
<!-- layer14_mlp1 -->
<g id="node164" class="node">
<title>layer14_mlp1</title>
<polygon fill="yellow" stroke="black" points="877.5,-2062.17 374.5,-2062.17 374.5,-1994.17 877.5,-1994.17 877.5,-2062.17"/>
<text text-anchor="middle" x="626" y="-2046.97" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column&#45;Parallel)</text>
<text text-anchor="middle" x="626" y="-2031.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="626" y="-2016.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="626" y="-2001.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer14_ln2&#45;&gt;layer14_mlp1 -->
<g id="edge191" class="edge">
<title>layer14_ln2&#45;&gt;layer14_mlp1</title>
<path fill="none" stroke="black" d="M710.76,-2099.01C699.05,-2089.36 686.14,-2078.72 674.01,-2068.72"/>
<polygon fill="black" stroke="black" points="676.11,-2065.92 666.16,-2062.26 671.66,-2071.32 676.11,-2065.92"/>
</g>
<!-- layer14_gelu -->
<g id="node165" class="node">
<title>layer14_gelu</title>
<polygon fill="yellow" stroke="black" points="815.5,-1957.17 312.5,-1957.17 312.5,-1889.17 815.5,-1889.17 815.5,-1957.17"/>
<text text-anchor="middle" x="564" y="-1941.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="564" y="-1926.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="564" y="-1911.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="564" y="-1896.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer14_mlp1&#45;&gt;layer14_gelu -->
<g id="edge192" class="edge">
<title>layer14_mlp1&#45;&gt;layer14_gelu</title>
<path fill="none" stroke="black" d="M606.04,-1994.01C600.68,-1985.1 594.8,-1975.34 589.19,-1966.02"/>
<polygon fill="black" stroke="black" points="592.08,-1964.02 583.92,-1957.26 586.08,-1967.63 592.08,-1964.02"/>
</g>
<!-- layer14_mlp2 -->
<g id="node166" class="node">
<title>layer14_mlp2</title>
<polygon fill="yellow" stroke="black" points="773.5,-1852.17 282.5,-1852.17 282.5,-1784.17 773.5,-1784.17 773.5,-1852.17"/>
<text text-anchor="middle" x="528" y="-1836.97" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row&#45;Parallel)</text>
<text text-anchor="middle" x="528" y="-1821.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="528" y="-1806.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="528" y="-1791.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer14_gelu&#45;&gt;layer14_mlp2 -->
<g id="edge193" class="edge">
<title>layer14_gelu&#45;&gt;layer14_mlp2</title>
<path fill="none" stroke="black" d="M552.41,-1889.01C549.39,-1880.37 546.1,-1870.94 542.93,-1861.89"/>
<polygon fill="black" stroke="black" points="546.17,-1860.55 539.57,-1852.26 539.56,-1862.86 546.17,-1860.55"/>
</g>
<!-- layer14_mlp_ar -->
<g id="node167" class="node">
<title>layer14_mlp_ar</title>
<polygon fill="yellow" stroke="black" points="994.4,-1747.17 222.24,-1747.17 23.6,-1611.17 795.76,-1611.17 994.4,-1747.17"/>
<text text-anchor="middle" x="509" y="-1697.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="509" y="-1682.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-1667.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-1652.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer14_mlp2&#45;&gt;layer14_mlp_ar -->
<g id="edge194" class="edge">
<title>layer14_mlp2&#45;&gt;layer14_mlp_ar</title>
<path fill="none" stroke="black" d="M523.4,-1784C522.27,-1775.86 521.02,-1766.8 519.73,-1757.52"/>
<polygon fill="black" stroke="black" points="523.16,-1756.82 518.32,-1747.4 516.23,-1757.79 523.16,-1756.82"/>
</g>
<!-- layer14_mlp_ar&#45;&gt;layer14_res2 -->
<g id="edge196" class="edge">
<title>layer14_mlp_ar&#45;&gt;layer14_res2</title>
<path fill="none" stroke="black" d="M621.5,-1610.99C639.37,-1600.32 657.48,-1589.51 674.28,-1579.48"/>
<polygon fill="black" stroke="black" points="676.14,-1582.44 682.94,-1574.31 672.56,-1576.43 676.14,-1582.44"/>
</g>
<!-- layer15_ln1 -->
<g id="node169" class="node">
<title>layer15_ln1</title>
<polygon fill="yellow" stroke="black" points="960,-1433.17 492,-1433.17 492,-1365.17 960,-1365.17 960,-1433.17"/>
<text text-anchor="middle" x="726" y="-1417.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="726" y="-1402.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="726" y="-1387.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="726" y="-1372.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer14_res2&#45;&gt;layer15_ln1 -->
<g id="edge197" class="edge">
<title>layer14_res2&#45;&gt;layer15_ln1</title>
<path fill="none" stroke="black" d="M743.3,-1491.14C740.4,-1475.91 737.1,-1458.55 734.16,-1443.11"/>
<polygon fill="black" stroke="black" points="737.6,-1442.45 732.3,-1433.28 730.73,-1443.76 737.6,-1442.45"/>
</g>
<!-- layer15_res1 -->
<g id="node173" class="node">
<title>layer15_res1</title>
<polygon fill="yellow" stroke="black" points="1000,-945.17 532,-945.17 532,-862.17 1000,-862.17 1000,-945.17"/>
<text text-anchor="middle" x="766" y="-929.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="766" y="-914.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-899.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-884.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="766" y="-869.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer14_res2&#45;&gt;layer15_res1 -->
<g id="edge201" class="edge">
<title>layer14_res2&#45;&gt;layer15_res1</title>
<path fill="none" stroke="black" d="M951.59,-1491.08C989.21,-1471.61 1017,-1442.8 1017,-1400.17 1017,-1400.17 1017,-1400.17 1017,-1049.17 1017,-1019.06 1026.49,-1005.12 1007,-982.17 996.46,-969.75 983.92,-959.3 970.18,-950.52"/>
<polygon fill="black" stroke="black" points="971.85,-947.44 961.48,-945.26 968.23,-953.43 971.85,-947.44"/>
</g>
<!-- layer15_qkv -->
<g id="node170" class="node">
<title>layer15_qkv</title>
<polygon fill="yellow" stroke="black" points="910.5,-1328.17 291.5,-1328.17 291.5,-1260.17 910.5,-1260.17 910.5,-1328.17"/>
<text text-anchor="middle" x="601" y="-1312.97" font-family="Times,serif" font-size="14.00">QKV Linear (Column&#45;Parallel)</text>
<text text-anchor="middle" x="601" y="-1297.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="601" y="-1282.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="601" y="-1267.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer15_ln1&#45;&gt;layer15_qkv -->
<g id="edge198" class="edge">
<title>layer15_ln1&#45;&gt;layer15_qkv</title>
<path fill="none" stroke="black" d="M685.76,-1365.01C674.05,-1355.36 661.14,-1344.72 649.01,-1334.72"/>
<polygon fill="black" stroke="black" points="651.11,-1331.92 641.16,-1328.26 646.66,-1337.32 651.11,-1331.92"/>
</g>
<!-- layer15_attn -->
<g id="node171" class="node">
<title>layer15_attn</title>
<polygon fill="yellow" stroke="black" points="849.5,-1223.17 242.5,-1223.17 242.5,-1155.17 849.5,-1155.17 849.5,-1223.17"/>
<text text-anchor="middle" x="546" y="-1207.97" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="546" y="-1192.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="546" y="-1177.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="546" y="-1162.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer15_qkv&#45;&gt;layer15_attn -->
<g id="edge199" class="edge">
<title>layer15_qkv&#45;&gt;layer15_attn</title>
<path fill="none" stroke="black" d="M583.29,-1260.01C578.58,-1251.19 573.43,-1241.54 568.5,-1232.31"/>
<polygon fill="black" stroke="black" points="571.47,-1230.43 563.67,-1223.26 565.29,-1233.73 571.47,-1230.43"/>
</g>
<!-- layer15_attn_ar -->
<g id="node172" class="node">
<title>layer15_attn_ar</title>
<polygon fill="yellow" stroke="black" points="998.4,-1118.17 226.24,-1118.17 27.6,-982.17 799.76,-982.17 998.4,-1118.17"/>
<text text-anchor="middle" x="513" y="-1068.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="513" y="-1053.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="513" y="-1038.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="513" y="-1023.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer15_attn&#45;&gt;layer15_attn_ar -->
<g id="edge200" class="edge">
<title>layer15_attn&#45;&gt;layer15_attn_ar</title>
<path fill="none" stroke="black" d="M538.01,-1155C536.03,-1146.77 533.82,-1137.61 531.56,-1128.23"/>
<polygon fill="black" stroke="black" points="534.94,-1127.3 529.19,-1118.4 528.13,-1128.94 534.94,-1127.3"/>
</g>
<!-- layer15_attn_ar&#45;&gt;layer15_res1 -->
<g id="edge202" class="edge">
<title>layer15_attn_ar&#45;&gt;layer15_res1</title>
<path fill="none" stroke="black" d="M630.61,-981.99C649.29,-971.32 668.23,-960.51 685.79,-950.48"/>
<polygon fill="black" stroke="black" points="687.89,-953.31 694.84,-945.31 684.42,-947.23 687.89,-953.31"/>
</g>
<!-- layer15_ln2 -->
<g id="node174" class="node">
<title>layer15_ln2</title>
<polygon fill="yellow" stroke="black" points="989,-825.17 521,-825.17 521,-757.17 989,-757.17 989,-825.17"/>
<text text-anchor="middle" x="755" y="-809.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="755" y="-794.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="755" y="-779.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="755" y="-764.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer15_res1&#45;&gt;layer15_ln2 -->
<g id="edge203" class="edge">
<title>layer15_res1&#45;&gt;layer15_ln2</title>
<path fill="none" stroke="black" d="M761.97,-862.15C761.1,-853.47 760.19,-844.27 759.31,-835.49"/>
<polygon fill="black" stroke="black" points="762.79,-835.04 758.31,-825.44 755.82,-835.73 762.79,-835.04"/>
</g>
<!-- layer15_res2 -->
<g id="node179" class="node">
<title>layer15_res2</title>
<polygon fill="yellow" stroke="black" points="879,-232.17 411,-232.17 411,-149.17 879,-149.17 879,-232.17"/>
<text text-anchor="middle" x="645" y="-216.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="645" y="-201.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="645" y="-186.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="645" y="-171.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="645" y="-156.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer15_res1&#45;&gt;layer15_res2 -->
<g id="edge208" class="edge">
<title>layer15_res1&#45;&gt;layer15_res2</title>
<path fill="none" stroke="black" d="M971.66,-862.02C996.33,-845.87 1013,-823.41 1013,-792.17 1013,-792.17 1013,-792.17 1013,-336.17 1013,-306.06 1023.59,-291.14 1003,-269.17 984.87,-249.82 940.58,-234.86 889.09,-223.47"/>
<polygon fill="black" stroke="black" points="889.56,-219.99 879.05,-221.31 888.09,-226.84 889.56,-219.99"/>
</g>
<!-- layer15_mlp1 -->
<g id="node175" class="node">
<title>layer15_mlp1</title>
<polygon fill="yellow" stroke="black" points="993.5,-720.17 490.5,-720.17 490.5,-652.17 993.5,-652.17 993.5,-720.17"/>
<text text-anchor="middle" x="742" y="-704.97" font-family="Times,serif" font-size="14.00">MLP Linear1 (Column&#45;Parallel)</text>
<text text-anchor="middle" x="742" y="-689.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="742" y="-674.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="742" y="-659.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer15_ln2&#45;&gt;layer15_mlp1 -->
<g id="edge204" class="edge">
<title>layer15_ln2&#45;&gt;layer15_mlp1</title>
<path fill="none" stroke="black" d="M750.82,-757.01C749.75,-748.56 748.59,-739.34 747.46,-730.47"/>
<polygon fill="black" stroke="black" points="750.9,-729.74 746.18,-720.26 743.96,-730.62 750.9,-729.74"/>
</g>
<!-- layer15_gelu -->
<g id="node176" class="node">
<title>layer15_gelu</title>
<polygon fill="yellow" stroke="black" points="877.5,-615.17 374.5,-615.17 374.5,-547.17 877.5,-547.17 877.5,-615.17"/>
<text text-anchor="middle" x="626" y="-599.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="626" y="-584.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="626" y="-569.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="626" y="-554.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer15_mlp1&#45;&gt;layer15_gelu -->
<g id="edge205" class="edge">
<title>layer15_mlp1&#45;&gt;layer15_gelu</title>
<path fill="none" stroke="black" d="M704.66,-652.01C693.9,-642.45 682.04,-631.93 670.87,-622.01"/>
<polygon fill="black" stroke="black" points="673.07,-619.28 663.27,-615.26 668.43,-624.52 673.07,-619.28"/>
</g>
<!-- layer15_mlp2 -->
<g id="node177" class="node">
<title>layer15_mlp2</title>
<polygon fill="yellow" stroke="black" points="798.5,-510.17 307.5,-510.17 307.5,-442.17 798.5,-442.17 798.5,-510.17"/>
<text text-anchor="middle" x="553" y="-494.97" font-family="Times,serif" font-size="14.00">MLP Linear2 (Row&#45;Parallel)</text>
<text text-anchor="middle" x="553" y="-479.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="553" y="-464.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="553" y="-449.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer15_gelu&#45;&gt;layer15_mlp2 -->
<g id="edge206" class="edge">
<title>layer15_gelu&#45;&gt;layer15_mlp2</title>
<path fill="none" stroke="black" d="M602.5,-547.01C596.05,-537.91 588.98,-527.94 582.26,-518.44"/>
<polygon fill="black" stroke="black" points="585.09,-516.4 576.46,-510.26 579.38,-520.44 585.09,-516.4"/>
</g>
<!-- layer15_mlp_ar -->
<g id="node178" class="node">
<title>layer15_mlp_ar</title>
<polygon fill="yellow" stroke="black" points="994.4,-405.17 222.24,-405.17 23.6,-269.17 795.76,-269.17 994.4,-405.17"/>
<text text-anchor="middle" x="509" y="-355.97" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="509" y="-340.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-325.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="509" y="-310.97" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer15_mlp2&#45;&gt;layer15_mlp_ar -->
<g id="edge207" class="edge">
<title>layer15_mlp2&#45;&gt;layer15_mlp_ar</title>
<path fill="none" stroke="black" d="M542.35,-442C539.68,-433.69 536.7,-424.42 533.65,-414.93"/>
<polygon fill="black" stroke="black" points="536.98,-413.85 530.59,-405.4 530.32,-415.99 536.98,-413.85"/>
</g>
<!-- layer15_mlp_ar&#45;&gt;layer15_res2 -->
<g id="edge209" class="edge">
<title>layer15_mlp_ar&#45;&gt;layer15_res2</title>
<path fill="none" stroke="black" d="M572.22,-268.99C581.53,-259.11 590.95,-249.09 599.79,-239.7"/>
<polygon fill="black" stroke="black" points="602.44,-241.99 606.75,-232.31 597.35,-237.19 602.44,-241.99"/>
</g>
<!-- final_output -->
<g id="node180" class="node">
<title>final_output</title>
<ellipse fill="yellow" stroke="black" cx="645" cy="-64.08" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="645" y="-82.88" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="645" y="-67.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="645" y="-52.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="645" y="-37.88" font-family="Times,serif" font-size="14.00">GPU: All GPUs 8&#45;15</text>
</g>
<!-- layer15_res2&#45;&gt;final_output -->
<g id="edge210" class="edge">
<title>layer15_res2&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M645,-148.87C645,-140.51 645,-131.55 645,-122.72"/>
<polygon fill="black" stroke="black" points="648.5,-122.46 645,-112.46 641.5,-122.46 648.5,-122.46"/>
</g>
</g>
</svg>
