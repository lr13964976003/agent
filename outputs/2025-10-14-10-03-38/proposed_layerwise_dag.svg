<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="119pt" height="2160pt"
 viewBox="0.00 0.00 119.01 2160.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.07 0.07) rotate(0) translate(4 31720.33)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-31720.33 1743.93,-31720.33 1743.93,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer_0_gpu_0</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="270,-29802.17 270,-31612.17 1539,-31612.17 1539,-29802.17 270,-29802.17"/>
<text text-anchor="middle" x="904.5" y="-31596.97" font-family="Times,serif" font-size="14.00">Layer 0 on GPU 0</text>
<text text-anchor="middle" x="904.5" y="-31581.97" font-family="Times,serif" font-size="14.00">SRAM/L2 Cache Optimized</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_1_gpu_1</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="219,-27812.17 219,-29794.17 1508,-29794.17 1508,-27812.17 219,-27812.17"/>
<text text-anchor="middle" x="863.5" y="-29778.97" font-family="Times,serif" font-size="14.00">Layer 1 on GPU 1</text>
<text text-anchor="middle" x="863.5" y="-29763.97" font-family="Times,serif" font-size="14.00">SRAM/L2 Cache Optimized</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_2_gpu_2</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="194,-25822.17 194,-27804.17 1483,-27804.17 1483,-25822.17 194,-25822.17"/>
<text text-anchor="middle" x="838.5" y="-27788.97" font-family="Times,serif" font-size="14.00">Layer 2 on GPU 2</text>
<text text-anchor="middle" x="838.5" y="-27773.97" font-family="Times,serif" font-size="14.00">SRAM/L2 Cache Optimized</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_3_gpu_3</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="174,-23832.17 174,-25814.17 1463,-25814.17 1463,-23832.17 174,-23832.17"/>
<text text-anchor="middle" x="818.5" y="-25798.97" font-family="Times,serif" font-size="14.00">Layer 3 on GPU 3</text>
<text text-anchor="middle" x="818.5" y="-25783.97" font-family="Times,serif" font-size="14.00">SRAM/L2 Cache Optimized</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer_4_gpu_4</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="170,-21842.17 170,-23824.17 1459,-23824.17 1459,-21842.17 170,-21842.17"/>
<text text-anchor="middle" x="814.5" y="-23808.97" font-family="Times,serif" font-size="14.00">Layer 4 on GPU 4</text>
<text text-anchor="middle" x="814.5" y="-23793.97" font-family="Times,serif" font-size="14.00">SRAM/L2 Cache Optimized</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer_5_gpu_5</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="147,-19852.17 147,-21834.17 1436,-21834.17 1436,-19852.17 147,-19852.17"/>
<text text-anchor="middle" x="791.5" y="-21818.97" font-family="Times,serif" font-size="14.00">Layer 5 on GPU 5</text>
<text text-anchor="middle" x="791.5" y="-21803.97" font-family="Times,serif" font-size="14.00">SRAM/L2 Cache Optimized</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer_6_gpu_6</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="130,-17862.17 130,-19844.17 1419,-19844.17 1419,-17862.17 130,-17862.17"/>
<text text-anchor="middle" x="774.5" y="-19828.97" font-family="Times,serif" font-size="14.00">Layer 6 on GPU 6</text>
<text text-anchor="middle" x="774.5" y="-19813.97" font-family="Times,serif" font-size="14.00">SRAM/L2 Cache Optimized</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer_7_gpu_7</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="116,-15872.17 116,-17854.17 1405,-17854.17 1405,-15872.17 116,-15872.17"/>
<text text-anchor="middle" x="760.5" y="-17838.97" font-family="Times,serif" font-size="14.00">Layer 7 on GPU 7</text>
<text text-anchor="middle" x="760.5" y="-17823.97" font-family="Times,serif" font-size="14.00">SRAM/L2 Cache Optimized</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer_8_gpu_8</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="111,-13882.17 111,-15864.17 1400,-15864.17 1400,-13882.17 111,-13882.17"/>
<text text-anchor="middle" x="755.5" y="-15848.97" font-family="Times,serif" font-size="14.00">Layer 8 on GPU 8</text>
<text text-anchor="middle" x="755.5" y="-15833.97" font-family="Times,serif" font-size="14.00">SRAM/L2 Cache Optimized</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_layer_9_gpu_9</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="97,-11892.17 97,-13874.17 1386,-13874.17 1386,-11892.17 97,-11892.17"/>
<text text-anchor="middle" x="741.5" y="-13858.97" font-family="Times,serif" font-size="14.00">Layer 9 on GPU 9</text>
<text text-anchor="middle" x="741.5" y="-13843.97" font-family="Times,serif" font-size="14.00">SRAM/L2 Cache Optimized</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer_10_gpu_10</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="83,-9902.17 83,-11884.17 1372,-11884.17 1372,-9902.17 83,-9902.17"/>
<text text-anchor="middle" x="727.5" y="-11868.97" font-family="Times,serif" font-size="14.00">Layer 10 on GPU 10</text>
<text text-anchor="middle" x="727.5" y="-11853.97" font-family="Times,serif" font-size="14.00">SRAM/L2 Cache Optimized</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_layer_11_gpu_11</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="45,-7912.17 45,-9894.17 1334,-9894.17 1334,-7912.17 45,-7912.17"/>
<text text-anchor="middle" x="689.5" y="-9878.97" font-family="Times,serif" font-size="14.00">Layer 11 on GPU 11</text>
<text text-anchor="middle" x="689.5" y="-9863.97" font-family="Times,serif" font-size="14.00">SRAM/L2 Cache Optimized</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_layer_12_gpu_12</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="31,-5922.17 31,-7904.17 1320,-7904.17 1320,-5922.17 31,-5922.17"/>
<text text-anchor="middle" x="675.5" y="-7888.97" font-family="Times,serif" font-size="14.00">Layer 12 on GPU 12</text>
<text text-anchor="middle" x="675.5" y="-7873.97" font-family="Times,serif" font-size="14.00">SRAM/L2 Cache Optimized</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_layer_13_gpu_13</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="26,-3932.17 26,-5914.17 1315,-5914.17 1315,-3932.17 26,-3932.17"/>
<text text-anchor="middle" x="670.5" y="-5898.97" font-family="Times,serif" font-size="14.00">Layer 13 on GPU 13</text>
<text text-anchor="middle" x="670.5" y="-5883.97" font-family="Times,serif" font-size="14.00">SRAM/L2 Cache Optimized</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_layer_14_gpu_14</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="12,-1942.17 12,-3924.17 1301,-3924.17 1301,-1942.17 12,-1942.17"/>
<text text-anchor="middle" x="656.5" y="-3908.97" font-family="Times,serif" font-size="14.00">Layer 14 on GPU 14</text>
<text text-anchor="middle" x="656.5" y="-3893.97" font-family="Times,serif" font-size="14.00">SRAM/L2 Cache Optimized</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_layer_15_gpu_15</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-124.17 8,-1934.17 1297,-1934.17 1297,-124.17 8,-124.17"/>
<text text-anchor="middle" x="652.5" y="-1918.97" font-family="Times,serif" font-size="14.00">Layer 15 on GPU 15</text>
<text text-anchor="middle" x="652.5" y="-1903.97" font-family="Times,serif" font-size="14.00">SRAM/L2 Cache Optimized</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="yellow" stroke="black" cx="1409" cy="-31668.25" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="1409" y="-31687.05" font-family="Times,serif" font-size="14.00">Model Input</text>
<text text-anchor="middle" x="1409" y="-31672.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1409" y="-31657.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1409" y="-31642.05" font-family="Times,serif" font-size="14.00">GPU: N/A</text>
</g>
<!-- layer0_ln1 -->
<g id="node2" class="node">
<title>layer0_ln1</title>
<polygon fill="yellow" stroke="black" points="1493,-31566.17 1025,-31566.17 1025,-31498.17 1493,-31498.17 1493,-31566.17"/>
<text text-anchor="middle" x="1259" y="-31550.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1259" y="-31535.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1259" y="-31520.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1259" y="-31505.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;layer0_ln1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_ln1</title>
<path fill="none" stroke="black" d="M1356.96,-31620.73C1339.64,-31605.25 1320.52,-31588.16 1303.8,-31573.21"/>
<polygon fill="black" stroke="black" points="1306.09,-31570.56 1296.3,-31566.51 1301.42,-31575.78 1306.09,-31570.56"/>
</g>
<!-- layer0_res1 -->
<g id="node13" class="node">
<title>layer0_res1</title>
<polygon fill="yellow" stroke="black" points="1492,-30600.17 1024,-30600.17 1024,-30517.17 1492,-30517.17 1492,-30600.17"/>
<text text-anchor="middle" x="1258" y="-30584.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1258" y="-30569.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1258" y="-30554.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1258" y="-30539.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1258" y="-30524.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;layer0_res1 -->
<g id="edge14" class="edge">
<title>input&#45;&gt;layer0_res1</title>
<path fill="none" stroke="black" d="M1493.64,-31621.43C1496.63,-31618.49 1499.44,-31615.4 1502,-31612.17 1554.83,-31545.34 1559,-31514.35 1559,-31429.17 1559,-31429.17 1559,-31429.17 1559,-30773.17 1559,-30704.17 1538.66,-30680.74 1486,-30636.17 1471.35,-30623.76 1454.6,-30613.34 1436.99,-30604.6"/>
<polygon fill="black" stroke="black" points="1438.24,-30601.32 1427.7,-30600.18 1435.23,-30607.64 1438.24,-30601.32"/>
</g>
<!-- layer0_qkv -->
<g id="node3" class="node">
<title>layer0_qkv</title>
<polygon fill="yellow" stroke="black" points="1523.5,-31462.17 904.5,-31462.17 904.5,-31394.17 1523.5,-31394.17 1523.5,-31462.17"/>
<text text-anchor="middle" x="1214" y="-31446.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1214" y="-31431.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1214" y="-31416.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1214" y="-31401.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_ln1&#45;&gt;layer0_qkv -->
<g id="edge2" class="edge">
<title>layer0_ln1&#45;&gt;layer0_qkv</title>
<path fill="none" stroke="black" d="M1244.39,-31498.05C1240.7,-31489.68 1236.68,-31480.57 1232.81,-31471.8"/>
<polygon fill="black" stroke="black" points="1235.93,-31470.2 1228.69,-31462.47 1229.53,-31473.03 1235.93,-31470.2"/>
</g>
<!-- layer0_reshape_qkv -->
<g id="node4" class="node">
<title>layer0_reshape_qkv</title>
<polygon fill="yellow" stroke="black" points="1519.5,-31358.17 900.5,-31358.17 900.5,-31290.17 1519.5,-31290.17 1519.5,-31358.17"/>
<text text-anchor="middle" x="1210" y="-31342.97" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1210" y="-31327.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1210" y="-31312.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1210" y="-31297.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_qkv&#45;&gt;layer0_reshape_qkv -->
<g id="edge3" class="edge">
<title>layer0_qkv&#45;&gt;layer0_reshape_qkv</title>
<path fill="none" stroke="black" d="M1212.7,-31394.05C1212.38,-31385.94 1212.04,-31377.15 1211.7,-31368.64"/>
<polygon fill="black" stroke="black" points="1215.2,-31368.32 1211.31,-31358.47 1208.2,-31368.6 1215.2,-31368.32"/>
</g>
<!-- layer0_split_q -->
<g id="node5" class="node">
<title>layer0_split_q</title>
<polygon fill="yellow" stroke="black" points="885.5,-31254.17 278.5,-31254.17 278.5,-31186.17 885.5,-31186.17 885.5,-31254.17"/>
<text text-anchor="middle" x="582" y="-31238.97" font-family="Times,serif" font-size="14.00">Split Query</text>
<text text-anchor="middle" x="582" y="-31223.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="582" y="-31208.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="582" y="-31193.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_reshape_qkv&#45;&gt;layer0_split_q -->
<g id="edge4" class="edge">
<title>layer0_reshape_qkv&#45;&gt;layer0_split_q</title>
<path fill="none" stroke="black" d="M1006.54,-31290.12C939.02,-31279.15 863.67,-31266.92 795.42,-31255.83"/>
<polygon fill="black" stroke="black" points="795.84,-31252.35 785.41,-31254.2 794.71,-31259.26 795.84,-31252.35"/>
</g>
<!-- layer0_split_k -->
<g id="node6" class="node">
<title>layer0_split_k</title>
<polygon fill="yellow" stroke="black" points="1510.5,-31254.17 903.5,-31254.17 903.5,-31186.17 1510.5,-31186.17 1510.5,-31254.17"/>
<text text-anchor="middle" x="1207" y="-31238.97" font-family="Times,serif" font-size="14.00">Split Key</text>
<text text-anchor="middle" x="1207" y="-31223.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1207" y="-31208.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1207" y="-31193.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_reshape_qkv&#45;&gt;layer0_split_k -->
<g id="edge5" class="edge">
<title>layer0_reshape_qkv&#45;&gt;layer0_split_k</title>
<path fill="none" stroke="black" d="M1209.03,-31290.05C1208.79,-31281.94 1208.53,-31273.15 1208.28,-31264.64"/>
<polygon fill="black" stroke="black" points="1211.77,-31264.36 1207.98,-31254.47 1204.77,-31264.56 1211.77,-31264.36"/>
</g>
<!-- layer0_split_v -->
<g id="node7" class="node">
<title>layer0_split_v</title>
<polygon fill="yellow" stroke="black" points="1530.5,-31142.67 923.5,-31142.67 923.5,-31074.67 1530.5,-31074.67 1530.5,-31142.67"/>
<text text-anchor="middle" x="1227" y="-31127.47" font-family="Times,serif" font-size="14.00">Split Value</text>
<text text-anchor="middle" x="1227" y="-31112.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1227" y="-31097.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1227" y="-31082.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_reshape_qkv&#45;&gt;layer0_split_v -->
<g id="edge6" class="edge">
<title>layer0_reshape_qkv&#45;&gt;layer0_split_v</title>
<path fill="none" stroke="black" d="M1445.9,-31290.16C1480.3,-31280.77 1508.14,-31268.95 1520,-31254.17 1538.91,-31230.59 1538.47,-31210.08 1520,-31186.17 1507.37,-31169.82 1474.88,-31156.3 1435.92,-31145.41"/>
<polygon fill="black" stroke="black" points="1436.45,-31141.93 1425.88,-31142.7 1434.62,-31148.68 1436.45,-31141.93"/>
</g>
<!-- layer0_attn_score -->
<g id="node8" class="node">
<title>layer0_attn_score</title>
<polygon fill="yellow" stroke="black" points="905,-31150.17 339,-31150.17 339,-31067.17 905,-31067.17 905,-31150.17"/>
<text text-anchor="middle" x="622" y="-31134.97" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="622" y="-31119.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="622" y="-31104.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="622" y="-31089.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="622" y="-31074.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_split_q&#45;&gt;layer0_attn_score -->
<g id="edge7" class="edge">
<title>layer0_split_q&#45;&gt;layer0_attn_score</title>
<path fill="none" stroke="black" d="M594.11,-31186.02C597.12,-31177.79 600.4,-31168.78 603.64,-31159.94"/>
<polygon fill="black" stroke="black" points="606.96,-31161.04 607.1,-31150.44 600.39,-31158.64 606.96,-31161.04"/>
</g>
<!-- layer0_split_k&#45;&gt;layer0_attn_score -->
<g id="edge8" class="edge">
<title>layer0_split_k&#45;&gt;layer0_attn_score</title>
<path fill="none" stroke="black" d="M1030.69,-31186.16C973.4,-31175.44 909.02,-31163.39 848.6,-31152.08"/>
<polygon fill="black" stroke="black" points="849.02,-31148.6 838.54,-31150.2 847.73,-31155.48 849.02,-31148.6"/>
</g>
<!-- layer0_attn_out -->
<g id="node10" class="node">
<title>layer0_attn_out</title>
<polygon fill="yellow" stroke="black" points="1508.5,-30927.17 945.5,-30927.17 945.5,-30844.17 1508.5,-30844.17 1508.5,-30927.17"/>
<text text-anchor="middle" x="1227" y="-30911.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1227" y="-30896.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1227" y="-30881.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1227" y="-30866.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1227" y="-30851.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_split_v&#45;&gt;layer0_attn_out -->
<g id="edge11" class="edge">
<title>layer0_split_v&#45;&gt;layer0_attn_out</title>
<path fill="none" stroke="black" d="M1227,-31074.58C1227,-31038.32 1227,-30979.7 1227,-30937.57"/>
<polygon fill="black" stroke="black" points="1230.5,-30937.51 1227,-30927.51 1223.5,-30937.51 1230.5,-30937.51"/>
</g>
<!-- layer0_attn_weights -->
<g id="node9" class="node">
<title>layer0_attn_weights</title>
<polygon fill="yellow" stroke="black" points="1057,-31031.17 491,-31031.17 491,-30963.17 1057,-30963.17 1057,-31031.17"/>
<text text-anchor="middle" x="774" y="-31015.97" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="774" y="-31000.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="774" y="-30985.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="774" y="-30970.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_attn_score&#45;&gt;layer0_attn_weights -->
<g id="edge9" class="edge">
<title>layer0_attn_score&#45;&gt;layer0_attn_weights</title>
<path fill="none" stroke="black" d="M678.6,-31066.89C692.02,-31057.22 706.31,-31046.93 719.62,-31037.34"/>
<polygon fill="black" stroke="black" points="721.71,-31040.15 727.78,-31031.47 717.62,-31034.47 721.71,-31040.15"/>
</g>
<!-- layer0_attn_weights&#45;&gt;layer0_attn_out -->
<g id="edge10" class="edge">
<title>layer0_attn_weights&#45;&gt;layer0_attn_out</title>
<path fill="none" stroke="black" d="M910.53,-30963.16C954.19,-30952.61 1003.17,-30940.77 1049.31,-30929.62"/>
<polygon fill="black" stroke="black" points="1050.21,-30933 1059.11,-30927.25 1048.57,-30926.2 1050.21,-30933"/>
</g>
<!-- layer0_attn_reshape -->
<g id="node11" class="node">
<title>layer0_attn_reshape</title>
<polygon fill="yellow" stroke="black" points="1516.5,-30808.17 965.5,-30808.17 965.5,-30740.17 1516.5,-30740.17 1516.5,-30808.17"/>
<text text-anchor="middle" x="1241" y="-30792.97" font-family="Times,serif" font-size="14.00">Reshape Attention</text>
<text text-anchor="middle" x="1241" y="-30777.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1241" y="-30762.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1241" y="-30747.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_attn_out&#45;&gt;layer0_attn_reshape -->
<g id="edge12" class="edge">
<title>layer0_attn_out&#45;&gt;layer0_attn_reshape</title>
<path fill="none" stroke="black" d="M1232.21,-30843.89C1233.27,-30835.59 1234.39,-30826.83 1235.47,-30818.45"/>
<polygon fill="black" stroke="black" points="1238.95,-30818.83 1236.74,-30808.47 1232,-30817.94 1238.95,-30818.83"/>
</g>
<!-- layer0_attn_proj -->
<g id="node12" class="node">
<title>layer0_attn_proj</title>
<polygon fill="yellow" stroke="black" points="1477,-30704.17 1009,-30704.17 1009,-30636.17 1477,-30636.17 1477,-30704.17"/>
<text text-anchor="middle" x="1243" y="-30688.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="1243" y="-30673.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1243" y="-30658.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1243" y="-30643.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_attn_reshape&#45;&gt;layer0_attn_proj -->
<g id="edge13" class="edge">
<title>layer0_attn_reshape&#45;&gt;layer0_attn_proj</title>
<path fill="none" stroke="black" d="M1241.65,-30740.05C1241.81,-30731.94 1241.98,-30723.15 1242.15,-30714.64"/>
<polygon fill="black" stroke="black" points="1245.65,-30714.53 1242.35,-30704.47 1238.65,-30714.4 1245.65,-30714.53"/>
</g>
<!-- layer0_attn_proj&#45;&gt;layer0_res1 -->
<g id="edge15" class="edge">
<title>layer0_attn_proj&#45;&gt;layer0_res1</title>
<path fill="none" stroke="black" d="M1247.54,-30636.02C1248.64,-30627.96 1249.85,-30619.17 1251.04,-30610.5"/>
<polygon fill="black" stroke="black" points="1254.52,-30610.83 1252.41,-30600.44 1247.59,-30609.88 1254.52,-30610.83"/>
</g>
<!-- layer0_ln2 -->
<g id="node14" class="node">
<title>layer0_ln2</title>
<polygon fill="yellow" stroke="black" points="1247,-30481.17 779,-30481.17 779,-30413.17 1247,-30413.17 1247,-30481.17"/>
<text text-anchor="middle" x="1013" y="-30465.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1013" y="-30450.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1013" y="-30435.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1013" y="-30420.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_res1&#45;&gt;layer0_ln2 -->
<g id="edge16" class="edge">
<title>layer0_res1&#45;&gt;layer0_ln2</title>
<path fill="none" stroke="black" d="M1167.12,-30517.05C1143.9,-30506.67 1119.05,-30495.57 1096.24,-30485.37"/>
<polygon fill="black" stroke="black" points="1097.49,-30482.09 1086.93,-30481.21 1094.63,-30488.49 1097.49,-30482.09"/>
</g>
<!-- layer0_res2 -->
<g id="node18" class="node">
<title>layer0_res2</title>
<polygon fill="yellow" stroke="black" points="1249,-30065.17 781,-30065.17 781,-29982.17 1249,-29982.17 1249,-30065.17"/>
<text text-anchor="middle" x="1015" y="-30049.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1015" y="-30034.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1015" y="-30019.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1015" y="-30004.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1015" y="-29989.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_res1&#45;&gt;layer0_res2 -->
<g id="edge20" class="edge">
<title>layer0_res1&#45;&gt;layer0_res2</title>
<path fill="none" stroke="black" d="M1263.19,-30516.81C1268.19,-30473.9 1275,-30404.4 1275,-30344.17 1275,-30344.17 1275,-30344.17 1275,-30238.17 1275,-30177 1300.58,-30148.63 1262,-30101.17 1252.36,-30089.31 1240.92,-30079.25 1228.32,-30070.72"/>
<polygon fill="black" stroke="black" points="1230.19,-30067.77 1219.88,-30065.34 1226.43,-30073.67 1230.19,-30067.77"/>
</g>
<!-- layer0_mlp1 -->
<g id="node15" class="node">
<title>layer0_mlp1</title>
<polygon fill="yellow" stroke="black" points="1255.5,-30377.17 752.5,-30377.17 752.5,-30309.17 1255.5,-30309.17 1255.5,-30377.17"/>
<text text-anchor="middle" x="1004" y="-30361.97" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="1004" y="-30346.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1004" y="-30331.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="1004" y="-30316.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_ln2&#45;&gt;layer0_mlp1 -->
<g id="edge17" class="edge">
<title>layer0_ln2&#45;&gt;layer0_mlp1</title>
<path fill="none" stroke="black" d="M1010.08,-30413.05C1009.36,-30404.94 1008.59,-30396.15 1007.84,-30387.64"/>
<polygon fill="black" stroke="black" points="1011.3,-30387.12 1006.94,-30377.47 1004.33,-30387.73 1011.3,-30387.12"/>
</g>
<!-- layer0_gelu -->
<g id="node16" class="node">
<title>layer0_gelu</title>
<polygon fill="yellow" stroke="black" points="1255.5,-30273.17 752.5,-30273.17 752.5,-30205.17 1255.5,-30205.17 1255.5,-30273.17"/>
<text text-anchor="middle" x="1004" y="-30257.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1004" y="-30242.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="1004" y="-30227.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="1004" y="-30212.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_mlp1&#45;&gt;layer0_gelu -->
<g id="edge18" class="edge">
<title>layer0_mlp1&#45;&gt;layer0_gelu</title>
<path fill="none" stroke="black" d="M1004,-30309.05C1004,-30300.94 1004,-30292.15 1004,-30283.64"/>
<polygon fill="black" stroke="black" points="1007.5,-30283.47 1004,-30273.47 1000.5,-30283.47 1007.5,-30283.47"/>
</g>
<!-- layer0_mlp2 -->
<g id="node17" class="node">
<title>layer0_mlp2</title>
<polygon fill="yellow" stroke="black" points="1252.5,-30169.17 761.5,-30169.17 761.5,-30101.17 1252.5,-30101.17 1252.5,-30169.17"/>
<text text-anchor="middle" x="1007" y="-30153.97" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="1007" y="-30138.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="1007" y="-30123.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1007" y="-30108.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gelu&#45;&gt;layer0_mlp2 -->
<g id="edge19" class="edge">
<title>layer0_gelu&#45;&gt;layer0_mlp2</title>
<path fill="none" stroke="black" d="M1004.97,-30205.05C1005.21,-30196.94 1005.47,-30188.15 1005.72,-30179.64"/>
<polygon fill="black" stroke="black" points="1009.23,-30179.56 1006.02,-30169.47 1002.23,-30179.36 1009.23,-30179.56"/>
</g>
<!-- layer0_mlp2&#45;&gt;layer0_res2 -->
<g id="edge21" class="edge">
<title>layer0_mlp2&#45;&gt;layer0_res2</title>
<path fill="none" stroke="black" d="M1009.42,-30101.02C1010.01,-30092.96 1010.65,-30084.17 1011.29,-30075.5"/>
<polygon fill="black" stroke="black" points="1014.78,-30075.67 1012.02,-30065.44 1007.8,-30075.16 1014.78,-30075.67"/>
</g>
<!-- send_to_gpu_1 -->
<g id="node19" class="node">
<title>send_to_gpu_1</title>
<polygon fill="yellow" stroke="black" points="1500.4,-29946.17 728.24,-29946.17 529.6,-29810.17 1301.76,-29810.17 1500.4,-29946.17"/>
<text text-anchor="middle" x="1015" y="-29896.97" font-family="Times,serif" font-size="14.00">Send to GPU 1</text>
<text text-anchor="middle" x="1015" y="-29881.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1015" y="-29866.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1015" y="-29851.97" font-family="Times,serif" font-size="14.00">GPU: 0 â†’ GPU 1</text>
</g>
<!-- layer0_res2&#45;&gt;send_to_gpu_1 -->
<g id="edge22" class="edge">
<title>layer0_res2&#45;&gt;send_to_gpu_1</title>
<path fill="none" stroke="black" d="M1015,-29981.93C1015,-29973.95 1015,-29965.33 1015,-29956.61"/>
<polygon fill="black" stroke="black" points="1018.5,-29956.34 1015,-29946.34 1011.5,-29956.34 1018.5,-29956.34"/>
</g>
<!-- comm_layer_1 -->
<g id="node20" class="node">
<title>comm_layer_1</title>
<polygon fill="yellow" stroke="black" points="1500.4,-29748.17 728.24,-29748.17 529.6,-29612.17 1301.76,-29612.17 1500.4,-29748.17"/>
<text text-anchor="middle" x="1015" y="-29698.97" font-family="Times,serif" font-size="14.00">Receive from GPU 0</text>
<text text-anchor="middle" x="1015" y="-29683.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1015" y="-29668.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1015" y="-29653.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- send_to_gpu_1&#45;&gt;comm_layer_1 -->
<g id="edge23" class="edge">
<title>send_to_gpu_1&#45;&gt;comm_layer_1</title>
<path fill="none" stroke="black" d="M1015,-29809.99C1015,-29793.47 1015,-29775.65 1015,-29758.69"/>
<polygon fill="black" stroke="black" points="1018.5,-29758.26 1015,-29748.26 1011.5,-29758.26 1018.5,-29758.26"/>
</g>
<!-- layer1_ln1 -->
<g id="node21" class="node">
<title>layer1_ln1</title>
<polygon fill="yellow" stroke="black" points="1267,-29576.17 799,-29576.17 799,-29508.17 1267,-29508.17 1267,-29576.17"/>
<text text-anchor="middle" x="1033" y="-29560.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1033" y="-29545.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1033" y="-29530.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1033" y="-29515.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- comm_layer_1&#45;&gt;layer1_ln1 -->
<g id="edge24" class="edge">
<title>comm_layer_1&#45;&gt;layer1_ln1</title>
<path fill="none" stroke="black" d="M1023.89,-29611.96C1025.05,-29603.21 1026.21,-29594.44 1027.3,-29586.23"/>
<polygon fill="black" stroke="black" points="1030.79,-29586.56 1028.63,-29576.18 1023.85,-29585.64 1030.79,-29586.56"/>
</g>
<!-- layer1_res1 -->
<g id="node32" class="node">
<title>layer1_res1</title>
<polygon fill="yellow" stroke="black" points="1455,-28610.17 987,-28610.17 987,-28527.17 1455,-28527.17 1455,-28610.17"/>
<text text-anchor="middle" x="1221" y="-28594.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1221" y="-28579.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1221" y="-28564.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1221" y="-28549.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1221" y="-28534.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- comm_layer_1&#45;&gt;layer1_res1 -->
<g id="edge37" class="edge">
<title>comm_layer_1&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M1325.63,-29628.48C1419.89,-29594.05 1499,-29536.24 1499,-29439.17 1499,-29439.17 1499,-29439.17 1499,-28783.17 1499,-28718.79 1497.76,-28691.44 1452,-28646.17 1439.7,-28634 1425.42,-28623.76 1410.11,-28615.16"/>
<polygon fill="black" stroke="black" points="1411.46,-28611.9 1400.99,-28610.27 1408.15,-28618.08 1411.46,-28611.9"/>
</g>
<!-- layer1_qkv -->
<g id="node22" class="node">
<title>layer1_qkv</title>
<polygon fill="yellow" stroke="black" points="1412.5,-29472.17 793.5,-29472.17 793.5,-29404.17 1412.5,-29404.17 1412.5,-29472.17"/>
<text text-anchor="middle" x="1103" y="-29456.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1103" y="-29441.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1103" y="-29426.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1103" y="-29411.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_qkv -->
<g id="edge25" class="edge">
<title>layer1_ln1&#45;&gt;layer1_qkv</title>
<path fill="none" stroke="black" d="M1055.73,-29508.05C1061.66,-29499.41 1068.12,-29489.99 1074.32,-29480.96"/>
<polygon fill="black" stroke="black" points="1077.37,-29482.69 1080.15,-29472.47 1071.6,-29478.73 1077.37,-29482.69"/>
</g>
<!-- layer1_reshape_qkv -->
<g id="node23" class="node">
<title>layer1_reshape_qkv</title>
<polygon fill="yellow" stroke="black" points="1447.5,-29368.17 828.5,-29368.17 828.5,-29300.17 1447.5,-29300.17 1447.5,-29368.17"/>
<text text-anchor="middle" x="1138" y="-29352.97" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1138" y="-29337.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1138" y="-29322.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1138" y="-29307.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_qkv&#45;&gt;layer1_reshape_qkv -->
<g id="edge26" class="edge">
<title>layer1_qkv&#45;&gt;layer1_reshape_qkv</title>
<path fill="none" stroke="black" d="M1114.36,-29404.05C1117.21,-29395.77 1120.3,-29386.76 1123.28,-29378.08"/>
<polygon fill="black" stroke="black" points="1126.64,-29379.06 1126.57,-29368.47 1120.02,-29376.79 1126.64,-29379.06"/>
</g>
<!-- layer1_split_q -->
<g id="node24" class="node">
<title>layer1_split_q</title>
<polygon fill="yellow" stroke="black" points="834.5,-29264.17 227.5,-29264.17 227.5,-29196.17 834.5,-29196.17 834.5,-29264.17"/>
<text text-anchor="middle" x="531" y="-29248.97" font-family="Times,serif" font-size="14.00">Split Query</text>
<text text-anchor="middle" x="531" y="-29233.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="531" y="-29218.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="531" y="-29203.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_reshape_qkv&#45;&gt;layer1_split_q -->
<g id="edge27" class="edge">
<title>layer1_reshape_qkv&#45;&gt;layer1_split_q</title>
<path fill="none" stroke="black" d="M941.34,-29300.12C876.21,-29289.18 803.55,-29276.97 737.69,-29265.9"/>
<polygon fill="black" stroke="black" points="738.05,-29262.41 727.6,-29264.2 736.88,-29269.31 738.05,-29262.41"/>
</g>
<!-- layer1_split_k -->
<g id="node25" class="node">
<title>layer1_split_k</title>
<polygon fill="yellow" stroke="black" points="1459.5,-29264.17 852.5,-29264.17 852.5,-29196.17 1459.5,-29196.17 1459.5,-29264.17"/>
<text text-anchor="middle" x="1156" y="-29248.97" font-family="Times,serif" font-size="14.00">Split Key</text>
<text text-anchor="middle" x="1156" y="-29233.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1156" y="-29218.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1156" y="-29203.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_reshape_qkv&#45;&gt;layer1_split_k -->
<g id="edge28" class="edge">
<title>layer1_reshape_qkv&#45;&gt;layer1_split_k</title>
<path fill="none" stroke="black" d="M1143.84,-29300.05C1145.29,-29291.86 1146.86,-29282.96 1148.38,-29274.36"/>
<polygon fill="black" stroke="black" points="1151.83,-29274.92 1150.12,-29264.47 1144.94,-29273.71 1151.83,-29274.92"/>
</g>
<!-- layer1_split_v -->
<g id="node26" class="node">
<title>layer1_split_v</title>
<polygon fill="yellow" stroke="black" points="1479.5,-29152.67 872.5,-29152.67 872.5,-29084.67 1479.5,-29084.67 1479.5,-29152.67"/>
<text text-anchor="middle" x="1176" y="-29137.47" font-family="Times,serif" font-size="14.00">Split Value</text>
<text text-anchor="middle" x="1176" y="-29122.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1176" y="-29107.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1176" y="-29092.47" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_reshape_qkv&#45;&gt;layer1_split_v -->
<g id="edge29" class="edge">
<title>layer1_reshape_qkv&#45;&gt;layer1_split_v</title>
<path fill="none" stroke="black" d="M1395.33,-29300.08C1429.49,-29290.79 1456.92,-29279.03 1469,-29264.17 1488.07,-29240.72 1487.47,-29220.08 1469,-29196.17 1456.37,-29179.82 1423.88,-29166.3 1384.92,-29155.41"/>
<polygon fill="black" stroke="black" points="1385.45,-29151.93 1374.88,-29152.7 1383.62,-29158.68 1385.45,-29151.93"/>
</g>
<!-- layer1_attn_score -->
<g id="node27" class="node">
<title>layer1_attn_score</title>
<polygon fill="yellow" stroke="black" points="854,-29160.17 288,-29160.17 288,-29077.17 854,-29077.17 854,-29160.17"/>
<text text-anchor="middle" x="571" y="-29144.97" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="571" y="-29129.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="571" y="-29114.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="571" y="-29099.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="571" y="-29084.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_split_q&#45;&gt;layer1_attn_score -->
<g id="edge30" class="edge">
<title>layer1_split_q&#45;&gt;layer1_attn_score</title>
<path fill="none" stroke="black" d="M543.11,-29196.02C546.12,-29187.79 549.4,-29178.78 552.64,-29169.94"/>
<polygon fill="black" stroke="black" points="555.96,-29171.04 556.1,-29160.44 549.39,-29168.64 555.96,-29171.04"/>
</g>
<!-- layer1_split_k&#45;&gt;layer1_attn_score -->
<g id="edge31" class="edge">
<title>layer1_split_k&#45;&gt;layer1_attn_score</title>
<path fill="none" stroke="black" d="M979.69,-29196.16C922.4,-29185.44 858.02,-29173.39 797.6,-29162.08"/>
<polygon fill="black" stroke="black" points="798.02,-29158.6 787.54,-29160.2 796.73,-29165.48 798.02,-29158.6"/>
</g>
<!-- layer1_attn_out -->
<g id="node29" class="node">
<title>layer1_attn_out</title>
<polygon fill="yellow" stroke="black" points="1457.5,-28937.17 894.5,-28937.17 894.5,-28854.17 1457.5,-28854.17 1457.5,-28937.17"/>
<text text-anchor="middle" x="1176" y="-28921.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1176" y="-28906.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1176" y="-28891.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1176" y="-28876.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1176" y="-28861.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_split_v&#45;&gt;layer1_attn_out -->
<g id="edge34" class="edge">
<title>layer1_split_v&#45;&gt;layer1_attn_out</title>
<path fill="none" stroke="black" d="M1176,-29084.58C1176,-29048.32 1176,-28989.7 1176,-28947.57"/>
<polygon fill="black" stroke="black" points="1179.5,-28947.51 1176,-28937.51 1172.5,-28947.51 1179.5,-28947.51"/>
</g>
<!-- layer1_attn_weights -->
<g id="node28" class="node">
<title>layer1_attn_weights</title>
<polygon fill="yellow" stroke="black" points="1006,-29041.17 440,-29041.17 440,-28973.17 1006,-28973.17 1006,-29041.17"/>
<text text-anchor="middle" x="723" y="-29025.97" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="723" y="-29010.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="723" y="-28995.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="723" y="-28980.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_score&#45;&gt;layer1_attn_weights -->
<g id="edge32" class="edge">
<title>layer1_attn_score&#45;&gt;layer1_attn_weights</title>
<path fill="none" stroke="black" d="M627.6,-29076.89C641.02,-29067.22 655.31,-29056.93 668.62,-29047.34"/>
<polygon fill="black" stroke="black" points="670.71,-29050.15 676.78,-29041.47 666.62,-29044.47 670.71,-29050.15"/>
</g>
<!-- layer1_attn_weights&#45;&gt;layer1_attn_out -->
<g id="edge33" class="edge">
<title>layer1_attn_weights&#45;&gt;layer1_attn_out</title>
<path fill="none" stroke="black" d="M859.53,-28973.16C903.19,-28962.61 952.17,-28950.77 998.31,-28939.62"/>
<polygon fill="black" stroke="black" points="999.21,-28943 1008.11,-28937.25 997.57,-28936.2 999.21,-28943"/>
</g>
<!-- layer1_attn_reshape -->
<g id="node30" class="node">
<title>layer1_attn_reshape</title>
<polygon fill="yellow" stroke="black" points="1462.5,-28818.17 911.5,-28818.17 911.5,-28750.17 1462.5,-28750.17 1462.5,-28818.17"/>
<text text-anchor="middle" x="1187" y="-28802.97" font-family="Times,serif" font-size="14.00">Reshape Attention</text>
<text text-anchor="middle" x="1187" y="-28787.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1187" y="-28772.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1187" y="-28757.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_out&#45;&gt;layer1_attn_reshape -->
<g id="edge35" class="edge">
<title>layer1_attn_out&#45;&gt;layer1_attn_reshape</title>
<path fill="none" stroke="black" d="M1180.1,-28853.89C1180.93,-28845.59 1181.81,-28836.83 1182.65,-28828.45"/>
<polygon fill="black" stroke="black" points="1186.14,-28828.77 1183.65,-28818.47 1179.17,-28828.07 1186.14,-28828.77"/>
</g>
<!-- layer1_attn_proj -->
<g id="node31" class="node">
<title>layer1_attn_proj</title>
<polygon fill="yellow" stroke="black" points="1443,-28714.17 975,-28714.17 975,-28646.17 1443,-28646.17 1443,-28714.17"/>
<text text-anchor="middle" x="1209" y="-28698.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="1209" y="-28683.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1209" y="-28668.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1209" y="-28653.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_reshape&#45;&gt;layer1_attn_proj -->
<g id="edge36" class="edge">
<title>layer1_attn_reshape&#45;&gt;layer1_attn_proj</title>
<path fill="none" stroke="black" d="M1194.14,-28750.05C1195.91,-28741.86 1197.83,-28732.96 1199.68,-28724.36"/>
<polygon fill="black" stroke="black" points="1203.13,-28724.98 1201.82,-28714.47 1196.29,-28723.5 1203.13,-28724.98"/>
</g>
<!-- layer1_attn_proj&#45;&gt;layer1_res1 -->
<g id="edge38" class="edge">
<title>layer1_attn_proj&#45;&gt;layer1_res1</title>
<path fill="none" stroke="black" d="M1212.63,-28646.02C1213.52,-28637.96 1214.48,-28629.17 1215.43,-28620.5"/>
<polygon fill="black" stroke="black" points="1218.92,-28620.77 1216.53,-28610.44 1211.96,-28620 1218.92,-28620.77"/>
</g>
<!-- layer1_ln2 -->
<g id="node33" class="node">
<title>layer1_ln2</title>
<polygon fill="yellow" stroke="black" points="1203,-28491.17 735,-28491.17 735,-28423.17 1203,-28423.17 1203,-28491.17"/>
<text text-anchor="middle" x="969" y="-28475.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="969" y="-28460.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="969" y="-28445.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="969" y="-28430.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_ln2 -->
<g id="edge39" class="edge">
<title>layer1_res1&#45;&gt;layer1_ln2</title>
<path fill="none" stroke="black" d="M1127.52,-28527.05C1103.53,-28516.62 1077.86,-28505.47 1054.3,-28495.23"/>
<polygon fill="black" stroke="black" points="1055.61,-28491.99 1045.04,-28491.21 1052.82,-28498.41 1055.61,-28491.99"/>
</g>
<!-- layer1_res2 -->
<g id="node37" class="node">
<title>layer1_res2</title>
<polygon fill="yellow" stroke="black" points="1224,-28075.17 756,-28075.17 756,-27992.17 1224,-27992.17 1224,-28075.17"/>
<text text-anchor="middle" x="990" y="-28059.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="990" y="-28044.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="990" y="-28029.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="990" y="-28014.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="990" y="-27999.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_res1&#45;&gt;layer1_res2 -->
<g id="edge43" class="edge">
<title>layer1_res1&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M1224.03,-28527.16C1226.97,-28484.24 1231,-28414.46 1231,-28354.17 1231,-28354.17 1231,-28354.17 1231,-28248.17 1231,-28187 1256.02,-28159.08 1218,-28111.17 1208.53,-28099.23 1197.12,-28089.14 1184.52,-28080.61"/>
<polygon fill="black" stroke="black" points="1186.39,-28077.66 1176.08,-28075.23 1182.63,-28083.56 1186.39,-28077.66"/>
</g>
<!-- layer1_mlp1 -->
<g id="node34" class="node">
<title>layer1_mlp1</title>
<polygon fill="yellow" stroke="black" points="1211.5,-28387.17 708.5,-28387.17 708.5,-28319.17 1211.5,-28319.17 1211.5,-28387.17"/>
<text text-anchor="middle" x="960" y="-28371.97" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="960" y="-28356.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="960" y="-28341.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="960" y="-28326.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_ln2&#45;&gt;layer1_mlp1 -->
<g id="edge40" class="edge">
<title>layer1_ln2&#45;&gt;layer1_mlp1</title>
<path fill="none" stroke="black" d="M966.08,-28423.05C965.36,-28414.94 964.59,-28406.15 963.84,-28397.64"/>
<polygon fill="black" stroke="black" points="967.3,-28397.12 962.94,-28387.47 960.33,-28397.73 967.3,-28397.12"/>
</g>
<!-- layer1_gelu -->
<g id="node35" class="node">
<title>layer1_gelu</title>
<polygon fill="yellow" stroke="black" points="1211.5,-28283.17 708.5,-28283.17 708.5,-28215.17 1211.5,-28215.17 1211.5,-28283.17"/>
<text text-anchor="middle" x="960" y="-28267.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="960" y="-28252.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="960" y="-28237.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="960" y="-28222.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_mlp1&#45;&gt;layer1_gelu -->
<g id="edge41" class="edge">
<title>layer1_mlp1&#45;&gt;layer1_gelu</title>
<path fill="none" stroke="black" d="M960,-28319.05C960,-28310.94 960,-28302.15 960,-28293.64"/>
<polygon fill="black" stroke="black" points="963.5,-28293.47 960,-28283.47 956.5,-28293.47 963.5,-28293.47"/>
</g>
<!-- layer1_mlp2 -->
<g id="node36" class="node">
<title>layer1_mlp2</title>
<polygon fill="yellow" stroke="black" points="1208.5,-28179.17 717.5,-28179.17 717.5,-28111.17 1208.5,-28111.17 1208.5,-28179.17"/>
<text text-anchor="middle" x="963" y="-28163.97" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="963" y="-28148.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="963" y="-28133.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="963" y="-28118.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gelu&#45;&gt;layer1_mlp2 -->
<g id="edge42" class="edge">
<title>layer1_gelu&#45;&gt;layer1_mlp2</title>
<path fill="none" stroke="black" d="M960.97,-28215.05C961.21,-28206.94 961.47,-28198.15 961.72,-28189.64"/>
<polygon fill="black" stroke="black" points="965.23,-28189.56 962.02,-28179.47 958.23,-28189.36 965.23,-28189.56"/>
</g>
<!-- layer1_mlp2&#45;&gt;layer1_res2 -->
<g id="edge44" class="edge">
<title>layer1_mlp2&#45;&gt;layer1_res2</title>
<path fill="none" stroke="black" d="M971.17,-28111.02C973.18,-28102.87 975.38,-28093.98 977.53,-28085.22"/>
<polygon fill="black" stroke="black" points="980.95,-28085.99 979.95,-28075.44 974.15,-28084.32 980.95,-28085.99"/>
</g>
<!-- send_to_gpu_2 -->
<g id="node38" class="node">
<title>send_to_gpu_2</title>
<polygon fill="yellow" stroke="black" points="1475.4,-27956.17 703.24,-27956.17 504.6,-27820.17 1276.76,-27820.17 1475.4,-27956.17"/>
<text text-anchor="middle" x="990" y="-27906.97" font-family="Times,serif" font-size="14.00">Send to GPU 2</text>
<text text-anchor="middle" x="990" y="-27891.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="990" y="-27876.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="990" y="-27861.97" font-family="Times,serif" font-size="14.00">GPU: 1 â†’ GPU 2</text>
</g>
<!-- layer1_res2&#45;&gt;send_to_gpu_2 -->
<g id="edge45" class="edge">
<title>layer1_res2&#45;&gt;send_to_gpu_2</title>
<path fill="none" stroke="black" d="M990,-27991.93C990,-27983.95 990,-27975.33 990,-27966.61"/>
<polygon fill="black" stroke="black" points="993.5,-27966.34 990,-27956.34 986.5,-27966.34 993.5,-27966.34"/>
</g>
<!-- comm_layer_2 -->
<g id="node39" class="node">
<title>comm_layer_2</title>
<polygon fill="yellow" stroke="black" points="1475.4,-27758.17 703.24,-27758.17 504.6,-27622.17 1276.76,-27622.17 1475.4,-27758.17"/>
<text text-anchor="middle" x="990" y="-27708.97" font-family="Times,serif" font-size="14.00">Receive from GPU 1</text>
<text text-anchor="middle" x="990" y="-27693.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="990" y="-27678.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="990" y="-27663.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- send_to_gpu_2&#45;&gt;comm_layer_2 -->
<g id="edge46" class="edge">
<title>send_to_gpu_2&#45;&gt;comm_layer_2</title>
<path fill="none" stroke="black" d="M990,-27819.99C990,-27803.47 990,-27785.65 990,-27768.69"/>
<polygon fill="black" stroke="black" points="993.5,-27768.26 990,-27758.26 986.5,-27768.26 993.5,-27768.26"/>
</g>
<!-- layer2_ln1 -->
<g id="node40" class="node">
<title>layer2_ln1</title>
<polygon fill="yellow" stroke="black" points="1242,-27586.17 774,-27586.17 774,-27518.17 1242,-27518.17 1242,-27586.17"/>
<text text-anchor="middle" x="1008" y="-27570.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1008" y="-27555.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1008" y="-27540.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1008" y="-27525.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- comm_layer_2&#45;&gt;layer2_ln1 -->
<g id="edge47" class="edge">
<title>comm_layer_2&#45;&gt;layer2_ln1</title>
<path fill="none" stroke="black" d="M998.89,-27621.96C1000.05,-27613.21 1001.21,-27604.44 1002.3,-27596.23"/>
<polygon fill="black" stroke="black" points="1005.79,-27596.56 1003.63,-27586.18 998.85,-27595.64 1005.79,-27596.56"/>
</g>
<!-- layer2_res1 -->
<g id="node51" class="node">
<title>layer2_res1</title>
<polygon fill="yellow" stroke="black" points="1430,-26620.17 962,-26620.17 962,-26537.17 1430,-26537.17 1430,-26620.17"/>
<text text-anchor="middle" x="1196" y="-26604.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1196" y="-26589.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1196" y="-26574.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1196" y="-26559.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1196" y="-26544.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- comm_layer_2&#45;&gt;layer2_res1 -->
<g id="edge60" class="edge">
<title>comm_layer_2&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M1300.63,-27638.48C1394.89,-27604.05 1474,-27546.24 1474,-27449.17 1474,-27449.17 1474,-27449.17 1474,-26793.17 1474,-26729.08 1474.32,-26701.48 1429,-26656.17 1416.79,-26643.96 1402.61,-26633.7 1387.38,-26625.08"/>
<polygon fill="black" stroke="black" points="1388.76,-26621.85 1378.3,-26620.19 1385.45,-26628.02 1388.76,-26621.85"/>
</g>
<!-- layer2_qkv -->
<g id="node41" class="node">
<title>layer2_qkv</title>
<polygon fill="yellow" stroke="black" points="1387.5,-27482.17 768.5,-27482.17 768.5,-27414.17 1387.5,-27414.17 1387.5,-27482.17"/>
<text text-anchor="middle" x="1078" y="-27466.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1078" y="-27451.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1078" y="-27436.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1078" y="-27421.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_qkv -->
<g id="edge48" class="edge">
<title>layer2_ln1&#45;&gt;layer2_qkv</title>
<path fill="none" stroke="black" d="M1030.73,-27518.05C1036.66,-27509.41 1043.12,-27499.99 1049.32,-27490.96"/>
<polygon fill="black" stroke="black" points="1052.37,-27492.69 1055.15,-27482.47 1046.6,-27488.73 1052.37,-27492.69"/>
</g>
<!-- layer2_reshape_qkv -->
<g id="node42" class="node">
<title>layer2_reshape_qkv</title>
<polygon fill="yellow" stroke="black" points="1422.5,-27378.17 803.5,-27378.17 803.5,-27310.17 1422.5,-27310.17 1422.5,-27378.17"/>
<text text-anchor="middle" x="1113" y="-27362.97" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1113" y="-27347.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1113" y="-27332.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1113" y="-27317.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_qkv&#45;&gt;layer2_reshape_qkv -->
<g id="edge49" class="edge">
<title>layer2_qkv&#45;&gt;layer2_reshape_qkv</title>
<path fill="none" stroke="black" d="M1089.36,-27414.05C1092.21,-27405.77 1095.3,-27396.76 1098.28,-27388.08"/>
<polygon fill="black" stroke="black" points="1101.64,-27389.06 1101.57,-27378.47 1095.02,-27386.79 1101.64,-27389.06"/>
</g>
<!-- layer2_split_q -->
<g id="node43" class="node">
<title>layer2_split_q</title>
<polygon fill="yellow" stroke="black" points="809.5,-27274.17 202.5,-27274.17 202.5,-27206.17 809.5,-27206.17 809.5,-27274.17"/>
<text text-anchor="middle" x="506" y="-27258.97" font-family="Times,serif" font-size="14.00">Split Query</text>
<text text-anchor="middle" x="506" y="-27243.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="506" y="-27228.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="506" y="-27213.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_reshape_qkv&#45;&gt;layer2_split_q -->
<g id="edge50" class="edge">
<title>layer2_reshape_qkv&#45;&gt;layer2_split_q</title>
<path fill="none" stroke="black" d="M916.34,-27310.12C851.21,-27299.18 778.55,-27286.97 712.69,-27275.9"/>
<polygon fill="black" stroke="black" points="713.05,-27272.41 702.6,-27274.2 711.88,-27279.31 713.05,-27272.41"/>
</g>
<!-- layer2_split_k -->
<g id="node44" class="node">
<title>layer2_split_k</title>
<polygon fill="yellow" stroke="black" points="1434.5,-27274.17 827.5,-27274.17 827.5,-27206.17 1434.5,-27206.17 1434.5,-27274.17"/>
<text text-anchor="middle" x="1131" y="-27258.97" font-family="Times,serif" font-size="14.00">Split Key</text>
<text text-anchor="middle" x="1131" y="-27243.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1131" y="-27228.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1131" y="-27213.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_reshape_qkv&#45;&gt;layer2_split_k -->
<g id="edge51" class="edge">
<title>layer2_reshape_qkv&#45;&gt;layer2_split_k</title>
<path fill="none" stroke="black" d="M1118.84,-27310.05C1120.29,-27301.86 1121.86,-27292.96 1123.38,-27284.36"/>
<polygon fill="black" stroke="black" points="1126.83,-27284.92 1125.12,-27274.47 1119.94,-27283.71 1126.83,-27284.92"/>
</g>
<!-- layer2_split_v -->
<g id="node45" class="node">
<title>layer2_split_v</title>
<polygon fill="yellow" stroke="black" points="1454.5,-27162.67 847.5,-27162.67 847.5,-27094.67 1454.5,-27094.67 1454.5,-27162.67"/>
<text text-anchor="middle" x="1151" y="-27147.47" font-family="Times,serif" font-size="14.00">Split Value</text>
<text text-anchor="middle" x="1151" y="-27132.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1151" y="-27117.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1151" y="-27102.47" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_reshape_qkv&#45;&gt;layer2_split_v -->
<g id="edge52" class="edge">
<title>layer2_reshape_qkv&#45;&gt;layer2_split_v</title>
<path fill="none" stroke="black" d="M1370.33,-27310.08C1404.49,-27300.79 1431.92,-27289.03 1444,-27274.17 1463.07,-27250.72 1462.47,-27230.08 1444,-27206.17 1431.37,-27189.82 1398.88,-27176.3 1359.92,-27165.41"/>
<polygon fill="black" stroke="black" points="1360.45,-27161.93 1349.88,-27162.7 1358.62,-27168.68 1360.45,-27161.93"/>
</g>
<!-- layer2_attn_score -->
<g id="node46" class="node">
<title>layer2_attn_score</title>
<polygon fill="yellow" stroke="black" points="829,-27170.17 263,-27170.17 263,-27087.17 829,-27087.17 829,-27170.17"/>
<text text-anchor="middle" x="546" y="-27154.97" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="546" y="-27139.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="546" y="-27124.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="546" y="-27109.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="546" y="-27094.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_split_q&#45;&gt;layer2_attn_score -->
<g id="edge53" class="edge">
<title>layer2_split_q&#45;&gt;layer2_attn_score</title>
<path fill="none" stroke="black" d="M518.11,-27206.02C521.12,-27197.79 524.4,-27188.78 527.64,-27179.94"/>
<polygon fill="black" stroke="black" points="530.96,-27181.04 531.1,-27170.44 524.39,-27178.64 530.96,-27181.04"/>
</g>
<!-- layer2_split_k&#45;&gt;layer2_attn_score -->
<g id="edge54" class="edge">
<title>layer2_split_k&#45;&gt;layer2_attn_score</title>
<path fill="none" stroke="black" d="M954.69,-27206.16C897.4,-27195.44 833.02,-27183.39 772.6,-27172.08"/>
<polygon fill="black" stroke="black" points="773.02,-27168.6 762.54,-27170.2 771.73,-27175.48 773.02,-27168.6"/>
</g>
<!-- layer2_attn_out -->
<g id="node48" class="node">
<title>layer2_attn_out</title>
<polygon fill="yellow" stroke="black" points="1432.5,-26947.17 869.5,-26947.17 869.5,-26864.17 1432.5,-26864.17 1432.5,-26947.17"/>
<text text-anchor="middle" x="1151" y="-26931.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1151" y="-26916.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1151" y="-26901.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1151" y="-26886.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1151" y="-26871.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_split_v&#45;&gt;layer2_attn_out -->
<g id="edge57" class="edge">
<title>layer2_split_v&#45;&gt;layer2_attn_out</title>
<path fill="none" stroke="black" d="M1151,-27094.58C1151,-27058.32 1151,-26999.7 1151,-26957.57"/>
<polygon fill="black" stroke="black" points="1154.5,-26957.51 1151,-26947.51 1147.5,-26957.51 1154.5,-26957.51"/>
</g>
<!-- layer2_attn_weights -->
<g id="node47" class="node">
<title>layer2_attn_weights</title>
<polygon fill="yellow" stroke="black" points="981,-27051.17 415,-27051.17 415,-26983.17 981,-26983.17 981,-27051.17"/>
<text text-anchor="middle" x="698" y="-27035.97" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="698" y="-27020.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="698" y="-27005.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="698" y="-26990.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_attn_score&#45;&gt;layer2_attn_weights -->
<g id="edge55" class="edge">
<title>layer2_attn_score&#45;&gt;layer2_attn_weights</title>
<path fill="none" stroke="black" d="M602.6,-27086.89C616.02,-27077.22 630.31,-27066.93 643.62,-27057.34"/>
<polygon fill="black" stroke="black" points="645.71,-27060.15 651.78,-27051.47 641.62,-27054.47 645.71,-27060.15"/>
</g>
<!-- layer2_attn_weights&#45;&gt;layer2_attn_out -->
<g id="edge56" class="edge">
<title>layer2_attn_weights&#45;&gt;layer2_attn_out</title>
<path fill="none" stroke="black" d="M834.53,-26983.16C878.19,-26972.61 927.17,-26960.77 973.31,-26949.62"/>
<polygon fill="black" stroke="black" points="974.21,-26953 983.11,-26947.25 972.57,-26946.2 974.21,-26953"/>
</g>
<!-- layer2_attn_reshape -->
<g id="node49" class="node">
<title>layer2_attn_reshape</title>
<polygon fill="yellow" stroke="black" points="1440.5,-26828.17 889.5,-26828.17 889.5,-26760.17 1440.5,-26760.17 1440.5,-26828.17"/>
<text text-anchor="middle" x="1165" y="-26812.97" font-family="Times,serif" font-size="14.00">Reshape Attention</text>
<text text-anchor="middle" x="1165" y="-26797.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1165" y="-26782.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1165" y="-26767.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_attn_out&#45;&gt;layer2_attn_reshape -->
<g id="edge58" class="edge">
<title>layer2_attn_out&#45;&gt;layer2_attn_reshape</title>
<path fill="none" stroke="black" d="M1156.21,-26863.89C1157.27,-26855.59 1158.39,-26846.83 1159.47,-26838.45"/>
<polygon fill="black" stroke="black" points="1162.95,-26838.83 1160.74,-26828.47 1156,-26837.94 1162.95,-26838.83"/>
</g>
<!-- layer2_attn_proj -->
<g id="node50" class="node">
<title>layer2_attn_proj</title>
<polygon fill="yellow" stroke="black" points="1420,-26724.17 952,-26724.17 952,-26656.17 1420,-26656.17 1420,-26724.17"/>
<text text-anchor="middle" x="1186" y="-26708.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="1186" y="-26693.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1186" y="-26678.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1186" y="-26663.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_attn_reshape&#45;&gt;layer2_attn_proj -->
<g id="edge59" class="edge">
<title>layer2_attn_reshape&#45;&gt;layer2_attn_proj</title>
<path fill="none" stroke="black" d="M1171.82,-26760.05C1173.51,-26751.86 1175.34,-26742.96 1177.11,-26734.36"/>
<polygon fill="black" stroke="black" points="1180.56,-26734.97 1179.14,-26724.47 1173.7,-26733.55 1180.56,-26734.97"/>
</g>
<!-- layer2_attn_proj&#45;&gt;layer2_res1 -->
<g id="edge61" class="edge">
<title>layer2_attn_proj&#45;&gt;layer2_res1</title>
<path fill="none" stroke="black" d="M1189.03,-26656.02C1189.76,-26647.96 1190.57,-26639.17 1191.36,-26630.5"/>
<polygon fill="black" stroke="black" points="1194.85,-26630.72 1192.28,-26620.44 1187.88,-26630.08 1194.85,-26630.72"/>
</g>
<!-- layer2_ln2 -->
<g id="node52" class="node">
<title>layer2_ln2</title>
<polygon fill="yellow" stroke="black" points="1188,-26501.17 720,-26501.17 720,-26433.17 1188,-26433.17 1188,-26501.17"/>
<text text-anchor="middle" x="954" y="-26485.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="954" y="-26470.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="954" y="-26455.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="954" y="-26440.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_ln2 -->
<g id="edge62" class="edge">
<title>layer2_res1&#45;&gt;layer2_ln2</title>
<path fill="none" stroke="black" d="M1106.23,-26537.05C1083.3,-26526.67 1058.75,-26515.57 1036.22,-26505.37"/>
<polygon fill="black" stroke="black" points="1037.58,-26502.14 1027.03,-26501.21 1034.7,-26508.52 1037.58,-26502.14"/>
</g>
<!-- layer2_res2 -->
<g id="node56" class="node">
<title>layer2_res2</title>
<polygon fill="yellow" stroke="black" points="1204,-26085.17 736,-26085.17 736,-26002.17 1204,-26002.17 1204,-26085.17"/>
<text text-anchor="middle" x="970" y="-26069.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="970" y="-26054.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="970" y="-26039.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="970" y="-26024.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="970" y="-26009.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_res1&#45;&gt;layer2_res2 -->
<g id="edge66" class="edge">
<title>layer2_res1&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M1202.11,-26536.84C1207.99,-26493.95 1216,-26424.48 1216,-26364.17 1216,-26364.17 1216,-26364.17 1216,-26258.17 1216,-26197 1241.18,-26168.95 1203,-26121.17 1193.46,-26109.23 1182.02,-26099.13 1169.39,-26090.6"/>
<polygon fill="black" stroke="black" points="1171.25,-26087.63 1160.93,-26085.22 1167.49,-26093.54 1171.25,-26087.63"/>
</g>
<!-- layer2_mlp1 -->
<g id="node53" class="node">
<title>layer2_mlp1</title>
<polygon fill="yellow" stroke="black" points="1196.5,-26397.17 693.5,-26397.17 693.5,-26329.17 1196.5,-26329.17 1196.5,-26397.17"/>
<text text-anchor="middle" x="945" y="-26381.97" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="945" y="-26366.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="945" y="-26351.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="945" y="-26336.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_ln2&#45;&gt;layer2_mlp1 -->
<g id="edge63" class="edge">
<title>layer2_ln2&#45;&gt;layer2_mlp1</title>
<path fill="none" stroke="black" d="M951.08,-26433.05C950.36,-26424.94 949.59,-26416.15 948.84,-26407.64"/>
<polygon fill="black" stroke="black" points="952.3,-26407.12 947.94,-26397.47 945.33,-26407.73 952.3,-26407.12"/>
</g>
<!-- layer2_gelu -->
<g id="node54" class="node">
<title>layer2_gelu</title>
<polygon fill="yellow" stroke="black" points="1196.5,-26293.17 693.5,-26293.17 693.5,-26225.17 1196.5,-26225.17 1196.5,-26293.17"/>
<text text-anchor="middle" x="945" y="-26277.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="945" y="-26262.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="945" y="-26247.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="945" y="-26232.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_mlp1&#45;&gt;layer2_gelu -->
<g id="edge64" class="edge">
<title>layer2_mlp1&#45;&gt;layer2_gelu</title>
<path fill="none" stroke="black" d="M945,-26329.05C945,-26320.94 945,-26312.15 945,-26303.64"/>
<polygon fill="black" stroke="black" points="948.5,-26303.47 945,-26293.47 941.5,-26303.47 948.5,-26303.47"/>
</g>
<!-- layer2_mlp2 -->
<g id="node55" class="node">
<title>layer2_mlp2</title>
<polygon fill="yellow" stroke="black" points="1193.5,-26189.17 702.5,-26189.17 702.5,-26121.17 1193.5,-26121.17 1193.5,-26189.17"/>
<text text-anchor="middle" x="948" y="-26173.97" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="948" y="-26158.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="948" y="-26143.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="948" y="-26128.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gelu&#45;&gt;layer2_mlp2 -->
<g id="edge65" class="edge">
<title>layer2_gelu&#45;&gt;layer2_mlp2</title>
<path fill="none" stroke="black" d="M945.97,-26225.05C946.21,-26216.94 946.47,-26208.15 946.72,-26199.64"/>
<polygon fill="black" stroke="black" points="950.23,-26199.56 947.02,-26189.47 943.23,-26199.36 950.23,-26199.56"/>
</g>
<!-- layer2_mlp2&#45;&gt;layer2_res2 -->
<g id="edge67" class="edge">
<title>layer2_mlp2&#45;&gt;layer2_res2</title>
<path fill="none" stroke="black" d="M954.66,-26121.02C956.28,-26112.96 958.05,-26104.17 959.79,-26095.5"/>
<polygon fill="black" stroke="black" points="963.27,-26095.94 961.81,-26085.44 956.41,-26094.56 963.27,-26095.94"/>
</g>
<!-- send_to_gpu_3 -->
<g id="node57" class="node">
<title>send_to_gpu_3</title>
<polygon fill="yellow" stroke="black" points="1455.4,-25966.17 683.24,-25966.17 484.6,-25830.17 1256.76,-25830.17 1455.4,-25966.17"/>
<text text-anchor="middle" x="970" y="-25916.97" font-family="Times,serif" font-size="14.00">Send to GPU 3</text>
<text text-anchor="middle" x="970" y="-25901.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="970" y="-25886.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="970" y="-25871.97" font-family="Times,serif" font-size="14.00">GPU: 2 â†’ GPU 3</text>
</g>
<!-- layer2_res2&#45;&gt;send_to_gpu_3 -->
<g id="edge68" class="edge">
<title>layer2_res2&#45;&gt;send_to_gpu_3</title>
<path fill="none" stroke="black" d="M970,-26001.93C970,-25993.95 970,-25985.33 970,-25976.61"/>
<polygon fill="black" stroke="black" points="973.5,-25976.34 970,-25966.34 966.5,-25976.34 973.5,-25976.34"/>
</g>
<!-- comm_layer_3 -->
<g id="node58" class="node">
<title>comm_layer_3</title>
<polygon fill="yellow" stroke="black" points="1455.4,-25768.17 683.24,-25768.17 484.6,-25632.17 1256.76,-25632.17 1455.4,-25768.17"/>
<text text-anchor="middle" x="970" y="-25718.97" font-family="Times,serif" font-size="14.00">Receive from GPU 2</text>
<text text-anchor="middle" x="970" y="-25703.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="970" y="-25688.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="970" y="-25673.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- send_to_gpu_3&#45;&gt;comm_layer_3 -->
<g id="edge69" class="edge">
<title>send_to_gpu_3&#45;&gt;comm_layer_3</title>
<path fill="none" stroke="black" d="M970,-25829.99C970,-25813.47 970,-25795.65 970,-25778.69"/>
<polygon fill="black" stroke="black" points="973.5,-25778.26 970,-25768.26 966.5,-25778.26 973.5,-25778.26"/>
</g>
<!-- layer3_ln1 -->
<g id="node59" class="node">
<title>layer3_ln1</title>
<polygon fill="yellow" stroke="black" points="1222,-25596.17 754,-25596.17 754,-25528.17 1222,-25528.17 1222,-25596.17"/>
<text text-anchor="middle" x="988" y="-25580.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="988" y="-25565.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="988" y="-25550.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="988" y="-25535.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- comm_layer_3&#45;&gt;layer3_ln1 -->
<g id="edge70" class="edge">
<title>comm_layer_3&#45;&gt;layer3_ln1</title>
<path fill="none" stroke="black" d="M978.89,-25631.96C980.05,-25623.21 981.21,-25614.44 982.3,-25606.23"/>
<polygon fill="black" stroke="black" points="985.79,-25606.56 983.63,-25596.18 978.85,-25605.64 985.79,-25606.56"/>
</g>
<!-- layer3_res1 -->
<g id="node70" class="node">
<title>layer3_res1</title>
<polygon fill="yellow" stroke="black" points="1403,-24630.17 935,-24630.17 935,-24547.17 1403,-24547.17 1403,-24630.17"/>
<text text-anchor="middle" x="1169" y="-24614.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1169" y="-24599.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1169" y="-24584.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1169" y="-24569.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1169" y="-24554.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- comm_layer_3&#45;&gt;layer3_res1 -->
<g id="edge83" class="edge">
<title>comm_layer_3&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M1280.63,-25648.48C1374.89,-25614.05 1454,-25556.24 1454,-25459.17 1454,-25459.17 1454,-25459.17 1454,-24803.17 1454,-24735.19 1436.9,-24711.22 1386,-24666.17 1372.18,-24653.94 1356.28,-24643.63 1339.51,-24634.95"/>
<polygon fill="black" stroke="black" points="1340.62,-24631.59 1330.11,-24630.29 1337.51,-24637.87 1340.62,-24631.59"/>
</g>
<!-- layer3_qkv -->
<g id="node60" class="node">
<title>layer3_qkv</title>
<polygon fill="yellow" stroke="black" points="1367.5,-25492.17 748.5,-25492.17 748.5,-25424.17 1367.5,-25424.17 1367.5,-25492.17"/>
<text text-anchor="middle" x="1058" y="-25476.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1058" y="-25461.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1058" y="-25446.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1058" y="-25431.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_qkv -->
<g id="edge71" class="edge">
<title>layer3_ln1&#45;&gt;layer3_qkv</title>
<path fill="none" stroke="black" d="M1010.73,-25528.05C1016.66,-25519.41 1023.12,-25509.99 1029.32,-25500.96"/>
<polygon fill="black" stroke="black" points="1032.37,-25502.69 1035.15,-25492.47 1026.6,-25498.73 1032.37,-25502.69"/>
</g>
<!-- layer3_reshape_qkv -->
<g id="node61" class="node">
<title>layer3_reshape_qkv</title>
<polygon fill="yellow" stroke="black" points="1402.5,-25388.17 783.5,-25388.17 783.5,-25320.17 1402.5,-25320.17 1402.5,-25388.17"/>
<text text-anchor="middle" x="1093" y="-25372.97" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1093" y="-25357.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1093" y="-25342.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1093" y="-25327.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_qkv&#45;&gt;layer3_reshape_qkv -->
<g id="edge72" class="edge">
<title>layer3_qkv&#45;&gt;layer3_reshape_qkv</title>
<path fill="none" stroke="black" d="M1069.36,-25424.05C1072.21,-25415.77 1075.3,-25406.76 1078.28,-25398.08"/>
<polygon fill="black" stroke="black" points="1081.64,-25399.06 1081.57,-25388.47 1075.02,-25396.79 1081.64,-25399.06"/>
</g>
<!-- layer3_split_q -->
<g id="node62" class="node">
<title>layer3_split_q</title>
<polygon fill="yellow" stroke="black" points="789.5,-25284.17 182.5,-25284.17 182.5,-25216.17 789.5,-25216.17 789.5,-25284.17"/>
<text text-anchor="middle" x="486" y="-25268.97" font-family="Times,serif" font-size="14.00">Split Query</text>
<text text-anchor="middle" x="486" y="-25253.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="486" y="-25238.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="486" y="-25223.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_reshape_qkv&#45;&gt;layer3_split_q -->
<g id="edge73" class="edge">
<title>layer3_reshape_qkv&#45;&gt;layer3_split_q</title>
<path fill="none" stroke="black" d="M896.34,-25320.12C831.21,-25309.18 758.55,-25296.97 692.69,-25285.9"/>
<polygon fill="black" stroke="black" points="693.05,-25282.41 682.6,-25284.2 691.88,-25289.31 693.05,-25282.41"/>
</g>
<!-- layer3_split_k -->
<g id="node63" class="node">
<title>layer3_split_k</title>
<polygon fill="yellow" stroke="black" points="1414.5,-25284.17 807.5,-25284.17 807.5,-25216.17 1414.5,-25216.17 1414.5,-25284.17"/>
<text text-anchor="middle" x="1111" y="-25268.97" font-family="Times,serif" font-size="14.00">Split Key</text>
<text text-anchor="middle" x="1111" y="-25253.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1111" y="-25238.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1111" y="-25223.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_reshape_qkv&#45;&gt;layer3_split_k -->
<g id="edge74" class="edge">
<title>layer3_reshape_qkv&#45;&gt;layer3_split_k</title>
<path fill="none" stroke="black" d="M1098.84,-25320.05C1100.29,-25311.86 1101.86,-25302.96 1103.38,-25294.36"/>
<polygon fill="black" stroke="black" points="1106.83,-25294.92 1105.12,-25284.47 1099.94,-25293.71 1106.83,-25294.92"/>
</g>
<!-- layer3_split_v -->
<g id="node64" class="node">
<title>layer3_split_v</title>
<polygon fill="yellow" stroke="black" points="1434.5,-25172.67 827.5,-25172.67 827.5,-25104.67 1434.5,-25104.67 1434.5,-25172.67"/>
<text text-anchor="middle" x="1131" y="-25157.47" font-family="Times,serif" font-size="14.00">Split Value</text>
<text text-anchor="middle" x="1131" y="-25142.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1131" y="-25127.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1131" y="-25112.47" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_reshape_qkv&#45;&gt;layer3_split_v -->
<g id="edge75" class="edge">
<title>layer3_reshape_qkv&#45;&gt;layer3_split_v</title>
<path fill="none" stroke="black" d="M1350.33,-25320.08C1384.49,-25310.79 1411.92,-25299.03 1424,-25284.17 1443.07,-25260.72 1442.47,-25240.08 1424,-25216.17 1411.37,-25199.82 1378.88,-25186.3 1339.92,-25175.41"/>
<polygon fill="black" stroke="black" points="1340.45,-25171.93 1329.88,-25172.7 1338.62,-25178.68 1340.45,-25171.93"/>
</g>
<!-- layer3_attn_score -->
<g id="node65" class="node">
<title>layer3_attn_score</title>
<polygon fill="yellow" stroke="black" points="809,-25180.17 243,-25180.17 243,-25097.17 809,-25097.17 809,-25180.17"/>
<text text-anchor="middle" x="526" y="-25164.97" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="526" y="-25149.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="526" y="-25134.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="526" y="-25119.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="526" y="-25104.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_split_q&#45;&gt;layer3_attn_score -->
<g id="edge76" class="edge">
<title>layer3_split_q&#45;&gt;layer3_attn_score</title>
<path fill="none" stroke="black" d="M498.11,-25216.02C501.12,-25207.79 504.4,-25198.78 507.64,-25189.94"/>
<polygon fill="black" stroke="black" points="510.96,-25191.04 511.1,-25180.44 504.39,-25188.64 510.96,-25191.04"/>
</g>
<!-- layer3_split_k&#45;&gt;layer3_attn_score -->
<g id="edge77" class="edge">
<title>layer3_split_k&#45;&gt;layer3_attn_score</title>
<path fill="none" stroke="black" d="M934.69,-25216.16C877.4,-25205.44 813.02,-25193.39 752.6,-25182.08"/>
<polygon fill="black" stroke="black" points="753.02,-25178.6 742.54,-25180.2 751.73,-25185.48 753.02,-25178.6"/>
</g>
<!-- layer3_attn_out -->
<g id="node67" class="node">
<title>layer3_attn_out</title>
<polygon fill="yellow" stroke="black" points="1412.5,-24957.17 849.5,-24957.17 849.5,-24874.17 1412.5,-24874.17 1412.5,-24957.17"/>
<text text-anchor="middle" x="1131" y="-24941.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1131" y="-24926.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1131" y="-24911.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1131" y="-24896.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1131" y="-24881.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_split_v&#45;&gt;layer3_attn_out -->
<g id="edge80" class="edge">
<title>layer3_split_v&#45;&gt;layer3_attn_out</title>
<path fill="none" stroke="black" d="M1131,-25104.58C1131,-25068.32 1131,-25009.7 1131,-24967.57"/>
<polygon fill="black" stroke="black" points="1134.5,-24967.51 1131,-24957.51 1127.5,-24967.51 1134.5,-24967.51"/>
</g>
<!-- layer3_attn_weights -->
<g id="node66" class="node">
<title>layer3_attn_weights</title>
<polygon fill="yellow" stroke="black" points="961,-25061.17 395,-25061.17 395,-24993.17 961,-24993.17 961,-25061.17"/>
<text text-anchor="middle" x="678" y="-25045.97" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="678" y="-25030.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="678" y="-25015.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="678" y="-25000.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_attn_score&#45;&gt;layer3_attn_weights -->
<g id="edge78" class="edge">
<title>layer3_attn_score&#45;&gt;layer3_attn_weights</title>
<path fill="none" stroke="black" d="M582.6,-25096.89C596.02,-25087.22 610.31,-25076.93 623.62,-25067.34"/>
<polygon fill="black" stroke="black" points="625.71,-25070.15 631.78,-25061.47 621.62,-25064.47 625.71,-25070.15"/>
</g>
<!-- layer3_attn_weights&#45;&gt;layer3_attn_out -->
<g id="edge79" class="edge">
<title>layer3_attn_weights&#45;&gt;layer3_attn_out</title>
<path fill="none" stroke="black" d="M814.53,-24993.16C858.19,-24982.61 907.17,-24970.77 953.31,-24959.62"/>
<polygon fill="black" stroke="black" points="954.21,-24963 963.11,-24957.25 952.57,-24956.2 954.21,-24963"/>
</g>
<!-- layer3_attn_reshape -->
<g id="node68" class="node">
<title>layer3_attn_reshape</title>
<polygon fill="yellow" stroke="black" points="1410.5,-24838.17 859.5,-24838.17 859.5,-24770.17 1410.5,-24770.17 1410.5,-24838.17"/>
<text text-anchor="middle" x="1135" y="-24822.97" font-family="Times,serif" font-size="14.00">Reshape Attention</text>
<text text-anchor="middle" x="1135" y="-24807.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1135" y="-24792.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1135" y="-24777.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_attn_out&#45;&gt;layer3_attn_reshape -->
<g id="edge81" class="edge">
<title>layer3_attn_out&#45;&gt;layer3_attn_reshape</title>
<path fill="none" stroke="black" d="M1132.49,-24873.89C1132.79,-24865.68 1133.11,-24857.03 1133.41,-24848.73"/>
<polygon fill="black" stroke="black" points="1136.92,-24848.59 1133.78,-24838.47 1129.92,-24848.33 1136.92,-24848.59"/>
</g>
<!-- layer3_attn_proj -->
<g id="node69" class="node">
<title>layer3_attn_proj</title>
<polygon fill="yellow" stroke="black" points="1377,-24734.17 909,-24734.17 909,-24666.17 1377,-24666.17 1377,-24734.17"/>
<text text-anchor="middle" x="1143" y="-24718.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="1143" y="-24703.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1143" y="-24688.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1143" y="-24673.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_attn_reshape&#45;&gt;layer3_attn_proj -->
<g id="edge82" class="edge">
<title>layer3_attn_reshape&#45;&gt;layer3_attn_proj</title>
<path fill="none" stroke="black" d="M1137.6,-24770.05C1138.23,-24761.94 1138.92,-24753.15 1139.59,-24744.64"/>
<polygon fill="black" stroke="black" points="1143.1,-24744.71 1140.39,-24734.47 1136.12,-24744.16 1143.1,-24744.71"/>
</g>
<!-- layer3_attn_proj&#45;&gt;layer3_res1 -->
<g id="edge84" class="edge">
<title>layer3_attn_proj&#45;&gt;layer3_res1</title>
<path fill="none" stroke="black" d="M1150.87,-24666.02C1152.8,-24657.87 1154.92,-24648.98 1157,-24640.22"/>
<polygon fill="black" stroke="black" points="1160.41,-24640.98 1159.32,-24630.44 1153.6,-24639.36 1160.41,-24640.98"/>
</g>
<!-- layer3_ln2 -->
<g id="node71" class="node">
<title>layer3_ln2</title>
<polygon fill="yellow" stroke="black" points="1193,-24511.17 725,-24511.17 725,-24443.17 1193,-24443.17 1193,-24511.17"/>
<text text-anchor="middle" x="959" y="-24495.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="959" y="-24480.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="959" y="-24465.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="959" y="-24450.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_ln2 -->
<g id="edge85" class="edge">
<title>layer3_res1&#45;&gt;layer3_ln2</title>
<path fill="none" stroke="black" d="M1091.1,-24547.05C1071.55,-24536.86 1050.66,-24525.96 1031.39,-24515.91"/>
<polygon fill="black" stroke="black" points="1032.86,-24512.73 1022.37,-24511.21 1029.62,-24518.94 1032.86,-24512.73"/>
</g>
<!-- layer3_res2 -->
<g id="node75" class="node">
<title>layer3_res2</title>
<polygon fill="yellow" stroke="black" points="1200,-24095.17 732,-24095.17 732,-24012.17 1200,-24012.17 1200,-24095.17"/>
<text text-anchor="middle" x="966" y="-24079.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="966" y="-24064.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="966" y="-24049.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="966" y="-24034.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="966" y="-24019.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_res1&#45;&gt;layer3_res2 -->
<g id="edge89" class="edge">
<title>layer3_res1&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M1188.9,-24547.12C1193.83,-24535.71 1198.65,-24523.15 1202,-24511.17 1218.55,-24451.96 1221,-24435.64 1221,-24374.17 1221,-24374.17 1221,-24374.17 1221,-24268.17 1221,-24207 1246.44,-24178.74 1208,-24131.17 1198.4,-24119.29 1186.97,-24109.22 1174.37,-24100.7"/>
<polygon fill="black" stroke="black" points="1176.24,-24097.74 1165.93,-24095.32 1172.48,-24103.65 1176.24,-24097.74"/>
</g>
<!-- layer3_mlp1 -->
<g id="node72" class="node">
<title>layer3_mlp1</title>
<polygon fill="yellow" stroke="black" points="1201.5,-24407.17 698.5,-24407.17 698.5,-24339.17 1201.5,-24339.17 1201.5,-24407.17"/>
<text text-anchor="middle" x="950" y="-24391.97" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="950" y="-24376.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="950" y="-24361.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="950" y="-24346.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_ln2&#45;&gt;layer3_mlp1 -->
<g id="edge86" class="edge">
<title>layer3_ln2&#45;&gt;layer3_mlp1</title>
<path fill="none" stroke="black" d="M956.08,-24443.05C955.36,-24434.94 954.59,-24426.15 953.84,-24417.64"/>
<polygon fill="black" stroke="black" points="957.3,-24417.12 952.94,-24407.47 950.33,-24417.73 957.3,-24417.12"/>
</g>
<!-- layer3_gelu -->
<g id="node73" class="node">
<title>layer3_gelu</title>
<polygon fill="yellow" stroke="black" points="1201.5,-24303.17 698.5,-24303.17 698.5,-24235.17 1201.5,-24235.17 1201.5,-24303.17"/>
<text text-anchor="middle" x="950" y="-24287.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="950" y="-24272.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="950" y="-24257.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="950" y="-24242.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_mlp1&#45;&gt;layer3_gelu -->
<g id="edge87" class="edge">
<title>layer3_mlp1&#45;&gt;layer3_gelu</title>
<path fill="none" stroke="black" d="M950,-24339.05C950,-24330.94 950,-24322.15 950,-24313.64"/>
<polygon fill="black" stroke="black" points="953.5,-24313.47 950,-24303.47 946.5,-24313.47 953.5,-24313.47"/>
</g>
<!-- layer3_mlp2 -->
<g id="node74" class="node">
<title>layer3_mlp2</title>
<polygon fill="yellow" stroke="black" points="1198.5,-24199.17 707.5,-24199.17 707.5,-24131.17 1198.5,-24131.17 1198.5,-24199.17"/>
<text text-anchor="middle" x="953" y="-24183.97" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="953" y="-24168.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="953" y="-24153.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="953" y="-24138.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gelu&#45;&gt;layer3_mlp2 -->
<g id="edge88" class="edge">
<title>layer3_gelu&#45;&gt;layer3_mlp2</title>
<path fill="none" stroke="black" d="M950.97,-24235.05C951.21,-24226.94 951.47,-24218.15 951.72,-24209.64"/>
<polygon fill="black" stroke="black" points="955.23,-24209.56 952.02,-24199.47 948.23,-24209.36 955.23,-24209.56"/>
</g>
<!-- layer3_mlp2&#45;&gt;layer3_res2 -->
<g id="edge90" class="edge">
<title>layer3_mlp2&#45;&gt;layer3_res2</title>
<path fill="none" stroke="black" d="M956.94,-24131.02C957.89,-24122.96 958.94,-24114.17 959.96,-24105.5"/>
<polygon fill="black" stroke="black" points="963.46,-24105.79 961.16,-24095.44 956.5,-24104.96 963.46,-24105.79"/>
</g>
<!-- send_to_gpu_4 -->
<g id="node76" class="node">
<title>send_to_gpu_4</title>
<polygon fill="yellow" stroke="black" points="1451.4,-23976.17 679.24,-23976.17 480.6,-23840.17 1252.76,-23840.17 1451.4,-23976.17"/>
<text text-anchor="middle" x="966" y="-23926.97" font-family="Times,serif" font-size="14.00">Send to GPU 4</text>
<text text-anchor="middle" x="966" y="-23911.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="966" y="-23896.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="966" y="-23881.97" font-family="Times,serif" font-size="14.00">GPU: 3 â†’ GPU 4</text>
</g>
<!-- layer3_res2&#45;&gt;send_to_gpu_4 -->
<g id="edge91" class="edge">
<title>layer3_res2&#45;&gt;send_to_gpu_4</title>
<path fill="none" stroke="black" d="M966,-24011.93C966,-24003.95 966,-23995.33 966,-23986.61"/>
<polygon fill="black" stroke="black" points="969.5,-23986.34 966,-23976.34 962.5,-23986.34 969.5,-23986.34"/>
</g>
<!-- comm_layer_4 -->
<g id="node77" class="node">
<title>comm_layer_4</title>
<polygon fill="yellow" stroke="black" points="1451.4,-23778.17 679.24,-23778.17 480.6,-23642.17 1252.76,-23642.17 1451.4,-23778.17"/>
<text text-anchor="middle" x="966" y="-23728.97" font-family="Times,serif" font-size="14.00">Receive from GPU 3</text>
<text text-anchor="middle" x="966" y="-23713.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="966" y="-23698.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="966" y="-23683.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- send_to_gpu_4&#45;&gt;comm_layer_4 -->
<g id="edge92" class="edge">
<title>send_to_gpu_4&#45;&gt;comm_layer_4</title>
<path fill="none" stroke="black" d="M966,-23839.99C966,-23823.47 966,-23805.65 966,-23788.69"/>
<polygon fill="black" stroke="black" points="969.5,-23788.26 966,-23778.26 962.5,-23788.26 969.5,-23788.26"/>
</g>
<!-- layer4_ln1 -->
<g id="node78" class="node">
<title>layer4_ln1</title>
<polygon fill="yellow" stroke="black" points="1218,-23606.17 750,-23606.17 750,-23538.17 1218,-23538.17 1218,-23606.17"/>
<text text-anchor="middle" x="984" y="-23590.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="984" y="-23575.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="984" y="-23560.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="984" y="-23545.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- comm_layer_4&#45;&gt;layer4_ln1 -->
<g id="edge93" class="edge">
<title>comm_layer_4&#45;&gt;layer4_ln1</title>
<path fill="none" stroke="black" d="M974.89,-23641.96C976.05,-23633.21 977.21,-23624.44 978.3,-23616.23"/>
<polygon fill="black" stroke="black" points="981.79,-23616.56 979.63,-23606.18 974.85,-23615.64 981.79,-23616.56"/>
</g>
<!-- layer4_res1 -->
<g id="node89" class="node">
<title>layer4_res1</title>
<polygon fill="yellow" stroke="black" points="1404,-22640.17 936,-22640.17 936,-22557.17 1404,-22557.17 1404,-22640.17"/>
<text text-anchor="middle" x="1170" y="-22624.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1170" y="-22609.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1170" y="-22594.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1170" y="-22579.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1170" y="-22564.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- comm_layer_4&#45;&gt;layer4_res1 -->
<g id="edge106" class="edge">
<title>comm_layer_4&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M1276.63,-23658.48C1370.89,-23624.05 1450,-23566.24 1450,-23469.17 1450,-23469.17 1450,-23469.17 1450,-22813.17 1450,-22749.08 1450.38,-22721.42 1405,-22676.17 1392.81,-22664.01 1378.67,-22653.78 1363.49,-22645.18"/>
<polygon fill="black" stroke="black" points="1364.9,-22641.97 1354.43,-22640.3 1361.58,-22648.13 1364.9,-22641.97"/>
</g>
<!-- layer4_qkv -->
<g id="node79" class="node">
<title>layer4_qkv</title>
<polygon fill="yellow" stroke="black" points="1363.5,-23502.17 744.5,-23502.17 744.5,-23434.17 1363.5,-23434.17 1363.5,-23502.17"/>
<text text-anchor="middle" x="1054" y="-23486.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1054" y="-23471.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1054" y="-23456.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1054" y="-23441.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_qkv -->
<g id="edge94" class="edge">
<title>layer4_ln1&#45;&gt;layer4_qkv</title>
<path fill="none" stroke="black" d="M1006.73,-23538.05C1012.66,-23529.41 1019.12,-23519.99 1025.32,-23510.96"/>
<polygon fill="black" stroke="black" points="1028.37,-23512.69 1031.15,-23502.47 1022.6,-23508.73 1028.37,-23512.69"/>
</g>
<!-- layer4_reshape_qkv -->
<g id="node80" class="node">
<title>layer4_reshape_qkv</title>
<polygon fill="yellow" stroke="black" points="1398.5,-23398.17 779.5,-23398.17 779.5,-23330.17 1398.5,-23330.17 1398.5,-23398.17"/>
<text text-anchor="middle" x="1089" y="-23382.97" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1089" y="-23367.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1089" y="-23352.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1089" y="-23337.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_qkv&#45;&gt;layer4_reshape_qkv -->
<g id="edge95" class="edge">
<title>layer4_qkv&#45;&gt;layer4_reshape_qkv</title>
<path fill="none" stroke="black" d="M1065.36,-23434.05C1068.21,-23425.77 1071.3,-23416.76 1074.28,-23408.08"/>
<polygon fill="black" stroke="black" points="1077.64,-23409.06 1077.57,-23398.47 1071.02,-23406.79 1077.64,-23409.06"/>
</g>
<!-- layer4_split_q -->
<g id="node81" class="node">
<title>layer4_split_q</title>
<polygon fill="yellow" stroke="black" points="785.5,-23294.17 178.5,-23294.17 178.5,-23226.17 785.5,-23226.17 785.5,-23294.17"/>
<text text-anchor="middle" x="482" y="-23278.97" font-family="Times,serif" font-size="14.00">Split Query</text>
<text text-anchor="middle" x="482" y="-23263.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="482" y="-23248.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="482" y="-23233.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_reshape_qkv&#45;&gt;layer4_split_q -->
<g id="edge96" class="edge">
<title>layer4_reshape_qkv&#45;&gt;layer4_split_q</title>
<path fill="none" stroke="black" d="M892.34,-23330.12C827.21,-23319.18 754.55,-23306.97 688.69,-23295.9"/>
<polygon fill="black" stroke="black" points="689.05,-23292.41 678.6,-23294.2 687.88,-23299.31 689.05,-23292.41"/>
</g>
<!-- layer4_split_k -->
<g id="node82" class="node">
<title>layer4_split_k</title>
<polygon fill="yellow" stroke="black" points="1410.5,-23294.17 803.5,-23294.17 803.5,-23226.17 1410.5,-23226.17 1410.5,-23294.17"/>
<text text-anchor="middle" x="1107" y="-23278.97" font-family="Times,serif" font-size="14.00">Split Key</text>
<text text-anchor="middle" x="1107" y="-23263.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1107" y="-23248.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1107" y="-23233.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_reshape_qkv&#45;&gt;layer4_split_k -->
<g id="edge97" class="edge">
<title>layer4_reshape_qkv&#45;&gt;layer4_split_k</title>
<path fill="none" stroke="black" d="M1094.84,-23330.05C1096.29,-23321.86 1097.86,-23312.96 1099.38,-23304.36"/>
<polygon fill="black" stroke="black" points="1102.83,-23304.92 1101.12,-23294.47 1095.94,-23303.71 1102.83,-23304.92"/>
</g>
<!-- layer4_split_v -->
<g id="node83" class="node">
<title>layer4_split_v</title>
<polygon fill="yellow" stroke="black" points="1430.5,-23182.67 823.5,-23182.67 823.5,-23114.67 1430.5,-23114.67 1430.5,-23182.67"/>
<text text-anchor="middle" x="1127" y="-23167.47" font-family="Times,serif" font-size="14.00">Split Value</text>
<text text-anchor="middle" x="1127" y="-23152.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1127" y="-23137.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1127" y="-23122.47" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_reshape_qkv&#45;&gt;layer4_split_v -->
<g id="edge98" class="edge">
<title>layer4_reshape_qkv&#45;&gt;layer4_split_v</title>
<path fill="none" stroke="black" d="M1346.33,-23330.08C1380.49,-23320.79 1407.92,-23309.03 1420,-23294.17 1439.07,-23270.72 1438.47,-23250.08 1420,-23226.17 1407.37,-23209.82 1374.88,-23196.3 1335.92,-23185.41"/>
<polygon fill="black" stroke="black" points="1336.45,-23181.93 1325.88,-23182.7 1334.62,-23188.68 1336.45,-23181.93"/>
</g>
<!-- layer4_attn_score -->
<g id="node84" class="node">
<title>layer4_attn_score</title>
<polygon fill="yellow" stroke="black" points="805,-23190.17 239,-23190.17 239,-23107.17 805,-23107.17 805,-23190.17"/>
<text text-anchor="middle" x="522" y="-23174.97" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="522" y="-23159.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="522" y="-23144.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="522" y="-23129.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="522" y="-23114.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_split_q&#45;&gt;layer4_attn_score -->
<g id="edge99" class="edge">
<title>layer4_split_q&#45;&gt;layer4_attn_score</title>
<path fill="none" stroke="black" d="M494.11,-23226.02C497.12,-23217.79 500.4,-23208.78 503.64,-23199.94"/>
<polygon fill="black" stroke="black" points="506.96,-23201.04 507.1,-23190.44 500.39,-23198.64 506.96,-23201.04"/>
</g>
<!-- layer4_split_k&#45;&gt;layer4_attn_score -->
<g id="edge100" class="edge">
<title>layer4_split_k&#45;&gt;layer4_attn_score</title>
<path fill="none" stroke="black" d="M930.69,-23226.16C873.4,-23215.44 809.02,-23203.39 748.6,-23192.08"/>
<polygon fill="black" stroke="black" points="749.02,-23188.6 738.54,-23190.2 747.73,-23195.48 749.02,-23188.6"/>
</g>
<!-- layer4_attn_out -->
<g id="node86" class="node">
<title>layer4_attn_out</title>
<polygon fill="yellow" stroke="black" points="1408.5,-22967.17 845.5,-22967.17 845.5,-22884.17 1408.5,-22884.17 1408.5,-22967.17"/>
<text text-anchor="middle" x="1127" y="-22951.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1127" y="-22936.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1127" y="-22921.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1127" y="-22906.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1127" y="-22891.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_split_v&#45;&gt;layer4_attn_out -->
<g id="edge103" class="edge">
<title>layer4_split_v&#45;&gt;layer4_attn_out</title>
<path fill="none" stroke="black" d="M1127,-23114.58C1127,-23078.32 1127,-23019.7 1127,-22977.57"/>
<polygon fill="black" stroke="black" points="1130.5,-22977.51 1127,-22967.51 1123.5,-22977.51 1130.5,-22977.51"/>
</g>
<!-- layer4_attn_weights -->
<g id="node85" class="node">
<title>layer4_attn_weights</title>
<polygon fill="yellow" stroke="black" points="957,-23071.17 391,-23071.17 391,-23003.17 957,-23003.17 957,-23071.17"/>
<text text-anchor="middle" x="674" y="-23055.97" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="674" y="-23040.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="674" y="-23025.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="674" y="-23010.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_attn_score&#45;&gt;layer4_attn_weights -->
<g id="edge101" class="edge">
<title>layer4_attn_score&#45;&gt;layer4_attn_weights</title>
<path fill="none" stroke="black" d="M578.6,-23106.89C592.02,-23097.22 606.31,-23086.93 619.62,-23077.34"/>
<polygon fill="black" stroke="black" points="621.71,-23080.15 627.78,-23071.47 617.62,-23074.47 621.71,-23080.15"/>
</g>
<!-- layer4_attn_weights&#45;&gt;layer4_attn_out -->
<g id="edge102" class="edge">
<title>layer4_attn_weights&#45;&gt;layer4_attn_out</title>
<path fill="none" stroke="black" d="M810.53,-23003.16C854.19,-22992.61 903.17,-22980.77 949.31,-22969.62"/>
<polygon fill="black" stroke="black" points="950.21,-22973 959.11,-22967.25 948.57,-22966.2 950.21,-22973"/>
</g>
<!-- layer4_attn_reshape -->
<g id="node87" class="node">
<title>layer4_attn_reshape</title>
<polygon fill="yellow" stroke="black" points="1416.5,-22848.17 865.5,-22848.17 865.5,-22780.17 1416.5,-22780.17 1416.5,-22848.17"/>
<text text-anchor="middle" x="1141" y="-22832.97" font-family="Times,serif" font-size="14.00">Reshape Attention</text>
<text text-anchor="middle" x="1141" y="-22817.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1141" y="-22802.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1141" y="-22787.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_attn_out&#45;&gt;layer4_attn_reshape -->
<g id="edge104" class="edge">
<title>layer4_attn_out&#45;&gt;layer4_attn_reshape</title>
<path fill="none" stroke="black" d="M1132.21,-22883.89C1133.27,-22875.59 1134.39,-22866.83 1135.47,-22858.45"/>
<polygon fill="black" stroke="black" points="1138.95,-22858.83 1136.74,-22848.47 1132,-22857.94 1138.95,-22858.83"/>
</g>
<!-- layer4_attn_proj -->
<g id="node88" class="node">
<title>layer4_attn_proj</title>
<polygon fill="yellow" stroke="black" points="1396,-22744.17 928,-22744.17 928,-22676.17 1396,-22676.17 1396,-22744.17"/>
<text text-anchor="middle" x="1162" y="-22728.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="1162" y="-22713.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1162" y="-22698.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1162" y="-22683.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_attn_reshape&#45;&gt;layer4_attn_proj -->
<g id="edge105" class="edge">
<title>layer4_attn_reshape&#45;&gt;layer4_attn_proj</title>
<path fill="none" stroke="black" d="M1147.82,-22780.05C1149.51,-22771.86 1151.34,-22762.96 1153.11,-22754.36"/>
<polygon fill="black" stroke="black" points="1156.56,-22754.97 1155.14,-22744.47 1149.7,-22753.55 1156.56,-22754.97"/>
</g>
<!-- layer4_attn_proj&#45;&gt;layer4_res1 -->
<g id="edge107" class="edge">
<title>layer4_attn_proj&#45;&gt;layer4_res1</title>
<path fill="none" stroke="black" d="M1164.42,-22676.02C1165.01,-22667.96 1165.65,-22659.17 1166.29,-22650.5"/>
<polygon fill="black" stroke="black" points="1169.78,-22650.67 1167.02,-22640.44 1162.8,-22650.16 1169.78,-22650.67"/>
</g>
<!-- layer4_ln2 -->
<g id="node90" class="node">
<title>layer4_ln2</title>
<polygon fill="yellow" stroke="black" points="1159,-22521.17 691,-22521.17 691,-22453.17 1159,-22453.17 1159,-22521.17"/>
<text text-anchor="middle" x="925" y="-22505.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="925" y="-22490.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="925" y="-22475.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="925" y="-22460.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_ln2 -->
<g id="edge108" class="edge">
<title>layer4_res1&#45;&gt;layer4_ln2</title>
<path fill="none" stroke="black" d="M1079.12,-22557.05C1055.9,-22546.67 1031.05,-22535.57 1008.24,-22525.37"/>
<polygon fill="black" stroke="black" points="1009.49,-22522.09 998.93,-22521.21 1006.63,-22528.49 1009.49,-22522.09"/>
</g>
<!-- layer4_res2 -->
<g id="node94" class="node">
<title>layer4_res2</title>
<polygon fill="yellow" stroke="black" points="1177,-22105.17 709,-22105.17 709,-22022.17 1177,-22022.17 1177,-22105.17"/>
<text text-anchor="middle" x="943" y="-22089.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="943" y="-22074.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="943" y="-22059.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="943" y="-22044.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="943" y="-22029.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_res1&#45;&gt;layer4_res2 -->
<g id="edge112" class="edge">
<title>layer4_res1&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M1175.19,-22556.81C1180.19,-22513.9 1187,-22444.4 1187,-22384.17 1187,-22384.17 1187,-22384.17 1187,-22278.17 1187,-22217 1212.12,-22189 1174,-22141.17 1164.5,-22129.24 1153.08,-22119.16 1140.48,-22110.63"/>
<polygon fill="black" stroke="black" points="1142.36,-22107.68 1132.04,-22105.25 1138.59,-22113.58 1142.36,-22107.68"/>
</g>
<!-- layer4_mlp1 -->
<g id="node91" class="node">
<title>layer4_mlp1</title>
<polygon fill="yellow" stroke="black" points="1167.5,-22417.17 664.5,-22417.17 664.5,-22349.17 1167.5,-22349.17 1167.5,-22417.17"/>
<text text-anchor="middle" x="916" y="-22401.97" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="916" y="-22386.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="916" y="-22371.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="916" y="-22356.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_ln2&#45;&gt;layer4_mlp1 -->
<g id="edge109" class="edge">
<title>layer4_ln2&#45;&gt;layer4_mlp1</title>
<path fill="none" stroke="black" d="M922.08,-22453.05C921.36,-22444.94 920.59,-22436.15 919.84,-22427.64"/>
<polygon fill="black" stroke="black" points="923.3,-22427.12 918.94,-22417.47 916.33,-22427.73 923.3,-22427.12"/>
</g>
<!-- layer4_gelu -->
<g id="node92" class="node">
<title>layer4_gelu</title>
<polygon fill="yellow" stroke="black" points="1167.5,-22313.17 664.5,-22313.17 664.5,-22245.17 1167.5,-22245.17 1167.5,-22313.17"/>
<text text-anchor="middle" x="916" y="-22297.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="916" y="-22282.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="916" y="-22267.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="916" y="-22252.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_mlp1&#45;&gt;layer4_gelu -->
<g id="edge110" class="edge">
<title>layer4_mlp1&#45;&gt;layer4_gelu</title>
<path fill="none" stroke="black" d="M916,-22349.05C916,-22340.94 916,-22332.15 916,-22323.64"/>
<polygon fill="black" stroke="black" points="919.5,-22323.47 916,-22313.47 912.5,-22323.47 919.5,-22323.47"/>
</g>
<!-- layer4_mlp2 -->
<g id="node93" class="node">
<title>layer4_mlp2</title>
<polygon fill="yellow" stroke="black" points="1164.5,-22209.17 673.5,-22209.17 673.5,-22141.17 1164.5,-22141.17 1164.5,-22209.17"/>
<text text-anchor="middle" x="919" y="-22193.97" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="919" y="-22178.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="919" y="-22163.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="919" y="-22148.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer4_gelu&#45;&gt;layer4_mlp2 -->
<g id="edge111" class="edge">
<title>layer4_gelu&#45;&gt;layer4_mlp2</title>
<path fill="none" stroke="black" d="M916.97,-22245.05C917.21,-22236.94 917.47,-22228.15 917.72,-22219.64"/>
<polygon fill="black" stroke="black" points="921.23,-22219.56 918.02,-22209.47 914.23,-22219.36 921.23,-22219.56"/>
</g>
<!-- layer4_mlp2&#45;&gt;layer4_res2 -->
<g id="edge113" class="edge">
<title>layer4_mlp2&#45;&gt;layer4_res2</title>
<path fill="none" stroke="black" d="M926.27,-22141.02C928.05,-22132.87 930,-22123.98 931.92,-22115.22"/>
<polygon fill="black" stroke="black" points="935.34,-22115.96 934.06,-22105.44 928.5,-22114.46 935.34,-22115.96"/>
</g>
<!-- send_to_gpu_5 -->
<g id="node95" class="node">
<title>send_to_gpu_5</title>
<polygon fill="yellow" stroke="black" points="1428.4,-21986.17 656.24,-21986.17 457.6,-21850.17 1229.76,-21850.17 1428.4,-21986.17"/>
<text text-anchor="middle" x="943" y="-21936.97" font-family="Times,serif" font-size="14.00">Send to GPU 5</text>
<text text-anchor="middle" x="943" y="-21921.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="943" y="-21906.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="943" y="-21891.97" font-family="Times,serif" font-size="14.00">GPU: 4 â†’ GPU 5</text>
</g>
<!-- layer4_res2&#45;&gt;send_to_gpu_5 -->
<g id="edge114" class="edge">
<title>layer4_res2&#45;&gt;send_to_gpu_5</title>
<path fill="none" stroke="black" d="M943,-22021.93C943,-22013.95 943,-22005.33 943,-21996.61"/>
<polygon fill="black" stroke="black" points="946.5,-21996.34 943,-21986.34 939.5,-21996.34 946.5,-21996.34"/>
</g>
<!-- comm_layer_5 -->
<g id="node96" class="node">
<title>comm_layer_5</title>
<polygon fill="yellow" stroke="black" points="1428.4,-21788.17 656.24,-21788.17 457.6,-21652.17 1229.76,-21652.17 1428.4,-21788.17"/>
<text text-anchor="middle" x="943" y="-21738.97" font-family="Times,serif" font-size="14.00">Receive from GPU 4</text>
<text text-anchor="middle" x="943" y="-21723.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="943" y="-21708.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="943" y="-21693.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- send_to_gpu_5&#45;&gt;comm_layer_5 -->
<g id="edge115" class="edge">
<title>send_to_gpu_5&#45;&gt;comm_layer_5</title>
<path fill="none" stroke="black" d="M943,-21849.99C943,-21833.47 943,-21815.65 943,-21798.69"/>
<polygon fill="black" stroke="black" points="946.5,-21798.26 943,-21788.26 939.5,-21798.26 946.5,-21798.26"/>
</g>
<!-- layer5_ln1 -->
<g id="node97" class="node">
<title>layer5_ln1</title>
<polygon fill="yellow" stroke="black" points="1195,-21616.17 727,-21616.17 727,-21548.17 1195,-21548.17 1195,-21616.17"/>
<text text-anchor="middle" x="961" y="-21600.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="961" y="-21585.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="961" y="-21570.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="961" y="-21555.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- comm_layer_5&#45;&gt;layer5_ln1 -->
<g id="edge116" class="edge">
<title>comm_layer_5&#45;&gt;layer5_ln1</title>
<path fill="none" stroke="black" d="M951.89,-21651.96C953.05,-21643.21 954.21,-21634.44 955.3,-21626.23"/>
<polygon fill="black" stroke="black" points="958.79,-21626.56 956.63,-21616.18 951.85,-21625.64 958.79,-21626.56"/>
</g>
<!-- layer5_res1 -->
<g id="node108" class="node">
<title>layer5_res1</title>
<polygon fill="yellow" stroke="black" points="1388,-20650.17 920,-20650.17 920,-20567.17 1388,-20567.17 1388,-20650.17"/>
<text text-anchor="middle" x="1154" y="-20634.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1154" y="-20619.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1154" y="-20604.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1154" y="-20589.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1154" y="-20574.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- comm_layer_5&#45;&gt;layer5_res1 -->
<g id="edge129" class="edge">
<title>comm_layer_5&#45;&gt;layer5_res1</title>
<path fill="none" stroke="black" d="M1253.63,-21668.48C1347.89,-21634.05 1427,-21576.24 1427,-21479.17 1427,-21479.17 1427,-21479.17 1427,-20823.17 1427,-20759.98 1432.68,-20731.82 1389,-20686.17 1377.35,-20673.99 1363.73,-20663.74 1349.04,-20655.13"/>
<polygon fill="black" stroke="black" points="1350.71,-20652.05 1340.27,-20650.24 1347.3,-20658.17 1350.71,-20652.05"/>
</g>
<!-- layer5_qkv -->
<g id="node98" class="node">
<title>layer5_qkv</title>
<polygon fill="yellow" stroke="black" points="1340.5,-21512.17 721.5,-21512.17 721.5,-21444.17 1340.5,-21444.17 1340.5,-21512.17"/>
<text text-anchor="middle" x="1031" y="-21496.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1031" y="-21481.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1031" y="-21466.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1031" y="-21451.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_ln1&#45;&gt;layer5_qkv -->
<g id="edge117" class="edge">
<title>layer5_ln1&#45;&gt;layer5_qkv</title>
<path fill="none" stroke="black" d="M983.73,-21548.05C989.66,-21539.41 996.12,-21529.99 1002.32,-21520.96"/>
<polygon fill="black" stroke="black" points="1005.37,-21522.69 1008.15,-21512.47 999.6,-21518.73 1005.37,-21522.69"/>
</g>
<!-- layer5_reshape_qkv -->
<g id="node99" class="node">
<title>layer5_reshape_qkv</title>
<polygon fill="yellow" stroke="black" points="1375.5,-21408.17 756.5,-21408.17 756.5,-21340.17 1375.5,-21340.17 1375.5,-21408.17"/>
<text text-anchor="middle" x="1066" y="-21392.97" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1066" y="-21377.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1066" y="-21362.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1066" y="-21347.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_qkv&#45;&gt;layer5_reshape_qkv -->
<g id="edge118" class="edge">
<title>layer5_qkv&#45;&gt;layer5_reshape_qkv</title>
<path fill="none" stroke="black" d="M1042.36,-21444.05C1045.21,-21435.77 1048.3,-21426.76 1051.28,-21418.08"/>
<polygon fill="black" stroke="black" points="1054.64,-21419.06 1054.57,-21408.47 1048.02,-21416.79 1054.64,-21419.06"/>
</g>
<!-- layer5_split_q -->
<g id="node100" class="node">
<title>layer5_split_q</title>
<polygon fill="yellow" stroke="black" points="762.5,-21304.17 155.5,-21304.17 155.5,-21236.17 762.5,-21236.17 762.5,-21304.17"/>
<text text-anchor="middle" x="459" y="-21288.97" font-family="Times,serif" font-size="14.00">Split Query</text>
<text text-anchor="middle" x="459" y="-21273.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="459" y="-21258.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="459" y="-21243.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_reshape_qkv&#45;&gt;layer5_split_q -->
<g id="edge119" class="edge">
<title>layer5_reshape_qkv&#45;&gt;layer5_split_q</title>
<path fill="none" stroke="black" d="M869.34,-21340.12C804.21,-21329.18 731.55,-21316.97 665.69,-21305.9"/>
<polygon fill="black" stroke="black" points="666.05,-21302.41 655.6,-21304.2 664.88,-21309.31 666.05,-21302.41"/>
</g>
<!-- layer5_split_k -->
<g id="node101" class="node">
<title>layer5_split_k</title>
<polygon fill="yellow" stroke="black" points="1387.5,-21304.17 780.5,-21304.17 780.5,-21236.17 1387.5,-21236.17 1387.5,-21304.17"/>
<text text-anchor="middle" x="1084" y="-21288.97" font-family="Times,serif" font-size="14.00">Split Key</text>
<text text-anchor="middle" x="1084" y="-21273.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1084" y="-21258.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1084" y="-21243.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_reshape_qkv&#45;&gt;layer5_split_k -->
<g id="edge120" class="edge">
<title>layer5_reshape_qkv&#45;&gt;layer5_split_k</title>
<path fill="none" stroke="black" d="M1071.84,-21340.05C1073.29,-21331.86 1074.86,-21322.96 1076.38,-21314.36"/>
<polygon fill="black" stroke="black" points="1079.83,-21314.92 1078.12,-21304.47 1072.94,-21313.71 1079.83,-21314.92"/>
</g>
<!-- layer5_split_v -->
<g id="node102" class="node">
<title>layer5_split_v</title>
<polygon fill="yellow" stroke="black" points="1407.5,-21192.67 800.5,-21192.67 800.5,-21124.67 1407.5,-21124.67 1407.5,-21192.67"/>
<text text-anchor="middle" x="1104" y="-21177.47" font-family="Times,serif" font-size="14.00">Split Value</text>
<text text-anchor="middle" x="1104" y="-21162.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1104" y="-21147.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1104" y="-21132.47" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_reshape_qkv&#45;&gt;layer5_split_v -->
<g id="edge121" class="edge">
<title>layer5_reshape_qkv&#45;&gt;layer5_split_v</title>
<path fill="none" stroke="black" d="M1323.33,-21340.08C1357.49,-21330.79 1384.92,-21319.03 1397,-21304.17 1416.07,-21280.72 1415.47,-21260.08 1397,-21236.17 1384.37,-21219.82 1351.88,-21206.3 1312.92,-21195.41"/>
<polygon fill="black" stroke="black" points="1313.45,-21191.93 1302.88,-21192.7 1311.62,-21198.68 1313.45,-21191.93"/>
</g>
<!-- layer5_attn_score -->
<g id="node103" class="node">
<title>layer5_attn_score</title>
<polygon fill="yellow" stroke="black" points="782,-21200.17 216,-21200.17 216,-21117.17 782,-21117.17 782,-21200.17"/>
<text text-anchor="middle" x="499" y="-21184.97" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="499" y="-21169.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="499" y="-21154.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="499" y="-21139.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="499" y="-21124.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_split_q&#45;&gt;layer5_attn_score -->
<g id="edge122" class="edge">
<title>layer5_split_q&#45;&gt;layer5_attn_score</title>
<path fill="none" stroke="black" d="M471.11,-21236.02C474.12,-21227.79 477.4,-21218.78 480.64,-21209.94"/>
<polygon fill="black" stroke="black" points="483.96,-21211.04 484.1,-21200.44 477.39,-21208.64 483.96,-21211.04"/>
</g>
<!-- layer5_split_k&#45;&gt;layer5_attn_score -->
<g id="edge123" class="edge">
<title>layer5_split_k&#45;&gt;layer5_attn_score</title>
<path fill="none" stroke="black" d="M907.69,-21236.16C850.4,-21225.44 786.02,-21213.39 725.6,-21202.08"/>
<polygon fill="black" stroke="black" points="726.02,-21198.6 715.54,-21200.2 724.73,-21205.48 726.02,-21198.6"/>
</g>
<!-- layer5_attn_out -->
<g id="node105" class="node">
<title>layer5_attn_out</title>
<polygon fill="yellow" stroke="black" points="1385.5,-20977.17 822.5,-20977.17 822.5,-20894.17 1385.5,-20894.17 1385.5,-20977.17"/>
<text text-anchor="middle" x="1104" y="-20961.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1104" y="-20946.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1104" y="-20931.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1104" y="-20916.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1104" y="-20901.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_split_v&#45;&gt;layer5_attn_out -->
<g id="edge126" class="edge">
<title>layer5_split_v&#45;&gt;layer5_attn_out</title>
<path fill="none" stroke="black" d="M1104,-21124.58C1104,-21088.32 1104,-21029.7 1104,-20987.57"/>
<polygon fill="black" stroke="black" points="1107.5,-20987.51 1104,-20977.51 1100.5,-20987.51 1107.5,-20987.51"/>
</g>
<!-- layer5_attn_weights -->
<g id="node104" class="node">
<title>layer5_attn_weights</title>
<polygon fill="yellow" stroke="black" points="934,-21081.17 368,-21081.17 368,-21013.17 934,-21013.17 934,-21081.17"/>
<text text-anchor="middle" x="651" y="-21065.97" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="651" y="-21050.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="651" y="-21035.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="651" y="-21020.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_attn_score&#45;&gt;layer5_attn_weights -->
<g id="edge124" class="edge">
<title>layer5_attn_score&#45;&gt;layer5_attn_weights</title>
<path fill="none" stroke="black" d="M555.6,-21116.89C569.02,-21107.22 583.31,-21096.93 596.62,-21087.34"/>
<polygon fill="black" stroke="black" points="598.71,-21090.15 604.78,-21081.47 594.62,-21084.47 598.71,-21090.15"/>
</g>
<!-- layer5_attn_weights&#45;&gt;layer5_attn_out -->
<g id="edge125" class="edge">
<title>layer5_attn_weights&#45;&gt;layer5_attn_out</title>
<path fill="none" stroke="black" d="M787.53,-21013.16C831.19,-21002.61 880.17,-20990.77 926.31,-20979.62"/>
<polygon fill="black" stroke="black" points="927.21,-20983 936.11,-20977.25 925.57,-20976.2 927.21,-20983"/>
</g>
<!-- layer5_attn_reshape -->
<g id="node106" class="node">
<title>layer5_attn_reshape</title>
<polygon fill="yellow" stroke="black" points="1393.5,-20858.17 842.5,-20858.17 842.5,-20790.17 1393.5,-20790.17 1393.5,-20858.17"/>
<text text-anchor="middle" x="1118" y="-20842.97" font-family="Times,serif" font-size="14.00">Reshape Attention</text>
<text text-anchor="middle" x="1118" y="-20827.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1118" y="-20812.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1118" y="-20797.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_attn_out&#45;&gt;layer5_attn_reshape -->
<g id="edge127" class="edge">
<title>layer5_attn_out&#45;&gt;layer5_attn_reshape</title>
<path fill="none" stroke="black" d="M1109.21,-20893.89C1110.27,-20885.59 1111.39,-20876.83 1112.47,-20868.45"/>
<polygon fill="black" stroke="black" points="1115.95,-20868.83 1113.74,-20858.47 1109,-20867.94 1115.95,-20868.83"/>
</g>
<!-- layer5_attn_proj -->
<g id="node107" class="node">
<title>layer5_attn_proj</title>
<polygon fill="yellow" stroke="black" points="1380,-20754.17 912,-20754.17 912,-20686.17 1380,-20686.17 1380,-20754.17"/>
<text text-anchor="middle" x="1146" y="-20738.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="1146" y="-20723.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1146" y="-20708.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1146" y="-20693.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_attn_reshape&#45;&gt;layer5_attn_proj -->
<g id="edge128" class="edge">
<title>layer5_attn_reshape&#45;&gt;layer5_attn_proj</title>
<path fill="none" stroke="black" d="M1127.09,-20790.05C1129.34,-20781.86 1131.78,-20772.96 1134.14,-20764.36"/>
<polygon fill="black" stroke="black" points="1137.59,-20765.04 1136.86,-20754.47 1130.84,-20763.18 1137.59,-20765.04"/>
</g>
<!-- layer5_attn_proj&#45;&gt;layer5_res1 -->
<g id="edge130" class="edge">
<title>layer5_attn_proj&#45;&gt;layer5_res1</title>
<path fill="none" stroke="black" d="M1148.42,-20686.02C1149.01,-20677.96 1149.65,-20669.17 1150.29,-20660.5"/>
<polygon fill="black" stroke="black" points="1153.78,-20660.67 1151.02,-20650.44 1146.8,-20660.16 1153.78,-20660.67"/>
</g>
<!-- layer5_ln2 -->
<g id="node109" class="node">
<title>layer5_ln2</title>
<polygon fill="yellow" stroke="black" points="1146,-20531.17 678,-20531.17 678,-20463.17 1146,-20463.17 1146,-20531.17"/>
<text text-anchor="middle" x="912" y="-20515.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="912" y="-20500.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="912" y="-20485.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="912" y="-20470.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_res1&#45;&gt;layer5_ln2 -->
<g id="edge131" class="edge">
<title>layer5_res1&#45;&gt;layer5_ln2</title>
<path fill="none" stroke="black" d="M1064.23,-20567.05C1041.3,-20556.67 1016.75,-20545.57 994.22,-20535.37"/>
<polygon fill="black" stroke="black" points="995.58,-20532.14 985.03,-20531.21 992.7,-20538.52 995.58,-20532.14"/>
</g>
<!-- layer5_res2 -->
<g id="node113" class="node">
<title>layer5_res2</title>
<polygon fill="yellow" stroke="black" points="1160,-20115.17 692,-20115.17 692,-20032.17 1160,-20032.17 1160,-20115.17"/>
<text text-anchor="middle" x="926" y="-20099.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="926" y="-20084.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="926" y="-20069.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="926" y="-20054.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="926" y="-20039.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_res1&#45;&gt;layer5_res2 -->
<g id="edge135" class="edge">
<title>layer5_res1&#45;&gt;layer5_res2</title>
<path fill="none" stroke="black" d="M1160.11,-20566.84C1165.99,-20523.95 1174,-20454.48 1174,-20394.17 1174,-20394.17 1174,-20394.17 1174,-20288.17 1174,-20227 1199.24,-20198.9 1161,-20151.17 1151.43,-20139.22 1139.96,-20129.11 1127.31,-20120.57"/>
<polygon fill="black" stroke="black" points="1129.15,-20117.59 1118.83,-20115.18 1125.39,-20123.5 1129.15,-20117.59"/>
</g>
<!-- layer5_mlp1 -->
<g id="node110" class="node">
<title>layer5_mlp1</title>
<polygon fill="yellow" stroke="black" points="1154.5,-20427.17 651.5,-20427.17 651.5,-20359.17 1154.5,-20359.17 1154.5,-20427.17"/>
<text text-anchor="middle" x="903" y="-20411.97" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="903" y="-20396.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="903" y="-20381.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="903" y="-20366.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_ln2&#45;&gt;layer5_mlp1 -->
<g id="edge132" class="edge">
<title>layer5_ln2&#45;&gt;layer5_mlp1</title>
<path fill="none" stroke="black" d="M909.08,-20463.05C908.36,-20454.94 907.59,-20446.15 906.84,-20437.64"/>
<polygon fill="black" stroke="black" points="910.3,-20437.12 905.94,-20427.47 903.33,-20437.73 910.3,-20437.12"/>
</g>
<!-- layer5_gelu -->
<g id="node111" class="node">
<title>layer5_gelu</title>
<polygon fill="yellow" stroke="black" points="1154.5,-20323.17 651.5,-20323.17 651.5,-20255.17 1154.5,-20255.17 1154.5,-20323.17"/>
<text text-anchor="middle" x="903" y="-20307.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="903" y="-20292.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="903" y="-20277.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="903" y="-20262.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_mlp1&#45;&gt;layer5_gelu -->
<g id="edge133" class="edge">
<title>layer5_mlp1&#45;&gt;layer5_gelu</title>
<path fill="none" stroke="black" d="M903,-20359.05C903,-20350.94 903,-20342.15 903,-20333.64"/>
<polygon fill="black" stroke="black" points="906.5,-20333.47 903,-20323.47 899.5,-20333.47 906.5,-20333.47"/>
</g>
<!-- layer5_mlp2 -->
<g id="node112" class="node">
<title>layer5_mlp2</title>
<polygon fill="yellow" stroke="black" points="1151.5,-20219.17 660.5,-20219.17 660.5,-20151.17 1151.5,-20151.17 1151.5,-20219.17"/>
<text text-anchor="middle" x="906" y="-20203.97" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="906" y="-20188.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="906" y="-20173.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="906" y="-20158.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer5_gelu&#45;&gt;layer5_mlp2 -->
<g id="edge134" class="edge">
<title>layer5_gelu&#45;&gt;layer5_mlp2</title>
<path fill="none" stroke="black" d="M903.97,-20255.05C904.21,-20246.94 904.47,-20238.15 904.72,-20229.64"/>
<polygon fill="black" stroke="black" points="908.23,-20229.56 905.02,-20219.47 901.23,-20229.36 908.23,-20229.56"/>
</g>
<!-- layer5_mlp2&#45;&gt;layer5_res2 -->
<g id="edge136" class="edge">
<title>layer5_mlp2&#45;&gt;layer5_res2</title>
<path fill="none" stroke="black" d="M912.05,-20151.02C913.53,-20142.96 915.13,-20134.17 916.71,-20125.5"/>
<polygon fill="black" stroke="black" points="920.2,-20125.91 918.55,-20115.44 913.31,-20124.65 920.2,-20125.91"/>
</g>
<!-- send_to_gpu_6 -->
<g id="node114" class="node">
<title>send_to_gpu_6</title>
<polygon fill="yellow" stroke="black" points="1411.4,-19996.17 639.24,-19996.17 440.6,-19860.17 1212.76,-19860.17 1411.4,-19996.17"/>
<text text-anchor="middle" x="926" y="-19946.97" font-family="Times,serif" font-size="14.00">Send to GPU 6</text>
<text text-anchor="middle" x="926" y="-19931.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="926" y="-19916.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="926" y="-19901.97" font-family="Times,serif" font-size="14.00">GPU: 5 â†’ GPU 6</text>
</g>
<!-- layer5_res2&#45;&gt;send_to_gpu_6 -->
<g id="edge137" class="edge">
<title>layer5_res2&#45;&gt;send_to_gpu_6</title>
<path fill="none" stroke="black" d="M926,-20031.93C926,-20023.95 926,-20015.33 926,-20006.61"/>
<polygon fill="black" stroke="black" points="929.5,-20006.34 926,-19996.34 922.5,-20006.34 929.5,-20006.34"/>
</g>
<!-- comm_layer_6 -->
<g id="node115" class="node">
<title>comm_layer_6</title>
<polygon fill="yellow" stroke="black" points="1411.4,-19798.17 639.24,-19798.17 440.6,-19662.17 1212.76,-19662.17 1411.4,-19798.17"/>
<text text-anchor="middle" x="926" y="-19748.97" font-family="Times,serif" font-size="14.00">Receive from GPU 5</text>
<text text-anchor="middle" x="926" y="-19733.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="926" y="-19718.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="926" y="-19703.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- send_to_gpu_6&#45;&gt;comm_layer_6 -->
<g id="edge138" class="edge">
<title>send_to_gpu_6&#45;&gt;comm_layer_6</title>
<path fill="none" stroke="black" d="M926,-19859.99C926,-19843.47 926,-19825.65 926,-19808.69"/>
<polygon fill="black" stroke="black" points="929.5,-19808.26 926,-19798.26 922.5,-19808.26 929.5,-19808.26"/>
</g>
<!-- layer6_ln1 -->
<g id="node116" class="node">
<title>layer6_ln1</title>
<polygon fill="yellow" stroke="black" points="1178,-19626.17 710,-19626.17 710,-19558.17 1178,-19558.17 1178,-19626.17"/>
<text text-anchor="middle" x="944" y="-19610.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="944" y="-19595.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="944" y="-19580.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="944" y="-19565.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- comm_layer_6&#45;&gt;layer6_ln1 -->
<g id="edge139" class="edge">
<title>comm_layer_6&#45;&gt;layer6_ln1</title>
<path fill="none" stroke="black" d="M934.89,-19661.96C936.05,-19653.21 937.21,-19644.44 938.3,-19636.23"/>
<polygon fill="black" stroke="black" points="941.79,-19636.56 939.63,-19626.18 934.85,-19635.64 941.79,-19636.56"/>
</g>
<!-- layer6_res1 -->
<g id="node127" class="node">
<title>layer6_res1</title>
<polygon fill="yellow" stroke="black" points="1358,-18660.17 890,-18660.17 890,-18577.17 1358,-18577.17 1358,-18660.17"/>
<text text-anchor="middle" x="1124" y="-18644.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1124" y="-18629.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1124" y="-18614.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1124" y="-18599.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1124" y="-18584.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- comm_layer_6&#45;&gt;layer6_res1 -->
<g id="edge152" class="edge">
<title>comm_layer_6&#45;&gt;layer6_res1</title>
<path fill="none" stroke="black" d="M1236.63,-19678.48C1330.89,-19644.05 1410,-19586.24 1410,-19489.17 1410,-19489.17 1410,-19489.17 1410,-18833.17 1410,-18764.99 1392.18,-18741.2 1341,-18696.17 1326.95,-18683.81 1310.78,-18673.41 1293.74,-18664.67"/>
<polygon fill="black" stroke="black" points="1295.27,-18661.52 1284.75,-18660.25 1292.18,-18667.8 1295.27,-18661.52"/>
</g>
<!-- layer6_qkv -->
<g id="node117" class="node">
<title>layer6_qkv</title>
<polygon fill="yellow" stroke="black" points="1323.5,-19522.17 704.5,-19522.17 704.5,-19454.17 1323.5,-19454.17 1323.5,-19522.17"/>
<text text-anchor="middle" x="1014" y="-19506.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1014" y="-19491.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1014" y="-19476.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1014" y="-19461.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_ln1&#45;&gt;layer6_qkv -->
<g id="edge140" class="edge">
<title>layer6_ln1&#45;&gt;layer6_qkv</title>
<path fill="none" stroke="black" d="M966.73,-19558.05C972.66,-19549.41 979.12,-19539.99 985.32,-19530.96"/>
<polygon fill="black" stroke="black" points="988.37,-19532.69 991.15,-19522.47 982.6,-19528.73 988.37,-19532.69"/>
</g>
<!-- layer6_reshape_qkv -->
<g id="node118" class="node">
<title>layer6_reshape_qkv</title>
<polygon fill="yellow" stroke="black" points="1358.5,-19418.17 739.5,-19418.17 739.5,-19350.17 1358.5,-19350.17 1358.5,-19418.17"/>
<text text-anchor="middle" x="1049" y="-19402.97" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1049" y="-19387.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1049" y="-19372.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1049" y="-19357.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_qkv&#45;&gt;layer6_reshape_qkv -->
<g id="edge141" class="edge">
<title>layer6_qkv&#45;&gt;layer6_reshape_qkv</title>
<path fill="none" stroke="black" d="M1025.36,-19454.05C1028.21,-19445.77 1031.3,-19436.76 1034.28,-19428.08"/>
<polygon fill="black" stroke="black" points="1037.64,-19429.06 1037.57,-19418.47 1031.02,-19426.79 1037.64,-19429.06"/>
</g>
<!-- layer6_split_q -->
<g id="node119" class="node">
<title>layer6_split_q</title>
<polygon fill="yellow" stroke="black" points="745.5,-19314.17 138.5,-19314.17 138.5,-19246.17 745.5,-19246.17 745.5,-19314.17"/>
<text text-anchor="middle" x="442" y="-19298.97" font-family="Times,serif" font-size="14.00">Split Query</text>
<text text-anchor="middle" x="442" y="-19283.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="442" y="-19268.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="442" y="-19253.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_reshape_qkv&#45;&gt;layer6_split_q -->
<g id="edge142" class="edge">
<title>layer6_reshape_qkv&#45;&gt;layer6_split_q</title>
<path fill="none" stroke="black" d="M852.34,-19350.12C787.21,-19339.18 714.55,-19326.97 648.69,-19315.9"/>
<polygon fill="black" stroke="black" points="649.05,-19312.41 638.6,-19314.2 647.88,-19319.31 649.05,-19312.41"/>
</g>
<!-- layer6_split_k -->
<g id="node120" class="node">
<title>layer6_split_k</title>
<polygon fill="yellow" stroke="black" points="1370.5,-19314.17 763.5,-19314.17 763.5,-19246.17 1370.5,-19246.17 1370.5,-19314.17"/>
<text text-anchor="middle" x="1067" y="-19298.97" font-family="Times,serif" font-size="14.00">Split Key</text>
<text text-anchor="middle" x="1067" y="-19283.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1067" y="-19268.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1067" y="-19253.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_reshape_qkv&#45;&gt;layer6_split_k -->
<g id="edge143" class="edge">
<title>layer6_reshape_qkv&#45;&gt;layer6_split_k</title>
<path fill="none" stroke="black" d="M1054.84,-19350.05C1056.29,-19341.86 1057.86,-19332.96 1059.38,-19324.36"/>
<polygon fill="black" stroke="black" points="1062.83,-19324.92 1061.12,-19314.47 1055.94,-19323.71 1062.83,-19324.92"/>
</g>
<!-- layer6_split_v -->
<g id="node121" class="node">
<title>layer6_split_v</title>
<polygon fill="yellow" stroke="black" points="1390.5,-19202.67 783.5,-19202.67 783.5,-19134.67 1390.5,-19134.67 1390.5,-19202.67"/>
<text text-anchor="middle" x="1087" y="-19187.47" font-family="Times,serif" font-size="14.00">Split Value</text>
<text text-anchor="middle" x="1087" y="-19172.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1087" y="-19157.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1087" y="-19142.47" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_reshape_qkv&#45;&gt;layer6_split_v -->
<g id="edge144" class="edge">
<title>layer6_reshape_qkv&#45;&gt;layer6_split_v</title>
<path fill="none" stroke="black" d="M1306.33,-19350.08C1340.49,-19340.79 1367.92,-19329.03 1380,-19314.17 1399.07,-19290.72 1398.47,-19270.08 1380,-19246.17 1367.37,-19229.82 1334.88,-19216.3 1295.92,-19205.41"/>
<polygon fill="black" stroke="black" points="1296.45,-19201.93 1285.88,-19202.7 1294.62,-19208.68 1296.45,-19201.93"/>
</g>
<!-- layer6_attn_score -->
<g id="node122" class="node">
<title>layer6_attn_score</title>
<polygon fill="yellow" stroke="black" points="765,-19210.17 199,-19210.17 199,-19127.17 765,-19127.17 765,-19210.17"/>
<text text-anchor="middle" x="482" y="-19194.97" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="482" y="-19179.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="482" y="-19164.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="482" y="-19149.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="482" y="-19134.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_split_q&#45;&gt;layer6_attn_score -->
<g id="edge145" class="edge">
<title>layer6_split_q&#45;&gt;layer6_attn_score</title>
<path fill="none" stroke="black" d="M454.11,-19246.02C457.12,-19237.79 460.4,-19228.78 463.64,-19219.94"/>
<polygon fill="black" stroke="black" points="466.96,-19221.04 467.1,-19210.44 460.39,-19218.64 466.96,-19221.04"/>
</g>
<!-- layer6_split_k&#45;&gt;layer6_attn_score -->
<g id="edge146" class="edge">
<title>layer6_split_k&#45;&gt;layer6_attn_score</title>
<path fill="none" stroke="black" d="M890.69,-19246.16C833.4,-19235.44 769.02,-19223.39 708.6,-19212.08"/>
<polygon fill="black" stroke="black" points="709.02,-19208.6 698.54,-19210.2 707.73,-19215.48 709.02,-19208.6"/>
</g>
<!-- layer6_attn_out -->
<g id="node124" class="node">
<title>layer6_attn_out</title>
<polygon fill="yellow" stroke="black" points="1368.5,-18987.17 805.5,-18987.17 805.5,-18904.17 1368.5,-18904.17 1368.5,-18987.17"/>
<text text-anchor="middle" x="1087" y="-18971.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1087" y="-18956.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1087" y="-18941.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1087" y="-18926.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1087" y="-18911.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_split_v&#45;&gt;layer6_attn_out -->
<g id="edge149" class="edge">
<title>layer6_split_v&#45;&gt;layer6_attn_out</title>
<path fill="none" stroke="black" d="M1087,-19134.58C1087,-19098.32 1087,-19039.7 1087,-18997.57"/>
<polygon fill="black" stroke="black" points="1090.5,-18997.51 1087,-18987.51 1083.5,-18997.51 1090.5,-18997.51"/>
</g>
<!-- layer6_attn_weights -->
<g id="node123" class="node">
<title>layer6_attn_weights</title>
<polygon fill="yellow" stroke="black" points="917,-19091.17 351,-19091.17 351,-19023.17 917,-19023.17 917,-19091.17"/>
<text text-anchor="middle" x="634" y="-19075.97" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="634" y="-19060.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="634" y="-19045.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="634" y="-19030.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_attn_score&#45;&gt;layer6_attn_weights -->
<g id="edge147" class="edge">
<title>layer6_attn_score&#45;&gt;layer6_attn_weights</title>
<path fill="none" stroke="black" d="M538.6,-19126.89C552.02,-19117.22 566.31,-19106.93 579.62,-19097.34"/>
<polygon fill="black" stroke="black" points="581.71,-19100.15 587.78,-19091.47 577.62,-19094.47 581.71,-19100.15"/>
</g>
<!-- layer6_attn_weights&#45;&gt;layer6_attn_out -->
<g id="edge148" class="edge">
<title>layer6_attn_weights&#45;&gt;layer6_attn_out</title>
<path fill="none" stroke="black" d="M770.53,-19023.16C814.19,-19012.61 863.17,-19000.77 909.31,-18989.62"/>
<polygon fill="black" stroke="black" points="910.21,-18993 919.11,-18987.25 908.57,-18986.2 910.21,-18993"/>
</g>
<!-- layer6_attn_reshape -->
<g id="node125" class="node">
<title>layer6_attn_reshape</title>
<polygon fill="yellow" stroke="black" points="1366.5,-18868.17 815.5,-18868.17 815.5,-18800.17 1366.5,-18800.17 1366.5,-18868.17"/>
<text text-anchor="middle" x="1091" y="-18852.97" font-family="Times,serif" font-size="14.00">Reshape Attention</text>
<text text-anchor="middle" x="1091" y="-18837.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1091" y="-18822.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1091" y="-18807.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_attn_out&#45;&gt;layer6_attn_reshape -->
<g id="edge150" class="edge">
<title>layer6_attn_out&#45;&gt;layer6_attn_reshape</title>
<path fill="none" stroke="black" d="M1088.49,-18903.89C1088.79,-18895.68 1089.11,-18887.03 1089.41,-18878.73"/>
<polygon fill="black" stroke="black" points="1092.92,-18878.59 1089.78,-18868.47 1085.92,-18878.33 1092.92,-18878.59"/>
</g>
<!-- layer6_attn_proj -->
<g id="node126" class="node">
<title>layer6_attn_proj</title>
<polygon fill="yellow" stroke="black" points="1332,-18764.17 864,-18764.17 864,-18696.17 1332,-18696.17 1332,-18764.17"/>
<text text-anchor="middle" x="1098" y="-18748.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="1098" y="-18733.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1098" y="-18718.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1098" y="-18703.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_attn_reshape&#45;&gt;layer6_attn_proj -->
<g id="edge151" class="edge">
<title>layer6_attn_reshape&#45;&gt;layer6_attn_proj</title>
<path fill="none" stroke="black" d="M1093.27,-18800.05C1093.83,-18791.94 1094.43,-18783.15 1095.02,-18774.64"/>
<polygon fill="black" stroke="black" points="1098.52,-18774.68 1095.71,-18764.47 1091.54,-18774.2 1098.52,-18774.68"/>
</g>
<!-- layer6_attn_proj&#45;&gt;layer6_res1 -->
<g id="edge153" class="edge">
<title>layer6_attn_proj&#45;&gt;layer6_res1</title>
<path fill="none" stroke="black" d="M1105.87,-18696.02C1107.8,-18687.87 1109.92,-18678.98 1112,-18670.22"/>
<polygon fill="black" stroke="black" points="1115.41,-18670.98 1114.32,-18660.44 1108.6,-18669.36 1115.41,-18670.98"/>
</g>
<!-- layer6_ln2 -->
<g id="node128" class="node">
<title>layer6_ln2</title>
<polygon fill="yellow" stroke="black" points="1148,-18541.17 680,-18541.17 680,-18473.17 1148,-18473.17 1148,-18541.17"/>
<text text-anchor="middle" x="914" y="-18525.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="914" y="-18510.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="914" y="-18495.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="914" y="-18480.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_res1&#45;&gt;layer6_ln2 -->
<g id="edge154" class="edge">
<title>layer6_res1&#45;&gt;layer6_ln2</title>
<path fill="none" stroke="black" d="M1046.1,-18577.05C1026.55,-18566.86 1005.66,-18555.96 986.39,-18545.91"/>
<polygon fill="black" stroke="black" points="987.86,-18542.73 977.37,-18541.21 984.62,-18548.94 987.86,-18542.73"/>
</g>
<!-- layer6_res2 -->
<g id="node132" class="node">
<title>layer6_res2</title>
<polygon fill="yellow" stroke="black" points="1146,-18125.17 678,-18125.17 678,-18042.17 1146,-18042.17 1146,-18125.17"/>
<text text-anchor="middle" x="912" y="-18109.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="912" y="-18094.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="912" y="-18079.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="912" y="-18064.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="912" y="-18049.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_res1&#45;&gt;layer6_res2 -->
<g id="edge158" class="edge">
<title>layer6_res1&#45;&gt;layer6_res2</title>
<path fill="none" stroke="black" d="M1143.9,-18577.12C1148.83,-18565.71 1153.65,-18553.15 1157,-18541.17 1173.55,-18481.96 1176,-18465.64 1176,-18404.17 1176,-18404.17 1176,-18404.17 1176,-18298.17 1176,-18237 1201.69,-18208.54 1163,-18161.17 1153.31,-18149.3 1141.83,-18139.23 1129.21,-18130.69"/>
<polygon fill="black" stroke="black" points="1131.06,-18127.72 1120.75,-18125.3 1127.3,-18133.62 1131.06,-18127.72"/>
</g>
<!-- layer6_mlp1 -->
<g id="node129" class="node">
<title>layer6_mlp1</title>
<polygon fill="yellow" stroke="black" points="1156.5,-18437.17 653.5,-18437.17 653.5,-18369.17 1156.5,-18369.17 1156.5,-18437.17"/>
<text text-anchor="middle" x="905" y="-18421.97" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="905" y="-18406.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="905" y="-18391.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="905" y="-18376.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_ln2&#45;&gt;layer6_mlp1 -->
<g id="edge155" class="edge">
<title>layer6_ln2&#45;&gt;layer6_mlp1</title>
<path fill="none" stroke="black" d="M911.08,-18473.05C910.36,-18464.94 909.59,-18456.15 908.84,-18447.64"/>
<polygon fill="black" stroke="black" points="912.3,-18447.12 907.94,-18437.47 905.33,-18447.73 912.3,-18447.12"/>
</g>
<!-- layer6_gelu -->
<g id="node130" class="node">
<title>layer6_gelu</title>
<polygon fill="yellow" stroke="black" points="1156.5,-18333.17 653.5,-18333.17 653.5,-18265.17 1156.5,-18265.17 1156.5,-18333.17"/>
<text text-anchor="middle" x="905" y="-18317.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="905" y="-18302.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="905" y="-18287.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="905" y="-18272.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_mlp1&#45;&gt;layer6_gelu -->
<g id="edge156" class="edge">
<title>layer6_mlp1&#45;&gt;layer6_gelu</title>
<path fill="none" stroke="black" d="M905,-18369.05C905,-18360.94 905,-18352.15 905,-18343.64"/>
<polygon fill="black" stroke="black" points="908.5,-18343.47 905,-18333.47 901.5,-18343.47 908.5,-18343.47"/>
</g>
<!-- layer6_mlp2 -->
<g id="node131" class="node">
<title>layer6_mlp2</title>
<polygon fill="yellow" stroke="black" points="1153.5,-18229.17 662.5,-18229.17 662.5,-18161.17 1153.5,-18161.17 1153.5,-18229.17"/>
<text text-anchor="middle" x="908" y="-18213.97" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="908" y="-18198.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="908" y="-18183.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="908" y="-18168.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer6_gelu&#45;&gt;layer6_mlp2 -->
<g id="edge157" class="edge">
<title>layer6_gelu&#45;&gt;layer6_mlp2</title>
<path fill="none" stroke="black" d="M905.97,-18265.05C906.21,-18256.94 906.47,-18248.15 906.72,-18239.64"/>
<polygon fill="black" stroke="black" points="910.23,-18239.56 907.02,-18229.47 903.23,-18239.36 910.23,-18239.56"/>
</g>
<!-- layer6_mlp2&#45;&gt;layer6_res2 -->
<g id="edge159" class="edge">
<title>layer6_mlp2&#45;&gt;layer6_res2</title>
<path fill="none" stroke="black" d="M909.21,-18161.02C909.51,-18152.96 909.83,-18144.17 910.14,-18135.5"/>
<polygon fill="black" stroke="black" points="913.64,-18135.57 910.51,-18125.44 906.65,-18135.31 913.64,-18135.57"/>
</g>
<!-- send_to_gpu_7 -->
<g id="node133" class="node">
<title>send_to_gpu_7</title>
<polygon fill="yellow" stroke="black" points="1397.4,-18006.17 625.24,-18006.17 426.6,-17870.17 1198.76,-17870.17 1397.4,-18006.17"/>
<text text-anchor="middle" x="912" y="-17956.97" font-family="Times,serif" font-size="14.00">Send to GPU 7</text>
<text text-anchor="middle" x="912" y="-17941.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="912" y="-17926.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="912" y="-17911.97" font-family="Times,serif" font-size="14.00">GPU: 6 â†’ GPU 7</text>
</g>
<!-- layer6_res2&#45;&gt;send_to_gpu_7 -->
<g id="edge160" class="edge">
<title>layer6_res2&#45;&gt;send_to_gpu_7</title>
<path fill="none" stroke="black" d="M912,-18041.93C912,-18033.95 912,-18025.33 912,-18016.61"/>
<polygon fill="black" stroke="black" points="915.5,-18016.34 912,-18006.34 908.5,-18016.34 915.5,-18016.34"/>
</g>
<!-- comm_layer_7 -->
<g id="node134" class="node">
<title>comm_layer_7</title>
<polygon fill="yellow" stroke="black" points="1397.4,-17808.17 625.24,-17808.17 426.6,-17672.17 1198.76,-17672.17 1397.4,-17808.17"/>
<text text-anchor="middle" x="912" y="-17758.97" font-family="Times,serif" font-size="14.00">Receive from GPU 6</text>
<text text-anchor="middle" x="912" y="-17743.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="912" y="-17728.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="912" y="-17713.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- send_to_gpu_7&#45;&gt;comm_layer_7 -->
<g id="edge161" class="edge">
<title>send_to_gpu_7&#45;&gt;comm_layer_7</title>
<path fill="none" stroke="black" d="M912,-17869.99C912,-17853.47 912,-17835.65 912,-17818.69"/>
<polygon fill="black" stroke="black" points="915.5,-17818.26 912,-17808.26 908.5,-17818.26 915.5,-17818.26"/>
</g>
<!-- layer7_ln1 -->
<g id="node135" class="node">
<title>layer7_ln1</title>
<polygon fill="yellow" stroke="black" points="1164,-17636.17 696,-17636.17 696,-17568.17 1164,-17568.17 1164,-17636.17"/>
<text text-anchor="middle" x="930" y="-17620.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="930" y="-17605.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="930" y="-17590.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="930" y="-17575.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- comm_layer_7&#45;&gt;layer7_ln1 -->
<g id="edge162" class="edge">
<title>comm_layer_7&#45;&gt;layer7_ln1</title>
<path fill="none" stroke="black" d="M920.89,-17671.96C922.05,-17663.21 923.21,-17654.44 924.3,-17646.23"/>
<polygon fill="black" stroke="black" points="927.79,-17646.56 925.63,-17636.18 920.85,-17645.64 927.79,-17646.56"/>
</g>
<!-- layer7_res1 -->
<g id="node146" class="node">
<title>layer7_res1</title>
<polygon fill="yellow" stroke="black" points="1352,-16670.17 884,-16670.17 884,-16587.17 1352,-16587.17 1352,-16670.17"/>
<text text-anchor="middle" x="1118" y="-16654.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1118" y="-16639.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1118" y="-16624.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1118" y="-16609.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1118" y="-16594.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- comm_layer_7&#45;&gt;layer7_res1 -->
<g id="edge175" class="edge">
<title>comm_layer_7&#45;&gt;layer7_res1</title>
<path fill="none" stroke="black" d="M1222.63,-17688.48C1316.89,-17654.05 1396,-17596.24 1396,-17499.17 1396,-17499.17 1396,-17499.17 1396,-16843.17 1396,-16779.08 1396.32,-16751.48 1351,-16706.17 1338.79,-16693.96 1324.61,-16683.7 1309.38,-16675.08"/>
<polygon fill="black" stroke="black" points="1310.76,-16671.85 1300.3,-16670.19 1307.45,-16678.02 1310.76,-16671.85"/>
</g>
<!-- layer7_qkv -->
<g id="node136" class="node">
<title>layer7_qkv</title>
<polygon fill="yellow" stroke="black" points="1309.5,-17532.17 690.5,-17532.17 690.5,-17464.17 1309.5,-17464.17 1309.5,-17532.17"/>
<text text-anchor="middle" x="1000" y="-17516.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="1000" y="-17501.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1000" y="-17486.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1000" y="-17471.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_ln1&#45;&gt;layer7_qkv -->
<g id="edge163" class="edge">
<title>layer7_ln1&#45;&gt;layer7_qkv</title>
<path fill="none" stroke="black" d="M952.73,-17568.05C958.66,-17559.41 965.12,-17549.99 971.32,-17540.96"/>
<polygon fill="black" stroke="black" points="974.37,-17542.69 977.15,-17532.47 968.6,-17538.73 974.37,-17542.69"/>
</g>
<!-- layer7_reshape_qkv -->
<g id="node137" class="node">
<title>layer7_reshape_qkv</title>
<polygon fill="yellow" stroke="black" points="1344.5,-17428.17 725.5,-17428.17 725.5,-17360.17 1344.5,-17360.17 1344.5,-17428.17"/>
<text text-anchor="middle" x="1035" y="-17412.97" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1035" y="-17397.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1035" y="-17382.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1035" y="-17367.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_qkv&#45;&gt;layer7_reshape_qkv -->
<g id="edge164" class="edge">
<title>layer7_qkv&#45;&gt;layer7_reshape_qkv</title>
<path fill="none" stroke="black" d="M1011.36,-17464.05C1014.21,-17455.77 1017.3,-17446.76 1020.28,-17438.08"/>
<polygon fill="black" stroke="black" points="1023.64,-17439.06 1023.57,-17428.47 1017.02,-17436.79 1023.64,-17439.06"/>
</g>
<!-- layer7_split_q -->
<g id="node138" class="node">
<title>layer7_split_q</title>
<polygon fill="yellow" stroke="black" points="731.5,-17324.17 124.5,-17324.17 124.5,-17256.17 731.5,-17256.17 731.5,-17324.17"/>
<text text-anchor="middle" x="428" y="-17308.97" font-family="Times,serif" font-size="14.00">Split Query</text>
<text text-anchor="middle" x="428" y="-17293.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="428" y="-17278.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="428" y="-17263.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_reshape_qkv&#45;&gt;layer7_split_q -->
<g id="edge165" class="edge">
<title>layer7_reshape_qkv&#45;&gt;layer7_split_q</title>
<path fill="none" stroke="black" d="M838.34,-17360.12C773.21,-17349.18 700.55,-17336.97 634.69,-17325.9"/>
<polygon fill="black" stroke="black" points="635.05,-17322.41 624.6,-17324.2 633.88,-17329.31 635.05,-17322.41"/>
</g>
<!-- layer7_split_k -->
<g id="node139" class="node">
<title>layer7_split_k</title>
<polygon fill="yellow" stroke="black" points="1356.5,-17324.17 749.5,-17324.17 749.5,-17256.17 1356.5,-17256.17 1356.5,-17324.17"/>
<text text-anchor="middle" x="1053" y="-17308.97" font-family="Times,serif" font-size="14.00">Split Key</text>
<text text-anchor="middle" x="1053" y="-17293.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1053" y="-17278.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1053" y="-17263.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_reshape_qkv&#45;&gt;layer7_split_k -->
<g id="edge166" class="edge">
<title>layer7_reshape_qkv&#45;&gt;layer7_split_k</title>
<path fill="none" stroke="black" d="M1040.84,-17360.05C1042.29,-17351.86 1043.86,-17342.96 1045.38,-17334.36"/>
<polygon fill="black" stroke="black" points="1048.83,-17334.92 1047.12,-17324.47 1041.94,-17333.71 1048.83,-17334.92"/>
</g>
<!-- layer7_split_v -->
<g id="node140" class="node">
<title>layer7_split_v</title>
<polygon fill="yellow" stroke="black" points="1376.5,-17212.67 769.5,-17212.67 769.5,-17144.67 1376.5,-17144.67 1376.5,-17212.67"/>
<text text-anchor="middle" x="1073" y="-17197.47" font-family="Times,serif" font-size="14.00">Split Value</text>
<text text-anchor="middle" x="1073" y="-17182.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1073" y="-17167.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1073" y="-17152.47" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_reshape_qkv&#45;&gt;layer7_split_v -->
<g id="edge167" class="edge">
<title>layer7_reshape_qkv&#45;&gt;layer7_split_v</title>
<path fill="none" stroke="black" d="M1292.33,-17360.08C1326.49,-17350.79 1353.92,-17339.03 1366,-17324.17 1385.07,-17300.72 1384.47,-17280.08 1366,-17256.17 1353.37,-17239.82 1320.88,-17226.3 1281.92,-17215.41"/>
<polygon fill="black" stroke="black" points="1282.45,-17211.93 1271.88,-17212.7 1280.62,-17218.68 1282.45,-17211.93"/>
</g>
<!-- layer7_attn_score -->
<g id="node141" class="node">
<title>layer7_attn_score</title>
<polygon fill="yellow" stroke="black" points="751,-17220.17 185,-17220.17 185,-17137.17 751,-17137.17 751,-17220.17"/>
<text text-anchor="middle" x="468" y="-17204.97" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="468" y="-17189.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="468" y="-17174.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="468" y="-17159.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="468" y="-17144.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_split_q&#45;&gt;layer7_attn_score -->
<g id="edge168" class="edge">
<title>layer7_split_q&#45;&gt;layer7_attn_score</title>
<path fill="none" stroke="black" d="M440.11,-17256.02C443.12,-17247.79 446.4,-17238.78 449.64,-17229.94"/>
<polygon fill="black" stroke="black" points="452.96,-17231.04 453.1,-17220.44 446.39,-17228.64 452.96,-17231.04"/>
</g>
<!-- layer7_split_k&#45;&gt;layer7_attn_score -->
<g id="edge169" class="edge">
<title>layer7_split_k&#45;&gt;layer7_attn_score</title>
<path fill="none" stroke="black" d="M876.69,-17256.16C819.4,-17245.44 755.02,-17233.39 694.6,-17222.08"/>
<polygon fill="black" stroke="black" points="695.02,-17218.6 684.54,-17220.2 693.73,-17225.48 695.02,-17218.6"/>
</g>
<!-- layer7_attn_out -->
<g id="node143" class="node">
<title>layer7_attn_out</title>
<polygon fill="yellow" stroke="black" points="1354.5,-16997.17 791.5,-16997.17 791.5,-16914.17 1354.5,-16914.17 1354.5,-16997.17"/>
<text text-anchor="middle" x="1073" y="-16981.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1073" y="-16966.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1073" y="-16951.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1073" y="-16936.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1073" y="-16921.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_split_v&#45;&gt;layer7_attn_out -->
<g id="edge172" class="edge">
<title>layer7_split_v&#45;&gt;layer7_attn_out</title>
<path fill="none" stroke="black" d="M1073,-17144.58C1073,-17108.32 1073,-17049.7 1073,-17007.57"/>
<polygon fill="black" stroke="black" points="1076.5,-17007.51 1073,-16997.51 1069.5,-17007.51 1076.5,-17007.51"/>
</g>
<!-- layer7_attn_weights -->
<g id="node142" class="node">
<title>layer7_attn_weights</title>
<polygon fill="yellow" stroke="black" points="903,-17101.17 337,-17101.17 337,-17033.17 903,-17033.17 903,-17101.17"/>
<text text-anchor="middle" x="620" y="-17085.97" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="620" y="-17070.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="620" y="-17055.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="620" y="-17040.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_attn_score&#45;&gt;layer7_attn_weights -->
<g id="edge170" class="edge">
<title>layer7_attn_score&#45;&gt;layer7_attn_weights</title>
<path fill="none" stroke="black" d="M524.6,-17136.89C538.02,-17127.22 552.31,-17116.93 565.62,-17107.34"/>
<polygon fill="black" stroke="black" points="567.71,-17110.15 573.78,-17101.47 563.62,-17104.47 567.71,-17110.15"/>
</g>
<!-- layer7_attn_weights&#45;&gt;layer7_attn_out -->
<g id="edge171" class="edge">
<title>layer7_attn_weights&#45;&gt;layer7_attn_out</title>
<path fill="none" stroke="black" d="M756.53,-17033.16C800.19,-17022.61 849.17,-17010.77 895.31,-16999.62"/>
<polygon fill="black" stroke="black" points="896.21,-17003 905.11,-16997.25 894.57,-16996.2 896.21,-17003"/>
</g>
<!-- layer7_attn_reshape -->
<g id="node144" class="node">
<title>layer7_attn_reshape</title>
<polygon fill="yellow" stroke="black" points="1362.5,-16878.17 811.5,-16878.17 811.5,-16810.17 1362.5,-16810.17 1362.5,-16878.17"/>
<text text-anchor="middle" x="1087" y="-16862.97" font-family="Times,serif" font-size="14.00">Reshape Attention</text>
<text text-anchor="middle" x="1087" y="-16847.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1087" y="-16832.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1087" y="-16817.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_attn_out&#45;&gt;layer7_attn_reshape -->
<g id="edge173" class="edge">
<title>layer7_attn_out&#45;&gt;layer7_attn_reshape</title>
<path fill="none" stroke="black" d="M1078.21,-16913.89C1079.27,-16905.59 1080.39,-16896.83 1081.47,-16888.45"/>
<polygon fill="black" stroke="black" points="1084.95,-16888.83 1082.74,-16878.47 1078,-16887.94 1084.95,-16888.83"/>
</g>
<!-- layer7_attn_proj -->
<g id="node145" class="node">
<title>layer7_attn_proj</title>
<polygon fill="yellow" stroke="black" points="1342,-16774.17 874,-16774.17 874,-16706.17 1342,-16706.17 1342,-16774.17"/>
<text text-anchor="middle" x="1108" y="-16758.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="1108" y="-16743.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1108" y="-16728.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1108" y="-16713.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_attn_reshape&#45;&gt;layer7_attn_proj -->
<g id="edge174" class="edge">
<title>layer7_attn_reshape&#45;&gt;layer7_attn_proj</title>
<path fill="none" stroke="black" d="M1093.82,-16810.05C1095.51,-16801.86 1097.34,-16792.96 1099.11,-16784.36"/>
<polygon fill="black" stroke="black" points="1102.56,-16784.97 1101.14,-16774.47 1095.7,-16783.55 1102.56,-16784.97"/>
</g>
<!-- layer7_attn_proj&#45;&gt;layer7_res1 -->
<g id="edge176" class="edge">
<title>layer7_attn_proj&#45;&gt;layer7_res1</title>
<path fill="none" stroke="black" d="M1111.03,-16706.02C1111.76,-16697.96 1112.57,-16689.17 1113.36,-16680.5"/>
<polygon fill="black" stroke="black" points="1116.85,-16680.72 1114.28,-16670.44 1109.88,-16680.08 1116.85,-16680.72"/>
</g>
<!-- layer7_ln2 -->
<g id="node147" class="node">
<title>layer7_ln2</title>
<polygon fill="yellow" stroke="black" points="1110,-16551.17 642,-16551.17 642,-16483.17 1110,-16483.17 1110,-16551.17"/>
<text text-anchor="middle" x="876" y="-16535.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="876" y="-16520.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="876" y="-16505.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="876" y="-16490.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_res1&#45;&gt;layer7_ln2 -->
<g id="edge177" class="edge">
<title>layer7_res1&#45;&gt;layer7_ln2</title>
<path fill="none" stroke="black" d="M1028.23,-16587.05C1005.3,-16576.67 980.75,-16565.57 958.22,-16555.37"/>
<polygon fill="black" stroke="black" points="959.58,-16552.14 949.03,-16551.21 956.7,-16558.52 959.58,-16552.14"/>
</g>
<!-- layer7_res2 -->
<g id="node151" class="node">
<title>layer7_res2</title>
<polygon fill="yellow" stroke="black" points="1141,-16135.17 673,-16135.17 673,-16052.17 1141,-16052.17 1141,-16135.17"/>
<text text-anchor="middle" x="907" y="-16119.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="907" y="-16104.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="907" y="-16089.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="907" y="-16074.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="907" y="-16059.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_res1&#45;&gt;layer7_res2 -->
<g id="edge181" class="edge">
<title>layer7_res1&#45;&gt;layer7_res2</title>
<path fill="none" stroke="black" d="M1124.11,-16586.84C1129.99,-16543.95 1138,-16474.48 1138,-16414.17 1138,-16414.17 1138,-16414.17 1138,-16308.17 1138,-16246.96 1161.86,-16219.26 1124,-16171.17 1114.58,-16159.19 1103.14,-16149.09 1090.51,-16140.56"/>
<polygon fill="black" stroke="black" points="1092.36,-16137.59 1082.04,-16135.19 1088.6,-16143.5 1092.36,-16137.59"/>
</g>
<!-- layer7_mlp1 -->
<g id="node148" class="node">
<title>layer7_mlp1</title>
<polygon fill="yellow" stroke="black" points="1118.5,-16447.17 615.5,-16447.17 615.5,-16379.17 1118.5,-16379.17 1118.5,-16447.17"/>
<text text-anchor="middle" x="867" y="-16431.97" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="867" y="-16416.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="867" y="-16401.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="867" y="-16386.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_ln2&#45;&gt;layer7_mlp1 -->
<g id="edge178" class="edge">
<title>layer7_ln2&#45;&gt;layer7_mlp1</title>
<path fill="none" stroke="black" d="M873.08,-16483.05C872.36,-16474.94 871.59,-16466.15 870.84,-16457.64"/>
<polygon fill="black" stroke="black" points="874.3,-16457.12 869.94,-16447.47 867.33,-16457.73 874.3,-16457.12"/>
</g>
<!-- layer7_gelu -->
<g id="node149" class="node">
<title>layer7_gelu</title>
<polygon fill="yellow" stroke="black" points="1118.5,-16343.17 615.5,-16343.17 615.5,-16275.17 1118.5,-16275.17 1118.5,-16343.17"/>
<text text-anchor="middle" x="867" y="-16327.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="867" y="-16312.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="867" y="-16297.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="867" y="-16282.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_mlp1&#45;&gt;layer7_gelu -->
<g id="edge179" class="edge">
<title>layer7_mlp1&#45;&gt;layer7_gelu</title>
<path fill="none" stroke="black" d="M867,-16379.05C867,-16370.94 867,-16362.15 867,-16353.64"/>
<polygon fill="black" stroke="black" points="870.5,-16353.47 867,-16343.47 863.5,-16353.47 870.5,-16353.47"/>
</g>
<!-- layer7_mlp2 -->
<g id="node150" class="node">
<title>layer7_mlp2</title>
<polygon fill="yellow" stroke="black" points="1114.5,-16239.17 623.5,-16239.17 623.5,-16171.17 1114.5,-16171.17 1114.5,-16239.17"/>
<text text-anchor="middle" x="869" y="-16223.97" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="869" y="-16208.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="869" y="-16193.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="869" y="-16178.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer7_gelu&#45;&gt;layer7_mlp2 -->
<g id="edge180" class="edge">
<title>layer7_gelu&#45;&gt;layer7_mlp2</title>
<path fill="none" stroke="black" d="M867.65,-16275.05C867.81,-16266.94 867.98,-16258.15 868.15,-16249.64"/>
<polygon fill="black" stroke="black" points="871.65,-16249.53 868.35,-16239.47 864.65,-16249.4 871.65,-16249.53"/>
</g>
<!-- layer7_mlp2&#45;&gt;layer7_res2 -->
<g id="edge182" class="edge">
<title>layer7_mlp2&#45;&gt;layer7_res2</title>
<path fill="none" stroke="black" d="M880.5,-16171.02C883.36,-16162.79 886.48,-16153.78 889.55,-16144.94"/>
<polygon fill="black" stroke="black" points="892.88,-16146.04 892.85,-16135.44 886.26,-16143.74 892.88,-16146.04"/>
</g>
<!-- send_to_gpu_8 -->
<g id="node152" class="node">
<title>send_to_gpu_8</title>
<polygon fill="yellow" stroke="black" points="1392.4,-16016.17 620.24,-16016.17 421.6,-15880.17 1193.76,-15880.17 1392.4,-16016.17"/>
<text text-anchor="middle" x="907" y="-15966.97" font-family="Times,serif" font-size="14.00">Send to GPU 8</text>
<text text-anchor="middle" x="907" y="-15951.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="907" y="-15936.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="907" y="-15921.97" font-family="Times,serif" font-size="14.00">GPU: 7 â†’ GPU 8</text>
</g>
<!-- layer7_res2&#45;&gt;send_to_gpu_8 -->
<g id="edge183" class="edge">
<title>layer7_res2&#45;&gt;send_to_gpu_8</title>
<path fill="none" stroke="black" d="M907,-16051.93C907,-16043.95 907,-16035.33 907,-16026.61"/>
<polygon fill="black" stroke="black" points="910.5,-16026.34 907,-16016.34 903.5,-16026.34 910.5,-16026.34"/>
</g>
<!-- comm_layer_8 -->
<g id="node153" class="node">
<title>comm_layer_8</title>
<polygon fill="yellow" stroke="black" points="1392.4,-15818.17 620.24,-15818.17 421.6,-15682.17 1193.76,-15682.17 1392.4,-15818.17"/>
<text text-anchor="middle" x="907" y="-15768.97" font-family="Times,serif" font-size="14.00">Receive from GPU 7</text>
<text text-anchor="middle" x="907" y="-15753.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="907" y="-15738.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="907" y="-15723.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- send_to_gpu_8&#45;&gt;comm_layer_8 -->
<g id="edge184" class="edge">
<title>send_to_gpu_8&#45;&gt;comm_layer_8</title>
<path fill="none" stroke="black" d="M907,-15879.99C907,-15863.47 907,-15845.65 907,-15828.69"/>
<polygon fill="black" stroke="black" points="910.5,-15828.26 907,-15818.26 903.5,-15828.26 910.5,-15828.26"/>
</g>
<!-- layer8_ln1 -->
<g id="node154" class="node">
<title>layer8_ln1</title>
<polygon fill="yellow" stroke="black" points="1159,-15646.17 691,-15646.17 691,-15578.17 1159,-15578.17 1159,-15646.17"/>
<text text-anchor="middle" x="925" y="-15630.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="925" y="-15615.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="925" y="-15600.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="925" y="-15585.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- comm_layer_8&#45;&gt;layer8_ln1 -->
<g id="edge185" class="edge">
<title>comm_layer_8&#45;&gt;layer8_ln1</title>
<path fill="none" stroke="black" d="M915.89,-15681.96C917.05,-15673.21 918.21,-15664.44 919.3,-15656.23"/>
<polygon fill="black" stroke="black" points="922.79,-15656.56 920.63,-15646.18 915.85,-15655.64 922.79,-15656.56"/>
</g>
<!-- layer8_res1 -->
<g id="node165" class="node">
<title>layer8_res1</title>
<polygon fill="yellow" stroke="black" points="1349,-14680.17 881,-14680.17 881,-14597.17 1349,-14597.17 1349,-14680.17"/>
<text text-anchor="middle" x="1115" y="-14664.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1115" y="-14649.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1115" y="-14634.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1115" y="-14619.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1115" y="-14604.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- comm_layer_8&#45;&gt;layer8_res1 -->
<g id="edge198" class="edge">
<title>comm_layer_8&#45;&gt;layer8_res1</title>
<path fill="none" stroke="black" d="M1217.63,-15698.48C1311.89,-15664.05 1391,-15606.24 1391,-15509.17 1391,-15509.17 1391,-15509.17 1391,-14853.17 1391,-14786.87 1380.44,-14761.43 1332,-14716.17 1318.89,-14703.91 1303.69,-14693.6 1287.55,-14684.93"/>
<polygon fill="black" stroke="black" points="1288.99,-14681.74 1278.49,-14680.28 1285.79,-14687.97 1288.99,-14681.74"/>
</g>
<!-- layer8_qkv -->
<g id="node155" class="node">
<title>layer8_qkv</title>
<polygon fill="yellow" stroke="black" points="1304.5,-15542.17 685.5,-15542.17 685.5,-15474.17 1304.5,-15474.17 1304.5,-15542.17"/>
<text text-anchor="middle" x="995" y="-15526.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="995" y="-15511.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="995" y="-15496.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="995" y="-15481.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_ln1&#45;&gt;layer8_qkv -->
<g id="edge186" class="edge">
<title>layer8_ln1&#45;&gt;layer8_qkv</title>
<path fill="none" stroke="black" d="M947.73,-15578.05C953.66,-15569.41 960.12,-15559.99 966.32,-15550.96"/>
<polygon fill="black" stroke="black" points="969.37,-15552.69 972.15,-15542.47 963.6,-15548.73 969.37,-15552.69"/>
</g>
<!-- layer8_reshape_qkv -->
<g id="node156" class="node">
<title>layer8_reshape_qkv</title>
<polygon fill="yellow" stroke="black" points="1339.5,-15438.17 720.5,-15438.17 720.5,-15370.17 1339.5,-15370.17 1339.5,-15438.17"/>
<text text-anchor="middle" x="1030" y="-15422.97" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1030" y="-15407.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1030" y="-15392.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1030" y="-15377.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_qkv&#45;&gt;layer8_reshape_qkv -->
<g id="edge187" class="edge">
<title>layer8_qkv&#45;&gt;layer8_reshape_qkv</title>
<path fill="none" stroke="black" d="M1006.36,-15474.05C1009.21,-15465.77 1012.3,-15456.76 1015.28,-15448.08"/>
<polygon fill="black" stroke="black" points="1018.64,-15449.06 1018.57,-15438.47 1012.02,-15446.79 1018.64,-15449.06"/>
</g>
<!-- layer8_split_q -->
<g id="node157" class="node">
<title>layer8_split_q</title>
<polygon fill="yellow" stroke="black" points="726.5,-15334.17 119.5,-15334.17 119.5,-15266.17 726.5,-15266.17 726.5,-15334.17"/>
<text text-anchor="middle" x="423" y="-15318.97" font-family="Times,serif" font-size="14.00">Split Query</text>
<text text-anchor="middle" x="423" y="-15303.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="423" y="-15288.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="423" y="-15273.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_reshape_qkv&#45;&gt;layer8_split_q -->
<g id="edge188" class="edge">
<title>layer8_reshape_qkv&#45;&gt;layer8_split_q</title>
<path fill="none" stroke="black" d="M833.34,-15370.12C768.21,-15359.18 695.55,-15346.97 629.69,-15335.9"/>
<polygon fill="black" stroke="black" points="630.05,-15332.41 619.6,-15334.2 628.88,-15339.31 630.05,-15332.41"/>
</g>
<!-- layer8_split_k -->
<g id="node158" class="node">
<title>layer8_split_k</title>
<polygon fill="yellow" stroke="black" points="1351.5,-15334.17 744.5,-15334.17 744.5,-15266.17 1351.5,-15266.17 1351.5,-15334.17"/>
<text text-anchor="middle" x="1048" y="-15318.97" font-family="Times,serif" font-size="14.00">Split Key</text>
<text text-anchor="middle" x="1048" y="-15303.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1048" y="-15288.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1048" y="-15273.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_reshape_qkv&#45;&gt;layer8_split_k -->
<g id="edge189" class="edge">
<title>layer8_reshape_qkv&#45;&gt;layer8_split_k</title>
<path fill="none" stroke="black" d="M1035.84,-15370.05C1037.29,-15361.86 1038.86,-15352.96 1040.38,-15344.36"/>
<polygon fill="black" stroke="black" points="1043.83,-15344.92 1042.12,-15334.47 1036.94,-15343.71 1043.83,-15344.92"/>
</g>
<!-- layer8_split_v -->
<g id="node159" class="node">
<title>layer8_split_v</title>
<polygon fill="yellow" stroke="black" points="1371.5,-15222.67 764.5,-15222.67 764.5,-15154.67 1371.5,-15154.67 1371.5,-15222.67"/>
<text text-anchor="middle" x="1068" y="-15207.47" font-family="Times,serif" font-size="14.00">Split Value</text>
<text text-anchor="middle" x="1068" y="-15192.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1068" y="-15177.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1068" y="-15162.47" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_reshape_qkv&#45;&gt;layer8_split_v -->
<g id="edge190" class="edge">
<title>layer8_reshape_qkv&#45;&gt;layer8_split_v</title>
<path fill="none" stroke="black" d="M1287.33,-15370.08C1321.49,-15360.79 1348.92,-15349.03 1361,-15334.17 1380.07,-15310.72 1379.47,-15290.08 1361,-15266.17 1348.37,-15249.82 1315.88,-15236.3 1276.92,-15225.41"/>
<polygon fill="black" stroke="black" points="1277.45,-15221.93 1266.88,-15222.7 1275.62,-15228.68 1277.45,-15221.93"/>
</g>
<!-- layer8_attn_score -->
<g id="node160" class="node">
<title>layer8_attn_score</title>
<polygon fill="yellow" stroke="black" points="746,-15230.17 180,-15230.17 180,-15147.17 746,-15147.17 746,-15230.17"/>
<text text-anchor="middle" x="463" y="-15214.97" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="463" y="-15199.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="463" y="-15184.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="463" y="-15169.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="463" y="-15154.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_split_q&#45;&gt;layer8_attn_score -->
<g id="edge191" class="edge">
<title>layer8_split_q&#45;&gt;layer8_attn_score</title>
<path fill="none" stroke="black" d="M435.11,-15266.02C438.12,-15257.79 441.4,-15248.78 444.64,-15239.94"/>
<polygon fill="black" stroke="black" points="447.96,-15241.04 448.1,-15230.44 441.39,-15238.64 447.96,-15241.04"/>
</g>
<!-- layer8_split_k&#45;&gt;layer8_attn_score -->
<g id="edge192" class="edge">
<title>layer8_split_k&#45;&gt;layer8_attn_score</title>
<path fill="none" stroke="black" d="M871.69,-15266.16C814.4,-15255.44 750.02,-15243.39 689.6,-15232.08"/>
<polygon fill="black" stroke="black" points="690.02,-15228.6 679.54,-15230.2 688.73,-15235.48 690.02,-15228.6"/>
</g>
<!-- layer8_attn_out -->
<g id="node162" class="node">
<title>layer8_attn_out</title>
<polygon fill="yellow" stroke="black" points="1349.5,-15007.17 786.5,-15007.17 786.5,-14924.17 1349.5,-14924.17 1349.5,-15007.17"/>
<text text-anchor="middle" x="1068" y="-14991.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1068" y="-14976.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1068" y="-14961.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1068" y="-14946.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1068" y="-14931.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_split_v&#45;&gt;layer8_attn_out -->
<g id="edge195" class="edge">
<title>layer8_split_v&#45;&gt;layer8_attn_out</title>
<path fill="none" stroke="black" d="M1068,-15154.58C1068,-15118.32 1068,-15059.7 1068,-15017.57"/>
<polygon fill="black" stroke="black" points="1071.5,-15017.51 1068,-15007.51 1064.5,-15017.51 1071.5,-15017.51"/>
</g>
<!-- layer8_attn_weights -->
<g id="node161" class="node">
<title>layer8_attn_weights</title>
<polygon fill="yellow" stroke="black" points="898,-15111.17 332,-15111.17 332,-15043.17 898,-15043.17 898,-15111.17"/>
<text text-anchor="middle" x="615" y="-15095.97" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="615" y="-15080.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="615" y="-15065.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="615" y="-15050.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_attn_score&#45;&gt;layer8_attn_weights -->
<g id="edge193" class="edge">
<title>layer8_attn_score&#45;&gt;layer8_attn_weights</title>
<path fill="none" stroke="black" d="M519.6,-15146.89C533.02,-15137.22 547.31,-15126.93 560.62,-15117.34"/>
<polygon fill="black" stroke="black" points="562.71,-15120.15 568.78,-15111.47 558.62,-15114.47 562.71,-15120.15"/>
</g>
<!-- layer8_attn_weights&#45;&gt;layer8_attn_out -->
<g id="edge194" class="edge">
<title>layer8_attn_weights&#45;&gt;layer8_attn_out</title>
<path fill="none" stroke="black" d="M751.53,-15043.16C795.19,-15032.61 844.17,-15020.77 890.31,-15009.62"/>
<polygon fill="black" stroke="black" points="891.21,-15013 900.11,-15007.25 889.57,-15006.2 891.21,-15013"/>
</g>
<!-- layer8_attn_reshape -->
<g id="node163" class="node">
<title>layer8_attn_reshape</title>
<polygon fill="yellow" stroke="black" points="1357.5,-14888.17 806.5,-14888.17 806.5,-14820.17 1357.5,-14820.17 1357.5,-14888.17"/>
<text text-anchor="middle" x="1082" y="-14872.97" font-family="Times,serif" font-size="14.00">Reshape Attention</text>
<text text-anchor="middle" x="1082" y="-14857.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1082" y="-14842.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1082" y="-14827.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_attn_out&#45;&gt;layer8_attn_reshape -->
<g id="edge196" class="edge">
<title>layer8_attn_out&#45;&gt;layer8_attn_reshape</title>
<path fill="none" stroke="black" d="M1073.21,-14923.89C1074.27,-14915.59 1075.39,-14906.83 1076.47,-14898.45"/>
<polygon fill="black" stroke="black" points="1079.95,-14898.83 1077.74,-14888.47 1073,-14897.94 1079.95,-14898.83"/>
</g>
<!-- layer8_attn_proj -->
<g id="node164" class="node">
<title>layer8_attn_proj</title>
<polygon fill="yellow" stroke="black" points="1323,-14784.17 855,-14784.17 855,-14716.17 1323,-14716.17 1323,-14784.17"/>
<text text-anchor="middle" x="1089" y="-14768.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="1089" y="-14753.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1089" y="-14738.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1089" y="-14723.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_attn_reshape&#45;&gt;layer8_attn_proj -->
<g id="edge197" class="edge">
<title>layer8_attn_reshape&#45;&gt;layer8_attn_proj</title>
<path fill="none" stroke="black" d="M1084.27,-14820.05C1084.83,-14811.94 1085.43,-14803.15 1086.02,-14794.64"/>
<polygon fill="black" stroke="black" points="1089.52,-14794.68 1086.71,-14784.47 1082.54,-14794.2 1089.52,-14794.68"/>
</g>
<!-- layer8_attn_proj&#45;&gt;layer8_res1 -->
<g id="edge199" class="edge">
<title>layer8_attn_proj&#45;&gt;layer8_res1</title>
<path fill="none" stroke="black" d="M1096.87,-14716.02C1098.8,-14707.87 1100.92,-14698.98 1103,-14690.22"/>
<polygon fill="black" stroke="black" points="1106.41,-14690.98 1105.32,-14680.44 1099.6,-14689.36 1106.41,-14690.98"/>
</g>
<!-- layer8_ln2 -->
<g id="node166" class="node">
<title>layer8_ln2</title>
<polygon fill="yellow" stroke="black" points="1125,-14561.17 657,-14561.17 657,-14493.17 1125,-14493.17 1125,-14561.17"/>
<text text-anchor="middle" x="891" y="-14545.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="891" y="-14530.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="891" y="-14515.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="891" y="-14500.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_res1&#45;&gt;layer8_ln2 -->
<g id="edge200" class="edge">
<title>layer8_res1&#45;&gt;layer8_ln2</title>
<path fill="none" stroke="black" d="M1031.91,-14597.05C1010.87,-14586.76 988.37,-14575.76 967.66,-14565.64"/>
<polygon fill="black" stroke="black" points="969.12,-14562.46 958.6,-14561.21 966.04,-14568.75 969.12,-14562.46"/>
</g>
<!-- layer8_res2 -->
<g id="node170" class="node">
<title>layer8_res2</title>
<polygon fill="yellow" stroke="black" points="1127,-14145.17 659,-14145.17 659,-14062.17 1127,-14062.17 1127,-14145.17"/>
<text text-anchor="middle" x="893" y="-14129.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="893" y="-14114.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="893" y="-14099.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="893" y="-14084.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="893" y="-14069.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_res1&#45;&gt;layer8_res2 -->
<g id="edge204" class="edge">
<title>layer8_res1&#45;&gt;layer8_res2</title>
<path fill="none" stroke="black" d="M1126.61,-14597.12C1137.78,-14554.45 1153,-14485.16 1153,-14424.17 1153,-14424.17 1153,-14424.17 1153,-14318.17 1153,-14257 1178.58,-14228.63 1140,-14181.17 1130.36,-14169.31 1118.92,-14159.25 1106.32,-14150.72"/>
<polygon fill="black" stroke="black" points="1108.19,-14147.77 1097.88,-14145.34 1104.43,-14153.67 1108.19,-14147.77"/>
</g>
<!-- layer8_mlp1 -->
<g id="node167" class="node">
<title>layer8_mlp1</title>
<polygon fill="yellow" stroke="black" points="1133.5,-14457.17 630.5,-14457.17 630.5,-14389.17 1133.5,-14389.17 1133.5,-14457.17"/>
<text text-anchor="middle" x="882" y="-14441.97" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="882" y="-14426.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="882" y="-14411.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="882" y="-14396.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_ln2&#45;&gt;layer8_mlp1 -->
<g id="edge201" class="edge">
<title>layer8_ln2&#45;&gt;layer8_mlp1</title>
<path fill="none" stroke="black" d="M888.08,-14493.05C887.36,-14484.94 886.59,-14476.15 885.84,-14467.64"/>
<polygon fill="black" stroke="black" points="889.3,-14467.12 884.94,-14457.47 882.33,-14467.73 889.3,-14467.12"/>
</g>
<!-- layer8_gelu -->
<g id="node168" class="node">
<title>layer8_gelu</title>
<polygon fill="yellow" stroke="black" points="1133.5,-14353.17 630.5,-14353.17 630.5,-14285.17 1133.5,-14285.17 1133.5,-14353.17"/>
<text text-anchor="middle" x="882" y="-14337.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="882" y="-14322.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="882" y="-14307.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="882" y="-14292.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_mlp1&#45;&gt;layer8_gelu -->
<g id="edge202" class="edge">
<title>layer8_mlp1&#45;&gt;layer8_gelu</title>
<path fill="none" stroke="black" d="M882,-14389.05C882,-14380.94 882,-14372.15 882,-14363.64"/>
<polygon fill="black" stroke="black" points="885.5,-14363.47 882,-14353.47 878.5,-14363.47 885.5,-14363.47"/>
</g>
<!-- layer8_mlp2 -->
<g id="node169" class="node">
<title>layer8_mlp2</title>
<polygon fill="yellow" stroke="black" points="1130.5,-14249.17 639.5,-14249.17 639.5,-14181.17 1130.5,-14181.17 1130.5,-14249.17"/>
<text text-anchor="middle" x="885" y="-14233.97" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="885" y="-14218.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="885" y="-14203.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="885" y="-14188.97" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer8_gelu&#45;&gt;layer8_mlp2 -->
<g id="edge203" class="edge">
<title>layer8_gelu&#45;&gt;layer8_mlp2</title>
<path fill="none" stroke="black" d="M882.97,-14285.05C883.21,-14276.94 883.47,-14268.15 883.72,-14259.64"/>
<polygon fill="black" stroke="black" points="887.23,-14259.56 884.02,-14249.47 880.23,-14259.36 887.23,-14259.56"/>
</g>
<!-- layer8_mlp2&#45;&gt;layer8_res2 -->
<g id="edge205" class="edge">
<title>layer8_mlp2&#45;&gt;layer8_res2</title>
<path fill="none" stroke="black" d="M887.42,-14181.02C888.01,-14172.96 888.65,-14164.17 889.29,-14155.5"/>
<polygon fill="black" stroke="black" points="892.78,-14155.67 890.02,-14145.44 885.8,-14155.16 892.78,-14155.67"/>
</g>
<!-- send_to_gpu_9 -->
<g id="node171" class="node">
<title>send_to_gpu_9</title>
<polygon fill="yellow" stroke="black" points="1378.4,-14026.17 606.24,-14026.17 407.6,-13890.17 1179.76,-13890.17 1378.4,-14026.17"/>
<text text-anchor="middle" x="893" y="-13976.97" font-family="Times,serif" font-size="14.00">Send to GPU 9</text>
<text text-anchor="middle" x="893" y="-13961.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="893" y="-13946.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="893" y="-13931.97" font-family="Times,serif" font-size="14.00">GPU: 8 â†’ GPU 9</text>
</g>
<!-- layer8_res2&#45;&gt;send_to_gpu_9 -->
<g id="edge206" class="edge">
<title>layer8_res2&#45;&gt;send_to_gpu_9</title>
<path fill="none" stroke="black" d="M893,-14061.93C893,-14053.95 893,-14045.33 893,-14036.61"/>
<polygon fill="black" stroke="black" points="896.5,-14036.34 893,-14026.34 889.5,-14036.34 896.5,-14036.34"/>
</g>
<!-- comm_layer_9 -->
<g id="node172" class="node">
<title>comm_layer_9</title>
<polygon fill="yellow" stroke="black" points="1378.4,-13828.17 606.24,-13828.17 407.6,-13692.17 1179.76,-13692.17 1378.4,-13828.17"/>
<text text-anchor="middle" x="893" y="-13778.97" font-family="Times,serif" font-size="14.00">Receive from GPU 8</text>
<text text-anchor="middle" x="893" y="-13763.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="893" y="-13748.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="893" y="-13733.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- send_to_gpu_9&#45;&gt;comm_layer_9 -->
<g id="edge207" class="edge">
<title>send_to_gpu_9&#45;&gt;comm_layer_9</title>
<path fill="none" stroke="black" d="M893,-13889.99C893,-13873.47 893,-13855.65 893,-13838.69"/>
<polygon fill="black" stroke="black" points="896.5,-13838.26 893,-13828.26 889.5,-13838.26 896.5,-13838.26"/>
</g>
<!-- layer9_ln1 -->
<g id="node173" class="node">
<title>layer9_ln1</title>
<polygon fill="yellow" stroke="black" points="1145,-13656.17 677,-13656.17 677,-13588.17 1145,-13588.17 1145,-13656.17"/>
<text text-anchor="middle" x="911" y="-13640.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="911" y="-13625.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="911" y="-13610.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="911" y="-13595.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- comm_layer_9&#45;&gt;layer9_ln1 -->
<g id="edge208" class="edge">
<title>comm_layer_9&#45;&gt;layer9_ln1</title>
<path fill="none" stroke="black" d="M901.89,-13691.96C903.05,-13683.21 904.21,-13674.44 905.3,-13666.23"/>
<polygon fill="black" stroke="black" points="908.79,-13666.56 906.63,-13656.18 901.85,-13665.64 908.79,-13666.56"/>
</g>
<!-- layer9_res1 -->
<g id="node184" class="node">
<title>layer9_res1</title>
<polygon fill="yellow" stroke="black" points="1323,-12690.17 855,-12690.17 855,-12607.17 1323,-12607.17 1323,-12690.17"/>
<text text-anchor="middle" x="1089" y="-12674.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1089" y="-12659.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1089" y="-12644.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1089" y="-12629.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1089" y="-12614.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- comm_layer_9&#45;&gt;layer9_res1 -->
<g id="edge221" class="edge">
<title>comm_layer_9&#45;&gt;layer9_res1</title>
<path fill="none" stroke="black" d="M1203.63,-13708.48C1297.89,-13674.05 1377,-13616.24 1377,-13519.17 1377,-13519.17 1377,-13519.17 1377,-12863.17 1377,-12794.38 1357,-12771.19 1305,-12726.17 1290.72,-12713.8 1274.31,-12703.39 1257.05,-12694.64"/>
<polygon fill="black" stroke="black" points="1258.48,-12691.44 1247.95,-12690.21 1255.41,-12697.74 1258.48,-12691.44"/>
</g>
<!-- layer9_qkv -->
<g id="node174" class="node">
<title>layer9_qkv</title>
<polygon fill="yellow" stroke="black" points="1290.5,-13552.17 671.5,-13552.17 671.5,-13484.17 1290.5,-13484.17 1290.5,-13552.17"/>
<text text-anchor="middle" x="981" y="-13536.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="981" y="-13521.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="981" y="-13506.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="981" y="-13491.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_ln1&#45;&gt;layer9_qkv -->
<g id="edge209" class="edge">
<title>layer9_ln1&#45;&gt;layer9_qkv</title>
<path fill="none" stroke="black" d="M933.73,-13588.05C939.66,-13579.41 946.12,-13569.99 952.32,-13560.96"/>
<polygon fill="black" stroke="black" points="955.37,-13562.69 958.15,-13552.47 949.6,-13558.73 955.37,-13562.69"/>
</g>
<!-- layer9_reshape_qkv -->
<g id="node175" class="node">
<title>layer9_reshape_qkv</title>
<polygon fill="yellow" stroke="black" points="1325.5,-13448.17 706.5,-13448.17 706.5,-13380.17 1325.5,-13380.17 1325.5,-13448.17"/>
<text text-anchor="middle" x="1016" y="-13432.97" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1016" y="-13417.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1016" y="-13402.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1016" y="-13387.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_qkv&#45;&gt;layer9_reshape_qkv -->
<g id="edge210" class="edge">
<title>layer9_qkv&#45;&gt;layer9_reshape_qkv</title>
<path fill="none" stroke="black" d="M992.36,-13484.05C995.21,-13475.77 998.3,-13466.76 1001.28,-13458.08"/>
<polygon fill="black" stroke="black" points="1004.64,-13459.06 1004.57,-13448.47 998.02,-13456.79 1004.64,-13459.06"/>
</g>
<!-- layer9_split_q -->
<g id="node176" class="node">
<title>layer9_split_q</title>
<polygon fill="yellow" stroke="black" points="712.5,-13344.17 105.5,-13344.17 105.5,-13276.17 712.5,-13276.17 712.5,-13344.17"/>
<text text-anchor="middle" x="409" y="-13328.97" font-family="Times,serif" font-size="14.00">Split Query</text>
<text text-anchor="middle" x="409" y="-13313.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="409" y="-13298.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="409" y="-13283.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_reshape_qkv&#45;&gt;layer9_split_q -->
<g id="edge211" class="edge">
<title>layer9_reshape_qkv&#45;&gt;layer9_split_q</title>
<path fill="none" stroke="black" d="M819.34,-13380.12C754.21,-13369.18 681.55,-13356.97 615.69,-13345.9"/>
<polygon fill="black" stroke="black" points="616.05,-13342.41 605.6,-13344.2 614.88,-13349.31 616.05,-13342.41"/>
</g>
<!-- layer9_split_k -->
<g id="node177" class="node">
<title>layer9_split_k</title>
<polygon fill="yellow" stroke="black" points="1337.5,-13344.17 730.5,-13344.17 730.5,-13276.17 1337.5,-13276.17 1337.5,-13344.17"/>
<text text-anchor="middle" x="1034" y="-13328.97" font-family="Times,serif" font-size="14.00">Split Key</text>
<text text-anchor="middle" x="1034" y="-13313.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1034" y="-13298.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1034" y="-13283.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_reshape_qkv&#45;&gt;layer9_split_k -->
<g id="edge212" class="edge">
<title>layer9_reshape_qkv&#45;&gt;layer9_split_k</title>
<path fill="none" stroke="black" d="M1021.84,-13380.05C1023.29,-13371.86 1024.86,-13362.96 1026.38,-13354.36"/>
<polygon fill="black" stroke="black" points="1029.83,-13354.92 1028.12,-13344.47 1022.94,-13353.71 1029.83,-13354.92"/>
</g>
<!-- layer9_split_v -->
<g id="node178" class="node">
<title>layer9_split_v</title>
<polygon fill="yellow" stroke="black" points="1357.5,-13232.67 750.5,-13232.67 750.5,-13164.67 1357.5,-13164.67 1357.5,-13232.67"/>
<text text-anchor="middle" x="1054" y="-13217.47" font-family="Times,serif" font-size="14.00">Split Value</text>
<text text-anchor="middle" x="1054" y="-13202.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1054" y="-13187.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1054" y="-13172.47" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_reshape_qkv&#45;&gt;layer9_split_v -->
<g id="edge213" class="edge">
<title>layer9_reshape_qkv&#45;&gt;layer9_split_v</title>
<path fill="none" stroke="black" d="M1273.33,-13380.08C1307.49,-13370.79 1334.92,-13359.03 1347,-13344.17 1366.07,-13320.72 1365.47,-13300.08 1347,-13276.17 1334.37,-13259.82 1301.88,-13246.3 1262.92,-13235.41"/>
<polygon fill="black" stroke="black" points="1263.45,-13231.93 1252.88,-13232.7 1261.62,-13238.68 1263.45,-13231.93"/>
</g>
<!-- layer9_attn_score -->
<g id="node179" class="node">
<title>layer9_attn_score</title>
<polygon fill="yellow" stroke="black" points="732,-13240.17 166,-13240.17 166,-13157.17 732,-13157.17 732,-13240.17"/>
<text text-anchor="middle" x="449" y="-13224.97" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="449" y="-13209.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="449" y="-13194.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="449" y="-13179.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="449" y="-13164.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_split_q&#45;&gt;layer9_attn_score -->
<g id="edge214" class="edge">
<title>layer9_split_q&#45;&gt;layer9_attn_score</title>
<path fill="none" stroke="black" d="M421.11,-13276.02C424.12,-13267.79 427.4,-13258.78 430.64,-13249.94"/>
<polygon fill="black" stroke="black" points="433.96,-13251.04 434.1,-13240.44 427.39,-13248.64 433.96,-13251.04"/>
</g>
<!-- layer9_split_k&#45;&gt;layer9_attn_score -->
<g id="edge215" class="edge">
<title>layer9_split_k&#45;&gt;layer9_attn_score</title>
<path fill="none" stroke="black" d="M857.69,-13276.16C800.4,-13265.44 736.02,-13253.39 675.6,-13242.08"/>
<polygon fill="black" stroke="black" points="676.02,-13238.6 665.54,-13240.2 674.73,-13245.48 676.02,-13238.6"/>
</g>
<!-- layer9_attn_out -->
<g id="node181" class="node">
<title>layer9_attn_out</title>
<polygon fill="yellow" stroke="black" points="1335.5,-13017.17 772.5,-13017.17 772.5,-12934.17 1335.5,-12934.17 1335.5,-13017.17"/>
<text text-anchor="middle" x="1054" y="-13001.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1054" y="-12986.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1054" y="-12971.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1054" y="-12956.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1054" y="-12941.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_split_v&#45;&gt;layer9_attn_out -->
<g id="edge218" class="edge">
<title>layer9_split_v&#45;&gt;layer9_attn_out</title>
<path fill="none" stroke="black" d="M1054,-13164.58C1054,-13128.32 1054,-13069.7 1054,-13027.57"/>
<polygon fill="black" stroke="black" points="1057.5,-13027.51 1054,-13017.51 1050.5,-13027.51 1057.5,-13027.51"/>
</g>
<!-- layer9_attn_weights -->
<g id="node180" class="node">
<title>layer9_attn_weights</title>
<polygon fill="yellow" stroke="black" points="884,-13121.17 318,-13121.17 318,-13053.17 884,-13053.17 884,-13121.17"/>
<text text-anchor="middle" x="601" y="-13105.97" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="601" y="-13090.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="601" y="-13075.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="601" y="-13060.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_attn_score&#45;&gt;layer9_attn_weights -->
<g id="edge216" class="edge">
<title>layer9_attn_score&#45;&gt;layer9_attn_weights</title>
<path fill="none" stroke="black" d="M505.6,-13156.89C519.02,-13147.22 533.31,-13136.93 546.62,-13127.34"/>
<polygon fill="black" stroke="black" points="548.71,-13130.15 554.78,-13121.47 544.62,-13124.47 548.71,-13130.15"/>
</g>
<!-- layer9_attn_weights&#45;&gt;layer9_attn_out -->
<g id="edge217" class="edge">
<title>layer9_attn_weights&#45;&gt;layer9_attn_out</title>
<path fill="none" stroke="black" d="M737.53,-13053.16C781.19,-13042.61 830.17,-13030.77 876.31,-13019.62"/>
<polygon fill="black" stroke="black" points="877.21,-13023 886.11,-13017.25 875.57,-13016.2 877.21,-13023"/>
</g>
<!-- layer9_attn_reshape -->
<g id="node182" class="node">
<title>layer9_attn_reshape</title>
<polygon fill="yellow" stroke="black" points="1332.5,-12898.17 781.5,-12898.17 781.5,-12830.17 1332.5,-12830.17 1332.5,-12898.17"/>
<text text-anchor="middle" x="1057" y="-12882.97" font-family="Times,serif" font-size="14.00">Reshape Attention</text>
<text text-anchor="middle" x="1057" y="-12867.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1057" y="-12852.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1057" y="-12837.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_attn_out&#45;&gt;layer9_attn_reshape -->
<g id="edge219" class="edge">
<title>layer9_attn_out&#45;&gt;layer9_attn_reshape</title>
<path fill="none" stroke="black" d="M1055.12,-12933.89C1055.34,-12925.68 1055.58,-12917.03 1055.81,-12908.73"/>
<polygon fill="black" stroke="black" points="1059.31,-12908.56 1056.09,-12898.47 1052.32,-12908.37 1059.31,-12908.56"/>
</g>
<!-- layer9_attn_proj -->
<g id="node183" class="node">
<title>layer9_attn_proj</title>
<polygon fill="yellow" stroke="black" points="1296,-12794.17 828,-12794.17 828,-12726.17 1296,-12726.17 1296,-12794.17"/>
<text text-anchor="middle" x="1062" y="-12778.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="1062" y="-12763.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1062" y="-12748.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1062" y="-12733.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_attn_reshape&#45;&gt;layer9_attn_proj -->
<g id="edge220" class="edge">
<title>layer9_attn_reshape&#45;&gt;layer9_attn_proj</title>
<path fill="none" stroke="black" d="M1058.62,-12830.05C1059.02,-12821.94 1059.45,-12813.15 1059.87,-12804.64"/>
<polygon fill="black" stroke="black" points="1063.37,-12804.63 1060.37,-12794.47 1056.38,-12804.28 1063.37,-12804.63"/>
</g>
<!-- layer9_attn_proj&#45;&gt;layer9_res1 -->
<g id="edge222" class="edge">
<title>layer9_attn_proj&#45;&gt;layer9_res1</title>
<path fill="none" stroke="black" d="M1070.17,-12726.02C1072.18,-12717.87 1074.38,-12708.98 1076.53,-12700.22"/>
<polygon fill="black" stroke="black" points="1079.95,-12700.99 1078.95,-12690.44 1073.15,-12699.32 1079.95,-12700.99"/>
</g>
<!-- layer9_ln2 -->
<g id="node185" class="node">
<title>layer9_ln2</title>
<polygon fill="yellow" stroke="black" points="1116,-12571.17 648,-12571.17 648,-12503.17 1116,-12503.17 1116,-12571.17"/>
<text text-anchor="middle" x="882" y="-12555.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="882" y="-12540.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="882" y="-12525.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="882" y="-12510.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_res1&#45;&gt;layer9_ln2 -->
<g id="edge223" class="edge">
<title>layer9_res1&#45;&gt;layer9_ln2</title>
<path fill="none" stroke="black" d="M1012.22,-12607.05C992.95,-12596.86 972.35,-12585.96 953.36,-12575.91"/>
<polygon fill="black" stroke="black" points="954.94,-12572.79 944.47,-12571.21 951.67,-12578.98 954.94,-12572.79"/>
</g>
<!-- layer9_res2 -->
<g id="node189" class="node">
<title>layer9_res2</title>
<polygon fill="yellow" stroke="black" points="1113,-12155.17 645,-12155.17 645,-12072.17 1113,-12072.17 1113,-12155.17"/>
<text text-anchor="middle" x="879" y="-12139.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="879" y="-12124.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="879" y="-12109.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="879" y="-12094.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="879" y="-12079.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_res1&#45;&gt;layer9_res2 -->
<g id="edge227" class="edge">
<title>layer9_res1&#45;&gt;layer9_res2</title>
<path fill="none" stroke="black" d="M1110.97,-12606.88C1116.28,-12595.58 1121.45,-12583.13 1125,-12571.17 1142.51,-12512.24 1144,-12495.64 1144,-12434.17 1144,-12434.17 1144,-12434.17 1144,-12328.17 1144,-12267 1169.71,-12238.52 1131,-12191.17 1121.27,-12179.26 1109.74,-12169.16 1097.06,-12160.6"/>
<polygon fill="black" stroke="black" points="1098.89,-12157.62 1088.57,-12155.2 1095.13,-12163.52 1098.89,-12157.62"/>
</g>
<!-- layer9_mlp1 -->
<g id="node186" class="node">
<title>layer9_mlp1</title>
<polygon fill="yellow" stroke="black" points="1124.5,-12467.17 621.5,-12467.17 621.5,-12399.17 1124.5,-12399.17 1124.5,-12467.17"/>
<text text-anchor="middle" x="873" y="-12451.97" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="873" y="-12436.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="873" y="-12421.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="873" y="-12406.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_ln2&#45;&gt;layer9_mlp1 -->
<g id="edge224" class="edge">
<title>layer9_ln2&#45;&gt;layer9_mlp1</title>
<path fill="none" stroke="black" d="M879.08,-12503.05C878.36,-12494.94 877.59,-12486.15 876.84,-12477.64"/>
<polygon fill="black" stroke="black" points="880.3,-12477.12 875.94,-12467.47 873.33,-12477.73 880.3,-12477.12"/>
</g>
<!-- layer9_gelu -->
<g id="node187" class="node">
<title>layer9_gelu</title>
<polygon fill="yellow" stroke="black" points="1124.5,-12363.17 621.5,-12363.17 621.5,-12295.17 1124.5,-12295.17 1124.5,-12363.17"/>
<text text-anchor="middle" x="873" y="-12347.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="873" y="-12332.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="873" y="-12317.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="873" y="-12302.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_mlp1&#45;&gt;layer9_gelu -->
<g id="edge225" class="edge">
<title>layer9_mlp1&#45;&gt;layer9_gelu</title>
<path fill="none" stroke="black" d="M873,-12399.05C873,-12390.94 873,-12382.15 873,-12373.64"/>
<polygon fill="black" stroke="black" points="876.5,-12373.47 873,-12363.47 869.5,-12373.47 876.5,-12373.47"/>
</g>
<!-- layer9_mlp2 -->
<g id="node188" class="node">
<title>layer9_mlp2</title>
<polygon fill="yellow" stroke="black" points="1121.5,-12259.17 630.5,-12259.17 630.5,-12191.17 1121.5,-12191.17 1121.5,-12259.17"/>
<text text-anchor="middle" x="876" y="-12243.97" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="876" y="-12228.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="876" y="-12213.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="876" y="-12198.97" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer9_gelu&#45;&gt;layer9_mlp2 -->
<g id="edge226" class="edge">
<title>layer9_gelu&#45;&gt;layer9_mlp2</title>
<path fill="none" stroke="black" d="M873.97,-12295.05C874.21,-12286.94 874.47,-12278.15 874.72,-12269.64"/>
<polygon fill="black" stroke="black" points="878.23,-12269.56 875.02,-12259.47 871.23,-12269.36 878.23,-12269.56"/>
</g>
<!-- layer9_mlp2&#45;&gt;layer9_res2 -->
<g id="edge228" class="edge">
<title>layer9_mlp2&#45;&gt;layer9_res2</title>
<path fill="none" stroke="black" d="M876.91,-12191.02C877.13,-12182.96 877.37,-12174.17 877.61,-12165.5"/>
<polygon fill="black" stroke="black" points="881.11,-12165.54 877.88,-12155.44 874.11,-12165.34 881.11,-12165.54"/>
</g>
<!-- send_to_gpu_10 -->
<g id="node190" class="node">
<title>send_to_gpu_10</title>
<polygon fill="yellow" stroke="black" points="1364.4,-12036.17 592.24,-12036.17 393.6,-11900.17 1165.76,-11900.17 1364.4,-12036.17"/>
<text text-anchor="middle" x="879" y="-11986.97" font-family="Times,serif" font-size="14.00">Send to GPU 10</text>
<text text-anchor="middle" x="879" y="-11971.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="879" y="-11956.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="879" y="-11941.97" font-family="Times,serif" font-size="14.00">GPU: 9 â†’ GPU 10</text>
</g>
<!-- layer9_res2&#45;&gt;send_to_gpu_10 -->
<g id="edge229" class="edge">
<title>layer9_res2&#45;&gt;send_to_gpu_10</title>
<path fill="none" stroke="black" d="M879,-12071.93C879,-12063.95 879,-12055.33 879,-12046.61"/>
<polygon fill="black" stroke="black" points="882.5,-12046.34 879,-12036.34 875.5,-12046.34 882.5,-12046.34"/>
</g>
<!-- comm_layer_10 -->
<g id="node191" class="node">
<title>comm_layer_10</title>
<polygon fill="yellow" stroke="black" points="1364.4,-11838.17 592.24,-11838.17 393.6,-11702.17 1165.76,-11702.17 1364.4,-11838.17"/>
<text text-anchor="middle" x="879" y="-11788.97" font-family="Times,serif" font-size="14.00">Receive from GPU 9</text>
<text text-anchor="middle" x="879" y="-11773.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="879" y="-11758.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="879" y="-11743.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- send_to_gpu_10&#45;&gt;comm_layer_10 -->
<g id="edge230" class="edge">
<title>send_to_gpu_10&#45;&gt;comm_layer_10</title>
<path fill="none" stroke="black" d="M879,-11899.99C879,-11883.47 879,-11865.65 879,-11848.69"/>
<polygon fill="black" stroke="black" points="882.5,-11848.26 879,-11838.26 875.5,-11848.26 882.5,-11848.26"/>
</g>
<!-- layer10_ln1 -->
<g id="node192" class="node">
<title>layer10_ln1</title>
<polygon fill="yellow" stroke="black" points="1131,-11666.17 663,-11666.17 663,-11598.17 1131,-11598.17 1131,-11666.17"/>
<text text-anchor="middle" x="897" y="-11650.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="897" y="-11635.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="897" y="-11620.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="897" y="-11605.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- comm_layer_10&#45;&gt;layer10_ln1 -->
<g id="edge231" class="edge">
<title>comm_layer_10&#45;&gt;layer10_ln1</title>
<path fill="none" stroke="black" d="M887.89,-11701.96C889.05,-11693.21 890.21,-11684.44 891.3,-11676.23"/>
<polygon fill="black" stroke="black" points="894.79,-11676.56 892.63,-11666.18 887.85,-11675.64 894.79,-11676.56"/>
</g>
<!-- layer10_res1 -->
<g id="node203" class="node">
<title>layer10_res1</title>
<polygon fill="yellow" stroke="black" points="1319,-10700.17 851,-10700.17 851,-10617.17 1319,-10617.17 1319,-10700.17"/>
<text text-anchor="middle" x="1085" y="-10684.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1085" y="-10669.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1085" y="-10654.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1085" y="-10639.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1085" y="-10624.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- comm_layer_10&#45;&gt;layer10_res1 -->
<g id="edge244" class="edge">
<title>comm_layer_10&#45;&gt;layer10_res1</title>
<path fill="none" stroke="black" d="M1189.63,-11718.48C1283.89,-11684.05 1363,-11626.24 1363,-11529.17 1363,-11529.17 1363,-11529.17 1363,-10873.17 1363,-10809.08 1363.32,-10781.48 1318,-10736.17 1305.79,-10723.96 1291.61,-10713.7 1276.38,-10705.08"/>
<polygon fill="black" stroke="black" points="1277.76,-10701.85 1267.3,-10700.19 1274.45,-10708.02 1277.76,-10701.85"/>
</g>
<!-- layer10_qkv -->
<g id="node193" class="node">
<title>layer10_qkv</title>
<polygon fill="yellow" stroke="black" points="1276.5,-11562.17 657.5,-11562.17 657.5,-11494.17 1276.5,-11494.17 1276.5,-11562.17"/>
<text text-anchor="middle" x="967" y="-11546.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="967" y="-11531.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="967" y="-11516.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="967" y="-11501.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_ln1&#45;&gt;layer10_qkv -->
<g id="edge232" class="edge">
<title>layer10_ln1&#45;&gt;layer10_qkv</title>
<path fill="none" stroke="black" d="M919.73,-11598.05C925.66,-11589.41 932.12,-11579.99 938.32,-11570.96"/>
<polygon fill="black" stroke="black" points="941.37,-11572.69 944.15,-11562.47 935.6,-11568.73 941.37,-11572.69"/>
</g>
<!-- layer10_reshape_qkv -->
<g id="node194" class="node">
<title>layer10_reshape_qkv</title>
<polygon fill="yellow" stroke="black" points="1311.5,-11458.17 692.5,-11458.17 692.5,-11390.17 1311.5,-11390.17 1311.5,-11458.17"/>
<text text-anchor="middle" x="1002" y="-11442.97" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1002" y="-11427.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1002" y="-11412.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1002" y="-11397.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_qkv&#45;&gt;layer10_reshape_qkv -->
<g id="edge233" class="edge">
<title>layer10_qkv&#45;&gt;layer10_reshape_qkv</title>
<path fill="none" stroke="black" d="M978.36,-11494.05C981.21,-11485.77 984.3,-11476.76 987.28,-11468.08"/>
<polygon fill="black" stroke="black" points="990.64,-11469.06 990.57,-11458.47 984.02,-11466.79 990.64,-11469.06"/>
</g>
<!-- layer10_split_q -->
<g id="node195" class="node">
<title>layer10_split_q</title>
<polygon fill="yellow" stroke="black" points="698.5,-11354.17 91.5,-11354.17 91.5,-11286.17 698.5,-11286.17 698.5,-11354.17"/>
<text text-anchor="middle" x="395" y="-11338.97" font-family="Times,serif" font-size="14.00">Split Query</text>
<text text-anchor="middle" x="395" y="-11323.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="395" y="-11308.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="395" y="-11293.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_reshape_qkv&#45;&gt;layer10_split_q -->
<g id="edge234" class="edge">
<title>layer10_reshape_qkv&#45;&gt;layer10_split_q</title>
<path fill="none" stroke="black" d="M805.34,-11390.12C740.21,-11379.18 667.55,-11366.97 601.69,-11355.9"/>
<polygon fill="black" stroke="black" points="602.05,-11352.41 591.6,-11354.2 600.88,-11359.31 602.05,-11352.41"/>
</g>
<!-- layer10_split_k -->
<g id="node196" class="node">
<title>layer10_split_k</title>
<polygon fill="yellow" stroke="black" points="1323.5,-11354.17 716.5,-11354.17 716.5,-11286.17 1323.5,-11286.17 1323.5,-11354.17"/>
<text text-anchor="middle" x="1020" y="-11338.97" font-family="Times,serif" font-size="14.00">Split Key</text>
<text text-anchor="middle" x="1020" y="-11323.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1020" y="-11308.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1020" y="-11293.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_reshape_qkv&#45;&gt;layer10_split_k -->
<g id="edge235" class="edge">
<title>layer10_reshape_qkv&#45;&gt;layer10_split_k</title>
<path fill="none" stroke="black" d="M1007.84,-11390.05C1009.29,-11381.86 1010.86,-11372.96 1012.38,-11364.36"/>
<polygon fill="black" stroke="black" points="1015.83,-11364.92 1014.12,-11354.47 1008.94,-11363.71 1015.83,-11364.92"/>
</g>
<!-- layer10_split_v -->
<g id="node197" class="node">
<title>layer10_split_v</title>
<polygon fill="yellow" stroke="black" points="1343.5,-11242.67 736.5,-11242.67 736.5,-11174.67 1343.5,-11174.67 1343.5,-11242.67"/>
<text text-anchor="middle" x="1040" y="-11227.47" font-family="Times,serif" font-size="14.00">Split Value</text>
<text text-anchor="middle" x="1040" y="-11212.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1040" y="-11197.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1040" y="-11182.47" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_reshape_qkv&#45;&gt;layer10_split_v -->
<g id="edge236" class="edge">
<title>layer10_reshape_qkv&#45;&gt;layer10_split_v</title>
<path fill="none" stroke="black" d="M1259.33,-11390.08C1293.49,-11380.79 1320.92,-11369.03 1333,-11354.17 1352.07,-11330.72 1351.47,-11310.08 1333,-11286.17 1320.37,-11269.82 1287.88,-11256.3 1248.92,-11245.41"/>
<polygon fill="black" stroke="black" points="1249.45,-11241.93 1238.88,-11242.7 1247.62,-11248.68 1249.45,-11241.93"/>
</g>
<!-- layer10_attn_score -->
<g id="node198" class="node">
<title>layer10_attn_score</title>
<polygon fill="yellow" stroke="black" points="718,-11250.17 152,-11250.17 152,-11167.17 718,-11167.17 718,-11250.17"/>
<text text-anchor="middle" x="435" y="-11234.97" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="435" y="-11219.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="435" y="-11204.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="435" y="-11189.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="435" y="-11174.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_split_q&#45;&gt;layer10_attn_score -->
<g id="edge237" class="edge">
<title>layer10_split_q&#45;&gt;layer10_attn_score</title>
<path fill="none" stroke="black" d="M407.11,-11286.02C410.12,-11277.79 413.4,-11268.78 416.64,-11259.94"/>
<polygon fill="black" stroke="black" points="419.96,-11261.04 420.1,-11250.44 413.39,-11258.64 419.96,-11261.04"/>
</g>
<!-- layer10_split_k&#45;&gt;layer10_attn_score -->
<g id="edge238" class="edge">
<title>layer10_split_k&#45;&gt;layer10_attn_score</title>
<path fill="none" stroke="black" d="M843.69,-11286.16C786.4,-11275.44 722.02,-11263.39 661.6,-11252.08"/>
<polygon fill="black" stroke="black" points="662.02,-11248.6 651.54,-11250.2 660.73,-11255.48 662.02,-11248.6"/>
</g>
<!-- layer10_attn_out -->
<g id="node200" class="node">
<title>layer10_attn_out</title>
<polygon fill="yellow" stroke="black" points="1321.5,-11027.17 758.5,-11027.17 758.5,-10944.17 1321.5,-10944.17 1321.5,-11027.17"/>
<text text-anchor="middle" x="1040" y="-11011.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1040" y="-10996.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1040" y="-10981.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1040" y="-10966.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1040" y="-10951.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_split_v&#45;&gt;layer10_attn_out -->
<g id="edge241" class="edge">
<title>layer10_split_v&#45;&gt;layer10_attn_out</title>
<path fill="none" stroke="black" d="M1040,-11174.58C1040,-11138.32 1040,-11079.7 1040,-11037.57"/>
<polygon fill="black" stroke="black" points="1043.5,-11037.51 1040,-11027.51 1036.5,-11037.51 1043.5,-11037.51"/>
</g>
<!-- layer10_attn_weights -->
<g id="node199" class="node">
<title>layer10_attn_weights</title>
<polygon fill="yellow" stroke="black" points="870,-11131.17 304,-11131.17 304,-11063.17 870,-11063.17 870,-11131.17"/>
<text text-anchor="middle" x="587" y="-11115.97" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="587" y="-11100.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="587" y="-11085.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="587" y="-11070.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_attn_score&#45;&gt;layer10_attn_weights -->
<g id="edge239" class="edge">
<title>layer10_attn_score&#45;&gt;layer10_attn_weights</title>
<path fill="none" stroke="black" d="M491.6,-11166.89C505.02,-11157.22 519.31,-11146.93 532.62,-11137.34"/>
<polygon fill="black" stroke="black" points="534.71,-11140.15 540.78,-11131.47 530.62,-11134.47 534.71,-11140.15"/>
</g>
<!-- layer10_attn_weights&#45;&gt;layer10_attn_out -->
<g id="edge240" class="edge">
<title>layer10_attn_weights&#45;&gt;layer10_attn_out</title>
<path fill="none" stroke="black" d="M723.53,-11063.16C767.19,-11052.61 816.17,-11040.77 862.31,-11029.62"/>
<polygon fill="black" stroke="black" points="863.21,-11033 872.11,-11027.25 861.57,-11026.2 863.21,-11033"/>
</g>
<!-- layer10_attn_reshape -->
<g id="node201" class="node">
<title>layer10_attn_reshape</title>
<polygon fill="yellow" stroke="black" points="1329.5,-10908.17 778.5,-10908.17 778.5,-10840.17 1329.5,-10840.17 1329.5,-10908.17"/>
<text text-anchor="middle" x="1054" y="-10892.97" font-family="Times,serif" font-size="14.00">Reshape Attention</text>
<text text-anchor="middle" x="1054" y="-10877.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1054" y="-10862.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1054" y="-10847.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_attn_out&#45;&gt;layer10_attn_reshape -->
<g id="edge242" class="edge">
<title>layer10_attn_out&#45;&gt;layer10_attn_reshape</title>
<path fill="none" stroke="black" d="M1045.21,-10943.89C1046.27,-10935.59 1047.39,-10926.83 1048.47,-10918.45"/>
<polygon fill="black" stroke="black" points="1051.95,-10918.83 1049.74,-10908.47 1045,-10917.94 1051.95,-10918.83"/>
</g>
<!-- layer10_attn_proj -->
<g id="node202" class="node">
<title>layer10_attn_proj</title>
<polygon fill="yellow" stroke="black" points="1309,-10804.17 841,-10804.17 841,-10736.17 1309,-10736.17 1309,-10804.17"/>
<text text-anchor="middle" x="1075" y="-10788.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="1075" y="-10773.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1075" y="-10758.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1075" y="-10743.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_attn_reshape&#45;&gt;layer10_attn_proj -->
<g id="edge243" class="edge">
<title>layer10_attn_reshape&#45;&gt;layer10_attn_proj</title>
<path fill="none" stroke="black" d="M1060.82,-10840.05C1062.51,-10831.86 1064.34,-10822.96 1066.11,-10814.36"/>
<polygon fill="black" stroke="black" points="1069.56,-10814.97 1068.14,-10804.47 1062.7,-10813.55 1069.56,-10814.97"/>
</g>
<!-- layer10_attn_proj&#45;&gt;layer10_res1 -->
<g id="edge245" class="edge">
<title>layer10_attn_proj&#45;&gt;layer10_res1</title>
<path fill="none" stroke="black" d="M1078.03,-10736.02C1078.76,-10727.96 1079.57,-10719.17 1080.36,-10710.5"/>
<polygon fill="black" stroke="black" points="1083.85,-10710.72 1081.28,-10700.44 1076.88,-10710.08 1083.85,-10710.72"/>
</g>
<!-- layer10_ln2 -->
<g id="node204" class="node">
<title>layer10_ln2</title>
<polygon fill="yellow" stroke="black" points="1077,-10581.17 609,-10581.17 609,-10513.17 1077,-10513.17 1077,-10581.17"/>
<text text-anchor="middle" x="843" y="-10565.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="843" y="-10550.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="843" y="-10535.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="843" y="-10520.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_res1&#45;&gt;layer10_ln2 -->
<g id="edge246" class="edge">
<title>layer10_res1&#45;&gt;layer10_ln2</title>
<path fill="none" stroke="black" d="M995.23,-10617.05C972.3,-10606.67 947.75,-10595.57 925.22,-10585.37"/>
<polygon fill="black" stroke="black" points="926.58,-10582.14 916.03,-10581.21 923.7,-10588.52 926.58,-10582.14"/>
</g>
<!-- layer10_res2 -->
<g id="node208" class="node">
<title>layer10_res2</title>
<polygon fill="yellow" stroke="black" points="1075,-10165.17 607,-10165.17 607,-10082.17 1075,-10082.17 1075,-10165.17"/>
<text text-anchor="middle" x="841" y="-10149.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="841" y="-10134.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="841" y="-10119.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="841" y="-10104.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="841" y="-10089.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_res1&#45;&gt;layer10_res2 -->
<g id="edge250" class="edge">
<title>layer10_res1&#45;&gt;layer10_res2</title>
<path fill="none" stroke="black" d="M1091.11,-10616.84C1096.99,-10573.95 1105,-10504.48 1105,-10444.17 1105,-10444.17 1105,-10444.17 1105,-10338.17 1105,-10276.96 1129.86,-10248.46 1091,-10201.17 1081.25,-10189.3 1069.71,-10179.23 1057.02,-10170.7"/>
<polygon fill="black" stroke="black" points="1058.84,-10167.71 1048.52,-10165.31 1055.09,-10173.62 1058.84,-10167.71"/>
</g>
<!-- layer10_mlp1 -->
<g id="node205" class="node">
<title>layer10_mlp1</title>
<polygon fill="yellow" stroke="black" points="1085.5,-10477.17 582.5,-10477.17 582.5,-10409.17 1085.5,-10409.17 1085.5,-10477.17"/>
<text text-anchor="middle" x="834" y="-10461.97" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="834" y="-10446.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="834" y="-10431.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="834" y="-10416.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_ln2&#45;&gt;layer10_mlp1 -->
<g id="edge247" class="edge">
<title>layer10_ln2&#45;&gt;layer10_mlp1</title>
<path fill="none" stroke="black" d="M840.08,-10513.05C839.36,-10504.94 838.59,-10496.15 837.84,-10487.64"/>
<polygon fill="black" stroke="black" points="841.3,-10487.12 836.94,-10477.47 834.33,-10487.73 841.3,-10487.12"/>
</g>
<!-- layer10_gelu -->
<g id="node206" class="node">
<title>layer10_gelu</title>
<polygon fill="yellow" stroke="black" points="1085.5,-10373.17 582.5,-10373.17 582.5,-10305.17 1085.5,-10305.17 1085.5,-10373.17"/>
<text text-anchor="middle" x="834" y="-10357.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="834" y="-10342.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="834" y="-10327.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="834" y="-10312.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_mlp1&#45;&gt;layer10_gelu -->
<g id="edge248" class="edge">
<title>layer10_mlp1&#45;&gt;layer10_gelu</title>
<path fill="none" stroke="black" d="M834,-10409.05C834,-10400.94 834,-10392.15 834,-10383.64"/>
<polygon fill="black" stroke="black" points="837.5,-10383.47 834,-10373.47 830.5,-10383.47 837.5,-10383.47"/>
</g>
<!-- layer10_mlp2 -->
<g id="node207" class="node">
<title>layer10_mlp2</title>
<polygon fill="yellow" stroke="black" points="1081.5,-10269.17 590.5,-10269.17 590.5,-10201.17 1081.5,-10201.17 1081.5,-10269.17"/>
<text text-anchor="middle" x="836" y="-10253.97" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="836" y="-10238.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="836" y="-10223.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="836" y="-10208.97" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer10_gelu&#45;&gt;layer10_mlp2 -->
<g id="edge249" class="edge">
<title>layer10_gelu&#45;&gt;layer10_mlp2</title>
<path fill="none" stroke="black" d="M834.65,-10305.05C834.81,-10296.94 834.98,-10288.15 835.15,-10279.64"/>
<polygon fill="black" stroke="black" points="838.65,-10279.53 835.35,-10269.47 831.65,-10279.4 838.65,-10279.53"/>
</g>
<!-- layer10_mlp2&#45;&gt;layer10_res2 -->
<g id="edge251" class="edge">
<title>layer10_mlp2&#45;&gt;layer10_res2</title>
<path fill="none" stroke="black" d="M837.51,-10201.02C837.88,-10192.96 838.28,-10184.17 838.68,-10175.5"/>
<polygon fill="black" stroke="black" points="842.18,-10175.59 839.14,-10165.44 835.19,-10175.27 842.18,-10175.59"/>
</g>
<!-- send_to_gpu_11 -->
<g id="node209" class="node">
<title>send_to_gpu_11</title>
<polygon fill="yellow" stroke="black" points="1326.4,-10046.17 554.24,-10046.17 355.6,-9910.17 1127.76,-9910.17 1326.4,-10046.17"/>
<text text-anchor="middle" x="841" y="-9996.97" font-family="Times,serif" font-size="14.00">Send to GPU 11</text>
<text text-anchor="middle" x="841" y="-9981.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="841" y="-9966.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="841" y="-9951.97" font-family="Times,serif" font-size="14.00">GPU: 10 â†’ GPU 11</text>
</g>
<!-- layer10_res2&#45;&gt;send_to_gpu_11 -->
<g id="edge252" class="edge">
<title>layer10_res2&#45;&gt;send_to_gpu_11</title>
<path fill="none" stroke="black" d="M841,-10081.93C841,-10073.95 841,-10065.33 841,-10056.61"/>
<polygon fill="black" stroke="black" points="844.5,-10056.34 841,-10046.34 837.5,-10056.34 844.5,-10056.34"/>
</g>
<!-- comm_layer_11 -->
<g id="node210" class="node">
<title>comm_layer_11</title>
<polygon fill="yellow" stroke="black" points="1326.4,-9848.17 554.24,-9848.17 355.6,-9712.17 1127.76,-9712.17 1326.4,-9848.17"/>
<text text-anchor="middle" x="841" y="-9798.97" font-family="Times,serif" font-size="14.00">Receive from GPU 10</text>
<text text-anchor="middle" x="841" y="-9783.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="841" y="-9768.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="841" y="-9753.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- send_to_gpu_11&#45;&gt;comm_layer_11 -->
<g id="edge253" class="edge">
<title>send_to_gpu_11&#45;&gt;comm_layer_11</title>
<path fill="none" stroke="black" d="M841,-9909.99C841,-9893.47 841,-9875.65 841,-9858.69"/>
<polygon fill="black" stroke="black" points="844.5,-9858.26 841,-9848.26 837.5,-9858.26 844.5,-9858.26"/>
</g>
<!-- layer11_ln1 -->
<g id="node211" class="node">
<title>layer11_ln1</title>
<polygon fill="yellow" stroke="black" points="1093,-9676.17 625,-9676.17 625,-9608.17 1093,-9608.17 1093,-9676.17"/>
<text text-anchor="middle" x="859" y="-9660.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="859" y="-9645.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="859" y="-9630.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="859" y="-9615.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- comm_layer_11&#45;&gt;layer11_ln1 -->
<g id="edge254" class="edge">
<title>comm_layer_11&#45;&gt;layer11_ln1</title>
<path fill="none" stroke="black" d="M849.89,-9711.96C851.05,-9703.21 852.21,-9694.44 853.3,-9686.23"/>
<polygon fill="black" stroke="black" points="856.79,-9686.56 854.63,-9676.18 849.85,-9685.64 856.79,-9686.56"/>
</g>
<!-- layer11_res1 -->
<g id="node222" class="node">
<title>layer11_res1</title>
<polygon fill="yellow" stroke="black" points="1273,-8710.17 805,-8710.17 805,-8627.17 1273,-8627.17 1273,-8710.17"/>
<text text-anchor="middle" x="1039" y="-8694.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1039" y="-8679.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1039" y="-8664.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1039" y="-8649.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1039" y="-8634.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- comm_layer_11&#45;&gt;layer11_res1 -->
<g id="edge267" class="edge">
<title>comm_layer_11&#45;&gt;layer11_res1</title>
<path fill="none" stroke="black" d="M1151.63,-9728.48C1245.89,-9694.05 1325,-9636.24 1325,-9539.17 1325,-9539.17 1325,-9539.17 1325,-8883.17 1325,-8814.99 1307.18,-8791.2 1256,-8746.17 1241.95,-8733.81 1225.78,-8723.41 1208.74,-8714.67"/>
<polygon fill="black" stroke="black" points="1210.27,-8711.52 1199.75,-8710.25 1207.18,-8717.8 1210.27,-8711.52"/>
</g>
<!-- layer11_qkv -->
<g id="node212" class="node">
<title>layer11_qkv</title>
<polygon fill="yellow" stroke="black" points="1238.5,-9572.17 619.5,-9572.17 619.5,-9504.17 1238.5,-9504.17 1238.5,-9572.17"/>
<text text-anchor="middle" x="929" y="-9556.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="929" y="-9541.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="929" y="-9526.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="929" y="-9511.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_ln1&#45;&gt;layer11_qkv -->
<g id="edge255" class="edge">
<title>layer11_ln1&#45;&gt;layer11_qkv</title>
<path fill="none" stroke="black" d="M881.73,-9608.05C887.66,-9599.41 894.12,-9589.99 900.32,-9580.96"/>
<polygon fill="black" stroke="black" points="903.37,-9582.69 906.15,-9572.47 897.6,-9578.73 903.37,-9582.69"/>
</g>
<!-- layer11_reshape_qkv -->
<g id="node213" class="node">
<title>layer11_reshape_qkv</title>
<polygon fill="yellow" stroke="black" points="1273.5,-9468.17 654.5,-9468.17 654.5,-9400.17 1273.5,-9400.17 1273.5,-9468.17"/>
<text text-anchor="middle" x="964" y="-9452.97" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="964" y="-9437.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="964" y="-9422.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="964" y="-9407.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_qkv&#45;&gt;layer11_reshape_qkv -->
<g id="edge256" class="edge">
<title>layer11_qkv&#45;&gt;layer11_reshape_qkv</title>
<path fill="none" stroke="black" d="M940.36,-9504.05C943.21,-9495.77 946.3,-9486.76 949.28,-9478.08"/>
<polygon fill="black" stroke="black" points="952.64,-9479.06 952.57,-9468.47 946.02,-9476.79 952.64,-9479.06"/>
</g>
<!-- layer11_split_q -->
<g id="node214" class="node">
<title>layer11_split_q</title>
<polygon fill="yellow" stroke="black" points="660.5,-9364.17 53.5,-9364.17 53.5,-9296.17 660.5,-9296.17 660.5,-9364.17"/>
<text text-anchor="middle" x="357" y="-9348.97" font-family="Times,serif" font-size="14.00">Split Query</text>
<text text-anchor="middle" x="357" y="-9333.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="357" y="-9318.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="357" y="-9303.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_reshape_qkv&#45;&gt;layer11_split_q -->
<g id="edge257" class="edge">
<title>layer11_reshape_qkv&#45;&gt;layer11_split_q</title>
<path fill="none" stroke="black" d="M767.34,-9400.12C702.21,-9389.18 629.55,-9376.97 563.69,-9365.9"/>
<polygon fill="black" stroke="black" points="564.05,-9362.41 553.6,-9364.2 562.88,-9369.31 564.05,-9362.41"/>
</g>
<!-- layer11_split_k -->
<g id="node215" class="node">
<title>layer11_split_k</title>
<polygon fill="yellow" stroke="black" points="1285.5,-9364.17 678.5,-9364.17 678.5,-9296.17 1285.5,-9296.17 1285.5,-9364.17"/>
<text text-anchor="middle" x="982" y="-9348.97" font-family="Times,serif" font-size="14.00">Split Key</text>
<text text-anchor="middle" x="982" y="-9333.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="982" y="-9318.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="982" y="-9303.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_reshape_qkv&#45;&gt;layer11_split_k -->
<g id="edge258" class="edge">
<title>layer11_reshape_qkv&#45;&gt;layer11_split_k</title>
<path fill="none" stroke="black" d="M969.84,-9400.05C971.29,-9391.86 972.86,-9382.96 974.38,-9374.36"/>
<polygon fill="black" stroke="black" points="977.83,-9374.92 976.12,-9364.47 970.94,-9373.71 977.83,-9374.92"/>
</g>
<!-- layer11_split_v -->
<g id="node216" class="node">
<title>layer11_split_v</title>
<polygon fill="yellow" stroke="black" points="1305.5,-9252.67 698.5,-9252.67 698.5,-9184.67 1305.5,-9184.67 1305.5,-9252.67"/>
<text text-anchor="middle" x="1002" y="-9237.47" font-family="Times,serif" font-size="14.00">Split Value</text>
<text text-anchor="middle" x="1002" y="-9222.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="1002" y="-9207.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1002" y="-9192.47" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_reshape_qkv&#45;&gt;layer11_split_v -->
<g id="edge259" class="edge">
<title>layer11_reshape_qkv&#45;&gt;layer11_split_v</title>
<path fill="none" stroke="black" d="M1221.33,-9400.08C1255.49,-9390.79 1282.92,-9379.03 1295,-9364.17 1314.07,-9340.72 1313.47,-9320.08 1295,-9296.17 1282.37,-9279.82 1249.88,-9266.3 1210.92,-9255.41"/>
<polygon fill="black" stroke="black" points="1211.45,-9251.93 1200.88,-9252.7 1209.62,-9258.68 1211.45,-9251.93"/>
</g>
<!-- layer11_attn_score -->
<g id="node217" class="node">
<title>layer11_attn_score</title>
<polygon fill="yellow" stroke="black" points="680,-9260.17 114,-9260.17 114,-9177.17 680,-9177.17 680,-9260.17"/>
<text text-anchor="middle" x="397" y="-9244.97" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="397" y="-9229.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="397" y="-9214.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="397" y="-9199.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="397" y="-9184.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_split_q&#45;&gt;layer11_attn_score -->
<g id="edge260" class="edge">
<title>layer11_split_q&#45;&gt;layer11_attn_score</title>
<path fill="none" stroke="black" d="M369.11,-9296.02C372.12,-9287.79 375.4,-9278.78 378.64,-9269.94"/>
<polygon fill="black" stroke="black" points="381.96,-9271.04 382.1,-9260.44 375.39,-9268.64 381.96,-9271.04"/>
</g>
<!-- layer11_split_k&#45;&gt;layer11_attn_score -->
<g id="edge261" class="edge">
<title>layer11_split_k&#45;&gt;layer11_attn_score</title>
<path fill="none" stroke="black" d="M805.69,-9296.16C748.4,-9285.44 684.02,-9273.39 623.6,-9262.08"/>
<polygon fill="black" stroke="black" points="624.02,-9258.6 613.54,-9260.2 622.73,-9265.48 624.02,-9258.6"/>
</g>
<!-- layer11_attn_out -->
<g id="node219" class="node">
<title>layer11_attn_out</title>
<polygon fill="yellow" stroke="black" points="1283.5,-9037.17 720.5,-9037.17 720.5,-8954.17 1283.5,-8954.17 1283.5,-9037.17"/>
<text text-anchor="middle" x="1002" y="-9021.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1002" y="-9006.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="1002" y="-8991.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1002" y="-8976.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1002" y="-8961.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_split_v&#45;&gt;layer11_attn_out -->
<g id="edge264" class="edge">
<title>layer11_split_v&#45;&gt;layer11_attn_out</title>
<path fill="none" stroke="black" d="M1002,-9184.58C1002,-9148.32 1002,-9089.7 1002,-9047.57"/>
<polygon fill="black" stroke="black" points="1005.5,-9047.51 1002,-9037.51 998.5,-9047.51 1005.5,-9047.51"/>
</g>
<!-- layer11_attn_weights -->
<g id="node218" class="node">
<title>layer11_attn_weights</title>
<polygon fill="yellow" stroke="black" points="832,-9141.17 266,-9141.17 266,-9073.17 832,-9073.17 832,-9141.17"/>
<text text-anchor="middle" x="549" y="-9125.97" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="549" y="-9110.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="549" y="-9095.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="549" y="-9080.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_attn_score&#45;&gt;layer11_attn_weights -->
<g id="edge262" class="edge">
<title>layer11_attn_score&#45;&gt;layer11_attn_weights</title>
<path fill="none" stroke="black" d="M453.6,-9176.89C467.02,-9167.22 481.31,-9156.93 494.62,-9147.34"/>
<polygon fill="black" stroke="black" points="496.71,-9150.15 502.78,-9141.47 492.62,-9144.47 496.71,-9150.15"/>
</g>
<!-- layer11_attn_weights&#45;&gt;layer11_attn_out -->
<g id="edge263" class="edge">
<title>layer11_attn_weights&#45;&gt;layer11_attn_out</title>
<path fill="none" stroke="black" d="M685.53,-9073.16C729.19,-9062.61 778.17,-9050.77 824.31,-9039.62"/>
<polygon fill="black" stroke="black" points="825.21,-9043 834.11,-9037.25 823.57,-9036.2 825.21,-9043"/>
</g>
<!-- layer11_attn_reshape -->
<g id="node220" class="node">
<title>layer11_attn_reshape</title>
<polygon fill="yellow" stroke="black" points="1281.5,-8918.17 730.5,-8918.17 730.5,-8850.17 1281.5,-8850.17 1281.5,-8918.17"/>
<text text-anchor="middle" x="1006" y="-8902.97" font-family="Times,serif" font-size="14.00">Reshape Attention</text>
<text text-anchor="middle" x="1006" y="-8887.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1006" y="-8872.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1006" y="-8857.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_attn_out&#45;&gt;layer11_attn_reshape -->
<g id="edge265" class="edge">
<title>layer11_attn_out&#45;&gt;layer11_attn_reshape</title>
<path fill="none" stroke="black" d="M1003.49,-8953.89C1003.79,-8945.68 1004.11,-8937.03 1004.41,-8928.73"/>
<polygon fill="black" stroke="black" points="1007.92,-8928.59 1004.78,-8918.47 1000.92,-8928.33 1007.92,-8928.59"/>
</g>
<!-- layer11_attn_proj -->
<g id="node221" class="node">
<title>layer11_attn_proj</title>
<polygon fill="yellow" stroke="black" points="1247,-8814.17 779,-8814.17 779,-8746.17 1247,-8746.17 1247,-8814.17"/>
<text text-anchor="middle" x="1013" y="-8798.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="1013" y="-8783.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1013" y="-8768.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1013" y="-8753.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_attn_reshape&#45;&gt;layer11_attn_proj -->
<g id="edge266" class="edge">
<title>layer11_attn_reshape&#45;&gt;layer11_attn_proj</title>
<path fill="none" stroke="black" d="M1008.27,-8850.05C1008.83,-8841.94 1009.43,-8833.15 1010.02,-8824.64"/>
<polygon fill="black" stroke="black" points="1013.52,-8824.68 1010.71,-8814.47 1006.54,-8824.2 1013.52,-8824.68"/>
</g>
<!-- layer11_attn_proj&#45;&gt;layer11_res1 -->
<g id="edge268" class="edge">
<title>layer11_attn_proj&#45;&gt;layer11_res1</title>
<path fill="none" stroke="black" d="M1020.87,-8746.02C1022.8,-8737.87 1024.92,-8728.98 1027,-8720.22"/>
<polygon fill="black" stroke="black" points="1030.41,-8720.98 1029.32,-8710.44 1023.6,-8719.36 1030.41,-8720.98"/>
</g>
<!-- layer11_ln2 -->
<g id="node223" class="node">
<title>layer11_ln2</title>
<polygon fill="yellow" stroke="black" points="1063,-8591.17 595,-8591.17 595,-8523.17 1063,-8523.17 1063,-8591.17"/>
<text text-anchor="middle" x="829" y="-8575.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="829" y="-8560.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="829" y="-8545.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="829" y="-8530.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_res1&#45;&gt;layer11_ln2 -->
<g id="edge269" class="edge">
<title>layer11_res1&#45;&gt;layer11_ln2</title>
<path fill="none" stroke="black" d="M961.1,-8627.05C941.55,-8616.86 920.66,-8605.96 901.39,-8595.91"/>
<polygon fill="black" stroke="black" points="902.86,-8592.73 892.37,-8591.21 899.62,-8598.94 902.86,-8592.73"/>
</g>
<!-- layer11_res2 -->
<g id="node227" class="node">
<title>layer11_res2</title>
<polygon fill="yellow" stroke="black" points="1061,-8175.17 593,-8175.17 593,-8092.17 1061,-8092.17 1061,-8175.17"/>
<text text-anchor="middle" x="827" y="-8159.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="827" y="-8144.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="827" y="-8129.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="827" y="-8114.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="827" y="-8099.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_res1&#45;&gt;layer11_res2 -->
<g id="edge273" class="edge">
<title>layer11_res1&#45;&gt;layer11_res2</title>
<path fill="none" stroke="black" d="M1058.9,-8627.12C1063.83,-8615.71 1068.65,-8603.15 1072,-8591.17 1088.55,-8531.96 1091,-8515.64 1091,-8454.17 1091,-8454.17 1091,-8454.17 1091,-8348.17 1091,-8287 1116.69,-8258.54 1078,-8211.17 1068.31,-8199.3 1056.83,-8189.23 1044.21,-8180.69"/>
<polygon fill="black" stroke="black" points="1046.06,-8177.72 1035.75,-8175.3 1042.3,-8183.62 1046.06,-8177.72"/>
</g>
<!-- layer11_mlp1 -->
<g id="node224" class="node">
<title>layer11_mlp1</title>
<polygon fill="yellow" stroke="black" points="1071.5,-8487.17 568.5,-8487.17 568.5,-8419.17 1071.5,-8419.17 1071.5,-8487.17"/>
<text text-anchor="middle" x="820" y="-8471.97" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="820" y="-8456.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="820" y="-8441.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="820" y="-8426.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_ln2&#45;&gt;layer11_mlp1 -->
<g id="edge270" class="edge">
<title>layer11_ln2&#45;&gt;layer11_mlp1</title>
<path fill="none" stroke="black" d="M826.08,-8523.05C825.36,-8514.94 824.59,-8506.15 823.84,-8497.64"/>
<polygon fill="black" stroke="black" points="827.3,-8497.12 822.94,-8487.47 820.33,-8497.73 827.3,-8497.12"/>
</g>
<!-- layer11_gelu -->
<g id="node225" class="node">
<title>layer11_gelu</title>
<polygon fill="yellow" stroke="black" points="1071.5,-8383.17 568.5,-8383.17 568.5,-8315.17 1071.5,-8315.17 1071.5,-8383.17"/>
<text text-anchor="middle" x="820" y="-8367.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="820" y="-8352.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="820" y="-8337.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="820" y="-8322.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_mlp1&#45;&gt;layer11_gelu -->
<g id="edge271" class="edge">
<title>layer11_mlp1&#45;&gt;layer11_gelu</title>
<path fill="none" stroke="black" d="M820,-8419.05C820,-8410.94 820,-8402.15 820,-8393.64"/>
<polygon fill="black" stroke="black" points="823.5,-8393.47 820,-8383.47 816.5,-8393.47 823.5,-8393.47"/>
</g>
<!-- layer11_mlp2 -->
<g id="node226" class="node">
<title>layer11_mlp2</title>
<polygon fill="yellow" stroke="black" points="1068.5,-8279.17 577.5,-8279.17 577.5,-8211.17 1068.5,-8211.17 1068.5,-8279.17"/>
<text text-anchor="middle" x="823" y="-8263.97" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="823" y="-8248.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="823" y="-8233.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="823" y="-8218.97" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer11_gelu&#45;&gt;layer11_mlp2 -->
<g id="edge272" class="edge">
<title>layer11_gelu&#45;&gt;layer11_mlp2</title>
<path fill="none" stroke="black" d="M820.97,-8315.05C821.21,-8306.94 821.47,-8298.15 821.72,-8289.64"/>
<polygon fill="black" stroke="black" points="825.23,-8289.56 822.02,-8279.47 818.23,-8289.36 825.23,-8289.56"/>
</g>
<!-- layer11_mlp2&#45;&gt;layer11_res2 -->
<g id="edge274" class="edge">
<title>layer11_mlp2&#45;&gt;layer11_res2</title>
<path fill="none" stroke="black" d="M824.21,-8211.02C824.51,-8202.96 824.83,-8194.17 825.14,-8185.5"/>
<polygon fill="black" stroke="black" points="828.64,-8185.57 825.51,-8175.44 821.65,-8185.31 828.64,-8185.57"/>
</g>
<!-- send_to_gpu_12 -->
<g id="node228" class="node">
<title>send_to_gpu_12</title>
<polygon fill="yellow" stroke="black" points="1312.4,-8056.17 540.24,-8056.17 341.6,-7920.17 1113.76,-7920.17 1312.4,-8056.17"/>
<text text-anchor="middle" x="827" y="-8006.97" font-family="Times,serif" font-size="14.00">Send to GPU 12</text>
<text text-anchor="middle" x="827" y="-7991.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="827" y="-7976.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="827" y="-7961.97" font-family="Times,serif" font-size="14.00">GPU: 11 â†’ GPU 12</text>
</g>
<!-- layer11_res2&#45;&gt;send_to_gpu_12 -->
<g id="edge275" class="edge">
<title>layer11_res2&#45;&gt;send_to_gpu_12</title>
<path fill="none" stroke="black" d="M827,-8091.93C827,-8083.95 827,-8075.33 827,-8066.61"/>
<polygon fill="black" stroke="black" points="830.5,-8066.34 827,-8056.34 823.5,-8066.34 830.5,-8066.34"/>
</g>
<!-- comm_layer_12 -->
<g id="node229" class="node">
<title>comm_layer_12</title>
<polygon fill="yellow" stroke="black" points="1312.4,-7858.17 540.24,-7858.17 341.6,-7722.17 1113.76,-7722.17 1312.4,-7858.17"/>
<text text-anchor="middle" x="827" y="-7808.97" font-family="Times,serif" font-size="14.00">Receive from GPU 11</text>
<text text-anchor="middle" x="827" y="-7793.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="827" y="-7778.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="827" y="-7763.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- send_to_gpu_12&#45;&gt;comm_layer_12 -->
<g id="edge276" class="edge">
<title>send_to_gpu_12&#45;&gt;comm_layer_12</title>
<path fill="none" stroke="black" d="M827,-7919.99C827,-7903.47 827,-7885.65 827,-7868.69"/>
<polygon fill="black" stroke="black" points="830.5,-7868.26 827,-7858.26 823.5,-7868.26 830.5,-7868.26"/>
</g>
<!-- layer12_ln1 -->
<g id="node230" class="node">
<title>layer12_ln1</title>
<polygon fill="yellow" stroke="black" points="1079,-7686.17 611,-7686.17 611,-7618.17 1079,-7618.17 1079,-7686.17"/>
<text text-anchor="middle" x="845" y="-7670.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="845" y="-7655.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="845" y="-7640.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="845" y="-7625.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- comm_layer_12&#45;&gt;layer12_ln1 -->
<g id="edge277" class="edge">
<title>comm_layer_12&#45;&gt;layer12_ln1</title>
<path fill="none" stroke="black" d="M835.89,-7721.96C837.05,-7713.21 838.21,-7704.44 839.3,-7696.23"/>
<polygon fill="black" stroke="black" points="842.79,-7696.56 840.63,-7686.18 835.85,-7695.64 842.79,-7696.56"/>
</g>
<!-- layer12_res1 -->
<g id="node241" class="node">
<title>layer12_res1</title>
<polygon fill="yellow" stroke="black" points="1267,-6720.17 799,-6720.17 799,-6637.17 1267,-6637.17 1267,-6720.17"/>
<text text-anchor="middle" x="1033" y="-6704.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1033" y="-6689.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1033" y="-6674.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1033" y="-6659.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1033" y="-6644.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- comm_layer_12&#45;&gt;layer12_res1 -->
<g id="edge290" class="edge">
<title>comm_layer_12&#45;&gt;layer12_res1</title>
<path fill="none" stroke="black" d="M1137.63,-7738.48C1231.89,-7704.05 1311,-7646.24 1311,-7549.17 1311,-7549.17 1311,-7549.17 1311,-6893.17 1311,-6829.08 1311.32,-6801.48 1266,-6756.17 1253.79,-6743.96 1239.61,-6733.7 1224.38,-6725.08"/>
<polygon fill="black" stroke="black" points="1225.76,-6721.85 1215.3,-6720.19 1222.45,-6728.02 1225.76,-6721.85"/>
</g>
<!-- layer12_qkv -->
<g id="node231" class="node">
<title>layer12_qkv</title>
<polygon fill="yellow" stroke="black" points="1224.5,-7582.17 605.5,-7582.17 605.5,-7514.17 1224.5,-7514.17 1224.5,-7582.17"/>
<text text-anchor="middle" x="915" y="-7566.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="915" y="-7551.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="915" y="-7536.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="915" y="-7521.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_ln1&#45;&gt;layer12_qkv -->
<g id="edge278" class="edge">
<title>layer12_ln1&#45;&gt;layer12_qkv</title>
<path fill="none" stroke="black" d="M867.73,-7618.05C873.66,-7609.41 880.12,-7599.99 886.32,-7590.96"/>
<polygon fill="black" stroke="black" points="889.37,-7592.69 892.15,-7582.47 883.6,-7588.73 889.37,-7592.69"/>
</g>
<!-- layer12_reshape_qkv -->
<g id="node232" class="node">
<title>layer12_reshape_qkv</title>
<polygon fill="yellow" stroke="black" points="1259.5,-7478.17 640.5,-7478.17 640.5,-7410.17 1259.5,-7410.17 1259.5,-7478.17"/>
<text text-anchor="middle" x="950" y="-7462.97" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="950" y="-7447.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="950" y="-7432.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="950" y="-7417.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_qkv&#45;&gt;layer12_reshape_qkv -->
<g id="edge279" class="edge">
<title>layer12_qkv&#45;&gt;layer12_reshape_qkv</title>
<path fill="none" stroke="black" d="M926.36,-7514.05C929.21,-7505.77 932.3,-7496.76 935.28,-7488.08"/>
<polygon fill="black" stroke="black" points="938.64,-7489.06 938.57,-7478.47 932.02,-7486.79 938.64,-7489.06"/>
</g>
<!-- layer12_split_q -->
<g id="node233" class="node">
<title>layer12_split_q</title>
<polygon fill="yellow" stroke="black" points="646.5,-7374.17 39.5,-7374.17 39.5,-7306.17 646.5,-7306.17 646.5,-7374.17"/>
<text text-anchor="middle" x="343" y="-7358.97" font-family="Times,serif" font-size="14.00">Split Query</text>
<text text-anchor="middle" x="343" y="-7343.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="343" y="-7328.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="343" y="-7313.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_reshape_qkv&#45;&gt;layer12_split_q -->
<g id="edge280" class="edge">
<title>layer12_reshape_qkv&#45;&gt;layer12_split_q</title>
<path fill="none" stroke="black" d="M753.34,-7410.12C688.21,-7399.18 615.55,-7386.97 549.69,-7375.9"/>
<polygon fill="black" stroke="black" points="550.05,-7372.41 539.6,-7374.2 548.88,-7379.31 550.05,-7372.41"/>
</g>
<!-- layer12_split_k -->
<g id="node234" class="node">
<title>layer12_split_k</title>
<polygon fill="yellow" stroke="black" points="1271.5,-7374.17 664.5,-7374.17 664.5,-7306.17 1271.5,-7306.17 1271.5,-7374.17"/>
<text text-anchor="middle" x="968" y="-7358.97" font-family="Times,serif" font-size="14.00">Split Key</text>
<text text-anchor="middle" x="968" y="-7343.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="968" y="-7328.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="968" y="-7313.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_reshape_qkv&#45;&gt;layer12_split_k -->
<g id="edge281" class="edge">
<title>layer12_reshape_qkv&#45;&gt;layer12_split_k</title>
<path fill="none" stroke="black" d="M955.84,-7410.05C957.29,-7401.86 958.86,-7392.96 960.38,-7384.36"/>
<polygon fill="black" stroke="black" points="963.83,-7384.92 962.12,-7374.47 956.94,-7383.71 963.83,-7384.92"/>
</g>
<!-- layer12_split_v -->
<g id="node235" class="node">
<title>layer12_split_v</title>
<polygon fill="yellow" stroke="black" points="1291.5,-7262.67 684.5,-7262.67 684.5,-7194.67 1291.5,-7194.67 1291.5,-7262.67"/>
<text text-anchor="middle" x="988" y="-7247.47" font-family="Times,serif" font-size="14.00">Split Value</text>
<text text-anchor="middle" x="988" y="-7232.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="988" y="-7217.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="988" y="-7202.47" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_reshape_qkv&#45;&gt;layer12_split_v -->
<g id="edge282" class="edge">
<title>layer12_reshape_qkv&#45;&gt;layer12_split_v</title>
<path fill="none" stroke="black" d="M1207.33,-7410.08C1241.49,-7400.79 1268.92,-7389.03 1281,-7374.17 1300.07,-7350.72 1299.47,-7330.08 1281,-7306.17 1268.37,-7289.82 1235.88,-7276.3 1196.92,-7265.41"/>
<polygon fill="black" stroke="black" points="1197.45,-7261.93 1186.88,-7262.7 1195.62,-7268.68 1197.45,-7261.93"/>
</g>
<!-- layer12_attn_score -->
<g id="node236" class="node">
<title>layer12_attn_score</title>
<polygon fill="yellow" stroke="black" points="666,-7270.17 100,-7270.17 100,-7187.17 666,-7187.17 666,-7270.17"/>
<text text-anchor="middle" x="383" y="-7254.97" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="383" y="-7239.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="383" y="-7224.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="383" y="-7209.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="383" y="-7194.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_split_q&#45;&gt;layer12_attn_score -->
<g id="edge283" class="edge">
<title>layer12_split_q&#45;&gt;layer12_attn_score</title>
<path fill="none" stroke="black" d="M355.11,-7306.02C358.12,-7297.79 361.4,-7288.78 364.64,-7279.94"/>
<polygon fill="black" stroke="black" points="367.96,-7281.04 368.1,-7270.44 361.39,-7278.64 367.96,-7281.04"/>
</g>
<!-- layer12_split_k&#45;&gt;layer12_attn_score -->
<g id="edge284" class="edge">
<title>layer12_split_k&#45;&gt;layer12_attn_score</title>
<path fill="none" stroke="black" d="M791.69,-7306.16C734.4,-7295.44 670.02,-7283.39 609.6,-7272.08"/>
<polygon fill="black" stroke="black" points="610.02,-7268.6 599.54,-7270.2 608.73,-7275.48 610.02,-7268.6"/>
</g>
<!-- layer12_attn_out -->
<g id="node238" class="node">
<title>layer12_attn_out</title>
<polygon fill="yellow" stroke="black" points="1269.5,-7047.17 706.5,-7047.17 706.5,-6964.17 1269.5,-6964.17 1269.5,-7047.17"/>
<text text-anchor="middle" x="988" y="-7031.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="988" y="-7016.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="988" y="-7001.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="988" y="-6986.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="988" y="-6971.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_split_v&#45;&gt;layer12_attn_out -->
<g id="edge287" class="edge">
<title>layer12_split_v&#45;&gt;layer12_attn_out</title>
<path fill="none" stroke="black" d="M988,-7194.58C988,-7158.32 988,-7099.7 988,-7057.57"/>
<polygon fill="black" stroke="black" points="991.5,-7057.51 988,-7047.51 984.5,-7057.51 991.5,-7057.51"/>
</g>
<!-- layer12_attn_weights -->
<g id="node237" class="node">
<title>layer12_attn_weights</title>
<polygon fill="yellow" stroke="black" points="818,-7151.17 252,-7151.17 252,-7083.17 818,-7083.17 818,-7151.17"/>
<text text-anchor="middle" x="535" y="-7135.97" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="535" y="-7120.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="535" y="-7105.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="535" y="-7090.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_attn_score&#45;&gt;layer12_attn_weights -->
<g id="edge285" class="edge">
<title>layer12_attn_score&#45;&gt;layer12_attn_weights</title>
<path fill="none" stroke="black" d="M439.6,-7186.89C453.02,-7177.22 467.31,-7166.93 480.62,-7157.34"/>
<polygon fill="black" stroke="black" points="482.71,-7160.15 488.78,-7151.47 478.62,-7154.47 482.71,-7160.15"/>
</g>
<!-- layer12_attn_weights&#45;&gt;layer12_attn_out -->
<g id="edge286" class="edge">
<title>layer12_attn_weights&#45;&gt;layer12_attn_out</title>
<path fill="none" stroke="black" d="M671.53,-7083.16C715.19,-7072.61 764.17,-7060.77 810.31,-7049.62"/>
<polygon fill="black" stroke="black" points="811.21,-7053 820.11,-7047.25 809.57,-7046.2 811.21,-7053"/>
</g>
<!-- layer12_attn_reshape -->
<g id="node239" class="node">
<title>layer12_attn_reshape</title>
<polygon fill="yellow" stroke="black" points="1277.5,-6928.17 726.5,-6928.17 726.5,-6860.17 1277.5,-6860.17 1277.5,-6928.17"/>
<text text-anchor="middle" x="1002" y="-6912.97" font-family="Times,serif" font-size="14.00">Reshape Attention</text>
<text text-anchor="middle" x="1002" y="-6897.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="1002" y="-6882.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1002" y="-6867.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_attn_out&#45;&gt;layer12_attn_reshape -->
<g id="edge288" class="edge">
<title>layer12_attn_out&#45;&gt;layer12_attn_reshape</title>
<path fill="none" stroke="black" d="M993.21,-6963.89C994.27,-6955.59 995.39,-6946.83 996.47,-6938.45"/>
<polygon fill="black" stroke="black" points="999.95,-6938.83 997.74,-6928.47 993,-6937.94 999.95,-6938.83"/>
</g>
<!-- layer12_attn_proj -->
<g id="node240" class="node">
<title>layer12_attn_proj</title>
<polygon fill="yellow" stroke="black" points="1257,-6824.17 789,-6824.17 789,-6756.17 1257,-6756.17 1257,-6824.17"/>
<text text-anchor="middle" x="1023" y="-6808.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="1023" y="-6793.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1023" y="-6778.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1023" y="-6763.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_attn_reshape&#45;&gt;layer12_attn_proj -->
<g id="edge289" class="edge">
<title>layer12_attn_reshape&#45;&gt;layer12_attn_proj</title>
<path fill="none" stroke="black" d="M1008.82,-6860.05C1010.51,-6851.86 1012.34,-6842.96 1014.11,-6834.36"/>
<polygon fill="black" stroke="black" points="1017.56,-6834.97 1016.14,-6824.47 1010.7,-6833.55 1017.56,-6834.97"/>
</g>
<!-- layer12_attn_proj&#45;&gt;layer12_res1 -->
<g id="edge291" class="edge">
<title>layer12_attn_proj&#45;&gt;layer12_res1</title>
<path fill="none" stroke="black" d="M1026.03,-6756.02C1026.76,-6747.96 1027.57,-6739.17 1028.36,-6730.5"/>
<polygon fill="black" stroke="black" points="1031.85,-6730.72 1029.28,-6720.44 1024.88,-6730.08 1031.85,-6730.72"/>
</g>
<!-- layer12_ln2 -->
<g id="node242" class="node">
<title>layer12_ln2</title>
<polygon fill="yellow" stroke="black" points="1025,-6601.17 557,-6601.17 557,-6533.17 1025,-6533.17 1025,-6601.17"/>
<text text-anchor="middle" x="791" y="-6585.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="791" y="-6570.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="791" y="-6555.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="791" y="-6540.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_res1&#45;&gt;layer12_ln2 -->
<g id="edge292" class="edge">
<title>layer12_res1&#45;&gt;layer12_ln2</title>
<path fill="none" stroke="black" d="M943.23,-6637.05C920.3,-6626.67 895.75,-6615.57 873.22,-6605.37"/>
<polygon fill="black" stroke="black" points="874.58,-6602.14 864.03,-6601.21 871.7,-6608.52 874.58,-6602.14"/>
</g>
<!-- layer12_res2 -->
<g id="node246" class="node">
<title>layer12_res2</title>
<polygon fill="yellow" stroke="black" points="1056,-6185.17 588,-6185.17 588,-6102.17 1056,-6102.17 1056,-6185.17"/>
<text text-anchor="middle" x="822" y="-6169.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="822" y="-6154.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="822" y="-6139.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="822" y="-6124.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="822" y="-6109.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_res1&#45;&gt;layer12_res2 -->
<g id="edge296" class="edge">
<title>layer12_res1&#45;&gt;layer12_res2</title>
<path fill="none" stroke="black" d="M1039.11,-6636.84C1044.99,-6593.95 1053,-6524.48 1053,-6464.17 1053,-6464.17 1053,-6464.17 1053,-6358.17 1053,-6296.96 1076.86,-6269.26 1039,-6221.17 1029.58,-6209.19 1018.14,-6199.09 1005.51,-6190.56"/>
<polygon fill="black" stroke="black" points="1007.36,-6187.59 997.04,-6185.19 1003.6,-6193.5 1007.36,-6187.59"/>
</g>
<!-- layer12_mlp1 -->
<g id="node243" class="node">
<title>layer12_mlp1</title>
<polygon fill="yellow" stroke="black" points="1033.5,-6497.17 530.5,-6497.17 530.5,-6429.17 1033.5,-6429.17 1033.5,-6497.17"/>
<text text-anchor="middle" x="782" y="-6481.97" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="782" y="-6466.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="782" y="-6451.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="782" y="-6436.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_ln2&#45;&gt;layer12_mlp1 -->
<g id="edge293" class="edge">
<title>layer12_ln2&#45;&gt;layer12_mlp1</title>
<path fill="none" stroke="black" d="M788.08,-6533.05C787.36,-6524.94 786.59,-6516.15 785.84,-6507.64"/>
<polygon fill="black" stroke="black" points="789.3,-6507.12 784.94,-6497.47 782.33,-6507.73 789.3,-6507.12"/>
</g>
<!-- layer12_gelu -->
<g id="node244" class="node">
<title>layer12_gelu</title>
<polygon fill="yellow" stroke="black" points="1033.5,-6393.17 530.5,-6393.17 530.5,-6325.17 1033.5,-6325.17 1033.5,-6393.17"/>
<text text-anchor="middle" x="782" y="-6377.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="782" y="-6362.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="782" y="-6347.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="782" y="-6332.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_mlp1&#45;&gt;layer12_gelu -->
<g id="edge294" class="edge">
<title>layer12_mlp1&#45;&gt;layer12_gelu</title>
<path fill="none" stroke="black" d="M782,-6429.05C782,-6420.94 782,-6412.15 782,-6403.64"/>
<polygon fill="black" stroke="black" points="785.5,-6403.47 782,-6393.47 778.5,-6403.47 785.5,-6403.47"/>
</g>
<!-- layer12_mlp2 -->
<g id="node245" class="node">
<title>layer12_mlp2</title>
<polygon fill="yellow" stroke="black" points="1029.5,-6289.17 538.5,-6289.17 538.5,-6221.17 1029.5,-6221.17 1029.5,-6289.17"/>
<text text-anchor="middle" x="784" y="-6273.97" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="784" y="-6258.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="784" y="-6243.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="784" y="-6228.97" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer12_gelu&#45;&gt;layer12_mlp2 -->
<g id="edge295" class="edge">
<title>layer12_gelu&#45;&gt;layer12_mlp2</title>
<path fill="none" stroke="black" d="M782.65,-6325.05C782.81,-6316.94 782.98,-6308.15 783.15,-6299.64"/>
<polygon fill="black" stroke="black" points="786.65,-6299.53 783.35,-6289.47 779.65,-6299.4 786.65,-6299.53"/>
</g>
<!-- layer12_mlp2&#45;&gt;layer12_res2 -->
<g id="edge297" class="edge">
<title>layer12_mlp2&#45;&gt;layer12_res2</title>
<path fill="none" stroke="black" d="M795.5,-6221.02C798.36,-6212.79 801.48,-6203.78 804.55,-6194.94"/>
<polygon fill="black" stroke="black" points="807.88,-6196.04 807.85,-6185.44 801.26,-6193.74 807.88,-6196.04"/>
</g>
<!-- send_to_gpu_13 -->
<g id="node247" class="node">
<title>send_to_gpu_13</title>
<polygon fill="yellow" stroke="black" points="1307.4,-6066.17 535.24,-6066.17 336.6,-5930.17 1108.76,-5930.17 1307.4,-6066.17"/>
<text text-anchor="middle" x="822" y="-6016.97" font-family="Times,serif" font-size="14.00">Send to GPU 13</text>
<text text-anchor="middle" x="822" y="-6001.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="822" y="-5986.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="822" y="-5971.97" font-family="Times,serif" font-size="14.00">GPU: 12 â†’ GPU 13</text>
</g>
<!-- layer12_res2&#45;&gt;send_to_gpu_13 -->
<g id="edge298" class="edge">
<title>layer12_res2&#45;&gt;send_to_gpu_13</title>
<path fill="none" stroke="black" d="M822,-6101.93C822,-6093.95 822,-6085.33 822,-6076.61"/>
<polygon fill="black" stroke="black" points="825.5,-6076.34 822,-6066.34 818.5,-6076.34 825.5,-6076.34"/>
</g>
<!-- comm_layer_13 -->
<g id="node248" class="node">
<title>comm_layer_13</title>
<polygon fill="yellow" stroke="black" points="1307.4,-5868.17 535.24,-5868.17 336.6,-5732.17 1108.76,-5732.17 1307.4,-5868.17"/>
<text text-anchor="middle" x="822" y="-5818.97" font-family="Times,serif" font-size="14.00">Receive from GPU 12</text>
<text text-anchor="middle" x="822" y="-5803.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="822" y="-5788.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="822" y="-5773.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- send_to_gpu_13&#45;&gt;comm_layer_13 -->
<g id="edge299" class="edge">
<title>send_to_gpu_13&#45;&gt;comm_layer_13</title>
<path fill="none" stroke="black" d="M822,-5929.99C822,-5913.47 822,-5895.65 822,-5878.69"/>
<polygon fill="black" stroke="black" points="825.5,-5878.26 822,-5868.26 818.5,-5878.26 825.5,-5878.26"/>
</g>
<!-- layer13_ln1 -->
<g id="node249" class="node">
<title>layer13_ln1</title>
<polygon fill="yellow" stroke="black" points="1074,-5696.17 606,-5696.17 606,-5628.17 1074,-5628.17 1074,-5696.17"/>
<text text-anchor="middle" x="840" y="-5680.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="840" y="-5665.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="840" y="-5650.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="840" y="-5635.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- comm_layer_13&#45;&gt;layer13_ln1 -->
<g id="edge300" class="edge">
<title>comm_layer_13&#45;&gt;layer13_ln1</title>
<path fill="none" stroke="black" d="M830.89,-5731.96C832.05,-5723.21 833.21,-5714.44 834.3,-5706.23"/>
<polygon fill="black" stroke="black" points="837.79,-5706.56 835.63,-5696.18 830.85,-5705.64 837.79,-5706.56"/>
</g>
<!-- layer13_res1 -->
<g id="node260" class="node">
<title>layer13_res1</title>
<polygon fill="yellow" stroke="black" points="1263,-4730.17 795,-4730.17 795,-4647.17 1263,-4647.17 1263,-4730.17"/>
<text text-anchor="middle" x="1029" y="-4714.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1029" y="-4699.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1029" y="-4684.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1029" y="-4669.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1029" y="-4654.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- comm_layer_13&#45;&gt;layer13_res1 -->
<g id="edge313" class="edge">
<title>comm_layer_13&#45;&gt;layer13_res1</title>
<path fill="none" stroke="black" d="M1132.63,-5748.48C1226.89,-5714.05 1306,-5656.24 1306,-5559.17 1306,-5559.17 1306,-5559.17 1306,-4903.17 1306,-4836.51 1293.94,-4811.41 1245,-4766.17 1231.75,-4753.92 1216.42,-4743.61 1200.15,-4734.94"/>
<polygon fill="black" stroke="black" points="1201.53,-4731.71 1191.03,-4730.29 1198.35,-4737.95 1201.53,-4731.71"/>
</g>
<!-- layer13_qkv -->
<g id="node250" class="node">
<title>layer13_qkv</title>
<polygon fill="yellow" stroke="black" points="1219.5,-5592.17 600.5,-5592.17 600.5,-5524.17 1219.5,-5524.17 1219.5,-5592.17"/>
<text text-anchor="middle" x="910" y="-5576.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="910" y="-5561.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="910" y="-5546.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="910" y="-5531.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_ln1&#45;&gt;layer13_qkv -->
<g id="edge301" class="edge">
<title>layer13_ln1&#45;&gt;layer13_qkv</title>
<path fill="none" stroke="black" d="M862.73,-5628.05C868.66,-5619.41 875.12,-5609.99 881.32,-5600.96"/>
<polygon fill="black" stroke="black" points="884.37,-5602.69 887.15,-5592.47 878.6,-5598.73 884.37,-5602.69"/>
</g>
<!-- layer13_reshape_qkv -->
<g id="node251" class="node">
<title>layer13_reshape_qkv</title>
<polygon fill="yellow" stroke="black" points="1254.5,-5488.17 635.5,-5488.17 635.5,-5420.17 1254.5,-5420.17 1254.5,-5488.17"/>
<text text-anchor="middle" x="945" y="-5472.97" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="945" y="-5457.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="945" y="-5442.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="945" y="-5427.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_qkv&#45;&gt;layer13_reshape_qkv -->
<g id="edge302" class="edge">
<title>layer13_qkv&#45;&gt;layer13_reshape_qkv</title>
<path fill="none" stroke="black" d="M921.36,-5524.05C924.21,-5515.77 927.3,-5506.76 930.28,-5498.08"/>
<polygon fill="black" stroke="black" points="933.64,-5499.06 933.57,-5488.47 927.02,-5496.79 933.64,-5499.06"/>
</g>
<!-- layer13_split_q -->
<g id="node252" class="node">
<title>layer13_split_q</title>
<polygon fill="yellow" stroke="black" points="641.5,-5384.17 34.5,-5384.17 34.5,-5316.17 641.5,-5316.17 641.5,-5384.17"/>
<text text-anchor="middle" x="338" y="-5368.97" font-family="Times,serif" font-size="14.00">Split Query</text>
<text text-anchor="middle" x="338" y="-5353.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="338" y="-5338.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="338" y="-5323.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_reshape_qkv&#45;&gt;layer13_split_q -->
<g id="edge303" class="edge">
<title>layer13_reshape_qkv&#45;&gt;layer13_split_q</title>
<path fill="none" stroke="black" d="M748.34,-5420.12C683.21,-5409.18 610.55,-5396.97 544.69,-5385.9"/>
<polygon fill="black" stroke="black" points="545.05,-5382.41 534.6,-5384.2 543.88,-5389.31 545.05,-5382.41"/>
</g>
<!-- layer13_split_k -->
<g id="node253" class="node">
<title>layer13_split_k</title>
<polygon fill="yellow" stroke="black" points="1266.5,-5384.17 659.5,-5384.17 659.5,-5316.17 1266.5,-5316.17 1266.5,-5384.17"/>
<text text-anchor="middle" x="963" y="-5368.97" font-family="Times,serif" font-size="14.00">Split Key</text>
<text text-anchor="middle" x="963" y="-5353.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="963" y="-5338.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="963" y="-5323.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_reshape_qkv&#45;&gt;layer13_split_k -->
<g id="edge304" class="edge">
<title>layer13_reshape_qkv&#45;&gt;layer13_split_k</title>
<path fill="none" stroke="black" d="M950.84,-5420.05C952.29,-5411.86 953.86,-5402.96 955.38,-5394.36"/>
<polygon fill="black" stroke="black" points="958.83,-5394.92 957.12,-5384.47 951.94,-5393.71 958.83,-5394.92"/>
</g>
<!-- layer13_split_v -->
<g id="node254" class="node">
<title>layer13_split_v</title>
<polygon fill="yellow" stroke="black" points="1286.5,-5272.67 679.5,-5272.67 679.5,-5204.67 1286.5,-5204.67 1286.5,-5272.67"/>
<text text-anchor="middle" x="983" y="-5257.47" font-family="Times,serif" font-size="14.00">Split Value</text>
<text text-anchor="middle" x="983" y="-5242.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="983" y="-5227.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="983" y="-5212.47" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_reshape_qkv&#45;&gt;layer13_split_v -->
<g id="edge305" class="edge">
<title>layer13_reshape_qkv&#45;&gt;layer13_split_v</title>
<path fill="none" stroke="black" d="M1202.33,-5420.08C1236.49,-5410.79 1263.92,-5399.03 1276,-5384.17 1295.07,-5360.72 1294.47,-5340.08 1276,-5316.17 1263.37,-5299.82 1230.88,-5286.3 1191.92,-5275.41"/>
<polygon fill="black" stroke="black" points="1192.45,-5271.93 1181.88,-5272.7 1190.62,-5278.68 1192.45,-5271.93"/>
</g>
<!-- layer13_attn_score -->
<g id="node255" class="node">
<title>layer13_attn_score</title>
<polygon fill="yellow" stroke="black" points="661,-5280.17 95,-5280.17 95,-5197.17 661,-5197.17 661,-5280.17"/>
<text text-anchor="middle" x="378" y="-5264.97" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="378" y="-5249.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="378" y="-5234.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="378" y="-5219.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="378" y="-5204.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_split_q&#45;&gt;layer13_attn_score -->
<g id="edge306" class="edge">
<title>layer13_split_q&#45;&gt;layer13_attn_score</title>
<path fill="none" stroke="black" d="M350.11,-5316.02C353.12,-5307.79 356.4,-5298.78 359.64,-5289.94"/>
<polygon fill="black" stroke="black" points="362.96,-5291.04 363.1,-5280.44 356.39,-5288.64 362.96,-5291.04"/>
</g>
<!-- layer13_split_k&#45;&gt;layer13_attn_score -->
<g id="edge307" class="edge">
<title>layer13_split_k&#45;&gt;layer13_attn_score</title>
<path fill="none" stroke="black" d="M786.69,-5316.16C729.4,-5305.44 665.02,-5293.39 604.6,-5282.08"/>
<polygon fill="black" stroke="black" points="605.02,-5278.6 594.54,-5280.2 603.73,-5285.48 605.02,-5278.6"/>
</g>
<!-- layer13_attn_out -->
<g id="node257" class="node">
<title>layer13_attn_out</title>
<polygon fill="yellow" stroke="black" points="1264.5,-5057.17 701.5,-5057.17 701.5,-4974.17 1264.5,-4974.17 1264.5,-5057.17"/>
<text text-anchor="middle" x="983" y="-5041.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="983" y="-5026.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="983" y="-5011.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="983" y="-4996.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="983" y="-4981.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_split_v&#45;&gt;layer13_attn_out -->
<g id="edge310" class="edge">
<title>layer13_split_v&#45;&gt;layer13_attn_out</title>
<path fill="none" stroke="black" d="M983,-5204.58C983,-5168.32 983,-5109.7 983,-5067.57"/>
<polygon fill="black" stroke="black" points="986.5,-5067.51 983,-5057.51 979.5,-5067.51 986.5,-5067.51"/>
</g>
<!-- layer13_attn_weights -->
<g id="node256" class="node">
<title>layer13_attn_weights</title>
<polygon fill="yellow" stroke="black" points="813,-5161.17 247,-5161.17 247,-5093.17 813,-5093.17 813,-5161.17"/>
<text text-anchor="middle" x="530" y="-5145.97" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="530" y="-5130.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="530" y="-5115.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="530" y="-5100.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_attn_score&#45;&gt;layer13_attn_weights -->
<g id="edge308" class="edge">
<title>layer13_attn_score&#45;&gt;layer13_attn_weights</title>
<path fill="none" stroke="black" d="M434.6,-5196.89C448.02,-5187.22 462.31,-5176.93 475.62,-5167.34"/>
<polygon fill="black" stroke="black" points="477.71,-5170.15 483.78,-5161.47 473.62,-5164.47 477.71,-5170.15"/>
</g>
<!-- layer13_attn_weights&#45;&gt;layer13_attn_out -->
<g id="edge309" class="edge">
<title>layer13_attn_weights&#45;&gt;layer13_attn_out</title>
<path fill="none" stroke="black" d="M666.53,-5093.16C710.19,-5082.61 759.17,-5070.77 805.31,-5059.62"/>
<polygon fill="black" stroke="black" points="806.21,-5063 815.11,-5057.25 804.57,-5056.2 806.21,-5063"/>
</g>
<!-- layer13_attn_reshape -->
<g id="node258" class="node">
<title>layer13_attn_reshape</title>
<polygon fill="yellow" stroke="black" points="1272.5,-4938.17 721.5,-4938.17 721.5,-4870.17 1272.5,-4870.17 1272.5,-4938.17"/>
<text text-anchor="middle" x="997" y="-4922.97" font-family="Times,serif" font-size="14.00">Reshape Attention</text>
<text text-anchor="middle" x="997" y="-4907.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="997" y="-4892.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="997" y="-4877.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_attn_out&#45;&gt;layer13_attn_reshape -->
<g id="edge311" class="edge">
<title>layer13_attn_out&#45;&gt;layer13_attn_reshape</title>
<path fill="none" stroke="black" d="M988.21,-4973.89C989.27,-4965.59 990.39,-4956.83 991.47,-4948.45"/>
<polygon fill="black" stroke="black" points="994.95,-4948.83 992.74,-4938.47 988,-4947.94 994.95,-4948.83"/>
</g>
<!-- layer13_attn_proj -->
<g id="node259" class="node">
<title>layer13_attn_proj</title>
<polygon fill="yellow" stroke="black" points="1236,-4834.17 768,-4834.17 768,-4766.17 1236,-4766.17 1236,-4834.17"/>
<text text-anchor="middle" x="1002" y="-4818.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="1002" y="-4803.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1002" y="-4788.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1002" y="-4773.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_attn_reshape&#45;&gt;layer13_attn_proj -->
<g id="edge312" class="edge">
<title>layer13_attn_reshape&#45;&gt;layer13_attn_proj</title>
<path fill="none" stroke="black" d="M998.62,-4870.05C999.02,-4861.94 999.45,-4853.15 999.87,-4844.64"/>
<polygon fill="black" stroke="black" points="1003.37,-4844.63 1000.37,-4834.47 996.38,-4844.28 1003.37,-4844.63"/>
</g>
<!-- layer13_attn_proj&#45;&gt;layer13_res1 -->
<g id="edge314" class="edge">
<title>layer13_attn_proj&#45;&gt;layer13_res1</title>
<path fill="none" stroke="black" d="M1010.17,-4766.02C1012.18,-4757.87 1014.38,-4748.98 1016.53,-4740.22"/>
<polygon fill="black" stroke="black" points="1019.95,-4740.99 1018.95,-4730.44 1013.15,-4739.32 1019.95,-4740.99"/>
</g>
<!-- layer13_ln2 -->
<g id="node261" class="node">
<title>layer13_ln2</title>
<polygon fill="yellow" stroke="black" points="1042,-4611.17 574,-4611.17 574,-4543.17 1042,-4543.17 1042,-4611.17"/>
<text text-anchor="middle" x="808" y="-4595.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="808" y="-4580.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="808" y="-4565.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="808" y="-4550.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_res1&#45;&gt;layer13_ln2 -->
<g id="edge315" class="edge">
<title>layer13_res1&#45;&gt;layer13_ln2</title>
<path fill="none" stroke="black" d="M947.02,-4647.05C926.36,-4636.81 904.26,-4625.86 883.91,-4615.78"/>
<polygon fill="black" stroke="black" points="885.2,-4612.51 874.69,-4611.21 882.1,-4618.79 885.2,-4612.51"/>
</g>
<!-- layer13_res2 -->
<g id="node265" class="node">
<title>layer13_res2</title>
<polygon fill="yellow" stroke="black" points="1042,-4195.17 574,-4195.17 574,-4112.17 1042,-4112.17 1042,-4195.17"/>
<text text-anchor="middle" x="808" y="-4179.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="808" y="-4164.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="808" y="-4149.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="808" y="-4134.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="808" y="-4119.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_res1&#45;&gt;layer13_res2 -->
<g id="edge319" class="edge">
<title>layer13_res1&#45;&gt;layer13_res2</title>
<path fill="none" stroke="black" d="M1041.84,-4647.04C1045.17,-4635.53 1048.51,-4622.93 1051,-4611.17 1063.75,-4551.03 1070,-4535.64 1070,-4474.17 1070,-4474.17 1070,-4474.17 1070,-4368.17 1070,-4307 1095.63,-4278.58 1057,-4231.17 1047.33,-4219.3 1035.87,-4209.24 1023.26,-4200.71"/>
<polygon fill="black" stroke="black" points="1025.13,-4197.74 1014.81,-4195.32 1021.36,-4203.65 1025.13,-4197.74"/>
</g>
<!-- layer13_mlp1 -->
<g id="node262" class="node">
<title>layer13_mlp1</title>
<polygon fill="yellow" stroke="black" points="1050.5,-4507.17 547.5,-4507.17 547.5,-4439.17 1050.5,-4439.17 1050.5,-4507.17"/>
<text text-anchor="middle" x="799" y="-4491.97" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="799" y="-4476.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="799" y="-4461.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="799" y="-4446.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_ln2&#45;&gt;layer13_mlp1 -->
<g id="edge316" class="edge">
<title>layer13_ln2&#45;&gt;layer13_mlp1</title>
<path fill="none" stroke="black" d="M805.08,-4543.05C804.36,-4534.94 803.59,-4526.15 802.84,-4517.64"/>
<polygon fill="black" stroke="black" points="806.3,-4517.12 801.94,-4507.47 799.33,-4517.73 806.3,-4517.12"/>
</g>
<!-- layer13_gelu -->
<g id="node263" class="node">
<title>layer13_gelu</title>
<polygon fill="yellow" stroke="black" points="1050.5,-4403.17 547.5,-4403.17 547.5,-4335.17 1050.5,-4335.17 1050.5,-4403.17"/>
<text text-anchor="middle" x="799" y="-4387.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="799" y="-4372.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="799" y="-4357.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="799" y="-4342.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_mlp1&#45;&gt;layer13_gelu -->
<g id="edge317" class="edge">
<title>layer13_mlp1&#45;&gt;layer13_gelu</title>
<path fill="none" stroke="black" d="M799,-4439.05C799,-4430.94 799,-4422.15 799,-4413.64"/>
<polygon fill="black" stroke="black" points="802.5,-4413.47 799,-4403.47 795.5,-4413.47 802.5,-4413.47"/>
</g>
<!-- layer13_mlp2 -->
<g id="node264" class="node">
<title>layer13_mlp2</title>
<polygon fill="yellow" stroke="black" points="1047.5,-4299.17 556.5,-4299.17 556.5,-4231.17 1047.5,-4231.17 1047.5,-4299.17"/>
<text text-anchor="middle" x="802" y="-4283.97" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="802" y="-4268.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="802" y="-4253.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="802" y="-4238.97" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer13_gelu&#45;&gt;layer13_mlp2 -->
<g id="edge318" class="edge">
<title>layer13_gelu&#45;&gt;layer13_mlp2</title>
<path fill="none" stroke="black" d="M799.97,-4335.05C800.21,-4326.94 800.47,-4318.15 800.72,-4309.64"/>
<polygon fill="black" stroke="black" points="804.23,-4309.56 801.02,-4299.47 797.23,-4309.36 804.23,-4309.56"/>
</g>
<!-- layer13_mlp2&#45;&gt;layer13_res2 -->
<g id="edge320" class="edge">
<title>layer13_mlp2&#45;&gt;layer13_res2</title>
<path fill="none" stroke="black" d="M803.82,-4231.02C804.26,-4222.96 804.74,-4214.17 805.21,-4205.5"/>
<polygon fill="black" stroke="black" points="808.71,-4205.62 805.77,-4195.44 801.72,-4205.24 808.71,-4205.62"/>
</g>
<!-- send_to_gpu_14 -->
<g id="node266" class="node">
<title>send_to_gpu_14</title>
<polygon fill="yellow" stroke="black" points="1293.4,-4076.17 521.24,-4076.17 322.6,-3940.17 1094.76,-3940.17 1293.4,-4076.17"/>
<text text-anchor="middle" x="808" y="-4026.97" font-family="Times,serif" font-size="14.00">Send to GPU 14</text>
<text text-anchor="middle" x="808" y="-4011.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="808" y="-3996.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="808" y="-3981.97" font-family="Times,serif" font-size="14.00">GPU: 13 â†’ GPU 14</text>
</g>
<!-- layer13_res2&#45;&gt;send_to_gpu_14 -->
<g id="edge321" class="edge">
<title>layer13_res2&#45;&gt;send_to_gpu_14</title>
<path fill="none" stroke="black" d="M808,-4111.93C808,-4103.95 808,-4095.33 808,-4086.61"/>
<polygon fill="black" stroke="black" points="811.5,-4086.34 808,-4076.34 804.5,-4086.34 811.5,-4086.34"/>
</g>
<!-- comm_layer_14 -->
<g id="node267" class="node">
<title>comm_layer_14</title>
<polygon fill="yellow" stroke="black" points="1293.4,-3878.17 521.24,-3878.17 322.6,-3742.17 1094.76,-3742.17 1293.4,-3878.17"/>
<text text-anchor="middle" x="808" y="-3828.97" font-family="Times,serif" font-size="14.00">Receive from GPU 13</text>
<text text-anchor="middle" x="808" y="-3813.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="808" y="-3798.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="808" y="-3783.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- send_to_gpu_14&#45;&gt;comm_layer_14 -->
<g id="edge322" class="edge">
<title>send_to_gpu_14&#45;&gt;comm_layer_14</title>
<path fill="none" stroke="black" d="M808,-3939.99C808,-3923.47 808,-3905.65 808,-3888.69"/>
<polygon fill="black" stroke="black" points="811.5,-3888.26 808,-3878.26 804.5,-3888.26 811.5,-3888.26"/>
</g>
<!-- layer14_ln1 -->
<g id="node268" class="node">
<title>layer14_ln1</title>
<polygon fill="yellow" stroke="black" points="1060,-3706.17 592,-3706.17 592,-3638.17 1060,-3638.17 1060,-3706.17"/>
<text text-anchor="middle" x="826" y="-3690.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="826" y="-3675.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="826" y="-3660.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="826" y="-3645.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- comm_layer_14&#45;&gt;layer14_ln1 -->
<g id="edge323" class="edge">
<title>comm_layer_14&#45;&gt;layer14_ln1</title>
<path fill="none" stroke="black" d="M816.89,-3741.96C818.05,-3733.21 819.21,-3724.44 820.3,-3716.23"/>
<polygon fill="black" stroke="black" points="823.79,-3716.56 821.63,-3706.18 816.85,-3715.64 823.79,-3716.56"/>
</g>
<!-- layer14_res1 -->
<g id="node279" class="node">
<title>layer14_res1</title>
<polygon fill="yellow" stroke="black" points="1240,-2740.17 772,-2740.17 772,-2657.17 1240,-2657.17 1240,-2740.17"/>
<text text-anchor="middle" x="1006" y="-2724.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1006" y="-2709.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1006" y="-2694.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1006" y="-2679.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1006" y="-2664.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- comm_layer_14&#45;&gt;layer14_res1 -->
<g id="edge336" class="edge">
<title>comm_layer_14&#45;&gt;layer14_res1</title>
<path fill="none" stroke="black" d="M1118.63,-3758.48C1212.89,-3724.05 1292,-3666.24 1292,-3569.17 1292,-3569.17 1292,-3569.17 1292,-2913.17 1292,-2844.99 1274.18,-2821.2 1223,-2776.17 1208.95,-2763.81 1192.78,-2753.41 1175.74,-2744.67"/>
<polygon fill="black" stroke="black" points="1177.27,-2741.52 1166.75,-2740.25 1174.18,-2747.8 1177.27,-2741.52"/>
</g>
<!-- layer14_qkv -->
<g id="node269" class="node">
<title>layer14_qkv</title>
<polygon fill="yellow" stroke="black" points="1205.5,-3602.17 586.5,-3602.17 586.5,-3534.17 1205.5,-3534.17 1205.5,-3602.17"/>
<text text-anchor="middle" x="896" y="-3586.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="896" y="-3571.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="896" y="-3556.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="896" y="-3541.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_ln1&#45;&gt;layer14_qkv -->
<g id="edge324" class="edge">
<title>layer14_ln1&#45;&gt;layer14_qkv</title>
<path fill="none" stroke="black" d="M848.73,-3638.05C854.66,-3629.41 861.12,-3619.99 867.32,-3610.96"/>
<polygon fill="black" stroke="black" points="870.37,-3612.69 873.15,-3602.47 864.6,-3608.73 870.37,-3612.69"/>
</g>
<!-- layer14_reshape_qkv -->
<g id="node270" class="node">
<title>layer14_reshape_qkv</title>
<polygon fill="yellow" stroke="black" points="1240.5,-3498.17 621.5,-3498.17 621.5,-3430.17 1240.5,-3430.17 1240.5,-3498.17"/>
<text text-anchor="middle" x="931" y="-3482.97" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="931" y="-3467.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="931" y="-3452.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="931" y="-3437.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_qkv&#45;&gt;layer14_reshape_qkv -->
<g id="edge325" class="edge">
<title>layer14_qkv&#45;&gt;layer14_reshape_qkv</title>
<path fill="none" stroke="black" d="M907.36,-3534.05C910.21,-3525.77 913.3,-3516.76 916.28,-3508.08"/>
<polygon fill="black" stroke="black" points="919.64,-3509.06 919.57,-3498.47 913.02,-3506.79 919.64,-3509.06"/>
</g>
<!-- layer14_split_q -->
<g id="node271" class="node">
<title>layer14_split_q</title>
<polygon fill="yellow" stroke="black" points="627.5,-3394.17 20.5,-3394.17 20.5,-3326.17 627.5,-3326.17 627.5,-3394.17"/>
<text text-anchor="middle" x="324" y="-3378.97" font-family="Times,serif" font-size="14.00">Split Query</text>
<text text-anchor="middle" x="324" y="-3363.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="324" y="-3348.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="324" y="-3333.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_reshape_qkv&#45;&gt;layer14_split_q -->
<g id="edge326" class="edge">
<title>layer14_reshape_qkv&#45;&gt;layer14_split_q</title>
<path fill="none" stroke="black" d="M734.34,-3430.12C669.21,-3419.18 596.55,-3406.97 530.69,-3395.9"/>
<polygon fill="black" stroke="black" points="531.05,-3392.41 520.6,-3394.2 529.88,-3399.31 531.05,-3392.41"/>
</g>
<!-- layer14_split_k -->
<g id="node272" class="node">
<title>layer14_split_k</title>
<polygon fill="yellow" stroke="black" points="1252.5,-3394.17 645.5,-3394.17 645.5,-3326.17 1252.5,-3326.17 1252.5,-3394.17"/>
<text text-anchor="middle" x="949" y="-3378.97" font-family="Times,serif" font-size="14.00">Split Key</text>
<text text-anchor="middle" x="949" y="-3363.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="949" y="-3348.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="949" y="-3333.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_reshape_qkv&#45;&gt;layer14_split_k -->
<g id="edge327" class="edge">
<title>layer14_reshape_qkv&#45;&gt;layer14_split_k</title>
<path fill="none" stroke="black" d="M936.84,-3430.05C938.29,-3421.86 939.86,-3412.96 941.38,-3404.36"/>
<polygon fill="black" stroke="black" points="944.83,-3404.92 943.12,-3394.47 937.94,-3403.71 944.83,-3404.92"/>
</g>
<!-- layer14_split_v -->
<g id="node273" class="node">
<title>layer14_split_v</title>
<polygon fill="yellow" stroke="black" points="1272.5,-3282.67 665.5,-3282.67 665.5,-3214.67 1272.5,-3214.67 1272.5,-3282.67"/>
<text text-anchor="middle" x="969" y="-3267.47" font-family="Times,serif" font-size="14.00">Split Value</text>
<text text-anchor="middle" x="969" y="-3252.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="969" y="-3237.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="969" y="-3222.47" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_reshape_qkv&#45;&gt;layer14_split_v -->
<g id="edge328" class="edge">
<title>layer14_reshape_qkv&#45;&gt;layer14_split_v</title>
<path fill="none" stroke="black" d="M1188.33,-3430.08C1222.49,-3420.79 1249.92,-3409.03 1262,-3394.17 1281.07,-3370.72 1280.47,-3350.08 1262,-3326.17 1249.37,-3309.82 1216.88,-3296.3 1177.92,-3285.41"/>
<polygon fill="black" stroke="black" points="1178.45,-3281.93 1167.88,-3282.7 1176.62,-3288.68 1178.45,-3281.93"/>
</g>
<!-- layer14_attn_score -->
<g id="node274" class="node">
<title>layer14_attn_score</title>
<polygon fill="yellow" stroke="black" points="647,-3290.17 81,-3290.17 81,-3207.17 647,-3207.17 647,-3290.17"/>
<text text-anchor="middle" x="364" y="-3274.97" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="364" y="-3259.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="364" y="-3244.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="364" y="-3229.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="364" y="-3214.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_split_q&#45;&gt;layer14_attn_score -->
<g id="edge329" class="edge">
<title>layer14_split_q&#45;&gt;layer14_attn_score</title>
<path fill="none" stroke="black" d="M336.11,-3326.02C339.12,-3317.79 342.4,-3308.78 345.64,-3299.94"/>
<polygon fill="black" stroke="black" points="348.96,-3301.04 349.1,-3290.44 342.39,-3298.64 348.96,-3301.04"/>
</g>
<!-- layer14_split_k&#45;&gt;layer14_attn_score -->
<g id="edge330" class="edge">
<title>layer14_split_k&#45;&gt;layer14_attn_score</title>
<path fill="none" stroke="black" d="M772.69,-3326.16C715.4,-3315.44 651.02,-3303.39 590.6,-3292.08"/>
<polygon fill="black" stroke="black" points="591.02,-3288.6 580.54,-3290.2 589.73,-3295.48 591.02,-3288.6"/>
</g>
<!-- layer14_attn_out -->
<g id="node276" class="node">
<title>layer14_attn_out</title>
<polygon fill="yellow" stroke="black" points="1250.5,-3067.17 687.5,-3067.17 687.5,-2984.17 1250.5,-2984.17 1250.5,-3067.17"/>
<text text-anchor="middle" x="969" y="-3051.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="969" y="-3036.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="969" y="-3021.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="969" y="-3006.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="969" y="-2991.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_split_v&#45;&gt;layer14_attn_out -->
<g id="edge333" class="edge">
<title>layer14_split_v&#45;&gt;layer14_attn_out</title>
<path fill="none" stroke="black" d="M969,-3214.58C969,-3178.32 969,-3119.7 969,-3077.57"/>
<polygon fill="black" stroke="black" points="972.5,-3077.51 969,-3067.51 965.5,-3077.51 972.5,-3077.51"/>
</g>
<!-- layer14_attn_weights -->
<g id="node275" class="node">
<title>layer14_attn_weights</title>
<polygon fill="yellow" stroke="black" points="799,-3171.17 233,-3171.17 233,-3103.17 799,-3103.17 799,-3171.17"/>
<text text-anchor="middle" x="516" y="-3155.97" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="516" y="-3140.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="516" y="-3125.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="516" y="-3110.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_attn_score&#45;&gt;layer14_attn_weights -->
<g id="edge331" class="edge">
<title>layer14_attn_score&#45;&gt;layer14_attn_weights</title>
<path fill="none" stroke="black" d="M420.6,-3206.89C434.02,-3197.22 448.31,-3186.93 461.62,-3177.34"/>
<polygon fill="black" stroke="black" points="463.71,-3180.15 469.78,-3171.47 459.62,-3174.47 463.71,-3180.15"/>
</g>
<!-- layer14_attn_weights&#45;&gt;layer14_attn_out -->
<g id="edge332" class="edge">
<title>layer14_attn_weights&#45;&gt;layer14_attn_out</title>
<path fill="none" stroke="black" d="M652.53,-3103.16C696.19,-3092.61 745.17,-3080.77 791.31,-3069.62"/>
<polygon fill="black" stroke="black" points="792.21,-3073 801.11,-3067.25 790.57,-3066.2 792.21,-3073"/>
</g>
<!-- layer14_attn_reshape -->
<g id="node277" class="node">
<title>layer14_attn_reshape</title>
<polygon fill="yellow" stroke="black" points="1248.5,-2948.17 697.5,-2948.17 697.5,-2880.17 1248.5,-2880.17 1248.5,-2948.17"/>
<text text-anchor="middle" x="973" y="-2932.97" font-family="Times,serif" font-size="14.00">Reshape Attention</text>
<text text-anchor="middle" x="973" y="-2917.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="973" y="-2902.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="973" y="-2887.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_attn_out&#45;&gt;layer14_attn_reshape -->
<g id="edge334" class="edge">
<title>layer14_attn_out&#45;&gt;layer14_attn_reshape</title>
<path fill="none" stroke="black" d="M970.49,-2983.89C970.79,-2975.68 971.11,-2967.03 971.41,-2958.73"/>
<polygon fill="black" stroke="black" points="974.92,-2958.59 971.78,-2948.47 967.92,-2958.33 974.92,-2958.59"/>
</g>
<!-- layer14_attn_proj -->
<g id="node278" class="node">
<title>layer14_attn_proj</title>
<polygon fill="yellow" stroke="black" points="1214,-2844.17 746,-2844.17 746,-2776.17 1214,-2776.17 1214,-2844.17"/>
<text text-anchor="middle" x="980" y="-2828.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="980" y="-2813.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="980" y="-2798.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="980" y="-2783.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_attn_reshape&#45;&gt;layer14_attn_proj -->
<g id="edge335" class="edge">
<title>layer14_attn_reshape&#45;&gt;layer14_attn_proj</title>
<path fill="none" stroke="black" d="M975.27,-2880.05C975.83,-2871.94 976.43,-2863.15 977.02,-2854.64"/>
<polygon fill="black" stroke="black" points="980.52,-2854.68 977.71,-2844.47 973.54,-2854.2 980.52,-2854.68"/>
</g>
<!-- layer14_attn_proj&#45;&gt;layer14_res1 -->
<g id="edge337" class="edge">
<title>layer14_attn_proj&#45;&gt;layer14_res1</title>
<path fill="none" stroke="black" d="M987.87,-2776.02C989.8,-2767.87 991.92,-2758.98 994,-2750.22"/>
<polygon fill="black" stroke="black" points="997.41,-2750.98 996.32,-2740.44 990.6,-2749.36 997.41,-2750.98"/>
</g>
<!-- layer14_ln2 -->
<g id="node280" class="node">
<title>layer14_ln2</title>
<polygon fill="yellow" stroke="black" points="1030,-2621.17 562,-2621.17 562,-2553.17 1030,-2553.17 1030,-2621.17"/>
<text text-anchor="middle" x="796" y="-2605.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="796" y="-2590.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="796" y="-2575.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="796" y="-2560.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_res1&#45;&gt;layer14_ln2 -->
<g id="edge338" class="edge">
<title>layer14_res1&#45;&gt;layer14_ln2</title>
<path fill="none" stroke="black" d="M928.1,-2657.05C908.55,-2646.86 887.66,-2635.96 868.39,-2625.91"/>
<polygon fill="black" stroke="black" points="869.86,-2622.73 859.37,-2621.21 866.62,-2628.94 869.86,-2622.73"/>
</g>
<!-- layer14_res2 -->
<g id="node284" class="node">
<title>layer14_res2</title>
<polygon fill="yellow" stroke="black" points="1038,-2205.17 570,-2205.17 570,-2122.17 1038,-2122.17 1038,-2205.17"/>
<text text-anchor="middle" x="804" y="-2189.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="804" y="-2174.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="804" y="-2159.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="804" y="-2144.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="804" y="-2129.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_res1&#45;&gt;layer14_res2 -->
<g id="edge342" class="edge">
<title>layer14_res1&#45;&gt;layer14_res2</title>
<path fill="none" stroke="black" d="M1025.9,-2657.12C1030.83,-2645.71 1035.65,-2633.15 1039,-2621.17 1055.55,-2561.96 1058,-2545.64 1058,-2484.17 1058,-2484.17 1058,-2484.17 1058,-2378.17 1058,-2317 1083.41,-2288.76 1045,-2241.17 1035.39,-2229.26 1023.93,-2219.17 1011.29,-2210.64"/>
<polygon fill="black" stroke="black" points="1013.15,-2207.67 1002.83,-2205.25 1009.39,-2213.57 1013.15,-2207.67"/>
</g>
<!-- layer14_mlp1 -->
<g id="node281" class="node">
<title>layer14_mlp1</title>
<polygon fill="yellow" stroke="black" points="1038.5,-2517.17 535.5,-2517.17 535.5,-2449.17 1038.5,-2449.17 1038.5,-2517.17"/>
<text text-anchor="middle" x="787" y="-2501.97" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="787" y="-2486.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="787" y="-2471.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="787" y="-2456.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_ln2&#45;&gt;layer14_mlp1 -->
<g id="edge339" class="edge">
<title>layer14_ln2&#45;&gt;layer14_mlp1</title>
<path fill="none" stroke="black" d="M793.08,-2553.05C792.36,-2544.94 791.59,-2536.15 790.84,-2527.64"/>
<polygon fill="black" stroke="black" points="794.3,-2527.12 789.94,-2517.47 787.33,-2527.73 794.3,-2527.12"/>
</g>
<!-- layer14_gelu -->
<g id="node282" class="node">
<title>layer14_gelu</title>
<polygon fill="yellow" stroke="black" points="1038.5,-2413.17 535.5,-2413.17 535.5,-2345.17 1038.5,-2345.17 1038.5,-2413.17"/>
<text text-anchor="middle" x="787" y="-2397.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="787" y="-2382.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="787" y="-2367.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="787" y="-2352.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_mlp1&#45;&gt;layer14_gelu -->
<g id="edge340" class="edge">
<title>layer14_mlp1&#45;&gt;layer14_gelu</title>
<path fill="none" stroke="black" d="M787,-2449.05C787,-2440.94 787,-2432.15 787,-2423.64"/>
<polygon fill="black" stroke="black" points="790.5,-2423.47 787,-2413.47 783.5,-2423.47 790.5,-2423.47"/>
</g>
<!-- layer14_mlp2 -->
<g id="node283" class="node">
<title>layer14_mlp2</title>
<polygon fill="yellow" stroke="black" points="1035.5,-2309.17 544.5,-2309.17 544.5,-2241.17 1035.5,-2241.17 1035.5,-2309.17"/>
<text text-anchor="middle" x="790" y="-2293.97" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="790" y="-2278.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="790" y="-2263.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="790" y="-2248.97" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer14_gelu&#45;&gt;layer14_mlp2 -->
<g id="edge341" class="edge">
<title>layer14_gelu&#45;&gt;layer14_mlp2</title>
<path fill="none" stroke="black" d="M787.97,-2345.05C788.21,-2336.94 788.47,-2328.15 788.72,-2319.64"/>
<polygon fill="black" stroke="black" points="792.23,-2319.56 789.02,-2309.47 785.23,-2319.36 792.23,-2319.56"/>
</g>
<!-- layer14_mlp2&#45;&gt;layer14_res2 -->
<g id="edge343" class="edge">
<title>layer14_mlp2&#45;&gt;layer14_res2</title>
<path fill="none" stroke="black" d="M794.24,-2241.02C795.27,-2232.96 796.39,-2224.17 797.5,-2215.5"/>
<polygon fill="black" stroke="black" points="800.99,-2215.81 798.79,-2205.44 794.05,-2214.92 800.99,-2215.81"/>
</g>
<!-- send_to_gpu_15 -->
<g id="node285" class="node">
<title>send_to_gpu_15</title>
<polygon fill="yellow" stroke="black" points="1289.4,-2086.17 517.24,-2086.17 318.6,-1950.17 1090.76,-1950.17 1289.4,-2086.17"/>
<text text-anchor="middle" x="804" y="-2036.97" font-family="Times,serif" font-size="14.00">Send to GPU 15</text>
<text text-anchor="middle" x="804" y="-2021.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="804" y="-2006.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="804" y="-1991.97" font-family="Times,serif" font-size="14.00">GPU: 14 â†’ GPU 15</text>
</g>
<!-- layer14_res2&#45;&gt;send_to_gpu_15 -->
<g id="edge344" class="edge">
<title>layer14_res2&#45;&gt;send_to_gpu_15</title>
<path fill="none" stroke="black" d="M804,-2121.93C804,-2113.95 804,-2105.33 804,-2096.61"/>
<polygon fill="black" stroke="black" points="807.5,-2096.34 804,-2086.34 800.5,-2096.34 807.5,-2096.34"/>
</g>
<!-- comm_layer_15 -->
<g id="node286" class="node">
<title>comm_layer_15</title>
<polygon fill="yellow" stroke="black" points="1289.4,-1888.17 517.24,-1888.17 318.6,-1752.17 1090.76,-1752.17 1289.4,-1888.17"/>
<text text-anchor="middle" x="804" y="-1838.97" font-family="Times,serif" font-size="14.00">Receive from GPU 14</text>
<text text-anchor="middle" x="804" y="-1823.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="804" y="-1808.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="804" y="-1793.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- send_to_gpu_15&#45;&gt;comm_layer_15 -->
<g id="edge345" class="edge">
<title>send_to_gpu_15&#45;&gt;comm_layer_15</title>
<path fill="none" stroke="black" d="M804,-1949.99C804,-1933.47 804,-1915.65 804,-1898.69"/>
<polygon fill="black" stroke="black" points="807.5,-1898.26 804,-1888.26 800.5,-1898.26 807.5,-1898.26"/>
</g>
<!-- layer15_ln1 -->
<g id="node287" class="node">
<title>layer15_ln1</title>
<polygon fill="yellow" stroke="black" points="1056,-1716.17 588,-1716.17 588,-1648.17 1056,-1648.17 1056,-1716.17"/>
<text text-anchor="middle" x="822" y="-1700.97" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="822" y="-1685.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="822" y="-1670.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="822" y="-1655.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- comm_layer_15&#45;&gt;layer15_ln1 -->
<g id="edge346" class="edge">
<title>comm_layer_15&#45;&gt;layer15_ln1</title>
<path fill="none" stroke="black" d="M812.89,-1751.96C814.05,-1743.21 815.21,-1734.44 816.3,-1726.23"/>
<polygon fill="black" stroke="black" points="819.79,-1726.56 817.63,-1716.18 812.85,-1725.64 819.79,-1726.56"/>
</g>
<!-- layer15_res1 -->
<g id="node298" class="node">
<title>layer15_res1</title>
<polygon fill="yellow" stroke="black" points="1277,-750.17 809,-750.17 809,-667.17 1277,-667.17 1277,-750.17"/>
<text text-anchor="middle" x="1043" y="-734.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1043" y="-719.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1043" y="-704.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1043" y="-689.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="1043" y="-674.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- comm_layer_15&#45;&gt;layer15_res1 -->
<g id="edge359" class="edge">
<title>comm_layer_15&#45;&gt;layer15_res1</title>
<path fill="none" stroke="black" d="M1114.63,-1768.48C1208.89,-1734.05 1288,-1676.24 1288,-1579.17 1288,-1579.17 1288,-1579.17 1288,-923.17 1288,-858.79 1285.64,-832.55 1241,-786.17 1229.36,-774.07 1215.59,-763.86 1200.82,-755.24"/>
<polygon fill="black" stroke="black" points="1202.45,-752.14 1192.01,-750.35 1199.05,-758.26 1202.45,-752.14"/>
</g>
<!-- layer15_qkv -->
<g id="node288" class="node">
<title>layer15_qkv</title>
<polygon fill="yellow" stroke="black" points="1201.5,-1612.17 582.5,-1612.17 582.5,-1544.17 1201.5,-1544.17 1201.5,-1612.17"/>
<text text-anchor="middle" x="892" y="-1596.97" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="892" y="-1581.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="892" y="-1566.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="892" y="-1551.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_ln1&#45;&gt;layer15_qkv -->
<g id="edge347" class="edge">
<title>layer15_ln1&#45;&gt;layer15_qkv</title>
<path fill="none" stroke="black" d="M844.73,-1648.05C850.66,-1639.41 857.12,-1629.99 863.32,-1620.96"/>
<polygon fill="black" stroke="black" points="866.37,-1622.69 869.15,-1612.47 860.6,-1618.73 866.37,-1622.69"/>
</g>
<!-- layer15_reshape_qkv -->
<g id="node289" class="node">
<title>layer15_reshape_qkv</title>
<polygon fill="yellow" stroke="black" points="1236.5,-1508.17 617.5,-1508.17 617.5,-1440.17 1236.5,-1440.17 1236.5,-1508.17"/>
<text text-anchor="middle" x="927" y="-1492.97" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="927" y="-1477.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="927" y="-1462.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="927" y="-1447.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_qkv&#45;&gt;layer15_reshape_qkv -->
<g id="edge348" class="edge">
<title>layer15_qkv&#45;&gt;layer15_reshape_qkv</title>
<path fill="none" stroke="black" d="M903.36,-1544.05C906.21,-1535.77 909.3,-1526.76 912.28,-1518.08"/>
<polygon fill="black" stroke="black" points="915.64,-1519.06 915.57,-1508.47 909.02,-1516.79 915.64,-1519.06"/>
</g>
<!-- layer15_split_q -->
<g id="node290" class="node">
<title>layer15_split_q</title>
<polygon fill="yellow" stroke="black" points="623.5,-1404.17 16.5,-1404.17 16.5,-1336.17 623.5,-1336.17 623.5,-1404.17"/>
<text text-anchor="middle" x="320" y="-1388.97" font-family="Times,serif" font-size="14.00">Split Query</text>
<text text-anchor="middle" x="320" y="-1373.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="320" y="-1358.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="320" y="-1343.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_reshape_qkv&#45;&gt;layer15_split_q -->
<g id="edge349" class="edge">
<title>layer15_reshape_qkv&#45;&gt;layer15_split_q</title>
<path fill="none" stroke="black" d="M730.34,-1440.12C665.21,-1429.18 592.55,-1416.97 526.69,-1405.9"/>
<polygon fill="black" stroke="black" points="527.05,-1402.41 516.6,-1404.2 525.88,-1409.31 527.05,-1402.41"/>
</g>
<!-- layer15_split_k -->
<g id="node291" class="node">
<title>layer15_split_k</title>
<polygon fill="yellow" stroke="black" points="1248.5,-1404.17 641.5,-1404.17 641.5,-1336.17 1248.5,-1336.17 1248.5,-1404.17"/>
<text text-anchor="middle" x="945" y="-1388.97" font-family="Times,serif" font-size="14.00">Split Key</text>
<text text-anchor="middle" x="945" y="-1373.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="945" y="-1358.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="945" y="-1343.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_reshape_qkv&#45;&gt;layer15_split_k -->
<g id="edge350" class="edge">
<title>layer15_reshape_qkv&#45;&gt;layer15_split_k</title>
<path fill="none" stroke="black" d="M932.84,-1440.05C934.29,-1431.86 935.86,-1422.96 937.38,-1414.36"/>
<polygon fill="black" stroke="black" points="940.83,-1414.92 939.12,-1404.47 933.94,-1413.71 940.83,-1414.92"/>
</g>
<!-- layer15_split_v -->
<g id="node292" class="node">
<title>layer15_split_v</title>
<polygon fill="yellow" stroke="black" points="1268.5,-1292.67 661.5,-1292.67 661.5,-1224.67 1268.5,-1224.67 1268.5,-1292.67"/>
<text text-anchor="middle" x="965" y="-1277.47" font-family="Times,serif" font-size="14.00">Split Value</text>
<text text-anchor="middle" x="965" y="-1262.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512, qkv=3]</text>
<text text-anchor="middle" x="965" y="-1247.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="965" y="-1232.47" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_reshape_qkv&#45;&gt;layer15_split_v -->
<g id="edge351" class="edge">
<title>layer15_reshape_qkv&#45;&gt;layer15_split_v</title>
<path fill="none" stroke="black" d="M1184.33,-1440.08C1218.49,-1430.79 1245.92,-1419.03 1258,-1404.17 1277.07,-1380.72 1276.47,-1360.08 1258,-1336.17 1245.37,-1319.82 1212.88,-1306.3 1173.92,-1295.41"/>
<polygon fill="black" stroke="black" points="1174.45,-1291.93 1163.88,-1292.7 1172.62,-1298.68 1174.45,-1291.93"/>
</g>
<!-- layer15_attn_score -->
<g id="node293" class="node">
<title>layer15_attn_score</title>
<polygon fill="yellow" stroke="black" points="643,-1300.17 77,-1300.17 77,-1217.17 643,-1217.17 643,-1300.17"/>
<text text-anchor="middle" x="360" y="-1284.97" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="360" y="-1269.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="360" y="-1254.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="360" y="-1239.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="360" y="-1224.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_split_q&#45;&gt;layer15_attn_score -->
<g id="edge352" class="edge">
<title>layer15_split_q&#45;&gt;layer15_attn_score</title>
<path fill="none" stroke="black" d="M332.11,-1336.02C335.12,-1327.79 338.4,-1318.78 341.64,-1309.94"/>
<polygon fill="black" stroke="black" points="344.96,-1311.04 345.1,-1300.44 338.39,-1308.64 344.96,-1311.04"/>
</g>
<!-- layer15_split_k&#45;&gt;layer15_attn_score -->
<g id="edge353" class="edge">
<title>layer15_split_k&#45;&gt;layer15_attn_score</title>
<path fill="none" stroke="black" d="M768.69,-1336.16C711.4,-1325.44 647.02,-1313.39 586.6,-1302.08"/>
<polygon fill="black" stroke="black" points="587.02,-1298.6 576.54,-1300.2 585.73,-1305.48 587.02,-1298.6"/>
</g>
<!-- layer15_attn_out -->
<g id="node295" class="node">
<title>layer15_attn_out</title>
<polygon fill="yellow" stroke="black" points="1246.5,-1077.17 683.5,-1077.17 683.5,-994.17 1246.5,-994.17 1246.5,-1077.17"/>
<text text-anchor="middle" x="965" y="-1061.97" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="965" y="-1046.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="965" y="-1031.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="965" y="-1016.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="965" y="-1001.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_split_v&#45;&gt;layer15_attn_out -->
<g id="edge356" class="edge">
<title>layer15_split_v&#45;&gt;layer15_attn_out</title>
<path fill="none" stroke="black" d="M965,-1224.58C965,-1188.32 965,-1129.7 965,-1087.57"/>
<polygon fill="black" stroke="black" points="968.5,-1087.51 965,-1077.51 961.5,-1087.51 968.5,-1087.51"/>
</g>
<!-- layer15_attn_weights -->
<g id="node294" class="node">
<title>layer15_attn_weights</title>
<polygon fill="yellow" stroke="black" points="795,-1181.17 229,-1181.17 229,-1113.17 795,-1113.17 795,-1181.17"/>
<text text-anchor="middle" x="512" y="-1165.97" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="512" y="-1150.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="512" y="-1135.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, num_heads=16, seq_len=10000, seq_len=10000]</text>
<text text-anchor="middle" x="512" y="-1120.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_attn_score&#45;&gt;layer15_attn_weights -->
<g id="edge354" class="edge">
<title>layer15_attn_score&#45;&gt;layer15_attn_weights</title>
<path fill="none" stroke="black" d="M416.6,-1216.89C430.02,-1207.22 444.31,-1196.93 457.62,-1187.34"/>
<polygon fill="black" stroke="black" points="459.71,-1190.15 465.78,-1181.47 455.62,-1184.47 459.71,-1190.15"/>
</g>
<!-- layer15_attn_weights&#45;&gt;layer15_attn_out -->
<g id="edge355" class="edge">
<title>layer15_attn_weights&#45;&gt;layer15_attn_out</title>
<path fill="none" stroke="black" d="M648.53,-1113.16C692.19,-1102.61 741.17,-1090.77 787.31,-1079.62"/>
<polygon fill="black" stroke="black" points="788.21,-1083 797.11,-1077.25 786.57,-1076.2 788.21,-1083"/>
</g>
<!-- layer15_attn_reshape -->
<g id="node296" class="node">
<title>layer15_attn_reshape</title>
<polygon fill="yellow" stroke="black" points="1251.5,-958.17 700.5,-958.17 700.5,-890.17 1251.5,-890.17 1251.5,-958.17"/>
<text text-anchor="middle" x="976" y="-942.97" font-family="Times,serif" font-size="14.00">Reshape Attention</text>
<text text-anchor="middle" x="976" y="-927.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, num_heads=16, head_dim=512]</text>
<text text-anchor="middle" x="976" y="-912.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="976" y="-897.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_attn_out&#45;&gt;layer15_attn_reshape -->
<g id="edge357" class="edge">
<title>layer15_attn_out&#45;&gt;layer15_attn_reshape</title>
<path fill="none" stroke="black" d="M969.1,-993.89C969.93,-985.59 970.81,-976.83 971.65,-968.45"/>
<polygon fill="black" stroke="black" points="975.14,-968.77 972.65,-958.47 968.17,-968.07 975.14,-968.77"/>
</g>
<!-- layer15_attn_proj -->
<g id="node297" class="node">
<title>layer15_attn_proj</title>
<polygon fill="yellow" stroke="black" points="1232,-854.17 764,-854.17 764,-786.17 1232,-786.17 1232,-854.17"/>
<text text-anchor="middle" x="998" y="-838.97" font-family="Times,serif" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="998" y="-823.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="998" y="-808.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="998" y="-793.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_attn_reshape&#45;&gt;layer15_attn_proj -->
<g id="edge358" class="edge">
<title>layer15_attn_reshape&#45;&gt;layer15_attn_proj</title>
<path fill="none" stroke="black" d="M983.14,-890.05C984.91,-881.86 986.83,-872.96 988.68,-864.36"/>
<polygon fill="black" stroke="black" points="992.13,-864.98 990.82,-854.47 985.29,-863.5 992.13,-864.98"/>
</g>
<!-- layer15_attn_proj&#45;&gt;layer15_res1 -->
<g id="edge360" class="edge">
<title>layer15_attn_proj&#45;&gt;layer15_res1</title>
<path fill="none" stroke="black" d="M1011.62,-786.02C1015.01,-777.79 1018.71,-768.78 1022.34,-759.94"/>
<polygon fill="black" stroke="black" points="1025.68,-761.02 1026.24,-750.44 1019.2,-758.36 1025.68,-761.02"/>
</g>
<!-- layer15_ln2 -->
<g id="node299" class="node">
<title>layer15_ln2</title>
<polygon fill="yellow" stroke="black" points="1141,-631.17 673,-631.17 673,-563.17 1141,-563.17 1141,-631.17"/>
<text text-anchor="middle" x="907" y="-615.97" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="907" y="-600.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="907" y="-585.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="907" y="-570.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_res1&#45;&gt;layer15_ln2 -->
<g id="edge361" class="edge">
<title>layer15_res1&#45;&gt;layer15_ln2</title>
<path fill="none" stroke="black" d="M992.36,-666.89C980.58,-657.41 968.05,-647.32 956.33,-637.88"/>
<polygon fill="black" stroke="black" points="958.34,-635.01 948.36,-631.47 953.95,-640.46 958.34,-635.01"/>
</g>
<!-- layer15_res2 -->
<g id="node303" class="node">
<title>layer15_res2</title>
<polygon fill="yellow" stroke="black" points="1230,-215.17 762,-215.17 762,-132.17 1230,-132.17 1230,-215.17"/>
<text text-anchor="middle" x="996" y="-199.97" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="996" y="-184.97" font-family="Times,serif" font-size="14.00">Input1: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="996" y="-169.97" font-family="Times,serif" font-size="14.00">Input2: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="996" y="-154.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="996" y="-139.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_res1&#45;&gt;layer15_res2 -->
<g id="edge365" class="edge">
<title>layer15_res1&#45;&gt;layer15_res2</title>
<path fill="none" stroke="black" d="M1117,-667.08C1129.81,-656.93 1141.67,-644.94 1150,-631.17 1181.81,-578.57 1169,-555.64 1169,-494.17 1169,-494.17 1169,-494.17 1169,-388.17 1169,-327 1191.02,-301.31 1156,-251.17 1147.91,-239.59 1137.59,-229.7 1126.09,-221.28"/>
<polygon fill="black" stroke="black" points="1127.74,-218.17 1117.52,-215.4 1123.78,-223.94 1127.74,-218.17"/>
</g>
<!-- layer15_mlp1 -->
<g id="node300" class="node">
<title>layer15_mlp1</title>
<polygon fill="yellow" stroke="black" points="1149.5,-527.17 646.5,-527.17 646.5,-459.17 1149.5,-459.17 1149.5,-527.17"/>
<text text-anchor="middle" x="898" y="-511.97" font-family="Times,serif" font-size="14.00">MLP Linear1</text>
<text text-anchor="middle" x="898" y="-496.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="898" y="-481.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="898" y="-466.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_ln2&#45;&gt;layer15_mlp1 -->
<g id="edge362" class="edge">
<title>layer15_ln2&#45;&gt;layer15_mlp1</title>
<path fill="none" stroke="black" d="M904.08,-563.05C903.36,-554.94 902.59,-546.15 901.84,-537.64"/>
<polygon fill="black" stroke="black" points="905.3,-537.12 900.94,-527.47 898.33,-537.73 905.3,-537.12"/>
</g>
<!-- layer15_gelu -->
<g id="node301" class="node">
<title>layer15_gelu</title>
<polygon fill="yellow" stroke="black" points="1149.5,-423.17 646.5,-423.17 646.5,-355.17 1149.5,-355.17 1149.5,-423.17"/>
<text text-anchor="middle" x="898" y="-407.97" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="898" y="-392.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="898" y="-377.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="898" y="-362.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_mlp1&#45;&gt;layer15_gelu -->
<g id="edge363" class="edge">
<title>layer15_mlp1&#45;&gt;layer15_gelu</title>
<path fill="none" stroke="black" d="M898,-459.05C898,-450.94 898,-442.15 898,-433.64"/>
<polygon fill="black" stroke="black" points="901.5,-433.47 898,-423.47 894.5,-433.47 901.5,-433.47"/>
</g>
<!-- layer15_mlp2 -->
<g id="node302" class="node">
<title>layer15_mlp2</title>
<polygon fill="yellow" stroke="black" points="1146.5,-319.17 655.5,-319.17 655.5,-251.17 1146.5,-251.17 1146.5,-319.17"/>
<text text-anchor="middle" x="901" y="-303.97" font-family="Times,serif" font-size="14.00">MLP Linear2</text>
<text text-anchor="middle" x="901" y="-288.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, ffn_hidden_size=32768]</text>
<text text-anchor="middle" x="901" y="-273.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="901" y="-258.97" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_gelu&#45;&gt;layer15_mlp2 -->
<g id="edge364" class="edge">
<title>layer15_gelu&#45;&gt;layer15_mlp2</title>
<path fill="none" stroke="black" d="M898.97,-355.05C899.21,-346.94 899.47,-338.15 899.72,-329.64"/>
<polygon fill="black" stroke="black" points="903.23,-329.56 900.02,-319.47 896.23,-329.36 903.23,-329.56"/>
</g>
<!-- layer15_mlp2&#45;&gt;layer15_res2 -->
<g id="edge366" class="edge">
<title>layer15_mlp2&#45;&gt;layer15_res2</title>
<path fill="none" stroke="black" d="M929.76,-251.02C937.36,-242.26 945.71,-232.63 953.85,-223.25"/>
<polygon fill="black" stroke="black" points="956.71,-225.29 960.62,-215.44 951.43,-220.7 956.71,-225.29"/>
</g>
<!-- output -->
<g id="node304" class="node">
<title>output</title>
<ellipse fill="yellow" stroke="black" cx="996" cy="-48.08" rx="330.85" ry="48.17"/>
<text text-anchor="middle" x="996" y="-66.88" font-family="Times,serif" font-size="14.00">Model Output</text>
<text text-anchor="middle" x="996" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="996" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="996" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer15_res2&#45;&gt;output -->
<g id="edge367" class="edge">
<title>layer15_res2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M996,-131.86C996,-123.67 996,-114.93 996,-106.3"/>
<polygon fill="black" stroke="black" points="999.5,-106.27 996,-96.27 992.5,-106.27 999.5,-106.27"/>
</g>
</g>
</svg>
