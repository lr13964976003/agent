<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Pipeline_Parallel_DAG Pages: 1 -->
<svg width="18141pt" height="10282pt"
 viewBox="0.00 0.00 18140.53 10282.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 10278.5)">
<title>Pipeline_Parallel_DAG</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-10278.5 18136.53,-10278.5 18136.53,4 -4,4"/>
<!-- pp_input -->
<g id="node1" class="node">
<title>pp_input</title>
<ellipse fill="lightblue" stroke="black" cx="3765.27" cy="-10226.41" rx="252.37" ry="48.17"/>
<text text-anchor="middle" x="3765.27" y="-10245.21" font-family="Times,serif" font-size="14.00">Model Input</text>
<text text-anchor="middle" x="3765.27" y="-10230.21" font-family="Times,serif" font-size="14.00">Input: Raw tokens</text>
<text text-anchor="middle" x="3765.27" y="-10215.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048]</text>
<text text-anchor="middle" x="3765.27" y="-10200.21" font-family="Times,serif" font-size="14.00">GPU: CPU</text>
</g>
<!-- pp_embed -->
<g id="node2" class="node">
<title>pp_embed</title>
<polygon fill="lightyellow" stroke="black" points="4013.77,-10092.33 3516.77,-10092.33 3516.77,-10024.33 4013.77,-10024.33 4013.77,-10092.33"/>
<text text-anchor="middle" x="3765.27" y="-10077.13" font-family="Times,serif" font-size="14.00">Token + Position Embedding</text>
<text text-anchor="middle" x="3765.27" y="-10062.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048]</text>
<text text-anchor="middle" x="3765.27" y="-10047.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3765.27" y="-10032.13" font-family="Times,serif" font-size="14.00">GPU: GPU 0</text>
</g>
<!-- pp_input&#45;&gt;pp_embed -->
<g id="edge1" class="edge">
<title>pp_input&#45;&gt;pp_embed</title>
<path fill="none" stroke="black" d="M3765.27,-10178.25C3765.27,-10178.25 3765.27,-10102.36 3765.27,-10102.36"/>
<polygon fill="black" stroke="black" points="3768.77,-10102.36 3765.27,-10092.36 3761.77,-10102.36 3768.77,-10102.36"/>
</g>
<!-- pp_stage0_layer0_norm -->
<g id="node3" class="node">
<title>pp_stage0_layer0_norm</title>
<polygon fill="lightyellow" stroke="black" points="4244.77,-9938.33 3747.77,-9938.33 3747.77,-9870.33 4244.77,-9870.33 4244.77,-9938.33"/>
<text text-anchor="middle" x="3996.27" y="-9923.13" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="3996.27" y="-9908.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3996.27" y="-9893.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3996.27" y="-9878.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_embed&#45;&gt;pp_stage0_layer0_norm -->
<g id="edge2" class="edge">
<title>pp_embed&#45;&gt;pp_stage0_layer0_norm</title>
<path fill="none" stroke="black" d="M3880.77,-10024.15C3880.77,-10024.15 3880.77,-9948.41 3880.77,-9948.41"/>
<polygon fill="black" stroke="black" points="3884.27,-9948.41 3880.77,-9938.41 3877.27,-9948.41 3884.27,-9948.41"/>
</g>
<!-- pp_stage0_layer0_attn_residual -->
<g id="node11" class="node">
<title>pp_stage0_layer0_attn_residual</title>
<ellipse fill="lightblue" stroke="black" cx="3765.27" cy="-8966.25" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="3765.27" y="-8985.05" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3765.27" y="-8970.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096], [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3765.27" y="-8955.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3765.27" y="-8940.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_embed&#45;&gt;pp_stage0_layer0_attn_residual -->
<g id="edge12" class="edge">
<title>pp_embed&#45;&gt;pp_stage0_layer0_attn_residual</title>
<path fill="none" stroke="black" d="M3601.02,-10024.15C3601.02,-10024.15 3601.02,-9022.76 3601.02,-9022.76"/>
<polygon fill="black" stroke="black" points="3604.52,-9022.76 3601.02,-9012.76 3597.52,-9022.76 3604.52,-9022.76"/>
</g>
<!-- pp_stage0_layer0_q_proj -->
<g id="node4" class="node">
<title>pp_stage0_layer0_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="4425.27,-9784.33 3915.27,-9784.33 3915.27,-9716.33 4425.27,-9716.33 4425.27,-9784.33"/>
<text text-anchor="middle" x="4170.27" y="-9769.13" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4170.27" y="-9754.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4170.27" y="-9739.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4170.27" y="-9724.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_norm&#45;&gt;pp_stage0_layer0_q_proj -->
<g id="edge3" class="edge">
<title>pp_stage0_layer0_norm&#45;&gt;pp_stage0_layer0_q_proj</title>
<path fill="none" stroke="black" d="M4080.02,-9870.15C4080.02,-9870.15 4080.02,-9794.41 4080.02,-9794.41"/>
<polygon fill="black" stroke="black" points="4083.52,-9794.41 4080.02,-9784.41 4076.52,-9794.41 4083.52,-9794.41"/>
</g>
<!-- pp_stage0_layer0_k_proj -->
<g id="node5" class="node">
<title>pp_stage0_layer0_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="4993.27,-9784.33 4483.27,-9784.33 4483.27,-9716.33 4993.27,-9716.33 4993.27,-9784.33"/>
<text text-anchor="middle" x="4738.27" y="-9769.13" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4738.27" y="-9754.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4738.27" y="-9739.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4738.27" y="-9724.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_norm&#45;&gt;pp_stage0_layer0_k_proj -->
<g id="edge4" class="edge">
<title>pp_stage0_layer0_norm&#45;&gt;pp_stage0_layer0_k_proj</title>
<path fill="none" stroke="black" d="M4244.89,-9904C4460.52,-9904 4738.27,-9904 4738.27,-9904 4738.27,-9904 4738.27,-9794.44 4738.27,-9794.44"/>
<polygon fill="black" stroke="black" points="4741.77,-9794.44 4738.27,-9784.44 4734.77,-9794.44 4741.77,-9794.44"/>
</g>
<!-- pp_stage0_layer0_v_proj -->
<g id="node6" class="node">
<title>pp_stage0_layer0_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="4195.27,-9630.33 3685.27,-9630.33 3685.27,-9562.33 4195.27,-9562.33 4195.27,-9630.33"/>
<text text-anchor="middle" x="3940.27" y="-9615.13" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="3940.27" y="-9600.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3940.27" y="-9585.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3940.27" y="-9570.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_norm&#45;&gt;pp_stage0_layer0_v_proj -->
<g id="edge5" class="edge">
<title>pp_stage0_layer0_norm&#45;&gt;pp_stage0_layer0_v_proj</title>
<path fill="none" stroke="black" d="M3831.52,-9870.19C3831.52,-9870.19 3831.52,-9640.62 3831.52,-9640.62"/>
<polygon fill="black" stroke="black" points="3835.02,-9640.62 3831.52,-9630.62 3828.02,-9640.62 3835.02,-9640.62"/>
</g>
<!-- pp_stage0_layer0_attn_scores -->
<g id="node7" class="node">
<title>pp_stage0_layer0_attn_scores</title>
<polygon fill="lightyellow" stroke="black" points="4801.27,-9630.33 4253.27,-9630.33 4253.27,-9562.33 4801.27,-9562.33 4801.27,-9630.33"/>
<text text-anchor="middle" x="4527.27" y="-9615.13" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="4527.27" y="-9600.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4527.27" y="-9585.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=32, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="4527.27" y="-9570.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_q_proj&#45;&gt;pp_stage0_layer0_attn_scores -->
<g id="edge6" class="edge">
<title>pp_stage0_layer0_q_proj&#45;&gt;pp_stage0_layer0_attn_scores</title>
<path fill="none" stroke="black" d="M4339.27,-9716.15C4339.27,-9716.15 4339.27,-9640.41 4339.27,-9640.41"/>
<polygon fill="black" stroke="black" points="4342.77,-9640.41 4339.27,-9630.41 4335.77,-9640.41 4342.77,-9640.41"/>
</g>
<!-- pp_stage0_layer0_k_proj&#45;&gt;pp_stage0_layer0_attn_scores -->
<g id="edge7" class="edge">
<title>pp_stage0_layer0_k_proj&#45;&gt;pp_stage0_layer0_attn_scores</title>
<path fill="none" stroke="black" d="M4642.27,-9716.15C4642.27,-9716.15 4642.27,-9640.41 4642.27,-9640.41"/>
<polygon fill="black" stroke="black" points="4645.77,-9640.41 4642.27,-9630.41 4638.77,-9640.41 4645.77,-9640.41"/>
</g>
<!-- pp_stage0_layer0_attn_out -->
<g id="node9" class="node">
<title>pp_stage0_layer0_attn_out</title>
<polygon fill="lightyellow" stroke="black" points="4221.27,-9322.33 3685.27,-9322.33 3685.27,-9254.33 4221.27,-9254.33 4221.27,-9322.33"/>
<text text-anchor="middle" x="3953.27" y="-9307.13" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="3953.27" y="-9292.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=32, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="3953.27" y="-9277.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3953.27" y="-9262.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_v_proj&#45;&gt;pp_stage0_layer0_attn_out -->
<g id="edge10" class="edge">
<title>pp_stage0_layer0_v_proj&#45;&gt;pp_stage0_layer0_attn_out</title>
<path fill="none" stroke="black" d="M3915.77,-9562.19C3915.77,-9562.19 3915.77,-9332.62 3915.77,-9332.62"/>
<polygon fill="black" stroke="black" points="3919.27,-9332.62 3915.77,-9322.62 3912.27,-9332.62 3919.27,-9332.62"/>
</g>
<!-- pp_stage0_layer0_softmax -->
<g id="node8" class="node">
<title>pp_stage0_layer0_softmax</title>
<polygon fill="lightyellow" stroke="black" points="4694.27,-9476.33 4146.27,-9476.33 4146.27,-9408.33 4694.27,-9408.33 4694.27,-9476.33"/>
<text text-anchor="middle" x="4420.27" y="-9461.13" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="4420.27" y="-9446.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=32, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="4420.27" y="-9431.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=32, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="4420.27" y="-9416.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_attn_scores&#45;&gt;pp_stage0_layer0_softmax -->
<g id="edge8" class="edge">
<title>pp_stage0_layer0_attn_scores&#45;&gt;pp_stage0_layer0_softmax</title>
<path fill="none" stroke="black" d="M4473.77,-9562.15C4473.77,-9562.15 4473.77,-9486.41 4473.77,-9486.41"/>
<polygon fill="black" stroke="black" points="4477.27,-9486.41 4473.77,-9476.41 4470.27,-9486.41 4477.27,-9486.41"/>
</g>
<!-- pp_stage0_layer0_softmax&#45;&gt;pp_stage0_layer0_attn_out -->
<g id="edge9" class="edge">
<title>pp_stage0_layer0_softmax&#45;&gt;pp_stage0_layer0_attn_out</title>
<path fill="none" stroke="black" d="M4183.77,-9408.15C4183.77,-9408.15 4183.77,-9332.41 4183.77,-9332.41"/>
<polygon fill="black" stroke="black" points="4187.27,-9332.41 4183.77,-9322.41 4180.27,-9332.41 4187.27,-9332.41"/>
</g>
<!-- pp_stage0_layer0_out_proj -->
<g id="node10" class="node">
<title>pp_stage0_layer0_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="4192.27,-9168.33 3694.27,-9168.33 3694.27,-9100.33 4192.27,-9100.33 4192.27,-9168.33"/>
<text text-anchor="middle" x="3943.27" y="-9153.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3943.27" y="-9138.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3943.27" y="-9123.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3943.27" y="-9108.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_attn_out&#45;&gt;pp_stage0_layer0_out_proj -->
<g id="edge11" class="edge">
<title>pp_stage0_layer0_attn_out&#45;&gt;pp_stage0_layer0_out_proj</title>
<path fill="none" stroke="black" d="M3943.27,-9254.15C3943.27,-9254.15 3943.27,-9178.41 3943.27,-9178.41"/>
<polygon fill="black" stroke="black" points="3946.77,-9178.41 3943.27,-9168.41 3939.77,-9178.41 3946.77,-9178.41"/>
</g>
<!-- pp_stage0_layer0_out_proj&#45;&gt;pp_stage0_layer0_attn_residual -->
<g id="edge13" class="edge">
<title>pp_stage0_layer0_out_proj&#45;&gt;pp_stage0_layer0_attn_residual</title>
<path fill="none" stroke="black" d="M3943.27,-9100.32C3943.27,-9100.32 3943.27,-9022.63 3943.27,-9022.63"/>
<polygon fill="black" stroke="black" points="3946.77,-9022.63 3943.27,-9012.63 3939.77,-9022.63 3946.77,-9022.63"/>
</g>
<!-- pp_stage0_layer0_moe_norm -->
<g id="node12" class="node">
<title>pp_stage0_layer0_moe_norm</title>
<polygon fill="lightyellow" stroke="black" points="8408.77,-8832.16 7911.77,-8832.16 7911.77,-8764.16 8408.77,-8764.16 8408.77,-8832.16"/>
<text text-anchor="middle" x="8160.27" y="-8816.96" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="8160.27" y="-8801.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8160.27" y="-8786.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8160.27" y="-8771.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_attn_residual&#45;&gt;pp_stage0_layer0_moe_norm -->
<g id="edge14" class="edge">
<title>pp_stage0_layer0_attn_residual&#45;&gt;pp_stage0_layer0_moe_norm</title>
<path fill="none" stroke="black" d="M4380.41,-8951.29C4380.41,-8914.77 4380.41,-8824 4380.41,-8824 4380.41,-8824 7901.53,-8824 7901.53,-8824"/>
<polygon fill="black" stroke="black" points="7901.53,-8827.5 7911.53,-8824 7901.53,-8820.5 7901.53,-8827.5"/>
</g>
<!-- pp_stage0_layer0_final_residual -->
<g id="node79" class="node">
<title>pp_stage0_layer0_final_residual</title>
<ellipse fill="lightblue" stroke="black" cx="4025.27" cy="-7695.92" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="4025.27" y="-7714.72" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="4025.27" y="-7699.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096], [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4025.27" y="-7684.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4025.27" y="-7669.72" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_attn_residual&#45;&gt;pp_stage0_layer0_final_residual -->
<g id="edge112" class="edge">
<title>pp_stage0_layer0_attn_residual&#45;&gt;pp_stage0_layer0_final_residual</title>
<path fill="none" stroke="black" d="M3354.77,-8929.05C3354.77,-8829.93 3354.77,-8567 3354.77,-8567 3354.77,-8567 3237.88,-8567 3237.88,-8567 3237.88,-8567 3237.88,-7695 3237.88,-7695 3237.88,-7695 3368.65,-7695 3368.65,-7695"/>
<polygon fill="black" stroke="black" points="3368.65,-7698.5 3378.65,-7695 3368.65,-7691.5 3368.65,-7698.5"/>
</g>
<!-- pp_stage0_layer0_gate -->
<g id="node13" class="node">
<title>pp_stage0_layer0_gate</title>
<polygon fill="lightpink" stroke="black" points="8920.92,-8370.16 8121.31,-8370.16 7915.62,-8234.16 8715.22,-8234.16 8920.92,-8370.16"/>
<text text-anchor="middle" x="8418.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="8418.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8418.27" y="-8290.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="8418.27" y="-8275.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_gate -->
<g id="edge15" class="edge">
<title>pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_gate</title>
<path fill="none" stroke="black" d="M8279.1,-8764.07C8279.1,-8764.07 8279.1,-8380.36 8279.1,-8380.36"/>
<polygon fill="black" stroke="black" points="8282.6,-8380.36 8279.1,-8370.36 8275.6,-8380.36 8282.6,-8380.36"/>
</g>
<!-- pp_stage0_layer0_expert0_up -->
<g id="node14" class="node">
<title>pp_stage0_layer0_expert0_up</title>
<polygon fill="lightcoral" stroke="black" points="10865.27,-8678.16 10359.27,-8678.16 10359.27,-8610.16 10865.27,-8610.16 10865.27,-8678.16"/>
<text text-anchor="middle" x="10612.27" y="-8662.96" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="10612.27" y="-8647.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10612.27" y="-8632.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10612.27" y="-8617.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert0_up -->
<g id="edge16" class="edge">
<title>pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert0_up</title>
<path fill="none" stroke="black" d="M8408.87,-8789C9032.24,-8789 10612.27,-8789 10612.27,-8789 10612.27,-8789 10612.27,-8688.49 10612.27,-8688.49"/>
<polygon fill="black" stroke="black" points="10615.77,-8688.49 10612.27,-8678.49 10608.77,-8688.49 10615.77,-8688.49"/>
</g>
<!-- pp_stage0_layer0_expert1_up -->
<g id="node18" class="node">
<title>pp_stage0_layer0_expert1_up</title>
<polygon fill="lightcoral" stroke="black" points="11436.27,-8678.16 10930.27,-8678.16 10930.27,-8610.16 11436.27,-8610.16 11436.27,-8678.16"/>
<text text-anchor="middle" x="11183.27" y="-8662.96" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="11183.27" y="-8647.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11183.27" y="-8632.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11183.27" y="-8617.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert1_up -->
<g id="edge21" class="edge">
<title>pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert1_up</title>
<path fill="none" stroke="black" d="M8408.94,-8798C9132.06,-8798 11183.27,-8798 11183.27,-8798 11183.27,-8798 11183.27,-8688.31 11183.27,-8688.31"/>
<polygon fill="black" stroke="black" points="11186.77,-8688.31 11183.27,-8678.31 11179.77,-8688.31 11186.77,-8688.31"/>
</g>
<!-- pp_stage0_layer0_expert2_up -->
<g id="node22" class="node">
<title>pp_stage0_layer0_expert2_up</title>
<polygon fill="lightcoral" stroke="black" points="12004.27,-8678.16 11498.27,-8678.16 11498.27,-8610.16 12004.27,-8610.16 12004.27,-8678.16"/>
<text text-anchor="middle" x="11751.27" y="-8662.96" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="11751.27" y="-8647.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11751.27" y="-8632.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11751.27" y="-8617.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert2_up -->
<g id="edge26" class="edge">
<title>pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert2_up</title>
<path fill="none" stroke="black" d="M8408.86,-8806C9222.08,-8806 11751.27,-8806 11751.27,-8806 11751.27,-8806 11751.27,-8688.49 11751.27,-8688.49"/>
<polygon fill="black" stroke="black" points="11754.77,-8688.49 11751.27,-8678.49 11747.77,-8688.49 11754.77,-8688.49"/>
</g>
<!-- pp_stage0_layer0_expert3_up -->
<g id="node26" class="node">
<title>pp_stage0_layer0_expert3_up</title>
<polygon fill="lightcoral" stroke="black" points="12570.27,-8678.16 12064.27,-8678.16 12064.27,-8610.16 12570.27,-8610.16 12570.27,-8678.16"/>
<text text-anchor="middle" x="12317.27" y="-8662.96" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="12317.27" y="-8647.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12317.27" y="-8632.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12317.27" y="-8617.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert3_up -->
<g id="edge31" class="edge">
<title>pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert3_up</title>
<path fill="none" stroke="black" d="M8409.01,-8815C9305.37,-8815 12317.27,-8815 12317.27,-8815 12317.27,-8815 12317.27,-8688.33 12317.27,-8688.33"/>
<polygon fill="black" stroke="black" points="12320.77,-8688.33 12317.27,-8678.33 12313.77,-8688.33 12320.77,-8688.33"/>
</g>
<!-- pp_stage0_layer0_expert4_up -->
<g id="node30" class="node">
<title>pp_stage0_layer0_expert4_up</title>
<polygon fill="lightcoral" stroke="black" points="13135.27,-8678.16 12629.27,-8678.16 12629.27,-8610.16 13135.27,-8610.16 13135.27,-8678.16"/>
<text text-anchor="middle" x="12882.27" y="-8662.96" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="12882.27" y="-8647.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12882.27" y="-8632.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12882.27" y="-8617.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert4_up -->
<g id="edge36" class="edge">
<title>pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert4_up</title>
<path fill="none" stroke="black" d="M8409.15,-8823C9383.05,-8823 12882.27,-8823 12882.27,-8823 12882.27,-8823 12882.27,-8688.22 12882.27,-8688.22"/>
<polygon fill="black" stroke="black" points="12885.77,-8688.22 12882.27,-8678.22 12878.77,-8688.22 12885.77,-8688.22"/>
</g>
<!-- pp_stage0_layer0_expert5_up -->
<g id="node34" class="node">
<title>pp_stage0_layer0_expert5_up</title>
<polygon fill="lightcoral" stroke="black" points="1598.27,-8678.16 1092.27,-8678.16 1092.27,-8610.16 1598.27,-8610.16 1598.27,-8678.16"/>
<text text-anchor="middle" x="1345.27" y="-8662.96" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="1345.27" y="-8647.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1345.27" y="-8632.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="1345.27" y="-8617.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert5_up -->
<g id="edge41" class="edge">
<title>pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert5_up</title>
<path fill="none" stroke="black" d="M7911.67,-8817C6686.01,-8817 1345.27,-8817 1345.27,-8817 1345.27,-8817 1345.27,-8688.31 1345.27,-8688.31"/>
<polygon fill="black" stroke="black" points="1348.77,-8688.31 1345.27,-8678.31 1341.77,-8688.31 1348.77,-8688.31"/>
</g>
<!-- pp_stage0_layer0_expert6_up -->
<g id="node38" class="node">
<title>pp_stage0_layer0_expert6_up</title>
<polygon fill="lightcoral" stroke="black" points="3269.27,-8678.16 2763.27,-8678.16 2763.27,-8610.16 3269.27,-8610.16 3269.27,-8678.16"/>
<text text-anchor="middle" x="3016.27" y="-8662.96" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="3016.27" y="-8647.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3016.27" y="-8632.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="3016.27" y="-8617.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert6_up -->
<g id="edge46" class="edge">
<title>pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert6_up</title>
<path fill="none" stroke="black" d="M7911.44,-8809C6905.64,-8809 3194.12,-8809 3194.12,-8809 3194.12,-8809 3194.12,-8688.32 3194.12,-8688.32"/>
<polygon fill="black" stroke="black" points="3197.62,-8688.32 3194.12,-8678.32 3190.62,-8688.32 3197.62,-8688.32"/>
</g>
<!-- pp_stage0_layer0_expert7_up -->
<g id="node42" class="node">
<title>pp_stage0_layer0_expert7_up</title>
<polygon fill="lightcoral" stroke="black" points="4349.27,-8678.16 3843.27,-8678.16 3843.27,-8610.16 4349.27,-8610.16 4349.27,-8678.16"/>
<text text-anchor="middle" x="4096.27" y="-8662.96" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="4096.27" y="-8647.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4096.27" y="-8632.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="4096.27" y="-8617.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert7_up -->
<g id="edge51" class="edge">
<title>pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert7_up</title>
<path fill="none" stroke="black" d="M7911.4,-8801C7028.12,-8801 4096.27,-8801 4096.27,-8801 4096.27,-8801 4096.27,-8688.2 4096.27,-8688.2"/>
<polygon fill="black" stroke="black" points="4099.77,-8688.2 4096.27,-8678.2 4092.77,-8688.2 4099.77,-8688.2"/>
</g>
<!-- pp_stage0_layer0_expert8_up -->
<g id="node46" class="node">
<title>pp_stage0_layer0_expert8_up</title>
<polygon fill="lightcoral" stroke="black" points="5134.27,-8678.16 4628.27,-8678.16 4628.27,-8610.16 5134.27,-8610.16 5134.27,-8678.16"/>
<text text-anchor="middle" x="4881.27" y="-8662.96" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="4881.27" y="-8647.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4881.27" y="-8632.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="4881.27" y="-8617.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert8_up -->
<g id="edge56" class="edge">
<title>pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert8_up</title>
<path fill="none" stroke="black" d="M7911.45,-8794C7176.06,-8794 5063.77,-8794 5063.77,-8794 5063.77,-8794 5063.77,-8688.54 5063.77,-8688.54"/>
<polygon fill="black" stroke="black" points="5067.27,-8688.54 5063.77,-8678.54 5060.27,-8688.54 5067.27,-8688.54"/>
</g>
<!-- pp_stage0_layer0_expert9_up -->
<g id="node50" class="node">
<title>pp_stage0_layer0_expert9_up</title>
<polygon fill="lightcoral" stroke="black" points="5772.27,-8678.16 5266.27,-8678.16 5266.27,-8610.16 5772.27,-8610.16 5772.27,-8678.16"/>
<text text-anchor="middle" x="5519.27" y="-8662.96" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="5519.27" y="-8647.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5519.27" y="-8632.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="5519.27" y="-8617.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert9_up -->
<g id="edge61" class="edge">
<title>pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert9_up</title>
<path fill="none" stroke="black" d="M7911.51,-8786C7253.84,-8786 5519.27,-8786 5519.27,-8786 5519.27,-8786 5519.27,-8688.5 5519.27,-8688.5"/>
<polygon fill="black" stroke="black" points="5522.77,-8688.5 5519.27,-8678.5 5515.77,-8688.5 5522.77,-8688.5"/>
</g>
<!-- pp_stage0_layer0_expert10_up -->
<g id="node54" class="node">
<title>pp_stage0_layer0_expert10_up</title>
<polygon fill="lightcoral" stroke="black" points="6592.27,-8678.16 6086.27,-8678.16 6086.27,-8610.16 6592.27,-8610.16 6592.27,-8678.16"/>
<text text-anchor="middle" x="6339.27" y="-8662.96" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="6339.27" y="-8647.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6339.27" y="-8632.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="6339.27" y="-8617.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert10_up -->
<g id="edge66" class="edge">
<title>pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert10_up</title>
<path fill="none" stroke="black" d="M7911.36,-8779C7412.84,-8779 6339.27,-8779 6339.27,-8779 6339.27,-8779 6339.27,-8688.19 6339.27,-8688.19"/>
<polygon fill="black" stroke="black" points="6342.77,-8688.19 6339.27,-8678.19 6335.77,-8688.19 6342.77,-8688.19"/>
</g>
<!-- pp_stage0_layer0_expert11_up -->
<g id="node58" class="node">
<title>pp_stage0_layer0_expert11_up</title>
<polygon fill="lightcoral" stroke="black" points="7592.27,-8678.16 7086.27,-8678.16 7086.27,-8610.16 7592.27,-8610.16 7592.27,-8678.16"/>
<text text-anchor="middle" x="7339.27" y="-8662.96" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="7339.27" y="-8647.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7339.27" y="-8632.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7339.27" y="-8617.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert11_up -->
<g id="edge71" class="edge">
<title>pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert11_up</title>
<path fill="none" stroke="black" d="M7911.71,-8771C7670.07,-8771 7339.27,-8771 7339.27,-8771 7339.27,-8771 7339.27,-8688.49 7339.27,-8688.49"/>
<polygon fill="black" stroke="black" points="7342.77,-8688.49 7339.27,-8678.49 7335.77,-8688.49 7342.77,-8688.49"/>
</g>
<!-- pp_stage0_layer0_expert12_up -->
<g id="node62" class="node">
<title>pp_stage0_layer0_expert12_up</title>
<polygon fill="lightcoral" stroke="black" points="8214.27,-8678.16 7708.27,-8678.16 7708.27,-8610.16 8214.27,-8610.16 8214.27,-8678.16"/>
<text text-anchor="middle" x="7961.27" y="-8662.96" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="7961.27" y="-8647.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7961.27" y="-8632.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7961.27" y="-8617.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert12_up -->
<g id="edge76" class="edge">
<title>pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert12_up</title>
<path fill="none" stroke="black" d="M8063.02,-8763.99C8063.02,-8763.99 8063.02,-8688.25 8063.02,-8688.25"/>
<polygon fill="black" stroke="black" points="8066.52,-8688.25 8063.02,-8678.25 8059.52,-8688.25 8066.52,-8688.25"/>
</g>
<!-- pp_stage0_layer0_expert13_up -->
<g id="node66" class="node">
<title>pp_stage0_layer0_expert13_up</title>
<polygon fill="lightcoral" stroke="black" points="9071.27,-8678.16 8565.27,-8678.16 8565.27,-8610.16 9071.27,-8610.16 9071.27,-8678.16"/>
<text text-anchor="middle" x="8818.27" y="-8662.96" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="8818.27" y="-8647.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8818.27" y="-8632.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="8818.27" y="-8617.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert13_up -->
<g id="edge81" class="edge">
<title>pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert13_up</title>
<path fill="none" stroke="black" d="M8343.93,-8763.95C8343.93,-8718.53 8343.93,-8644 8343.93,-8644 8343.93,-8644 8555.13,-8644 8555.13,-8644"/>
<polygon fill="black" stroke="black" points="8555.13,-8647.5 8565.13,-8644 8555.13,-8640.5 8555.13,-8647.5"/>
</g>
<!-- pp_stage0_layer0_expert14_up -->
<g id="node70" class="node">
<title>pp_stage0_layer0_expert14_up</title>
<polygon fill="lightcoral" stroke="black" points="9693.27,-8678.16 9187.27,-8678.16 9187.27,-8610.16 9693.27,-8610.16 9693.27,-8678.16"/>
<text text-anchor="middle" x="9440.27" y="-8662.96" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="9440.27" y="-8647.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9440.27" y="-8632.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9440.27" y="-8617.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert14_up -->
<g id="edge86" class="edge">
<title>pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert14_up</title>
<path fill="none" stroke="black" d="M8408.96,-8772C8781.26,-8772 9440.27,-8772 9440.27,-8772 9440.27,-8772 9440.27,-8688.42 9440.27,-8688.42"/>
<polygon fill="black" stroke="black" points="9443.77,-8688.42 9440.27,-8678.42 9436.77,-8688.42 9443.77,-8688.42"/>
</g>
<!-- pp_stage0_layer0_expert15_up -->
<g id="node74" class="node">
<title>pp_stage0_layer0_expert15_up</title>
<polygon fill="lightcoral" stroke="black" points="10286.27,-8678.16 9780.27,-8678.16 9780.27,-8610.16 10286.27,-8610.16 10286.27,-8678.16"/>
<text text-anchor="middle" x="10033.27" y="-8662.96" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="10033.27" y="-8647.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10033.27" y="-8632.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10033.27" y="-8617.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert15_up -->
<g id="edge91" class="edge">
<title>pp_stage0_layer0_moe_norm&#45;&gt;pp_stage0_layer0_expert15_up</title>
<path fill="none" stroke="black" d="M8408.99,-8781C8918.48,-8781 10033.27,-8781 10033.27,-8781 10033.27,-8781 10033.27,-8688.34 10033.27,-8688.34"/>
<polygon fill="black" stroke="black" points="10036.77,-8688.34 10033.27,-8678.34 10029.77,-8688.34 10036.77,-8688.34"/>
</g>
<!-- pp_stage0_layer0_route_back_expert0 -->
<g id="node17" class="node">
<title>pp_stage0_layer0_route_back_expert0</title>
<polygon fill="lightpink" stroke="black" points="13009.3,-8148.16 12190,-8148.16 11979.23,-8012.16 12798.54,-8012.16 13009.3,-8148.16"/>
<text text-anchor="middle" x="12494.27" y="-8098.96" font-family="Times,serif" font-size="14.00">Route Back Expert 0</text>
<text text-anchor="middle" x="12494.27" y="-8083.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12494.27" y="-8068.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12494.27" y="-8053.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert0 -->
<g id="edge20" class="edge">
<title>pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8731.84,-8245C9618.12,-8245 12077.59,-8245 12077.59,-8245 12077.59,-8245 12077.59,-8090.28 12077.59,-8090.28"/>
<polygon fill="black" stroke="black" points="12081.09,-8090.28 12077.59,-8080.28 12074.09,-8090.28 12081.09,-8090.28"/>
</g>
<!-- pp_stage0_layer0_route_back_expert1 -->
<g id="node21" class="node">
<title>pp_stage0_layer0_route_back_expert1</title>
<polygon fill="lightpink" stroke="black" points="14098.3,-8148.16 13279,-8148.16 13068.23,-8012.16 13887.54,-8012.16 14098.3,-8148.16"/>
<text text-anchor="middle" x="13583.27" y="-8098.96" font-family="Times,serif" font-size="14.00">Route Back Expert 1</text>
<text text-anchor="middle" x="13583.27" y="-8083.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13583.27" y="-8068.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13583.27" y="-8053.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert1 -->
<g id="edge25" class="edge">
<title>pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8737.84,-8249C9801.54,-8249 13155.59,-8249 13155.59,-8249 13155.59,-8249 13155.59,-8090.29 13155.59,-8090.29"/>
<polygon fill="black" stroke="black" points="13159.09,-8090.29 13155.59,-8080.29 13152.09,-8090.29 13159.09,-8090.29"/>
</g>
<!-- pp_stage0_layer0_route_back_expert2 -->
<g id="node25" class="node">
<title>pp_stage0_layer0_route_back_expert2</title>
<polygon fill="lightpink" stroke="black" points="15187.3,-8148.16 14368,-8148.16 14157.23,-8012.16 14976.54,-8012.16 15187.3,-8148.16"/>
<text text-anchor="middle" x="14672.27" y="-8098.96" font-family="Times,serif" font-size="14.00">Route Back Expert 2</text>
<text text-anchor="middle" x="14672.27" y="-8083.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14672.27" y="-8068.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14672.27" y="-8053.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert2 -->
<g id="edge30" class="edge">
<title>pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8743.94,-8253C9970.09,-8253 14238.92,-8253 14238.92,-8253 14238.92,-8253 14238.92,-8090.29 14238.92,-8090.29"/>
<polygon fill="black" stroke="black" points="14242.42,-8090.29 14238.92,-8080.29 14235.42,-8090.29 14242.42,-8090.29"/>
</g>
<!-- pp_stage0_layer0_route_back_expert3 -->
<g id="node29" class="node">
<title>pp_stage0_layer0_route_back_expert3</title>
<polygon fill="lightpink" stroke="black" points="16276.3,-8148.16 15457,-8148.16 15246.23,-8012.16 16065.54,-8012.16 16276.3,-8148.16"/>
<text text-anchor="middle" x="15761.27" y="-8098.96" font-family="Times,serif" font-size="14.00">Route Back Expert 3</text>
<text text-anchor="middle" x="15761.27" y="-8083.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15761.27" y="-8068.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15761.27" y="-8053.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert3 -->
<g id="edge35" class="edge">
<title>pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8748.5,-8256C10123.79,-8256 15325.26,-8256 15325.26,-8256 15325.26,-8256 15325.26,-8090.29 15325.26,-8090.29"/>
<polygon fill="black" stroke="black" points="15328.76,-8090.29 15325.26,-8080.29 15321.76,-8090.29 15328.76,-8090.29"/>
</g>
<!-- pp_stage0_layer0_route_back_expert4 -->
<g id="node33" class="node">
<title>pp_stage0_layer0_route_back_expert4</title>
<polygon fill="lightpink" stroke="black" points="17365.3,-8148.16 16546,-8148.16 16335.23,-8012.16 17154.54,-8012.16 17365.3,-8148.16"/>
<text text-anchor="middle" x="16850.27" y="-8098.96" font-family="Times,serif" font-size="14.00">Route Back Expert 4</text>
<text text-anchor="middle" x="16850.27" y="-8083.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16850.27" y="-8068.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16850.27" y="-8053.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert4 -->
<g id="edge40" class="edge">
<title>pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8754.46,-8260C10272.36,-8260 16412.92,-8260 16412.92,-8260 16412.92,-8260 16412.92,-8090.3 16412.92,-8090.3"/>
<polygon fill="black" stroke="black" points="16416.42,-8090.3 16412.92,-8080.3 16409.42,-8090.3 16416.42,-8090.3"/>
</g>
<!-- pp_stage0_layer0_route_back_expert5 -->
<g id="node37" class="node">
<title>pp_stage0_layer0_route_back_expert5</title>
<polygon fill="lightpink" stroke="black" points="1030.3,-8148.16 211,-8148.16 0.23,-8012.16 819.54,-8012.16 1030.3,-8148.16"/>
<text text-anchor="middle" x="515.27" y="-8098.96" font-family="Times,serif" font-size="14.00">Route Back Expert 5</text>
<text text-anchor="middle" x="515.27" y="-8083.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="515.27" y="-8068.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="515.27" y="-8053.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert5 -->
<g id="edge45" class="edge">
<title>pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7958.91,-8263C6331.02,-8263 934.15,-8263 934.15,-8263 934.15,-8263 934.15,-8158.25 934.15,-8158.25"/>
<polygon fill="black" stroke="black" points="937.65,-8158.25 934.15,-8148.25 930.65,-8158.25 937.65,-8158.25"/>
</g>
<!-- pp_stage0_layer0_route_back_expert6 -->
<g id="node41" class="node">
<title>pp_stage0_layer0_route_back_expert6</title>
<polygon fill="lightpink" stroke="black" points="2119.3,-8148.16 1300,-8148.16 1089.23,-8012.16 1908.54,-8012.16 2119.3,-8148.16"/>
<text text-anchor="middle" x="1604.27" y="-8098.96" font-family="Times,serif" font-size="14.00">Route Back Expert 6</text>
<text text-anchor="middle" x="1604.27" y="-8083.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1604.27" y="-8068.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1604.27" y="-8053.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert6 -->
<g id="edge50" class="edge">
<title>pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7953.04,-8259C6470.5,-8259 1953.94,-8259 1953.94,-8259 1953.94,-8259 1953.94,-8158.28 1953.94,-8158.28"/>
<polygon fill="black" stroke="black" points="1957.44,-8158.28 1953.94,-8148.28 1950.44,-8158.28 1957.44,-8158.28"/>
</g>
<!-- pp_stage0_layer0_route_back_expert7 -->
<g id="node45" class="node">
<title>pp_stage0_layer0_route_back_expert7</title>
<polygon fill="lightpink" stroke="black" points="3208.3,-8148.16 2389,-8148.16 2178.23,-8012.16 2997.54,-8012.16 3208.3,-8148.16"/>
<text text-anchor="middle" x="2693.27" y="-8098.96" font-family="Times,serif" font-size="14.00">Route Back Expert 7</text>
<text text-anchor="middle" x="2693.27" y="-8083.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2693.27" y="-8068.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2693.27" y="-8053.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert7 -->
<g id="edge55" class="edge">
<title>pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7947.13,-8255C6636.42,-8255 3042.94,-8255 3042.94,-8255 3042.94,-8255 3042.94,-8158.26 3042.94,-8158.26"/>
<polygon fill="black" stroke="black" points="3046.44,-8158.26 3042.94,-8148.26 3039.44,-8158.26 3046.44,-8158.26"/>
</g>
<!-- pp_stage0_layer0_route_back_expert8 -->
<g id="node49" class="node">
<title>pp_stage0_layer0_route_back_expert8</title>
<polygon fill="lightpink" stroke="black" points="4297.3,-8148.16 3478,-8148.16 3267.23,-8012.16 4086.54,-8012.16 4297.3,-8148.16"/>
<text text-anchor="middle" x="3782.27" y="-8098.96" font-family="Times,serif" font-size="14.00">Route Back Expert 8</text>
<text text-anchor="middle" x="3782.27" y="-8083.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3782.27" y="-8068.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3782.27" y="-8053.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert8 -->
<g id="edge60" class="edge">
<title>pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7940.86,-8251C6823.45,-8251 4131.94,-8251 4131.94,-8251 4131.94,-8251 4131.94,-8158.17 4131.94,-8158.17"/>
<polygon fill="black" stroke="black" points="4135.44,-8158.17 4131.94,-8148.17 4128.44,-8158.17 4135.44,-8158.17"/>
</g>
<!-- pp_stage0_layer0_route_back_expert9 -->
<g id="node53" class="node">
<title>pp_stage0_layer0_route_back_expert9</title>
<polygon fill="lightpink" stroke="black" points="5386.3,-8148.16 4567,-8148.16 4356.23,-8012.16 5175.54,-8012.16 5386.3,-8148.16"/>
<text text-anchor="middle" x="4871.27" y="-8098.96" font-family="Times,serif" font-size="14.00">Route Back Expert 9</text>
<text text-anchor="middle" x="4871.27" y="-8083.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4871.27" y="-8068.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4871.27" y="-8053.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert9 -->
<g id="edge65" class="edge">
<title>pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7933.1,-8246C7061.05,-8246 5318.65,-8246 5318.65,-8246 5318.65,-8246 5318.65,-8158.57 5318.65,-8158.57"/>
<polygon fill="black" stroke="black" points="5322.15,-8158.57 5318.65,-8148.57 5315.15,-8158.57 5322.15,-8158.57"/>
</g>
<!-- pp_stage0_layer0_route_back_expert10 -->
<g id="node57" class="node">
<title>pp_stage0_layer0_route_back_expert10</title>
<polygon fill="lightpink" stroke="black" points="6475.3,-8148.16 5656,-8148.16 5445.23,-8012.16 6264.54,-8012.16 6475.3,-8148.16"/>
<text text-anchor="middle" x="5960.27" y="-8098.96" font-family="Times,serif" font-size="14.00">Route Back Expert 10</text>
<text text-anchor="middle" x="5960.27" y="-8083.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5960.27" y="-8068.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5960.27" y="-8053.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert10 -->
<g id="edge70" class="edge">
<title>pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7927.19,-8242C7326.82,-8242 6389.65,-8242 6389.65,-8242 6389.65,-8242 6389.65,-8158.33 6389.65,-8158.33"/>
<polygon fill="black" stroke="black" points="6393.15,-8158.33 6389.65,-8148.33 6386.15,-8158.33 6393.15,-8158.33"/>
</g>
<!-- pp_stage0_layer0_route_back_expert11 -->
<g id="node61" class="node">
<title>pp_stage0_layer0_route_back_expert11</title>
<polygon fill="lightpink" stroke="black" points="7564.3,-8148.16 6745,-8148.16 6534.23,-8012.16 7353.54,-8012.16 7564.3,-8148.16"/>
<text text-anchor="middle" x="7049.27" y="-8098.96" font-family="Times,serif" font-size="14.00">Route Back Expert 11</text>
<text text-anchor="middle" x="7049.27" y="-8083.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7049.27" y="-8068.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7049.27" y="-8053.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert11 -->
<g id="edge75" class="edge">
<title>pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7921.21,-8238C7688.89,-8238 7462.65,-8238 7462.65,-8238 7462.65,-8238 7462.65,-8158.48 7462.65,-8158.48"/>
<polygon fill="black" stroke="black" points="7466.15,-8158.48 7462.65,-8148.48 7459.15,-8158.48 7466.15,-8158.48"/>
</g>
<!-- pp_stage0_layer0_route_back_expert12 -->
<g id="node65" class="node">
<title>pp_stage0_layer0_route_back_expert12</title>
<polygon fill="lightpink" stroke="black" points="8653.3,-8148.16 7834,-8148.16 7623.23,-8012.16 8442.54,-8012.16 8653.3,-8148.16"/>
<text text-anchor="middle" x="8138.27" y="-8098.96" font-family="Times,serif" font-size="14.00">Route Back Expert 12</text>
<text text-anchor="middle" x="8138.27" y="-8083.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8138.27" y="-8068.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8138.27" y="-8053.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert12 -->
<g id="edge80" class="edge">
<title>pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8284.49,-8234.05C8284.49,-8234.05 8284.49,-8158.53 8284.49,-8158.53"/>
<polygon fill="black" stroke="black" points="8287.99,-8158.53 8284.49,-8148.53 8280.99,-8158.53 8287.99,-8158.53"/>
</g>
<!-- pp_stage0_layer0_route_back_expert13 -->
<g id="node69" class="node">
<title>pp_stage0_layer0_route_back_expert13</title>
<polygon fill="lightpink" stroke="black" points="9742.3,-8148.16 8923,-8148.16 8712.23,-8012.16 9531.54,-8012.16 9742.3,-8148.16"/>
<text text-anchor="middle" x="9227.27" y="-8098.96" font-family="Times,serif" font-size="14.00">Route Back Expert 13</text>
<text text-anchor="middle" x="9227.27" y="-8083.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9227.27" y="-8068.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9227.27" y="-8053.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert13 -->
<g id="edge85" class="edge">
<title>pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8816.55,-8300.75C8816.55,-8300.75 8816.55,-8090.31 8816.55,-8090.31"/>
<polygon fill="black" stroke="black" points="8820.05,-8090.31 8816.55,-8080.31 8813.05,-8090.31 8820.05,-8090.31"/>
</g>
<!-- pp_stage0_layer0_route_back_expert14 -->
<g id="node73" class="node">
<title>pp_stage0_layer0_route_back_expert14</title>
<polygon fill="lightpink" stroke="black" points="10831.3,-8148.16 10012,-8148.16 9801.23,-8012.16 10620.54,-8012.16 10831.3,-8148.16"/>
<text text-anchor="middle" x="10316.27" y="-8098.96" font-family="Times,serif" font-size="14.00">Route Back Expert 14</text>
<text text-anchor="middle" x="10316.27" y="-8083.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10316.27" y="-8068.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10316.27" y="-8053.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert14 -->
<g id="edge90" class="edge">
<title>pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8719.55,-8237C9169.98,-8237 9966.59,-8237 9966.59,-8237 9966.59,-8237 9966.59,-8128.93 9966.59,-8128.93"/>
<polygon fill="black" stroke="black" points="9970.09,-8128.93 9966.59,-8118.93 9963.09,-8128.93 9970.09,-8128.93"/>
</g>
<!-- pp_stage0_layer0_route_back_expert15 -->
<g id="node77" class="node">
<title>pp_stage0_layer0_route_back_expert15</title>
<polygon fill="lightpink" stroke="black" points="11920.3,-8148.16 11101,-8148.16 10890.23,-8012.16 11709.54,-8012.16 11920.3,-8148.16"/>
<text text-anchor="middle" x="11405.27" y="-8098.96" font-family="Times,serif" font-size="14.00">Route Back Expert 15</text>
<text text-anchor="middle" x="11405.27" y="-8083.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11405.27" y="-8068.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11405.27" y="-8053.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert15 -->
<g id="edge95" class="edge">
<title>pp_stage0_layer0_gate&#45;&gt;pp_stage0_layer0_route_back_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8725.86,-8241C9412.63,-8241 11010.92,-8241 11010.92,-8241 11010.92,-8241 11010.92,-8100.23 11010.92,-8100.23"/>
<polygon fill="black" stroke="black" points="11014.42,-8100.23 11010.92,-8090.23 11007.42,-8100.23 11014.42,-8100.23"/>
</g>
<!-- pp_stage0_layer0_expert0_activation -->
<g id="node15" class="node">
<title>pp_stage0_layer0_expert0_activation</title>
<polygon fill="lightyellow" stroke="black" points="11171.27,-8524.16 10665.27,-8524.16 10665.27,-8456.16 11171.27,-8456.16 11171.27,-8524.16"/>
<text text-anchor="middle" x="10918.27" y="-8508.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="10918.27" y="-8493.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10918.27" y="-8478.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10918.27" y="-8463.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert0_up&#45;&gt;pp_stage0_layer0_expert0_activation -->
<g id="edge17" class="edge">
<title>pp_stage0_layer0_expert0_up&#45;&gt;pp_stage0_layer0_expert0_activation</title>
<path fill="none" stroke="black" d="M10765.27,-8609.99C10765.27,-8609.99 10765.27,-8534.25 10765.27,-8534.25"/>
<polygon fill="black" stroke="black" points="10768.77,-8534.25 10765.27,-8524.25 10761.77,-8534.25 10768.77,-8534.25"/>
</g>
<!-- pp_stage0_layer0_expert0_down -->
<g id="node16" class="node">
<title>pp_stage0_layer0_expert0_down</title>
<polygon fill="lightcoral" stroke="black" points="12274.77,-8336.16 11777.77,-8336.16 11777.77,-8268.16 12274.77,-8268.16 12274.77,-8336.16"/>
<text text-anchor="middle" x="12026.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="12026.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12026.27" y="-8290.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12026.27" y="-8275.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert0_activation&#45;&gt;pp_stage0_layer0_expert0_down -->
<g id="edge18" class="edge">
<title>pp_stage0_layer0_expert0_activation&#45;&gt;pp_stage0_layer0_expert0_down</title>
<path fill="none" stroke="black" d="M10963.52,-8456.04C10963.52,-8427.35 10963.52,-8391 10963.52,-8391 10963.52,-8391 11785.52,-8391 11785.52,-8391 11785.52,-8391 11785.52,-8346.26 11785.52,-8346.26"/>
<polygon fill="black" stroke="black" points="11789.02,-8346.26 11785.52,-8336.26 11782.02,-8346.26 11789.02,-8346.26"/>
</g>
<!-- pp_stage0_layer0_expert0_down&#45;&gt;pp_stage0_layer0_route_back_expert0 -->
<g id="edge19" class="edge">
<title>pp_stage0_layer0_expert0_down&#45;&gt;pp_stage0_layer0_route_back_expert0</title>
<path fill="none" stroke="black" d="M12176.18,-8267.96C12176.18,-8267.96 12176.18,-8149.48 12176.18,-8149.48"/>
<polygon fill="black" stroke="black" points="12179.68,-8149.48 12176.18,-8139.48 12172.68,-8149.48 12179.68,-8149.48"/>
</g>
<!-- pp_stage0_layer0_expert_agg -->
<g id="node78" class="node">
<title>pp_stage0_layer0_expert_agg</title>
<ellipse fill="lightblue" stroke="black" cx="8138.27" cy="-7878.08" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="8138.27" y="-7896.88" font-family="Times,serif" font-size="14.00">Aggregate Experts</text>
<text text-anchor="middle" x="8138.27" y="-7881.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8138.27" y="-7866.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8138.27" y="-7851.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_route_back_expert0&#45;&gt;pp_stage0_layer0_expert_agg -->
<g id="edge96" class="edge">
<title>pp_stage0_layer0_route_back_expert0&#45;&gt;pp_stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M11986.27,-8080.02C11986.27,-8074.05 11986.27,-7883 11986.27,-7883 11986.27,-7883 8498.24,-7883 8498.24,-7883"/>
<polygon fill="black" stroke="black" points="8498.24,-7879.5 8488.24,-7883 8498.24,-7886.5 8498.24,-7879.5"/>
</g>
<!-- pp_stage0_layer0_expert1_activation -->
<g id="node19" class="node">
<title>pp_stage0_layer0_expert1_activation</title>
<polygon fill="lightyellow" stroke="black" points="11735.27,-8524.16 11229.27,-8524.16 11229.27,-8456.16 11735.27,-8456.16 11735.27,-8524.16"/>
<text text-anchor="middle" x="11482.27" y="-8508.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="11482.27" y="-8493.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11482.27" y="-8478.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11482.27" y="-8463.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert1_up&#45;&gt;pp_stage0_layer0_expert1_activation -->
<g id="edge22" class="edge">
<title>pp_stage0_layer0_expert1_up&#45;&gt;pp_stage0_layer0_expert1_activation</title>
<path fill="none" stroke="black" d="M11332.77,-8609.99C11332.77,-8609.99 11332.77,-8534.25 11332.77,-8534.25"/>
<polygon fill="black" stroke="black" points="11336.27,-8534.25 11332.77,-8524.25 11329.27,-8534.25 11336.27,-8534.25"/>
</g>
<!-- pp_stage0_layer0_expert1_down -->
<g id="node20" class="node">
<title>pp_stage0_layer0_expert1_down</title>
<polygon fill="lightcoral" stroke="black" points="13330.77,-8336.16 12833.77,-8336.16 12833.77,-8268.16 13330.77,-8268.16 13330.77,-8336.16"/>
<text text-anchor="middle" x="13082.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="13082.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="13082.27" y="-8290.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13082.27" y="-8275.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert1_activation&#45;&gt;pp_stage0_layer0_expert1_down -->
<g id="edge23" class="edge">
<title>pp_stage0_layer0_expert1_activation&#45;&gt;pp_stage0_layer0_expert1_down</title>
<path fill="none" stroke="black" d="M11494.02,-8456.09C11494.02,-8435.42 11494.02,-8413 11494.02,-8413 11494.02,-8413 12843.6,-8413 12843.6,-8413 12843.6,-8413 12843.6,-8346.32 12843.6,-8346.32"/>
<polygon fill="black" stroke="black" points="12847.1,-8346.32 12843.6,-8336.32 12840.1,-8346.32 12847.1,-8346.32"/>
</g>
<!-- pp_stage0_layer0_expert1_down&#45;&gt;pp_stage0_layer0_route_back_expert1 -->
<g id="edge24" class="edge">
<title>pp_stage0_layer0_expert1_down&#45;&gt;pp_stage0_layer0_route_back_expert1</title>
<path fill="none" stroke="black" d="M13243.18,-8267.96C13243.18,-8267.96 13243.18,-8135.16 13243.18,-8135.16"/>
<polygon fill="black" stroke="black" points="13246.68,-8135.16 13243.18,-8125.16 13239.68,-8135.16 13246.68,-8135.16"/>
</g>
<!-- pp_stage0_layer0_route_back_expert1&#45;&gt;pp_stage0_layer0_expert_agg -->
<g id="edge97" class="edge">
<title>pp_stage0_layer0_route_back_expert1&#45;&gt;pp_stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M13080.88,-8080.01C13080.88,-8073.71 13080.88,-7872 13080.88,-7872 13080.88,-7872 8497.3,-7872 8497.3,-7872"/>
<polygon fill="black" stroke="black" points="8497.3,-7868.5 8487.3,-7872 8497.3,-7875.5 8497.3,-7868.5"/>
</g>
<!-- pp_stage0_layer0_expert2_activation -->
<g id="node23" class="node">
<title>pp_stage0_layer0_expert2_activation</title>
<polygon fill="lightyellow" stroke="black" points="12299.27,-8524.16 11793.27,-8524.16 11793.27,-8456.16 12299.27,-8456.16 12299.27,-8524.16"/>
<text text-anchor="middle" x="12046.27" y="-8508.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="12046.27" y="-8493.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12046.27" y="-8478.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12046.27" y="-8463.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert2_up&#45;&gt;pp_stage0_layer0_expert2_activation -->
<g id="edge27" class="edge">
<title>pp_stage0_layer0_expert2_up&#45;&gt;pp_stage0_layer0_expert2_activation</title>
<path fill="none" stroke="black" d="M11898.77,-8609.99C11898.77,-8609.99 11898.77,-8534.25 11898.77,-8534.25"/>
<polygon fill="black" stroke="black" points="11902.27,-8534.25 11898.77,-8524.25 11895.27,-8534.25 11902.27,-8534.25"/>
</g>
<!-- pp_stage0_layer0_expert2_down -->
<g id="node24" class="node">
<title>pp_stage0_layer0_expert2_down</title>
<polygon fill="lightcoral" stroke="black" points="14402.77,-8336.16 13905.77,-8336.16 13905.77,-8268.16 14402.77,-8268.16 14402.77,-8336.16"/>
<text text-anchor="middle" x="14154.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="14154.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="14154.27" y="-8290.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14154.27" y="-8275.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert2_activation&#45;&gt;pp_stage0_layer0_expert2_down -->
<g id="edge28" class="edge">
<title>pp_stage0_layer0_expert2_activation&#45;&gt;pp_stage0_layer0_expert2_down</title>
<path fill="none" stroke="black" d="M12287.02,-8455.82C12287.02,-8392.55 12287.02,-8264 12287.02,-8264 12287.02,-8264 14002.15,-8264 14002.15,-8264 14002.15,-8264 14002.15,-8264.41 14002.15,-8264.41"/>
<polygon fill="black" stroke="black" points="13998.65,-8258.08 14002.15,-8268.08 14005.65,-8258.08 13998.65,-8258.08"/>
</g>
<!-- pp_stage0_layer0_expert2_down&#45;&gt;pp_stage0_layer0_route_back_expert2 -->
<g id="edge29" class="edge">
<title>pp_stage0_layer0_expert2_down&#45;&gt;pp_stage0_layer0_route_back_expert2</title>
<path fill="none" stroke="black" d="M14320.84,-8267.96C14320.84,-8267.96 14320.84,-8127.75 14320.84,-8127.75"/>
<polygon fill="black" stroke="black" points="14324.34,-8127.75 14320.84,-8117.75 14317.34,-8127.75 14324.34,-8127.75"/>
</g>
<!-- pp_stage0_layer0_route_back_expert2&#45;&gt;pp_stage0_layer0_expert_agg -->
<g id="edge98" class="edge">
<title>pp_stage0_layer0_route_back_expert2&#45;&gt;pp_stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M14283.13,-8012.03C14283.13,-7948.02 14283.13,-7862 14283.13,-7862 14283.13,-7862 8479.73,-7862 8479.73,-7862"/>
<polygon fill="black" stroke="black" points="8479.73,-7858.5 8469.73,-7862 8479.73,-7865.5 8479.73,-7858.5"/>
</g>
<!-- pp_stage0_layer0_expert3_activation -->
<g id="node27" class="node">
<title>pp_stage0_layer0_expert3_activation</title>
<polygon fill="lightyellow" stroke="black" points="12863.27,-8524.16 12357.27,-8524.16 12357.27,-8456.16 12863.27,-8456.16 12863.27,-8524.16"/>
<text text-anchor="middle" x="12610.27" y="-8508.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="12610.27" y="-8493.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12610.27" y="-8478.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12610.27" y="-8463.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert3_up&#45;&gt;pp_stage0_layer0_expert3_activation -->
<g id="edge32" class="edge">
<title>pp_stage0_layer0_expert3_up&#45;&gt;pp_stage0_layer0_expert3_activation</title>
<path fill="none" stroke="black" d="M12463.77,-8609.99C12463.77,-8609.99 12463.77,-8534.25 12463.77,-8534.25"/>
<polygon fill="black" stroke="black" points="12467.27,-8534.25 12463.77,-8524.25 12460.27,-8534.25 12467.27,-8534.25"/>
</g>
<!-- pp_stage0_layer0_expert3_down -->
<g id="node28" class="node">
<title>pp_stage0_layer0_expert3_down</title>
<polygon fill="lightcoral" stroke="black" points="15483.77,-8336.16 14986.77,-8336.16 14986.77,-8268.16 15483.77,-8268.16 15483.77,-8336.16"/>
<text text-anchor="middle" x="15235.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="15235.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="15235.27" y="-8290.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15235.27" y="-8275.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert3_activation&#45;&gt;pp_stage0_layer0_expert3_down -->
<g id="edge33" class="edge">
<title>pp_stage0_layer0_expert3_activation&#45;&gt;pp_stage0_layer0_expert3_down</title>
<path fill="none" stroke="black" d="M12853.43,-8455.88C12853.43,-8444.18 12853.43,-8434 12853.43,-8434 12853.43,-8434 15235.27,-8434 15235.27,-8434 15235.27,-8434 15235.27,-8346.46 15235.27,-8346.46"/>
<polygon fill="black" stroke="black" points="15238.77,-8346.46 15235.27,-8336.46 15231.77,-8346.46 15238.77,-8346.46"/>
</g>
<!-- pp_stage0_layer0_expert3_down&#45;&gt;pp_stage0_layer0_route_back_expert3 -->
<g id="edge34" class="edge">
<title>pp_stage0_layer0_expert3_down&#45;&gt;pp_stage0_layer0_route_back_expert3</title>
<path fill="none" stroke="black" d="M15404.51,-8267.96C15404.51,-8267.96 15404.51,-8124.4 15404.51,-8124.4"/>
<polygon fill="black" stroke="black" points="15408.01,-8124.4 15404.51,-8114.4 15401.01,-8124.4 15408.01,-8124.4"/>
</g>
<!-- pp_stage0_layer0_route_back_expert3&#45;&gt;pp_stage0_layer0_expert_agg -->
<g id="edge99" class="edge">
<title>pp_stage0_layer0_route_back_expert3&#45;&gt;pp_stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M15376.63,-8012.03C15376.63,-7944.48 15376.63,-7851 15376.63,-7851 15376.63,-7851 8438.73,-7851 8438.73,-7851"/>
<polygon fill="black" stroke="black" points="8438.73,-7847.5 8428.73,-7851 8438.73,-7854.5 8438.73,-7847.5"/>
</g>
<!-- pp_stage0_layer0_expert4_activation -->
<g id="node31" class="node">
<title>pp_stage0_layer0_expert4_activation</title>
<polygon fill="lightyellow" stroke="black" points="13427.27,-8524.16 12921.27,-8524.16 12921.27,-8456.16 13427.27,-8456.16 13427.27,-8524.16"/>
<text text-anchor="middle" x="13174.27" y="-8508.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="13174.27" y="-8493.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="13174.27" y="-8478.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="13174.27" y="-8463.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert4_up&#45;&gt;pp_stage0_layer0_expert4_activation -->
<g id="edge37" class="edge">
<title>pp_stage0_layer0_expert4_up&#45;&gt;pp_stage0_layer0_expert4_activation</title>
<path fill="none" stroke="black" d="M13028.27,-8609.99C13028.27,-8609.99 13028.27,-8534.25 13028.27,-8534.25"/>
<polygon fill="black" stroke="black" points="13031.77,-8534.25 13028.27,-8524.25 13024.77,-8534.25 13031.77,-8534.25"/>
</g>
<!-- pp_stage0_layer0_expert4_down -->
<g id="node32" class="node">
<title>pp_stage0_layer0_expert4_down</title>
<polygon fill="lightcoral" stroke="black" points="16568.77,-8336.16 16071.77,-8336.16 16071.77,-8268.16 16568.77,-8268.16 16568.77,-8336.16"/>
<text text-anchor="middle" x="16320.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="16320.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="16320.27" y="-8290.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16320.27" y="-8275.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert4_activation&#45;&gt;pp_stage0_layer0_expert4_down -->
<g id="edge38" class="edge">
<title>pp_stage0_layer0_expert4_activation&#45;&gt;pp_stage0_layer0_expert4_down</title>
<path fill="none" stroke="black" d="M13427.39,-8490C14174.84,-8490 16320.27,-8490 16320.27,-8490 16320.27,-8490 16320.27,-8346.18 16320.27,-8346.18"/>
<polygon fill="black" stroke="black" points="16323.77,-8346.18 16320.27,-8336.18 16316.77,-8346.18 16323.77,-8346.18"/>
</g>
<!-- pp_stage0_layer0_expert4_down&#45;&gt;pp_stage0_layer0_route_back_expert4 -->
<g id="edge39" class="edge">
<title>pp_stage0_layer0_expert4_down&#45;&gt;pp_stage0_layer0_route_back_expert4</title>
<path fill="none" stroke="black" d="M16490.84,-8267.96C16490.84,-8267.96 16490.84,-8122.6 16490.84,-8122.6"/>
<polygon fill="black" stroke="black" points="16494.34,-8122.6 16490.84,-8112.6 16487.34,-8122.6 16494.34,-8122.6"/>
</g>
<!-- pp_stage0_layer0_route_back_expert4&#45;&gt;pp_stage0_layer0_expert_agg -->
<g id="edge100" class="edge">
<title>pp_stage0_layer0_route_back_expert4&#45;&gt;pp_stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M16581.88,-8011.99C16581.88,-7940.98 16581.88,-7840 16581.88,-7840 16581.88,-7840 8363.07,-7840 8363.07,-7840"/>
<polygon fill="black" stroke="black" points="8363.07,-7836.5 8353.07,-7840 8363.07,-7843.5 8363.07,-7836.5"/>
</g>
<!-- pp_stage0_layer0_expert5_activation -->
<g id="node35" class="node">
<title>pp_stage0_layer0_expert5_activation</title>
<polygon fill="lightyellow" stroke="black" points="1047.27,-8524.16 541.27,-8524.16 541.27,-8456.16 1047.27,-8456.16 1047.27,-8524.16"/>
<text text-anchor="middle" x="794.27" y="-8508.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="794.27" y="-8493.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="794.27" y="-8478.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="794.27" y="-8463.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert5_up&#45;&gt;pp_stage0_layer0_expert5_activation -->
<g id="edge42" class="edge">
<title>pp_stage0_layer0_expert5_up&#45;&gt;pp_stage0_layer0_expert5_activation</title>
<path fill="none" stroke="black" d="M1345.27,-8609.95C1345.27,-8564.53 1345.27,-8490 1345.27,-8490 1345.27,-8490 1057.59,-8490 1057.59,-8490"/>
<polygon fill="black" stroke="black" points="1057.59,-8486.5 1047.59,-8490 1057.59,-8493.5 1057.59,-8486.5"/>
</g>
<!-- pp_stage0_layer0_expert5_down -->
<g id="node36" class="node">
<title>pp_stage0_layer0_expert5_down</title>
<polygon fill="lightcoral" stroke="black" points="837.77,-8336.16 340.77,-8336.16 340.77,-8268.16 837.77,-8268.16 837.77,-8336.16"/>
<text text-anchor="middle" x="589.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="589.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="589.27" y="-8290.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="589.27" y="-8275.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert5_activation&#45;&gt;pp_stage0_layer0_expert5_down -->
<g id="edge43" class="edge">
<title>pp_stage0_layer0_expert5_activation&#45;&gt;pp_stage0_layer0_expert5_down</title>
<path fill="none" stroke="black" d="M689.52,-8456.12C689.52,-8456.12 689.52,-8346.27 689.52,-8346.27"/>
<polygon fill="black" stroke="black" points="693.02,-8346.27 689.52,-8336.27 686.02,-8346.27 693.02,-8346.27"/>
</g>
<!-- pp_stage0_layer0_expert5_down&#45;&gt;pp_stage0_layer0_route_back_expert5 -->
<g id="edge44" class="edge">
<title>pp_stage0_layer0_expert5_down&#45;&gt;pp_stage0_layer0_route_back_expert5</title>
<path fill="none" stroke="black" d="M589.27,-8267.96C589.27,-8267.96 589.27,-8158.43 589.27,-8158.43"/>
<polygon fill="black" stroke="black" points="592.77,-8158.43 589.27,-8148.43 585.77,-8158.43 592.77,-8158.43"/>
</g>
<!-- pp_stage0_layer0_route_back_expert5&#45;&gt;pp_stage0_layer0_expert_agg -->
<g id="edge101" class="edge">
<title>pp_stage0_layer0_route_back_expert5&#45;&gt;pp_stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M799.65,-8011.92C799.65,-7941.54 799.65,-7842 799.65,-7842 799.65,-7842 7895.75,-7842 7895.75,-7842"/>
<polygon fill="black" stroke="black" points="7895.75,-7845.5 7905.75,-7842 7895.75,-7838.5 7895.75,-7845.5"/>
</g>
<!-- pp_stage0_layer0_expert6_activation -->
<g id="node39" class="node">
<title>pp_stage0_layer0_expert6_activation</title>
<polygon fill="lightyellow" stroke="black" points="2792.27,-8524.16 2286.27,-8524.16 2286.27,-8456.16 2792.27,-8456.16 2792.27,-8524.16"/>
<text text-anchor="middle" x="2539.27" y="-8508.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2539.27" y="-8493.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="2539.27" y="-8478.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="2539.27" y="-8463.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert6_up&#45;&gt;pp_stage0_layer0_expert6_activation -->
<g id="edge47" class="edge">
<title>pp_stage0_layer0_expert6_up&#45;&gt;pp_stage0_layer0_expert6_activation</title>
<path fill="none" stroke="black" d="M2777.77,-8609.99C2777.77,-8609.99 2777.77,-8534.25 2777.77,-8534.25"/>
<polygon fill="black" stroke="black" points="2781.27,-8534.25 2777.77,-8524.25 2774.27,-8534.25 2781.27,-8534.25"/>
</g>
<!-- pp_stage0_layer0_expert6_down -->
<g id="node40" class="node">
<title>pp_stage0_layer0_expert6_down</title>
<polygon fill="lightcoral" stroke="black" points="2119.77,-8336.16 1622.77,-8336.16 1622.77,-8268.16 2119.77,-8268.16 2119.77,-8336.16"/>
<text text-anchor="middle" x="1871.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="1871.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="1871.27" y="-8290.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1871.27" y="-8275.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert6_activation&#45;&gt;pp_stage0_layer0_expert6_down -->
<g id="edge48" class="edge">
<title>pp_stage0_layer0_expert6_activation&#45;&gt;pp_stage0_layer0_expert6_down</title>
<path fill="none" stroke="black" d="M2499.02,-8456.09C2499.02,-8401.87 2499.02,-8302 2499.02,-8302 2499.02,-8302 2129.82,-8302 2129.82,-8302"/>
<polygon fill="black" stroke="black" points="2129.82,-8298.5 2119.82,-8302 2129.82,-8305.5 2129.82,-8298.5"/>
</g>
<!-- pp_stage0_layer0_expert6_down&#45;&gt;pp_stage0_layer0_route_back_expert6 -->
<g id="edge49" class="edge">
<title>pp_stage0_layer0_expert6_down&#45;&gt;pp_stage0_layer0_route_back_expert6</title>
<path fill="none" stroke="black" d="M1788.36,-8267.96C1788.36,-8267.96 1788.36,-8158.43 1788.36,-8158.43"/>
<polygon fill="black" stroke="black" points="1791.86,-8158.43 1788.36,-8148.43 1784.86,-8158.43 1791.86,-8158.43"/>
</g>
<!-- pp_stage0_layer0_route_back_expert6&#45;&gt;pp_stage0_layer0_expert_agg -->
<g id="edge102" class="edge">
<title>pp_stage0_layer0_route_back_expert6&#45;&gt;pp_stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M1734.27,-8012C1734.27,-7945.41 1734.27,-7854 1734.27,-7854 1734.27,-7854 7823.96,-7854 7823.96,-7854"/>
<polygon fill="black" stroke="black" points="7823.96,-7857.5 7833.96,-7854 7823.96,-7850.5 7823.96,-7857.5"/>
</g>
<!-- pp_stage0_layer0_expert7_activation -->
<g id="node43" class="node">
<title>pp_stage0_layer0_expert7_activation</title>
<polygon fill="lightyellow" stroke="black" points="3946.27,-8524.16 3440.27,-8524.16 3440.27,-8456.16 3946.27,-8456.16 3946.27,-8524.16"/>
<text text-anchor="middle" x="3693.27" y="-8508.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3693.27" y="-8493.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="3693.27" y="-8478.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="3693.27" y="-8463.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert7_up&#45;&gt;pp_stage0_layer0_expert7_activation -->
<g id="edge52" class="edge">
<title>pp_stage0_layer0_expert7_up&#45;&gt;pp_stage0_layer0_expert7_activation</title>
<path fill="none" stroke="black" d="M3894.77,-8609.99C3894.77,-8609.99 3894.77,-8534.25 3894.77,-8534.25"/>
<polygon fill="black" stroke="black" points="3898.27,-8534.25 3894.77,-8524.25 3891.27,-8534.25 3898.27,-8534.25"/>
</g>
<!-- pp_stage0_layer0_expert7_down -->
<g id="node44" class="node">
<title>pp_stage0_layer0_expert7_down</title>
<polygon fill="lightcoral" stroke="black" points="3208.77,-8336.16 2711.77,-8336.16 2711.77,-8268.16 3208.77,-8268.16 3208.77,-8336.16"/>
<text text-anchor="middle" x="2960.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="2960.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="2960.27" y="-8290.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2960.27" y="-8275.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert7_activation&#45;&gt;pp_stage0_layer0_expert7_down -->
<g id="edge53" class="edge">
<title>pp_stage0_layer0_expert7_activation&#45;&gt;pp_stage0_layer0_expert7_down</title>
<path fill="none" stroke="black" d="M3620.52,-8456.09C3620.52,-8401.87 3620.52,-8302 3620.52,-8302 3620.52,-8302 3218.94,-8302 3218.94,-8302"/>
<polygon fill="black" stroke="black" points="3218.94,-8298.5 3208.94,-8302 3218.94,-8305.5 3218.94,-8298.5"/>
</g>
<!-- pp_stage0_layer0_expert7_down&#45;&gt;pp_stage0_layer0_route_back_expert7 -->
<g id="edge54" class="edge">
<title>pp_stage0_layer0_expert7_down&#45;&gt;pp_stage0_layer0_route_back_expert7</title>
<path fill="none" stroke="black" d="M2877.36,-8267.96C2877.36,-8267.96 2877.36,-8158.43 2877.36,-8158.43"/>
<polygon fill="black" stroke="black" points="2880.86,-8158.43 2877.36,-8148.43 2873.86,-8158.43 2880.86,-8158.43"/>
</g>
<!-- pp_stage0_layer0_route_back_expert7&#45;&gt;pp_stage0_layer0_expert_agg -->
<g id="edge103" class="edge">
<title>pp_stage0_layer0_route_back_expert7&#45;&gt;pp_stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3061.9,-8053.47C3061.9,-7996.06 3061.9,-7866 3061.9,-7866 3061.9,-7866 7787.8,-7866 7787.8,-7866"/>
<polygon fill="black" stroke="black" points="7787.8,-7869.5 7797.8,-7866 7787.8,-7862.5 7787.8,-7869.5"/>
</g>
<!-- pp_stage0_layer0_expert8_activation -->
<g id="node47" class="node">
<title>pp_stage0_layer0_expert8_activation</title>
<polygon fill="lightyellow" stroke="black" points="4805.27,-8524.16 4299.27,-8524.16 4299.27,-8456.16 4805.27,-8456.16 4805.27,-8524.16"/>
<text text-anchor="middle" x="4552.27" y="-8508.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="4552.27" y="-8493.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="4552.27" y="-8478.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="4552.27" y="-8463.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert8_up&#45;&gt;pp_stage0_layer0_expert8_activation -->
<g id="edge57" class="edge">
<title>pp_stage0_layer0_expert8_up&#45;&gt;pp_stage0_layer0_expert8_activation</title>
<path fill="none" stroke="black" d="M4716.77,-8609.99C4716.77,-8609.99 4716.77,-8534.25 4716.77,-8534.25"/>
<polygon fill="black" stroke="black" points="4720.27,-8534.25 4716.77,-8524.25 4713.27,-8534.25 4720.27,-8534.25"/>
</g>
<!-- pp_stage0_layer0_expert8_down -->
<g id="node48" class="node">
<title>pp_stage0_layer0_expert8_down</title>
<polygon fill="lightcoral" stroke="black" points="4297.77,-8336.16 3800.77,-8336.16 3800.77,-8268.16 4297.77,-8268.16 4297.77,-8336.16"/>
<text text-anchor="middle" x="4049.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="4049.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="4049.27" y="-8290.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4049.27" y="-8275.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert8_activation&#45;&gt;pp_stage0_layer0_expert8_down -->
<g id="edge58" class="edge">
<title>pp_stage0_layer0_expert8_activation&#45;&gt;pp_stage0_layer0_expert8_down</title>
<path fill="none" stroke="black" d="M4327.63,-8456.09C4327.63,-8401.87 4327.63,-8302 4327.63,-8302 4327.63,-8302 4307.84,-8302 4307.84,-8302"/>
<polygon fill="black" stroke="black" points="4307.84,-8298.5 4297.84,-8302 4307.84,-8305.5 4307.84,-8298.5"/>
</g>
<!-- pp_stage0_layer0_expert8_down&#45;&gt;pp_stage0_layer0_route_back_expert8 -->
<g id="edge59" class="edge">
<title>pp_stage0_layer0_expert8_down&#45;&gt;pp_stage0_layer0_route_back_expert8</title>
<path fill="none" stroke="black" d="M3966.36,-8267.96C3966.36,-8267.96 3966.36,-8158.43 3966.36,-8158.43"/>
<polygon fill="black" stroke="black" points="3969.86,-8158.43 3966.36,-8148.43 3962.86,-8158.43 3969.86,-8158.43"/>
</g>
<!-- pp_stage0_layer0_route_back_expert8&#45;&gt;pp_stage0_layer0_expert_agg -->
<g id="edge104" class="edge">
<title>pp_stage0_layer0_route_back_expert8&#45;&gt;pp_stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M3838.25,-8012C3838.25,-7953.31 3838.25,-7878 3838.25,-7878 3838.25,-7878 7776.83,-7878 7776.83,-7878"/>
<polygon fill="black" stroke="black" points="7776.83,-7881.5 7786.83,-7878 7776.83,-7874.5 7776.83,-7881.5"/>
</g>
<!-- pp_stage0_layer0_expert9_activation -->
<g id="node51" class="node">
<title>pp_stage0_layer0_expert9_activation</title>
<polygon fill="lightyellow" stroke="black" points="5517.27,-8524.16 5011.27,-8524.16 5011.27,-8456.16 5517.27,-8456.16 5517.27,-8524.16"/>
<text text-anchor="middle" x="5264.27" y="-8508.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="5264.27" y="-8493.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="5264.27" y="-8478.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="5264.27" y="-8463.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert9_up&#45;&gt;pp_stage0_layer0_expert9_activation -->
<g id="edge62" class="edge">
<title>pp_stage0_layer0_expert9_up&#45;&gt;pp_stage0_layer0_expert9_activation</title>
<path fill="none" stroke="black" d="M5391.77,-8609.99C5391.77,-8609.99 5391.77,-8534.25 5391.77,-8534.25"/>
<polygon fill="black" stroke="black" points="5395.27,-8534.25 5391.77,-8524.25 5388.27,-8534.25 5395.27,-8534.25"/>
</g>
<!-- pp_stage0_layer0_expert9_down -->
<g id="node52" class="node">
<title>pp_stage0_layer0_expert9_down</title>
<polygon fill="lightcoral" stroke="black" points="5250.77,-8336.16 4753.77,-8336.16 4753.77,-8268.16 5250.77,-8268.16 5250.77,-8336.16"/>
<text text-anchor="middle" x="5002.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="5002.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="5002.27" y="-8290.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5002.27" y="-8275.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert9_activation&#45;&gt;pp_stage0_layer0_expert9_down -->
<g id="edge63" class="edge">
<title>pp_stage0_layer0_expert9_activation&#45;&gt;pp_stage0_layer0_expert9_down</title>
<path fill="none" stroke="black" d="M5131.02,-8456.12C5131.02,-8456.12 5131.02,-8346.27 5131.02,-8346.27"/>
<polygon fill="black" stroke="black" points="5134.52,-8346.27 5131.02,-8336.27 5127.52,-8346.27 5134.52,-8346.27"/>
</g>
<!-- pp_stage0_layer0_expert9_down&#45;&gt;pp_stage0_layer0_route_back_expert9 -->
<g id="edge64" class="edge">
<title>pp_stage0_layer0_expert9_down&#45;&gt;pp_stage0_layer0_route_back_expert9</title>
<path fill="none" stroke="black" d="M5002.27,-8267.96C5002.27,-8267.96 5002.27,-8158.43 5002.27,-8158.43"/>
<polygon fill="black" stroke="black" points="5005.77,-8158.43 5002.27,-8148.43 4998.77,-8158.43 5005.77,-8158.43"/>
</g>
<!-- pp_stage0_layer0_route_back_expert9&#45;&gt;pp_stage0_layer0_expert_agg -->
<g id="edge105" class="edge">
<title>pp_stage0_layer0_route_back_expert9&#45;&gt;pp_stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M5335.9,-8080.03C5335.9,-8074.27 5335.9,-7890 5335.9,-7890 5335.9,-7890 7787.79,-7890 7787.79,-7890"/>
<polygon fill="black" stroke="black" points="7787.79,-7893.5 7797.79,-7890 7787.79,-7886.5 7787.79,-7893.5"/>
</g>
<!-- pp_stage0_layer0_expert10_activation -->
<g id="node55" class="node">
<title>pp_stage0_layer0_expert10_activation</title>
<polygon fill="lightyellow" stroke="black" points="6497.27,-8524.16 5991.27,-8524.16 5991.27,-8456.16 6497.27,-8456.16 6497.27,-8524.16"/>
<text text-anchor="middle" x="6244.27" y="-8508.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="6244.27" y="-8493.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="6244.27" y="-8478.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="6244.27" y="-8463.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert10_up&#45;&gt;pp_stage0_layer0_expert10_activation -->
<g id="edge67" class="edge">
<title>pp_stage0_layer0_expert10_up&#45;&gt;pp_stage0_layer0_expert10_activation</title>
<path fill="none" stroke="black" d="M6291.77,-8609.99C6291.77,-8609.99 6291.77,-8534.25 6291.77,-8534.25"/>
<polygon fill="black" stroke="black" points="6295.27,-8534.25 6291.77,-8524.25 6288.27,-8534.25 6295.27,-8534.25"/>
</g>
<!-- pp_stage0_layer0_expert10_down -->
<g id="node56" class="node">
<title>pp_stage0_layer0_expert10_down</title>
<polygon fill="lightcoral" stroke="black" points="6303.77,-8336.16 5806.77,-8336.16 5806.77,-8268.16 6303.77,-8268.16 6303.77,-8336.16"/>
<text text-anchor="middle" x="6055.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="6055.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="6055.27" y="-8290.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6055.27" y="-8275.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert10_activation&#45;&gt;pp_stage0_layer0_expert10_down -->
<g id="edge68" class="edge">
<title>pp_stage0_layer0_expert10_activation&#45;&gt;pp_stage0_layer0_expert10_down</title>
<path fill="none" stroke="black" d="M6147.52,-8456.12C6147.52,-8456.12 6147.52,-8346.27 6147.52,-8346.27"/>
<polygon fill="black" stroke="black" points="6151.02,-8346.27 6147.52,-8336.27 6144.02,-8346.27 6151.02,-8346.27"/>
</g>
<!-- pp_stage0_layer0_expert10_down&#45;&gt;pp_stage0_layer0_route_back_expert10 -->
<g id="edge69" class="edge">
<title>pp_stage0_layer0_expert10_down&#45;&gt;pp_stage0_layer0_route_back_expert10</title>
<path fill="none" stroke="black" d="M6055.27,-8267.96C6055.27,-8267.96 6055.27,-8158.43 6055.27,-8158.43"/>
<polygon fill="black" stroke="black" points="6058.77,-8158.43 6055.27,-8148.43 6051.77,-8158.43 6058.77,-8158.43"/>
</g>
<!-- pp_stage0_layer0_route_back_expert10&#45;&gt;pp_stage0_layer0_expert_agg -->
<g id="edge106" class="edge">
<title>pp_stage0_layer0_route_back_expert10&#45;&gt;pp_stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M6457.9,-8080.04C6457.9,-8074.64 6457.9,-7902 6457.9,-7902 6457.9,-7902 7822.99,-7902 7822.99,-7902"/>
<polygon fill="black" stroke="black" points="7822.99,-7905.5 7832.99,-7902 7822.99,-7898.5 7822.99,-7905.5"/>
</g>
<!-- pp_stage0_layer0_expert11_activation -->
<g id="node59" class="node">
<title>pp_stage0_layer0_expert11_activation</title>
<polygon fill="lightyellow" stroke="black" points="7534.27,-8524.16 7028.27,-8524.16 7028.27,-8456.16 7534.27,-8456.16 7534.27,-8524.16"/>
<text text-anchor="middle" x="7281.27" y="-8508.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7281.27" y="-8493.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7281.27" y="-8478.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7281.27" y="-8463.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert11_up&#45;&gt;pp_stage0_layer0_expert11_activation -->
<g id="edge72" class="edge">
<title>pp_stage0_layer0_expert11_up&#45;&gt;pp_stage0_layer0_expert11_activation</title>
<path fill="none" stroke="black" d="M7310.27,-8609.99C7310.27,-8609.99 7310.27,-8534.25 7310.27,-8534.25"/>
<polygon fill="black" stroke="black" points="7313.77,-8534.25 7310.27,-8524.25 7306.77,-8534.25 7313.77,-8534.25"/>
</g>
<!-- pp_stage0_layer0_expert11_down -->
<g id="node60" class="node">
<title>pp_stage0_layer0_expert11_down</title>
<polygon fill="lightcoral" stroke="black" points="7300.77,-8336.16 6803.77,-8336.16 6803.77,-8268.16 7300.77,-8268.16 7300.77,-8336.16"/>
<text text-anchor="middle" x="7052.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="7052.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7052.27" y="-8290.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7052.27" y="-8275.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert11_activation&#45;&gt;pp_stage0_layer0_expert11_down -->
<g id="edge73" class="edge">
<title>pp_stage0_layer0_expert11_activation&#45;&gt;pp_stage0_layer0_expert11_down</title>
<path fill="none" stroke="black" d="M7164.52,-8456.12C7164.52,-8456.12 7164.52,-8346.27 7164.52,-8346.27"/>
<polygon fill="black" stroke="black" points="7168.02,-8346.27 7164.52,-8336.27 7161.02,-8346.27 7168.02,-8346.27"/>
</g>
<!-- pp_stage0_layer0_expert11_down&#45;&gt;pp_stage0_layer0_route_back_expert11 -->
<g id="edge74" class="edge">
<title>pp_stage0_layer0_expert11_down&#45;&gt;pp_stage0_layer0_route_back_expert11</title>
<path fill="none" stroke="black" d="M7052.27,-8267.96C7052.27,-8267.96 7052.27,-8158.43 7052.27,-8158.43"/>
<polygon fill="black" stroke="black" points="7055.77,-8158.43 7052.27,-8148.43 7048.77,-8158.43 7055.77,-8158.43"/>
</g>
<!-- pp_stage0_layer0_route_back_expert11&#45;&gt;pp_stage0_layer0_expert_agg -->
<g id="edge107" class="edge">
<title>pp_stage0_layer0_route_back_expert11&#45;&gt;pp_stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M7485.4,-8080.04C7485.4,-8075.01 7485.4,-7914 7485.4,-7914 7485.4,-7914 7894.41,-7914 7894.41,-7914"/>
<polygon fill="black" stroke="black" points="7894.41,-7917.5 7904.41,-7914 7894.41,-7910.5 7894.41,-7917.5"/>
</g>
<!-- pp_stage0_layer0_expert12_activation -->
<g id="node63" class="node">
<title>pp_stage0_layer0_expert12_activation</title>
<polygon fill="lightyellow" stroke="black" points="8214.27,-8524.16 7708.27,-8524.16 7708.27,-8456.16 8214.27,-8456.16 8214.27,-8524.16"/>
<text text-anchor="middle" x="7961.27" y="-8508.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7961.27" y="-8493.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7961.27" y="-8478.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7961.27" y="-8463.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert12_up&#45;&gt;pp_stage0_layer0_expert12_activation -->
<g id="edge77" class="edge">
<title>pp_stage0_layer0_expert12_up&#45;&gt;pp_stage0_layer0_expert12_activation</title>
<path fill="none" stroke="black" d="M7961.27,-8609.99C7961.27,-8609.99 7961.27,-8534.25 7961.27,-8534.25"/>
<polygon fill="black" stroke="black" points="7964.77,-8534.25 7961.27,-8524.25 7957.77,-8534.25 7964.77,-8534.25"/>
</g>
<!-- pp_stage0_layer0_expert12_down -->
<g id="node64" class="node">
<title>pp_stage0_layer0_expert12_down</title>
<polygon fill="lightcoral" stroke="black" points="7857.77,-8336.16 7360.77,-8336.16 7360.77,-8268.16 7857.77,-8268.16 7857.77,-8336.16"/>
<text text-anchor="middle" x="7609.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="7609.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7609.27" y="-8290.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7609.27" y="-8275.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert12_activation&#45;&gt;pp_stage0_layer0_expert12_down -->
<g id="edge78" class="edge">
<title>pp_stage0_layer0_expert12_activation&#45;&gt;pp_stage0_layer0_expert12_down</title>
<path fill="none" stroke="black" d="M7783.02,-8456.12C7783.02,-8456.12 7783.02,-8346.27 7783.02,-8346.27"/>
<polygon fill="black" stroke="black" points="7786.52,-8346.27 7783.02,-8336.27 7779.52,-8346.27 7786.52,-8346.27"/>
</g>
<!-- pp_stage0_layer0_expert12_down&#45;&gt;pp_stage0_layer0_route_back_expert12 -->
<g id="edge79" class="edge">
<title>pp_stage0_layer0_expert12_down&#45;&gt;pp_stage0_layer0_route_back_expert12</title>
<path fill="none" stroke="black" d="M7740.38,-8267.96C7740.38,-8267.96 7740.38,-8097.84 7740.38,-8097.84"/>
<polygon fill="black" stroke="black" points="7743.88,-8097.84 7740.38,-8087.84 7736.88,-8097.84 7743.88,-8097.84"/>
</g>
<!-- pp_stage0_layer0_route_back_expert12&#45;&gt;pp_stage0_layer0_expert_agg -->
<g id="edge108" class="edge">
<title>pp_stage0_layer0_route_back_expert12&#45;&gt;pp_stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M8138.27,-8012.03C8138.27,-8012.03 8138.27,-7936.47 8138.27,-7936.47"/>
<polygon fill="black" stroke="black" points="8141.77,-7936.47 8138.27,-7926.47 8134.77,-7936.47 8141.77,-7936.47"/>
</g>
<!-- pp_stage0_layer0_expert13_activation -->
<g id="node67" class="node">
<title>pp_stage0_layer0_expert13_activation</title>
<polygon fill="lightyellow" stroke="black" points="9479.27,-8524.16 8973.27,-8524.16 8973.27,-8456.16 9479.27,-8456.16 9479.27,-8524.16"/>
<text text-anchor="middle" x="9226.27" y="-8508.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="9226.27" y="-8493.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9226.27" y="-8478.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9226.27" y="-8463.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert13_up&#45;&gt;pp_stage0_layer0_expert13_activation -->
<g id="edge82" class="edge">
<title>pp_stage0_layer0_expert13_up&#45;&gt;pp_stage0_layer0_expert13_activation</title>
<path fill="none" stroke="black" d="M9022.27,-8609.99C9022.27,-8609.99 9022.27,-8534.25 9022.27,-8534.25"/>
<polygon fill="black" stroke="black" points="9025.77,-8534.25 9022.27,-8524.25 9018.77,-8534.25 9025.77,-8534.25"/>
</g>
<!-- pp_stage0_layer0_expert13_down -->
<g id="node68" class="node">
<title>pp_stage0_layer0_expert13_down</title>
<polygon fill="lightcoral" stroke="black" points="9475.77,-8336.16 8978.77,-8336.16 8978.77,-8268.16 9475.77,-8268.16 9475.77,-8336.16"/>
<text text-anchor="middle" x="9227.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="9227.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9227.27" y="-8290.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9227.27" y="-8275.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert13_activation&#45;&gt;pp_stage0_layer0_expert13_down -->
<g id="edge83" class="edge">
<title>pp_stage0_layer0_expert13_activation&#45;&gt;pp_stage0_layer0_expert13_down</title>
<path fill="none" stroke="black" d="M9227.27,-8456.12C9227.27,-8456.12 9227.27,-8346.27 9227.27,-8346.27"/>
<polygon fill="black" stroke="black" points="9230.77,-8346.27 9227.27,-8336.27 9223.77,-8346.27 9230.77,-8346.27"/>
</g>
<!-- pp_stage0_layer0_expert13_down&#45;&gt;pp_stage0_layer0_route_back_expert13 -->
<g id="edge84" class="edge">
<title>pp_stage0_layer0_expert13_down&#45;&gt;pp_stage0_layer0_route_back_expert13</title>
<path fill="none" stroke="black" d="M9227.27,-8267.96C9227.27,-8267.96 9227.27,-8158.43 9227.27,-8158.43"/>
<polygon fill="black" stroke="black" points="9230.77,-8158.43 9227.27,-8148.43 9223.77,-8158.43 9230.77,-8158.43"/>
</g>
<!-- pp_stage0_layer0_route_back_expert13&#45;&gt;pp_stage0_layer0_expert_agg -->
<g id="edge109" class="edge">
<title>pp_stage0_layer0_route_back_expert13&#45;&gt;pp_stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M8851.02,-8012.03C8851.02,-7966.54 8851.02,-7915 8851.02,-7915 8851.02,-7915 8373.78,-7915 8373.78,-7915"/>
<polygon fill="black" stroke="black" points="8373.78,-7911.5 8363.78,-7915 8373.78,-7918.5 8373.78,-7911.5"/>
</g>
<!-- pp_stage0_layer0_expert14_activation -->
<g id="node71" class="node">
<title>pp_stage0_layer0_expert14_activation</title>
<polygon fill="lightyellow" stroke="black" points="10043.27,-8524.16 9537.27,-8524.16 9537.27,-8456.16 10043.27,-8456.16 10043.27,-8524.16"/>
<text text-anchor="middle" x="9790.27" y="-8508.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="9790.27" y="-8493.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9790.27" y="-8478.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9790.27" y="-8463.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert14_up&#45;&gt;pp_stage0_layer0_expert14_activation -->
<g id="edge87" class="edge">
<title>pp_stage0_layer0_expert14_up&#45;&gt;pp_stage0_layer0_expert14_activation</title>
<path fill="none" stroke="black" d="M9615.27,-8609.99C9615.27,-8609.99 9615.27,-8534.25 9615.27,-8534.25"/>
<polygon fill="black" stroke="black" points="9618.77,-8534.25 9615.27,-8524.25 9611.77,-8534.25 9618.77,-8534.25"/>
</g>
<!-- pp_stage0_layer0_expert14_down -->
<g id="node72" class="node">
<title>pp_stage0_layer0_expert14_down</title>
<polygon fill="lightcoral" stroke="black" points="10297.77,-8336.16 9800.77,-8336.16 9800.77,-8268.16 10297.77,-8268.16 10297.77,-8336.16"/>
<text text-anchor="middle" x="10049.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="10049.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10049.27" y="-8290.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10049.27" y="-8275.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert14_activation&#45;&gt;pp_stage0_layer0_expert14_down -->
<g id="edge88" class="edge">
<title>pp_stage0_layer0_expert14_activation&#45;&gt;pp_stage0_layer0_expert14_down</title>
<path fill="none" stroke="black" d="M9922.02,-8456.12C9922.02,-8456.12 9922.02,-8346.27 9922.02,-8346.27"/>
<polygon fill="black" stroke="black" points="9925.52,-8346.27 9922.02,-8336.27 9918.52,-8346.27 9925.52,-8346.27"/>
</g>
<!-- pp_stage0_layer0_expert14_down&#45;&gt;pp_stage0_layer0_route_back_expert14 -->
<g id="edge89" class="edge">
<title>pp_stage0_layer0_expert14_down&#45;&gt;pp_stage0_layer0_route_back_expert14</title>
<path fill="none" stroke="black" d="M10132.18,-8267.96C10132.18,-8267.96 10132.18,-8158.43 10132.18,-8158.43"/>
<polygon fill="black" stroke="black" points="10135.68,-8158.43 10132.18,-8148.43 10128.68,-8158.43 10135.68,-8158.43"/>
</g>
<!-- pp_stage0_layer0_route_back_expert14&#45;&gt;pp_stage0_layer0_expert_agg -->
<g id="edge110" class="edge">
<title>pp_stage0_layer0_route_back_expert14&#45;&gt;pp_stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M9991.13,-8012.05C9991.13,-7962.48 9991.13,-7904 9991.13,-7904 9991.13,-7904 8444.42,-7904 8444.42,-7904"/>
<polygon fill="black" stroke="black" points="8444.42,-7900.5 8434.42,-7904 8444.42,-7907.5 8444.42,-7900.5"/>
</g>
<!-- pp_stage0_layer0_expert15_activation -->
<g id="node75" class="node">
<title>pp_stage0_layer0_expert15_activation</title>
<polygon fill="lightyellow" stroke="black" points="10607.27,-8524.16 10101.27,-8524.16 10101.27,-8456.16 10607.27,-8456.16 10607.27,-8524.16"/>
<text text-anchor="middle" x="10354.27" y="-8508.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="10354.27" y="-8493.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10354.27" y="-8478.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10354.27" y="-8463.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert15_up&#45;&gt;pp_stage0_layer0_expert15_activation -->
<g id="edge92" class="edge">
<title>pp_stage0_layer0_expert15_up&#45;&gt;pp_stage0_layer0_expert15_activation</title>
<path fill="none" stroke="black" d="M10193.77,-8609.99C10193.77,-8609.99 10193.77,-8534.25 10193.77,-8534.25"/>
<polygon fill="black" stroke="black" points="10197.27,-8534.25 10193.77,-8524.25 10190.27,-8534.25 10197.27,-8534.25"/>
</g>
<!-- pp_stage0_layer0_expert15_down -->
<g id="node76" class="node">
<title>pp_stage0_layer0_expert15_down</title>
<polygon fill="lightcoral" stroke="black" points="11252.77,-8336.16 10755.77,-8336.16 10755.77,-8268.16 11252.77,-8268.16 11252.77,-8336.16"/>
<text text-anchor="middle" x="11004.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="11004.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11004.27" y="-8290.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11004.27" y="-8275.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_expert15_activation&#45;&gt;pp_stage0_layer0_expert15_down -->
<g id="edge93" class="edge">
<title>pp_stage0_layer0_expert15_activation&#45;&gt;pp_stage0_layer0_expert15_down</title>
<path fill="none" stroke="black" d="M10452.52,-8456.09C10452.52,-8401.87 10452.52,-8302 10452.52,-8302 10452.52,-8302 10745.43,-8302 10745.43,-8302"/>
<polygon fill="black" stroke="black" points="10745.43,-8305.5 10755.43,-8302 10745.43,-8298.5 10745.43,-8305.5"/>
</g>
<!-- pp_stage0_layer0_expert15_down&#45;&gt;pp_stage0_layer0_route_back_expert15 -->
<g id="edge94" class="edge">
<title>pp_stage0_layer0_expert15_down&#45;&gt;pp_stage0_layer0_route_back_expert15</title>
<path fill="none" stroke="black" d="M11131.84,-8267.96C11131.84,-8267.96 11131.84,-8158.43 11131.84,-8158.43"/>
<polygon fill="black" stroke="black" points="11135.34,-8158.43 11131.84,-8148.43 11128.34,-8158.43 11135.34,-8158.43"/>
</g>
<!-- pp_stage0_layer0_route_back_expert15&#45;&gt;pp_stage0_layer0_expert_agg -->
<g id="edge111" class="edge">
<title>pp_stage0_layer0_route_back_expert15&#45;&gt;pp_stage0_layer0_expert_agg</title>
<path fill="none" stroke="black" d="M11064.93,-8011.9C11064.93,-7958.77 11064.93,-7894 11064.93,-7894 11064.93,-7894 8480.08,-7894 8480.08,-7894"/>
<polygon fill="black" stroke="black" points="8480.08,-7890.5 8470.08,-7894 8480.08,-7897.5 8480.08,-7890.5"/>
</g>
<!-- pp_stage0_layer0_expert_agg&#45;&gt;pp_stage0_layer0_final_residual -->
<g id="edge113" class="edge">
<title>pp_stage0_layer0_expert_agg&#45;&gt;pp_stage0_layer0_final_residual</title>
<path fill="none" stroke="black" d="M7828.64,-7855.26C7828.64,-7806.19 7828.64,-7695 7828.64,-7695 7828.64,-7695 4681.53,-7695 4681.53,-7695"/>
<polygon fill="black" stroke="black" points="4681.53,-7691.5 4671.53,-7695 4681.53,-7698.5 4681.53,-7691.5"/>
</g>
<!-- pp_stage0_layer0_pipeline_comm -->
<g id="node80" class="node">
<title>pp_stage0_layer0_pipeline_comm</title>
<ellipse fill="lightblue" stroke="black" cx="4025.27" cy="-7513.75" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="4025.27" y="-7532.55" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="4025.27" y="-7517.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4025.27" y="-7502.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4025.27" y="-7487.55" font-family="Times,serif" font-size="14.00">GPU: GPU 1</text>
</g>
<!-- pp_stage0_layer0_final_residual&#45;&gt;pp_stage0_layer0_pipeline_comm -->
<g id="edge114" class="edge">
<title>pp_stage0_layer0_final_residual&#45;&gt;pp_stage0_layer0_pipeline_comm</title>
<path fill="none" stroke="black" d="M4025.27,-7647.58C4025.27,-7647.58 4025.27,-7572 4025.27,-7572"/>
<polygon fill="black" stroke="black" points="4028.77,-7572 4025.27,-7562 4021.77,-7572 4028.77,-7572"/>
</g>
<!-- pp_stage0_layer1_norm -->
<g id="node81" class="node">
<title>pp_stage0_layer1_norm</title>
<polygon fill="lightyellow" stroke="black" points="4558.77,-7379.67 4061.77,-7379.67 4061.77,-7311.67 4558.77,-7311.67 4558.77,-7379.67"/>
<text text-anchor="middle" x="4310.27" y="-7364.47" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="4310.27" y="-7349.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4310.27" y="-7334.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4310.27" y="-7319.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_pipeline_comm&#45;&gt;pp_stage0_layer1_norm -->
<g id="edge115" class="edge">
<title>pp_stage0_layer0_pipeline_comm&#45;&gt;pp_stage0_layer1_norm</title>
<path fill="none" stroke="black" d="M4219.23,-7473.49C4219.23,-7473.49 4219.23,-7389.92 4219.23,-7389.92"/>
<polygon fill="black" stroke="black" points="4222.73,-7389.92 4219.23,-7379.92 4215.73,-7389.92 4222.73,-7389.92"/>
</g>
<!-- pp_stage0_layer1_attn_residual -->
<g id="node89" class="node">
<title>pp_stage0_layer1_attn_residual</title>
<ellipse fill="lightblue" stroke="black" cx="4025.27" cy="-6407.58" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="4025.27" y="-6426.38" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4025.27" y="-6411.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096], [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4025.27" y="-6396.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4025.27" y="-6381.38" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer0_pipeline_comm&#45;&gt;pp_stage0_layer1_attn_residual -->
<g id="edge125" class="edge">
<title>pp_stage0_layer0_pipeline_comm&#45;&gt;pp_stage0_layer1_attn_residual</title>
<path fill="none" stroke="black" d="M3809.55,-7475.67C3809.55,-7475.67 3809.55,-6462.91 3809.55,-6462.91"/>
<polygon fill="black" stroke="black" points="3813.05,-6462.91 3809.55,-6452.91 3806.05,-6462.91 3813.05,-6462.91"/>
</g>
<!-- pp_stage0_layer1_q_proj -->
<g id="node82" class="node">
<title>pp_stage0_layer1_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="4682.27,-7225.67 4172.27,-7225.67 4172.27,-7157.67 4682.27,-7157.67 4682.27,-7225.67"/>
<text text-anchor="middle" x="4427.27" y="-7210.47" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4427.27" y="-7195.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4427.27" y="-7180.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4427.27" y="-7165.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_norm&#45;&gt;pp_stage0_layer1_q_proj -->
<g id="edge116" class="edge">
<title>pp_stage0_layer1_norm&#45;&gt;pp_stage0_layer1_q_proj</title>
<path fill="none" stroke="black" d="M4365.52,-7311.49C4365.52,-7311.49 4365.52,-7235.75 4365.52,-7235.75"/>
<polygon fill="black" stroke="black" points="4369.02,-7235.75 4365.52,-7225.75 4362.02,-7235.75 4369.02,-7235.75"/>
</g>
<!-- pp_stage0_layer1_k_proj -->
<g id="node83" class="node">
<title>pp_stage0_layer1_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="5250.27,-7225.67 4740.27,-7225.67 4740.27,-7157.67 5250.27,-7157.67 5250.27,-7225.67"/>
<text text-anchor="middle" x="4995.27" y="-7210.47" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4995.27" y="-7195.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4995.27" y="-7180.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4995.27" y="-7165.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_norm&#45;&gt;pp_stage0_layer1_k_proj -->
<g id="edge117" class="edge">
<title>pp_stage0_layer1_norm&#45;&gt;pp_stage0_layer1_k_proj</title>
<path fill="none" stroke="black" d="M4559.02,-7345C4754.97,-7345 4995.27,-7345 4995.27,-7345 4995.27,-7345 4995.27,-7235.7 4995.27,-7235.7"/>
<polygon fill="black" stroke="black" points="4998.77,-7235.7 4995.27,-7225.7 4991.77,-7235.7 4998.77,-7235.7"/>
</g>
<!-- pp_stage0_layer1_v_proj -->
<g id="node84" class="node">
<title>pp_stage0_layer1_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="4455.27,-7071.67 3945.27,-7071.67 3945.27,-7003.67 4455.27,-7003.67 4455.27,-7071.67"/>
<text text-anchor="middle" x="4200.27" y="-7056.47" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4200.27" y="-7041.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4200.27" y="-7026.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4200.27" y="-7011.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_norm&#45;&gt;pp_stage0_layer1_v_proj -->
<g id="edge118" class="edge">
<title>pp_stage0_layer1_norm&#45;&gt;pp_stage0_layer1_v_proj</title>
<path fill="none" stroke="black" d="M4117.02,-7311.53C4117.02,-7311.53 4117.02,-7081.96 4117.02,-7081.96"/>
<polygon fill="black" stroke="black" points="4120.52,-7081.96 4117.02,-7071.96 4113.52,-7081.96 4120.52,-7081.96"/>
</g>
<!-- pp_stage0_layer1_attn_scores -->
<g id="node85" class="node">
<title>pp_stage0_layer1_attn_scores</title>
<polygon fill="lightyellow" stroke="black" points="5061.27,-7071.67 4513.27,-7071.67 4513.27,-7003.67 5061.27,-7003.67 5061.27,-7071.67"/>
<text text-anchor="middle" x="4787.27" y="-7056.47" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="4787.27" y="-7041.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4787.27" y="-7026.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=32, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="4787.27" y="-7011.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_q_proj&#45;&gt;pp_stage0_layer1_attn_scores -->
<g id="edge119" class="edge">
<title>pp_stage0_layer1_q_proj&#45;&gt;pp_stage0_layer1_attn_scores</title>
<path fill="none" stroke="black" d="M4597.77,-7157.49C4597.77,-7157.49 4597.77,-7081.75 4597.77,-7081.75"/>
<polygon fill="black" stroke="black" points="4601.27,-7081.75 4597.77,-7071.75 4594.27,-7081.75 4601.27,-7081.75"/>
</g>
<!-- pp_stage0_layer1_k_proj&#45;&gt;pp_stage0_layer1_attn_scores -->
<g id="edge120" class="edge">
<title>pp_stage0_layer1_k_proj&#45;&gt;pp_stage0_layer1_attn_scores</title>
<path fill="none" stroke="black" d="M4900.77,-7157.49C4900.77,-7157.49 4900.77,-7081.75 4900.77,-7081.75"/>
<polygon fill="black" stroke="black" points="4904.27,-7081.75 4900.77,-7071.75 4897.27,-7081.75 4904.27,-7081.75"/>
</g>
<!-- pp_stage0_layer1_attn_out -->
<g id="node87" class="node">
<title>pp_stage0_layer1_attn_out</title>
<polygon fill="lightyellow" stroke="black" points="4481.27,-6763.67 3945.27,-6763.67 3945.27,-6695.67 4481.27,-6695.67 4481.27,-6763.67"/>
<text text-anchor="middle" x="4213.27" y="-6748.47" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="4213.27" y="-6733.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=32, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="4213.27" y="-6718.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4213.27" y="-6703.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_v_proj&#45;&gt;pp_stage0_layer1_attn_out -->
<g id="edge123" class="edge">
<title>pp_stage0_layer1_v_proj&#45;&gt;pp_stage0_layer1_attn_out</title>
<path fill="none" stroke="black" d="M4175.77,-7003.53C4175.77,-7003.53 4175.77,-6773.96 4175.77,-6773.96"/>
<polygon fill="black" stroke="black" points="4179.27,-6773.96 4175.77,-6763.96 4172.27,-6773.96 4179.27,-6773.96"/>
</g>
<!-- pp_stage0_layer1_softmax -->
<g id="node86" class="node">
<title>pp_stage0_layer1_softmax</title>
<polygon fill="lightyellow" stroke="black" points="4954.27,-6917.67 4406.27,-6917.67 4406.27,-6849.67 4954.27,-6849.67 4954.27,-6917.67"/>
<text text-anchor="middle" x="4680.27" y="-6902.47" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="4680.27" y="-6887.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=32, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="4680.27" y="-6872.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=32, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="4680.27" y="-6857.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_attn_scores&#45;&gt;pp_stage0_layer1_softmax -->
<g id="edge121" class="edge">
<title>pp_stage0_layer1_attn_scores&#45;&gt;pp_stage0_layer1_softmax</title>
<path fill="none" stroke="black" d="M4733.77,-7003.49C4733.77,-7003.49 4733.77,-6927.75 4733.77,-6927.75"/>
<polygon fill="black" stroke="black" points="4737.27,-6927.75 4733.77,-6917.75 4730.27,-6927.75 4737.27,-6927.75"/>
</g>
<!-- pp_stage0_layer1_softmax&#45;&gt;pp_stage0_layer1_attn_out -->
<g id="edge122" class="edge">
<title>pp_stage0_layer1_softmax&#45;&gt;pp_stage0_layer1_attn_out</title>
<path fill="none" stroke="black" d="M4443.77,-6849.49C4443.77,-6849.49 4443.77,-6773.75 4443.77,-6773.75"/>
<polygon fill="black" stroke="black" points="4447.27,-6773.75 4443.77,-6763.75 4440.27,-6773.75 4447.27,-6773.75"/>
</g>
<!-- pp_stage0_layer1_out_proj -->
<g id="node88" class="node">
<title>pp_stage0_layer1_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="4452.27,-6609.67 3954.27,-6609.67 3954.27,-6541.67 4452.27,-6541.67 4452.27,-6609.67"/>
<text text-anchor="middle" x="4203.27" y="-6594.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4203.27" y="-6579.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4203.27" y="-6564.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4203.27" y="-6549.47" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_attn_out&#45;&gt;pp_stage0_layer1_out_proj -->
<g id="edge124" class="edge">
<title>pp_stage0_layer1_attn_out&#45;&gt;pp_stage0_layer1_out_proj</title>
<path fill="none" stroke="black" d="M4203.27,-6695.49C4203.27,-6695.49 4203.27,-6619.75 4203.27,-6619.75"/>
<polygon fill="black" stroke="black" points="4206.77,-6619.75 4203.27,-6609.75 4199.77,-6619.75 4206.77,-6619.75"/>
</g>
<!-- pp_stage0_layer1_out_proj&#45;&gt;pp_stage0_layer1_attn_residual -->
<g id="edge126" class="edge">
<title>pp_stage0_layer1_out_proj&#45;&gt;pp_stage0_layer1_attn_residual</title>
<path fill="none" stroke="black" d="M4203.27,-6541.65C4203.27,-6541.65 4203.27,-6463.97 4203.27,-6463.97"/>
<polygon fill="black" stroke="black" points="4206.77,-6463.97 4203.27,-6453.97 4199.77,-6463.97 4206.77,-6463.97"/>
</g>
<!-- pp_stage0_layer1_moe_norm -->
<g id="node90" class="node">
<title>pp_stage0_layer1_moe_norm</title>
<polygon fill="lightyellow" stroke="black" points="8714.77,-6273.5 8217.77,-6273.5 8217.77,-6205.5 8714.77,-6205.5 8714.77,-6273.5"/>
<text text-anchor="middle" x="8466.27" y="-6258.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="8466.27" y="-6243.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8466.27" y="-6228.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8466.27" y="-6213.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_attn_residual&#45;&gt;pp_stage0_layer1_moe_norm -->
<g id="edge127" class="edge">
<title>pp_stage0_layer1_attn_residual&#45;&gt;pp_stage0_layer1_moe_norm</title>
<path fill="none" stroke="black" d="M4611.91,-6387.15C4611.91,-6347.73 4611.91,-6265 4611.91,-6265 4611.91,-6265 8207.45,-6265 8207.45,-6265"/>
<polygon fill="black" stroke="black" points="8207.45,-6268.5 8217.45,-6265 8207.45,-6261.5 8207.45,-6268.5"/>
</g>
<!-- pp_stage0_layer1_final_residual -->
<g id="node157" class="node">
<title>pp_stage0_layer1_final_residual</title>
<ellipse fill="lightblue" stroke="black" cx="4285.27" cy="-5137.25" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="4285.27" y="-5156.05" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="4285.27" y="-5141.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096], [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4285.27" y="-5126.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4285.27" y="-5111.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_attn_residual&#45;&gt;pp_stage0_layer1_final_residual -->
<g id="edge225" class="edge">
<title>pp_stage0_layer1_attn_residual&#45;&gt;pp_stage0_layer1_final_residual</title>
<path fill="none" stroke="black" d="M4185.27,-6360.86C4185.27,-6227.4 4185.27,-5854 4185.27,-5854 4185.27,-5854 4586.77,-5854 4586.77,-5854 4586.77,-5854 4586.77,-5189.94 4586.77,-5189.94"/>
<polygon fill="black" stroke="black" points="4590.27,-5189.94 4586.77,-5179.94 4583.27,-5189.94 4590.27,-5189.94"/>
</g>
<!-- pp_stage0_layer1_gate -->
<g id="node91" class="node">
<title>pp_stage0_layer1_gate</title>
<polygon fill="lightpink" stroke="black" points="9180.92,-5811.5 8381.31,-5811.5 8175.62,-5675.5 8975.22,-5675.5 9180.92,-5811.5"/>
<text text-anchor="middle" x="8678.27" y="-5762.3" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="8678.27" y="-5747.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8678.27" y="-5732.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="8678.27" y="-5717.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_gate -->
<g id="edge128" class="edge">
<title>pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_gate</title>
<path fill="none" stroke="black" d="M8594.43,-6205.41C8594.43,-6205.41 8594.43,-5821.69 8594.43,-5821.69"/>
<polygon fill="black" stroke="black" points="8597.93,-5821.69 8594.43,-5811.69 8590.93,-5821.69 8597.93,-5821.69"/>
</g>
<!-- pp_stage0_layer1_expert0_up -->
<g id="node92" class="node">
<title>pp_stage0_layer1_expert0_up</title>
<polygon fill="lightcoral" stroke="black" points="11402.27,-6119.5 10896.27,-6119.5 10896.27,-6051.5 11402.27,-6051.5 11402.27,-6119.5"/>
<text text-anchor="middle" x="11149.27" y="-6104.3" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="11149.27" y="-6089.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11149.27" y="-6074.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11149.27" y="-6059.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert0_up -->
<g id="edge129" class="edge">
<title>pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert0_up</title>
<path fill="none" stroke="black" d="M8714.89,-6230C9394.63,-6230 11233.6,-6230 11233.6,-6230 11233.6,-6230 11233.6,-6129.74 11233.6,-6129.74"/>
<polygon fill="black" stroke="black" points="11237.1,-6129.74 11233.6,-6119.74 11230.1,-6129.74 11237.1,-6129.74"/>
</g>
<!-- pp_stage0_layer1_expert1_up -->
<g id="node96" class="node">
<title>pp_stage0_layer1_expert1_up</title>
<polygon fill="lightcoral" stroke="black" points="11982.27,-6119.5 11476.27,-6119.5 11476.27,-6051.5 11982.27,-6051.5 11982.27,-6119.5"/>
<text text-anchor="middle" x="11729.27" y="-6104.3" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="11729.27" y="-6089.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11729.27" y="-6074.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11729.27" y="-6059.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert1_up -->
<g id="edge134" class="edge">
<title>pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert1_up</title>
<path fill="none" stroke="black" d="M8714.85,-6239C9472.02,-6239 11698.4,-6239 11698.4,-6239 11698.4,-6239 11698.4,-6129.57 11698.4,-6129.57"/>
<polygon fill="black" stroke="black" points="11701.9,-6129.57 11698.4,-6119.57 11694.9,-6129.57 11701.9,-6129.57"/>
</g>
<!-- pp_stage0_layer1_expert2_up -->
<g id="node100" class="node">
<title>pp_stage0_layer1_expert2_up</title>
<polygon fill="lightcoral" stroke="black" points="12554.27,-6119.5 12048.27,-6119.5 12048.27,-6051.5 12554.27,-6051.5 12554.27,-6119.5"/>
<text text-anchor="middle" x="12301.27" y="-6104.3" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="12301.27" y="-6089.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12301.27" y="-6074.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12301.27" y="-6059.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert2_up -->
<g id="edge139" class="edge">
<title>pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert2_up</title>
<path fill="none" stroke="black" d="M8714.94,-6247C9564.75,-6247 12301.27,-6247 12301.27,-6247 12301.27,-6247 12301.27,-6129.75 12301.27,-6129.75"/>
<polygon fill="black" stroke="black" points="12304.77,-6129.75 12301.27,-6119.75 12297.77,-6129.75 12304.77,-6129.75"/>
</g>
<!-- pp_stage0_layer1_expert3_up -->
<g id="node104" class="node">
<title>pp_stage0_layer1_expert3_up</title>
<polygon fill="lightcoral" stroke="black" points="13603.27,-6119.5 13097.27,-6119.5 13097.27,-6051.5 13603.27,-6051.5 13603.27,-6119.5"/>
<text text-anchor="middle" x="13350.27" y="-6104.3" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="13350.27" y="-6089.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13350.27" y="-6074.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="13350.27" y="-6059.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert3_up -->
<g id="edge144" class="edge">
<title>pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert3_up</title>
<path fill="none" stroke="black" d="M8715.18,-6256C9710.44,-6256 13350.27,-6256 13350.27,-6256 13350.27,-6256 13350.27,-6129.59 13350.27,-6129.59"/>
<polygon fill="black" stroke="black" points="13353.77,-6129.59 13350.27,-6119.59 13346.77,-6129.59 13353.77,-6129.59"/>
</g>
<!-- pp_stage0_layer1_expert4_up -->
<g id="node108" class="node">
<title>pp_stage0_layer1_expert4_up</title>
<polygon fill="lightcoral" stroke="black" points="14409.27,-6119.5 13903.27,-6119.5 13903.27,-6051.5 14409.27,-6051.5 14409.27,-6119.5"/>
<text text-anchor="middle" x="14156.27" y="-6104.3" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="14156.27" y="-6089.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14156.27" y="-6074.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="14156.27" y="-6059.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert4_up -->
<g id="edge149" class="edge">
<title>pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert4_up</title>
<path fill="none" stroke="black" d="M8714.83,-6264C9791.77,-6264 14000.9,-6264 14000.9,-6264 14000.9,-6264 14000.9,-6129.92 14000.9,-6129.92"/>
<polygon fill="black" stroke="black" points="14004.4,-6129.92 14000.9,-6119.92 13997.4,-6129.92 14004.4,-6129.92"/>
</g>
<!-- pp_stage0_layer1_expert5_up -->
<g id="node112" class="node">
<title>pp_stage0_layer1_expert5_up</title>
<polygon fill="lightcoral" stroke="black" points="2915.27,-6119.5 2409.27,-6119.5 2409.27,-6051.5 2915.27,-6051.5 2915.27,-6119.5"/>
<text text-anchor="middle" x="2662.27" y="-6104.3" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="2662.27" y="-6089.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2662.27" y="-6074.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="2662.27" y="-6059.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert5_up -->
<g id="edge154" class="edge">
<title>pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert5_up</title>
<path fill="none" stroke="black" d="M8217.34,-6258C7107.19,-6258 2662.27,-6258 2662.27,-6258 2662.27,-6258 2662.27,-6129.58 2662.27,-6129.58"/>
<polygon fill="black" stroke="black" points="2665.77,-6129.58 2662.27,-6119.58 2658.77,-6129.58 2665.77,-6129.58"/>
</g>
<!-- pp_stage0_layer1_expert6_up -->
<g id="node116" class="node">
<title>pp_stage0_layer1_expert6_up</title>
<polygon fill="lightcoral" stroke="black" points="4156.27,-6119.5 3650.27,-6119.5 3650.27,-6051.5 4156.27,-6051.5 4156.27,-6119.5"/>
<text text-anchor="middle" x="3903.27" y="-6104.3" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="3903.27" y="-6089.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3903.27" y="-6074.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="3903.27" y="-6059.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert6_up -->
<g id="edge159" class="edge">
<title>pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert6_up</title>
<path fill="none" stroke="black" d="M8217.7,-6250C7265.5,-6250 3903.27,-6250 3903.27,-6250 3903.27,-6250 3903.27,-6129.58 3903.27,-6129.58"/>
<polygon fill="black" stroke="black" points="3906.77,-6129.58 3903.27,-6119.58 3899.77,-6129.58 3906.77,-6129.58"/>
</g>
<!-- pp_stage0_layer1_expert7_up -->
<g id="node120" class="node">
<title>pp_stage0_layer1_expert7_up</title>
<polygon fill="lightcoral" stroke="black" points="5058.27,-6119.5 4552.27,-6119.5 4552.27,-6051.5 5058.27,-6051.5 5058.27,-6119.5"/>
<text text-anchor="middle" x="4805.27" y="-6104.3" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="4805.27" y="-6089.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4805.27" y="-6074.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="4805.27" y="-6059.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert7_up -->
<g id="edge164" class="edge">
<title>pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert7_up</title>
<path fill="none" stroke="black" d="M8217.43,-6243C7424.08,-6243 5006.27,-6243 5006.27,-6243 5006.27,-6243 5006.27,-6129.67 5006.27,-6129.67"/>
<polygon fill="black" stroke="black" points="5009.77,-6129.67 5006.27,-6119.67 5002.77,-6129.67 5009.77,-6129.67"/>
</g>
<!-- pp_stage0_layer1_expert8_up -->
<g id="node124" class="node">
<title>pp_stage0_layer1_expert8_up</title>
<polygon fill="lightcoral" stroke="black" points="5791.27,-6119.5 5285.27,-6119.5 5285.27,-6051.5 5791.27,-6051.5 5791.27,-6119.5"/>
<text text-anchor="middle" x="5538.27" y="-6104.3" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="5538.27" y="-6089.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5538.27" y="-6074.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="5538.27" y="-6059.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert8_up -->
<g id="edge169" class="edge">
<title>pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert8_up</title>
<path fill="none" stroke="black" d="M8217.56,-6235C7523.86,-6235 5618.13,-6235 5618.13,-6235 5618.13,-6235 5618.13,-6129.8 5618.13,-6129.8"/>
<polygon fill="black" stroke="black" points="5621.63,-6129.8 5618.13,-6119.8 5614.63,-6129.8 5621.63,-6129.8"/>
</g>
<!-- pp_stage0_layer1_expert9_up -->
<g id="node128" class="node">
<title>pp_stage0_layer1_expert9_up</title>
<polygon fill="lightcoral" stroke="black" points="6440.27,-6119.5 5934.27,-6119.5 5934.27,-6051.5 6440.27,-6051.5 6440.27,-6119.5"/>
<text text-anchor="middle" x="6187.27" y="-6104.3" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="6187.27" y="-6089.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6187.27" y="-6074.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="6187.27" y="-6059.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert9_up -->
<g id="edge174" class="edge">
<title>pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert9_up</title>
<path fill="none" stroke="black" d="M8217.76,-6228C7626.93,-6228 6187.27,-6228 6187.27,-6228 6187.27,-6228 6187.27,-6129.63 6187.27,-6129.63"/>
<polygon fill="black" stroke="black" points="6190.77,-6129.63 6187.27,-6119.63 6183.77,-6129.63 6190.77,-6129.63"/>
</g>
<!-- pp_stage0_layer1_expert10_up -->
<g id="node132" class="node">
<title>pp_stage0_layer1_expert10_up</title>
<polygon fill="lightcoral" stroke="black" points="7232.27,-6119.5 6726.27,-6119.5 6726.27,-6051.5 7232.27,-6051.5 7232.27,-6119.5"/>
<text text-anchor="middle" x="6979.27" y="-6104.3" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="6979.27" y="-6089.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6979.27" y="-6074.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="6979.27" y="-6059.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert10_up -->
<g id="edge179" class="edge">
<title>pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert10_up</title>
<path fill="none" stroke="black" d="M8217.38,-6220C7794.06,-6220 6979.27,-6220 6979.27,-6220 6979.27,-6220 6979.27,-6129.79 6979.27,-6129.79"/>
<polygon fill="black" stroke="black" points="6982.77,-6129.79 6979.27,-6119.79 6975.77,-6129.79 6982.77,-6129.79"/>
</g>
<!-- pp_stage0_layer1_expert11_up -->
<g id="node136" class="node">
<title>pp_stage0_layer1_expert11_up</title>
<polygon fill="lightcoral" stroke="black" points="7912.27,-6119.5 7406.27,-6119.5 7406.27,-6051.5 7912.27,-6051.5 7912.27,-6119.5"/>
<text text-anchor="middle" x="7659.27" y="-6104.3" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="7659.27" y="-6089.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7659.27" y="-6074.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7659.27" y="-6059.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert11_up -->
<g id="edge184" class="edge">
<title>pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert11_up</title>
<path fill="none" stroke="black" d="M8217.47,-6213C8054.1,-6213 7870.46,-6213 7870.46,-6213 7870.46,-6213 7870.46,-6129.67 7870.46,-6129.67"/>
<polygon fill="black" stroke="black" points="7873.96,-6129.67 7870.46,-6119.67 7866.96,-6129.67 7873.96,-6129.67"/>
</g>
<!-- pp_stage0_layer1_expert12_up -->
<g id="node140" class="node">
<title>pp_stage0_layer1_expert12_up</title>
<polygon fill="lightcoral" stroke="black" points="8534.27,-6119.5 8028.27,-6119.5 8028.27,-6051.5 8534.27,-6051.5 8534.27,-6119.5"/>
<text text-anchor="middle" x="8281.27" y="-6104.3" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="8281.27" y="-6089.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8281.27" y="-6074.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="8281.27" y="-6059.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert12_up -->
<g id="edge189" class="edge">
<title>pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert12_up</title>
<path fill="none" stroke="black" d="M8376.02,-6205.32C8376.02,-6205.32 8376.02,-6129.58 8376.02,-6129.58"/>
<polygon fill="black" stroke="black" points="8379.52,-6129.58 8376.02,-6119.58 8372.52,-6129.58 8379.52,-6129.58"/>
</g>
<!-- pp_stage0_layer1_expert13_up -->
<g id="node144" class="node">
<title>pp_stage0_layer1_expert13_up</title>
<polygon fill="lightcoral" stroke="black" points="9493.27,-6119.5 8987.27,-6119.5 8987.27,-6051.5 9493.27,-6051.5 9493.27,-6119.5"/>
<text text-anchor="middle" x="9240.27" y="-6104.3" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="9240.27" y="-6089.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9240.27" y="-6074.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9240.27" y="-6059.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert13_up -->
<g id="edge194" class="edge">
<title>pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert13_up</title>
<path fill="none" stroke="black" d="M8654.6,-6205.21C8654.6,-6159.69 8654.6,-6085 8654.6,-6085 8654.6,-6085 8977.22,-6085 8977.22,-6085"/>
<polygon fill="black" stroke="black" points="8977.22,-6088.5 8987.22,-6085 8977.22,-6081.5 8977.22,-6088.5"/>
</g>
<!-- pp_stage0_layer1_expert14_up -->
<g id="node148" class="node">
<title>pp_stage0_layer1_expert14_up</title>
<polygon fill="lightcoral" stroke="black" points="10181.27,-6119.5 9675.27,-6119.5 9675.27,-6051.5 10181.27,-6051.5 10181.27,-6119.5"/>
<text text-anchor="middle" x="9928.27" y="-6104.3" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="9928.27" y="-6089.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9928.27" y="-6074.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9928.27" y="-6059.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert14_up -->
<g id="edge199" class="edge">
<title>pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert14_up</title>
<path fill="none" stroke="black" d="M8715.12,-6213C9077.81,-6213 9708.9,-6213 9708.9,-6213 9708.9,-6213 9708.9,-6129.67 9708.9,-6129.67"/>
<polygon fill="black" stroke="black" points="9712.4,-6129.67 9708.9,-6119.67 9705.4,-6129.67 9712.4,-6129.67"/>
</g>
<!-- pp_stage0_layer1_expert15_up -->
<g id="node152" class="node">
<title>pp_stage0_layer1_expert15_up</title>
<polygon fill="lightcoral" stroke="black" points="10807.27,-6119.5 10301.27,-6119.5 10301.27,-6051.5 10807.27,-6051.5 10807.27,-6119.5"/>
<text text-anchor="middle" x="10554.27" y="-6104.3" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="10554.27" y="-6089.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10554.27" y="-6074.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10554.27" y="-6059.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert15_up -->
<g id="edge204" class="edge">
<title>pp_stage0_layer1_moe_norm&#45;&gt;pp_stage0_layer1_expert15_up</title>
<path fill="none" stroke="black" d="M8715.02,-6222C9268.68,-6222 10554.27,-6222 10554.27,-6222 10554.27,-6222 10554.27,-6129.59 10554.27,-6129.59"/>
<polygon fill="black" stroke="black" points="10557.77,-6129.59 10554.27,-6119.59 10550.77,-6129.59 10557.77,-6129.59"/>
</g>
<!-- pp_stage0_layer1_route_back_expert0 -->
<g id="node95" class="node">
<title>pp_stage0_layer1_route_back_expert0</title>
<polygon fill="lightpink" stroke="black" points="13269.3,-5589.5 12450,-5589.5 12239.23,-5453.5 13058.54,-5453.5 13269.3,-5589.5"/>
<text text-anchor="middle" x="12754.27" y="-5540.3" font-family="Times,serif" font-size="14.00">Route Back Expert 0</text>
<text text-anchor="middle" x="12754.27" y="-5525.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12754.27" y="-5510.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12754.27" y="-5495.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert0 -->
<g id="edge133" class="edge">
<title>pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8994.22,-5688C9882.51,-5688 12337.59,-5688 12337.59,-5688 12337.59,-5688 12337.59,-5531.62 12337.59,-5531.62"/>
<polygon fill="black" stroke="black" points="12341.09,-5531.62 12337.59,-5521.62 12334.09,-5531.62 12341.09,-5531.62"/>
</g>
<!-- pp_stage0_layer1_route_back_expert1 -->
<g id="node99" class="node">
<title>pp_stage0_layer1_route_back_expert1</title>
<polygon fill="lightpink" stroke="black" points="14358.3,-5589.5 13539,-5589.5 13328.23,-5453.5 14147.54,-5453.5 14358.3,-5589.5"/>
<text text-anchor="middle" x="13843.27" y="-5540.3" font-family="Times,serif" font-size="14.00">Route Back Expert 1</text>
<text text-anchor="middle" x="13843.27" y="-5525.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13843.27" y="-5510.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13843.27" y="-5495.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert1 -->
<g id="edge138" class="edge">
<title>pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9000.62,-5692C10067.37,-5692 13415.59,-5692 13415.59,-5692 13415.59,-5692 13415.59,-5531.62 13415.59,-5531.62"/>
<polygon fill="black" stroke="black" points="13419.09,-5531.62 13415.59,-5521.62 13412.09,-5531.62 13419.09,-5531.62"/>
</g>
<!-- pp_stage0_layer1_route_back_expert2 -->
<g id="node103" class="node">
<title>pp_stage0_layer1_route_back_expert2</title>
<polygon fill="lightpink" stroke="black" points="15447.3,-5589.5 14628,-5589.5 14417.23,-5453.5 15236.54,-5453.5 15447.3,-5589.5"/>
<text text-anchor="middle" x="14932.27" y="-5540.3" font-family="Times,serif" font-size="14.00">Route Back Expert 2</text>
<text text-anchor="middle" x="14932.27" y="-5525.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14932.27" y="-5510.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14932.27" y="-5495.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert2 -->
<g id="edge143" class="edge">
<title>pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9006.31,-5696C10235.56,-5696 14498.92,-5696 14498.92,-5696 14498.92,-5696 14498.92,-5531.63 14498.92,-5531.63"/>
<polygon fill="black" stroke="black" points="14502.42,-5531.63 14498.92,-5521.63 14495.42,-5531.63 14502.42,-5531.63"/>
</g>
<!-- pp_stage0_layer1_route_back_expert3 -->
<g id="node107" class="node">
<title>pp_stage0_layer1_route_back_expert3</title>
<polygon fill="lightpink" stroke="black" points="16536.3,-5589.5 15717,-5589.5 15506.23,-5453.5 16325.54,-5453.5 16536.3,-5589.5"/>
<text text-anchor="middle" x="16021.27" y="-5540.3" font-family="Times,serif" font-size="14.00">Route Back Expert 3</text>
<text text-anchor="middle" x="16021.27" y="-5525.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16021.27" y="-5510.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16021.27" y="-5495.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert3 -->
<g id="edge148" class="edge">
<title>pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9012.28,-5700C10393.3,-5700 15585.26,-5700 15585.26,-5700 15585.26,-5700 15585.26,-5531.63 15585.26,-5531.63"/>
<polygon fill="black" stroke="black" points="15588.76,-5531.63 15585.26,-5521.63 15581.76,-5531.63 15588.76,-5531.63"/>
</g>
<!-- pp_stage0_layer1_route_back_expert4 -->
<g id="node111" class="node">
<title>pp_stage0_layer1_route_back_expert4</title>
<polygon fill="lightpink" stroke="black" points="17625.3,-5589.5 16806,-5589.5 16595.23,-5453.5 17414.54,-5453.5 17625.3,-5589.5"/>
<text text-anchor="middle" x="17110.27" y="-5540.3" font-family="Times,serif" font-size="14.00">Route Back Expert 4</text>
<text text-anchor="middle" x="17110.27" y="-5525.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17110.27" y="-5510.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17110.27" y="-5495.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert4 -->
<g id="edge153" class="edge">
<title>pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9019.87,-5705C10546.89,-5705 16672.92,-5705 16672.92,-5705 16672.92,-5705 16672.92,-5531.63 16672.92,-5531.63"/>
<polygon fill="black" stroke="black" points="16676.42,-5531.63 16672.92,-5521.63 16669.42,-5531.63 16676.42,-5531.63"/>
</g>
<!-- pp_stage0_layer1_route_back_expert5 -->
<g id="node115" class="node">
<title>pp_stage0_layer1_route_back_expert5</title>
<polygon fill="lightpink" stroke="black" points="1290.3,-5589.5 471,-5589.5 260.23,-5453.5 1079.54,-5453.5 1290.3,-5589.5"/>
<text text-anchor="middle" x="775.27" y="-5540.3" font-family="Times,serif" font-size="14.00">Route Back Expert 5</text>
<text text-anchor="middle" x="775.27" y="-5525.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="775.27" y="-5510.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="775.27" y="-5495.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert5 -->
<g id="edge158" class="edge">
<title>pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8220.05,-5705C6592.91,-5705 1189.77,-5705 1189.77,-5705 1189.77,-5705 1189.77,-5599.57 1189.77,-5599.57"/>
<polygon fill="black" stroke="black" points="1193.27,-5599.57 1189.77,-5589.57 1186.27,-5599.57 1193.27,-5599.57"/>
</g>
<!-- pp_stage0_layer1_route_back_expert6 -->
<g id="node119" class="node">
<title>pp_stage0_layer1_route_back_expert6</title>
<polygon fill="lightpink" stroke="black" points="2379.3,-5589.5 1560,-5589.5 1349.23,-5453.5 2168.54,-5453.5 2379.3,-5589.5"/>
<text text-anchor="middle" x="1864.27" y="-5540.3" font-family="Times,serif" font-size="14.00">Route Back Expert 6</text>
<text text-anchor="middle" x="1864.27" y="-5525.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1864.27" y="-5510.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1864.27" y="-5495.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert6 -->
<g id="edge163" class="edge">
<title>pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8212.38,-5700C6743.01,-5700 2302.94,-5700 2302.94,-5700 2302.94,-5700 2302.94,-5599.75 2302.94,-5599.75"/>
<polygon fill="black" stroke="black" points="2306.44,-5599.75 2302.94,-5589.75 2299.44,-5599.75 2306.44,-5599.75"/>
</g>
<!-- pp_stage0_layer1_route_back_expert7 -->
<g id="node123" class="node">
<title>pp_stage0_layer1_route_back_expert7</title>
<polygon fill="lightpink" stroke="black" points="3468.3,-5589.5 2649,-5589.5 2438.23,-5453.5 3257.54,-5453.5 3468.3,-5589.5"/>
<text text-anchor="middle" x="2953.27" y="-5540.3" font-family="Times,serif" font-size="14.00">Route Back Expert 7</text>
<text text-anchor="middle" x="2953.27" y="-5525.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2953.27" y="-5510.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2953.27" y="-5495.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert7 -->
<g id="edge168" class="edge">
<title>pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8206.54,-5696C6895.35,-5696 3302.94,-5696 3302.94,-5696 3302.94,-5696 3302.94,-5599.72 3302.94,-5599.72"/>
<polygon fill="black" stroke="black" points="3306.44,-5599.72 3302.94,-5589.72 3299.44,-5599.72 3306.44,-5599.72"/>
</g>
<!-- pp_stage0_layer1_route_back_expert8 -->
<g id="node127" class="node">
<title>pp_stage0_layer1_route_back_expert8</title>
<polygon fill="lightpink" stroke="black" points="4557.3,-5589.5 3738,-5589.5 3527.23,-5453.5 4346.54,-5453.5 4557.3,-5589.5"/>
<text text-anchor="middle" x="4042.27" y="-5540.3" font-family="Times,serif" font-size="14.00">Route Back Expert 8</text>
<text text-anchor="middle" x="4042.27" y="-5525.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4042.27" y="-5510.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4042.27" y="-5495.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert8 -->
<g id="edge173" class="edge">
<title>pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8200.51,-5692C7111.29,-5692 4537.65,-5692 4537.65,-5692 4537.65,-5692 4537.65,-5531.62 4537.65,-5531.62"/>
<polygon fill="black" stroke="black" points="4541.15,-5531.62 4537.65,-5521.62 4534.15,-5531.62 4541.15,-5531.62"/>
</g>
<!-- pp_stage0_layer1_route_back_expert9 -->
<g id="node131" class="node">
<title>pp_stage0_layer1_route_back_expert9</title>
<polygon fill="lightpink" stroke="black" points="5646.3,-5589.5 4827,-5589.5 4616.23,-5453.5 5435.54,-5453.5 5646.3,-5589.5"/>
<text text-anchor="middle" x="5131.27" y="-5540.3" font-family="Times,serif" font-size="14.00">Route Back Expert 9</text>
<text text-anchor="middle" x="5131.27" y="-5525.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5131.27" y="-5510.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5131.27" y="-5495.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert9 -->
<g id="edge178" class="edge">
<title>pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8194.35,-5688C7320.8,-5688 5570.28,-5688 5570.28,-5688 5570.28,-5688 5570.28,-5599.7 5570.28,-5599.7"/>
<polygon fill="black" stroke="black" points="5573.78,-5599.7 5570.28,-5589.7 5566.78,-5599.7 5573.78,-5599.7"/>
</g>
<!-- pp_stage0_layer1_route_back_expert10 -->
<g id="node135" class="node">
<title>pp_stage0_layer1_route_back_expert10</title>
<polygon fill="lightpink" stroke="black" points="6735.3,-5589.5 5916,-5589.5 5705.23,-5453.5 6524.54,-5453.5 6735.3,-5589.5"/>
<text text-anchor="middle" x="6220.27" y="-5540.3" font-family="Times,serif" font-size="14.00">Route Back Expert 10</text>
<text text-anchor="middle" x="6220.27" y="-5525.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6220.27" y="-5510.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6220.27" y="-5495.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert10 -->
<g id="edge183" class="edge">
<title>pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8186.7,-5683C7563.8,-5683 6570.28,-5683 6570.28,-5683 6570.28,-5683 6570.28,-5599.52 6570.28,-5599.52"/>
<polygon fill="black" stroke="black" points="6573.78,-5599.52 6570.28,-5589.52 6566.78,-5599.52 6573.78,-5599.52"/>
</g>
<!-- pp_stage0_layer1_route_back_expert11 -->
<g id="node139" class="node">
<title>pp_stage0_layer1_route_back_expert11</title>
<polygon fill="lightpink" stroke="black" points="7824.3,-5589.5 7005,-5589.5 6794.23,-5453.5 7613.54,-5453.5 7824.3,-5589.5"/>
<text text-anchor="middle" x="7309.27" y="-5540.3" font-family="Times,serif" font-size="14.00">Route Back Expert 11</text>
<text text-anchor="middle" x="7309.27" y="-5525.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7309.27" y="-5510.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7309.27" y="-5495.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert11 -->
<g id="edge188" class="edge">
<title>pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8180.87,-5679C7948.67,-5679 7722.65,-5679 7722.65,-5679 7722.65,-5679 7722.65,-5599.67 7722.65,-5599.67"/>
<polygon fill="black" stroke="black" points="7726.15,-5599.66 7722.65,-5589.67 7719.15,-5599.67 7726.15,-5599.66"/>
</g>
<!-- pp_stage0_layer1_route_back_expert12 -->
<g id="node143" class="node">
<title>pp_stage0_layer1_route_back_expert12</title>
<polygon fill="lightpink" stroke="black" points="8913.3,-5589.5 8094,-5589.5 7883.23,-5453.5 8702.54,-5453.5 8913.3,-5589.5"/>
<text text-anchor="middle" x="8398.27" y="-5540.3" font-family="Times,serif" font-size="14.00">Route Back Expert 12</text>
<text text-anchor="middle" x="8398.27" y="-5525.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8398.27" y="-5510.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8398.27" y="-5495.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert12 -->
<g id="edge193" class="edge">
<title>pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8544.49,-5675.38C8544.49,-5675.38 8544.49,-5599.87 8544.49,-5599.87"/>
<polygon fill="black" stroke="black" points="8547.99,-5599.87 8544.49,-5589.87 8540.99,-5599.87 8547.99,-5599.87"/>
</g>
<!-- pp_stage0_layer1_route_back_expert13 -->
<g id="node147" class="node">
<title>pp_stage0_layer1_route_back_expert13</title>
<polygon fill="lightpink" stroke="black" points="10002.3,-5589.5 9183,-5589.5 8972.23,-5453.5 9791.54,-5453.5 10002.3,-5589.5"/>
<text text-anchor="middle" x="9487.27" y="-5540.3" font-family="Times,serif" font-size="14.00">Route Back Expert 13</text>
<text text-anchor="middle" x="9487.27" y="-5525.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9487.27" y="-5510.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9487.27" y="-5495.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert13 -->
<g id="edge198" class="edge">
<title>pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9076.55,-5742.08C9076.55,-5742.08 9076.55,-5531.64 9076.55,-5531.64"/>
<polygon fill="black" stroke="black" points="9080.05,-5531.64 9076.55,-5521.64 9073.05,-5531.64 9080.05,-5531.64"/>
</g>
<!-- pp_stage0_layer1_route_back_expert14 -->
<g id="node151" class="node">
<title>pp_stage0_layer1_route_back_expert14</title>
<polygon fill="lightpink" stroke="black" points="11091.3,-5589.5 10272,-5589.5 10061.23,-5453.5 10880.54,-5453.5 11091.3,-5589.5"/>
<text text-anchor="middle" x="10576.27" y="-5540.3" font-family="Times,serif" font-size="14.00">Route Back Expert 14</text>
<text text-anchor="middle" x="10576.27" y="-5525.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10576.27" y="-5510.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10576.27" y="-5495.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert14 -->
<g id="edge203" class="edge">
<title>pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8980.93,-5679C9431.61,-5679 10226.59,-5679 10226.59,-5679 10226.59,-5679 10226.59,-5570.43 10226.59,-5570.43"/>
<polygon fill="black" stroke="black" points="10230.09,-5570.43 10226.59,-5560.43 10223.09,-5570.43 10230.09,-5570.43"/>
</g>
<!-- pp_stage0_layer1_route_back_expert15 -->
<g id="node155" class="node">
<title>pp_stage0_layer1_route_back_expert15</title>
<polygon fill="lightpink" stroke="black" points="12180.3,-5589.5 11361,-5589.5 11150.23,-5453.5 11969.54,-5453.5 12180.3,-5589.5"/>
<text text-anchor="middle" x="11665.27" y="-5540.3" font-family="Times,serif" font-size="14.00">Route Back Expert 15</text>
<text text-anchor="middle" x="11665.27" y="-5525.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11665.27" y="-5510.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11665.27" y="-5495.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert15 -->
<g id="edge208" class="edge">
<title>pp_stage0_layer1_gate&#45;&gt;pp_stage0_layer1_route_back_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8986.82,-5683C9674.12,-5683 11270.92,-5683 11270.92,-5683 11270.92,-5683 11270.92,-5541.6 11270.92,-5541.6"/>
<polygon fill="black" stroke="black" points="11274.42,-5541.6 11270.92,-5531.6 11267.42,-5541.6 11274.42,-5541.6"/>
</g>
<!-- pp_stage0_layer1_expert0_activation -->
<g id="node93" class="node">
<title>pp_stage0_layer1_expert0_activation</title>
<polygon fill="lightyellow" stroke="black" points="11430.27,-5965.5 10924.27,-5965.5 10924.27,-5897.5 11430.27,-5897.5 11430.27,-5965.5"/>
<text text-anchor="middle" x="11177.27" y="-5950.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="11177.27" y="-5935.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11177.27" y="-5920.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11177.27" y="-5905.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert0_up&#45;&gt;pp_stage0_layer1_expert0_activation -->
<g id="edge130" class="edge">
<title>pp_stage0_layer1_expert0_up&#45;&gt;pp_stage0_layer1_expert0_activation</title>
<path fill="none" stroke="black" d="M11163.27,-6051.32C11163.27,-6051.32 11163.27,-5975.58 11163.27,-5975.58"/>
<polygon fill="black" stroke="black" points="11166.77,-5975.58 11163.27,-5965.58 11159.77,-5975.58 11166.77,-5975.58"/>
</g>
<!-- pp_stage0_layer1_expert0_down -->
<g id="node94" class="node">
<title>pp_stage0_layer1_expert0_down</title>
<polygon fill="lightcoral" stroke="black" points="12534.77,-5777.5 12037.77,-5777.5 12037.77,-5709.5 12534.77,-5709.5 12534.77,-5777.5"/>
<text text-anchor="middle" x="12286.27" y="-5762.3" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="12286.27" y="-5747.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12286.27" y="-5732.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12286.27" y="-5717.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert0_activation&#45;&gt;pp_stage0_layer1_expert0_down -->
<g id="edge131" class="edge">
<title>pp_stage0_layer1_expert0_activation&#45;&gt;pp_stage0_layer1_expert0_down</title>
<path fill="none" stroke="black" d="M11416.27,-5965.68C11416.27,-5980.27 11416.27,-5994 11416.27,-5994 11416.27,-5994 12043.02,-5994 12043.02,-5994 12043.02,-5994 12043.02,-5787.54 12043.02,-5787.54"/>
<polygon fill="black" stroke="black" points="12046.52,-5787.54 12043.02,-5777.54 12039.52,-5787.54 12046.52,-5787.54"/>
</g>
<!-- pp_stage0_layer1_expert0_down&#45;&gt;pp_stage0_layer1_route_back_expert0 -->
<g id="edge132" class="edge">
<title>pp_stage0_layer1_expert0_down&#45;&gt;pp_stage0_layer1_route_back_expert0</title>
<path fill="none" stroke="black" d="M12436.18,-5709.3C12436.18,-5709.3 12436.18,-5590.82 12436.18,-5590.82"/>
<polygon fill="black" stroke="black" points="12439.68,-5590.82 12436.18,-5580.82 12432.68,-5590.82 12439.68,-5590.82"/>
</g>
<!-- pp_stage0_layer1_expert_agg -->
<g id="node156" class="node">
<title>pp_stage0_layer1_expert_agg</title>
<ellipse fill="lightblue" stroke="black" cx="8398.27" cy="-5319.42" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="8398.27" y="-5338.22" font-family="Times,serif" font-size="14.00">Aggregate Experts</text>
<text text-anchor="middle" x="8398.27" y="-5323.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8398.27" y="-5308.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8398.27" y="-5293.22" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_route_back_expert0&#45;&gt;pp_stage0_layer1_expert_agg -->
<g id="edge209" class="edge">
<title>pp_stage0_layer1_route_back_expert0&#45;&gt;pp_stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M12323.63,-5453.25C12323.63,-5396.17 12323.63,-5324 12323.63,-5324 12323.63,-5324 8758.34,-5324 8758.34,-5324"/>
<polygon fill="black" stroke="black" points="8758.34,-5320.5 8748.34,-5324 8758.34,-5327.5 8758.34,-5320.5"/>
</g>
<!-- pp_stage0_layer1_expert1_activation -->
<g id="node97" class="node">
<title>pp_stage0_layer1_expert1_activation</title>
<polygon fill="lightyellow" stroke="black" points="11994.27,-5965.5 11488.27,-5965.5 11488.27,-5897.5 11994.27,-5897.5 11994.27,-5965.5"/>
<text text-anchor="middle" x="11741.27" y="-5950.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="11741.27" y="-5935.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11741.27" y="-5920.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11741.27" y="-5905.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert1_up&#45;&gt;pp_stage0_layer1_expert1_activation -->
<g id="edge135" class="edge">
<title>pp_stage0_layer1_expert1_up&#45;&gt;pp_stage0_layer1_expert1_activation</title>
<path fill="none" stroke="black" d="M11735.27,-6051.32C11735.27,-6051.32 11735.27,-5975.58 11735.27,-5975.58"/>
<polygon fill="black" stroke="black" points="11738.77,-5975.58 11735.27,-5965.58 11731.77,-5975.58 11738.77,-5975.58"/>
</g>
<!-- pp_stage0_layer1_expert1_down -->
<g id="node98" class="node">
<title>pp_stage0_layer1_expert1_down</title>
<polygon fill="lightcoral" stroke="black" points="13590.77,-5777.5 13093.77,-5777.5 13093.77,-5709.5 13590.77,-5709.5 13590.77,-5777.5"/>
<text text-anchor="middle" x="13342.27" y="-5762.3" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="13342.27" y="-5747.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="13342.27" y="-5732.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13342.27" y="-5717.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert1_activation&#45;&gt;pp_stage0_layer1_expert1_down -->
<g id="edge136" class="edge">
<title>pp_stage0_layer1_expert1_activation&#45;&gt;pp_stage0_layer1_expert1_down</title>
<path fill="none" stroke="black" d="M11990.27,-5965.71C11990.27,-5991.34 11990.27,-6022 11990.27,-6022 11990.27,-6022 13344.02,-6022 13344.02,-6022 13344.02,-6022 13344.02,-5787.65 13344.02,-5787.65"/>
<polygon fill="black" stroke="black" points="13347.52,-5787.65 13344.02,-5777.65 13340.52,-5787.65 13347.52,-5787.65"/>
</g>
<!-- pp_stage0_layer1_expert1_down&#45;&gt;pp_stage0_layer1_route_back_expert1 -->
<g id="edge137" class="edge">
<title>pp_stage0_layer1_expert1_down&#45;&gt;pp_stage0_layer1_route_back_expert1</title>
<path fill="none" stroke="black" d="M13503.18,-5709.3C13503.18,-5709.3 13503.18,-5576.5 13503.18,-5576.5"/>
<polygon fill="black" stroke="black" points="13506.68,-5576.5 13503.18,-5566.5 13499.68,-5576.5 13506.68,-5576.5"/>
</g>
<!-- pp_stage0_layer1_route_back_expert1&#45;&gt;pp_stage0_layer1_expert_agg -->
<g id="edge210" class="edge">
<title>pp_stage0_layer1_route_back_expert1&#45;&gt;pp_stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M13432.63,-5453.27C13432.63,-5392.79 13432.63,-5314 13432.63,-5314 13432.63,-5314 8757.78,-5314 8757.78,-5314"/>
<polygon fill="black" stroke="black" points="8757.78,-5310.5 8747.78,-5314 8757.78,-5317.5 8757.78,-5310.5"/>
</g>
<!-- pp_stage0_layer1_expert2_activation -->
<g id="node101" class="node">
<title>pp_stage0_layer1_expert2_activation</title>
<polygon fill="lightyellow" stroke="black" points="12558.27,-5965.5 12052.27,-5965.5 12052.27,-5897.5 12558.27,-5897.5 12558.27,-5965.5"/>
<text text-anchor="middle" x="12305.27" y="-5950.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="12305.27" y="-5935.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12305.27" y="-5920.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12305.27" y="-5905.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert2_up&#45;&gt;pp_stage0_layer1_expert2_activation -->
<g id="edge140" class="edge">
<title>pp_stage0_layer1_expert2_up&#45;&gt;pp_stage0_layer1_expert2_activation</title>
<path fill="none" stroke="black" d="M12303.27,-6051.32C12303.27,-6051.32 12303.27,-5975.58 12303.27,-5975.58"/>
<polygon fill="black" stroke="black" points="12306.77,-5975.58 12303.27,-5965.58 12299.77,-5975.58 12306.77,-5975.58"/>
</g>
<!-- pp_stage0_layer1_expert2_down -->
<g id="node102" class="node">
<title>pp_stage0_layer1_expert2_down</title>
<polygon fill="lightcoral" stroke="black" points="14662.77,-5777.5 14165.77,-5777.5 14165.77,-5709.5 14662.77,-5709.5 14662.77,-5777.5"/>
<text text-anchor="middle" x="14414.27" y="-5762.3" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="14414.27" y="-5747.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="14414.27" y="-5732.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14414.27" y="-5717.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert2_activation&#45;&gt;pp_stage0_layer1_expert2_down -->
<g id="edge141" class="edge">
<title>pp_stage0_layer1_expert2_activation&#45;&gt;pp_stage0_layer1_expert2_down</title>
<path fill="none" stroke="black" d="M12558.33,-5920C13092.72,-5920 14287.52,-5920 14287.52,-5920 14287.52,-5920 14287.52,-5787.53 14287.52,-5787.53"/>
<polygon fill="black" stroke="black" points="14291.02,-5787.53 14287.52,-5777.53 14284.02,-5787.53 14291.02,-5787.53"/>
</g>
<!-- pp_stage0_layer1_expert2_down&#45;&gt;pp_stage0_layer1_route_back_expert2 -->
<g id="edge142" class="edge">
<title>pp_stage0_layer1_expert2_down&#45;&gt;pp_stage0_layer1_route_back_expert2</title>
<path fill="none" stroke="black" d="M14580.84,-5709.3C14580.84,-5709.3 14580.84,-5569.08 14580.84,-5569.08"/>
<polygon fill="black" stroke="black" points="14584.34,-5569.08 14580.84,-5559.08 14577.34,-5569.08 14584.34,-5569.08"/>
</g>
<!-- pp_stage0_layer1_route_back_expert2&#45;&gt;pp_stage0_layer1_expert_agg -->
<g id="edge211" class="edge">
<title>pp_stage0_layer1_route_back_expert2&#45;&gt;pp_stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M14670.27,-5453.26C14670.27,-5389.15 14670.27,-5303 14670.27,-5303 14670.27,-5303 8738.84,-5303 8738.84,-5303"/>
<polygon fill="black" stroke="black" points="8738.84,-5299.5 8728.84,-5303 8738.84,-5306.5 8738.84,-5299.5"/>
</g>
<!-- pp_stage0_layer1_expert3_activation -->
<g id="node105" class="node">
<title>pp_stage0_layer1_expert3_activation</title>
<polygon fill="lightyellow" stroke="black" points="15507.27,-5965.5 15001.27,-5965.5 15001.27,-5897.5 15507.27,-5897.5 15507.27,-5965.5"/>
<text text-anchor="middle" x="15254.27" y="-5950.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15254.27" y="-5935.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="15254.27" y="-5920.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="15254.27" y="-5905.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert3_up&#45;&gt;pp_stage0_layer1_expert3_activation -->
<g id="edge145" class="edge">
<title>pp_stage0_layer1_expert3_up&#45;&gt;pp_stage0_layer1_expert3_activation</title>
<path fill="none" stroke="black" d="M13597.02,-6051.49C13597.02,-6009.06 13597.02,-5942 13597.02,-5942 13597.02,-5942 14991.21,-5942 14991.21,-5942"/>
<polygon fill="black" stroke="black" points="14991.21,-5945.5 15001.21,-5942 14991.21,-5938.5 14991.21,-5945.5"/>
</g>
<!-- pp_stage0_layer1_expert3_down -->
<g id="node106" class="node">
<title>pp_stage0_layer1_expert3_down</title>
<polygon fill="lightcoral" stroke="black" points="15743.77,-5777.5 15246.77,-5777.5 15246.77,-5709.5 15743.77,-5709.5 15743.77,-5777.5"/>
<text text-anchor="middle" x="15495.27" y="-5762.3" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="15495.27" y="-5747.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="15495.27" y="-5732.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15495.27" y="-5717.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert3_activation&#45;&gt;pp_stage0_layer1_expert3_down -->
<g id="edge146" class="edge">
<title>pp_stage0_layer1_expert3_activation&#45;&gt;pp_stage0_layer1_expert3_down</title>
<path fill="none" stroke="black" d="M15377.02,-5897.45C15377.02,-5897.45 15377.02,-5787.61 15377.02,-5787.61"/>
<polygon fill="black" stroke="black" points="15380.52,-5787.61 15377.02,-5777.61 15373.52,-5787.61 15380.52,-5787.61"/>
</g>
<!-- pp_stage0_layer1_expert3_down&#45;&gt;pp_stage0_layer1_route_back_expert3 -->
<g id="edge147" class="edge">
<title>pp_stage0_layer1_expert3_down&#45;&gt;pp_stage0_layer1_route_back_expert3</title>
<path fill="none" stroke="black" d="M15664.51,-5709.3C15664.51,-5709.3 15664.51,-5565.74 15664.51,-5565.74"/>
<polygon fill="black" stroke="black" points="15668.01,-5565.74 15664.51,-5555.74 15661.01,-5565.74 15668.01,-5565.74"/>
</g>
<!-- pp_stage0_layer1_route_back_expert3&#45;&gt;pp_stage0_layer1_expert_agg -->
<g id="edge212" class="edge">
<title>pp_stage0_layer1_route_back_expert3&#45;&gt;pp_stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M15670.59,-5453.26C15670.59,-5385.61 15670.59,-5292 15670.59,-5292 15670.59,-5292 8696.99,-5292 8696.99,-5292"/>
<polygon fill="black" stroke="black" points="8696.99,-5288.5 8686.99,-5292 8696.99,-5295.5 8696.99,-5288.5"/>
</g>
<!-- pp_stage0_layer1_expert4_activation -->
<g id="node109" class="node">
<title>pp_stage0_layer1_expert4_activation</title>
<polygon fill="lightyellow" stroke="black" points="16071.27,-5965.5 15565.27,-5965.5 15565.27,-5897.5 16071.27,-5897.5 16071.27,-5965.5"/>
<text text-anchor="middle" x="15818.27" y="-5950.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15818.27" y="-5935.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="15818.27" y="-5920.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="15818.27" y="-5905.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert4_up&#45;&gt;pp_stage0_layer1_expert4_activation -->
<g id="edge150" class="edge">
<title>pp_stage0_layer1_expert4_up&#45;&gt;pp_stage0_layer1_expert4_activation</title>
<path fill="none" stroke="black" d="M14409.59,-6085C14874.85,-6085 15818.27,-6085 15818.27,-6085 15818.27,-6085 15818.27,-5975.57 15818.27,-5975.57"/>
<polygon fill="black" stroke="black" points="15821.77,-5975.57 15818.27,-5965.57 15814.77,-5975.57 15821.77,-5975.57"/>
</g>
<!-- pp_stage0_layer1_expert4_down -->
<g id="node110" class="node">
<title>pp_stage0_layer1_expert4_down</title>
<polygon fill="lightcoral" stroke="black" points="16828.77,-5777.5 16331.77,-5777.5 16331.77,-5709.5 16828.77,-5709.5 16828.77,-5777.5"/>
<text text-anchor="middle" x="16580.27" y="-5762.3" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="16580.27" y="-5747.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="16580.27" y="-5732.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16580.27" y="-5717.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert4_activation&#45;&gt;pp_stage0_layer1_expert4_down -->
<g id="edge151" class="edge">
<title>pp_stage0_layer1_expert4_activation&#45;&gt;pp_stage0_layer1_expert4_down</title>
<path fill="none" stroke="black" d="M15907.52,-5897.36C15907.52,-5843.04 15907.52,-5743 15907.52,-5743 15907.52,-5743 16321.67,-5743 16321.67,-5743"/>
<polygon fill="black" stroke="black" points="16321.67,-5746.5 16331.67,-5743 16321.67,-5739.5 16321.67,-5746.5"/>
</g>
<!-- pp_stage0_layer1_expert4_down&#45;&gt;pp_stage0_layer1_route_back_expert4 -->
<g id="edge152" class="edge">
<title>pp_stage0_layer1_expert4_down&#45;&gt;pp_stage0_layer1_route_back_expert4</title>
<path fill="none" stroke="black" d="M16750.84,-5709.3C16750.84,-5709.3 16750.84,-5563.93 16750.84,-5563.93"/>
<polygon fill="black" stroke="black" points="16754.34,-5563.93 16750.84,-5553.93 16747.34,-5563.93 16754.34,-5563.93"/>
</g>
<!-- pp_stage0_layer1_route_back_expert4&#45;&gt;pp_stage0_layer1_expert_agg -->
<g id="edge213" class="edge">
<title>pp_stage0_layer1_route_back_expert4&#45;&gt;pp_stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M16839.88,-5453.19C16839.88,-5382.4 16839.88,-5282 16839.88,-5282 16839.88,-5282 8629.18,-5282 8629.18,-5282"/>
<polygon fill="black" stroke="black" points="8629.18,-5278.5 8619.18,-5282 8629.18,-5285.5 8629.18,-5278.5"/>
</g>
<!-- pp_stage0_layer1_expert5_activation -->
<g id="node113" class="node">
<title>pp_stage0_layer1_expert5_activation</title>
<polygon fill="lightyellow" stroke="black" points="2647.27,-5965.5 2141.27,-5965.5 2141.27,-5897.5 2647.27,-5897.5 2647.27,-5965.5"/>
<text text-anchor="middle" x="2394.27" y="-5950.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2394.27" y="-5935.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="2394.27" y="-5920.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="2394.27" y="-5905.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert5_up&#45;&gt;pp_stage0_layer1_expert5_activation -->
<g id="edge155" class="edge">
<title>pp_stage0_layer1_expert5_up&#45;&gt;pp_stage0_layer1_expert5_activation</title>
<path fill="none" stroke="black" d="M2528.27,-6051.32C2528.27,-6051.32 2528.27,-5975.58 2528.27,-5975.58"/>
<polygon fill="black" stroke="black" points="2531.77,-5975.58 2528.27,-5965.58 2524.77,-5975.58 2531.77,-5975.58"/>
</g>
<!-- pp_stage0_layer1_expert5_down -->
<g id="node114" class="node">
<title>pp_stage0_layer1_expert5_down</title>
<polygon fill="lightcoral" stroke="black" points="1065.77,-5777.5 568.77,-5777.5 568.77,-5709.5 1065.77,-5709.5 1065.77,-5777.5"/>
<text text-anchor="middle" x="817.27" y="-5762.3" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="817.27" y="-5747.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="817.27" y="-5732.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="817.27" y="-5717.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert5_activation&#45;&gt;pp_stage0_layer1_expert5_down -->
<g id="edge156" class="edge">
<title>pp_stage0_layer1_expert5_activation&#45;&gt;pp_stage0_layer1_expert5_down</title>
<path fill="none" stroke="black" d="M2145.52,-5897.36C2145.52,-5843.04 2145.52,-5743 2145.52,-5743 2145.52,-5743 1075.93,-5743 1075.93,-5743"/>
<polygon fill="black" stroke="black" points="1075.93,-5739.5 1065.93,-5743 1075.93,-5746.5 1075.93,-5739.5"/>
</g>
<!-- pp_stage0_layer1_expert5_down&#45;&gt;pp_stage0_layer1_route_back_expert5 -->
<g id="edge157" class="edge">
<title>pp_stage0_layer1_expert5_down&#45;&gt;pp_stage0_layer1_route_back_expert5</title>
<path fill="none" stroke="black" d="M817.27,-5709.3C817.27,-5709.3 817.27,-5599.76 817.27,-5599.76"/>
<polygon fill="black" stroke="black" points="820.77,-5599.76 817.27,-5589.76 813.77,-5599.76 820.77,-5599.76"/>
</g>
<!-- pp_stage0_layer1_route_back_expert5&#45;&gt;pp_stage0_layer1_expert_agg -->
<g id="edge214" class="edge">
<title>pp_stage0_layer1_route_back_expert5&#45;&gt;pp_stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M1092.15,-5461.62C1092.15,-5390.98 1092.15,-5283 1092.15,-5283 1092.15,-5283 8158.56,-5283 8158.56,-5283"/>
<polygon fill="black" stroke="black" points="8158.56,-5286.5 8168.56,-5283 8158.56,-5279.5 8158.56,-5286.5"/>
</g>
<!-- pp_stage0_layer1_expert6_activation -->
<g id="node117" class="node">
<title>pp_stage0_layer1_expert6_activation</title>
<polygon fill="lightyellow" stroke="black" points="3282.27,-5965.5 2776.27,-5965.5 2776.27,-5897.5 3282.27,-5897.5 3282.27,-5965.5"/>
<text text-anchor="middle" x="3029.27" y="-5950.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3029.27" y="-5935.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="3029.27" y="-5920.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="3029.27" y="-5905.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert6_up&#45;&gt;pp_stage0_layer1_expert6_activation -->
<g id="edge160" class="edge">
<title>pp_stage0_layer1_expert6_up&#45;&gt;pp_stage0_layer1_expert6_activation</title>
<path fill="none" stroke="black" d="M3649.84,-6085C3475.27,-6085 3274.63,-6085 3274.63,-6085 3274.63,-6085 3274.63,-5975.57 3274.63,-5975.57"/>
<polygon fill="black" stroke="black" points="3278.13,-5975.57 3274.63,-5965.57 3271.13,-5975.57 3278.13,-5975.57"/>
</g>
<!-- pp_stage0_layer1_expert6_down -->
<g id="node118" class="node">
<title>pp_stage0_layer1_expert6_down</title>
<polygon fill="lightcoral" stroke="black" points="2646.77,-5777.5 2149.77,-5777.5 2149.77,-5709.5 2646.77,-5709.5 2646.77,-5777.5"/>
<text text-anchor="middle" x="2398.27" y="-5762.3" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="2398.27" y="-5747.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="2398.27" y="-5732.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2398.27" y="-5717.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert6_activation&#45;&gt;pp_stage0_layer1_expert6_down -->
<g id="edge161" class="edge">
<title>pp_stage0_layer1_expert6_activation&#45;&gt;pp_stage0_layer1_expert6_down</title>
<path fill="none" stroke="black" d="M2874.02,-5897.36C2874.02,-5843.04 2874.02,-5743 2874.02,-5743 2874.02,-5743 2656.94,-5743 2656.94,-5743"/>
<polygon fill="black" stroke="black" points="2656.94,-5739.5 2646.94,-5743 2656.94,-5746.5 2656.94,-5739.5"/>
</g>
<!-- pp_stage0_layer1_expert6_down&#45;&gt;pp_stage0_layer1_route_back_expert6 -->
<g id="edge162" class="edge">
<title>pp_stage0_layer1_expert6_down&#45;&gt;pp_stage0_layer1_route_back_expert6</title>
<path fill="none" stroke="black" d="M2226.36,-5709.3C2226.36,-5709.3 2226.36,-5599.76 2226.36,-5599.76"/>
<polygon fill="black" stroke="black" points="2229.86,-5599.76 2226.36,-5589.76 2222.86,-5599.76 2229.86,-5599.76"/>
</g>
<!-- pp_stage0_layer1_route_back_expert6&#45;&gt;pp_stage0_layer1_expert_agg -->
<g id="edge215" class="edge">
<title>pp_stage0_layer1_route_back_expert6&#45;&gt;pp_stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M2226.4,-5490.48C2226.4,-5428.45 2226.4,-5295 2226.4,-5295 2226.4,-5295 8085.36,-5295 8085.36,-5295"/>
<polygon fill="black" stroke="black" points="8085.36,-5298.5 8095.36,-5295 8085.36,-5291.5 8085.36,-5298.5"/>
</g>
<!-- pp_stage0_layer1_expert7_activation -->
<g id="node121" class="node">
<title>pp_stage0_layer1_expert7_activation</title>
<polygon fill="lightyellow" stroke="black" points="3959.27,-5965.5 3453.27,-5965.5 3453.27,-5897.5 3959.27,-5897.5 3959.27,-5965.5"/>
<text text-anchor="middle" x="3706.27" y="-5950.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3706.27" y="-5935.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="3706.27" y="-5920.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="3706.27" y="-5905.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert7_up&#45;&gt;pp_stage0_layer1_expert7_activation -->
<g id="edge165" class="edge">
<title>pp_stage0_layer1_expert7_up&#45;&gt;pp_stage0_layer1_expert7_activation</title>
<path fill="none" stroke="black" d="M4552.06,-6085C4391.65,-6085 4214.27,-6085 4214.27,-6085 4214.27,-6085 4214.27,-5931 4214.27,-5931 4214.27,-5931 3969.52,-5931 3969.52,-5931"/>
<polygon fill="black" stroke="black" points="3969.52,-5927.5 3959.52,-5931 3969.52,-5934.5 3969.52,-5927.5"/>
</g>
<!-- pp_stage0_layer1_expert7_down -->
<g id="node122" class="node">
<title>pp_stage0_layer1_expert7_down</title>
<polygon fill="lightcoral" stroke="black" points="3468.77,-5777.5 2971.77,-5777.5 2971.77,-5709.5 3468.77,-5709.5 3468.77,-5777.5"/>
<text text-anchor="middle" x="3220.27" y="-5762.3" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="3220.27" y="-5747.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="3220.27" y="-5732.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3220.27" y="-5717.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert7_activation&#45;&gt;pp_stage0_layer1_expert7_down -->
<g id="edge166" class="edge">
<title>pp_stage0_layer1_expert7_activation&#45;&gt;pp_stage0_layer1_expert7_down</title>
<path fill="none" stroke="black" d="M3461.02,-5897.45C3461.02,-5897.45 3461.02,-5787.61 3461.02,-5787.61"/>
<polygon fill="black" stroke="black" points="3464.52,-5787.61 3461.02,-5777.61 3457.52,-5787.61 3464.52,-5787.61"/>
</g>
<!-- pp_stage0_layer1_expert7_down&#45;&gt;pp_stage0_layer1_route_back_expert7 -->
<g id="edge167" class="edge">
<title>pp_stage0_layer1_expert7_down&#45;&gt;pp_stage0_layer1_route_back_expert7</title>
<path fill="none" stroke="black" d="M3137.36,-5709.3C3137.36,-5709.3 3137.36,-5599.76 3137.36,-5599.76"/>
<polygon fill="black" stroke="black" points="3140.86,-5599.76 3137.36,-5589.76 3133.86,-5599.76 3140.86,-5599.76"/>
</g>
<!-- pp_stage0_layer1_route_back_expert7&#45;&gt;pp_stage0_layer1_expert_agg -->
<g id="edge216" class="edge">
<title>pp_stage0_layer1_route_back_expert7&#45;&gt;pp_stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3455.4,-5521.34C3455.4,-5514.85 3455.4,-5307 3455.4,-5307 3455.4,-5307 8048.52,-5307 8048.52,-5307"/>
<polygon fill="black" stroke="black" points="8048.52,-5310.5 8058.52,-5307 8048.52,-5303.5 8048.52,-5310.5"/>
</g>
<!-- pp_stage0_layer1_expert8_activation -->
<g id="node125" class="node">
<title>pp_stage0_layer1_expert8_activation</title>
<polygon fill="lightyellow" stroke="black" points="4749.27,-5965.5 4243.27,-5965.5 4243.27,-5897.5 4749.27,-5897.5 4749.27,-5965.5"/>
<text text-anchor="middle" x="4496.27" y="-5950.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="4496.27" y="-5935.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="4496.27" y="-5920.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="4496.27" y="-5905.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert8_up&#45;&gt;pp_stage0_layer1_expert8_activation -->
<g id="edge170" class="edge">
<title>pp_stage0_layer1_expert8_up&#45;&gt;pp_stage0_layer1_expert8_activation</title>
<path fill="none" stroke="black" d="M5351.52,-6051.21C5351.52,-6005.69 5351.52,-5931 5351.52,-5931 5351.52,-5931 4759.4,-5931 4759.4,-5931"/>
<polygon fill="black" stroke="black" points="4759.4,-5927.5 4749.4,-5931 4759.4,-5934.5 4759.4,-5927.5"/>
</g>
<!-- pp_stage0_layer1_expert8_down -->
<g id="node126" class="node">
<title>pp_stage0_layer1_expert8_down</title>
<polygon fill="lightcoral" stroke="black" points="4517.77,-5777.5 4020.77,-5777.5 4020.77,-5709.5 4517.77,-5709.5 4517.77,-5777.5"/>
<text text-anchor="middle" x="4269.27" y="-5762.3" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="4269.27" y="-5747.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="4269.27" y="-5732.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4269.27" y="-5717.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert8_activation&#45;&gt;pp_stage0_layer1_expert8_down -->
<g id="edge171" class="edge">
<title>pp_stage0_layer1_expert8_activation&#45;&gt;pp_stage0_layer1_expert8_down</title>
<path fill="none" stroke="black" d="M4380.52,-5897.45C4380.52,-5897.45 4380.52,-5787.61 4380.52,-5787.61"/>
<polygon fill="black" stroke="black" points="4384.02,-5787.61 4380.52,-5777.61 4377.02,-5787.61 4384.02,-5787.61"/>
</g>
<!-- pp_stage0_layer1_expert8_down&#45;&gt;pp_stage0_layer1_route_back_expert8 -->
<g id="edge172" class="edge">
<title>pp_stage0_layer1_expert8_down&#45;&gt;pp_stage0_layer1_route_back_expert8</title>
<path fill="none" stroke="black" d="M4269.27,-5709.3C4269.27,-5709.3 4269.27,-5599.76 4269.27,-5599.76"/>
<polygon fill="black" stroke="black" points="4272.77,-5599.76 4269.27,-5589.76 4265.77,-5599.76 4272.77,-5599.76"/>
</g>
<!-- pp_stage0_layer1_route_back_expert8&#45;&gt;pp_stage0_layer1_expert_agg -->
<g id="edge217" class="edge">
<title>pp_stage0_layer1_route_back_expert8&#45;&gt;pp_stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4098.25,-5453.22C4098.25,-5394.44 4098.25,-5319 4098.25,-5319 4098.25,-5319 8036.83,-5319 8036.83,-5319"/>
<polygon fill="black" stroke="black" points="8036.83,-5322.5 8046.83,-5319 8036.83,-5315.5 8036.83,-5322.5"/>
</g>
<!-- pp_stage0_layer1_expert9_activation -->
<g id="node129" class="node">
<title>pp_stage0_layer1_expert9_activation</title>
<polygon fill="lightyellow" stroke="black" points="6215.27,-5965.5 5709.27,-5965.5 5709.27,-5897.5 6215.27,-5897.5 6215.27,-5965.5"/>
<text text-anchor="middle" x="5962.27" y="-5950.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="5962.27" y="-5935.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="5962.27" y="-5920.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="5962.27" y="-5905.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert9_up&#45;&gt;pp_stage0_layer1_expert9_activation -->
<g id="edge175" class="edge">
<title>pp_stage0_layer1_expert9_up&#45;&gt;pp_stage0_layer1_expert9_activation</title>
<path fill="none" stroke="black" d="M6074.77,-6051.32C6074.77,-6051.32 6074.77,-5975.58 6074.77,-5975.58"/>
<polygon fill="black" stroke="black" points="6078.27,-5975.58 6074.77,-5965.58 6071.27,-5975.58 6078.27,-5975.58"/>
</g>
<!-- pp_stage0_layer1_expert9_down -->
<g id="node130" class="node">
<title>pp_stage0_layer1_expert9_down</title>
<polygon fill="lightcoral" stroke="black" points="5914.77,-5777.5 5417.77,-5777.5 5417.77,-5709.5 5914.77,-5709.5 5914.77,-5777.5"/>
<text text-anchor="middle" x="5666.27" y="-5762.3" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="5666.27" y="-5747.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="5666.27" y="-5732.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5666.27" y="-5717.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert9_activation&#45;&gt;pp_stage0_layer1_expert9_down -->
<g id="edge176" class="edge">
<title>pp_stage0_layer1_expert9_activation&#45;&gt;pp_stage0_layer1_expert9_down</title>
<path fill="none" stroke="black" d="M5812.02,-5897.45C5812.02,-5897.45 5812.02,-5787.61 5812.02,-5787.61"/>
<polygon fill="black" stroke="black" points="5815.52,-5787.61 5812.02,-5777.61 5808.52,-5787.61 5815.52,-5787.61"/>
</g>
<!-- pp_stage0_layer1_expert9_down&#45;&gt;pp_stage0_layer1_route_back_expert9 -->
<g id="edge177" class="edge">
<title>pp_stage0_layer1_expert9_down&#45;&gt;pp_stage0_layer1_route_back_expert9</title>
<path fill="none" stroke="black" d="M5494.02,-5709.3C5494.02,-5709.3 5494.02,-5599.76 5494.02,-5599.76"/>
<polygon fill="black" stroke="black" points="5497.52,-5599.76 5494.02,-5589.76 5490.52,-5599.76 5497.52,-5599.76"/>
</g>
<!-- pp_stage0_layer1_route_back_expert9&#45;&gt;pp_stage0_layer1_expert_agg -->
<g id="edge218" class="edge">
<title>pp_stage0_layer1_route_back_expert9&#45;&gt;pp_stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5608.9,-5521.36C5608.9,-5515.59 5608.9,-5331 5608.9,-5331 5608.9,-5331 8046.93,-5331 8046.93,-5331"/>
<polygon fill="black" stroke="black" points="8046.93,-5334.5 8056.93,-5331 8046.93,-5327.5 8046.93,-5334.5"/>
</g>
<!-- pp_stage0_layer1_expert10_activation -->
<g id="node133" class="node">
<title>pp_stage0_layer1_expert10_activation</title>
<polygon fill="lightyellow" stroke="black" points="7230.27,-5965.5 6724.27,-5965.5 6724.27,-5897.5 7230.27,-5897.5 7230.27,-5965.5"/>
<text text-anchor="middle" x="6977.27" y="-5950.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="6977.27" y="-5935.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="6977.27" y="-5920.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="6977.27" y="-5905.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert10_up&#45;&gt;pp_stage0_layer1_expert10_activation -->
<g id="edge180" class="edge">
<title>pp_stage0_layer1_expert10_up&#45;&gt;pp_stage0_layer1_expert10_activation</title>
<path fill="none" stroke="black" d="M6978.27,-6051.32C6978.27,-6051.32 6978.27,-5975.58 6978.27,-5975.58"/>
<polygon fill="black" stroke="black" points="6981.77,-5975.58 6978.27,-5965.58 6974.77,-5975.58 6981.77,-5975.58"/>
</g>
<!-- pp_stage0_layer1_expert10_down -->
<g id="node134" class="node">
<title>pp_stage0_layer1_expert10_down</title>
<polygon fill="lightcoral" stroke="black" points="6736.77,-5777.5 6239.77,-5777.5 6239.77,-5709.5 6736.77,-5709.5 6736.77,-5777.5"/>
<text text-anchor="middle" x="6488.27" y="-5762.3" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="6488.27" y="-5747.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="6488.27" y="-5732.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6488.27" y="-5717.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert10_activation&#45;&gt;pp_stage0_layer1_expert10_down -->
<g id="edge181" class="edge">
<title>pp_stage0_layer1_expert10_activation&#45;&gt;pp_stage0_layer1_expert10_down</title>
<path fill="none" stroke="black" d="M6730.52,-5897.45C6730.52,-5897.45 6730.52,-5787.61 6730.52,-5787.61"/>
<polygon fill="black" stroke="black" points="6734.02,-5787.61 6730.52,-5777.61 6727.02,-5787.61 6734.02,-5787.61"/>
</g>
<!-- pp_stage0_layer1_expert10_down&#45;&gt;pp_stage0_layer1_route_back_expert10 -->
<g id="edge182" class="edge">
<title>pp_stage0_layer1_expert10_down&#45;&gt;pp_stage0_layer1_route_back_expert10</title>
<path fill="none" stroke="black" d="M6405.02,-5709.3C6405.02,-5709.3 6405.02,-5599.76 6405.02,-5599.76"/>
<polygon fill="black" stroke="black" points="6408.52,-5599.76 6405.02,-5589.76 6401.52,-5599.76 6408.52,-5599.76"/>
</g>
<!-- pp_stage0_layer1_route_back_expert10&#45;&gt;pp_stage0_layer1_expert_agg -->
<g id="edge219" class="edge">
<title>pp_stage0_layer1_route_back_expert10&#45;&gt;pp_stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M6691.65,-5521.37C6691.65,-5515.96 6691.65,-5343 6691.65,-5343 6691.65,-5343 8081.68,-5343 8081.68,-5343"/>
<polygon fill="black" stroke="black" points="8081.68,-5346.5 8091.68,-5343 8081.68,-5339.5 8081.68,-5346.5"/>
</g>
<!-- pp_stage0_layer1_expert11_activation -->
<g id="node137" class="node">
<title>pp_stage0_layer1_expert11_activation</title>
<polygon fill="lightyellow" stroke="black" points="7794.27,-5965.5 7288.27,-5965.5 7288.27,-5897.5 7794.27,-5897.5 7794.27,-5965.5"/>
<text text-anchor="middle" x="7541.27" y="-5950.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7541.27" y="-5935.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7541.27" y="-5920.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7541.27" y="-5905.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert11_up&#45;&gt;pp_stage0_layer1_expert11_activation -->
<g id="edge185" class="edge">
<title>pp_stage0_layer1_expert11_up&#45;&gt;pp_stage0_layer1_expert11_activation</title>
<path fill="none" stroke="black" d="M7600.27,-6051.32C7600.27,-6051.32 7600.27,-5975.58 7600.27,-5975.58"/>
<polygon fill="black" stroke="black" points="7603.77,-5975.58 7600.27,-5965.58 7596.77,-5975.58 7603.77,-5975.58"/>
</g>
<!-- pp_stage0_layer1_expert11_down -->
<g id="node138" class="node">
<title>pp_stage0_layer1_expert11_down</title>
<polygon fill="lightcoral" stroke="black" points="7560.77,-5777.5 7063.77,-5777.5 7063.77,-5709.5 7560.77,-5709.5 7560.77,-5777.5"/>
<text text-anchor="middle" x="7312.27" y="-5762.3" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="7312.27" y="-5747.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7312.27" y="-5732.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7312.27" y="-5717.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert11_activation&#45;&gt;pp_stage0_layer1_expert11_down -->
<g id="edge186" class="edge">
<title>pp_stage0_layer1_expert11_activation&#45;&gt;pp_stage0_layer1_expert11_down</title>
<path fill="none" stroke="black" d="M7424.52,-5897.45C7424.52,-5897.45 7424.52,-5787.61 7424.52,-5787.61"/>
<polygon fill="black" stroke="black" points="7428.02,-5787.61 7424.52,-5777.61 7421.02,-5787.61 7428.02,-5787.61"/>
</g>
<!-- pp_stage0_layer1_expert11_down&#45;&gt;pp_stage0_layer1_route_back_expert11 -->
<g id="edge187" class="edge">
<title>pp_stage0_layer1_expert11_down&#45;&gt;pp_stage0_layer1_route_back_expert11</title>
<path fill="none" stroke="black" d="M7312.27,-5709.3C7312.27,-5709.3 7312.27,-5599.76 7312.27,-5599.76"/>
<polygon fill="black" stroke="black" points="7315.77,-5599.76 7312.27,-5589.76 7308.77,-5599.76 7315.77,-5599.76"/>
</g>
<!-- pp_stage0_layer1_route_back_expert11&#45;&gt;pp_stage0_layer1_expert_agg -->
<g id="edge220" class="edge">
<title>pp_stage0_layer1_route_back_expert11&#45;&gt;pp_stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M7714.4,-5518.32C7714.4,-5495.3 7714.4,-5355 7714.4,-5355 7714.4,-5355 8151.48,-5355 8151.48,-5355"/>
<polygon fill="black" stroke="black" points="8151.48,-5358.5 8161.48,-5355 8151.48,-5351.5 8151.48,-5358.5"/>
</g>
<!-- pp_stage0_layer1_expert12_activation -->
<g id="node141" class="node">
<title>pp_stage0_layer1_expert12_activation</title>
<polygon fill="lightyellow" stroke="black" points="8446.27,-5965.5 7940.27,-5965.5 7940.27,-5897.5 8446.27,-5897.5 8446.27,-5965.5"/>
<text text-anchor="middle" x="8193.27" y="-5950.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="8193.27" y="-5935.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="8193.27" y="-5920.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="8193.27" y="-5905.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert12_up&#45;&gt;pp_stage0_layer1_expert12_activation -->
<g id="edge190" class="edge">
<title>pp_stage0_layer1_expert12_up&#45;&gt;pp_stage0_layer1_expert12_activation</title>
<path fill="none" stroke="black" d="M8237.27,-6051.32C8237.27,-6051.32 8237.27,-5975.58 8237.27,-5975.58"/>
<polygon fill="black" stroke="black" points="8240.77,-5975.58 8237.27,-5965.58 8233.77,-5975.58 8240.77,-5975.58"/>
</g>
<!-- pp_stage0_layer1_expert12_down -->
<g id="node142" class="node">
<title>pp_stage0_layer1_expert12_down</title>
<polygon fill="lightcoral" stroke="black" points="8117.77,-5777.5 7620.77,-5777.5 7620.77,-5709.5 8117.77,-5709.5 8117.77,-5777.5"/>
<text text-anchor="middle" x="7869.27" y="-5762.3" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="7869.27" y="-5747.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7869.27" y="-5732.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7869.27" y="-5717.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert12_activation&#45;&gt;pp_stage0_layer1_expert12_down -->
<g id="edge191" class="edge">
<title>pp_stage0_layer1_expert12_activation&#45;&gt;pp_stage0_layer1_expert12_down</title>
<path fill="none" stroke="black" d="M8029.02,-5897.45C8029.02,-5897.45 8029.02,-5787.61 8029.02,-5787.61"/>
<polygon fill="black" stroke="black" points="8032.52,-5787.61 8029.02,-5777.61 8025.52,-5787.61 8032.52,-5787.61"/>
</g>
<!-- pp_stage0_layer1_expert12_down&#45;&gt;pp_stage0_layer1_route_back_expert12 -->
<g id="edge192" class="edge">
<title>pp_stage0_layer1_expert12_down&#45;&gt;pp_stage0_layer1_route_back_expert12</title>
<path fill="none" stroke="black" d="M8000.38,-5709.3C8000.38,-5709.3 8000.38,-5539.18 8000.38,-5539.18"/>
<polygon fill="black" stroke="black" points="8003.88,-5539.18 8000.38,-5529.18 7996.88,-5539.18 8003.88,-5539.18"/>
</g>
<!-- pp_stage0_layer1_route_back_expert12&#45;&gt;pp_stage0_layer1_expert_agg -->
<g id="edge221" class="edge">
<title>pp_stage0_layer1_route_back_expert12&#45;&gt;pp_stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M8398.27,-5453.36C8398.27,-5453.36 8398.27,-5377.8 8398.27,-5377.8"/>
<polygon fill="black" stroke="black" points="8401.77,-5377.8 8398.27,-5367.8 8394.77,-5377.8 8401.77,-5377.8"/>
</g>
<!-- pp_stage0_layer1_expert13_activation -->
<g id="node145" class="node">
<title>pp_stage0_layer1_expert13_activation</title>
<polygon fill="lightyellow" stroke="black" points="9738.27,-5965.5 9232.27,-5965.5 9232.27,-5897.5 9738.27,-5897.5 9738.27,-5965.5"/>
<text text-anchor="middle" x="9485.27" y="-5950.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="9485.27" y="-5935.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9485.27" y="-5920.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9485.27" y="-5905.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert13_up&#45;&gt;pp_stage0_layer1_expert13_activation -->
<g id="edge195" class="edge">
<title>pp_stage0_layer1_expert13_up&#45;&gt;pp_stage0_layer1_expert13_activation</title>
<path fill="none" stroke="black" d="M9362.77,-6051.32C9362.77,-6051.32 9362.77,-5975.58 9362.77,-5975.58"/>
<polygon fill="black" stroke="black" points="9366.27,-5975.58 9362.77,-5965.58 9359.27,-5975.58 9366.27,-5975.58"/>
</g>
<!-- pp_stage0_layer1_expert13_down -->
<g id="node146" class="node">
<title>pp_stage0_layer1_expert13_down</title>
<polygon fill="lightcoral" stroke="black" points="9735.77,-5777.5 9238.77,-5777.5 9238.77,-5709.5 9735.77,-5709.5 9735.77,-5777.5"/>
<text text-anchor="middle" x="9487.27" y="-5762.3" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="9487.27" y="-5747.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9487.27" y="-5732.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9487.27" y="-5717.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert13_activation&#45;&gt;pp_stage0_layer1_expert13_down -->
<g id="edge196" class="edge">
<title>pp_stage0_layer1_expert13_activation&#45;&gt;pp_stage0_layer1_expert13_down</title>
<path fill="none" stroke="black" d="M9487.27,-5897.45C9487.27,-5897.45 9487.27,-5787.61 9487.27,-5787.61"/>
<polygon fill="black" stroke="black" points="9490.77,-5787.61 9487.27,-5777.61 9483.77,-5787.61 9490.77,-5787.61"/>
</g>
<!-- pp_stage0_layer1_expert13_down&#45;&gt;pp_stage0_layer1_route_back_expert13 -->
<g id="edge197" class="edge">
<title>pp_stage0_layer1_expert13_down&#45;&gt;pp_stage0_layer1_route_back_expert13</title>
<path fill="none" stroke="black" d="M9487.27,-5709.3C9487.27,-5709.3 9487.27,-5599.76 9487.27,-5599.76"/>
<polygon fill="black" stroke="black" points="9490.77,-5599.76 9487.27,-5589.76 9483.77,-5599.76 9490.77,-5599.76"/>
</g>
<!-- pp_stage0_layer1_route_back_expert13&#45;&gt;pp_stage0_layer1_expert_agg -->
<g id="edge222" class="edge">
<title>pp_stage0_layer1_route_back_expert13&#45;&gt;pp_stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M9001.63,-5521.38C9001.63,-5516.37 9001.63,-5356 9001.63,-5356 9001.63,-5356 8636.37,-5356 8636.37,-5356"/>
<polygon fill="black" stroke="black" points="8636.37,-5352.5 8626.37,-5356 8636.37,-5359.5 8636.37,-5352.5"/>
</g>
<!-- pp_stage0_layer1_expert14_activation -->
<g id="node149" class="node">
<title>pp_stage0_layer1_expert14_activation</title>
<polygon fill="lightyellow" stroke="black" points="10302.27,-5965.5 9796.27,-5965.5 9796.27,-5897.5 10302.27,-5897.5 10302.27,-5965.5"/>
<text text-anchor="middle" x="10049.27" y="-5950.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="10049.27" y="-5935.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10049.27" y="-5920.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10049.27" y="-5905.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert14_up&#45;&gt;pp_stage0_layer1_expert14_activation -->
<g id="edge200" class="edge">
<title>pp_stage0_layer1_expert14_up&#45;&gt;pp_stage0_layer1_expert14_activation</title>
<path fill="none" stroke="black" d="M9988.77,-6051.32C9988.77,-6051.32 9988.77,-5975.58 9988.77,-5975.58"/>
<polygon fill="black" stroke="black" points="9992.27,-5975.58 9988.77,-5965.58 9985.27,-5975.58 9992.27,-5975.58"/>
</g>
<!-- pp_stage0_layer1_expert14_down -->
<g id="node150" class="node">
<title>pp_stage0_layer1_expert14_down</title>
<polygon fill="lightcoral" stroke="black" points="10557.77,-5777.5 10060.77,-5777.5 10060.77,-5709.5 10557.77,-5709.5 10557.77,-5777.5"/>
<text text-anchor="middle" x="10309.27" y="-5762.3" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="10309.27" y="-5747.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10309.27" y="-5732.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10309.27" y="-5717.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert14_activation&#45;&gt;pp_stage0_layer1_expert14_down -->
<g id="edge201" class="edge">
<title>pp_stage0_layer1_expert14_activation&#45;&gt;pp_stage0_layer1_expert14_down</title>
<path fill="none" stroke="black" d="M10181.52,-5897.45C10181.52,-5897.45 10181.52,-5787.61 10181.52,-5787.61"/>
<polygon fill="black" stroke="black" points="10185.02,-5787.61 10181.52,-5777.61 10178.02,-5787.61 10185.02,-5787.61"/>
</g>
<!-- pp_stage0_layer1_expert14_down&#45;&gt;pp_stage0_layer1_route_back_expert14 -->
<g id="edge202" class="edge">
<title>pp_stage0_layer1_expert14_down&#45;&gt;pp_stage0_layer1_route_back_expert14</title>
<path fill="none" stroke="black" d="M10392.18,-5709.3C10392.18,-5709.3 10392.18,-5599.76 10392.18,-5599.76"/>
<polygon fill="black" stroke="black" points="10395.68,-5599.76 10392.18,-5589.76 10388.68,-5599.76 10395.68,-5599.76"/>
</g>
<!-- pp_stage0_layer1_route_back_expert14&#45;&gt;pp_stage0_layer1_expert_agg -->
<g id="edge223" class="edge">
<title>pp_stage0_layer1_route_back_expert14&#45;&gt;pp_stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M10094.13,-5521.37C10094.13,-5516.06 10094.13,-5346 10094.13,-5346 10094.13,-5346 8701.24,-5346 8701.24,-5346"/>
<polygon fill="black" stroke="black" points="8701.24,-5342.5 8691.24,-5346 8701.24,-5349.5 8701.24,-5342.5"/>
</g>
<!-- pp_stage0_layer1_expert15_activation -->
<g id="node153" class="node">
<title>pp_stage0_layer1_expert15_activation</title>
<polygon fill="lightyellow" stroke="black" points="10866.27,-5965.5 10360.27,-5965.5 10360.27,-5897.5 10866.27,-5897.5 10866.27,-5965.5"/>
<text text-anchor="middle" x="10613.27" y="-5950.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="10613.27" y="-5935.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10613.27" y="-5920.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10613.27" y="-5905.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert15_up&#45;&gt;pp_stage0_layer1_expert15_activation -->
<g id="edge205" class="edge">
<title>pp_stage0_layer1_expert15_up&#45;&gt;pp_stage0_layer1_expert15_activation</title>
<path fill="none" stroke="black" d="M10583.77,-6051.32C10583.77,-6051.32 10583.77,-5975.58 10583.77,-5975.58"/>
<polygon fill="black" stroke="black" points="10587.27,-5975.58 10583.77,-5965.58 10580.27,-5975.58 10587.27,-5975.58"/>
</g>
<!-- pp_stage0_layer1_expert15_down -->
<g id="node154" class="node">
<title>pp_stage0_layer1_expert15_down</title>
<polygon fill="lightcoral" stroke="black" points="11512.77,-5777.5 11015.77,-5777.5 11015.77,-5709.5 11512.77,-5709.5 11512.77,-5777.5"/>
<text text-anchor="middle" x="11264.27" y="-5762.3" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="11264.27" y="-5747.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11264.27" y="-5732.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11264.27" y="-5717.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pp_stage0_layer1_expert15_activation&#45;&gt;pp_stage0_layer1_expert15_down -->
<g id="edge206" class="edge">
<title>pp_stage0_layer1_expert15_activation&#45;&gt;pp_stage0_layer1_expert15_down</title>
<path fill="none" stroke="black" d="M10712.02,-5897.36C10712.02,-5843.04 10712.02,-5743 10712.02,-5743 10712.02,-5743 11005.61,-5743 11005.61,-5743"/>
<polygon fill="black" stroke="black" points="11005.61,-5746.5 11015.61,-5743 11005.61,-5739.5 11005.61,-5746.5"/>
</g>
<!-- pp_stage0_layer1_expert15_down&#45;&gt;pp_stage0_layer1_route_back_expert15 -->
<g id="edge207" class="edge">
<title>pp_stage0_layer1_expert15_down&#45;&gt;pp_stage0_layer1_route_back_expert15</title>
<path fill="none" stroke="black" d="M11391.84,-5709.3C11391.84,-5709.3 11391.84,-5599.76 11391.84,-5599.76"/>
<polygon fill="black" stroke="black" points="11395.34,-5599.76 11391.84,-5589.76 11388.34,-5599.76 11395.34,-5599.76"/>
</g>
<!-- pp_stage0_layer1_route_back_expert15&#45;&gt;pp_stage0_layer1_expert_agg -->
<g id="edge224" class="edge">
<title>pp_stage0_layer1_route_back_expert15&#45;&gt;pp_stage0_layer1_expert_agg</title>
<path fill="none" stroke="black" d="M11212.63,-5453.38C11212.63,-5400.1 11212.63,-5335 11212.63,-5335 11212.63,-5335 8740.77,-5335 8740.77,-5335"/>
<polygon fill="black" stroke="black" points="8740.77,-5331.5 8730.77,-5335 8740.77,-5338.5 8740.77,-5331.5"/>
</g>
<!-- pp_stage0_layer1_expert_agg&#45;&gt;pp_stage0_layer1_final_residual -->
<g id="edge226" class="edge">
<title>pp_stage0_layer1_expert_agg&#45;&gt;pp_stage0_layer1_final_residual</title>
<path fill="none" stroke="black" d="M8067.98,-5302.91C8067.98,-5258 8067.98,-5137 8067.98,-5137 8067.98,-5137 4941.78,-5137 4941.78,-5137"/>
<polygon fill="black" stroke="black" points="4941.78,-5133.5 4931.78,-5137 4941.78,-5140.5 4941.78,-5133.5"/>
</g>
<!-- pp_stage0_layer1_pipeline_comm -->
<g id="node158" class="node">
<title>pp_stage0_layer1_pipeline_comm</title>
<ellipse fill="lightblue" stroke="black" cx="4285.27" cy="-4955.08" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="4285.27" y="-4973.88" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="4285.27" y="-4958.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4285.27" y="-4943.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4285.27" y="-4928.88" font-family="Times,serif" font-size="14.00">GPU: GPU 1</text>
</g>
<!-- pp_stage0_layer1_final_residual&#45;&gt;pp_stage0_layer1_pipeline_comm -->
<g id="edge227" class="edge">
<title>pp_stage0_layer1_final_residual&#45;&gt;pp_stage0_layer1_pipeline_comm</title>
<path fill="none" stroke="black" d="M4285.27,-5088.91C4285.27,-5088.91 4285.27,-5013.33 4285.27,-5013.33"/>
<polygon fill="black" stroke="black" points="4288.77,-5013.33 4285.27,-5003.33 4281.77,-5013.33 4288.77,-5013.33"/>
</g>
<!-- pp_stage1_layer2_norm -->
<g id="node159" class="node">
<title>pp_stage1_layer2_norm</title>
<polygon fill="lightyellow" stroke="black" points="4818.77,-4821 4321.77,-4821 4321.77,-4753 4818.77,-4753 4818.77,-4821"/>
<text text-anchor="middle" x="4570.27" y="-4805.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="4570.27" y="-4790.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4570.27" y="-4775.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4570.27" y="-4760.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage0_layer1_pipeline_comm&#45;&gt;pp_stage1_layer2_norm -->
<g id="edge228" class="edge">
<title>pp_stage0_layer1_pipeline_comm&#45;&gt;pp_stage1_layer2_norm</title>
<path fill="none" stroke="black" d="M4479.23,-4914.82C4479.23,-4914.82 4479.23,-4831.26 4479.23,-4831.26"/>
<polygon fill="black" stroke="black" points="4482.73,-4831.26 4479.23,-4821.26 4475.73,-4831.26 4482.73,-4831.26"/>
</g>
<!-- pp_stage1_layer2_attn_residual -->
<g id="node167" class="node">
<title>pp_stage1_layer2_attn_residual</title>
<ellipse fill="lightblue" stroke="black" cx="4285.27" cy="-3848.92" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="4285.27" y="-3867.72" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4285.27" y="-3852.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096], [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4285.27" y="-3837.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4285.27" y="-3822.72" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage0_layer1_pipeline_comm&#45;&gt;pp_stage1_layer2_attn_residual -->
<g id="edge238" class="edge">
<title>pp_stage0_layer1_pipeline_comm&#45;&gt;pp_stage1_layer2_attn_residual</title>
<path fill="none" stroke="black" d="M4069.55,-4917.01C4069.55,-4917.01 4069.55,-3904.24 4069.55,-3904.24"/>
<polygon fill="black" stroke="black" points="4073.05,-3904.24 4069.55,-3894.24 4066.05,-3904.24 4073.05,-3904.24"/>
</g>
<!-- pp_stage1_layer2_q_proj -->
<g id="node160" class="node">
<title>pp_stage1_layer2_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="4942.27,-4667 4432.27,-4667 4432.27,-4599 4942.27,-4599 4942.27,-4667"/>
<text text-anchor="middle" x="4687.27" y="-4651.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4687.27" y="-4636.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4687.27" y="-4621.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4687.27" y="-4606.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_norm&#45;&gt;pp_stage1_layer2_q_proj -->
<g id="edge229" class="edge">
<title>pp_stage1_layer2_norm&#45;&gt;pp_stage1_layer2_q_proj</title>
<path fill="none" stroke="black" d="M4625.52,-4752.82C4625.52,-4752.82 4625.52,-4677.08 4625.52,-4677.08"/>
<polygon fill="black" stroke="black" points="4629.02,-4677.08 4625.52,-4667.08 4622.02,-4677.08 4629.02,-4677.08"/>
</g>
<!-- pp_stage1_layer2_k_proj -->
<g id="node161" class="node">
<title>pp_stage1_layer2_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="5510.27,-4667 5000.27,-4667 5000.27,-4599 5510.27,-4599 5510.27,-4667"/>
<text text-anchor="middle" x="5255.27" y="-4651.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5255.27" y="-4636.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5255.27" y="-4621.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5255.27" y="-4606.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_norm&#45;&gt;pp_stage1_layer2_k_proj -->
<g id="edge230" class="edge">
<title>pp_stage1_layer2_norm&#45;&gt;pp_stage1_layer2_k_proj</title>
<path fill="none" stroke="black" d="M4819.02,-4786C5014.97,-4786 5255.27,-4786 5255.27,-4786 5255.27,-4786 5255.27,-4677.34 5255.27,-4677.34"/>
<polygon fill="black" stroke="black" points="5258.77,-4677.34 5255.27,-4667.34 5251.77,-4677.34 5258.77,-4677.34"/>
</g>
<!-- pp_stage1_layer2_v_proj -->
<g id="node162" class="node">
<title>pp_stage1_layer2_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="4715.27,-4513 4205.27,-4513 4205.27,-4445 4715.27,-4445 4715.27,-4513"/>
<text text-anchor="middle" x="4460.27" y="-4497.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4460.27" y="-4482.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4460.27" y="-4467.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4460.27" y="-4452.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_norm&#45;&gt;pp_stage1_layer2_v_proj -->
<g id="edge231" class="edge">
<title>pp_stage1_layer2_norm&#45;&gt;pp_stage1_layer2_v_proj</title>
<path fill="none" stroke="black" d="M4377.02,-4752.86C4377.02,-4752.86 4377.02,-4523.29 4377.02,-4523.29"/>
<polygon fill="black" stroke="black" points="4380.52,-4523.29 4377.02,-4513.29 4373.52,-4523.29 4380.52,-4523.29"/>
</g>
<!-- pp_stage1_layer2_attn_scores -->
<g id="node163" class="node">
<title>pp_stage1_layer2_attn_scores</title>
<polygon fill="lightyellow" stroke="black" points="5321.27,-4513 4773.27,-4513 4773.27,-4445 5321.27,-4445 5321.27,-4513"/>
<text text-anchor="middle" x="5047.27" y="-4497.8" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="5047.27" y="-4482.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5047.27" y="-4467.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=32, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="5047.27" y="-4452.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_q_proj&#45;&gt;pp_stage1_layer2_attn_scores -->
<g id="edge232" class="edge">
<title>pp_stage1_layer2_q_proj&#45;&gt;pp_stage1_layer2_attn_scores</title>
<path fill="none" stroke="black" d="M4857.77,-4598.82C4857.77,-4598.82 4857.77,-4523.08 4857.77,-4523.08"/>
<polygon fill="black" stroke="black" points="4861.27,-4523.08 4857.77,-4513.08 4854.27,-4523.08 4861.27,-4523.08"/>
</g>
<!-- pp_stage1_layer2_k_proj&#45;&gt;pp_stage1_layer2_attn_scores -->
<g id="edge233" class="edge">
<title>pp_stage1_layer2_k_proj&#45;&gt;pp_stage1_layer2_attn_scores</title>
<path fill="none" stroke="black" d="M5160.77,-4598.82C5160.77,-4598.82 5160.77,-4523.08 5160.77,-4523.08"/>
<polygon fill="black" stroke="black" points="5164.27,-4523.08 5160.77,-4513.08 5157.27,-4523.08 5164.27,-4523.08"/>
</g>
<!-- pp_stage1_layer2_attn_out -->
<g id="node165" class="node">
<title>pp_stage1_layer2_attn_out</title>
<polygon fill="lightyellow" stroke="black" points="4741.27,-4205 4205.27,-4205 4205.27,-4137 4741.27,-4137 4741.27,-4205"/>
<text text-anchor="middle" x="4473.27" y="-4189.8" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="4473.27" y="-4174.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=32, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="4473.27" y="-4159.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4473.27" y="-4144.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_v_proj&#45;&gt;pp_stage1_layer2_attn_out -->
<g id="edge236" class="edge">
<title>pp_stage1_layer2_v_proj&#45;&gt;pp_stage1_layer2_attn_out</title>
<path fill="none" stroke="black" d="M4435.77,-4444.86C4435.77,-4444.86 4435.77,-4215.29 4435.77,-4215.29"/>
<polygon fill="black" stroke="black" points="4439.27,-4215.29 4435.77,-4205.29 4432.27,-4215.29 4439.27,-4215.29"/>
</g>
<!-- pp_stage1_layer2_softmax -->
<g id="node164" class="node">
<title>pp_stage1_layer2_softmax</title>
<polygon fill="lightyellow" stroke="black" points="5214.27,-4359 4666.27,-4359 4666.27,-4291 5214.27,-4291 5214.27,-4359"/>
<text text-anchor="middle" x="4940.27" y="-4343.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="4940.27" y="-4328.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=32, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="4940.27" y="-4313.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=32, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="4940.27" y="-4298.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_attn_scores&#45;&gt;pp_stage1_layer2_softmax -->
<g id="edge234" class="edge">
<title>pp_stage1_layer2_attn_scores&#45;&gt;pp_stage1_layer2_softmax</title>
<path fill="none" stroke="black" d="M4993.77,-4444.82C4993.77,-4444.82 4993.77,-4369.08 4993.77,-4369.08"/>
<polygon fill="black" stroke="black" points="4997.27,-4369.08 4993.77,-4359.08 4990.27,-4369.08 4997.27,-4369.08"/>
</g>
<!-- pp_stage1_layer2_softmax&#45;&gt;pp_stage1_layer2_attn_out -->
<g id="edge235" class="edge">
<title>pp_stage1_layer2_softmax&#45;&gt;pp_stage1_layer2_attn_out</title>
<path fill="none" stroke="black" d="M4703.77,-4290.82C4703.77,-4290.82 4703.77,-4215.08 4703.77,-4215.08"/>
<polygon fill="black" stroke="black" points="4707.27,-4215.08 4703.77,-4205.08 4700.27,-4215.08 4707.27,-4215.08"/>
</g>
<!-- pp_stage1_layer2_out_proj -->
<g id="node166" class="node">
<title>pp_stage1_layer2_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="4712.27,-4051 4214.27,-4051 4214.27,-3983 4712.27,-3983 4712.27,-4051"/>
<text text-anchor="middle" x="4463.27" y="-4035.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4463.27" y="-4020.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4463.27" y="-4005.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4463.27" y="-3990.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_attn_out&#45;&gt;pp_stage1_layer2_out_proj -->
<g id="edge237" class="edge">
<title>pp_stage1_layer2_attn_out&#45;&gt;pp_stage1_layer2_out_proj</title>
<path fill="none" stroke="black" d="M4463.27,-4136.82C4463.27,-4136.82 4463.27,-4061.08 4463.27,-4061.08"/>
<polygon fill="black" stroke="black" points="4466.77,-4061.08 4463.27,-4051.08 4459.77,-4061.08 4466.77,-4061.08"/>
</g>
<!-- pp_stage1_layer2_out_proj&#45;&gt;pp_stage1_layer2_attn_residual -->
<g id="edge239" class="edge">
<title>pp_stage1_layer2_out_proj&#45;&gt;pp_stage1_layer2_attn_residual</title>
<path fill="none" stroke="black" d="M4463.27,-3982.98C4463.27,-3982.98 4463.27,-3905.3 4463.27,-3905.3"/>
<polygon fill="black" stroke="black" points="4466.77,-3905.3 4463.27,-3895.3 4459.77,-3905.3 4466.77,-3905.3"/>
</g>
<!-- pp_stage1_layer2_moe_norm -->
<g id="node168" class="node">
<title>pp_stage1_layer2_moe_norm</title>
<polygon fill="lightyellow" stroke="black" points="8947.77,-3714.83 8450.77,-3714.83 8450.77,-3646.83 8947.77,-3646.83 8947.77,-3714.83"/>
<text text-anchor="middle" x="8699.27" y="-3699.63" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="8699.27" y="-3684.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8699.27" y="-3669.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8699.27" y="-3654.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_attn_residual&#45;&gt;pp_stage1_layer2_moe_norm -->
<g id="edge240" class="edge">
<title>pp_stage1_layer2_attn_residual&#45;&gt;pp_stage1_layer2_moe_norm</title>
<path fill="none" stroke="black" d="M4901.78,-3834.26C4901.78,-3798 4901.78,-3707 4901.78,-3707 4901.78,-3707 8440.47,-3707 8440.47,-3707"/>
<polygon fill="black" stroke="black" points="8440.47,-3710.5 8450.47,-3707 8440.47,-3703.5 8440.47,-3710.5"/>
</g>
<!-- pp_stage1_layer2_final_residual -->
<g id="node235" class="node">
<title>pp_stage1_layer2_final_residual</title>
<ellipse fill="lightblue" stroke="black" cx="4541.27" cy="-2578.58" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="4541.27" y="-2597.38" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="4541.27" y="-2582.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096], [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4541.27" y="-2567.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4541.27" y="-2552.38" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_attn_residual&#45;&gt;pp_stage1_layer2_final_residual -->
<g id="edge338" class="edge">
<title>pp_stage1_layer2_attn_residual&#45;&gt;pp_stage1_layer2_final_residual</title>
<path fill="none" stroke="black" d="M4865.63,-3827.66C4865.63,-3827.66 4865.63,-2630.32 4865.63,-2630.32"/>
<polygon fill="black" stroke="black" points="4869.13,-2630.32 4865.63,-2620.32 4862.13,-2630.32 4869.13,-2630.32"/>
</g>
<!-- pp_stage1_layer2_gate -->
<g id="node169" class="node">
<title>pp_stage1_layer2_gate</title>
<polygon fill="lightpink" stroke="black" points="9436.92,-3252.83 8637.31,-3252.83 8431.62,-3116.83 9231.22,-3116.83 9436.92,-3252.83"/>
<text text-anchor="middle" x="8934.27" y="-3203.63" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="8934.27" y="-3188.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8934.27" y="-3173.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="8934.27" y="-3158.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_gate -->
<g id="edge241" class="edge">
<title>pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_gate</title>
<path fill="none" stroke="black" d="M8822.77,-3646.74C8822.77,-3646.74 8822.77,-3263.03 8822.77,-3263.03"/>
<polygon fill="black" stroke="black" points="8826.27,-3263.03 8822.77,-3253.03 8819.27,-3263.03 8826.27,-3263.03"/>
</g>
<!-- pp_stage1_layer2_expert0_up -->
<g id="node170" class="node">
<title>pp_stage1_layer2_expert0_up</title>
<polygon fill="lightcoral" stroke="black" points="11275.27,-3560.83 10769.27,-3560.83 10769.27,-3492.83 11275.27,-3492.83 11275.27,-3560.83"/>
<text text-anchor="middle" x="11022.27" y="-3545.63" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="11022.27" y="-3530.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11022.27" y="-3515.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11022.27" y="-3500.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert0_up -->
<g id="edge242" class="edge">
<title>pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert0_up</title>
<path fill="none" stroke="black" d="M8947.9,-3672C9529.62,-3672 10930.4,-3672 10930.4,-3672 10930.4,-3672 10930.4,-3570.87 10930.4,-3570.87"/>
<polygon fill="black" stroke="black" points="10933.9,-3570.87 10930.4,-3560.87 10926.9,-3570.87 10933.9,-3570.87"/>
</g>
<!-- pp_stage1_layer2_expert1_up -->
<g id="node174" class="node">
<title>pp_stage1_layer2_expert1_up</title>
<polygon fill="lightcoral" stroke="black" points="11842.27,-3560.83 11336.27,-3560.83 11336.27,-3492.83 11842.27,-3492.83 11842.27,-3560.83"/>
<text text-anchor="middle" x="11589.27" y="-3545.63" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="11589.27" y="-3530.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11589.27" y="-3515.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11589.27" y="-3500.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert1_up -->
<g id="edge247" class="edge">
<title>pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert1_up</title>
<path fill="none" stroke="black" d="M8947.85,-3680C9648.6,-3680 11589.27,-3680 11589.27,-3680 11589.27,-3680 11589.27,-3571.21 11589.27,-3571.21"/>
<polygon fill="black" stroke="black" points="11592.77,-3571.21 11589.27,-3561.21 11585.77,-3571.21 11592.77,-3571.21"/>
</g>
<!-- pp_stage1_layer2_expert2_up -->
<g id="node178" class="node">
<title>pp_stage1_layer2_expert2_up</title>
<polygon fill="lightcoral" stroke="black" points="12408.27,-3560.83 11902.27,-3560.83 11902.27,-3492.83 12408.27,-3492.83 12408.27,-3560.83"/>
<text text-anchor="middle" x="12155.27" y="-3545.63" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="12155.27" y="-3530.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12155.27" y="-3515.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12155.27" y="-3500.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert2_up -->
<g id="edge252" class="edge">
<title>pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert2_up</title>
<path fill="none" stroke="black" d="M8948.08,-3689C9722.97,-3689 12041.4,-3689 12041.4,-3689 12041.4,-3689 12041.4,-3571.22 12041.4,-3571.22"/>
<polygon fill="black" stroke="black" points="12044.9,-3571.22 12041.4,-3561.22 12037.9,-3571.22 12044.9,-3571.22"/>
</g>
<!-- pp_stage1_layer2_expert3_up -->
<g id="node182" class="node">
<title>pp_stage1_layer2_expert3_up</title>
<polygon fill="lightcoral" stroke="black" points="12973.27,-3560.83 12467.27,-3560.83 12467.27,-3492.83 12973.27,-3492.83 12973.27,-3560.83"/>
<text text-anchor="middle" x="12720.27" y="-3545.63" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="12720.27" y="-3530.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12720.27" y="-3515.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12720.27" y="-3500.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert3_up -->
<g id="edge257" class="edge">
<title>pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert3_up</title>
<path fill="none" stroke="black" d="M8948.14,-3697C9825.27,-3697 12720.27,-3697 12720.27,-3697 12720.27,-3697 12720.27,-3570.86 12720.27,-3570.86"/>
<polygon fill="black" stroke="black" points="12723.77,-3570.86 12720.27,-3560.86 12716.77,-3570.86 12723.77,-3570.86"/>
</g>
<!-- pp_stage1_layer2_expert4_up -->
<g id="node186" class="node">
<title>pp_stage1_layer2_expert4_up</title>
<polygon fill="lightcoral" stroke="black" points="13537.27,-3560.83 13031.27,-3560.83 13031.27,-3492.83 13537.27,-3492.83 13537.27,-3560.83"/>
<text text-anchor="middle" x="13284.27" y="-3545.63" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="13284.27" y="-3530.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13284.27" y="-3515.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="13284.27" y="-3500.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert4_up -->
<g id="edge262" class="edge">
<title>pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert4_up</title>
<path fill="none" stroke="black" d="M8948.12,-3706C9885.5,-3706 13150.4,-3706 13150.4,-3706 13150.4,-3706 13150.4,-3570.95 13150.4,-3570.95"/>
<polygon fill="black" stroke="black" points="13153.9,-3570.95 13150.4,-3560.95 13146.9,-3570.95 13153.9,-3570.95"/>
</g>
<!-- pp_stage1_layer2_expert5_up -->
<g id="node190" class="node">
<title>pp_stage1_layer2_expert5_up</title>
<polygon fill="lightcoral" stroke="black" points="3065.27,-3560.83 2559.27,-3560.83 2559.27,-3492.83 3065.27,-3492.83 3065.27,-3560.83"/>
<text text-anchor="middle" x="2812.27" y="-3545.63" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="2812.27" y="-3530.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2812.27" y="-3515.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="2812.27" y="-3500.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert5_up -->
<g id="edge267" class="edge">
<title>pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert5_up</title>
<path fill="none" stroke="black" d="M8450.54,-3699C7330.83,-3699 2812.27,-3699 2812.27,-3699 2812.27,-3699 2812.27,-3570.85 2812.27,-3570.85"/>
<polygon fill="black" stroke="black" points="2815.77,-3570.85 2812.27,-3560.85 2808.77,-3570.85 2815.77,-3570.85"/>
</g>
<!-- pp_stage1_layer2_expert6_up -->
<g id="node194" class="node">
<title>pp_stage1_layer2_expert6_up</title>
<polygon fill="lightcoral" stroke="black" points="4073.27,-3560.83 3567.27,-3560.83 3567.27,-3492.83 4073.27,-3492.83 4073.27,-3560.83"/>
<text text-anchor="middle" x="3820.27" y="-3545.63" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="3820.27" y="-3530.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3820.27" y="-3515.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="3820.27" y="-3500.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert6_up -->
<g id="edge272" class="edge">
<title>pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert6_up</title>
<path fill="none" stroke="black" d="M8450.76,-3692C7461.41,-3692 3856.12,-3692 3856.12,-3692 3856.12,-3692 3856.12,-3571.06 3856.12,-3571.06"/>
<polygon fill="black" stroke="black" points="3859.62,-3571.06 3856.12,-3561.06 3852.62,-3571.06 3859.62,-3571.06"/>
</g>
<!-- pp_stage1_layer2_expert7_up -->
<g id="node198" class="node">
<title>pp_stage1_layer2_expert7_up</title>
<polygon fill="lightcoral" stroke="black" points="4859.27,-3560.83 4353.27,-3560.83 4353.27,-3492.83 4859.27,-3492.83 4859.27,-3560.83"/>
<text text-anchor="middle" x="4606.27" y="-3545.63" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="4606.27" y="-3530.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4606.27" y="-3515.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="4606.27" y="-3500.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert7_up -->
<g id="edge277" class="edge">
<title>pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert7_up</title>
<path fill="none" stroke="black" d="M8450.54,-3684C7563.29,-3684 4606.27,-3684 4606.27,-3684 4606.27,-3684 4606.27,-3570.94 4606.27,-3570.94"/>
<polygon fill="black" stroke="black" points="4609.77,-3570.94 4606.27,-3560.94 4602.77,-3570.94 4609.77,-3570.94"/>
</g>
<!-- pp_stage1_layer2_expert8_up -->
<g id="node202" class="node">
<title>pp_stage1_layer2_expert8_up</title>
<polygon fill="lightcoral" stroke="black" points="5571.27,-3560.83 5065.27,-3560.83 5065.27,-3492.83 5571.27,-3492.83 5571.27,-3560.83"/>
<text text-anchor="middle" x="5318.27" y="-3545.63" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="5318.27" y="-3530.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5318.27" y="-3515.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="5318.27" y="-3500.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert8_up -->
<g id="edge282" class="edge">
<title>pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert8_up</title>
<path fill="none" stroke="black" d="M8450.77,-3677C7705.56,-3677 5540.77,-3677 5540.77,-3677 5540.77,-3677 5540.77,-3570.91 5540.77,-3570.91"/>
<polygon fill="black" stroke="black" points="5544.27,-3570.91 5540.77,-3560.91 5537.27,-3570.91 5544.27,-3570.91"/>
</g>
<!-- pp_stage1_layer2_expert9_up -->
<g id="node206" class="node">
<title>pp_stage1_layer2_expert9_up</title>
<polygon fill="lightcoral" stroke="black" points="6585.27,-3560.83 6079.27,-3560.83 6079.27,-3492.83 6585.27,-3492.83 6585.27,-3560.83"/>
<text text-anchor="middle" x="6332.27" y="-3545.63" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="6332.27" y="-3530.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6332.27" y="-3515.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="6332.27" y="-3500.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert9_up -->
<g id="edge287" class="edge">
<title>pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert9_up</title>
<path fill="none" stroke="black" d="M8450.71,-3669C7843.17,-3669 6332.27,-3669 6332.27,-3669 6332.27,-3669 6332.27,-3570.89 6332.27,-3570.89"/>
<polygon fill="black" stroke="black" points="6335.77,-3570.89 6332.27,-3560.89 6328.77,-3570.89 6335.77,-3570.89"/>
</g>
<!-- pp_stage1_layer2_expert10_up -->
<g id="node210" class="node">
<title>pp_stage1_layer2_expert10_up</title>
<polygon fill="lightcoral" stroke="black" points="7374.27,-3560.83 6868.27,-3560.83 6868.27,-3492.83 7374.27,-3492.83 7374.27,-3560.83"/>
<text text-anchor="middle" x="7121.27" y="-3545.63" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="7121.27" y="-3530.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7121.27" y="-3515.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7121.27" y="-3500.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert10_up -->
<g id="edge292" class="edge">
<title>pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert10_up</title>
<path fill="none" stroke="black" d="M8450.53,-3661C8006,-3661 7121.27,-3661 7121.27,-3661 7121.27,-3661 7121.27,-3571.04 7121.27,-3571.04"/>
<polygon fill="black" stroke="black" points="7124.77,-3571.04 7121.27,-3561.04 7117.77,-3571.04 7124.77,-3571.04"/>
</g>
<!-- pp_stage1_layer2_expert11_up -->
<g id="node214" class="node">
<title>pp_stage1_layer2_expert11_up</title>
<polygon fill="lightcoral" stroke="black" points="8110.27,-3560.83 7604.27,-3560.83 7604.27,-3492.83 8110.27,-3492.83 8110.27,-3560.83"/>
<text text-anchor="middle" x="7857.27" y="-3545.63" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="7857.27" y="-3530.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7857.27" y="-3515.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7857.27" y="-3500.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert11_up -->
<g id="edge297" class="edge">
<title>pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert11_up</title>
<path fill="none" stroke="black" d="M8450.66,-3654C8281.84,-3654 8089.12,-3654 8089.12,-3654 8089.12,-3654 8089.12,-3570.91 8089.12,-3570.91"/>
<polygon fill="black" stroke="black" points="8092.62,-3570.91 8089.12,-3560.91 8085.62,-3570.91 8092.62,-3570.91"/>
</g>
<!-- pp_stage1_layer2_expert12_up -->
<g id="node218" class="node">
<title>pp_stage1_layer2_expert12_up</title>
<polygon fill="lightcoral" stroke="black" points="8760.27,-3560.83 8254.27,-3560.83 8254.27,-3492.83 8760.27,-3492.83 8760.27,-3560.83"/>
<text text-anchor="middle" x="8507.27" y="-3545.63" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="8507.27" y="-3530.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8507.27" y="-3515.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="8507.27" y="-3500.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert12_up -->
<g id="edge302" class="edge">
<title>pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert12_up</title>
<path fill="none" stroke="black" d="M8605.52,-3646.66C8605.52,-3646.66 8605.52,-3570.91 8605.52,-3570.91"/>
<polygon fill="black" stroke="black" points="8609.02,-3570.91 8605.52,-3560.91 8602.02,-3570.91 8609.02,-3570.91"/>
</g>
<!-- pp_stage1_layer2_expert13_up -->
<g id="node222" class="node">
<title>pp_stage1_layer2_expert13_up</title>
<polygon fill="lightcoral" stroke="black" points="9537.27,-3560.83 9031.27,-3560.83 9031.27,-3492.83 9537.27,-3492.83 9537.27,-3560.83"/>
<text text-anchor="middle" x="9284.27" y="-3545.63" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="9284.27" y="-3530.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9284.27" y="-3515.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9284.27" y="-3500.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert13_up -->
<g id="edge307" class="edge">
<title>pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert13_up</title>
<path fill="none" stroke="black" d="M8885.27,-3646.47C8885.27,-3600.86 8885.27,-3526 8885.27,-3526 8885.27,-3526 9021.01,-3526 9021.01,-3526"/>
<polygon fill="black" stroke="black" points="9021.01,-3529.5 9031.01,-3526 9021.01,-3522.5 9021.01,-3529.5"/>
</g>
<!-- pp_stage1_layer2_expert14_up -->
<g id="node226" class="node">
<title>pp_stage1_layer2_expert14_up</title>
<polygon fill="lightcoral" stroke="black" points="10127.27,-3560.83 9621.27,-3560.83 9621.27,-3492.83 10127.27,-3492.83 10127.27,-3560.83"/>
<text text-anchor="middle" x="9874.27" y="-3545.63" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="9874.27" y="-3530.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9874.27" y="-3515.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9874.27" y="-3500.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert14_up -->
<g id="edge312" class="edge">
<title>pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert14_up</title>
<path fill="none" stroke="black" d="M8947.92,-3655C9275.87,-3655 9811.9,-3655 9811.9,-3655 9811.9,-3655 9811.9,-3570.84 9811.9,-3570.84"/>
<polygon fill="black" stroke="black" points="9815.4,-3570.84 9811.9,-3560.84 9808.4,-3570.84 9815.4,-3570.84"/>
</g>
<!-- pp_stage1_layer2_expert15_up -->
<g id="node230" class="node">
<title>pp_stage1_layer2_expert15_up</title>
<polygon fill="lightcoral" stroke="black" points="10704.27,-3560.83 10198.27,-3560.83 10198.27,-3492.83 10704.27,-3492.83 10704.27,-3560.83"/>
<text text-anchor="middle" x="10451.27" y="-3545.63" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="10451.27" y="-3530.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10451.27" y="-3515.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10451.27" y="-3500.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert15_up -->
<g id="edge317" class="edge">
<title>pp_stage1_layer2_moe_norm&#45;&gt;pp_stage1_layer2_expert15_up</title>
<path fill="none" stroke="black" d="M8947.96,-3663C9431.47,-3663 10451.27,-3663 10451.27,-3663 10451.27,-3663 10451.27,-3570.84 10451.27,-3570.84"/>
<polygon fill="black" stroke="black" points="10454.77,-3570.84 10451.27,-3560.84 10447.77,-3570.84 10454.77,-3570.84"/>
</g>
<!-- pp_stage1_layer2_route_back_expert0 -->
<g id="node173" class="node">
<title>pp_stage1_layer2_route_back_expert0</title>
<polygon fill="lightpink" stroke="black" points="13525.3,-3030.83 12706,-3030.83 12495.23,-2894.83 13314.54,-2894.83 13525.3,-3030.83"/>
<text text-anchor="middle" x="13010.27" y="-2981.63" font-family="Times,serif" font-size="14.00">Route Back Expert 0</text>
<text text-anchor="middle" x="13010.27" y="-2966.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13010.27" y="-2951.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13010.27" y="-2936.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert0 -->
<g id="edge246" class="edge">
<title>pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9248.24,-3128C10134.85,-3128 12593.59,-3128 12593.59,-3128 12593.59,-3128 12593.59,-2972.95 12593.59,-2972.95"/>
<polygon fill="black" stroke="black" points="12597.09,-2972.95 12593.59,-2962.95 12590.09,-2972.95 12597.09,-2972.95"/>
</g>
<!-- pp_stage1_layer2_route_back_expert1 -->
<g id="node177" class="node">
<title>pp_stage1_layer2_route_back_expert1</title>
<polygon fill="lightpink" stroke="black" points="14614.3,-3030.83 13795,-3030.83 13584.23,-2894.83 14403.54,-2894.83 14614.3,-3030.83"/>
<text text-anchor="middle" x="14099.27" y="-2981.63" font-family="Times,serif" font-size="14.00">Route Back Expert 1</text>
<text text-anchor="middle" x="14099.27" y="-2966.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14099.27" y="-2951.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14099.27" y="-2936.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert1 -->
<g id="edge251" class="edge">
<title>pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9252.91,-3131C10315.59,-3131 13671.59,-3131 13671.59,-3131 13671.59,-3131 13671.59,-2972.95 13671.59,-2972.95"/>
<polygon fill="black" stroke="black" points="13675.09,-2972.95 13671.59,-2962.95 13668.09,-2972.95 13675.09,-2972.95"/>
</g>
<!-- pp_stage1_layer2_route_back_expert2 -->
<g id="node181" class="node">
<title>pp_stage1_layer2_route_back_expert2</title>
<polygon fill="lightpink" stroke="black" points="15703.3,-3030.83 14884,-3030.83 14673.23,-2894.83 15492.54,-2894.83 15703.3,-3030.83"/>
<text text-anchor="middle" x="15188.27" y="-2981.63" font-family="Times,serif" font-size="14.00">Route Back Expert 2</text>
<text text-anchor="middle" x="15188.27" y="-2966.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15188.27" y="-2951.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15188.27" y="-2936.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert2 -->
<g id="edge256" class="edge">
<title>pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9258.9,-3135C10483.65,-3135 14754.92,-3135 14754.92,-3135 14754.92,-3135 14754.92,-2972.96 14754.92,-2972.96"/>
<polygon fill="black" stroke="black" points="14758.42,-2972.96 14754.92,-2962.96 14751.42,-2972.96 14758.42,-2972.96"/>
</g>
<!-- pp_stage1_layer2_route_back_expert3 -->
<g id="node185" class="node">
<title>pp_stage1_layer2_route_back_expert3</title>
<polygon fill="lightpink" stroke="black" points="16792.3,-3030.83 15973,-3030.83 15762.23,-2894.83 16581.54,-2894.83 16792.3,-3030.83"/>
<text text-anchor="middle" x="16277.27" y="-2981.63" font-family="Times,serif" font-size="14.00">Route Back Expert 3</text>
<text text-anchor="middle" x="16277.27" y="-2966.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16277.27" y="-2951.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16277.27" y="-2936.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert3 -->
<g id="edge261" class="edge">
<title>pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9264.79,-3139C10640.52,-3139 15841.26,-3139 15841.26,-3139 15841.26,-3139 15841.26,-2972.96 15841.26,-2972.96"/>
<polygon fill="black" stroke="black" points="15844.76,-2972.96 15841.26,-2962.96 15837.76,-2972.96 15844.76,-2972.96"/>
</g>
<!-- pp_stage1_layer2_route_back_expert4 -->
<g id="node189" class="node">
<title>pp_stage1_layer2_route_back_expert4</title>
<polygon fill="lightpink" stroke="black" points="17881.3,-3030.83 17062,-3030.83 16851.23,-2894.83 17670.54,-2894.83 17881.3,-3030.83"/>
<text text-anchor="middle" x="17366.27" y="-2981.63" font-family="Times,serif" font-size="14.00">Route Back Expert 4</text>
<text text-anchor="middle" x="17366.27" y="-2966.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17366.27" y="-2951.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17366.27" y="-2936.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert4 -->
<g id="edge266" class="edge">
<title>pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9271.09,-3143C10790.07,-3143 16928.92,-3143 16928.92,-3143 16928.92,-3143 16928.92,-2972.96 16928.92,-2972.96"/>
<polygon fill="black" stroke="black" points="16932.42,-2972.96 16928.92,-2962.96 16925.42,-2972.96 16932.42,-2972.96"/>
</g>
<!-- pp_stage1_layer2_route_back_expert5 -->
<g id="node193" class="node">
<title>pp_stage1_layer2_route_back_expert5</title>
<polygon fill="lightpink" stroke="black" points="1546.3,-3030.83 727,-3030.83 516.23,-2894.83 1335.54,-2894.83 1546.3,-3030.83"/>
<text text-anchor="middle" x="1031.27" y="-2981.63" font-family="Times,serif" font-size="14.00">Route Back Expert 5</text>
<text text-anchor="middle" x="1031.27" y="-2966.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1031.27" y="-2951.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1031.27" y="-2936.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert5 -->
<g id="edge271" class="edge">
<title>pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8475.7,-3146C6851.41,-3146 1468.65,-3146 1468.65,-3146 1468.65,-3146 1468.65,-3041.04 1468.65,-3041.04"/>
<polygon fill="black" stroke="black" points="1472.15,-3041.04 1468.65,-3031.04 1465.15,-3041.04 1472.15,-3041.04"/>
</g>
<!-- pp_stage1_layer2_route_back_expert6 -->
<g id="node197" class="node">
<title>pp_stage1_layer2_route_back_expert6</title>
<polygon fill="lightpink" stroke="black" points="2635.3,-3030.83 1816,-3030.83 1605.23,-2894.83 2424.54,-2894.83 2635.3,-3030.83"/>
<text text-anchor="middle" x="2120.27" y="-2981.63" font-family="Times,serif" font-size="14.00">Route Back Expert 6</text>
<text text-anchor="middle" x="2120.27" y="-2966.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2120.27" y="-2951.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2120.27" y="-2936.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert6 -->
<g id="edge276" class="edge">
<title>pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8469.37,-3142C6987.16,-3142 2469.94,-3142 2469.94,-3142 2469.94,-3142 2469.94,-3041.08 2469.94,-3041.08"/>
<polygon fill="black" stroke="black" points="2473.44,-3041.08 2469.94,-3031.08 2466.44,-3041.08 2473.44,-3041.08"/>
</g>
<!-- pp_stage1_layer2_route_back_expert7 -->
<g id="node201" class="node">
<title>pp_stage1_layer2_route_back_expert7</title>
<polygon fill="lightpink" stroke="black" points="3724.3,-3030.83 2905,-3030.83 2694.23,-2894.83 3513.54,-2894.83 3724.3,-3030.83"/>
<text text-anchor="middle" x="3209.27" y="-2981.63" font-family="Times,serif" font-size="14.00">Route Back Expert 7</text>
<text text-anchor="middle" x="3209.27" y="-2966.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3209.27" y="-2951.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3209.27" y="-2936.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert7 -->
<g id="edge281" class="edge">
<title>pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8463.42,-3138C7152.96,-3138 3558.94,-3138 3558.94,-3138 3558.94,-3138 3558.94,-3041.06 3558.94,-3041.06"/>
<polygon fill="black" stroke="black" points="3562.44,-3041.06 3558.94,-3031.06 3555.44,-3041.06 3562.44,-3041.06"/>
</g>
<!-- pp_stage1_layer2_route_back_expert8 -->
<g id="node205" class="node">
<title>pp_stage1_layer2_route_back_expert8</title>
<polygon fill="lightpink" stroke="black" points="4813.3,-3030.83 3994,-3030.83 3783.23,-2894.83 4602.54,-2894.83 4813.3,-3030.83"/>
<text text-anchor="middle" x="4298.27" y="-2981.63" font-family="Times,serif" font-size="14.00">Route Back Expert 8</text>
<text text-anchor="middle" x="4298.27" y="-2966.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4298.27" y="-2951.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4298.27" y="-2936.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert8 -->
<g id="edge286" class="edge">
<title>pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8456.07,-3133C7355.43,-3133 4736.65,-3133 4736.65,-3133 4736.65,-3133 4736.65,-3041.07 4736.65,-3041.07"/>
<polygon fill="black" stroke="black" points="4740.15,-3041.07 4736.65,-3031.07 4733.15,-3041.07 4740.15,-3041.07"/>
</g>
<!-- pp_stage1_layer2_route_back_expert9 -->
<g id="node209" class="node">
<title>pp_stage1_layer2_route_back_expert9</title>
<polygon fill="lightpink" stroke="black" points="5902.3,-3030.83 5083,-3030.83 4872.23,-2894.83 5691.54,-2894.83 5902.3,-3030.83"/>
<text text-anchor="middle" x="5387.27" y="-2981.63" font-family="Times,serif" font-size="14.00">Route Back Expert 9</text>
<text text-anchor="middle" x="5387.27" y="-2966.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5387.27" y="-2951.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5387.27" y="-2936.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert9 -->
<g id="edge291" class="edge">
<title>pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8449.92,-3129C7562.94,-3129 5767.94,-3129 5767.94,-3129 5767.94,-3129 5767.94,-3040.9 5767.94,-3040.9"/>
<polygon fill="black" stroke="black" points="5771.44,-3040.9 5767.94,-3030.9 5764.44,-3040.9 5771.44,-3040.9"/>
</g>
<!-- pp_stage1_layer2_route_back_expert10 -->
<g id="node213" class="node">
<title>pp_stage1_layer2_route_back_expert10</title>
<polygon fill="lightpink" stroke="black" points="6991.3,-3030.83 6172,-3030.83 5961.23,-2894.83 6780.54,-2894.83 6991.3,-3030.83"/>
<text text-anchor="middle" x="6476.27" y="-2981.63" font-family="Times,serif" font-size="14.00">Route Back Expert 10</text>
<text text-anchor="middle" x="6476.27" y="-2966.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6476.27" y="-2951.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6476.27" y="-2936.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert10 -->
<g id="edge296" class="edge">
<title>pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8443.77,-3125C7835.24,-3125 6876.94,-3125 6876.94,-3125 6876.94,-3125 6876.94,-3041.14 6876.94,-3041.14"/>
<polygon fill="black" stroke="black" points="6880.44,-3041.14 6876.94,-3031.14 6873.44,-3041.14 6880.44,-3041.14"/>
</g>
<!-- pp_stage1_layer2_route_back_expert11 -->
<g id="node217" class="node">
<title>pp_stage1_layer2_route_back_expert11</title>
<polygon fill="lightpink" stroke="black" points="8080.3,-3030.83 7261,-3030.83 7050.23,-2894.83 7869.54,-2894.83 8080.3,-3030.83"/>
<text text-anchor="middle" x="7565.27" y="-2981.63" font-family="Times,serif" font-size="14.00">Route Back Expert 11</text>
<text text-anchor="middle" x="7565.27" y="-2966.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7565.27" y="-2951.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7565.27" y="-2936.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert11 -->
<g id="edge301" class="edge">
<title>pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8437.91,-3121C8205.35,-3121 7978.65,-3121 7978.65,-3121 7978.65,-3121 7978.65,-3041.29 7978.65,-3041.29"/>
<polygon fill="black" stroke="black" points="7982.15,-3041.29 7978.65,-3031.29 7975.15,-3041.29 7982.15,-3041.29"/>
</g>
<!-- pp_stage1_layer2_route_back_expert12 -->
<g id="node221" class="node">
<title>pp_stage1_layer2_route_back_expert12</title>
<polygon fill="lightpink" stroke="black" points="9169.3,-3030.83 8350,-3030.83 8139.23,-2894.83 8958.54,-2894.83 9169.3,-3030.83"/>
<text text-anchor="middle" x="8654.27" y="-2981.63" font-family="Times,serif" font-size="14.00">Route Back Expert 12</text>
<text text-anchor="middle" x="8654.27" y="-2966.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8654.27" y="-2951.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8654.27" y="-2936.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert12 -->
<g id="edge306" class="edge">
<title>pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8800.49,-3116.72C8800.49,-3116.72 8800.49,-3041.2 8800.49,-3041.2"/>
<polygon fill="black" stroke="black" points="8803.99,-3041.2 8800.49,-3031.2 8796.99,-3041.2 8803.99,-3041.2"/>
</g>
<!-- pp_stage1_layer2_route_back_expert13 -->
<g id="node225" class="node">
<title>pp_stage1_layer2_route_back_expert13</title>
<polygon fill="lightpink" stroke="black" points="10258.3,-3030.83 9439,-3030.83 9228.23,-2894.83 10047.54,-2894.83 10258.3,-3030.83"/>
<text text-anchor="middle" x="9743.27" y="-2981.63" font-family="Times,serif" font-size="14.00">Route Back Expert 13</text>
<text text-anchor="middle" x="9743.27" y="-2966.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9743.27" y="-2951.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9743.27" y="-2936.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert13 -->
<g id="edge311" class="edge">
<title>pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9332.55,-3183.41C9332.55,-3183.41 9332.55,-2972.98 9332.55,-2972.98"/>
<polygon fill="black" stroke="black" points="9336.05,-2972.98 9332.55,-2962.98 9329.05,-2972.98 9336.05,-2972.98"/>
</g>
<!-- pp_stage1_layer2_route_back_expert14 -->
<g id="node229" class="node">
<title>pp_stage1_layer2_route_back_expert14</title>
<polygon fill="lightpink" stroke="black" points="11347.3,-3030.83 10528,-3030.83 10317.23,-2894.83 11136.54,-2894.83 11347.3,-3030.83"/>
<text text-anchor="middle" x="10832.27" y="-2981.63" font-family="Times,serif" font-size="14.00">Route Back Expert 14</text>
<text text-anchor="middle" x="10832.27" y="-2966.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10832.27" y="-2951.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10832.27" y="-2936.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert14 -->
<g id="edge316" class="edge">
<title>pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9236.01,-3120C9686.52,-3120 10482.59,-3120 10482.59,-3120 10482.59,-3120 10482.59,-3011.68 10482.59,-3011.68"/>
<polygon fill="black" stroke="black" points="10486.09,-3011.68 10482.59,-3001.68 10479.09,-3011.68 10486.09,-3011.68"/>
</g>
<!-- pp_stage1_layer2_route_back_expert15 -->
<g id="node233" class="node">
<title>pp_stage1_layer2_route_back_expert15</title>
<polygon fill="lightpink" stroke="black" points="12436.3,-3030.83 11617,-3030.83 11406.23,-2894.83 12225.54,-2894.83 12436.3,-3030.83"/>
<text text-anchor="middle" x="11921.27" y="-2981.63" font-family="Times,serif" font-size="14.00">Route Back Expert 15</text>
<text text-anchor="middle" x="11921.27" y="-2966.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11921.27" y="-2951.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11921.27" y="-2936.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert15 -->
<g id="edge321" class="edge">
<title>pp_stage1_layer2_gate&#45;&gt;pp_stage1_layer2_route_back_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9242.18,-3124C9929.12,-3124 11526.92,-3124 11526.92,-3124 11526.92,-3124 11526.92,-2982.91 11526.92,-2982.91"/>
<polygon fill="black" stroke="black" points="11530.42,-2982.91 11526.92,-2972.91 11523.42,-2982.91 11530.42,-2982.91"/>
</g>
<!-- pp_stage1_layer2_expert0_activation -->
<g id="node171" class="node">
<title>pp_stage1_layer2_expert0_activation</title>
<polygon fill="lightyellow" stroke="black" points="11687.27,-3406.83 11181.27,-3406.83 11181.27,-3338.83 11687.27,-3338.83 11687.27,-3406.83"/>
<text text-anchor="middle" x="11434.27" y="-3391.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="11434.27" y="-3376.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11434.27" y="-3361.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11434.27" y="-3346.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert0_up&#45;&gt;pp_stage1_layer2_expert0_activation -->
<g id="edge243" class="edge">
<title>pp_stage1_layer2_expert0_up&#45;&gt;pp_stage1_layer2_expert0_activation</title>
<path fill="none" stroke="black" d="M11228.27,-3492.66C11228.27,-3492.66 11228.27,-3416.91 11228.27,-3416.91"/>
<polygon fill="black" stroke="black" points="11231.77,-3416.91 11228.27,-3406.91 11224.77,-3416.91 11231.77,-3416.91"/>
</g>
<!-- pp_stage1_layer2_expert0_down -->
<g id="node172" class="node">
<title>pp_stage1_layer2_expert0_down</title>
<polygon fill="lightcoral" stroke="black" points="12790.77,-3218.83 12293.77,-3218.83 12293.77,-3150.83 12790.77,-3150.83 12790.77,-3218.83"/>
<text text-anchor="middle" x="12542.27" y="-3203.63" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="12542.27" y="-3188.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12542.27" y="-3173.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12542.27" y="-3158.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert0_activation&#45;&gt;pp_stage1_layer2_expert0_down -->
<g id="edge244" class="edge">
<title>pp_stage1_layer2_expert0_activation&#45;&gt;pp_stage1_layer2_expert0_down</title>
<path fill="none" stroke="black" d="M11479.52,-3338.82C11479.52,-3310.23 11479.52,-3274 11479.52,-3274 11479.52,-3274 12301.52,-3274 12301.52,-3274 12301.52,-3274 12301.52,-3229.05 12301.52,-3229.05"/>
<polygon fill="black" stroke="black" points="12305.02,-3229.05 12301.52,-3219.05 12298.02,-3229.05 12305.02,-3229.05"/>
</g>
<!-- pp_stage1_layer2_expert0_down&#45;&gt;pp_stage1_layer2_route_back_expert0 -->
<g id="edge245" class="edge">
<title>pp_stage1_layer2_expert0_down&#45;&gt;pp_stage1_layer2_route_back_expert0</title>
<path fill="none" stroke="black" d="M12692.18,-3150.63C12692.18,-3150.63 12692.18,-3032.15 12692.18,-3032.15"/>
<polygon fill="black" stroke="black" points="12695.68,-3032.15 12692.18,-3022.15 12688.68,-3032.15 12695.68,-3032.15"/>
</g>
<!-- pp_stage1_layer2_expert_agg -->
<g id="node234" class="node">
<title>pp_stage1_layer2_expert_agg</title>
<ellipse fill="lightblue" stroke="black" cx="8654.27" cy="-2760.75" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="8654.27" y="-2779.55" font-family="Times,serif" font-size="14.00">Aggregate Experts</text>
<text text-anchor="middle" x="8654.27" y="-2764.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8654.27" y="-2749.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8654.27" y="-2734.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_route_back_expert0&#45;&gt;pp_stage1_layer2_expert_agg -->
<g id="edge322" class="edge">
<title>pp_stage1_layer2_route_back_expert0&#45;&gt;pp_stage1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M12612.13,-2894.82C12612.13,-2837.92 12612.13,-2766 12612.13,-2766 12612.13,-2766 9013.76,-2766 9013.76,-2766"/>
<polygon fill="black" stroke="black" points="9013.76,-2762.5 9003.76,-2766 9013.76,-2769.5 9013.76,-2762.5"/>
</g>
<!-- pp_stage1_layer2_expert1_activation -->
<g id="node175" class="node">
<title>pp_stage1_layer2_expert1_activation</title>
<polygon fill="lightyellow" stroke="black" points="12251.27,-3406.83 11745.27,-3406.83 11745.27,-3338.83 12251.27,-3338.83 12251.27,-3406.83"/>
<text text-anchor="middle" x="11998.27" y="-3391.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="11998.27" y="-3376.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11998.27" y="-3361.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11998.27" y="-3346.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert1_up&#45;&gt;pp_stage1_layer2_expert1_activation -->
<g id="edge248" class="edge">
<title>pp_stage1_layer2_expert1_up&#45;&gt;pp_stage1_layer2_expert1_activation</title>
<path fill="none" stroke="black" d="M11793.77,-3492.66C11793.77,-3492.66 11793.77,-3416.91 11793.77,-3416.91"/>
<polygon fill="black" stroke="black" points="11797.27,-3416.91 11793.77,-3406.91 11790.27,-3416.91 11797.27,-3416.91"/>
</g>
<!-- pp_stage1_layer2_expert1_down -->
<g id="node176" class="node">
<title>pp_stage1_layer2_expert1_down</title>
<polygon fill="lightcoral" stroke="black" points="13846.77,-3218.83 13349.77,-3218.83 13349.77,-3150.83 13846.77,-3150.83 13846.77,-3218.83"/>
<text text-anchor="middle" x="13598.27" y="-3203.63" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="13598.27" y="-3188.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="13598.27" y="-3173.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13598.27" y="-3158.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert1_activation&#45;&gt;pp_stage1_layer2_expert1_down -->
<g id="edge249" class="edge">
<title>pp_stage1_layer2_expert1_activation&#45;&gt;pp_stage1_layer2_expert1_down</title>
<path fill="none" stroke="black" d="M12010.02,-3338.47C12010.02,-3317.62 12010.02,-3295 12010.02,-3295 12010.02,-3295 13359.6,-3295 13359.6,-3295 13359.6,-3295 13359.6,-3229.09 13359.6,-3229.09"/>
<polygon fill="black" stroke="black" points="13363.1,-3229.09 13359.6,-3219.09 13356.1,-3229.09 13363.1,-3229.09"/>
</g>
<!-- pp_stage1_layer2_expert1_down&#45;&gt;pp_stage1_layer2_route_back_expert1 -->
<g id="edge250" class="edge">
<title>pp_stage1_layer2_expert1_down&#45;&gt;pp_stage1_layer2_route_back_expert1</title>
<path fill="none" stroke="black" d="M13759.18,-3150.63C13759.18,-3150.63 13759.18,-3017.83 13759.18,-3017.83"/>
<polygon fill="black" stroke="black" points="13762.68,-3017.83 13759.18,-3007.83 13755.68,-3017.83 13762.68,-3017.83"/>
</g>
<!-- pp_stage1_layer2_route_back_expert1&#45;&gt;pp_stage1_layer2_expert_agg -->
<g id="edge323" class="edge">
<title>pp_stage1_layer2_route_back_expert1&#45;&gt;pp_stage1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M13721.63,-2894.78C13721.63,-2834.17 13721.63,-2755 13721.63,-2755 13721.63,-2755 9013.57,-2755 9013.57,-2755"/>
<polygon fill="black" stroke="black" points="9013.57,-2751.5 9003.57,-2755 9013.57,-2758.5 9013.57,-2751.5"/>
</g>
<!-- pp_stage1_layer2_expert2_activation -->
<g id="node179" class="node">
<title>pp_stage1_layer2_expert2_activation</title>
<polygon fill="lightyellow" stroke="black" points="12815.27,-3406.83 12309.27,-3406.83 12309.27,-3338.83 12815.27,-3338.83 12815.27,-3406.83"/>
<text text-anchor="middle" x="12562.27" y="-3391.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="12562.27" y="-3376.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12562.27" y="-3361.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12562.27" y="-3346.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert2_up&#45;&gt;pp_stage1_layer2_expert2_activation -->
<g id="edge253" class="edge">
<title>pp_stage1_layer2_expert2_up&#45;&gt;pp_stage1_layer2_expert2_activation</title>
<path fill="none" stroke="black" d="M12358.77,-3492.66C12358.77,-3492.66 12358.77,-3416.91 12358.77,-3416.91"/>
<polygon fill="black" stroke="black" points="12362.27,-3416.91 12358.77,-3406.91 12355.27,-3416.91 12362.27,-3416.91"/>
</g>
<!-- pp_stage1_layer2_expert2_down -->
<g id="node180" class="node">
<title>pp_stage1_layer2_expert2_down</title>
<polygon fill="lightcoral" stroke="black" points="14918.77,-3218.83 14421.77,-3218.83 14421.77,-3150.83 14918.77,-3150.83 14918.77,-3218.83"/>
<text text-anchor="middle" x="14670.27" y="-3203.63" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="14670.27" y="-3188.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="14670.27" y="-3173.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14670.27" y="-3158.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert2_activation&#45;&gt;pp_stage1_layer2_expert2_down -->
<g id="edge254" class="edge">
<title>pp_stage1_layer2_expert2_activation&#45;&gt;pp_stage1_layer2_expert2_down</title>
<path fill="none" stroke="black" d="M12803.02,-3338.53C12803.02,-3275.36 12803.02,-3147 12803.02,-3147 12803.02,-3147 14518.15,-3147 14518.15,-3147 14518.15,-3147 14518.15,-3147.38 14518.15,-3147.38"/>
<polygon fill="black" stroke="black" points="14514.65,-3140.77 14518.15,-3150.77 14521.65,-3140.77 14514.65,-3140.77"/>
</g>
<!-- pp_stage1_layer2_expert2_down&#45;&gt;pp_stage1_layer2_route_back_expert2 -->
<g id="edge255" class="edge">
<title>pp_stage1_layer2_expert2_down&#45;&gt;pp_stage1_layer2_route_back_expert2</title>
<path fill="none" stroke="black" d="M14836.84,-3150.63C14836.84,-3150.63 14836.84,-3010.42 14836.84,-3010.42"/>
<polygon fill="black" stroke="black" points="14840.34,-3010.42 14836.84,-3000.42 14833.34,-3010.42 14840.34,-3010.42"/>
</g>
<!-- pp_stage1_layer2_route_back_expert2&#45;&gt;pp_stage1_layer2_expert_agg -->
<g id="edge324" class="edge">
<title>pp_stage1_layer2_route_back_expert2&#45;&gt;pp_stage1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M14921.38,-2894.79C14921.38,-2830.55 14921.38,-2744 14921.38,-2744 14921.38,-2744 8993.76,-2744 8993.76,-2744"/>
<polygon fill="black" stroke="black" points="8993.76,-2740.5 8983.76,-2744 8993.76,-2747.5 8993.76,-2740.5"/>
</g>
<!-- pp_stage1_layer2_expert3_activation -->
<g id="node183" class="node">
<title>pp_stage1_layer2_expert3_activation</title>
<polygon fill="lightyellow" stroke="black" points="13379.27,-3406.83 12873.27,-3406.83 12873.27,-3338.83 13379.27,-3338.83 13379.27,-3406.83"/>
<text text-anchor="middle" x="13126.27" y="-3391.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="13126.27" y="-3376.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="13126.27" y="-3361.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="13126.27" y="-3346.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert3_up&#45;&gt;pp_stage1_layer2_expert3_activation -->
<g id="edge258" class="edge">
<title>pp_stage1_layer2_expert3_up&#45;&gt;pp_stage1_layer2_expert3_activation</title>
<path fill="none" stroke="black" d="M12923.27,-3492.66C12923.27,-3492.66 12923.27,-3416.91 12923.27,-3416.91"/>
<polygon fill="black" stroke="black" points="12926.77,-3416.91 12923.27,-3406.91 12919.77,-3416.91 12926.77,-3416.91"/>
</g>
<!-- pp_stage1_layer2_expert3_down -->
<g id="node184" class="node">
<title>pp_stage1_layer2_expert3_down</title>
<polygon fill="lightcoral" stroke="black" points="15999.77,-3218.83 15502.77,-3218.83 15502.77,-3150.83 15999.77,-3150.83 15999.77,-3218.83"/>
<text text-anchor="middle" x="15751.27" y="-3203.63" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="15751.27" y="-3188.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="15751.27" y="-3173.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15751.27" y="-3158.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert3_activation&#45;&gt;pp_stage1_layer2_expert3_down -->
<g id="edge259" class="edge">
<title>pp_stage1_layer2_expert3_activation&#45;&gt;pp_stage1_layer2_expert3_down</title>
<path fill="none" stroke="black" d="M13369.43,-3338.75C13369.43,-3327.12 13369.43,-3317 13369.43,-3317 13369.43,-3317 15835.18,-3317 15835.18,-3317 15835.18,-3317 15835.18,-3228.87 15835.18,-3228.87"/>
<polygon fill="black" stroke="black" points="15838.68,-3228.87 15835.18,-3218.87 15831.68,-3228.87 15838.68,-3228.87"/>
</g>
<!-- pp_stage1_layer2_expert3_down&#45;&gt;pp_stage1_layer2_route_back_expert3 -->
<g id="edge260" class="edge">
<title>pp_stage1_layer2_expert3_down&#45;&gt;pp_stage1_layer2_route_back_expert3</title>
<path fill="none" stroke="black" d="M15920.51,-3150.63C15920.51,-3150.63 15920.51,-3007.07 15920.51,-3007.07"/>
<polygon fill="black" stroke="black" points="15924.01,-3007.07 15920.51,-2997.07 15917.01,-3007.07 15924.01,-3007.07"/>
</g>
<!-- pp_stage1_layer2_route_back_expert3&#45;&gt;pp_stage1_layer2_expert_agg -->
<g id="edge325" class="edge">
<title>pp_stage1_layer2_route_back_expert3&#45;&gt;pp_stage1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M16006.38,-2894.79C16006.38,-2827.34 16006.38,-2734 16006.38,-2734 16006.38,-2734 8956.45,-2734 8956.45,-2734"/>
<polygon fill="black" stroke="black" points="8956.45,-2730.5 8946.45,-2734 8956.45,-2737.5 8956.45,-2730.5"/>
</g>
<!-- pp_stage1_layer2_expert4_activation -->
<g id="node187" class="node">
<title>pp_stage1_layer2_expert4_activation</title>
<polygon fill="lightyellow" stroke="black" points="13943.27,-3406.83 13437.27,-3406.83 13437.27,-3338.83 13943.27,-3338.83 13943.27,-3406.83"/>
<text text-anchor="middle" x="13690.27" y="-3391.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="13690.27" y="-3376.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="13690.27" y="-3361.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="13690.27" y="-3346.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert4_up&#45;&gt;pp_stage1_layer2_expert4_activation -->
<g id="edge263" class="edge">
<title>pp_stage1_layer2_expert4_up&#45;&gt;pp_stage1_layer2_expert4_activation</title>
<path fill="none" stroke="black" d="M13487.27,-3492.66C13487.27,-3492.66 13487.27,-3416.91 13487.27,-3416.91"/>
<polygon fill="black" stroke="black" points="13490.77,-3416.91 13487.27,-3406.91 13483.77,-3416.91 13490.77,-3416.91"/>
</g>
<!-- pp_stage1_layer2_expert4_down -->
<g id="node188" class="node">
<title>pp_stage1_layer2_expert4_down</title>
<polygon fill="lightcoral" stroke="black" points="17084.77,-3218.83 16587.77,-3218.83 16587.77,-3150.83 17084.77,-3150.83 17084.77,-3218.83"/>
<text text-anchor="middle" x="16836.27" y="-3203.63" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="16836.27" y="-3188.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="16836.27" y="-3173.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16836.27" y="-3158.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert4_activation&#45;&gt;pp_stage1_layer2_expert4_down -->
<g id="edge264" class="edge">
<title>pp_stage1_layer2_expert4_activation&#45;&gt;pp_stage1_layer2_expert4_down</title>
<path fill="none" stroke="black" d="M13943.28,-3372C14649.63,-3372 16591.38,-3372 16591.38,-3372 16591.38,-3372 16591.38,-3229.16 16591.38,-3229.16"/>
<polygon fill="black" stroke="black" points="16594.88,-3229.16 16591.38,-3219.16 16587.88,-3229.16 16594.88,-3229.16"/>
</g>
<!-- pp_stage1_layer2_expert4_down&#45;&gt;pp_stage1_layer2_route_back_expert4 -->
<g id="edge265" class="edge">
<title>pp_stage1_layer2_expert4_down&#45;&gt;pp_stage1_layer2_route_back_expert4</title>
<path fill="none" stroke="black" d="M17006.84,-3150.63C17006.84,-3150.63 17006.84,-3005.27 17006.84,-3005.27"/>
<polygon fill="black" stroke="black" points="17010.34,-3005.27 17006.84,-2995.27 17003.34,-3005.27 17010.34,-3005.27"/>
</g>
<!-- pp_stage1_layer2_route_back_expert4&#45;&gt;pp_stage1_layer2_expert_agg -->
<g id="edge326" class="edge">
<title>pp_stage1_layer2_route_back_expert4&#45;&gt;pp_stage1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M17093.38,-2894.75C17093.38,-2823.84 17093.38,-2723 17093.38,-2723 17093.38,-2723 8882.16,-2723 8882.16,-2723"/>
<polygon fill="black" stroke="black" points="8882.16,-2719.5 8872.16,-2723 8882.16,-2726.5 8882.16,-2719.5"/>
</g>
<!-- pp_stage1_layer2_expert5_activation -->
<g id="node191" class="node">
<title>pp_stage1_layer2_expert5_activation</title>
<polygon fill="lightyellow" stroke="black" points="2579.27,-3406.83 2073.27,-3406.83 2073.27,-3338.83 2579.27,-3338.83 2579.27,-3406.83"/>
<text text-anchor="middle" x="2326.27" y="-3391.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2326.27" y="-3376.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="2326.27" y="-3361.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="2326.27" y="-3346.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert5_up&#45;&gt;pp_stage1_layer2_expert5_activation -->
<g id="edge268" class="edge">
<title>pp_stage1_layer2_expert5_up&#45;&gt;pp_stage1_layer2_expert5_activation</title>
<path fill="none" stroke="black" d="M2569.27,-3492.66C2569.27,-3492.66 2569.27,-3416.91 2569.27,-3416.91"/>
<polygon fill="black" stroke="black" points="2572.77,-3416.91 2569.27,-3406.91 2565.77,-3416.91 2572.77,-3416.91"/>
</g>
<!-- pp_stage1_layer2_expert5_down -->
<g id="node192" class="node">
<title>pp_stage1_layer2_expert5_down</title>
<polygon fill="lightcoral" stroke="black" points="1390.77,-3218.83 893.77,-3218.83 893.77,-3150.83 1390.77,-3150.83 1390.77,-3218.83"/>
<text text-anchor="middle" x="1142.27" y="-3203.63" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="1142.27" y="-3188.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="1142.27" y="-3173.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1142.27" y="-3158.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert5_activation&#45;&gt;pp_stage1_layer2_expert5_down -->
<g id="edge269" class="edge">
<title>pp_stage1_layer2_expert5_activation&#45;&gt;pp_stage1_layer2_expert5_down</title>
<path fill="none" stroke="black" d="M2073.11,-3372C1789.77,-3372 1369.88,-3372 1369.88,-3372 1369.88,-3372 1369.88,-3229.16 1369.88,-3229.16"/>
<polygon fill="black" stroke="black" points="1373.38,-3229.16 1369.88,-3219.16 1366.38,-3229.16 1373.38,-3229.16"/>
</g>
<!-- pp_stage1_layer2_expert5_down&#45;&gt;pp_stage1_layer2_route_back_expert5 -->
<g id="edge270" class="edge">
<title>pp_stage1_layer2_expert5_down&#45;&gt;pp_stage1_layer2_route_back_expert5</title>
<path fill="none" stroke="black" d="M1142.27,-3150.63C1142.27,-3150.63 1142.27,-3041.09 1142.27,-3041.09"/>
<polygon fill="black" stroke="black" points="1145.77,-3041.09 1142.27,-3031.09 1138.77,-3041.09 1145.77,-3041.09"/>
</g>
<!-- pp_stage1_layer2_route_back_expert5&#45;&gt;pp_stage1_layer2_expert_agg -->
<g id="edge327" class="edge">
<title>pp_stage1_layer2_route_back_expert5&#45;&gt;pp_stage1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M1499.9,-2962.79C1499.9,-2959.12 1499.9,-2724 1499.9,-2724 1499.9,-2724 8417.34,-2724 8417.34,-2724"/>
<polygon fill="black" stroke="black" points="8417.34,-2727.5 8427.34,-2724 8417.34,-2720.5 8417.34,-2727.5"/>
</g>
<!-- pp_stage1_layer2_expert6_activation -->
<g id="node195" class="node">
<title>pp_stage1_layer2_expert6_activation</title>
<polygon fill="lightyellow" stroke="black" points="3442.27,-3406.83 2936.27,-3406.83 2936.27,-3338.83 3442.27,-3338.83 3442.27,-3406.83"/>
<text text-anchor="middle" x="3189.27" y="-3391.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3189.27" y="-3376.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="3189.27" y="-3361.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="3189.27" y="-3346.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert6_up&#45;&gt;pp_stage1_layer2_expert6_activation -->
<g id="edge273" class="edge">
<title>pp_stage1_layer2_expert6_up&#45;&gt;pp_stage1_layer2_expert6_activation</title>
<path fill="none" stroke="black" d="M3646.02,-3492.47C3646.02,-3446.86 3646.02,-3372 3646.02,-3372 3646.02,-3372 3452.35,-3372 3452.35,-3372"/>
<polygon fill="black" stroke="black" points="3452.35,-3368.5 3442.35,-3372 3452.35,-3375.5 3452.35,-3368.5"/>
</g>
<!-- pp_stage1_layer2_expert6_down -->
<g id="node196" class="node">
<title>pp_stage1_layer2_expert6_down</title>
<polygon fill="lightcoral" stroke="black" points="2635.77,-3218.83 2138.77,-3218.83 2138.77,-3150.83 2635.77,-3150.83 2635.77,-3218.83"/>
<text text-anchor="middle" x="2387.27" y="-3203.63" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="2387.27" y="-3188.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="2387.27" y="-3173.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2387.27" y="-3158.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert6_activation&#45;&gt;pp_stage1_layer2_expert6_down -->
<g id="edge274" class="edge">
<title>pp_stage1_layer2_expert6_activation&#45;&gt;pp_stage1_layer2_expert6_down</title>
<path fill="none" stroke="black" d="M2936.22,-3372C2779.33,-3372 2607.52,-3372 2607.52,-3372 2607.52,-3372 2607.52,-3229.16 2607.52,-3229.16"/>
<polygon fill="black" stroke="black" points="2611.02,-3229.16 2607.52,-3219.16 2604.02,-3229.16 2611.02,-3229.16"/>
</g>
<!-- pp_stage1_layer2_expert6_down&#45;&gt;pp_stage1_layer2_route_back_expert6 -->
<g id="edge275" class="edge">
<title>pp_stage1_layer2_expert6_down&#45;&gt;pp_stage1_layer2_route_back_expert6</title>
<path fill="none" stroke="black" d="M2304.36,-3150.63C2304.36,-3150.63 2304.36,-3041.09 2304.36,-3041.09"/>
<polygon fill="black" stroke="black" points="2307.86,-3041.09 2304.36,-3031.09 2300.86,-3041.09 2307.86,-3041.09"/>
</g>
<!-- pp_stage1_layer2_route_back_expert6&#45;&gt;pp_stage1_layer2_expert_agg -->
<g id="edge328" class="edge">
<title>pp_stage1_layer2_route_back_expert6&#45;&gt;pp_stage1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M2457.4,-2915.83C2457.4,-2849.39 2457.4,-2736 2457.4,-2736 2457.4,-2736 8342.76,-2736 8342.76,-2736"/>
<polygon fill="black" stroke="black" points="8342.76,-2739.5 8352.76,-2736 8342.76,-2732.5 8342.76,-2739.5"/>
</g>
<!-- pp_stage1_layer2_expert7_activation -->
<g id="node199" class="node">
<title>pp_stage1_layer2_expert7_activation</title>
<polygon fill="lightyellow" stroke="black" points="4598.27,-3406.83 4092.27,-3406.83 4092.27,-3338.83 4598.27,-3338.83 4598.27,-3406.83"/>
<text text-anchor="middle" x="4345.27" y="-3391.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="4345.27" y="-3376.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="4345.27" y="-3361.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="4345.27" y="-3346.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert7_up&#45;&gt;pp_stage1_layer2_expert7_activation -->
<g id="edge278" class="edge">
<title>pp_stage1_layer2_expert7_up&#45;&gt;pp_stage1_layer2_expert7_activation</title>
<path fill="none" stroke="black" d="M4475.77,-3492.66C4475.77,-3492.66 4475.77,-3416.91 4475.77,-3416.91"/>
<polygon fill="black" stroke="black" points="4479.27,-3416.91 4475.77,-3406.91 4472.27,-3416.91 4479.27,-3416.91"/>
</g>
<!-- pp_stage1_layer2_expert7_down -->
<g id="node200" class="node">
<title>pp_stage1_layer2_expert7_down</title>
<polygon fill="lightcoral" stroke="black" points="3724.77,-3218.83 3227.77,-3218.83 3227.77,-3150.83 3724.77,-3150.83 3724.77,-3218.83"/>
<text text-anchor="middle" x="3476.27" y="-3203.63" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="3476.27" y="-3188.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="3476.27" y="-3173.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3476.27" y="-3158.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert7_activation&#45;&gt;pp_stage1_layer2_expert7_down -->
<g id="edge279" class="edge">
<title>pp_stage1_layer2_expert7_activation&#45;&gt;pp_stage1_layer2_expert7_down</title>
<path fill="none" stroke="black" d="M4127.52,-3338.64C4127.52,-3284.22 4127.52,-3184 4127.52,-3184 4127.52,-3184 3734.8,-3184 3734.8,-3184"/>
<polygon fill="black" stroke="black" points="3734.8,-3180.5 3724.8,-3184 3734.8,-3187.5 3734.8,-3180.5"/>
</g>
<!-- pp_stage1_layer2_expert7_down&#45;&gt;pp_stage1_layer2_route_back_expert7 -->
<g id="edge280" class="edge">
<title>pp_stage1_layer2_expert7_down&#45;&gt;pp_stage1_layer2_route_back_expert7</title>
<path fill="none" stroke="black" d="M3393.36,-3150.63C3393.36,-3150.63 3393.36,-3041.09 3393.36,-3041.09"/>
<polygon fill="black" stroke="black" points="3396.86,-3041.09 3393.36,-3031.09 3389.86,-3041.09 3396.86,-3041.09"/>
</g>
<!-- pp_stage1_layer2_route_back_expert7&#45;&gt;pp_stage1_layer2_expert_agg -->
<g id="edge329" class="edge">
<title>pp_stage1_layer2_route_back_expert7&#45;&gt;pp_stage1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M3684.9,-2962.68C3684.9,-2956.17 3684.9,-2748 3684.9,-2748 3684.9,-2748 8305.15,-2748 8305.15,-2748"/>
<polygon fill="black" stroke="black" points="8305.15,-2751.5 8315.15,-2748 8305.15,-2744.5 8305.15,-2751.5"/>
</g>
<!-- pp_stage1_layer2_expert8_activation -->
<g id="node203" class="node">
<title>pp_stage1_layer2_expert8_activation</title>
<polygon fill="lightyellow" stroke="black" points="5458.27,-3406.83 4952.27,-3406.83 4952.27,-3338.83 5458.27,-3338.83 5458.27,-3406.83"/>
<text text-anchor="middle" x="5205.27" y="-3391.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="5205.27" y="-3376.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="5205.27" y="-3361.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="5205.27" y="-3346.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert8_up&#45;&gt;pp_stage1_layer2_expert8_activation -->
<g id="edge283" class="edge">
<title>pp_stage1_layer2_expert8_up&#45;&gt;pp_stage1_layer2_expert8_activation</title>
<path fill="none" stroke="black" d="M5261.77,-3492.66C5261.77,-3492.66 5261.77,-3416.91 5261.77,-3416.91"/>
<polygon fill="black" stroke="black" points="5265.27,-3416.91 5261.77,-3406.91 5258.27,-3416.91 5265.27,-3416.91"/>
</g>
<!-- pp_stage1_layer2_expert8_down -->
<g id="node204" class="node">
<title>pp_stage1_layer2_expert8_down</title>
<polygon fill="lightcoral" stroke="black" points="4659.77,-3218.83 4162.77,-3218.83 4162.77,-3150.83 4659.77,-3150.83 4659.77,-3218.83"/>
<text text-anchor="middle" x="4411.27" y="-3203.63" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="4411.27" y="-3188.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="4411.27" y="-3173.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4411.27" y="-3158.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert8_activation&#45;&gt;pp_stage1_layer2_expert8_down -->
<g id="edge284" class="edge">
<title>pp_stage1_layer2_expert8_activation&#45;&gt;pp_stage1_layer2_expert8_down</title>
<path fill="none" stroke="black" d="M4952.1,-3372C4797.38,-3372 4629.02,-3372 4629.02,-3372 4629.02,-3372 4629.02,-3229.16 4629.02,-3229.16"/>
<polygon fill="black" stroke="black" points="4632.52,-3229.16 4629.02,-3219.16 4625.52,-3229.16 4632.52,-3229.16"/>
</g>
<!-- pp_stage1_layer2_expert8_down&#45;&gt;pp_stage1_layer2_route_back_expert8 -->
<g id="edge285" class="edge">
<title>pp_stage1_layer2_expert8_down&#45;&gt;pp_stage1_layer2_route_back_expert8</title>
<path fill="none" stroke="black" d="M4411.27,-3150.63C4411.27,-3150.63 4411.27,-3041.09 4411.27,-3041.09"/>
<polygon fill="black" stroke="black" points="4414.77,-3041.09 4411.27,-3031.09 4407.77,-3041.09 4414.77,-3041.09"/>
</g>
<!-- pp_stage1_layer2_route_back_expert8&#45;&gt;pp_stage1_layer2_expert_agg -->
<g id="edge330" class="edge">
<title>pp_stage1_layer2_route_back_expert8&#45;&gt;pp_stage1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M4354.25,-2894.73C4354.25,-2835.8 4354.25,-2760 4354.25,-2760 4354.25,-2760 8292.83,-2760 8292.83,-2760"/>
<polygon fill="black" stroke="black" points="8292.83,-2763.5 8302.83,-2760 8292.83,-2756.5 8292.83,-2763.5"/>
</g>
<!-- pp_stage1_layer2_expert9_activation -->
<g id="node207" class="node">
<title>pp_stage1_layer2_expert9_activation</title>
<polygon fill="lightyellow" stroke="black" points="6360.27,-3406.83 5854.27,-3406.83 5854.27,-3338.83 6360.27,-3338.83 6360.27,-3406.83"/>
<text text-anchor="middle" x="6107.27" y="-3391.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="6107.27" y="-3376.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="6107.27" y="-3361.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="6107.27" y="-3346.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert9_up&#45;&gt;pp_stage1_layer2_expert9_activation -->
<g id="edge288" class="edge">
<title>pp_stage1_layer2_expert9_up&#45;&gt;pp_stage1_layer2_expert9_activation</title>
<path fill="none" stroke="black" d="M6219.77,-3492.66C6219.77,-3492.66 6219.77,-3416.91 6219.77,-3416.91"/>
<polygon fill="black" stroke="black" points="6223.27,-3416.91 6219.77,-3406.91 6216.27,-3416.91 6223.27,-3416.91"/>
</g>
<!-- pp_stage1_layer2_expert9_down -->
<g id="node208" class="node">
<title>pp_stage1_layer2_expert9_down</title>
<polygon fill="lightcoral" stroke="black" points="5995.77,-3218.83 5498.77,-3218.83 5498.77,-3150.83 5995.77,-3150.83 5995.77,-3218.83"/>
<text text-anchor="middle" x="5747.27" y="-3203.63" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="5747.27" y="-3188.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="5747.27" y="-3173.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5747.27" y="-3158.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert9_activation&#45;&gt;pp_stage1_layer2_expert9_down -->
<g id="edge289" class="edge">
<title>pp_stage1_layer2_expert9_activation&#45;&gt;pp_stage1_layer2_expert9_down</title>
<path fill="none" stroke="black" d="M5925.02,-3338.79C5925.02,-3338.79 5925.02,-3228.94 5925.02,-3228.94"/>
<polygon fill="black" stroke="black" points="5928.52,-3228.94 5925.02,-3218.94 5921.52,-3228.94 5928.52,-3228.94"/>
</g>
<!-- pp_stage1_layer2_expert9_down&#45;&gt;pp_stage1_layer2_route_back_expert9 -->
<g id="edge290" class="edge">
<title>pp_stage1_layer2_expert9_down&#45;&gt;pp_stage1_layer2_route_back_expert9</title>
<path fill="none" stroke="black" d="M5633.36,-3150.63C5633.36,-3150.63 5633.36,-3041.09 5633.36,-3041.09"/>
<polygon fill="black" stroke="black" points="5636.86,-3041.09 5633.36,-3031.09 5629.86,-3041.09 5636.86,-3041.09"/>
</g>
<!-- pp_stage1_layer2_route_back_expert9&#45;&gt;pp_stage1_layer2_expert_agg -->
<g id="edge331" class="edge">
<title>pp_stage1_layer2_route_back_expert9&#45;&gt;pp_stage1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M5890.4,-2962.69C5890.4,-2956.92 5890.4,-2772 5890.4,-2772 5890.4,-2772 8302.24,-2772 8302.24,-2772"/>
<polygon fill="black" stroke="black" points="8302.24,-2775.5 8312.24,-2772 8302.24,-2768.5 8302.24,-2775.5"/>
</g>
<!-- pp_stage1_layer2_expert10_activation -->
<g id="node211" class="node">
<title>pp_stage1_layer2_expert10_activation</title>
<polygon fill="lightyellow" stroke="black" points="7374.27,-3406.83 6868.27,-3406.83 6868.27,-3338.83 7374.27,-3338.83 7374.27,-3406.83"/>
<text text-anchor="middle" x="7121.27" y="-3391.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7121.27" y="-3376.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7121.27" y="-3361.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7121.27" y="-3346.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert10_up&#45;&gt;pp_stage1_layer2_expert10_activation -->
<g id="edge293" class="edge">
<title>pp_stage1_layer2_expert10_up&#45;&gt;pp_stage1_layer2_expert10_activation</title>
<path fill="none" stroke="black" d="M7121.27,-3492.66C7121.27,-3492.66 7121.27,-3416.91 7121.27,-3416.91"/>
<polygon fill="black" stroke="black" points="7124.77,-3416.91 7121.27,-3406.91 7117.77,-3416.91 7124.77,-3416.91"/>
</g>
<!-- pp_stage1_layer2_expert10_down -->
<g id="node212" class="node">
<title>pp_stage1_layer2_expert10_down</title>
<polygon fill="lightcoral" stroke="black" points="7144.77,-3218.83 6647.77,-3218.83 6647.77,-3150.83 7144.77,-3150.83 7144.77,-3218.83"/>
<text text-anchor="middle" x="6896.27" y="-3203.63" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="6896.27" y="-3188.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="6896.27" y="-3173.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6896.27" y="-3158.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert10_activation&#45;&gt;pp_stage1_layer2_expert10_down -->
<g id="edge294" class="edge">
<title>pp_stage1_layer2_expert10_activation&#45;&gt;pp_stage1_layer2_expert10_down</title>
<path fill="none" stroke="black" d="M7006.52,-3338.79C7006.52,-3338.79 7006.52,-3228.94 7006.52,-3228.94"/>
<polygon fill="black" stroke="black" points="7010.02,-3228.94 7006.52,-3218.94 7003.02,-3228.94 7010.02,-3228.94"/>
</g>
<!-- pp_stage1_layer2_expert10_down&#45;&gt;pp_stage1_layer2_route_back_expert10 -->
<g id="edge295" class="edge">
<title>pp_stage1_layer2_expert10_down&#45;&gt;pp_stage1_layer2_route_back_expert10</title>
<path fill="none" stroke="black" d="M6762.36,-3150.63C6762.36,-3150.63 6762.36,-3041.09 6762.36,-3041.09"/>
<polygon fill="black" stroke="black" points="6765.86,-3041.09 6762.36,-3031.09 6758.86,-3041.09 6765.86,-3041.09"/>
</g>
<!-- pp_stage1_layer2_route_back_expert10&#45;&gt;pp_stage1_layer2_expert_agg -->
<g id="edge332" class="edge">
<title>pp_stage1_layer2_route_back_expert10&#45;&gt;pp_stage1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M6793.9,-2903.28C6793.9,-2851.26 6793.9,-2784 6793.9,-2784 6793.9,-2784 8336.54,-2784 8336.54,-2784"/>
<polygon fill="black" stroke="black" points="8336.54,-2787.5 8346.54,-2784 8336.54,-2780.5 8336.54,-2787.5"/>
</g>
<!-- pp_stage1_layer2_expert11_activation -->
<g id="node215" class="node">
<title>pp_stage1_layer2_expert11_activation</title>
<polygon fill="lightyellow" stroke="black" points="7938.27,-3406.83 7432.27,-3406.83 7432.27,-3338.83 7938.27,-3338.83 7938.27,-3406.83"/>
<text text-anchor="middle" x="7685.27" y="-3391.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7685.27" y="-3376.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7685.27" y="-3361.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7685.27" y="-3346.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert11_up&#45;&gt;pp_stage1_layer2_expert11_activation -->
<g id="edge298" class="edge">
<title>pp_stage1_layer2_expert11_up&#45;&gt;pp_stage1_layer2_expert11_activation</title>
<path fill="none" stroke="black" d="M7771.27,-3492.66C7771.27,-3492.66 7771.27,-3416.91 7771.27,-3416.91"/>
<polygon fill="black" stroke="black" points="7774.77,-3416.91 7771.27,-3406.91 7767.77,-3416.91 7774.77,-3416.91"/>
</g>
<!-- pp_stage1_layer2_expert11_down -->
<g id="node216" class="node">
<title>pp_stage1_layer2_expert11_down</title>
<polygon fill="lightcoral" stroke="black" points="7816.77,-3218.83 7319.77,-3218.83 7319.77,-3150.83 7816.77,-3150.83 7816.77,-3218.83"/>
<text text-anchor="middle" x="7568.27" y="-3203.63" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="7568.27" y="-3188.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7568.27" y="-3173.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7568.27" y="-3158.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert11_activation&#45;&gt;pp_stage1_layer2_expert11_down -->
<g id="edge299" class="edge">
<title>pp_stage1_layer2_expert11_activation&#45;&gt;pp_stage1_layer2_expert11_down</title>
<path fill="none" stroke="black" d="M7624.52,-3338.79C7624.52,-3338.79 7624.52,-3228.94 7624.52,-3228.94"/>
<polygon fill="black" stroke="black" points="7628.02,-3228.94 7624.52,-3218.94 7621.02,-3228.94 7628.02,-3228.94"/>
</g>
<!-- pp_stage1_layer2_expert11_down&#45;&gt;pp_stage1_layer2_route_back_expert11 -->
<g id="edge300" class="edge">
<title>pp_stage1_layer2_expert11_down&#45;&gt;pp_stage1_layer2_route_back_expert11</title>
<path fill="none" stroke="black" d="M7568.27,-3150.63C7568.27,-3150.63 7568.27,-3041.09 7568.27,-3041.09"/>
<polygon fill="black" stroke="black" points="7571.77,-3041.09 7568.27,-3031.09 7564.77,-3041.09 7571.77,-3041.09"/>
</g>
<!-- pp_stage1_layer2_route_back_expert11&#45;&gt;pp_stage1_layer2_expert_agg -->
<g id="edge333" class="edge">
<title>pp_stage1_layer2_route_back_expert11&#45;&gt;pp_stage1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M8003.4,-2962.71C8003.4,-2957.66 8003.4,-2796 8003.4,-2796 8003.4,-2796 8405.14,-2796 8405.14,-2796"/>
<polygon fill="black" stroke="black" points="8405.14,-2799.5 8415.14,-2796 8405.14,-2792.5 8405.14,-2799.5"/>
</g>
<!-- pp_stage1_layer2_expert12_activation -->
<g id="node219" class="node">
<title>pp_stage1_layer2_expert12_activation</title>
<polygon fill="lightyellow" stroke="black" points="8631.27,-3406.83 8125.27,-3406.83 8125.27,-3338.83 8631.27,-3338.83 8631.27,-3406.83"/>
<text text-anchor="middle" x="8378.27" y="-3391.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="8378.27" y="-3376.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="8378.27" y="-3361.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="8378.27" y="-3346.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert12_up&#45;&gt;pp_stage1_layer2_expert12_activation -->
<g id="edge303" class="edge">
<title>pp_stage1_layer2_expert12_up&#45;&gt;pp_stage1_layer2_expert12_activation</title>
<path fill="none" stroke="black" d="M8442.77,-3492.66C8442.77,-3492.66 8442.77,-3416.91 8442.77,-3416.91"/>
<polygon fill="black" stroke="black" points="8446.27,-3416.91 8442.77,-3406.91 8439.27,-3416.91 8446.27,-3416.91"/>
</g>
<!-- pp_stage1_layer2_expert12_down -->
<g id="node220" class="node">
<title>pp_stage1_layer2_expert12_down</title>
<polygon fill="lightcoral" stroke="black" points="8373.77,-3218.83 7876.77,-3218.83 7876.77,-3150.83 8373.77,-3150.83 8373.77,-3218.83"/>
<text text-anchor="middle" x="8125.27" y="-3203.63" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="8125.27" y="-3188.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="8125.27" y="-3173.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8125.27" y="-3158.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert12_activation&#45;&gt;pp_stage1_layer2_expert12_down -->
<g id="edge304" class="edge">
<title>pp_stage1_layer2_expert12_activation&#45;&gt;pp_stage1_layer2_expert12_down</title>
<path fill="none" stroke="black" d="M8249.52,-3338.79C8249.52,-3338.79 8249.52,-3228.94 8249.52,-3228.94"/>
<polygon fill="black" stroke="black" points="8253.02,-3228.94 8249.52,-3218.94 8246.02,-3228.94 8253.02,-3228.94"/>
</g>
<!-- pp_stage1_layer2_expert12_down&#45;&gt;pp_stage1_layer2_route_back_expert12 -->
<g id="edge305" class="edge">
<title>pp_stage1_layer2_expert12_down&#45;&gt;pp_stage1_layer2_route_back_expert12</title>
<path fill="none" stroke="black" d="M8256.38,-3150.63C8256.38,-3150.63 8256.38,-2980.51 8256.38,-2980.51"/>
<polygon fill="black" stroke="black" points="8259.88,-2980.51 8256.38,-2970.51 8252.88,-2980.51 8259.88,-2980.51"/>
</g>
<!-- pp_stage1_layer2_route_back_expert12&#45;&gt;pp_stage1_layer2_expert_agg -->
<g id="edge334" class="edge">
<title>pp_stage1_layer2_route_back_expert12&#45;&gt;pp_stage1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M8654.27,-2894.7C8654.27,-2894.7 8654.27,-2819.13 8654.27,-2819.13"/>
<polygon fill="black" stroke="black" points="8657.77,-2819.13 8654.27,-2809.13 8650.77,-2819.13 8657.77,-2819.13"/>
</g>
<!-- pp_stage1_layer2_expert13_activation -->
<g id="node223" class="node">
<title>pp_stage1_layer2_expert13_activation</title>
<polygon fill="lightyellow" stroke="black" points="9995.27,-3406.83 9489.27,-3406.83 9489.27,-3338.83 9995.27,-3338.83 9995.27,-3406.83"/>
<text text-anchor="middle" x="9742.27" y="-3391.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="9742.27" y="-3376.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9742.27" y="-3361.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9742.27" y="-3346.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert13_up&#45;&gt;pp_stage1_layer2_expert13_activation -->
<g id="edge308" class="edge">
<title>pp_stage1_layer2_expert13_up&#45;&gt;pp_stage1_layer2_expert13_activation</title>
<path fill="none" stroke="black" d="M9513.27,-3492.66C9513.27,-3492.66 9513.27,-3416.91 9513.27,-3416.91"/>
<polygon fill="black" stroke="black" points="9516.77,-3416.91 9513.27,-3406.91 9509.77,-3416.91 9516.77,-3416.91"/>
</g>
<!-- pp_stage1_layer2_expert13_down -->
<g id="node224" class="node">
<title>pp_stage1_layer2_expert13_down</title>
<polygon fill="lightcoral" stroke="black" points="9991.77,-3218.83 9494.77,-3218.83 9494.77,-3150.83 9991.77,-3150.83 9991.77,-3218.83"/>
<text text-anchor="middle" x="9743.27" y="-3203.63" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="9743.27" y="-3188.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9743.27" y="-3173.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9743.27" y="-3158.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert13_activation&#45;&gt;pp_stage1_layer2_expert13_down -->
<g id="edge309" class="edge">
<title>pp_stage1_layer2_expert13_activation&#45;&gt;pp_stage1_layer2_expert13_down</title>
<path fill="none" stroke="black" d="M9743.27,-3338.79C9743.27,-3338.79 9743.27,-3228.94 9743.27,-3228.94"/>
<polygon fill="black" stroke="black" points="9746.77,-3228.94 9743.27,-3218.94 9739.77,-3228.94 9746.77,-3228.94"/>
</g>
<!-- pp_stage1_layer2_expert13_down&#45;&gt;pp_stage1_layer2_route_back_expert13 -->
<g id="edge310" class="edge">
<title>pp_stage1_layer2_expert13_down&#45;&gt;pp_stage1_layer2_route_back_expert13</title>
<path fill="none" stroke="black" d="M9743.27,-3150.63C9743.27,-3150.63 9743.27,-3041.09 9743.27,-3041.09"/>
<polygon fill="black" stroke="black" points="9746.77,-3041.09 9743.27,-3031.09 9739.77,-3041.09 9746.77,-3041.09"/>
</g>
<!-- pp_stage1_layer2_route_back_expert13&#45;&gt;pp_stage1_layer2_expert_agg -->
<g id="edge335" class="edge">
<title>pp_stage1_layer2_route_back_expert13&#45;&gt;pp_stage1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M9277.13,-2962.71C9277.13,-2957.72 9277.13,-2798 9277.13,-2798 9277.13,-2798 8886.5,-2798 8886.5,-2798"/>
<polygon fill="black" stroke="black" points="8886.5,-2794.5 8876.5,-2798 8886.5,-2801.5 8886.5,-2794.5"/>
</g>
<!-- pp_stage1_layer2_expert14_activation -->
<g id="node227" class="node">
<title>pp_stage1_layer2_expert14_activation</title>
<polygon fill="lightyellow" stroke="black" points="10559.27,-3406.83 10053.27,-3406.83 10053.27,-3338.83 10559.27,-3338.83 10559.27,-3406.83"/>
<text text-anchor="middle" x="10306.27" y="-3391.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="10306.27" y="-3376.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10306.27" y="-3361.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10306.27" y="-3346.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert14_up&#45;&gt;pp_stage1_layer2_expert14_activation -->
<g id="edge313" class="edge">
<title>pp_stage1_layer2_expert14_up&#45;&gt;pp_stage1_layer2_expert14_activation</title>
<path fill="none" stroke="black" d="M10090.27,-3492.66C10090.27,-3492.66 10090.27,-3416.91 10090.27,-3416.91"/>
<polygon fill="black" stroke="black" points="10093.77,-3416.91 10090.27,-3406.91 10086.77,-3416.91 10093.77,-3416.91"/>
</g>
<!-- pp_stage1_layer2_expert14_down -->
<g id="node228" class="node">
<title>pp_stage1_layer2_expert14_down</title>
<polygon fill="lightcoral" stroke="black" points="10813.77,-3218.83 10316.77,-3218.83 10316.77,-3150.83 10813.77,-3150.83 10813.77,-3218.83"/>
<text text-anchor="middle" x="10565.27" y="-3203.63" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="10565.27" y="-3188.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10565.27" y="-3173.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10565.27" y="-3158.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert14_activation&#45;&gt;pp_stage1_layer2_expert14_down -->
<g id="edge314" class="edge">
<title>pp_stage1_layer2_expert14_activation&#45;&gt;pp_stage1_layer2_expert14_down</title>
<path fill="none" stroke="black" d="M10438.02,-3338.79C10438.02,-3338.79 10438.02,-3228.94 10438.02,-3228.94"/>
<polygon fill="black" stroke="black" points="10441.52,-3228.94 10438.02,-3218.94 10434.52,-3228.94 10441.52,-3228.94"/>
</g>
<!-- pp_stage1_layer2_expert14_down&#45;&gt;pp_stage1_layer2_route_back_expert14 -->
<g id="edge315" class="edge">
<title>pp_stage1_layer2_expert14_down&#45;&gt;pp_stage1_layer2_route_back_expert14</title>
<path fill="none" stroke="black" d="M10648.18,-3150.63C10648.18,-3150.63 10648.18,-3041.09 10648.18,-3041.09"/>
<polygon fill="black" stroke="black" points="10651.68,-3041.09 10648.18,-3031.09 10644.68,-3041.09 10651.68,-3041.09"/>
</g>
<!-- pp_stage1_layer2_route_back_expert14&#45;&gt;pp_stage1_layer2_expert_agg -->
<g id="edge336" class="edge">
<title>pp_stage1_layer2_route_back_expert14&#45;&gt;pp_stage1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M10376.63,-2962.71C10376.63,-2957.38 10376.63,-2787 10376.63,-2787 10376.63,-2787 8958.88,-2787 8958.88,-2787"/>
<polygon fill="black" stroke="black" points="8958.88,-2783.5 8948.88,-2787 8958.88,-2790.5 8958.88,-2783.5"/>
</g>
<!-- pp_stage1_layer2_expert15_activation -->
<g id="node231" class="node">
<title>pp_stage1_layer2_expert15_activation</title>
<polygon fill="lightyellow" stroke="black" points="11123.27,-3406.83 10617.27,-3406.83 10617.27,-3338.83 11123.27,-3338.83 11123.27,-3406.83"/>
<text text-anchor="middle" x="10870.27" y="-3391.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="10870.27" y="-3376.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10870.27" y="-3361.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10870.27" y="-3346.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert15_up&#45;&gt;pp_stage1_layer2_expert15_activation -->
<g id="edge318" class="edge">
<title>pp_stage1_layer2_expert15_up&#45;&gt;pp_stage1_layer2_expert15_activation</title>
<path fill="none" stroke="black" d="M10660.77,-3492.66C10660.77,-3492.66 10660.77,-3416.91 10660.77,-3416.91"/>
<polygon fill="black" stroke="black" points="10664.27,-3416.91 10660.77,-3406.91 10657.27,-3416.91 10664.27,-3416.91"/>
</g>
<!-- pp_stage1_layer2_expert15_down -->
<g id="node232" class="node">
<title>pp_stage1_layer2_expert15_down</title>
<polygon fill="lightcoral" stroke="black" points="11768.77,-3218.83 11271.77,-3218.83 11271.77,-3150.83 11768.77,-3150.83 11768.77,-3218.83"/>
<text text-anchor="middle" x="11520.27" y="-3203.63" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="11520.27" y="-3188.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11520.27" y="-3173.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11520.27" y="-3158.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_expert15_activation&#45;&gt;pp_stage1_layer2_expert15_down -->
<g id="edge319" class="edge">
<title>pp_stage1_layer2_expert15_activation&#45;&gt;pp_stage1_layer2_expert15_down</title>
<path fill="none" stroke="black" d="M10968.52,-3338.64C10968.52,-3284.22 10968.52,-3184 10968.52,-3184 10968.52,-3184 11261.43,-3184 11261.43,-3184"/>
<polygon fill="black" stroke="black" points="11261.43,-3187.5 11271.43,-3184 11261.43,-3180.5 11261.43,-3187.5"/>
</g>
<!-- pp_stage1_layer2_expert15_down&#45;&gt;pp_stage1_layer2_route_back_expert15 -->
<g id="edge320" class="edge">
<title>pp_stage1_layer2_expert15_down&#45;&gt;pp_stage1_layer2_route_back_expert15</title>
<path fill="none" stroke="black" d="M11647.84,-3150.63C11647.84,-3150.63 11647.84,-3041.09 11647.84,-3041.09"/>
<polygon fill="black" stroke="black" points="11651.34,-3041.09 11647.84,-3031.09 11644.34,-3041.09 11651.34,-3041.09"/>
</g>
<!-- pp_stage1_layer2_route_back_expert15&#45;&gt;pp_stage1_layer2_expert_agg -->
<g id="edge337" class="edge">
<title>pp_stage1_layer2_route_back_expert15&#45;&gt;pp_stage1_layer2_expert_agg</title>
<path fill="none" stroke="black" d="M11500.13,-2894.59C11500.13,-2841.22 11500.13,-2776 11500.13,-2776 11500.13,-2776 8997.69,-2776 8997.69,-2776"/>
<polygon fill="black" stroke="black" points="8997.69,-2772.5 8987.69,-2776 8997.69,-2779.5 8997.69,-2772.5"/>
</g>
<!-- pp_stage1_layer2_expert_agg&#45;&gt;pp_stage1_layer2_final_residual -->
<g id="edge339" class="edge">
<title>pp_stage1_layer2_expert_agg&#45;&gt;pp_stage1_layer2_final_residual</title>
<path fill="none" stroke="black" d="M8345.98,-2737.6C8345.98,-2688.43 8345.98,-2578 8345.98,-2578 8345.98,-2578 5197.76,-2578 5197.76,-2578"/>
<polygon fill="black" stroke="black" points="5197.76,-2574.5 5187.76,-2578 5197.76,-2581.5 5197.76,-2574.5"/>
</g>
<!-- pp_stage1_layer3_norm -->
<g id="node236" class="node">
<title>pp_stage1_layer3_norm</title>
<polygon fill="lightyellow" stroke="black" points="5074.77,-2444.5 4577.77,-2444.5 4577.77,-2376.5 5074.77,-2376.5 5074.77,-2444.5"/>
<text text-anchor="middle" x="4826.27" y="-2429.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="4826.27" y="-2414.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4826.27" y="-2399.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4826.27" y="-2384.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_final_residual&#45;&gt;pp_stage1_layer3_norm -->
<g id="edge340" class="edge">
<title>pp_stage1_layer2_final_residual&#45;&gt;pp_stage1_layer3_norm</title>
<path fill="none" stroke="black" d="M4826.27,-2535.3C4826.27,-2535.3 4826.27,-2454.63 4826.27,-2454.63"/>
<polygon fill="black" stroke="black" points="4829.77,-2454.63 4826.27,-2444.63 4822.77,-2454.63 4829.77,-2454.63"/>
</g>
<!-- pp_stage1_layer3_attn_residual -->
<g id="node244" class="node">
<title>pp_stage1_layer3_attn_residual</title>
<ellipse fill="lightblue" stroke="black" cx="4541.27" cy="-1472.42" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="4541.27" y="-1491.22" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4541.27" y="-1476.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096], [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4541.27" y="-1461.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4541.27" y="-1446.22" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer2_final_residual&#45;&gt;pp_stage1_layer3_attn_residual -->
<g id="edge350" class="edge">
<title>pp_stage1_layer2_final_residual&#45;&gt;pp_stage1_layer3_attn_residual</title>
<path fill="none" stroke="black" d="M4178.12,-2538.56C4178.12,-2538.56 4178.12,-1522.39 4178.12,-1522.39"/>
<polygon fill="black" stroke="black" points="4181.62,-1522.39 4178.12,-1512.39 4174.62,-1522.39 4181.62,-1522.39"/>
</g>
<!-- pp_stage1_layer3_q_proj -->
<g id="node237" class="node">
<title>pp_stage1_layer3_q_proj</title>
<polygon fill="lightgreen" stroke="black" points="5198.27,-2290.5 4688.27,-2290.5 4688.27,-2222.5 5198.27,-2222.5 5198.27,-2290.5"/>
<text text-anchor="middle" x="4943.27" y="-2275.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4943.27" y="-2260.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4943.27" y="-2245.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4943.27" y="-2230.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_norm&#45;&gt;pp_stage1_layer3_q_proj -->
<g id="edge341" class="edge">
<title>pp_stage1_layer3_norm&#45;&gt;pp_stage1_layer3_q_proj</title>
<path fill="none" stroke="black" d="M4881.52,-2376.32C4881.52,-2376.32 4881.52,-2300.58 4881.52,-2300.58"/>
<polygon fill="black" stroke="black" points="4885.02,-2300.58 4881.52,-2290.58 4878.02,-2300.58 4885.02,-2300.58"/>
</g>
<!-- pp_stage1_layer3_k_proj -->
<g id="node238" class="node">
<title>pp_stage1_layer3_k_proj</title>
<polygon fill="lightgreen" stroke="black" points="5766.27,-2290.5 5256.27,-2290.5 5256.27,-2222.5 5766.27,-2222.5 5766.27,-2290.5"/>
<text text-anchor="middle" x="5511.27" y="-2275.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5511.27" y="-2260.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5511.27" y="-2245.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5511.27" y="-2230.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_norm&#45;&gt;pp_stage1_layer3_k_proj -->
<g id="edge342" class="edge">
<title>pp_stage1_layer3_norm&#45;&gt;pp_stage1_layer3_k_proj</title>
<path fill="none" stroke="black" d="M5075.02,-2410C5270.97,-2410 5511.27,-2410 5511.27,-2410 5511.27,-2410 5511.27,-2300.57 5511.27,-2300.57"/>
<polygon fill="black" stroke="black" points="5514.77,-2300.57 5511.27,-2290.57 5507.77,-2300.57 5514.77,-2300.57"/>
</g>
<!-- pp_stage1_layer3_v_proj -->
<g id="node239" class="node">
<title>pp_stage1_layer3_v_proj</title>
<polygon fill="lightgreen" stroke="black" points="4971.27,-2136.5 4461.27,-2136.5 4461.27,-2068.5 4971.27,-2068.5 4971.27,-2136.5"/>
<text text-anchor="middle" x="4716.27" y="-2121.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4716.27" y="-2106.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4716.27" y="-2091.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4716.27" y="-2076.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_norm&#45;&gt;pp_stage1_layer3_v_proj -->
<g id="edge343" class="edge">
<title>pp_stage1_layer3_norm&#45;&gt;pp_stage1_layer3_v_proj</title>
<path fill="none" stroke="black" d="M4633.02,-2376.36C4633.02,-2376.36 4633.02,-2146.79 4633.02,-2146.79"/>
<polygon fill="black" stroke="black" points="4636.52,-2146.79 4633.02,-2136.79 4629.52,-2146.79 4636.52,-2146.79"/>
</g>
<!-- pp_stage1_layer3_attn_scores -->
<g id="node240" class="node">
<title>pp_stage1_layer3_attn_scores</title>
<polygon fill="lightyellow" stroke="black" points="5577.27,-2136.5 5029.27,-2136.5 5029.27,-2068.5 5577.27,-2068.5 5577.27,-2136.5"/>
<text text-anchor="middle" x="5303.27" y="-2121.3" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="5303.27" y="-2106.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5303.27" y="-2091.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=32, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="5303.27" y="-2076.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_q_proj&#45;&gt;pp_stage1_layer3_attn_scores -->
<g id="edge344" class="edge">
<title>pp_stage1_layer3_q_proj&#45;&gt;pp_stage1_layer3_attn_scores</title>
<path fill="none" stroke="black" d="M5113.77,-2222.32C5113.77,-2222.32 5113.77,-2146.58 5113.77,-2146.58"/>
<polygon fill="black" stroke="black" points="5117.27,-2146.58 5113.77,-2136.58 5110.27,-2146.58 5117.27,-2146.58"/>
</g>
<!-- pp_stage1_layer3_k_proj&#45;&gt;pp_stage1_layer3_attn_scores -->
<g id="edge345" class="edge">
<title>pp_stage1_layer3_k_proj&#45;&gt;pp_stage1_layer3_attn_scores</title>
<path fill="none" stroke="black" d="M5416.77,-2222.32C5416.77,-2222.32 5416.77,-2146.58 5416.77,-2146.58"/>
<polygon fill="black" stroke="black" points="5420.27,-2146.58 5416.77,-2136.58 5413.27,-2146.58 5420.27,-2146.58"/>
</g>
<!-- pp_stage1_layer3_attn_out -->
<g id="node242" class="node">
<title>pp_stage1_layer3_attn_out</title>
<polygon fill="lightyellow" stroke="black" points="4997.27,-1828.5 4461.27,-1828.5 4461.27,-1760.5 4997.27,-1760.5 4997.27,-1828.5"/>
<text text-anchor="middle" x="4729.27" y="-1813.3" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="4729.27" y="-1798.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=32, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="4729.27" y="-1783.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4729.27" y="-1768.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_v_proj&#45;&gt;pp_stage1_layer3_attn_out -->
<g id="edge348" class="edge">
<title>pp_stage1_layer3_v_proj&#45;&gt;pp_stage1_layer3_attn_out</title>
<path fill="none" stroke="black" d="M4691.77,-2068.36C4691.77,-2068.36 4691.77,-1838.79 4691.77,-1838.79"/>
<polygon fill="black" stroke="black" points="4695.27,-1838.79 4691.77,-1828.79 4688.27,-1838.79 4695.27,-1838.79"/>
</g>
<!-- pp_stage1_layer3_softmax -->
<g id="node241" class="node">
<title>pp_stage1_layer3_softmax</title>
<polygon fill="lightyellow" stroke="black" points="5470.27,-1982.5 4922.27,-1982.5 4922.27,-1914.5 5470.27,-1914.5 5470.27,-1982.5"/>
<text text-anchor="middle" x="5196.27" y="-1967.3" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="5196.27" y="-1952.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=32, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="5196.27" y="-1937.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=32, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="5196.27" y="-1922.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_attn_scores&#45;&gt;pp_stage1_layer3_softmax -->
<g id="edge346" class="edge">
<title>pp_stage1_layer3_attn_scores&#45;&gt;pp_stage1_layer3_softmax</title>
<path fill="none" stroke="black" d="M5249.77,-2068.32C5249.77,-2068.32 5249.77,-1992.58 5249.77,-1992.58"/>
<polygon fill="black" stroke="black" points="5253.27,-1992.58 5249.77,-1982.58 5246.27,-1992.58 5253.27,-1992.58"/>
</g>
<!-- pp_stage1_layer3_softmax&#45;&gt;pp_stage1_layer3_attn_out -->
<g id="edge347" class="edge">
<title>pp_stage1_layer3_softmax&#45;&gt;pp_stage1_layer3_attn_out</title>
<path fill="none" stroke="black" d="M4959.77,-1914.32C4959.77,-1914.32 4959.77,-1838.58 4959.77,-1838.58"/>
<polygon fill="black" stroke="black" points="4963.27,-1838.58 4959.77,-1828.58 4956.27,-1838.58 4963.27,-1838.58"/>
</g>
<!-- pp_stage1_layer3_out_proj -->
<g id="node243" class="node">
<title>pp_stage1_layer3_out_proj</title>
<polygon fill="lightgreen" stroke="black" points="4968.27,-1674.5 4470.27,-1674.5 4470.27,-1606.5 4968.27,-1606.5 4968.27,-1674.5"/>
<text text-anchor="middle" x="4719.27" y="-1659.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4719.27" y="-1644.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4719.27" y="-1629.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4719.27" y="-1614.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_attn_out&#45;&gt;pp_stage1_layer3_out_proj -->
<g id="edge349" class="edge">
<title>pp_stage1_layer3_attn_out&#45;&gt;pp_stage1_layer3_out_proj</title>
<path fill="none" stroke="black" d="M4719.27,-1760.32C4719.27,-1760.32 4719.27,-1684.58 4719.27,-1684.58"/>
<polygon fill="black" stroke="black" points="4722.77,-1684.58 4719.27,-1674.58 4715.77,-1684.58 4722.77,-1684.58"/>
</g>
<!-- pp_stage1_layer3_out_proj&#45;&gt;pp_stage1_layer3_attn_residual -->
<g id="edge351" class="edge">
<title>pp_stage1_layer3_out_proj&#45;&gt;pp_stage1_layer3_attn_residual</title>
<path fill="none" stroke="black" d="M4719.27,-1606.49C4719.27,-1606.49 4719.27,-1528.8 4719.27,-1528.8"/>
<polygon fill="black" stroke="black" points="4722.77,-1528.8 4719.27,-1518.8 4715.77,-1528.8 4722.77,-1528.8"/>
</g>
<!-- pp_stage1_layer3_moe_norm -->
<g id="node245" class="node">
<title>pp_stage1_layer3_moe_norm</title>
<polygon fill="lightyellow" stroke="black" points="9224.77,-1338.33 8727.77,-1338.33 8727.77,-1270.33 9224.77,-1270.33 9224.77,-1338.33"/>
<text text-anchor="middle" x="8976.27" y="-1323.13" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="8976.27" y="-1308.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8976.27" y="-1293.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8976.27" y="-1278.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_attn_residual&#45;&gt;pp_stage1_layer3_moe_norm -->
<g id="edge352" class="edge">
<title>pp_stage1_layer3_attn_residual&#45;&gt;pp_stage1_layer3_moe_norm</title>
<path fill="none" stroke="black" d="M5066.91,-1444.28C5066.91,-1402.77 5066.91,-1330 5066.91,-1330 5066.91,-1330 8717.64,-1330 8717.64,-1330"/>
<polygon fill="black" stroke="black" points="8717.64,-1333.5 8727.64,-1330 8717.64,-1326.5 8717.64,-1333.5"/>
</g>
<!-- pp_stage1_layer3_final_residual -->
<g id="node312" class="node">
<title>pp_stage1_layer3_final_residual</title>
<ellipse fill="lightblue" stroke="black" cx="4792.27" cy="-202.08" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="4792.27" y="-220.88" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="4792.27" y="-205.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096], [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4792.27" y="-190.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4792.27" y="-175.88" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_attn_residual&#45;&gt;pp_stage1_layer3_final_residual -->
<g id="edge450" class="edge">
<title>pp_stage1_layer3_attn_residual&#45;&gt;pp_stage1_layer3_final_residual</title>
<path fill="none" stroke="black" d="M4694.77,-1425.42C4694.77,-1319.84 4694.77,-1073 4694.77,-1073 4694.77,-1073 5114.88,-1073 5114.88,-1073 5114.88,-1073 5114.88,-253.8 5114.88,-253.8"/>
<polygon fill="black" stroke="black" points="5118.38,-253.8 5114.88,-243.8 5111.38,-253.8 5118.38,-253.8"/>
</g>
<!-- pp_stage1_layer3_gate -->
<g id="node246" class="node">
<title>pp_stage1_layer3_gate</title>
<polygon fill="lightpink" stroke="black" points="9687.92,-876.33 8888.31,-876.33 8682.62,-740.33 9482.22,-740.33 9687.92,-876.33"/>
<text text-anchor="middle" x="9185.27" y="-827.13" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="9185.27" y="-812.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9185.27" y="-797.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="9185.27" y="-782.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_gate -->
<g id="edge353" class="edge">
<title>pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_gate</title>
<path fill="none" stroke="black" d="M9105.77,-1270.24C9105.77,-1270.24 9105.77,-886.53 9105.77,-886.53"/>
<polygon fill="black" stroke="black" points="9109.27,-886.53 9105.77,-876.53 9102.27,-886.53 9109.27,-886.53"/>
</g>
<!-- pp_stage1_layer3_expert0_up -->
<g id="node247" class="node">
<title>pp_stage1_layer3_expert0_up</title>
<polygon fill="lightcoral" stroke="black" points="11594.27,-1184.33 11088.27,-1184.33 11088.27,-1116.33 11594.27,-1116.33 11594.27,-1184.33"/>
<text text-anchor="middle" x="11341.27" y="-1169.13" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="11341.27" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11341.27" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11341.27" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert0_up -->
<g id="edge354" class="edge">
<title>pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert0_up</title>
<path fill="none" stroke="black" d="M9224.99,-1295C9808.8,-1295 11217.9,-1295 11217.9,-1295 11217.9,-1295 11217.9,-1194.62 11217.9,-1194.62"/>
<polygon fill="black" stroke="black" points="11221.4,-1194.62 11217.9,-1184.62 11214.4,-1194.62 11221.4,-1194.62"/>
</g>
<!-- pp_stage1_layer3_expert1_up -->
<g id="node251" class="node">
<title>pp_stage1_layer3_expert1_up</title>
<polygon fill="lightcoral" stroke="black" points="12163.27,-1184.33 11657.27,-1184.33 11657.27,-1116.33 12163.27,-1116.33 12163.27,-1184.33"/>
<text text-anchor="middle" x="11910.27" y="-1169.13" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="11910.27" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11910.27" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11910.27" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert1_up -->
<g id="edge359" class="edge">
<title>pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert1_up</title>
<path fill="none" stroke="black" d="M9224.84,-1304C9933,-1304 11910.27,-1304 11910.27,-1304 11910.27,-1304 11910.27,-1194.44 11910.27,-1194.44"/>
<polygon fill="black" stroke="black" points="11913.77,-1194.44 11910.27,-1184.44 11906.77,-1194.44 11913.77,-1194.44"/>
</g>
<!-- pp_stage1_layer3_expert2_up -->
<g id="node255" class="node">
<title>pp_stage1_layer3_expert2_up</title>
<polygon fill="lightcoral" stroke="black" points="12729.27,-1184.33 12223.27,-1184.33 12223.27,-1116.33 12729.27,-1116.33 12729.27,-1184.33"/>
<text text-anchor="middle" x="12476.27" y="-1169.13" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="12476.27" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12476.27" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12476.27" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert2_up -->
<g id="edge364" class="edge">
<title>pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert2_up</title>
<path fill="none" stroke="black" d="M9224.91,-1312C10001.44,-1312 12329.9,-1312 12329.9,-1312 12329.9,-1312 12329.9,-1194.62 12329.9,-1194.62"/>
<polygon fill="black" stroke="black" points="12333.4,-1194.62 12329.9,-1184.62 12326.4,-1194.62 12333.4,-1194.62"/>
</g>
<!-- pp_stage1_layer3_expert3_up -->
<g id="node259" class="node">
<title>pp_stage1_layer3_expert3_up</title>
<polygon fill="lightcoral" stroke="black" points="13294.27,-1184.33 12788.27,-1184.33 12788.27,-1116.33 13294.27,-1116.33 13294.27,-1184.33"/>
<text text-anchor="middle" x="13041.27" y="-1169.13" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="13041.27" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13041.27" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="13041.27" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert3_up -->
<g id="edge369" class="edge">
<title>pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert3_up</title>
<path fill="none" stroke="black" d="M9224.81,-1321C10107.85,-1321 13041.27,-1321 13041.27,-1321 13041.27,-1321 13041.27,-1194.46 13041.27,-1194.46"/>
<polygon fill="black" stroke="black" points="13044.77,-1194.46 13041.27,-1184.46 13037.77,-1194.46 13044.77,-1194.46"/>
</g>
<!-- pp_stage1_layer3_expert4_up -->
<g id="node263" class="node">
<title>pp_stage1_layer3_expert4_up</title>
<polygon fill="lightcoral" stroke="black" points="13859.27,-1184.33 13353.27,-1184.33 13353.27,-1116.33 13859.27,-1116.33 13859.27,-1184.33"/>
<text text-anchor="middle" x="13606.27" y="-1169.13" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="13606.27" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13606.27" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="13606.27" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert4_up -->
<g id="edge374" class="edge">
<title>pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert4_up</title>
<path fill="none" stroke="black" d="M9224.98,-1329C10163.83,-1329 13439.4,-1329 13439.4,-1329 13439.4,-1329 13439.4,-1194.36 13439.4,-1194.36"/>
<polygon fill="black" stroke="black" points="13442.9,-1194.36 13439.4,-1184.36 13435.9,-1194.36 13442.9,-1194.36"/>
</g>
<!-- pp_stage1_layer3_expert5_up -->
<g id="node267" class="node">
<title>pp_stage1_layer3_expert5_up</title>
<polygon fill="lightcoral" stroke="black" points="2113.27,-1184.33 1607.27,-1184.33 1607.27,-1116.33 2113.27,-1116.33 2113.27,-1184.33"/>
<text text-anchor="middle" x="1860.27" y="-1169.13" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="1860.27" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1860.27" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="1860.27" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert5_up -->
<g id="edge379" class="edge">
<title>pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert5_up</title>
<path fill="none" stroke="black" d="M8727.7,-1323C7469.24,-1323 1860.27,-1323 1860.27,-1323 1860.27,-1323 1860.27,-1194.45 1860.27,-1194.45"/>
<polygon fill="black" stroke="black" points="1863.77,-1194.45 1860.27,-1184.45 1856.77,-1194.45 1863.77,-1194.45"/>
</g>
<!-- pp_stage1_layer3_expert6_up -->
<g id="node271" class="node">
<title>pp_stage1_layer3_expert6_up</title>
<polygon fill="lightcoral" stroke="black" points="4151.27,-1184.33 3645.27,-1184.33 3645.27,-1116.33 4151.27,-1116.33 4151.27,-1184.33"/>
<text text-anchor="middle" x="3898.27" y="-1169.13" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="3898.27" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3898.27" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="3898.27" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert6_up -->
<g id="edge384" class="edge">
<title>pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert6_up</title>
<path fill="none" stroke="black" d="M8727.67,-1315C7723.88,-1315 4023.12,-1315 4023.12,-1315 4023.12,-1315 4023.12,-1194.45 4023.12,-1194.45"/>
<polygon fill="black" stroke="black" points="4026.62,-1194.45 4023.12,-1184.45 4019.62,-1194.45 4026.62,-1194.45"/>
</g>
<!-- pp_stage1_layer3_expert7_up -->
<g id="node275" class="node">
<title>pp_stage1_layer3_expert7_up</title>
<polygon fill="lightcoral" stroke="black" points="5452.27,-1184.33 4946.27,-1184.33 4946.27,-1116.33 5452.27,-1116.33 5452.27,-1184.33"/>
<text text-anchor="middle" x="5199.27" y="-1169.13" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="5199.27" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5199.27" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="5199.27" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert7_up -->
<g id="edge389" class="edge">
<title>pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert7_up</title>
<path fill="none" stroke="black" d="M8727.47,-1308C7904.13,-1308 5319.91,-1308 5319.91,-1308 5319.91,-1308 5319.91,-1194.54 5319.91,-1194.54"/>
<polygon fill="black" stroke="black" points="5323.41,-1194.54 5319.91,-1184.54 5316.41,-1194.54 5323.41,-1194.54"/>
</g>
<!-- pp_stage1_layer3_expert8_up -->
<g id="node279" class="node">
<title>pp_stage1_layer3_expert8_up</title>
<polygon fill="lightcoral" stroke="black" points="6384.27,-1184.33 5878.27,-1184.33 5878.27,-1116.33 6384.27,-1116.33 6384.27,-1184.33"/>
<text text-anchor="middle" x="6131.27" y="-1169.13" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="6131.27" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6131.27" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="6131.27" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert8_up -->
<g id="edge394" class="edge">
<title>pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert8_up</title>
<path fill="none" stroke="black" d="M8727.46,-1300C8041.31,-1300 6172.63,-1300 6172.63,-1300 6172.63,-1300 6172.63,-1194.67 6172.63,-1194.67"/>
<polygon fill="black" stroke="black" points="6176.13,-1194.67 6172.63,-1184.67 6169.13,-1194.67 6176.13,-1194.67"/>
</g>
<!-- pp_stage1_layer3_expert9_up -->
<g id="node283" class="node">
<title>pp_stage1_layer3_expert9_up</title>
<polygon fill="lightcoral" stroke="black" points="7102.27,-1184.33 6596.27,-1184.33 6596.27,-1116.33 7102.27,-1116.33 7102.27,-1184.33"/>
<text text-anchor="middle" x="6849.27" y="-1169.13" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="6849.27" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6849.27" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="6849.27" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert9_up -->
<g id="edge399" class="edge">
<title>pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert9_up</title>
<path fill="none" stroke="black" d="M8727.37,-1292C8212.09,-1292 7076.13,-1292 7076.13,-1292 7076.13,-1292 7076.13,-1194.63 7076.13,-1194.63"/>
<polygon fill="black" stroke="black" points="7079.63,-1194.63 7076.13,-1184.63 7072.63,-1194.63 7079.63,-1194.63"/>
</g>
<!-- pp_stage1_layer3_expert10_up -->
<g id="node287" class="node">
<title>pp_stage1_layer3_expert10_up</title>
<polygon fill="lightcoral" stroke="black" points="7767.27,-1184.33 7261.27,-1184.33 7261.27,-1116.33 7767.27,-1116.33 7767.27,-1184.33"/>
<text text-anchor="middle" x="7514.27" y="-1169.13" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="7514.27" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7514.27" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7514.27" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert10_up -->
<g id="edge404" class="edge">
<title>pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert10_up</title>
<path fill="none" stroke="black" d="M8727.43,-1285C8310.09,-1285 7514.27,-1285 7514.27,-1285 7514.27,-1285 7514.27,-1194.66 7514.27,-1194.66"/>
<polygon fill="black" stroke="black" points="7517.77,-1194.66 7514.27,-1184.66 7510.77,-1194.66 7517.77,-1194.66"/>
</g>
<!-- pp_stage1_layer3_expert11_up -->
<g id="node291" class="node">
<title>pp_stage1_layer3_expert11_up</title>
<polygon fill="lightcoral" stroke="black" points="8432.27,-1184.33 7926.27,-1184.33 7926.27,-1116.33 8432.27,-1116.33 8432.27,-1184.33"/>
<text text-anchor="middle" x="8179.27" y="-1169.13" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="8179.27" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8179.27" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="8179.27" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert11_up -->
<g id="edge409" class="edge">
<title>pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert11_up</title>
<path fill="none" stroke="black" d="M8727.69,-1277C8567.55,-1277 8389.12,-1277 8389.12,-1277 8389.12,-1277 8389.12,-1194.61 8389.12,-1194.61"/>
<polygon fill="black" stroke="black" points="8392.62,-1194.61 8389.12,-1184.61 8385.62,-1194.61 8392.62,-1194.61"/>
</g>
<!-- pp_stage1_layer3_expert12_up -->
<g id="node295" class="node">
<title>pp_stage1_layer3_expert12_up</title>
<polygon fill="lightcoral" stroke="black" points="9046.27,-1184.33 8540.27,-1184.33 8540.27,-1116.33 9046.27,-1116.33 9046.27,-1184.33"/>
<text text-anchor="middle" x="8793.27" y="-1169.13" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="8793.27" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8793.27" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="8793.27" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert12_up -->
<g id="edge414" class="edge">
<title>pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert12_up</title>
<path fill="none" stroke="black" d="M8887.02,-1270.16C8887.02,-1270.16 8887.02,-1194.42 8887.02,-1194.42"/>
<polygon fill="black" stroke="black" points="8890.52,-1194.42 8887.02,-1184.42 8883.52,-1194.42 8890.52,-1194.42"/>
</g>
<!-- pp_stage1_layer3_expert13_up -->
<g id="node299" class="node">
<title>pp_stage1_layer3_expert13_up</title>
<polygon fill="lightcoral" stroke="black" points="9832.27,-1184.33 9326.27,-1184.33 9326.27,-1116.33 9832.27,-1116.33 9832.27,-1184.33"/>
<text text-anchor="middle" x="9579.27" y="-1169.13" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="9579.27" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9579.27" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9579.27" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert13_up -->
<g id="edge419" class="edge">
<title>pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert13_up</title>
<path fill="none" stroke="black" d="M9165.27,-1270.08C9165.27,-1224.61 9165.27,-1150 9165.27,-1150 9165.27,-1150 9316.22,-1150 9316.22,-1150"/>
<polygon fill="black" stroke="black" points="9316.22,-1153.5 9326.22,-1150 9316.22,-1146.5 9316.22,-1153.5"/>
</g>
<!-- pp_stage1_layer3_expert14_up -->
<g id="node303" class="node">
<title>pp_stage1_layer3_expert14_up</title>
<polygon fill="lightcoral" stroke="black" points="10436.27,-1184.33 9930.27,-1184.33 9930.27,-1116.33 10436.27,-1116.33 10436.27,-1184.33"/>
<text text-anchor="middle" x="10183.27" y="-1169.13" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="10183.27" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10183.27" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10183.27" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert14_up -->
<g id="edge424" class="edge">
<title>pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert14_up</title>
<path fill="none" stroke="black" d="M9225.11,-1278C9554.59,-1278 10094.4,-1278 10094.4,-1278 10094.4,-1278 10094.4,-1194.55 10094.4,-1194.55"/>
<polygon fill="black" stroke="black" points="10097.9,-1194.55 10094.4,-1184.55 10090.9,-1194.55 10097.9,-1194.55"/>
</g>
<!-- pp_stage1_layer3_expert15_up -->
<g id="node307" class="node">
<title>pp_stage1_layer3_expert15_up</title>
<polygon fill="lightcoral" stroke="black" points="11020.27,-1184.33 10514.27,-1184.33 10514.27,-1116.33 11020.27,-1116.33 11020.27,-1184.33"/>
<text text-anchor="middle" x="10767.27" y="-1169.13" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="10767.27" y="-1154.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10767.27" y="-1139.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10767.27" y="-1124.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert15_up -->
<g id="edge429" class="edge">
<title>pp_stage1_layer3_moe_norm&#45;&gt;pp_stage1_layer3_expert15_up</title>
<path fill="none" stroke="black" d="M9224.83,-1287C9716.75,-1287 10767.27,-1287 10767.27,-1287 10767.27,-1287 10767.27,-1194.47 10767.27,-1194.47"/>
<polygon fill="black" stroke="black" points="10770.77,-1194.47 10767.27,-1184.47 10763.77,-1194.47 10770.77,-1194.47"/>
</g>
<!-- pp_stage1_layer3_route_back_expert0 -->
<g id="node250" class="node">
<title>pp_stage1_layer3_route_back_expert0</title>
<polygon fill="lightpink" stroke="black" points="13776.3,-654.33 12957,-654.33 12746.23,-518.33 13565.54,-518.33 13776.3,-654.33"/>
<text text-anchor="middle" x="13261.27" y="-605.13" font-family="Times,serif" font-size="14.00">Route Back Expert 0</text>
<text text-anchor="middle" x="13261.27" y="-590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13261.27" y="-575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13261.27" y="-560.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert0 -->
<g id="edge358" class="edge">
<title>pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9498.44,-751C10384.38,-751 12844.59,-751 12844.59,-751 12844.59,-751 12844.59,-596.45 12844.59,-596.45"/>
<polygon fill="black" stroke="black" points="12848.09,-596.45 12844.59,-586.45 12841.09,-596.45 12848.09,-596.45"/>
</g>
<!-- pp_stage1_layer3_route_back_expert1 -->
<g id="node254" class="node">
<title>pp_stage1_layer3_route_back_expert1</title>
<polygon fill="lightpink" stroke="black" points="14865.3,-654.33 14046,-654.33 13835.23,-518.33 14654.54,-518.33 14865.3,-654.33"/>
<text text-anchor="middle" x="14350.27" y="-605.13" font-family="Times,serif" font-size="14.00">Route Back Expert 1</text>
<text text-anchor="middle" x="14350.27" y="-590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14350.27" y="-575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14350.27" y="-560.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert1 -->
<g id="edge363" class="edge">
<title>pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9504.84,-755C10568.54,-755 13922.59,-755 13922.59,-755 13922.59,-755 13922.59,-596.46 13922.59,-596.46"/>
<polygon fill="black" stroke="black" points="13926.09,-596.46 13922.59,-586.46 13919.09,-596.46 13926.09,-596.46"/>
</g>
<!-- pp_stage1_layer3_route_back_expert2 -->
<g id="node258" class="node">
<title>pp_stage1_layer3_route_back_expert2</title>
<polygon fill="lightpink" stroke="black" points="15954.3,-654.33 15135,-654.33 14924.23,-518.33 15743.54,-518.33 15954.3,-654.33"/>
<text text-anchor="middle" x="15439.27" y="-605.13" font-family="Times,serif" font-size="14.00">Route Back Expert 2</text>
<text text-anchor="middle" x="15439.27" y="-590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15439.27" y="-575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15439.27" y="-560.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert2 -->
<g id="edge368" class="edge">
<title>pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9510.68,-759C10736.48,-759 15005.92,-759 15005.92,-759 15005.92,-759 15005.92,-596.46 15005.92,-596.46"/>
<polygon fill="black" stroke="black" points="15009.42,-596.46 15005.92,-586.46 15002.42,-596.46 15009.42,-596.46"/>
</g>
<!-- pp_stage1_layer3_route_back_expert3 -->
<g id="node262" class="node">
<title>pp_stage1_layer3_route_back_expert3</title>
<polygon fill="lightpink" stroke="black" points="17043.3,-654.33 16224,-654.33 16013.23,-518.33 16832.54,-518.33 17043.3,-654.33"/>
<text text-anchor="middle" x="16528.27" y="-605.13" font-family="Times,serif" font-size="14.00">Route Back Expert 3</text>
<text text-anchor="middle" x="16528.27" y="-590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16528.27" y="-575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16528.27" y="-560.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert3 -->
<g id="edge373" class="edge">
<title>pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9515.21,-762C10890.06,-762 16092.26,-762 16092.26,-762 16092.26,-762 16092.26,-596.46 16092.26,-596.46"/>
<polygon fill="black" stroke="black" points="16095.76,-596.46 16092.26,-586.46 16088.76,-596.46 16095.76,-596.46"/>
</g>
<!-- pp_stage1_layer3_route_back_expert4 -->
<g id="node266" class="node">
<title>pp_stage1_layer3_route_back_expert4</title>
<polygon fill="lightpink" stroke="black" points="18132.3,-654.33 17313,-654.33 17102.23,-518.33 17921.54,-518.33 18132.3,-654.33"/>
<text text-anchor="middle" x="17617.27" y="-605.13" font-family="Times,serif" font-size="14.00">Route Back Expert 4</text>
<text text-anchor="middle" x="17617.27" y="-590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17617.27" y="-575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17617.27" y="-560.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert4 -->
<g id="edge378" class="edge">
<title>pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9521.14,-766C11038.5,-766 17179.92,-766 17179.92,-766 17179.92,-766 17179.92,-596.46 17179.92,-596.46"/>
<polygon fill="black" stroke="black" points="17183.42,-596.46 17179.92,-586.46 17176.42,-596.46 17183.42,-596.46"/>
</g>
<!-- pp_stage1_layer3_route_back_expert5 -->
<g id="node270" class="node">
<title>pp_stage1_layer3_route_back_expert5</title>
<polygon fill="lightpink" stroke="black" points="1797.3,-654.33 978,-654.33 767.23,-518.33 1586.54,-518.33 1797.3,-654.33"/>
<text text-anchor="middle" x="1282.27" y="-605.13" font-family="Times,serif" font-size="14.00">Route Back Expert 5</text>
<text text-anchor="middle" x="1282.27" y="-590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1282.27" y="-575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1282.27" y="-560.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert5 -->
<g id="edge383" class="edge">
<title>pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8727.31,-770C7105.2,-770 1729.65,-770 1729.65,-770 1729.65,-770 1729.65,-664.46 1729.65,-664.46"/>
<polygon fill="black" stroke="black" points="1733.15,-664.46 1729.65,-654.46 1726.15,-664.46 1733.15,-664.46"/>
</g>
<!-- pp_stage1_layer3_route_back_expert6 -->
<g id="node274" class="node">
<title>pp_stage1_layer3_route_back_expert6</title>
<polygon fill="lightpink" stroke="black" points="2886.3,-654.33 2067,-654.33 1856.23,-518.33 2675.54,-518.33 2886.3,-654.33"/>
<text text-anchor="middle" x="2371.27" y="-605.13" font-family="Times,serif" font-size="14.00">Route Back Expert 6</text>
<text text-anchor="middle" x="2371.27" y="-590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2371.27" y="-575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2371.27" y="-560.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert6 -->
<g id="edge388" class="edge">
<title>pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8719.67,-765C7254.66,-765 2835.9,-765 2835.9,-765 2835.9,-765 2835.9,-596.46 2835.9,-596.46"/>
<polygon fill="black" stroke="black" points="2839.4,-596.46 2835.9,-586.46 2832.4,-596.46 2839.4,-596.46"/>
</g>
<!-- pp_stage1_layer3_route_back_expert7 -->
<g id="node278" class="node">
<title>pp_stage1_layer3_route_back_expert7</title>
<polygon fill="lightpink" stroke="black" points="3975.3,-654.33 3156,-654.33 2945.23,-518.33 3764.54,-518.33 3975.3,-654.33"/>
<text text-anchor="middle" x="3460.27" y="-605.13" font-family="Times,serif" font-size="14.00">Route Back Expert 7</text>
<text text-anchor="middle" x="3460.27" y="-590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3460.27" y="-575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3460.27" y="-560.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert7 -->
<g id="edge393" class="edge">
<title>pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8713.71,-761C7412.68,-761 3868.28,-761 3868.28,-761 3868.28,-761 3868.28,-664.36 3868.28,-664.36"/>
<polygon fill="black" stroke="black" points="3871.78,-664.36 3868.28,-654.36 3864.78,-664.36 3871.78,-664.36"/>
</g>
<!-- pp_stage1_layer3_route_back_expert8 -->
<g id="node282" class="node">
<title>pp_stage1_layer3_route_back_expert8</title>
<polygon fill="lightpink" stroke="black" points="5064.3,-654.33 4245,-654.33 4034.23,-518.33 4853.54,-518.33 5064.3,-654.33"/>
<text text-anchor="middle" x="4549.27" y="-605.13" font-family="Times,serif" font-size="14.00">Route Back Expert 8</text>
<text text-anchor="middle" x="4549.27" y="-590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4549.27" y="-575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4549.27" y="-560.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert8 -->
<g id="edge398" class="edge">
<title>pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8707.61,-757C7592.77,-757 4912.94,-757 4912.94,-757 4912.94,-757 4912.94,-664.77 4912.94,-664.77"/>
<polygon fill="black" stroke="black" points="4916.44,-664.77 4912.94,-654.77 4909.44,-664.77 4916.44,-664.77"/>
</g>
<!-- pp_stage1_layer3_route_back_expert9 -->
<g id="node286" class="node">
<title>pp_stage1_layer3_route_back_expert9</title>
<polygon fill="lightpink" stroke="black" points="6153.3,-654.33 5334,-654.33 5123.23,-518.33 5942.54,-518.33 6153.3,-654.33"/>
<text text-anchor="middle" x="5638.27" y="-605.13" font-family="Times,serif" font-size="14.00">Route Back Expert 9</text>
<text text-anchor="middle" x="5638.27" y="-590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5638.27" y="-575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5638.27" y="-560.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert9 -->
<g id="edge403" class="edge">
<title>pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8701.55,-753C7843.82,-753 6145.78,-753 6145.78,-753 6145.78,-753 6145.78,-596.45 6145.78,-596.45"/>
<polygon fill="black" stroke="black" points="6149.28,-596.45 6145.78,-586.45 6142.28,-596.45 6149.28,-596.45"/>
</g>
<!-- pp_stage1_layer3_route_back_expert10 -->
<g id="node290" class="node">
<title>pp_stage1_layer3_route_back_expert10</title>
<polygon fill="lightpink" stroke="black" points="7242.3,-654.33 6423,-654.33 6212.23,-518.33 7031.54,-518.33 7242.3,-654.33"/>
<text text-anchor="middle" x="6727.27" y="-605.13" font-family="Times,serif" font-size="14.00">Route Back Expert 10</text>
<text text-anchor="middle" x="6727.27" y="-590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6727.27" y="-575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6727.27" y="-560.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert10 -->
<g id="edge408" class="edge">
<title>pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8693.96,-748C8090.99,-748 7147.61,-748 7147.61,-748 7147.61,-748 7147.61,-664.43 7147.61,-664.43"/>
<polygon fill="black" stroke="black" points="7151.11,-664.43 7147.61,-654.43 7144.11,-664.43 7151.11,-664.43"/>
</g>
<!-- pp_stage1_layer3_route_back_expert11 -->
<g id="node294" class="node">
<title>pp_stage1_layer3_route_back_expert11</title>
<polygon fill="lightpink" stroke="black" points="8331.3,-654.33 7512,-654.33 7301.23,-518.33 8120.54,-518.33 8331.3,-654.33"/>
<text text-anchor="middle" x="7816.27" y="-605.13" font-family="Times,serif" font-size="14.00">Route Back Expert 11</text>
<text text-anchor="middle" x="7816.27" y="-590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7816.27" y="-575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7816.27" y="-560.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert11 -->
<g id="edge413" class="edge">
<title>pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8687.87,-744C8455.67,-744 8229.65,-744 8229.65,-744 8229.65,-744 8229.65,-664.57 8229.65,-664.57"/>
<polygon fill="black" stroke="black" points="8233.15,-664.57 8229.65,-654.57 8226.15,-664.57 8233.15,-664.57"/>
</g>
<!-- pp_stage1_layer3_route_back_expert12 -->
<g id="node298" class="node">
<title>pp_stage1_layer3_route_back_expert12</title>
<polygon fill="lightpink" stroke="black" points="9420.3,-654.33 8601,-654.33 8390.23,-518.33 9209.54,-518.33 9420.3,-654.33"/>
<text text-anchor="middle" x="8905.27" y="-605.13" font-family="Times,serif" font-size="14.00">Route Back Expert 12</text>
<text text-anchor="middle" x="8905.27" y="-590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8905.27" y="-575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8905.27" y="-560.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert12 -->
<g id="edge418" class="edge">
<title>pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9051.49,-740.22C9051.49,-740.22 9051.49,-664.7 9051.49,-664.7"/>
<polygon fill="black" stroke="black" points="9054.99,-664.7 9051.49,-654.7 9047.99,-664.7 9054.99,-664.7"/>
</g>
<!-- pp_stage1_layer3_route_back_expert13 -->
<g id="node302" class="node">
<title>pp_stage1_layer3_route_back_expert13</title>
<polygon fill="lightpink" stroke="black" points="10509.3,-654.33 9690,-654.33 9479.23,-518.33 10298.54,-518.33 10509.3,-654.33"/>
<text text-anchor="middle" x="9994.27" y="-605.13" font-family="Times,serif" font-size="14.00">Route Back Expert 13</text>
<text text-anchor="middle" x="9994.27" y="-590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9994.27" y="-575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9994.27" y="-560.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert13 -->
<g id="edge423" class="edge">
<title>pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9583.55,-806.92C9583.55,-806.92 9583.55,-596.48 9583.55,-596.48"/>
<polygon fill="black" stroke="black" points="9587.05,-596.48 9583.55,-586.48 9580.05,-596.48 9587.05,-596.48"/>
</g>
<!-- pp_stage1_layer3_route_back_expert14 -->
<g id="node306" class="node">
<title>pp_stage1_layer3_route_back_expert14</title>
<polygon fill="lightpink" stroke="black" points="11598.3,-654.33 10779,-654.33 10568.23,-518.33 11387.54,-518.33 11598.3,-654.33"/>
<text text-anchor="middle" x="11083.27" y="-605.13" font-family="Times,serif" font-size="14.00">Route Back Expert 14</text>
<text text-anchor="middle" x="11083.27" y="-590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11083.27" y="-575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11083.27" y="-560.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert14 -->
<g id="edge428" class="edge">
<title>pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9487.93,-744C9938.61,-744 10733.59,-744 10733.59,-744 10733.59,-744 10733.59,-635.31 10733.59,-635.31"/>
<polygon fill="black" stroke="black" points="10737.09,-635.31 10733.59,-625.31 10730.09,-635.31 10737.09,-635.31"/>
</g>
<!-- pp_stage1_layer3_route_back_expert15 -->
<g id="node310" class="node">
<title>pp_stage1_layer3_route_back_expert15</title>
<polygon fill="lightpink" stroke="black" points="12687.3,-654.33 11868,-654.33 11657.23,-518.33 12476.54,-518.33 12687.3,-654.33"/>
<text text-anchor="middle" x="12172.27" y="-605.13" font-family="Times,serif" font-size="14.00">Route Back Expert 15</text>
<text text-anchor="middle" x="12172.27" y="-590.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12172.27" y="-575.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12172.27" y="-560.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert15 -->
<g id="edge433" class="edge">
<title>pp_stage1_layer3_gate&#45;&gt;pp_stage1_layer3_route_back_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9492.54,-747C10179.13,-747 11777.92,-747 11777.92,-747 11777.92,-747 11777.92,-606.38 11777.92,-606.38"/>
<polygon fill="black" stroke="black" points="11781.42,-606.38 11777.92,-596.38 11774.42,-606.38 11781.42,-606.38"/>
</g>
<!-- pp_stage1_layer3_expert0_activation -->
<g id="node248" class="node">
<title>pp_stage1_layer3_expert0_activation</title>
<polygon fill="lightyellow" stroke="black" points="11938.27,-1030.33 11432.27,-1030.33 11432.27,-962.33 11938.27,-962.33 11938.27,-1030.33"/>
<text text-anchor="middle" x="11685.27" y="-1015.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="11685.27" y="-1000.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11685.27" y="-985.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11685.27" y="-970.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert0_up&#45;&gt;pp_stage1_layer3_expert0_activation -->
<g id="edge355" class="edge">
<title>pp_stage1_layer3_expert0_up&#45;&gt;pp_stage1_layer3_expert0_activation</title>
<path fill="none" stroke="black" d="M11513.27,-1116.16C11513.27,-1116.16 11513.27,-1040.42 11513.27,-1040.42"/>
<polygon fill="black" stroke="black" points="11516.77,-1040.42 11513.27,-1030.42 11509.77,-1040.42 11516.77,-1040.42"/>
</g>
<!-- pp_stage1_layer3_expert0_down -->
<g id="node249" class="node">
<title>pp_stage1_layer3_expert0_down</title>
<polygon fill="lightcoral" stroke="black" points="13041.77,-842.33 12544.77,-842.33 12544.77,-774.33 13041.77,-774.33 13041.77,-842.33"/>
<text text-anchor="middle" x="12793.27" y="-827.13" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="12793.27" y="-812.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12793.27" y="-797.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12793.27" y="-782.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert0_activation&#45;&gt;pp_stage1_layer3_expert0_down -->
<g id="edge356" class="edge">
<title>pp_stage1_layer3_expert0_activation&#45;&gt;pp_stage1_layer3_expert0_down</title>
<path fill="none" stroke="black" d="M11730.52,-962.15C11730.52,-933.41 11730.52,-897 11730.52,-897 11730.52,-897 12552.52,-897 12552.52,-897 12552.52,-897 12552.52,-852.36 12552.52,-852.36"/>
<polygon fill="black" stroke="black" points="12556.02,-852.36 12552.52,-842.36 12549.02,-852.36 12556.02,-852.36"/>
</g>
<!-- pp_stage1_layer3_expert0_down&#45;&gt;pp_stage1_layer3_route_back_expert0 -->
<g id="edge357" class="edge">
<title>pp_stage1_layer3_expert0_down&#45;&gt;pp_stage1_layer3_route_back_expert0</title>
<path fill="none" stroke="black" d="M12943.18,-774.13C12943.18,-774.13 12943.18,-655.65 12943.18,-655.65"/>
<polygon fill="black" stroke="black" points="12946.68,-655.65 12943.18,-645.65 12939.68,-655.65 12946.68,-655.65"/>
</g>
<!-- pp_stage1_layer3_expert_agg -->
<g id="node311" class="node">
<title>pp_stage1_layer3_expert_agg</title>
<ellipse fill="lightblue" stroke="black" cx="8905.27" cy="-384.25" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="8905.27" y="-403.05" font-family="Times,serif" font-size="14.00">Aggregate Experts</text>
<text text-anchor="middle" x="8905.27" y="-388.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8905.27" y="-373.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8905.27" y="-358.05" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_route_back_expert0&#45;&gt;pp_stage1_layer3_expert_agg -->
<g id="edge434" class="edge">
<title>pp_stage1_layer3_route_back_expert0&#45;&gt;pp_stage1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M13261.27,-518.15C13261.27,-461.11 13261.27,-389 13261.27,-389 13261.27,-389 9265.29,-389 9265.29,-389"/>
<polygon fill="black" stroke="black" points="9265.29,-385.5 9255.29,-389 9265.29,-392.5 9265.29,-385.5"/>
</g>
<!-- pp_stage1_layer3_expert1_activation -->
<g id="node252" class="node">
<title>pp_stage1_layer3_expert1_activation</title>
<polygon fill="lightyellow" stroke="black" points="12502.27,-1030.33 11996.27,-1030.33 11996.27,-962.33 12502.27,-962.33 12502.27,-1030.33"/>
<text text-anchor="middle" x="12249.27" y="-1015.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="12249.27" y="-1000.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12249.27" y="-985.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12249.27" y="-970.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert1_up&#45;&gt;pp_stage1_layer3_expert1_activation -->
<g id="edge360" class="edge">
<title>pp_stage1_layer3_expert1_up&#45;&gt;pp_stage1_layer3_expert1_activation</title>
<path fill="none" stroke="black" d="M12079.77,-1116.16C12079.77,-1116.16 12079.77,-1040.42 12079.77,-1040.42"/>
<polygon fill="black" stroke="black" points="12083.27,-1040.42 12079.77,-1030.42 12076.27,-1040.42 12083.27,-1040.42"/>
</g>
<!-- pp_stage1_layer3_expert1_down -->
<g id="node253" class="node">
<title>pp_stage1_layer3_expert1_down</title>
<polygon fill="lightcoral" stroke="black" points="14097.77,-842.33 13600.77,-842.33 13600.77,-774.33 14097.77,-774.33 14097.77,-842.33"/>
<text text-anchor="middle" x="13849.27" y="-827.13" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="13849.27" y="-812.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="13849.27" y="-797.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13849.27" y="-782.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert1_activation&#45;&gt;pp_stage1_layer3_expert1_down -->
<g id="edge361" class="edge">
<title>pp_stage1_layer3_expert1_activation&#45;&gt;pp_stage1_layer3_expert1_down</title>
<path fill="none" stroke="black" d="M12261.02,-962.19C12261.02,-941.47 12261.02,-919 12261.02,-919 12261.02,-919 13610.6,-919 13610.6,-919 13610.6,-919 13610.6,-852.44 13610.6,-852.44"/>
<polygon fill="black" stroke="black" points="13614.1,-852.44 13610.6,-842.44 13607.1,-852.44 13614.1,-852.44"/>
</g>
<!-- pp_stage1_layer3_expert1_down&#45;&gt;pp_stage1_layer3_route_back_expert1 -->
<g id="edge362" class="edge">
<title>pp_stage1_layer3_expert1_down&#45;&gt;pp_stage1_layer3_route_back_expert1</title>
<path fill="none" stroke="black" d="M14010.18,-774.13C14010.18,-774.13 14010.18,-641.33 14010.18,-641.33"/>
<polygon fill="black" stroke="black" points="14013.68,-641.33 14010.18,-631.33 14006.68,-641.33 14013.68,-641.33"/>
</g>
<!-- pp_stage1_layer3_route_back_expert1&#45;&gt;pp_stage1_layer3_expert_agg -->
<g id="edge435" class="edge">
<title>pp_stage1_layer3_route_back_expert1&#45;&gt;pp_stage1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M14350.27,-518.12C14350.27,-457.36 14350.27,-378 14350.27,-378 14350.27,-378 9263.9,-378 9263.9,-378"/>
<polygon fill="black" stroke="black" points="9263.9,-374.5 9253.9,-378 9263.9,-381.5 9263.9,-374.5"/>
</g>
<!-- pp_stage1_layer3_expert2_activation -->
<g id="node256" class="node">
<title>pp_stage1_layer3_expert2_activation</title>
<polygon fill="lightyellow" stroke="black" points="13066.27,-1030.33 12560.27,-1030.33 12560.27,-962.33 13066.27,-962.33 13066.27,-1030.33"/>
<text text-anchor="middle" x="12813.27" y="-1015.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="12813.27" y="-1000.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12813.27" y="-985.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="12813.27" y="-970.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert2_up&#45;&gt;pp_stage1_layer3_expert2_activation -->
<g id="edge365" class="edge">
<title>pp_stage1_layer3_expert2_up&#45;&gt;pp_stage1_layer3_expert2_activation</title>
<path fill="none" stroke="black" d="M12644.77,-1116.16C12644.77,-1116.16 12644.77,-1040.42 12644.77,-1040.42"/>
<polygon fill="black" stroke="black" points="12648.27,-1040.42 12644.77,-1030.42 12641.27,-1040.42 12648.27,-1040.42"/>
</g>
<!-- pp_stage1_layer3_expert2_down -->
<g id="node257" class="node">
<title>pp_stage1_layer3_expert2_down</title>
<polygon fill="lightcoral" stroke="black" points="15169.77,-842.33 14672.77,-842.33 14672.77,-774.33 15169.77,-774.33 15169.77,-842.33"/>
<text text-anchor="middle" x="14921.27" y="-827.13" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="14921.27" y="-812.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="14921.27" y="-797.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14921.27" y="-782.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert2_activation&#45;&gt;pp_stage1_layer3_expert2_down -->
<g id="edge366" class="edge">
<title>pp_stage1_layer3_expert2_activation&#45;&gt;pp_stage1_layer3_expert2_down</title>
<path fill="none" stroke="black" d="M13054.02,-961.96C13054.02,-898.64 13054.02,-770 13054.02,-770 13054.02,-770 14769.15,-770 14769.15,-770 14769.15,-770 14769.15,-770.41 14769.15,-770.41"/>
<polygon fill="black" stroke="black" points="14765.65,-764.1 14769.15,-774.1 14772.65,-764.1 14765.65,-764.1"/>
</g>
<!-- pp_stage1_layer3_expert2_down&#45;&gt;pp_stage1_layer3_route_back_expert2 -->
<g id="edge367" class="edge">
<title>pp_stage1_layer3_expert2_down&#45;&gt;pp_stage1_layer3_route_back_expert2</title>
<path fill="none" stroke="black" d="M15087.84,-774.13C15087.84,-774.13 15087.84,-633.92 15087.84,-633.92"/>
<polygon fill="black" stroke="black" points="15091.34,-633.92 15087.84,-623.92 15084.34,-633.92 15091.34,-633.92"/>
</g>
<!-- pp_stage1_layer3_route_back_expert2&#45;&gt;pp_stage1_layer3_expert_agg -->
<g id="edge436" class="edge">
<title>pp_stage1_layer3_route_back_expert2&#45;&gt;pp_stage1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M15439.27,-518.15C15439.27,-454.09 15439.27,-368 15439.27,-368 15439.27,-368 9246.3,-368 9246.3,-368"/>
<polygon fill="black" stroke="black" points="9246.3,-364.5 9236.3,-368 9246.3,-371.5 9246.3,-364.5"/>
</g>
<!-- pp_stage1_layer3_expert3_activation -->
<g id="node260" class="node">
<title>pp_stage1_layer3_expert3_activation</title>
<polygon fill="lightyellow" stroke="black" points="13630.27,-1030.33 13124.27,-1030.33 13124.27,-962.33 13630.27,-962.33 13630.27,-1030.33"/>
<text text-anchor="middle" x="13377.27" y="-1015.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="13377.27" y="-1000.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="13377.27" y="-985.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="13377.27" y="-970.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert3_up&#45;&gt;pp_stage1_layer3_expert3_activation -->
<g id="edge370" class="edge">
<title>pp_stage1_layer3_expert3_up&#45;&gt;pp_stage1_layer3_expert3_activation</title>
<path fill="none" stroke="black" d="M13209.27,-1116.16C13209.27,-1116.16 13209.27,-1040.42 13209.27,-1040.42"/>
<polygon fill="black" stroke="black" points="13212.77,-1040.42 13209.27,-1030.42 13205.77,-1040.42 13212.77,-1040.42"/>
</g>
<!-- pp_stage1_layer3_expert3_down -->
<g id="node261" class="node">
<title>pp_stage1_layer3_expert3_down</title>
<polygon fill="lightcoral" stroke="black" points="16250.77,-842.33 15753.77,-842.33 15753.77,-774.33 16250.77,-774.33 16250.77,-842.33"/>
<text text-anchor="middle" x="16002.27" y="-827.13" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="16002.27" y="-812.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="16002.27" y="-797.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16002.27" y="-782.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert3_activation&#45;&gt;pp_stage1_layer3_expert3_down -->
<g id="edge371" class="edge">
<title>pp_stage1_layer3_expert3_activation&#45;&gt;pp_stage1_layer3_expert3_down</title>
<path fill="none" stroke="black" d="M13620.43,-962.26C13620.43,-950.4 13620.43,-940 13620.43,-940 13620.43,-940 15757.88,-940 15757.88,-940 15757.88,-940 15757.88,-852.58 15757.88,-852.58"/>
<polygon fill="black" stroke="black" points="15761.38,-852.58 15757.88,-842.58 15754.38,-852.58 15761.38,-852.58"/>
</g>
<!-- pp_stage1_layer3_expert3_down&#45;&gt;pp_stage1_layer3_route_back_expert3 -->
<g id="edge372" class="edge">
<title>pp_stage1_layer3_expert3_down&#45;&gt;pp_stage1_layer3_route_back_expert3</title>
<path fill="none" stroke="black" d="M16171.51,-774.13C16171.51,-774.13 16171.51,-630.57 16171.51,-630.57"/>
<polygon fill="black" stroke="black" points="16175.01,-630.57 16171.51,-620.57 16168.01,-630.57 16175.01,-630.57"/>
</g>
<!-- pp_stage1_layer3_route_back_expert3&#45;&gt;pp_stage1_layer3_expert_agg -->
<g id="edge437" class="edge">
<title>pp_stage1_layer3_route_back_expert3&#45;&gt;pp_stage1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M16528.27,-518.15C16528.27,-450.55 16528.27,-357 16528.27,-357 16528.27,-357 9205.08,-357 9205.08,-357"/>
<polygon fill="black" stroke="black" points="9205.08,-353.5 9195.08,-357 9205.08,-360.5 9205.08,-353.5"/>
</g>
<!-- pp_stage1_layer3_expert4_activation -->
<g id="node264" class="node">
<title>pp_stage1_layer3_expert4_activation</title>
<polygon fill="lightyellow" stroke="black" points="14194.27,-1030.33 13688.27,-1030.33 13688.27,-962.33 14194.27,-962.33 14194.27,-1030.33"/>
<text text-anchor="middle" x="13941.27" y="-1015.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="13941.27" y="-1000.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="13941.27" y="-985.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="13941.27" y="-970.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert4_up&#45;&gt;pp_stage1_layer3_expert4_activation -->
<g id="edge375" class="edge">
<title>pp_stage1_layer3_expert4_up&#45;&gt;pp_stage1_layer3_expert4_activation</title>
<path fill="none" stroke="black" d="M13773.77,-1116.16C13773.77,-1116.16 13773.77,-1040.42 13773.77,-1040.42"/>
<polygon fill="black" stroke="black" points="13777.27,-1040.42 13773.77,-1030.42 13770.27,-1040.42 13777.27,-1040.42"/>
</g>
<!-- pp_stage1_layer3_expert4_down -->
<g id="node265" class="node">
<title>pp_stage1_layer3_expert4_down</title>
<polygon fill="lightcoral" stroke="black" points="17335.77,-842.33 16838.77,-842.33 16838.77,-774.33 17335.77,-774.33 17335.77,-842.33"/>
<text text-anchor="middle" x="17087.27" y="-827.13" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="17087.27" y="-812.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="17087.27" y="-797.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17087.27" y="-782.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert4_activation&#45;&gt;pp_stage1_layer3_expert4_down -->
<g id="edge376" class="edge">
<title>pp_stage1_layer3_expert4_activation&#45;&gt;pp_stage1_layer3_expert4_down</title>
<path fill="none" stroke="black" d="M14194.5,-996C14901.46,-996 16844.88,-996 16844.88,-996 16844.88,-996 16844.88,-852.75 16844.88,-852.75"/>
<polygon fill="black" stroke="black" points="16848.38,-852.75 16844.88,-842.75 16841.38,-852.75 16848.38,-852.75"/>
</g>
<!-- pp_stage1_layer3_expert4_down&#45;&gt;pp_stage1_layer3_route_back_expert4 -->
<g id="edge377" class="edge">
<title>pp_stage1_layer3_expert4_down&#45;&gt;pp_stage1_layer3_route_back_expert4</title>
<path fill="none" stroke="black" d="M17257.84,-774.13C17257.84,-774.13 17257.84,-628.77 17257.84,-628.77"/>
<polygon fill="black" stroke="black" points="17261.34,-628.77 17257.84,-618.77 17254.34,-628.77 17261.34,-628.77"/>
</g>
<!-- pp_stage1_layer3_route_back_expert4&#45;&gt;pp_stage1_layer3_expert_agg -->
<g id="edge438" class="edge">
<title>pp_stage1_layer3_route_back_expert4&#45;&gt;pp_stage1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M17617.27,-518.11C17617.27,-447.05 17617.27,-346 17617.27,-346 17617.27,-346 9128.46,-346 9128.46,-346"/>
<polygon fill="black" stroke="black" points="9128.46,-342.5 9118.46,-346 9128.46,-349.5 9128.46,-342.5"/>
</g>
<!-- pp_stage1_layer3_expert5_activation -->
<g id="node268" class="node">
<title>pp_stage1_layer3_expert5_activation</title>
<polygon fill="lightyellow" stroke="black" points="1959.27,-1030.33 1453.27,-1030.33 1453.27,-962.33 1959.27,-962.33 1959.27,-1030.33"/>
<text text-anchor="middle" x="1706.27" y="-1015.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1706.27" y="-1000.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="1706.27" y="-985.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="1706.27" y="-970.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert5_up&#45;&gt;pp_stage1_layer3_expert5_activation -->
<g id="edge380" class="edge">
<title>pp_stage1_layer3_expert5_up&#45;&gt;pp_stage1_layer3_expert5_activation</title>
<path fill="none" stroke="black" d="M1783.27,-1116.16C1783.27,-1116.16 1783.27,-1040.42 1783.27,-1040.42"/>
<polygon fill="black" stroke="black" points="1786.77,-1040.42 1783.27,-1030.42 1779.77,-1040.42 1786.77,-1040.42"/>
</g>
<!-- pp_stage1_layer3_expert5_down -->
<g id="node269" class="node">
<title>pp_stage1_layer3_expert5_down</title>
<polygon fill="lightcoral" stroke="black" points="1661.77,-842.33 1164.77,-842.33 1164.77,-774.33 1661.77,-774.33 1661.77,-842.33"/>
<text text-anchor="middle" x="1413.27" y="-827.13" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="1413.27" y="-812.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="1413.27" y="-797.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1413.27" y="-782.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert5_activation&#45;&gt;pp_stage1_layer3_expert5_down -->
<g id="edge381" class="edge">
<title>pp_stage1_layer3_expert5_activation&#45;&gt;pp_stage1_layer3_expert5_down</title>
<path fill="none" stroke="black" d="M1557.52,-962.29C1557.52,-962.29 1557.52,-852.44 1557.52,-852.44"/>
<polygon fill="black" stroke="black" points="1561.02,-852.44 1557.52,-842.44 1554.02,-852.44 1561.02,-852.44"/>
</g>
<!-- pp_stage1_layer3_expert5_down&#45;&gt;pp_stage1_layer3_route_back_expert5 -->
<g id="edge382" class="edge">
<title>pp_stage1_layer3_expert5_down&#45;&gt;pp_stage1_layer3_route_back_expert5</title>
<path fill="none" stroke="black" d="M1413.27,-774.13C1413.27,-774.13 1413.27,-664.59 1413.27,-664.59"/>
<polygon fill="black" stroke="black" points="1416.77,-664.59 1413.27,-654.59 1409.77,-664.59 1416.77,-664.59"/>
</g>
<!-- pp_stage1_layer3_route_back_expert5&#45;&gt;pp_stage1_layer3_expert_agg -->
<g id="edge439" class="edge">
<title>pp_stage1_layer3_route_back_expert5&#45;&gt;pp_stage1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M1282.27,-518.15C1282.27,-450.55 1282.27,-357 1282.27,-357 1282.27,-357 8605.46,-357 8605.46,-357"/>
<polygon fill="black" stroke="black" points="8605.46,-360.5 8615.46,-357 8605.46,-353.5 8605.46,-360.5"/>
</g>
<!-- pp_stage1_layer3_expert6_activation -->
<g id="node272" class="node">
<title>pp_stage1_layer3_expert6_activation</title>
<polygon fill="lightyellow" stroke="black" points="2785.27,-1030.33 2279.27,-1030.33 2279.27,-962.33 2785.27,-962.33 2785.27,-1030.33"/>
<text text-anchor="middle" x="2532.27" y="-1015.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2532.27" y="-1000.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="2532.27" y="-985.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="2532.27" y="-970.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert6_up&#45;&gt;pp_stage1_layer3_expert6_activation -->
<g id="edge385" class="edge">
<title>pp_stage1_layer3_expert6_up&#45;&gt;pp_stage1_layer3_expert6_activation</title>
<path fill="none" stroke="black" d="M3649.52,-1116.08C3649.52,-1070.61 3649.52,-996 3649.52,-996 3649.52,-996 2795.44,-996 2795.44,-996"/>
<polygon fill="black" stroke="black" points="2795.44,-992.5 2785.44,-996 2795.44,-999.5 2795.44,-992.5"/>
</g>
<!-- pp_stage1_layer3_expert6_down -->
<g id="node273" class="node">
<title>pp_stage1_layer3_expert6_down</title>
<polygon fill="lightcoral" stroke="black" points="2673.77,-842.33 2176.77,-842.33 2176.77,-774.33 2673.77,-774.33 2673.77,-842.33"/>
<text text-anchor="middle" x="2425.27" y="-827.13" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="2425.27" y="-812.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="2425.27" y="-797.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2425.27" y="-782.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert6_activation&#45;&gt;pp_stage1_layer3_expert6_down -->
<g id="edge386" class="edge">
<title>pp_stage1_layer3_expert6_activation&#45;&gt;pp_stage1_layer3_expert6_down</title>
<path fill="none" stroke="black" d="M2476.52,-962.29C2476.52,-962.29 2476.52,-852.44 2476.52,-852.44"/>
<polygon fill="black" stroke="black" points="2480.02,-852.44 2476.52,-842.44 2473.02,-852.44 2480.02,-852.44"/>
</g>
<!-- pp_stage1_layer3_expert6_down&#45;&gt;pp_stage1_layer3_route_back_expert6 -->
<g id="edge387" class="edge">
<title>pp_stage1_layer3_expert6_down&#45;&gt;pp_stage1_layer3_route_back_expert6</title>
<path fill="none" stroke="black" d="M2425.27,-774.13C2425.27,-774.13 2425.27,-664.59 2425.27,-664.59"/>
<polygon fill="black" stroke="black" points="2428.77,-664.59 2425.27,-654.59 2421.77,-664.59 2428.77,-664.59"/>
</g>
<!-- pp_stage1_layer3_route_back_expert6&#45;&gt;pp_stage1_layer3_expert_agg -->
<g id="edge440" class="edge">
<title>pp_stage1_layer3_route_back_expert6&#45;&gt;pp_stage1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M2371.27,-518.15C2371.27,-454.09 2371.27,-368 2371.27,-368 2371.27,-368 8564.24,-368 8564.24,-368"/>
<polygon fill="black" stroke="black" points="8564.24,-371.5 8574.24,-368 8564.24,-364.5 8564.24,-371.5"/>
</g>
<!-- pp_stage1_layer3_expert7_activation -->
<g id="node276" class="node">
<title>pp_stage1_layer3_expert7_activation</title>
<polygon fill="lightyellow" stroke="black" points="4949.27,-1030.33 4443.27,-1030.33 4443.27,-962.33 4949.27,-962.33 4949.27,-1030.33"/>
<text text-anchor="middle" x="4696.27" y="-1015.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="4696.27" y="-1000.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="4696.27" y="-985.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="4696.27" y="-970.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert7_up&#45;&gt;pp_stage1_layer3_expert7_activation -->
<g id="edge390" class="edge">
<title>pp_stage1_layer3_expert7_up&#45;&gt;pp_stage1_layer3_expert7_activation</title>
<path fill="none" stroke="black" d="M5001.77,-1116C5001.77,-1073.6 5001.77,-1007 5001.77,-1007 5001.77,-1007 4959.6,-1007 4959.6,-1007"/>
<polygon fill="black" stroke="black" points="4959.6,-1003.5 4949.6,-1007 4959.6,-1010.5 4959.6,-1003.5"/>
</g>
<!-- pp_stage1_layer3_expert7_down -->
<g id="node277" class="node">
<title>pp_stage1_layer3_expert7_down</title>
<polygon fill="lightcoral" stroke="black" points="4150.77,-842.33 3653.77,-842.33 3653.77,-774.33 4150.77,-774.33 4150.77,-842.33"/>
<text text-anchor="middle" x="3902.27" y="-827.13" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="3902.27" y="-812.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="3902.27" y="-797.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3902.27" y="-782.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert7_activation&#45;&gt;pp_stage1_layer3_expert7_down -->
<g id="edge391" class="edge">
<title>pp_stage1_layer3_expert7_activation&#45;&gt;pp_stage1_layer3_expert7_down</title>
<path fill="none" stroke="black" d="M4526.52,-962.23C4526.52,-907.95 4526.52,-808 4526.52,-808 4526.52,-808 4160.78,-808 4160.78,-808"/>
<polygon fill="black" stroke="black" points="4160.78,-804.5 4150.78,-808 4160.78,-811.5 4160.78,-804.5"/>
</g>
<!-- pp_stage1_layer3_expert7_down&#45;&gt;pp_stage1_layer3_route_back_expert7 -->
<g id="edge392" class="edge">
<title>pp_stage1_layer3_expert7_down&#45;&gt;pp_stage1_layer3_route_back_expert7</title>
<path fill="none" stroke="black" d="M3761.02,-774.13C3761.02,-774.13 3761.02,-664.59 3761.02,-664.59"/>
<polygon fill="black" stroke="black" points="3764.52,-664.59 3761.02,-654.59 3757.52,-664.59 3764.52,-664.59"/>
</g>
<!-- pp_stage1_layer3_route_back_expert7&#45;&gt;pp_stage1_layer3_expert_agg -->
<g id="edge441" class="edge">
<title>pp_stage1_layer3_route_back_expert7&#45;&gt;pp_stage1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M3460.27,-518.12C3460.27,-457.36 3460.27,-378 3460.27,-378 3460.27,-378 8546.63,-378 8546.63,-378"/>
<polygon fill="black" stroke="black" points="8546.63,-381.5 8556.63,-378 8546.63,-374.5 8546.63,-381.5"/>
</g>
<!-- pp_stage1_layer3_expert8_activation -->
<g id="node280" class="node">
<title>pp_stage1_layer3_expert8_activation</title>
<polygon fill="lightyellow" stroke="black" points="6130.27,-1030.33 5624.27,-1030.33 5624.27,-962.33 6130.27,-962.33 6130.27,-1030.33"/>
<text text-anchor="middle" x="5877.27" y="-1015.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="5877.27" y="-1000.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="5877.27" y="-985.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="5877.27" y="-970.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert8_up&#45;&gt;pp_stage1_layer3_expert8_activation -->
<g id="edge395" class="edge">
<title>pp_stage1_layer3_expert8_up&#45;&gt;pp_stage1_layer3_expert8_activation</title>
<path fill="none" stroke="black" d="M6004.27,-1116.16C6004.27,-1116.16 6004.27,-1040.42 6004.27,-1040.42"/>
<polygon fill="black" stroke="black" points="6007.77,-1040.42 6004.27,-1030.42 6000.77,-1040.42 6007.77,-1040.42"/>
</g>
<!-- pp_stage1_layer3_expert8_down -->
<g id="node281" class="node">
<title>pp_stage1_layer3_expert8_down</title>
<polygon fill="lightcoral" stroke="black" points="5106.77,-842.33 4609.77,-842.33 4609.77,-774.33 5106.77,-774.33 5106.77,-842.33"/>
<text text-anchor="middle" x="4858.27" y="-827.13" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="4858.27" y="-812.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="4858.27" y="-797.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4858.27" y="-782.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert8_activation&#45;&gt;pp_stage1_layer3_expert8_down -->
<g id="edge396" class="edge">
<title>pp_stage1_layer3_expert8_activation&#45;&gt;pp_stage1_layer3_expert8_down</title>
<path fill="none" stroke="black" d="M5624.19,-984C5382.31,-984 5054.27,-984 5054.27,-984 5054.27,-984 5054.27,-852.62 5054.27,-852.62"/>
<polygon fill="black" stroke="black" points="5057.77,-852.62 5054.27,-842.62 5050.77,-852.62 5057.77,-852.62"/>
</g>
<!-- pp_stage1_layer3_expert8_down&#45;&gt;pp_stage1_layer3_route_back_expert8 -->
<g id="edge397" class="edge">
<title>pp_stage1_layer3_expert8_down&#45;&gt;pp_stage1_layer3_route_back_expert8</title>
<path fill="none" stroke="black" d="M4761.36,-774.13C4761.36,-774.13 4761.36,-664.59 4761.36,-664.59"/>
<polygon fill="black" stroke="black" points="4764.86,-664.59 4761.36,-654.59 4757.86,-664.59 4764.86,-664.59"/>
</g>
<!-- pp_stage1_layer3_route_back_expert8&#45;&gt;pp_stage1_layer3_expert_agg -->
<g id="edge442" class="edge">
<title>pp_stage1_layer3_route_back_expert8&#45;&gt;pp_stage1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M4605.25,-518.15C4605.25,-461.11 4605.25,-389 4605.25,-389 4605.25,-389 8545.2,-389 8545.2,-389"/>
<polygon fill="black" stroke="black" points="8545.2,-392.5 8555.2,-389 8545.2,-385.5 8545.2,-392.5"/>
</g>
<!-- pp_stage1_layer3_expert9_activation -->
<g id="node284" class="node">
<title>pp_stage1_layer3_expert9_activation</title>
<polygon fill="lightyellow" stroke="black" points="7002.27,-1030.33 6496.27,-1030.33 6496.27,-962.33 7002.27,-962.33 7002.27,-1030.33"/>
<text text-anchor="middle" x="6749.27" y="-1015.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="6749.27" y="-1000.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="6749.27" y="-985.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="6749.27" y="-970.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert9_up&#45;&gt;pp_stage1_layer3_expert9_activation -->
<g id="edge400" class="edge">
<title>pp_stage1_layer3_expert9_up&#45;&gt;pp_stage1_layer3_expert9_activation</title>
<path fill="none" stroke="black" d="M6799.27,-1116.16C6799.27,-1116.16 6799.27,-1040.42 6799.27,-1040.42"/>
<polygon fill="black" stroke="black" points="6802.77,-1040.42 6799.27,-1030.42 6795.77,-1040.42 6802.77,-1040.42"/>
</g>
<!-- pp_stage1_layer3_expert9_down -->
<g id="node285" class="node">
<title>pp_stage1_layer3_expert9_down</title>
<polygon fill="lightcoral" stroke="black" points="6792.77,-842.33 6295.77,-842.33 6295.77,-774.33 6792.77,-774.33 6792.77,-842.33"/>
<text text-anchor="middle" x="6544.27" y="-827.13" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="6544.27" y="-812.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="6544.27" y="-797.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6544.27" y="-782.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert9_activation&#45;&gt;pp_stage1_layer3_expert9_down -->
<g id="edge401" class="edge">
<title>pp_stage1_layer3_expert9_activation&#45;&gt;pp_stage1_layer3_expert9_down</title>
<path fill="none" stroke="black" d="M6644.52,-962.29C6644.52,-962.29 6644.52,-852.44 6644.52,-852.44"/>
<polygon fill="black" stroke="black" points="6648.02,-852.44 6644.52,-842.44 6641.02,-852.44 6648.02,-852.44"/>
</g>
<!-- pp_stage1_layer3_expert9_down&#45;&gt;pp_stage1_layer3_route_back_expert9 -->
<g id="edge402" class="edge">
<title>pp_stage1_layer3_expert9_down&#45;&gt;pp_stage1_layer3_route_back_expert9</title>
<path fill="none" stroke="black" d="M6295.67,-808C6211.33,-808 6138.02,-808 6138.02,-808 6138.02,-808 6138.02,-596.49 6138.02,-596.49"/>
<polygon fill="black" stroke="black" points="6141.52,-596.49 6138.02,-586.49 6134.52,-596.49 6141.52,-596.49"/>
</g>
<!-- pp_stage1_layer3_route_back_expert9&#45;&gt;pp_stage1_layer3_expert_agg -->
<g id="edge443" class="edge">
<title>pp_stage1_layer3_route_back_expert9&#45;&gt;pp_stage1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M5796.05,-518.27C5796.05,-465.04 5796.05,-400 5796.05,-400 5796.05,-400 8562.89,-400 8562.89,-400"/>
<polygon fill="black" stroke="black" points="8562.89,-403.5 8572.89,-400 8562.89,-396.5 8562.89,-403.5"/>
</g>
<!-- pp_stage1_layer3_expert10_activation -->
<g id="node288" class="node">
<title>pp_stage1_layer3_expert10_activation</title>
<polygon fill="lightyellow" stroke="black" points="7767.27,-1030.33 7261.27,-1030.33 7261.27,-962.33 7767.27,-962.33 7767.27,-1030.33"/>
<text text-anchor="middle" x="7514.27" y="-1015.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7514.27" y="-1000.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7514.27" y="-985.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7514.27" y="-970.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert10_up&#45;&gt;pp_stage1_layer3_expert10_activation -->
<g id="edge405" class="edge">
<title>pp_stage1_layer3_expert10_up&#45;&gt;pp_stage1_layer3_expert10_activation</title>
<path fill="none" stroke="black" d="M7514.27,-1116.16C7514.27,-1116.16 7514.27,-1040.42 7514.27,-1040.42"/>
<polygon fill="black" stroke="black" points="7517.77,-1040.42 7514.27,-1030.42 7510.77,-1040.42 7517.77,-1040.42"/>
</g>
<!-- pp_stage1_layer3_expert10_down -->
<g id="node289" class="node">
<title>pp_stage1_layer3_expert10_down</title>
<polygon fill="lightcoral" stroke="black" points="7454.77,-842.33 6957.77,-842.33 6957.77,-774.33 7454.77,-774.33 7454.77,-842.33"/>
<text text-anchor="middle" x="7206.27" y="-827.13" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="7206.27" y="-812.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7206.27" y="-797.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7206.27" y="-782.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert10_activation&#45;&gt;pp_stage1_layer3_expert10_down -->
<g id="edge406" class="edge">
<title>pp_stage1_layer3_expert10_activation&#45;&gt;pp_stage1_layer3_expert10_down</title>
<path fill="none" stroke="black" d="M7358.02,-962.29C7358.02,-962.29 7358.02,-852.44 7358.02,-852.44"/>
<polygon fill="black" stroke="black" points="7361.52,-852.44 7358.02,-842.44 7354.52,-852.44 7361.52,-852.44"/>
</g>
<!-- pp_stage1_layer3_expert10_down&#45;&gt;pp_stage1_layer3_route_back_expert10 -->
<g id="edge407" class="edge">
<title>pp_stage1_layer3_expert10_down&#45;&gt;pp_stage1_layer3_route_back_expert10</title>
<path fill="none" stroke="black" d="M7052.69,-774.13C7052.69,-774.13 7052.69,-664.59 7052.69,-664.59"/>
<polygon fill="black" stroke="black" points="7056.19,-664.59 7052.69,-654.59 7049.19,-664.59 7056.19,-664.59"/>
</g>
<!-- pp_stage1_layer3_route_back_expert10&#45;&gt;pp_stage1_layer3_expert_agg -->
<g id="edge444" class="edge">
<title>pp_stage1_layer3_route_back_expert10&#45;&gt;pp_stage1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M6727.27,-518.16C6727.27,-468.54 6727.27,-410 6727.27,-410 6727.27,-410 8598.41,-410 8598.41,-410"/>
<polygon fill="black" stroke="black" points="8598.41,-413.5 8608.41,-410 8598.41,-406.5 8598.41,-413.5"/>
</g>
<!-- pp_stage1_layer3_expert11_activation -->
<g id="node292" class="node">
<title>pp_stage1_layer3_expert11_activation</title>
<polygon fill="lightyellow" stroke="black" points="8331.27,-1030.33 7825.27,-1030.33 7825.27,-962.33 8331.27,-962.33 8331.27,-1030.33"/>
<text text-anchor="middle" x="8078.27" y="-1015.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="8078.27" y="-1000.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="8078.27" y="-985.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="8078.27" y="-970.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert11_up&#45;&gt;pp_stage1_layer3_expert11_activation -->
<g id="edge410" class="edge">
<title>pp_stage1_layer3_expert11_up&#45;&gt;pp_stage1_layer3_expert11_activation</title>
<path fill="none" stroke="black" d="M8128.77,-1116.16C8128.77,-1116.16 8128.77,-1040.42 8128.77,-1040.42"/>
<polygon fill="black" stroke="black" points="8132.27,-1040.42 8128.77,-1030.42 8125.27,-1040.42 8132.27,-1040.42"/>
</g>
<!-- pp_stage1_layer3_expert11_down -->
<g id="node293" class="node">
<title>pp_stage1_layer3_expert11_down</title>
<polygon fill="lightcoral" stroke="black" points="8067.77,-842.33 7570.77,-842.33 7570.77,-774.33 8067.77,-774.33 8067.77,-842.33"/>
<text text-anchor="middle" x="7819.27" y="-827.13" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="7819.27" y="-812.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="7819.27" y="-797.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7819.27" y="-782.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert11_activation&#45;&gt;pp_stage1_layer3_expert11_down -->
<g id="edge411" class="edge">
<title>pp_stage1_layer3_expert11_activation&#45;&gt;pp_stage1_layer3_expert11_down</title>
<path fill="none" stroke="black" d="M7946.52,-962.29C7946.52,-962.29 7946.52,-852.44 7946.52,-852.44"/>
<polygon fill="black" stroke="black" points="7950.02,-852.44 7946.52,-842.44 7943.02,-852.44 7950.02,-852.44"/>
</g>
<!-- pp_stage1_layer3_expert11_down&#45;&gt;pp_stage1_layer3_route_back_expert11 -->
<g id="edge412" class="edge">
<title>pp_stage1_layer3_expert11_down&#45;&gt;pp_stage1_layer3_route_back_expert11</title>
<path fill="none" stroke="black" d="M7819.27,-774.13C7819.27,-774.13 7819.27,-664.59 7819.27,-664.59"/>
<polygon fill="black" stroke="black" points="7822.77,-664.59 7819.27,-654.59 7815.77,-664.59 7822.77,-664.59"/>
</g>
<!-- pp_stage1_layer3_route_back_expert11&#45;&gt;pp_stage1_layer3_expert_agg -->
<g id="edge445" class="edge">
<title>pp_stage1_layer3_route_back_expert11&#45;&gt;pp_stage1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M7816.27,-518.13C7816.27,-472.59 7816.27,-421 7816.27,-421 7816.27,-421 8668.63,-421 8668.63,-421"/>
<polygon fill="black" stroke="black" points="8668.63,-424.5 8678.63,-421 8668.63,-417.5 8668.63,-424.5"/>
</g>
<!-- pp_stage1_layer3_expert12_activation -->
<g id="node296" class="node">
<title>pp_stage1_layer3_expert12_activation</title>
<polygon fill="lightyellow" stroke="black" points="8971.27,-1030.33 8465.27,-1030.33 8465.27,-962.33 8971.27,-962.33 8971.27,-1030.33"/>
<text text-anchor="middle" x="8718.27" y="-1015.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="8718.27" y="-1000.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="8718.27" y="-985.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="8718.27" y="-970.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert12_up&#45;&gt;pp_stage1_layer3_expert12_activation -->
<g id="edge415" class="edge">
<title>pp_stage1_layer3_expert12_up&#45;&gt;pp_stage1_layer3_expert12_activation</title>
<path fill="none" stroke="black" d="M8755.77,-1116.16C8755.77,-1116.16 8755.77,-1040.42 8755.77,-1040.42"/>
<polygon fill="black" stroke="black" points="8759.27,-1040.42 8755.77,-1030.42 8752.27,-1040.42 8759.27,-1040.42"/>
</g>
<!-- pp_stage1_layer3_expert12_down -->
<g id="node297" class="node">
<title>pp_stage1_layer3_expert12_down</title>
<polygon fill="lightcoral" stroke="black" points="8624.77,-842.33 8127.77,-842.33 8127.77,-774.33 8624.77,-774.33 8624.77,-842.33"/>
<text text-anchor="middle" x="8376.27" y="-827.13" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="8376.27" y="-812.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="8376.27" y="-797.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8376.27" y="-782.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert12_activation&#45;&gt;pp_stage1_layer3_expert12_down -->
<g id="edge416" class="edge">
<title>pp_stage1_layer3_expert12_activation&#45;&gt;pp_stage1_layer3_expert12_down</title>
<path fill="none" stroke="black" d="M8545.02,-962.29C8545.02,-962.29 8545.02,-852.44 8545.02,-852.44"/>
<polygon fill="black" stroke="black" points="8548.52,-852.44 8545.02,-842.44 8541.52,-852.44 8548.52,-852.44"/>
</g>
<!-- pp_stage1_layer3_expert12_down&#45;&gt;pp_stage1_layer3_route_back_expert12 -->
<g id="edge417" class="edge">
<title>pp_stage1_layer3_expert12_down&#45;&gt;pp_stage1_layer3_route_back_expert12</title>
<path fill="none" stroke="black" d="M8507.38,-774.13C8507.38,-774.13 8507.38,-604.01 8507.38,-604.01"/>
<polygon fill="black" stroke="black" points="8510.88,-604.01 8507.38,-594.01 8503.88,-604.01 8510.88,-604.01"/>
</g>
<!-- pp_stage1_layer3_route_back_expert12&#45;&gt;pp_stage1_layer3_expert_agg -->
<g id="edge446" class="edge">
<title>pp_stage1_layer3_route_back_expert12&#45;&gt;pp_stage1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M8905.27,-518.2C8905.27,-518.2 8905.27,-442.64 8905.27,-442.64"/>
<polygon fill="black" stroke="black" points="8908.77,-442.64 8905.27,-432.64 8901.77,-442.64 8908.77,-442.64"/>
</g>
<!-- pp_stage1_layer3_expert13_activation -->
<g id="node300" class="node">
<title>pp_stage1_layer3_expert13_activation</title>
<polygon fill="lightyellow" stroke="black" points="10246.27,-1030.33 9740.27,-1030.33 9740.27,-962.33 10246.27,-962.33 10246.27,-1030.33"/>
<text text-anchor="middle" x="9993.27" y="-1015.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="9993.27" y="-1000.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9993.27" y="-985.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9993.27" y="-970.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert13_up&#45;&gt;pp_stage1_layer3_expert13_activation -->
<g id="edge420" class="edge">
<title>pp_stage1_layer3_expert13_up&#45;&gt;pp_stage1_layer3_expert13_activation</title>
<path fill="none" stroke="black" d="M9786.27,-1116.16C9786.27,-1116.16 9786.27,-1040.42 9786.27,-1040.42"/>
<polygon fill="black" stroke="black" points="9789.77,-1040.42 9786.27,-1030.42 9782.77,-1040.42 9789.77,-1040.42"/>
</g>
<!-- pp_stage1_layer3_expert13_down -->
<g id="node301" class="node">
<title>pp_stage1_layer3_expert13_down</title>
<polygon fill="lightcoral" stroke="black" points="10242.77,-842.33 9745.77,-842.33 9745.77,-774.33 10242.77,-774.33 10242.77,-842.33"/>
<text text-anchor="middle" x="9994.27" y="-827.13" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="9994.27" y="-812.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="9994.27" y="-797.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9994.27" y="-782.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert13_activation&#45;&gt;pp_stage1_layer3_expert13_down -->
<g id="edge421" class="edge">
<title>pp_stage1_layer3_expert13_activation&#45;&gt;pp_stage1_layer3_expert13_down</title>
<path fill="none" stroke="black" d="M9994.27,-962.29C9994.27,-962.29 9994.27,-852.44 9994.27,-852.44"/>
<polygon fill="black" stroke="black" points="9997.77,-852.44 9994.27,-842.44 9990.77,-852.44 9997.77,-852.44"/>
</g>
<!-- pp_stage1_layer3_expert13_down&#45;&gt;pp_stage1_layer3_route_back_expert13 -->
<g id="edge422" class="edge">
<title>pp_stage1_layer3_expert13_down&#45;&gt;pp_stage1_layer3_route_back_expert13</title>
<path fill="none" stroke="black" d="M9994.27,-774.13C9994.27,-774.13 9994.27,-664.59 9994.27,-664.59"/>
<polygon fill="black" stroke="black" points="9997.77,-664.59 9994.27,-654.59 9990.77,-664.59 9997.77,-664.59"/>
</g>
<!-- pp_stage1_layer3_route_back_expert13&#45;&gt;pp_stage1_layer3_expert_agg -->
<g id="edge447" class="edge">
<title>pp_stage1_layer3_route_back_expert13&#45;&gt;pp_stage1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M9994.27,-518.13C9994.27,-472.59 9994.27,-421 9994.27,-421 9994.27,-421 9141.9,-421 9141.9,-421"/>
<polygon fill="black" stroke="black" points="9141.9,-417.5 9131.9,-421 9141.9,-424.5 9141.9,-417.5"/>
</g>
<!-- pp_stage1_layer3_expert14_activation -->
<g id="node304" class="node">
<title>pp_stage1_layer3_expert14_activation</title>
<polygon fill="lightyellow" stroke="black" points="10810.27,-1030.33 10304.27,-1030.33 10304.27,-962.33 10810.27,-962.33 10810.27,-1030.33"/>
<text text-anchor="middle" x="10557.27" y="-1015.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="10557.27" y="-1000.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10557.27" y="-985.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10557.27" y="-970.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert14_up&#45;&gt;pp_stage1_layer3_expert14_activation -->
<g id="edge425" class="edge">
<title>pp_stage1_layer3_expert14_up&#45;&gt;pp_stage1_layer3_expert14_activation</title>
<path fill="none" stroke="black" d="M10370.27,-1116.16C10370.27,-1116.16 10370.27,-1040.42 10370.27,-1040.42"/>
<polygon fill="black" stroke="black" points="10373.77,-1040.42 10370.27,-1030.42 10366.77,-1040.42 10373.77,-1040.42"/>
</g>
<!-- pp_stage1_layer3_expert14_down -->
<g id="node305" class="node">
<title>pp_stage1_layer3_expert14_down</title>
<polygon fill="lightcoral" stroke="black" points="11064.77,-842.33 10567.77,-842.33 10567.77,-774.33 11064.77,-774.33 11064.77,-842.33"/>
<text text-anchor="middle" x="10816.27" y="-827.13" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="10816.27" y="-812.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="10816.27" y="-797.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10816.27" y="-782.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert14_activation&#45;&gt;pp_stage1_layer3_expert14_down -->
<g id="edge426" class="edge">
<title>pp_stage1_layer3_expert14_activation&#45;&gt;pp_stage1_layer3_expert14_down</title>
<path fill="none" stroke="black" d="M10689.02,-962.29C10689.02,-962.29 10689.02,-852.44 10689.02,-852.44"/>
<polygon fill="black" stroke="black" points="10692.52,-852.44 10689.02,-842.44 10685.52,-852.44 10692.52,-852.44"/>
</g>
<!-- pp_stage1_layer3_expert14_down&#45;&gt;pp_stage1_layer3_route_back_expert14 -->
<g id="edge427" class="edge">
<title>pp_stage1_layer3_expert14_down&#45;&gt;pp_stage1_layer3_route_back_expert14</title>
<path fill="none" stroke="black" d="M10899.18,-774.13C10899.18,-774.13 10899.18,-664.59 10899.18,-664.59"/>
<polygon fill="black" stroke="black" points="10902.68,-664.59 10899.18,-654.59 10895.68,-664.59 10902.68,-664.59"/>
</g>
<!-- pp_stage1_layer3_route_back_expert14&#45;&gt;pp_stage1_layer3_expert_agg -->
<g id="edge448" class="edge">
<title>pp_stage1_layer3_route_back_expert14&#45;&gt;pp_stage1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M11083.27,-518.16C11083.27,-468.54 11083.27,-410 11083.27,-410 11083.27,-410 9212.12,-410 9212.12,-410"/>
<polygon fill="black" stroke="black" points="9212.12,-406.5 9202.12,-410 9212.12,-413.5 9212.12,-406.5"/>
</g>
<!-- pp_stage1_layer3_expert15_activation -->
<g id="node308" class="node">
<title>pp_stage1_layer3_expert15_activation</title>
<polygon fill="lightyellow" stroke="black" points="11374.27,-1030.33 10868.27,-1030.33 10868.27,-962.33 11374.27,-962.33 11374.27,-1030.33"/>
<text text-anchor="middle" x="11121.27" y="-1015.13" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="11121.27" y="-1000.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11121.27" y="-985.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11121.27" y="-970.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert15_up&#45;&gt;pp_stage1_layer3_expert15_activation -->
<g id="edge430" class="edge">
<title>pp_stage1_layer3_expert15_up&#45;&gt;pp_stage1_layer3_expert15_activation</title>
<path fill="none" stroke="black" d="M10944.27,-1116.16C10944.27,-1116.16 10944.27,-1040.42 10944.27,-1040.42"/>
<polygon fill="black" stroke="black" points="10947.77,-1040.42 10944.27,-1030.42 10940.77,-1040.42 10947.77,-1040.42"/>
</g>
<!-- pp_stage1_layer3_expert15_down -->
<g id="node309" class="node">
<title>pp_stage1_layer3_expert15_down</title>
<polygon fill="lightcoral" stroke="black" points="12019.77,-842.33 11522.77,-842.33 11522.77,-774.33 12019.77,-774.33 12019.77,-842.33"/>
<text text-anchor="middle" x="11771.27" y="-827.13" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="11771.27" y="-812.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=16384]</text>
<text text-anchor="middle" x="11771.27" y="-797.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11771.27" y="-782.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_expert15_activation&#45;&gt;pp_stage1_layer3_expert15_down -->
<g id="edge431" class="edge">
<title>pp_stage1_layer3_expert15_activation&#45;&gt;pp_stage1_layer3_expert15_down</title>
<path fill="none" stroke="black" d="M11219.52,-962.23C11219.52,-907.95 11219.52,-808 11219.52,-808 11219.52,-808 11512.43,-808 11512.43,-808"/>
<polygon fill="black" stroke="black" points="11512.43,-811.5 11522.43,-808 11512.43,-804.5 11512.43,-811.5"/>
</g>
<!-- pp_stage1_layer3_expert15_down&#45;&gt;pp_stage1_layer3_route_back_expert15 -->
<g id="edge432" class="edge">
<title>pp_stage1_layer3_expert15_down&#45;&gt;pp_stage1_layer3_route_back_expert15</title>
<path fill="none" stroke="black" d="M11898.84,-774.13C11898.84,-774.13 11898.84,-664.59 11898.84,-664.59"/>
<polygon fill="black" stroke="black" points="11902.34,-664.59 11898.84,-654.59 11895.34,-664.59 11902.34,-664.59"/>
</g>
<!-- pp_stage1_layer3_route_back_expert15&#45;&gt;pp_stage1_layer3_expert_agg -->
<g id="edge449" class="edge">
<title>pp_stage1_layer3_route_back_expert15&#45;&gt;pp_stage1_layer3_expert_agg</title>
<path fill="none" stroke="black" d="M12172.27,-518.27C12172.27,-465.04 12172.27,-400 12172.27,-400 12172.27,-400 9247.64,-400 9247.64,-400"/>
<polygon fill="black" stroke="black" points="9247.64,-396.5 9237.64,-400 9247.64,-403.5 9247.64,-396.5"/>
</g>
<!-- pp_stage1_layer3_expert_agg&#45;&gt;pp_stage1_layer3_final_residual -->
<g id="edge451" class="edge">
<title>pp_stage1_layer3_expert_agg&#45;&gt;pp_stage1_layer3_final_residual</title>
<path fill="none" stroke="black" d="M8692.07,-346C7915.14,-346 5280.78,-346 5280.78,-346 5280.78,-346 5280.78,-243.67 5280.78,-243.67"/>
<polygon fill="black" stroke="black" points="5284.28,-243.67 5280.78,-233.67 5277.28,-243.67 5284.28,-243.67"/>
</g>
<!-- pp_output -->
<g id="node313" class="node">
<title>pp_output</title>
<polygon fill="lightgreen" stroke="black" points="5057.27,-68 4527.27,-68 4527.27,0 5057.27,0 5057.27,-68"/>
<text text-anchor="middle" x="4792.27" y="-52.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4792.27" y="-37.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4792.27" y="-22.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, vocab_size=vocab_size]</text>
<text text-anchor="middle" x="4792.27" y="-7.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pp_stage1_layer3_final_residual&#45;&gt;pp_output -->
<g id="edge452" class="edge">
<title>pp_stage1_layer3_final_residual&#45;&gt;pp_output</title>
<path fill="none" stroke="black" d="M4792.27,-153.92C4792.27,-153.92 4792.27,-78.03 4792.27,-78.03"/>
<polygon fill="black" stroke="black" points="4795.77,-78.03 4792.27,-68.03 4788.77,-78.03 4795.77,-78.03"/>
</g>
</g>
</svg>
