<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MA_Separation_DAG Pages: 1 -->
<svg width="23094pt" height="14352pt"
 viewBox="0.00 0.00 23093.53 14351.83" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 14347.83)">
<title>MA_Separation_DAG</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-14347.83 23089.53,-14347.83 23089.53,4 -4,4"/>
<!-- model_input -->
<g id="node1" class="node">
<title>model_input</title>
<ellipse fill="lightblue" stroke="black" cx="12653.27" cy="-14295.75" rx="252.37" ry="48.17"/>
<text text-anchor="middle" x="12653.27" y="-14314.55" font-family="Times,serif" font-size="14.00">Model Input</text>
<text text-anchor="middle" x="12653.27" y="-14299.55" font-family="Times,serif" font-size="14.00">Input: Raw tokens</text>
<text text-anchor="middle" x="12653.27" y="-14284.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048]</text>
<text text-anchor="middle" x="12653.27" y="-14269.55" font-family="Times,serif" font-size="14.00">GPU: CPU</text>
</g>
<!-- token_embedding -->
<g id="node2" class="node">
<title>token_embedding</title>
<polygon fill="lightyellow" stroke="black" points="12901.77,-14161.66 12404.77,-14161.66 12404.77,-14093.66 12901.77,-14093.66 12901.77,-14161.66"/>
<text text-anchor="middle" x="12653.27" y="-14146.46" font-family="Times,serif" font-size="14.00">Token Embedding</text>
<text text-anchor="middle" x="12653.27" y="-14131.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048]</text>
<text text-anchor="middle" x="12653.27" y="-14116.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12653.27" y="-14101.46" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- model_input&#45;&gt;token_embedding -->
<g id="edge1" class="edge">
<title>model_input&#45;&gt;token_embedding</title>
<path fill="none" stroke="black" d="M12653.27,-14247.58C12653.27,-14247.58 12653.27,-14171.69 12653.27,-14171.69"/>
<polygon fill="black" stroke="black" points="12656.77,-14171.69 12653.27,-14161.69 12649.77,-14171.69 12656.77,-14171.69"/>
</g>
<!-- add_embeddings -->
<g id="node4" class="node">
<title>add_embeddings</title>
<ellipse fill="lightblue" stroke="black" cx="12930.27" cy="-13959.58" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="12930.27" y="-13978.38" font-family="Times,serif" font-size="14.00">Add Embeddings</text>
<text text-anchor="middle" x="12930.27" y="-13963.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096], [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12930.27" y="-13948.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12930.27" y="-13933.38" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- token_embedding&#45;&gt;add_embeddings -->
<g id="edge2" class="edge">
<title>token_embedding&#45;&gt;add_embeddings</title>
<path fill="none" stroke="black" d="M12653.27,-14093.65C12653.27,-14093.65 12653.27,-14013.14 12653.27,-14013.14"/>
<polygon fill="black" stroke="black" points="12656.77,-14013.14 12653.27,-14003.14 12649.77,-14013.14 12656.77,-14013.14"/>
</g>
<!-- position_embedding -->
<g id="node3" class="node">
<title>position_embedding</title>
<polygon fill="lightyellow" stroke="black" points="13456.77,-14161.66 12959.77,-14161.66 12959.77,-14093.66 13456.77,-14093.66 13456.77,-14161.66"/>
<text text-anchor="middle" x="13208.27" y="-14146.46" font-family="Times,serif" font-size="14.00">Position Embedding</text>
<text text-anchor="middle" x="13208.27" y="-14131.46" font-family="Times,serif" font-size="14.00">Input: [seq_len=2048]</text>
<text text-anchor="middle" x="13208.27" y="-14116.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13208.27" y="-14101.46" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- position_embedding&#45;&gt;add_embeddings -->
<g id="edge3" class="edge">
<title>position_embedding&#45;&gt;add_embeddings</title>
<path fill="none" stroke="black" d="M13208.27,-14093.65C13208.27,-14093.65 13208.27,-14013.14 13208.27,-14013.14"/>
<polygon fill="black" stroke="black" points="13211.77,-14013.14 13208.27,-14003.14 13204.77,-14013.14 13211.77,-14013.14"/>
</g>
<!-- layer0_attn_norm_gpu0 -->
<g id="node5" class="node">
<title>layer0_attn_norm_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="16253.77,-13825.5 15756.77,-13825.5 15756.77,-13757.5 16253.77,-13757.5 16253.77,-13825.5"/>
<text text-anchor="middle" x="16005.27" y="-13810.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="16005.27" y="-13795.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16005.27" y="-13780.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16005.27" y="-13765.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- add_embeddings&#45;&gt;layer0_attn_norm_gpu0 -->
<g id="edge4" class="edge">
<title>add_embeddings&#45;&gt;layer0_attn_norm_gpu0</title>
<path fill="none" stroke="black" d="M13485.79,-13935C14371.61,-13935 16005.27,-13935 16005.27,-13935 16005.27,-13935 16005.27,-13835.5 16005.27,-13835.5"/>
<polygon fill="black" stroke="black" points="16008.77,-13835.5 16005.27,-13825.5 16001.77,-13835.5 16008.77,-13835.5"/>
</g>
<!-- layer0_attn_norm_gpu1 -->
<g id="node16" class="node">
<title>layer0_attn_norm_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="17929.77,-13825.5 17432.77,-13825.5 17432.77,-13757.5 17929.77,-13757.5 17929.77,-13825.5"/>
<text text-anchor="middle" x="17681.27" y="-13810.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="17681.27" y="-13795.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17681.27" y="-13780.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17681.27" y="-13765.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- add_embeddings&#45;&gt;layer0_attn_norm_gpu1 -->
<g id="edge17" class="edge">
<title>add_embeddings&#45;&gt;layer0_attn_norm_gpu1</title>
<path fill="none" stroke="black" d="M13576.57,-13959C14875.85,-13959 17681.27,-13959 17681.27,-13959 17681.27,-13959 17681.27,-13835.8 17681.27,-13835.8"/>
<polygon fill="black" stroke="black" points="17684.77,-13835.8 17681.27,-13825.8 17677.77,-13835.8 17684.77,-13835.8"/>
</g>
<!-- layer0_attn_norm_gpu2 -->
<g id="node27" class="node">
<title>layer0_attn_norm_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="19606.77,-13825.5 19109.77,-13825.5 19109.77,-13757.5 19606.77,-13757.5 19606.77,-13825.5"/>
<text text-anchor="middle" x="19358.27" y="-13810.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="19358.27" y="-13795.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19358.27" y="-13780.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19358.27" y="-13765.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- add_embeddings&#45;&gt;layer0_attn_norm_gpu2 -->
<g id="edge30" class="edge">
<title>add_embeddings&#45;&gt;layer0_attn_norm_gpu2</title>
<path fill="none" stroke="black" d="M13494.72,-13983C15062.98,-13983 19358.27,-13983 19358.27,-13983 19358.27,-13983 19358.27,-13835.73 19358.27,-13835.73"/>
<polygon fill="black" stroke="black" points="19361.77,-13835.73 19358.27,-13825.73 19354.77,-13835.73 19361.77,-13835.73"/>
</g>
<!-- layer0_attn_norm_gpu3 -->
<g id="node38" class="node">
<title>layer0_attn_norm_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="8426.77,-13825.5 7929.77,-13825.5 7929.77,-13757.5 8426.77,-13757.5 8426.77,-13825.5"/>
<text text-anchor="middle" x="8178.27" y="-13810.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="8178.27" y="-13795.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8178.27" y="-13780.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8178.27" y="-13765.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- add_embeddings&#45;&gt;layer0_attn_norm_gpu3 -->
<g id="edge43" class="edge">
<title>add_embeddings&#45;&gt;layer0_attn_norm_gpu3</title>
<path fill="none" stroke="black" d="M12317.84,-13975C11033.97,-13975 8178.27,-13975 8178.27,-13975 8178.27,-13975 8178.27,-13835.58 8178.27,-13835.58"/>
<polygon fill="black" stroke="black" points="8181.77,-13835.58 8178.27,-13825.58 8174.77,-13835.58 8181.77,-13835.58"/>
</g>
<!-- layer0_attn_norm_gpu4 -->
<g id="node49" class="node">
<title>layer0_attn_norm_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="10103.77,-13825.5 9606.77,-13825.5 9606.77,-13757.5 10103.77,-13757.5 10103.77,-13825.5"/>
<text text-anchor="middle" x="9855.27" y="-13810.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="9855.27" y="-13795.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9855.27" y="-13780.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9855.27" y="-13765.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- add_embeddings&#45;&gt;layer0_attn_norm_gpu4 -->
<g id="edge56" class="edge">
<title>add_embeddings&#45;&gt;layer0_attn_norm_gpu4</title>
<path fill="none" stroke="black" d="M12323.2,-13943C11427.13,-13943 9855.27,-13943 9855.27,-13943 9855.27,-13943 9855.27,-13835.5 9855.27,-13835.5"/>
<polygon fill="black" stroke="black" points="9858.77,-13835.5 9855.27,-13825.5 9851.77,-13835.5 9858.77,-13835.5"/>
</g>
<!-- layer0_attn_norm_gpu5 -->
<g id="node60" class="node">
<title>layer0_attn_norm_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="11781.77,-13825.5 11284.77,-13825.5 11284.77,-13757.5 11781.77,-13757.5 11781.77,-13825.5"/>
<text text-anchor="middle" x="11533.27" y="-13810.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="11533.27" y="-13795.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11533.27" y="-13780.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11533.27" y="-13765.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- add_embeddings&#45;&gt;layer0_attn_norm_gpu5 -->
<g id="edge69" class="edge">
<title>add_embeddings&#45;&gt;layer0_attn_norm_gpu5</title>
<path fill="none" stroke="black" d="M12396.57,-13932.13C12396.57,-13886.98 12396.57,-13802 12396.57,-13802 12396.57,-13802 11791.81,-13802 11791.81,-13802"/>
<polygon fill="black" stroke="black" points="11791.81,-13798.5 11781.81,-13802 11791.81,-13805.5 11791.81,-13798.5"/>
</g>
<!-- layer0_attn_norm_gpu6 -->
<g id="node71" class="node">
<title>layer0_attn_norm_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="13178.77,-13825.5 12681.77,-13825.5 12681.77,-13757.5 13178.77,-13757.5 13178.77,-13825.5"/>
<text text-anchor="middle" x="12930.27" y="-13810.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="12930.27" y="-13795.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12930.27" y="-13780.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12930.27" y="-13765.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- add_embeddings&#45;&gt;layer0_attn_norm_gpu6 -->
<g id="edge82" class="edge">
<title>add_embeddings&#45;&gt;layer0_attn_norm_gpu6</title>
<path fill="none" stroke="black" d="M12930.27,-13911.41C12930.27,-13911.41 12930.27,-13835.53 12930.27,-13835.53"/>
<polygon fill="black" stroke="black" points="12933.77,-13835.53 12930.27,-13825.53 12926.77,-13835.53 12933.77,-13835.53"/>
</g>
<!-- layer0_attn_norm_gpu7 -->
<g id="node82" class="node">
<title>layer0_attn_norm_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="14575.77,-13825.5 14078.77,-13825.5 14078.77,-13757.5 14575.77,-13757.5 14575.77,-13825.5"/>
<text text-anchor="middle" x="14327.27" y="-13810.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="14327.27" y="-13795.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14327.27" y="-13780.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14327.27" y="-13765.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- add_embeddings&#45;&gt;layer0_attn_norm_gpu7 -->
<g id="edge95" class="edge">
<title>add_embeddings&#45;&gt;layer0_attn_norm_gpu7</title>
<path fill="none" stroke="black" d="M13463.96,-13932.13C13463.96,-13886.98 13463.96,-13802 13463.96,-13802 13463.96,-13802 14068.72,-13802 14068.72,-13802"/>
<polygon fill="black" stroke="black" points="14068.72,-13805.5 14078.72,-13802 14068.72,-13798.5 14068.72,-13805.5"/>
</g>
<!-- layer0_attn_residual -->
<g id="node94" class="node">
<title>layer0_attn_residual</title>
<ellipse fill="lightblue" stroke="black" cx="9686.27" cy="-12432.75" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="9686.27" y="-12451.55" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9686.27" y="-12436.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096], [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9686.27" y="-12421.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9686.27" y="-12406.55" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- add_embeddings&#45;&gt;layer0_attn_residual -->
<g id="edge116" class="edge">
<title>add_embeddings&#45;&gt;layer0_attn_residual</title>
<path fill="none" stroke="black" d="M13209.77,-13915.87C13209.77,-13780.61 13209.77,-13378 13209.77,-13378 13209.77,-13378 10266.16,-13378 10266.16,-13378 10266.16,-13378 10266.16,-12464.26 10266.16,-12464.26"/>
<polygon fill="black" stroke="black" points="10269.66,-12464.26 10266.16,-12454.26 10262.66,-12464.26 10269.66,-12464.26"/>
</g>
<!-- layer0_q_proj_gpu0 -->
<g id="node6" class="node">
<title>layer0_q_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="17093.77,-13671.5 16592.77,-13671.5 16592.77,-13603.5 17093.77,-13603.5 17093.77,-13671.5"/>
<text text-anchor="middle" x="16843.27" y="-13656.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="16843.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16843.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="16843.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_attn_norm_gpu0&#45;&gt;layer0_q_proj_gpu0 -->
<g id="edge5" class="edge">
<title>layer0_attn_norm_gpu0&#45;&gt;layer0_q_proj_gpu0</title>
<path fill="none" stroke="black" d="M16253.86,-13791C16500.92,-13791 16843.27,-13791 16843.27,-13791 16843.27,-13791 16843.27,-13681.56 16843.27,-13681.56"/>
<polygon fill="black" stroke="black" points="16846.77,-13681.56 16843.27,-13671.56 16839.77,-13681.56 16846.77,-13681.56"/>
</g>
<!-- layer0_k_proj_gpu0 -->
<g id="node7" class="node">
<title>layer0_k_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="16534.77,-13671.5 16033.77,-13671.5 16033.77,-13603.5 16534.77,-13603.5 16534.77,-13671.5"/>
<text text-anchor="middle" x="16284.27" y="-13656.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="16284.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16284.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="16284.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_attn_norm_gpu0&#45;&gt;layer0_k_proj_gpu0 -->
<g id="edge6" class="edge">
<title>layer0_attn_norm_gpu0&#45;&gt;layer0_k_proj_gpu0</title>
<path fill="none" stroke="black" d="M16143.77,-13757.32C16143.77,-13757.32 16143.77,-13681.58 16143.77,-13681.58"/>
<polygon fill="black" stroke="black" points="16147.27,-13681.58 16143.77,-13671.58 16140.27,-13681.58 16147.27,-13681.58"/>
</g>
<!-- layer0_v_proj_gpu0 -->
<g id="node8" class="node">
<title>layer0_v_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="15975.77,-13671.5 15474.77,-13671.5 15474.77,-13603.5 15975.77,-13603.5 15975.77,-13671.5"/>
<text text-anchor="middle" x="15725.27" y="-13656.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="15725.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15725.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15725.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_attn_norm_gpu0&#45;&gt;layer0_v_proj_gpu0 -->
<g id="edge7" class="edge">
<title>layer0_attn_norm_gpu0&#45;&gt;layer0_v_proj_gpu0</title>
<path fill="none" stroke="black" d="M15866.27,-13757.32C15866.27,-13757.32 15866.27,-13681.58 15866.27,-13681.58"/>
<polygon fill="black" stroke="black" points="15869.77,-13681.58 15866.27,-13671.58 15862.77,-13681.58 15869.77,-13681.58"/>
</g>
<!-- layer0_gather_q_gpu0 -->
<g id="node9" class="node">
<title>layer0_gather_q_gpu0</title>
<ellipse fill="lightblue" stroke="black" cx="16953.27" cy="-13469.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="16953.27" y="-13488.21" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="16953.27" y="-13473.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="16953.27" y="-13458.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="16953.27" y="-13443.21" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_q_proj_gpu0&#45;&gt;layer0_gather_q_gpu0 -->
<g id="edge8" class="edge">
<title>layer0_q_proj_gpu0&#45;&gt;layer0_gather_q_gpu0</title>
<path fill="none" stroke="black" d="M16843.27,-13603.48C16843.27,-13603.48 16843.27,-13525.48 16843.27,-13525.48"/>
<polygon fill="black" stroke="black" points="16846.77,-13525.48 16843.27,-13515.48 16839.77,-13525.48 16846.77,-13525.48"/>
</g>
<!-- layer0_gather_k_gpu0 -->
<g id="node10" class="node">
<title>layer0_gather_k_gpu0</title>
<ellipse fill="lightblue" stroke="black" cx="16174.27" cy="-13469.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="16174.27" y="-13488.21" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="16174.27" y="-13473.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="16174.27" y="-13458.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="16174.27" y="-13443.21" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_k_proj_gpu0&#45;&gt;layer0_gather_k_gpu0 -->
<g id="edge9" class="edge">
<title>layer0_k_proj_gpu0&#45;&gt;layer0_gather_k_gpu0</title>
<path fill="none" stroke="black" d="M16284.27,-13603.48C16284.27,-13603.48 16284.27,-13525.48 16284.27,-13525.48"/>
<polygon fill="black" stroke="black" points="16287.77,-13525.48 16284.27,-13515.48 16280.77,-13525.48 16287.77,-13525.48"/>
</g>
<!-- layer0_gather_v_gpu0 -->
<g id="node11" class="node">
<title>layer0_gather_v_gpu0</title>
<ellipse fill="lightblue" stroke="black" cx="15606.27" cy="-13105.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="15606.27" y="-13123.88" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="15606.27" y="-13108.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15606.27" y="-13093.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="15606.27" y="-13078.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_v_proj_gpu0&#45;&gt;layer0_gather_v_gpu0 -->
<g id="edge10" class="edge">
<title>layer0_v_proj_gpu0&#45;&gt;layer0_gather_v_gpu0</title>
<path fill="none" stroke="black" d="M15725.27,-13603.38C15725.27,-13603.38 15725.27,-13160.64 15725.27,-13160.64"/>
<polygon fill="black" stroke="black" points="15728.77,-13160.64 15725.27,-13150.64 15721.77,-13160.64 15728.77,-13160.64"/>
</g>
<!-- layer0_attn_scores_gpu0 -->
<g id="node12" class="node">
<title>layer0_attn_scores_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="16563.77,-13321.25 16024.77,-13321.25 16024.77,-13253.25 16563.77,-13253.25 16563.77,-13321.25"/>
<text text-anchor="middle" x="16294.27" y="-13306.05" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="16294.27" y="-13291.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="16294.27" y="-13276.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="16294.27" y="-13261.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gather_q_gpu0&#45;&gt;layer0_attn_scores_gpu0 -->
<g id="edge11" class="edge">
<title>layer0_gather_q_gpu0&#45;&gt;layer0_attn_scores_gpu0</title>
<path fill="none" stroke="black" d="M16592.56,-13469C16565.99,-13469 16549.33,-13469 16549.33,-13469 16549.33,-13469 16549.33,-13331.43 16549.33,-13331.43"/>
<polygon fill="black" stroke="black" points="16552.83,-13331.43 16549.33,-13321.43 16545.83,-13331.43 16552.83,-13331.43"/>
</g>
<!-- layer0_gather_k_gpu0&#45;&gt;layer0_attn_scores_gpu0 -->
<g id="edge12" class="edge">
<title>layer0_gather_k_gpu0&#45;&gt;layer0_attn_scores_gpu0</title>
<path fill="none" stroke="black" d="M16279.83,-13422.97C16279.83,-13422.97 16279.83,-13331.52 16279.83,-13331.52"/>
<polygon fill="black" stroke="black" points="16283.33,-13331.52 16279.83,-13321.52 16276.33,-13331.52 16283.33,-13331.52"/>
</g>
<!-- layer0_attn_out_gpu0 -->
<g id="node14" class="node">
<title>layer0_attn_out_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="15869.77,-12971 15342.77,-12971 15342.77,-12903 15869.77,-12903 15869.77,-12971"/>
<text text-anchor="middle" x="15606.27" y="-12955.8" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="15606.27" y="-12940.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="15606.27" y="-12925.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15606.27" y="-12910.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_gather_v_gpu0&#45;&gt;layer0_attn_out_gpu0 -->
<g id="edge15" class="edge">
<title>layer0_gather_v_gpu0&#45;&gt;layer0_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M15606.27,-13056.91C15606.27,-13056.91 15606.27,-12981.03 15606.27,-12981.03"/>
<polygon fill="black" stroke="black" points="15609.77,-12981.03 15606.27,-12971.03 15602.77,-12981.03 15609.77,-12981.03"/>
</g>
<!-- layer0_softmax_gpu0 -->
<g id="node13" class="node">
<title>layer0_softmax_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="16563.77,-13139.08 16024.77,-13139.08 16024.77,-13071.08 16563.77,-13071.08 16563.77,-13139.08"/>
<text text-anchor="middle" x="16294.27" y="-13123.88" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="16294.27" y="-13108.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="16294.27" y="-13093.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="16294.27" y="-13078.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_attn_scores_gpu0&#45;&gt;layer0_softmax_gpu0 -->
<g id="edge13" class="edge">
<title>layer0_attn_scores_gpu0&#45;&gt;layer0_softmax_gpu0</title>
<path fill="none" stroke="black" d="M16294.27,-13252.98C16294.27,-13252.98 16294.27,-13149.19 16294.27,-13149.19"/>
<polygon fill="black" stroke="black" points="16297.77,-13149.19 16294.27,-13139.19 16290.77,-13149.19 16297.77,-13149.19"/>
</g>
<!-- layer0_softmax_gpu0&#45;&gt;layer0_attn_out_gpu0 -->
<g id="edge14" class="edge">
<title>layer0_softmax_gpu0&#45;&gt;layer0_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M16237.77,-13071C16237.77,-13024.8 16237.77,-12948 16237.77,-12948 16237.77,-12948 15879.96,-12948 15879.96,-12948"/>
<polygon fill="black" stroke="black" points="15879.96,-12944.5 15869.96,-12948 15879.96,-12951.5 15879.96,-12944.5"/>
</g>
<!-- layer0_out_proj_gpu0 -->
<g id="node15" class="node">
<title>layer0_out_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="15403.77,-12817 14914.77,-12817 14914.77,-12749 15403.77,-12749 15403.77,-12817"/>
<text text-anchor="middle" x="15159.27" y="-12801.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15159.27" y="-12786.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15159.27" y="-12771.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="15159.27" y="-12756.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_attn_out_gpu0&#45;&gt;layer0_out_proj_gpu0 -->
<g id="edge16" class="edge">
<title>layer0_attn_out_gpu0&#45;&gt;layer0_out_proj_gpu0</title>
<path fill="none" stroke="black" d="M15373.27,-12902.82C15373.27,-12902.82 15373.27,-12827.08 15373.27,-12827.08"/>
<polygon fill="black" stroke="black" points="15376.77,-12827.08 15373.27,-12817.08 15369.77,-12827.08 15376.77,-12827.08"/>
</g>
<!-- layer0_attn_all_reduce -->
<g id="node93" class="node">
<title>layer0_attn_all_reduce</title>
<ellipse fill="lightblue" stroke="black" cx="12653.27" cy="-12614.91" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="12653.27" y="-12633.71" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="12653.27" y="-12618.71" font-family="Times,serif" font-size="14.00">Input: 8×[512]</text>
<text text-anchor="middle" x="12653.27" y="-12603.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12653.27" y="-12588.71" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- layer0_out_proj_gpu0&#45;&gt;layer0_attn_all_reduce -->
<g id="edge108" class="edge">
<title>layer0_out_proj_gpu0&#45;&gt;layer0_attn_all_reduce</title>
<path fill="none" stroke="black" d="M15159.27,-12748.63C15159.27,-12705.76 15159.27,-12638 15159.27,-12638 15159.27,-12638 12971.81,-12638 12971.81,-12638"/>
<polygon fill="black" stroke="black" points="12971.81,-12634.5 12961.81,-12638 12971.81,-12641.5 12971.81,-12634.5"/>
</g>
<!-- layer0_q_proj_gpu1 -->
<g id="node17" class="node">
<title>layer0_q_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="18770.77,-13671.5 18269.77,-13671.5 18269.77,-13603.5 18770.77,-13603.5 18770.77,-13671.5"/>
<text text-anchor="middle" x="18520.27" y="-13656.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="18520.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18520.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="18520.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_attn_norm_gpu1&#45;&gt;layer0_q_proj_gpu1 -->
<g id="edge18" class="edge">
<title>layer0_attn_norm_gpu1&#45;&gt;layer0_q_proj_gpu1</title>
<path fill="none" stroke="black" d="M17929.87,-13791C18177.25,-13791 18520.27,-13791 18520.27,-13791 18520.27,-13791 18520.27,-13681.56 18520.27,-13681.56"/>
<polygon fill="black" stroke="black" points="18523.77,-13681.56 18520.27,-13671.56 18516.77,-13681.56 18523.77,-13681.56"/>
</g>
<!-- layer0_k_proj_gpu1 -->
<g id="node18" class="node">
<title>layer0_k_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="18211.77,-13671.5 17710.77,-13671.5 17710.77,-13603.5 18211.77,-13603.5 18211.77,-13671.5"/>
<text text-anchor="middle" x="17961.27" y="-13656.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="17961.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17961.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="17961.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_attn_norm_gpu1&#45;&gt;layer0_k_proj_gpu1 -->
<g id="edge19" class="edge">
<title>layer0_attn_norm_gpu1&#45;&gt;layer0_k_proj_gpu1</title>
<path fill="none" stroke="black" d="M17820.27,-13757.32C17820.27,-13757.32 17820.27,-13681.58 17820.27,-13681.58"/>
<polygon fill="black" stroke="black" points="17823.77,-13681.58 17820.27,-13671.58 17816.77,-13681.58 17823.77,-13681.58"/>
</g>
<!-- layer0_v_proj_gpu1 -->
<g id="node19" class="node">
<title>layer0_v_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="17652.77,-13671.5 17151.77,-13671.5 17151.77,-13603.5 17652.77,-13603.5 17652.77,-13671.5"/>
<text text-anchor="middle" x="17402.27" y="-13656.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="17402.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17402.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="17402.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_attn_norm_gpu1&#45;&gt;layer0_v_proj_gpu1 -->
<g id="edge20" class="edge">
<title>layer0_attn_norm_gpu1&#45;&gt;layer0_v_proj_gpu1</title>
<path fill="none" stroke="black" d="M17542.77,-13757.32C17542.77,-13757.32 17542.77,-13681.58 17542.77,-13681.58"/>
<polygon fill="black" stroke="black" points="17546.27,-13681.58 17542.77,-13671.58 17539.27,-13681.58 17546.27,-13681.58"/>
</g>
<!-- layer0_gather_q_gpu1 -->
<g id="node20" class="node">
<title>layer0_gather_q_gpu1</title>
<ellipse fill="lightblue" stroke="black" cx="18630.27" cy="-13469.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="18630.27" y="-13488.21" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="18630.27" y="-13473.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="18630.27" y="-13458.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="18630.27" y="-13443.21" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_q_proj_gpu1&#45;&gt;layer0_gather_q_gpu1 -->
<g id="edge21" class="edge">
<title>layer0_q_proj_gpu1&#45;&gt;layer0_gather_q_gpu1</title>
<path fill="none" stroke="black" d="M18520.27,-13603.48C18520.27,-13603.48 18520.27,-13525.48 18520.27,-13525.48"/>
<polygon fill="black" stroke="black" points="18523.77,-13525.48 18520.27,-13515.48 18516.77,-13525.48 18523.77,-13525.48"/>
</g>
<!-- layer0_gather_k_gpu1 -->
<g id="node21" class="node">
<title>layer0_gather_k_gpu1</title>
<ellipse fill="lightblue" stroke="black" cx="17851.27" cy="-13469.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="17851.27" y="-13488.21" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="17851.27" y="-13473.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="17851.27" y="-13458.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="17851.27" y="-13443.21" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_k_proj_gpu1&#45;&gt;layer0_gather_k_gpu1 -->
<g id="edge22" class="edge">
<title>layer0_k_proj_gpu1&#45;&gt;layer0_gather_k_gpu1</title>
<path fill="none" stroke="black" d="M17961.27,-13603.48C17961.27,-13603.48 17961.27,-13525.48 17961.27,-13525.48"/>
<polygon fill="black" stroke="black" points="17964.77,-13525.48 17961.27,-13515.48 17957.77,-13525.48 17964.77,-13525.48"/>
</g>
<!-- layer0_gather_v_gpu1 -->
<g id="node22" class="node">
<title>layer0_gather_v_gpu1</title>
<ellipse fill="lightblue" stroke="black" cx="17283.27" cy="-13287.25" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="17283.27" y="-13306.05" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="17283.27" y="-13291.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="17283.27" y="-13276.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="17283.27" y="-13261.05" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_v_proj_gpu1&#45;&gt;layer0_gather_v_gpu1 -->
<g id="edge23" class="edge">
<title>layer0_v_proj_gpu1&#45;&gt;layer0_gather_v_gpu1</title>
<path fill="none" stroke="black" d="M17402.27,-13603.27C17402.27,-13603.27 17402.27,-13342.86 17402.27,-13342.86"/>
<polygon fill="black" stroke="black" points="17405.77,-13342.86 17402.27,-13332.86 17398.77,-13342.86 17405.77,-13342.86"/>
</g>
<!-- layer0_attn_scores_gpu1 -->
<g id="node23" class="node">
<title>layer0_attn_scores_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="18240.77,-13321.25 17701.77,-13321.25 17701.77,-13253.25 18240.77,-13253.25 18240.77,-13321.25"/>
<text text-anchor="middle" x="17971.27" y="-13306.05" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="17971.27" y="-13291.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="17971.27" y="-13276.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="17971.27" y="-13261.05" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gather_q_gpu1&#45;&gt;layer0_attn_scores_gpu1 -->
<g id="edge24" class="edge">
<title>layer0_gather_q_gpu1&#45;&gt;layer0_attn_scores_gpu1</title>
<path fill="none" stroke="black" d="M18269.56,-13469C18242.99,-13469 18226.33,-13469 18226.33,-13469 18226.33,-13469 18226.33,-13331.43 18226.33,-13331.43"/>
<polygon fill="black" stroke="black" points="18229.83,-13331.43 18226.33,-13321.43 18222.83,-13331.43 18229.83,-13331.43"/>
</g>
<!-- layer0_gather_k_gpu1&#45;&gt;layer0_attn_scores_gpu1 -->
<g id="edge25" class="edge">
<title>layer0_gather_k_gpu1&#45;&gt;layer0_attn_scores_gpu1</title>
<path fill="none" stroke="black" d="M17956.83,-13422.97C17956.83,-13422.97 17956.83,-13331.52 17956.83,-13331.52"/>
<polygon fill="black" stroke="black" points="17960.33,-13331.52 17956.83,-13321.52 17953.33,-13331.52 17960.33,-13331.52"/>
</g>
<!-- layer0_attn_out_gpu1 -->
<g id="node25" class="node">
<title>layer0_attn_out_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="17546.77,-12971 17019.77,-12971 17019.77,-12903 17546.77,-12903 17546.77,-12971"/>
<text text-anchor="middle" x="17283.27" y="-12955.8" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="17283.27" y="-12940.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="17283.27" y="-12925.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="17283.27" y="-12910.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_gather_v_gpu1&#45;&gt;layer0_attn_out_gpu1 -->
<g id="edge28" class="edge">
<title>layer0_gather_v_gpu1&#45;&gt;layer0_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M17278.27,-13238.91C17278.27,-13238.91 17278.27,-12981.15 17278.27,-12981.15"/>
<polygon fill="black" stroke="black" points="17281.77,-12981.15 17278.27,-12971.15 17274.77,-12981.15 17281.77,-12981.15"/>
</g>
<!-- layer0_softmax_gpu1 -->
<g id="node24" class="node">
<title>layer0_softmax_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="18075.77,-13139.08 17536.77,-13139.08 17536.77,-13071.08 18075.77,-13071.08 18075.77,-13139.08"/>
<text text-anchor="middle" x="17806.27" y="-13123.88" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="17806.27" y="-13108.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="17806.27" y="-13093.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="17806.27" y="-13078.88" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_attn_scores_gpu1&#45;&gt;layer0_softmax_gpu1 -->
<g id="edge26" class="edge">
<title>layer0_attn_scores_gpu1&#45;&gt;layer0_softmax_gpu1</title>
<path fill="none" stroke="black" d="M17888.77,-13252.98C17888.77,-13252.98 17888.77,-13149.19 17888.77,-13149.19"/>
<polygon fill="black" stroke="black" points="17892.27,-13149.19 17888.77,-13139.19 17885.27,-13149.19 17892.27,-13149.19"/>
</g>
<!-- layer0_softmax_gpu1&#45;&gt;layer0_attn_out_gpu1 -->
<g id="edge27" class="edge">
<title>layer0_softmax_gpu1&#45;&gt;layer0_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M17541.77,-13071.06C17541.77,-13071.06 17541.77,-12981.25 17541.77,-12981.25"/>
<polygon fill="black" stroke="black" points="17545.27,-12981.25 17541.77,-12971.25 17538.27,-12981.25 17545.27,-12981.25"/>
</g>
<!-- layer0_out_proj_gpu1 -->
<g id="node26" class="node">
<title>layer0_out_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="16939.77,-12817 16450.77,-12817 16450.77,-12749 16939.77,-12749 16939.77,-12817"/>
<text text-anchor="middle" x="16695.27" y="-12801.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16695.27" y="-12786.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="16695.27" y="-12771.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="16695.27" y="-12756.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_attn_out_gpu1&#45;&gt;layer0_out_proj_gpu1 -->
<g id="edge29" class="edge">
<title>layer0_attn_out_gpu1&#45;&gt;layer0_out_proj_gpu1</title>
<path fill="none" stroke="black" d="M17019.59,-12925C16968.88,-12925 16931.2,-12925 16931.2,-12925 16931.2,-12925 16931.2,-12827.01 16931.2,-12827.01"/>
<polygon fill="black" stroke="black" points="16934.7,-12827.01 16931.2,-12817.01 16927.7,-12827.01 16934.7,-12827.01"/>
</g>
<!-- layer0_out_proj_gpu1&#45;&gt;layer0_attn_all_reduce -->
<g id="edge109" class="edge">
<title>layer0_out_proj_gpu1&#45;&gt;layer0_attn_all_reduce</title>
<path fill="none" stroke="black" d="M16469.93,-12748.8C16469.93,-12699.42 16469.93,-12614 16469.93,-12614 16469.93,-12614 13014.64,-12614 13014.64,-12614"/>
<polygon fill="black" stroke="black" points="13014.64,-12610.5 13004.64,-12614 13014.64,-12617.5 13014.64,-12610.5"/>
</g>
<!-- layer0_q_proj_gpu2 -->
<g id="node28" class="node">
<title>layer0_q_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="20530.77,-13671.5 20029.77,-13671.5 20029.77,-13603.5 20530.77,-13603.5 20530.77,-13671.5"/>
<text text-anchor="middle" x="20280.27" y="-13656.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="20280.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="20280.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="20280.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_attn_norm_gpu2&#45;&gt;layer0_q_proj_gpu2 -->
<g id="edge31" class="edge">
<title>layer0_attn_norm_gpu2&#45;&gt;layer0_q_proj_gpu2</title>
<path fill="none" stroke="black" d="M19606.86,-13791C19879.94,-13791 20280.27,-13791 20280.27,-13791 20280.27,-13791 20280.27,-13681.56 20280.27,-13681.56"/>
<polygon fill="black" stroke="black" points="20283.77,-13681.56 20280.27,-13671.56 20276.77,-13681.56 20283.77,-13681.56"/>
</g>
<!-- layer0_k_proj_gpu2 -->
<g id="node29" class="node">
<title>layer0_k_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="19888.77,-13671.5 19387.77,-13671.5 19387.77,-13603.5 19888.77,-13603.5 19888.77,-13671.5"/>
<text text-anchor="middle" x="19638.27" y="-13656.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="19638.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19638.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="19638.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_attn_norm_gpu2&#45;&gt;layer0_k_proj_gpu2 -->
<g id="edge32" class="edge">
<title>layer0_attn_norm_gpu2&#45;&gt;layer0_k_proj_gpu2</title>
<path fill="none" stroke="black" d="M19497.27,-13757.32C19497.27,-13757.32 19497.27,-13681.58 19497.27,-13681.58"/>
<polygon fill="black" stroke="black" points="19500.77,-13681.58 19497.27,-13671.58 19493.77,-13681.58 19500.77,-13681.58"/>
</g>
<!-- layer0_v_proj_gpu2 -->
<g id="node30" class="node">
<title>layer0_v_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="19329.77,-13671.5 18828.77,-13671.5 18828.77,-13603.5 19329.77,-13603.5 19329.77,-13671.5"/>
<text text-anchor="middle" x="19079.27" y="-13656.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="19079.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19079.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="19079.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_attn_norm_gpu2&#45;&gt;layer0_v_proj_gpu2 -->
<g id="edge33" class="edge">
<title>layer0_attn_norm_gpu2&#45;&gt;layer0_v_proj_gpu2</title>
<path fill="none" stroke="black" d="M19219.77,-13757.32C19219.77,-13757.32 19219.77,-13681.58 19219.77,-13681.58"/>
<polygon fill="black" stroke="black" points="19223.27,-13681.58 19219.77,-13671.58 19216.27,-13681.58 19223.27,-13681.58"/>
</g>
<!-- layer0_gather_q_gpu2 -->
<g id="node31" class="node">
<title>layer0_gather_q_gpu2</title>
<ellipse fill="lightblue" stroke="black" cx="20362.27" cy="-13469.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="20362.27" y="-13488.21" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="20362.27" y="-13473.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="20362.27" y="-13458.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="20362.27" y="-13443.21" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_q_proj_gpu2&#45;&gt;layer0_gather_q_gpu2 -->
<g id="edge34" class="edge">
<title>layer0_q_proj_gpu2&#45;&gt;layer0_gather_q_gpu2</title>
<path fill="none" stroke="black" d="M20280.27,-13603.48C20280.27,-13603.48 20280.27,-13526.43 20280.27,-13526.43"/>
<polygon fill="black" stroke="black" points="20283.77,-13526.43 20280.27,-13516.43 20276.77,-13526.43 20283.77,-13526.43"/>
</g>
<!-- layer0_gather_k_gpu2 -->
<g id="node32" class="node">
<title>layer0_gather_k_gpu2</title>
<ellipse fill="lightblue" stroke="black" cx="19583.27" cy="-13469.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="19583.27" y="-13488.21" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="19583.27" y="-13473.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="19583.27" y="-13458.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="19583.27" y="-13443.21" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_k_proj_gpu2&#45;&gt;layer0_gather_k_gpu2 -->
<g id="edge35" class="edge">
<title>layer0_k_proj_gpu2&#45;&gt;layer0_gather_k_gpu2</title>
<path fill="none" stroke="black" d="M19638.27,-13603.48C19638.27,-13603.48 19638.27,-13527.07 19638.27,-13527.07"/>
<polygon fill="black" stroke="black" points="19641.77,-13527.07 19638.27,-13517.07 19634.77,-13527.07 19641.77,-13527.07"/>
</g>
<!-- layer0_gather_v_gpu2 -->
<g id="node33" class="node">
<title>layer0_gather_v_gpu2</title>
<ellipse fill="lightblue" stroke="black" cx="18987.27" cy="-13105.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="18987.27" y="-13123.88" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="18987.27" y="-13108.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="18987.27" y="-13093.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="18987.27" y="-13078.88" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_v_proj_gpu2&#45;&gt;layer0_gather_v_gpu2 -->
<g id="edge36" class="edge">
<title>layer0_v_proj_gpu2&#45;&gt;layer0_gather_v_gpu2</title>
<path fill="none" stroke="black" d="M19106.77,-13603.38C19106.77,-13603.38 19106.77,-13160.64 19106.77,-13160.64"/>
<polygon fill="black" stroke="black" points="19110.27,-13160.64 19106.77,-13150.64 19103.27,-13160.64 19110.27,-13160.64"/>
</g>
<!-- layer0_attn_scores_gpu2 -->
<g id="node34" class="node">
<title>layer0_attn_scores_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="19944.77,-13321.25 19405.77,-13321.25 19405.77,-13253.25 19944.77,-13253.25 19944.77,-13321.25"/>
<text text-anchor="middle" x="19675.27" y="-13306.05" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="19675.27" y="-13291.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="19675.27" y="-13276.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="19675.27" y="-13261.05" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gather_q_gpu2&#45;&gt;layer0_attn_scores_gpu2 -->
<g id="edge37" class="edge">
<title>layer0_gather_q_gpu2&#45;&gt;layer0_attn_scores_gpu2</title>
<path fill="none" stroke="black" d="M20362.27,-13421.01C20362.27,-13366.97 20362.27,-13287 20362.27,-13287 20362.27,-13287 19954.82,-13287 19954.82,-13287"/>
<polygon fill="black" stroke="black" points="19954.82,-13283.5 19944.82,-13287 19954.82,-13290.5 19954.82,-13283.5"/>
</g>
<!-- layer0_gather_k_gpu2&#45;&gt;layer0_attn_scores_gpu2 -->
<g id="edge38" class="edge">
<title>layer0_gather_k_gpu2&#45;&gt;layer0_attn_scores_gpu2</title>
<path fill="none" stroke="black" d="M19674.83,-13422.5C19674.83,-13422.5 19674.83,-13331.34 19674.83,-13331.34"/>
<polygon fill="black" stroke="black" points="19678.33,-13331.34 19674.83,-13321.34 19671.33,-13331.34 19678.33,-13331.34"/>
</g>
<!-- layer0_attn_out_gpu2 -->
<g id="node36" class="node">
<title>layer0_attn_out_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="19250.77,-12971 18723.77,-12971 18723.77,-12903 19250.77,-12903 19250.77,-12971"/>
<text text-anchor="middle" x="18987.27" y="-12955.8" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="18987.27" y="-12940.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="18987.27" y="-12925.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="18987.27" y="-12910.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_gather_v_gpu2&#45;&gt;layer0_attn_out_gpu2 -->
<g id="edge41" class="edge">
<title>layer0_gather_v_gpu2&#45;&gt;layer0_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M18987.27,-13056.91C18987.27,-13056.91 18987.27,-12981.03 18987.27,-12981.03"/>
<polygon fill="black" stroke="black" points="18990.77,-12981.03 18987.27,-12971.03 18983.77,-12981.03 18990.77,-12981.03"/>
</g>
<!-- layer0_softmax_gpu2 -->
<g id="node35" class="node">
<title>layer0_softmax_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="19944.77,-13139.08 19405.77,-13139.08 19405.77,-13071.08 19944.77,-13071.08 19944.77,-13139.08"/>
<text text-anchor="middle" x="19675.27" y="-13123.88" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="19675.27" y="-13108.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="19675.27" y="-13093.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="19675.27" y="-13078.88" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_attn_scores_gpu2&#45;&gt;layer0_softmax_gpu2 -->
<g id="edge39" class="edge">
<title>layer0_attn_scores_gpu2&#45;&gt;layer0_softmax_gpu2</title>
<path fill="none" stroke="black" d="M19675.27,-13252.98C19675.27,-13252.98 19675.27,-13149.19 19675.27,-13149.19"/>
<polygon fill="black" stroke="black" points="19678.77,-13149.19 19675.27,-13139.19 19671.77,-13149.19 19678.77,-13149.19"/>
</g>
<!-- layer0_softmax_gpu2&#45;&gt;layer0_attn_out_gpu2 -->
<g id="edge40" class="edge">
<title>layer0_softmax_gpu2&#45;&gt;layer0_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M19543.43,-13070.86C19543.43,-13021.46 19543.43,-12936 19543.43,-12936 19543.43,-12936 19261.1,-12936 19261.1,-12936"/>
<polygon fill="black" stroke="black" points="19261.1,-12932.5 19251.1,-12936 19261.1,-12939.5 19261.1,-12932.5"/>
</g>
<!-- layer0_out_proj_gpu2 -->
<g id="node37" class="node">
<title>layer0_out_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="18426.77,-12817 17937.77,-12817 17937.77,-12749 18426.77,-12749 18426.77,-12817"/>
<text text-anchor="middle" x="18182.27" y="-12801.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="18182.27" y="-12786.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="18182.27" y="-12771.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="18182.27" y="-12756.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_attn_out_gpu2&#45;&gt;layer0_out_proj_gpu2 -->
<g id="edge42" class="edge">
<title>layer0_attn_out_gpu2&#45;&gt;layer0_out_proj_gpu2</title>
<path fill="none" stroke="black" d="M18723.65,-12936C18547.61,-12936 18348.2,-12936 18348.2,-12936 18348.2,-12936 18348.2,-12827.33 18348.2,-12827.33"/>
<polygon fill="black" stroke="black" points="18351.7,-12827.33 18348.2,-12817.33 18344.7,-12827.33 18351.7,-12827.33"/>
</g>
<!-- layer0_out_proj_gpu2&#45;&gt;layer0_attn_all_reduce -->
<g id="edge110" class="edge">
<title>layer0_out_proj_gpu2&#45;&gt;layer0_attn_all_reduce</title>
<path fill="none" stroke="black" d="M18182.27,-12748.94C18182.27,-12693.53 18182.27,-12590 18182.27,-12590 18182.27,-12590 12963.96,-12590 12963.96,-12590"/>
<polygon fill="black" stroke="black" points="12963.96,-12586.5 12953.96,-12590 12963.96,-12593.5 12963.96,-12586.5"/>
</g>
<!-- layer0_q_proj_gpu3 -->
<g id="node39" class="node">
<title>layer0_q_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="8149.77,-13671.5 7648.77,-13671.5 7648.77,-13603.5 8149.77,-13603.5 8149.77,-13671.5"/>
<text text-anchor="middle" x="7899.27" y="-13656.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7899.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7899.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7899.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_attn_norm_gpu3&#45;&gt;layer0_q_proj_gpu3 -->
<g id="edge44" class="edge">
<title>layer0_attn_norm_gpu3&#45;&gt;layer0_q_proj_gpu3</title>
<path fill="none" stroke="black" d="M8039.77,-13757.32C8039.77,-13757.32 8039.77,-13681.58 8039.77,-13681.58"/>
<polygon fill="black" stroke="black" points="8043.27,-13681.58 8039.77,-13671.58 8036.27,-13681.58 8043.27,-13681.58"/>
</g>
<!-- layer0_k_proj_gpu3 -->
<g id="node40" class="node">
<title>layer0_k_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="8708.77,-13671.5 8207.77,-13671.5 8207.77,-13603.5 8708.77,-13603.5 8708.77,-13671.5"/>
<text text-anchor="middle" x="8458.27" y="-13656.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8458.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8458.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8458.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_attn_norm_gpu3&#45;&gt;layer0_k_proj_gpu3 -->
<g id="edge45" class="edge">
<title>layer0_attn_norm_gpu3&#45;&gt;layer0_k_proj_gpu3</title>
<path fill="none" stroke="black" d="M8317.27,-13757.32C8317.27,-13757.32 8317.27,-13681.58 8317.27,-13681.58"/>
<polygon fill="black" stroke="black" points="8320.77,-13681.58 8317.27,-13671.58 8313.77,-13681.58 8320.77,-13681.58"/>
</g>
<!-- layer0_v_proj_gpu3 -->
<g id="node41" class="node">
<title>layer0_v_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="7590.77,-13671.5 7089.77,-13671.5 7089.77,-13603.5 7590.77,-13603.5 7590.77,-13671.5"/>
<text text-anchor="middle" x="7340.27" y="-13656.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7340.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7340.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7340.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_attn_norm_gpu3&#45;&gt;layer0_v_proj_gpu3 -->
<g id="edge46" class="edge">
<title>layer0_attn_norm_gpu3&#45;&gt;layer0_v_proj_gpu3</title>
<path fill="none" stroke="black" d="M7929.67,-13791C7682.61,-13791 7340.27,-13791 7340.27,-13791 7340.27,-13791 7340.27,-13681.56 7340.27,-13681.56"/>
<polygon fill="black" stroke="black" points="7343.77,-13681.56 7340.27,-13671.56 7336.77,-13681.56 7343.77,-13681.56"/>
</g>
<!-- layer0_gather_q_gpu3 -->
<g id="node42" class="node">
<title>layer0_gather_q_gpu3</title>
<ellipse fill="lightblue" stroke="black" cx="7789.27" cy="-13469.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="7789.27" y="-13488.21" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="7789.27" y="-13473.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7789.27" y="-13458.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7789.27" y="-13443.21" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_q_proj_gpu3&#45;&gt;layer0_gather_q_gpu3 -->
<g id="edge47" class="edge">
<title>layer0_q_proj_gpu3&#45;&gt;layer0_gather_q_gpu3</title>
<path fill="none" stroke="black" d="M7899.27,-13603.48C7899.27,-13603.48 7899.27,-13525.48 7899.27,-13525.48"/>
<polygon fill="black" stroke="black" points="7902.77,-13525.48 7899.27,-13515.48 7895.77,-13525.48 7902.77,-13525.48"/>
</g>
<!-- layer0_gather_k_gpu3 -->
<g id="node43" class="node">
<title>layer0_gather_k_gpu3</title>
<ellipse fill="lightblue" stroke="black" cx="8568.27" cy="-13469.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="8568.27" y="-13488.21" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="8568.27" y="-13473.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8568.27" y="-13458.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8568.27" y="-13443.21" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_k_proj_gpu3&#45;&gt;layer0_gather_k_gpu3 -->
<g id="edge48" class="edge">
<title>layer0_k_proj_gpu3&#45;&gt;layer0_gather_k_gpu3</title>
<path fill="none" stroke="black" d="M8458.27,-13603.48C8458.27,-13603.48 8458.27,-13525.48 8458.27,-13525.48"/>
<polygon fill="black" stroke="black" points="8461.77,-13525.48 8458.27,-13515.48 8454.77,-13525.48 8461.77,-13525.48"/>
</g>
<!-- layer0_gather_v_gpu3 -->
<g id="node44" class="node">
<title>layer0_gather_v_gpu3</title>
<ellipse fill="lightblue" stroke="black" cx="7620.27" cy="-13287.25" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="7620.27" y="-13306.05" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="7620.27" y="-13291.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7620.27" y="-13276.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7620.27" y="-13261.05" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_v_proj_gpu3&#45;&gt;layer0_gather_v_gpu3 -->
<g id="edge49" class="edge">
<title>layer0_v_proj_gpu3&#45;&gt;layer0_gather_v_gpu3</title>
<path fill="none" stroke="black" d="M7344.14,-13603.27C7344.14,-13603.27 7344.14,-13328.56 7344.14,-13328.56"/>
<polygon fill="black" stroke="black" points="7347.64,-13328.56 7344.14,-13318.56 7340.64,-13328.56 7347.64,-13328.56"/>
</g>
<!-- layer0_attn_scores_gpu3 -->
<g id="node45" class="node">
<title>layer0_attn_scores_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="8662.77,-13321.25 8123.77,-13321.25 8123.77,-13253.25 8662.77,-13253.25 8662.77,-13321.25"/>
<text text-anchor="middle" x="8393.27" y="-13306.05" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="8393.27" y="-13291.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8393.27" y="-13276.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="8393.27" y="-13261.05" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gather_q_gpu3&#45;&gt;layer0_attn_scores_gpu3 -->
<g id="edge50" class="edge">
<title>layer0_gather_q_gpu3&#45;&gt;layer0_attn_scores_gpu3</title>
<path fill="none" stroke="black" d="M8136.83,-13456.31C8136.83,-13456.31 8136.83,-13331.56 8136.83,-13331.56"/>
<polygon fill="black" stroke="black" points="8140.33,-13331.56 8136.83,-13321.56 8133.33,-13331.56 8140.33,-13331.56"/>
</g>
<!-- layer0_gather_k_gpu3&#45;&gt;layer0_attn_scores_gpu3 -->
<g id="edge51" class="edge">
<title>layer0_gather_k_gpu3&#45;&gt;layer0_attn_scores_gpu3</title>
<path fill="none" stroke="black" d="M8435.2,-13424.38C8435.2,-13424.38 8435.2,-13331.47 8435.2,-13331.47"/>
<polygon fill="black" stroke="black" points="8438.7,-13331.47 8435.2,-13321.47 8431.7,-13331.47 8438.7,-13331.47"/>
</g>
<!-- layer0_attn_out_gpu3 -->
<g id="node47" class="node">
<title>layer0_attn_out_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="8656.77,-12971 8129.77,-12971 8129.77,-12903 8656.77,-12903 8656.77,-12971"/>
<text text-anchor="middle" x="8393.27" y="-12955.8" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="8393.27" y="-12940.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="8393.27" y="-12925.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8393.27" y="-12910.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_gather_v_gpu3&#45;&gt;layer0_attn_out_gpu3 -->
<g id="edge54" class="edge">
<title>layer0_gather_v_gpu3&#45;&gt;layer0_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M7797.73,-13245.23C7797.73,-13151.99 7797.73,-12936 7797.73,-12936 7797.73,-12936 8119.45,-12936 8119.45,-12936"/>
<polygon fill="black" stroke="black" points="8119.45,-12939.5 8129.45,-12936 8119.45,-12932.5 8119.45,-12939.5"/>
</g>
<!-- layer0_softmax_gpu3 -->
<g id="node46" class="node">
<title>layer0_softmax_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="8662.77,-13139.08 8123.77,-13139.08 8123.77,-13071.08 8662.77,-13071.08 8662.77,-13139.08"/>
<text text-anchor="middle" x="8393.27" y="-13123.88" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="8393.27" y="-13108.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="8393.27" y="-13093.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="8393.27" y="-13078.88" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_attn_scores_gpu3&#45;&gt;layer0_softmax_gpu3 -->
<g id="edge52" class="edge">
<title>layer0_attn_scores_gpu3&#45;&gt;layer0_softmax_gpu3</title>
<path fill="none" stroke="black" d="M8393.27,-13252.98C8393.27,-13252.98 8393.27,-13149.19 8393.27,-13149.19"/>
<polygon fill="black" stroke="black" points="8396.77,-13149.19 8393.27,-13139.19 8389.77,-13149.19 8396.77,-13149.19"/>
</g>
<!-- layer0_softmax_gpu3&#45;&gt;layer0_attn_out_gpu3 -->
<g id="edge53" class="edge">
<title>layer0_softmax_gpu3&#45;&gt;layer0_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M8393.27,-13071.06C8393.27,-13071.06 8393.27,-12981.25 8393.27,-12981.25"/>
<polygon fill="black" stroke="black" points="8396.77,-12981.25 8393.27,-12971.25 8389.77,-12981.25 8396.77,-12981.25"/>
</g>
<!-- layer0_out_proj_gpu3 -->
<g id="node48" class="node">
<title>layer0_out_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="9091.77,-12817 8602.77,-12817 8602.77,-12749 9091.77,-12749 9091.77,-12817"/>
<text text-anchor="middle" x="8847.27" y="-12801.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8847.27" y="-12786.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8847.27" y="-12771.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="8847.27" y="-12756.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_attn_out_gpu3&#45;&gt;layer0_out_proj_gpu3 -->
<g id="edge55" class="edge">
<title>layer0_attn_out_gpu3&#45;&gt;layer0_out_proj_gpu3</title>
<path fill="none" stroke="black" d="M8629.77,-12902.82C8629.77,-12902.82 8629.77,-12827.08 8629.77,-12827.08"/>
<polygon fill="black" stroke="black" points="8633.27,-12827.08 8629.77,-12817.08 8626.27,-12827.08 8633.27,-12827.08"/>
</g>
<!-- layer0_out_proj_gpu3&#45;&gt;layer0_attn_all_reduce -->
<g id="edge111" class="edge">
<title>layer0_out_proj_gpu3&#45;&gt;layer0_attn_all_reduce</title>
<path fill="none" stroke="black" d="M9065.87,-12748.63C9065.87,-12695.13 9065.87,-12598 9065.87,-12598 9065.87,-12598 12314.2,-12598 12314.2,-12598"/>
<polygon fill="black" stroke="black" points="12314.2,-12601.5 12324.2,-12598 12314.2,-12594.5 12314.2,-12601.5"/>
</g>
<!-- layer0_q_proj_gpu4 -->
<g id="node50" class="node">
<title>layer0_q_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="9826.77,-13671.5 9325.77,-13671.5 9325.77,-13603.5 9826.77,-13603.5 9826.77,-13671.5"/>
<text text-anchor="middle" x="9576.27" y="-13656.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="9576.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9576.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9576.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_attn_norm_gpu4&#45;&gt;layer0_q_proj_gpu4 -->
<g id="edge57" class="edge">
<title>layer0_attn_norm_gpu4&#45;&gt;layer0_q_proj_gpu4</title>
<path fill="none" stroke="black" d="M9716.77,-13757.32C9716.77,-13757.32 9716.77,-13681.58 9716.77,-13681.58"/>
<polygon fill="black" stroke="black" points="9720.27,-13681.58 9716.77,-13671.58 9713.27,-13681.58 9720.27,-13681.58"/>
</g>
<!-- layer0_k_proj_gpu4 -->
<g id="node51" class="node">
<title>layer0_k_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="10385.77,-13671.5 9884.77,-13671.5 9884.77,-13603.5 10385.77,-13603.5 10385.77,-13671.5"/>
<text text-anchor="middle" x="10135.27" y="-13656.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="10135.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10135.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10135.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_attn_norm_gpu4&#45;&gt;layer0_k_proj_gpu4 -->
<g id="edge58" class="edge">
<title>layer0_attn_norm_gpu4&#45;&gt;layer0_k_proj_gpu4</title>
<path fill="none" stroke="black" d="M9994.27,-13757.32C9994.27,-13757.32 9994.27,-13681.58 9994.27,-13681.58"/>
<polygon fill="black" stroke="black" points="9997.77,-13681.58 9994.27,-13671.58 9990.77,-13681.58 9997.77,-13681.58"/>
</g>
<!-- layer0_v_proj_gpu4 -->
<g id="node52" class="node">
<title>layer0_v_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="9267.77,-13671.5 8766.77,-13671.5 8766.77,-13603.5 9267.77,-13603.5 9267.77,-13671.5"/>
<text text-anchor="middle" x="9017.27" y="-13656.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="9017.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9017.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9017.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_attn_norm_gpu4&#45;&gt;layer0_v_proj_gpu4 -->
<g id="edge59" class="edge">
<title>layer0_attn_norm_gpu4&#45;&gt;layer0_v_proj_gpu4</title>
<path fill="none" stroke="black" d="M9606.67,-13791C9359.61,-13791 9017.27,-13791 9017.27,-13791 9017.27,-13791 9017.27,-13681.56 9017.27,-13681.56"/>
<polygon fill="black" stroke="black" points="9020.77,-13681.56 9017.27,-13671.56 9013.77,-13681.56 9020.77,-13681.56"/>
</g>
<!-- layer0_gather_q_gpu4 -->
<g id="node53" class="node">
<title>layer0_gather_q_gpu4</title>
<ellipse fill="lightblue" stroke="black" cx="9466.27" cy="-13469.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="9466.27" y="-13488.21" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="9466.27" y="-13473.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9466.27" y="-13458.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9466.27" y="-13443.21" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_q_proj_gpu4&#45;&gt;layer0_gather_q_gpu4 -->
<g id="edge60" class="edge">
<title>layer0_q_proj_gpu4&#45;&gt;layer0_gather_q_gpu4</title>
<path fill="none" stroke="black" d="M9576.27,-13603.48C9576.27,-13603.48 9576.27,-13525.48 9576.27,-13525.48"/>
<polygon fill="black" stroke="black" points="9579.77,-13525.48 9576.27,-13515.48 9572.77,-13525.48 9579.77,-13525.48"/>
</g>
<!-- layer0_gather_k_gpu4 -->
<g id="node54" class="node">
<title>layer0_gather_k_gpu4</title>
<ellipse fill="lightblue" stroke="black" cx="10245.27" cy="-13469.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="10245.27" y="-13488.21" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="10245.27" y="-13473.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10245.27" y="-13458.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10245.27" y="-13443.21" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_k_proj_gpu4&#45;&gt;layer0_gather_k_gpu4 -->
<g id="edge61" class="edge">
<title>layer0_k_proj_gpu4&#45;&gt;layer0_gather_k_gpu4</title>
<path fill="none" stroke="black" d="M10135.27,-13603.48C10135.27,-13603.48 10135.27,-13525.48 10135.27,-13525.48"/>
<polygon fill="black" stroke="black" points="10138.77,-13525.48 10135.27,-13515.48 10131.77,-13525.48 10138.77,-13525.48"/>
</g>
<!-- layer0_gather_v_gpu4 -->
<g id="node55" class="node">
<title>layer0_gather_v_gpu4</title>
<ellipse fill="lightblue" stroke="black" cx="9167.27" cy="-13105.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="9167.27" y="-13123.88" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="9167.27" y="-13108.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9167.27" y="-13093.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9167.27" y="-13078.88" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_v_proj_gpu4&#45;&gt;layer0_gather_v_gpu4 -->
<g id="edge62" class="edge">
<title>layer0_v_proj_gpu4&#45;&gt;layer0_gather_v_gpu4</title>
<path fill="none" stroke="black" d="M9017.27,-13603.38C9017.27,-13603.38 9017.27,-13159.09 9017.27,-13159.09"/>
<polygon fill="black" stroke="black" points="9020.77,-13159.09 9017.27,-13149.09 9013.77,-13159.09 9020.77,-13159.09"/>
</g>
<!-- layer0_attn_scores_gpu4 -->
<g id="node56" class="node">
<title>layer0_attn_scores_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="10199.77,-13321.25 9660.77,-13321.25 9660.77,-13253.25 10199.77,-13253.25 10199.77,-13321.25"/>
<text text-anchor="middle" x="9930.27" y="-13306.05" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="9930.27" y="-13291.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9930.27" y="-13276.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="9930.27" y="-13261.05" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gather_q_gpu4&#45;&gt;layer0_attn_scores_gpu4 -->
<g id="edge63" class="edge">
<title>layer0_gather_q_gpu4&#45;&gt;layer0_attn_scores_gpu4</title>
<path fill="none" stroke="black" d="M9743.83,-13438.51C9743.83,-13438.51 9743.83,-13331.4 9743.83,-13331.4"/>
<polygon fill="black" stroke="black" points="9747.33,-13331.4 9743.83,-13321.4 9740.33,-13331.4 9747.33,-13331.4"/>
</g>
<!-- layer0_gather_k_gpu4&#45;&gt;layer0_attn_scores_gpu4 -->
<g id="edge64" class="edge">
<title>layer0_gather_k_gpu4&#45;&gt;layer0_attn_scores_gpu4</title>
<path fill="none" stroke="black" d="M10042.2,-13429.43C10042.2,-13429.43 10042.2,-13331.32 10042.2,-13331.32"/>
<polygon fill="black" stroke="black" points="10045.7,-13331.32 10042.2,-13321.32 10038.7,-13331.32 10045.7,-13331.32"/>
</g>
<!-- layer0_attn_out_gpu4 -->
<g id="node58" class="node">
<title>layer0_attn_out_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="10193.77,-12971 9666.77,-12971 9666.77,-12903 10193.77,-12903 10193.77,-12971"/>
<text text-anchor="middle" x="9930.27" y="-12955.8" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="9930.27" y="-12940.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="9930.27" y="-12925.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9930.27" y="-12910.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_gather_v_gpu4&#45;&gt;layer0_attn_out_gpu4 -->
<g id="edge67" class="edge">
<title>layer0_gather_v_gpu4&#45;&gt;layer0_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M9309.83,-13060.66C9309.83,-13010.56 9309.83,-12936 9309.83,-12936 9309.83,-12936 9656.7,-12936 9656.7,-12936"/>
<polygon fill="black" stroke="black" points="9656.7,-12939.5 9666.7,-12936 9656.7,-12932.5 9656.7,-12939.5"/>
</g>
<!-- layer0_softmax_gpu4 -->
<g id="node57" class="node">
<title>layer0_softmax_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="10199.77,-13139.08 9660.77,-13139.08 9660.77,-13071.08 10199.77,-13071.08 10199.77,-13139.08"/>
<text text-anchor="middle" x="9930.27" y="-13123.88" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="9930.27" y="-13108.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="9930.27" y="-13093.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="9930.27" y="-13078.88" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_attn_scores_gpu4&#45;&gt;layer0_softmax_gpu4 -->
<g id="edge65" class="edge">
<title>layer0_attn_scores_gpu4&#45;&gt;layer0_softmax_gpu4</title>
<path fill="none" stroke="black" d="M9930.27,-13252.98C9930.27,-13252.98 9930.27,-13149.19 9930.27,-13149.19"/>
<polygon fill="black" stroke="black" points="9933.77,-13149.19 9930.27,-13139.19 9926.77,-13149.19 9933.77,-13149.19"/>
</g>
<!-- layer0_softmax_gpu4&#45;&gt;layer0_attn_out_gpu4 -->
<g id="edge66" class="edge">
<title>layer0_softmax_gpu4&#45;&gt;layer0_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M9930.27,-13071.06C9930.27,-13071.06 9930.27,-12981.25 9930.27,-12981.25"/>
<polygon fill="black" stroke="black" points="9933.77,-12981.25 9930.27,-12971.25 9926.77,-12981.25 9933.77,-12981.25"/>
</g>
<!-- layer0_out_proj_gpu4 -->
<g id="node59" class="node">
<title>layer0_out_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="10934.77,-12817 10445.77,-12817 10445.77,-12749 10934.77,-12749 10934.77,-12817"/>
<text text-anchor="middle" x="10690.27" y="-12801.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10690.27" y="-12786.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10690.27" y="-12771.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="10690.27" y="-12756.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_attn_out_gpu4&#45;&gt;layer0_out_proj_gpu4 -->
<g id="edge68" class="edge">
<title>layer0_attn_out_gpu4&#45;&gt;layer0_out_proj_gpu4</title>
<path fill="none" stroke="black" d="M10193.94,-12925C10413.45,-12925 10690.27,-12925 10690.27,-12925 10690.27,-12925 10690.27,-12827.01 10690.27,-12827.01"/>
<polygon fill="black" stroke="black" points="10693.77,-12827.01 10690.27,-12817.01 10686.77,-12827.01 10693.77,-12827.01"/>
</g>
<!-- layer0_out_proj_gpu4&#45;&gt;layer0_attn_all_reduce -->
<g id="edge112" class="edge">
<title>layer0_out_proj_gpu4&#45;&gt;layer0_attn_all_reduce</title>
<path fill="none" stroke="black" d="M10690.27,-12748.66C10690.27,-12703.55 10690.27,-12630 10690.27,-12630 10690.27,-12630 12309.44,-12630 12309.44,-12630"/>
<polygon fill="black" stroke="black" points="12309.44,-12633.5 12319.44,-12630 12309.44,-12626.5 12309.44,-12633.5"/>
</g>
<!-- layer0_q_proj_gpu5 -->
<g id="node61" class="node">
<title>layer0_q_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="11503.77,-13671.5 11002.77,-13671.5 11002.77,-13603.5 11503.77,-13603.5 11503.77,-13671.5"/>
<text text-anchor="middle" x="11253.27" y="-13656.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="11253.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11253.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11253.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_attn_norm_gpu5&#45;&gt;layer0_q_proj_gpu5 -->
<g id="edge70" class="edge">
<title>layer0_attn_norm_gpu5&#45;&gt;layer0_q_proj_gpu5</title>
<path fill="none" stroke="black" d="M11394.27,-13757.32C11394.27,-13757.32 11394.27,-13681.58 11394.27,-13681.58"/>
<polygon fill="black" stroke="black" points="11397.77,-13681.58 11394.27,-13671.58 11390.77,-13681.58 11397.77,-13681.58"/>
</g>
<!-- layer0_k_proj_gpu5 -->
<g id="node62" class="node">
<title>layer0_k_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12062.77,-13671.5 11561.77,-13671.5 11561.77,-13603.5 12062.77,-13603.5 12062.77,-13671.5"/>
<text text-anchor="middle" x="11812.27" y="-13656.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="11812.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11812.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11812.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_attn_norm_gpu5&#45;&gt;layer0_k_proj_gpu5 -->
<g id="edge71" class="edge">
<title>layer0_attn_norm_gpu5&#45;&gt;layer0_k_proj_gpu5</title>
<path fill="none" stroke="black" d="M11671.77,-13757.32C11671.77,-13757.32 11671.77,-13681.58 11671.77,-13681.58"/>
<polygon fill="black" stroke="black" points="11675.27,-13681.58 11671.77,-13671.58 11668.27,-13681.58 11675.27,-13681.58"/>
</g>
<!-- layer0_v_proj_gpu5 -->
<g id="node63" class="node">
<title>layer0_v_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="10944.77,-13671.5 10443.77,-13671.5 10443.77,-13603.5 10944.77,-13603.5 10944.77,-13671.5"/>
<text text-anchor="middle" x="10694.27" y="-13656.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="10694.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10694.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10694.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_attn_norm_gpu5&#45;&gt;layer0_v_proj_gpu5 -->
<g id="edge72" class="edge">
<title>layer0_attn_norm_gpu5&#45;&gt;layer0_v_proj_gpu5</title>
<path fill="none" stroke="black" d="M11284.66,-13791C11037.28,-13791 10694.27,-13791 10694.27,-13791 10694.27,-13791 10694.27,-13681.56 10694.27,-13681.56"/>
<polygon fill="black" stroke="black" points="10697.77,-13681.56 10694.27,-13671.56 10690.77,-13681.56 10697.77,-13681.56"/>
</g>
<!-- layer0_gather_q_gpu5 -->
<g id="node64" class="node">
<title>layer0_gather_q_gpu5</title>
<ellipse fill="lightblue" stroke="black" cx="11143.27" cy="-13469.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="11143.27" y="-13488.21" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="11143.27" y="-13473.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11143.27" y="-13458.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11143.27" y="-13443.21" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_q_proj_gpu5&#45;&gt;layer0_gather_q_gpu5 -->
<g id="edge73" class="edge">
<title>layer0_q_proj_gpu5&#45;&gt;layer0_gather_q_gpu5</title>
<path fill="none" stroke="black" d="M11253.27,-13603.48C11253.27,-13603.48 11253.27,-13525.48 11253.27,-13525.48"/>
<polygon fill="black" stroke="black" points="11256.77,-13525.48 11253.27,-13515.48 11249.77,-13525.48 11256.77,-13525.48"/>
</g>
<!-- layer0_gather_k_gpu5 -->
<g id="node65" class="node">
<title>layer0_gather_k_gpu5</title>
<ellipse fill="lightblue" stroke="black" cx="11922.27" cy="-13469.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="11922.27" y="-13488.21" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="11922.27" y="-13473.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11922.27" y="-13458.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11922.27" y="-13443.21" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_k_proj_gpu5&#45;&gt;layer0_gather_k_gpu5 -->
<g id="edge74" class="edge">
<title>layer0_k_proj_gpu5&#45;&gt;layer0_gather_k_gpu5</title>
<path fill="none" stroke="black" d="M11812.27,-13603.48C11812.27,-13603.48 11812.27,-13525.48 11812.27,-13525.48"/>
<polygon fill="black" stroke="black" points="11815.77,-13525.48 11812.27,-13515.48 11808.77,-13525.48 11815.77,-13525.48"/>
</g>
<!-- layer0_gather_v_gpu5 -->
<g id="node66" class="node">
<title>layer0_gather_v_gpu5</title>
<ellipse fill="lightblue" stroke="black" cx="10749.27" cy="-13287.25" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="10749.27" y="-13306.05" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="10749.27" y="-13291.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10749.27" y="-13276.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10749.27" y="-13261.05" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_v_proj_gpu5&#45;&gt;layer0_gather_v_gpu5 -->
<g id="edge75" class="edge">
<title>layer0_v_proj_gpu5&#45;&gt;layer0_gather_v_gpu5</title>
<path fill="none" stroke="black" d="M10694.27,-13603.27C10694.27,-13603.27 10694.27,-13344.9 10694.27,-13344.9"/>
<polygon fill="black" stroke="black" points="10697.77,-13344.9 10694.27,-13334.9 10690.77,-13344.9 10697.77,-13344.9"/>
</g>
<!-- layer0_attn_scores_gpu5 -->
<g id="node67" class="node">
<title>layer0_attn_scores_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="11816.77,-13321.25 11277.77,-13321.25 11277.77,-13253.25 11816.77,-13253.25 11816.77,-13321.25"/>
<text text-anchor="middle" x="11547.27" y="-13306.05" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="11547.27" y="-13291.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11547.27" y="-13276.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="11547.27" y="-13261.05" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gather_q_gpu5&#45;&gt;layer0_attn_scores_gpu5 -->
<g id="edge76" class="edge">
<title>layer0_gather_q_gpu5&#45;&gt;layer0_attn_scores_gpu5</title>
<path fill="none" stroke="black" d="M11390.83,-13434.29C11390.83,-13434.29 11390.83,-13331.34 11390.83,-13331.34"/>
<polygon fill="black" stroke="black" points="11394.33,-13331.34 11390.83,-13321.34 11387.33,-13331.34 11394.33,-13331.34"/>
</g>
<!-- layer0_gather_k_gpu5&#45;&gt;layer0_attn_scores_gpu5 -->
<g id="edge77" class="edge">
<title>layer0_gather_k_gpu5&#45;&gt;layer0_attn_scores_gpu5</title>
<path fill="none" stroke="black" d="M11689.2,-13432.55C11689.2,-13432.55 11689.2,-13331.29 11689.2,-13331.29"/>
<polygon fill="black" stroke="black" points="11692.7,-13331.29 11689.2,-13321.29 11685.7,-13331.29 11692.7,-13331.29"/>
</g>
<!-- layer0_attn_out_gpu5 -->
<g id="node69" class="node">
<title>layer0_attn_out_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="11810.77,-12971 11283.77,-12971 11283.77,-12903 11810.77,-12903 11810.77,-12971"/>
<text text-anchor="middle" x="11547.27" y="-12955.8" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="11547.27" y="-12940.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="11547.27" y="-12925.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11547.27" y="-12910.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_gather_v_gpu5&#45;&gt;layer0_attn_out_gpu5 -->
<g id="edge80" class="edge">
<title>layer0_gather_v_gpu5&#45;&gt;layer0_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M11022.33,-13255.63C11022.33,-13171.42 11022.33,-12948 11022.33,-12948 11022.33,-12948 11273.64,-12948 11273.64,-12948"/>
<polygon fill="black" stroke="black" points="11273.64,-12951.5 11283.64,-12948 11273.64,-12944.5 11273.64,-12951.5"/>
</g>
<!-- layer0_softmax_gpu5 -->
<g id="node68" class="node">
<title>layer0_softmax_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="11816.77,-13139.08 11277.77,-13139.08 11277.77,-13071.08 11816.77,-13071.08 11816.77,-13139.08"/>
<text text-anchor="middle" x="11547.27" y="-13123.88" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="11547.27" y="-13108.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="11547.27" y="-13093.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="11547.27" y="-13078.88" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_attn_scores_gpu5&#45;&gt;layer0_softmax_gpu5 -->
<g id="edge78" class="edge">
<title>layer0_attn_scores_gpu5&#45;&gt;layer0_softmax_gpu5</title>
<path fill="none" stroke="black" d="M11547.27,-13252.98C11547.27,-13252.98 11547.27,-13149.19 11547.27,-13149.19"/>
<polygon fill="black" stroke="black" points="11550.77,-13149.19 11547.27,-13139.19 11543.77,-13149.19 11550.77,-13149.19"/>
</g>
<!-- layer0_softmax_gpu5&#45;&gt;layer0_attn_out_gpu5 -->
<g id="edge79" class="edge">
<title>layer0_softmax_gpu5&#45;&gt;layer0_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M11547.27,-13071.06C11547.27,-13071.06 11547.27,-12981.25 11547.27,-12981.25"/>
<polygon fill="black" stroke="black" points="11550.77,-12981.25 11547.27,-12971.25 11543.77,-12981.25 11550.77,-12981.25"/>
</g>
<!-- layer0_out_proj_gpu5 -->
<g id="node70" class="node">
<title>layer0_out_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="12129.77,-12817 11640.77,-12817 11640.77,-12749 12129.77,-12749 12129.77,-12817"/>
<text text-anchor="middle" x="11885.27" y="-12801.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11885.27" y="-12786.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11885.27" y="-12771.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="11885.27" y="-12756.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_attn_out_gpu5&#45;&gt;layer0_out_proj_gpu5 -->
<g id="edge81" class="edge">
<title>layer0_attn_out_gpu5&#45;&gt;layer0_out_proj_gpu5</title>
<path fill="none" stroke="black" d="M11725.77,-12902.82C11725.77,-12902.82 11725.77,-12827.08 11725.77,-12827.08"/>
<polygon fill="black" stroke="black" points="11729.27,-12827.08 11725.77,-12817.08 11722.27,-12827.08 11729.27,-12827.08"/>
</g>
<!-- layer0_out_proj_gpu5&#45;&gt;layer0_attn_all_reduce -->
<g id="edge113" class="edge">
<title>layer0_out_proj_gpu5&#45;&gt;layer0_attn_all_reduce</title>
<path fill="none" stroke="black" d="M12130.03,-12782C12240.13,-12782 12345.8,-12782 12345.8,-12782 12345.8,-12782 12345.8,-12648.5 12345.8,-12648.5"/>
<polygon fill="black" stroke="black" points="12349.3,-12648.5 12345.8,-12638.5 12342.3,-12648.5 12349.3,-12648.5"/>
</g>
<!-- layer0_q_proj_gpu6 -->
<g id="node72" class="node">
<title>layer0_q_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="13180.77,-13671.5 12679.77,-13671.5 12679.77,-13603.5 13180.77,-13603.5 13180.77,-13671.5"/>
<text text-anchor="middle" x="12930.27" y="-13656.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="12930.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12930.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12930.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_attn_norm_gpu6&#45;&gt;layer0_q_proj_gpu6 -->
<g id="edge83" class="edge">
<title>layer0_attn_norm_gpu6&#45;&gt;layer0_q_proj_gpu6</title>
<path fill="none" stroke="black" d="M12930.27,-13757.32C12930.27,-13757.32 12930.27,-13681.58 12930.27,-13681.58"/>
<polygon fill="black" stroke="black" points="12933.77,-13681.58 12930.27,-13671.58 12926.77,-13681.58 12933.77,-13681.58"/>
</g>
<!-- layer0_k_proj_gpu6 -->
<g id="node73" class="node">
<title>layer0_k_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="13739.77,-13671.5 13238.77,-13671.5 13238.77,-13603.5 13739.77,-13603.5 13739.77,-13671.5"/>
<text text-anchor="middle" x="13489.27" y="-13656.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="13489.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13489.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13489.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_attn_norm_gpu6&#45;&gt;layer0_k_proj_gpu6 -->
<g id="edge84" class="edge">
<title>layer0_attn_norm_gpu6&#45;&gt;layer0_k_proj_gpu6</title>
<path fill="none" stroke="black" d="M13178.87,-13780C13270.04,-13780 13351.36,-13780 13351.36,-13780 13351.36,-13780 13351.36,-13681.63 13351.36,-13681.63"/>
<polygon fill="black" stroke="black" points="13354.86,-13681.63 13351.36,-13671.63 13347.86,-13681.63 13354.86,-13681.63"/>
</g>
<!-- layer0_v_proj_gpu6 -->
<g id="node74" class="node">
<title>layer0_v_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="12621.77,-13671.5 12120.77,-13671.5 12120.77,-13603.5 12621.77,-13603.5 12621.77,-13671.5"/>
<text text-anchor="middle" x="12371.27" y="-13656.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="12371.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12371.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12371.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_attn_norm_gpu6&#45;&gt;layer0_v_proj_gpu6 -->
<g id="edge85" class="edge">
<title>layer0_attn_norm_gpu6&#45;&gt;layer0_v_proj_gpu6</title>
<path fill="none" stroke="black" d="M12681.66,-13780C12590.49,-13780 12509.17,-13780 12509.17,-13780 12509.17,-13780 12509.17,-13681.63 12509.17,-13681.63"/>
<polygon fill="black" stroke="black" points="12512.67,-13681.63 12509.17,-13671.63 12505.67,-13681.63 12512.67,-13681.63"/>
</g>
<!-- layer0_gather_q_gpu6 -->
<g id="node75" class="node">
<title>layer0_gather_q_gpu6</title>
<ellipse fill="lightblue" stroke="black" cx="12820.27" cy="-13469.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="12820.27" y="-13488.21" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="12820.27" y="-13473.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12820.27" y="-13458.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12820.27" y="-13443.21" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_q_proj_gpu6&#45;&gt;layer0_gather_q_gpu6 -->
<g id="edge86" class="edge">
<title>layer0_q_proj_gpu6&#45;&gt;layer0_gather_q_gpu6</title>
<path fill="none" stroke="black" d="M12930.27,-13603.48C12930.27,-13603.48 12930.27,-13525.48 12930.27,-13525.48"/>
<polygon fill="black" stroke="black" points="12933.77,-13525.48 12930.27,-13515.48 12926.77,-13525.48 12933.77,-13525.48"/>
</g>
<!-- layer0_gather_k_gpu6 -->
<g id="node76" class="node">
<title>layer0_gather_k_gpu6</title>
<ellipse fill="lightblue" stroke="black" cx="13599.27" cy="-13469.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="13599.27" y="-13488.21" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="13599.27" y="-13473.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13599.27" y="-13458.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13599.27" y="-13443.21" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_k_proj_gpu6&#45;&gt;layer0_gather_k_gpu6 -->
<g id="edge87" class="edge">
<title>layer0_k_proj_gpu6&#45;&gt;layer0_gather_k_gpu6</title>
<path fill="none" stroke="black" d="M13489.27,-13603.48C13489.27,-13603.48 13489.27,-13525.48 13489.27,-13525.48"/>
<polygon fill="black" stroke="black" points="13492.77,-13525.48 13489.27,-13515.48 13485.77,-13525.48 13492.77,-13525.48"/>
</g>
<!-- layer0_gather_v_gpu6 -->
<g id="node77" class="node">
<title>layer0_gather_v_gpu6</title>
<ellipse fill="lightblue" stroke="black" cx="12371.27" cy="-13105.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="12371.27" y="-13123.88" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="12371.27" y="-13108.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12371.27" y="-13093.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12371.27" y="-13078.88" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_v_proj_gpu6&#45;&gt;layer0_gather_v_gpu6 -->
<g id="edge88" class="edge">
<title>layer0_v_proj_gpu6&#45;&gt;layer0_gather_v_gpu6</title>
<path fill="none" stroke="black" d="M12371.27,-13603.38C12371.27,-13603.38 12371.27,-13163.4 12371.27,-13163.4"/>
<polygon fill="black" stroke="black" points="12374.77,-13163.4 12371.27,-13153.4 12367.77,-13163.4 12374.77,-13163.4"/>
</g>
<!-- layer0_attn_scores_gpu6 -->
<g id="node78" class="node">
<title>layer0_attn_scores_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="13328.77,-13321.25 12789.77,-13321.25 12789.77,-13253.25 13328.77,-13253.25 13328.77,-13321.25"/>
<text text-anchor="middle" x="13059.27" y="-13306.05" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="13059.27" y="-13291.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13059.27" y="-13276.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="13059.27" y="-13261.05" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gather_q_gpu6&#45;&gt;layer0_attn_scores_gpu6 -->
<g id="edge89" class="edge">
<title>layer0_gather_q_gpu6&#45;&gt;layer0_attn_scores_gpu6</title>
<path fill="none" stroke="black" d="M12985.33,-13426.24C12985.33,-13426.24 12985.33,-13331.3 12985.33,-13331.3"/>
<polygon fill="black" stroke="black" points="12988.83,-13331.3 12985.33,-13321.3 12981.83,-13331.3 12988.83,-13331.3"/>
</g>
<!-- layer0_gather_k_gpu6&#45;&gt;layer0_attn_scores_gpu6 -->
<g id="edge90" class="edge">
<title>layer0_gather_k_gpu6&#45;&gt;layer0_attn_scores_gpu6</title>
<path fill="none" stroke="black" d="M13283.7,-13445.97C13283.7,-13445.97 13283.7,-13331.47 13283.7,-13331.47"/>
<polygon fill="black" stroke="black" points="13287.2,-13331.47 13283.7,-13321.47 13280.2,-13331.47 13287.2,-13331.47"/>
</g>
<!-- layer0_attn_out_gpu6 -->
<g id="node80" class="node">
<title>layer0_attn_out_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="12916.77,-12971 12389.77,-12971 12389.77,-12903 12916.77,-12903 12916.77,-12971"/>
<text text-anchor="middle" x="12653.27" y="-12955.8" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="12653.27" y="-12940.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="12653.27" y="-12925.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12653.27" y="-12910.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_gather_v_gpu6&#45;&gt;layer0_attn_out_gpu6 -->
<g id="edge93" class="edge">
<title>layer0_gather_v_gpu6&#45;&gt;layer0_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M12560.83,-13063.96C12560.83,-13063.96 12560.83,-12981.18 12560.83,-12981.18"/>
<polygon fill="black" stroke="black" points="12564.33,-12981.18 12560.83,-12971.18 12557.33,-12981.18 12564.33,-12981.18"/>
</g>
<!-- layer0_softmax_gpu6 -->
<g id="node79" class="node">
<title>layer0_softmax_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="13328.77,-13139.08 12789.77,-13139.08 12789.77,-13071.08 13328.77,-13071.08 13328.77,-13139.08"/>
<text text-anchor="middle" x="13059.27" y="-13123.88" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="13059.27" y="-13108.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="13059.27" y="-13093.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="13059.27" y="-13078.88" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_attn_scores_gpu6&#45;&gt;layer0_softmax_gpu6 -->
<g id="edge91" class="edge">
<title>layer0_attn_scores_gpu6&#45;&gt;layer0_softmax_gpu6</title>
<path fill="none" stroke="black" d="M13059.27,-13252.98C13059.27,-13252.98 13059.27,-13149.19 13059.27,-13149.19"/>
<polygon fill="black" stroke="black" points="13062.77,-13149.19 13059.27,-13139.19 13055.77,-13149.19 13062.77,-13149.19"/>
</g>
<!-- layer0_softmax_gpu6&#45;&gt;layer0_attn_out_gpu6 -->
<g id="edge92" class="edge">
<title>layer0_softmax_gpu6&#45;&gt;layer0_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M12853.27,-13071.06C12853.27,-13071.06 12853.27,-12981.25 12853.27,-12981.25"/>
<polygon fill="black" stroke="black" points="12856.77,-12981.25 12853.27,-12971.25 12849.77,-12981.25 12856.77,-12981.25"/>
</g>
<!-- layer0_out_proj_gpu6 -->
<g id="node81" class="node">
<title>layer0_out_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="12897.77,-12817 12408.77,-12817 12408.77,-12749 12897.77,-12749 12897.77,-12817"/>
<text text-anchor="middle" x="12653.27" y="-12801.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12653.27" y="-12786.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12653.27" y="-12771.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="12653.27" y="-12756.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_attn_out_gpu6&#45;&gt;layer0_out_proj_gpu6 -->
<g id="edge94" class="edge">
<title>layer0_attn_out_gpu6&#45;&gt;layer0_out_proj_gpu6</title>
<path fill="none" stroke="black" d="M12653.27,-12902.82C12653.27,-12902.82 12653.27,-12827.08 12653.27,-12827.08"/>
<polygon fill="black" stroke="black" points="12656.77,-12827.08 12653.27,-12817.08 12649.77,-12827.08 12656.77,-12827.08"/>
</g>
<!-- layer0_out_proj_gpu6&#45;&gt;layer0_attn_all_reduce -->
<g id="edge114" class="edge">
<title>layer0_out_proj_gpu6&#45;&gt;layer0_attn_all_reduce</title>
<path fill="none" stroke="black" d="M12653.27,-12748.98C12653.27,-12748.98 12653.27,-12673.21 12653.27,-12673.21"/>
<polygon fill="black" stroke="black" points="12656.77,-12673.21 12653.27,-12663.21 12649.77,-12673.21 12656.77,-12673.21"/>
</g>
<!-- layer0_q_proj_gpu7 -->
<g id="node83" class="node">
<title>layer0_q_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="14857.77,-13671.5 14356.77,-13671.5 14356.77,-13603.5 14857.77,-13603.5 14857.77,-13671.5"/>
<text text-anchor="middle" x="14607.27" y="-13656.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="14607.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14607.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14607.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_attn_norm_gpu7&#45;&gt;layer0_q_proj_gpu7 -->
<g id="edge96" class="edge">
<title>layer0_attn_norm_gpu7&#45;&gt;layer0_q_proj_gpu7</title>
<path fill="none" stroke="black" d="M14466.27,-13757.32C14466.27,-13757.32 14466.27,-13681.58 14466.27,-13681.58"/>
<polygon fill="black" stroke="black" points="14469.77,-13681.58 14466.27,-13671.58 14462.77,-13681.58 14469.77,-13681.58"/>
</g>
<!-- layer0_k_proj_gpu7 -->
<g id="node84" class="node">
<title>layer0_k_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="15416.77,-13671.5 14915.77,-13671.5 14915.77,-13603.5 15416.77,-13603.5 15416.77,-13671.5"/>
<text text-anchor="middle" x="15166.27" y="-13656.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="15166.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15166.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15166.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_attn_norm_gpu7&#45;&gt;layer0_k_proj_gpu7 -->
<g id="edge97" class="edge">
<title>layer0_attn_norm_gpu7&#45;&gt;layer0_k_proj_gpu7</title>
<path fill="none" stroke="black" d="M14575.87,-13791C14823.25,-13791 15166.27,-13791 15166.27,-13791 15166.27,-13791 15166.27,-13681.56 15166.27,-13681.56"/>
<polygon fill="black" stroke="black" points="15169.77,-13681.56 15166.27,-13671.56 15162.77,-13681.56 15169.77,-13681.56"/>
</g>
<!-- layer0_v_proj_gpu7 -->
<g id="node85" class="node">
<title>layer0_v_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="14298.77,-13671.5 13797.77,-13671.5 13797.77,-13603.5 14298.77,-13603.5 14298.77,-13671.5"/>
<text text-anchor="middle" x="14048.27" y="-13656.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="14048.27" y="-13641.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14048.27" y="-13626.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14048.27" y="-13611.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_attn_norm_gpu7&#45;&gt;layer0_v_proj_gpu7 -->
<g id="edge98" class="edge">
<title>layer0_attn_norm_gpu7&#45;&gt;layer0_v_proj_gpu7</title>
<path fill="none" stroke="black" d="M14188.77,-13757.32C14188.77,-13757.32 14188.77,-13681.58 14188.77,-13681.58"/>
<polygon fill="black" stroke="black" points="14192.27,-13681.58 14188.77,-13671.58 14185.27,-13681.58 14192.27,-13681.58"/>
</g>
<!-- layer0_gather_q_gpu7 -->
<g id="node86" class="node">
<title>layer0_gather_q_gpu7</title>
<ellipse fill="lightblue" stroke="black" cx="14497.27" cy="-13469.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="14497.27" y="-13488.21" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="14497.27" y="-13473.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14497.27" y="-13458.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14497.27" y="-13443.21" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_q_proj_gpu7&#45;&gt;layer0_gather_q_gpu7 -->
<g id="edge99" class="edge">
<title>layer0_q_proj_gpu7&#45;&gt;layer0_gather_q_gpu7</title>
<path fill="none" stroke="black" d="M14607.27,-13603.48C14607.27,-13603.48 14607.27,-13525.48 14607.27,-13525.48"/>
<polygon fill="black" stroke="black" points="14610.77,-13525.48 14607.27,-13515.48 14603.77,-13525.48 14610.77,-13525.48"/>
</g>
<!-- layer0_gather_k_gpu7 -->
<g id="node87" class="node">
<title>layer0_gather_k_gpu7</title>
<ellipse fill="lightblue" stroke="black" cx="15276.27" cy="-13469.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="15276.27" y="-13488.21" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="15276.27" y="-13473.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15276.27" y="-13458.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="15276.27" y="-13443.21" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_k_proj_gpu7&#45;&gt;layer0_gather_k_gpu7 -->
<g id="edge100" class="edge">
<title>layer0_k_proj_gpu7&#45;&gt;layer0_gather_k_gpu7</title>
<path fill="none" stroke="black" d="M15166.27,-13603.48C15166.27,-13603.48 15166.27,-13525.48 15166.27,-13525.48"/>
<polygon fill="black" stroke="black" points="15169.77,-13525.48 15166.27,-13515.48 15162.77,-13525.48 15169.77,-13525.48"/>
</g>
<!-- layer0_gather_v_gpu7 -->
<g id="node88" class="node">
<title>layer0_gather_v_gpu7</title>
<ellipse fill="lightblue" stroke="black" cx="13929.27" cy="-13287.25" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="13929.27" y="-13306.05" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="13929.27" y="-13291.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13929.27" y="-13276.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13929.27" y="-13261.05" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_v_proj_gpu7&#45;&gt;layer0_gather_v_gpu7 -->
<g id="edge101" class="edge">
<title>layer0_v_proj_gpu7&#45;&gt;layer0_gather_v_gpu7</title>
<path fill="none" stroke="black" d="M14048.27,-13603.27C14048.27,-13603.27 14048.27,-13342.86 14048.27,-13342.86"/>
<polygon fill="black" stroke="black" points="14051.77,-13342.86 14048.27,-13332.86 14044.77,-13342.86 14051.77,-13342.86"/>
</g>
<!-- layer0_attn_scores_gpu7 -->
<g id="node89" class="node">
<title>layer0_attn_scores_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="14886.77,-13321.25 14347.77,-13321.25 14347.77,-13253.25 14886.77,-13253.25 14886.77,-13321.25"/>
<text text-anchor="middle" x="14617.27" y="-13306.05" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="14617.27" y="-13291.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14617.27" y="-13276.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="14617.27" y="-13261.05" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gather_q_gpu7&#45;&gt;layer0_attn_scores_gpu7 -->
<g id="edge102" class="edge">
<title>layer0_gather_q_gpu7&#45;&gt;layer0_attn_scores_gpu7</title>
<path fill="none" stroke="black" d="M14602.83,-13422.97C14602.83,-13422.97 14602.83,-13331.52 14602.83,-13331.52"/>
<polygon fill="black" stroke="black" points="14606.33,-13331.52 14602.83,-13321.52 14599.33,-13331.52 14606.33,-13331.52"/>
</g>
<!-- layer0_gather_k_gpu7&#45;&gt;layer0_attn_scores_gpu7 -->
<g id="edge103" class="edge">
<title>layer0_gather_k_gpu7&#45;&gt;layer0_attn_scores_gpu7</title>
<path fill="none" stroke="black" d="M14915.56,-13469C14888.99,-13469 14872.33,-13469 14872.33,-13469 14872.33,-13469 14872.33,-13331.43 14872.33,-13331.43"/>
<polygon fill="black" stroke="black" points="14875.83,-13331.43 14872.33,-13321.43 14868.83,-13331.43 14875.83,-13331.43"/>
</g>
<!-- layer0_attn_out_gpu7 -->
<g id="node91" class="node">
<title>layer0_attn_out_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="14192.77,-12971 13665.77,-12971 13665.77,-12903 14192.77,-12903 14192.77,-12971"/>
<text text-anchor="middle" x="13929.27" y="-12955.8" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="13929.27" y="-12940.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="13929.27" y="-12925.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13929.27" y="-12910.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_gather_v_gpu7&#45;&gt;layer0_attn_out_gpu7 -->
<g id="edge106" class="edge">
<title>layer0_gather_v_gpu7&#45;&gt;layer0_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M13924.27,-13238.91C13924.27,-13238.91 13924.27,-12981.15 13924.27,-12981.15"/>
<polygon fill="black" stroke="black" points="13927.77,-12981.15 13924.27,-12971.15 13920.77,-12981.15 13927.77,-12981.15"/>
</g>
<!-- layer0_softmax_gpu7 -->
<g id="node90" class="node">
<title>layer0_softmax_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="14721.77,-13139.08 14182.77,-13139.08 14182.77,-13071.08 14721.77,-13071.08 14721.77,-13139.08"/>
<text text-anchor="middle" x="14452.27" y="-13123.88" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="14452.27" y="-13108.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="14452.27" y="-13093.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="14452.27" y="-13078.88" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_attn_scores_gpu7&#45;&gt;layer0_softmax_gpu7 -->
<g id="edge104" class="edge">
<title>layer0_attn_scores_gpu7&#45;&gt;layer0_softmax_gpu7</title>
<path fill="none" stroke="black" d="M14534.77,-13252.98C14534.77,-13252.98 14534.77,-13149.19 14534.77,-13149.19"/>
<polygon fill="black" stroke="black" points="14538.27,-13149.19 14534.77,-13139.19 14531.27,-13149.19 14538.27,-13149.19"/>
</g>
<!-- layer0_softmax_gpu7&#45;&gt;layer0_attn_out_gpu7 -->
<g id="edge105" class="edge">
<title>layer0_softmax_gpu7&#45;&gt;layer0_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M14187.77,-13071.06C14187.77,-13071.06 14187.77,-12981.25 14187.77,-12981.25"/>
<polygon fill="black" stroke="black" points="14191.27,-12981.25 14187.77,-12971.25 14184.27,-12981.25 14191.27,-12981.25"/>
</g>
<!-- layer0_out_proj_gpu7 -->
<g id="node92" class="node">
<title>layer0_out_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="14009.77,-12817 13520.77,-12817 13520.77,-12749 14009.77,-12749 14009.77,-12817"/>
<text text-anchor="middle" x="13765.27" y="-12801.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13765.27" y="-12786.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13765.27" y="-12771.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="13765.27" y="-12756.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_attn_out_gpu7&#45;&gt;layer0_out_proj_gpu7 -->
<g id="edge107" class="edge">
<title>layer0_attn_out_gpu7&#45;&gt;layer0_out_proj_gpu7</title>
<path fill="none" stroke="black" d="M13837.77,-12902.82C13837.77,-12902.82 13837.77,-12827.08 13837.77,-12827.08"/>
<polygon fill="black" stroke="black" points="13841.27,-12827.08 13837.77,-12817.08 13834.27,-12827.08 13841.27,-12827.08"/>
</g>
<!-- layer0_out_proj_gpu7&#45;&gt;layer0_attn_all_reduce -->
<g id="edge115" class="edge">
<title>layer0_out_proj_gpu7&#45;&gt;layer0_attn_all_reduce</title>
<path fill="none" stroke="black" d="M13520.6,-12782C13283.9,-12782 12960.73,-12782 12960.73,-12782 12960.73,-12782 12960.73,-12648.5 12960.73,-12648.5"/>
<polygon fill="black" stroke="black" points="12964.23,-12648.5 12960.73,-12638.5 12957.23,-12648.5 12964.23,-12648.5"/>
</g>
<!-- layer0_attn_all_reduce&#45;&gt;layer0_attn_residual -->
<g id="edge117" class="edge">
<title>layer0_attn_all_reduce&#45;&gt;layer0_attn_residual</title>
<path fill="none" stroke="black" d="M12330.77,-12595.68C12330.77,-12548.72 12330.77,-12432 12330.77,-12432 12330.77,-12432 10342.76,-12432 10342.76,-12432"/>
<polygon fill="black" stroke="black" points="10342.76,-12428.5 10332.76,-12432 10342.76,-12435.5 10342.76,-12428.5"/>
</g>
<!-- layer0_broadcast_to_moe -->
<g id="node95" class="node">
<title>layer0_broadcast_to_moe</title>
<ellipse fill="lightblue" stroke="black" cx="12008.27" cy="-12250.58" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="12008.27" y="-12269.38" font-family="Times,serif" font-size="14.00">Broadcast to MoE GPUs</text>
<text text-anchor="middle" x="12008.27" y="-12254.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12008.27" y="-12239.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12008.27" y="-12224.38" font-family="Times,serif" font-size="14.00">GPU: GPUs 8&#45;15</text>
</g>
<!-- layer0_attn_residual&#45;&gt;layer0_broadcast_to_moe -->
<g id="edge118" class="edge">
<title>layer0_attn_residual&#45;&gt;layer0_broadcast_to_moe</title>
<path fill="none" stroke="black" d="M10248,-12408.86C10248,-12359.32 10248,-12250 10248,-12250 10248,-12250 11646.81,-12250 11646.81,-12250"/>
<polygon fill="black" stroke="black" points="11646.81,-12253.5 11656.81,-12250 11646.81,-12246.5 11646.81,-12253.5"/>
</g>
<!-- layer0_final_residual -->
<g id="node179" class="node">
<title>layer0_final_residual</title>
<ellipse fill="lightblue" stroke="black" cx="9745.27" cy="-10604.25" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="9745.27" y="-10623.05" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="9745.27" y="-10608.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096], [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9745.27" y="-10593.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9745.27" y="-10578.05" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer0_attn_residual&#45;&gt;layer0_final_residual -->
<g id="edge233" class="edge">
<title>layer0_attn_residual&#45;&gt;layer0_final_residual</title>
<path fill="none" stroke="black" d="M10134.27,-12398.03C10134.27,-12235.9 10134.27,-11561 10134.27,-11561 10134.27,-11561 10046.77,-11561 10046.77,-11561 10046.77,-11561 10046.77,-10656.9 10046.77,-10656.9"/>
<polygon fill="black" stroke="black" points="10050.27,-10656.9 10046.77,-10646.9 10043.27,-10656.9 10050.27,-10656.9"/>
</g>
<!-- layer0_moe_norm -->
<g id="node96" class="node">
<title>layer0_moe_norm</title>
<polygon fill="lightyellow" stroke="black" points="14283.77,-12116.5 13786.77,-12116.5 13786.77,-12048.5 14283.77,-12048.5 14283.77,-12116.5"/>
<text text-anchor="middle" x="14035.27" y="-12101.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="14035.27" y="-12086.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14035.27" y="-12071.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14035.27" y="-12056.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer0_broadcast_to_moe&#45;&gt;layer0_moe_norm -->
<g id="edge119" class="edge">
<title>layer0_broadcast_to_moe&#45;&gt;layer0_moe_norm</title>
<path fill="none" stroke="black" d="M12325.57,-12229.85C12325.57,-12190.3 12325.57,-12108 12325.57,-12108 12325.57,-12108 13776.66,-12108 13776.66,-12108"/>
<polygon fill="black" stroke="black" points="13776.66,-12111.5 13786.66,-12108 13776.66,-12104.5 13776.66,-12111.5"/>
</g>
<!-- layer0_gate -->
<g id="node97" class="node">
<title>layer0_gate</title>
<polygon fill="lightpink" stroke="black" points="14833.92,-11962.5 14034.31,-11962.5 13828.62,-11826.5 14628.22,-11826.5 14833.92,-11962.5"/>
<text text-anchor="middle" x="14331.27" y="-11913.3" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="14331.27" y="-11898.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14331.27" y="-11883.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="14331.27" y="-11868.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer0_moe_norm&#45;&gt;layer0_gate -->
<g id="edge120" class="edge">
<title>layer0_moe_norm&#45;&gt;layer0_gate</title>
<path fill="none" stroke="black" d="M14056.1,-12048.45C14056.1,-12048.45 14056.1,-11972.56 14056.1,-11972.56"/>
<polygon fill="black" stroke="black" points="14059.6,-11972.56 14056.1,-11962.56 14052.6,-11972.56 14059.6,-11972.56"/>
</g>
<!-- layer0_route_expert0 -->
<g id="node98" class="node">
<title>layer0_route_expert0</title>
<polygon fill="lightpink" stroke="black" points="17552.92,-11740.5 16753.31,-11740.5 16547.62,-11604.5 17347.22,-11604.5 17552.92,-11740.5"/>
<text text-anchor="middle" x="17050.27" y="-11691.3" font-family="Times,serif" font-size="14.00">Route to Expert 0</text>
<text text-anchor="middle" x="17050.27" y="-11676.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17050.27" y="-11661.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="17050.27" y="-11646.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_moe_norm&#45;&gt;layer0_route_expert0 -->
<g id="edge122" class="edge">
<title>layer0_moe_norm&#45;&gt;layer0_route_expert0</title>
<path fill="none" stroke="black" d="M14283.86,-12071C14964.67,-12071 16808.99,-12071 16808.99,-12071 16808.99,-12071 16808.99,-11750.55 16808.99,-11750.55"/>
<polygon fill="black" stroke="black" points="16812.49,-11750.55 16808.99,-11740.55 16805.49,-11750.55 16812.49,-11750.55"/>
</g>
<!-- layer0_route_expert1 -->
<g id="node103" class="node">
<title>layer0_route_expert1</title>
<polygon fill="lightpink" stroke="black" points="18616.92,-11740.5 17817.31,-11740.5 17611.62,-11604.5 18411.22,-11604.5 18616.92,-11740.5"/>
<text text-anchor="middle" x="18114.27" y="-11691.3" font-family="Times,serif" font-size="14.00">Route to Expert 1</text>
<text text-anchor="middle" x="18114.27" y="-11676.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18114.27" y="-11661.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="18114.27" y="-11646.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_moe_norm&#45;&gt;layer0_route_expert1 -->
<g id="edge128" class="edge">
<title>layer0_moe_norm&#45;&gt;layer0_route_expert1</title>
<path fill="none" stroke="black" d="M14283.82,-12078C15127.4,-12078 17828.99,-12078 17828.99,-12078 17828.99,-12078 17828.99,-11750.83 17828.99,-11750.83"/>
<polygon fill="black" stroke="black" points="17832.49,-11750.83 17828.99,-11740.83 17825.49,-11750.83 17832.49,-11750.83"/>
</g>
<!-- layer0_route_expert2 -->
<g id="node108" class="node">
<title>layer0_route_expert2</title>
<polygon fill="lightpink" stroke="black" points="19680.92,-11740.5 18881.31,-11740.5 18675.62,-11604.5 19475.22,-11604.5 19680.92,-11740.5"/>
<text text-anchor="middle" x="19178.27" y="-11691.3" font-family="Times,serif" font-size="14.00">Route to Expert 2</text>
<text text-anchor="middle" x="19178.27" y="-11676.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19178.27" y="-11661.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="19178.27" y="-11646.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_moe_norm&#45;&gt;layer0_route_expert2 -->
<g id="edge134" class="edge">
<title>layer0_moe_norm&#45;&gt;layer0_route_expert2</title>
<path fill="none" stroke="black" d="M14284,-12086C15251.09,-12086 18707.66,-12086 18707.66,-12086 18707.66,-12086 18707.66,-11682.57 18707.66,-11682.57"/>
<polygon fill="black" stroke="black" points="18711.16,-11682.57 18707.66,-11672.57 18704.16,-11682.57 18711.16,-11682.57"/>
</g>
<!-- layer0_route_expert3 -->
<g id="node113" class="node">
<title>layer0_route_expert3</title>
<polygon fill="lightpink" stroke="black" points="20744.92,-11740.5 19945.31,-11740.5 19739.62,-11604.5 20539.22,-11604.5 20744.92,-11740.5"/>
<text text-anchor="middle" x="20242.27" y="-11691.3" font-family="Times,serif" font-size="14.00">Route to Expert 3</text>
<text text-anchor="middle" x="20242.27" y="-11676.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="20242.27" y="-11661.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="20242.27" y="-11646.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_moe_norm&#45;&gt;layer0_route_expert3 -->
<g id="edge140" class="edge">
<title>layer0_moe_norm&#45;&gt;layer0_route_expert3</title>
<path fill="none" stroke="black" d="M14283.91,-12093C15398.02,-12093 19876.32,-12093 19876.32,-12093 19876.32,-12093 19876.32,-11705.1 19876.32,-11705.1"/>
<polygon fill="black" stroke="black" points="19879.82,-11705.1 19876.32,-11695.1 19872.82,-11705.1 19879.82,-11705.1"/>
</g>
<!-- layer0_route_expert4 -->
<g id="node118" class="node">
<title>layer0_route_expert4</title>
<polygon fill="lightpink" stroke="black" points="21808.92,-11740.5 21009.31,-11740.5 20803.62,-11604.5 21603.22,-11604.5 21808.92,-11740.5"/>
<text text-anchor="middle" x="21306.27" y="-11691.3" font-family="Times,serif" font-size="14.00">Route to Expert 4</text>
<text text-anchor="middle" x="21306.27" y="-11676.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="21306.27" y="-11661.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="21306.27" y="-11646.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_moe_norm&#45;&gt;layer0_route_expert4 -->
<g id="edge146" class="edge">
<title>layer0_moe_norm&#45;&gt;layer0_route_expert4</title>
<path fill="none" stroke="black" d="M14283.82,-12101C15576.71,-12101 21473.87,-12101 21473.87,-12101 21473.87,-12101 21473.87,-11750.87 21473.87,-11750.87"/>
<polygon fill="black" stroke="black" points="21477.37,-11750.87 21473.87,-11740.87 21470.37,-11750.87 21477.37,-11750.87"/>
</g>
<!-- layer0_route_expert5 -->
<g id="node123" class="node">
<title>layer0_route_expert5</title>
<polygon fill="lightpink" stroke="black" points="22872.92,-11740.5 22073.31,-11740.5 21867.62,-11604.5 22667.22,-11604.5 22872.92,-11740.5"/>
<text text-anchor="middle" x="22370.27" y="-11691.3" font-family="Times,serif" font-size="14.00">Route to Expert 5</text>
<text text-anchor="middle" x="22370.27" y="-11676.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="22370.27" y="-11661.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="22370.27" y="-11646.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_moe_norm&#45;&gt;layer0_route_expert5 -->
<g id="edge152" class="edge">
<title>layer0_moe_norm&#45;&gt;layer0_route_expert5</title>
<path fill="none" stroke="black" d="M14283.98,-12108C15685.84,-12108 22537.87,-12108 22537.87,-12108 22537.87,-12108 22537.87,-11750.54 22537.87,-11750.54"/>
<polygon fill="black" stroke="black" points="22541.37,-11750.54 22537.87,-11740.54 22534.37,-11750.54 22541.37,-11750.54"/>
</g>
<!-- layer0_route_expert6 -->
<g id="node128" class="node">
<title>layer0_route_expert6</title>
<polygon fill="lightpink" stroke="black" points="6912.92,-11740.5 6113.31,-11740.5 5907.62,-11604.5 6707.22,-11604.5 6912.92,-11740.5"/>
<text text-anchor="middle" x="6410.27" y="-11691.3" font-family="Times,serif" font-size="14.00">Route to Expert 6</text>
<text text-anchor="middle" x="6410.27" y="-11676.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6410.27" y="-11661.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="6410.27" y="-11646.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_moe_norm&#45;&gt;layer0_route_expert6 -->
<g id="edge158" class="edge">
<title>layer0_moe_norm&#45;&gt;layer0_route_expert6</title>
<path fill="none" stroke="black" d="M13786.73,-12101C12456.94,-12101 6242.66,-12101 6242.66,-12101 6242.66,-12101 6242.66,-11750.87 6242.66,-11750.87"/>
<polygon fill="black" stroke="black" points="6246.16,-11750.87 6242.66,-11740.87 6239.16,-11750.87 6246.16,-11750.87"/>
</g>
<!-- layer0_route_expert7 -->
<g id="node133" class="node">
<title>layer0_route_expert7</title>
<polygon fill="lightpink" stroke="black" points="7976.92,-11740.5 7177.31,-11740.5 6971.62,-11604.5 7771.22,-11604.5 7976.92,-11740.5"/>
<text text-anchor="middle" x="7474.27" y="-11691.3" font-family="Times,serif" font-size="14.00">Route to Expert 7</text>
<text text-anchor="middle" x="7474.27" y="-11676.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7474.27" y="-11661.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="7474.27" y="-11646.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_moe_norm&#45;&gt;layer0_route_expert7 -->
<g id="edge164" class="edge">
<title>layer0_moe_norm&#45;&gt;layer0_route_expert7</title>
<path fill="none" stroke="black" d="M13786.74,-12093C12585.54,-12093 7439,-12093 7439,-12093 7439,-12093 7439,-11750.52 7439,-11750.52"/>
<polygon fill="black" stroke="black" points="7442.5,-11750.52 7439,-11740.52 7435.5,-11750.52 7442.5,-11750.52"/>
</g>
<!-- layer0_route_expert8 -->
<g id="node138" class="node">
<title>layer0_route_expert8</title>
<polygon fill="lightpink" stroke="black" points="9040.92,-11740.5 8241.31,-11740.5 8035.62,-11604.5 8835.22,-11604.5 9040.92,-11740.5"/>
<text text-anchor="middle" x="8538.27" y="-11691.3" font-family="Times,serif" font-size="14.00">Route to Expert 8</text>
<text text-anchor="middle" x="8538.27" y="-11676.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8538.27" y="-11661.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="8538.27" y="-11646.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_moe_norm&#45;&gt;layer0_route_expert8 -->
<g id="edge170" class="edge">
<title>layer0_moe_norm&#45;&gt;layer0_route_expert8</title>
<path fill="none" stroke="black" d="M13786.48,-12086C12739.91,-12086 8748.5,-12086 8748.5,-12086 8748.5,-12086 8748.5,-11750.78 8748.5,-11750.78"/>
<polygon fill="black" stroke="black" points="8752,-11750.78 8748.5,-11740.78 8745,-11750.78 8752,-11750.78"/>
</g>
<!-- layer0_route_expert9 -->
<g id="node143" class="node">
<title>layer0_route_expert9</title>
<polygon fill="lightpink" stroke="black" points="10104.92,-11740.5 9305.31,-11740.5 9099.62,-11604.5 9899.22,-11604.5 10104.92,-11740.5"/>
<text text-anchor="middle" x="9602.27" y="-11691.3" font-family="Times,serif" font-size="14.00">Route to Expert 9</text>
<text text-anchor="middle" x="9602.27" y="-11676.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9602.27" y="-11661.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="9602.27" y="-11646.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_moe_norm&#45;&gt;layer0_route_expert9 -->
<g id="edge176" class="edge">
<title>layer0_moe_norm&#45;&gt;layer0_route_expert9</title>
<path fill="none" stroke="black" d="M13786.69,-12078C12829.43,-12078 9434.66,-12078 9434.66,-12078 9434.66,-12078 9434.66,-11750.83 9434.66,-11750.83"/>
<polygon fill="black" stroke="black" points="9438.16,-11750.83 9434.66,-11740.83 9431.16,-11750.83 9438.16,-11750.83"/>
</g>
<!-- layer0_route_expert10 -->
<g id="node148" class="node">
<title>layer0_route_expert10</title>
<polygon fill="lightpink" stroke="black" points="11168.92,-11740.5 10369.31,-11740.5 10163.62,-11604.5 10963.22,-11604.5 11168.92,-11740.5"/>
<text text-anchor="middle" x="10666.27" y="-11691.3" font-family="Times,serif" font-size="14.00">Route to Expert 10</text>
<text text-anchor="middle" x="10666.27" y="-11676.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10666.27" y="-11661.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="10666.27" y="-11646.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_moe_norm&#45;&gt;layer0_route_expert10 -->
<g id="edge182" class="edge">
<title>layer0_moe_norm&#45;&gt;layer0_route_expert10</title>
<path fill="none" stroke="black" d="M13786.59,-12071C13083.12,-12071 11129.62,-12071 11129.62,-12071 11129.62,-12071 11129.62,-11750.55 11129.62,-11750.55"/>
<polygon fill="black" stroke="black" points="11133.12,-11750.55 11129.62,-11740.55 11126.12,-11750.55 11133.12,-11750.55"/>
</g>
<!-- layer0_route_expert11 -->
<g id="node153" class="node">
<title>layer0_route_expert11</title>
<polygon fill="lightpink" stroke="black" points="12232.92,-11740.5 11433.31,-11740.5 11227.62,-11604.5 12027.22,-11604.5 12232.92,-11740.5"/>
<text text-anchor="middle" x="11730.27" y="-11691.3" font-family="Times,serif" font-size="14.00">Route to Expert 11</text>
<text text-anchor="middle" x="11730.27" y="-11676.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11730.27" y="-11661.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="11730.27" y="-11646.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_moe_norm&#45;&gt;layer0_route_expert11 -->
<g id="edge188" class="edge">
<title>layer0_moe_norm&#45;&gt;layer0_route_expert11</title>
<path fill="none" stroke="black" d="M13786.59,-12063C13213.55,-12063 11848.92,-12063 11848.92,-12063 11848.92,-12063 11848.92,-11750.52 11848.92,-11750.52"/>
<polygon fill="black" stroke="black" points="11852.42,-11750.52 11848.92,-11740.52 11845.42,-11750.52 11852.42,-11750.52"/>
</g>
<!-- layer0_route_expert12 -->
<g id="node158" class="node">
<title>layer0_route_expert12</title>
<polygon fill="lightpink" stroke="black" points="13296.92,-11740.5 12497.31,-11740.5 12291.62,-11604.5 13091.22,-11604.5 13296.92,-11740.5"/>
<text text-anchor="middle" x="12794.27" y="-11691.3" font-family="Times,serif" font-size="14.00">Route to Expert 12</text>
<text text-anchor="middle" x="12794.27" y="-11676.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12794.27" y="-11661.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="12794.27" y="-11646.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_moe_norm&#45;&gt;layer0_route_expert12 -->
<g id="edge194" class="edge">
<title>layer0_moe_norm&#45;&gt;layer0_route_expert12</title>
<path fill="none" stroke="black" d="M13786.74,-12056C13510.32,-12056 13102.16,-12056 13102.16,-12056 13102.16,-12056 13102.16,-11750.62 13102.16,-11750.62"/>
<polygon fill="black" stroke="black" points="13105.66,-11750.62 13102.16,-11740.62 13098.66,-11750.62 13105.66,-11750.62"/>
</g>
<!-- layer0_route_expert13 -->
<g id="node163" class="node">
<title>layer0_route_expert13</title>
<polygon fill="lightpink" stroke="black" points="14360.92,-11740.5 13561.31,-11740.5 13355.62,-11604.5 14155.22,-11604.5 14360.92,-11740.5"/>
<text text-anchor="middle" x="13858.27" y="-11691.3" font-family="Times,serif" font-size="14.00">Route to Expert 13</text>
<text text-anchor="middle" x="13858.27" y="-11676.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13858.27" y="-11661.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="13858.27" y="-11646.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_moe_norm&#45;&gt;layer0_route_expert13 -->
<g id="edge200" class="edge">
<title>layer0_moe_norm&#45;&gt;layer0_route_expert13</title>
<path fill="none" stroke="black" d="M13807.6,-12048.24C13807.6,-12048.24 13807.6,-11750.55 13807.6,-11750.55"/>
<polygon fill="black" stroke="black" points="13811.1,-11750.55 13807.6,-11740.55 13804.1,-11750.55 13811.1,-11750.55"/>
</g>
<!-- layer0_route_expert14 -->
<g id="node168" class="node">
<title>layer0_route_expert14</title>
<polygon fill="lightpink" stroke="black" points="15424.92,-11740.5 14625.31,-11740.5 14419.62,-11604.5 15219.22,-11604.5 15424.92,-11740.5"/>
<text text-anchor="middle" x="14922.27" y="-11691.3" font-family="Times,serif" font-size="14.00">Route to Expert 14</text>
<text text-anchor="middle" x="14922.27" y="-11676.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14922.27" y="-11661.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="14922.27" y="-11646.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_moe_norm&#45;&gt;layer0_route_expert14 -->
<g id="edge206" class="edge">
<title>layer0_moe_norm&#45;&gt;layer0_route_expert14</title>
<path fill="none" stroke="black" d="M14283.96,-12056C14526.92,-12056 14860.43,-12056 14860.43,-12056 14860.43,-12056 14860.43,-11750.62 14860.43,-11750.62"/>
<polygon fill="black" stroke="black" points="14863.93,-11750.62 14860.43,-11740.62 14856.93,-11750.62 14863.93,-11750.62"/>
</g>
<!-- layer0_route_expert15 -->
<g id="node173" class="node">
<title>layer0_route_expert15</title>
<polygon fill="lightpink" stroke="black" points="16488.92,-11740.5 15689.31,-11740.5 15483.62,-11604.5 16283.22,-11604.5 16488.92,-11740.5"/>
<text text-anchor="middle" x="15986.27" y="-11691.3" font-family="Times,serif" font-size="14.00">Route to Expert 15</text>
<text text-anchor="middle" x="15986.27" y="-11676.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15986.27" y="-11661.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="15986.27" y="-11646.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_moe_norm&#45;&gt;layer0_route_expert15 -->
<g id="edge212" class="edge">
<title>layer0_moe_norm&#45;&gt;layer0_route_expert15</title>
<path fill="none" stroke="black" d="M14284.21,-12063C14757.64,-12063 15740.99,-12063 15740.99,-12063 15740.99,-12063 15740.99,-11750.52 15740.99,-11750.52"/>
<polygon fill="black" stroke="black" points="15744.49,-11750.52 15740.99,-11740.52 15737.49,-11750.52 15744.49,-11750.52"/>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_expert0 -->
<g id="edge121" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14679.15,-11860C15332.58,-11860 16678.22,-11860 16678.22,-11860 16678.22,-11860 16678.22,-11701.16 16678.22,-11701.16"/>
<polygon fill="black" stroke="black" points="16681.72,-11701.16 16678.22,-11691.16 16674.72,-11701.16 16681.72,-11701.16"/>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_expert1 -->
<g id="edge127" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14704.86,-11877C15585.96,-11877 17720.22,-11877 17720.22,-11877 17720.22,-11877 17720.22,-11686.4 17720.22,-11686.4"/>
<polygon fill="black" stroke="black" points="17723.72,-11686.4 17720.22,-11676.4 17716.72,-11686.4 17723.72,-11686.4"/>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_expert2 -->
<g id="edge133" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14730.74,-11894C15807.89,-11894 18691.55,-11894 18691.55,-11894 18691.55,-11894 18691.55,-11682.66 18691.55,-11682.66"/>
<polygon fill="black" stroke="black" points="18695.05,-11682.66 18691.55,-11672.66 18688.05,-11682.66 18695.05,-11682.66"/>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_expert3 -->
<g id="edge139" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14756.17,-11911C16042.65,-11911 19807.88,-11911 19807.88,-11911 19807.88,-11911 19807.88,-11682.54 19807.88,-11682.54"/>
<polygon fill="black" stroke="black" points="19811.38,-11682.54 19807.88,-11672.54 19804.38,-11682.54 19811.38,-11682.54"/>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_expert4 -->
<g id="edge145" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14781.87,-11928C16300.79,-11928 21138.66,-11928 21138.66,-11928 21138.66,-11928 21138.66,-11750.63 21138.66,-11750.63"/>
<polygon fill="black" stroke="black" points="21142.16,-11750.63 21138.66,-11740.63 21135.16,-11750.63 21142.16,-11750.63"/>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_expert5 -->
<g id="edge151" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14807.76,-11945C16511.82,-11945 22202.66,-11945 22202.66,-11945 22202.66,-11945 22202.66,-11750.56 22202.66,-11750.56"/>
<polygon fill="black" stroke="black" points="22206.16,-11750.56 22202.66,-11740.56 22199.16,-11750.56 22206.16,-11750.56"/>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_expert6 -->
<g id="edge157" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14007.68,-11945C12539.77,-11945 6577.87,-11945 6577.87,-11945 6577.87,-11945 6577.87,-11750.56 6577.87,-11750.56"/>
<polygon fill="black" stroke="black" points="6581.37,-11750.56 6577.87,-11740.56 6574.37,-11750.56 6581.37,-11750.56"/>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_expert7 -->
<g id="edge163" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13981.86,-11928C12603.52,-11928 7618.37,-11928 7618.37,-11928 7618.37,-11928 7618.37,-11750.63 7618.37,-11750.63"/>
<polygon fill="black" stroke="black" points="7621.87,-11750.63 7618.37,-11740.63 7614.87,-11750.63 7621.87,-11750.63"/>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_expert8 -->
<g id="edge169" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13956.22,-11911C12726.39,-11911 8894.24,-11911 8894.24,-11911 8894.24,-11911 8894.24,-11750.52 8894.24,-11750.52"/>
<polygon fill="black" stroke="black" points="8897.74,-11750.52 8894.24,-11740.52 8890.74,-11750.52 8897.74,-11750.52"/>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_expert9 -->
<g id="edge175" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13930.47,-11894C12817.41,-11894 9769.87,-11894 9769.87,-11894 9769.87,-11894 9769.87,-11750.76 9769.87,-11750.76"/>
<polygon fill="black" stroke="black" points="9773.37,-11750.76 9769.87,-11740.76 9766.37,-11750.76 9773.37,-11750.76"/>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_expert10 -->
<g id="edge181" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13904.62,-11877C13037.2,-11877 11149.36,-11877 11149.36,-11877 11149.36,-11877 11149.36,-11682.64 11149.36,-11682.64"/>
<polygon fill="black" stroke="black" points="11152.86,-11682.64 11149.36,-11672.64 11145.86,-11682.64 11152.86,-11682.64"/>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_expert11 -->
<g id="edge187" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13879.13,-11860C13211.73,-11860 12041.01,-11860 12041.01,-11860 12041.01,-11860 12041.01,-11750.72 12041.01,-11750.72"/>
<polygon fill="black" stroke="black" points="12044.51,-11750.72 12041.01,-11740.72 12037.51,-11750.72 12044.51,-11750.72"/>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_expert12 -->
<g id="edge193" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13853.4,-11843C13544.44,-11843 13199.63,-11843 13199.63,-11843 13199.63,-11843 13199.63,-11750.86 13199.63,-11750.86"/>
<polygon fill="black" stroke="black" points="13203.13,-11750.86 13199.63,-11740.86 13196.13,-11750.86 13203.13,-11750.86"/>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_expert13 -->
<g id="edge199" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14094.77,-11826.38C14094.77,-11826.38 14094.77,-11750.87 14094.77,-11750.87"/>
<polygon fill="black" stroke="black" points="14098.27,-11750.87 14094.77,-11740.87 14091.27,-11750.87 14098.27,-11750.87"/>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_expert14 -->
<g id="edge205" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14626.77,-11826.38C14626.77,-11826.38 14626.77,-11750.87 14626.77,-11750.87"/>
<polygon fill="black" stroke="black" points="14630.27,-11750.87 14626.77,-11740.87 14623.27,-11750.87 14630.27,-11750.87"/>
</g>
<!-- layer0_gate&#45;&gt;layer0_route_expert15 -->
<g id="edge211" class="edge">
<title>layer0_gate&#45;&gt;layer0_route_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14653.26,-11843C15032.71,-11843 15612.22,-11843 15612.22,-11843 15612.22,-11843 15612.22,-11699.78 15612.22,-11699.78"/>
<polygon fill="black" stroke="black" points="15615.72,-11699.78 15612.22,-11689.78 15608.72,-11699.78 15615.72,-11699.78"/>
</g>
<!-- layer0_expert0_up -->
<g id="node99" class="node">
<title>layer0_expert0_up</title>
<polygon fill="lightcoral" stroke="black" points="17210.27,-11518.5 16928.27,-11518.5 16928.27,-11450.5 17210.27,-11450.5 17210.27,-11518.5"/>
<text text-anchor="middle" x="17069.27" y="-11503.3" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="17069.27" y="-11488.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="17069.27" y="-11473.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="17069.27" y="-11458.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_route_expert0&#45;&gt;layer0_expert0_up -->
<g id="edge123" class="edge">
<title>layer0_route_expert0&#45;&gt;layer0_expert0_up</title>
<path fill="none" stroke="black" d="M17069.27,-11604.36C17069.27,-11604.36 17069.27,-11528.67 17069.27,-11528.67"/>
<polygon fill="black" stroke="black" points="17072.77,-11528.67 17069.27,-11518.67 17065.77,-11528.67 17072.77,-11528.67"/>
</g>
<!-- layer0_expert0_activation -->
<g id="node100" class="node">
<title>layer0_expert0_activation</title>
<polygon fill="lightyellow" stroke="black" points="17220.27,-11364.5 16938.27,-11364.5 16938.27,-11296.5 17220.27,-11296.5 17220.27,-11364.5"/>
<text text-anchor="middle" x="17079.27" y="-11349.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17079.27" y="-11334.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="17079.27" y="-11319.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="17079.27" y="-11304.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_expert0_up&#45;&gt;layer0_expert0_activation -->
<g id="edge124" class="edge">
<title>layer0_expert0_up&#45;&gt;layer0_expert0_activation</title>
<path fill="none" stroke="black" d="M17074.27,-11450.32C17074.27,-11450.32 17074.27,-11374.58 17074.27,-11374.58"/>
<polygon fill="black" stroke="black" points="17077.77,-11374.58 17074.27,-11364.58 17070.77,-11374.58 17077.77,-11374.58"/>
</g>
<!-- layer0_expert0_down -->
<g id="node101" class="node">
<title>layer0_expert0_down</title>
<polygon fill="lightcoral" stroke="black" points="17224.77,-11210.5 16951.77,-11210.5 16951.77,-11142.5 17224.77,-11142.5 17224.77,-11210.5"/>
<text text-anchor="middle" x="17088.27" y="-11195.3" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="17088.27" y="-11180.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="17088.27" y="-11165.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="17088.27" y="-11150.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_expert0_activation&#45;&gt;layer0_expert0_down -->
<g id="edge125" class="edge">
<title>layer0_expert0_activation&#45;&gt;layer0_expert0_down</title>
<path fill="none" stroke="black" d="M17086.02,-11296.32C17086.02,-11296.32 17086.02,-11220.58 17086.02,-11220.58"/>
<polygon fill="black" stroke="black" points="17089.52,-11220.58 17086.02,-11210.58 17082.52,-11220.58 17089.52,-11220.58"/>
</g>
<!-- layer0_route_back_expert0 -->
<g id="node102" class="node">
<title>layer0_route_back_expert0</title>
<polygon fill="lightpink" stroke="black" points="17640.3,-11056.5 16821,-11056.5 16610.23,-10920.5 17429.54,-10920.5 17640.3,-11056.5"/>
<text text-anchor="middle" x="17125.27" y="-11007.3" font-family="Times,serif" font-size="14.00">Route Back Expert 0</text>
<text text-anchor="middle" x="17125.27" y="-10992.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="17125.27" y="-10977.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17125.27" y="-10962.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_expert0_down&#45;&gt;layer0_route_back_expert0 -->
<g id="edge126" class="edge">
<title>layer0_expert0_down&#45;&gt;layer0_route_back_expert0</title>
<path fill="none" stroke="black" d="M17088.27,-11142.45C17088.27,-11142.45 17088.27,-11066.56 17088.27,-11066.56"/>
<polygon fill="black" stroke="black" points="17091.77,-11066.56 17088.27,-11056.56 17084.77,-11066.56 17091.77,-11066.56"/>
</g>
<!-- layer0_expert_agg -->
<g id="node178" class="node">
<title>layer0_expert_agg</title>
<ellipse fill="lightblue" stroke="black" cx="13858.27" cy="-10786.41" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="13858.27" y="-10805.21" font-family="Times,serif" font-size="14.00">Aggregate Experts</text>
<text text-anchor="middle" x="13858.27" y="-10790.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13858.27" y="-10775.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13858.27" y="-10760.21" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer0_route_back_expert0&#45;&gt;layer0_expert_agg -->
<g id="edge217" class="edge">
<title>layer0_route_back_expert0&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M16656.88,-10988.36C16656.88,-10982.71 16656.88,-10802 16656.88,-10802 16656.88,-10802 14200.99,-10802 14200.99,-10802"/>
<polygon fill="black" stroke="black" points="14200.99,-10798.5 14190.99,-10802 14200.99,-10805.5 14200.99,-10798.5"/>
</g>
<!-- layer0_expert1_up -->
<g id="node104" class="node">
<title>layer0_expert1_up</title>
<polygon fill="lightcoral" stroke="black" points="18280.27,-11518.5 17998.27,-11518.5 17998.27,-11450.5 18280.27,-11450.5 18280.27,-11518.5"/>
<text text-anchor="middle" x="18139.27" y="-11503.3" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="18139.27" y="-11488.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="18139.27" y="-11473.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="18139.27" y="-11458.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_route_expert1&#45;&gt;layer0_expert1_up -->
<g id="edge129" class="edge">
<title>layer0_route_expert1&#45;&gt;layer0_expert1_up</title>
<path fill="none" stroke="black" d="M18139.27,-11604.36C18139.27,-11604.36 18139.27,-11528.67 18139.27,-11528.67"/>
<polygon fill="black" stroke="black" points="18142.77,-11528.67 18139.27,-11518.67 18135.77,-11528.67 18142.77,-11528.67"/>
</g>
<!-- layer0_expert1_activation -->
<g id="node105" class="node">
<title>layer0_expert1_activation</title>
<polygon fill="lightyellow" stroke="black" points="18292.27,-11364.5 18010.27,-11364.5 18010.27,-11296.5 18292.27,-11296.5 18292.27,-11364.5"/>
<text text-anchor="middle" x="18151.27" y="-11349.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="18151.27" y="-11334.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="18151.27" y="-11319.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="18151.27" y="-11304.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_expert1_up&#45;&gt;layer0_expert1_activation -->
<g id="edge130" class="edge">
<title>layer0_expert1_up&#45;&gt;layer0_expert1_activation</title>
<path fill="none" stroke="black" d="M18145.27,-11450.32C18145.27,-11450.32 18145.27,-11374.58 18145.27,-11374.58"/>
<polygon fill="black" stroke="black" points="18148.77,-11374.58 18145.27,-11364.58 18141.77,-11374.58 18148.77,-11374.58"/>
</g>
<!-- layer0_expert1_down -->
<g id="node106" class="node">
<title>layer0_expert1_down</title>
<polygon fill="lightcoral" stroke="black" points="18337.77,-11210.5 18064.77,-11210.5 18064.77,-11142.5 18337.77,-11142.5 18337.77,-11210.5"/>
<text text-anchor="middle" x="18201.27" y="-11195.3" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="18201.27" y="-11180.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="18201.27" y="-11165.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="18201.27" y="-11150.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_expert1_activation&#45;&gt;layer0_expert1_down -->
<g id="edge131" class="edge">
<title>layer0_expert1_activation&#45;&gt;layer0_expert1_down</title>
<path fill="none" stroke="black" d="M18178.52,-11296.32C18178.52,-11296.32 18178.52,-11220.58 18178.52,-11220.58"/>
<polygon fill="black" stroke="black" points="18182.02,-11220.58 18178.52,-11210.58 18175.02,-11220.58 18182.02,-11220.58"/>
</g>
<!-- layer0_route_back_expert1 -->
<g id="node107" class="node">
<title>layer0_route_back_expert1</title>
<polygon fill="lightpink" stroke="black" points="18729.3,-11056.5 17910,-11056.5 17699.23,-10920.5 18518.54,-10920.5 18729.3,-11056.5"/>
<text text-anchor="middle" x="18214.27" y="-11007.3" font-family="Times,serif" font-size="14.00">Route Back Expert 1</text>
<text text-anchor="middle" x="18214.27" y="-10992.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="18214.27" y="-10977.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18214.27" y="-10962.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer0_expert1_down&#45;&gt;layer0_route_back_expert1 -->
<g id="edge132" class="edge">
<title>layer0_expert1_down&#45;&gt;layer0_route_back_expert1</title>
<path fill="none" stroke="black" d="M18201.27,-11142.45C18201.27,-11142.45 18201.27,-11066.56 18201.27,-11066.56"/>
<polygon fill="black" stroke="black" points="18204.77,-11066.56 18201.27,-11056.56 18197.77,-11066.56 18204.77,-11066.56"/>
</g>
<!-- layer0_route_back_expert1&#45;&gt;layer0_expert_agg -->
<g id="edge218" class="edge">
<title>layer0_route_back_expert1&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M18161.55,-10920.25C18161.55,-10863.17 18161.55,-10791 18161.55,-10791 18161.55,-10791 14218.14,-10791 14218.14,-10791"/>
<polygon fill="black" stroke="black" points="14218.14,-10787.5 14208.14,-10791 14218.14,-10794.5 14218.14,-10787.5"/>
</g>
<!-- layer0_expert2_up -->
<g id="node109" class="node">
<title>layer0_expert2_up</title>
<polygon fill="lightcoral" stroke="black" points="19335.27,-11518.5 19053.27,-11518.5 19053.27,-11450.5 19335.27,-11450.5 19335.27,-11518.5"/>
<text text-anchor="middle" x="19194.27" y="-11503.3" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="19194.27" y="-11488.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="19194.27" y="-11473.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="19194.27" y="-11458.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_route_expert2&#45;&gt;layer0_expert2_up -->
<g id="edge135" class="edge">
<title>layer0_route_expert2&#45;&gt;layer0_expert2_up</title>
<path fill="none" stroke="black" d="M19194.27,-11604.36C19194.27,-11604.36 19194.27,-11528.67 19194.27,-11528.67"/>
<polygon fill="black" stroke="black" points="19197.77,-11528.67 19194.27,-11518.67 19190.77,-11528.67 19197.77,-11528.67"/>
</g>
<!-- layer0_expert2_activation -->
<g id="node110" class="node">
<title>layer0_expert2_activation</title>
<polygon fill="lightyellow" stroke="black" points="19397.27,-11364.5 19115.27,-11364.5 19115.27,-11296.5 19397.27,-11296.5 19397.27,-11364.5"/>
<text text-anchor="middle" x="19256.27" y="-11349.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="19256.27" y="-11334.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="19256.27" y="-11319.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="19256.27" y="-11304.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_expert2_up&#45;&gt;layer0_expert2_activation -->
<g id="edge136" class="edge">
<title>layer0_expert2_up&#45;&gt;layer0_expert2_activation</title>
<path fill="none" stroke="black" d="M19225.27,-11450.32C19225.27,-11450.32 19225.27,-11374.58 19225.27,-11374.58"/>
<polygon fill="black" stroke="black" points="19228.77,-11374.58 19225.27,-11364.58 19221.77,-11374.58 19228.77,-11374.58"/>
</g>
<!-- layer0_expert2_down -->
<g id="node111" class="node">
<title>layer0_expert2_down</title>
<polygon fill="lightcoral" stroke="black" points="19423.77,-11210.5 19150.77,-11210.5 19150.77,-11142.5 19423.77,-11142.5 19423.77,-11210.5"/>
<text text-anchor="middle" x="19287.27" y="-11195.3" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="19287.27" y="-11180.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="19287.27" y="-11165.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="19287.27" y="-11150.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_expert2_activation&#45;&gt;layer0_expert2_down -->
<g id="edge137" class="edge">
<title>layer0_expert2_activation&#45;&gt;layer0_expert2_down</title>
<path fill="none" stroke="black" d="M19274.02,-11296.32C19274.02,-11296.32 19274.02,-11220.58 19274.02,-11220.58"/>
<polygon fill="black" stroke="black" points="19277.52,-11220.58 19274.02,-11210.58 19270.52,-11220.58 19277.52,-11220.58"/>
</g>
<!-- layer0_route_back_expert2 -->
<g id="node112" class="node">
<title>layer0_route_back_expert2</title>
<polygon fill="lightpink" stroke="black" points="19818.3,-11056.5 18999,-11056.5 18788.23,-10920.5 19607.54,-10920.5 19818.3,-11056.5"/>
<text text-anchor="middle" x="19303.27" y="-11007.3" font-family="Times,serif" font-size="14.00">Route Back Expert 2</text>
<text text-anchor="middle" x="19303.27" y="-10992.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="19303.27" y="-10977.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19303.27" y="-10962.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_expert2_down&#45;&gt;layer0_route_back_expert2 -->
<g id="edge138" class="edge">
<title>layer0_expert2_down&#45;&gt;layer0_route_back_expert2</title>
<path fill="none" stroke="black" d="M19287.27,-11142.45C19287.27,-11142.45 19287.27,-11066.56 19287.27,-11066.56"/>
<polygon fill="black" stroke="black" points="19290.77,-11066.56 19287.27,-11056.56 19283.77,-11066.56 19290.77,-11066.56"/>
</g>
<!-- layer0_route_back_expert2&#45;&gt;layer0_expert_agg -->
<g id="edge219" class="edge">
<title>layer0_route_back_expert2&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M19238.05,-10920.27C19238.05,-10859.79 19238.05,-10781 19238.05,-10781 19238.05,-10781 14217.62,-10781 14217.62,-10781"/>
<polygon fill="black" stroke="black" points="14217.62,-10777.5 14207.62,-10781 14217.62,-10784.5 14217.62,-10777.5"/>
</g>
<!-- layer0_expert3_up -->
<g id="node114" class="node">
<title>layer0_expert3_up</title>
<polygon fill="lightcoral" stroke="black" points="20402.27,-11518.5 20120.27,-11518.5 20120.27,-11450.5 20402.27,-11450.5 20402.27,-11518.5"/>
<text text-anchor="middle" x="20261.27" y="-11503.3" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="20261.27" y="-11488.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="20261.27" y="-11473.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="20261.27" y="-11458.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_route_expert3&#45;&gt;layer0_expert3_up -->
<g id="edge141" class="edge">
<title>layer0_route_expert3&#45;&gt;layer0_expert3_up</title>
<path fill="none" stroke="black" d="M20261.27,-11604.36C20261.27,-11604.36 20261.27,-11528.67 20261.27,-11528.67"/>
<polygon fill="black" stroke="black" points="20264.77,-11528.67 20261.27,-11518.67 20257.77,-11528.67 20264.77,-11528.67"/>
</g>
<!-- layer0_expert3_activation -->
<g id="node115" class="node">
<title>layer0_expert3_activation</title>
<polygon fill="lightyellow" stroke="black" points="20477.27,-11364.5 20195.27,-11364.5 20195.27,-11296.5 20477.27,-11296.5 20477.27,-11364.5"/>
<text text-anchor="middle" x="20336.27" y="-11349.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="20336.27" y="-11334.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="20336.27" y="-11319.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="20336.27" y="-11304.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_expert3_up&#45;&gt;layer0_expert3_activation -->
<g id="edge142" class="edge">
<title>layer0_expert3_up&#45;&gt;layer0_expert3_activation</title>
<path fill="none" stroke="black" d="M20298.77,-11450.32C20298.77,-11450.32 20298.77,-11374.58 20298.77,-11374.58"/>
<polygon fill="black" stroke="black" points="20302.27,-11374.58 20298.77,-11364.58 20295.27,-11374.58 20302.27,-11374.58"/>
</g>
<!-- layer0_expert3_down -->
<g id="node116" class="node">
<title>layer0_expert3_down</title>
<polygon fill="lightcoral" stroke="black" points="20509.77,-11210.5 20236.77,-11210.5 20236.77,-11142.5 20509.77,-11142.5 20509.77,-11210.5"/>
<text text-anchor="middle" x="20373.27" y="-11195.3" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="20373.27" y="-11180.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="20373.27" y="-11165.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="20373.27" y="-11150.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_expert3_activation&#45;&gt;layer0_expert3_down -->
<g id="edge143" class="edge">
<title>layer0_expert3_activation&#45;&gt;layer0_expert3_down</title>
<path fill="none" stroke="black" d="M20357.02,-11296.32C20357.02,-11296.32 20357.02,-11220.58 20357.02,-11220.58"/>
<polygon fill="black" stroke="black" points="20360.52,-11220.58 20357.02,-11210.58 20353.52,-11220.58 20360.52,-11220.58"/>
</g>
<!-- layer0_route_back_expert3 -->
<g id="node117" class="node">
<title>layer0_route_back_expert3</title>
<polygon fill="lightpink" stroke="black" points="20907.3,-11056.5 20088,-11056.5 19877.23,-10920.5 20696.54,-10920.5 20907.3,-11056.5"/>
<text text-anchor="middle" x="20392.27" y="-11007.3" font-family="Times,serif" font-size="14.00">Route Back Expert 3</text>
<text text-anchor="middle" x="20392.27" y="-10992.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="20392.27" y="-10977.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="20392.27" y="-10962.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer0_expert3_down&#45;&gt;layer0_route_back_expert3 -->
<g id="edge144" class="edge">
<title>layer0_expert3_down&#45;&gt;layer0_route_back_expert3</title>
<path fill="none" stroke="black" d="M20373.27,-11142.45C20373.27,-11142.45 20373.27,-11066.56 20373.27,-11066.56"/>
<polygon fill="black" stroke="black" points="20376.77,-11066.56 20373.27,-11056.56 20369.77,-11066.56 20376.77,-11066.56"/>
</g>
<!-- layer0_route_back_expert3&#45;&gt;layer0_expert_agg -->
<g id="edge220" class="edge">
<title>layer0_route_back_expert3&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M19888.77,-10988.34C19888.77,-10981.72 19888.77,-10770 19888.77,-10770 19888.77,-10770 14198.66,-10770 14198.66,-10770"/>
<polygon fill="black" stroke="black" points="14198.66,-10766.5 14188.66,-10770 14198.66,-10773.5 14198.66,-10766.5"/>
</g>
<!-- layer0_expert4_up -->
<g id="node119" class="node">
<title>layer0_expert4_up</title>
<polygon fill="lightcoral" stroke="black" points="21469.27,-11518.5 21187.27,-11518.5 21187.27,-11450.5 21469.27,-11450.5 21469.27,-11518.5"/>
<text text-anchor="middle" x="21328.27" y="-11503.3" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="21328.27" y="-11488.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="21328.27" y="-11473.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="21328.27" y="-11458.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_route_expert4&#45;&gt;layer0_expert4_up -->
<g id="edge147" class="edge">
<title>layer0_route_expert4&#45;&gt;layer0_expert4_up</title>
<path fill="none" stroke="black" d="M21328.27,-11604.36C21328.27,-11604.36 21328.27,-11528.67 21328.27,-11528.67"/>
<polygon fill="black" stroke="black" points="21331.77,-11528.67 21328.27,-11518.67 21324.77,-11528.67 21331.77,-11528.67"/>
</g>
<!-- layer0_expert4_activation -->
<g id="node120" class="node">
<title>layer0_expert4_activation</title>
<polygon fill="lightyellow" stroke="black" points="21556.27,-11364.5 21274.27,-11364.5 21274.27,-11296.5 21556.27,-11296.5 21556.27,-11364.5"/>
<text text-anchor="middle" x="21415.27" y="-11349.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="21415.27" y="-11334.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="21415.27" y="-11319.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="21415.27" y="-11304.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_expert4_up&#45;&gt;layer0_expert4_activation -->
<g id="edge148" class="edge">
<title>layer0_expert4_up&#45;&gt;layer0_expert4_activation</title>
<path fill="none" stroke="black" d="M21371.77,-11450.32C21371.77,-11450.32 21371.77,-11374.58 21371.77,-11374.58"/>
<polygon fill="black" stroke="black" points="21375.27,-11374.58 21371.77,-11364.58 21368.27,-11374.58 21375.27,-11374.58"/>
</g>
<!-- layer0_expert4_down -->
<g id="node121" class="node">
<title>layer0_expert4_down</title>
<polygon fill="lightcoral" stroke="black" points="21595.77,-11210.5 21322.77,-11210.5 21322.77,-11142.5 21595.77,-11142.5 21595.77,-11210.5"/>
<text text-anchor="middle" x="21459.27" y="-11195.3" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="21459.27" y="-11180.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="21459.27" y="-11165.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="21459.27" y="-11150.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_expert4_activation&#45;&gt;layer0_expert4_down -->
<g id="edge149" class="edge">
<title>layer0_expert4_activation&#45;&gt;layer0_expert4_down</title>
<path fill="none" stroke="black" d="M21439.52,-11296.32C21439.52,-11296.32 21439.52,-11220.58 21439.52,-11220.58"/>
<polygon fill="black" stroke="black" points="21443.02,-11220.58 21439.52,-11210.58 21436.02,-11220.58 21443.02,-11220.58"/>
</g>
<!-- layer0_route_back_expert4 -->
<g id="node122" class="node">
<title>layer0_route_back_expert4</title>
<polygon fill="lightpink" stroke="black" points="21996.3,-11056.5 21177,-11056.5 20966.23,-10920.5 21785.54,-10920.5 21996.3,-11056.5"/>
<text text-anchor="middle" x="21481.27" y="-11007.3" font-family="Times,serif" font-size="14.00">Route Back Expert 4</text>
<text text-anchor="middle" x="21481.27" y="-10992.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="21481.27" y="-10977.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="21481.27" y="-10962.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_expert4_down&#45;&gt;layer0_route_back_expert4 -->
<g id="edge150" class="edge">
<title>layer0_expert4_down&#45;&gt;layer0_route_back_expert4</title>
<path fill="none" stroke="black" d="M21459.27,-11142.45C21459.27,-11142.45 21459.27,-11066.56 21459.27,-11066.56"/>
<polygon fill="black" stroke="black" points="21462.77,-11066.56 21459.27,-11056.56 21455.77,-11066.56 21462.77,-11066.56"/>
</g>
<!-- layer0_route_back_expert4&#45;&gt;layer0_expert_agg -->
<g id="edge221" class="edge">
<title>layer0_route_back_expert4&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M21481.27,-10920.26C21481.27,-10852.61 21481.27,-10759 21481.27,-10759 21481.27,-10759 14157.21,-10759 14157.21,-10759"/>
<polygon fill="black" stroke="black" points="14157.21,-10755.5 14147.21,-10759 14157.21,-10762.5 14157.21,-10755.5"/>
</g>
<!-- layer0_expert5_up -->
<g id="node124" class="node">
<title>layer0_expert5_up</title>
<polygon fill="lightcoral" stroke="black" points="22536.27,-11518.5 22254.27,-11518.5 22254.27,-11450.5 22536.27,-11450.5 22536.27,-11518.5"/>
<text text-anchor="middle" x="22395.27" y="-11503.3" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="22395.27" y="-11488.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="22395.27" y="-11473.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="22395.27" y="-11458.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_route_expert5&#45;&gt;layer0_expert5_up -->
<g id="edge153" class="edge">
<title>layer0_route_expert5&#45;&gt;layer0_expert5_up</title>
<path fill="none" stroke="black" d="M22395.27,-11604.36C22395.27,-11604.36 22395.27,-11528.67 22395.27,-11528.67"/>
<polygon fill="black" stroke="black" points="22398.77,-11528.67 22395.27,-11518.67 22391.77,-11528.67 22398.77,-11528.67"/>
</g>
<!-- layer0_expert5_activation -->
<g id="node125" class="node">
<title>layer0_expert5_activation</title>
<polygon fill="lightyellow" stroke="black" points="22636.27,-11364.5 22354.27,-11364.5 22354.27,-11296.5 22636.27,-11296.5 22636.27,-11364.5"/>
<text text-anchor="middle" x="22495.27" y="-11349.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="22495.27" y="-11334.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="22495.27" y="-11319.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="22495.27" y="-11304.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_expert5_up&#45;&gt;layer0_expert5_activation -->
<g id="edge154" class="edge">
<title>layer0_expert5_up&#45;&gt;layer0_expert5_activation</title>
<path fill="none" stroke="black" d="M22445.27,-11450.32C22445.27,-11450.32 22445.27,-11374.58 22445.27,-11374.58"/>
<polygon fill="black" stroke="black" points="22448.77,-11374.58 22445.27,-11364.58 22441.77,-11374.58 22448.77,-11374.58"/>
</g>
<!-- layer0_expert5_down -->
<g id="node126" class="node">
<title>layer0_expert5_down</title>
<polygon fill="lightcoral" stroke="black" points="22681.77,-11210.5 22408.77,-11210.5 22408.77,-11142.5 22681.77,-11142.5 22681.77,-11210.5"/>
<text text-anchor="middle" x="22545.27" y="-11195.3" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="22545.27" y="-11180.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="22545.27" y="-11165.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="22545.27" y="-11150.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_expert5_activation&#45;&gt;layer0_expert5_down -->
<g id="edge155" class="edge">
<title>layer0_expert5_activation&#45;&gt;layer0_expert5_down</title>
<path fill="none" stroke="black" d="M22522.52,-11296.32C22522.52,-11296.32 22522.52,-11220.58 22522.52,-11220.58"/>
<polygon fill="black" stroke="black" points="22526.02,-11220.58 22522.52,-11210.58 22519.02,-11220.58 22526.02,-11220.58"/>
</g>
<!-- layer0_route_back_expert5 -->
<g id="node127" class="node">
<title>layer0_route_back_expert5</title>
<polygon fill="lightpink" stroke="black" points="23085.3,-11056.5 22266,-11056.5 22055.23,-10920.5 22874.54,-10920.5 23085.3,-11056.5"/>
<text text-anchor="middle" x="22570.27" y="-11007.3" font-family="Times,serif" font-size="14.00">Route Back Expert 5</text>
<text text-anchor="middle" x="22570.27" y="-10992.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="22570.27" y="-10977.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="22570.27" y="-10962.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer0_expert5_down&#45;&gt;layer0_route_back_expert5 -->
<g id="edge156" class="edge">
<title>layer0_expert5_down&#45;&gt;layer0_route_back_expert5</title>
<path fill="none" stroke="black" d="M22545.27,-11142.45C22545.27,-11142.45 22545.27,-11066.56 22545.27,-11066.56"/>
<polygon fill="black" stroke="black" points="22548.77,-11066.56 22545.27,-11056.56 22541.77,-11066.56 22548.77,-11066.56"/>
</g>
<!-- layer0_route_back_expert5&#45;&gt;layer0_expert_agg -->
<g id="edge222" class="edge">
<title>layer0_route_back_expert5&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M22570.27,-10920.19C22570.27,-10849.4 22570.27,-10749 22570.27,-10749 22570.27,-10749 14089.07,-10749 14089.07,-10749"/>
<polygon fill="black" stroke="black" points="14089.07,-10745.5 14079.07,-10749 14089.07,-10752.5 14089.07,-10745.5"/>
</g>
<!-- layer0_expert6_up -->
<g id="node129" class="node">
<title>layer0_expert6_up</title>
<polygon fill="lightcoral" stroke="black" points="6464.27,-11518.5 6182.27,-11518.5 6182.27,-11450.5 6464.27,-11450.5 6464.27,-11518.5"/>
<text text-anchor="middle" x="6323.27" y="-11503.3" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="6323.27" y="-11488.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="6323.27" y="-11473.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="6323.27" y="-11458.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_route_expert6&#45;&gt;layer0_expert6_up -->
<g id="edge159" class="edge">
<title>layer0_route_expert6&#45;&gt;layer0_expert6_up</title>
<path fill="none" stroke="black" d="M6323.27,-11604.36C6323.27,-11604.36 6323.27,-11528.67 6323.27,-11528.67"/>
<polygon fill="black" stroke="black" points="6326.77,-11528.67 6323.27,-11518.67 6319.77,-11528.67 6326.77,-11528.67"/>
</g>
<!-- layer0_expert6_activation -->
<g id="node130" class="node">
<title>layer0_expert6_activation</title>
<polygon fill="lightyellow" stroke="black" points="6442.27,-11364.5 6160.27,-11364.5 6160.27,-11296.5 6442.27,-11296.5 6442.27,-11364.5"/>
<text text-anchor="middle" x="6301.27" y="-11349.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="6301.27" y="-11334.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="6301.27" y="-11319.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="6301.27" y="-11304.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_expert6_up&#45;&gt;layer0_expert6_activation -->
<g id="edge160" class="edge">
<title>layer0_expert6_up&#45;&gt;layer0_expert6_activation</title>
<path fill="none" stroke="black" d="M6312.27,-11450.32C6312.27,-11450.32 6312.27,-11374.58 6312.27,-11374.58"/>
<polygon fill="black" stroke="black" points="6315.77,-11374.58 6312.27,-11364.58 6308.77,-11374.58 6315.77,-11374.58"/>
</g>
<!-- layer0_expert6_down -->
<g id="node131" class="node">
<title>layer0_expert6_down</title>
<polygon fill="lightcoral" stroke="black" points="6415.77,-11210.5 6142.77,-11210.5 6142.77,-11142.5 6415.77,-11142.5 6415.77,-11210.5"/>
<text text-anchor="middle" x="6279.27" y="-11195.3" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="6279.27" y="-11180.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="6279.27" y="-11165.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="6279.27" y="-11150.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_expert6_activation&#45;&gt;layer0_expert6_down -->
<g id="edge161" class="edge">
<title>layer0_expert6_activation&#45;&gt;layer0_expert6_down</title>
<path fill="none" stroke="black" d="M6288.02,-11296.32C6288.02,-11296.32 6288.02,-11220.58 6288.02,-11220.58"/>
<polygon fill="black" stroke="black" points="6291.52,-11220.58 6288.02,-11210.58 6284.52,-11220.58 6291.52,-11220.58"/>
</g>
<!-- layer0_route_back_expert6 -->
<g id="node132" class="node">
<title>layer0_route_back_expert6</title>
<polygon fill="lightpink" stroke="black" points="6750.3,-11056.5 5931,-11056.5 5720.23,-10920.5 6539.54,-10920.5 6750.3,-11056.5"/>
<text text-anchor="middle" x="6235.27" y="-11007.3" font-family="Times,serif" font-size="14.00">Route Back Expert 6</text>
<text text-anchor="middle" x="6235.27" y="-10992.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="6235.27" y="-10977.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6235.27" y="-10962.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_expert6_down&#45;&gt;layer0_route_back_expert6 -->
<g id="edge162" class="edge">
<title>layer0_expert6_down&#45;&gt;layer0_route_back_expert6</title>
<path fill="none" stroke="black" d="M6279.27,-11142.45C6279.27,-11142.45 6279.27,-11066.56 6279.27,-11066.56"/>
<polygon fill="black" stroke="black" points="6282.77,-11066.56 6279.27,-11056.56 6275.77,-11066.56 6282.77,-11066.56"/>
</g>
<!-- layer0_route_back_expert6&#45;&gt;layer0_expert_agg -->
<g id="edge223" class="edge">
<title>layer0_route_back_expert6&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M6586.15,-10950.34C6586.15,-10885.08 6586.15,-10759 6586.15,-10759 6586.15,-10759 13559.27,-10759 13559.27,-10759"/>
<polygon fill="black" stroke="black" points="13559.27,-10762.5 13569.27,-10759 13559.27,-10755.5 13559.27,-10762.5"/>
</g>
<!-- layer0_expert7_up -->
<g id="node134" class="node">
<title>layer0_expert7_up</title>
<polygon fill="lightcoral" stroke="black" points="7596.27,-11518.5 7314.27,-11518.5 7314.27,-11450.5 7596.27,-11450.5 7596.27,-11518.5"/>
<text text-anchor="middle" x="7455.27" y="-11503.3" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="7455.27" y="-11488.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="7455.27" y="-11473.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="7455.27" y="-11458.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_route_expert7&#45;&gt;layer0_expert7_up -->
<g id="edge165" class="edge">
<title>layer0_route_expert7&#45;&gt;layer0_expert7_up</title>
<path fill="none" stroke="black" d="M7455.27,-11604.36C7455.27,-11604.36 7455.27,-11528.67 7455.27,-11528.67"/>
<polygon fill="black" stroke="black" points="7458.77,-11528.67 7455.27,-11518.67 7451.77,-11528.67 7458.77,-11528.67"/>
</g>
<!-- layer0_expert7_activation -->
<g id="node135" class="node">
<title>layer0_expert7_activation</title>
<polygon fill="lightyellow" stroke="black" points="7577.27,-11364.5 7295.27,-11364.5 7295.27,-11296.5 7577.27,-11296.5 7577.27,-11364.5"/>
<text text-anchor="middle" x="7436.27" y="-11349.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7436.27" y="-11334.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="7436.27" y="-11319.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="7436.27" y="-11304.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_expert7_up&#45;&gt;layer0_expert7_activation -->
<g id="edge166" class="edge">
<title>layer0_expert7_up&#45;&gt;layer0_expert7_activation</title>
<path fill="none" stroke="black" d="M7445.77,-11450.32C7445.77,-11450.32 7445.77,-11374.58 7445.77,-11374.58"/>
<polygon fill="black" stroke="black" points="7449.27,-11374.58 7445.77,-11364.58 7442.27,-11374.58 7449.27,-11374.58"/>
</g>
<!-- layer0_expert7_down -->
<g id="node136" class="node">
<title>layer0_expert7_down</title>
<polygon fill="lightcoral" stroke="black" points="7497.77,-11210.5 7224.77,-11210.5 7224.77,-11142.5 7497.77,-11142.5 7497.77,-11210.5"/>
<text text-anchor="middle" x="7361.27" y="-11195.3" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="7361.27" y="-11180.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="7361.27" y="-11165.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="7361.27" y="-11150.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_expert7_activation&#45;&gt;layer0_expert7_down -->
<g id="edge167" class="edge">
<title>layer0_expert7_activation&#45;&gt;layer0_expert7_down</title>
<path fill="none" stroke="black" d="M7396.52,-11296.32C7396.52,-11296.32 7396.52,-11220.58 7396.52,-11220.58"/>
<polygon fill="black" stroke="black" points="7400.02,-11220.58 7396.52,-11210.58 7393.02,-11220.58 7400.02,-11220.58"/>
</g>
<!-- layer0_route_back_expert7 -->
<g id="node137" class="node">
<title>layer0_route_back_expert7</title>
<polygon fill="lightpink" stroke="black" points="7839.3,-11056.5 7020,-11056.5 6809.23,-10920.5 7628.54,-10920.5 7839.3,-11056.5"/>
<text text-anchor="middle" x="7324.27" y="-11007.3" font-family="Times,serif" font-size="14.00">Route Back Expert 7</text>
<text text-anchor="middle" x="7324.27" y="-10992.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="7324.27" y="-10977.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7324.27" y="-10962.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer0_expert7_down&#45;&gt;layer0_route_back_expert7 -->
<g id="edge168" class="edge">
<title>layer0_expert7_down&#45;&gt;layer0_route_back_expert7</title>
<path fill="none" stroke="black" d="M7361.27,-11142.45C7361.27,-11142.45 7361.27,-11066.56 7361.27,-11066.56"/>
<polygon fill="black" stroke="black" points="7364.77,-11066.56 7361.27,-11056.56 7357.77,-11066.56 7364.77,-11066.56"/>
</g>
<!-- layer0_route_back_expert7&#45;&gt;layer0_expert_agg -->
<g id="edge224" class="edge">
<title>layer0_route_back_expert7&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M7828.65,-10988.34C7828.65,-10981.72 7828.65,-10770 7828.65,-10770 7828.65,-10770 13517.92,-10770 13517.92,-10770"/>
<polygon fill="black" stroke="black" points="13517.92,-10773.5 13527.92,-10770 13517.92,-10766.5 13517.92,-10773.5"/>
</g>
<!-- layer0_expert8_up -->
<g id="node139" class="node">
<title>layer0_expert8_up</title>
<polygon fill="lightcoral" stroke="black" points="8663.27,-11518.5 8381.27,-11518.5 8381.27,-11450.5 8663.27,-11450.5 8663.27,-11518.5"/>
<text text-anchor="middle" x="8522.27" y="-11503.3" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="8522.27" y="-11488.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="8522.27" y="-11473.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="8522.27" y="-11458.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_route_expert8&#45;&gt;layer0_expert8_up -->
<g id="edge171" class="edge">
<title>layer0_route_expert8&#45;&gt;layer0_expert8_up</title>
<path fill="none" stroke="black" d="M8522.27,-11604.36C8522.27,-11604.36 8522.27,-11528.67 8522.27,-11528.67"/>
<polygon fill="black" stroke="black" points="8525.77,-11528.67 8522.27,-11518.67 8518.77,-11528.67 8525.77,-11528.67"/>
</g>
<!-- layer0_expert8_activation -->
<g id="node140" class="node">
<title>layer0_expert8_activation</title>
<polygon fill="lightyellow" stroke="black" points="8647.27,-11364.5 8365.27,-11364.5 8365.27,-11296.5 8647.27,-11296.5 8647.27,-11364.5"/>
<text text-anchor="middle" x="8506.27" y="-11349.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="8506.27" y="-11334.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="8506.27" y="-11319.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="8506.27" y="-11304.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_expert8_up&#45;&gt;layer0_expert8_activation -->
<g id="edge172" class="edge">
<title>layer0_expert8_up&#45;&gt;layer0_expert8_activation</title>
<path fill="none" stroke="black" d="M8514.27,-11450.32C8514.27,-11450.32 8514.27,-11374.58 8514.27,-11374.58"/>
<polygon fill="black" stroke="black" points="8517.77,-11374.58 8514.27,-11364.58 8510.77,-11374.58 8517.77,-11374.58"/>
</g>
<!-- layer0_expert8_down -->
<g id="node141" class="node">
<title>layer0_expert8_down</title>
<polygon fill="lightcoral" stroke="black" points="8580.77,-11210.5 8307.77,-11210.5 8307.77,-11142.5 8580.77,-11142.5 8580.77,-11210.5"/>
<text text-anchor="middle" x="8444.27" y="-11195.3" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="8444.27" y="-11180.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="8444.27" y="-11165.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="8444.27" y="-11150.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_expert8_activation&#45;&gt;layer0_expert8_down -->
<g id="edge173" class="edge">
<title>layer0_expert8_activation&#45;&gt;layer0_expert8_down</title>
<path fill="none" stroke="black" d="M8473.02,-11296.32C8473.02,-11296.32 8473.02,-11220.58 8473.02,-11220.58"/>
<polygon fill="black" stroke="black" points="8476.52,-11220.58 8473.02,-11210.58 8469.52,-11220.58 8476.52,-11220.58"/>
</g>
<!-- layer0_route_back_expert8 -->
<g id="node142" class="node">
<title>layer0_route_back_expert8</title>
<polygon fill="lightpink" stroke="black" points="8928.3,-11056.5 8109,-11056.5 7898.23,-10920.5 8717.54,-10920.5 8928.3,-11056.5"/>
<text text-anchor="middle" x="8413.27" y="-11007.3" font-family="Times,serif" font-size="14.00">Route Back Expert 8</text>
<text text-anchor="middle" x="8413.27" y="-10992.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="8413.27" y="-10977.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8413.27" y="-10962.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_expert8_down&#45;&gt;layer0_route_back_expert8 -->
<g id="edge174" class="edge">
<title>layer0_expert8_down&#45;&gt;layer0_route_back_expert8</title>
<path fill="none" stroke="black" d="M8444.27,-11142.45C8444.27,-11142.45 8444.27,-11066.56 8444.27,-11066.56"/>
<polygon fill="black" stroke="black" points="8447.77,-11066.56 8444.27,-11056.56 8440.77,-11066.56 8447.77,-11066.56"/>
</g>
<!-- layer0_route_back_expert8&#45;&gt;layer0_expert_agg -->
<g id="edge225" class="edge">
<title>layer0_route_back_expert8&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M8903.15,-10988.35C8903.15,-10982.06 8903.15,-10781 8903.15,-10781 8903.15,-10781 13498.85,-10781 13498.85,-10781"/>
<polygon fill="black" stroke="black" points="13498.85,-10784.5 13508.85,-10781 13498.85,-10777.5 13498.85,-10784.5"/>
</g>
<!-- layer0_expert9_up -->
<g id="node144" class="node">
<title>layer0_expert9_up</title>
<polygon fill="lightcoral" stroke="black" points="9693.27,-11518.5 9411.27,-11518.5 9411.27,-11450.5 9693.27,-11450.5 9693.27,-11518.5"/>
<text text-anchor="middle" x="9552.27" y="-11503.3" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="9552.27" y="-11488.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="9552.27" y="-11473.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="9552.27" y="-11458.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_route_expert9&#45;&gt;layer0_expert9_up -->
<g id="edge177" class="edge">
<title>layer0_route_expert9&#45;&gt;layer0_expert9_up</title>
<path fill="none" stroke="black" d="M9552.27,-11604.36C9552.27,-11604.36 9552.27,-11528.67 9552.27,-11528.67"/>
<polygon fill="black" stroke="black" points="9555.77,-11528.67 9552.27,-11518.67 9548.77,-11528.67 9555.77,-11528.67"/>
</g>
<!-- layer0_expert9_activation -->
<g id="node145" class="node">
<title>layer0_expert9_activation</title>
<polygon fill="lightyellow" stroke="black" points="9681.27,-11364.5 9399.27,-11364.5 9399.27,-11296.5 9681.27,-11296.5 9681.27,-11364.5"/>
<text text-anchor="middle" x="9540.27" y="-11349.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="9540.27" y="-11334.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="9540.27" y="-11319.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="9540.27" y="-11304.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_expert9_up&#45;&gt;layer0_expert9_activation -->
<g id="edge178" class="edge">
<title>layer0_expert9_up&#45;&gt;layer0_expert9_activation</title>
<path fill="none" stroke="black" d="M9546.27,-11450.32C9546.27,-11450.32 9546.27,-11374.58 9546.27,-11374.58"/>
<polygon fill="black" stroke="black" points="9549.77,-11374.58 9546.27,-11364.58 9542.77,-11374.58 9549.77,-11374.58"/>
</g>
<!-- layer0_expert9_down -->
<g id="node146" class="node">
<title>layer0_expert9_down</title>
<polygon fill="lightcoral" stroke="black" points="9663.77,-11210.5 9390.77,-11210.5 9390.77,-11142.5 9663.77,-11142.5 9663.77,-11210.5"/>
<text text-anchor="middle" x="9527.27" y="-11195.3" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="9527.27" y="-11180.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="9527.27" y="-11165.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="9527.27" y="-11150.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_expert9_activation&#45;&gt;layer0_expert9_down -->
<g id="edge179" class="edge">
<title>layer0_expert9_activation&#45;&gt;layer0_expert9_down</title>
<path fill="none" stroke="black" d="M9531.52,-11296.32C9531.52,-11296.32 9531.52,-11220.58 9531.52,-11220.58"/>
<polygon fill="black" stroke="black" points="9535.02,-11220.58 9531.52,-11210.58 9528.02,-11220.58 9535.02,-11220.58"/>
</g>
<!-- layer0_route_back_expert9 -->
<g id="node147" class="node">
<title>layer0_route_back_expert9</title>
<polygon fill="lightpink" stroke="black" points="10017.3,-11056.5 9198,-11056.5 8987.23,-10920.5 9806.54,-10920.5 10017.3,-11056.5"/>
<text text-anchor="middle" x="9502.27" y="-11007.3" font-family="Times,serif" font-size="14.00">Route Back Expert 9</text>
<text text-anchor="middle" x="9502.27" y="-10992.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="9502.27" y="-10977.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9502.27" y="-10962.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer0_expert9_down&#45;&gt;layer0_route_back_expert9 -->
<g id="edge180" class="edge">
<title>layer0_expert9_down&#45;&gt;layer0_route_back_expert9</title>
<path fill="none" stroke="black" d="M9527.27,-11142.45C9527.27,-11142.45 9527.27,-11066.56 9527.27,-11066.56"/>
<polygon fill="black" stroke="black" points="9530.77,-11066.56 9527.27,-11056.56 9523.77,-11066.56 9530.77,-11066.56"/>
</g>
<!-- layer0_route_back_expert9&#45;&gt;layer0_expert_agg -->
<g id="edge226" class="edge">
<title>layer0_route_back_expert9&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M9558.25,-10920.25C9558.25,-10863.17 9558.25,-10791 9558.25,-10791 9558.25,-10791 13498.2,-10791 13498.2,-10791"/>
<polygon fill="black" stroke="black" points="13498.2,-10794.5 13508.2,-10791 13498.2,-10787.5 13498.2,-10794.5"/>
</g>
<!-- layer0_expert10_up -->
<g id="node149" class="node">
<title>layer0_expert10_up</title>
<polygon fill="lightcoral" stroke="black" points="10770.27,-11518.5 10488.27,-11518.5 10488.27,-11450.5 10770.27,-11450.5 10770.27,-11518.5"/>
<text text-anchor="middle" x="10629.27" y="-11503.3" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="10629.27" y="-11488.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="10629.27" y="-11473.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="10629.27" y="-11458.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_route_expert10&#45;&gt;layer0_expert10_up -->
<g id="edge183" class="edge">
<title>layer0_route_expert10&#45;&gt;layer0_expert10_up</title>
<path fill="none" stroke="black" d="M10629.27,-11604.36C10629.27,-11604.36 10629.27,-11528.67 10629.27,-11528.67"/>
<polygon fill="black" stroke="black" points="10632.77,-11528.67 10629.27,-11518.67 10625.77,-11528.67 10632.77,-11528.67"/>
</g>
<!-- layer0_expert10_activation -->
<g id="node150" class="node">
<title>layer0_expert10_activation</title>
<polygon fill="lightyellow" stroke="black" points="10760.27,-11364.5 10478.27,-11364.5 10478.27,-11296.5 10760.27,-11296.5 10760.27,-11364.5"/>
<text text-anchor="middle" x="10619.27" y="-11349.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="10619.27" y="-11334.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="10619.27" y="-11319.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="10619.27" y="-11304.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_expert10_up&#45;&gt;layer0_expert10_activation -->
<g id="edge184" class="edge">
<title>layer0_expert10_up&#45;&gt;layer0_expert10_activation</title>
<path fill="none" stroke="black" d="M10624.27,-11450.32C10624.27,-11450.32 10624.27,-11374.58 10624.27,-11374.58"/>
<polygon fill="black" stroke="black" points="10627.77,-11374.58 10624.27,-11364.58 10620.77,-11374.58 10627.77,-11374.58"/>
</g>
<!-- layer0_expert10_down -->
<g id="node151" class="node">
<title>layer0_expert10_down</title>
<polygon fill="lightcoral" stroke="black" points="10736.77,-11210.5 10463.77,-11210.5 10463.77,-11142.5 10736.77,-11142.5 10736.77,-11210.5"/>
<text text-anchor="middle" x="10600.27" y="-11195.3" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="10600.27" y="-11180.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="10600.27" y="-11165.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="10600.27" y="-11150.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_expert10_activation&#45;&gt;layer0_expert10_down -->
<g id="edge185" class="edge">
<title>layer0_expert10_activation&#45;&gt;layer0_expert10_down</title>
<path fill="none" stroke="black" d="M10607.52,-11296.32C10607.52,-11296.32 10607.52,-11220.58 10607.52,-11220.58"/>
<polygon fill="black" stroke="black" points="10611.02,-11220.58 10607.52,-11210.58 10604.02,-11220.58 10611.02,-11220.58"/>
</g>
<!-- layer0_route_back_expert10 -->
<g id="node152" class="node">
<title>layer0_route_back_expert10</title>
<polygon fill="lightpink" stroke="black" points="11106.3,-11056.5 10287,-11056.5 10076.23,-10920.5 10895.54,-10920.5 11106.3,-11056.5"/>
<text text-anchor="middle" x="10591.27" y="-11007.3" font-family="Times,serif" font-size="14.00">Route Back Expert 10</text>
<text text-anchor="middle" x="10591.27" y="-10992.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="10591.27" y="-10977.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10591.27" y="-10962.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_expert10_down&#45;&gt;layer0_route_back_expert10 -->
<g id="edge186" class="edge">
<title>layer0_expert10_down&#45;&gt;layer0_route_back_expert10</title>
<path fill="none" stroke="black" d="M10600.27,-11142.45C10600.27,-11142.45 10600.27,-11066.56 10600.27,-11066.56"/>
<polygon fill="black" stroke="black" points="10603.77,-11066.56 10600.27,-11056.56 10596.77,-11066.56 10603.77,-11066.56"/>
</g>
<!-- layer0_route_back_expert10&#45;&gt;layer0_expert_agg -->
<g id="edge227" class="edge">
<title>layer0_route_back_expert10&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M10964.69,-10964.88C10964.69,-10914.69 10964.69,-10802 10964.69,-10802 10964.69,-10802 13515.63,-10802 13515.63,-10802"/>
<polygon fill="black" stroke="black" points="13515.63,-10805.5 13525.63,-10802 13515.63,-10798.5 13515.63,-10805.5"/>
</g>
<!-- layer0_expert11_up -->
<g id="node154" class="node">
<title>layer0_expert11_up</title>
<polygon fill="lightcoral" stroke="black" points="11864.27,-11518.5 11582.27,-11518.5 11582.27,-11450.5 11864.27,-11450.5 11864.27,-11518.5"/>
<text text-anchor="middle" x="11723.27" y="-11503.3" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="11723.27" y="-11488.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="11723.27" y="-11473.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="11723.27" y="-11458.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_route_expert11&#45;&gt;layer0_expert11_up -->
<g id="edge189" class="edge">
<title>layer0_route_expert11&#45;&gt;layer0_expert11_up</title>
<path fill="none" stroke="black" d="M11723.27,-11604.36C11723.27,-11604.36 11723.27,-11528.67 11723.27,-11528.67"/>
<polygon fill="black" stroke="black" points="11726.77,-11528.67 11723.27,-11518.67 11719.77,-11528.67 11726.77,-11528.67"/>
</g>
<!-- layer0_expert11_activation -->
<g id="node155" class="node">
<title>layer0_expert11_activation</title>
<polygon fill="lightyellow" stroke="black" points="11858.27,-11364.5 11576.27,-11364.5 11576.27,-11296.5 11858.27,-11296.5 11858.27,-11364.5"/>
<text text-anchor="middle" x="11717.27" y="-11349.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="11717.27" y="-11334.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="11717.27" y="-11319.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="11717.27" y="-11304.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_expert11_up&#45;&gt;layer0_expert11_activation -->
<g id="edge190" class="edge">
<title>layer0_expert11_up&#45;&gt;layer0_expert11_activation</title>
<path fill="none" stroke="black" d="M11720.27,-11450.32C11720.27,-11450.32 11720.27,-11374.58 11720.27,-11374.58"/>
<polygon fill="black" stroke="black" points="11723.77,-11374.58 11720.27,-11364.58 11716.77,-11374.58 11723.77,-11374.58"/>
</g>
<!-- layer0_expert11_down -->
<g id="node156" class="node">
<title>layer0_expert11_down</title>
<polygon fill="lightcoral" stroke="black" points="11828.77,-11210.5 11555.77,-11210.5 11555.77,-11142.5 11828.77,-11142.5 11828.77,-11210.5"/>
<text text-anchor="middle" x="11692.27" y="-11195.3" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="11692.27" y="-11180.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="11692.27" y="-11165.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="11692.27" y="-11150.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_expert11_activation&#45;&gt;layer0_expert11_down -->
<g id="edge191" class="edge">
<title>layer0_expert11_activation&#45;&gt;layer0_expert11_down</title>
<path fill="none" stroke="black" d="M11702.52,-11296.32C11702.52,-11296.32 11702.52,-11220.58 11702.52,-11220.58"/>
<polygon fill="black" stroke="black" points="11706.02,-11220.58 11702.52,-11210.58 11699.02,-11220.58 11706.02,-11220.58"/>
</g>
<!-- layer0_route_back_expert11 -->
<g id="node157" class="node">
<title>layer0_route_back_expert11</title>
<polygon fill="lightpink" stroke="black" points="12195.3,-11056.5 11376,-11056.5 11165.23,-10920.5 11984.54,-10920.5 12195.3,-11056.5"/>
<text text-anchor="middle" x="11680.27" y="-11007.3" font-family="Times,serif" font-size="14.00">Route Back Expert 11</text>
<text text-anchor="middle" x="11680.27" y="-10992.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="11680.27" y="-10977.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11680.27" y="-10962.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer0_expert11_down&#45;&gt;layer0_route_back_expert11 -->
<g id="edge192" class="edge">
<title>layer0_expert11_down&#45;&gt;layer0_route_back_expert11</title>
<path fill="none" stroke="black" d="M11692.27,-11142.45C11692.27,-11142.45 11692.27,-11066.56 11692.27,-11066.56"/>
<polygon fill="black" stroke="black" points="11695.77,-11066.56 11692.27,-11056.56 11688.77,-11066.56 11695.77,-11066.56"/>
</g>
<!-- layer0_route_back_expert11&#45;&gt;layer0_expert_agg -->
<g id="edge228" class="edge">
<title>layer0_route_back_expert11&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M11885.69,-10920.39C11885.69,-10871.06 11885.69,-10813 11885.69,-10813 11885.69,-10813 13555.35,-10813 13555.35,-10813"/>
<polygon fill="black" stroke="black" points="13555.35,-10816.5 13565.35,-10813 13555.35,-10809.5 13555.35,-10816.5"/>
</g>
<!-- layer0_expert12_up -->
<g id="node159" class="node">
<title>layer0_expert12_up</title>
<polygon fill="lightcoral" stroke="black" points="12923.27,-11518.5 12641.27,-11518.5 12641.27,-11450.5 12923.27,-11450.5 12923.27,-11518.5"/>
<text text-anchor="middle" x="12782.27" y="-11503.3" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="12782.27" y="-11488.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="12782.27" y="-11473.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="12782.27" y="-11458.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_route_expert12&#45;&gt;layer0_expert12_up -->
<g id="edge195" class="edge">
<title>layer0_route_expert12&#45;&gt;layer0_expert12_up</title>
<path fill="none" stroke="black" d="M12782.27,-11604.36C12782.27,-11604.36 12782.27,-11528.67 12782.27,-11528.67"/>
<polygon fill="black" stroke="black" points="12785.77,-11528.67 12782.27,-11518.67 12778.77,-11528.67 12785.77,-11528.67"/>
</g>
<!-- layer0_expert12_activation -->
<g id="node160" class="node">
<title>layer0_expert12_activation</title>
<polygon fill="lightyellow" stroke="black" points="12920.27,-11364.5 12638.27,-11364.5 12638.27,-11296.5 12920.27,-11296.5 12920.27,-11364.5"/>
<text text-anchor="middle" x="12779.27" y="-11349.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="12779.27" y="-11334.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="12779.27" y="-11319.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="12779.27" y="-11304.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_expert12_up&#45;&gt;layer0_expert12_activation -->
<g id="edge196" class="edge">
<title>layer0_expert12_up&#45;&gt;layer0_expert12_activation</title>
<path fill="none" stroke="black" d="M12780.77,-11450.32C12780.77,-11450.32 12780.77,-11374.58 12780.77,-11374.58"/>
<polygon fill="black" stroke="black" points="12784.27,-11374.58 12780.77,-11364.58 12777.27,-11374.58 12784.27,-11374.58"/>
</g>
<!-- layer0_expert12_down -->
<g id="node161" class="node">
<title>layer0_expert12_down</title>
<polygon fill="lightcoral" stroke="black" points="12911.77,-11210.5 12638.77,-11210.5 12638.77,-11142.5 12911.77,-11142.5 12911.77,-11210.5"/>
<text text-anchor="middle" x="12775.27" y="-11195.3" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="12775.27" y="-11180.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="12775.27" y="-11165.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="12775.27" y="-11150.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_expert12_activation&#45;&gt;layer0_expert12_down -->
<g id="edge197" class="edge">
<title>layer0_expert12_activation&#45;&gt;layer0_expert12_down</title>
<path fill="none" stroke="black" d="M12775.27,-11296.32C12775.27,-11296.32 12775.27,-11220.58 12775.27,-11220.58"/>
<polygon fill="black" stroke="black" points="12778.77,-11220.58 12775.27,-11210.58 12771.77,-11220.58 12778.77,-11220.58"/>
</g>
<!-- layer0_route_back_expert12 -->
<g id="node162" class="node">
<title>layer0_route_back_expert12</title>
<polygon fill="lightpink" stroke="black" points="13284.3,-11056.5 12465,-11056.5 12254.23,-10920.5 13073.54,-10920.5 13284.3,-11056.5"/>
<text text-anchor="middle" x="12769.27" y="-11007.3" font-family="Times,serif" font-size="14.00">Route Back Expert 12</text>
<text text-anchor="middle" x="12769.27" y="-10992.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="12769.27" y="-10977.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12769.27" y="-10962.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_expert12_down&#45;&gt;layer0_route_back_expert12 -->
<g id="edge198" class="edge">
<title>layer0_expert12_down&#45;&gt;layer0_route_back_expert12</title>
<path fill="none" stroke="black" d="M12775.27,-11142.45C12775.27,-11142.45 12775.27,-11066.56 12775.27,-11066.56"/>
<polygon fill="black" stroke="black" points="12778.77,-11066.56 12775.27,-11056.56 12771.77,-11066.56 12778.77,-11066.56"/>
</g>
<!-- layer0_route_back_expert12&#45;&gt;layer0_expert_agg -->
<g id="edge229" class="edge">
<title>layer0_route_back_expert12&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M13176.65,-10986.64C13176.65,-10968.46 13176.65,-10823 13176.65,-10823 13176.65,-10823 13619.88,-10823 13619.88,-10823"/>
<polygon fill="black" stroke="black" points="13619.88,-10826.5 13629.88,-10823 13619.88,-10819.5 13619.88,-10826.5"/>
</g>
<!-- layer0_expert13_up -->
<g id="node164" class="node">
<title>layer0_expert13_up</title>
<polygon fill="lightcoral" stroke="black" points="13999.27,-11518.5 13717.27,-11518.5 13717.27,-11450.5 13999.27,-11450.5 13999.27,-11518.5"/>
<text text-anchor="middle" x="13858.27" y="-11503.3" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="13858.27" y="-11488.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="13858.27" y="-11473.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="13858.27" y="-11458.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_route_expert13&#45;&gt;layer0_expert13_up -->
<g id="edge201" class="edge">
<title>layer0_route_expert13&#45;&gt;layer0_expert13_up</title>
<path fill="none" stroke="black" d="M13858.27,-11604.36C13858.27,-11604.36 13858.27,-11528.67 13858.27,-11528.67"/>
<polygon fill="black" stroke="black" points="13861.77,-11528.67 13858.27,-11518.67 13854.77,-11528.67 13861.77,-11528.67"/>
</g>
<!-- layer0_expert13_activation -->
<g id="node165" class="node">
<title>layer0_expert13_activation</title>
<polygon fill="lightyellow" stroke="black" points="13999.27,-11364.5 13717.27,-11364.5 13717.27,-11296.5 13999.27,-11296.5 13999.27,-11364.5"/>
<text text-anchor="middle" x="13858.27" y="-11349.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="13858.27" y="-11334.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="13858.27" y="-11319.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="13858.27" y="-11304.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_expert13_up&#45;&gt;layer0_expert13_activation -->
<g id="edge202" class="edge">
<title>layer0_expert13_up&#45;&gt;layer0_expert13_activation</title>
<path fill="none" stroke="black" d="M13858.27,-11450.32C13858.27,-11450.32 13858.27,-11374.58 13858.27,-11374.58"/>
<polygon fill="black" stroke="black" points="13861.77,-11374.58 13858.27,-11364.58 13854.77,-11374.58 13861.77,-11374.58"/>
</g>
<!-- layer0_expert13_down -->
<g id="node166" class="node">
<title>layer0_expert13_down</title>
<polygon fill="lightcoral" stroke="black" points="13994.77,-11210.5 13721.77,-11210.5 13721.77,-11142.5 13994.77,-11142.5 13994.77,-11210.5"/>
<text text-anchor="middle" x="13858.27" y="-11195.3" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="13858.27" y="-11180.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="13858.27" y="-11165.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="13858.27" y="-11150.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_expert13_activation&#45;&gt;layer0_expert13_down -->
<g id="edge203" class="edge">
<title>layer0_expert13_activation&#45;&gt;layer0_expert13_down</title>
<path fill="none" stroke="black" d="M13858.27,-11296.32C13858.27,-11296.32 13858.27,-11220.58 13858.27,-11220.58"/>
<polygon fill="black" stroke="black" points="13861.77,-11220.58 13858.27,-11210.58 13854.77,-11220.58 13861.77,-11220.58"/>
</g>
<!-- layer0_route_back_expert13 -->
<g id="node167" class="node">
<title>layer0_route_back_expert13</title>
<polygon fill="lightpink" stroke="black" points="14373.3,-11056.5 13554,-11056.5 13343.23,-10920.5 14162.54,-10920.5 14373.3,-11056.5"/>
<text text-anchor="middle" x="13858.27" y="-11007.3" font-family="Times,serif" font-size="14.00">Route Back Expert 13</text>
<text text-anchor="middle" x="13858.27" y="-10992.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="13858.27" y="-10977.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13858.27" y="-10962.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer0_expert13_down&#45;&gt;layer0_route_back_expert13 -->
<g id="edge204" class="edge">
<title>layer0_expert13_down&#45;&gt;layer0_route_back_expert13</title>
<path fill="none" stroke="black" d="M13858.27,-11142.45C13858.27,-11142.45 13858.27,-11066.56 13858.27,-11066.56"/>
<polygon fill="black" stroke="black" points="13861.77,-11066.56 13858.27,-11056.56 13854.77,-11066.56 13861.77,-11066.56"/>
</g>
<!-- layer0_route_back_expert13&#45;&gt;layer0_expert_agg -->
<g id="edge230" class="edge">
<title>layer0_route_back_expert13&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M13858.27,-10920.36C13858.27,-10920.36 13858.27,-10844.8 13858.27,-10844.8"/>
<polygon fill="black" stroke="black" points="13861.77,-10844.8 13858.27,-10834.8 13854.77,-10844.8 13861.77,-10844.8"/>
</g>
<!-- layer0_expert14_up -->
<g id="node169" class="node">
<title>layer0_expert14_up</title>
<polygon fill="lightcoral" stroke="black" points="15067.27,-11518.5 14785.27,-11518.5 14785.27,-11450.5 15067.27,-11450.5 15067.27,-11518.5"/>
<text text-anchor="middle" x="14926.27" y="-11503.3" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="14926.27" y="-11488.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="14926.27" y="-11473.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="14926.27" y="-11458.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_route_expert14&#45;&gt;layer0_expert14_up -->
<g id="edge207" class="edge">
<title>layer0_route_expert14&#45;&gt;layer0_expert14_up</title>
<path fill="none" stroke="black" d="M14926.27,-11604.36C14926.27,-11604.36 14926.27,-11528.67 14926.27,-11528.67"/>
<polygon fill="black" stroke="black" points="14929.77,-11528.67 14926.27,-11518.67 14922.77,-11528.67 14929.77,-11528.67"/>
</g>
<!-- layer0_expert14_activation -->
<g id="node170" class="node">
<title>layer0_expert14_activation</title>
<polygon fill="lightyellow" stroke="black" points="15079.27,-11364.5 14797.27,-11364.5 14797.27,-11296.5 15079.27,-11296.5 15079.27,-11364.5"/>
<text text-anchor="middle" x="14938.27" y="-11349.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14938.27" y="-11334.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="14938.27" y="-11319.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="14938.27" y="-11304.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_expert14_up&#45;&gt;layer0_expert14_activation -->
<g id="edge208" class="edge">
<title>layer0_expert14_up&#45;&gt;layer0_expert14_activation</title>
<path fill="none" stroke="black" d="M14932.27,-11450.32C14932.27,-11450.32 14932.27,-11374.58 14932.27,-11374.58"/>
<polygon fill="black" stroke="black" points="14935.77,-11374.58 14932.27,-11364.58 14928.77,-11374.58 14935.77,-11374.58"/>
</g>
<!-- layer0_expert14_down -->
<g id="node171" class="node">
<title>layer0_expert14_down</title>
<polygon fill="lightcoral" stroke="black" points="15080.77,-11210.5 14807.77,-11210.5 14807.77,-11142.5 15080.77,-11142.5 15080.77,-11210.5"/>
<text text-anchor="middle" x="14944.27" y="-11195.3" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="14944.27" y="-11180.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="14944.27" y="-11165.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="14944.27" y="-11150.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_expert14_activation&#45;&gt;layer0_expert14_down -->
<g id="edge209" class="edge">
<title>layer0_expert14_activation&#45;&gt;layer0_expert14_down</title>
<path fill="none" stroke="black" d="M14943.52,-11296.32C14943.52,-11296.32 14943.52,-11220.58 14943.52,-11220.58"/>
<polygon fill="black" stroke="black" points="14947.02,-11220.58 14943.52,-11210.58 14940.02,-11220.58 14947.02,-11220.58"/>
</g>
<!-- layer0_route_back_expert14 -->
<g id="node172" class="node">
<title>layer0_route_back_expert14</title>
<polygon fill="lightpink" stroke="black" points="15462.3,-11056.5 14643,-11056.5 14432.23,-10920.5 15251.54,-10920.5 15462.3,-11056.5"/>
<text text-anchor="middle" x="14947.27" y="-11007.3" font-family="Times,serif" font-size="14.00">Route Back Expert 14</text>
<text text-anchor="middle" x="14947.27" y="-10992.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="14947.27" y="-10977.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14947.27" y="-10962.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_expert14_down&#45;&gt;layer0_route_back_expert14 -->
<g id="edge210" class="edge">
<title>layer0_expert14_down&#45;&gt;layer0_route_back_expert14</title>
<path fill="none" stroke="black" d="M14944.27,-11142.45C14944.27,-11142.45 14944.27,-11066.56 14944.27,-11066.56"/>
<polygon fill="black" stroke="black" points="14947.77,-11066.56 14944.27,-11056.56 14940.77,-11066.56 14947.77,-11066.56"/>
</g>
<!-- layer0_route_back_expert14&#45;&gt;layer0_expert_agg -->
<g id="edge231" class="edge">
<title>layer0_route_back_expert14&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M14588.88,-10920.23C14588.88,-10874.64 14588.88,-10823 14588.88,-10823 14588.88,-10823 14096.43,-10823 14096.43,-10823"/>
<polygon fill="black" stroke="black" points="14096.43,-10819.5 14086.43,-10823 14096.43,-10826.5 14096.43,-10819.5"/>
</g>
<!-- layer0_expert15_up -->
<g id="node174" class="node">
<title>layer0_expert15_up</title>
<polygon fill="lightcoral" stroke="black" points="16133.27,-11518.5 15851.27,-11518.5 15851.27,-11450.5 16133.27,-11450.5 16133.27,-11518.5"/>
<text text-anchor="middle" x="15992.27" y="-11503.3" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="15992.27" y="-11488.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="15992.27" y="-11473.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="15992.27" y="-11458.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_route_expert15&#45;&gt;layer0_expert15_up -->
<g id="edge213" class="edge">
<title>layer0_route_expert15&#45;&gt;layer0_expert15_up</title>
<path fill="none" stroke="black" d="M15992.27,-11604.36C15992.27,-11604.36 15992.27,-11528.67 15992.27,-11528.67"/>
<polygon fill="black" stroke="black" points="15995.77,-11528.67 15992.27,-11518.67 15988.77,-11528.67 15995.77,-11528.67"/>
</g>
<!-- layer0_expert15_activation -->
<g id="node175" class="node">
<title>layer0_expert15_activation</title>
<polygon fill="lightyellow" stroke="black" points="16158.27,-11364.5 15876.27,-11364.5 15876.27,-11296.5 16158.27,-11296.5 16158.27,-11364.5"/>
<text text-anchor="middle" x="16017.27" y="-11349.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16017.27" y="-11334.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="16017.27" y="-11319.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="16017.27" y="-11304.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_expert15_up&#45;&gt;layer0_expert15_activation -->
<g id="edge214" class="edge">
<title>layer0_expert15_up&#45;&gt;layer0_expert15_activation</title>
<path fill="none" stroke="black" d="M16004.77,-11450.32C16004.77,-11450.32 16004.77,-11374.58 16004.77,-11374.58"/>
<polygon fill="black" stroke="black" points="16008.27,-11374.58 16004.77,-11364.58 16001.27,-11374.58 16008.27,-11374.58"/>
</g>
<!-- layer0_expert15_down -->
<g id="node176" class="node">
<title>layer0_expert15_down</title>
<polygon fill="lightcoral" stroke="black" points="16165.77,-11210.5 15892.77,-11210.5 15892.77,-11142.5 16165.77,-11142.5 16165.77,-11210.5"/>
<text text-anchor="middle" x="16029.27" y="-11195.3" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="16029.27" y="-11180.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="16029.27" y="-11165.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="16029.27" y="-11150.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_expert15_activation&#45;&gt;layer0_expert15_down -->
<g id="edge215" class="edge">
<title>layer0_expert15_activation&#45;&gt;layer0_expert15_down</title>
<path fill="none" stroke="black" d="M16025.52,-11296.32C16025.52,-11296.32 16025.52,-11220.58 16025.52,-11220.58"/>
<polygon fill="black" stroke="black" points="16029.02,-11220.58 16025.52,-11210.58 16022.02,-11220.58 16029.02,-11220.58"/>
</g>
<!-- layer0_route_back_expert15 -->
<g id="node177" class="node">
<title>layer0_route_back_expert15</title>
<polygon fill="lightpink" stroke="black" points="16551.3,-11056.5 15732,-11056.5 15521.23,-10920.5 16340.54,-10920.5 16551.3,-11056.5"/>
<text text-anchor="middle" x="16036.27" y="-11007.3" font-family="Times,serif" font-size="14.00">Route Back Expert 15</text>
<text text-anchor="middle" x="16036.27" y="-10992.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="16036.27" y="-10977.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16036.27" y="-10962.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer0_expert15_down&#45;&gt;layer0_route_back_expert15 -->
<g id="edge216" class="edge">
<title>layer0_expert15_down&#45;&gt;layer0_route_back_expert15</title>
<path fill="none" stroke="black" d="M16029.27,-11142.45C16029.27,-11142.45 16029.27,-11066.56 16029.27,-11066.56"/>
<polygon fill="black" stroke="black" points="16032.77,-11066.56 16029.27,-11056.56 16025.77,-11066.56 16032.77,-11066.56"/>
</g>
<!-- layer0_route_back_expert15&#45;&gt;layer0_expert_agg -->
<g id="edge232" class="edge">
<title>layer0_route_back_expert15&#45;&gt;layer0_expert_agg</title>
<path fill="none" stroke="black" d="M15553.38,-10988.37C15553.38,-10983.05 15553.38,-10813 15553.38,-10813 15553.38,-10813 14161.11,-10813 14161.11,-10813"/>
<polygon fill="black" stroke="black" points="14161.11,-10809.5 14151.11,-10813 14161.11,-10816.5 14161.11,-10809.5"/>
</g>
<!-- layer0_expert_agg&#45;&gt;layer0_final_residual -->
<g id="edge234" class="edge">
<title>layer0_expert_agg&#45;&gt;layer0_final_residual</title>
<path fill="none" stroke="black" d="M13637.33,-10749C12850.82,-10749 10233.78,-10749 10233.78,-10749 10233.78,-10749 10233.78,-10646.01 10233.78,-10646.01"/>
<polygon fill="black" stroke="black" points="10237.28,-10646.01 10233.78,-10636.01 10230.28,-10646.01 10237.28,-10646.01"/>
</g>
<!-- layer1_attn_norm_gpu0 -->
<g id="node180" class="node">
<title>layer1_attn_norm_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="13068.77,-10470.16 12571.77,-10470.16 12571.77,-10402.16 13068.77,-10402.16 13068.77,-10470.16"/>
<text text-anchor="middle" x="12820.27" y="-10454.96" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="12820.27" y="-10439.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12820.27" y="-10424.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12820.27" y="-10409.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer0_final_residual&#45;&gt;layer1_attn_norm_gpu0 -->
<g id="edge235" class="edge">
<title>layer0_final_residual&#45;&gt;layer1_attn_norm_gpu0</title>
<path fill="none" stroke="black" d="M10376.82,-10594C11276.72,-10594 12820.27,-10594 12820.27,-10594 12820.27,-10594 12820.27,-10480.41 12820.27,-10480.41"/>
<polygon fill="black" stroke="black" points="12823.77,-10480.41 12820.27,-10470.41 12816.77,-10480.41 12823.77,-10480.41"/>
</g>
<!-- layer1_attn_norm_gpu1 -->
<g id="node191" class="node">
<title>layer1_attn_norm_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="14745.77,-10470.16 14248.77,-10470.16 14248.77,-10402.16 14745.77,-10402.16 14745.77,-10470.16"/>
<text text-anchor="middle" x="14497.27" y="-10454.96" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="14497.27" y="-10439.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14497.27" y="-10424.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14497.27" y="-10409.96" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer0_final_residual&#45;&gt;layer1_attn_norm_gpu1 -->
<g id="edge248" class="edge">
<title>layer0_final_residual&#45;&gt;layer1_attn_norm_gpu1</title>
<path fill="none" stroke="black" d="M10381.03,-10613C11635.99,-10613 14311.15,-10613 14311.15,-10613 14311.15,-10613 14311.15,-10480.26 14311.15,-10480.26"/>
<polygon fill="black" stroke="black" points="14314.65,-10480.26 14311.15,-10470.26 14307.65,-10480.26 14314.65,-10480.26"/>
</g>
<!-- layer1_attn_norm_gpu2 -->
<g id="node202" class="node">
<title>layer1_attn_norm_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="16421.77,-10470.16 15924.77,-10470.16 15924.77,-10402.16 16421.77,-10402.16 16421.77,-10470.16"/>
<text text-anchor="middle" x="16173.27" y="-10454.96" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="16173.27" y="-10439.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16173.27" y="-10424.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16173.27" y="-10409.96" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer0_final_residual&#45;&gt;layer1_attn_norm_gpu2 -->
<g id="edge261" class="edge">
<title>layer0_final_residual&#45;&gt;layer1_attn_norm_gpu2</title>
<path fill="none" stroke="black" d="M10263.48,-10633C11791.6,-10633 16173.27,-10633 16173.27,-10633 16173.27,-10633 16173.27,-10480.45 16173.27,-10480.45"/>
<polygon fill="black" stroke="black" points="16176.77,-10480.45 16173.27,-10470.45 16169.77,-10480.45 16176.77,-10480.45"/>
</g>
<!-- layer1_attn_norm_gpu3 -->
<g id="node213" class="node">
<title>layer1_attn_norm_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="5242.77,-10470.16 4745.77,-10470.16 4745.77,-10402.16 5242.77,-10402.16 5242.77,-10470.16"/>
<text text-anchor="middle" x="4994.27" y="-10454.96" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="4994.27" y="-10439.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4994.27" y="-10424.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4994.27" y="-10409.96" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer0_final_residual&#45;&gt;layer1_attn_norm_gpu3 -->
<g id="edge274" class="edge">
<title>layer0_final_residual&#45;&gt;layer1_attn_norm_gpu3</title>
<path fill="none" stroke="black" d="M9134.49,-10620C7851.61,-10620 4994.27,-10620 4994.27,-10620 4994.27,-10620 4994.27,-10480.31 4994.27,-10480.31"/>
<polygon fill="black" stroke="black" points="4997.77,-10480.31 4994.27,-10470.31 4990.77,-10480.31 4997.77,-10480.31"/>
</g>
<!-- layer1_attn_norm_gpu4 -->
<g id="node224" class="node">
<title>layer1_attn_norm_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="6918.77,-10470.16 6421.77,-10470.16 6421.77,-10402.16 6918.77,-10402.16 6918.77,-10470.16"/>
<text text-anchor="middle" x="6670.27" y="-10454.96" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="6670.27" y="-10439.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6670.27" y="-10424.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6670.27" y="-10409.96" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer0_final_residual&#45;&gt;layer1_attn_norm_gpu4 -->
<g id="edge287" class="edge">
<title>layer0_final_residual&#45;&gt;layer1_attn_norm_gpu4</title>
<path fill="none" stroke="black" d="M9136.84,-10588C8291.36,-10588 6863.88,-10588 6863.88,-10588 6863.88,-10588 6863.88,-10480.24 6863.88,-10480.24"/>
<polygon fill="black" stroke="black" points="6867.38,-10480.24 6863.88,-10470.24 6860.38,-10480.24 6867.38,-10480.24"/>
</g>
<!-- layer1_attn_norm_gpu5 -->
<g id="node235" class="node">
<title>layer1_attn_norm_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="8596.77,-10470.16 8099.77,-10470.16 8099.77,-10402.16 8596.77,-10402.16 8596.77,-10470.16"/>
<text text-anchor="middle" x="8348.27" y="-10454.96" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="8348.27" y="-10439.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8348.27" y="-10424.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8348.27" y="-10409.96" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer0_final_residual&#45;&gt;layer1_attn_norm_gpu5 -->
<g id="edge300" class="edge">
<title>layer0_final_residual&#45;&gt;layer1_attn_norm_gpu5</title>
<path fill="none" stroke="black" d="M9211.57,-10576.86C9211.57,-10531.8 9211.57,-10447 9211.57,-10447 9211.57,-10447 8606.81,-10447 8606.81,-10447"/>
<polygon fill="black" stroke="black" points="8606.81,-10443.5 8596.81,-10447 8606.81,-10450.5 8606.81,-10443.5"/>
</g>
<!-- layer1_attn_norm_gpu6 -->
<g id="node246" class="node">
<title>layer1_attn_norm_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="9993.77,-10470.16 9496.77,-10470.16 9496.77,-10402.16 9993.77,-10402.16 9993.77,-10470.16"/>
<text text-anchor="middle" x="9745.27" y="-10454.96" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="9745.27" y="-10439.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9745.27" y="-10424.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9745.27" y="-10409.96" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer0_final_residual&#45;&gt;layer1_attn_norm_gpu6 -->
<g id="edge313" class="edge">
<title>layer0_final_residual&#45;&gt;layer1_attn_norm_gpu6</title>
<path fill="none" stroke="black" d="M9745.27,-10556.08C9745.27,-10556.08 9745.27,-10480.2 9745.27,-10480.2"/>
<polygon fill="black" stroke="black" points="9748.77,-10480.2 9745.27,-10470.2 9741.77,-10480.2 9748.77,-10480.2"/>
</g>
<!-- layer1_attn_norm_gpu7 -->
<g id="node257" class="node">
<title>layer1_attn_norm_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="11390.77,-10470.16 10893.77,-10470.16 10893.77,-10402.16 11390.77,-10402.16 11390.77,-10470.16"/>
<text text-anchor="middle" x="11142.27" y="-10454.96" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="11142.27" y="-10439.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11142.27" y="-10424.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11142.27" y="-10409.96" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer0_final_residual&#45;&gt;layer1_attn_norm_gpu7 -->
<g id="edge326" class="edge">
<title>layer0_final_residual&#45;&gt;layer1_attn_norm_gpu7</title>
<path fill="none" stroke="black" d="M10258.49,-10575C10618.43,-10575 11035.61,-10575 11035.61,-10575 11035.61,-10575 11035.61,-10480.48 11035.61,-10480.48"/>
<polygon fill="black" stroke="black" points="11039.11,-10480.48 11035.61,-10470.48 11032.11,-10480.48 11039.11,-10480.48"/>
</g>
<!-- layer1_attn_residual -->
<g id="node269" class="node">
<title>layer1_attn_residual</title>
<ellipse fill="lightblue" stroke="black" cx="6501.27" cy="-9077.41" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="6501.27" y="-9096.21" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6501.27" y="-9081.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096], [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6501.27" y="-9066.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6501.27" y="-9051.21" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer0_final_residual&#45;&gt;layer1_attn_residual -->
<g id="edge347" class="edge">
<title>layer0_final_residual&#45;&gt;layer1_attn_residual</title>
<path fill="none" stroke="black" d="M10024.77,-10560.48C10024.77,-10425.08 10024.77,-10022 10024.77,-10022 10024.77,-10022 7201.77,-10022 7201.77,-10022 7201.77,-10022 7201.77,-9101 7201.77,-9101 7201.77,-9101 7074.62,-9101 7074.62,-9101"/>
<polygon fill="black" stroke="black" points="7074.62,-9097.5 7064.62,-9101 7074.62,-9104.5 7074.62,-9097.5"/>
</g>
<!-- layer1_q_proj_gpu0 -->
<g id="node181" class="node">
<title>layer1_q_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="13908.77,-10316.16 13407.77,-10316.16 13407.77,-10248.16 13908.77,-10248.16 13908.77,-10316.16"/>
<text text-anchor="middle" x="13658.27" y="-10300.96" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="13658.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13658.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13658.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attn_norm_gpu0&#45;&gt;layer1_q_proj_gpu0 -->
<g id="edge236" class="edge">
<title>layer1_attn_norm_gpu0&#45;&gt;layer1_q_proj_gpu0</title>
<path fill="none" stroke="black" d="M13068.84,-10436C13247.61,-10436 13457.3,-10436 13457.3,-10436 13457.3,-10436 13457.3,-10326.3 13457.3,-10326.3"/>
<polygon fill="black" stroke="black" points="13460.8,-10326.3 13457.3,-10316.3 13453.8,-10326.3 13460.8,-10326.3"/>
</g>
<!-- layer1_k_proj_gpu0 -->
<g id="node182" class="node">
<title>layer1_k_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="13349.77,-10316.16 12848.77,-10316.16 12848.77,-10248.16 13349.77,-10248.16 13349.77,-10316.16"/>
<text text-anchor="middle" x="13099.27" y="-10300.96" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="13099.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13099.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13099.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attn_norm_gpu0&#45;&gt;layer1_k_proj_gpu0 -->
<g id="edge237" class="edge">
<title>layer1_attn_norm_gpu0&#45;&gt;layer1_k_proj_gpu0</title>
<path fill="none" stroke="black" d="M12958.77,-10401.99C12958.77,-10401.99 12958.77,-10326.25 12958.77,-10326.25"/>
<polygon fill="black" stroke="black" points="12962.27,-10326.25 12958.77,-10316.25 12955.27,-10326.25 12962.27,-10326.25"/>
</g>
<!-- layer1_v_proj_gpu0 -->
<g id="node183" class="node">
<title>layer1_v_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="12790.77,-10316.16 12289.77,-10316.16 12289.77,-10248.16 12790.77,-10248.16 12790.77,-10316.16"/>
<text text-anchor="middle" x="12540.27" y="-10300.96" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="12540.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12540.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12540.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attn_norm_gpu0&#45;&gt;layer1_v_proj_gpu0 -->
<g id="edge238" class="edge">
<title>layer1_attn_norm_gpu0&#45;&gt;layer1_v_proj_gpu0</title>
<path fill="none" stroke="black" d="M12681.27,-10401.99C12681.27,-10401.99 12681.27,-10326.25 12681.27,-10326.25"/>
<polygon fill="black" stroke="black" points="12684.77,-10326.25 12681.27,-10316.25 12677.77,-10326.25 12684.77,-10326.25"/>
</g>
<!-- layer1_gather_q_gpu0 -->
<g id="node184" class="node">
<title>layer1_gather_q_gpu0</title>
<ellipse fill="lightblue" stroke="black" cx="13768.27" cy="-10114.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="13768.27" y="-10132.88" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="13768.27" y="-10117.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13768.27" y="-10102.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13768.27" y="-10087.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_q_proj_gpu0&#45;&gt;layer1_gather_q_gpu0 -->
<g id="edge239" class="edge">
<title>layer1_q_proj_gpu0&#45;&gt;layer1_gather_q_gpu0</title>
<path fill="none" stroke="black" d="M13658.27,-10248.15C13658.27,-10248.15 13658.27,-10170.15 13658.27,-10170.15"/>
<polygon fill="black" stroke="black" points="13661.77,-10170.15 13658.27,-10160.15 13654.77,-10170.15 13661.77,-10170.15"/>
</g>
<!-- layer1_gather_k_gpu0 -->
<g id="node185" class="node">
<title>layer1_gather_k_gpu0</title>
<ellipse fill="lightblue" stroke="black" cx="12989.27" cy="-10114.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="12989.27" y="-10132.88" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="12989.27" y="-10117.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12989.27" y="-10102.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12989.27" y="-10087.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_k_proj_gpu0&#45;&gt;layer1_gather_k_gpu0 -->
<g id="edge240" class="edge">
<title>layer1_k_proj_gpu0&#45;&gt;layer1_gather_k_gpu0</title>
<path fill="none" stroke="black" d="M13099.27,-10248.15C13099.27,-10248.15 13099.27,-10170.15 13099.27,-10170.15"/>
<polygon fill="black" stroke="black" points="13102.77,-10170.15 13099.27,-10160.15 13095.77,-10170.15 13102.77,-10170.15"/>
</g>
<!-- layer1_gather_v_gpu0 -->
<g id="node186" class="node">
<title>layer1_gather_v_gpu0</title>
<ellipse fill="lightblue" stroke="black" cx="12421.27" cy="-9749.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="12421.27" y="-9768.55" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="12421.27" y="-9753.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12421.27" y="-9738.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12421.27" y="-9723.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_v_proj_gpu0&#45;&gt;layer1_gather_v_gpu0 -->
<g id="edge241" class="edge">
<title>layer1_v_proj_gpu0&#45;&gt;layer1_gather_v_gpu0</title>
<path fill="none" stroke="black" d="M12540.27,-10248.05C12540.27,-10248.05 12540.27,-9805.31 12540.27,-9805.31"/>
<polygon fill="black" stroke="black" points="12543.77,-9805.31 12540.27,-9795.31 12536.77,-9805.31 12543.77,-9805.31"/>
</g>
<!-- layer1_attn_scores_gpu0 -->
<g id="node187" class="node">
<title>layer1_attn_scores_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="13378.77,-9965.91 12839.77,-9965.91 12839.77,-9897.91 13378.77,-9897.91 13378.77,-9965.91"/>
<text text-anchor="middle" x="13109.27" y="-9950.71" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="13109.27" y="-9935.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13109.27" y="-9920.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="13109.27" y="-9905.71" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gather_q_gpu0&#45;&gt;layer1_attn_scores_gpu0 -->
<g id="edge242" class="edge">
<title>layer1_gather_q_gpu0&#45;&gt;layer1_attn_scores_gpu0</title>
<path fill="none" stroke="black" d="M13407.56,-10114C13380.99,-10114 13364.33,-10114 13364.33,-10114 13364.33,-10114 13364.33,-9976.16 13364.33,-9976.16"/>
<polygon fill="black" stroke="black" points="13367.83,-9976.16 13364.33,-9966.16 13360.83,-9976.16 13367.83,-9976.16"/>
</g>
<!-- layer1_gather_k_gpu0&#45;&gt;layer1_attn_scores_gpu0 -->
<g id="edge243" class="edge">
<title>layer1_gather_k_gpu0&#45;&gt;layer1_attn_scores_gpu0</title>
<path fill="none" stroke="black" d="M13094.83,-10067.64C13094.83,-10067.64 13094.83,-9976.19 13094.83,-9976.19"/>
<polygon fill="black" stroke="black" points="13098.33,-9976.19 13094.83,-9966.19 13091.33,-9976.19 13098.33,-9976.19"/>
</g>
<!-- layer1_attn_out_gpu0 -->
<g id="node189" class="node">
<title>layer1_attn_out_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="12684.77,-9615.66 12157.77,-9615.66 12157.77,-9547.66 12684.77,-9547.66 12684.77,-9615.66"/>
<text text-anchor="middle" x="12421.27" y="-9600.46" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="12421.27" y="-9585.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="12421.27" y="-9570.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12421.27" y="-9555.46" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_gather_v_gpu0&#45;&gt;layer1_attn_out_gpu0 -->
<g id="edge246" class="edge">
<title>layer1_gather_v_gpu0&#45;&gt;layer1_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M12421.27,-9701.58C12421.27,-9701.58 12421.27,-9625.7 12421.27,-9625.7"/>
<polygon fill="black" stroke="black" points="12424.77,-9625.7 12421.27,-9615.7 12417.77,-9625.7 12424.77,-9625.7"/>
</g>
<!-- layer1_softmax_gpu0 -->
<g id="node188" class="node">
<title>layer1_softmax_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="13378.77,-9783.75 12839.77,-9783.75 12839.77,-9715.75 13378.77,-9715.75 13378.77,-9783.75"/>
<text text-anchor="middle" x="13109.27" y="-9768.55" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="13109.27" y="-9753.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="13109.27" y="-9738.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="13109.27" y="-9723.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attn_scores_gpu0&#45;&gt;layer1_softmax_gpu0 -->
<g id="edge244" class="edge">
<title>layer1_attn_scores_gpu0&#45;&gt;layer1_softmax_gpu0</title>
<path fill="none" stroke="black" d="M13109.27,-9897.65C13109.27,-9897.65 13109.27,-9793.86 13109.27,-9793.86"/>
<polygon fill="black" stroke="black" points="13112.77,-9793.86 13109.27,-9783.86 13105.77,-9793.86 13112.77,-9793.86"/>
</g>
<!-- layer1_softmax_gpu0&#45;&gt;layer1_attn_out_gpu0 -->
<g id="edge245" class="edge">
<title>layer1_softmax_gpu0&#45;&gt;layer1_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M13052.77,-9715.52C13052.77,-9669.12 13052.77,-9592 13052.77,-9592 13052.77,-9592 12694.96,-9592 12694.96,-9592"/>
<polygon fill="black" stroke="black" points="12694.96,-9588.5 12684.96,-9592 12694.96,-9595.5 12694.96,-9588.5"/>
</g>
<!-- layer1_out_proj_gpu0 -->
<g id="node190" class="node">
<title>layer1_out_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="12218.77,-9461.66 11729.77,-9461.66 11729.77,-9393.66 12218.77,-9393.66 12218.77,-9461.66"/>
<text text-anchor="middle" x="11974.27" y="-9446.46" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11974.27" y="-9431.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11974.27" y="-9416.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="11974.27" y="-9401.46" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_attn_out_gpu0&#45;&gt;layer1_out_proj_gpu0 -->
<g id="edge247" class="edge">
<title>layer1_attn_out_gpu0&#45;&gt;layer1_out_proj_gpu0</title>
<path fill="none" stroke="black" d="M12188.27,-9547.49C12188.27,-9547.49 12188.27,-9471.75 12188.27,-9471.75"/>
<polygon fill="black" stroke="black" points="12191.77,-9471.75 12188.27,-9461.75 12184.77,-9471.75 12191.77,-9471.75"/>
</g>
<!-- layer1_attn_all_reduce -->
<g id="node268" class="node">
<title>layer1_attn_all_reduce</title>
<ellipse fill="lightblue" stroke="black" cx="9468.27" cy="-9259.58" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="9468.27" y="-9278.38" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="9468.27" y="-9263.38" font-family="Times,serif" font-size="14.00">Input: 8×[512]</text>
<text text-anchor="middle" x="9468.27" y="-9248.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9468.27" y="-9233.38" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- layer1_out_proj_gpu0&#45;&gt;layer1_attn_all_reduce -->
<g id="edge339" class="edge">
<title>layer1_out_proj_gpu0&#45;&gt;layer1_attn_all_reduce</title>
<path fill="none" stroke="black" d="M11974.27,-9393.38C11974.27,-9350.6 11974.27,-9283 11974.27,-9283 11974.27,-9283 9785.24,-9283 9785.24,-9283"/>
<polygon fill="black" stroke="black" points="9785.24,-9279.5 9775.24,-9283 9785.24,-9286.5 9785.24,-9279.5"/>
</g>
<!-- layer1_q_proj_gpu1 -->
<g id="node192" class="node">
<title>layer1_q_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="15585.77,-10316.16 15084.77,-10316.16 15084.77,-10248.16 15585.77,-10248.16 15585.77,-10316.16"/>
<text text-anchor="middle" x="15335.27" y="-10300.96" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="15335.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15335.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15335.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_norm_gpu1&#45;&gt;layer1_q_proj_gpu1 -->
<g id="edge249" class="edge">
<title>layer1_attn_norm_gpu1&#45;&gt;layer1_q_proj_gpu1</title>
<path fill="none" stroke="black" d="M14745.86,-10436C14972.98,-10436 15273.65,-10436 15273.65,-10436 15273.65,-10436 15273.65,-10326.3 15273.65,-10326.3"/>
<polygon fill="black" stroke="black" points="15277.15,-10326.3 15273.65,-10316.3 15270.15,-10326.3 15277.15,-10326.3"/>
</g>
<!-- layer1_k_proj_gpu1 -->
<g id="node193" class="node">
<title>layer1_k_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="15026.77,-10316.16 14525.77,-10316.16 14525.77,-10248.16 15026.77,-10248.16 15026.77,-10316.16"/>
<text text-anchor="middle" x="14776.27" y="-10300.96" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="14776.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14776.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14776.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_norm_gpu1&#45;&gt;layer1_k_proj_gpu1 -->
<g id="edge250" class="edge">
<title>layer1_attn_norm_gpu1&#45;&gt;layer1_k_proj_gpu1</title>
<path fill="none" stroke="black" d="M14635.77,-10401.99C14635.77,-10401.99 14635.77,-10326.25 14635.77,-10326.25"/>
<polygon fill="black" stroke="black" points="14639.27,-10326.25 14635.77,-10316.25 14632.27,-10326.25 14639.27,-10326.25"/>
</g>
<!-- layer1_v_proj_gpu1 -->
<g id="node194" class="node">
<title>layer1_v_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="14467.77,-10316.16 13966.77,-10316.16 13966.77,-10248.16 14467.77,-10248.16 14467.77,-10316.16"/>
<text text-anchor="middle" x="14217.27" y="-10300.96" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="14217.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14217.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14217.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_norm_gpu1&#45;&gt;layer1_v_proj_gpu1 -->
<g id="edge251" class="edge">
<title>layer1_attn_norm_gpu1&#45;&gt;layer1_v_proj_gpu1</title>
<path fill="none" stroke="black" d="M14358.27,-10401.99C14358.27,-10401.99 14358.27,-10326.25 14358.27,-10326.25"/>
<polygon fill="black" stroke="black" points="14361.77,-10326.25 14358.27,-10316.25 14354.77,-10326.25 14361.77,-10326.25"/>
</g>
<!-- layer1_gather_q_gpu1 -->
<g id="node195" class="node">
<title>layer1_gather_q_gpu1</title>
<ellipse fill="lightblue" stroke="black" cx="15445.27" cy="-10114.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="15445.27" y="-10132.88" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="15445.27" y="-10117.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15445.27" y="-10102.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="15445.27" y="-10087.88" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_q_proj_gpu1&#45;&gt;layer1_gather_q_gpu1 -->
<g id="edge252" class="edge">
<title>layer1_q_proj_gpu1&#45;&gt;layer1_gather_q_gpu1</title>
<path fill="none" stroke="black" d="M15335.27,-10248.15C15335.27,-10248.15 15335.27,-10170.15 15335.27,-10170.15"/>
<polygon fill="black" stroke="black" points="15338.77,-10170.15 15335.27,-10160.15 15331.77,-10170.15 15338.77,-10170.15"/>
</g>
<!-- layer1_gather_k_gpu1 -->
<g id="node196" class="node">
<title>layer1_gather_k_gpu1</title>
<ellipse fill="lightblue" stroke="black" cx="14666.27" cy="-10114.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="14666.27" y="-10132.88" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="14666.27" y="-10117.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14666.27" y="-10102.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14666.27" y="-10087.88" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_k_proj_gpu1&#45;&gt;layer1_gather_k_gpu1 -->
<g id="edge253" class="edge">
<title>layer1_k_proj_gpu1&#45;&gt;layer1_gather_k_gpu1</title>
<path fill="none" stroke="black" d="M14776.27,-10248.15C14776.27,-10248.15 14776.27,-10170.15 14776.27,-10170.15"/>
<polygon fill="black" stroke="black" points="14779.77,-10170.15 14776.27,-10160.15 14772.77,-10170.15 14779.77,-10170.15"/>
</g>
<!-- layer1_gather_v_gpu1 -->
<g id="node197" class="node">
<title>layer1_gather_v_gpu1</title>
<ellipse fill="lightblue" stroke="black" cx="14098.27" cy="-9931.91" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="14098.27" y="-9950.71" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="14098.27" y="-9935.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14098.27" y="-9920.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14098.27" y="-9905.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_v_proj_gpu1&#45;&gt;layer1_gather_v_gpu1 -->
<g id="edge254" class="edge">
<title>layer1_v_proj_gpu1&#45;&gt;layer1_gather_v_gpu1</title>
<path fill="none" stroke="black" d="M14217.27,-10247.94C14217.27,-10247.94 14217.27,-9987.52 14217.27,-9987.52"/>
<polygon fill="black" stroke="black" points="14220.77,-9987.52 14217.27,-9977.52 14213.77,-9987.52 14220.77,-9987.52"/>
</g>
<!-- layer1_attn_scores_gpu1 -->
<g id="node198" class="node">
<title>layer1_attn_scores_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="15055.77,-9965.91 14516.77,-9965.91 14516.77,-9897.91 15055.77,-9897.91 15055.77,-9965.91"/>
<text text-anchor="middle" x="14786.27" y="-9950.71" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="14786.27" y="-9935.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14786.27" y="-9920.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="14786.27" y="-9905.71" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gather_q_gpu1&#45;&gt;layer1_attn_scores_gpu1 -->
<g id="edge255" class="edge">
<title>layer1_gather_q_gpu1&#45;&gt;layer1_attn_scores_gpu1</title>
<path fill="none" stroke="black" d="M15084.56,-10114C15057.99,-10114 15041.33,-10114 15041.33,-10114 15041.33,-10114 15041.33,-9976.16 15041.33,-9976.16"/>
<polygon fill="black" stroke="black" points="15044.83,-9976.16 15041.33,-9966.16 15037.83,-9976.16 15044.83,-9976.16"/>
</g>
<!-- layer1_gather_k_gpu1&#45;&gt;layer1_attn_scores_gpu1 -->
<g id="edge256" class="edge">
<title>layer1_gather_k_gpu1&#45;&gt;layer1_attn_scores_gpu1</title>
<path fill="none" stroke="black" d="M14771.83,-10067.64C14771.83,-10067.64 14771.83,-9976.19 14771.83,-9976.19"/>
<polygon fill="black" stroke="black" points="14775.33,-9976.19 14771.83,-9966.19 14768.33,-9976.19 14775.33,-9976.19"/>
</g>
<!-- layer1_attn_out_gpu1 -->
<g id="node200" class="node">
<title>layer1_attn_out_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="14361.77,-9615.66 13834.77,-9615.66 13834.77,-9547.66 14361.77,-9547.66 14361.77,-9615.66"/>
<text text-anchor="middle" x="14098.27" y="-9600.46" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="14098.27" y="-9585.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="14098.27" y="-9570.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14098.27" y="-9555.46" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_gather_v_gpu1&#45;&gt;layer1_attn_out_gpu1 -->
<g id="edge259" class="edge">
<title>layer1_gather_v_gpu1&#45;&gt;layer1_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M14093.27,-9883.58C14093.27,-9883.58 14093.27,-9625.82 14093.27,-9625.82"/>
<polygon fill="black" stroke="black" points="14096.77,-9625.82 14093.27,-9615.82 14089.77,-9625.82 14096.77,-9625.82"/>
</g>
<!-- layer1_softmax_gpu1 -->
<g id="node199" class="node">
<title>layer1_softmax_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="14890.77,-9783.75 14351.77,-9783.75 14351.77,-9715.75 14890.77,-9715.75 14890.77,-9783.75"/>
<text text-anchor="middle" x="14621.27" y="-9768.55" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="14621.27" y="-9753.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="14621.27" y="-9738.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="14621.27" y="-9723.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_scores_gpu1&#45;&gt;layer1_softmax_gpu1 -->
<g id="edge257" class="edge">
<title>layer1_attn_scores_gpu1&#45;&gt;layer1_softmax_gpu1</title>
<path fill="none" stroke="black" d="M14703.77,-9897.65C14703.77,-9897.65 14703.77,-9793.86 14703.77,-9793.86"/>
<polygon fill="black" stroke="black" points="14707.27,-9793.86 14703.77,-9783.86 14700.27,-9793.86 14707.27,-9793.86"/>
</g>
<!-- layer1_softmax_gpu1&#45;&gt;layer1_attn_out_gpu1 -->
<g id="edge258" class="edge">
<title>layer1_softmax_gpu1&#45;&gt;layer1_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M14356.77,-9715.73C14356.77,-9715.73 14356.77,-9625.92 14356.77,-9625.92"/>
<polygon fill="black" stroke="black" points="14360.27,-9625.92 14356.77,-9615.92 14353.27,-9625.92 14360.27,-9625.92"/>
</g>
<!-- layer1_out_proj_gpu1 -->
<g id="node201" class="node">
<title>layer1_out_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="13754.77,-9461.66 13265.77,-9461.66 13265.77,-9393.66 13754.77,-9393.66 13754.77,-9461.66"/>
<text text-anchor="middle" x="13510.27" y="-9446.46" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13510.27" y="-9431.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13510.27" y="-9416.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="13510.27" y="-9401.46" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_attn_out_gpu1&#45;&gt;layer1_out_proj_gpu1 -->
<g id="edge260" class="edge">
<title>layer1_attn_out_gpu1&#45;&gt;layer1_out_proj_gpu1</title>
<path fill="none" stroke="black" d="M13834.59,-9570C13783.88,-9570 13746.2,-9570 13746.2,-9570 13746.2,-9570 13746.2,-9471.76 13746.2,-9471.76"/>
<polygon fill="black" stroke="black" points="13749.7,-9471.76 13746.2,-9461.76 13742.7,-9471.76 13749.7,-9471.76"/>
</g>
<!-- layer1_out_proj_gpu1&#45;&gt;layer1_attn_all_reduce -->
<g id="edge340" class="edge">
<title>layer1_out_proj_gpu1&#45;&gt;layer1_attn_all_reduce</title>
<path fill="none" stroke="black" d="M13284.93,-9393.53C13284.93,-9344.25 13284.93,-9259 13284.93,-9259 13284.93,-9259 9830.06,-9259 9830.06,-9259"/>
<polygon fill="black" stroke="black" points="9830.06,-9255.5 9820.06,-9259 9830.06,-9262.5 9830.06,-9255.5"/>
</g>
<!-- layer1_q_proj_gpu2 -->
<g id="node203" class="node">
<title>layer1_q_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="17345.77,-10316.16 16844.77,-10316.16 16844.77,-10248.16 17345.77,-10248.16 17345.77,-10316.16"/>
<text text-anchor="middle" x="17095.27" y="-10300.96" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="17095.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17095.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="17095.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attn_norm_gpu2&#45;&gt;layer1_q_proj_gpu2 -->
<g id="edge262" class="edge">
<title>layer1_attn_norm_gpu2&#45;&gt;layer1_q_proj_gpu2</title>
<path fill="none" stroke="black" d="M16421.86,-10436C16694.94,-10436 17095.27,-10436 17095.27,-10436 17095.27,-10436 17095.27,-10326.3 17095.27,-10326.3"/>
<polygon fill="black" stroke="black" points="17098.77,-10326.3 17095.27,-10316.3 17091.77,-10326.3 17098.77,-10326.3"/>
</g>
<!-- layer1_k_proj_gpu2 -->
<g id="node204" class="node">
<title>layer1_k_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="16703.77,-10316.16 16202.77,-10316.16 16202.77,-10248.16 16703.77,-10248.16 16703.77,-10316.16"/>
<text text-anchor="middle" x="16453.27" y="-10300.96" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="16453.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16453.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="16453.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attn_norm_gpu2&#45;&gt;layer1_k_proj_gpu2 -->
<g id="edge263" class="edge">
<title>layer1_attn_norm_gpu2&#45;&gt;layer1_k_proj_gpu2</title>
<path fill="none" stroke="black" d="M16312.27,-10401.99C16312.27,-10401.99 16312.27,-10326.25 16312.27,-10326.25"/>
<polygon fill="black" stroke="black" points="16315.77,-10326.25 16312.27,-10316.25 16308.77,-10326.25 16315.77,-10326.25"/>
</g>
<!-- layer1_v_proj_gpu2 -->
<g id="node205" class="node">
<title>layer1_v_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="16144.77,-10316.16 15643.77,-10316.16 15643.77,-10248.16 16144.77,-10248.16 16144.77,-10316.16"/>
<text text-anchor="middle" x="15894.27" y="-10300.96" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="15894.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15894.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15894.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attn_norm_gpu2&#45;&gt;layer1_v_proj_gpu2 -->
<g id="edge264" class="edge">
<title>layer1_attn_norm_gpu2&#45;&gt;layer1_v_proj_gpu2</title>
<path fill="none" stroke="black" d="M16034.77,-10401.99C16034.77,-10401.99 16034.77,-10326.25 16034.77,-10326.25"/>
<polygon fill="black" stroke="black" points="16038.27,-10326.25 16034.77,-10316.25 16031.27,-10326.25 16038.27,-10326.25"/>
</g>
<!-- layer1_gather_q_gpu2 -->
<g id="node206" class="node">
<title>layer1_gather_q_gpu2</title>
<ellipse fill="lightblue" stroke="black" cx="17177.27" cy="-10114.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="17177.27" y="-10132.88" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="17177.27" y="-10117.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="17177.27" y="-10102.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="17177.27" y="-10087.88" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_q_proj_gpu2&#45;&gt;layer1_gather_q_gpu2 -->
<g id="edge265" class="edge">
<title>layer1_q_proj_gpu2&#45;&gt;layer1_gather_q_gpu2</title>
<path fill="none" stroke="black" d="M17095.27,-10248.15C17095.27,-10248.15 17095.27,-10171.1 17095.27,-10171.1"/>
<polygon fill="black" stroke="black" points="17098.77,-10171.1 17095.27,-10161.1 17091.77,-10171.1 17098.77,-10171.1"/>
</g>
<!-- layer1_gather_k_gpu2 -->
<g id="node207" class="node">
<title>layer1_gather_k_gpu2</title>
<ellipse fill="lightblue" stroke="black" cx="16398.27" cy="-10114.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="16398.27" y="-10132.88" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="16398.27" y="-10117.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="16398.27" y="-10102.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="16398.27" y="-10087.88" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_k_proj_gpu2&#45;&gt;layer1_gather_k_gpu2 -->
<g id="edge266" class="edge">
<title>layer1_k_proj_gpu2&#45;&gt;layer1_gather_k_gpu2</title>
<path fill="none" stroke="black" d="M16453.27,-10248.15C16453.27,-10248.15 16453.27,-10171.74 16453.27,-10171.74"/>
<polygon fill="black" stroke="black" points="16456.77,-10171.74 16453.27,-10161.74 16449.77,-10171.74 16456.77,-10171.74"/>
</g>
<!-- layer1_gather_v_gpu2 -->
<g id="node208" class="node">
<title>layer1_gather_v_gpu2</title>
<ellipse fill="lightblue" stroke="black" cx="15802.27" cy="-9749.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="15802.27" y="-9768.55" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="15802.27" y="-9753.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15802.27" y="-9738.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="15802.27" y="-9723.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_v_proj_gpu2&#45;&gt;layer1_gather_v_gpu2 -->
<g id="edge267" class="edge">
<title>layer1_v_proj_gpu2&#45;&gt;layer1_gather_v_gpu2</title>
<path fill="none" stroke="black" d="M15921.77,-10248.05C15921.77,-10248.05 15921.77,-9805.31 15921.77,-9805.31"/>
<polygon fill="black" stroke="black" points="15925.27,-9805.31 15921.77,-9795.31 15918.27,-9805.31 15925.27,-9805.31"/>
</g>
<!-- layer1_attn_scores_gpu2 -->
<g id="node209" class="node">
<title>layer1_attn_scores_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="16759.77,-9965.91 16220.77,-9965.91 16220.77,-9897.91 16759.77,-9897.91 16759.77,-9965.91"/>
<text text-anchor="middle" x="16490.27" y="-9950.71" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="16490.27" y="-9935.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="16490.27" y="-9920.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="16490.27" y="-9905.71" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gather_q_gpu2&#45;&gt;layer1_attn_scores_gpu2 -->
<g id="edge268" class="edge">
<title>layer1_gather_q_gpu2&#45;&gt;layer1_attn_scores_gpu2</title>
<path fill="none" stroke="black" d="M17177.27,-10065.98C17177.27,-10011.73 17177.27,-9931 17177.27,-9931 17177.27,-9931 16769.82,-9931 16769.82,-9931"/>
<polygon fill="black" stroke="black" points="16769.82,-9927.5 16759.82,-9931 16769.82,-9934.5 16769.82,-9927.5"/>
</g>
<!-- layer1_gather_k_gpu2&#45;&gt;layer1_attn_scores_gpu2 -->
<g id="edge269" class="edge">
<title>layer1_gather_k_gpu2&#45;&gt;layer1_attn_scores_gpu2</title>
<path fill="none" stroke="black" d="M16489.83,-10067.17C16489.83,-10067.17 16489.83,-9976.01 16489.83,-9976.01"/>
<polygon fill="black" stroke="black" points="16493.33,-9976.01 16489.83,-9966.01 16486.33,-9976.01 16493.33,-9976.01"/>
</g>
<!-- layer1_attn_out_gpu2 -->
<g id="node211" class="node">
<title>layer1_attn_out_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="16065.77,-9615.66 15538.77,-9615.66 15538.77,-9547.66 16065.77,-9547.66 16065.77,-9615.66"/>
<text text-anchor="middle" x="15802.27" y="-9600.46" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="15802.27" y="-9585.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="15802.27" y="-9570.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15802.27" y="-9555.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_gather_v_gpu2&#45;&gt;layer1_attn_out_gpu2 -->
<g id="edge272" class="edge">
<title>layer1_gather_v_gpu2&#45;&gt;layer1_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M15802.27,-9701.58C15802.27,-9701.58 15802.27,-9625.7 15802.27,-9625.7"/>
<polygon fill="black" stroke="black" points="15805.77,-9625.7 15802.27,-9615.7 15798.77,-9625.7 15805.77,-9625.7"/>
</g>
<!-- layer1_softmax_gpu2 -->
<g id="node210" class="node">
<title>layer1_softmax_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="16759.77,-9783.75 16220.77,-9783.75 16220.77,-9715.75 16759.77,-9715.75 16759.77,-9783.75"/>
<text text-anchor="middle" x="16490.27" y="-9768.55" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="16490.27" y="-9753.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="16490.27" y="-9738.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="16490.27" y="-9723.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attn_scores_gpu2&#45;&gt;layer1_softmax_gpu2 -->
<g id="edge270" class="edge">
<title>layer1_attn_scores_gpu2&#45;&gt;layer1_softmax_gpu2</title>
<path fill="none" stroke="black" d="M16490.27,-9897.65C16490.27,-9897.65 16490.27,-9793.86 16490.27,-9793.86"/>
<polygon fill="black" stroke="black" points="16493.77,-9793.86 16490.27,-9783.86 16486.77,-9793.86 16493.77,-9793.86"/>
</g>
<!-- layer1_softmax_gpu2&#45;&gt;layer1_attn_out_gpu2 -->
<g id="edge271" class="edge">
<title>layer1_softmax_gpu2&#45;&gt;layer1_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M16358.43,-9715.6C16358.43,-9666.29 16358.43,-9581 16358.43,-9581 16358.43,-9581 16076.1,-9581 16076.1,-9581"/>
<polygon fill="black" stroke="black" points="16076.1,-9577.5 16066.1,-9581 16076.1,-9584.5 16076.1,-9577.5"/>
</g>
<!-- layer1_out_proj_gpu2 -->
<g id="node212" class="node">
<title>layer1_out_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="15241.77,-9461.66 14752.77,-9461.66 14752.77,-9393.66 15241.77,-9393.66 15241.77,-9461.66"/>
<text text-anchor="middle" x="14997.27" y="-9446.46" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14997.27" y="-9431.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14997.27" y="-9416.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="14997.27" y="-9401.46" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_attn_out_gpu2&#45;&gt;layer1_out_proj_gpu2 -->
<g id="edge273" class="edge">
<title>layer1_attn_out_gpu2&#45;&gt;layer1_out_proj_gpu2</title>
<path fill="none" stroke="black" d="M15538.65,-9581C15362.61,-9581 15163.2,-9581 15163.2,-9581 15163.2,-9581 15163.2,-9471.69 15163.2,-9471.69"/>
<polygon fill="black" stroke="black" points="15166.7,-9471.69 15163.2,-9461.69 15159.7,-9471.69 15166.7,-9471.69"/>
</g>
<!-- layer1_out_proj_gpu2&#45;&gt;layer1_attn_all_reduce -->
<g id="edge341" class="edge">
<title>layer1_out_proj_gpu2&#45;&gt;layer1_attn_all_reduce</title>
<path fill="none" stroke="black" d="M14997.27,-9393.66C14997.27,-9338.35 14997.27,-9235 14997.27,-9235 14997.27,-9235 9780.44,-9235 9780.44,-9235"/>
<polygon fill="black" stroke="black" points="9780.44,-9231.5 9770.44,-9235 9780.44,-9238.5 9780.44,-9231.5"/>
</g>
<!-- layer1_q_proj_gpu3 -->
<g id="node214" class="node">
<title>layer1_q_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="4964.77,-10316.16 4463.77,-10316.16 4463.77,-10248.16 4964.77,-10248.16 4964.77,-10316.16"/>
<text text-anchor="middle" x="4714.27" y="-10300.96" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4714.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4714.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4714.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_attn_norm_gpu3&#45;&gt;layer1_q_proj_gpu3 -->
<g id="edge275" class="edge">
<title>layer1_attn_norm_gpu3&#45;&gt;layer1_q_proj_gpu3</title>
<path fill="none" stroke="black" d="M4855.27,-10401.99C4855.27,-10401.99 4855.27,-10326.25 4855.27,-10326.25"/>
<polygon fill="black" stroke="black" points="4858.77,-10326.25 4855.27,-10316.25 4851.77,-10326.25 4858.77,-10326.25"/>
</g>
<!-- layer1_k_proj_gpu3 -->
<g id="node215" class="node">
<title>layer1_k_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="5523.77,-10316.16 5022.77,-10316.16 5022.77,-10248.16 5523.77,-10248.16 5523.77,-10316.16"/>
<text text-anchor="middle" x="5273.27" y="-10300.96" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5273.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5273.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5273.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_attn_norm_gpu3&#45;&gt;layer1_k_proj_gpu3 -->
<g id="edge276" class="edge">
<title>layer1_attn_norm_gpu3&#45;&gt;layer1_k_proj_gpu3</title>
<path fill="none" stroke="black" d="M5132.77,-10401.99C5132.77,-10401.99 5132.77,-10326.25 5132.77,-10326.25"/>
<polygon fill="black" stroke="black" points="5136.27,-10326.25 5132.77,-10316.25 5129.27,-10326.25 5136.27,-10326.25"/>
</g>
<!-- layer1_v_proj_gpu3 -->
<g id="node216" class="node">
<title>layer1_v_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="4405.77,-10316.16 3904.77,-10316.16 3904.77,-10248.16 4405.77,-10248.16 4405.77,-10316.16"/>
<text text-anchor="middle" x="4155.27" y="-10300.96" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4155.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4155.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4155.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_attn_norm_gpu3&#45;&gt;layer1_v_proj_gpu3 -->
<g id="edge277" class="edge">
<title>layer1_attn_norm_gpu3&#45;&gt;layer1_v_proj_gpu3</title>
<path fill="none" stroke="black" d="M4745.66,-10436C4498.28,-10436 4155.27,-10436 4155.27,-10436 4155.27,-10436 4155.27,-10326.3 4155.27,-10326.3"/>
<polygon fill="black" stroke="black" points="4158.77,-10326.3 4155.27,-10316.3 4151.77,-10326.3 4158.77,-10326.3"/>
</g>
<!-- layer1_gather_q_gpu3 -->
<g id="node217" class="node">
<title>layer1_gather_q_gpu3</title>
<ellipse fill="lightblue" stroke="black" cx="4604.27" cy="-10114.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="4604.27" y="-10132.88" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="4604.27" y="-10117.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4604.27" y="-10102.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4604.27" y="-10087.88" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_q_proj_gpu3&#45;&gt;layer1_gather_q_gpu3 -->
<g id="edge278" class="edge">
<title>layer1_q_proj_gpu3&#45;&gt;layer1_gather_q_gpu3</title>
<path fill="none" stroke="black" d="M4714.27,-10248.15C4714.27,-10248.15 4714.27,-10170.15 4714.27,-10170.15"/>
<polygon fill="black" stroke="black" points="4717.77,-10170.15 4714.27,-10160.15 4710.77,-10170.15 4717.77,-10170.15"/>
</g>
<!-- layer1_gather_k_gpu3 -->
<g id="node218" class="node">
<title>layer1_gather_k_gpu3</title>
<ellipse fill="lightblue" stroke="black" cx="5383.27" cy="-10114.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="5383.27" y="-10132.88" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="5383.27" y="-10117.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5383.27" y="-10102.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5383.27" y="-10087.88" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_k_proj_gpu3&#45;&gt;layer1_gather_k_gpu3 -->
<g id="edge279" class="edge">
<title>layer1_k_proj_gpu3&#45;&gt;layer1_gather_k_gpu3</title>
<path fill="none" stroke="black" d="M5273.27,-10248.15C5273.27,-10248.15 5273.27,-10170.15 5273.27,-10170.15"/>
<polygon fill="black" stroke="black" points="5276.77,-10170.15 5273.27,-10160.15 5269.77,-10170.15 5276.77,-10170.15"/>
</g>
<!-- layer1_gather_v_gpu3 -->
<g id="node219" class="node">
<title>layer1_gather_v_gpu3</title>
<ellipse fill="lightblue" stroke="black" cx="4360.27" cy="-9931.91" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="4360.27" y="-9950.71" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="4360.27" y="-9935.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4360.27" y="-9920.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4360.27" y="-9905.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_v_proj_gpu3&#45;&gt;layer1_gather_v_gpu3 -->
<g id="edge280" class="edge">
<title>layer1_v_proj_gpu3&#45;&gt;layer1_gather_v_gpu3</title>
<path fill="none" stroke="black" d="M4121.64,-10247.94C4121.64,-10247.94 4121.64,-9978.1 4121.64,-9978.1"/>
<polygon fill="black" stroke="black" points="4125.14,-9978.1 4121.64,-9968.1 4118.14,-9978.1 4125.14,-9978.1"/>
</g>
<!-- layer1_attn_scores_gpu3 -->
<g id="node220" class="node">
<title>layer1_attn_scores_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="5365.77,-9965.91 4826.77,-9965.91 4826.77,-9897.91 5365.77,-9897.91 5365.77,-9965.91"/>
<text text-anchor="middle" x="5096.27" y="-9950.71" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="5096.27" y="-9935.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5096.27" y="-9920.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="5096.27" y="-9905.71" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gather_q_gpu3&#45;&gt;layer1_attn_scores_gpu3 -->
<g id="edge281" class="edge">
<title>layer1_gather_q_gpu3&#45;&gt;layer1_attn_scores_gpu3</title>
<path fill="none" stroke="black" d="M4895.83,-10085.62C4895.83,-10085.62 4895.83,-9976.07 4895.83,-9976.07"/>
<polygon fill="black" stroke="black" points="4899.33,-9976.07 4895.83,-9966.07 4892.33,-9976.07 4899.33,-9976.07"/>
</g>
<!-- layer1_gather_k_gpu3&#45;&gt;layer1_attn_scores_gpu3 -->
<g id="edge282" class="edge">
<title>layer1_gather_k_gpu3&#45;&gt;layer1_attn_scores_gpu3</title>
<path fill="none" stroke="black" d="M5194.2,-10072.74C5194.2,-10072.74 5194.2,-9976.07 5194.2,-9976.07"/>
<polygon fill="black" stroke="black" points="5197.7,-9976.07 5194.2,-9966.07 5190.7,-9976.07 5197.7,-9976.07"/>
</g>
<!-- layer1_attn_out_gpu3 -->
<g id="node222" class="node">
<title>layer1_attn_out_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="5359.77,-9615.66 4832.77,-9615.66 4832.77,-9547.66 5359.77,-9547.66 5359.77,-9615.66"/>
<text text-anchor="middle" x="5096.27" y="-9600.46" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="5096.27" y="-9585.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="5096.27" y="-9570.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5096.27" y="-9555.46" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_gather_v_gpu3&#45;&gt;layer1_attn_out_gpu3 -->
<g id="edge285" class="edge">
<title>layer1_gather_v_gpu3&#45;&gt;layer1_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M4360.27,-9883.49C4360.27,-9787.22 4360.27,-9581 4360.27,-9581 4360.27,-9581 4822.63,-9581 4822.63,-9581"/>
<polygon fill="black" stroke="black" points="4822.63,-9584.5 4832.63,-9581 4822.63,-9577.5 4822.63,-9584.5"/>
</g>
<!-- layer1_softmax_gpu3 -->
<g id="node221" class="node">
<title>layer1_softmax_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="5365.77,-9783.75 4826.77,-9783.75 4826.77,-9715.75 5365.77,-9715.75 5365.77,-9783.75"/>
<text text-anchor="middle" x="5096.27" y="-9768.55" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="5096.27" y="-9753.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="5096.27" y="-9738.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="5096.27" y="-9723.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_attn_scores_gpu3&#45;&gt;layer1_softmax_gpu3 -->
<g id="edge283" class="edge">
<title>layer1_attn_scores_gpu3&#45;&gt;layer1_softmax_gpu3</title>
<path fill="none" stroke="black" d="M5096.27,-9897.65C5096.27,-9897.65 5096.27,-9793.86 5096.27,-9793.86"/>
<polygon fill="black" stroke="black" points="5099.77,-9793.86 5096.27,-9783.86 5092.77,-9793.86 5099.77,-9793.86"/>
</g>
<!-- layer1_softmax_gpu3&#45;&gt;layer1_attn_out_gpu3 -->
<g id="edge284" class="edge">
<title>layer1_softmax_gpu3&#45;&gt;layer1_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M5096.27,-9715.73C5096.27,-9715.73 5096.27,-9625.92 5096.27,-9625.92"/>
<polygon fill="black" stroke="black" points="5099.77,-9625.92 5096.27,-9615.92 5092.77,-9625.92 5099.77,-9625.92"/>
</g>
<!-- layer1_out_proj_gpu3 -->
<g id="node223" class="node">
<title>layer1_out_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="6684.77,-9461.66 6195.77,-9461.66 6195.77,-9393.66 6684.77,-9393.66 6684.77,-9461.66"/>
<text text-anchor="middle" x="6440.27" y="-9446.46" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6440.27" y="-9431.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6440.27" y="-9416.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="6440.27" y="-9401.46" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_attn_out_gpu3&#45;&gt;layer1_out_proj_gpu3 -->
<g id="edge286" class="edge">
<title>layer1_attn_out_gpu3&#45;&gt;layer1_out_proj_gpu3</title>
<path fill="none" stroke="black" d="M5359.87,-9570C5693.46,-9570 6225.14,-9570 6225.14,-9570 6225.14,-9570 6225.14,-9471.76 6225.14,-9471.76"/>
<polygon fill="black" stroke="black" points="6228.64,-9471.76 6225.14,-9461.76 6221.64,-9471.76 6228.64,-9471.76"/>
</g>
<!-- layer1_out_proj_gpu3&#45;&gt;layer1_attn_all_reduce -->
<g id="edge342" class="edge">
<title>layer1_out_proj_gpu3&#45;&gt;layer1_attn_all_reduce</title>
<path fill="none" stroke="black" d="M6440.27,-9393.36C6440.27,-9339.96 6440.27,-9243 6440.27,-9243 6440.27,-9243 9128.09,-9243 9128.09,-9243"/>
<polygon fill="black" stroke="black" points="9128.09,-9246.5 9138.09,-9243 9128.09,-9239.5 9128.09,-9246.5"/>
</g>
<!-- layer1_q_proj_gpu4 -->
<g id="node225" class="node">
<title>layer1_q_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="6641.77,-10316.16 6140.77,-10316.16 6140.77,-10248.16 6641.77,-10248.16 6641.77,-10316.16"/>
<text text-anchor="middle" x="6391.27" y="-10300.96" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6391.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6391.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6391.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_attn_norm_gpu4&#45;&gt;layer1_q_proj_gpu4 -->
<g id="edge288" class="edge">
<title>layer1_attn_norm_gpu4&#45;&gt;layer1_q_proj_gpu4</title>
<path fill="none" stroke="black" d="M6531.77,-10401.99C6531.77,-10401.99 6531.77,-10326.25 6531.77,-10326.25"/>
<polygon fill="black" stroke="black" points="6535.27,-10326.25 6531.77,-10316.25 6528.27,-10326.25 6535.27,-10326.25"/>
</g>
<!-- layer1_k_proj_gpu4 -->
<g id="node226" class="node">
<title>layer1_k_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="7200.77,-10316.16 6699.77,-10316.16 6699.77,-10248.16 7200.77,-10248.16 7200.77,-10316.16"/>
<text text-anchor="middle" x="6950.27" y="-10300.96" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6950.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6950.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6950.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_attn_norm_gpu4&#45;&gt;layer1_k_proj_gpu4 -->
<g id="edge289" class="edge">
<title>layer1_attn_norm_gpu4&#45;&gt;layer1_k_proj_gpu4</title>
<path fill="none" stroke="black" d="M6809.27,-10401.99C6809.27,-10401.99 6809.27,-10326.25 6809.27,-10326.25"/>
<polygon fill="black" stroke="black" points="6812.77,-10326.25 6809.27,-10316.25 6805.77,-10326.25 6812.77,-10326.25"/>
</g>
<!-- layer1_v_proj_gpu4 -->
<g id="node227" class="node">
<title>layer1_v_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="6082.77,-10316.16 5581.77,-10316.16 5581.77,-10248.16 6082.77,-10248.16 6082.77,-10316.16"/>
<text text-anchor="middle" x="5832.27" y="-10300.96" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5832.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5832.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5832.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_attn_norm_gpu4&#45;&gt;layer1_v_proj_gpu4 -->
<g id="edge290" class="edge">
<title>layer1_attn_norm_gpu4&#45;&gt;layer1_v_proj_gpu4</title>
<path fill="none" stroke="black" d="M6421.69,-10436C6197.05,-10436 5901.38,-10436 5901.38,-10436 5901.38,-10436 5901.38,-10326.3 5901.38,-10326.3"/>
<polygon fill="black" stroke="black" points="5904.88,-10326.3 5901.38,-10316.3 5897.88,-10326.3 5904.88,-10326.3"/>
</g>
<!-- layer1_gather_q_gpu4 -->
<g id="node228" class="node">
<title>layer1_gather_q_gpu4</title>
<ellipse fill="lightblue" stroke="black" cx="6281.27" cy="-10114.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="6281.27" y="-10132.88" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="6281.27" y="-10117.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6281.27" y="-10102.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6281.27" y="-10087.88" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_q_proj_gpu4&#45;&gt;layer1_gather_q_gpu4 -->
<g id="edge291" class="edge">
<title>layer1_q_proj_gpu4&#45;&gt;layer1_gather_q_gpu4</title>
<path fill="none" stroke="black" d="M6391.27,-10248.15C6391.27,-10248.15 6391.27,-10170.15 6391.27,-10170.15"/>
<polygon fill="black" stroke="black" points="6394.77,-10170.15 6391.27,-10160.15 6387.77,-10170.15 6394.77,-10170.15"/>
</g>
<!-- layer1_gather_k_gpu4 -->
<g id="node229" class="node">
<title>layer1_gather_k_gpu4</title>
<ellipse fill="lightblue" stroke="black" cx="7060.27" cy="-10114.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="7060.27" y="-10132.88" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="7060.27" y="-10117.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7060.27" y="-10102.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7060.27" y="-10087.88" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_k_proj_gpu4&#45;&gt;layer1_gather_k_gpu4 -->
<g id="edge292" class="edge">
<title>layer1_k_proj_gpu4&#45;&gt;layer1_gather_k_gpu4</title>
<path fill="none" stroke="black" d="M6950.27,-10248.15C6950.27,-10248.15 6950.27,-10170.15 6950.27,-10170.15"/>
<polygon fill="black" stroke="black" points="6953.77,-10170.15 6950.27,-10160.15 6946.77,-10170.15 6953.77,-10170.15"/>
</g>
<!-- layer1_gather_v_gpu4 -->
<g id="node230" class="node">
<title>layer1_gather_v_gpu4</title>
<ellipse fill="lightblue" stroke="black" cx="5923.27" cy="-9749.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="5923.27" y="-9768.55" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="5923.27" y="-9753.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5923.27" y="-9738.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5923.27" y="-9723.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_v_proj_gpu4&#45;&gt;layer1_gather_v_gpu4 -->
<g id="edge293" class="edge">
<title>layer1_v_proj_gpu4&#45;&gt;layer1_gather_v_gpu4</title>
<path fill="none" stroke="black" d="M5832.27,-10248.05C5832.27,-10248.05 5832.27,-9806.48 5832.27,-9806.48"/>
<polygon fill="black" stroke="black" points="5835.77,-9806.48 5832.27,-9796.48 5828.77,-9806.48 5835.77,-9806.48"/>
</g>
<!-- layer1_attn_scores_gpu4 -->
<g id="node231" class="node">
<title>layer1_attn_scores_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="7150.77,-9965.91 6611.77,-9965.91 6611.77,-9897.91 7150.77,-9897.91 7150.77,-9965.91"/>
<text text-anchor="middle" x="6881.27" y="-9950.71" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="6881.27" y="-9935.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6881.27" y="-9920.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="6881.27" y="-9905.71" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gather_q_gpu4&#45;&gt;layer1_attn_scores_gpu4 -->
<g id="edge294" class="edge">
<title>layer1_gather_q_gpu4&#45;&gt;layer1_attn_scores_gpu4</title>
<path fill="none" stroke="black" d="M6626.83,-10100.09C6626.83,-10100.09 6626.83,-9976.15 6626.83,-9976.15"/>
<polygon fill="black" stroke="black" points="6630.33,-9976.15 6626.83,-9966.15 6623.33,-9976.15 6630.33,-9976.15"/>
</g>
<!-- layer1_gather_k_gpu4&#45;&gt;layer1_attn_scores_gpu4 -->
<g id="edge295" class="edge">
<title>layer1_gather_k_gpu4&#45;&gt;layer1_attn_scores_gpu4</title>
<path fill="none" stroke="black" d="M6925.2,-10069.05C6925.2,-10069.05 6925.2,-9976.14 6925.2,-9976.14"/>
<polygon fill="black" stroke="black" points="6928.7,-9976.14 6925.2,-9966.14 6921.7,-9976.14 6928.7,-9976.14"/>
</g>
<!-- layer1_attn_out_gpu4 -->
<g id="node233" class="node">
<title>layer1_attn_out_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="7144.77,-9615.66 6617.77,-9615.66 6617.77,-9547.66 7144.77,-9547.66 7144.77,-9615.66"/>
<text text-anchor="middle" x="6881.27" y="-9600.46" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="6881.27" y="-9585.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="6881.27" y="-9570.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6881.27" y="-9555.46" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_gather_v_gpu4&#45;&gt;layer1_attn_out_gpu4 -->
<g id="edge298" class="edge">
<title>layer1_gather_v_gpu4&#45;&gt;layer1_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M6254.52,-9730.72C6254.52,-9688.76 6254.52,-9592 6254.52,-9592 6254.52,-9592 6607.74,-9592 6607.74,-9592"/>
<polygon fill="black" stroke="black" points="6607.74,-9595.5 6617.74,-9592 6607.74,-9588.5 6607.74,-9595.5"/>
</g>
<!-- layer1_softmax_gpu4 -->
<g id="node232" class="node">
<title>layer1_softmax_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="7150.77,-9783.75 6611.77,-9783.75 6611.77,-9715.75 7150.77,-9715.75 7150.77,-9783.75"/>
<text text-anchor="middle" x="6881.27" y="-9768.55" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="6881.27" y="-9753.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="6881.27" y="-9738.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="6881.27" y="-9723.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_attn_scores_gpu4&#45;&gt;layer1_softmax_gpu4 -->
<g id="edge296" class="edge">
<title>layer1_attn_scores_gpu4&#45;&gt;layer1_softmax_gpu4</title>
<path fill="none" stroke="black" d="M6881.27,-9897.65C6881.27,-9897.65 6881.27,-9793.86 6881.27,-9793.86"/>
<polygon fill="black" stroke="black" points="6884.77,-9793.86 6881.27,-9783.86 6877.77,-9793.86 6884.77,-9793.86"/>
</g>
<!-- layer1_softmax_gpu4&#45;&gt;layer1_attn_out_gpu4 -->
<g id="edge297" class="edge">
<title>layer1_softmax_gpu4&#45;&gt;layer1_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M6881.27,-9715.73C6881.27,-9715.73 6881.27,-9625.92 6881.27,-9625.92"/>
<polygon fill="black" stroke="black" points="6884.77,-9625.92 6881.27,-9615.92 6877.77,-9625.92 6884.77,-9625.92"/>
</g>
<!-- layer1_out_proj_gpu4 -->
<g id="node234" class="node">
<title>layer1_out_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="7741.77,-9461.66 7252.77,-9461.66 7252.77,-9393.66 7741.77,-9393.66 7741.77,-9461.66"/>
<text text-anchor="middle" x="7497.27" y="-9446.46" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7497.27" y="-9431.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7497.27" y="-9416.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="7497.27" y="-9401.46" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_attn_out_gpu4&#45;&gt;layer1_out_proj_gpu4 -->
<g id="edge299" class="edge">
<title>layer1_attn_out_gpu4&#45;&gt;layer1_out_proj_gpu4</title>
<path fill="none" stroke="black" d="M6914.77,-9547.34C6914.77,-9501.77 6914.77,-9427 6914.77,-9427 6914.77,-9427 7242.77,-9427 7242.77,-9427"/>
<polygon fill="black" stroke="black" points="7242.77,-9430.5 7252.77,-9427 7242.77,-9423.5 7242.77,-9430.5"/>
</g>
<!-- layer1_out_proj_gpu4&#45;&gt;layer1_attn_all_reduce -->
<g id="edge343" class="edge">
<title>layer1_out_proj_gpu4&#45;&gt;layer1_attn_all_reduce</title>
<path fill="none" stroke="black" d="M7497.27,-9393.4C7497.27,-9348.39 7497.27,-9275 7497.27,-9275 7497.27,-9275 9125.31,-9275 9125.31,-9275"/>
<polygon fill="black" stroke="black" points="9125.31,-9278.5 9135.31,-9275 9125.31,-9271.5 9125.31,-9278.5"/>
</g>
<!-- layer1_q_proj_gpu5 -->
<g id="node236" class="node">
<title>layer1_q_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="8318.77,-10316.16 7817.77,-10316.16 7817.77,-10248.16 8318.77,-10248.16 8318.77,-10316.16"/>
<text text-anchor="middle" x="8068.27" y="-10300.96" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8068.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8068.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8068.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_attn_norm_gpu5&#45;&gt;layer1_q_proj_gpu5 -->
<g id="edge301" class="edge">
<title>layer1_attn_norm_gpu5&#45;&gt;layer1_q_proj_gpu5</title>
<path fill="none" stroke="black" d="M8209.27,-10401.99C8209.27,-10401.99 8209.27,-10326.25 8209.27,-10326.25"/>
<polygon fill="black" stroke="black" points="8212.77,-10326.25 8209.27,-10316.25 8205.77,-10326.25 8212.77,-10326.25"/>
</g>
<!-- layer1_k_proj_gpu5 -->
<g id="node237" class="node">
<title>layer1_k_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="8877.77,-10316.16 8376.77,-10316.16 8376.77,-10248.16 8877.77,-10248.16 8877.77,-10316.16"/>
<text text-anchor="middle" x="8627.27" y="-10300.96" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8627.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8627.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8627.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_attn_norm_gpu5&#45;&gt;layer1_k_proj_gpu5 -->
<g id="edge302" class="edge">
<title>layer1_attn_norm_gpu5&#45;&gt;layer1_k_proj_gpu5</title>
<path fill="none" stroke="black" d="M8486.77,-10401.99C8486.77,-10401.99 8486.77,-10326.25 8486.77,-10326.25"/>
<polygon fill="black" stroke="black" points="8490.27,-10326.25 8486.77,-10316.25 8483.27,-10326.25 8490.27,-10326.25"/>
</g>
<!-- layer1_v_proj_gpu5 -->
<g id="node238" class="node">
<title>layer1_v_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="7759.77,-10316.16 7258.77,-10316.16 7258.77,-10248.16 7759.77,-10248.16 7759.77,-10316.16"/>
<text text-anchor="middle" x="7509.27" y="-10300.96" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7509.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7509.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7509.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_attn_norm_gpu5&#45;&gt;layer1_v_proj_gpu5 -->
<g id="edge303" class="edge">
<title>layer1_attn_norm_gpu5&#45;&gt;layer1_v_proj_gpu5</title>
<path fill="none" stroke="black" d="M8099.66,-10436C7852.28,-10436 7509.27,-10436 7509.27,-10436 7509.27,-10436 7509.27,-10326.3 7509.27,-10326.3"/>
<polygon fill="black" stroke="black" points="7512.77,-10326.3 7509.27,-10316.3 7505.77,-10326.3 7512.77,-10326.3"/>
</g>
<!-- layer1_gather_q_gpu5 -->
<g id="node239" class="node">
<title>layer1_gather_q_gpu5</title>
<ellipse fill="lightblue" stroke="black" cx="7958.27" cy="-10114.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="7958.27" y="-10132.88" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="7958.27" y="-10117.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7958.27" y="-10102.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7958.27" y="-10087.88" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_q_proj_gpu5&#45;&gt;layer1_gather_q_gpu5 -->
<g id="edge304" class="edge">
<title>layer1_q_proj_gpu5&#45;&gt;layer1_gather_q_gpu5</title>
<path fill="none" stroke="black" d="M8068.27,-10248.15C8068.27,-10248.15 8068.27,-10170.15 8068.27,-10170.15"/>
<polygon fill="black" stroke="black" points="8071.77,-10170.15 8068.27,-10160.15 8064.77,-10170.15 8071.77,-10170.15"/>
</g>
<!-- layer1_gather_k_gpu5 -->
<g id="node240" class="node">
<title>layer1_gather_k_gpu5</title>
<ellipse fill="lightblue" stroke="black" cx="8737.27" cy="-10114.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="8737.27" y="-10132.88" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="8737.27" y="-10117.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8737.27" y="-10102.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8737.27" y="-10087.88" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_k_proj_gpu5&#45;&gt;layer1_gather_k_gpu5 -->
<g id="edge305" class="edge">
<title>layer1_k_proj_gpu5&#45;&gt;layer1_gather_k_gpu5</title>
<path fill="none" stroke="black" d="M8627.27,-10248.15C8627.27,-10248.15 8627.27,-10170.15 8627.27,-10170.15"/>
<polygon fill="black" stroke="black" points="8630.77,-10170.15 8627.27,-10160.15 8623.77,-10170.15 8630.77,-10170.15"/>
</g>
<!-- layer1_gather_v_gpu5 -->
<g id="node241" class="node">
<title>layer1_gather_v_gpu5</title>
<ellipse fill="lightblue" stroke="black" cx="7615.27" cy="-9931.91" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="7615.27" y="-9950.71" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="7615.27" y="-9935.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7615.27" y="-9920.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7615.27" y="-9905.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_v_proj_gpu5&#45;&gt;layer1_gather_v_gpu5 -->
<g id="edge306" class="edge">
<title>layer1_v_proj_gpu5&#45;&gt;layer1_gather_v_gpu5</title>
<path fill="none" stroke="black" d="M7509.27,-10247.94C7509.27,-10247.94 7509.27,-9988.11 7509.27,-9988.11"/>
<polygon fill="black" stroke="black" points="7512.77,-9988.11 7509.27,-9978.11 7505.77,-9988.11 7512.77,-9988.11"/>
</g>
<!-- layer1_attn_scores_gpu5 -->
<g id="node242" class="node">
<title>layer1_attn_scores_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="8722.77,-9965.91 8183.77,-9965.91 8183.77,-9897.91 8722.77,-9897.91 8722.77,-9965.91"/>
<text text-anchor="middle" x="8453.27" y="-9950.71" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="8453.27" y="-9935.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8453.27" y="-9920.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="8453.27" y="-9905.71" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gather_q_gpu5&#45;&gt;layer1_attn_scores_gpu5 -->
<g id="edge307" class="edge">
<title>layer1_gather_q_gpu5&#45;&gt;layer1_attn_scores_gpu5</title>
<path fill="none" stroke="black" d="M8251.33,-10086.02C8251.33,-10086.02 8251.33,-9976.23 8251.33,-9976.23"/>
<polygon fill="black" stroke="black" points="8254.83,-9976.23 8251.33,-9966.23 8247.83,-9976.23 8254.83,-9976.23"/>
</g>
<!-- layer1_gather_k_gpu5&#45;&gt;layer1_attn_scores_gpu5 -->
<g id="edge308" class="edge">
<title>layer1_gather_k_gpu5&#45;&gt;layer1_attn_scores_gpu5</title>
<path fill="none" stroke="black" d="M8549.7,-10072.74C8549.7,-10072.74 8549.7,-9976.07 8549.7,-9976.07"/>
<polygon fill="black" stroke="black" points="8553.2,-9976.07 8549.7,-9966.07 8546.2,-9976.07 8553.2,-9976.07"/>
</g>
<!-- layer1_attn_out_gpu5 -->
<g id="node244" class="node">
<title>layer1_attn_out_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="8716.77,-9615.66 8189.77,-9615.66 8189.77,-9547.66 8716.77,-9547.66 8716.77,-9615.66"/>
<text text-anchor="middle" x="8453.27" y="-9600.46" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="8453.27" y="-9585.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="8453.27" y="-9570.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8453.27" y="-9555.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_gather_v_gpu5&#45;&gt;layer1_attn_out_gpu5 -->
<g id="edge311" class="edge">
<title>layer1_gather_v_gpu5&#45;&gt;layer1_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M7858.83,-9896.33C7858.83,-9807.12 7858.83,-9581 7858.83,-9581 7858.83,-9581 8179.51,-9581 8179.51,-9581"/>
<polygon fill="black" stroke="black" points="8179.51,-9584.5 8189.51,-9581 8179.51,-9577.5 8179.51,-9584.5"/>
</g>
<!-- layer1_softmax_gpu5 -->
<g id="node243" class="node">
<title>layer1_softmax_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="8722.77,-9783.75 8183.77,-9783.75 8183.77,-9715.75 8722.77,-9715.75 8722.77,-9783.75"/>
<text text-anchor="middle" x="8453.27" y="-9768.55" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="8453.27" y="-9753.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="8453.27" y="-9738.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="8453.27" y="-9723.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_attn_scores_gpu5&#45;&gt;layer1_softmax_gpu5 -->
<g id="edge309" class="edge">
<title>layer1_attn_scores_gpu5&#45;&gt;layer1_softmax_gpu5</title>
<path fill="none" stroke="black" d="M8453.27,-9897.65C8453.27,-9897.65 8453.27,-9793.86 8453.27,-9793.86"/>
<polygon fill="black" stroke="black" points="8456.77,-9793.86 8453.27,-9783.86 8449.77,-9793.86 8456.77,-9793.86"/>
</g>
<!-- layer1_softmax_gpu5&#45;&gt;layer1_attn_out_gpu5 -->
<g id="edge310" class="edge">
<title>layer1_softmax_gpu5&#45;&gt;layer1_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M8453.27,-9715.73C8453.27,-9715.73 8453.27,-9625.92 8453.27,-9625.92"/>
<polygon fill="black" stroke="black" points="8456.77,-9625.92 8453.27,-9615.92 8449.77,-9625.92 8456.77,-9625.92"/>
</g>
<!-- layer1_out_proj_gpu5 -->
<g id="node245" class="node">
<title>layer1_out_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="9095.77,-9461.66 8606.77,-9461.66 8606.77,-9393.66 9095.77,-9393.66 9095.77,-9461.66"/>
<text text-anchor="middle" x="8851.27" y="-9446.46" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8851.27" y="-9431.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8851.27" y="-9416.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="8851.27" y="-9401.46" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_attn_out_gpu5&#45;&gt;layer1_out_proj_gpu5 -->
<g id="edge312" class="edge">
<title>layer1_attn_out_gpu5&#45;&gt;layer1_out_proj_gpu5</title>
<path fill="none" stroke="black" d="M8661.77,-9547.49C8661.77,-9547.49 8661.77,-9471.75 8661.77,-9471.75"/>
<polygon fill="black" stroke="black" points="8665.27,-9471.75 8661.77,-9461.75 8658.27,-9471.75 8665.27,-9471.75"/>
</g>
<!-- layer1_out_proj_gpu5&#45;&gt;layer1_attn_all_reduce -->
<g id="edge344" class="edge">
<title>layer1_out_proj_gpu5&#45;&gt;layer1_attn_all_reduce</title>
<path fill="none" stroke="black" d="M9095.91,-9427C9133.88,-9427 9160.8,-9427 9160.8,-9427 9160.8,-9427 9160.8,-9293.21 9160.8,-9293.21"/>
<polygon fill="black" stroke="black" points="9164.3,-9293.21 9160.8,-9283.21 9157.3,-9293.21 9164.3,-9293.21"/>
</g>
<!-- layer1_q_proj_gpu6 -->
<g id="node247" class="node">
<title>layer1_q_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="9995.77,-10316.16 9494.77,-10316.16 9494.77,-10248.16 9995.77,-10248.16 9995.77,-10316.16"/>
<text text-anchor="middle" x="9745.27" y="-10300.96" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="9745.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9745.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9745.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_attn_norm_gpu6&#45;&gt;layer1_q_proj_gpu6 -->
<g id="edge314" class="edge">
<title>layer1_attn_norm_gpu6&#45;&gt;layer1_q_proj_gpu6</title>
<path fill="none" stroke="black" d="M9745.27,-10401.99C9745.27,-10401.99 9745.27,-10326.25 9745.27,-10326.25"/>
<polygon fill="black" stroke="black" points="9748.77,-10326.25 9745.27,-10316.25 9741.77,-10326.25 9748.77,-10326.25"/>
</g>
<!-- layer1_k_proj_gpu6 -->
<g id="node248" class="node">
<title>layer1_k_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="10554.77,-10316.16 10053.77,-10316.16 10053.77,-10248.16 10554.77,-10248.16 10554.77,-10316.16"/>
<text text-anchor="middle" x="10304.27" y="-10300.96" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="10304.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10304.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10304.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_attn_norm_gpu6&#45;&gt;layer1_k_proj_gpu6 -->
<g id="edge315" class="edge">
<title>layer1_attn_norm_gpu6&#45;&gt;layer1_k_proj_gpu6</title>
<path fill="none" stroke="black" d="M9994.1,-10436C10109.98,-10436 10222.66,-10436 10222.66,-10436 10222.66,-10436 10222.66,-10326.3 10222.66,-10326.3"/>
<polygon fill="black" stroke="black" points="10226.16,-10326.3 10222.66,-10316.3 10219.16,-10326.3 10226.16,-10326.3"/>
</g>
<!-- layer1_v_proj_gpu6 -->
<g id="node249" class="node">
<title>layer1_v_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="9436.77,-10316.16 8935.77,-10316.16 8935.77,-10248.16 9436.77,-10248.16 9436.77,-10316.16"/>
<text text-anchor="middle" x="9186.27" y="-10300.96" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="9186.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9186.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9186.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_attn_norm_gpu6&#45;&gt;layer1_v_proj_gpu6 -->
<g id="edge316" class="edge">
<title>layer1_attn_norm_gpu6&#45;&gt;layer1_v_proj_gpu6</title>
<path fill="none" stroke="black" d="M9496.66,-10424C9405.49,-10424 9324.17,-10424 9324.17,-10424 9324.17,-10424 9324.17,-10326.5 9324.17,-10326.5"/>
<polygon fill="black" stroke="black" points="9327.67,-10326.5 9324.17,-10316.5 9320.67,-10326.5 9327.67,-10326.5"/>
</g>
<!-- layer1_gather_q_gpu6 -->
<g id="node250" class="node">
<title>layer1_gather_q_gpu6</title>
<ellipse fill="lightblue" stroke="black" cx="9635.27" cy="-10114.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="9635.27" y="-10132.88" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="9635.27" y="-10117.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9635.27" y="-10102.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9635.27" y="-10087.88" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_q_proj_gpu6&#45;&gt;layer1_gather_q_gpu6 -->
<g id="edge317" class="edge">
<title>layer1_q_proj_gpu6&#45;&gt;layer1_gather_q_gpu6</title>
<path fill="none" stroke="black" d="M9745.27,-10248.15C9745.27,-10248.15 9745.27,-10170.15 9745.27,-10170.15"/>
<polygon fill="black" stroke="black" points="9748.77,-10170.15 9745.27,-10160.15 9741.77,-10170.15 9748.77,-10170.15"/>
</g>
<!-- layer1_gather_k_gpu6 -->
<g id="node251" class="node">
<title>layer1_gather_k_gpu6</title>
<ellipse fill="lightblue" stroke="black" cx="10414.27" cy="-10114.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="10414.27" y="-10132.88" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="10414.27" y="-10117.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10414.27" y="-10102.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10414.27" y="-10087.88" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_k_proj_gpu6&#45;&gt;layer1_gather_k_gpu6 -->
<g id="edge318" class="edge">
<title>layer1_k_proj_gpu6&#45;&gt;layer1_gather_k_gpu6</title>
<path fill="none" stroke="black" d="M10304.27,-10248.15C10304.27,-10248.15 10304.27,-10170.15 10304.27,-10170.15"/>
<polygon fill="black" stroke="black" points="10307.77,-10170.15 10304.27,-10160.15 10300.77,-10170.15 10307.77,-10170.15"/>
</g>
<!-- layer1_gather_v_gpu6 -->
<g id="node252" class="node">
<title>layer1_gather_v_gpu6</title>
<ellipse fill="lightblue" stroke="black" cx="9186.27" cy="-9749.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="9186.27" y="-9768.55" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="9186.27" y="-9753.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9186.27" y="-9738.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9186.27" y="-9723.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_v_proj_gpu6&#45;&gt;layer1_gather_v_gpu6 -->
<g id="edge319" class="edge">
<title>layer1_v_proj_gpu6&#45;&gt;layer1_gather_v_gpu6</title>
<path fill="none" stroke="black" d="M9186.27,-10248.05C9186.27,-10248.05 9186.27,-9808.07 9186.27,-9808.07"/>
<polygon fill="black" stroke="black" points="9189.77,-9808.07 9186.27,-9798.07 9182.77,-9808.07 9189.77,-9808.07"/>
</g>
<!-- layer1_attn_scores_gpu6 -->
<g id="node253" class="node">
<title>layer1_attn_scores_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="10143.77,-9965.91 9604.77,-9965.91 9604.77,-9897.91 10143.77,-9897.91 10143.77,-9965.91"/>
<text text-anchor="middle" x="9874.27" y="-9950.71" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="9874.27" y="-9935.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9874.27" y="-9920.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="9874.27" y="-9905.71" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gather_q_gpu6&#45;&gt;layer1_attn_scores_gpu6 -->
<g id="edge320" class="edge">
<title>layer1_gather_q_gpu6&#45;&gt;layer1_attn_scores_gpu6</title>
<path fill="none" stroke="black" d="M9800.33,-10070.91C9800.33,-10070.91 9800.33,-9975.97 9800.33,-9975.97"/>
<polygon fill="black" stroke="black" points="9803.83,-9975.97 9800.33,-9965.97 9796.83,-9975.97 9803.83,-9975.97"/>
</g>
<!-- layer1_gather_k_gpu6&#45;&gt;layer1_attn_scores_gpu6 -->
<g id="edge321" class="edge">
<title>layer1_gather_k_gpu6&#45;&gt;layer1_attn_scores_gpu6</title>
<path fill="none" stroke="black" d="M10098.7,-10090.64C10098.7,-10090.64 10098.7,-9976.13 10098.7,-9976.13"/>
<polygon fill="black" stroke="black" points="10102.2,-9976.13 10098.7,-9966.13 10095.2,-9976.13 10102.2,-9976.13"/>
</g>
<!-- layer1_attn_out_gpu6 -->
<g id="node255" class="node">
<title>layer1_attn_out_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="9731.77,-9615.66 9204.77,-9615.66 9204.77,-9547.66 9731.77,-9547.66 9731.77,-9615.66"/>
<text text-anchor="middle" x="9468.27" y="-9600.46" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="9468.27" y="-9585.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="9468.27" y="-9570.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9468.27" y="-9555.46" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_gather_v_gpu6&#45;&gt;layer1_attn_out_gpu6 -->
<g id="edge324" class="edge">
<title>layer1_gather_v_gpu6&#45;&gt;layer1_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M9375.83,-9708.63C9375.83,-9708.63 9375.83,-9625.85 9375.83,-9625.85"/>
<polygon fill="black" stroke="black" points="9379.33,-9625.85 9375.83,-9615.85 9372.33,-9625.85 9379.33,-9625.85"/>
</g>
<!-- layer1_softmax_gpu6 -->
<g id="node254" class="node">
<title>layer1_softmax_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="10143.77,-9783.75 9604.77,-9783.75 9604.77,-9715.75 10143.77,-9715.75 10143.77,-9783.75"/>
<text text-anchor="middle" x="9874.27" y="-9768.55" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="9874.27" y="-9753.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="9874.27" y="-9738.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="9874.27" y="-9723.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_attn_scores_gpu6&#45;&gt;layer1_softmax_gpu6 -->
<g id="edge322" class="edge">
<title>layer1_attn_scores_gpu6&#45;&gt;layer1_softmax_gpu6</title>
<path fill="none" stroke="black" d="M9874.27,-9897.65C9874.27,-9897.65 9874.27,-9793.86 9874.27,-9793.86"/>
<polygon fill="black" stroke="black" points="9877.77,-9793.86 9874.27,-9783.86 9870.77,-9793.86 9877.77,-9793.86"/>
</g>
<!-- layer1_softmax_gpu6&#45;&gt;layer1_attn_out_gpu6 -->
<g id="edge323" class="edge">
<title>layer1_softmax_gpu6&#45;&gt;layer1_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M9668.27,-9715.73C9668.27,-9715.73 9668.27,-9625.92 9668.27,-9625.92"/>
<polygon fill="black" stroke="black" points="9671.77,-9625.92 9668.27,-9615.92 9664.77,-9625.92 9671.77,-9625.92"/>
</g>
<!-- layer1_out_proj_gpu6 -->
<g id="node256" class="node">
<title>layer1_out_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="9712.77,-9461.66 9223.77,-9461.66 9223.77,-9393.66 9712.77,-9393.66 9712.77,-9461.66"/>
<text text-anchor="middle" x="9468.27" y="-9446.46" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9468.27" y="-9431.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9468.27" y="-9416.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="9468.27" y="-9401.46" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_attn_out_gpu6&#45;&gt;layer1_out_proj_gpu6 -->
<g id="edge325" class="edge">
<title>layer1_attn_out_gpu6&#45;&gt;layer1_out_proj_gpu6</title>
<path fill="none" stroke="black" d="M9468.27,-9547.49C9468.27,-9547.49 9468.27,-9471.75 9468.27,-9471.75"/>
<polygon fill="black" stroke="black" points="9471.77,-9471.75 9468.27,-9461.75 9464.77,-9471.75 9471.77,-9471.75"/>
</g>
<!-- layer1_out_proj_gpu6&#45;&gt;layer1_attn_all_reduce -->
<g id="edge345" class="edge">
<title>layer1_out_proj_gpu6&#45;&gt;layer1_attn_all_reduce</title>
<path fill="none" stroke="black" d="M9468.27,-9393.65C9468.27,-9393.65 9468.27,-9317.88 9468.27,-9317.88"/>
<polygon fill="black" stroke="black" points="9471.77,-9317.88 9468.27,-9307.88 9464.77,-9317.88 9471.77,-9317.88"/>
</g>
<!-- layer1_q_proj_gpu7 -->
<g id="node258" class="node">
<title>layer1_q_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="11672.77,-10316.16 11171.77,-10316.16 11171.77,-10248.16 11672.77,-10248.16 11672.77,-10316.16"/>
<text text-anchor="middle" x="11422.27" y="-10300.96" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="11422.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11422.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11422.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_attn_norm_gpu7&#45;&gt;layer1_q_proj_gpu7 -->
<g id="edge327" class="edge">
<title>layer1_attn_norm_gpu7&#45;&gt;layer1_q_proj_gpu7</title>
<path fill="none" stroke="black" d="M11281.27,-10401.99C11281.27,-10401.99 11281.27,-10326.25 11281.27,-10326.25"/>
<polygon fill="black" stroke="black" points="11284.77,-10326.25 11281.27,-10316.25 11277.77,-10326.25 11284.77,-10326.25"/>
</g>
<!-- layer1_k_proj_gpu7 -->
<g id="node259" class="node">
<title>layer1_k_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="12231.77,-10316.16 11730.77,-10316.16 11730.77,-10248.16 12231.77,-10248.16 12231.77,-10316.16"/>
<text text-anchor="middle" x="11981.27" y="-10300.96" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="11981.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11981.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11981.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_attn_norm_gpu7&#45;&gt;layer1_k_proj_gpu7 -->
<g id="edge328" class="edge">
<title>layer1_attn_norm_gpu7&#45;&gt;layer1_k_proj_gpu7</title>
<path fill="none" stroke="black" d="M11391.01,-10436C11656.89,-10436 12040.61,-10436 12040.61,-10436 12040.61,-10436 12040.61,-10326.3 12040.61,-10326.3"/>
<polygon fill="black" stroke="black" points="12044.11,-10326.3 12040.61,-10316.3 12037.11,-10326.3 12044.11,-10326.3"/>
</g>
<!-- layer1_v_proj_gpu7 -->
<g id="node260" class="node">
<title>layer1_v_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="11113.77,-10316.16 10612.77,-10316.16 10612.77,-10248.16 11113.77,-10248.16 11113.77,-10316.16"/>
<text text-anchor="middle" x="10863.27" y="-10300.96" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="10863.27" y="-10285.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10863.27" y="-10270.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10863.27" y="-10255.96" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_attn_norm_gpu7&#45;&gt;layer1_v_proj_gpu7 -->
<g id="edge329" class="edge">
<title>layer1_attn_norm_gpu7&#45;&gt;layer1_v_proj_gpu7</title>
<path fill="none" stroke="black" d="M11003.77,-10401.99C11003.77,-10401.99 11003.77,-10326.25 11003.77,-10326.25"/>
<polygon fill="black" stroke="black" points="11007.27,-10326.25 11003.77,-10316.25 11000.27,-10326.25 11007.27,-10326.25"/>
</g>
<!-- layer1_gather_q_gpu7 -->
<g id="node261" class="node">
<title>layer1_gather_q_gpu7</title>
<ellipse fill="lightblue" stroke="black" cx="11312.27" cy="-10114.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="11312.27" y="-10132.88" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="11312.27" y="-10117.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11312.27" y="-10102.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11312.27" y="-10087.88" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_q_proj_gpu7&#45;&gt;layer1_gather_q_gpu7 -->
<g id="edge330" class="edge">
<title>layer1_q_proj_gpu7&#45;&gt;layer1_gather_q_gpu7</title>
<path fill="none" stroke="black" d="M11422.27,-10248.15C11422.27,-10248.15 11422.27,-10170.15 11422.27,-10170.15"/>
<polygon fill="black" stroke="black" points="11425.77,-10170.15 11422.27,-10160.15 11418.77,-10170.15 11425.77,-10170.15"/>
</g>
<!-- layer1_gather_k_gpu7 -->
<g id="node262" class="node">
<title>layer1_gather_k_gpu7</title>
<ellipse fill="lightblue" stroke="black" cx="12091.27" cy="-10114.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="12091.27" y="-10132.88" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="12091.27" y="-10117.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12091.27" y="-10102.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12091.27" y="-10087.88" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_k_proj_gpu7&#45;&gt;layer1_gather_k_gpu7 -->
<g id="edge331" class="edge">
<title>layer1_k_proj_gpu7&#45;&gt;layer1_gather_k_gpu7</title>
<path fill="none" stroke="black" d="M11981.27,-10248.15C11981.27,-10248.15 11981.27,-10170.15 11981.27,-10170.15"/>
<polygon fill="black" stroke="black" points="11984.77,-10170.15 11981.27,-10160.15 11977.77,-10170.15 11984.77,-10170.15"/>
</g>
<!-- layer1_gather_v_gpu7 -->
<g id="node263" class="node">
<title>layer1_gather_v_gpu7</title>
<ellipse fill="lightblue" stroke="black" cx="10744.27" cy="-9931.91" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="10744.27" y="-9950.71" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="10744.27" y="-9935.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10744.27" y="-9920.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10744.27" y="-9905.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_v_proj_gpu7&#45;&gt;layer1_gather_v_gpu7 -->
<g id="edge332" class="edge">
<title>layer1_v_proj_gpu7&#45;&gt;layer1_gather_v_gpu7</title>
<path fill="none" stroke="black" d="M10863.27,-10247.94C10863.27,-10247.94 10863.27,-9987.52 10863.27,-9987.52"/>
<polygon fill="black" stroke="black" points="10866.77,-9987.52 10863.27,-9977.52 10859.77,-9987.52 10866.77,-9987.52"/>
</g>
<!-- layer1_attn_scores_gpu7 -->
<g id="node264" class="node">
<title>layer1_attn_scores_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="11701.77,-9965.91 11162.77,-9965.91 11162.77,-9897.91 11701.77,-9897.91 11701.77,-9965.91"/>
<text text-anchor="middle" x="11432.27" y="-9950.71" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="11432.27" y="-9935.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11432.27" y="-9920.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="11432.27" y="-9905.71" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gather_q_gpu7&#45;&gt;layer1_attn_scores_gpu7 -->
<g id="edge333" class="edge">
<title>layer1_gather_q_gpu7&#45;&gt;layer1_attn_scores_gpu7</title>
<path fill="none" stroke="black" d="M11417.83,-10067.64C11417.83,-10067.64 11417.83,-9976.19 11417.83,-9976.19"/>
<polygon fill="black" stroke="black" points="11421.33,-9976.19 11417.83,-9966.19 11414.33,-9976.19 11421.33,-9976.19"/>
</g>
<!-- layer1_gather_k_gpu7&#45;&gt;layer1_attn_scores_gpu7 -->
<g id="edge334" class="edge">
<title>layer1_gather_k_gpu7&#45;&gt;layer1_attn_scores_gpu7</title>
<path fill="none" stroke="black" d="M11730.56,-10114C11703.99,-10114 11687.33,-10114 11687.33,-10114 11687.33,-10114 11687.33,-9976.16 11687.33,-9976.16"/>
<polygon fill="black" stroke="black" points="11690.83,-9976.16 11687.33,-9966.16 11683.83,-9976.16 11690.83,-9976.16"/>
</g>
<!-- layer1_attn_out_gpu7 -->
<g id="node266" class="node">
<title>layer1_attn_out_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="11007.77,-9615.66 10480.77,-9615.66 10480.77,-9547.66 11007.77,-9547.66 11007.77,-9615.66"/>
<text text-anchor="middle" x="10744.27" y="-9600.46" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="10744.27" y="-9585.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="10744.27" y="-9570.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10744.27" y="-9555.46" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_gather_v_gpu7&#45;&gt;layer1_attn_out_gpu7 -->
<g id="edge337" class="edge">
<title>layer1_gather_v_gpu7&#45;&gt;layer1_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M10739.27,-9883.58C10739.27,-9883.58 10739.27,-9625.82 10739.27,-9625.82"/>
<polygon fill="black" stroke="black" points="10742.77,-9625.82 10739.27,-9615.82 10735.77,-9625.82 10742.77,-9625.82"/>
</g>
<!-- layer1_softmax_gpu7 -->
<g id="node265" class="node">
<title>layer1_softmax_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="11536.77,-9783.75 10997.77,-9783.75 10997.77,-9715.75 11536.77,-9715.75 11536.77,-9783.75"/>
<text text-anchor="middle" x="11267.27" y="-9768.55" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="11267.27" y="-9753.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="11267.27" y="-9738.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="11267.27" y="-9723.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_attn_scores_gpu7&#45;&gt;layer1_softmax_gpu7 -->
<g id="edge335" class="edge">
<title>layer1_attn_scores_gpu7&#45;&gt;layer1_softmax_gpu7</title>
<path fill="none" stroke="black" d="M11349.77,-9897.65C11349.77,-9897.65 11349.77,-9793.86 11349.77,-9793.86"/>
<polygon fill="black" stroke="black" points="11353.27,-9793.86 11349.77,-9783.86 11346.27,-9793.86 11353.27,-9793.86"/>
</g>
<!-- layer1_softmax_gpu7&#45;&gt;layer1_attn_out_gpu7 -->
<g id="edge336" class="edge">
<title>layer1_softmax_gpu7&#45;&gt;layer1_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M11002.77,-9715.73C11002.77,-9715.73 11002.77,-9625.92 11002.77,-9625.92"/>
<polygon fill="black" stroke="black" points="11006.27,-9625.92 11002.77,-9615.92 10999.27,-9625.92 11006.27,-9625.92"/>
</g>
<!-- layer1_out_proj_gpu7 -->
<g id="node267" class="node">
<title>layer1_out_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="10824.77,-9461.66 10335.77,-9461.66 10335.77,-9393.66 10824.77,-9393.66 10824.77,-9461.66"/>
<text text-anchor="middle" x="10580.27" y="-9446.46" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10580.27" y="-9431.46" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10580.27" y="-9416.46" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="10580.27" y="-9401.46" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_attn_out_gpu7&#45;&gt;layer1_out_proj_gpu7 -->
<g id="edge338" class="edge">
<title>layer1_attn_out_gpu7&#45;&gt;layer1_out_proj_gpu7</title>
<path fill="none" stroke="black" d="M10652.77,-9547.49C10652.77,-9547.49 10652.77,-9471.75 10652.77,-9471.75"/>
<polygon fill="black" stroke="black" points="10656.27,-9471.75 10652.77,-9461.75 10649.27,-9471.75 10656.27,-9471.75"/>
</g>
<!-- layer1_out_proj_gpu7&#45;&gt;layer1_attn_all_reduce -->
<g id="edge346" class="edge">
<title>layer1_out_proj_gpu7&#45;&gt;layer1_attn_all_reduce</title>
<path fill="none" stroke="black" d="M10335.6,-9427C10098.9,-9427 9775.73,-9427 9775.73,-9427 9775.73,-9427 9775.73,-9293.21 9775.73,-9293.21"/>
<polygon fill="black" stroke="black" points="9779.23,-9293.21 9775.73,-9283.21 9772.23,-9293.21 9779.23,-9293.21"/>
</g>
<!-- layer1_attn_all_reduce&#45;&gt;layer1_attn_residual -->
<g id="edge348" class="edge">
<title>layer1_attn_all_reduce&#45;&gt;layer1_attn_residual</title>
<path fill="none" stroke="black" d="M9145.77,-9240.39C9145.77,-9193.51 9145.77,-9077 9145.77,-9077 9145.77,-9077 7157.76,-9077 7157.76,-9077"/>
<polygon fill="black" stroke="black" points="7157.76,-9073.5 7147.76,-9077 7157.76,-9080.5 7157.76,-9073.5"/>
</g>
<!-- layer1_broadcast_to_moe -->
<g id="node270" class="node">
<title>layer1_broadcast_to_moe</title>
<ellipse fill="lightblue" stroke="black" cx="8823.27" cy="-8895.25" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="8823.27" y="-8914.05" font-family="Times,serif" font-size="14.00">Broadcast to MoE GPUs</text>
<text text-anchor="middle" x="8823.27" y="-8899.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8823.27" y="-8884.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8823.27" y="-8869.05" font-family="Times,serif" font-size="14.00">GPU: GPUs 8&#45;15</text>
</g>
<!-- layer1_attn_residual&#45;&gt;layer1_broadcast_to_moe -->
<g id="edge349" class="edge">
<title>layer1_attn_residual&#45;&gt;layer1_broadcast_to_moe</title>
<path fill="none" stroke="black" d="M7058.17,-9053C7661.59,-9053 8539.3,-9053 8539.3,-9053 8539.3,-9053 8539.3,-8933.82 8539.3,-8933.82"/>
<polygon fill="black" stroke="black" points="8542.8,-8933.81 8539.3,-8923.82 8535.8,-8933.82 8542.8,-8933.81"/>
</g>
<!-- layer1_final_residual -->
<g id="node354" class="node">
<title>layer1_final_residual</title>
<ellipse fill="lightblue" stroke="black" cx="6560.27" cy="-7248.91" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="6560.27" y="-7267.71" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="6560.27" y="-7252.71" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096], [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6560.27" y="-7237.71" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6560.27" y="-7222.71" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer1_attn_residual&#45;&gt;layer1_final_residual -->
<g id="edge464" class="edge">
<title>layer1_attn_residual&#45;&gt;layer1_final_residual</title>
<path fill="none" stroke="black" d="M6949.27,-9042.72C6949.27,-8880.64 6949.27,-8206 6949.27,-8206 6949.27,-8206 6861.77,-8206 6861.77,-8206 6861.77,-8206 6861.77,-7301.59 6861.77,-7301.59"/>
<polygon fill="black" stroke="black" points="6865.27,-7301.59 6861.77,-7291.59 6858.27,-7301.59 6865.27,-7301.59"/>
</g>
<!-- layer1_moe_norm -->
<g id="node271" class="node">
<title>layer1_moe_norm</title>
<polygon fill="lightyellow" stroke="black" points="11098.77,-8761.16 10601.77,-8761.16 10601.77,-8693.16 11098.77,-8693.16 11098.77,-8761.16"/>
<text text-anchor="middle" x="10850.27" y="-8745.96" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="10850.27" y="-8730.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10850.27" y="-8715.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10850.27" y="-8700.96" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer1_broadcast_to_moe&#45;&gt;layer1_moe_norm -->
<g id="edge350" class="edge">
<title>layer1_broadcast_to_moe&#45;&gt;layer1_moe_norm</title>
<path fill="none" stroke="black" d="M9140.57,-8874.56C9140.57,-8835.11 9140.57,-8753 9140.57,-8753 9140.57,-8753 10591.66,-8753 10591.66,-8753"/>
<polygon fill="black" stroke="black" points="10591.66,-8756.5 10601.66,-8753 10591.66,-8749.5 10591.66,-8756.5"/>
</g>
<!-- layer1_gate -->
<g id="node272" class="node">
<title>layer1_gate</title>
<polygon fill="lightpink" stroke="black" points="11648.92,-8607.16 10849.31,-8607.16 10643.62,-8471.16 11443.22,-8471.16 11648.92,-8607.16"/>
<text text-anchor="middle" x="11146.27" y="-8557.96" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="11146.27" y="-8542.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11146.27" y="-8527.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="11146.27" y="-8512.96" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer1_moe_norm&#45;&gt;layer1_gate -->
<g id="edge351" class="edge">
<title>layer1_moe_norm&#45;&gt;layer1_gate</title>
<path fill="none" stroke="black" d="M10871.1,-8693.12C10871.1,-8693.12 10871.1,-8617.23 10871.1,-8617.23"/>
<polygon fill="black" stroke="black" points="10874.6,-8617.23 10871.1,-8607.23 10867.6,-8617.23 10874.6,-8617.23"/>
</g>
<!-- layer1_route_expert0 -->
<g id="node273" class="node">
<title>layer1_route_expert0</title>
<polygon fill="lightpink" stroke="black" points="14367.92,-8385.16 13568.31,-8385.16 13362.62,-8249.16 14162.22,-8249.16 14367.92,-8385.16"/>
<text text-anchor="middle" x="13865.27" y="-8335.96" font-family="Times,serif" font-size="14.00">Route to Expert 0</text>
<text text-anchor="middle" x="13865.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13865.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="13865.27" y="-8290.96" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_moe_norm&#45;&gt;layer1_route_expert0 -->
<g id="edge353" class="edge">
<title>layer1_moe_norm&#45;&gt;layer1_route_expert0</title>
<path fill="none" stroke="black" d="M11098.86,-8715C11779.67,-8715 13623.99,-8715 13623.99,-8715 13623.99,-8715 13623.99,-8395.55 13623.99,-8395.55"/>
<polygon fill="black" stroke="black" points="13627.49,-8395.55 13623.99,-8385.55 13620.49,-8395.55 13627.49,-8395.55"/>
</g>
<!-- layer1_route_expert1 -->
<g id="node278" class="node">
<title>layer1_route_expert1</title>
<polygon fill="lightpink" stroke="black" points="15431.92,-8385.16 14632.31,-8385.16 14426.62,-8249.16 15226.22,-8249.16 15431.92,-8385.16"/>
<text text-anchor="middle" x="14929.27" y="-8335.96" font-family="Times,serif" font-size="14.00">Route to Expert 1</text>
<text text-anchor="middle" x="14929.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14929.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="14929.27" y="-8290.96" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_moe_norm&#45;&gt;layer1_route_expert1 -->
<g id="edge359" class="edge">
<title>layer1_moe_norm&#45;&gt;layer1_route_expert1</title>
<path fill="none" stroke="black" d="M11098.82,-8723C11942.4,-8723 14643.99,-8723 14643.99,-8723 14643.99,-8723 14643.99,-8395.55 14643.99,-8395.55"/>
<polygon fill="black" stroke="black" points="14647.49,-8395.55 14643.99,-8385.55 14640.49,-8395.55 14647.49,-8395.55"/>
</g>
<!-- layer1_route_expert2 -->
<g id="node283" class="node">
<title>layer1_route_expert2</title>
<polygon fill="lightpink" stroke="black" points="16495.92,-8385.16 15696.31,-8385.16 15490.62,-8249.16 16290.22,-8249.16 16495.92,-8385.16"/>
<text text-anchor="middle" x="15993.27" y="-8335.96" font-family="Times,serif" font-size="14.00">Route to Expert 2</text>
<text text-anchor="middle" x="15993.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15993.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="15993.27" y="-8290.96" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_moe_norm&#45;&gt;layer1_route_expert2 -->
<g id="edge365" class="edge">
<title>layer1_moe_norm&#45;&gt;layer1_route_expert2</title>
<path fill="none" stroke="black" d="M11099,-8730C12066.09,-8730 15522.66,-8730 15522.66,-8730 15522.66,-8730 15522.66,-8327.24 15522.66,-8327.24"/>
<polygon fill="black" stroke="black" points="15526.16,-8327.24 15522.66,-8317.24 15519.16,-8327.24 15526.16,-8327.24"/>
</g>
<!-- layer1_route_expert3 -->
<g id="node288" class="node">
<title>layer1_route_expert3</title>
<polygon fill="lightpink" stroke="black" points="17559.92,-8385.16 16760.31,-8385.16 16554.62,-8249.16 17354.22,-8249.16 17559.92,-8385.16"/>
<text text-anchor="middle" x="17057.27" y="-8335.96" font-family="Times,serif" font-size="14.00">Route to Expert 3</text>
<text text-anchor="middle" x="17057.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17057.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="17057.27" y="-8290.96" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_moe_norm&#45;&gt;layer1_route_expert3 -->
<g id="edge371" class="edge">
<title>layer1_moe_norm&#45;&gt;layer1_route_expert3</title>
<path fill="none" stroke="black" d="M11098.91,-8738C12213.02,-8738 16691.32,-8738 16691.32,-8738 16691.32,-8738 16691.32,-8349.79 16691.32,-8349.79"/>
<polygon fill="black" stroke="black" points="16694.82,-8349.79 16691.32,-8339.79 16687.82,-8349.79 16694.82,-8349.79"/>
</g>
<!-- layer1_route_expert4 -->
<g id="node293" class="node">
<title>layer1_route_expert4</title>
<polygon fill="lightpink" stroke="black" points="18623.92,-8385.16 17824.31,-8385.16 17618.62,-8249.16 18418.22,-8249.16 18623.92,-8385.16"/>
<text text-anchor="middle" x="18121.27" y="-8335.96" font-family="Times,serif" font-size="14.00">Route to Expert 4</text>
<text text-anchor="middle" x="18121.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18121.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="18121.27" y="-8290.96" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_moe_norm&#45;&gt;layer1_route_expert4 -->
<g id="edge377" class="edge">
<title>layer1_moe_norm&#45;&gt;layer1_route_expert4</title>
<path fill="none" stroke="black" d="M11098.96,-8746C12321.25,-8746 17633.17,-8746 17633.17,-8746 17633.17,-8746 17633.17,-8327.24 17633.17,-8327.24"/>
<polygon fill="black" stroke="black" points="17636.67,-8327.24 17633.17,-8317.24 17629.67,-8327.24 17636.67,-8327.24"/>
</g>
<!-- layer1_route_expert5 -->
<g id="node298" class="node">
<title>layer1_route_expert5</title>
<polygon fill="lightpink" stroke="black" points="19687.92,-8385.16 18888.31,-8385.16 18682.62,-8249.16 19482.22,-8249.16 19687.92,-8385.16"/>
<text text-anchor="middle" x="19185.27" y="-8335.96" font-family="Times,serif" font-size="14.00">Route to Expert 5</text>
<text text-anchor="middle" x="19185.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19185.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="19185.27" y="-8290.96" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_moe_norm&#45;&gt;layer1_route_expert5 -->
<g id="edge383" class="edge">
<title>layer1_moe_norm&#45;&gt;layer1_route_expert5</title>
<path fill="none" stroke="black" d="M11098.87,-8753C12436.11,-8753 18713.84,-8753 18713.84,-8753 18713.84,-8753 18713.84,-8327.24 18713.84,-8327.24"/>
<polygon fill="black" stroke="black" points="18717.34,-8327.24 18713.84,-8317.24 18710.34,-8327.24 18717.34,-8327.24"/>
</g>
<!-- layer1_route_expert6 -->
<g id="node303" class="node">
<title>layer1_route_expert6</title>
<polygon fill="lightpink" stroke="black" points="3727.92,-8385.16 2928.31,-8385.16 2722.62,-8249.16 3522.22,-8249.16 3727.92,-8385.16"/>
<text text-anchor="middle" x="3225.27" y="-8335.96" font-family="Times,serif" font-size="14.00">Route to Expert 6</text>
<text text-anchor="middle" x="3225.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3225.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="3225.27" y="-8290.96" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_moe_norm&#45;&gt;layer1_route_expert6 -->
<g id="edge389" class="edge">
<title>layer1_moe_norm&#45;&gt;layer1_route_expert6</title>
<path fill="none" stroke="black" d="M10601.73,-8746C9271.94,-8746 3057.66,-8746 3057.66,-8746 3057.66,-8746 3057.66,-8395.59 3057.66,-8395.59"/>
<polygon fill="black" stroke="black" points="3061.16,-8395.59 3057.66,-8385.59 3054.16,-8395.59 3061.16,-8395.59"/>
</g>
<!-- layer1_route_expert7 -->
<g id="node308" class="node">
<title>layer1_route_expert7</title>
<polygon fill="lightpink" stroke="black" points="4791.92,-8385.16 3992.31,-8385.16 3786.62,-8249.16 4586.22,-8249.16 4791.92,-8385.16"/>
<text text-anchor="middle" x="4289.27" y="-8335.96" font-family="Times,serif" font-size="14.00">Route to Expert 7</text>
<text text-anchor="middle" x="4289.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4289.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="4289.27" y="-8290.96" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_moe_norm&#45;&gt;layer1_route_expert7 -->
<g id="edge395" class="edge">
<title>layer1_moe_norm&#45;&gt;layer1_route_expert7</title>
<path fill="none" stroke="black" d="M10601.45,-8738C9455.85,-8738 4744.62,-8738 4744.62,-8738 4744.62,-8738 4744.62,-8395.25 4744.62,-8395.25"/>
<polygon fill="black" stroke="black" points="4748.12,-8395.25 4744.62,-8385.25 4741.12,-8395.25 4748.12,-8395.25"/>
</g>
<!-- layer1_route_expert8 -->
<g id="node313" class="node">
<title>layer1_route_expert8</title>
<polygon fill="lightpink" stroke="black" points="5855.92,-8385.16 5056.31,-8385.16 4850.62,-8249.16 5650.22,-8249.16 5855.92,-8385.16"/>
<text text-anchor="middle" x="5353.27" y="-8335.96" font-family="Times,serif" font-size="14.00">Route to Expert 8</text>
<text text-anchor="middle" x="5353.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5353.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="5353.27" y="-8290.96" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_moe_norm&#45;&gt;layer1_route_expert8 -->
<g id="edge401" class="edge">
<title>layer1_moe_norm&#45;&gt;layer1_route_expert8</title>
<path fill="none" stroke="black" d="M10601.68,-8730C9567.57,-8730 5660.08,-8730 5660.08,-8730 5660.08,-8730 5660.08,-8395.34 5660.08,-8395.34"/>
<polygon fill="black" stroke="black" points="5663.58,-8395.34 5660.08,-8385.34 5656.58,-8395.34 5663.58,-8395.34"/>
</g>
<!-- layer1_route_expert9 -->
<g id="node318" class="node">
<title>layer1_route_expert9</title>
<polygon fill="lightpink" stroke="black" points="6919.92,-8385.16 6120.31,-8385.16 5914.62,-8249.16 6714.22,-8249.16 6919.92,-8385.16"/>
<text text-anchor="middle" x="6417.27" y="-8335.96" font-family="Times,serif" font-size="14.00">Route to Expert 9</text>
<text text-anchor="middle" x="6417.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6417.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="6417.27" y="-8290.96" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_moe_norm&#45;&gt;layer1_route_expert9 -->
<g id="edge407" class="edge">
<title>layer1_moe_norm&#45;&gt;layer1_route_expert9</title>
<path fill="none" stroke="black" d="M10601.69,-8723C9644.43,-8723 6249.66,-8723 6249.66,-8723 6249.66,-8723 6249.66,-8395.55 6249.66,-8395.55"/>
<polygon fill="black" stroke="black" points="6253.16,-8395.55 6249.66,-8385.55 6246.16,-8395.55 6253.16,-8395.55"/>
</g>
<!-- layer1_route_expert10 -->
<g id="node323" class="node">
<title>layer1_route_expert10</title>
<polygon fill="lightpink" stroke="black" points="7983.92,-8385.16 7184.31,-8385.16 6978.62,-8249.16 7778.22,-8249.16 7983.92,-8385.16"/>
<text text-anchor="middle" x="7481.27" y="-8335.96" font-family="Times,serif" font-size="14.00">Route to Expert 10</text>
<text text-anchor="middle" x="7481.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7481.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="7481.27" y="-8290.96" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_moe_norm&#45;&gt;layer1_route_expert10 -->
<g id="edge413" class="edge">
<title>layer1_moe_norm&#45;&gt;layer1_route_expert10</title>
<path fill="none" stroke="black" d="M10601.7,-8715C9904.09,-8715 7978.62,-8715 7978.62,-8715 7978.62,-8715 7978.62,-8327.24 7978.62,-8327.24"/>
<polygon fill="black" stroke="black" points="7982.12,-8327.24 7978.62,-8317.24 7975.12,-8327.24 7982.12,-8327.24"/>
</g>
<!-- layer1_route_expert11 -->
<g id="node328" class="node">
<title>layer1_route_expert11</title>
<polygon fill="lightpink" stroke="black" points="9047.92,-8385.16 8248.31,-8385.16 8042.62,-8249.16 8842.22,-8249.16 9047.92,-8385.16"/>
<text text-anchor="middle" x="8545.27" y="-8335.96" font-family="Times,serif" font-size="14.00">Route to Expert 11</text>
<text text-anchor="middle" x="8545.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8545.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="8545.27" y="-8290.96" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_moe_norm&#45;&gt;layer1_route_expert11 -->
<g id="edge419" class="edge">
<title>layer1_moe_norm&#45;&gt;layer1_route_expert11</title>
<path fill="none" stroke="black" d="M10601.59,-8708C10028.55,-8708 8663.92,-8708 8663.92,-8708 8663.92,-8708 8663.92,-8395.24 8663.92,-8395.24"/>
<polygon fill="black" stroke="black" points="8667.42,-8395.24 8663.92,-8385.24 8660.42,-8395.24 8667.42,-8395.24"/>
</g>
<!-- layer1_route_expert12 -->
<g id="node333" class="node">
<title>layer1_route_expert12</title>
<polygon fill="lightpink" stroke="black" points="10111.92,-8385.16 9312.31,-8385.16 9106.62,-8249.16 9906.22,-8249.16 10111.92,-8385.16"/>
<text text-anchor="middle" x="9609.27" y="-8335.96" font-family="Times,serif" font-size="14.00">Route to Expert 12</text>
<text text-anchor="middle" x="9609.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9609.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="9609.27" y="-8290.96" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_moe_norm&#45;&gt;layer1_route_expert12 -->
<g id="edge425" class="edge">
<title>layer1_moe_norm&#45;&gt;layer1_route_expert12</title>
<path fill="none" stroke="black" d="M10601.74,-8700C10325.32,-8700 9917.16,-8700 9917.16,-8700 9917.16,-8700 9917.16,-8395.17 9917.16,-8395.17"/>
<polygon fill="black" stroke="black" points="9920.66,-8395.17 9917.16,-8385.17 9913.66,-8395.17 9920.66,-8395.17"/>
</g>
<!-- layer1_route_expert13 -->
<g id="node338" class="node">
<title>layer1_route_expert13</title>
<polygon fill="lightpink" stroke="black" points="11175.92,-8385.16 10376.31,-8385.16 10170.62,-8249.16 10970.22,-8249.16 11175.92,-8385.16"/>
<text text-anchor="middle" x="10673.27" y="-8335.96" font-family="Times,serif" font-size="14.00">Route to Expert 13</text>
<text text-anchor="middle" x="10673.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10673.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="10673.27" y="-8290.96" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_moe_norm&#45;&gt;layer1_route_expert13 -->
<g id="edge431" class="edge">
<title>layer1_moe_norm&#45;&gt;layer1_route_expert13</title>
<path fill="none" stroke="black" d="M10622.6,-8692.91C10622.6,-8692.91 10622.6,-8395.22 10622.6,-8395.22"/>
<polygon fill="black" stroke="black" points="10626.1,-8395.22 10622.6,-8385.22 10619.1,-8395.22 10626.1,-8395.22"/>
</g>
<!-- layer1_route_expert14 -->
<g id="node343" class="node">
<title>layer1_route_expert14</title>
<polygon fill="lightpink" stroke="black" points="12239.92,-8385.16 11440.31,-8385.16 11234.62,-8249.16 12034.22,-8249.16 12239.92,-8385.16"/>
<text text-anchor="middle" x="11737.27" y="-8335.96" font-family="Times,serif" font-size="14.00">Route to Expert 14</text>
<text text-anchor="middle" x="11737.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11737.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="11737.27" y="-8290.96" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_moe_norm&#45;&gt;layer1_route_expert14 -->
<g id="edge437" class="edge">
<title>layer1_moe_norm&#45;&gt;layer1_route_expert14</title>
<path fill="none" stroke="black" d="M11098.96,-8700C11341.92,-8700 11675.43,-8700 11675.43,-8700 11675.43,-8700 11675.43,-8395.17 11675.43,-8395.17"/>
<polygon fill="black" stroke="black" points="11678.93,-8395.17 11675.43,-8385.17 11671.93,-8395.17 11678.93,-8395.17"/>
</g>
<!-- layer1_route_expert15 -->
<g id="node348" class="node">
<title>layer1_route_expert15</title>
<polygon fill="lightpink" stroke="black" points="13303.92,-8385.16 12504.31,-8385.16 12298.62,-8249.16 13098.22,-8249.16 13303.92,-8385.16"/>
<text text-anchor="middle" x="12801.27" y="-8335.96" font-family="Times,serif" font-size="14.00">Route to Expert 15</text>
<text text-anchor="middle" x="12801.27" y="-8320.96" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12801.27" y="-8305.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="12801.27" y="-8290.96" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_moe_norm&#45;&gt;layer1_route_expert15 -->
<g id="edge443" class="edge">
<title>layer1_moe_norm&#45;&gt;layer1_route_expert15</title>
<path fill="none" stroke="black" d="M11099.21,-8708C11572.64,-8708 12555.99,-8708 12555.99,-8708 12555.99,-8708 12555.99,-8395.24 12555.99,-8395.24"/>
<polygon fill="black" stroke="black" points="12559.49,-8395.24 12555.99,-8385.24 12552.49,-8395.24 12559.49,-8395.24"/>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_expert0 -->
<g id="edge352" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11494.46,-8505C12148.01,-8505 13493.22,-8505 13493.22,-8505 13493.22,-8505 13493.22,-8345.52 13493.22,-8345.52"/>
<polygon fill="black" stroke="black" points="13496.72,-8345.52 13493.22,-8335.52 13489.72,-8345.52 13496.72,-8345.52"/>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_expert1 -->
<g id="edge358" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11520.26,-8522C12401.62,-8522 14535.22,-8522 14535.22,-8522 14535.22,-8522 14535.22,-8331.07 14535.22,-8331.07"/>
<polygon fill="black" stroke="black" points="14538.72,-8331.07 14535.22,-8321.07 14531.72,-8331.07 14538.72,-8331.07"/>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_expert2 -->
<g id="edge364" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11546.23,-8539C12623.76,-8539 15506.55,-8539 15506.55,-8539 15506.55,-8539 15506.55,-8327.32 15506.55,-8327.32"/>
<polygon fill="black" stroke="black" points="15510.05,-8327.32 15506.55,-8317.32 15503.05,-8327.32 15510.05,-8327.32"/>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_expert3 -->
<g id="edge370" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11571.73,-8556C12858.76,-8556 16622.88,-8556 16622.88,-8556 16622.88,-8556 16622.88,-8327.21 16622.88,-8327.21"/>
<polygon fill="black" stroke="black" points="16626.38,-8327.21 16622.88,-8317.21 16619.38,-8327.21 16626.38,-8327.21"/>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_expert4 -->
<g id="edge376" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11597.39,-8573C13067.49,-8573 17625.8,-8573 17625.8,-8573 17625.8,-8573 17625.8,-8327.21 17625.8,-8327.21"/>
<polygon fill="black" stroke="black" points="17629.31,-8327.21 17625.8,-8317.21 17622.31,-8327.21 17629.31,-8327.21"/>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_expert5 -->
<g id="edge382" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11622.96,-8590C13281.33,-8590 18698.14,-8590 18698.14,-8590 18698.14,-8590 18698.14,-8327.21 18698.14,-8327.21"/>
<polygon fill="black" stroke="black" points="18701.64,-8327.21 18698.14,-8317.21 18694.64,-8327.21 18701.64,-8327.21"/>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_expert6 -->
<g id="edge388" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10823.29,-8590C9356.43,-8590 3392.87,-8590 3392.87,-8590 3392.87,-8590 3392.87,-8395.31 3392.87,-8395.31"/>
<polygon fill="black" stroke="black" points="3396.37,-8395.31 3392.87,-8385.31 3389.37,-8395.31 3396.37,-8395.31"/>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_expert7 -->
<g id="edge394" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10797.41,-8573C9464.57,-8573 4768.36,-8573 4768.36,-8573 4768.36,-8573 4768.36,-8327.21 4768.36,-8327.21"/>
<polygon fill="black" stroke="black" points="4771.86,-8327.21 4768.36,-8317.21 4764.86,-8327.21 4771.86,-8327.21"/>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_expert8 -->
<g id="edge400" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10771.89,-8556C9550.12,-8556 5757.53,-8556 5757.53,-8556 5757.53,-8556 5757.53,-8395.29 5757.53,-8395.29"/>
<polygon fill="black" stroke="black" points="5761.03,-8395.29 5757.53,-8385.29 5754.03,-8395.29 5761.03,-8395.29"/>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_expert9 -->
<g id="edge406" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10745.97,-8539C9633.32,-8539 6584.87,-8539 6584.87,-8539 6584.87,-8539 6584.87,-8395.23 6584.87,-8395.23"/>
<polygon fill="black" stroke="black" points="6588.37,-8395.23 6584.87,-8385.23 6581.37,-8395.23 6588.37,-8395.23"/>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_expert10 -->
<g id="edge412" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10720.25,-8522C9856.74,-8522 7981.36,-8522 7981.36,-8522 7981.36,-8522 7981.36,-8327.31 7981.36,-8327.31"/>
<polygon fill="black" stroke="black" points="7984.86,-8327.31 7981.36,-8317.31 7977.86,-8327.31 7984.86,-8327.31"/>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_expert11 -->
<g id="edge418" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10694.47,-8505C10027.13,-8505 8856.01,-8505 8856.01,-8505 8856.01,-8505 8856.01,-8395.24 8856.01,-8395.24"/>
<polygon fill="black" stroke="black" points="8859.51,-8395.24 8856.01,-8385.24 8852.51,-8395.24 8859.51,-8395.24"/>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_expert12 -->
<g id="edge424" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10668.81,-8488C10359.75,-8488 10014.63,-8488 10014.63,-8488 10014.63,-8488 10014.63,-8395.17 10014.63,-8395.17"/>
<polygon fill="black" stroke="black" points="10018.13,-8395.17 10014.63,-8385.17 10011.13,-8395.17 10018.13,-8395.17"/>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_expert13 -->
<g id="edge430" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10909.77,-8471.05C10909.77,-8471.05 10909.77,-8395.53 10909.77,-8395.53"/>
<polygon fill="black" stroke="black" points="10913.27,-8395.53 10909.77,-8385.53 10906.27,-8395.53 10913.27,-8395.53"/>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_expert14 -->
<g id="edge436" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11441.77,-8471.05C11441.77,-8471.05 11441.77,-8395.53 11441.77,-8395.53"/>
<polygon fill="black" stroke="black" points="11445.27,-8395.53 11441.77,-8385.53 11438.27,-8395.53 11445.27,-8395.53"/>
</g>
<!-- layer1_gate&#45;&gt;layer1_route_expert15 -->
<g id="edge442" class="edge">
<title>layer1_gate&#45;&gt;layer1_route_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11469.09,-8488C11848.55,-8488 12427.22,-8488 12427.22,-8488 12427.22,-8488 12427.22,-8344.48 12427.22,-8344.48"/>
<polygon fill="black" stroke="black" points="12430.72,-8344.48 12427.22,-8334.48 12423.72,-8344.48 12430.72,-8344.48"/>
</g>
<!-- layer1_expert0_up -->
<g id="node274" class="node">
<title>layer1_expert0_up</title>
<polygon fill="lightcoral" stroke="black" points="14025.27,-8163.16 13743.27,-8163.16 13743.27,-8095.16 14025.27,-8095.16 14025.27,-8163.16"/>
<text text-anchor="middle" x="13884.27" y="-8147.96" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="13884.27" y="-8132.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="13884.27" y="-8117.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="13884.27" y="-8102.96" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_route_expert0&#45;&gt;layer1_expert0_up -->
<g id="edge354" class="edge">
<title>layer1_route_expert0&#45;&gt;layer1_expert0_up</title>
<path fill="none" stroke="black" d="M13884.27,-8249.03C13884.27,-8249.03 13884.27,-8173.34 13884.27,-8173.34"/>
<polygon fill="black" stroke="black" points="13887.77,-8173.34 13884.27,-8163.34 13880.77,-8173.34 13887.77,-8173.34"/>
</g>
<!-- layer1_expert0_activation -->
<g id="node275" class="node">
<title>layer1_expert0_activation</title>
<polygon fill="lightyellow" stroke="black" points="14035.27,-8009.16 13753.27,-8009.16 13753.27,-7941.16 14035.27,-7941.16 14035.27,-8009.16"/>
<text text-anchor="middle" x="13894.27" y="-7993.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="13894.27" y="-7978.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="13894.27" y="-7963.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="13894.27" y="-7948.96" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_expert0_up&#45;&gt;layer1_expert0_activation -->
<g id="edge355" class="edge">
<title>layer1_expert0_up&#45;&gt;layer1_expert0_activation</title>
<path fill="none" stroke="black" d="M13889.27,-8094.99C13889.27,-8094.99 13889.27,-8019.25 13889.27,-8019.25"/>
<polygon fill="black" stroke="black" points="13892.77,-8019.25 13889.27,-8009.25 13885.77,-8019.25 13892.77,-8019.25"/>
</g>
<!-- layer1_expert0_down -->
<g id="node276" class="node">
<title>layer1_expert0_down</title>
<polygon fill="lightcoral" stroke="black" points="14039.77,-7855.16 13766.77,-7855.16 13766.77,-7787.16 14039.77,-7787.16 14039.77,-7855.16"/>
<text text-anchor="middle" x="13903.27" y="-7839.96" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="13903.27" y="-7824.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="13903.27" y="-7809.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="13903.27" y="-7794.96" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_expert0_activation&#45;&gt;layer1_expert0_down -->
<g id="edge356" class="edge">
<title>layer1_expert0_activation&#45;&gt;layer1_expert0_down</title>
<path fill="none" stroke="black" d="M13901.02,-7940.99C13901.02,-7940.99 13901.02,-7865.25 13901.02,-7865.25"/>
<polygon fill="black" stroke="black" points="13904.52,-7865.25 13901.02,-7855.25 13897.52,-7865.25 13904.52,-7865.25"/>
</g>
<!-- layer1_route_back_expert0 -->
<g id="node277" class="node">
<title>layer1_route_back_expert0</title>
<polygon fill="lightpink" stroke="black" points="14455.3,-7701.16 13636,-7701.16 13425.23,-7565.16 14244.54,-7565.16 14455.3,-7701.16"/>
<text text-anchor="middle" x="13940.27" y="-7651.96" font-family="Times,serif" font-size="14.00">Route Back Expert 0</text>
<text text-anchor="middle" x="13940.27" y="-7636.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="13940.27" y="-7621.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13940.27" y="-7606.96" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_expert0_down&#45;&gt;layer1_route_back_expert0 -->
<g id="edge357" class="edge">
<title>layer1_expert0_down&#45;&gt;layer1_route_back_expert0</title>
<path fill="none" stroke="black" d="M13903.27,-7787.12C13903.27,-7787.12 13903.27,-7711.23 13903.27,-7711.23"/>
<polygon fill="black" stroke="black" points="13906.77,-7711.23 13903.27,-7701.23 13899.77,-7711.23 13906.77,-7711.23"/>
</g>
<!-- layer1_expert_agg -->
<g id="node353" class="node">
<title>layer1_expert_agg</title>
<ellipse fill="lightblue" stroke="black" cx="10673.27" cy="-7431.08" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="10673.27" y="-7449.88" font-family="Times,serif" font-size="14.00">Aggregate Experts</text>
<text text-anchor="middle" x="10673.27" y="-7434.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10673.27" y="-7419.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10673.27" y="-7404.88" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer1_route_back_expert0&#45;&gt;layer1_expert_agg -->
<g id="edge448" class="edge">
<title>layer1_route_back_expert0&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M13471.88,-7633.03C13471.88,-7627.39 13471.88,-7447 13471.88,-7447 13471.88,-7447 11014.95,-7447 11014.95,-7447"/>
<polygon fill="black" stroke="black" points="11014.95,-7443.5 11004.95,-7447 11014.95,-7450.5 11014.95,-7443.5"/>
</g>
<!-- layer1_expert1_up -->
<g id="node279" class="node">
<title>layer1_expert1_up</title>
<polygon fill="lightcoral" stroke="black" points="15082.27,-8163.16 14800.27,-8163.16 14800.27,-8095.16 15082.27,-8095.16 15082.27,-8163.16"/>
<text text-anchor="middle" x="14941.27" y="-8147.96" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="14941.27" y="-8132.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="14941.27" y="-8117.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="14941.27" y="-8102.96" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_route_expert1&#45;&gt;layer1_expert1_up -->
<g id="edge360" class="edge">
<title>layer1_route_expert1&#45;&gt;layer1_expert1_up</title>
<path fill="none" stroke="black" d="M14941.27,-8249.03C14941.27,-8249.03 14941.27,-8173.34 14941.27,-8173.34"/>
<polygon fill="black" stroke="black" points="14944.77,-8173.34 14941.27,-8163.34 14937.77,-8173.34 14944.77,-8173.34"/>
</g>
<!-- layer1_expert1_activation -->
<g id="node280" class="node">
<title>layer1_expert1_activation</title>
<polygon fill="lightyellow" stroke="black" points="15095.27,-8009.16 14813.27,-8009.16 14813.27,-7941.16 15095.27,-7941.16 15095.27,-8009.16"/>
<text text-anchor="middle" x="14954.27" y="-7993.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14954.27" y="-7978.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="14954.27" y="-7963.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="14954.27" y="-7948.96" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_expert1_up&#45;&gt;layer1_expert1_activation -->
<g id="edge361" class="edge">
<title>layer1_expert1_up&#45;&gt;layer1_expert1_activation</title>
<path fill="none" stroke="black" d="M14947.77,-8094.99C14947.77,-8094.99 14947.77,-8019.25 14947.77,-8019.25"/>
<polygon fill="black" stroke="black" points="14951.27,-8019.25 14947.77,-8009.25 14944.27,-8019.25 14951.27,-8019.25"/>
</g>
<!-- layer1_expert1_down -->
<g id="node281" class="node">
<title>layer1_expert1_down</title>
<polygon fill="lightcoral" stroke="black" points="15115.77,-7855.16 14842.77,-7855.16 14842.77,-7787.16 15115.77,-7787.16 15115.77,-7855.16"/>
<text text-anchor="middle" x="14979.27" y="-7839.96" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="14979.27" y="-7824.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="14979.27" y="-7809.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="14979.27" y="-7794.96" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_expert1_activation&#45;&gt;layer1_expert1_down -->
<g id="edge362" class="edge">
<title>layer1_expert1_activation&#45;&gt;layer1_expert1_down</title>
<path fill="none" stroke="black" d="M14969.02,-7940.99C14969.02,-7940.99 14969.02,-7865.25 14969.02,-7865.25"/>
<polygon fill="black" stroke="black" points="14972.52,-7865.25 14969.02,-7855.25 14965.52,-7865.25 14972.52,-7865.25"/>
</g>
<!-- layer1_route_back_expert1 -->
<g id="node282" class="node">
<title>layer1_route_back_expert1</title>
<polygon fill="lightpink" stroke="black" points="15544.3,-7701.16 14725,-7701.16 14514.23,-7565.16 15333.54,-7565.16 15544.3,-7701.16"/>
<text text-anchor="middle" x="15029.27" y="-7651.96" font-family="Times,serif" font-size="14.00">Route Back Expert 1</text>
<text text-anchor="middle" x="15029.27" y="-7636.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="15029.27" y="-7621.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15029.27" y="-7606.96" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer1_expert1_down&#45;&gt;layer1_route_back_expert1 -->
<g id="edge363" class="edge">
<title>layer1_expert1_down&#45;&gt;layer1_route_back_expert1</title>
<path fill="none" stroke="black" d="M14979.27,-7787.12C14979.27,-7787.12 14979.27,-7711.23 14979.27,-7711.23"/>
<polygon fill="black" stroke="black" points="14982.77,-7711.23 14979.27,-7701.23 14975.77,-7711.23 14982.77,-7711.23"/>
</g>
<!-- layer1_route_back_expert1&#45;&gt;layer1_expert_agg -->
<g id="edge449" class="edge">
<title>layer1_route_back_expert1&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M14766.05,-7565.04C14766.05,-7508.05 14766.05,-7436 14766.05,-7436 14766.05,-7436 11033.1,-7436 11033.1,-7436"/>
<polygon fill="black" stroke="black" points="11033.1,-7432.5 11023.1,-7436 11033.1,-7439.5 11033.1,-7432.5"/>
</g>
<!-- layer1_expert2_up -->
<g id="node284" class="node">
<title>layer1_expert2_up</title>
<polygon fill="lightcoral" stroke="black" points="16150.27,-8163.16 15868.27,-8163.16 15868.27,-8095.16 16150.27,-8095.16 16150.27,-8163.16"/>
<text text-anchor="middle" x="16009.27" y="-8147.96" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="16009.27" y="-8132.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="16009.27" y="-8117.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="16009.27" y="-8102.96" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_route_expert2&#45;&gt;layer1_expert2_up -->
<g id="edge366" class="edge">
<title>layer1_route_expert2&#45;&gt;layer1_expert2_up</title>
<path fill="none" stroke="black" d="M16009.27,-8249.03C16009.27,-8249.03 16009.27,-8173.34 16009.27,-8173.34"/>
<polygon fill="black" stroke="black" points="16012.77,-8173.34 16009.27,-8163.34 16005.77,-8173.34 16012.77,-8173.34"/>
</g>
<!-- layer1_expert2_activation -->
<g id="node285" class="node">
<title>layer1_expert2_activation</title>
<polygon fill="lightyellow" stroke="black" points="16166.27,-8009.16 15884.27,-8009.16 15884.27,-7941.16 16166.27,-7941.16 16166.27,-8009.16"/>
<text text-anchor="middle" x="16025.27" y="-7993.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16025.27" y="-7978.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="16025.27" y="-7963.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="16025.27" y="-7948.96" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_expert2_up&#45;&gt;layer1_expert2_activation -->
<g id="edge367" class="edge">
<title>layer1_expert2_up&#45;&gt;layer1_expert2_activation</title>
<path fill="none" stroke="black" d="M16017.27,-8094.99C16017.27,-8094.99 16017.27,-8019.25 16017.27,-8019.25"/>
<polygon fill="black" stroke="black" points="16020.77,-8019.25 16017.27,-8009.25 16013.77,-8019.25 16020.77,-8019.25"/>
</g>
<!-- layer1_expert2_down -->
<g id="node286" class="node">
<title>layer1_expert2_down</title>
<polygon fill="lightcoral" stroke="black" points="16192.77,-7855.16 15919.77,-7855.16 15919.77,-7787.16 16192.77,-7787.16 16192.77,-7855.16"/>
<text text-anchor="middle" x="16056.27" y="-7839.96" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="16056.27" y="-7824.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="16056.27" y="-7809.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="16056.27" y="-7794.96" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_expert2_activation&#45;&gt;layer1_expert2_down -->
<g id="edge368" class="edge">
<title>layer1_expert2_activation&#45;&gt;layer1_expert2_down</title>
<path fill="none" stroke="black" d="M16043.02,-7940.99C16043.02,-7940.99 16043.02,-7865.25 16043.02,-7865.25"/>
<polygon fill="black" stroke="black" points="16046.52,-7865.25 16043.02,-7855.25 16039.52,-7865.25 16046.52,-7865.25"/>
</g>
<!-- layer1_route_back_expert2 -->
<g id="node287" class="node">
<title>layer1_route_back_expert2</title>
<polygon fill="lightpink" stroke="black" points="16633.3,-7701.16 15814,-7701.16 15603.23,-7565.16 16422.54,-7565.16 16633.3,-7701.16"/>
<text text-anchor="middle" x="16118.27" y="-7651.96" font-family="Times,serif" font-size="14.00">Route Back Expert 2</text>
<text text-anchor="middle" x="16118.27" y="-7636.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="16118.27" y="-7621.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16118.27" y="-7606.96" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_expert2_down&#45;&gt;layer1_route_back_expert2 -->
<g id="edge369" class="edge">
<title>layer1_expert2_down&#45;&gt;layer1_route_back_expert2</title>
<path fill="none" stroke="black" d="M16056.27,-7787.12C16056.27,-7787.12 16056.27,-7711.23 16056.27,-7711.23"/>
<polygon fill="black" stroke="black" points="16059.77,-7711.23 16056.27,-7701.23 16052.77,-7711.23 16059.77,-7711.23"/>
</g>
<!-- layer1_route_back_expert2&#45;&gt;layer1_expert_agg -->
<g id="edge450" class="edge">
<title>layer1_route_back_expert2&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M15842.55,-7565C15842.55,-7504.29 15842.55,-7425 15842.55,-7425 15842.55,-7425 11031.98,-7425 11031.98,-7425"/>
<polygon fill="black" stroke="black" points="11031.98,-7421.5 11021.98,-7425 11031.98,-7428.5 11031.98,-7421.5"/>
</g>
<!-- layer1_expert3_up -->
<g id="node289" class="node">
<title>layer1_expert3_up</title>
<polygon fill="lightcoral" stroke="black" points="17217.27,-8163.16 16935.27,-8163.16 16935.27,-8095.16 17217.27,-8095.16 17217.27,-8163.16"/>
<text text-anchor="middle" x="17076.27" y="-8147.96" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="17076.27" y="-8132.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="17076.27" y="-8117.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="17076.27" y="-8102.96" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_route_expert3&#45;&gt;layer1_expert3_up -->
<g id="edge372" class="edge">
<title>layer1_route_expert3&#45;&gt;layer1_expert3_up</title>
<path fill="none" stroke="black" d="M17076.27,-8249.03C17076.27,-8249.03 17076.27,-8173.34 17076.27,-8173.34"/>
<polygon fill="black" stroke="black" points="17079.77,-8173.34 17076.27,-8163.34 17072.77,-8173.34 17079.77,-8173.34"/>
</g>
<!-- layer1_expert3_activation -->
<g id="node290" class="node">
<title>layer1_expert3_activation</title>
<polygon fill="lightyellow" stroke="black" points="17236.27,-8009.16 16954.27,-8009.16 16954.27,-7941.16 17236.27,-7941.16 17236.27,-8009.16"/>
<text text-anchor="middle" x="17095.27" y="-7993.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17095.27" y="-7978.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="17095.27" y="-7963.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="17095.27" y="-7948.96" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_expert3_up&#45;&gt;layer1_expert3_activation -->
<g id="edge373" class="edge">
<title>layer1_expert3_up&#45;&gt;layer1_expert3_activation</title>
<path fill="none" stroke="black" d="M17085.77,-8094.99C17085.77,-8094.99 17085.77,-8019.25 17085.77,-8019.25"/>
<polygon fill="black" stroke="black" points="17089.27,-8019.25 17085.77,-8009.25 17082.27,-8019.25 17089.27,-8019.25"/>
</g>
<!-- layer1_expert3_down -->
<g id="node291" class="node">
<title>layer1_expert3_down</title>
<polygon fill="lightcoral" stroke="black" points="17268.77,-7855.16 16995.77,-7855.16 16995.77,-7787.16 17268.77,-7787.16 17268.77,-7855.16"/>
<text text-anchor="middle" x="17132.27" y="-7839.96" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="17132.27" y="-7824.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="17132.27" y="-7809.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="17132.27" y="-7794.96" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_expert3_activation&#45;&gt;layer1_expert3_down -->
<g id="edge374" class="edge">
<title>layer1_expert3_activation&#45;&gt;layer1_expert3_down</title>
<path fill="none" stroke="black" d="M17116.02,-7940.99C17116.02,-7940.99 17116.02,-7865.25 17116.02,-7865.25"/>
<polygon fill="black" stroke="black" points="17119.52,-7865.25 17116.02,-7855.25 17112.52,-7865.25 17119.52,-7865.25"/>
</g>
<!-- layer1_route_back_expert3 -->
<g id="node292" class="node">
<title>layer1_route_back_expert3</title>
<polygon fill="lightpink" stroke="black" points="17722.3,-7701.16 16903,-7701.16 16692.23,-7565.16 17511.54,-7565.16 17722.3,-7701.16"/>
<text text-anchor="middle" x="17207.27" y="-7651.96" font-family="Times,serif" font-size="14.00">Route Back Expert 3</text>
<text text-anchor="middle" x="17207.27" y="-7636.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="17207.27" y="-7621.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17207.27" y="-7606.96" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer1_expert3_down&#45;&gt;layer1_route_back_expert3 -->
<g id="edge375" class="edge">
<title>layer1_expert3_down&#45;&gt;layer1_route_back_expert3</title>
<path fill="none" stroke="black" d="M17132.27,-7787.12C17132.27,-7787.12 17132.27,-7711.23 17132.27,-7711.23"/>
<polygon fill="black" stroke="black" points="17135.77,-7711.23 17132.27,-7701.23 17128.77,-7711.23 17135.77,-7711.23"/>
</g>
<!-- layer1_route_back_expert3&#45;&gt;layer1_expert_agg -->
<g id="edge451" class="edge">
<title>layer1_route_back_expert3&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M16919.05,-7565.03C16919.05,-7501.02 16919.05,-7415 16919.05,-7415 16919.05,-7415 11014.66,-7415 11014.66,-7415"/>
<polygon fill="black" stroke="black" points="11014.66,-7411.5 11004.66,-7415 11014.66,-7418.5 11014.66,-7411.5"/>
</g>
<!-- layer1_expert4_up -->
<g id="node294" class="node">
<title>layer1_expert4_up</title>
<polygon fill="lightcoral" stroke="black" points="18284.27,-8163.16 18002.27,-8163.16 18002.27,-8095.16 18284.27,-8095.16 18284.27,-8163.16"/>
<text text-anchor="middle" x="18143.27" y="-8147.96" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="18143.27" y="-8132.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="18143.27" y="-8117.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="18143.27" y="-8102.96" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_route_expert4&#45;&gt;layer1_expert4_up -->
<g id="edge378" class="edge">
<title>layer1_route_expert4&#45;&gt;layer1_expert4_up</title>
<path fill="none" stroke="black" d="M18143.27,-8249.03C18143.27,-8249.03 18143.27,-8173.34 18143.27,-8173.34"/>
<polygon fill="black" stroke="black" points="18146.77,-8173.34 18143.27,-8163.34 18139.77,-8173.34 18146.77,-8173.34"/>
</g>
<!-- layer1_expert4_activation -->
<g id="node295" class="node">
<title>layer1_expert4_activation</title>
<polygon fill="lightyellow" stroke="black" points="18328.27,-8009.16 18046.27,-8009.16 18046.27,-7941.16 18328.27,-7941.16 18328.27,-8009.16"/>
<text text-anchor="middle" x="18187.27" y="-7993.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="18187.27" y="-7978.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="18187.27" y="-7963.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="18187.27" y="-7948.96" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_expert4_up&#45;&gt;layer1_expert4_activation -->
<g id="edge379" class="edge">
<title>layer1_expert4_up&#45;&gt;layer1_expert4_activation</title>
<path fill="none" stroke="black" d="M18165.27,-8094.99C18165.27,-8094.99 18165.27,-8019.25 18165.27,-8019.25"/>
<polygon fill="black" stroke="black" points="18168.77,-8019.25 18165.27,-8009.25 18161.77,-8019.25 18168.77,-8019.25"/>
</g>
<!-- layer1_expert4_down -->
<g id="node296" class="node">
<title>layer1_expert4_down</title>
<polygon fill="lightcoral" stroke="black" points="18410.77,-7855.16 18137.77,-7855.16 18137.77,-7787.16 18410.77,-7787.16 18410.77,-7855.16"/>
<text text-anchor="middle" x="18274.27" y="-7839.96" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="18274.27" y="-7824.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="18274.27" y="-7809.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="18274.27" y="-7794.96" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_expert4_activation&#45;&gt;layer1_expert4_down -->
<g id="edge380" class="edge">
<title>layer1_expert4_activation&#45;&gt;layer1_expert4_down</title>
<path fill="none" stroke="black" d="M18233.02,-7940.99C18233.02,-7940.99 18233.02,-7865.25 18233.02,-7865.25"/>
<polygon fill="black" stroke="black" points="18236.52,-7865.25 18233.02,-7855.25 18229.52,-7865.25 18236.52,-7865.25"/>
</g>
<!-- layer1_route_back_expert4 -->
<g id="node297" class="node">
<title>layer1_route_back_expert4</title>
<polygon fill="lightpink" stroke="black" points="18811.3,-7701.16 17992,-7701.16 17781.23,-7565.16 18600.54,-7565.16 18811.3,-7701.16"/>
<text text-anchor="middle" x="18296.27" y="-7651.96" font-family="Times,serif" font-size="14.00">Route Back Expert 4</text>
<text text-anchor="middle" x="18296.27" y="-7636.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="18296.27" y="-7621.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18296.27" y="-7606.96" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_expert4_down&#45;&gt;layer1_route_back_expert4 -->
<g id="edge381" class="edge">
<title>layer1_expert4_down&#45;&gt;layer1_route_back_expert4</title>
<path fill="none" stroke="black" d="M18274.27,-7787.12C18274.27,-7787.12 18274.27,-7711.23 18274.27,-7711.23"/>
<polygon fill="black" stroke="black" points="18277.77,-7711.23 18274.27,-7701.23 18270.77,-7711.23 18277.77,-7711.23"/>
</g>
<!-- layer1_route_back_expert4&#45;&gt;layer1_expert_agg -->
<g id="edge452" class="edge">
<title>layer1_route_back_expert4&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M17995.55,-7565.03C17995.55,-7497.48 17995.55,-7404 17995.55,-7404 17995.55,-7404 10973.69,-7404 10973.69,-7404"/>
<polygon fill="black" stroke="black" points="10973.69,-7400.5 10963.69,-7404 10973.69,-7407.5 10973.69,-7400.5"/>
</g>
<!-- layer1_expert5_up -->
<g id="node299" class="node">
<title>layer1_expert5_up</title>
<polygon fill="lightcoral" stroke="black" points="19351.27,-8163.16 19069.27,-8163.16 19069.27,-8095.16 19351.27,-8095.16 19351.27,-8163.16"/>
<text text-anchor="middle" x="19210.27" y="-8147.96" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="19210.27" y="-8132.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="19210.27" y="-8117.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="19210.27" y="-8102.96" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_route_expert5&#45;&gt;layer1_expert5_up -->
<g id="edge384" class="edge">
<title>layer1_route_expert5&#45;&gt;layer1_expert5_up</title>
<path fill="none" stroke="black" d="M19210.27,-8249.03C19210.27,-8249.03 19210.27,-8173.34 19210.27,-8173.34"/>
<polygon fill="black" stroke="black" points="19213.77,-8173.34 19210.27,-8163.34 19206.77,-8173.34 19213.77,-8173.34"/>
</g>
<!-- layer1_expert5_activation -->
<g id="node300" class="node">
<title>layer1_expert5_activation</title>
<polygon fill="lightyellow" stroke="black" points="19451.27,-8009.16 19169.27,-8009.16 19169.27,-7941.16 19451.27,-7941.16 19451.27,-8009.16"/>
<text text-anchor="middle" x="19310.27" y="-7993.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="19310.27" y="-7978.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="19310.27" y="-7963.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="19310.27" y="-7948.96" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_expert5_up&#45;&gt;layer1_expert5_activation -->
<g id="edge385" class="edge">
<title>layer1_expert5_up&#45;&gt;layer1_expert5_activation</title>
<path fill="none" stroke="black" d="M19260.27,-8094.99C19260.27,-8094.99 19260.27,-8019.25 19260.27,-8019.25"/>
<polygon fill="black" stroke="black" points="19263.77,-8019.25 19260.27,-8009.25 19256.77,-8019.25 19263.77,-8019.25"/>
</g>
<!-- layer1_expert5_down -->
<g id="node301" class="node">
<title>layer1_expert5_down</title>
<polygon fill="lightcoral" stroke="black" points="19496.77,-7855.16 19223.77,-7855.16 19223.77,-7787.16 19496.77,-7787.16 19496.77,-7855.16"/>
<text text-anchor="middle" x="19360.27" y="-7839.96" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="19360.27" y="-7824.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="19360.27" y="-7809.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="19360.27" y="-7794.96" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_expert5_activation&#45;&gt;layer1_expert5_down -->
<g id="edge386" class="edge">
<title>layer1_expert5_activation&#45;&gt;layer1_expert5_down</title>
<path fill="none" stroke="black" d="M19337.52,-7940.99C19337.52,-7940.99 19337.52,-7865.25 19337.52,-7865.25"/>
<polygon fill="black" stroke="black" points="19341.02,-7865.25 19337.52,-7855.25 19334.02,-7865.25 19341.02,-7865.25"/>
</g>
<!-- layer1_route_back_expert5 -->
<g id="node302" class="node">
<title>layer1_route_back_expert5</title>
<polygon fill="lightpink" stroke="black" points="19900.3,-7701.16 19081,-7701.16 18870.23,-7565.16 19689.54,-7565.16 19900.3,-7701.16"/>
<text text-anchor="middle" x="19385.27" y="-7651.96" font-family="Times,serif" font-size="14.00">Route Back Expert 5</text>
<text text-anchor="middle" x="19385.27" y="-7636.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="19385.27" y="-7621.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19385.27" y="-7606.96" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer1_expert5_down&#45;&gt;layer1_route_back_expert5 -->
<g id="edge387" class="edge">
<title>layer1_expert5_down&#45;&gt;layer1_route_back_expert5</title>
<path fill="none" stroke="black" d="M19360.27,-7787.12C19360.27,-7787.12 19360.27,-7711.23 19360.27,-7711.23"/>
<polygon fill="black" stroke="black" points="19363.77,-7711.23 19360.27,-7701.23 19356.77,-7711.23 19363.77,-7711.23"/>
</g>
<!-- layer1_route_back_expert5&#45;&gt;layer1_expert_agg -->
<g id="edge453" class="edge">
<title>layer1_route_back_expert5&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M19072.05,-7564.98C19072.05,-7493.98 19072.05,-7393 19072.05,-7393 19072.05,-7393 10897.99,-7393 10897.99,-7393"/>
<polygon fill="black" stroke="black" points="10897.99,-7389.5 10887.99,-7393 10897.99,-7396.5 10897.99,-7389.5"/>
</g>
<!-- layer1_expert6_up -->
<g id="node304" class="node">
<title>layer1_expert6_up</title>
<polygon fill="lightcoral" stroke="black" points="3344.27,-8163.16 3062.27,-8163.16 3062.27,-8095.16 3344.27,-8095.16 3344.27,-8163.16"/>
<text text-anchor="middle" x="3203.27" y="-8147.96" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="3203.27" y="-8132.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="3203.27" y="-8117.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="3203.27" y="-8102.96" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_route_expert6&#45;&gt;layer1_expert6_up -->
<g id="edge390" class="edge">
<title>layer1_route_expert6&#45;&gt;layer1_expert6_up</title>
<path fill="none" stroke="black" d="M3203.27,-8249.03C3203.27,-8249.03 3203.27,-8173.34 3203.27,-8173.34"/>
<polygon fill="black" stroke="black" points="3206.77,-8173.34 3203.27,-8163.34 3199.77,-8173.34 3206.77,-8173.34"/>
</g>
<!-- layer1_expert6_activation -->
<g id="node305" class="node">
<title>layer1_expert6_activation</title>
<polygon fill="lightyellow" stroke="black" points="3322.27,-8009.16 3040.27,-8009.16 3040.27,-7941.16 3322.27,-7941.16 3322.27,-8009.16"/>
<text text-anchor="middle" x="3181.27" y="-7993.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3181.27" y="-7978.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="3181.27" y="-7963.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="3181.27" y="-7948.96" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_expert6_up&#45;&gt;layer1_expert6_activation -->
<g id="edge391" class="edge">
<title>layer1_expert6_up&#45;&gt;layer1_expert6_activation</title>
<path fill="none" stroke="black" d="M3192.27,-8094.99C3192.27,-8094.99 3192.27,-8019.25 3192.27,-8019.25"/>
<polygon fill="black" stroke="black" points="3195.77,-8019.25 3192.27,-8009.25 3188.77,-8019.25 3195.77,-8019.25"/>
</g>
<!-- layer1_expert6_down -->
<g id="node306" class="node">
<title>layer1_expert6_down</title>
<polygon fill="lightcoral" stroke="black" points="3230.77,-7855.16 2957.77,-7855.16 2957.77,-7787.16 3230.77,-7787.16 3230.77,-7855.16"/>
<text text-anchor="middle" x="3094.27" y="-7839.96" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="3094.27" y="-7824.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="3094.27" y="-7809.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="3094.27" y="-7794.96" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_expert6_activation&#45;&gt;layer1_expert6_down -->
<g id="edge392" class="edge">
<title>layer1_expert6_activation&#45;&gt;layer1_expert6_down</title>
<path fill="none" stroke="black" d="M3135.52,-7940.99C3135.52,-7940.99 3135.52,-7865.25 3135.52,-7865.25"/>
<polygon fill="black" stroke="black" points="3139.02,-7865.25 3135.52,-7855.25 3132.02,-7865.25 3139.02,-7865.25"/>
</g>
<!-- layer1_route_back_expert6 -->
<g id="node307" class="node">
<title>layer1_route_back_expert6</title>
<polygon fill="lightpink" stroke="black" points="3565.3,-7701.16 2746,-7701.16 2535.23,-7565.16 3354.54,-7565.16 3565.3,-7701.16"/>
<text text-anchor="middle" x="3050.27" y="-7651.96" font-family="Times,serif" font-size="14.00">Route Back Expert 6</text>
<text text-anchor="middle" x="3050.27" y="-7636.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="3050.27" y="-7621.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3050.27" y="-7606.96" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_expert6_down&#45;&gt;layer1_route_back_expert6 -->
<g id="edge393" class="edge">
<title>layer1_expert6_down&#45;&gt;layer1_route_back_expert6</title>
<path fill="none" stroke="black" d="M3094.27,-7787.12C3094.27,-7787.12 3094.27,-7711.23 3094.27,-7711.23"/>
<polygon fill="black" stroke="black" points="3097.77,-7711.23 3094.27,-7701.23 3090.77,-7711.23 3097.77,-7711.23"/>
</g>
<!-- layer1_route_back_expert6&#45;&gt;layer1_expert_agg -->
<g id="edge454" class="edge">
<title>layer1_route_back_expert6&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M3401.15,-7595.06C3401.15,-7529.9 3401.15,-7404 3401.15,-7404 3401.15,-7404 10372.86,-7404 10372.86,-7404"/>
<polygon fill="black" stroke="black" points="10372.86,-7407.5 10382.86,-7404 10372.86,-7400.5 10372.86,-7407.5"/>
</g>
<!-- layer1_expert7_up -->
<g id="node309" class="node">
<title>layer1_expert7_up</title>
<polygon fill="lightcoral" stroke="black" points="4355.27,-8163.16 4073.27,-8163.16 4073.27,-8095.16 4355.27,-8095.16 4355.27,-8163.16"/>
<text text-anchor="middle" x="4214.27" y="-8147.96" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="4214.27" y="-8132.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="4214.27" y="-8117.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="4214.27" y="-8102.96" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_route_expert7&#45;&gt;layer1_expert7_up -->
<g id="edge396" class="edge">
<title>layer1_route_expert7&#45;&gt;layer1_expert7_up</title>
<path fill="none" stroke="black" d="M4214.27,-8249.03C4214.27,-8249.03 4214.27,-8173.34 4214.27,-8173.34"/>
<polygon fill="black" stroke="black" points="4217.77,-8173.34 4214.27,-8163.34 4210.77,-8173.34 4217.77,-8173.34"/>
</g>
<!-- layer1_expert7_activation -->
<g id="node310" class="node">
<title>layer1_expert7_activation</title>
<polygon fill="lightyellow" stroke="black" points="4336.27,-8009.16 4054.27,-8009.16 4054.27,-7941.16 4336.27,-7941.16 4336.27,-8009.16"/>
<text text-anchor="middle" x="4195.27" y="-7993.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="4195.27" y="-7978.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="4195.27" y="-7963.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="4195.27" y="-7948.96" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_expert7_up&#45;&gt;layer1_expert7_activation -->
<g id="edge397" class="edge">
<title>layer1_expert7_up&#45;&gt;layer1_expert7_activation</title>
<path fill="none" stroke="black" d="M4204.77,-8094.99C4204.77,-8094.99 4204.77,-8019.25 4204.77,-8019.25"/>
<polygon fill="black" stroke="black" points="4208.27,-8019.25 4204.77,-8009.25 4201.27,-8019.25 4208.27,-8019.25"/>
</g>
<!-- layer1_expert7_down -->
<g id="node311" class="node">
<title>layer1_expert7_down</title>
<polygon fill="lightcoral" stroke="black" points="4312.77,-7855.16 4039.77,-7855.16 4039.77,-7787.16 4312.77,-7787.16 4312.77,-7855.16"/>
<text text-anchor="middle" x="4176.27" y="-7839.96" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="4176.27" y="-7824.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="4176.27" y="-7809.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="4176.27" y="-7794.96" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_expert7_activation&#45;&gt;layer1_expert7_down -->
<g id="edge398" class="edge">
<title>layer1_expert7_activation&#45;&gt;layer1_expert7_down</title>
<path fill="none" stroke="black" d="M4183.52,-7940.99C4183.52,-7940.99 4183.52,-7865.25 4183.52,-7865.25"/>
<polygon fill="black" stroke="black" points="4187.02,-7865.25 4183.52,-7855.25 4180.02,-7865.25 4187.02,-7865.25"/>
</g>
<!-- layer1_route_back_expert7 -->
<g id="node312" class="node">
<title>layer1_route_back_expert7</title>
<polygon fill="lightpink" stroke="black" points="4654.3,-7701.16 3835,-7701.16 3624.23,-7565.16 4443.54,-7565.16 4654.3,-7701.16"/>
<text text-anchor="middle" x="4139.27" y="-7651.96" font-family="Times,serif" font-size="14.00">Route Back Expert 7</text>
<text text-anchor="middle" x="4139.27" y="-7636.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="4139.27" y="-7621.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4139.27" y="-7606.96" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer1_expert7_down&#45;&gt;layer1_route_back_expert7 -->
<g id="edge399" class="edge">
<title>layer1_expert7_down&#45;&gt;layer1_route_back_expert7</title>
<path fill="none" stroke="black" d="M4176.27,-7787.12C4176.27,-7787.12 4176.27,-7711.23 4176.27,-7711.23"/>
<polygon fill="black" stroke="black" points="4179.77,-7711.23 4176.27,-7701.23 4172.77,-7711.23 4179.77,-7711.23"/>
</g>
<!-- layer1_route_back_expert7&#45;&gt;layer1_expert_agg -->
<g id="edge455" class="edge">
<title>layer1_route_back_expert7&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M4643.65,-7633.01C4643.65,-7626.4 4643.65,-7415 4643.65,-7415 4643.65,-7415 10331.85,-7415 10331.85,-7415"/>
<polygon fill="black" stroke="black" points="10331.85,-7418.5 10341.85,-7415 10331.85,-7411.5 10331.85,-7418.5"/>
</g>
<!-- layer1_expert8_up -->
<g id="node314" class="node">
<title>layer1_expert8_up</title>
<polygon fill="lightcoral" stroke="black" points="5463.27,-8163.16 5181.27,-8163.16 5181.27,-8095.16 5463.27,-8095.16 5463.27,-8163.16"/>
<text text-anchor="middle" x="5322.27" y="-8147.96" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="5322.27" y="-8132.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="5322.27" y="-8117.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="5322.27" y="-8102.96" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_route_expert8&#45;&gt;layer1_expert8_up -->
<g id="edge402" class="edge">
<title>layer1_route_expert8&#45;&gt;layer1_expert8_up</title>
<path fill="none" stroke="black" d="M5322.27,-8249.03C5322.27,-8249.03 5322.27,-8173.34 5322.27,-8173.34"/>
<polygon fill="black" stroke="black" points="5325.77,-8173.34 5322.27,-8163.34 5318.77,-8173.34 5325.77,-8173.34"/>
</g>
<!-- layer1_expert8_activation -->
<g id="node315" class="node">
<title>layer1_expert8_activation</title>
<polygon fill="lightyellow" stroke="black" points="5447.27,-8009.16 5165.27,-8009.16 5165.27,-7941.16 5447.27,-7941.16 5447.27,-8009.16"/>
<text text-anchor="middle" x="5306.27" y="-7993.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="5306.27" y="-7978.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="5306.27" y="-7963.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="5306.27" y="-7948.96" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_expert8_up&#45;&gt;layer1_expert8_activation -->
<g id="edge403" class="edge">
<title>layer1_expert8_up&#45;&gt;layer1_expert8_activation</title>
<path fill="none" stroke="black" d="M5314.27,-8094.99C5314.27,-8094.99 5314.27,-8019.25 5314.27,-8019.25"/>
<polygon fill="black" stroke="black" points="5317.77,-8019.25 5314.27,-8009.25 5310.77,-8019.25 5317.77,-8019.25"/>
</g>
<!-- layer1_expert8_down -->
<g id="node316" class="node">
<title>layer1_expert8_down</title>
<polygon fill="lightcoral" stroke="black" points="5380.77,-7855.16 5107.77,-7855.16 5107.77,-7787.16 5380.77,-7787.16 5380.77,-7855.16"/>
<text text-anchor="middle" x="5244.27" y="-7839.96" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="5244.27" y="-7824.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="5244.27" y="-7809.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="5244.27" y="-7794.96" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_expert8_activation&#45;&gt;layer1_expert8_down -->
<g id="edge404" class="edge">
<title>layer1_expert8_activation&#45;&gt;layer1_expert8_down</title>
<path fill="none" stroke="black" d="M5273.02,-7940.99C5273.02,-7940.99 5273.02,-7865.25 5273.02,-7865.25"/>
<polygon fill="black" stroke="black" points="5276.52,-7865.25 5273.02,-7855.25 5269.52,-7865.25 5276.52,-7865.25"/>
</g>
<!-- layer1_route_back_expert8 -->
<g id="node317" class="node">
<title>layer1_route_back_expert8</title>
<polygon fill="lightpink" stroke="black" points="5743.3,-7701.16 4924,-7701.16 4713.23,-7565.16 5532.54,-7565.16 5743.3,-7701.16"/>
<text text-anchor="middle" x="5228.27" y="-7651.96" font-family="Times,serif" font-size="14.00">Route Back Expert 8</text>
<text text-anchor="middle" x="5228.27" y="-7636.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="5228.27" y="-7621.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5228.27" y="-7606.96" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_expert8_down&#45;&gt;layer1_route_back_expert8 -->
<g id="edge405" class="edge">
<title>layer1_expert8_down&#45;&gt;layer1_route_back_expert8</title>
<path fill="none" stroke="black" d="M5244.27,-7787.12C5244.27,-7787.12 5244.27,-7711.23 5244.27,-7711.23"/>
<polygon fill="black" stroke="black" points="5247.77,-7711.23 5244.27,-7701.23 5240.77,-7711.23 5247.77,-7711.23"/>
</g>
<!-- layer1_route_back_expert8&#45;&gt;layer1_expert_agg -->
<g id="edge456" class="edge">
<title>layer1_route_back_expert8&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M5718.15,-7633.01C5718.15,-7626.71 5718.15,-7425 5718.15,-7425 5718.15,-7425 10314.34,-7425 10314.34,-7425"/>
<polygon fill="black" stroke="black" points="10314.34,-7428.5 10324.34,-7425 10314.34,-7421.5 10314.34,-7428.5"/>
</g>
<!-- layer1_expert9_up -->
<g id="node319" class="node">
<title>layer1_expert9_up</title>
<polygon fill="lightcoral" stroke="black" points="6533.27,-8163.16 6251.27,-8163.16 6251.27,-8095.16 6533.27,-8095.16 6533.27,-8163.16"/>
<text text-anchor="middle" x="6392.27" y="-8147.96" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="6392.27" y="-8132.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="6392.27" y="-8117.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="6392.27" y="-8102.96" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_route_expert9&#45;&gt;layer1_expert9_up -->
<g id="edge408" class="edge">
<title>layer1_route_expert9&#45;&gt;layer1_expert9_up</title>
<path fill="none" stroke="black" d="M6392.27,-8249.03C6392.27,-8249.03 6392.27,-8173.34 6392.27,-8173.34"/>
<polygon fill="black" stroke="black" points="6395.77,-8173.34 6392.27,-8163.34 6388.77,-8173.34 6395.77,-8173.34"/>
</g>
<!-- layer1_expert9_activation -->
<g id="node320" class="node">
<title>layer1_expert9_activation</title>
<polygon fill="lightyellow" stroke="black" points="6520.27,-8009.16 6238.27,-8009.16 6238.27,-7941.16 6520.27,-7941.16 6520.27,-8009.16"/>
<text text-anchor="middle" x="6379.27" y="-7993.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="6379.27" y="-7978.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="6379.27" y="-7963.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="6379.27" y="-7948.96" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_expert9_up&#45;&gt;layer1_expert9_activation -->
<g id="edge409" class="edge">
<title>layer1_expert9_up&#45;&gt;layer1_expert9_activation</title>
<path fill="none" stroke="black" d="M6385.77,-8094.99C6385.77,-8094.99 6385.77,-8019.25 6385.77,-8019.25"/>
<polygon fill="black" stroke="black" points="6389.27,-8019.25 6385.77,-8009.25 6382.27,-8019.25 6389.27,-8019.25"/>
</g>
<!-- layer1_expert9_down -->
<g id="node321" class="node">
<title>layer1_expert9_down</title>
<polygon fill="lightcoral" stroke="black" points="6465.77,-7855.16 6192.77,-7855.16 6192.77,-7787.16 6465.77,-7787.16 6465.77,-7855.16"/>
<text text-anchor="middle" x="6329.27" y="-7839.96" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="6329.27" y="-7824.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="6329.27" y="-7809.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="6329.27" y="-7794.96" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_expert9_activation&#45;&gt;layer1_expert9_down -->
<g id="edge410" class="edge">
<title>layer1_expert9_activation&#45;&gt;layer1_expert9_down</title>
<path fill="none" stroke="black" d="M6352.02,-7940.99C6352.02,-7940.99 6352.02,-7865.25 6352.02,-7865.25"/>
<polygon fill="black" stroke="black" points="6355.52,-7865.25 6352.02,-7855.25 6348.52,-7865.25 6355.52,-7865.25"/>
</g>
<!-- layer1_route_back_expert9 -->
<g id="node322" class="node">
<title>layer1_route_back_expert9</title>
<polygon fill="lightpink" stroke="black" points="6832.3,-7701.16 6013,-7701.16 5802.23,-7565.16 6621.54,-7565.16 6832.3,-7701.16"/>
<text text-anchor="middle" x="6317.27" y="-7651.96" font-family="Times,serif" font-size="14.00">Route Back Expert 9</text>
<text text-anchor="middle" x="6317.27" y="-7636.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="6317.27" y="-7621.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6317.27" y="-7606.96" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer1_expert9_down&#45;&gt;layer1_route_back_expert9 -->
<g id="edge411" class="edge">
<title>layer1_expert9_down&#45;&gt;layer1_route_back_expert9</title>
<path fill="none" stroke="black" d="M6329.27,-7787.12C6329.27,-7787.12 6329.27,-7711.23 6329.27,-7711.23"/>
<polygon fill="black" stroke="black" points="6332.77,-7711.23 6329.27,-7701.23 6325.77,-7711.23 6332.77,-7711.23"/>
</g>
<!-- layer1_route_back_expert9&#45;&gt;layer1_expert_agg -->
<g id="edge457" class="edge">
<title>layer1_route_back_expert9&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M6373.25,-7565.04C6373.25,-7508.05 6373.25,-7436 6373.25,-7436 6373.25,-7436 10313.66,-7436 10313.66,-7436"/>
<polygon fill="black" stroke="black" points="10313.66,-7439.5 10323.66,-7436 10313.66,-7432.5 10313.66,-7439.5"/>
</g>
<!-- layer1_expert10_up -->
<g id="node324" class="node">
<title>layer1_expert10_up</title>
<polygon fill="lightcoral" stroke="black" points="7612.27,-8163.16 7330.27,-8163.16 7330.27,-8095.16 7612.27,-8095.16 7612.27,-8163.16"/>
<text text-anchor="middle" x="7471.27" y="-8147.96" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="7471.27" y="-8132.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="7471.27" y="-8117.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="7471.27" y="-8102.96" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_route_expert10&#45;&gt;layer1_expert10_up -->
<g id="edge414" class="edge">
<title>layer1_route_expert10&#45;&gt;layer1_expert10_up</title>
<path fill="none" stroke="black" d="M7471.27,-8249.03C7471.27,-8249.03 7471.27,-8173.34 7471.27,-8173.34"/>
<polygon fill="black" stroke="black" points="7474.77,-8173.34 7471.27,-8163.34 7467.77,-8173.34 7474.77,-8173.34"/>
</g>
<!-- layer1_expert10_activation -->
<g id="node325" class="node">
<title>layer1_expert10_activation</title>
<polygon fill="lightyellow" stroke="black" points="7603.27,-8009.16 7321.27,-8009.16 7321.27,-7941.16 7603.27,-7941.16 7603.27,-8009.16"/>
<text text-anchor="middle" x="7462.27" y="-7993.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7462.27" y="-7978.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="7462.27" y="-7963.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="7462.27" y="-7948.96" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_expert10_up&#45;&gt;layer1_expert10_activation -->
<g id="edge415" class="edge">
<title>layer1_expert10_up&#45;&gt;layer1_expert10_activation</title>
<path fill="none" stroke="black" d="M7466.77,-8094.99C7466.77,-8094.99 7466.77,-8019.25 7466.77,-8019.25"/>
<polygon fill="black" stroke="black" points="7470.27,-8019.25 7466.77,-8009.25 7463.27,-8019.25 7470.27,-8019.25"/>
</g>
<!-- layer1_expert10_down -->
<g id="node326" class="node">
<title>layer1_expert10_down</title>
<polygon fill="lightcoral" stroke="black" points="7561.77,-7855.16 7288.77,-7855.16 7288.77,-7787.16 7561.77,-7787.16 7561.77,-7855.16"/>
<text text-anchor="middle" x="7425.27" y="-7839.96" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="7425.27" y="-7824.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="7425.27" y="-7809.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="7425.27" y="-7794.96" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_expert10_activation&#45;&gt;layer1_expert10_down -->
<g id="edge416" class="edge">
<title>layer1_expert10_activation&#45;&gt;layer1_expert10_down</title>
<path fill="none" stroke="black" d="M7441.52,-7940.99C7441.52,-7940.99 7441.52,-7865.25 7441.52,-7865.25"/>
<polygon fill="black" stroke="black" points="7445.02,-7865.25 7441.52,-7855.25 7438.02,-7865.25 7445.02,-7865.25"/>
</g>
<!-- layer1_route_back_expert10 -->
<g id="node327" class="node">
<title>layer1_route_back_expert10</title>
<polygon fill="lightpink" stroke="black" points="7921.3,-7701.16 7102,-7701.16 6891.23,-7565.16 7710.54,-7565.16 7921.3,-7701.16"/>
<text text-anchor="middle" x="7406.27" y="-7651.96" font-family="Times,serif" font-size="14.00">Route Back Expert 10</text>
<text text-anchor="middle" x="7406.27" y="-7636.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="7406.27" y="-7621.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7406.27" y="-7606.96" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_expert10_down&#45;&gt;layer1_route_back_expert10 -->
<g id="edge417" class="edge">
<title>layer1_expert10_down&#45;&gt;layer1_route_back_expert10</title>
<path fill="none" stroke="black" d="M7425.27,-7787.12C7425.27,-7787.12 7425.27,-7711.23 7425.27,-7711.23"/>
<polygon fill="black" stroke="black" points="7428.77,-7711.23 7425.27,-7701.23 7421.77,-7711.23 7428.77,-7711.23"/>
</g>
<!-- layer1_route_back_expert10&#45;&gt;layer1_expert_agg -->
<g id="edge458" class="edge">
<title>layer1_route_back_expert10&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M7779.69,-7609.59C7779.69,-7559.49 7779.69,-7447 7779.69,-7447 7779.69,-7447 10331.34,-7447 10331.34,-7447"/>
<polygon fill="black" stroke="black" points="10331.34,-7450.5 10341.34,-7447 10331.34,-7443.5 10331.34,-7450.5"/>
</g>
<!-- layer1_expert11_up -->
<g id="node329" class="node">
<title>layer1_expert11_up</title>
<polygon fill="lightcoral" stroke="black" points="8674.27,-8163.16 8392.27,-8163.16 8392.27,-8095.16 8674.27,-8095.16 8674.27,-8163.16"/>
<text text-anchor="middle" x="8533.27" y="-8147.96" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="8533.27" y="-8132.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="8533.27" y="-8117.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="8533.27" y="-8102.96" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_route_expert11&#45;&gt;layer1_expert11_up -->
<g id="edge420" class="edge">
<title>layer1_route_expert11&#45;&gt;layer1_expert11_up</title>
<path fill="none" stroke="black" d="M8533.27,-8249.03C8533.27,-8249.03 8533.27,-8173.34 8533.27,-8173.34"/>
<polygon fill="black" stroke="black" points="8536.77,-8173.34 8533.27,-8163.34 8529.77,-8173.34 8536.77,-8173.34"/>
</g>
<!-- layer1_expert11_activation -->
<g id="node330" class="node">
<title>layer1_expert11_activation</title>
<polygon fill="lightyellow" stroke="black" points="8668.27,-8009.16 8386.27,-8009.16 8386.27,-7941.16 8668.27,-7941.16 8668.27,-8009.16"/>
<text text-anchor="middle" x="8527.27" y="-7993.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="8527.27" y="-7978.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="8527.27" y="-7963.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="8527.27" y="-7948.96" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_expert11_up&#45;&gt;layer1_expert11_activation -->
<g id="edge421" class="edge">
<title>layer1_expert11_up&#45;&gt;layer1_expert11_activation</title>
<path fill="none" stroke="black" d="M8530.27,-8094.99C8530.27,-8094.99 8530.27,-8019.25 8530.27,-8019.25"/>
<polygon fill="black" stroke="black" points="8533.77,-8019.25 8530.27,-8009.25 8526.77,-8019.25 8533.77,-8019.25"/>
</g>
<!-- layer1_expert11_down -->
<g id="node331" class="node">
<title>layer1_expert11_down</title>
<polygon fill="lightcoral" stroke="black" points="8638.77,-7855.16 8365.77,-7855.16 8365.77,-7787.16 8638.77,-7787.16 8638.77,-7855.16"/>
<text text-anchor="middle" x="8502.27" y="-7839.96" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="8502.27" y="-7824.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="8502.27" y="-7809.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="8502.27" y="-7794.96" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_expert11_activation&#45;&gt;layer1_expert11_down -->
<g id="edge422" class="edge">
<title>layer1_expert11_activation&#45;&gt;layer1_expert11_down</title>
<path fill="none" stroke="black" d="M8512.52,-7940.99C8512.52,-7940.99 8512.52,-7865.25 8512.52,-7865.25"/>
<polygon fill="black" stroke="black" points="8516.02,-7865.25 8512.52,-7855.25 8509.02,-7865.25 8516.02,-7865.25"/>
</g>
<!-- layer1_route_back_expert11 -->
<g id="node332" class="node">
<title>layer1_route_back_expert11</title>
<polygon fill="lightpink" stroke="black" points="9010.3,-7701.16 8191,-7701.16 7980.23,-7565.16 8799.54,-7565.16 9010.3,-7701.16"/>
<text text-anchor="middle" x="8495.27" y="-7651.96" font-family="Times,serif" font-size="14.00">Route Back Expert 11</text>
<text text-anchor="middle" x="8495.27" y="-7636.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="8495.27" y="-7621.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8495.27" y="-7606.96" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer1_expert11_down&#45;&gt;layer1_route_back_expert11 -->
<g id="edge423" class="edge">
<title>layer1_expert11_down&#45;&gt;layer1_route_back_expert11</title>
<path fill="none" stroke="black" d="M8502.27,-7787.12C8502.27,-7787.12 8502.27,-7711.23 8502.27,-7711.23"/>
<polygon fill="black" stroke="black" points="8505.77,-7711.23 8502.27,-7701.23 8498.77,-7711.23 8505.77,-7711.23"/>
</g>
<!-- layer1_route_back_expert11&#45;&gt;layer1_expert_agg -->
<g id="edge459" class="edge">
<title>layer1_route_back_expert11&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M8700.69,-7565.05C8700.69,-7515.48 8700.69,-7457 8700.69,-7457 8700.69,-7457 10367.15,-7457 10367.15,-7457"/>
<polygon fill="black" stroke="black" points="10367.15,-7460.5 10377.15,-7457 10367.15,-7453.5 10367.15,-7460.5"/>
</g>
<!-- layer1_expert12_up -->
<g id="node334" class="node">
<title>layer1_expert12_up</title>
<polygon fill="lightcoral" stroke="black" points="9746.27,-8163.16 9464.27,-8163.16 9464.27,-8095.16 9746.27,-8095.16 9746.27,-8163.16"/>
<text text-anchor="middle" x="9605.27" y="-8147.96" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="9605.27" y="-8132.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="9605.27" y="-8117.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="9605.27" y="-8102.96" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_route_expert12&#45;&gt;layer1_expert12_up -->
<g id="edge426" class="edge">
<title>layer1_route_expert12&#45;&gt;layer1_expert12_up</title>
<path fill="none" stroke="black" d="M9605.27,-8249.03C9605.27,-8249.03 9605.27,-8173.34 9605.27,-8173.34"/>
<polygon fill="black" stroke="black" points="9608.77,-8173.34 9605.27,-8163.34 9601.77,-8173.34 9608.77,-8173.34"/>
</g>
<!-- layer1_expert12_activation -->
<g id="node335" class="node">
<title>layer1_expert12_activation</title>
<polygon fill="lightyellow" stroke="black" points="9743.27,-8009.16 9461.27,-8009.16 9461.27,-7941.16 9743.27,-7941.16 9743.27,-8009.16"/>
<text text-anchor="middle" x="9602.27" y="-7993.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="9602.27" y="-7978.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="9602.27" y="-7963.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="9602.27" y="-7948.96" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_expert12_up&#45;&gt;layer1_expert12_activation -->
<g id="edge427" class="edge">
<title>layer1_expert12_up&#45;&gt;layer1_expert12_activation</title>
<path fill="none" stroke="black" d="M9603.77,-8094.99C9603.77,-8094.99 9603.77,-8019.25 9603.77,-8019.25"/>
<polygon fill="black" stroke="black" points="9607.27,-8019.25 9603.77,-8009.25 9600.27,-8019.25 9607.27,-8019.25"/>
</g>
<!-- layer1_expert12_down -->
<g id="node336" class="node">
<title>layer1_expert12_down</title>
<polygon fill="lightcoral" stroke="black" points="9726.77,-7855.16 9453.77,-7855.16 9453.77,-7787.16 9726.77,-7787.16 9726.77,-7855.16"/>
<text text-anchor="middle" x="9590.27" y="-7839.96" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="9590.27" y="-7824.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="9590.27" y="-7809.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="9590.27" y="-7794.96" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_expert12_activation&#45;&gt;layer1_expert12_down -->
<g id="edge428" class="edge">
<title>layer1_expert12_activation&#45;&gt;layer1_expert12_down</title>
<path fill="none" stroke="black" d="M9594.02,-7940.99C9594.02,-7940.99 9594.02,-7865.25 9594.02,-7865.25"/>
<polygon fill="black" stroke="black" points="9597.52,-7865.25 9594.02,-7855.25 9590.52,-7865.25 9597.52,-7865.25"/>
</g>
<!-- layer1_route_back_expert12 -->
<g id="node337" class="node">
<title>layer1_route_back_expert12</title>
<polygon fill="lightpink" stroke="black" points="10099.3,-7701.16 9280,-7701.16 9069.23,-7565.16 9888.54,-7565.16 10099.3,-7701.16"/>
<text text-anchor="middle" x="9584.27" y="-7651.96" font-family="Times,serif" font-size="14.00">Route Back Expert 12</text>
<text text-anchor="middle" x="9584.27" y="-7636.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="9584.27" y="-7621.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9584.27" y="-7606.96" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_expert12_down&#45;&gt;layer1_route_back_expert12 -->
<g id="edge429" class="edge">
<title>layer1_expert12_down&#45;&gt;layer1_route_back_expert12</title>
<path fill="none" stroke="black" d="M9590.27,-7787.12C9590.27,-7787.12 9590.27,-7711.23 9590.27,-7711.23"/>
<polygon fill="black" stroke="black" points="9593.77,-7711.23 9590.27,-7701.23 9586.77,-7711.23 9593.77,-7711.23"/>
</g>
<!-- layer1_route_back_expert12&#45;&gt;layer1_expert_agg -->
<g id="edge460" class="edge">
<title>layer1_route_back_expert12&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M9991.15,-7631.31C9991.15,-7613.16 9991.15,-7468 9991.15,-7468 9991.15,-7468 10438.03,-7468 10438.03,-7468"/>
<polygon fill="black" stroke="black" points="10438.03,-7471.5 10448.03,-7468 10438.03,-7464.5 10438.03,-7471.5"/>
</g>
<!-- layer1_expert13_up -->
<g id="node339" class="node">
<title>layer1_expert13_up</title>
<polygon fill="lightcoral" stroke="black" points="10814.27,-8163.16 10532.27,-8163.16 10532.27,-8095.16 10814.27,-8095.16 10814.27,-8163.16"/>
<text text-anchor="middle" x="10673.27" y="-8147.96" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="10673.27" y="-8132.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="10673.27" y="-8117.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="10673.27" y="-8102.96" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_route_expert13&#45;&gt;layer1_expert13_up -->
<g id="edge432" class="edge">
<title>layer1_route_expert13&#45;&gt;layer1_expert13_up</title>
<path fill="none" stroke="black" d="M10673.27,-8249.03C10673.27,-8249.03 10673.27,-8173.34 10673.27,-8173.34"/>
<polygon fill="black" stroke="black" points="10676.77,-8173.34 10673.27,-8163.34 10669.77,-8173.34 10676.77,-8173.34"/>
</g>
<!-- layer1_expert13_activation -->
<g id="node340" class="node">
<title>layer1_expert13_activation</title>
<polygon fill="lightyellow" stroke="black" points="10814.27,-8009.16 10532.27,-8009.16 10532.27,-7941.16 10814.27,-7941.16 10814.27,-8009.16"/>
<text text-anchor="middle" x="10673.27" y="-7993.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="10673.27" y="-7978.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="10673.27" y="-7963.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="10673.27" y="-7948.96" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_expert13_up&#45;&gt;layer1_expert13_activation -->
<g id="edge433" class="edge">
<title>layer1_expert13_up&#45;&gt;layer1_expert13_activation</title>
<path fill="none" stroke="black" d="M10673.27,-8094.99C10673.27,-8094.99 10673.27,-8019.25 10673.27,-8019.25"/>
<polygon fill="black" stroke="black" points="10676.77,-8019.25 10673.27,-8009.25 10669.77,-8019.25 10676.77,-8019.25"/>
</g>
<!-- layer1_expert13_down -->
<g id="node341" class="node">
<title>layer1_expert13_down</title>
<polygon fill="lightcoral" stroke="black" points="10809.77,-7855.16 10536.77,-7855.16 10536.77,-7787.16 10809.77,-7787.16 10809.77,-7855.16"/>
<text text-anchor="middle" x="10673.27" y="-7839.96" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="10673.27" y="-7824.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="10673.27" y="-7809.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="10673.27" y="-7794.96" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_expert13_activation&#45;&gt;layer1_expert13_down -->
<g id="edge434" class="edge">
<title>layer1_expert13_activation&#45;&gt;layer1_expert13_down</title>
<path fill="none" stroke="black" d="M10673.27,-7940.99C10673.27,-7940.99 10673.27,-7865.25 10673.27,-7865.25"/>
<polygon fill="black" stroke="black" points="10676.77,-7865.25 10673.27,-7855.25 10669.77,-7865.25 10676.77,-7865.25"/>
</g>
<!-- layer1_route_back_expert13 -->
<g id="node342" class="node">
<title>layer1_route_back_expert13</title>
<polygon fill="lightpink" stroke="black" points="11188.3,-7701.16 10369,-7701.16 10158.23,-7565.16 10977.54,-7565.16 11188.3,-7701.16"/>
<text text-anchor="middle" x="10673.27" y="-7651.96" font-family="Times,serif" font-size="14.00">Route Back Expert 13</text>
<text text-anchor="middle" x="10673.27" y="-7636.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="10673.27" y="-7621.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10673.27" y="-7606.96" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer1_expert13_down&#45;&gt;layer1_route_back_expert13 -->
<g id="edge435" class="edge">
<title>layer1_expert13_down&#45;&gt;layer1_route_back_expert13</title>
<path fill="none" stroke="black" d="M10673.27,-7787.12C10673.27,-7787.12 10673.27,-7711.23 10673.27,-7711.23"/>
<polygon fill="black" stroke="black" points="10676.77,-7711.23 10673.27,-7701.23 10669.77,-7711.23 10676.77,-7711.23"/>
</g>
<!-- layer1_route_back_expert13&#45;&gt;layer1_expert_agg -->
<g id="edge461" class="edge">
<title>layer1_route_back_expert13&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M10673.27,-7565.03C10673.27,-7565.03 10673.27,-7489.47 10673.27,-7489.47"/>
<polygon fill="black" stroke="black" points="10676.77,-7489.47 10673.27,-7479.47 10669.77,-7489.47 10676.77,-7489.47"/>
</g>
<!-- layer1_expert14_up -->
<g id="node344" class="node">
<title>layer1_expert14_up</title>
<polygon fill="lightcoral" stroke="black" points="11881.27,-8163.16 11599.27,-8163.16 11599.27,-8095.16 11881.27,-8095.16 11881.27,-8163.16"/>
<text text-anchor="middle" x="11740.27" y="-8147.96" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="11740.27" y="-8132.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="11740.27" y="-8117.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="11740.27" y="-8102.96" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_route_expert14&#45;&gt;layer1_expert14_up -->
<g id="edge438" class="edge">
<title>layer1_route_expert14&#45;&gt;layer1_expert14_up</title>
<path fill="none" stroke="black" d="M11740.27,-8249.03C11740.27,-8249.03 11740.27,-8173.34 11740.27,-8173.34"/>
<polygon fill="black" stroke="black" points="11743.77,-8173.34 11740.27,-8163.34 11736.77,-8173.34 11743.77,-8173.34"/>
</g>
<!-- layer1_expert14_activation -->
<g id="node345" class="node">
<title>layer1_expert14_activation</title>
<polygon fill="lightyellow" stroke="black" points="11885.27,-8009.16 11603.27,-8009.16 11603.27,-7941.16 11885.27,-7941.16 11885.27,-8009.16"/>
<text text-anchor="middle" x="11744.27" y="-7993.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="11744.27" y="-7978.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="11744.27" y="-7963.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="11744.27" y="-7948.96" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_expert14_up&#45;&gt;layer1_expert14_activation -->
<g id="edge439" class="edge">
<title>layer1_expert14_up&#45;&gt;layer1_expert14_activation</title>
<path fill="none" stroke="black" d="M11742.27,-8094.99C11742.27,-8094.99 11742.27,-8019.25 11742.27,-8019.25"/>
<polygon fill="black" stroke="black" points="11745.77,-8019.25 11742.27,-8009.25 11738.77,-8019.25 11745.77,-8019.25"/>
</g>
<!-- layer1_expert14_down -->
<g id="node346" class="node">
<title>layer1_expert14_down</title>
<polygon fill="lightcoral" stroke="black" points="11886.77,-7855.16 11613.77,-7855.16 11613.77,-7787.16 11886.77,-7787.16 11886.77,-7855.16"/>
<text text-anchor="middle" x="11750.27" y="-7839.96" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="11750.27" y="-7824.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="11750.27" y="-7809.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="11750.27" y="-7794.96" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_expert14_activation&#45;&gt;layer1_expert14_down -->
<g id="edge440" class="edge">
<title>layer1_expert14_activation&#45;&gt;layer1_expert14_down</title>
<path fill="none" stroke="black" d="M11749.52,-7940.99C11749.52,-7940.99 11749.52,-7865.25 11749.52,-7865.25"/>
<polygon fill="black" stroke="black" points="11753.02,-7865.25 11749.52,-7855.25 11746.02,-7865.25 11753.02,-7865.25"/>
</g>
<!-- layer1_route_back_expert14 -->
<g id="node347" class="node">
<title>layer1_route_back_expert14</title>
<polygon fill="lightpink" stroke="black" points="12277.3,-7701.16 11458,-7701.16 11247.23,-7565.16 12066.54,-7565.16 12277.3,-7701.16"/>
<text text-anchor="middle" x="11762.27" y="-7651.96" font-family="Times,serif" font-size="14.00">Route Back Expert 14</text>
<text text-anchor="middle" x="11762.27" y="-7636.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="11762.27" y="-7621.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11762.27" y="-7606.96" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_expert14_down&#45;&gt;layer1_route_back_expert14 -->
<g id="edge441" class="edge">
<title>layer1_expert14_down&#45;&gt;layer1_route_back_expert14</title>
<path fill="none" stroke="black" d="M11750.27,-7787.12C11750.27,-7787.12 11750.27,-7711.23 11750.27,-7711.23"/>
<polygon fill="black" stroke="black" points="11753.77,-7711.23 11750.27,-7701.23 11746.77,-7711.23 11753.77,-7711.23"/>
</g>
<!-- layer1_route_back_expert14&#45;&gt;layer1_expert_agg -->
<g id="edge462" class="edge">
<title>layer1_route_back_expert14&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M11403.38,-7565.03C11403.38,-7519.54 11403.38,-7468 11403.38,-7468 11403.38,-7468 10908.78,-7468 10908.78,-7468"/>
<polygon fill="black" stroke="black" points="10908.78,-7464.5 10898.78,-7468 10908.78,-7471.5 10908.78,-7464.5"/>
</g>
<!-- layer1_expert15_up -->
<g id="node349" class="node">
<title>layer1_expert15_up</title>
<polygon fill="lightcoral" stroke="black" points="12948.27,-8163.16 12666.27,-8163.16 12666.27,-8095.16 12948.27,-8095.16 12948.27,-8163.16"/>
<text text-anchor="middle" x="12807.27" y="-8147.96" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="12807.27" y="-8132.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="12807.27" y="-8117.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="12807.27" y="-8102.96" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_route_expert15&#45;&gt;layer1_expert15_up -->
<g id="edge444" class="edge">
<title>layer1_route_expert15&#45;&gt;layer1_expert15_up</title>
<path fill="none" stroke="black" d="M12807.27,-8249.03C12807.27,-8249.03 12807.27,-8173.34 12807.27,-8173.34"/>
<polygon fill="black" stroke="black" points="12810.77,-8173.34 12807.27,-8163.34 12803.77,-8173.34 12810.77,-8173.34"/>
</g>
<!-- layer1_expert15_activation -->
<g id="node350" class="node">
<title>layer1_expert15_activation</title>
<polygon fill="lightyellow" stroke="black" points="12973.27,-8009.16 12691.27,-8009.16 12691.27,-7941.16 12973.27,-7941.16 12973.27,-8009.16"/>
<text text-anchor="middle" x="12832.27" y="-7993.96" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="12832.27" y="-7978.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="12832.27" y="-7963.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="12832.27" y="-7948.96" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_expert15_up&#45;&gt;layer1_expert15_activation -->
<g id="edge445" class="edge">
<title>layer1_expert15_up&#45;&gt;layer1_expert15_activation</title>
<path fill="none" stroke="black" d="M12819.77,-8094.99C12819.77,-8094.99 12819.77,-8019.25 12819.77,-8019.25"/>
<polygon fill="black" stroke="black" points="12823.27,-8019.25 12819.77,-8009.25 12816.27,-8019.25 12823.27,-8019.25"/>
</g>
<!-- layer1_expert15_down -->
<g id="node351" class="node">
<title>layer1_expert15_down</title>
<polygon fill="lightcoral" stroke="black" points="12975.77,-7855.16 12702.77,-7855.16 12702.77,-7787.16 12975.77,-7787.16 12975.77,-7855.16"/>
<text text-anchor="middle" x="12839.27" y="-7839.96" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="12839.27" y="-7824.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="12839.27" y="-7809.96" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="12839.27" y="-7794.96" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_expert15_activation&#45;&gt;layer1_expert15_down -->
<g id="edge446" class="edge">
<title>layer1_expert15_activation&#45;&gt;layer1_expert15_down</title>
<path fill="none" stroke="black" d="M12838.02,-7940.99C12838.02,-7940.99 12838.02,-7865.25 12838.02,-7865.25"/>
<polygon fill="black" stroke="black" points="12841.52,-7865.25 12838.02,-7855.25 12834.52,-7865.25 12841.52,-7865.25"/>
</g>
<!-- layer1_route_back_expert15 -->
<g id="node352" class="node">
<title>layer1_route_back_expert15</title>
<polygon fill="lightpink" stroke="black" points="13366.3,-7701.16 12547,-7701.16 12336.23,-7565.16 13155.54,-7565.16 13366.3,-7701.16"/>
<text text-anchor="middle" x="12851.27" y="-7651.96" font-family="Times,serif" font-size="14.00">Route Back Expert 15</text>
<text text-anchor="middle" x="12851.27" y="-7636.96" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="12851.27" y="-7621.96" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12851.27" y="-7606.96" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer1_expert15_down&#45;&gt;layer1_route_back_expert15 -->
<g id="edge447" class="edge">
<title>layer1_expert15_down&#45;&gt;layer1_route_back_expert15</title>
<path fill="none" stroke="black" d="M12839.27,-7787.12C12839.27,-7787.12 12839.27,-7711.23 12839.27,-7711.23"/>
<polygon fill="black" stroke="black" points="12842.77,-7711.23 12839.27,-7701.23 12835.77,-7711.23 12842.77,-7711.23"/>
</g>
<!-- layer1_route_back_expert15&#45;&gt;layer1_expert_agg -->
<g id="edge463" class="edge">
<title>layer1_route_back_expert15&#45;&gt;layer1_expert_agg</title>
<path fill="none" stroke="black" d="M12368.38,-7633.04C12368.38,-7627.7 12368.38,-7457 12368.38,-7457 12368.38,-7457 10979.5,-7457 10979.5,-7457"/>
<polygon fill="black" stroke="black" points="10979.5,-7453.5 10969.5,-7457 10979.5,-7460.5 10979.5,-7453.5"/>
</g>
<!-- layer1_expert_agg&#45;&gt;layer1_final_residual -->
<g id="edge465" class="edge">
<title>layer1_expert_agg&#45;&gt;layer1_final_residual</title>
<path fill="none" stroke="black" d="M10458.4,-7393C9679.37,-7393 7048.78,-7393 7048.78,-7393 7048.78,-7393 7048.78,-7290.53 7048.78,-7290.53"/>
<polygon fill="black" stroke="black" points="7052.28,-7290.53 7048.78,-7280.53 7045.28,-7290.53 7052.28,-7290.53"/>
</g>
<!-- layer2_attn_norm_gpu0 -->
<g id="node355" class="node">
<title>layer2_attn_norm_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="9882.77,-7114.83 9385.77,-7114.83 9385.77,-7046.83 9882.77,-7046.83 9882.77,-7114.83"/>
<text text-anchor="middle" x="9634.27" y="-7099.63" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="9634.27" y="-7084.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9634.27" y="-7069.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9634.27" y="-7054.63" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer1_final_residual&#45;&gt;layer2_attn_norm_gpu0 -->
<g id="edge466" class="edge">
<title>layer1_final_residual&#45;&gt;layer2_attn_norm_gpu0</title>
<path fill="none" stroke="black" d="M7193.01,-7239C8092.82,-7239 9634.27,-7239 9634.27,-7239 9634.27,-7239 9634.27,-7125.15 9634.27,-7125.15"/>
<polygon fill="black" stroke="black" points="9637.77,-7125.15 9634.27,-7115.15 9630.77,-7125.15 9637.77,-7125.15"/>
</g>
<!-- layer2_attn_norm_gpu1 -->
<g id="node366" class="node">
<title>layer2_attn_norm_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="11559.77,-7114.83 11062.77,-7114.83 11062.77,-7046.83 11559.77,-7046.83 11559.77,-7114.83"/>
<text text-anchor="middle" x="11311.27" y="-7099.63" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="11311.27" y="-7084.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11311.27" y="-7069.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11311.27" y="-7054.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer1_final_residual&#45;&gt;layer2_attn_norm_gpu1 -->
<g id="edge479" class="edge">
<title>layer1_final_residual&#45;&gt;layer2_attn_norm_gpu1</title>
<path fill="none" stroke="black" d="M7195.06,-7258C8449.51,-7258 11125.65,-7258 11125.65,-7258 11125.65,-7258 11125.65,-7124.99 11125.65,-7124.99"/>
<polygon fill="black" stroke="black" points="11129.15,-7124.99 11125.65,-7114.99 11122.15,-7124.99 11129.15,-7124.99"/>
</g>
<!-- layer2_attn_norm_gpu2 -->
<g id="node377" class="node">
<title>layer2_attn_norm_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="13236.77,-7114.83 12739.77,-7114.83 12739.77,-7046.83 13236.77,-7046.83 13236.77,-7114.83"/>
<text text-anchor="middle" x="12988.27" y="-7099.63" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="12988.27" y="-7084.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12988.27" y="-7069.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12988.27" y="-7054.63" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer1_final_residual&#45;&gt;layer2_attn_norm_gpu2 -->
<g id="edge492" class="edge">
<title>layer1_final_residual&#45;&gt;layer2_attn_norm_gpu2</title>
<path fill="none" stroke="black" d="M7084.93,-7277C8618.9,-7277 12988.27,-7277 12988.27,-7277 12988.27,-7277 12988.27,-7125 12988.27,-7125"/>
<polygon fill="black" stroke="black" points="12991.77,-7125 12988.27,-7115 12984.77,-7125 12991.77,-7125"/>
</g>
<!-- layer2_attn_norm_gpu3 -->
<g id="node388" class="node">
<title>layer2_attn_norm_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="2056.77,-7114.83 1559.77,-7114.83 1559.77,-7046.83 2056.77,-7046.83 2056.77,-7114.83"/>
<text text-anchor="middle" x="1808.27" y="-7099.63" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="1808.27" y="-7084.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1808.27" y="-7069.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1808.27" y="-7054.63" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer1_final_residual&#45;&gt;layer2_attn_norm_gpu3 -->
<g id="edge505" class="edge">
<title>layer1_final_residual&#45;&gt;layer2_attn_norm_gpu3</title>
<path fill="none" stroke="black" d="M5946.33,-7264C4661.72,-7264 1808.27,-7264 1808.27,-7264 1808.27,-7264 1808.27,-7124.85 1808.27,-7124.85"/>
<polygon fill="black" stroke="black" points="1811.77,-7124.85 1808.27,-7114.85 1804.77,-7124.85 1811.77,-7124.85"/>
</g>
<!-- layer2_attn_norm_gpu4 -->
<g id="node399" class="node">
<title>layer2_attn_norm_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="3733.77,-7114.83 3236.77,-7114.83 3236.77,-7046.83 3733.77,-7046.83 3733.77,-7114.83"/>
<text text-anchor="middle" x="3485.27" y="-7099.63" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="3485.27" y="-7084.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3485.27" y="-7069.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3485.27" y="-7054.63" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer1_final_residual&#45;&gt;layer2_attn_norm_gpu4 -->
<g id="edge518" class="edge">
<title>layer1_final_residual&#45;&gt;layer2_attn_norm_gpu4</title>
<path fill="none" stroke="black" d="M5954.92,-7232C5109.83,-7232 3678.88,-7232 3678.88,-7232 3678.88,-7232 3678.88,-7125.13 3678.88,-7125.13"/>
<polygon fill="black" stroke="black" points="3682.38,-7125.13 3678.88,-7115.13 3675.38,-7125.13 3682.38,-7125.13"/>
</g>
<!-- layer2_attn_norm_gpu5 -->
<g id="node410" class="node">
<title>layer2_attn_norm_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="5411.77,-7114.83 4914.77,-7114.83 4914.77,-7046.83 5411.77,-7046.83 5411.77,-7114.83"/>
<text text-anchor="middle" x="5163.27" y="-7099.63" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="5163.27" y="-7084.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5163.27" y="-7069.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5163.27" y="-7054.63" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer1_final_residual&#45;&gt;layer2_attn_norm_gpu5 -->
<g id="edge531" class="edge">
<title>layer1_final_residual&#45;&gt;layer2_attn_norm_gpu5</title>
<path fill="none" stroke="black" d="M5998.42,-7225.08C5998.42,-7181.19 5998.42,-7092 5998.42,-7092 5998.42,-7092 5421.86,-7092 5421.86,-7092"/>
<polygon fill="black" stroke="black" points="5421.86,-7088.5 5411.86,-7092 5421.86,-7095.5 5421.86,-7088.5"/>
</g>
<!-- layer2_attn_norm_gpu6 -->
<g id="node421" class="node">
<title>layer2_attn_norm_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="6808.77,-7114.83 6311.77,-7114.83 6311.77,-7046.83 6808.77,-7046.83 6808.77,-7114.83"/>
<text text-anchor="middle" x="6560.27" y="-7099.63" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="6560.27" y="-7084.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6560.27" y="-7069.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6560.27" y="-7054.63" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer1_final_residual&#45;&gt;layer2_attn_norm_gpu6 -->
<g id="edge544" class="edge">
<title>layer1_final_residual&#45;&gt;layer2_attn_norm_gpu6</title>
<path fill="none" stroke="black" d="M6560.27,-7200.75C6560.27,-7200.75 6560.27,-7124.86 6560.27,-7124.86"/>
<polygon fill="black" stroke="black" points="6563.77,-7124.86 6560.27,-7114.86 6556.77,-7124.86 6563.77,-7124.86"/>
</g>
<!-- layer2_attn_norm_gpu7 -->
<g id="node432" class="node">
<title>layer2_attn_norm_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="8205.77,-7114.83 7708.77,-7114.83 7708.77,-7046.83 8205.77,-7046.83 8205.77,-7114.83"/>
<text text-anchor="middle" x="7957.27" y="-7099.63" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="7957.27" y="-7084.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7957.27" y="-7069.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7957.27" y="-7054.63" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer1_final_residual&#45;&gt;layer2_attn_norm_gpu7 -->
<g id="edge557" class="edge">
<title>layer1_final_residual&#45;&gt;layer2_attn_norm_gpu7</title>
<path fill="none" stroke="black" d="M7076.74,-7220C7435.93,-7220 7850.61,-7220 7850.61,-7220 7850.61,-7220 7850.61,-7124.88 7850.61,-7124.88"/>
<polygon fill="black" stroke="black" points="7854.11,-7124.88 7850.61,-7114.88 7847.11,-7124.88 7854.11,-7124.88"/>
</g>
<!-- layer2_attn_residual -->
<g id="node444" class="node">
<title>layer2_attn_residual</title>
<ellipse fill="lightblue" stroke="black" cx="3316.27" cy="-5722.08" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="3316.27" y="-5740.88" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3316.27" y="-5725.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096], [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3316.27" y="-5710.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3316.27" y="-5695.88" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer1_final_residual&#45;&gt;layer2_attn_residual -->
<g id="edge578" class="edge">
<title>layer1_final_residual&#45;&gt;layer2_attn_residual</title>
<path fill="none" stroke="black" d="M6082.87,-7216.26C6082.87,-7149.37 6082.87,-7003 6082.87,-7003 6082.87,-7003 3463.83,-7003 3463.83,-7003 3463.83,-7003 3463.83,-5779.19 3463.83,-5779.19"/>
<polygon fill="black" stroke="black" points="3467.33,-5779.19 3463.83,-5769.19 3460.33,-5779.19 3467.33,-5779.19"/>
</g>
<!-- layer2_q_proj_gpu0 -->
<g id="node356" class="node">
<title>layer2_q_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="10723.77,-6960.83 10222.77,-6960.83 10222.77,-6892.83 10723.77,-6892.83 10723.77,-6960.83"/>
<text text-anchor="middle" x="10473.27" y="-6945.63" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="10473.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10473.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10473.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_attn_norm_gpu0&#45;&gt;layer2_q_proj_gpu0 -->
<g id="edge467" class="edge">
<title>layer2_attn_norm_gpu0&#45;&gt;layer2_q_proj_gpu0</title>
<path fill="none" stroke="black" d="M9882.77,-7080C10061.92,-7080 10272.3,-7080 10272.3,-7080 10272.3,-7080 10272.3,-6971.21 10272.3,-6971.21"/>
<polygon fill="black" stroke="black" points="10275.8,-6971.2 10272.3,-6961.21 10268.8,-6971.21 10275.8,-6971.2"/>
</g>
<!-- layer2_k_proj_gpu0 -->
<g id="node357" class="node">
<title>layer2_k_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="10164.77,-6960.83 9663.77,-6960.83 9663.77,-6892.83 10164.77,-6892.83 10164.77,-6960.83"/>
<text text-anchor="middle" x="9914.27" y="-6945.63" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="9914.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9914.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9914.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_attn_norm_gpu0&#45;&gt;layer2_k_proj_gpu0 -->
<g id="edge468" class="edge">
<title>layer2_attn_norm_gpu0&#45;&gt;layer2_k_proj_gpu0</title>
<path fill="none" stroke="black" d="M9773.27,-7046.65C9773.27,-7046.65 9773.27,-6970.91 9773.27,-6970.91"/>
<polygon fill="black" stroke="black" points="9776.77,-6970.91 9773.27,-6960.91 9769.77,-6970.91 9776.77,-6970.91"/>
</g>
<!-- layer2_v_proj_gpu0 -->
<g id="node358" class="node">
<title>layer2_v_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="9605.77,-6960.83 9104.77,-6960.83 9104.77,-6892.83 9605.77,-6892.83 9605.77,-6960.83"/>
<text text-anchor="middle" x="9355.27" y="-6945.63" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="9355.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9355.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9355.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_attn_norm_gpu0&#45;&gt;layer2_v_proj_gpu0 -->
<g id="edge469" class="edge">
<title>layer2_attn_norm_gpu0&#45;&gt;layer2_v_proj_gpu0</title>
<path fill="none" stroke="black" d="M9495.77,-7046.65C9495.77,-7046.65 9495.77,-6970.91 9495.77,-6970.91"/>
<polygon fill="black" stroke="black" points="9499.27,-6970.91 9495.77,-6960.91 9492.27,-6970.91 9499.27,-6970.91"/>
</g>
<!-- layer2_gather_q_gpu0 -->
<g id="node359" class="node">
<title>layer2_gather_q_gpu0</title>
<ellipse fill="lightblue" stroke="black" cx="10583.27" cy="-6758.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="10583.27" y="-6777.55" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="10583.27" y="-6762.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10583.27" y="-6747.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10583.27" y="-6732.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_q_proj_gpu0&#45;&gt;layer2_gather_q_gpu0 -->
<g id="edge470" class="edge">
<title>layer2_q_proj_gpu0&#45;&gt;layer2_gather_q_gpu0</title>
<path fill="none" stroke="black" d="M10473.27,-6892.82C10473.27,-6892.82 10473.27,-6814.82 10473.27,-6814.82"/>
<polygon fill="black" stroke="black" points="10476.77,-6814.82 10473.27,-6804.82 10469.77,-6814.82 10476.77,-6814.82"/>
</g>
<!-- layer2_gather_k_gpu0 -->
<g id="node360" class="node">
<title>layer2_gather_k_gpu0</title>
<ellipse fill="lightblue" stroke="black" cx="9804.27" cy="-6758.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="9804.27" y="-6777.55" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="9804.27" y="-6762.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9804.27" y="-6747.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9804.27" y="-6732.55" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_k_proj_gpu0&#45;&gt;layer2_gather_k_gpu0 -->
<g id="edge471" class="edge">
<title>layer2_k_proj_gpu0&#45;&gt;layer2_gather_k_gpu0</title>
<path fill="none" stroke="black" d="M9914.27,-6892.82C9914.27,-6892.82 9914.27,-6814.82 9914.27,-6814.82"/>
<polygon fill="black" stroke="black" points="9917.77,-6814.82 9914.27,-6804.82 9910.77,-6814.82 9917.77,-6814.82"/>
</g>
<!-- layer2_gather_v_gpu0 -->
<g id="node361" class="node">
<title>layer2_gather_v_gpu0</title>
<ellipse fill="lightblue" stroke="black" cx="9236.27" cy="-6394.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="9236.27" y="-6413.21" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="9236.27" y="-6398.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9236.27" y="-6383.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9236.27" y="-6368.21" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_v_proj_gpu0&#45;&gt;layer2_gather_v_gpu0 -->
<g id="edge472" class="edge">
<title>layer2_v_proj_gpu0&#45;&gt;layer2_gather_v_gpu0</title>
<path fill="none" stroke="black" d="M9355.27,-6892.72C9355.27,-6892.72 9355.27,-6449.98 9355.27,-6449.98"/>
<polygon fill="black" stroke="black" points="9358.77,-6449.98 9355.27,-6439.98 9351.77,-6449.98 9358.77,-6449.98"/>
</g>
<!-- layer2_attn_scores_gpu0 -->
<g id="node362" class="node">
<title>layer2_attn_scores_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="10193.77,-6610.58 9654.77,-6610.58 9654.77,-6542.58 10193.77,-6542.58 10193.77,-6610.58"/>
<text text-anchor="middle" x="9924.27" y="-6595.38" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="9924.27" y="-6580.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9924.27" y="-6565.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="9924.27" y="-6550.38" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gather_q_gpu0&#45;&gt;layer2_attn_scores_gpu0 -->
<g id="edge473" class="edge">
<title>layer2_gather_q_gpu0&#45;&gt;layer2_attn_scores_gpu0</title>
<path fill="none" stroke="black" d="M10222.56,-6758C10195.99,-6758 10179.33,-6758 10179.33,-6758 10179.33,-6758 10179.33,-6620.7 10179.33,-6620.7"/>
<polygon fill="black" stroke="black" points="10182.83,-6620.7 10179.33,-6610.7 10175.83,-6620.7 10182.83,-6620.7"/>
</g>
<!-- layer2_gather_k_gpu0&#45;&gt;layer2_attn_scores_gpu0 -->
<g id="edge474" class="edge">
<title>layer2_gather_k_gpu0&#45;&gt;layer2_attn_scores_gpu0</title>
<path fill="none" stroke="black" d="M9909.83,-6712.31C9909.83,-6712.31 9909.83,-6620.86 9909.83,-6620.86"/>
<polygon fill="black" stroke="black" points="9913.33,-6620.86 9909.83,-6610.86 9906.33,-6620.86 9913.33,-6620.86"/>
</g>
<!-- layer2_attn_out_gpu0 -->
<g id="node364" class="node">
<title>layer2_attn_out_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="9499.77,-6260.33 8972.77,-6260.33 8972.77,-6192.33 9499.77,-6192.33 9499.77,-6260.33"/>
<text text-anchor="middle" x="9236.27" y="-6245.13" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="9236.27" y="-6230.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="9236.27" y="-6215.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9236.27" y="-6200.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_gather_v_gpu0&#45;&gt;layer2_attn_out_gpu0 -->
<g id="edge477" class="edge">
<title>layer2_gather_v_gpu0&#45;&gt;layer2_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M9236.27,-6346.25C9236.27,-6346.25 9236.27,-6270.36 9236.27,-6270.36"/>
<polygon fill="black" stroke="black" points="9239.77,-6270.36 9236.27,-6260.36 9232.77,-6270.36 9239.77,-6270.36"/>
</g>
<!-- layer2_softmax_gpu0 -->
<g id="node363" class="node">
<title>layer2_softmax_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="10193.77,-6428.41 9654.77,-6428.41 9654.77,-6360.41 10193.77,-6360.41 10193.77,-6428.41"/>
<text text-anchor="middle" x="9924.27" y="-6413.21" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="9924.27" y="-6398.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="9924.27" y="-6383.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="9924.27" y="-6368.21" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_attn_scores_gpu0&#45;&gt;layer2_softmax_gpu0 -->
<g id="edge475" class="edge">
<title>layer2_attn_scores_gpu0&#45;&gt;layer2_softmax_gpu0</title>
<path fill="none" stroke="black" d="M9924.27,-6542.32C9924.27,-6542.32 9924.27,-6438.53 9924.27,-6438.53"/>
<polygon fill="black" stroke="black" points="9927.77,-6438.53 9924.27,-6428.53 9920.77,-6438.53 9927.77,-6438.53"/>
</g>
<!-- layer2_softmax_gpu0&#45;&gt;layer2_attn_out_gpu0 -->
<g id="edge476" class="edge">
<title>layer2_softmax_gpu0&#45;&gt;layer2_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M9687.26,-6360.26C9687.26,-6313.96 9687.26,-6237 9687.26,-6237 9687.26,-6237 9509.92,-6237 9509.92,-6237"/>
<polygon fill="black" stroke="black" points="9509.92,-6233.5 9499.92,-6237 9509.92,-6240.5 9509.92,-6233.5"/>
</g>
<!-- layer2_out_proj_gpu0 -->
<g id="node365" class="node">
<title>layer2_out_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="9033.77,-6106.33 8544.77,-6106.33 8544.77,-6038.33 9033.77,-6038.33 9033.77,-6106.33"/>
<text text-anchor="middle" x="8789.27" y="-6091.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8789.27" y="-6076.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8789.27" y="-6061.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="8789.27" y="-6046.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_attn_out_gpu0&#45;&gt;layer2_out_proj_gpu0 -->
<g id="edge478" class="edge">
<title>layer2_attn_out_gpu0&#45;&gt;layer2_out_proj_gpu0</title>
<path fill="none" stroke="black" d="M9003.27,-6192.15C9003.27,-6192.15 9003.27,-6116.41 9003.27,-6116.41"/>
<polygon fill="black" stroke="black" points="9006.77,-6116.41 9003.27,-6106.41 8999.77,-6116.41 9006.77,-6116.41"/>
</g>
<!-- layer2_attn_all_reduce -->
<g id="node443" class="node">
<title>layer2_attn_all_reduce</title>
<ellipse fill="lightblue" stroke="black" cx="6283.27" cy="-5904.25" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="6283.27" y="-5923.05" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="6283.27" y="-5908.05" font-family="Times,serif" font-size="14.00">Input: 8×[512]</text>
<text text-anchor="middle" x="6283.27" y="-5893.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6283.27" y="-5878.05" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- layer2_out_proj_gpu0&#45;&gt;layer2_attn_all_reduce -->
<g id="edge570" class="edge">
<title>layer2_out_proj_gpu0&#45;&gt;layer2_attn_all_reduce</title>
<path fill="none" stroke="black" d="M8611.76,-6038.13C8611.76,-5995.45 8611.76,-5928 8611.76,-5928 8611.76,-5928 6598.87,-5928 6598.87,-5928"/>
<polygon fill="black" stroke="black" points="6598.87,-5924.5 6588.87,-5928 6598.87,-5931.5 6598.87,-5924.5"/>
</g>
<!-- layer2_q_proj_gpu1 -->
<g id="node367" class="node">
<title>layer2_q_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="12400.77,-6960.83 11899.77,-6960.83 11899.77,-6892.83 12400.77,-6892.83 12400.77,-6960.83"/>
<text text-anchor="middle" x="12150.27" y="-6945.63" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="12150.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12150.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12150.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_attn_norm_gpu1&#45;&gt;layer2_q_proj_gpu1 -->
<g id="edge480" class="edge">
<title>layer2_attn_norm_gpu1&#45;&gt;layer2_q_proj_gpu1</title>
<path fill="none" stroke="black" d="M11559.91,-7080C11787.35,-7080 12088.65,-7080 12088.65,-7080 12088.65,-7080 12088.65,-6971.21 12088.65,-6971.21"/>
<polygon fill="black" stroke="black" points="12092.15,-6971.2 12088.65,-6961.21 12085.15,-6971.21 12092.15,-6971.2"/>
</g>
<!-- layer2_k_proj_gpu1 -->
<g id="node368" class="node">
<title>layer2_k_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11841.77,-6960.83 11340.77,-6960.83 11340.77,-6892.83 11841.77,-6892.83 11841.77,-6960.83"/>
<text text-anchor="middle" x="11591.27" y="-6945.63" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="11591.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11591.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11591.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_attn_norm_gpu1&#45;&gt;layer2_k_proj_gpu1 -->
<g id="edge481" class="edge">
<title>layer2_attn_norm_gpu1&#45;&gt;layer2_k_proj_gpu1</title>
<path fill="none" stroke="black" d="M11450.27,-7046.65C11450.27,-7046.65 11450.27,-6970.91 11450.27,-6970.91"/>
<polygon fill="black" stroke="black" points="11453.77,-6970.91 11450.27,-6960.91 11446.77,-6970.91 11453.77,-6970.91"/>
</g>
<!-- layer2_v_proj_gpu1 -->
<g id="node369" class="node">
<title>layer2_v_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11282.77,-6960.83 10781.77,-6960.83 10781.77,-6892.83 11282.77,-6892.83 11282.77,-6960.83"/>
<text text-anchor="middle" x="11032.27" y="-6945.63" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="11032.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11032.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11032.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_attn_norm_gpu1&#45;&gt;layer2_v_proj_gpu1 -->
<g id="edge482" class="edge">
<title>layer2_attn_norm_gpu1&#45;&gt;layer2_v_proj_gpu1</title>
<path fill="none" stroke="black" d="M11172.77,-7046.65C11172.77,-7046.65 11172.77,-6970.91 11172.77,-6970.91"/>
<polygon fill="black" stroke="black" points="11176.27,-6970.91 11172.77,-6960.91 11169.27,-6970.91 11176.27,-6970.91"/>
</g>
<!-- layer2_gather_q_gpu1 -->
<g id="node370" class="node">
<title>layer2_gather_q_gpu1</title>
<ellipse fill="lightblue" stroke="black" cx="12260.27" cy="-6758.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="12260.27" y="-6777.55" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="12260.27" y="-6762.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12260.27" y="-6747.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12260.27" y="-6732.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_q_proj_gpu1&#45;&gt;layer2_gather_q_gpu1 -->
<g id="edge483" class="edge">
<title>layer2_q_proj_gpu1&#45;&gt;layer2_gather_q_gpu1</title>
<path fill="none" stroke="black" d="M12150.27,-6892.82C12150.27,-6892.82 12150.27,-6814.82 12150.27,-6814.82"/>
<polygon fill="black" stroke="black" points="12153.77,-6814.82 12150.27,-6804.82 12146.77,-6814.82 12153.77,-6814.82"/>
</g>
<!-- layer2_gather_k_gpu1 -->
<g id="node371" class="node">
<title>layer2_gather_k_gpu1</title>
<ellipse fill="lightblue" stroke="black" cx="11481.27" cy="-6758.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="11481.27" y="-6777.55" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="11481.27" y="-6762.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11481.27" y="-6747.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11481.27" y="-6732.55" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_k_proj_gpu1&#45;&gt;layer2_gather_k_gpu1 -->
<g id="edge484" class="edge">
<title>layer2_k_proj_gpu1&#45;&gt;layer2_gather_k_gpu1</title>
<path fill="none" stroke="black" d="M11591.27,-6892.82C11591.27,-6892.82 11591.27,-6814.82 11591.27,-6814.82"/>
<polygon fill="black" stroke="black" points="11594.77,-6814.82 11591.27,-6804.82 11587.77,-6814.82 11594.77,-6814.82"/>
</g>
<!-- layer2_gather_v_gpu1 -->
<g id="node372" class="node">
<title>layer2_gather_v_gpu1</title>
<ellipse fill="lightblue" stroke="black" cx="10913.27" cy="-6576.58" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="10913.27" y="-6595.38" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="10913.27" y="-6580.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10913.27" y="-6565.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10913.27" y="-6550.38" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_v_proj_gpu1&#45;&gt;layer2_gather_v_gpu1 -->
<g id="edge485" class="edge">
<title>layer2_v_proj_gpu1&#45;&gt;layer2_gather_v_gpu1</title>
<path fill="none" stroke="black" d="M11032.27,-6892.61C11032.27,-6892.61 11032.27,-6632.19 11032.27,-6632.19"/>
<polygon fill="black" stroke="black" points="11035.77,-6632.19 11032.27,-6622.19 11028.77,-6632.19 11035.77,-6632.19"/>
</g>
<!-- layer2_attn_scores_gpu1 -->
<g id="node373" class="node">
<title>layer2_attn_scores_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="11870.77,-6610.58 11331.77,-6610.58 11331.77,-6542.58 11870.77,-6542.58 11870.77,-6610.58"/>
<text text-anchor="middle" x="11601.27" y="-6595.38" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="11601.27" y="-6580.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11601.27" y="-6565.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="11601.27" y="-6550.38" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gather_q_gpu1&#45;&gt;layer2_attn_scores_gpu1 -->
<g id="edge486" class="edge">
<title>layer2_gather_q_gpu1&#45;&gt;layer2_attn_scores_gpu1</title>
<path fill="none" stroke="black" d="M11899.56,-6758C11872.99,-6758 11856.33,-6758 11856.33,-6758 11856.33,-6758 11856.33,-6620.7 11856.33,-6620.7"/>
<polygon fill="black" stroke="black" points="11859.83,-6620.7 11856.33,-6610.7 11852.83,-6620.7 11859.83,-6620.7"/>
</g>
<!-- layer2_gather_k_gpu1&#45;&gt;layer2_attn_scores_gpu1 -->
<g id="edge487" class="edge">
<title>layer2_gather_k_gpu1&#45;&gt;layer2_attn_scores_gpu1</title>
<path fill="none" stroke="black" d="M11586.83,-6712.31C11586.83,-6712.31 11586.83,-6620.86 11586.83,-6620.86"/>
<polygon fill="black" stroke="black" points="11590.33,-6620.86 11586.83,-6610.86 11583.33,-6620.86 11590.33,-6620.86"/>
</g>
<!-- layer2_attn_out_gpu1 -->
<g id="node375" class="node">
<title>layer2_attn_out_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="11176.77,-6260.33 10649.77,-6260.33 10649.77,-6192.33 11176.77,-6192.33 11176.77,-6260.33"/>
<text text-anchor="middle" x="10913.27" y="-6245.13" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="10913.27" y="-6230.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="10913.27" y="-6215.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10913.27" y="-6200.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_gather_v_gpu1&#45;&gt;layer2_attn_out_gpu1 -->
<g id="edge490" class="edge">
<title>layer2_gather_v_gpu1&#45;&gt;layer2_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M10908.27,-6528.25C10908.27,-6528.25 10908.27,-6270.48 10908.27,-6270.48"/>
<polygon fill="black" stroke="black" points="10911.77,-6270.48 10908.27,-6260.48 10904.77,-6270.48 10911.77,-6270.48"/>
</g>
<!-- layer2_softmax_gpu1 -->
<g id="node374" class="node">
<title>layer2_softmax_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="11705.77,-6428.41 11166.77,-6428.41 11166.77,-6360.41 11705.77,-6360.41 11705.77,-6428.41"/>
<text text-anchor="middle" x="11436.27" y="-6413.21" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="11436.27" y="-6398.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="11436.27" y="-6383.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="11436.27" y="-6368.21" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_attn_scores_gpu1&#45;&gt;layer2_softmax_gpu1 -->
<g id="edge488" class="edge">
<title>layer2_attn_scores_gpu1&#45;&gt;layer2_softmax_gpu1</title>
<path fill="none" stroke="black" d="M11518.77,-6542.32C11518.77,-6542.32 11518.77,-6438.53 11518.77,-6438.53"/>
<polygon fill="black" stroke="black" points="11522.27,-6438.53 11518.77,-6428.53 11515.27,-6438.53 11522.27,-6438.53"/>
</g>
<!-- layer2_softmax_gpu1&#45;&gt;layer2_attn_out_gpu1 -->
<g id="edge489" class="edge">
<title>layer2_softmax_gpu1&#45;&gt;layer2_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M11171.77,-6360.4C11171.77,-6360.4 11171.77,-6270.58 11171.77,-6270.58"/>
<polygon fill="black" stroke="black" points="11175.27,-6270.58 11171.77,-6260.58 11168.27,-6270.58 11175.27,-6270.58"/>
</g>
<!-- layer2_out_proj_gpu1 -->
<g id="node376" class="node">
<title>layer2_out_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="10569.77,-6106.33 10080.77,-6106.33 10080.77,-6038.33 10569.77,-6038.33 10569.77,-6106.33"/>
<text text-anchor="middle" x="10325.27" y="-6091.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10325.27" y="-6076.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10325.27" y="-6061.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="10325.27" y="-6046.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_attn_out_gpu1&#45;&gt;layer2_out_proj_gpu1 -->
<g id="edge491" class="edge">
<title>layer2_attn_out_gpu1&#45;&gt;layer2_out_proj_gpu1</title>
<path fill="none" stroke="black" d="M10649.59,-6214C10598.88,-6214 10561.2,-6214 10561.2,-6214 10561.2,-6214 10561.2,-6116.63 10561.2,-6116.63"/>
<polygon fill="black" stroke="black" points="10564.7,-6116.63 10561.2,-6106.63 10557.7,-6116.63 10564.7,-6116.63"/>
</g>
<!-- layer2_out_proj_gpu1&#45;&gt;layer2_attn_all_reduce -->
<g id="edge571" class="edge">
<title>layer2_out_proj_gpu1&#45;&gt;layer2_attn_all_reduce</title>
<path fill="none" stroke="black" d="M10325.27,-6038.27C10325.27,-5989.08 10325.27,-5904 10325.27,-5904 10325.27,-5904 6644.9,-5904 6644.9,-5904"/>
<polygon fill="black" stroke="black" points="6644.9,-5900.5 6634.9,-5904 6644.9,-5907.5 6644.9,-5900.5"/>
</g>
<!-- layer2_q_proj_gpu2 -->
<g id="node378" class="node">
<title>layer2_q_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="14160.77,-6960.83 13659.77,-6960.83 13659.77,-6892.83 14160.77,-6892.83 14160.77,-6960.83"/>
<text text-anchor="middle" x="13910.27" y="-6945.63" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="13910.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13910.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13910.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_attn_norm_gpu2&#45;&gt;layer2_q_proj_gpu2 -->
<g id="edge493" class="edge">
<title>layer2_attn_norm_gpu2&#45;&gt;layer2_q_proj_gpu2</title>
<path fill="none" stroke="black" d="M13236.86,-7080C13509.94,-7080 13910.27,-7080 13910.27,-7080 13910.27,-7080 13910.27,-6971.21 13910.27,-6971.21"/>
<polygon fill="black" stroke="black" points="13913.77,-6971.2 13910.27,-6961.21 13906.77,-6971.21 13913.77,-6971.2"/>
</g>
<!-- layer2_k_proj_gpu2 -->
<g id="node379" class="node">
<title>layer2_k_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="13518.77,-6960.83 13017.77,-6960.83 13017.77,-6892.83 13518.77,-6892.83 13518.77,-6960.83"/>
<text text-anchor="middle" x="13268.27" y="-6945.63" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="13268.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13268.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13268.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_attn_norm_gpu2&#45;&gt;layer2_k_proj_gpu2 -->
<g id="edge494" class="edge">
<title>layer2_attn_norm_gpu2&#45;&gt;layer2_k_proj_gpu2</title>
<path fill="none" stroke="black" d="M13127.27,-7046.65C13127.27,-7046.65 13127.27,-6970.91 13127.27,-6970.91"/>
<polygon fill="black" stroke="black" points="13130.77,-6970.91 13127.27,-6960.91 13123.77,-6970.91 13130.77,-6970.91"/>
</g>
<!-- layer2_v_proj_gpu2 -->
<g id="node380" class="node">
<title>layer2_v_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12959.77,-6960.83 12458.77,-6960.83 12458.77,-6892.83 12959.77,-6892.83 12959.77,-6960.83"/>
<text text-anchor="middle" x="12709.27" y="-6945.63" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="12709.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12709.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12709.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_attn_norm_gpu2&#45;&gt;layer2_v_proj_gpu2 -->
<g id="edge495" class="edge">
<title>layer2_attn_norm_gpu2&#45;&gt;layer2_v_proj_gpu2</title>
<path fill="none" stroke="black" d="M12849.77,-7046.65C12849.77,-7046.65 12849.77,-6970.91 12849.77,-6970.91"/>
<polygon fill="black" stroke="black" points="12853.27,-6970.91 12849.77,-6960.91 12846.27,-6970.91 12853.27,-6970.91"/>
</g>
<!-- layer2_gather_q_gpu2 -->
<g id="node381" class="node">
<title>layer2_gather_q_gpu2</title>
<ellipse fill="lightblue" stroke="black" cx="13992.27" cy="-6758.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="13992.27" y="-6777.55" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="13992.27" y="-6762.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13992.27" y="-6747.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13992.27" y="-6732.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_q_proj_gpu2&#45;&gt;layer2_gather_q_gpu2 -->
<g id="edge496" class="edge">
<title>layer2_q_proj_gpu2&#45;&gt;layer2_gather_q_gpu2</title>
<path fill="none" stroke="black" d="M13910.27,-6892.82C13910.27,-6892.82 13910.27,-6815.77 13910.27,-6815.77"/>
<polygon fill="black" stroke="black" points="13913.77,-6815.77 13910.27,-6805.77 13906.77,-6815.77 13913.77,-6815.77"/>
</g>
<!-- layer2_gather_k_gpu2 -->
<g id="node382" class="node">
<title>layer2_gather_k_gpu2</title>
<ellipse fill="lightblue" stroke="black" cx="13213.27" cy="-6758.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="13213.27" y="-6777.55" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="13213.27" y="-6762.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13213.27" y="-6747.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13213.27" y="-6732.55" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_k_proj_gpu2&#45;&gt;layer2_gather_k_gpu2 -->
<g id="edge497" class="edge">
<title>layer2_k_proj_gpu2&#45;&gt;layer2_gather_k_gpu2</title>
<path fill="none" stroke="black" d="M13268.27,-6892.82C13268.27,-6892.82 13268.27,-6816.4 13268.27,-6816.4"/>
<polygon fill="black" stroke="black" points="13271.77,-6816.4 13268.27,-6806.4 13264.77,-6816.4 13271.77,-6816.4"/>
</g>
<!-- layer2_gather_v_gpu2 -->
<g id="node383" class="node">
<title>layer2_gather_v_gpu2</title>
<ellipse fill="lightblue" stroke="black" cx="12617.27" cy="-6394.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="12617.27" y="-6413.21" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="12617.27" y="-6398.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12617.27" y="-6383.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12617.27" y="-6368.21" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_v_proj_gpu2&#45;&gt;layer2_gather_v_gpu2 -->
<g id="edge498" class="edge">
<title>layer2_v_proj_gpu2&#45;&gt;layer2_gather_v_gpu2</title>
<path fill="none" stroke="black" d="M12736.77,-6892.72C12736.77,-6892.72 12736.77,-6449.98 12736.77,-6449.98"/>
<polygon fill="black" stroke="black" points="12740.27,-6449.98 12736.77,-6439.98 12733.27,-6449.98 12740.27,-6449.98"/>
</g>
<!-- layer2_attn_scores_gpu2 -->
<g id="node384" class="node">
<title>layer2_attn_scores_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="13574.77,-6610.58 13035.77,-6610.58 13035.77,-6542.58 13574.77,-6542.58 13574.77,-6610.58"/>
<text text-anchor="middle" x="13305.27" y="-6595.38" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="13305.27" y="-6580.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13305.27" y="-6565.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="13305.27" y="-6550.38" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gather_q_gpu2&#45;&gt;layer2_attn_scores_gpu2 -->
<g id="edge499" class="edge">
<title>layer2_gather_q_gpu2&#45;&gt;layer2_attn_scores_gpu2</title>
<path fill="none" stroke="black" d="M13792.87,-6718.64C13792.87,-6664.85 13792.87,-6576 13792.87,-6576 13792.87,-6576 13585.09,-6576 13585.09,-6576"/>
<polygon fill="black" stroke="black" points="13585.09,-6572.5 13575.09,-6576 13585.09,-6579.5 13585.09,-6572.5"/>
</g>
<!-- layer2_gather_k_gpu2&#45;&gt;layer2_attn_scores_gpu2 -->
<g id="edge500" class="edge">
<title>layer2_gather_k_gpu2&#45;&gt;layer2_attn_scores_gpu2</title>
<path fill="none" stroke="black" d="M13304.83,-6711.84C13304.83,-6711.84 13304.83,-6620.68 13304.83,-6620.68"/>
<polygon fill="black" stroke="black" points="13308.33,-6620.68 13304.83,-6610.68 13301.33,-6620.68 13308.33,-6620.68"/>
</g>
<!-- layer2_attn_out_gpu2 -->
<g id="node386" class="node">
<title>layer2_attn_out_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="12880.77,-6260.33 12353.77,-6260.33 12353.77,-6192.33 12880.77,-6192.33 12880.77,-6260.33"/>
<text text-anchor="middle" x="12617.27" y="-6245.13" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="12617.27" y="-6230.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="12617.27" y="-6215.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12617.27" y="-6200.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_gather_v_gpu2&#45;&gt;layer2_attn_out_gpu2 -->
<g id="edge503" class="edge">
<title>layer2_gather_v_gpu2&#45;&gt;layer2_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M12617.27,-6346.25C12617.27,-6346.25 12617.27,-6270.36 12617.27,-6270.36"/>
<polygon fill="black" stroke="black" points="12620.77,-6270.36 12617.27,-6260.36 12613.77,-6270.36 12620.77,-6270.36"/>
</g>
<!-- layer2_softmax_gpu2 -->
<g id="node385" class="node">
<title>layer2_softmax_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="13574.77,-6428.41 13035.77,-6428.41 13035.77,-6360.41 13574.77,-6360.41 13574.77,-6428.41"/>
<text text-anchor="middle" x="13305.27" y="-6413.21" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="13305.27" y="-6398.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="13305.27" y="-6383.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="13305.27" y="-6368.21" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_attn_scores_gpu2&#45;&gt;layer2_softmax_gpu2 -->
<g id="edge501" class="edge">
<title>layer2_attn_scores_gpu2&#45;&gt;layer2_softmax_gpu2</title>
<path fill="none" stroke="black" d="M13305.27,-6542.32C13305.27,-6542.32 13305.27,-6438.53 13305.27,-6438.53"/>
<polygon fill="black" stroke="black" points="13308.77,-6438.53 13305.27,-6428.53 13301.77,-6438.53 13308.77,-6438.53"/>
</g>
<!-- layer2_softmax_gpu2&#45;&gt;layer2_attn_out_gpu2 -->
<g id="edge502" class="edge">
<title>layer2_softmax_gpu2&#45;&gt;layer2_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M13305.27,-6360.33C13305.27,-6311.12 13305.27,-6226 13305.27,-6226 13305.27,-6226 12890.81,-6226 12890.81,-6226"/>
<polygon fill="black" stroke="black" points="12890.81,-6222.5 12880.81,-6226 12890.81,-6229.5 12890.81,-6222.5"/>
</g>
<!-- layer2_out_proj_gpu2 -->
<g id="node387" class="node">
<title>layer2_out_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12056.77,-6106.33 11567.77,-6106.33 11567.77,-6038.33 12056.77,-6038.33 12056.77,-6106.33"/>
<text text-anchor="middle" x="11812.27" y="-6091.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11812.27" y="-6076.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11812.27" y="-6061.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="11812.27" y="-6046.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_attn_out_gpu2&#45;&gt;layer2_out_proj_gpu2 -->
<g id="edge504" class="edge">
<title>layer2_attn_out_gpu2&#45;&gt;layer2_out_proj_gpu2</title>
<path fill="none" stroke="black" d="M12353.65,-6226C12177.61,-6226 11978.2,-6226 11978.2,-6226 11978.2,-6226 11978.2,-6116.44 11978.2,-6116.44"/>
<polygon fill="black" stroke="black" points="11981.7,-6116.44 11978.2,-6106.44 11974.7,-6116.44 11981.7,-6116.44"/>
</g>
<!-- layer2_out_proj_gpu2&#45;&gt;layer2_attn_all_reduce -->
<g id="edge572" class="edge">
<title>layer2_out_proj_gpu2&#45;&gt;layer2_attn_all_reduce</title>
<path fill="none" stroke="black" d="M11658.27,-6037.95C11658.27,-5982.63 11658.27,-5880 11658.27,-5880 11658.27,-5880 6597.16,-5880 6597.16,-5880"/>
<polygon fill="black" stroke="black" points="6597.16,-5876.5 6587.16,-5880 6597.16,-5883.5 6597.16,-5876.5"/>
</g>
<!-- layer2_q_proj_gpu3 -->
<g id="node389" class="node">
<title>layer2_q_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1779.77,-6960.83 1278.77,-6960.83 1278.77,-6892.83 1779.77,-6892.83 1779.77,-6960.83"/>
<text text-anchor="middle" x="1529.27" y="-6945.63" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="1529.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1529.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1529.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_attn_norm_gpu3&#45;&gt;layer2_q_proj_gpu3 -->
<g id="edge506" class="edge">
<title>layer2_attn_norm_gpu3&#45;&gt;layer2_q_proj_gpu3</title>
<path fill="none" stroke="black" d="M1669.77,-7046.65C1669.77,-7046.65 1669.77,-6970.91 1669.77,-6970.91"/>
<polygon fill="black" stroke="black" points="1673.27,-6970.91 1669.77,-6960.91 1666.27,-6970.91 1673.27,-6970.91"/>
</g>
<!-- layer2_k_proj_gpu3 -->
<g id="node390" class="node">
<title>layer2_k_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="2338.77,-6960.83 1837.77,-6960.83 1837.77,-6892.83 2338.77,-6892.83 2338.77,-6960.83"/>
<text text-anchor="middle" x="2088.27" y="-6945.63" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="2088.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2088.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2088.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_attn_norm_gpu3&#45;&gt;layer2_k_proj_gpu3 -->
<g id="edge507" class="edge">
<title>layer2_attn_norm_gpu3&#45;&gt;layer2_k_proj_gpu3</title>
<path fill="none" stroke="black" d="M1947.27,-7046.65C1947.27,-7046.65 1947.27,-6970.91 1947.27,-6970.91"/>
<polygon fill="black" stroke="black" points="1950.77,-6970.91 1947.27,-6960.91 1943.77,-6970.91 1950.77,-6970.91"/>
</g>
<!-- layer2_v_proj_gpu3 -->
<g id="node391" class="node">
<title>layer2_v_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1220.77,-6960.83 719.77,-6960.83 719.77,-6892.83 1220.77,-6892.83 1220.77,-6960.83"/>
<text text-anchor="middle" x="970.27" y="-6945.63" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="970.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="970.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="970.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_attn_norm_gpu3&#45;&gt;layer2_v_proj_gpu3 -->
<g id="edge508" class="edge">
<title>layer2_attn_norm_gpu3&#45;&gt;layer2_v_proj_gpu3</title>
<path fill="none" stroke="black" d="M1559.67,-7080C1312.61,-7080 970.27,-7080 970.27,-7080 970.27,-7080 970.27,-6971.21 970.27,-6971.21"/>
<polygon fill="black" stroke="black" points="973.77,-6971.2 970.27,-6961.21 966.77,-6971.21 973.77,-6971.2"/>
</g>
<!-- layer2_gather_q_gpu3 -->
<g id="node392" class="node">
<title>layer2_gather_q_gpu3</title>
<ellipse fill="lightblue" stroke="black" cx="1419.27" cy="-6758.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="1419.27" y="-6777.55" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="1419.27" y="-6762.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1419.27" y="-6747.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1419.27" y="-6732.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_q_proj_gpu3&#45;&gt;layer2_gather_q_gpu3 -->
<g id="edge509" class="edge">
<title>layer2_q_proj_gpu3&#45;&gt;layer2_gather_q_gpu3</title>
<path fill="none" stroke="black" d="M1529.27,-6892.82C1529.27,-6892.82 1529.27,-6814.82 1529.27,-6814.82"/>
<polygon fill="black" stroke="black" points="1532.77,-6814.82 1529.27,-6804.82 1525.77,-6814.82 1532.77,-6814.82"/>
</g>
<!-- layer2_gather_k_gpu3 -->
<g id="node393" class="node">
<title>layer2_gather_k_gpu3</title>
<ellipse fill="lightblue" stroke="black" cx="2198.27" cy="-6758.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="2198.27" y="-6777.55" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="2198.27" y="-6762.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2198.27" y="-6747.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2198.27" y="-6732.55" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_k_proj_gpu3&#45;&gt;layer2_gather_k_gpu3 -->
<g id="edge510" class="edge">
<title>layer2_k_proj_gpu3&#45;&gt;layer2_gather_k_gpu3</title>
<path fill="none" stroke="black" d="M2088.27,-6892.82C2088.27,-6892.82 2088.27,-6814.82 2088.27,-6814.82"/>
<polygon fill="black" stroke="black" points="2091.77,-6814.82 2088.27,-6804.82 2084.77,-6814.82 2091.77,-6814.82"/>
</g>
<!-- layer2_gather_v_gpu3 -->
<g id="node394" class="node">
<title>layer2_gather_v_gpu3</title>
<ellipse fill="lightblue" stroke="black" cx="1295.27" cy="-6576.58" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="1295.27" y="-6595.38" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="1295.27" y="-6580.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1295.27" y="-6565.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1295.27" y="-6550.38" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_v_proj_gpu3&#45;&gt;layer2_gather_v_gpu3 -->
<g id="edge511" class="edge">
<title>layer2_v_proj_gpu3&#45;&gt;layer2_gather_v_gpu3</title>
<path fill="none" stroke="black" d="M996.64,-6892.61C996.64,-6892.61 996.64,-6613.55 996.64,-6613.55"/>
<polygon fill="black" stroke="black" points="1000.14,-6613.55 996.64,-6603.55 993.14,-6613.55 1000.14,-6613.55"/>
</g>
<!-- layer2_attn_scores_gpu3 -->
<g id="node395" class="node">
<title>layer2_attn_scores_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="2359.77,-6610.58 1820.77,-6610.58 1820.77,-6542.58 2359.77,-6542.58 2359.77,-6610.58"/>
<text text-anchor="middle" x="2090.27" y="-6595.38" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="2090.27" y="-6580.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2090.27" y="-6565.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="2090.27" y="-6550.38" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gather_q_gpu3&#45;&gt;layer2_attn_scores_gpu3 -->
<g id="edge512" class="edge">
<title>layer2_gather_q_gpu3&#45;&gt;layer2_attn_scores_gpu3</title>
<path fill="none" stroke="black" d="M1780.16,-6758C1810.11,-6758 1829.2,-6758 1829.2,-6758 1829.2,-6758 1829.2,-6620.7 1829.2,-6620.7"/>
<polygon fill="black" stroke="black" points="1832.7,-6620.7 1829.2,-6610.7 1825.7,-6620.7 1832.7,-6620.7"/>
</g>
<!-- layer2_gather_k_gpu3&#45;&gt;layer2_attn_scores_gpu3 -->
<g id="edge513" class="edge">
<title>layer2_gather_k_gpu3&#45;&gt;layer2_attn_scores_gpu3</title>
<path fill="none" stroke="black" d="M2098.7,-6712.31C2098.7,-6712.31 2098.7,-6620.86 2098.7,-6620.86"/>
<polygon fill="black" stroke="black" points="2102.2,-6620.86 2098.7,-6610.86 2095.2,-6620.86 2102.2,-6620.86"/>
</g>
<!-- layer2_attn_out_gpu3 -->
<g id="node397" class="node">
<title>layer2_attn_out_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="2353.77,-6260.33 1826.77,-6260.33 1826.77,-6192.33 2353.77,-6192.33 2353.77,-6260.33"/>
<text text-anchor="middle" x="2090.27" y="-6245.13" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="2090.27" y="-6230.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="2090.27" y="-6215.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2090.27" y="-6200.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_gather_v_gpu3&#45;&gt;layer2_attn_out_gpu3 -->
<g id="edge516" class="edge">
<title>layer2_gather_v_gpu3&#45;&gt;layer2_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M1512.83,-6538.06C1512.83,-6446.99 1512.83,-6226 1512.83,-6226 1512.83,-6226 1816.47,-6226 1816.47,-6226"/>
<polygon fill="black" stroke="black" points="1816.47,-6229.5 1826.47,-6226 1816.47,-6222.5 1816.47,-6229.5"/>
</g>
<!-- layer2_softmax_gpu3 -->
<g id="node396" class="node">
<title>layer2_softmax_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="2359.77,-6428.41 1820.77,-6428.41 1820.77,-6360.41 2359.77,-6360.41 2359.77,-6428.41"/>
<text text-anchor="middle" x="2090.27" y="-6413.21" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="2090.27" y="-6398.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="2090.27" y="-6383.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="2090.27" y="-6368.21" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_attn_scores_gpu3&#45;&gt;layer2_softmax_gpu3 -->
<g id="edge514" class="edge">
<title>layer2_attn_scores_gpu3&#45;&gt;layer2_softmax_gpu3</title>
<path fill="none" stroke="black" d="M2090.27,-6542.32C2090.27,-6542.32 2090.27,-6438.53 2090.27,-6438.53"/>
<polygon fill="black" stroke="black" points="2093.77,-6438.53 2090.27,-6428.53 2086.77,-6438.53 2093.77,-6438.53"/>
</g>
<!-- layer2_softmax_gpu3&#45;&gt;layer2_attn_out_gpu3 -->
<g id="edge515" class="edge">
<title>layer2_softmax_gpu3&#45;&gt;layer2_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M2090.27,-6360.4C2090.27,-6360.4 2090.27,-6270.58 2090.27,-6270.58"/>
<polygon fill="black" stroke="black" points="2093.77,-6270.58 2090.27,-6260.58 2086.77,-6270.58 2093.77,-6270.58"/>
</g>
<!-- layer2_out_proj_gpu3 -->
<g id="node398" class="node">
<title>layer2_out_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="2953.77,-6106.33 2464.77,-6106.33 2464.77,-6038.33 2953.77,-6038.33 2953.77,-6106.33"/>
<text text-anchor="middle" x="2709.27" y="-6091.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2709.27" y="-6076.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2709.27" y="-6061.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="2709.27" y="-6046.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_attn_out_gpu3&#45;&gt;layer2_out_proj_gpu3 -->
<g id="edge517" class="edge">
<title>layer2_attn_out_gpu3&#45;&gt;layer2_out_proj_gpu3</title>
<path fill="none" stroke="black" d="M2353.85,-6214C2438.45,-6214 2510.7,-6214 2510.7,-6214 2510.7,-6214 2510.7,-6116.63 2510.7,-6116.63"/>
<polygon fill="black" stroke="black" points="2514.2,-6116.63 2510.7,-6106.63 2507.2,-6116.63 2514.2,-6116.63"/>
</g>
<!-- layer2_out_proj_gpu3&#45;&gt;layer2_attn_all_reduce -->
<g id="edge573" class="edge">
<title>layer2_out_proj_gpu3&#45;&gt;layer2_attn_all_reduce</title>
<path fill="none" stroke="black" d="M2811.87,-6038.27C2811.87,-5989.08 2811.87,-5904 2811.87,-5904 2811.87,-5904 5921.71,-5904 5921.71,-5904"/>
<polygon fill="black" stroke="black" points="5921.71,-5907.5 5931.71,-5904 5921.71,-5900.5 5921.71,-5907.5"/>
</g>
<!-- layer2_q_proj_gpu4 -->
<g id="node400" class="node">
<title>layer2_q_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="3456.77,-6960.83 2955.77,-6960.83 2955.77,-6892.83 3456.77,-6892.83 3456.77,-6960.83"/>
<text text-anchor="middle" x="3206.27" y="-6945.63" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="3206.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3206.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3206.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_attn_norm_gpu4&#45;&gt;layer2_q_proj_gpu4 -->
<g id="edge519" class="edge">
<title>layer2_attn_norm_gpu4&#45;&gt;layer2_q_proj_gpu4</title>
<path fill="none" stroke="black" d="M3346.77,-7046.65C3346.77,-7046.65 3346.77,-6970.91 3346.77,-6970.91"/>
<polygon fill="black" stroke="black" points="3350.27,-6970.91 3346.77,-6960.91 3343.27,-6970.91 3350.27,-6970.91"/>
</g>
<!-- layer2_k_proj_gpu4 -->
<g id="node401" class="node">
<title>layer2_k_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="4015.77,-6960.83 3514.77,-6960.83 3514.77,-6892.83 4015.77,-6892.83 4015.77,-6960.83"/>
<text text-anchor="middle" x="3765.27" y="-6945.63" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="3765.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3765.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3765.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_attn_norm_gpu4&#45;&gt;layer2_k_proj_gpu4 -->
<g id="edge520" class="edge">
<title>layer2_attn_norm_gpu4&#45;&gt;layer2_k_proj_gpu4</title>
<path fill="none" stroke="black" d="M3624.27,-7046.65C3624.27,-7046.65 3624.27,-6970.91 3624.27,-6970.91"/>
<polygon fill="black" stroke="black" points="3627.77,-6970.91 3624.27,-6960.91 3620.77,-6970.91 3627.77,-6970.91"/>
</g>
<!-- layer2_v_proj_gpu4 -->
<g id="node402" class="node">
<title>layer2_v_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="2897.77,-6960.83 2396.77,-6960.83 2396.77,-6892.83 2897.77,-6892.83 2897.77,-6960.83"/>
<text text-anchor="middle" x="2647.27" y="-6945.63" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="2647.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2647.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2647.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_attn_norm_gpu4&#45;&gt;layer2_v_proj_gpu4 -->
<g id="edge521" class="edge">
<title>layer2_attn_norm_gpu4&#45;&gt;layer2_v_proj_gpu4</title>
<path fill="none" stroke="black" d="M3236.69,-7080C3012.05,-7080 2716.38,-7080 2716.38,-7080 2716.38,-7080 2716.38,-6971.21 2716.38,-6971.21"/>
<polygon fill="black" stroke="black" points="2719.88,-6971.2 2716.38,-6961.21 2712.88,-6971.21 2719.88,-6971.2"/>
</g>
<!-- layer2_gather_q_gpu4 -->
<g id="node403" class="node">
<title>layer2_gather_q_gpu4</title>
<ellipse fill="lightblue" stroke="black" cx="3096.27" cy="-6758.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="3096.27" y="-6777.55" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="3096.27" y="-6762.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3096.27" y="-6747.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3096.27" y="-6732.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_q_proj_gpu4&#45;&gt;layer2_gather_q_gpu4 -->
<g id="edge522" class="edge">
<title>layer2_q_proj_gpu4&#45;&gt;layer2_gather_q_gpu4</title>
<path fill="none" stroke="black" d="M3206.27,-6892.82C3206.27,-6892.82 3206.27,-6814.82 3206.27,-6814.82"/>
<polygon fill="black" stroke="black" points="3209.77,-6814.82 3206.27,-6804.82 3202.77,-6814.82 3209.77,-6814.82"/>
</g>
<!-- layer2_gather_k_gpu4 -->
<g id="node404" class="node">
<title>layer2_gather_k_gpu4</title>
<ellipse fill="lightblue" stroke="black" cx="3875.27" cy="-6758.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="3875.27" y="-6777.55" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="3875.27" y="-6762.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3875.27" y="-6747.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3875.27" y="-6732.55" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_k_proj_gpu4&#45;&gt;layer2_gather_k_gpu4 -->
<g id="edge523" class="edge">
<title>layer2_k_proj_gpu4&#45;&gt;layer2_gather_k_gpu4</title>
<path fill="none" stroke="black" d="M3765.27,-6892.82C3765.27,-6892.82 3765.27,-6814.82 3765.27,-6814.82"/>
<polygon fill="black" stroke="black" points="3768.77,-6814.82 3765.27,-6804.82 3761.77,-6814.82 3768.77,-6814.82"/>
</g>
<!-- layer2_gather_v_gpu4 -->
<g id="node405" class="node">
<title>layer2_gather_v_gpu4</title>
<ellipse fill="lightblue" stroke="black" cx="2917.27" cy="-6394.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="2917.27" y="-6413.21" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="2917.27" y="-6398.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2917.27" y="-6383.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2917.27" y="-6368.21" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_v_proj_gpu4&#45;&gt;layer2_gather_v_gpu4 -->
<g id="edge524" class="edge">
<title>layer2_v_proj_gpu4&#45;&gt;layer2_gather_v_gpu4</title>
<path fill="none" stroke="black" d="M2647.27,-6892.72C2647.27,-6892.72 2647.27,-6436.55 2647.27,-6436.55"/>
<polygon fill="black" stroke="black" points="2650.77,-6436.55 2647.27,-6426.55 2643.77,-6436.55 2650.77,-6436.55"/>
</g>
<!-- layer2_attn_scores_gpu4 -->
<g id="node406" class="node">
<title>layer2_attn_scores_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="4009.77,-6610.58 3470.77,-6610.58 3470.77,-6542.58 4009.77,-6542.58 4009.77,-6610.58"/>
<text text-anchor="middle" x="3740.27" y="-6595.38" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="3740.27" y="-6580.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3740.27" y="-6565.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="3740.27" y="-6550.38" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gather_q_gpu4&#45;&gt;layer2_attn_scores_gpu4 -->
<g id="edge525" class="edge">
<title>layer2_gather_q_gpu4&#45;&gt;layer2_attn_scores_gpu4</title>
<path fill="none" stroke="black" d="M3457.17,-6758C3479.2,-6758 3492.7,-6758 3492.7,-6758 3492.7,-6758 3492.7,-6620.7 3492.7,-6620.7"/>
<polygon fill="black" stroke="black" points="3496.2,-6620.7 3492.7,-6610.7 3489.2,-6620.7 3496.2,-6620.7"/>
</g>
<!-- layer2_gather_k_gpu4&#45;&gt;layer2_attn_scores_gpu4 -->
<g id="edge526" class="edge">
<title>layer2_gather_k_gpu4&#45;&gt;layer2_attn_scores_gpu4</title>
<path fill="none" stroke="black" d="M3762.2,-6712.78C3762.2,-6712.78 3762.2,-6620.74 3762.2,-6620.74"/>
<polygon fill="black" stroke="black" points="3765.7,-6620.74 3762.2,-6610.74 3758.7,-6620.75 3765.7,-6620.74"/>
</g>
<!-- layer2_attn_out_gpu4 -->
<g id="node408" class="node">
<title>layer2_attn_out_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="4003.77,-6260.33 3476.77,-6260.33 3476.77,-6192.33 4003.77,-6192.33 4003.77,-6260.33"/>
<text text-anchor="middle" x="3740.27" y="-6245.13" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="3740.27" y="-6230.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="3740.27" y="-6215.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3740.27" y="-6200.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_gather_v_gpu4&#45;&gt;layer2_attn_out_gpu4 -->
<g id="edge529" class="edge">
<title>layer2_gather_v_gpu4&#45;&gt;layer2_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M3115.83,-6353.88C3115.83,-6307.24 3115.83,-6237 3115.83,-6237 3115.83,-6237 3466.35,-6237 3466.35,-6237"/>
<polygon fill="black" stroke="black" points="3466.35,-6240.5 3476.35,-6237 3466.35,-6233.5 3466.35,-6240.5"/>
</g>
<!-- layer2_softmax_gpu4 -->
<g id="node407" class="node">
<title>layer2_softmax_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="4009.77,-6428.41 3470.77,-6428.41 3470.77,-6360.41 4009.77,-6360.41 4009.77,-6428.41"/>
<text text-anchor="middle" x="3740.27" y="-6413.21" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="3740.27" y="-6398.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="3740.27" y="-6383.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="3740.27" y="-6368.21" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_attn_scores_gpu4&#45;&gt;layer2_softmax_gpu4 -->
<g id="edge527" class="edge">
<title>layer2_attn_scores_gpu4&#45;&gt;layer2_softmax_gpu4</title>
<path fill="none" stroke="black" d="M3740.27,-6542.32C3740.27,-6542.32 3740.27,-6438.53 3740.27,-6438.53"/>
<polygon fill="black" stroke="black" points="3743.77,-6438.53 3740.27,-6428.53 3736.77,-6438.53 3743.77,-6438.53"/>
</g>
<!-- layer2_softmax_gpu4&#45;&gt;layer2_attn_out_gpu4 -->
<g id="edge528" class="edge">
<title>layer2_softmax_gpu4&#45;&gt;layer2_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M3740.27,-6360.4C3740.27,-6360.4 3740.27,-6270.58 3740.27,-6270.58"/>
<polygon fill="black" stroke="black" points="3743.77,-6270.58 3740.27,-6260.58 3736.77,-6270.58 3743.77,-6270.58"/>
</g>
<!-- layer2_out_proj_gpu4 -->
<g id="node409" class="node">
<title>layer2_out_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="4465.77,-6106.33 3976.77,-6106.33 3976.77,-6038.33 4465.77,-6038.33 4465.77,-6106.33"/>
<text text-anchor="middle" x="4221.27" y="-6091.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4221.27" y="-6076.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4221.27" y="-6061.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="4221.27" y="-6046.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_attn_out_gpu4&#45;&gt;layer2_out_proj_gpu4 -->
<g id="edge530" class="edge">
<title>layer2_attn_out_gpu4&#45;&gt;layer2_out_proj_gpu4</title>
<path fill="none" stroke="black" d="M3990.27,-6192.15C3990.27,-6192.15 3990.27,-6116.41 3990.27,-6116.41"/>
<polygon fill="black" stroke="black" points="3993.77,-6116.41 3990.27,-6106.41 3986.77,-6116.41 3993.77,-6116.41"/>
</g>
<!-- layer2_out_proj_gpu4&#45;&gt;layer2_attn_all_reduce -->
<g id="edge574" class="edge">
<title>layer2_out_proj_gpu4&#45;&gt;layer2_attn_all_reduce</title>
<path fill="none" stroke="black" d="M4451.1,-6038.13C4451.1,-5995.45 4451.1,-5928 4451.1,-5928 4451.1,-5928 5967.63,-5928 5967.63,-5928"/>
<polygon fill="black" stroke="black" points="5967.64,-5931.5 5977.63,-5928 5967.63,-5924.5 5967.64,-5931.5"/>
</g>
<!-- layer2_q_proj_gpu5 -->
<g id="node411" class="node">
<title>layer2_q_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="5133.77,-6960.83 4632.77,-6960.83 4632.77,-6892.83 5133.77,-6892.83 5133.77,-6960.83"/>
<text text-anchor="middle" x="4883.27" y="-6945.63" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4883.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4883.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4883.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_attn_norm_gpu5&#45;&gt;layer2_q_proj_gpu5 -->
<g id="edge532" class="edge">
<title>layer2_attn_norm_gpu5&#45;&gt;layer2_q_proj_gpu5</title>
<path fill="none" stroke="black" d="M5024.27,-7046.65C5024.27,-7046.65 5024.27,-6970.91 5024.27,-6970.91"/>
<polygon fill="black" stroke="black" points="5027.77,-6970.91 5024.27,-6960.91 5020.77,-6970.91 5027.77,-6970.91"/>
</g>
<!-- layer2_k_proj_gpu5 -->
<g id="node412" class="node">
<title>layer2_k_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="5692.77,-6960.83 5191.77,-6960.83 5191.77,-6892.83 5692.77,-6892.83 5692.77,-6960.83"/>
<text text-anchor="middle" x="5442.27" y="-6945.63" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5442.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5442.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5442.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_attn_norm_gpu5&#45;&gt;layer2_k_proj_gpu5 -->
<g id="edge533" class="edge">
<title>layer2_attn_norm_gpu5&#45;&gt;layer2_k_proj_gpu5</title>
<path fill="none" stroke="black" d="M5301.77,-7046.65C5301.77,-7046.65 5301.77,-6970.91 5301.77,-6970.91"/>
<polygon fill="black" stroke="black" points="5305.27,-6970.91 5301.77,-6960.91 5298.27,-6970.91 5305.27,-6970.91"/>
</g>
<!-- layer2_v_proj_gpu5 -->
<g id="node413" class="node">
<title>layer2_v_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="4574.77,-6960.83 4073.77,-6960.83 4073.77,-6892.83 4574.77,-6892.83 4574.77,-6960.83"/>
<text text-anchor="middle" x="4324.27" y="-6945.63" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4324.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4324.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4324.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_attn_norm_gpu5&#45;&gt;layer2_v_proj_gpu5 -->
<g id="edge534" class="edge">
<title>layer2_attn_norm_gpu5&#45;&gt;layer2_v_proj_gpu5</title>
<path fill="none" stroke="black" d="M4914.66,-7080C4667.28,-7080 4324.27,-7080 4324.27,-7080 4324.27,-7080 4324.27,-6971.21 4324.27,-6971.21"/>
<polygon fill="black" stroke="black" points="4327.77,-6971.2 4324.27,-6961.21 4320.77,-6971.21 4327.77,-6971.2"/>
</g>
<!-- layer2_gather_q_gpu5 -->
<g id="node414" class="node">
<title>layer2_gather_q_gpu5</title>
<ellipse fill="lightblue" stroke="black" cx="4773.27" cy="-6758.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="4773.27" y="-6777.55" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="4773.27" y="-6762.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4773.27" y="-6747.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4773.27" y="-6732.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_q_proj_gpu5&#45;&gt;layer2_gather_q_gpu5 -->
<g id="edge535" class="edge">
<title>layer2_q_proj_gpu5&#45;&gt;layer2_gather_q_gpu5</title>
<path fill="none" stroke="black" d="M4883.27,-6892.82C4883.27,-6892.82 4883.27,-6814.82 4883.27,-6814.82"/>
<polygon fill="black" stroke="black" points="4886.77,-6814.82 4883.27,-6804.82 4879.77,-6814.82 4886.77,-6814.82"/>
</g>
<!-- layer2_gather_k_gpu5 -->
<g id="node415" class="node">
<title>layer2_gather_k_gpu5</title>
<ellipse fill="lightblue" stroke="black" cx="5552.27" cy="-6758.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="5552.27" y="-6777.55" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="5552.27" y="-6762.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5552.27" y="-6747.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5552.27" y="-6732.55" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_k_proj_gpu5&#45;&gt;layer2_gather_k_gpu5 -->
<g id="edge536" class="edge">
<title>layer2_k_proj_gpu5&#45;&gt;layer2_gather_k_gpu5</title>
<path fill="none" stroke="black" d="M5442.27,-6892.82C5442.27,-6892.82 5442.27,-6814.82 5442.27,-6814.82"/>
<polygon fill="black" stroke="black" points="5445.77,-6814.82 5442.27,-6804.82 5438.77,-6814.82 5445.77,-6814.82"/>
</g>
<!-- layer2_gather_v_gpu5 -->
<g id="node416" class="node">
<title>layer2_gather_v_gpu5</title>
<ellipse fill="lightblue" stroke="black" cx="4579.27" cy="-6576.58" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="4579.27" y="-6595.38" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="4579.27" y="-6580.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4579.27" y="-6565.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4579.27" y="-6550.38" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_v_proj_gpu5&#45;&gt;layer2_gather_v_gpu5 -->
<g id="edge537" class="edge">
<title>layer2_v_proj_gpu5&#45;&gt;layer2_gather_v_gpu5</title>
<path fill="none" stroke="black" d="M4324.27,-6892.61C4324.27,-6892.61 4324.27,-6620.68 4324.27,-6620.68"/>
<polygon fill="black" stroke="black" points="4327.77,-6620.68 4324.27,-6610.68 4320.77,-6620.68 4327.77,-6620.68"/>
</g>
<!-- layer2_attn_scores_gpu5 -->
<g id="node417" class="node">
<title>layer2_attn_scores_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="5567.77,-6610.58 5028.77,-6610.58 5028.77,-6542.58 5567.77,-6542.58 5567.77,-6610.58"/>
<text text-anchor="middle" x="5298.27" y="-6595.38" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="5298.27" y="-6580.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5298.27" y="-6565.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="5298.27" y="-6550.38" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gather_q_gpu5&#45;&gt;layer2_attn_scores_gpu5 -->
<g id="edge538" class="edge">
<title>layer2_gather_q_gpu5&#45;&gt;layer2_attn_scores_gpu5</title>
<path fill="none" stroke="black" d="M5081.33,-6733.42C5081.33,-6733.42 5081.33,-6620.69 5081.33,-6620.69"/>
<polygon fill="black" stroke="black" points="5084.83,-6620.69 5081.33,-6610.69 5077.83,-6620.69 5084.83,-6620.69"/>
</g>
<!-- layer2_gather_k_gpu5&#45;&gt;layer2_attn_scores_gpu5 -->
<g id="edge539" class="edge">
<title>layer2_gather_k_gpu5&#45;&gt;layer2_attn_scores_gpu5</title>
<path fill="none" stroke="black" d="M5379.7,-6716.5C5379.7,-6716.5 5379.7,-6620.68 5379.7,-6620.68"/>
<polygon fill="black" stroke="black" points="5383.2,-6620.68 5379.7,-6610.68 5376.2,-6620.68 5383.2,-6620.68"/>
</g>
<!-- layer2_attn_out_gpu5 -->
<g id="node419" class="node">
<title>layer2_attn_out_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="5561.77,-6260.33 5034.77,-6260.33 5034.77,-6192.33 5561.77,-6192.33 5561.77,-6260.33"/>
<text text-anchor="middle" x="5298.27" y="-6245.13" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="5298.27" y="-6230.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="5298.27" y="-6215.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5298.27" y="-6200.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_gather_v_gpu5&#45;&gt;layer2_attn_out_gpu5 -->
<g id="edge542" class="edge">
<title>layer2_gather_v_gpu5&#45;&gt;layer2_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M4702.83,-6531.11C4702.83,-6436.25 4702.83,-6226 4702.83,-6226 4702.83,-6226 5024.5,-6226 5024.5,-6226"/>
<polygon fill="black" stroke="black" points="5024.5,-6229.5 5034.5,-6226 5024.5,-6222.5 5024.5,-6229.5"/>
</g>
<!-- layer2_softmax_gpu5 -->
<g id="node418" class="node">
<title>layer2_softmax_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="5567.77,-6428.41 5028.77,-6428.41 5028.77,-6360.41 5567.77,-6360.41 5567.77,-6428.41"/>
<text text-anchor="middle" x="5298.27" y="-6413.21" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="5298.27" y="-6398.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="5298.27" y="-6383.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="5298.27" y="-6368.21" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_attn_scores_gpu5&#45;&gt;layer2_softmax_gpu5 -->
<g id="edge540" class="edge">
<title>layer2_attn_scores_gpu5&#45;&gt;layer2_softmax_gpu5</title>
<path fill="none" stroke="black" d="M5298.27,-6542.32C5298.27,-6542.32 5298.27,-6438.53 5298.27,-6438.53"/>
<polygon fill="black" stroke="black" points="5301.77,-6438.53 5298.27,-6428.53 5294.77,-6438.53 5301.77,-6438.53"/>
</g>
<!-- layer2_softmax_gpu5&#45;&gt;layer2_attn_out_gpu5 -->
<g id="edge541" class="edge">
<title>layer2_softmax_gpu5&#45;&gt;layer2_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M5298.27,-6360.4C5298.27,-6360.4 5298.27,-6270.58 5298.27,-6270.58"/>
<polygon fill="black" stroke="black" points="5301.77,-6270.58 5298.27,-6260.58 5294.77,-6270.58 5301.77,-6270.58"/>
</g>
<!-- layer2_out_proj_gpu5 -->
<g id="node420" class="node">
<title>layer2_out_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="5910.77,-6106.33 5421.77,-6106.33 5421.77,-6038.33 5910.77,-6038.33 5910.77,-6106.33"/>
<text text-anchor="middle" x="5666.27" y="-6091.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5666.27" y="-6076.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5666.27" y="-6061.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="5666.27" y="-6046.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_attn_out_gpu5&#45;&gt;layer2_out_proj_gpu5 -->
<g id="edge543" class="edge">
<title>layer2_attn_out_gpu5&#45;&gt;layer2_out_proj_gpu5</title>
<path fill="none" stroke="black" d="M5491.77,-6192.15C5491.77,-6192.15 5491.77,-6116.41 5491.77,-6116.41"/>
<polygon fill="black" stroke="black" points="5495.27,-6116.41 5491.77,-6106.41 5488.27,-6116.41 5495.27,-6116.41"/>
</g>
<!-- layer2_out_proj_gpu5&#45;&gt;layer2_attn_all_reduce -->
<g id="edge575" class="edge">
<title>layer2_out_proj_gpu5&#45;&gt;layer2_attn_all_reduce</title>
<path fill="none" stroke="black" d="M5910.91,-6072C5948.88,-6072 5975.8,-6072 5975.8,-6072 5975.8,-6072 5975.8,-5937.57 5975.8,-5937.57"/>
<polygon fill="black" stroke="black" points="5979.3,-5937.57 5975.8,-5927.57 5972.3,-5937.57 5979.3,-5937.57"/>
</g>
<!-- layer2_q_proj_gpu6 -->
<g id="node422" class="node">
<title>layer2_q_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="6810.77,-6960.83 6309.77,-6960.83 6309.77,-6892.83 6810.77,-6892.83 6810.77,-6960.83"/>
<text text-anchor="middle" x="6560.27" y="-6945.63" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6560.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6560.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6560.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_attn_norm_gpu6&#45;&gt;layer2_q_proj_gpu6 -->
<g id="edge545" class="edge">
<title>layer2_attn_norm_gpu6&#45;&gt;layer2_q_proj_gpu6</title>
<path fill="none" stroke="black" d="M6560.27,-7046.65C6560.27,-7046.65 6560.27,-6970.91 6560.27,-6970.91"/>
<polygon fill="black" stroke="black" points="6563.77,-6970.91 6560.27,-6960.91 6556.77,-6970.91 6563.77,-6970.91"/>
</g>
<!-- layer2_k_proj_gpu6 -->
<g id="node423" class="node">
<title>layer2_k_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="7369.77,-6960.83 6868.77,-6960.83 6868.77,-6892.83 7369.77,-6892.83 7369.77,-6960.83"/>
<text text-anchor="middle" x="7119.27" y="-6945.63" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7119.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7119.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7119.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_attn_norm_gpu6&#45;&gt;layer2_k_proj_gpu6 -->
<g id="edge546" class="edge">
<title>layer2_attn_norm_gpu6&#45;&gt;layer2_k_proj_gpu6</title>
<path fill="none" stroke="black" d="M6809.1,-7080C6924.98,-7080 7037.66,-7080 7037.66,-7080 7037.66,-7080 7037.66,-6971.21 7037.66,-6971.21"/>
<polygon fill="black" stroke="black" points="7041.16,-6971.2 7037.66,-6961.21 7034.16,-6971.21 7041.16,-6971.2"/>
</g>
<!-- layer2_v_proj_gpu6 -->
<g id="node424" class="node">
<title>layer2_v_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="6251.77,-6960.83 5750.77,-6960.83 5750.77,-6892.83 6251.77,-6892.83 6251.77,-6960.83"/>
<text text-anchor="middle" x="6001.27" y="-6945.63" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6001.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6001.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6001.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_attn_norm_gpu6&#45;&gt;layer2_v_proj_gpu6 -->
<g id="edge547" class="edge">
<title>layer2_attn_norm_gpu6&#45;&gt;layer2_v_proj_gpu6</title>
<path fill="none" stroke="black" d="M6311.68,-7069C6233.58,-7069 6167.32,-7069 6167.32,-7069 6167.32,-7069 6167.32,-6970.88 6167.32,-6970.88"/>
<polygon fill="black" stroke="black" points="6170.82,-6970.88 6167.32,-6960.88 6163.82,-6970.88 6170.82,-6970.88"/>
</g>
<!-- layer2_gather_q_gpu6 -->
<g id="node425" class="node">
<title>layer2_gather_q_gpu6</title>
<ellipse fill="lightblue" stroke="black" cx="6450.27" cy="-6758.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="6450.27" y="-6777.55" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="6450.27" y="-6762.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6450.27" y="-6747.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6450.27" y="-6732.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_q_proj_gpu6&#45;&gt;layer2_gather_q_gpu6 -->
<g id="edge548" class="edge">
<title>layer2_q_proj_gpu6&#45;&gt;layer2_gather_q_gpu6</title>
<path fill="none" stroke="black" d="M6560.27,-6892.82C6560.27,-6892.82 6560.27,-6814.82 6560.27,-6814.82"/>
<polygon fill="black" stroke="black" points="6563.77,-6814.82 6560.27,-6804.82 6556.77,-6814.82 6563.77,-6814.82"/>
</g>
<!-- layer2_gather_k_gpu6 -->
<g id="node426" class="node">
<title>layer2_gather_k_gpu6</title>
<ellipse fill="lightblue" stroke="black" cx="7229.27" cy="-6758.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="7229.27" y="-6777.55" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="7229.27" y="-6762.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7229.27" y="-6747.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7229.27" y="-6732.55" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_k_proj_gpu6&#45;&gt;layer2_gather_k_gpu6 -->
<g id="edge549" class="edge">
<title>layer2_k_proj_gpu6&#45;&gt;layer2_gather_k_gpu6</title>
<path fill="none" stroke="black" d="M7119.27,-6892.82C7119.27,-6892.82 7119.27,-6814.82 7119.27,-6814.82"/>
<polygon fill="black" stroke="black" points="7122.77,-6814.82 7119.27,-6804.82 7115.77,-6814.82 7122.77,-6814.82"/>
</g>
<!-- layer2_gather_v_gpu6 -->
<g id="node427" class="node">
<title>layer2_gather_v_gpu6</title>
<ellipse fill="lightblue" stroke="black" cx="6001.27" cy="-6394.41" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="6001.27" y="-6413.21" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="6001.27" y="-6398.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6001.27" y="-6383.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6001.27" y="-6368.21" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_v_proj_gpu6&#45;&gt;layer2_gather_v_gpu6 -->
<g id="edge550" class="edge">
<title>layer2_v_proj_gpu6&#45;&gt;layer2_gather_v_gpu6</title>
<path fill="none" stroke="black" d="M6001.27,-6892.72C6001.27,-6892.72 6001.27,-6452.74 6001.27,-6452.74"/>
<polygon fill="black" stroke="black" points="6004.77,-6452.74 6001.27,-6442.74 5997.77,-6452.74 6004.77,-6452.74"/>
</g>
<!-- layer2_attn_scores_gpu6 -->
<g id="node428" class="node">
<title>layer2_attn_scores_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="6958.77,-6610.58 6419.77,-6610.58 6419.77,-6542.58 6958.77,-6542.58 6958.77,-6610.58"/>
<text text-anchor="middle" x="6689.27" y="-6595.38" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="6689.27" y="-6580.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6689.27" y="-6565.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="6689.27" y="-6550.38" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gather_q_gpu6&#45;&gt;layer2_attn_scores_gpu6 -->
<g id="edge551" class="edge">
<title>layer2_gather_q_gpu6&#45;&gt;layer2_attn_scores_gpu6</title>
<path fill="none" stroke="black" d="M6615.33,-6715.58C6615.33,-6715.58 6615.33,-6620.63 6615.33,-6620.63"/>
<polygon fill="black" stroke="black" points="6618.83,-6620.63 6615.33,-6610.63 6611.83,-6620.63 6618.83,-6620.63"/>
</g>
<!-- layer2_gather_k_gpu6&#45;&gt;layer2_attn_scores_gpu6 -->
<g id="edge552" class="edge">
<title>layer2_gather_k_gpu6&#45;&gt;layer2_attn_scores_gpu6</title>
<path fill="none" stroke="black" d="M6913.7,-6735.31C6913.7,-6735.31 6913.7,-6620.8 6913.7,-6620.8"/>
<polygon fill="black" stroke="black" points="6917.2,-6620.8 6913.7,-6610.8 6910.2,-6620.8 6917.2,-6620.8"/>
</g>
<!-- layer2_attn_out_gpu6 -->
<g id="node430" class="node">
<title>layer2_attn_out_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="6546.77,-6260.33 6019.77,-6260.33 6019.77,-6192.33 6546.77,-6192.33 6546.77,-6260.33"/>
<text text-anchor="middle" x="6283.27" y="-6245.13" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="6283.27" y="-6230.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="6283.27" y="-6215.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6283.27" y="-6200.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_gather_v_gpu6&#45;&gt;layer2_attn_out_gpu6 -->
<g id="edge555" class="edge">
<title>layer2_gather_v_gpu6&#45;&gt;layer2_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M6190.83,-6353.3C6190.83,-6353.3 6190.83,-6270.52 6190.83,-6270.52"/>
<polygon fill="black" stroke="black" points="6194.33,-6270.52 6190.83,-6260.52 6187.33,-6270.52 6194.33,-6270.52"/>
</g>
<!-- layer2_softmax_gpu6 -->
<g id="node429" class="node">
<title>layer2_softmax_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="6958.77,-6428.41 6419.77,-6428.41 6419.77,-6360.41 6958.77,-6360.41 6958.77,-6428.41"/>
<text text-anchor="middle" x="6689.27" y="-6413.21" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="6689.27" y="-6398.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="6689.27" y="-6383.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="6689.27" y="-6368.21" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_attn_scores_gpu6&#45;&gt;layer2_softmax_gpu6 -->
<g id="edge553" class="edge">
<title>layer2_attn_scores_gpu6&#45;&gt;layer2_softmax_gpu6</title>
<path fill="none" stroke="black" d="M6689.27,-6542.32C6689.27,-6542.32 6689.27,-6438.53 6689.27,-6438.53"/>
<polygon fill="black" stroke="black" points="6692.77,-6438.53 6689.27,-6428.53 6685.77,-6438.53 6692.77,-6438.53"/>
</g>
<!-- layer2_softmax_gpu6&#45;&gt;layer2_attn_out_gpu6 -->
<g id="edge554" class="edge">
<title>layer2_softmax_gpu6&#45;&gt;layer2_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M6483.27,-6360.4C6483.27,-6360.4 6483.27,-6270.58 6483.27,-6270.58"/>
<polygon fill="black" stroke="black" points="6486.77,-6270.58 6483.27,-6260.58 6479.77,-6270.58 6486.77,-6270.58"/>
</g>
<!-- layer2_out_proj_gpu6 -->
<g id="node431" class="node">
<title>layer2_out_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="6527.77,-6106.33 6038.77,-6106.33 6038.77,-6038.33 6527.77,-6038.33 6527.77,-6106.33"/>
<text text-anchor="middle" x="6283.27" y="-6091.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6283.27" y="-6076.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6283.27" y="-6061.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="6283.27" y="-6046.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_attn_out_gpu6&#45;&gt;layer2_out_proj_gpu6 -->
<g id="edge556" class="edge">
<title>layer2_attn_out_gpu6&#45;&gt;layer2_out_proj_gpu6</title>
<path fill="none" stroke="black" d="M6283.27,-6192.15C6283.27,-6192.15 6283.27,-6116.41 6283.27,-6116.41"/>
<polygon fill="black" stroke="black" points="6286.77,-6116.41 6283.27,-6106.41 6279.77,-6116.41 6286.77,-6116.41"/>
</g>
<!-- layer2_out_proj_gpu6&#45;&gt;layer2_attn_all_reduce -->
<g id="edge576" class="edge">
<title>layer2_out_proj_gpu6&#45;&gt;layer2_attn_all_reduce</title>
<path fill="none" stroke="black" d="M6283.27,-6038.32C6283.27,-6038.32 6283.27,-5962.54 6283.27,-5962.54"/>
<polygon fill="black" stroke="black" points="6286.77,-5962.54 6283.27,-5952.54 6279.77,-5962.54 6286.77,-5962.54"/>
</g>
<!-- layer2_q_proj_gpu7 -->
<g id="node433" class="node">
<title>layer2_q_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="8487.77,-6960.83 7986.77,-6960.83 7986.77,-6892.83 8487.77,-6892.83 8487.77,-6960.83"/>
<text text-anchor="middle" x="8237.27" y="-6945.63" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8237.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8237.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8237.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_attn_norm_gpu7&#45;&gt;layer2_q_proj_gpu7 -->
<g id="edge558" class="edge">
<title>layer2_attn_norm_gpu7&#45;&gt;layer2_q_proj_gpu7</title>
<path fill="none" stroke="black" d="M8096.27,-7046.65C8096.27,-7046.65 8096.27,-6970.91 8096.27,-6970.91"/>
<polygon fill="black" stroke="black" points="8099.77,-6970.91 8096.27,-6960.91 8092.77,-6970.91 8099.77,-6970.91"/>
</g>
<!-- layer2_k_proj_gpu7 -->
<g id="node434" class="node">
<title>layer2_k_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="9046.77,-6960.83 8545.77,-6960.83 8545.77,-6892.83 9046.77,-6892.83 9046.77,-6960.83"/>
<text text-anchor="middle" x="8796.27" y="-6945.63" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8796.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8796.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8796.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_attn_norm_gpu7&#45;&gt;layer2_k_proj_gpu7 -->
<g id="edge559" class="edge">
<title>layer2_attn_norm_gpu7&#45;&gt;layer2_k_proj_gpu7</title>
<path fill="none" stroke="black" d="M8206.01,-7080C8471.89,-7080 8855.61,-7080 8855.61,-7080 8855.61,-7080 8855.61,-6971.21 8855.61,-6971.21"/>
<polygon fill="black" stroke="black" points="8859.11,-6971.2 8855.61,-6961.21 8852.11,-6971.21 8859.11,-6971.2"/>
</g>
<!-- layer2_v_proj_gpu7 -->
<g id="node435" class="node">
<title>layer2_v_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="7928.77,-6960.83 7427.77,-6960.83 7427.77,-6892.83 7928.77,-6892.83 7928.77,-6960.83"/>
<text text-anchor="middle" x="7678.27" y="-6945.63" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7678.27" y="-6930.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7678.27" y="-6915.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7678.27" y="-6900.63" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_attn_norm_gpu7&#45;&gt;layer2_v_proj_gpu7 -->
<g id="edge560" class="edge">
<title>layer2_attn_norm_gpu7&#45;&gt;layer2_v_proj_gpu7</title>
<path fill="none" stroke="black" d="M7818.77,-7046.65C7818.77,-7046.65 7818.77,-6970.91 7818.77,-6970.91"/>
<polygon fill="black" stroke="black" points="7822.27,-6970.91 7818.77,-6960.91 7815.27,-6970.91 7822.27,-6970.91"/>
</g>
<!-- layer2_gather_q_gpu7 -->
<g id="node436" class="node">
<title>layer2_gather_q_gpu7</title>
<ellipse fill="lightblue" stroke="black" cx="8127.27" cy="-6758.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="8127.27" y="-6777.55" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="8127.27" y="-6762.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8127.27" y="-6747.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8127.27" y="-6732.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_q_proj_gpu7&#45;&gt;layer2_gather_q_gpu7 -->
<g id="edge561" class="edge">
<title>layer2_q_proj_gpu7&#45;&gt;layer2_gather_q_gpu7</title>
<path fill="none" stroke="black" d="M8237.27,-6892.82C8237.27,-6892.82 8237.27,-6814.82 8237.27,-6814.82"/>
<polygon fill="black" stroke="black" points="8240.77,-6814.82 8237.27,-6804.82 8233.77,-6814.82 8240.77,-6814.82"/>
</g>
<!-- layer2_gather_k_gpu7 -->
<g id="node437" class="node">
<title>layer2_gather_k_gpu7</title>
<ellipse fill="lightblue" stroke="black" cx="8906.27" cy="-6758.75" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="8906.27" y="-6777.55" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="8906.27" y="-6762.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8906.27" y="-6747.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8906.27" y="-6732.55" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_k_proj_gpu7&#45;&gt;layer2_gather_k_gpu7 -->
<g id="edge562" class="edge">
<title>layer2_k_proj_gpu7&#45;&gt;layer2_gather_k_gpu7</title>
<path fill="none" stroke="black" d="M8796.27,-6892.82C8796.27,-6892.82 8796.27,-6814.82 8796.27,-6814.82"/>
<polygon fill="black" stroke="black" points="8799.77,-6814.82 8796.27,-6804.82 8792.77,-6814.82 8799.77,-6814.82"/>
</g>
<!-- layer2_gather_v_gpu7 -->
<g id="node438" class="node">
<title>layer2_gather_v_gpu7</title>
<ellipse fill="lightblue" stroke="black" cx="7559.27" cy="-6576.58" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="7559.27" y="-6595.38" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="7559.27" y="-6580.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7559.27" y="-6565.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7559.27" y="-6550.38" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_v_proj_gpu7&#45;&gt;layer2_gather_v_gpu7 -->
<g id="edge563" class="edge">
<title>layer2_v_proj_gpu7&#45;&gt;layer2_gather_v_gpu7</title>
<path fill="none" stroke="black" d="M7678.27,-6892.61C7678.27,-6892.61 7678.27,-6632.19 7678.27,-6632.19"/>
<polygon fill="black" stroke="black" points="7681.77,-6632.19 7678.27,-6622.19 7674.77,-6632.19 7681.77,-6632.19"/>
</g>
<!-- layer2_attn_scores_gpu7 -->
<g id="node439" class="node">
<title>layer2_attn_scores_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="8516.77,-6610.58 7977.77,-6610.58 7977.77,-6542.58 8516.77,-6542.58 8516.77,-6610.58"/>
<text text-anchor="middle" x="8247.27" y="-6595.38" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="8247.27" y="-6580.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8247.27" y="-6565.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="8247.27" y="-6550.38" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gather_q_gpu7&#45;&gt;layer2_attn_scores_gpu7 -->
<g id="edge564" class="edge">
<title>layer2_gather_q_gpu7&#45;&gt;layer2_attn_scores_gpu7</title>
<path fill="none" stroke="black" d="M8232.83,-6712.31C8232.83,-6712.31 8232.83,-6620.86 8232.83,-6620.86"/>
<polygon fill="black" stroke="black" points="8236.33,-6620.86 8232.83,-6610.86 8229.33,-6620.86 8236.33,-6620.86"/>
</g>
<!-- layer2_gather_k_gpu7&#45;&gt;layer2_attn_scores_gpu7 -->
<g id="edge565" class="edge">
<title>layer2_gather_k_gpu7&#45;&gt;layer2_attn_scores_gpu7</title>
<path fill="none" stroke="black" d="M8545.56,-6758C8518.99,-6758 8502.33,-6758 8502.33,-6758 8502.33,-6758 8502.33,-6620.7 8502.33,-6620.7"/>
<polygon fill="black" stroke="black" points="8505.83,-6620.7 8502.33,-6610.7 8498.83,-6620.7 8505.83,-6620.7"/>
</g>
<!-- layer2_attn_out_gpu7 -->
<g id="node441" class="node">
<title>layer2_attn_out_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="7822.77,-6260.33 7295.77,-6260.33 7295.77,-6192.33 7822.77,-6192.33 7822.77,-6260.33"/>
<text text-anchor="middle" x="7559.27" y="-6245.13" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="7559.27" y="-6230.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="7559.27" y="-6215.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7559.27" y="-6200.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_gather_v_gpu7&#45;&gt;layer2_attn_out_gpu7 -->
<g id="edge568" class="edge">
<title>layer2_gather_v_gpu7&#45;&gt;layer2_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M7554.27,-6528.25C7554.27,-6528.25 7554.27,-6270.48 7554.27,-6270.48"/>
<polygon fill="black" stroke="black" points="7557.77,-6270.48 7554.27,-6260.48 7550.77,-6270.48 7557.77,-6270.48"/>
</g>
<!-- layer2_softmax_gpu7 -->
<g id="node440" class="node">
<title>layer2_softmax_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="8351.77,-6428.41 7812.77,-6428.41 7812.77,-6360.41 8351.77,-6360.41 8351.77,-6428.41"/>
<text text-anchor="middle" x="8082.27" y="-6413.21" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="8082.27" y="-6398.21" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="8082.27" y="-6383.21" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="8082.27" y="-6368.21" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_attn_scores_gpu7&#45;&gt;layer2_softmax_gpu7 -->
<g id="edge566" class="edge">
<title>layer2_attn_scores_gpu7&#45;&gt;layer2_softmax_gpu7</title>
<path fill="none" stroke="black" d="M8164.77,-6542.32C8164.77,-6542.32 8164.77,-6438.53 8164.77,-6438.53"/>
<polygon fill="black" stroke="black" points="8168.27,-6438.53 8164.77,-6428.53 8161.27,-6438.53 8168.27,-6438.53"/>
</g>
<!-- layer2_softmax_gpu7&#45;&gt;layer2_attn_out_gpu7 -->
<g id="edge567" class="edge">
<title>layer2_softmax_gpu7&#45;&gt;layer2_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M7817.77,-6360.4C7817.77,-6360.4 7817.77,-6270.58 7817.77,-6270.58"/>
<polygon fill="black" stroke="black" points="7821.27,-6270.58 7817.77,-6260.58 7814.27,-6270.58 7821.27,-6270.58"/>
</g>
<!-- layer2_out_proj_gpu7 -->
<g id="node442" class="node">
<title>layer2_out_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="7639.77,-6106.33 7150.77,-6106.33 7150.77,-6038.33 7639.77,-6038.33 7639.77,-6106.33"/>
<text text-anchor="middle" x="7395.27" y="-6091.13" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7395.27" y="-6076.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7395.27" y="-6061.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="7395.27" y="-6046.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_attn_out_gpu7&#45;&gt;layer2_out_proj_gpu7 -->
<g id="edge569" class="edge">
<title>layer2_attn_out_gpu7&#45;&gt;layer2_out_proj_gpu7</title>
<path fill="none" stroke="black" d="M7467.77,-6192.15C7467.77,-6192.15 7467.77,-6116.41 7467.77,-6116.41"/>
<polygon fill="black" stroke="black" points="7471.27,-6116.41 7467.77,-6106.41 7464.27,-6116.41 7471.27,-6116.41"/>
</g>
<!-- layer2_out_proj_gpu7&#45;&gt;layer2_attn_all_reduce -->
<g id="edge577" class="edge">
<title>layer2_out_proj_gpu7&#45;&gt;layer2_attn_all_reduce</title>
<path fill="none" stroke="black" d="M7150.6,-6072C6913.9,-6072 6590.73,-6072 6590.73,-6072 6590.73,-6072 6590.73,-5937.57 6590.73,-5937.57"/>
<polygon fill="black" stroke="black" points="6594.23,-5937.57 6590.73,-5927.57 6587.23,-5937.57 6594.23,-5937.57"/>
</g>
<!-- layer2_attn_all_reduce&#45;&gt;layer2_attn_residual -->
<g id="edge579" class="edge">
<title>layer2_attn_all_reduce&#45;&gt;layer2_attn_residual</title>
<path fill="none" stroke="black" d="M5979.75,-5880C5301.03,-5880 3719.66,-5880 3719.66,-5880 3719.66,-5880 3719.66,-5769.91 3719.66,-5769.91"/>
<polygon fill="black" stroke="black" points="3723.16,-5769.91 3719.66,-5759.91 3716.16,-5769.91 3723.16,-5769.91"/>
</g>
<!-- layer2_broadcast_to_moe -->
<g id="node445" class="node">
<title>layer2_broadcast_to_moe</title>
<ellipse fill="lightblue" stroke="black" cx="7370.27" cy="-5539.92" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="7370.27" y="-5558.72" font-family="Times,serif" font-size="14.00">Broadcast to MoE GPUs</text>
<text text-anchor="middle" x="7370.27" y="-5543.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7370.27" y="-5528.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7370.27" y="-5513.72" font-family="Times,serif" font-size="14.00">GPU: GPUs 8&#45;15</text>
</g>
<!-- layer2_attn_residual&#45;&gt;layer2_broadcast_to_moe -->
<g id="edge580" class="edge">
<title>layer2_attn_residual&#45;&gt;layer2_broadcast_to_moe</title>
<path fill="none" stroke="black" d="M3962.76,-5722C5039.89,-5722 7084.8,-5722 7084.8,-5722 7084.8,-5722 7084.8,-5577.97 7084.8,-5577.97"/>
<polygon fill="black" stroke="black" points="7088.3,-5577.97 7084.8,-5567.97 7081.3,-5577.97 7088.3,-5577.97"/>
</g>
<!-- layer2_final_residual -->
<g id="node529" class="node">
<title>layer2_final_residual</title>
<ellipse fill="lightblue" stroke="black" cx="7210.27" cy="-3893.58" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="7210.27" y="-3912.38" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="7210.27" y="-3897.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096], [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7210.27" y="-3882.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7210.27" y="-3867.38" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer2_attn_residual&#45;&gt;layer2_final_residual -->
<g id="edge695" class="edge">
<title>layer2_attn_residual&#45;&gt;layer2_final_residual</title>
<path fill="none" stroke="black" d="M3115.88,-5676.1C3115.88,-5394.71 3115.88,-3917 3115.88,-3917 3115.88,-3917 6635.8,-3917 6635.8,-3917"/>
<polygon fill="black" stroke="black" points="6635.8,-3920.5 6645.8,-3917 6635.8,-3913.5 6635.8,-3920.5"/>
</g>
<!-- layer2_moe_norm -->
<g id="node446" class="node">
<title>layer2_moe_norm</title>
<polygon fill="lightyellow" stroke="black" points="11748.77,-5405.83 11251.77,-5405.83 11251.77,-5337.83 11748.77,-5337.83 11748.77,-5405.83"/>
<text text-anchor="middle" x="11500.27" y="-5390.63" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="11500.27" y="-5375.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11500.27" y="-5360.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11500.27" y="-5345.63" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer2_broadcast_to_moe&#45;&gt;layer2_moe_norm -->
<g id="edge581" class="edge">
<title>layer2_broadcast_to_moe&#45;&gt;layer2_moe_norm</title>
<path fill="none" stroke="black" d="M7675.07,-5515.84C7675.07,-5475.35 7675.07,-5398 7675.07,-5398 7675.07,-5398 11241.5,-5398 11241.5,-5398"/>
<polygon fill="black" stroke="black" points="11241.5,-5401.5 11251.5,-5398 11241.5,-5394.5 11241.5,-5401.5"/>
</g>
<!-- layer2_gate -->
<g id="node447" class="node">
<title>layer2_gate</title>
<polygon fill="lightpink" stroke="black" points="12298.92,-5251.83 11499.31,-5251.83 11293.62,-5115.83 12093.22,-5115.83 12298.92,-5251.83"/>
<text text-anchor="middle" x="11796.27" y="-5202.63" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="11796.27" y="-5187.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11796.27" y="-5172.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="11796.27" y="-5157.63" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer2_moe_norm&#45;&gt;layer2_gate -->
<g id="edge582" class="edge">
<title>layer2_moe_norm&#45;&gt;layer2_gate</title>
<path fill="none" stroke="black" d="M11521.1,-5337.79C11521.1,-5337.79 11521.1,-5261.89 11521.1,-5261.89"/>
<polygon fill="black" stroke="black" points="11524.6,-5261.89 11521.1,-5251.89 11517.6,-5261.89 11524.6,-5261.89"/>
</g>
<!-- layer2_route_expert0 -->
<g id="node448" class="node">
<title>layer2_route_expert0</title>
<polygon fill="lightpink" stroke="black" points="15017.92,-5029.83 14218.31,-5029.83 14012.62,-4893.83 14812.22,-4893.83 15017.92,-5029.83"/>
<text text-anchor="middle" x="14515.27" y="-4980.63" font-family="Times,serif" font-size="14.00">Route to Expert 0</text>
<text text-anchor="middle" x="14515.27" y="-4965.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14515.27" y="-4950.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="14515.27" y="-4935.63" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_moe_norm&#45;&gt;layer2_route_expert0 -->
<g id="edge584" class="edge">
<title>layer2_moe_norm&#45;&gt;layer2_route_expert0</title>
<path fill="none" stroke="black" d="M11748.78,-5360C12423.53,-5360 14239.41,-5360 14239.41,-5360 14239.41,-5360 14239.41,-5040.28 14239.41,-5040.28"/>
<polygon fill="black" stroke="black" points="14242.91,-5040.28 14239.41,-5030.28 14235.91,-5040.28 14242.91,-5040.28"/>
</g>
<!-- layer2_route_expert1 -->
<g id="node453" class="node">
<title>layer2_route_expert1</title>
<polygon fill="lightpink" stroke="black" points="16081.92,-5029.83 15282.31,-5029.83 15076.62,-4893.83 15876.22,-4893.83 16081.92,-5029.83"/>
<text text-anchor="middle" x="15579.27" y="-4980.63" font-family="Times,serif" font-size="14.00">Route to Expert 1</text>
<text text-anchor="middle" x="15579.27" y="-4965.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15579.27" y="-4950.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="15579.27" y="-4935.63" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_moe_norm&#45;&gt;layer2_route_expert1 -->
<g id="edge590" class="edge">
<title>layer2_moe_norm&#45;&gt;layer2_route_expert1</title>
<path fill="none" stroke="black" d="M11749.04,-5368C12606.78,-5368 15388.5,-5368 15388.5,-5368 15388.5,-5368 15388.5,-5040.27 15388.5,-5040.27"/>
<polygon fill="black" stroke="black" points="15392,-5040.27 15388.5,-5030.27 15385,-5040.27 15392,-5040.27"/>
</g>
<!-- layer2_route_expert2 -->
<g id="node458" class="node">
<title>layer2_route_expert2</title>
<polygon fill="lightpink" stroke="black" points="17145.92,-5029.83 16346.31,-5029.83 16140.62,-4893.83 16940.22,-4893.83 17145.92,-5029.83"/>
<text text-anchor="middle" x="16643.27" y="-4980.63" font-family="Times,serif" font-size="14.00">Route to Expert 2</text>
<text text-anchor="middle" x="16643.27" y="-4965.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16643.27" y="-4950.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="16643.27" y="-4935.63" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_moe_norm&#45;&gt;layer2_route_expert2 -->
<g id="edge596" class="edge">
<title>layer2_moe_norm&#45;&gt;layer2_route_expert2</title>
<path fill="none" stroke="black" d="M11748.8,-5375C12754.54,-5375 16469.17,-5375 16469.17,-5375 16469.17,-5375 16469.17,-5040.06 16469.17,-5040.06"/>
<polygon fill="black" stroke="black" points="16472.67,-5040.06 16469.17,-5030.06 16465.67,-5040.06 16472.67,-5040.06"/>
</g>
<!-- layer2_route_expert3 -->
<g id="node463" class="node">
<title>layer2_route_expert3</title>
<polygon fill="lightpink" stroke="black" points="18209.92,-5029.83 17410.31,-5029.83 17204.62,-4893.83 18004.22,-4893.83 18209.92,-5029.83"/>
<text text-anchor="middle" x="17707.27" y="-4980.63" font-family="Times,serif" font-size="14.00">Route to Expert 3</text>
<text text-anchor="middle" x="17707.27" y="-4965.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17707.27" y="-4950.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="17707.27" y="-4935.63" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_moe_norm&#45;&gt;layer2_route_expert3 -->
<g id="edge602" class="edge">
<title>layer2_moe_norm&#45;&gt;layer2_route_expert3</title>
<path fill="none" stroke="black" d="M11749.17,-5383C12888.36,-5383 17549.84,-5383 17549.84,-5383 17549.84,-5383 17549.84,-5039.97 17549.84,-5039.97"/>
<polygon fill="black" stroke="black" points="17553.34,-5039.97 17549.84,-5029.97 17546.34,-5039.97 17553.34,-5039.97"/>
</g>
<!-- layer2_route_expert4 -->
<g id="node468" class="node">
<title>layer2_route_expert4</title>
<polygon fill="lightpink" stroke="black" points="19273.92,-5029.83 18474.31,-5029.83 18268.62,-4893.83 19068.22,-4893.83 19273.92,-5029.83"/>
<text text-anchor="middle" x="18771.27" y="-4980.63" font-family="Times,serif" font-size="14.00">Route to Expert 4</text>
<text text-anchor="middle" x="18771.27" y="-4965.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18771.27" y="-4950.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="18771.27" y="-4935.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_moe_norm&#45;&gt;layer2_route_expert4 -->
<g id="edge608" class="edge">
<title>layer2_moe_norm&#45;&gt;layer2_route_expert4</title>
<path fill="none" stroke="black" d="M11748.81,-5390C13008.76,-5390 18630.5,-5390 18630.5,-5390 18630.5,-5390 18630.5,-5040.15 18630.5,-5040.15"/>
<polygon fill="black" stroke="black" points="18634,-5040.15 18630.5,-5030.15 18627,-5040.15 18634,-5040.15"/>
</g>
<!-- layer2_route_expert5 -->
<g id="node473" class="node">
<title>layer2_route_expert5</title>
<polygon fill="lightpink" stroke="black" points="20337.92,-5029.83 19538.31,-5029.83 19332.62,-4893.83 20132.22,-4893.83 20337.92,-5029.83"/>
<text text-anchor="middle" x="19835.27" y="-4980.63" font-family="Times,serif" font-size="14.00">Route to Expert 5</text>
<text text-anchor="middle" x="19835.27" y="-4965.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19835.27" y="-4950.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="19835.27" y="-4935.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_moe_norm&#45;&gt;layer2_route_expert5 -->
<g id="edge614" class="edge">
<title>layer2_moe_norm&#45;&gt;layer2_route_expert5</title>
<path fill="none" stroke="black" d="M11748.8,-5398C13121.18,-5398 19711.17,-5398 19711.17,-5398 19711.17,-5398 19711.17,-5039.98 19711.17,-5039.98"/>
<polygon fill="black" stroke="black" points="19714.67,-5039.98 19711.17,-5029.98 19707.67,-5039.98 19714.67,-5039.98"/>
</g>
<!-- layer2_route_expert6 -->
<g id="node478" class="node">
<title>layer2_route_expert6</title>
<polygon fill="lightpink" stroke="black" points="4377.92,-5029.83 3578.31,-5029.83 3372.62,-4893.83 4172.22,-4893.83 4377.92,-5029.83"/>
<text text-anchor="middle" x="3875.27" y="-4980.63" font-family="Times,serif" font-size="14.00">Route to Expert 6</text>
<text text-anchor="middle" x="3875.27" y="-4965.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3875.27" y="-4950.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="3875.27" y="-4935.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_moe_norm&#45;&gt;layer2_route_expert6 -->
<g id="edge620" class="edge">
<title>layer2_moe_norm&#45;&gt;layer2_route_expert6</title>
<path fill="none" stroke="black" d="M11251.75,-5390C9964.14,-5390 4110.54,-5390 4110.54,-5390 4110.54,-5390 4110.54,-5040.15 4110.54,-5040.15"/>
<polygon fill="black" stroke="black" points="4114.04,-5040.15 4110.54,-5030.15 4107.04,-5040.15 4114.04,-5040.15"/>
</g>
<!-- layer2_route_expert7 -->
<g id="node483" class="node">
<title>layer2_route_expert7</title>
<polygon fill="lightpink" stroke="black" points="5441.92,-5029.83 4642.31,-5029.83 4436.62,-4893.83 5236.22,-4893.83 5441.92,-5029.83"/>
<text text-anchor="middle" x="4939.27" y="-4980.63" font-family="Times,serif" font-size="14.00">Route to Expert 7</text>
<text text-anchor="middle" x="4939.27" y="-4965.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4939.27" y="-4950.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="4939.27" y="-4935.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_moe_norm&#45;&gt;layer2_route_expert7 -->
<g id="edge626" class="edge">
<title>layer2_moe_norm&#45;&gt;layer2_route_expert7</title>
<path fill="none" stroke="black" d="M11251.4,-5383C10109.69,-5383 5428.54,-5383 5428.54,-5383 5428.54,-5383 5428.54,-5039.97 5428.54,-5039.97"/>
<polygon fill="black" stroke="black" points="5432.04,-5039.97 5428.54,-5029.97 5425.04,-5039.97 5432.04,-5039.97"/>
</g>
<!-- layer2_route_expert8 -->
<g id="node488" class="node">
<title>layer2_route_expert8</title>
<polygon fill="lightpink" stroke="black" points="6505.92,-5029.83 5706.31,-5029.83 5500.62,-4893.83 6300.22,-4893.83 6505.92,-5029.83"/>
<text text-anchor="middle" x="6003.27" y="-4980.63" font-family="Times,serif" font-size="14.00">Route to Expert 8</text>
<text text-anchor="middle" x="6003.27" y="-4965.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6003.27" y="-4950.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="6003.27" y="-4935.63" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_moe_norm&#45;&gt;layer2_route_expert8 -->
<g id="edge632" class="edge">
<title>layer2_moe_norm&#45;&gt;layer2_route_expert8</title>
<path fill="none" stroke="black" d="M11251.71,-5375C10194.21,-5375 6123.25,-5375 6123.25,-5375 6123.25,-5375 6123.25,-5040.06 6123.25,-5040.06"/>
<polygon fill="black" stroke="black" points="6126.75,-5040.06 6123.25,-5030.06 6119.75,-5040.06 6126.75,-5040.06"/>
</g>
<!-- layer2_route_expert9 -->
<g id="node493" class="node">
<title>layer2_route_expert9</title>
<polygon fill="lightpink" stroke="black" points="7569.92,-5029.83 6770.31,-5029.83 6564.62,-4893.83 7364.22,-4893.83 7569.92,-5029.83"/>
<text text-anchor="middle" x="7067.27" y="-4980.63" font-family="Times,serif" font-size="14.00">Route to Expert 9</text>
<text text-anchor="middle" x="7067.27" y="-4965.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7067.27" y="-4950.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="7067.27" y="-4935.63" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_moe_norm&#45;&gt;layer2_route_expert9 -->
<g id="edge638" class="edge">
<title>layer2_moe_norm&#45;&gt;layer2_route_expert9</title>
<path fill="none" stroke="black" d="M11251.42,-5368C10335.19,-5368 7202.59,-5368 7202.59,-5368 7202.59,-5368 7202.59,-5040.27 7202.59,-5040.27"/>
<polygon fill="black" stroke="black" points="7206.09,-5040.27 7202.59,-5030.27 7199.09,-5040.27 7206.09,-5040.27"/>
</g>
<!-- layer2_route_expert10 -->
<g id="node498" class="node">
<title>layer2_route_expert10</title>
<polygon fill="lightpink" stroke="black" points="8633.92,-5029.83 7834.31,-5029.83 7628.62,-4893.83 8428.22,-4893.83 8633.92,-5029.83"/>
<text text-anchor="middle" x="8131.27" y="-4980.63" font-family="Times,serif" font-size="14.00">Route to Expert 10</text>
<text text-anchor="middle" x="8131.27" y="-4965.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8131.27" y="-4950.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="8131.27" y="-4935.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_moe_norm&#45;&gt;layer2_route_expert10 -->
<g id="edge644" class="edge">
<title>layer2_moe_norm&#45;&gt;layer2_route_expert10</title>
<path fill="none" stroke="black" d="M11251.45,-5360C10543.21,-5360 8567.1,-5360 8567.1,-5360 8567.1,-5360 8567.1,-5040.28 8567.1,-5040.28"/>
<polygon fill="black" stroke="black" points="8570.6,-5040.28 8567.1,-5030.28 8563.6,-5040.28 8570.6,-5040.28"/>
</g>
<!-- layer2_route_expert11 -->
<g id="node503" class="node">
<title>layer2_route_expert11</title>
<polygon fill="lightpink" stroke="black" points="9697.92,-5029.83 8898.31,-5029.83 8692.62,-4893.83 9492.22,-4893.83 9697.92,-5029.83"/>
<text text-anchor="middle" x="9195.27" y="-4980.63" font-family="Times,serif" font-size="14.00">Route to Expert 11</text>
<text text-anchor="middle" x="9195.27" y="-4965.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9195.27" y="-4950.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="9195.27" y="-4935.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_moe_norm&#45;&gt;layer2_route_expert11 -->
<g id="edge650" class="edge">
<title>layer2_moe_norm&#45;&gt;layer2_route_expert11</title>
<path fill="none" stroke="black" d="M11251.4,-5352C10749.98,-5352 9665.6,-5352 9665.6,-5352 9665.6,-5352 9665.6,-5040.24 9665.6,-5040.24"/>
<polygon fill="black" stroke="black" points="9669.1,-5040.24 9665.6,-5030.24 9662.1,-5040.24 9669.1,-5040.24"/>
</g>
<!-- layer2_route_expert12 -->
<g id="node508" class="node">
<title>layer2_route_expert12</title>
<polygon fill="lightpink" stroke="black" points="10761.92,-5029.83 9962.31,-5029.83 9756.62,-4893.83 10556.22,-4893.83 10761.92,-5029.83"/>
<text text-anchor="middle" x="10259.27" y="-4980.63" font-family="Times,serif" font-size="14.00">Route to Expert 12</text>
<text text-anchor="middle" x="10259.27" y="-4965.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10259.27" y="-4950.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="10259.27" y="-4935.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_moe_norm&#45;&gt;layer2_route_expert12 -->
<g id="edge656" class="edge">
<title>layer2_moe_norm&#45;&gt;layer2_route_expert12</title>
<path fill="none" stroke="black" d="M11251.63,-5345C11012.55,-5345 10687.21,-5345 10687.21,-5345 10687.21,-5345 10687.21,-5039.89 10687.21,-5039.89"/>
<polygon fill="black" stroke="black" points="10690.71,-5039.89 10687.21,-5029.89 10683.71,-5039.89 10690.71,-5039.89"/>
</g>
<!-- layer2_route_expert13 -->
<g id="node513" class="node">
<title>layer2_route_expert13</title>
<polygon fill="lightpink" stroke="black" points="11825.92,-5029.83 11026.31,-5029.83 10820.62,-4893.83 11620.22,-4893.83 11825.92,-5029.83"/>
<text text-anchor="middle" x="11323.27" y="-4980.63" font-family="Times,serif" font-size="14.00">Route to Expert 13</text>
<text text-anchor="middle" x="11323.27" y="-4965.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11323.27" y="-4950.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="11323.27" y="-4935.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_moe_norm&#45;&gt;layer2_route_expert13 -->
<g id="edge662" class="edge">
<title>layer2_moe_norm&#45;&gt;layer2_route_expert13</title>
<path fill="none" stroke="black" d="M11272.6,-5337.58C11272.6,-5337.58 11272.6,-5039.89 11272.6,-5039.89"/>
<polygon fill="black" stroke="black" points="11276.1,-5039.89 11272.6,-5029.89 11269.1,-5039.89 11276.1,-5039.89"/>
</g>
<!-- layer2_route_expert14 -->
<g id="node518" class="node">
<title>layer2_route_expert14</title>
<polygon fill="lightpink" stroke="black" points="12889.92,-5029.83 12090.31,-5029.83 11884.62,-4893.83 12684.22,-4893.83 12889.92,-5029.83"/>
<text text-anchor="middle" x="12387.27" y="-4980.63" font-family="Times,serif" font-size="14.00">Route to Expert 14</text>
<text text-anchor="middle" x="12387.27" y="-4965.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12387.27" y="-4950.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="12387.27" y="-4935.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_moe_norm&#45;&gt;layer2_route_expert14 -->
<g id="edge668" class="edge">
<title>layer2_moe_norm&#45;&gt;layer2_route_expert14</title>
<path fill="none" stroke="black" d="M11748.98,-5345C11992.26,-5345 12326.43,-5345 12326.43,-5345 12326.43,-5345 12326.43,-5039.89 12326.43,-5039.89"/>
<polygon fill="black" stroke="black" points="12329.93,-5039.89 12326.43,-5029.89 12322.93,-5039.89 12329.93,-5039.89"/>
</g>
<!-- layer2_route_expert15 -->
<g id="node523" class="node">
<title>layer2_route_expert15</title>
<polygon fill="lightpink" stroke="black" points="13953.92,-5029.83 13154.31,-5029.83 12948.62,-4893.83 13748.22,-4893.83 13953.92,-5029.83"/>
<text text-anchor="middle" x="13451.27" y="-4980.63" font-family="Times,serif" font-size="14.00">Route to Expert 15</text>
<text text-anchor="middle" x="13451.27" y="-4965.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13451.27" y="-4950.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="13451.27" y="-4935.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_moe_norm&#45;&gt;layer2_route_expert15 -->
<g id="edge674" class="edge">
<title>layer2_moe_norm&#45;&gt;layer2_route_expert15</title>
<path fill="none" stroke="black" d="M11748.84,-5352C12167.5,-5352 12968.07,-5352 12968.07,-5352 12968.07,-5352 12968.07,-4971.9 12968.07,-4971.9"/>
<polygon fill="black" stroke="black" points="12971.57,-4971.9 12968.07,-4961.9 12964.57,-4971.9 12971.57,-4971.9"/>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_expert0 -->
<g id="edge583" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12143.47,-5149C12792.79,-5149 14125.92,-5149 14125.92,-5149 14125.92,-5149 14125.92,-4978.94 14125.92,-4978.94"/>
<polygon fill="black" stroke="black" points="14129.42,-4978.94 14125.92,-4968.94 14122.42,-4978.94 14129.42,-4978.94"/>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_expert1 -->
<g id="edge589" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12169.31,-5166C13059.13,-5166 15232.47,-5166 15232.47,-5166 15232.47,-5166 15232.47,-5006.93 15232.47,-5006.93"/>
<polygon fill="black" stroke="black" points="15235.97,-5006.93 15232.47,-4996.93 15228.97,-5006.93 15235.97,-5006.93"/>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_expert2 -->
<g id="edge595" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12194.89,-5183C13297.08,-5183 16304.8,-5183 16304.8,-5183 16304.8,-5183 16304.8,-5012.4 16304.8,-5012.4"/>
<polygon fill="black" stroke="black" points="16308.31,-5012.4 16304.8,-5002.4 16301.31,-5012.4 16308.31,-5012.4"/>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_expert3 -->
<g id="edge601" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12220.61,-5200C13523.26,-5200 17377.14,-5200 17377.14,-5200 17377.14,-5200 17377.14,-5018.04 17377.14,-5018.04"/>
<polygon fill="black" stroke="black" points="17380.64,-5018.04 17377.14,-5008.04 17373.64,-5018.04 17380.64,-5018.04"/>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_expert4 -->
<g id="edge607" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12246.38,-5217C13741.7,-5217 18449.47,-5217 18449.47,-5217 18449.47,-5217 18449.47,-5023.47 18449.47,-5023.47"/>
<polygon fill="black" stroke="black" points="18452.97,-5023.47 18449.47,-5013.47 18445.97,-5023.47 18452.97,-5023.47"/>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_expert5 -->
<g id="edge613" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12272.25,-5234C13954.84,-5234 19521.8,-5234 19521.8,-5234 19521.8,-5234 19521.8,-5029.22 19521.8,-5029.22"/>
<polygon fill="black" stroke="black" points="19525.31,-5029.22 19521.8,-5019.22 19518.31,-5029.22 19525.31,-5029.22"/>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_expert6 -->
<g id="edge619" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11472.07,-5234C10027.08,-5234 4244.32,-5234 4244.32,-5234 4244.32,-5234 4244.32,-5040.16 4244.32,-5040.16"/>
<polygon fill="black" stroke="black" points="4247.82,-5040.16 4244.32,-5030.16 4240.82,-5040.16 4247.82,-5040.16"/>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_expert7 -->
<g id="edge625" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11446.35,-5217C10114.37,-5217 5435.32,-5217 5435.32,-5217 5435.32,-5217 5435.32,-4971.88 5435.32,-4971.88"/>
<polygon fill="black" stroke="black" points="5438.82,-4971.88 5435.32,-4961.88 5431.82,-4971.88 5438.82,-4971.88"/>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_expert8 -->
<g id="edge631" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11420.84,-5200C10183.86,-5200 6314.67,-5200 6314.67,-5200 6314.67,-5200 6314.67,-5040.08 6314.67,-5040.08"/>
<polygon fill="black" stroke="black" points="6318.17,-5040.08 6314.67,-5030.08 6311.17,-5040.08 6318.17,-5040.08"/>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_expert9 -->
<g id="edge637" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11395.18,-5183C10308.09,-5183 7386.34,-5183 7386.34,-5183 7386.34,-5183 7386.34,-5039.99 7386.34,-5039.99"/>
<polygon fill="black" stroke="black" points="7389.84,-5039.99 7386.34,-5029.99 7382.84,-5039.99 7389.84,-5039.99"/>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_expert10 -->
<g id="edge643" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11369.18,-5166C10496.29,-5166 8589.43,-5166 8589.43,-5166 8589.43,-5166 8589.43,-4971.98 8589.43,-4971.98"/>
<polygon fill="black" stroke="black" points="8592.93,-4971.98 8589.43,-4961.98 8585.93,-4971.98 8592.93,-4971.98"/>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_expert11 -->
<g id="edge649" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11343.46,-5149C10720.81,-5149 9676.43,-5149 9676.43,-5149 9676.43,-5149 9676.43,-4971.97 9676.43,-4971.97"/>
<polygon fill="black" stroke="black" points="9679.93,-4971.97 9676.43,-4961.97 9672.93,-4971.97 9679.93,-4971.97"/>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_expert12 -->
<g id="edge655" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11318.05,-5132C11032.39,-5132 10724.65,-5132 10724.65,-5132 10724.65,-5132 10724.65,-4971.96 10724.65,-4971.96"/>
<polygon fill="black" stroke="black" points="10728.15,-4971.96 10724.65,-4961.96 10721.15,-4971.96 10728.15,-4971.96"/>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_expert13 -->
<g id="edge661" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11559.77,-5115.72C11559.77,-5115.72 11559.77,-5040.2 11559.77,-5040.2"/>
<polygon fill="black" stroke="black" points="11563.27,-5040.2 11559.77,-5030.2 11556.27,-5040.2 11563.27,-5040.2"/>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_expert14 -->
<g id="edge667" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12091.77,-5115.72C12091.77,-5115.72 12091.77,-5040.2 12091.77,-5040.2"/>
<polygon fill="black" stroke="black" points="12095.27,-5040.2 12091.77,-5030.2 12088.27,-5040.2 12095.27,-5040.2"/>
</g>
<!-- layer2_gate&#45;&gt;layer2_route_expert15 -->
<g id="edge673" class="edge">
<title>layer2_gate&#45;&gt;layer2_route_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12118.02,-5132C12461.92,-5132 12958.26,-5132 12958.26,-5132 12958.26,-5132 12958.26,-4971.96 12958.26,-4971.96"/>
<polygon fill="black" stroke="black" points="12961.76,-4971.96 12958.26,-4961.96 12954.76,-4971.96 12961.76,-4971.96"/>
</g>
<!-- layer2_expert0_up -->
<g id="node449" class="node">
<title>layer2_expert0_up</title>
<polygon fill="lightcoral" stroke="black" points="14675.27,-4807.83 14393.27,-4807.83 14393.27,-4739.83 14675.27,-4739.83 14675.27,-4807.83"/>
<text text-anchor="middle" x="14534.27" y="-4792.63" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="14534.27" y="-4777.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="14534.27" y="-4762.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="14534.27" y="-4747.63" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_route_expert0&#45;&gt;layer2_expert0_up -->
<g id="edge585" class="edge">
<title>layer2_route_expert0&#45;&gt;layer2_expert0_up</title>
<path fill="none" stroke="black" d="M14534.27,-4893.69C14534.27,-4893.69 14534.27,-4818.01 14534.27,-4818.01"/>
<polygon fill="black" stroke="black" points="14537.77,-4818.01 14534.27,-4808.01 14530.77,-4818.01 14537.77,-4818.01"/>
</g>
<!-- layer2_expert0_activation -->
<g id="node450" class="node">
<title>layer2_expert0_activation</title>
<polygon fill="lightyellow" stroke="black" points="14685.27,-4653.83 14403.27,-4653.83 14403.27,-4585.83 14685.27,-4585.83 14685.27,-4653.83"/>
<text text-anchor="middle" x="14544.27" y="-4638.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14544.27" y="-4623.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="14544.27" y="-4608.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="14544.27" y="-4593.63" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_expert0_up&#45;&gt;layer2_expert0_activation -->
<g id="edge586" class="edge">
<title>layer2_expert0_up&#45;&gt;layer2_expert0_activation</title>
<path fill="none" stroke="black" d="M14539.27,-4739.65C14539.27,-4739.65 14539.27,-4663.91 14539.27,-4663.91"/>
<polygon fill="black" stroke="black" points="14542.77,-4663.91 14539.27,-4653.91 14535.77,-4663.91 14542.77,-4663.91"/>
</g>
<!-- layer2_expert0_down -->
<g id="node451" class="node">
<title>layer2_expert0_down</title>
<polygon fill="lightcoral" stroke="black" points="14689.77,-4499.83 14416.77,-4499.83 14416.77,-4431.83 14689.77,-4431.83 14689.77,-4499.83"/>
<text text-anchor="middle" x="14553.27" y="-4484.63" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="14553.27" y="-4469.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="14553.27" y="-4454.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="14553.27" y="-4439.63" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_expert0_activation&#45;&gt;layer2_expert0_down -->
<g id="edge587" class="edge">
<title>layer2_expert0_activation&#45;&gt;layer2_expert0_down</title>
<path fill="none" stroke="black" d="M14551.02,-4585.65C14551.02,-4585.65 14551.02,-4509.91 14551.02,-4509.91"/>
<polygon fill="black" stroke="black" points="14554.52,-4509.91 14551.02,-4499.91 14547.52,-4509.91 14554.52,-4509.91"/>
</g>
<!-- layer2_route_back_expert0 -->
<g id="node452" class="node">
<title>layer2_route_back_expert0</title>
<polygon fill="lightpink" stroke="black" points="15105.3,-4345.83 14286,-4345.83 14075.23,-4209.83 14894.54,-4209.83 15105.3,-4345.83"/>
<text text-anchor="middle" x="14590.27" y="-4296.63" font-family="Times,serif" font-size="14.00">Route Back Expert 0</text>
<text text-anchor="middle" x="14590.27" y="-4281.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="14590.27" y="-4266.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14590.27" y="-4251.63" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_expert0_down&#45;&gt;layer2_route_back_expert0 -->
<g id="edge588" class="edge">
<title>layer2_expert0_down&#45;&gt;layer2_route_back_expert0</title>
<path fill="none" stroke="black" d="M14553.27,-4431.79C14553.27,-4431.79 14553.27,-4355.89 14553.27,-4355.89"/>
<polygon fill="black" stroke="black" points="14556.77,-4355.89 14553.27,-4345.89 14549.77,-4355.89 14556.77,-4355.89"/>
</g>
<!-- layer2_expert_agg -->
<g id="node528" class="node">
<title>layer2_expert_agg</title>
<ellipse fill="lightblue" stroke="black" cx="11323.27" cy="-4075.75" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="11323.27" y="-4094.55" font-family="Times,serif" font-size="14.00">Aggregate Experts</text>
<text text-anchor="middle" x="11323.27" y="-4079.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11323.27" y="-4064.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11323.27" y="-4049.55" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer2_route_back_expert0&#45;&gt;layer2_expert_agg -->
<g id="edge679" class="edge">
<title>layer2_route_back_expert0&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M14121.88,-4277.7C14121.88,-4272.04 14121.88,-4091 14121.88,-4091 14121.88,-4091 11666.68,-4091 11666.68,-4091"/>
<polygon fill="black" stroke="black" points="11666.68,-4087.5 11656.68,-4091 11666.68,-4094.5 11666.68,-4087.5"/>
</g>
<!-- layer2_expert1_up -->
<g id="node454" class="node">
<title>layer2_expert1_up</title>
<polygon fill="lightcoral" stroke="black" points="15732.27,-4807.83 15450.27,-4807.83 15450.27,-4739.83 15732.27,-4739.83 15732.27,-4807.83"/>
<text text-anchor="middle" x="15591.27" y="-4792.63" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="15591.27" y="-4777.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="15591.27" y="-4762.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="15591.27" y="-4747.63" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_route_expert1&#45;&gt;layer2_expert1_up -->
<g id="edge591" class="edge">
<title>layer2_route_expert1&#45;&gt;layer2_expert1_up</title>
<path fill="none" stroke="black" d="M15591.27,-4893.69C15591.27,-4893.69 15591.27,-4818.01 15591.27,-4818.01"/>
<polygon fill="black" stroke="black" points="15594.77,-4818.01 15591.27,-4808.01 15587.77,-4818.01 15594.77,-4818.01"/>
</g>
<!-- layer2_expert1_activation -->
<g id="node455" class="node">
<title>layer2_expert1_activation</title>
<polygon fill="lightyellow" stroke="black" points="15745.27,-4653.83 15463.27,-4653.83 15463.27,-4585.83 15745.27,-4585.83 15745.27,-4653.83"/>
<text text-anchor="middle" x="15604.27" y="-4638.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15604.27" y="-4623.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="15604.27" y="-4608.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="15604.27" y="-4593.63" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_expert1_up&#45;&gt;layer2_expert1_activation -->
<g id="edge592" class="edge">
<title>layer2_expert1_up&#45;&gt;layer2_expert1_activation</title>
<path fill="none" stroke="black" d="M15597.77,-4739.65C15597.77,-4739.65 15597.77,-4663.91 15597.77,-4663.91"/>
<polygon fill="black" stroke="black" points="15601.27,-4663.91 15597.77,-4653.91 15594.27,-4663.91 15601.27,-4663.91"/>
</g>
<!-- layer2_expert1_down -->
<g id="node456" class="node">
<title>layer2_expert1_down</title>
<polygon fill="lightcoral" stroke="black" points="15765.77,-4499.83 15492.77,-4499.83 15492.77,-4431.83 15765.77,-4431.83 15765.77,-4499.83"/>
<text text-anchor="middle" x="15629.27" y="-4484.63" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="15629.27" y="-4469.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="15629.27" y="-4454.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="15629.27" y="-4439.63" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_expert1_activation&#45;&gt;layer2_expert1_down -->
<g id="edge593" class="edge">
<title>layer2_expert1_activation&#45;&gt;layer2_expert1_down</title>
<path fill="none" stroke="black" d="M15619.02,-4585.65C15619.02,-4585.65 15619.02,-4509.91 15619.02,-4509.91"/>
<polygon fill="black" stroke="black" points="15622.52,-4509.91 15619.02,-4499.91 15615.52,-4509.91 15622.52,-4509.91"/>
</g>
<!-- layer2_route_back_expert1 -->
<g id="node457" class="node">
<title>layer2_route_back_expert1</title>
<polygon fill="lightpink" stroke="black" points="16194.3,-4345.83 15375,-4345.83 15164.23,-4209.83 15983.54,-4209.83 16194.3,-4345.83"/>
<text text-anchor="middle" x="15679.27" y="-4296.63" font-family="Times,serif" font-size="14.00">Route Back Expert 1</text>
<text text-anchor="middle" x="15679.27" y="-4281.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="15679.27" y="-4266.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15679.27" y="-4251.63" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer2_expert1_down&#45;&gt;layer2_route_back_expert1 -->
<g id="edge594" class="edge">
<title>layer2_expert1_down&#45;&gt;layer2_route_back_expert1</title>
<path fill="none" stroke="black" d="M15629.27,-4431.79C15629.27,-4431.79 15629.27,-4355.89 15629.27,-4355.89"/>
<polygon fill="black" stroke="black" points="15632.77,-4355.89 15629.27,-4345.89 15625.77,-4355.89 15632.77,-4355.89"/>
</g>
<!-- layer2_route_back_expert1&#45;&gt;layer2_expert_agg -->
<g id="edge680" class="edge">
<title>layer2_route_back_expert1&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M15626.55,-4209.82C15626.55,-4152.92 15626.55,-4081 15626.55,-4081 15626.55,-4081 11682.69,-4081 11682.69,-4081"/>
<polygon fill="black" stroke="black" points="11682.69,-4077.5 11672.69,-4081 11682.69,-4084.5 11682.69,-4077.5"/>
</g>
<!-- layer2_expert2_up -->
<g id="node459" class="node">
<title>layer2_expert2_up</title>
<polygon fill="lightcoral" stroke="black" points="16800.27,-4807.83 16518.27,-4807.83 16518.27,-4739.83 16800.27,-4739.83 16800.27,-4807.83"/>
<text text-anchor="middle" x="16659.27" y="-4792.63" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="16659.27" y="-4777.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="16659.27" y="-4762.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="16659.27" y="-4747.63" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_route_expert2&#45;&gt;layer2_expert2_up -->
<g id="edge597" class="edge">
<title>layer2_route_expert2&#45;&gt;layer2_expert2_up</title>
<path fill="none" stroke="black" d="M16659.27,-4893.69C16659.27,-4893.69 16659.27,-4818.01 16659.27,-4818.01"/>
<polygon fill="black" stroke="black" points="16662.77,-4818.01 16659.27,-4808.01 16655.77,-4818.01 16662.77,-4818.01"/>
</g>
<!-- layer2_expert2_activation -->
<g id="node460" class="node">
<title>layer2_expert2_activation</title>
<polygon fill="lightyellow" stroke="black" points="16816.27,-4653.83 16534.27,-4653.83 16534.27,-4585.83 16816.27,-4585.83 16816.27,-4653.83"/>
<text text-anchor="middle" x="16675.27" y="-4638.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16675.27" y="-4623.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="16675.27" y="-4608.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="16675.27" y="-4593.63" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_expert2_up&#45;&gt;layer2_expert2_activation -->
<g id="edge598" class="edge">
<title>layer2_expert2_up&#45;&gt;layer2_expert2_activation</title>
<path fill="none" stroke="black" d="M16667.27,-4739.65C16667.27,-4739.65 16667.27,-4663.91 16667.27,-4663.91"/>
<polygon fill="black" stroke="black" points="16670.77,-4663.91 16667.27,-4653.91 16663.77,-4663.91 16670.77,-4663.91"/>
</g>
<!-- layer2_expert2_down -->
<g id="node461" class="node">
<title>layer2_expert2_down</title>
<polygon fill="lightcoral" stroke="black" points="16842.77,-4499.83 16569.77,-4499.83 16569.77,-4431.83 16842.77,-4431.83 16842.77,-4499.83"/>
<text text-anchor="middle" x="16706.27" y="-4484.63" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="16706.27" y="-4469.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="16706.27" y="-4454.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="16706.27" y="-4439.63" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_expert2_activation&#45;&gt;layer2_expert2_down -->
<g id="edge599" class="edge">
<title>layer2_expert2_activation&#45;&gt;layer2_expert2_down</title>
<path fill="none" stroke="black" d="M16693.02,-4585.65C16693.02,-4585.65 16693.02,-4509.91 16693.02,-4509.91"/>
<polygon fill="black" stroke="black" points="16696.52,-4509.91 16693.02,-4499.91 16689.52,-4509.91 16696.52,-4509.91"/>
</g>
<!-- layer2_route_back_expert2 -->
<g id="node462" class="node">
<title>layer2_route_back_expert2</title>
<polygon fill="lightpink" stroke="black" points="17283.3,-4345.83 16464,-4345.83 16253.23,-4209.83 17072.54,-4209.83 17283.3,-4345.83"/>
<text text-anchor="middle" x="16768.27" y="-4296.63" font-family="Times,serif" font-size="14.00">Route Back Expert 2</text>
<text text-anchor="middle" x="16768.27" y="-4281.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="16768.27" y="-4266.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16768.27" y="-4251.63" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_expert2_down&#45;&gt;layer2_route_back_expert2 -->
<g id="edge600" class="edge">
<title>layer2_expert2_down&#45;&gt;layer2_route_back_expert2</title>
<path fill="none" stroke="black" d="M16706.27,-4431.79C16706.27,-4431.79 16706.27,-4355.89 16706.27,-4355.89"/>
<polygon fill="black" stroke="black" points="16709.77,-4355.89 16706.27,-4345.89 16702.77,-4355.89 16709.77,-4355.89"/>
</g>
<!-- layer2_route_back_expert2&#45;&gt;layer2_expert_agg -->
<g id="edge681" class="edge">
<title>layer2_route_back_expert2&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M16703.05,-4209.78C16703.05,-4149.17 16703.05,-4070 16703.05,-4070 16703.05,-4070 11682.36,-4070 11682.36,-4070"/>
<polygon fill="black" stroke="black" points="11682.36,-4066.5 11672.36,-4070 11682.36,-4073.5 11682.36,-4066.5"/>
</g>
<!-- layer2_expert3_up -->
<g id="node464" class="node">
<title>layer2_expert3_up</title>
<polygon fill="lightcoral" stroke="black" points="17867.27,-4807.83 17585.27,-4807.83 17585.27,-4739.83 17867.27,-4739.83 17867.27,-4807.83"/>
<text text-anchor="middle" x="17726.27" y="-4792.63" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="17726.27" y="-4777.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="17726.27" y="-4762.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="17726.27" y="-4747.63" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_route_expert3&#45;&gt;layer2_expert3_up -->
<g id="edge603" class="edge">
<title>layer2_route_expert3&#45;&gt;layer2_expert3_up</title>
<path fill="none" stroke="black" d="M17726.27,-4893.69C17726.27,-4893.69 17726.27,-4818.01 17726.27,-4818.01"/>
<polygon fill="black" stroke="black" points="17729.77,-4818.01 17726.27,-4808.01 17722.77,-4818.01 17729.77,-4818.01"/>
</g>
<!-- layer2_expert3_activation -->
<g id="node465" class="node">
<title>layer2_expert3_activation</title>
<polygon fill="lightyellow" stroke="black" points="17886.27,-4653.83 17604.27,-4653.83 17604.27,-4585.83 17886.27,-4585.83 17886.27,-4653.83"/>
<text text-anchor="middle" x="17745.27" y="-4638.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="17745.27" y="-4623.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="17745.27" y="-4608.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="17745.27" y="-4593.63" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_expert3_up&#45;&gt;layer2_expert3_activation -->
<g id="edge604" class="edge">
<title>layer2_expert3_up&#45;&gt;layer2_expert3_activation</title>
<path fill="none" stroke="black" d="M17735.77,-4739.65C17735.77,-4739.65 17735.77,-4663.91 17735.77,-4663.91"/>
<polygon fill="black" stroke="black" points="17739.27,-4663.91 17735.77,-4653.91 17732.27,-4663.91 17739.27,-4663.91"/>
</g>
<!-- layer2_expert3_down -->
<g id="node466" class="node">
<title>layer2_expert3_down</title>
<polygon fill="lightcoral" stroke="black" points="17918.77,-4499.83 17645.77,-4499.83 17645.77,-4431.83 17918.77,-4431.83 17918.77,-4499.83"/>
<text text-anchor="middle" x="17782.27" y="-4484.63" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="17782.27" y="-4469.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="17782.27" y="-4454.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="17782.27" y="-4439.63" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_expert3_activation&#45;&gt;layer2_expert3_down -->
<g id="edge605" class="edge">
<title>layer2_expert3_activation&#45;&gt;layer2_expert3_down</title>
<path fill="none" stroke="black" d="M17766.02,-4585.65C17766.02,-4585.65 17766.02,-4509.91 17766.02,-4509.91"/>
<polygon fill="black" stroke="black" points="17769.52,-4509.91 17766.02,-4499.91 17762.52,-4509.91 17769.52,-4509.91"/>
</g>
<!-- layer2_route_back_expert3 -->
<g id="node467" class="node">
<title>layer2_route_back_expert3</title>
<polygon fill="lightpink" stroke="black" points="18372.3,-4345.83 17553,-4345.83 17342.23,-4209.83 18161.54,-4209.83 18372.3,-4345.83"/>
<text text-anchor="middle" x="17857.27" y="-4296.63" font-family="Times,serif" font-size="14.00">Route Back Expert 3</text>
<text text-anchor="middle" x="17857.27" y="-4281.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="17857.27" y="-4266.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17857.27" y="-4251.63" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer2_expert3_down&#45;&gt;layer2_route_back_expert3 -->
<g id="edge606" class="edge">
<title>layer2_expert3_down&#45;&gt;layer2_route_back_expert3</title>
<path fill="none" stroke="black" d="M17782.27,-4431.79C17782.27,-4431.79 17782.27,-4355.89 17782.27,-4355.89"/>
<polygon fill="black" stroke="black" points="17785.77,-4355.89 17782.27,-4345.89 17778.77,-4355.89 17785.77,-4355.89"/>
</g>
<!-- layer2_route_back_expert3&#45;&gt;layer2_expert_agg -->
<g id="edge682" class="edge">
<title>layer2_route_back_expert3&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M17353.77,-4277.67C17353.77,-4271.05 17353.77,-4059 17353.77,-4059 17353.77,-4059 11662.85,-4059 11662.85,-4059"/>
<polygon fill="black" stroke="black" points="11662.85,-4055.5 11652.85,-4059 11662.85,-4062.5 11662.85,-4055.5"/>
</g>
<!-- layer2_expert4_up -->
<g id="node469" class="node">
<title>layer2_expert4_up</title>
<polygon fill="lightcoral" stroke="black" points="18934.27,-4807.83 18652.27,-4807.83 18652.27,-4739.83 18934.27,-4739.83 18934.27,-4807.83"/>
<text text-anchor="middle" x="18793.27" y="-4792.63" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="18793.27" y="-4777.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="18793.27" y="-4762.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="18793.27" y="-4747.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_route_expert4&#45;&gt;layer2_expert4_up -->
<g id="edge609" class="edge">
<title>layer2_route_expert4&#45;&gt;layer2_expert4_up</title>
<path fill="none" stroke="black" d="M18793.27,-4893.69C18793.27,-4893.69 18793.27,-4818.01 18793.27,-4818.01"/>
<polygon fill="black" stroke="black" points="18796.77,-4818.01 18793.27,-4808.01 18789.77,-4818.01 18796.77,-4818.01"/>
</g>
<!-- layer2_expert4_activation -->
<g id="node470" class="node">
<title>layer2_expert4_activation</title>
<polygon fill="lightyellow" stroke="black" points="19021.27,-4653.83 18739.27,-4653.83 18739.27,-4585.83 19021.27,-4585.83 19021.27,-4653.83"/>
<text text-anchor="middle" x="18880.27" y="-4638.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="18880.27" y="-4623.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="18880.27" y="-4608.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="18880.27" y="-4593.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_expert4_up&#45;&gt;layer2_expert4_activation -->
<g id="edge610" class="edge">
<title>layer2_expert4_up&#45;&gt;layer2_expert4_activation</title>
<path fill="none" stroke="black" d="M18836.77,-4739.65C18836.77,-4739.65 18836.77,-4663.91 18836.77,-4663.91"/>
<polygon fill="black" stroke="black" points="18840.27,-4663.91 18836.77,-4653.91 18833.27,-4663.91 18840.27,-4663.91"/>
</g>
<!-- layer2_expert4_down -->
<g id="node471" class="node">
<title>layer2_expert4_down</title>
<polygon fill="lightcoral" stroke="black" points="19060.77,-4499.83 18787.77,-4499.83 18787.77,-4431.83 19060.77,-4431.83 19060.77,-4499.83"/>
<text text-anchor="middle" x="18924.27" y="-4484.63" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="18924.27" y="-4469.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="18924.27" y="-4454.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="18924.27" y="-4439.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_expert4_activation&#45;&gt;layer2_expert4_down -->
<g id="edge611" class="edge">
<title>layer2_expert4_activation&#45;&gt;layer2_expert4_down</title>
<path fill="none" stroke="black" d="M18904.52,-4585.65C18904.52,-4585.65 18904.52,-4509.91 18904.52,-4509.91"/>
<polygon fill="black" stroke="black" points="18908.02,-4509.91 18904.52,-4499.91 18901.02,-4509.91 18908.02,-4509.91"/>
</g>
<!-- layer2_route_back_expert4 -->
<g id="node472" class="node">
<title>layer2_route_back_expert4</title>
<polygon fill="lightpink" stroke="black" points="19461.3,-4345.83 18642,-4345.83 18431.23,-4209.83 19250.54,-4209.83 19461.3,-4345.83"/>
<text text-anchor="middle" x="18946.27" y="-4296.63" font-family="Times,serif" font-size="14.00">Route Back Expert 4</text>
<text text-anchor="middle" x="18946.27" y="-4281.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="18946.27" y="-4266.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18946.27" y="-4251.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_expert4_down&#45;&gt;layer2_route_back_expert4 -->
<g id="edge612" class="edge">
<title>layer2_expert4_down&#45;&gt;layer2_route_back_expert4</title>
<path fill="none" stroke="black" d="M18924.27,-4431.79C18924.27,-4431.79 18924.27,-4355.89 18924.27,-4355.89"/>
<polygon fill="black" stroke="black" points="18927.77,-4355.89 18924.27,-4345.89 18920.77,-4355.89 18927.77,-4355.89"/>
</g>
<!-- layer2_route_back_expert4&#45;&gt;layer2_expert_agg -->
<g id="edge683" class="edge">
<title>layer2_route_back_expert4&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M18946.27,-4209.79C18946.27,-4142.34 18946.27,-4049 18946.27,-4049 18946.27,-4049 11625.39,-4049 11625.39,-4049"/>
<polygon fill="black" stroke="black" points="11625.39,-4045.5 11615.39,-4049 11625.39,-4052.5 11625.39,-4045.5"/>
</g>
<!-- layer2_expert5_up -->
<g id="node474" class="node">
<title>layer2_expert5_up</title>
<polygon fill="lightcoral" stroke="black" points="20001.27,-4807.83 19719.27,-4807.83 19719.27,-4739.83 20001.27,-4739.83 20001.27,-4807.83"/>
<text text-anchor="middle" x="19860.27" y="-4792.63" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="19860.27" y="-4777.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="19860.27" y="-4762.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="19860.27" y="-4747.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_route_expert5&#45;&gt;layer2_expert5_up -->
<g id="edge615" class="edge">
<title>layer2_route_expert5&#45;&gt;layer2_expert5_up</title>
<path fill="none" stroke="black" d="M19860.27,-4893.69C19860.27,-4893.69 19860.27,-4818.01 19860.27,-4818.01"/>
<polygon fill="black" stroke="black" points="19863.77,-4818.01 19860.27,-4808.01 19856.77,-4818.01 19863.77,-4818.01"/>
</g>
<!-- layer2_expert5_activation -->
<g id="node475" class="node">
<title>layer2_expert5_activation</title>
<polygon fill="lightyellow" stroke="black" points="20101.27,-4653.83 19819.27,-4653.83 19819.27,-4585.83 20101.27,-4585.83 20101.27,-4653.83"/>
<text text-anchor="middle" x="19960.27" y="-4638.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="19960.27" y="-4623.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="19960.27" y="-4608.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="19960.27" y="-4593.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_expert5_up&#45;&gt;layer2_expert5_activation -->
<g id="edge616" class="edge">
<title>layer2_expert5_up&#45;&gt;layer2_expert5_activation</title>
<path fill="none" stroke="black" d="M19910.27,-4739.65C19910.27,-4739.65 19910.27,-4663.91 19910.27,-4663.91"/>
<polygon fill="black" stroke="black" points="19913.77,-4663.91 19910.27,-4653.91 19906.77,-4663.91 19913.77,-4663.91"/>
</g>
<!-- layer2_expert5_down -->
<g id="node476" class="node">
<title>layer2_expert5_down</title>
<polygon fill="lightcoral" stroke="black" points="20146.77,-4499.83 19873.77,-4499.83 19873.77,-4431.83 20146.77,-4431.83 20146.77,-4499.83"/>
<text text-anchor="middle" x="20010.27" y="-4484.63" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="20010.27" y="-4469.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="20010.27" y="-4454.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="20010.27" y="-4439.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_expert5_activation&#45;&gt;layer2_expert5_down -->
<g id="edge617" class="edge">
<title>layer2_expert5_activation&#45;&gt;layer2_expert5_down</title>
<path fill="none" stroke="black" d="M19987.52,-4585.65C19987.52,-4585.65 19987.52,-4509.91 19987.52,-4509.91"/>
<polygon fill="black" stroke="black" points="19991.02,-4509.91 19987.52,-4499.91 19984.02,-4509.91 19991.02,-4509.91"/>
</g>
<!-- layer2_route_back_expert5 -->
<g id="node477" class="node">
<title>layer2_route_back_expert5</title>
<polygon fill="lightpink" stroke="black" points="20550.3,-4345.83 19731,-4345.83 19520.23,-4209.83 20339.54,-4209.83 20550.3,-4345.83"/>
<text text-anchor="middle" x="20035.27" y="-4296.63" font-family="Times,serif" font-size="14.00">Route Back Expert 5</text>
<text text-anchor="middle" x="20035.27" y="-4281.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="20035.27" y="-4266.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="20035.27" y="-4251.63" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer2_expert5_down&#45;&gt;layer2_route_back_expert5 -->
<g id="edge618" class="edge">
<title>layer2_expert5_down&#45;&gt;layer2_route_back_expert5</title>
<path fill="none" stroke="black" d="M20010.27,-4431.79C20010.27,-4431.79 20010.27,-4355.89 20010.27,-4355.89"/>
<polygon fill="black" stroke="black" points="20013.77,-4355.89 20010.27,-4345.89 20006.77,-4355.89 20013.77,-4355.89"/>
</g>
<!-- layer2_route_back_expert5&#45;&gt;layer2_expert_agg -->
<g id="edge684" class="edge">
<title>layer2_route_back_expert5&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M20035.27,-4209.75C20035.27,-4138.84 20035.27,-4038 20035.27,-4038 20035.27,-4038 11551.07,-4038 11551.07,-4038"/>
<polygon fill="black" stroke="black" points="11551.07,-4034.5 11541.07,-4038 11551.07,-4041.5 11551.07,-4034.5"/>
</g>
<!-- layer2_expert6_up -->
<g id="node479" class="node">
<title>layer2_expert6_up</title>
<polygon fill="lightcoral" stroke="black" points="3929.27,-4807.83 3647.27,-4807.83 3647.27,-4739.83 3929.27,-4739.83 3929.27,-4807.83"/>
<text text-anchor="middle" x="3788.27" y="-4792.63" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="3788.27" y="-4777.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="3788.27" y="-4762.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="3788.27" y="-4747.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_route_expert6&#45;&gt;layer2_expert6_up -->
<g id="edge621" class="edge">
<title>layer2_route_expert6&#45;&gt;layer2_expert6_up</title>
<path fill="none" stroke="black" d="M3788.27,-4893.69C3788.27,-4893.69 3788.27,-4818.01 3788.27,-4818.01"/>
<polygon fill="black" stroke="black" points="3791.77,-4818.01 3788.27,-4808.01 3784.77,-4818.01 3791.77,-4818.01"/>
</g>
<!-- layer2_expert6_activation -->
<g id="node480" class="node">
<title>layer2_expert6_activation</title>
<polygon fill="lightyellow" stroke="black" points="3907.27,-4653.83 3625.27,-4653.83 3625.27,-4585.83 3907.27,-4585.83 3907.27,-4653.83"/>
<text text-anchor="middle" x="3766.27" y="-4638.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3766.27" y="-4623.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="3766.27" y="-4608.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="3766.27" y="-4593.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_expert6_up&#45;&gt;layer2_expert6_activation -->
<g id="edge622" class="edge">
<title>layer2_expert6_up&#45;&gt;layer2_expert6_activation</title>
<path fill="none" stroke="black" d="M3777.27,-4739.65C3777.27,-4739.65 3777.27,-4663.91 3777.27,-4663.91"/>
<polygon fill="black" stroke="black" points="3780.77,-4663.91 3777.27,-4653.91 3773.77,-4663.91 3780.77,-4663.91"/>
</g>
<!-- layer2_expert6_down -->
<g id="node481" class="node">
<title>layer2_expert6_down</title>
<polygon fill="lightcoral" stroke="black" points="3880.77,-4499.83 3607.77,-4499.83 3607.77,-4431.83 3880.77,-4431.83 3880.77,-4499.83"/>
<text text-anchor="middle" x="3744.27" y="-4484.63" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="3744.27" y="-4469.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="3744.27" y="-4454.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="3744.27" y="-4439.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_expert6_activation&#45;&gt;layer2_expert6_down -->
<g id="edge623" class="edge">
<title>layer2_expert6_activation&#45;&gt;layer2_expert6_down</title>
<path fill="none" stroke="black" d="M3753.02,-4585.65C3753.02,-4585.65 3753.02,-4509.91 3753.02,-4509.91"/>
<polygon fill="black" stroke="black" points="3756.52,-4509.91 3753.02,-4499.91 3749.52,-4509.91 3756.52,-4509.91"/>
</g>
<!-- layer2_route_back_expert6 -->
<g id="node482" class="node">
<title>layer2_route_back_expert6</title>
<polygon fill="lightpink" stroke="black" points="4215.3,-4345.83 3396,-4345.83 3185.23,-4209.83 4004.54,-4209.83 4215.3,-4345.83"/>
<text text-anchor="middle" x="3700.27" y="-4296.63" font-family="Times,serif" font-size="14.00">Route Back Expert 6</text>
<text text-anchor="middle" x="3700.27" y="-4281.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="3700.27" y="-4266.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3700.27" y="-4251.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_expert6_down&#45;&gt;layer2_route_back_expert6 -->
<g id="edge624" class="edge">
<title>layer2_expert6_down&#45;&gt;layer2_route_back_expert6</title>
<path fill="none" stroke="black" d="M3744.27,-4431.79C3744.27,-4431.79 3744.27,-4355.89 3744.27,-4355.89"/>
<polygon fill="black" stroke="black" points="3747.77,-4355.89 3744.27,-4345.89 3740.77,-4355.89 3747.77,-4355.89"/>
</g>
<!-- layer2_route_back_expert6&#45;&gt;layer2_expert_agg -->
<g id="edge685" class="edge">
<title>layer2_route_back_expert6&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M4051.65,-4240.04C4051.65,-4175.05 4051.65,-4049 4051.65,-4049 4051.65,-4049 11021.19,-4049 11021.19,-4049"/>
<polygon fill="black" stroke="black" points="11021.19,-4052.5 11031.19,-4049 11021.19,-4045.5 11021.19,-4052.5"/>
</g>
<!-- layer2_expert7_up -->
<g id="node484" class="node">
<title>layer2_expert7_up</title>
<polygon fill="lightcoral" stroke="black" points="5043.27,-4807.83 4761.27,-4807.83 4761.27,-4739.83 5043.27,-4739.83 5043.27,-4807.83"/>
<text text-anchor="middle" x="4902.27" y="-4792.63" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="4902.27" y="-4777.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="4902.27" y="-4762.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="4902.27" y="-4747.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_route_expert7&#45;&gt;layer2_expert7_up -->
<g id="edge627" class="edge">
<title>layer2_route_expert7&#45;&gt;layer2_expert7_up</title>
<path fill="none" stroke="black" d="M4902.27,-4893.69C4902.27,-4893.69 4902.27,-4818.01 4902.27,-4818.01"/>
<polygon fill="black" stroke="black" points="4905.77,-4818.01 4902.27,-4808.01 4898.77,-4818.01 4905.77,-4818.01"/>
</g>
<!-- layer2_expert7_activation -->
<g id="node485" class="node">
<title>layer2_expert7_activation</title>
<polygon fill="lightyellow" stroke="black" points="5024.27,-4653.83 4742.27,-4653.83 4742.27,-4585.83 5024.27,-4585.83 5024.27,-4653.83"/>
<text text-anchor="middle" x="4883.27" y="-4638.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="4883.27" y="-4623.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="4883.27" y="-4608.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="4883.27" y="-4593.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_expert7_up&#45;&gt;layer2_expert7_activation -->
<g id="edge628" class="edge">
<title>layer2_expert7_up&#45;&gt;layer2_expert7_activation</title>
<path fill="none" stroke="black" d="M4892.77,-4739.65C4892.77,-4739.65 4892.77,-4663.91 4892.77,-4663.91"/>
<polygon fill="black" stroke="black" points="4896.27,-4663.91 4892.77,-4653.91 4889.27,-4663.91 4896.27,-4663.91"/>
</g>
<!-- layer2_expert7_down -->
<g id="node486" class="node">
<title>layer2_expert7_down</title>
<polygon fill="lightcoral" stroke="black" points="4944.77,-4499.83 4671.77,-4499.83 4671.77,-4431.83 4944.77,-4431.83 4944.77,-4499.83"/>
<text text-anchor="middle" x="4808.27" y="-4484.63" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="4808.27" y="-4469.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="4808.27" y="-4454.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="4808.27" y="-4439.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_expert7_activation&#45;&gt;layer2_expert7_down -->
<g id="edge629" class="edge">
<title>layer2_expert7_activation&#45;&gt;layer2_expert7_down</title>
<path fill="none" stroke="black" d="M4843.52,-4585.65C4843.52,-4585.65 4843.52,-4509.91 4843.52,-4509.91"/>
<polygon fill="black" stroke="black" points="4847.02,-4509.91 4843.52,-4499.91 4840.02,-4509.91 4847.02,-4509.91"/>
</g>
<!-- layer2_route_back_expert7 -->
<g id="node487" class="node">
<title>layer2_route_back_expert7</title>
<polygon fill="lightpink" stroke="black" points="5304.3,-4345.83 4485,-4345.83 4274.23,-4209.83 5093.54,-4209.83 5304.3,-4345.83"/>
<text text-anchor="middle" x="4789.27" y="-4296.63" font-family="Times,serif" font-size="14.00">Route Back Expert 7</text>
<text text-anchor="middle" x="4789.27" y="-4281.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="4789.27" y="-4266.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4789.27" y="-4251.63" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer2_expert7_down&#45;&gt;layer2_route_back_expert7 -->
<g id="edge630" class="edge">
<title>layer2_expert7_down&#45;&gt;layer2_route_back_expert7</title>
<path fill="none" stroke="black" d="M4808.27,-4431.79C4808.27,-4431.79 4808.27,-4355.89 4808.27,-4355.89"/>
<polygon fill="black" stroke="black" points="4811.77,-4355.89 4808.27,-4345.89 4804.77,-4355.89 4811.77,-4355.89"/>
</g>
<!-- layer2_route_back_expert7&#45;&gt;layer2_expert_agg -->
<g id="edge686" class="edge">
<title>layer2_route_back_expert7&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M5293.65,-4277.67C5293.65,-4271.05 5293.65,-4059 5293.65,-4059 5293.65,-4059 10983.73,-4059 10983.73,-4059"/>
<polygon fill="black" stroke="black" points="10983.73,-4062.5 10993.73,-4059 10983.73,-4055.5 10983.73,-4062.5"/>
</g>
<!-- layer2_expert8_up -->
<g id="node489" class="node">
<title>layer2_expert8_up</title>
<polygon fill="lightcoral" stroke="black" points="6082.27,-4807.83 5800.27,-4807.83 5800.27,-4739.83 6082.27,-4739.83 6082.27,-4807.83"/>
<text text-anchor="middle" x="5941.27" y="-4792.63" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="5941.27" y="-4777.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="5941.27" y="-4762.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="5941.27" y="-4747.63" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_route_expert8&#45;&gt;layer2_expert8_up -->
<g id="edge633" class="edge">
<title>layer2_route_expert8&#45;&gt;layer2_expert8_up</title>
<path fill="none" stroke="black" d="M5941.27,-4893.69C5941.27,-4893.69 5941.27,-4818.01 5941.27,-4818.01"/>
<polygon fill="black" stroke="black" points="5944.77,-4818.01 5941.27,-4808.01 5937.77,-4818.01 5944.77,-4818.01"/>
</g>
<!-- layer2_expert8_activation -->
<g id="node490" class="node">
<title>layer2_expert8_activation</title>
<polygon fill="lightyellow" stroke="black" points="6066.27,-4653.83 5784.27,-4653.83 5784.27,-4585.83 6066.27,-4585.83 6066.27,-4653.83"/>
<text text-anchor="middle" x="5925.27" y="-4638.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="5925.27" y="-4623.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="5925.27" y="-4608.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="5925.27" y="-4593.63" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_expert8_up&#45;&gt;layer2_expert8_activation -->
<g id="edge634" class="edge">
<title>layer2_expert8_up&#45;&gt;layer2_expert8_activation</title>
<path fill="none" stroke="black" d="M5933.27,-4739.65C5933.27,-4739.65 5933.27,-4663.91 5933.27,-4663.91"/>
<polygon fill="black" stroke="black" points="5936.77,-4663.91 5933.27,-4653.91 5929.77,-4663.91 5936.77,-4663.91"/>
</g>
<!-- layer2_expert8_down -->
<g id="node491" class="node">
<title>layer2_expert8_down</title>
<polygon fill="lightcoral" stroke="black" points="6045.77,-4499.83 5772.77,-4499.83 5772.77,-4431.83 6045.77,-4431.83 6045.77,-4499.83"/>
<text text-anchor="middle" x="5909.27" y="-4484.63" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="5909.27" y="-4469.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="5909.27" y="-4454.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="5909.27" y="-4439.63" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_expert8_activation&#45;&gt;layer2_expert8_down -->
<g id="edge635" class="edge">
<title>layer2_expert8_activation&#45;&gt;layer2_expert8_down</title>
<path fill="none" stroke="black" d="M5915.02,-4585.65C5915.02,-4585.65 5915.02,-4509.91 5915.02,-4509.91"/>
<polygon fill="black" stroke="black" points="5918.52,-4509.91 5915.02,-4499.91 5911.52,-4509.91 5918.52,-4509.91"/>
</g>
<!-- layer2_route_back_expert8 -->
<g id="node492" class="node">
<title>layer2_route_back_expert8</title>
<polygon fill="lightpink" stroke="black" points="6393.3,-4345.83 5574,-4345.83 5363.23,-4209.83 6182.54,-4209.83 6393.3,-4345.83"/>
<text text-anchor="middle" x="5878.27" y="-4296.63" font-family="Times,serif" font-size="14.00">Route Back Expert 8</text>
<text text-anchor="middle" x="5878.27" y="-4281.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="5878.27" y="-4266.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5878.27" y="-4251.63" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_expert8_down&#45;&gt;layer2_route_back_expert8 -->
<g id="edge636" class="edge">
<title>layer2_expert8_down&#45;&gt;layer2_route_back_expert8</title>
<path fill="none" stroke="black" d="M5909.27,-4431.79C5909.27,-4431.79 5909.27,-4355.89 5909.27,-4355.89"/>
<polygon fill="black" stroke="black" points="5912.77,-4355.89 5909.27,-4345.89 5905.77,-4355.89 5912.77,-4355.89"/>
</g>
<!-- layer2_route_back_expert8&#45;&gt;layer2_expert_agg -->
<g id="edge687" class="edge">
<title>layer2_route_back_expert8&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M6368.15,-4277.68C6368.15,-4271.39 6368.15,-4070 6368.15,-4070 6368.15,-4070 10964.34,-4070 10964.34,-4070"/>
<polygon fill="black" stroke="black" points="10964.34,-4073.5 10974.34,-4070 10964.34,-4066.5 10964.34,-4073.5"/>
</g>
<!-- layer2_expert9_up -->
<g id="node494" class="node">
<title>layer2_expert9_up</title>
<polygon fill="lightcoral" stroke="black" points="7195.27,-4807.83 6913.27,-4807.83 6913.27,-4739.83 7195.27,-4739.83 7195.27,-4807.83"/>
<text text-anchor="middle" x="7054.27" y="-4792.63" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="7054.27" y="-4777.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="7054.27" y="-4762.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="7054.27" y="-4747.63" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_route_expert9&#45;&gt;layer2_expert9_up -->
<g id="edge639" class="edge">
<title>layer2_route_expert9&#45;&gt;layer2_expert9_up</title>
<path fill="none" stroke="black" d="M7054.27,-4893.69C7054.27,-4893.69 7054.27,-4818.01 7054.27,-4818.01"/>
<polygon fill="black" stroke="black" points="7057.77,-4818.01 7054.27,-4808.01 7050.77,-4818.01 7057.77,-4818.01"/>
</g>
<!-- layer2_expert9_activation -->
<g id="node495" class="node">
<title>layer2_expert9_activation</title>
<polygon fill="lightyellow" stroke="black" points="7183.27,-4653.83 6901.27,-4653.83 6901.27,-4585.83 7183.27,-4585.83 7183.27,-4653.83"/>
<text text-anchor="middle" x="7042.27" y="-4638.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7042.27" y="-4623.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="7042.27" y="-4608.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="7042.27" y="-4593.63" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_expert9_up&#45;&gt;layer2_expert9_activation -->
<g id="edge640" class="edge">
<title>layer2_expert9_up&#45;&gt;layer2_expert9_activation</title>
<path fill="none" stroke="black" d="M7048.27,-4739.65C7048.27,-4739.65 7048.27,-4663.91 7048.27,-4663.91"/>
<polygon fill="black" stroke="black" points="7051.77,-4663.91 7048.27,-4653.91 7044.77,-4663.91 7051.77,-4663.91"/>
</g>
<!-- layer2_expert9_down -->
<g id="node496" class="node">
<title>layer2_expert9_down</title>
<polygon fill="lightcoral" stroke="black" points="7128.77,-4499.83 6855.77,-4499.83 6855.77,-4431.83 7128.77,-4431.83 7128.77,-4499.83"/>
<text text-anchor="middle" x="6992.27" y="-4484.63" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="6992.27" y="-4469.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="6992.27" y="-4454.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="6992.27" y="-4439.63" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_expert9_activation&#45;&gt;layer2_expert9_down -->
<g id="edge641" class="edge">
<title>layer2_expert9_activation&#45;&gt;layer2_expert9_down</title>
<path fill="none" stroke="black" d="M7015.02,-4585.65C7015.02,-4585.65 7015.02,-4509.91 7015.02,-4509.91"/>
<polygon fill="black" stroke="black" points="7018.52,-4509.91 7015.02,-4499.91 7011.52,-4509.91 7018.52,-4509.91"/>
</g>
<!-- layer2_route_back_expert9 -->
<g id="node497" class="node">
<title>layer2_route_back_expert9</title>
<polygon fill="lightpink" stroke="black" points="7482.3,-4345.83 6663,-4345.83 6452.23,-4209.83 7271.54,-4209.83 7482.3,-4345.83"/>
<text text-anchor="middle" x="6967.27" y="-4296.63" font-family="Times,serif" font-size="14.00">Route Back Expert 9</text>
<text text-anchor="middle" x="6967.27" y="-4281.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="6967.27" y="-4266.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6967.27" y="-4251.63" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer2_expert9_down&#45;&gt;layer2_route_back_expert9 -->
<g id="edge642" class="edge">
<title>layer2_expert9_down&#45;&gt;layer2_route_back_expert9</title>
<path fill="none" stroke="black" d="M6992.27,-4431.79C6992.27,-4431.79 6992.27,-4355.89 6992.27,-4355.89"/>
<polygon fill="black" stroke="black" points="6995.77,-4355.89 6992.27,-4345.89 6988.77,-4355.89 6995.77,-4355.89"/>
</g>
<!-- layer2_route_back_expert9&#45;&gt;layer2_expert_agg -->
<g id="edge688" class="edge">
<title>layer2_route_back_expert9&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M7023.25,-4209.82C7023.25,-4152.92 7023.25,-4081 7023.25,-4081 7023.25,-4081 10963.66,-4081 10963.66,-4081"/>
<polygon fill="black" stroke="black" points="10963.66,-4084.5 10973.66,-4081 10963.66,-4077.5 10963.66,-4084.5"/>
</g>
<!-- layer2_expert10_up -->
<g id="node499" class="node">
<title>layer2_expert10_up</title>
<polygon fill="lightcoral" stroke="black" points="8235.27,-4807.83 7953.27,-4807.83 7953.27,-4739.83 8235.27,-4739.83 8235.27,-4807.83"/>
<text text-anchor="middle" x="8094.27" y="-4792.63" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="8094.27" y="-4777.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="8094.27" y="-4762.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="8094.27" y="-4747.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_route_expert10&#45;&gt;layer2_expert10_up -->
<g id="edge645" class="edge">
<title>layer2_route_expert10&#45;&gt;layer2_expert10_up</title>
<path fill="none" stroke="black" d="M8094.27,-4893.69C8094.27,-4893.69 8094.27,-4818.01 8094.27,-4818.01"/>
<polygon fill="black" stroke="black" points="8097.77,-4818.01 8094.27,-4808.01 8090.77,-4818.01 8097.77,-4818.01"/>
</g>
<!-- layer2_expert10_activation -->
<g id="node500" class="node">
<title>layer2_expert10_activation</title>
<polygon fill="lightyellow" stroke="black" points="8226.27,-4653.83 7944.27,-4653.83 7944.27,-4585.83 8226.27,-4585.83 8226.27,-4653.83"/>
<text text-anchor="middle" x="8085.27" y="-4638.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="8085.27" y="-4623.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="8085.27" y="-4608.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="8085.27" y="-4593.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_expert10_up&#45;&gt;layer2_expert10_activation -->
<g id="edge646" class="edge">
<title>layer2_expert10_up&#45;&gt;layer2_expert10_activation</title>
<path fill="none" stroke="black" d="M8089.77,-4739.65C8089.77,-4739.65 8089.77,-4663.91 8089.77,-4663.91"/>
<polygon fill="black" stroke="black" points="8093.27,-4663.91 8089.77,-4653.91 8086.27,-4663.91 8093.27,-4663.91"/>
</g>
<!-- layer2_expert10_down -->
<g id="node501" class="node">
<title>layer2_expert10_down</title>
<polygon fill="lightcoral" stroke="black" points="8211.77,-4499.83 7938.77,-4499.83 7938.77,-4431.83 8211.77,-4431.83 8211.77,-4499.83"/>
<text text-anchor="middle" x="8075.27" y="-4484.63" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="8075.27" y="-4469.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="8075.27" y="-4454.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="8075.27" y="-4439.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_expert10_activation&#45;&gt;layer2_expert10_down -->
<g id="edge647" class="edge">
<title>layer2_expert10_activation&#45;&gt;layer2_expert10_down</title>
<path fill="none" stroke="black" d="M8078.02,-4585.65C8078.02,-4585.65 8078.02,-4509.91 8078.02,-4509.91"/>
<polygon fill="black" stroke="black" points="8081.52,-4509.91 8078.02,-4499.91 8074.52,-4509.91 8081.52,-4509.91"/>
</g>
<!-- layer2_route_back_expert10 -->
<g id="node502" class="node">
<title>layer2_route_back_expert10</title>
<polygon fill="lightpink" stroke="black" points="8571.3,-4345.83 7752,-4345.83 7541.23,-4209.83 8360.54,-4209.83 8571.3,-4345.83"/>
<text text-anchor="middle" x="8056.27" y="-4296.63" font-family="Times,serif" font-size="14.00">Route Back Expert 10</text>
<text text-anchor="middle" x="8056.27" y="-4281.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="8056.27" y="-4266.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8056.27" y="-4251.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_expert10_down&#45;&gt;layer2_route_back_expert10 -->
<g id="edge648" class="edge">
<title>layer2_expert10_down&#45;&gt;layer2_route_back_expert10</title>
<path fill="none" stroke="black" d="M8075.27,-4431.79C8075.27,-4431.79 8075.27,-4355.89 8075.27,-4355.89"/>
<polygon fill="black" stroke="black" points="8078.77,-4355.89 8075.27,-4345.89 8071.77,-4355.89 8078.77,-4355.89"/>
</g>
<!-- layer2_route_back_expert10&#45;&gt;layer2_expert_agg -->
<g id="edge689" class="edge">
<title>layer2_route_back_expert10&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M8429.69,-4254.17C8429.69,-4203.9 8429.69,-4091 8429.69,-4091 8429.69,-4091 10979.92,-4091 10979.92,-4091"/>
<polygon fill="black" stroke="black" points="10979.92,-4094.5 10989.92,-4091 10979.92,-4087.5 10979.92,-4094.5"/>
</g>
<!-- layer2_expert11_up -->
<g id="node504" class="node">
<title>layer2_expert11_up</title>
<polygon fill="lightcoral" stroke="black" points="9311.27,-4807.83 9029.27,-4807.83 9029.27,-4739.83 9311.27,-4739.83 9311.27,-4807.83"/>
<text text-anchor="middle" x="9170.27" y="-4792.63" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="9170.27" y="-4777.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="9170.27" y="-4762.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="9170.27" y="-4747.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_route_expert11&#45;&gt;layer2_expert11_up -->
<g id="edge651" class="edge">
<title>layer2_route_expert11&#45;&gt;layer2_expert11_up</title>
<path fill="none" stroke="black" d="M9170.27,-4893.69C9170.27,-4893.69 9170.27,-4818.01 9170.27,-4818.01"/>
<polygon fill="black" stroke="black" points="9173.77,-4818.01 9170.27,-4808.01 9166.77,-4818.01 9173.77,-4818.01"/>
</g>
<!-- layer2_expert11_activation -->
<g id="node505" class="node">
<title>layer2_expert11_activation</title>
<polygon fill="lightyellow" stroke="black" points="9305.27,-4653.83 9023.27,-4653.83 9023.27,-4585.83 9305.27,-4585.83 9305.27,-4653.83"/>
<text text-anchor="middle" x="9164.27" y="-4638.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="9164.27" y="-4623.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="9164.27" y="-4608.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="9164.27" y="-4593.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_expert11_up&#45;&gt;layer2_expert11_activation -->
<g id="edge652" class="edge">
<title>layer2_expert11_up&#45;&gt;layer2_expert11_activation</title>
<path fill="none" stroke="black" d="M9167.27,-4739.65C9167.27,-4739.65 9167.27,-4663.91 9167.27,-4663.91"/>
<polygon fill="black" stroke="black" points="9170.77,-4663.91 9167.27,-4653.91 9163.77,-4663.91 9170.77,-4663.91"/>
</g>
<!-- layer2_expert11_down -->
<g id="node506" class="node">
<title>layer2_expert11_down</title>
<polygon fill="lightcoral" stroke="black" points="9293.77,-4499.83 9020.77,-4499.83 9020.77,-4431.83 9293.77,-4431.83 9293.77,-4499.83"/>
<text text-anchor="middle" x="9157.27" y="-4484.63" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="9157.27" y="-4469.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="9157.27" y="-4454.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="9157.27" y="-4439.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_expert11_activation&#45;&gt;layer2_expert11_down -->
<g id="edge653" class="edge">
<title>layer2_expert11_activation&#45;&gt;layer2_expert11_down</title>
<path fill="none" stroke="black" d="M9158.52,-4585.65C9158.52,-4585.65 9158.52,-4509.91 9158.52,-4509.91"/>
<polygon fill="black" stroke="black" points="9162.02,-4509.91 9158.52,-4499.91 9155.02,-4509.91 9162.02,-4509.91"/>
</g>
<!-- layer2_route_back_expert11 -->
<g id="node507" class="node">
<title>layer2_route_back_expert11</title>
<polygon fill="lightpink" stroke="black" points="9660.3,-4345.83 8841,-4345.83 8630.23,-4209.83 9449.54,-4209.83 9660.3,-4345.83"/>
<text text-anchor="middle" x="9145.27" y="-4296.63" font-family="Times,serif" font-size="14.00">Route Back Expert 11</text>
<text text-anchor="middle" x="9145.27" y="-4281.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="9145.27" y="-4266.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9145.27" y="-4251.63" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer2_expert11_down&#45;&gt;layer2_route_back_expert11 -->
<g id="edge654" class="edge">
<title>layer2_expert11_down&#45;&gt;layer2_route_back_expert11</title>
<path fill="none" stroke="black" d="M9157.27,-4431.79C9157.27,-4431.79 9157.27,-4355.89 9157.27,-4355.89"/>
<polygon fill="black" stroke="black" points="9160.77,-4355.89 9157.27,-4345.89 9153.77,-4355.89 9160.77,-4355.89"/>
</g>
<!-- layer2_route_back_expert11&#45;&gt;layer2_expert_agg -->
<g id="edge690" class="edge">
<title>layer2_route_back_expert11&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M9350.69,-4209.6C9350.69,-4160.17 9350.69,-4102 9350.69,-4102 9350.69,-4102 11018.75,-4102 11018.75,-4102"/>
<polygon fill="black" stroke="black" points="11018.75,-4105.5 11028.75,-4102 11018.75,-4098.5 11018.75,-4105.5"/>
</g>
<!-- layer2_expert12_up -->
<g id="node509" class="node">
<title>layer2_expert12_up</title>
<polygon fill="lightcoral" stroke="black" points="10397.27,-4807.83 10115.27,-4807.83 10115.27,-4739.83 10397.27,-4739.83 10397.27,-4807.83"/>
<text text-anchor="middle" x="10256.27" y="-4792.63" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="10256.27" y="-4777.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="10256.27" y="-4762.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="10256.27" y="-4747.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_route_expert12&#45;&gt;layer2_expert12_up -->
<g id="edge657" class="edge">
<title>layer2_route_expert12&#45;&gt;layer2_expert12_up</title>
<path fill="none" stroke="black" d="M10256.27,-4893.69C10256.27,-4893.69 10256.27,-4818.01 10256.27,-4818.01"/>
<polygon fill="black" stroke="black" points="10259.77,-4818.01 10256.27,-4808.01 10252.77,-4818.01 10259.77,-4818.01"/>
</g>
<!-- layer2_expert12_activation -->
<g id="node510" class="node">
<title>layer2_expert12_activation</title>
<polygon fill="lightyellow" stroke="black" points="10391.27,-4653.83 10109.27,-4653.83 10109.27,-4585.83 10391.27,-4585.83 10391.27,-4653.83"/>
<text text-anchor="middle" x="10250.27" y="-4638.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="10250.27" y="-4623.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="10250.27" y="-4608.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="10250.27" y="-4593.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_expert12_up&#45;&gt;layer2_expert12_activation -->
<g id="edge658" class="edge">
<title>layer2_expert12_up&#45;&gt;layer2_expert12_activation</title>
<path fill="none" stroke="black" d="M10253.27,-4739.65C10253.27,-4739.65 10253.27,-4663.91 10253.27,-4663.91"/>
<polygon fill="black" stroke="black" points="10256.77,-4663.91 10253.27,-4653.91 10249.77,-4663.91 10256.77,-4663.91"/>
</g>
<!-- layer2_expert12_down -->
<g id="node511" class="node">
<title>layer2_expert12_down</title>
<polygon fill="lightcoral" stroke="black" points="10374.77,-4499.83 10101.77,-4499.83 10101.77,-4431.83 10374.77,-4431.83 10374.77,-4499.83"/>
<text text-anchor="middle" x="10238.27" y="-4484.63" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="10238.27" y="-4469.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="10238.27" y="-4454.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="10238.27" y="-4439.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_expert12_activation&#45;&gt;layer2_expert12_down -->
<g id="edge659" class="edge">
<title>layer2_expert12_activation&#45;&gt;layer2_expert12_down</title>
<path fill="none" stroke="black" d="M10242.02,-4585.65C10242.02,-4585.65 10242.02,-4509.91 10242.02,-4509.91"/>
<polygon fill="black" stroke="black" points="10245.52,-4509.91 10242.02,-4499.91 10238.52,-4509.91 10245.52,-4509.91"/>
</g>
<!-- layer2_route_back_expert12 -->
<g id="node512" class="node">
<title>layer2_route_back_expert12</title>
<polygon fill="lightpink" stroke="black" points="10749.3,-4345.83 9930,-4345.83 9719.23,-4209.83 10538.54,-4209.83 10749.3,-4345.83"/>
<text text-anchor="middle" x="10234.27" y="-4296.63" font-family="Times,serif" font-size="14.00">Route Back Expert 12</text>
<text text-anchor="middle" x="10234.27" y="-4281.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="10234.27" y="-4266.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10234.27" y="-4251.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_expert12_down&#45;&gt;layer2_route_back_expert12 -->
<g id="edge660" class="edge">
<title>layer2_expert12_down&#45;&gt;layer2_route_back_expert12</title>
<path fill="none" stroke="black" d="M10238.27,-4431.79C10238.27,-4431.79 10238.27,-4355.89 10238.27,-4355.89"/>
<polygon fill="black" stroke="black" points="10241.77,-4355.89 10238.27,-4345.89 10234.77,-4355.89 10241.77,-4355.89"/>
</g>
<!-- layer2_route_back_expert12&#45;&gt;layer2_expert_agg -->
<g id="edge691" class="edge">
<title>layer2_route_back_expert12&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M10641.15,-4275.98C10641.15,-4257.87 10641.15,-4113 10641.15,-4113 10641.15,-4113 11090.86,-4113 11090.86,-4113"/>
<polygon fill="black" stroke="black" points="11090.86,-4116.5 11100.86,-4113 11090.86,-4109.5 11090.86,-4116.5"/>
</g>
<!-- layer2_expert13_up -->
<g id="node514" class="node">
<title>layer2_expert13_up</title>
<polygon fill="lightcoral" stroke="black" points="11464.27,-4807.83 11182.27,-4807.83 11182.27,-4739.83 11464.27,-4739.83 11464.27,-4807.83"/>
<text text-anchor="middle" x="11323.27" y="-4792.63" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="11323.27" y="-4777.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="11323.27" y="-4762.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="11323.27" y="-4747.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_route_expert13&#45;&gt;layer2_expert13_up -->
<g id="edge663" class="edge">
<title>layer2_route_expert13&#45;&gt;layer2_expert13_up</title>
<path fill="none" stroke="black" d="M11323.27,-4893.69C11323.27,-4893.69 11323.27,-4818.01 11323.27,-4818.01"/>
<polygon fill="black" stroke="black" points="11326.77,-4818.01 11323.27,-4808.01 11319.77,-4818.01 11326.77,-4818.01"/>
</g>
<!-- layer2_expert13_activation -->
<g id="node515" class="node">
<title>layer2_expert13_activation</title>
<polygon fill="lightyellow" stroke="black" points="11464.27,-4653.83 11182.27,-4653.83 11182.27,-4585.83 11464.27,-4585.83 11464.27,-4653.83"/>
<text text-anchor="middle" x="11323.27" y="-4638.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="11323.27" y="-4623.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="11323.27" y="-4608.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="11323.27" y="-4593.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_expert13_up&#45;&gt;layer2_expert13_activation -->
<g id="edge664" class="edge">
<title>layer2_expert13_up&#45;&gt;layer2_expert13_activation</title>
<path fill="none" stroke="black" d="M11323.27,-4739.65C11323.27,-4739.65 11323.27,-4663.91 11323.27,-4663.91"/>
<polygon fill="black" stroke="black" points="11326.77,-4663.91 11323.27,-4653.91 11319.77,-4663.91 11326.77,-4663.91"/>
</g>
<!-- layer2_expert13_down -->
<g id="node516" class="node">
<title>layer2_expert13_down</title>
<polygon fill="lightcoral" stroke="black" points="11459.77,-4499.83 11186.77,-4499.83 11186.77,-4431.83 11459.77,-4431.83 11459.77,-4499.83"/>
<text text-anchor="middle" x="11323.27" y="-4484.63" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="11323.27" y="-4469.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="11323.27" y="-4454.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="11323.27" y="-4439.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_expert13_activation&#45;&gt;layer2_expert13_down -->
<g id="edge665" class="edge">
<title>layer2_expert13_activation&#45;&gt;layer2_expert13_down</title>
<path fill="none" stroke="black" d="M11323.27,-4585.65C11323.27,-4585.65 11323.27,-4509.91 11323.27,-4509.91"/>
<polygon fill="black" stroke="black" points="11326.77,-4509.91 11323.27,-4499.91 11319.77,-4509.91 11326.77,-4509.91"/>
</g>
<!-- layer2_route_back_expert13 -->
<g id="node517" class="node">
<title>layer2_route_back_expert13</title>
<polygon fill="lightpink" stroke="black" points="11838.3,-4345.83 11019,-4345.83 10808.23,-4209.83 11627.54,-4209.83 11838.3,-4345.83"/>
<text text-anchor="middle" x="11323.27" y="-4296.63" font-family="Times,serif" font-size="14.00">Route Back Expert 13</text>
<text text-anchor="middle" x="11323.27" y="-4281.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="11323.27" y="-4266.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11323.27" y="-4251.63" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer2_expert13_down&#45;&gt;layer2_route_back_expert13 -->
<g id="edge666" class="edge">
<title>layer2_expert13_down&#45;&gt;layer2_route_back_expert13</title>
<path fill="none" stroke="black" d="M11323.27,-4431.79C11323.27,-4431.79 11323.27,-4355.89 11323.27,-4355.89"/>
<polygon fill="black" stroke="black" points="11326.77,-4355.89 11323.27,-4345.89 11319.77,-4355.89 11326.77,-4355.89"/>
</g>
<!-- layer2_route_back_expert13&#45;&gt;layer2_expert_agg -->
<g id="edge692" class="edge">
<title>layer2_route_back_expert13&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M11323.27,-4209.7C11323.27,-4209.7 11323.27,-4134.13 11323.27,-4134.13"/>
<polygon fill="black" stroke="black" points="11326.77,-4134.13 11323.27,-4124.13 11319.77,-4134.13 11326.77,-4134.13"/>
</g>
<!-- layer2_expert14_up -->
<g id="node519" class="node">
<title>layer2_expert14_up</title>
<polygon fill="lightcoral" stroke="black" points="12531.27,-4807.83 12249.27,-4807.83 12249.27,-4739.83 12531.27,-4739.83 12531.27,-4807.83"/>
<text text-anchor="middle" x="12390.27" y="-4792.63" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="12390.27" y="-4777.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="12390.27" y="-4762.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="12390.27" y="-4747.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_route_expert14&#45;&gt;layer2_expert14_up -->
<g id="edge669" class="edge">
<title>layer2_route_expert14&#45;&gt;layer2_expert14_up</title>
<path fill="none" stroke="black" d="M12390.27,-4893.69C12390.27,-4893.69 12390.27,-4818.01 12390.27,-4818.01"/>
<polygon fill="black" stroke="black" points="12393.77,-4818.01 12390.27,-4808.01 12386.77,-4818.01 12393.77,-4818.01"/>
</g>
<!-- layer2_expert14_activation -->
<g id="node520" class="node">
<title>layer2_expert14_activation</title>
<polygon fill="lightyellow" stroke="black" points="12543.27,-4653.83 12261.27,-4653.83 12261.27,-4585.83 12543.27,-4585.83 12543.27,-4653.83"/>
<text text-anchor="middle" x="12402.27" y="-4638.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="12402.27" y="-4623.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="12402.27" y="-4608.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="12402.27" y="-4593.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_expert14_up&#45;&gt;layer2_expert14_activation -->
<g id="edge670" class="edge">
<title>layer2_expert14_up&#45;&gt;layer2_expert14_activation</title>
<path fill="none" stroke="black" d="M12396.27,-4739.65C12396.27,-4739.65 12396.27,-4663.91 12396.27,-4663.91"/>
<polygon fill="black" stroke="black" points="12399.77,-4663.91 12396.27,-4653.91 12392.77,-4663.91 12399.77,-4663.91"/>
</g>
<!-- layer2_expert14_down -->
<g id="node521" class="node">
<title>layer2_expert14_down</title>
<polygon fill="lightcoral" stroke="black" points="12542.77,-4499.83 12269.77,-4499.83 12269.77,-4431.83 12542.77,-4431.83 12542.77,-4499.83"/>
<text text-anchor="middle" x="12406.27" y="-4484.63" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="12406.27" y="-4469.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="12406.27" y="-4454.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="12406.27" y="-4439.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_expert14_activation&#45;&gt;layer2_expert14_down -->
<g id="edge671" class="edge">
<title>layer2_expert14_activation&#45;&gt;layer2_expert14_down</title>
<path fill="none" stroke="black" d="M12406.27,-4585.65C12406.27,-4585.65 12406.27,-4509.91 12406.27,-4509.91"/>
<polygon fill="black" stroke="black" points="12409.77,-4509.91 12406.27,-4499.91 12402.77,-4509.91 12409.77,-4509.91"/>
</g>
<!-- layer2_route_back_expert14 -->
<g id="node522" class="node">
<title>layer2_route_back_expert14</title>
<polygon fill="lightpink" stroke="black" points="12927.3,-4345.83 12108,-4345.83 11897.23,-4209.83 12716.54,-4209.83 12927.3,-4345.83"/>
<text text-anchor="middle" x="12412.27" y="-4296.63" font-family="Times,serif" font-size="14.00">Route Back Expert 14</text>
<text text-anchor="middle" x="12412.27" y="-4281.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="12412.27" y="-4266.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12412.27" y="-4251.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_expert14_down&#45;&gt;layer2_route_back_expert14 -->
<g id="edge672" class="edge">
<title>layer2_expert14_down&#45;&gt;layer2_route_back_expert14</title>
<path fill="none" stroke="black" d="M12406.27,-4431.79C12406.27,-4431.79 12406.27,-4355.89 12406.27,-4355.89"/>
<polygon fill="black" stroke="black" points="12409.77,-4355.89 12406.27,-4345.89 12402.77,-4355.89 12409.77,-4355.89"/>
</g>
<!-- layer2_route_back_expert14&#45;&gt;layer2_expert_agg -->
<g id="edge693" class="edge">
<title>layer2_route_back_expert14&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M12053.88,-4209.36C12053.88,-4164.07 12053.88,-4113 12053.88,-4113 12053.88,-4113 11555.95,-4113 11555.95,-4113"/>
<polygon fill="black" stroke="black" points="11555.95,-4109.5 11545.95,-4113 11555.95,-4116.5 11555.95,-4109.5"/>
</g>
<!-- layer2_expert15_up -->
<g id="node524" class="node">
<title>layer2_expert15_up</title>
<polygon fill="lightcoral" stroke="black" points="13598.27,-4807.83 13316.27,-4807.83 13316.27,-4739.83 13598.27,-4739.83 13598.27,-4807.83"/>
<text text-anchor="middle" x="13457.27" y="-4792.63" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="13457.27" y="-4777.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="13457.27" y="-4762.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="13457.27" y="-4747.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_route_expert15&#45;&gt;layer2_expert15_up -->
<g id="edge675" class="edge">
<title>layer2_route_expert15&#45;&gt;layer2_expert15_up</title>
<path fill="none" stroke="black" d="M13457.27,-4893.69C13457.27,-4893.69 13457.27,-4818.01 13457.27,-4818.01"/>
<polygon fill="black" stroke="black" points="13460.77,-4818.01 13457.27,-4808.01 13453.77,-4818.01 13460.77,-4818.01"/>
</g>
<!-- layer2_expert15_activation -->
<g id="node525" class="node">
<title>layer2_expert15_activation</title>
<polygon fill="lightyellow" stroke="black" points="13605.27,-4653.83 13323.27,-4653.83 13323.27,-4585.83 13605.27,-4585.83 13605.27,-4653.83"/>
<text text-anchor="middle" x="13464.27" y="-4638.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="13464.27" y="-4623.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="13464.27" y="-4608.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="13464.27" y="-4593.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_expert15_up&#45;&gt;layer2_expert15_activation -->
<g id="edge676" class="edge">
<title>layer2_expert15_up&#45;&gt;layer2_expert15_activation</title>
<path fill="none" stroke="black" d="M13460.77,-4739.65C13460.77,-4739.65 13460.77,-4663.91 13460.77,-4663.91"/>
<polygon fill="black" stroke="black" points="13464.27,-4663.91 13460.77,-4653.91 13457.27,-4663.91 13464.27,-4663.91"/>
</g>
<!-- layer2_expert15_down -->
<g id="node526" class="node">
<title>layer2_expert15_down</title>
<polygon fill="lightcoral" stroke="black" points="13612.77,-4499.83 13339.77,-4499.83 13339.77,-4431.83 13612.77,-4431.83 13612.77,-4499.83"/>
<text text-anchor="middle" x="13476.27" y="-4484.63" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="13476.27" y="-4469.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="13476.27" y="-4454.63" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="13476.27" y="-4439.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_expert15_activation&#45;&gt;layer2_expert15_down -->
<g id="edge677" class="edge">
<title>layer2_expert15_activation&#45;&gt;layer2_expert15_down</title>
<path fill="none" stroke="black" d="M13472.52,-4585.65C13472.52,-4585.65 13472.52,-4509.91 13472.52,-4509.91"/>
<polygon fill="black" stroke="black" points="13476.02,-4509.91 13472.52,-4499.91 13469.02,-4509.91 13476.02,-4509.91"/>
</g>
<!-- layer2_route_back_expert15 -->
<g id="node527" class="node">
<title>layer2_route_back_expert15</title>
<polygon fill="lightpink" stroke="black" points="14016.3,-4345.83 13197,-4345.83 12986.23,-4209.83 13805.54,-4209.83 14016.3,-4345.83"/>
<text text-anchor="middle" x="13501.27" y="-4296.63" font-family="Times,serif" font-size="14.00">Route Back Expert 15</text>
<text text-anchor="middle" x="13501.27" y="-4281.63" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="13501.27" y="-4266.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13501.27" y="-4251.63" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer2_expert15_down&#45;&gt;layer2_route_back_expert15 -->
<g id="edge678" class="edge">
<title>layer2_expert15_down&#45;&gt;layer2_route_back_expert15</title>
<path fill="none" stroke="black" d="M13476.27,-4431.79C13476.27,-4431.79 13476.27,-4355.89 13476.27,-4355.89"/>
<polygon fill="black" stroke="black" points="13479.77,-4355.89 13476.27,-4345.89 13472.77,-4355.89 13479.77,-4355.89"/>
</g>
<!-- layer2_route_back_expert15&#45;&gt;layer2_expert_agg -->
<g id="edge694" class="edge">
<title>layer2_route_back_expert15&#45;&gt;layer2_expert_agg</title>
<path fill="none" stroke="black" d="M13018.38,-4277.7C13018.38,-4272.38 13018.38,-4102 13018.38,-4102 13018.38,-4102 11628.05,-4102 11628.05,-4102"/>
<polygon fill="black" stroke="black" points="11628.05,-4098.5 11618.05,-4102 11628.05,-4105.5 11628.05,-4098.5"/>
</g>
<!-- layer2_expert_agg&#45;&gt;layer2_final_residual -->
<g id="edge696" class="edge">
<title>layer2_expert_agg&#45;&gt;layer2_final_residual</title>
<path fill="none" stroke="black" d="M11105.38,-4038C10322.59,-4038 7698.78,-4038 7698.78,-4038 7698.78,-4038 7698.78,-3935.28 7698.78,-3935.28"/>
<polygon fill="black" stroke="black" points="7702.28,-3935.28 7698.78,-3925.28 7695.28,-3935.28 7702.28,-3935.28"/>
</g>
<!-- layer3_attn_norm_gpu0 -->
<g id="node530" class="node">
<title>layer3_attn_norm_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="10532.77,-3759.5 10035.77,-3759.5 10035.77,-3691.5 10532.77,-3691.5 10532.77,-3759.5"/>
<text text-anchor="middle" x="10284.27" y="-3744.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="10284.27" y="-3729.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10284.27" y="-3714.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10284.27" y="-3699.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer2_final_residual&#45;&gt;layer3_attn_norm_gpu0 -->
<g id="edge697" class="edge">
<title>layer2_final_residual&#45;&gt;layer3_attn_norm_gpu0</title>
<path fill="none" stroke="black" d="M7841.15,-3883C8740.69,-3883 10284.27,-3883 10284.27,-3883 10284.27,-3883 10284.27,-3769.67 10284.27,-3769.67"/>
<polygon fill="black" stroke="black" points="10287.77,-3769.67 10284.27,-3759.67 10280.77,-3769.67 10287.77,-3769.67"/>
</g>
<!-- layer3_attn_norm_gpu1 -->
<g id="node541" class="node">
<title>layer3_attn_norm_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="12210.77,-3759.5 11713.77,-3759.5 11713.77,-3691.5 12210.77,-3691.5 12210.77,-3759.5"/>
<text text-anchor="middle" x="11962.27" y="-3744.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="11962.27" y="-3729.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11962.27" y="-3714.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11962.27" y="-3699.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer2_final_residual&#45;&gt;layer3_attn_norm_gpu1 -->
<g id="edge710" class="edge">
<title>layer2_final_residual&#45;&gt;layer3_attn_norm_gpu1</title>
<path fill="none" stroke="black" d="M7844.23,-3903C9098.43,-3903 11776.15,-3903 11776.15,-3903 11776.15,-3903 11776.15,-3769.72 11776.15,-3769.72"/>
<polygon fill="black" stroke="black" points="11779.65,-3769.72 11776.15,-3759.72 11772.65,-3769.72 11779.65,-3769.72"/>
</g>
<!-- layer3_attn_norm_gpu2 -->
<g id="node552" class="node">
<title>layer3_attn_norm_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="13886.77,-3759.5 13389.77,-3759.5 13389.77,-3691.5 13886.77,-3691.5 13886.77,-3759.5"/>
<text text-anchor="middle" x="13638.27" y="-3744.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="13638.27" y="-3729.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13638.27" y="-3714.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13638.27" y="-3699.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer2_final_residual&#45;&gt;layer3_attn_norm_gpu2 -->
<g id="edge723" class="edge">
<title>layer2_final_residual&#45;&gt;layer3_attn_norm_gpu2</title>
<path fill="none" stroke="black" d="M7731.87,-3922C9263.08,-3922 13638.27,-3922 13638.27,-3922 13638.27,-3922 13638.27,-3769.73 13638.27,-3769.73"/>
<polygon fill="black" stroke="black" points="13641.77,-3769.73 13638.27,-3759.73 13634.77,-3769.73 13641.77,-3769.73"/>
</g>
<!-- layer3_attn_norm_gpu3 -->
<g id="node563" class="node">
<title>layer3_attn_norm_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="2707.77,-3759.5 2210.77,-3759.5 2210.77,-3691.5 2707.77,-3691.5 2707.77,-3759.5"/>
<text text-anchor="middle" x="2459.27" y="-3744.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="2459.27" y="-3729.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2459.27" y="-3714.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2459.27" y="-3699.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer2_final_residual&#45;&gt;layer3_attn_norm_gpu3 -->
<g id="edge736" class="edge">
<title>layer2_final_residual&#45;&gt;layer3_attn_norm_gpu3</title>
<path fill="none" stroke="black" d="M6563.96,-3893C5314.36,-3893 2688.87,-3893 2688.87,-3893 2688.87,-3893 2688.87,-3769.8 2688.87,-3769.8"/>
<polygon fill="black" stroke="black" points="2692.37,-3769.8 2688.87,-3759.8 2685.37,-3769.8 2692.37,-3769.8"/>
</g>
<!-- layer3_attn_norm_gpu4 -->
<g id="node574" class="node">
<title>layer3_attn_norm_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="4384.77,-3759.5 3887.77,-3759.5 3887.77,-3691.5 4384.77,-3691.5 4384.77,-3759.5"/>
<text text-anchor="middle" x="4136.27" y="-3744.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="4136.27" y="-3729.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4136.27" y="-3714.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4136.27" y="-3699.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer2_final_residual&#45;&gt;layer3_attn_norm_gpu4 -->
<g id="edge749" class="edge">
<title>layer2_final_residual&#45;&gt;layer3_attn_norm_gpu4</title>
<path fill="none" stroke="black" d="M6654.8,-3869C5817.65,-3869 4329.38,-3869 4329.38,-3869 4329.38,-3869 4329.38,-3769.51 4329.38,-3769.51"/>
<polygon fill="black" stroke="black" points="4332.88,-3769.51 4329.38,-3759.51 4325.88,-3769.51 4332.88,-3769.51"/>
</g>
<!-- layer3_attn_norm_gpu5 -->
<g id="node585" class="node">
<title>layer3_attn_norm_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="6061.77,-3759.5 5564.77,-3759.5 5564.77,-3691.5 6061.77,-3691.5 6061.77,-3759.5"/>
<text text-anchor="middle" x="5813.27" y="-3744.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="5813.27" y="-3729.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5813.27" y="-3714.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5813.27" y="-3699.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer2_final_residual&#45;&gt;layer3_attn_norm_gpu5 -->
<g id="edge762" class="edge">
<title>layer2_final_residual&#45;&gt;layer3_attn_norm_gpu5</title>
<path fill="none" stroke="black" d="M6676.57,-3866.13C6676.57,-3820.98 6676.57,-3736 6676.57,-3736 6676.57,-3736 6071.81,-3736 6071.81,-3736"/>
<polygon fill="black" stroke="black" points="6071.81,-3732.5 6061.81,-3736 6071.81,-3739.5 6071.81,-3732.5"/>
</g>
<!-- layer3_attn_norm_gpu6 -->
<g id="node596" class="node">
<title>layer3_attn_norm_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="7458.77,-3759.5 6961.77,-3759.5 6961.77,-3691.5 7458.77,-3691.5 7458.77,-3759.5"/>
<text text-anchor="middle" x="7210.27" y="-3744.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="7210.27" y="-3729.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7210.27" y="-3714.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7210.27" y="-3699.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer2_final_residual&#45;&gt;layer3_attn_norm_gpu6 -->
<g id="edge775" class="edge">
<title>layer2_final_residual&#45;&gt;layer3_attn_norm_gpu6</title>
<path fill="none" stroke="black" d="M7210.27,-3845.42C7210.27,-3845.42 7210.27,-3769.53 7210.27,-3769.53"/>
<polygon fill="black" stroke="black" points="7213.77,-3769.53 7210.27,-3759.53 7206.77,-3769.53 7213.77,-3769.53"/>
</g>
<!-- layer3_attn_norm_gpu7 -->
<g id="node607" class="node">
<title>layer3_attn_norm_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="8855.77,-3759.5 8358.77,-3759.5 8358.77,-3691.5 8855.77,-3691.5 8855.77,-3759.5"/>
<text text-anchor="middle" x="8607.27" y="-3744.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="8607.27" y="-3729.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8607.27" y="-3714.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8607.27" y="-3699.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer2_final_residual&#45;&gt;layer3_attn_norm_gpu7 -->
<g id="edge788" class="edge">
<title>layer2_final_residual&#45;&gt;layer3_attn_norm_gpu7</title>
<path fill="none" stroke="black" d="M7719.78,-3864C8080.56,-3864 8500.61,-3864 8500.61,-3864 8500.61,-3864 8500.61,-3769.73 8500.61,-3769.73"/>
<polygon fill="black" stroke="black" points="8504.11,-3769.73 8500.61,-3759.73 8497.11,-3769.74 8504.11,-3769.73"/>
</g>
<!-- layer3_attn_residual -->
<g id="node619" class="node">
<title>layer3_attn_residual</title>
<ellipse fill="lightblue" stroke="black" cx="3966.27" cy="-2366.75" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="3966.27" y="-2385.55" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3966.27" y="-2370.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096], [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3966.27" y="-2355.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3966.27" y="-2340.55" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer2_final_residual&#45;&gt;layer3_attn_residual -->
<g id="edge809" class="edge">
<title>layer2_final_residual&#45;&gt;layer3_attn_residual</title>
<path fill="none" stroke="black" d="M7489.77,-3849.87C7489.77,-3714.62 7489.77,-3312 7489.77,-3312 7489.77,-3312 4536.66,-3312 4536.66,-3312 4536.66,-3312 4536.66,-2399.65 4536.66,-2399.65"/>
<polygon fill="black" stroke="black" points="4540.16,-2399.65 4536.66,-2389.65 4533.16,-2399.65 4540.16,-2399.65"/>
</g>
<!-- layer3_q_proj_gpu0 -->
<g id="node531" class="node">
<title>layer3_q_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="11373.77,-3605.5 10872.77,-3605.5 10872.77,-3537.5 11373.77,-3537.5 11373.77,-3605.5"/>
<text text-anchor="middle" x="11123.27" y="-3590.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="11123.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11123.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11123.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_attn_norm_gpu0&#45;&gt;layer3_q_proj_gpu0 -->
<g id="edge698" class="edge">
<title>layer3_attn_norm_gpu0&#45;&gt;layer3_q_proj_gpu0</title>
<path fill="none" stroke="black" d="M10532.77,-3725C10711.92,-3725 10922.3,-3725 10922.3,-3725 10922.3,-3725 10922.3,-3615.57 10922.3,-3615.57"/>
<polygon fill="black" stroke="black" points="10925.8,-3615.57 10922.3,-3605.57 10918.8,-3615.57 10925.8,-3615.57"/>
</g>
<!-- layer3_k_proj_gpu0 -->
<g id="node532" class="node">
<title>layer3_k_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="10814.77,-3605.5 10313.77,-3605.5 10313.77,-3537.5 10814.77,-3537.5 10814.77,-3605.5"/>
<text text-anchor="middle" x="10564.27" y="-3590.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="10564.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10564.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10564.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_attn_norm_gpu0&#45;&gt;layer3_k_proj_gpu0 -->
<g id="edge699" class="edge">
<title>layer3_attn_norm_gpu0&#45;&gt;layer3_k_proj_gpu0</title>
<path fill="none" stroke="black" d="M10423.27,-3691.32C10423.27,-3691.32 10423.27,-3615.58 10423.27,-3615.58"/>
<polygon fill="black" stroke="black" points="10426.77,-3615.58 10423.27,-3605.58 10419.77,-3615.58 10426.77,-3615.58"/>
</g>
<!-- layer3_v_proj_gpu0 -->
<g id="node533" class="node">
<title>layer3_v_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="10255.77,-3605.5 9754.77,-3605.5 9754.77,-3537.5 10255.77,-3537.5 10255.77,-3605.5"/>
<text text-anchor="middle" x="10005.27" y="-3590.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="10005.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10005.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10005.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_attn_norm_gpu0&#45;&gt;layer3_v_proj_gpu0 -->
<g id="edge700" class="edge">
<title>layer3_attn_norm_gpu0&#45;&gt;layer3_v_proj_gpu0</title>
<path fill="none" stroke="black" d="M10145.77,-3691.32C10145.77,-3691.32 10145.77,-3615.58 10145.77,-3615.58"/>
<polygon fill="black" stroke="black" points="10149.27,-3615.58 10145.77,-3605.58 10142.27,-3615.58 10149.27,-3615.58"/>
</g>
<!-- layer3_gather_q_gpu0 -->
<g id="node534" class="node">
<title>layer3_gather_q_gpu0</title>
<ellipse fill="lightblue" stroke="black" cx="11233.27" cy="-3403.42" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="11233.27" y="-3422.22" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="11233.27" y="-3407.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11233.27" y="-3392.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11233.27" y="-3377.22" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_q_proj_gpu0&#45;&gt;layer3_gather_q_gpu0 -->
<g id="edge701" class="edge">
<title>layer3_q_proj_gpu0&#45;&gt;layer3_gather_q_gpu0</title>
<path fill="none" stroke="black" d="M11123.27,-3537.48C11123.27,-3537.48 11123.27,-3459.48 11123.27,-3459.48"/>
<polygon fill="black" stroke="black" points="11126.77,-3459.48 11123.27,-3449.48 11119.77,-3459.48 11126.77,-3459.48"/>
</g>
<!-- layer3_gather_k_gpu0 -->
<g id="node535" class="node">
<title>layer3_gather_k_gpu0</title>
<ellipse fill="lightblue" stroke="black" cx="10454.27" cy="-3403.42" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="10454.27" y="-3422.22" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="10454.27" y="-3407.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10454.27" y="-3392.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10454.27" y="-3377.22" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_k_proj_gpu0&#45;&gt;layer3_gather_k_gpu0 -->
<g id="edge702" class="edge">
<title>layer3_k_proj_gpu0&#45;&gt;layer3_gather_k_gpu0</title>
<path fill="none" stroke="black" d="M10564.27,-3537.48C10564.27,-3537.48 10564.27,-3459.48 10564.27,-3459.48"/>
<polygon fill="black" stroke="black" points="10567.77,-3459.48 10564.27,-3449.48 10560.77,-3459.48 10567.77,-3459.48"/>
</g>
<!-- layer3_gather_v_gpu0 -->
<g id="node536" class="node">
<title>layer3_gather_v_gpu0</title>
<ellipse fill="lightblue" stroke="black" cx="9886.27" cy="-3039.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="9886.27" y="-3057.88" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="9886.27" y="-3042.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9886.27" y="-3027.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9886.27" y="-3012.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_v_proj_gpu0&#45;&gt;layer3_gather_v_gpu0 -->
<g id="edge703" class="edge">
<title>layer3_v_proj_gpu0&#45;&gt;layer3_gather_v_gpu0</title>
<path fill="none" stroke="black" d="M10005.27,-3537.38C10005.27,-3537.38 10005.27,-3094.64 10005.27,-3094.64"/>
<polygon fill="black" stroke="black" points="10008.77,-3094.64 10005.27,-3084.64 10001.77,-3094.64 10008.77,-3094.64"/>
</g>
<!-- layer3_attn_scores_gpu0 -->
<g id="node537" class="node">
<title>layer3_attn_scores_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="10843.77,-3255.25 10304.77,-3255.25 10304.77,-3187.25 10843.77,-3187.25 10843.77,-3255.25"/>
<text text-anchor="middle" x="10574.27" y="-3240.05" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="10574.27" y="-3225.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10574.27" y="-3210.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="10574.27" y="-3195.05" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gather_q_gpu0&#45;&gt;layer3_attn_scores_gpu0 -->
<g id="edge704" class="edge">
<title>layer3_gather_q_gpu0&#45;&gt;layer3_attn_scores_gpu0</title>
<path fill="none" stroke="black" d="M10872.56,-3403C10845.99,-3403 10829.33,-3403 10829.33,-3403 10829.33,-3403 10829.33,-3265.43 10829.33,-3265.43"/>
<polygon fill="black" stroke="black" points="10832.83,-3265.43 10829.33,-3255.43 10825.83,-3265.43 10832.83,-3265.43"/>
</g>
<!-- layer3_gather_k_gpu0&#45;&gt;layer3_attn_scores_gpu0 -->
<g id="edge705" class="edge">
<title>layer3_gather_k_gpu0&#45;&gt;layer3_attn_scores_gpu0</title>
<path fill="none" stroke="black" d="M10559.83,-3356.98C10559.83,-3356.98 10559.83,-3265.52 10559.83,-3265.52"/>
<polygon fill="black" stroke="black" points="10563.33,-3265.52 10559.83,-3255.52 10556.33,-3265.52 10563.33,-3265.52"/>
</g>
<!-- layer3_attn_out_gpu0 -->
<g id="node539" class="node">
<title>layer3_attn_out_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="10149.77,-2905 9622.77,-2905 9622.77,-2837 10149.77,-2837 10149.77,-2905"/>
<text text-anchor="middle" x="9886.27" y="-2889.8" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="9886.27" y="-2874.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="9886.27" y="-2859.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9886.27" y="-2844.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_gather_v_gpu0&#45;&gt;layer3_attn_out_gpu0 -->
<g id="edge708" class="edge">
<title>layer3_gather_v_gpu0&#45;&gt;layer3_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M9886.27,-2990.92C9886.27,-2990.92 9886.27,-2915.03 9886.27,-2915.03"/>
<polygon fill="black" stroke="black" points="9889.77,-2915.03 9886.27,-2905.03 9882.77,-2915.03 9889.77,-2915.03"/>
</g>
<!-- layer3_softmax_gpu0 -->
<g id="node538" class="node">
<title>layer3_softmax_gpu0</title>
<polygon fill="lightyellow" stroke="black" points="10843.77,-3073.08 10304.77,-3073.08 10304.77,-3005.08 10843.77,-3005.08 10843.77,-3073.08"/>
<text text-anchor="middle" x="10574.27" y="-3057.88" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="10574.27" y="-3042.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="10574.27" y="-3027.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="10574.27" y="-3012.88" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_attn_scores_gpu0&#45;&gt;layer3_softmax_gpu0 -->
<g id="edge706" class="edge">
<title>layer3_attn_scores_gpu0&#45;&gt;layer3_softmax_gpu0</title>
<path fill="none" stroke="black" d="M10574.27,-3186.98C10574.27,-3186.98 10574.27,-3083.19 10574.27,-3083.19"/>
<polygon fill="black" stroke="black" points="10577.77,-3083.19 10574.27,-3073.19 10570.77,-3083.19 10577.77,-3083.19"/>
</g>
<!-- layer3_softmax_gpu0&#45;&gt;layer3_attn_out_gpu0 -->
<g id="edge707" class="edge">
<title>layer3_softmax_gpu0&#45;&gt;layer3_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M10517.77,-3005C10517.77,-2958.8 10517.77,-2882 10517.77,-2882 10517.77,-2882 10159.96,-2882 10159.96,-2882"/>
<polygon fill="black" stroke="black" points="10159.96,-2878.5 10149.96,-2882 10159.96,-2885.5 10159.96,-2878.5"/>
</g>
<!-- layer3_out_proj_gpu0 -->
<g id="node540" class="node">
<title>layer3_out_proj_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="9683.77,-2751 9194.77,-2751 9194.77,-2683 9683.77,-2683 9683.77,-2751"/>
<text text-anchor="middle" x="9439.27" y="-2735.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9439.27" y="-2720.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9439.27" y="-2705.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="9439.27" y="-2690.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer3_attn_out_gpu0&#45;&gt;layer3_out_proj_gpu0 -->
<g id="edge709" class="edge">
<title>layer3_attn_out_gpu0&#45;&gt;layer3_out_proj_gpu0</title>
<path fill="none" stroke="black" d="M9653.27,-2836.82C9653.27,-2836.82 9653.27,-2761.08 9653.27,-2761.08"/>
<polygon fill="black" stroke="black" points="9656.77,-2761.08 9653.27,-2751.08 9649.77,-2761.08 9656.77,-2761.08"/>
</g>
<!-- layer3_attn_all_reduce -->
<g id="node618" class="node">
<title>layer3_attn_all_reduce</title>
<ellipse fill="lightblue" stroke="black" cx="6933.27" cy="-2548.92" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="6933.27" y="-2567.72" font-family="Times,serif" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="6933.27" y="-2552.72" font-family="Times,serif" font-size="14.00">Input: 8×[512]</text>
<text text-anchor="middle" x="6933.27" y="-2537.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6933.27" y="-2522.72" font-family="Times,serif" font-size="14.00">GPU: GPUs 0&#45;7</text>
</g>
<!-- layer3_out_proj_gpu0&#45;&gt;layer3_attn_all_reduce -->
<g id="edge801" class="edge">
<title>layer3_out_proj_gpu0&#45;&gt;layer3_attn_all_reduce</title>
<path fill="none" stroke="black" d="M9439.27,-2682.64C9439.27,-2639.76 9439.27,-2572 9439.27,-2572 9439.27,-2572 7251.81,-2572 7251.81,-2572"/>
<polygon fill="black" stroke="black" points="7251.81,-2568.5 7241.81,-2572 7251.81,-2575.5 7251.81,-2568.5"/>
</g>
<!-- layer3_q_proj_gpu1 -->
<g id="node542" class="node">
<title>layer3_q_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="13050.77,-3605.5 12549.77,-3605.5 12549.77,-3537.5 13050.77,-3537.5 13050.77,-3605.5"/>
<text text-anchor="middle" x="12800.27" y="-3590.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="12800.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12800.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12800.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_attn_norm_gpu1&#45;&gt;layer3_q_proj_gpu1 -->
<g id="edge711" class="edge">
<title>layer3_attn_norm_gpu1&#45;&gt;layer3_q_proj_gpu1</title>
<path fill="none" stroke="black" d="M12210.86,-3725C12437.98,-3725 12738.65,-3725 12738.65,-3725 12738.65,-3725 12738.65,-3615.57 12738.65,-3615.57"/>
<polygon fill="black" stroke="black" points="12742.15,-3615.57 12738.65,-3605.57 12735.15,-3615.57 12742.15,-3615.57"/>
</g>
<!-- layer3_k_proj_gpu1 -->
<g id="node543" class="node">
<title>layer3_k_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="12491.77,-3605.5 11990.77,-3605.5 11990.77,-3537.5 12491.77,-3537.5 12491.77,-3605.5"/>
<text text-anchor="middle" x="12241.27" y="-3590.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="12241.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12241.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12241.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_attn_norm_gpu1&#45;&gt;layer3_k_proj_gpu1 -->
<g id="edge712" class="edge">
<title>layer3_attn_norm_gpu1&#45;&gt;layer3_k_proj_gpu1</title>
<path fill="none" stroke="black" d="M12100.77,-3691.32C12100.77,-3691.32 12100.77,-3615.58 12100.77,-3615.58"/>
<polygon fill="black" stroke="black" points="12104.27,-3615.58 12100.77,-3605.58 12097.27,-3615.58 12104.27,-3615.58"/>
</g>
<!-- layer3_v_proj_gpu1 -->
<g id="node544" class="node">
<title>layer3_v_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11932.77,-3605.5 11431.77,-3605.5 11431.77,-3537.5 11932.77,-3537.5 11932.77,-3605.5"/>
<text text-anchor="middle" x="11682.27" y="-3590.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="11682.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11682.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11682.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_attn_norm_gpu1&#45;&gt;layer3_v_proj_gpu1 -->
<g id="edge713" class="edge">
<title>layer3_attn_norm_gpu1&#45;&gt;layer3_v_proj_gpu1</title>
<path fill="none" stroke="black" d="M11823.27,-3691.32C11823.27,-3691.32 11823.27,-3615.58 11823.27,-3615.58"/>
<polygon fill="black" stroke="black" points="11826.77,-3615.58 11823.27,-3605.58 11819.77,-3615.58 11826.77,-3615.58"/>
</g>
<!-- layer3_gather_q_gpu1 -->
<g id="node545" class="node">
<title>layer3_gather_q_gpu1</title>
<ellipse fill="lightblue" stroke="black" cx="12910.27" cy="-3403.42" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="12910.27" y="-3422.22" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="12910.27" y="-3407.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12910.27" y="-3392.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12910.27" y="-3377.22" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_q_proj_gpu1&#45;&gt;layer3_gather_q_gpu1 -->
<g id="edge714" class="edge">
<title>layer3_q_proj_gpu1&#45;&gt;layer3_gather_q_gpu1</title>
<path fill="none" stroke="black" d="M12800.27,-3537.48C12800.27,-3537.48 12800.27,-3459.48 12800.27,-3459.48"/>
<polygon fill="black" stroke="black" points="12803.77,-3459.48 12800.27,-3449.48 12796.77,-3459.48 12803.77,-3459.48"/>
</g>
<!-- layer3_gather_k_gpu1 -->
<g id="node546" class="node">
<title>layer3_gather_k_gpu1</title>
<ellipse fill="lightblue" stroke="black" cx="12131.27" cy="-3403.42" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="12131.27" y="-3422.22" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="12131.27" y="-3407.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12131.27" y="-3392.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12131.27" y="-3377.22" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_k_proj_gpu1&#45;&gt;layer3_gather_k_gpu1 -->
<g id="edge715" class="edge">
<title>layer3_k_proj_gpu1&#45;&gt;layer3_gather_k_gpu1</title>
<path fill="none" stroke="black" d="M12241.27,-3537.48C12241.27,-3537.48 12241.27,-3459.48 12241.27,-3459.48"/>
<polygon fill="black" stroke="black" points="12244.77,-3459.48 12241.27,-3449.48 12237.77,-3459.48 12244.77,-3459.48"/>
</g>
<!-- layer3_gather_v_gpu1 -->
<g id="node547" class="node">
<title>layer3_gather_v_gpu1</title>
<ellipse fill="lightblue" stroke="black" cx="11563.27" cy="-3221.25" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="11563.27" y="-3240.05" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="11563.27" y="-3225.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11563.27" y="-3210.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11563.27" y="-3195.05" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_v_proj_gpu1&#45;&gt;layer3_gather_v_gpu1 -->
<g id="edge716" class="edge">
<title>layer3_v_proj_gpu1&#45;&gt;layer3_gather_v_gpu1</title>
<path fill="none" stroke="black" d="M11682.27,-3537.28C11682.27,-3537.28 11682.27,-3276.86 11682.27,-3276.86"/>
<polygon fill="black" stroke="black" points="11685.77,-3276.86 11682.27,-3266.86 11678.77,-3276.86 11685.77,-3276.86"/>
</g>
<!-- layer3_attn_scores_gpu1 -->
<g id="node548" class="node">
<title>layer3_attn_scores_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="12520.77,-3255.25 11981.77,-3255.25 11981.77,-3187.25 12520.77,-3187.25 12520.77,-3255.25"/>
<text text-anchor="middle" x="12251.27" y="-3240.05" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="12251.27" y="-3225.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12251.27" y="-3210.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="12251.27" y="-3195.05" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gather_q_gpu1&#45;&gt;layer3_attn_scores_gpu1 -->
<g id="edge717" class="edge">
<title>layer3_gather_q_gpu1&#45;&gt;layer3_attn_scores_gpu1</title>
<path fill="none" stroke="black" d="M12549.56,-3403C12522.99,-3403 12506.33,-3403 12506.33,-3403 12506.33,-3403 12506.33,-3265.43 12506.33,-3265.43"/>
<polygon fill="black" stroke="black" points="12509.83,-3265.43 12506.33,-3255.43 12502.83,-3265.43 12509.83,-3265.43"/>
</g>
<!-- layer3_gather_k_gpu1&#45;&gt;layer3_attn_scores_gpu1 -->
<g id="edge718" class="edge">
<title>layer3_gather_k_gpu1&#45;&gt;layer3_attn_scores_gpu1</title>
<path fill="none" stroke="black" d="M12236.83,-3356.98C12236.83,-3356.98 12236.83,-3265.52 12236.83,-3265.52"/>
<polygon fill="black" stroke="black" points="12240.33,-3265.52 12236.83,-3255.52 12233.33,-3265.52 12240.33,-3265.52"/>
</g>
<!-- layer3_attn_out_gpu1 -->
<g id="node550" class="node">
<title>layer3_attn_out_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="11826.77,-2905 11299.77,-2905 11299.77,-2837 11826.77,-2837 11826.77,-2905"/>
<text text-anchor="middle" x="11563.27" y="-2889.8" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="11563.27" y="-2874.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="11563.27" y="-2859.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11563.27" y="-2844.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_gather_v_gpu1&#45;&gt;layer3_attn_out_gpu1 -->
<g id="edge721" class="edge">
<title>layer3_gather_v_gpu1&#45;&gt;layer3_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M11558.27,-3172.92C11558.27,-3172.92 11558.27,-2915.15 11558.27,-2915.15"/>
<polygon fill="black" stroke="black" points="11561.77,-2915.15 11558.27,-2905.15 11554.77,-2915.15 11561.77,-2915.15"/>
</g>
<!-- layer3_softmax_gpu1 -->
<g id="node549" class="node">
<title>layer3_softmax_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="12355.77,-3073.08 11816.77,-3073.08 11816.77,-3005.08 12355.77,-3005.08 12355.77,-3073.08"/>
<text text-anchor="middle" x="12086.27" y="-3057.88" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="12086.27" y="-3042.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="12086.27" y="-3027.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="12086.27" y="-3012.88" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_attn_scores_gpu1&#45;&gt;layer3_softmax_gpu1 -->
<g id="edge719" class="edge">
<title>layer3_attn_scores_gpu1&#45;&gt;layer3_softmax_gpu1</title>
<path fill="none" stroke="black" d="M12168.77,-3186.98C12168.77,-3186.98 12168.77,-3083.19 12168.77,-3083.19"/>
<polygon fill="black" stroke="black" points="12172.27,-3083.19 12168.77,-3073.19 12165.27,-3083.19 12172.27,-3083.19"/>
</g>
<!-- layer3_softmax_gpu1&#45;&gt;layer3_attn_out_gpu1 -->
<g id="edge720" class="edge">
<title>layer3_softmax_gpu1&#45;&gt;layer3_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M11821.77,-3005.07C11821.77,-3005.07 11821.77,-2915.25 11821.77,-2915.25"/>
<polygon fill="black" stroke="black" points="11825.27,-2915.25 11821.77,-2905.25 11818.27,-2915.25 11825.27,-2915.25"/>
</g>
<!-- layer3_out_proj_gpu1 -->
<g id="node551" class="node">
<title>layer3_out_proj_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="11219.77,-2751 10730.77,-2751 10730.77,-2683 11219.77,-2683 11219.77,-2751"/>
<text text-anchor="middle" x="10975.27" y="-2735.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10975.27" y="-2720.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10975.27" y="-2705.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="10975.27" y="-2690.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer3_attn_out_gpu1&#45;&gt;layer3_out_proj_gpu1 -->
<g id="edge722" class="edge">
<title>layer3_attn_out_gpu1&#45;&gt;layer3_out_proj_gpu1</title>
<path fill="none" stroke="black" d="M11299.59,-2859C11248.88,-2859 11211.2,-2859 11211.2,-2859 11211.2,-2859 11211.2,-2761.01 11211.2,-2761.01"/>
<polygon fill="black" stroke="black" points="11214.7,-2761.01 11211.2,-2751.01 11207.7,-2761.01 11214.7,-2761.01"/>
</g>
<!-- layer3_out_proj_gpu1&#45;&gt;layer3_attn_all_reduce -->
<g id="edge802" class="edge">
<title>layer3_out_proj_gpu1&#45;&gt;layer3_attn_all_reduce</title>
<path fill="none" stroke="black" d="M10749.93,-2682.8C10749.93,-2633.42 10749.93,-2548 10749.93,-2548 10749.93,-2548 7294.64,-2548 7294.64,-2548"/>
<polygon fill="black" stroke="black" points="7294.64,-2544.5 7284.64,-2548 7294.64,-2551.5 7294.64,-2544.5"/>
</g>
<!-- layer3_q_proj_gpu2 -->
<g id="node553" class="node">
<title>layer3_q_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="14810.77,-3605.5 14309.77,-3605.5 14309.77,-3537.5 14810.77,-3537.5 14810.77,-3605.5"/>
<text text-anchor="middle" x="14560.27" y="-3590.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="14560.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14560.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14560.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_attn_norm_gpu2&#45;&gt;layer3_q_proj_gpu2 -->
<g id="edge724" class="edge">
<title>layer3_attn_norm_gpu2&#45;&gt;layer3_q_proj_gpu2</title>
<path fill="none" stroke="black" d="M13886.86,-3725C14159.94,-3725 14560.27,-3725 14560.27,-3725 14560.27,-3725 14560.27,-3615.57 14560.27,-3615.57"/>
<polygon fill="black" stroke="black" points="14563.77,-3615.57 14560.27,-3605.57 14556.77,-3615.57 14563.77,-3615.57"/>
</g>
<!-- layer3_k_proj_gpu2 -->
<g id="node554" class="node">
<title>layer3_k_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="14168.77,-3605.5 13667.77,-3605.5 13667.77,-3537.5 14168.77,-3537.5 14168.77,-3605.5"/>
<text text-anchor="middle" x="13918.27" y="-3590.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="13918.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13918.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13918.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_attn_norm_gpu2&#45;&gt;layer3_k_proj_gpu2 -->
<g id="edge725" class="edge">
<title>layer3_attn_norm_gpu2&#45;&gt;layer3_k_proj_gpu2</title>
<path fill="none" stroke="black" d="M13777.27,-3691.32C13777.27,-3691.32 13777.27,-3615.58 13777.27,-3615.58"/>
<polygon fill="black" stroke="black" points="13780.77,-3615.58 13777.27,-3605.58 13773.77,-3615.58 13780.77,-3615.58"/>
</g>
<!-- layer3_v_proj_gpu2 -->
<g id="node555" class="node">
<title>layer3_v_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="13609.77,-3605.5 13108.77,-3605.5 13108.77,-3537.5 13609.77,-3537.5 13609.77,-3605.5"/>
<text text-anchor="middle" x="13359.27" y="-3590.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="13359.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13359.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13359.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_attn_norm_gpu2&#45;&gt;layer3_v_proj_gpu2 -->
<g id="edge726" class="edge">
<title>layer3_attn_norm_gpu2&#45;&gt;layer3_v_proj_gpu2</title>
<path fill="none" stroke="black" d="M13499.77,-3691.32C13499.77,-3691.32 13499.77,-3615.58 13499.77,-3615.58"/>
<polygon fill="black" stroke="black" points="13503.27,-3615.58 13499.77,-3605.58 13496.27,-3615.58 13503.27,-3615.58"/>
</g>
<!-- layer3_gather_q_gpu2 -->
<g id="node556" class="node">
<title>layer3_gather_q_gpu2</title>
<ellipse fill="lightblue" stroke="black" cx="14642.27" cy="-3403.42" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="14642.27" y="-3422.22" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="14642.27" y="-3407.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14642.27" y="-3392.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14642.27" y="-3377.22" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_q_proj_gpu2&#45;&gt;layer3_gather_q_gpu2 -->
<g id="edge727" class="edge">
<title>layer3_q_proj_gpu2&#45;&gt;layer3_gather_q_gpu2</title>
<path fill="none" stroke="black" d="M14560.27,-3537.48C14560.27,-3537.48 14560.27,-3460.44 14560.27,-3460.44"/>
<polygon fill="black" stroke="black" points="14563.77,-3460.44 14560.27,-3450.44 14556.77,-3460.44 14563.77,-3460.44"/>
</g>
<!-- layer3_gather_k_gpu2 -->
<g id="node557" class="node">
<title>layer3_gather_k_gpu2</title>
<ellipse fill="lightblue" stroke="black" cx="13863.27" cy="-3403.42" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="13863.27" y="-3422.22" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="13863.27" y="-3407.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13863.27" y="-3392.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13863.27" y="-3377.22" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_k_proj_gpu2&#45;&gt;layer3_gather_k_gpu2 -->
<g id="edge728" class="edge">
<title>layer3_k_proj_gpu2&#45;&gt;layer3_gather_k_gpu2</title>
<path fill="none" stroke="black" d="M13918.27,-3537.48C13918.27,-3537.48 13918.27,-3461.07 13918.27,-3461.07"/>
<polygon fill="black" stroke="black" points="13921.77,-3461.07 13918.27,-3451.07 13914.77,-3461.07 13921.77,-3461.07"/>
</g>
<!-- layer3_gather_v_gpu2 -->
<g id="node558" class="node">
<title>layer3_gather_v_gpu2</title>
<ellipse fill="lightblue" stroke="black" cx="13267.27" cy="-3039.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="13267.27" y="-3057.88" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="13267.27" y="-3042.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13267.27" y="-3027.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13267.27" y="-3012.88" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_v_proj_gpu2&#45;&gt;layer3_gather_v_gpu2 -->
<g id="edge729" class="edge">
<title>layer3_v_proj_gpu2&#45;&gt;layer3_gather_v_gpu2</title>
<path fill="none" stroke="black" d="M13386.77,-3537.38C13386.77,-3537.38 13386.77,-3094.64 13386.77,-3094.64"/>
<polygon fill="black" stroke="black" points="13390.27,-3094.64 13386.77,-3084.64 13383.27,-3094.64 13390.27,-3094.64"/>
</g>
<!-- layer3_attn_scores_gpu2 -->
<g id="node559" class="node">
<title>layer3_attn_scores_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="14224.77,-3255.25 13685.77,-3255.25 13685.77,-3187.25 14224.77,-3187.25 14224.77,-3255.25"/>
<text text-anchor="middle" x="13955.27" y="-3240.05" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="13955.27" y="-3225.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13955.27" y="-3210.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="13955.27" y="-3195.05" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gather_q_gpu2&#45;&gt;layer3_attn_scores_gpu2 -->
<g id="edge730" class="edge">
<title>layer3_gather_q_gpu2&#45;&gt;layer3_attn_scores_gpu2</title>
<path fill="none" stroke="black" d="M14642.27,-3355.01C14642.27,-3300.97 14642.27,-3221 14642.27,-3221 14642.27,-3221 14234.82,-3221 14234.82,-3221"/>
<polygon fill="black" stroke="black" points="14234.82,-3217.5 14224.82,-3221 14234.82,-3224.5 14234.82,-3217.5"/>
</g>
<!-- layer3_gather_k_gpu2&#45;&gt;layer3_attn_scores_gpu2 -->
<g id="edge731" class="edge">
<title>layer3_gather_k_gpu2&#45;&gt;layer3_attn_scores_gpu2</title>
<path fill="none" stroke="black" d="M13954.83,-3356.5C13954.83,-3356.5 13954.83,-3265.35 13954.83,-3265.35"/>
<polygon fill="black" stroke="black" points="13958.33,-3265.35 13954.83,-3255.35 13951.33,-3265.35 13958.33,-3265.35"/>
</g>
<!-- layer3_attn_out_gpu2 -->
<g id="node561" class="node">
<title>layer3_attn_out_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="13530.77,-2905 13003.77,-2905 13003.77,-2837 13530.77,-2837 13530.77,-2905"/>
<text text-anchor="middle" x="13267.27" y="-2889.8" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="13267.27" y="-2874.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="13267.27" y="-2859.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13267.27" y="-2844.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_gather_v_gpu2&#45;&gt;layer3_attn_out_gpu2 -->
<g id="edge734" class="edge">
<title>layer3_gather_v_gpu2&#45;&gt;layer3_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M13267.27,-2990.92C13267.27,-2990.92 13267.27,-2915.03 13267.27,-2915.03"/>
<polygon fill="black" stroke="black" points="13270.77,-2915.03 13267.27,-2905.03 13263.77,-2915.03 13270.77,-2915.03"/>
</g>
<!-- layer3_softmax_gpu2 -->
<g id="node560" class="node">
<title>layer3_softmax_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="14224.77,-3073.08 13685.77,-3073.08 13685.77,-3005.08 14224.77,-3005.08 14224.77,-3073.08"/>
<text text-anchor="middle" x="13955.27" y="-3057.88" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="13955.27" y="-3042.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="13955.27" y="-3027.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="13955.27" y="-3012.88" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_attn_scores_gpu2&#45;&gt;layer3_softmax_gpu2 -->
<g id="edge732" class="edge">
<title>layer3_attn_scores_gpu2&#45;&gt;layer3_softmax_gpu2</title>
<path fill="none" stroke="black" d="M13955.27,-3186.98C13955.27,-3186.98 13955.27,-3083.19 13955.27,-3083.19"/>
<polygon fill="black" stroke="black" points="13958.77,-3083.19 13955.27,-3073.19 13951.77,-3083.19 13958.77,-3083.19"/>
</g>
<!-- layer3_softmax_gpu2&#45;&gt;layer3_attn_out_gpu2 -->
<g id="edge733" class="edge">
<title>layer3_softmax_gpu2&#45;&gt;layer3_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M13823.43,-3004.87C13823.43,-2955.46 13823.43,-2870 13823.43,-2870 13823.43,-2870 13541.1,-2870 13541.1,-2870"/>
<polygon fill="black" stroke="black" points="13541.1,-2866.5 13531.1,-2870 13541.1,-2873.5 13541.1,-2866.5"/>
</g>
<!-- layer3_out_proj_gpu2 -->
<g id="node562" class="node">
<title>layer3_out_proj_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="12706.77,-2751 12217.77,-2751 12217.77,-2683 12706.77,-2683 12706.77,-2751"/>
<text text-anchor="middle" x="12462.27" y="-2735.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12462.27" y="-2720.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12462.27" y="-2705.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="12462.27" y="-2690.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer3_attn_out_gpu2&#45;&gt;layer3_out_proj_gpu2 -->
<g id="edge735" class="edge">
<title>layer3_attn_out_gpu2&#45;&gt;layer3_out_proj_gpu2</title>
<path fill="none" stroke="black" d="M13003.65,-2870C12827.61,-2870 12628.2,-2870 12628.2,-2870 12628.2,-2870 12628.2,-2761.34 12628.2,-2761.34"/>
<polygon fill="black" stroke="black" points="12631.7,-2761.34 12628.2,-2751.34 12624.7,-2761.34 12631.7,-2761.34"/>
</g>
<!-- layer3_out_proj_gpu2&#45;&gt;layer3_attn_all_reduce -->
<g id="edge803" class="edge">
<title>layer3_out_proj_gpu2&#45;&gt;layer3_attn_all_reduce</title>
<path fill="none" stroke="black" d="M12462.27,-2682.94C12462.27,-2627.53 12462.27,-2524 12462.27,-2524 12462.27,-2524 7243.96,-2524 7243.96,-2524"/>
<polygon fill="black" stroke="black" points="7243.96,-2520.5 7233.96,-2524 7243.96,-2527.5 7243.96,-2520.5"/>
</g>
<!-- layer3_q_proj_gpu3 -->
<g id="node564" class="node">
<title>layer3_q_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="2429.77,-3605.5 1928.77,-3605.5 1928.77,-3537.5 2429.77,-3537.5 2429.77,-3605.5"/>
<text text-anchor="middle" x="2179.27" y="-3590.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="2179.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2179.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2179.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_attn_norm_gpu3&#45;&gt;layer3_q_proj_gpu3 -->
<g id="edge737" class="edge">
<title>layer3_attn_norm_gpu3&#45;&gt;layer3_q_proj_gpu3</title>
<path fill="none" stroke="black" d="M2320.27,-3691.32C2320.27,-3691.32 2320.27,-3615.58 2320.27,-3615.58"/>
<polygon fill="black" stroke="black" points="2323.77,-3615.58 2320.27,-3605.58 2316.77,-3615.58 2323.77,-3615.58"/>
</g>
<!-- layer3_k_proj_gpu3 -->
<g id="node565" class="node">
<title>layer3_k_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="2988.77,-3605.5 2487.77,-3605.5 2487.77,-3537.5 2988.77,-3537.5 2988.77,-3605.5"/>
<text text-anchor="middle" x="2738.27" y="-3590.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="2738.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2738.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2738.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_attn_norm_gpu3&#45;&gt;layer3_k_proj_gpu3 -->
<g id="edge738" class="edge">
<title>layer3_attn_norm_gpu3&#45;&gt;layer3_k_proj_gpu3</title>
<path fill="none" stroke="black" d="M2597.77,-3691.32C2597.77,-3691.32 2597.77,-3615.58 2597.77,-3615.58"/>
<polygon fill="black" stroke="black" points="2601.27,-3615.58 2597.77,-3605.58 2594.27,-3615.58 2601.27,-3615.58"/>
</g>
<!-- layer3_v_proj_gpu3 -->
<g id="node566" class="node">
<title>layer3_v_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1870.77,-3605.5 1369.77,-3605.5 1369.77,-3537.5 1870.77,-3537.5 1870.77,-3605.5"/>
<text text-anchor="middle" x="1620.27" y="-3590.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1620.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1620.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1620.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_attn_norm_gpu3&#45;&gt;layer3_v_proj_gpu3 -->
<g id="edge739" class="edge">
<title>layer3_attn_norm_gpu3&#45;&gt;layer3_v_proj_gpu3</title>
<path fill="none" stroke="black" d="M2210.51,-3725C2041.6,-3725 1848.77,-3725 1848.77,-3725 1848.77,-3725 1848.77,-3615.57 1848.77,-3615.57"/>
<polygon fill="black" stroke="black" points="1852.27,-3615.57 1848.77,-3605.57 1845.27,-3615.57 1852.27,-3615.57"/>
</g>
<!-- layer3_gather_q_gpu3 -->
<g id="node567" class="node">
<title>layer3_gather_q_gpu3</title>
<ellipse fill="lightblue" stroke="black" cx="2069.27" cy="-3403.42" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="2069.27" y="-3422.22" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="2069.27" y="-3407.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2069.27" y="-3392.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2069.27" y="-3377.22" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_q_proj_gpu3&#45;&gt;layer3_gather_q_gpu3 -->
<g id="edge740" class="edge">
<title>layer3_q_proj_gpu3&#45;&gt;layer3_gather_q_gpu3</title>
<path fill="none" stroke="black" d="M2179.27,-3537.48C2179.27,-3537.48 2179.27,-3459.48 2179.27,-3459.48"/>
<polygon fill="black" stroke="black" points="2182.77,-3459.48 2179.27,-3449.48 2175.77,-3459.48 2182.77,-3459.48"/>
</g>
<!-- layer3_gather_k_gpu3 -->
<g id="node568" class="node">
<title>layer3_gather_k_gpu3</title>
<ellipse fill="lightblue" stroke="black" cx="2848.27" cy="-3403.42" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="2848.27" y="-3422.22" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="2848.27" y="-3407.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2848.27" y="-3392.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2848.27" y="-3377.22" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_k_proj_gpu3&#45;&gt;layer3_gather_k_gpu3 -->
<g id="edge741" class="edge">
<title>layer3_k_proj_gpu3&#45;&gt;layer3_gather_k_gpu3</title>
<path fill="none" stroke="black" d="M2738.27,-3537.48C2738.27,-3537.48 2738.27,-3459.48 2738.27,-3459.48"/>
<polygon fill="black" stroke="black" points="2741.77,-3459.48 2738.27,-3449.48 2734.77,-3459.48 2741.77,-3459.48"/>
</g>
<!-- layer3_gather_v_gpu3 -->
<g id="node569" class="node">
<title>layer3_gather_v_gpu3</title>
<ellipse fill="lightblue" stroke="black" cx="1863.27" cy="-3221.25" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="1863.27" y="-3240.05" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="1863.27" y="-3225.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1863.27" y="-3210.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1863.27" y="-3195.05" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_v_proj_gpu3&#45;&gt;layer3_gather_v_gpu3 -->
<g id="edge742" class="edge">
<title>layer3_v_proj_gpu3&#45;&gt;layer3_gather_v_gpu3</title>
<path fill="none" stroke="black" d="M1605.64,-3537.28C1605.64,-3537.28 1605.64,-3265.09 1605.64,-3265.09"/>
<polygon fill="black" stroke="black" points="1609.14,-3265.09 1605.64,-3255.09 1602.14,-3265.09 1609.14,-3265.09"/>
</g>
<!-- layer3_attn_scores_gpu3 -->
<g id="node570" class="node">
<title>layer3_attn_scores_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="2887.77,-3255.25 2348.77,-3255.25 2348.77,-3187.25 2887.77,-3187.25 2887.77,-3255.25"/>
<text text-anchor="middle" x="2618.27" y="-3240.05" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="2618.27" y="-3225.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2618.27" y="-3210.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="2618.27" y="-3195.05" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gather_q_gpu3&#45;&gt;layer3_attn_scores_gpu3 -->
<g id="edge743" class="edge">
<title>layer3_gather_q_gpu3&#45;&gt;layer3_attn_scores_gpu3</title>
<path fill="none" stroke="black" d="M2389.33,-3381.08C2389.33,-3381.08 2389.33,-3265.26 2389.33,-3265.26"/>
<polygon fill="black" stroke="black" points="2392.83,-3265.26 2389.33,-3255.26 2385.83,-3265.26 2392.83,-3265.26"/>
</g>
<!-- layer3_gather_k_gpu3&#45;&gt;layer3_attn_scores_gpu3 -->
<g id="edge744" class="edge">
<title>layer3_gather_k_gpu3&#45;&gt;layer3_attn_scores_gpu3</title>
<path fill="none" stroke="black" d="M2687.7,-3360.24C2687.7,-3360.24 2687.7,-3265.3 2687.7,-3265.3"/>
<polygon fill="black" stroke="black" points="2691.2,-3265.3 2687.7,-3255.3 2684.2,-3265.3 2691.2,-3265.3"/>
</g>
<!-- layer3_attn_out_gpu3 -->
<g id="node572" class="node">
<title>layer3_attn_out_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="2881.77,-2905 2354.77,-2905 2354.77,-2837 2881.77,-2837 2881.77,-2905"/>
<text text-anchor="middle" x="2618.27" y="-2889.8" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="2618.27" y="-2874.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="2618.27" y="-2859.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2618.27" y="-2844.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_gather_v_gpu3&#45;&gt;layer3_attn_out_gpu3 -->
<g id="edge747" class="edge">
<title>layer3_gather_v_gpu3&#45;&gt;layer3_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M1863.27,-3173.15C1863.27,-3076.95 1863.27,-2870 1863.27,-2870 1863.27,-2870 2344.73,-2870 2344.73,-2870"/>
<polygon fill="black" stroke="black" points="2344.73,-2873.5 2354.73,-2870 2344.73,-2866.5 2344.73,-2873.5"/>
</g>
<!-- layer3_softmax_gpu3 -->
<g id="node571" class="node">
<title>layer3_softmax_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="2887.77,-3073.08 2348.77,-3073.08 2348.77,-3005.08 2887.77,-3005.08 2887.77,-3073.08"/>
<text text-anchor="middle" x="2618.27" y="-3057.88" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="2618.27" y="-3042.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="2618.27" y="-3027.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="2618.27" y="-3012.88" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_attn_scores_gpu3&#45;&gt;layer3_softmax_gpu3 -->
<g id="edge745" class="edge">
<title>layer3_attn_scores_gpu3&#45;&gt;layer3_softmax_gpu3</title>
<path fill="none" stroke="black" d="M2618.27,-3186.98C2618.27,-3186.98 2618.27,-3083.19 2618.27,-3083.19"/>
<polygon fill="black" stroke="black" points="2621.77,-3083.19 2618.27,-3073.19 2614.77,-3083.19 2621.77,-3083.19"/>
</g>
<!-- layer3_softmax_gpu3&#45;&gt;layer3_attn_out_gpu3 -->
<g id="edge746" class="edge">
<title>layer3_softmax_gpu3&#45;&gt;layer3_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M2618.27,-3005.07C2618.27,-3005.07 2618.27,-2915.25 2618.27,-2915.25"/>
<polygon fill="black" stroke="black" points="2621.77,-2915.25 2618.27,-2905.25 2614.77,-2915.25 2621.77,-2915.25"/>
</g>
<!-- layer3_out_proj_gpu3 -->
<g id="node573" class="node">
<title>layer3_out_proj_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="3371.77,-2751 2882.77,-2751 2882.77,-2683 3371.77,-2683 3371.77,-2751"/>
<text text-anchor="middle" x="3127.27" y="-2735.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3127.27" y="-2720.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3127.27" y="-2705.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="3127.27" y="-2690.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer3_attn_out_gpu3&#45;&gt;layer3_out_proj_gpu3 -->
<g id="edge748" class="edge">
<title>layer3_attn_out_gpu3&#45;&gt;layer3_out_proj_gpu3</title>
<path fill="none" stroke="black" d="M2881.85,-2859C2936.43,-2859 2977.7,-2859 2977.7,-2859 2977.7,-2859 2977.7,-2761.01 2977.7,-2761.01"/>
<polygon fill="black" stroke="black" points="2981.2,-2761.01 2977.7,-2751.01 2974.2,-2761.01 2981.2,-2761.01"/>
</g>
<!-- layer3_out_proj_gpu3&#45;&gt;layer3_attn_all_reduce -->
<g id="edge804" class="edge">
<title>layer3_out_proj_gpu3&#45;&gt;layer3_attn_all_reduce</title>
<path fill="none" stroke="black" d="M3345.87,-2682.64C3345.87,-2629.14 3345.87,-2532 3345.87,-2532 3345.87,-2532 6594.2,-2532 6594.2,-2532"/>
<polygon fill="black" stroke="black" points="6594.2,-2535.5 6604.2,-2532 6594.2,-2528.5 6594.2,-2535.5"/>
</g>
<!-- layer3_q_proj_gpu4 -->
<g id="node575" class="node">
<title>layer3_q_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="4106.77,-3605.5 3605.77,-3605.5 3605.77,-3537.5 4106.77,-3537.5 4106.77,-3605.5"/>
<text text-anchor="middle" x="3856.27" y="-3590.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="3856.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3856.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3856.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_attn_norm_gpu4&#45;&gt;layer3_q_proj_gpu4 -->
<g id="edge750" class="edge">
<title>layer3_attn_norm_gpu4&#45;&gt;layer3_q_proj_gpu4</title>
<path fill="none" stroke="black" d="M3997.27,-3691.32C3997.27,-3691.32 3997.27,-3615.58 3997.27,-3615.58"/>
<polygon fill="black" stroke="black" points="4000.77,-3615.58 3997.27,-3605.58 3993.77,-3615.58 4000.77,-3615.58"/>
</g>
<!-- layer3_k_proj_gpu4 -->
<g id="node576" class="node">
<title>layer3_k_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="4665.77,-3605.5 4164.77,-3605.5 4164.77,-3537.5 4665.77,-3537.5 4665.77,-3605.5"/>
<text text-anchor="middle" x="4415.27" y="-3590.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4415.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4415.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4415.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_attn_norm_gpu4&#45;&gt;layer3_k_proj_gpu4 -->
<g id="edge751" class="edge">
<title>layer3_attn_norm_gpu4&#45;&gt;layer3_k_proj_gpu4</title>
<path fill="none" stroke="black" d="M4274.77,-3691.32C4274.77,-3691.32 4274.77,-3615.58 4274.77,-3615.58"/>
<polygon fill="black" stroke="black" points="4278.27,-3615.58 4274.77,-3605.58 4271.27,-3615.58 4278.27,-3615.58"/>
</g>
<!-- layer3_v_proj_gpu4 -->
<g id="node577" class="node">
<title>layer3_v_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="3547.77,-3605.5 3046.77,-3605.5 3046.77,-3537.5 3547.77,-3537.5 3547.77,-3605.5"/>
<text text-anchor="middle" x="3297.27" y="-3590.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="3297.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3297.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3297.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_attn_norm_gpu4&#45;&gt;layer3_v_proj_gpu4 -->
<g id="edge752" class="edge">
<title>layer3_attn_norm_gpu4&#45;&gt;layer3_v_proj_gpu4</title>
<path fill="none" stroke="black" d="M3887.64,-3725C3662.67,-3725 3366.38,-3725 3366.38,-3725 3366.38,-3725 3366.38,-3615.57 3366.38,-3615.57"/>
<polygon fill="black" stroke="black" points="3369.88,-3615.57 3366.38,-3605.57 3362.88,-3615.57 3369.88,-3615.57"/>
</g>
<!-- layer3_gather_q_gpu4 -->
<g id="node578" class="node">
<title>layer3_gather_q_gpu4</title>
<ellipse fill="lightblue" stroke="black" cx="3746.27" cy="-3403.42" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="3746.27" y="-3422.22" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="3746.27" y="-3407.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3746.27" y="-3392.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3746.27" y="-3377.22" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_q_proj_gpu4&#45;&gt;layer3_gather_q_gpu4 -->
<g id="edge753" class="edge">
<title>layer3_q_proj_gpu4&#45;&gt;layer3_gather_q_gpu4</title>
<path fill="none" stroke="black" d="M3856.27,-3537.48C3856.27,-3537.48 3856.27,-3459.48 3856.27,-3459.48"/>
<polygon fill="black" stroke="black" points="3859.77,-3459.48 3856.27,-3449.48 3852.77,-3459.48 3859.77,-3459.48"/>
</g>
<!-- layer3_gather_k_gpu4 -->
<g id="node579" class="node">
<title>layer3_gather_k_gpu4</title>
<ellipse fill="lightblue" stroke="black" cx="4525.27" cy="-3403.42" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="4525.27" y="-3422.22" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="4525.27" y="-3407.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4525.27" y="-3392.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4525.27" y="-3377.22" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_k_proj_gpu4&#45;&gt;layer3_gather_k_gpu4 -->
<g id="edge754" class="edge">
<title>layer3_k_proj_gpu4&#45;&gt;layer3_gather_k_gpu4</title>
<path fill="none" stroke="black" d="M4415.27,-3537.48C4415.27,-3537.48 4415.27,-3459.48 4415.27,-3459.48"/>
<polygon fill="black" stroke="black" points="4418.77,-3459.48 4415.27,-3449.48 4411.77,-3459.48 4418.77,-3459.48"/>
</g>
<!-- layer3_gather_v_gpu4 -->
<g id="node580" class="node">
<title>layer3_gather_v_gpu4</title>
<ellipse fill="lightblue" stroke="black" cx="3428.27" cy="-3039.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="3428.27" y="-3057.88" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="3428.27" y="-3042.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3428.27" y="-3027.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3428.27" y="-3012.88" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_v_proj_gpu4&#45;&gt;layer3_gather_v_gpu4 -->
<g id="edge755" class="edge">
<title>layer3_v_proj_gpu4&#45;&gt;layer3_gather_v_gpu4</title>
<path fill="none" stroke="black" d="M3297.27,-3537.38C3297.27,-3537.38 3297.27,-3094.25 3297.27,-3094.25"/>
<polygon fill="black" stroke="black" points="3300.77,-3094.25 3297.27,-3084.25 3293.77,-3094.25 3300.77,-3094.25"/>
</g>
<!-- layer3_attn_scores_gpu4 -->
<g id="node581" class="node">
<title>layer3_attn_scores_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="4460.77,-3255.25 3921.77,-3255.25 3921.77,-3187.25 4460.77,-3187.25 4460.77,-3255.25"/>
<text text-anchor="middle" x="4191.27" y="-3240.05" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="4191.27" y="-3225.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4191.27" y="-3210.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="4191.27" y="-3195.05" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gather_q_gpu4&#45;&gt;layer3_attn_scores_gpu4 -->
<g id="edge756" class="edge">
<title>layer3_gather_q_gpu4&#45;&gt;layer3_attn_scores_gpu4</title>
<path fill="none" stroke="black" d="M4014.33,-3370.85C4014.33,-3370.85 4014.33,-3265.39 4014.33,-3265.39"/>
<polygon fill="black" stroke="black" points="4017.83,-3265.39 4014.33,-3255.39 4010.83,-3265.39 4017.83,-3265.39"/>
</g>
<!-- layer3_gather_k_gpu4&#45;&gt;layer3_attn_scores_gpu4 -->
<g id="edge757" class="edge">
<title>layer3_gather_k_gpu4&#45;&gt;layer3_attn_scores_gpu4</title>
<path fill="none" stroke="black" d="M4312.7,-3364.34C4312.7,-3364.34 4312.7,-3265.36 4312.7,-3265.36"/>
<polygon fill="black" stroke="black" points="4316.2,-3265.36 4312.7,-3255.36 4309.2,-3265.36 4316.2,-3265.36"/>
</g>
<!-- layer3_attn_out_gpu4 -->
<g id="node583" class="node">
<title>layer3_attn_out_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="4454.77,-2905 3927.77,-2905 3927.77,-2837 4454.77,-2837 4454.77,-2905"/>
<text text-anchor="middle" x="4191.27" y="-2889.8" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="4191.27" y="-2874.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="4191.27" y="-2859.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4191.27" y="-2844.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_gather_v_gpu4&#45;&gt;layer3_attn_out_gpu4 -->
<g id="edge760" class="edge">
<title>layer3_gather_v_gpu4&#45;&gt;layer3_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M3580.33,-2995.33C3580.33,-2948.85 3580.33,-2882 3580.33,-2882 3580.33,-2882 3917.74,-2882 3917.74,-2882"/>
<polygon fill="black" stroke="black" points="3917.74,-2885.5 3927.74,-2882 3917.74,-2878.5 3917.74,-2885.5"/>
</g>
<!-- layer3_softmax_gpu4 -->
<g id="node582" class="node">
<title>layer3_softmax_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="4460.77,-3073.08 3921.77,-3073.08 3921.77,-3005.08 4460.77,-3005.08 4460.77,-3073.08"/>
<text text-anchor="middle" x="4191.27" y="-3057.88" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="4191.27" y="-3042.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="4191.27" y="-3027.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="4191.27" y="-3012.88" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_attn_scores_gpu4&#45;&gt;layer3_softmax_gpu4 -->
<g id="edge758" class="edge">
<title>layer3_attn_scores_gpu4&#45;&gt;layer3_softmax_gpu4</title>
<path fill="none" stroke="black" d="M4191.27,-3186.98C4191.27,-3186.98 4191.27,-3083.19 4191.27,-3083.19"/>
<polygon fill="black" stroke="black" points="4194.77,-3083.19 4191.27,-3073.19 4187.77,-3083.19 4194.77,-3083.19"/>
</g>
<!-- layer3_softmax_gpu4&#45;&gt;layer3_attn_out_gpu4 -->
<g id="edge759" class="edge">
<title>layer3_softmax_gpu4&#45;&gt;layer3_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M4191.27,-3005.07C4191.27,-3005.07 4191.27,-2915.25 4191.27,-2915.25"/>
<polygon fill="black" stroke="black" points="4194.77,-2915.25 4191.27,-2905.25 4187.77,-2915.25 4194.77,-2915.25"/>
</g>
<!-- layer3_out_proj_gpu4 -->
<g id="node584" class="node">
<title>layer3_out_proj_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="5214.77,-2751 4725.77,-2751 4725.77,-2683 5214.77,-2683 5214.77,-2751"/>
<text text-anchor="middle" x="4970.27" y="-2735.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4970.27" y="-2720.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4970.27" y="-2705.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="4970.27" y="-2690.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer3_attn_out_gpu4&#45;&gt;layer3_out_proj_gpu4 -->
<g id="edge761" class="edge">
<title>layer3_attn_out_gpu4&#45;&gt;layer3_out_proj_gpu4</title>
<path fill="none" stroke="black" d="M4455,-2859C4680.99,-2859 4970.27,-2859 4970.27,-2859 4970.27,-2859 4970.27,-2761.01 4970.27,-2761.01"/>
<polygon fill="black" stroke="black" points="4973.77,-2761.01 4970.27,-2751.01 4966.77,-2761.01 4973.77,-2761.01"/>
</g>
<!-- layer3_out_proj_gpu4&#45;&gt;layer3_attn_all_reduce -->
<g id="edge805" class="edge">
<title>layer3_out_proj_gpu4&#45;&gt;layer3_attn_all_reduce</title>
<path fill="none" stroke="black" d="M4970.27,-2682.66C4970.27,-2637.55 4970.27,-2564 4970.27,-2564 4970.27,-2564 6589.44,-2564 6589.44,-2564"/>
<polygon fill="black" stroke="black" points="6589.44,-2567.5 6599.44,-2564 6589.44,-2560.5 6589.44,-2567.5"/>
</g>
<!-- layer3_q_proj_gpu5 -->
<g id="node586" class="node">
<title>layer3_q_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="5783.77,-3605.5 5282.77,-3605.5 5282.77,-3537.5 5783.77,-3537.5 5783.77,-3605.5"/>
<text text-anchor="middle" x="5533.27" y="-3590.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5533.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5533.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5533.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_attn_norm_gpu5&#45;&gt;layer3_q_proj_gpu5 -->
<g id="edge763" class="edge">
<title>layer3_attn_norm_gpu5&#45;&gt;layer3_q_proj_gpu5</title>
<path fill="none" stroke="black" d="M5674.27,-3691.32C5674.27,-3691.32 5674.27,-3615.58 5674.27,-3615.58"/>
<polygon fill="black" stroke="black" points="5677.77,-3615.58 5674.27,-3605.58 5670.77,-3615.58 5677.77,-3615.58"/>
</g>
<!-- layer3_k_proj_gpu5 -->
<g id="node587" class="node">
<title>layer3_k_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="6342.77,-3605.5 5841.77,-3605.5 5841.77,-3537.5 6342.77,-3537.5 6342.77,-3605.5"/>
<text text-anchor="middle" x="6092.27" y="-3590.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6092.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6092.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6092.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_attn_norm_gpu5&#45;&gt;layer3_k_proj_gpu5 -->
<g id="edge764" class="edge">
<title>layer3_attn_norm_gpu5&#45;&gt;layer3_k_proj_gpu5</title>
<path fill="none" stroke="black" d="M5951.77,-3691.32C5951.77,-3691.32 5951.77,-3615.58 5951.77,-3615.58"/>
<polygon fill="black" stroke="black" points="5955.27,-3615.58 5951.77,-3605.58 5948.27,-3615.58 5955.27,-3615.58"/>
</g>
<!-- layer3_v_proj_gpu5 -->
<g id="node588" class="node">
<title>layer3_v_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="5224.77,-3605.5 4723.77,-3605.5 4723.77,-3537.5 5224.77,-3537.5 5224.77,-3605.5"/>
<text text-anchor="middle" x="4974.27" y="-3590.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4974.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4974.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4974.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_attn_norm_gpu5&#45;&gt;layer3_v_proj_gpu5 -->
<g id="edge765" class="edge">
<title>layer3_attn_norm_gpu5&#45;&gt;layer3_v_proj_gpu5</title>
<path fill="none" stroke="black" d="M5564.66,-3725C5317.28,-3725 4974.27,-3725 4974.27,-3725 4974.27,-3725 4974.27,-3615.57 4974.27,-3615.57"/>
<polygon fill="black" stroke="black" points="4977.77,-3615.57 4974.27,-3605.57 4970.77,-3615.57 4977.77,-3615.57"/>
</g>
<!-- layer3_gather_q_gpu5 -->
<g id="node589" class="node">
<title>layer3_gather_q_gpu5</title>
<ellipse fill="lightblue" stroke="black" cx="5423.27" cy="-3403.42" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="5423.27" y="-3422.22" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="5423.27" y="-3407.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5423.27" y="-3392.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5423.27" y="-3377.22" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_q_proj_gpu5&#45;&gt;layer3_gather_q_gpu5 -->
<g id="edge766" class="edge">
<title>layer3_q_proj_gpu5&#45;&gt;layer3_gather_q_gpu5</title>
<path fill="none" stroke="black" d="M5533.27,-3537.48C5533.27,-3537.48 5533.27,-3459.48 5533.27,-3459.48"/>
<polygon fill="black" stroke="black" points="5536.77,-3459.48 5533.27,-3449.48 5529.77,-3459.48 5536.77,-3459.48"/>
</g>
<!-- layer3_gather_k_gpu5 -->
<g id="node590" class="node">
<title>layer3_gather_k_gpu5</title>
<ellipse fill="lightblue" stroke="black" cx="6202.27" cy="-3403.42" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="6202.27" y="-3422.22" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="6202.27" y="-3407.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6202.27" y="-3392.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6202.27" y="-3377.22" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_k_proj_gpu5&#45;&gt;layer3_gather_k_gpu5 -->
<g id="edge767" class="edge">
<title>layer3_k_proj_gpu5&#45;&gt;layer3_gather_k_gpu5</title>
<path fill="none" stroke="black" d="M6092.27,-3537.48C6092.27,-3537.48 6092.27,-3459.48 6092.27,-3459.48"/>
<polygon fill="black" stroke="black" points="6095.77,-3459.48 6092.27,-3449.48 6088.77,-3459.48 6095.77,-3459.48"/>
</g>
<!-- layer3_gather_v_gpu5 -->
<g id="node591" class="node">
<title>layer3_gather_v_gpu5</title>
<ellipse fill="lightblue" stroke="black" cx="5029.27" cy="-3221.25" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="5029.27" y="-3240.05" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="5029.27" y="-3225.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5029.27" y="-3210.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5029.27" y="-3195.05" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_v_proj_gpu5&#45;&gt;layer3_gather_v_gpu5 -->
<g id="edge768" class="edge">
<title>layer3_v_proj_gpu5&#45;&gt;layer3_gather_v_gpu5</title>
<path fill="none" stroke="black" d="M4974.27,-3537.28C4974.27,-3537.28 4974.27,-3278.91 4974.27,-3278.91"/>
<polygon fill="black" stroke="black" points="4977.77,-3278.91 4974.27,-3268.91 4970.77,-3278.91 4977.77,-3278.91"/>
</g>
<!-- layer3_attn_scores_gpu5 -->
<g id="node592" class="node">
<title>layer3_attn_scores_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="6096.77,-3255.25 5557.77,-3255.25 5557.77,-3187.25 6096.77,-3187.25 6096.77,-3255.25"/>
<text text-anchor="middle" x="5827.27" y="-3240.05" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="5827.27" y="-3225.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5827.27" y="-3210.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="5827.27" y="-3195.05" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gather_q_gpu5&#45;&gt;layer3_attn_scores_gpu5 -->
<g id="edge769" class="edge">
<title>layer3_gather_q_gpu5&#45;&gt;layer3_attn_scores_gpu5</title>
<path fill="none" stroke="black" d="M5670.83,-3368.29C5670.83,-3368.29 5670.83,-3265.34 5670.83,-3265.34"/>
<polygon fill="black" stroke="black" points="5674.33,-3265.34 5670.83,-3255.34 5667.33,-3265.34 5674.33,-3265.34"/>
</g>
<!-- layer3_gather_k_gpu5&#45;&gt;layer3_attn_scores_gpu5 -->
<g id="edge770" class="edge">
<title>layer3_gather_k_gpu5&#45;&gt;layer3_attn_scores_gpu5</title>
<path fill="none" stroke="black" d="M5969.2,-3366.55C5969.2,-3366.55 5969.2,-3265.29 5969.2,-3265.29"/>
<polygon fill="black" stroke="black" points="5972.7,-3265.29 5969.2,-3255.29 5965.7,-3265.29 5972.7,-3265.29"/>
</g>
<!-- layer3_attn_out_gpu5 -->
<g id="node594" class="node">
<title>layer3_attn_out_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="6090.77,-2905 5563.77,-2905 5563.77,-2837 6090.77,-2837 6090.77,-2905"/>
<text text-anchor="middle" x="5827.27" y="-2889.8" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="5827.27" y="-2874.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="5827.27" y="-2859.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5827.27" y="-2844.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_gather_v_gpu5&#45;&gt;layer3_attn_out_gpu5 -->
<g id="edge773" class="edge">
<title>layer3_gather_v_gpu5&#45;&gt;layer3_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M5302.33,-3189.64C5302.33,-3105.42 5302.33,-2882 5302.33,-2882 5302.33,-2882 5553.64,-2882 5553.64,-2882"/>
<polygon fill="black" stroke="black" points="5553.64,-2885.5 5563.64,-2882 5553.64,-2878.5 5553.64,-2885.5"/>
</g>
<!-- layer3_softmax_gpu5 -->
<g id="node593" class="node">
<title>layer3_softmax_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="6096.77,-3073.08 5557.77,-3073.08 5557.77,-3005.08 6096.77,-3005.08 6096.77,-3073.08"/>
<text text-anchor="middle" x="5827.27" y="-3057.88" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="5827.27" y="-3042.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="5827.27" y="-3027.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="5827.27" y="-3012.88" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_attn_scores_gpu5&#45;&gt;layer3_softmax_gpu5 -->
<g id="edge771" class="edge">
<title>layer3_attn_scores_gpu5&#45;&gt;layer3_softmax_gpu5</title>
<path fill="none" stroke="black" d="M5827.27,-3186.98C5827.27,-3186.98 5827.27,-3083.19 5827.27,-3083.19"/>
<polygon fill="black" stroke="black" points="5830.77,-3083.19 5827.27,-3073.19 5823.77,-3083.19 5830.77,-3083.19"/>
</g>
<!-- layer3_softmax_gpu5&#45;&gt;layer3_attn_out_gpu5 -->
<g id="edge772" class="edge">
<title>layer3_softmax_gpu5&#45;&gt;layer3_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M5827.27,-3005.07C5827.27,-3005.07 5827.27,-2915.25 5827.27,-2915.25"/>
<polygon fill="black" stroke="black" points="5830.77,-2915.25 5827.27,-2905.25 5823.77,-2915.25 5830.77,-2915.25"/>
</g>
<!-- layer3_out_proj_gpu5 -->
<g id="node595" class="node">
<title>layer3_out_proj_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="6409.77,-2751 5920.77,-2751 5920.77,-2683 6409.77,-2683 6409.77,-2751"/>
<text text-anchor="middle" x="6165.27" y="-2735.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6165.27" y="-2720.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6165.27" y="-2705.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="6165.27" y="-2690.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer3_attn_out_gpu5&#45;&gt;layer3_out_proj_gpu5 -->
<g id="edge774" class="edge">
<title>layer3_attn_out_gpu5&#45;&gt;layer3_out_proj_gpu5</title>
<path fill="none" stroke="black" d="M6005.77,-2836.82C6005.77,-2836.82 6005.77,-2761.08 6005.77,-2761.08"/>
<polygon fill="black" stroke="black" points="6009.27,-2761.08 6005.77,-2751.08 6002.27,-2761.08 6009.27,-2761.08"/>
</g>
<!-- layer3_out_proj_gpu5&#45;&gt;layer3_attn_all_reduce -->
<g id="edge806" class="edge">
<title>layer3_out_proj_gpu5&#45;&gt;layer3_attn_all_reduce</title>
<path fill="none" stroke="black" d="M6410.03,-2716C6520.13,-2716 6625.8,-2716 6625.8,-2716 6625.8,-2716 6625.8,-2582.5 6625.8,-2582.5"/>
<polygon fill="black" stroke="black" points="6629.3,-2582.5 6625.8,-2572.5 6622.3,-2582.5 6629.3,-2582.5"/>
</g>
<!-- layer3_q_proj_gpu6 -->
<g id="node597" class="node">
<title>layer3_q_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="7460.77,-3605.5 6959.77,-3605.5 6959.77,-3537.5 7460.77,-3537.5 7460.77,-3605.5"/>
<text text-anchor="middle" x="7210.27" y="-3590.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7210.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7210.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7210.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_attn_norm_gpu6&#45;&gt;layer3_q_proj_gpu6 -->
<g id="edge776" class="edge">
<title>layer3_attn_norm_gpu6&#45;&gt;layer3_q_proj_gpu6</title>
<path fill="none" stroke="black" d="M7210.27,-3691.32C7210.27,-3691.32 7210.27,-3615.58 7210.27,-3615.58"/>
<polygon fill="black" stroke="black" points="7213.77,-3615.58 7210.27,-3605.58 7206.77,-3615.58 7213.77,-3615.58"/>
</g>
<!-- layer3_k_proj_gpu6 -->
<g id="node598" class="node">
<title>layer3_k_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="8019.77,-3605.5 7518.77,-3605.5 7518.77,-3537.5 8019.77,-3537.5 8019.77,-3605.5"/>
<text text-anchor="middle" x="7769.27" y="-3590.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7769.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7769.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7769.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_attn_norm_gpu6&#45;&gt;layer3_k_proj_gpu6 -->
<g id="edge777" class="edge">
<title>layer3_attn_norm_gpu6&#45;&gt;layer3_k_proj_gpu6</title>
<path fill="none" stroke="black" d="M7459.1,-3725C7574.98,-3725 7687.66,-3725 7687.66,-3725 7687.66,-3725 7687.66,-3615.57 7687.66,-3615.57"/>
<polygon fill="black" stroke="black" points="7691.16,-3615.57 7687.66,-3605.57 7684.16,-3615.57 7691.16,-3615.57"/>
</g>
<!-- layer3_v_proj_gpu6 -->
<g id="node599" class="node">
<title>layer3_v_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="6901.77,-3605.5 6400.77,-3605.5 6400.77,-3537.5 6901.77,-3537.5 6901.77,-3605.5"/>
<text text-anchor="middle" x="6651.27" y="-3590.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6651.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6651.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6651.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_attn_norm_gpu6&#45;&gt;layer3_v_proj_gpu6 -->
<g id="edge778" class="edge">
<title>layer3_attn_norm_gpu6&#45;&gt;layer3_v_proj_gpu6</title>
<path fill="none" stroke="black" d="M6961.66,-3714C6870.49,-3714 6789.17,-3714 6789.17,-3714 6789.17,-3714 6789.17,-3615.63 6789.17,-3615.63"/>
<polygon fill="black" stroke="black" points="6792.67,-3615.63 6789.17,-3605.63 6785.67,-3615.63 6792.67,-3615.63"/>
</g>
<!-- layer3_gather_q_gpu6 -->
<g id="node600" class="node">
<title>layer3_gather_q_gpu6</title>
<ellipse fill="lightblue" stroke="black" cx="7100.27" cy="-3403.42" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="7100.27" y="-3422.22" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="7100.27" y="-3407.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7100.27" y="-3392.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7100.27" y="-3377.22" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_q_proj_gpu6&#45;&gt;layer3_gather_q_gpu6 -->
<g id="edge779" class="edge">
<title>layer3_q_proj_gpu6&#45;&gt;layer3_gather_q_gpu6</title>
<path fill="none" stroke="black" d="M7210.27,-3537.48C7210.27,-3537.48 7210.27,-3459.48 7210.27,-3459.48"/>
<polygon fill="black" stroke="black" points="7213.77,-3459.48 7210.27,-3449.48 7206.77,-3459.48 7213.77,-3459.48"/>
</g>
<!-- layer3_gather_k_gpu6 -->
<g id="node601" class="node">
<title>layer3_gather_k_gpu6</title>
<ellipse fill="lightblue" stroke="black" cx="7879.27" cy="-3403.42" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="7879.27" y="-3422.22" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="7879.27" y="-3407.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="7879.27" y="-3392.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7879.27" y="-3377.22" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_k_proj_gpu6&#45;&gt;layer3_gather_k_gpu6 -->
<g id="edge780" class="edge">
<title>layer3_k_proj_gpu6&#45;&gt;layer3_gather_k_gpu6</title>
<path fill="none" stroke="black" d="M7769.27,-3537.48C7769.27,-3537.48 7769.27,-3459.48 7769.27,-3459.48"/>
<polygon fill="black" stroke="black" points="7772.77,-3459.48 7769.27,-3449.48 7765.77,-3459.48 7772.77,-3459.48"/>
</g>
<!-- layer3_gather_v_gpu6 -->
<g id="node602" class="node">
<title>layer3_gather_v_gpu6</title>
<ellipse fill="lightblue" stroke="black" cx="6651.27" cy="-3039.08" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="6651.27" y="-3057.88" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="6651.27" y="-3042.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6651.27" y="-3027.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6651.27" y="-3012.88" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_v_proj_gpu6&#45;&gt;layer3_gather_v_gpu6 -->
<g id="edge781" class="edge">
<title>layer3_v_proj_gpu6&#45;&gt;layer3_gather_v_gpu6</title>
<path fill="none" stroke="black" d="M6651.27,-3537.38C6651.27,-3537.38 6651.27,-3097.4 6651.27,-3097.4"/>
<polygon fill="black" stroke="black" points="6654.77,-3097.4 6651.27,-3087.4 6647.77,-3097.4 6654.77,-3097.4"/>
</g>
<!-- layer3_attn_scores_gpu6 -->
<g id="node603" class="node">
<title>layer3_attn_scores_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="7608.77,-3255.25 7069.77,-3255.25 7069.77,-3187.25 7608.77,-3187.25 7608.77,-3255.25"/>
<text text-anchor="middle" x="7339.27" y="-3240.05" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="7339.27" y="-3225.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7339.27" y="-3210.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="7339.27" y="-3195.05" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gather_q_gpu6&#45;&gt;layer3_attn_scores_gpu6 -->
<g id="edge782" class="edge">
<title>layer3_gather_q_gpu6&#45;&gt;layer3_attn_scores_gpu6</title>
<path fill="none" stroke="black" d="M7265.33,-3360.24C7265.33,-3360.24 7265.33,-3265.3 7265.33,-3265.3"/>
<polygon fill="black" stroke="black" points="7268.83,-3265.3 7265.33,-3255.3 7261.83,-3265.3 7268.83,-3265.3"/>
</g>
<!-- layer3_gather_k_gpu6&#45;&gt;layer3_attn_scores_gpu6 -->
<g id="edge783" class="edge">
<title>layer3_gather_k_gpu6&#45;&gt;layer3_attn_scores_gpu6</title>
<path fill="none" stroke="black" d="M7563.7,-3379.97C7563.7,-3379.97 7563.7,-3265.47 7563.7,-3265.47"/>
<polygon fill="black" stroke="black" points="7567.2,-3265.47 7563.7,-3255.47 7560.2,-3265.47 7567.2,-3265.47"/>
</g>
<!-- layer3_attn_out_gpu6 -->
<g id="node605" class="node">
<title>layer3_attn_out_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="7196.77,-2905 6669.77,-2905 6669.77,-2837 7196.77,-2837 7196.77,-2905"/>
<text text-anchor="middle" x="6933.27" y="-2889.8" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="6933.27" y="-2874.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="6933.27" y="-2859.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6933.27" y="-2844.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_gather_v_gpu6&#45;&gt;layer3_attn_out_gpu6 -->
<g id="edge786" class="edge">
<title>layer3_gather_v_gpu6&#45;&gt;layer3_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M6840.83,-2997.96C6840.83,-2997.96 6840.83,-2915.18 6840.83,-2915.18"/>
<polygon fill="black" stroke="black" points="6844.33,-2915.18 6840.83,-2905.18 6837.33,-2915.19 6844.33,-2915.18"/>
</g>
<!-- layer3_softmax_gpu6 -->
<g id="node604" class="node">
<title>layer3_softmax_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="7608.77,-3073.08 7069.77,-3073.08 7069.77,-3005.08 7608.77,-3005.08 7608.77,-3073.08"/>
<text text-anchor="middle" x="7339.27" y="-3057.88" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="7339.27" y="-3042.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="7339.27" y="-3027.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="7339.27" y="-3012.88" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_attn_scores_gpu6&#45;&gt;layer3_softmax_gpu6 -->
<g id="edge784" class="edge">
<title>layer3_attn_scores_gpu6&#45;&gt;layer3_softmax_gpu6</title>
<path fill="none" stroke="black" d="M7339.27,-3186.98C7339.27,-3186.98 7339.27,-3083.19 7339.27,-3083.19"/>
<polygon fill="black" stroke="black" points="7342.77,-3083.19 7339.27,-3073.19 7335.77,-3083.19 7342.77,-3083.19"/>
</g>
<!-- layer3_softmax_gpu6&#45;&gt;layer3_attn_out_gpu6 -->
<g id="edge785" class="edge">
<title>layer3_softmax_gpu6&#45;&gt;layer3_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M7133.27,-3005.07C7133.27,-3005.07 7133.27,-2915.25 7133.27,-2915.25"/>
<polygon fill="black" stroke="black" points="7136.77,-2915.25 7133.27,-2905.25 7129.77,-2915.25 7136.77,-2915.25"/>
</g>
<!-- layer3_out_proj_gpu6 -->
<g id="node606" class="node">
<title>layer3_out_proj_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="7177.77,-2751 6688.77,-2751 6688.77,-2683 7177.77,-2683 7177.77,-2751"/>
<text text-anchor="middle" x="6933.27" y="-2735.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6933.27" y="-2720.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="6933.27" y="-2705.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="6933.27" y="-2690.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer3_attn_out_gpu6&#45;&gt;layer3_out_proj_gpu6 -->
<g id="edge787" class="edge">
<title>layer3_attn_out_gpu6&#45;&gt;layer3_out_proj_gpu6</title>
<path fill="none" stroke="black" d="M6933.27,-2836.82C6933.27,-2836.82 6933.27,-2761.08 6933.27,-2761.08"/>
<polygon fill="black" stroke="black" points="6936.77,-2761.08 6933.27,-2751.08 6929.77,-2761.08 6936.77,-2761.08"/>
</g>
<!-- layer3_out_proj_gpu6&#45;&gt;layer3_attn_all_reduce -->
<g id="edge807" class="edge">
<title>layer3_out_proj_gpu6&#45;&gt;layer3_attn_all_reduce</title>
<path fill="none" stroke="black" d="M6933.27,-2682.98C6933.27,-2682.98 6933.27,-2607.21 6933.27,-2607.21"/>
<polygon fill="black" stroke="black" points="6936.77,-2607.21 6933.27,-2597.21 6929.77,-2607.21 6936.77,-2607.21"/>
</g>
<!-- layer3_q_proj_gpu7 -->
<g id="node608" class="node">
<title>layer3_q_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="9137.77,-3605.5 8636.77,-3605.5 8636.77,-3537.5 9137.77,-3537.5 9137.77,-3605.5"/>
<text text-anchor="middle" x="8887.27" y="-3590.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8887.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8887.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8887.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_attn_norm_gpu7&#45;&gt;layer3_q_proj_gpu7 -->
<g id="edge789" class="edge">
<title>layer3_attn_norm_gpu7&#45;&gt;layer3_q_proj_gpu7</title>
<path fill="none" stroke="black" d="M8746.27,-3691.32C8746.27,-3691.32 8746.27,-3615.58 8746.27,-3615.58"/>
<polygon fill="black" stroke="black" points="8749.77,-3615.58 8746.27,-3605.58 8742.77,-3615.58 8749.77,-3615.58"/>
</g>
<!-- layer3_k_proj_gpu7 -->
<g id="node609" class="node">
<title>layer3_k_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="9696.77,-3605.5 9195.77,-3605.5 9195.77,-3537.5 9696.77,-3537.5 9696.77,-3605.5"/>
<text text-anchor="middle" x="9446.27" y="-3590.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="9446.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9446.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9446.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_attn_norm_gpu7&#45;&gt;layer3_k_proj_gpu7 -->
<g id="edge790" class="edge">
<title>layer3_attn_norm_gpu7&#45;&gt;layer3_k_proj_gpu7</title>
<path fill="none" stroke="black" d="M8856.01,-3725C9121.89,-3725 9505.61,-3725 9505.61,-3725 9505.61,-3725 9505.61,-3615.57 9505.61,-3615.57"/>
<polygon fill="black" stroke="black" points="9509.11,-3615.57 9505.61,-3605.57 9502.11,-3615.57 9509.11,-3615.57"/>
</g>
<!-- layer3_v_proj_gpu7 -->
<g id="node610" class="node">
<title>layer3_v_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="8578.77,-3605.5 8077.77,-3605.5 8077.77,-3537.5 8578.77,-3537.5 8578.77,-3605.5"/>
<text text-anchor="middle" x="8328.27" y="-3590.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8328.27" y="-3575.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8328.27" y="-3560.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8328.27" y="-3545.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_attn_norm_gpu7&#45;&gt;layer3_v_proj_gpu7 -->
<g id="edge791" class="edge">
<title>layer3_attn_norm_gpu7&#45;&gt;layer3_v_proj_gpu7</title>
<path fill="none" stroke="black" d="M8468.77,-3691.32C8468.77,-3691.32 8468.77,-3615.58 8468.77,-3615.58"/>
<polygon fill="black" stroke="black" points="8472.27,-3615.58 8468.77,-3605.58 8465.27,-3615.58 8472.27,-3615.58"/>
</g>
<!-- layer3_gather_q_gpu7 -->
<g id="node611" class="node">
<title>layer3_gather_q_gpu7</title>
<ellipse fill="lightblue" stroke="black" cx="8777.27" cy="-3403.42" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="8777.27" y="-3422.22" font-family="Times,serif" font-size="14.00">All&#45;Gather Q</text>
<text text-anchor="middle" x="8777.27" y="-3407.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8777.27" y="-3392.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8777.27" y="-3377.22" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_q_proj_gpu7&#45;&gt;layer3_gather_q_gpu7 -->
<g id="edge792" class="edge">
<title>layer3_q_proj_gpu7&#45;&gt;layer3_gather_q_gpu7</title>
<path fill="none" stroke="black" d="M8887.27,-3537.48C8887.27,-3537.48 8887.27,-3459.48 8887.27,-3459.48"/>
<polygon fill="black" stroke="black" points="8890.77,-3459.48 8887.27,-3449.48 8883.77,-3459.48 8890.77,-3459.48"/>
</g>
<!-- layer3_gather_k_gpu7 -->
<g id="node612" class="node">
<title>layer3_gather_k_gpu7</title>
<ellipse fill="lightblue" stroke="black" cx="9556.27" cy="-3403.42" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="9556.27" y="-3422.22" font-family="Times,serif" font-size="14.00">All&#45;Gather K</text>
<text text-anchor="middle" x="9556.27" y="-3407.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9556.27" y="-3392.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9556.27" y="-3377.22" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_k_proj_gpu7&#45;&gt;layer3_gather_k_gpu7 -->
<g id="edge793" class="edge">
<title>layer3_k_proj_gpu7&#45;&gt;layer3_gather_k_gpu7</title>
<path fill="none" stroke="black" d="M9446.27,-3537.48C9446.27,-3537.48 9446.27,-3459.48 9446.27,-3459.48"/>
<polygon fill="black" stroke="black" points="9449.77,-3459.48 9446.27,-3449.48 9442.77,-3459.48 9449.77,-3459.48"/>
</g>
<!-- layer3_gather_v_gpu7 -->
<g id="node613" class="node">
<title>layer3_gather_v_gpu7</title>
<ellipse fill="lightblue" stroke="black" cx="8209.27" cy="-3221.25" rx="360.75" ry="48.17"/>
<text text-anchor="middle" x="8209.27" y="-3240.05" font-family="Times,serif" font-size="14.00">All&#45;Gather V</text>
<text text-anchor="middle" x="8209.27" y="-3225.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8209.27" y="-3210.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8209.27" y="-3195.05" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_v_proj_gpu7&#45;&gt;layer3_gather_v_gpu7 -->
<g id="edge794" class="edge">
<title>layer3_v_proj_gpu7&#45;&gt;layer3_gather_v_gpu7</title>
<path fill="none" stroke="black" d="M8328.27,-3537.28C8328.27,-3537.28 8328.27,-3276.86 8328.27,-3276.86"/>
<polygon fill="black" stroke="black" points="8331.77,-3276.86 8328.27,-3266.86 8324.77,-3276.86 8331.77,-3276.86"/>
</g>
<!-- layer3_attn_scores_gpu7 -->
<g id="node614" class="node">
<title>layer3_attn_scores_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="9166.77,-3255.25 8627.77,-3255.25 8627.77,-3187.25 9166.77,-3187.25 9166.77,-3255.25"/>
<text text-anchor="middle" x="8897.27" y="-3240.05" font-family="Times,serif" font-size="14.00">QK^T / sqrt(d_k)</text>
<text text-anchor="middle" x="8897.27" y="-3225.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8897.27" y="-3210.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="8897.27" y="-3195.05" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gather_q_gpu7&#45;&gt;layer3_attn_scores_gpu7 -->
<g id="edge795" class="edge">
<title>layer3_gather_q_gpu7&#45;&gt;layer3_attn_scores_gpu7</title>
<path fill="none" stroke="black" d="M8882.83,-3356.98C8882.83,-3356.98 8882.83,-3265.52 8882.83,-3265.52"/>
<polygon fill="black" stroke="black" points="8886.33,-3265.52 8882.83,-3255.52 8879.33,-3265.52 8886.33,-3265.52"/>
</g>
<!-- layer3_gather_k_gpu7&#45;&gt;layer3_attn_scores_gpu7 -->
<g id="edge796" class="edge">
<title>layer3_gather_k_gpu7&#45;&gt;layer3_attn_scores_gpu7</title>
<path fill="none" stroke="black" d="M9195.56,-3403C9168.99,-3403 9152.33,-3403 9152.33,-3403 9152.33,-3403 9152.33,-3265.43 9152.33,-3265.43"/>
<polygon fill="black" stroke="black" points="9155.83,-3265.43 9152.33,-3255.43 9148.83,-3265.43 9155.83,-3265.43"/>
</g>
<!-- layer3_attn_out_gpu7 -->
<g id="node616" class="node">
<title>layer3_attn_out_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="8472.77,-2905 7945.77,-2905 7945.77,-2837 8472.77,-2837 8472.77,-2905"/>
<text text-anchor="middle" x="8209.27" y="-2889.8" font-family="Times,serif" font-size="14.00">Attention×V</text>
<text text-anchor="middle" x="8209.27" y="-2874.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="8209.27" y="-2859.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8209.27" y="-2844.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_gather_v_gpu7&#45;&gt;layer3_attn_out_gpu7 -->
<g id="edge799" class="edge">
<title>layer3_gather_v_gpu7&#45;&gt;layer3_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M8204.27,-3172.92C8204.27,-3172.92 8204.27,-2915.15 8204.27,-2915.15"/>
<polygon fill="black" stroke="black" points="8207.77,-2915.15 8204.27,-2905.15 8200.77,-2915.15 8207.77,-2915.15"/>
</g>
<!-- layer3_softmax_gpu7 -->
<g id="node615" class="node">
<title>layer3_softmax_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="9001.77,-3073.08 8462.77,-3073.08 8462.77,-3005.08 9001.77,-3005.08 9001.77,-3073.08"/>
<text text-anchor="middle" x="8732.27" y="-3057.88" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="8732.27" y="-3042.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="8732.27" y="-3027.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, heads=4, seq_len=2048, seq_len=2048]</text>
<text text-anchor="middle" x="8732.27" y="-3012.88" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_attn_scores_gpu7&#45;&gt;layer3_softmax_gpu7 -->
<g id="edge797" class="edge">
<title>layer3_attn_scores_gpu7&#45;&gt;layer3_softmax_gpu7</title>
<path fill="none" stroke="black" d="M8814.77,-3186.98C8814.77,-3186.98 8814.77,-3083.19 8814.77,-3083.19"/>
<polygon fill="black" stroke="black" points="8818.27,-3083.19 8814.77,-3073.19 8811.27,-3083.19 8818.27,-3083.19"/>
</g>
<!-- layer3_softmax_gpu7&#45;&gt;layer3_attn_out_gpu7 -->
<g id="edge798" class="edge">
<title>layer3_softmax_gpu7&#45;&gt;layer3_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M8467.77,-3005.07C8467.77,-3005.07 8467.77,-2915.25 8467.77,-2915.25"/>
<polygon fill="black" stroke="black" points="8471.27,-2915.25 8467.77,-2905.25 8464.27,-2915.25 8471.27,-2915.25"/>
</g>
<!-- layer3_out_proj_gpu7 -->
<g id="node617" class="node">
<title>layer3_out_proj_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="8289.77,-2751 7800.77,-2751 7800.77,-2683 8289.77,-2683 8289.77,-2751"/>
<text text-anchor="middle" x="8045.27" y="-2735.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8045.27" y="-2720.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8045.27" y="-2705.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=512]</text>
<text text-anchor="middle" x="8045.27" y="-2690.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer3_attn_out_gpu7&#45;&gt;layer3_out_proj_gpu7 -->
<g id="edge800" class="edge">
<title>layer3_attn_out_gpu7&#45;&gt;layer3_out_proj_gpu7</title>
<path fill="none" stroke="black" d="M8117.77,-2836.82C8117.77,-2836.82 8117.77,-2761.08 8117.77,-2761.08"/>
<polygon fill="black" stroke="black" points="8121.27,-2761.08 8117.77,-2751.08 8114.27,-2761.08 8121.27,-2761.08"/>
</g>
<!-- layer3_out_proj_gpu7&#45;&gt;layer3_attn_all_reduce -->
<g id="edge808" class="edge">
<title>layer3_out_proj_gpu7&#45;&gt;layer3_attn_all_reduce</title>
<path fill="none" stroke="black" d="M7800.6,-2716C7563.9,-2716 7240.73,-2716 7240.73,-2716 7240.73,-2716 7240.73,-2582.5 7240.73,-2582.5"/>
<polygon fill="black" stroke="black" points="7244.23,-2582.5 7240.73,-2572.5 7237.23,-2582.5 7244.23,-2582.5"/>
</g>
<!-- layer3_attn_all_reduce&#45;&gt;layer3_attn_residual -->
<g id="edge810" class="edge">
<title>layer3_attn_all_reduce&#45;&gt;layer3_attn_residual</title>
<path fill="none" stroke="black" d="M6610.77,-2529.69C6610.77,-2482.72 6610.77,-2366 6610.77,-2366 6610.77,-2366 4622.76,-2366 4622.76,-2366"/>
<polygon fill="black" stroke="black" points="4622.76,-2362.5 4612.76,-2366 4622.76,-2369.5 4622.76,-2362.5"/>
</g>
<!-- layer3_broadcast_to_moe -->
<g id="node620" class="node">
<title>layer3_broadcast_to_moe</title>
<ellipse fill="lightblue" stroke="black" cx="6288.27" cy="-2184.58" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="6288.27" y="-2203.38" font-family="Times,serif" font-size="14.00">Broadcast to MoE GPUs</text>
<text text-anchor="middle" x="6288.27" y="-2188.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6288.27" y="-2173.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6288.27" y="-2158.38" font-family="Times,serif" font-size="14.00">GPU: GPUs 8&#45;15</text>
</g>
<!-- layer3_attn_residual&#45;&gt;layer3_broadcast_to_moe -->
<g id="edge811" class="edge">
<title>layer3_attn_residual&#45;&gt;layer3_broadcast_to_moe</title>
<path fill="none" stroke="black" d="M4528,-2342.86C4528,-2293.32 4528,-2184 4528,-2184 4528,-2184 5926.81,-2184 5926.81,-2184"/>
<polygon fill="black" stroke="black" points="5926.81,-2187.5 5936.81,-2184 5926.81,-2180.5 5926.81,-2187.5"/>
</g>
<!-- layer3_final_residual -->
<g id="node704" class="node">
<title>layer3_final_residual</title>
<ellipse fill="lightblue" stroke="black" cx="4025.27" cy="-538.25" rx="646.09" ry="48.17"/>
<text text-anchor="middle" x="4025.27" y="-557.05" font-family="Times,serif" font-size="14.00">Final Residual Add</text>
<text text-anchor="middle" x="4025.27" y="-542.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096], [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4025.27" y="-527.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4025.27" y="-512.05" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer3_attn_residual&#45;&gt;layer3_final_residual -->
<g id="edge926" class="edge">
<title>layer3_attn_residual&#45;&gt;layer3_final_residual</title>
<path fill="none" stroke="black" d="M4414.27,-2332.04C4414.27,-2169.9 4414.27,-1495 4414.27,-1495 4414.27,-1495 4326.77,-1495 4326.77,-1495 4326.77,-1495 4326.77,-590.91 4326.77,-590.91"/>
<polygon fill="black" stroke="black" points="4330.27,-590.91 4326.77,-580.91 4323.27,-590.91 4330.27,-590.91"/>
</g>
<!-- layer3_moe_norm -->
<g id="node621" class="node">
<title>layer3_moe_norm</title>
<polygon fill="lightyellow" stroke="black" points="8563.77,-2050.5 8066.77,-2050.5 8066.77,-1982.5 8563.77,-1982.5 8563.77,-2050.5"/>
<text text-anchor="middle" x="8315.27" y="-2035.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="8315.27" y="-2020.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8315.27" y="-2005.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8315.27" y="-1990.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer3_broadcast_to_moe&#45;&gt;layer3_moe_norm -->
<g id="edge812" class="edge">
<title>layer3_broadcast_to_moe&#45;&gt;layer3_moe_norm</title>
<path fill="none" stroke="black" d="M6605.57,-2163.85C6605.57,-2124.31 6605.57,-2042 6605.57,-2042 6605.57,-2042 8056.66,-2042 8056.66,-2042"/>
<polygon fill="black" stroke="black" points="8056.66,-2045.5 8066.66,-2042 8056.66,-2038.5 8056.66,-2045.5"/>
</g>
<!-- layer3_gate -->
<g id="node622" class="node">
<title>layer3_gate</title>
<polygon fill="lightpink" stroke="black" points="9113.92,-1896.5 8314.31,-1896.5 8108.62,-1760.5 8908.22,-1760.5 9113.92,-1896.5"/>
<text text-anchor="middle" x="8611.27" y="-1847.3" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="8611.27" y="-1832.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8611.27" y="-1817.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, experts=16]</text>
<text text-anchor="middle" x="8611.27" y="-1802.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer3_moe_norm&#45;&gt;layer3_gate -->
<g id="edge813" class="edge">
<title>layer3_moe_norm&#45;&gt;layer3_gate</title>
<path fill="none" stroke="black" d="M8336.1,-1982.45C8336.1,-1982.45 8336.1,-1906.56 8336.1,-1906.56"/>
<polygon fill="black" stroke="black" points="8339.6,-1906.56 8336.1,-1896.56 8332.6,-1906.56 8339.6,-1906.56"/>
</g>
<!-- layer3_route_expert0 -->
<g id="node623" class="node">
<title>layer3_route_expert0</title>
<polygon fill="lightpink" stroke="black" points="11832.92,-1674.5 11033.31,-1674.5 10827.62,-1538.5 11627.22,-1538.5 11832.92,-1674.5"/>
<text text-anchor="middle" x="11330.27" y="-1625.3" font-family="Times,serif" font-size="14.00">Route to Expert 0</text>
<text text-anchor="middle" x="11330.27" y="-1610.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11330.27" y="-1595.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="11330.27" y="-1580.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_moe_norm&#45;&gt;layer3_route_expert0 -->
<g id="edge815" class="edge">
<title>layer3_moe_norm&#45;&gt;layer3_route_expert0</title>
<path fill="none" stroke="black" d="M8563.86,-2005C9244.67,-2005 11088.99,-2005 11088.99,-2005 11088.99,-2005 11088.99,-1684.55 11088.99,-1684.55"/>
<polygon fill="black" stroke="black" points="11092.49,-1684.55 11088.99,-1674.55 11085.49,-1684.55 11092.49,-1684.55"/>
</g>
<!-- layer3_route_expert1 -->
<g id="node628" class="node">
<title>layer3_route_expert1</title>
<polygon fill="lightpink" stroke="black" points="12896.92,-1674.5 12097.31,-1674.5 11891.62,-1538.5 12691.22,-1538.5 12896.92,-1674.5"/>
<text text-anchor="middle" x="12394.27" y="-1625.3" font-family="Times,serif" font-size="14.00">Route to Expert 1</text>
<text text-anchor="middle" x="12394.27" y="-1610.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12394.27" y="-1595.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="12394.27" y="-1580.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_moe_norm&#45;&gt;layer3_route_expert1 -->
<g id="edge821" class="edge">
<title>layer3_moe_norm&#45;&gt;layer3_route_expert1</title>
<path fill="none" stroke="black" d="M8563.82,-2012C9407.4,-2012 12108.99,-2012 12108.99,-2012 12108.99,-2012 12108.99,-1684.83 12108.99,-1684.83"/>
<polygon fill="black" stroke="black" points="12112.49,-1684.83 12108.99,-1674.83 12105.49,-1684.83 12112.49,-1684.83"/>
</g>
<!-- layer3_route_expert2 -->
<g id="node633" class="node">
<title>layer3_route_expert2</title>
<polygon fill="lightpink" stroke="black" points="13960.92,-1674.5 13161.31,-1674.5 12955.62,-1538.5 13755.22,-1538.5 13960.92,-1674.5"/>
<text text-anchor="middle" x="13458.27" y="-1625.3" font-family="Times,serif" font-size="14.00">Route to Expert 2</text>
<text text-anchor="middle" x="13458.27" y="-1610.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13458.27" y="-1595.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="13458.27" y="-1580.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_moe_norm&#45;&gt;layer3_route_expert2 -->
<g id="edge827" class="edge">
<title>layer3_moe_norm&#45;&gt;layer3_route_expert2</title>
<path fill="none" stroke="black" d="M8564,-2020C9531.09,-2020 12987.66,-2020 12987.66,-2020 12987.66,-2020 12987.66,-1616.57 12987.66,-1616.57"/>
<polygon fill="black" stroke="black" points="12991.16,-1616.57 12987.66,-1606.57 12984.16,-1616.57 12991.16,-1616.57"/>
</g>
<!-- layer3_route_expert3 -->
<g id="node638" class="node">
<title>layer3_route_expert3</title>
<polygon fill="lightpink" stroke="black" points="15024.92,-1674.5 14225.31,-1674.5 14019.62,-1538.5 14819.22,-1538.5 15024.92,-1674.5"/>
<text text-anchor="middle" x="14522.27" y="-1625.3" font-family="Times,serif" font-size="14.00">Route to Expert 3</text>
<text text-anchor="middle" x="14522.27" y="-1610.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14522.27" y="-1595.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="14522.27" y="-1580.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_moe_norm&#45;&gt;layer3_route_expert3 -->
<g id="edge833" class="edge">
<title>layer3_moe_norm&#45;&gt;layer3_route_expert3</title>
<path fill="none" stroke="black" d="M8563.91,-2027C9678.02,-2027 14156.32,-2027 14156.32,-2027 14156.32,-2027 14156.32,-1639.11 14156.32,-1639.11"/>
<polygon fill="black" stroke="black" points="14159.82,-1639.11 14156.32,-1629.11 14152.82,-1639.11 14159.82,-1639.11"/>
</g>
<!-- layer3_route_expert4 -->
<g id="node643" class="node">
<title>layer3_route_expert4</title>
<polygon fill="lightpink" stroke="black" points="16088.92,-1674.5 15289.31,-1674.5 15083.62,-1538.5 15883.22,-1538.5 16088.92,-1674.5"/>
<text text-anchor="middle" x="15586.27" y="-1625.3" font-family="Times,serif" font-size="14.00">Route to Expert 4</text>
<text text-anchor="middle" x="15586.27" y="-1610.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15586.27" y="-1595.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="15586.27" y="-1580.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_moe_norm&#45;&gt;layer3_route_expert4 -->
<g id="edge839" class="edge">
<title>layer3_moe_norm&#45;&gt;layer3_route_expert4</title>
<path fill="none" stroke="black" d="M8563.96,-2035C9786.25,-2035 15098.17,-2035 15098.17,-2035 15098.17,-2035 15098.17,-1616.58 15098.17,-1616.58"/>
<polygon fill="black" stroke="black" points="15101.67,-1616.58 15098.17,-1606.58 15094.67,-1616.58 15101.67,-1616.58"/>
</g>
<!-- layer3_route_expert5 -->
<g id="node648" class="node">
<title>layer3_route_expert5</title>
<polygon fill="lightpink" stroke="black" points="17152.92,-1674.5 16353.31,-1674.5 16147.62,-1538.5 16947.22,-1538.5 17152.92,-1674.5"/>
<text text-anchor="middle" x="16650.27" y="-1625.3" font-family="Times,serif" font-size="14.00">Route to Expert 5</text>
<text text-anchor="middle" x="16650.27" y="-1610.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16650.27" y="-1595.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="16650.27" y="-1580.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_moe_norm&#45;&gt;layer3_route_expert5 -->
<g id="edge845" class="edge">
<title>layer3_moe_norm&#45;&gt;layer3_route_expert5</title>
<path fill="none" stroke="black" d="M8563.87,-2042C9901.11,-2042 16178.84,-2042 16178.84,-2042 16178.84,-2042 16178.84,-1616.58 16178.84,-1616.58"/>
<polygon fill="black" stroke="black" points="16182.34,-1616.58 16178.84,-1606.58 16175.34,-1616.58 16182.34,-1616.58"/>
</g>
<!-- layer3_route_expert6 -->
<g id="node653" class="node">
<title>layer3_route_expert6</title>
<polygon fill="lightpink" stroke="black" points="1192.92,-1674.5 393.31,-1674.5 187.62,-1538.5 987.22,-1538.5 1192.92,-1674.5"/>
<text text-anchor="middle" x="690.27" y="-1625.3" font-family="Times,serif" font-size="14.00">Route to Expert 6</text>
<text text-anchor="middle" x="690.27" y="-1610.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="690.27" y="-1595.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="690.27" y="-1580.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_moe_norm&#45;&gt;layer3_route_expert6 -->
<g id="edge851" class="edge">
<title>layer3_moe_norm&#45;&gt;layer3_route_expert6</title>
<path fill="none" stroke="black" d="M8066.55,-2035C6788.64,-2035 1020.79,-2035 1020.79,-2035 1020.79,-2035 1020.79,-1684.87 1020.79,-1684.87"/>
<polygon fill="black" stroke="black" points="1024.29,-1684.87 1020.79,-1674.87 1017.29,-1684.87 1024.29,-1684.87"/>
</g>
<!-- layer3_route_expert7 -->
<g id="node658" class="node">
<title>layer3_route_expert7</title>
<polygon fill="lightpink" stroke="black" points="2256.92,-1674.5 1457.31,-1674.5 1251.62,-1538.5 2051.22,-1538.5 2256.92,-1674.5"/>
<text text-anchor="middle" x="1754.27" y="-1625.3" font-family="Times,serif" font-size="14.00">Route to Expert 7</text>
<text text-anchor="middle" x="1754.27" y="-1610.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1754.27" y="-1595.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="1754.27" y="-1580.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_moe_norm&#45;&gt;layer3_route_expert7 -->
<g id="edge857" class="edge">
<title>layer3_moe_norm&#45;&gt;layer3_route_expert7</title>
<path fill="none" stroke="black" d="M8066.53,-2027C6924.03,-2027 2234.96,-2027 2234.96,-2027 2234.96,-2027 2234.96,-1684.53 2234.96,-1684.53"/>
<polygon fill="black" stroke="black" points="2238.46,-1684.53 2234.96,-1674.53 2231.46,-1684.53 2238.46,-1684.53"/>
</g>
<!-- layer3_route_expert8 -->
<g id="node663" class="node">
<title>layer3_route_expert8</title>
<polygon fill="lightpink" stroke="black" points="3320.92,-1674.5 2521.31,-1674.5 2315.62,-1538.5 3115.22,-1538.5 3320.92,-1674.5"/>
<text text-anchor="middle" x="2818.27" y="-1625.3" font-family="Times,serif" font-size="14.00">Route to Expert 8</text>
<text text-anchor="middle" x="2818.27" y="-1610.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2818.27" y="-1595.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="2818.27" y="-1580.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_moe_norm&#45;&gt;layer3_route_expert8 -->
<g id="edge863" class="edge">
<title>layer3_moe_norm&#45;&gt;layer3_route_expert8</title>
<path fill="none" stroke="black" d="M8066.48,-2020C7019.91,-2020 3028.5,-2020 3028.5,-2020 3028.5,-2020 3028.5,-1684.78 3028.5,-1684.78"/>
<polygon fill="black" stroke="black" points="3032,-1684.78 3028.5,-1674.78 3025,-1684.78 3032,-1684.78"/>
</g>
<!-- layer3_route_expert9 -->
<g id="node668" class="node">
<title>layer3_route_expert9</title>
<polygon fill="lightpink" stroke="black" points="4384.92,-1674.5 3585.31,-1674.5 3379.62,-1538.5 4179.22,-1538.5 4384.92,-1674.5"/>
<text text-anchor="middle" x="3882.27" y="-1625.3" font-family="Times,serif" font-size="14.00">Route to Expert 9</text>
<text text-anchor="middle" x="3882.27" y="-1610.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3882.27" y="-1595.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="3882.27" y="-1580.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_moe_norm&#45;&gt;layer3_route_expert9 -->
<g id="edge869" class="edge">
<title>layer3_moe_norm&#45;&gt;layer3_route_expert9</title>
<path fill="none" stroke="black" d="M8066.69,-2012C7109.43,-2012 3714.66,-2012 3714.66,-2012 3714.66,-2012 3714.66,-1684.83 3714.66,-1684.83"/>
<polygon fill="black" stroke="black" points="3718.16,-1684.83 3714.66,-1674.83 3711.16,-1684.83 3718.16,-1684.83"/>
</g>
<!-- layer3_route_expert10 -->
<g id="node673" class="node">
<title>layer3_route_expert10</title>
<polygon fill="lightpink" stroke="black" points="5448.92,-1674.5 4649.31,-1674.5 4443.62,-1538.5 5243.22,-1538.5 5448.92,-1674.5"/>
<text text-anchor="middle" x="4946.27" y="-1625.3" font-family="Times,serif" font-size="14.00">Route to Expert 10</text>
<text text-anchor="middle" x="4946.27" y="-1610.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4946.27" y="-1595.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="4946.27" y="-1580.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_moe_norm&#45;&gt;layer3_route_expert10 -->
<g id="edge875" class="edge">
<title>layer3_moe_norm&#45;&gt;layer3_route_expert10</title>
<path fill="none" stroke="black" d="M8066.59,-2005C7363.12,-2005 5409.62,-2005 5409.62,-2005 5409.62,-2005 5409.62,-1684.55 5409.62,-1684.55"/>
<polygon fill="black" stroke="black" points="5413.12,-1684.55 5409.62,-1674.55 5406.12,-1684.55 5413.12,-1684.55"/>
</g>
<!-- layer3_route_expert11 -->
<g id="node678" class="node">
<title>layer3_route_expert11</title>
<polygon fill="lightpink" stroke="black" points="6512.92,-1674.5 5713.31,-1674.5 5507.62,-1538.5 6307.22,-1538.5 6512.92,-1674.5"/>
<text text-anchor="middle" x="6010.27" y="-1625.3" font-family="Times,serif" font-size="14.00">Route to Expert 11</text>
<text text-anchor="middle" x="6010.27" y="-1610.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6010.27" y="-1595.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="6010.27" y="-1580.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_moe_norm&#45;&gt;layer3_route_expert11 -->
<g id="edge881" class="edge">
<title>layer3_moe_norm&#45;&gt;layer3_route_expert11</title>
<path fill="none" stroke="black" d="M8066.59,-1997C7493.55,-1997 6128.92,-1997 6128.92,-1997 6128.92,-1997 6128.92,-1684.52 6128.92,-1684.52"/>
<polygon fill="black" stroke="black" points="6132.42,-1684.52 6128.92,-1674.52 6125.42,-1684.52 6132.42,-1684.52"/>
</g>
<!-- layer3_route_expert12 -->
<g id="node683" class="node">
<title>layer3_route_expert12</title>
<polygon fill="lightpink" stroke="black" points="7576.92,-1674.5 6777.31,-1674.5 6571.62,-1538.5 7371.22,-1538.5 7576.92,-1674.5"/>
<text text-anchor="middle" x="7074.27" y="-1625.3" font-family="Times,serif" font-size="14.00">Route to Expert 12</text>
<text text-anchor="middle" x="7074.27" y="-1610.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7074.27" y="-1595.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="7074.27" y="-1580.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_moe_norm&#45;&gt;layer3_route_expert12 -->
<g id="edge887" class="edge">
<title>layer3_moe_norm&#45;&gt;layer3_route_expert12</title>
<path fill="none" stroke="black" d="M8066.74,-1990C7790.32,-1990 7382.16,-1990 7382.16,-1990 7382.16,-1990 7382.16,-1684.62 7382.16,-1684.62"/>
<polygon fill="black" stroke="black" points="7385.66,-1684.62 7382.16,-1674.62 7378.66,-1684.62 7385.66,-1684.62"/>
</g>
<!-- layer3_route_expert13 -->
<g id="node688" class="node">
<title>layer3_route_expert13</title>
<polygon fill="lightpink" stroke="black" points="8640.92,-1674.5 7841.31,-1674.5 7635.62,-1538.5 8435.22,-1538.5 8640.92,-1674.5"/>
<text text-anchor="middle" x="8138.27" y="-1625.3" font-family="Times,serif" font-size="14.00">Route to Expert 13</text>
<text text-anchor="middle" x="8138.27" y="-1610.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8138.27" y="-1595.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="8138.27" y="-1580.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_moe_norm&#45;&gt;layer3_route_expert13 -->
<g id="edge893" class="edge">
<title>layer3_moe_norm&#45;&gt;layer3_route_expert13</title>
<path fill="none" stroke="black" d="M8087.6,-1982.25C8087.6,-1982.25 8087.6,-1684.56 8087.6,-1684.56"/>
<polygon fill="black" stroke="black" points="8091.1,-1684.56 8087.6,-1674.56 8084.1,-1684.56 8091.1,-1684.56"/>
</g>
<!-- layer3_route_expert14 -->
<g id="node693" class="node">
<title>layer3_route_expert14</title>
<polygon fill="lightpink" stroke="black" points="9704.92,-1674.5 8905.31,-1674.5 8699.62,-1538.5 9499.22,-1538.5 9704.92,-1674.5"/>
<text text-anchor="middle" x="9202.27" y="-1625.3" font-family="Times,serif" font-size="14.00">Route to Expert 14</text>
<text text-anchor="middle" x="9202.27" y="-1610.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9202.27" y="-1595.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="9202.27" y="-1580.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_moe_norm&#45;&gt;layer3_route_expert14 -->
<g id="edge899" class="edge">
<title>layer3_moe_norm&#45;&gt;layer3_route_expert14</title>
<path fill="none" stroke="black" d="M8563.96,-1990C8806.92,-1990 9140.43,-1990 9140.43,-1990 9140.43,-1990 9140.43,-1684.62 9140.43,-1684.62"/>
<polygon fill="black" stroke="black" points="9143.93,-1684.62 9140.43,-1674.62 9136.93,-1684.62 9143.93,-1684.62"/>
</g>
<!-- layer3_route_expert15 -->
<g id="node698" class="node">
<title>layer3_route_expert15</title>
<polygon fill="lightpink" stroke="black" points="10768.92,-1674.5 9969.31,-1674.5 9763.62,-1538.5 10563.22,-1538.5 10768.92,-1674.5"/>
<text text-anchor="middle" x="10266.27" y="-1625.3" font-family="Times,serif" font-size="14.00">Route to Expert 15</text>
<text text-anchor="middle" x="10266.27" y="-1610.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10266.27" y="-1595.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="10266.27" y="-1580.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_moe_norm&#45;&gt;layer3_route_expert15 -->
<g id="edge905" class="edge">
<title>layer3_moe_norm&#45;&gt;layer3_route_expert15</title>
<path fill="none" stroke="black" d="M8564.21,-1997C9037.64,-1997 10020.99,-1997 10020.99,-1997 10020.99,-1997 10020.99,-1684.52 10020.99,-1684.52"/>
<polygon fill="black" stroke="black" points="10024.49,-1684.52 10020.99,-1674.52 10017.49,-1684.52 10024.49,-1684.52"/>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_expert0 -->
<g id="edge814" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8959.15,-1794C9612.58,-1794 10958.22,-1794 10958.22,-1794 10958.22,-1794 10958.22,-1635.16 10958.22,-1635.16"/>
<polygon fill="black" stroke="black" points="10961.72,-1635.16 10958.22,-1625.16 10954.72,-1635.16 10961.72,-1635.16"/>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_expert1 -->
<g id="edge820" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8984.86,-1811C9865.96,-1811 12000.22,-1811 12000.22,-1811 12000.22,-1811 12000.22,-1620.4 12000.22,-1620.4"/>
<polygon fill="black" stroke="black" points="12003.72,-1620.4 12000.22,-1610.4 11996.72,-1620.4 12003.72,-1620.4"/>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_expert2 -->
<g id="edge826" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9010.74,-1828C10087.89,-1828 12971.55,-1828 12971.55,-1828 12971.55,-1828 12971.55,-1616.66 12971.55,-1616.66"/>
<polygon fill="black" stroke="black" points="12975.05,-1616.66 12971.55,-1606.66 12968.05,-1616.66 12975.05,-1616.66"/>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_expert3 -->
<g id="edge832" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9036.17,-1845C10322.65,-1845 14087.88,-1845 14087.88,-1845 14087.88,-1845 14087.88,-1616.54 14087.88,-1616.54"/>
<polygon fill="black" stroke="black" points="14091.38,-1616.54 14087.88,-1606.54 14084.38,-1616.54 14091.38,-1616.54"/>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_expert4 -->
<g id="edge838" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_expert4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9061.75,-1862C10531.17,-1862 15090.8,-1862 15090.8,-1862 15090.8,-1862 15090.8,-1616.55 15090.8,-1616.55"/>
<polygon fill="black" stroke="black" points="15094.31,-1616.55 15090.8,-1606.55 15087.31,-1616.55 15094.31,-1616.55"/>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_expert5 -->
<g id="edge844" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_expert5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9087.61,-1879C10745.55,-1879 16163.14,-1879 16163.14,-1879 16163.14,-1879 16163.14,-1616.55 16163.14,-1616.55"/>
<polygon fill="black" stroke="black" points="16166.64,-1616.55 16163.14,-1606.55 16159.64,-1616.55 16166.64,-1616.55"/>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_expert6 -->
<g id="edge850" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_expert6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8287.61,-1879C6849.23,-1879 1106.94,-1879 1106.94,-1879 1106.94,-1879 1106.94,-1684.56 1106.94,-1684.56"/>
<polygon fill="black" stroke="black" points="1110.44,-1684.56 1106.94,-1674.56 1103.44,-1684.56 1110.44,-1684.56"/>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_expert7 -->
<g id="edge856" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_expert7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8261.97,-1862C6930.24,-1862 2246.02,-1862 2246.02,-1862 2246.02,-1862 2246.02,-1616.55 2246.02,-1616.55"/>
<polygon fill="black" stroke="black" points="2249.52,-1616.55 2246.02,-1606.55 2242.52,-1616.55 2249.52,-1616.55"/>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_expert8 -->
<g id="edge862" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_expert8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8236.22,-1845C7006.39,-1845 3174.24,-1845 3174.24,-1845 3174.24,-1845 3174.24,-1684.53 3174.24,-1684.53"/>
<polygon fill="black" stroke="black" points="3177.74,-1684.53 3174.24,-1674.53 3170.74,-1684.53 3177.74,-1684.53"/>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_expert9 -->
<g id="edge868" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_expert9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8210.47,-1828C7097.41,-1828 4049.87,-1828 4049.87,-1828 4049.87,-1828 4049.87,-1684.76 4049.87,-1684.76"/>
<polygon fill="black" stroke="black" points="4053.37,-1684.76 4049.87,-1674.76 4046.37,-1684.76 4053.37,-1684.76"/>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_expert10 -->
<g id="edge874" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_expert10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8184.62,-1811C7317.2,-1811 5429.36,-1811 5429.36,-1811 5429.36,-1811 5429.36,-1616.65 5429.36,-1616.65"/>
<polygon fill="black" stroke="black" points="5432.86,-1616.65 5429.36,-1606.65 5425.86,-1616.65 5432.86,-1616.65"/>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_expert11 -->
<g id="edge880" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_expert11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8159.13,-1794C7491.73,-1794 6321.01,-1794 6321.01,-1794 6321.01,-1794 6321.01,-1684.72 6321.01,-1684.72"/>
<polygon fill="black" stroke="black" points="6324.51,-1684.72 6321.01,-1674.72 6317.51,-1684.72 6324.51,-1684.72"/>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_expert12 -->
<g id="edge886" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_expert12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8133.4,-1777C7824.44,-1777 7479.63,-1777 7479.63,-1777 7479.63,-1777 7479.63,-1684.87 7479.63,-1684.87"/>
<polygon fill="black" stroke="black" points="7483.13,-1684.87 7479.63,-1674.87 7476.13,-1684.87 7483.13,-1684.87"/>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_expert13 -->
<g id="edge892" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_expert13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8374.77,-1760.38C8374.77,-1760.38 8374.77,-1684.87 8374.77,-1684.87"/>
<polygon fill="black" stroke="black" points="8378.27,-1684.87 8374.77,-1674.87 8371.27,-1684.87 8378.27,-1684.87"/>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_expert14 -->
<g id="edge898" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_expert14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8906.77,-1760.38C8906.77,-1760.38 8906.77,-1684.87 8906.77,-1684.87"/>
<polygon fill="black" stroke="black" points="8910.27,-1684.87 8906.77,-1674.87 8903.27,-1684.87 8910.27,-1684.87"/>
</g>
<!-- layer3_gate&#45;&gt;layer3_route_expert15 -->
<g id="edge904" class="edge">
<title>layer3_gate&#45;&gt;layer3_route_expert15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8933.26,-1777C9312.71,-1777 9892.22,-1777 9892.22,-1777 9892.22,-1777 9892.22,-1633.79 9892.22,-1633.79"/>
<polygon fill="black" stroke="black" points="9895.72,-1633.79 9892.22,-1623.79 9888.72,-1633.79 9895.72,-1633.79"/>
</g>
<!-- layer3_expert0_up -->
<g id="node624" class="node">
<title>layer3_expert0_up</title>
<polygon fill="lightcoral" stroke="black" points="11490.27,-1452.5 11208.27,-1452.5 11208.27,-1384.5 11490.27,-1384.5 11490.27,-1452.5"/>
<text text-anchor="middle" x="11349.27" y="-1437.3" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="11349.27" y="-1422.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="11349.27" y="-1407.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="11349.27" y="-1392.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_route_expert0&#45;&gt;layer3_expert0_up -->
<g id="edge816" class="edge">
<title>layer3_route_expert0&#45;&gt;layer3_expert0_up</title>
<path fill="none" stroke="black" d="M11349.27,-1538.36C11349.27,-1538.36 11349.27,-1462.68 11349.27,-1462.68"/>
<polygon fill="black" stroke="black" points="11352.77,-1462.68 11349.27,-1452.68 11345.77,-1462.68 11352.77,-1462.68"/>
</g>
<!-- layer3_expert0_activation -->
<g id="node625" class="node">
<title>layer3_expert0_activation</title>
<polygon fill="lightyellow" stroke="black" points="11500.27,-1298.5 11218.27,-1298.5 11218.27,-1230.5 11500.27,-1230.5 11500.27,-1298.5"/>
<text text-anchor="middle" x="11359.27" y="-1283.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="11359.27" y="-1268.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="11359.27" y="-1253.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="11359.27" y="-1238.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_expert0_up&#45;&gt;layer3_expert0_activation -->
<g id="edge817" class="edge">
<title>layer3_expert0_up&#45;&gt;layer3_expert0_activation</title>
<path fill="none" stroke="black" d="M11354.27,-1384.32C11354.27,-1384.32 11354.27,-1308.58 11354.27,-1308.58"/>
<polygon fill="black" stroke="black" points="11357.77,-1308.58 11354.27,-1298.58 11350.77,-1308.58 11357.77,-1308.58"/>
</g>
<!-- layer3_expert0_down -->
<g id="node626" class="node">
<title>layer3_expert0_down</title>
<polygon fill="lightcoral" stroke="black" points="11504.77,-1144.5 11231.77,-1144.5 11231.77,-1076.5 11504.77,-1076.5 11504.77,-1144.5"/>
<text text-anchor="middle" x="11368.27" y="-1129.3" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="11368.27" y="-1114.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="11368.27" y="-1099.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="11368.27" y="-1084.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_expert0_activation&#45;&gt;layer3_expert0_down -->
<g id="edge818" class="edge">
<title>layer3_expert0_activation&#45;&gt;layer3_expert0_down</title>
<path fill="none" stroke="black" d="M11366.02,-1230.32C11366.02,-1230.32 11366.02,-1154.58 11366.02,-1154.58"/>
<polygon fill="black" stroke="black" points="11369.52,-1154.58 11366.02,-1144.58 11362.52,-1154.58 11369.52,-1154.58"/>
</g>
<!-- layer3_route_back_expert0 -->
<g id="node627" class="node">
<title>layer3_route_back_expert0</title>
<polygon fill="lightpink" stroke="black" points="11920.3,-990.5 11101,-990.5 10890.23,-854.5 11709.54,-854.5 11920.3,-990.5"/>
<text text-anchor="middle" x="11405.27" y="-941.3" font-family="Times,serif" font-size="14.00">Route Back Expert 0</text>
<text text-anchor="middle" x="11405.27" y="-926.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="11405.27" y="-911.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11405.27" y="-896.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_expert0_down&#45;&gt;layer3_route_back_expert0 -->
<g id="edge819" class="edge">
<title>layer3_expert0_down&#45;&gt;layer3_route_back_expert0</title>
<path fill="none" stroke="black" d="M11368.27,-1076.45C11368.27,-1076.45 11368.27,-1000.56 11368.27,-1000.56"/>
<polygon fill="black" stroke="black" points="11371.77,-1000.56 11368.27,-990.56 11364.77,-1000.56 11371.77,-1000.56"/>
</g>
<!-- layer3_expert_agg -->
<g id="node703" class="node">
<title>layer3_expert_agg</title>
<ellipse fill="lightblue" stroke="black" cx="8138.27" cy="-720.42" rx="351.36" ry="48.17"/>
<text text-anchor="middle" x="8138.27" y="-739.22" font-family="Times,serif" font-size="14.00">Aggregate Experts</text>
<text text-anchor="middle" x="8138.27" y="-724.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8138.27" y="-709.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8138.27" y="-694.22" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer3_route_back_expert0&#45;&gt;layer3_expert_agg -->
<g id="edge910" class="edge">
<title>layer3_route_back_expert0&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M11405.27,-854.38C11405.27,-801.1 11405.27,-736 11405.27,-736 11405.27,-736 8481.02,-736 8481.02,-736"/>
<polygon fill="black" stroke="black" points="8481.02,-732.5 8471.02,-736 8481.02,-739.5 8481.02,-732.5"/>
</g>
<!-- layer3_expert1_up -->
<g id="node629" class="node">
<title>layer3_expert1_up</title>
<polygon fill="lightcoral" stroke="black" points="12547.27,-1452.5 12265.27,-1452.5 12265.27,-1384.5 12547.27,-1384.5 12547.27,-1452.5"/>
<text text-anchor="middle" x="12406.27" y="-1437.3" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="12406.27" y="-1422.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="12406.27" y="-1407.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="12406.27" y="-1392.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_route_expert1&#45;&gt;layer3_expert1_up -->
<g id="edge822" class="edge">
<title>layer3_route_expert1&#45;&gt;layer3_expert1_up</title>
<path fill="none" stroke="black" d="M12406.27,-1538.36C12406.27,-1538.36 12406.27,-1462.68 12406.27,-1462.68"/>
<polygon fill="black" stroke="black" points="12409.77,-1462.68 12406.27,-1452.68 12402.77,-1462.68 12409.77,-1462.68"/>
</g>
<!-- layer3_expert1_activation -->
<g id="node630" class="node">
<title>layer3_expert1_activation</title>
<polygon fill="lightyellow" stroke="black" points="12560.27,-1298.5 12278.27,-1298.5 12278.27,-1230.5 12560.27,-1230.5 12560.27,-1298.5"/>
<text text-anchor="middle" x="12419.27" y="-1283.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="12419.27" y="-1268.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="12419.27" y="-1253.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="12419.27" y="-1238.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_expert1_up&#45;&gt;layer3_expert1_activation -->
<g id="edge823" class="edge">
<title>layer3_expert1_up&#45;&gt;layer3_expert1_activation</title>
<path fill="none" stroke="black" d="M12412.77,-1384.32C12412.77,-1384.32 12412.77,-1308.58 12412.77,-1308.58"/>
<polygon fill="black" stroke="black" points="12416.27,-1308.58 12412.77,-1298.58 12409.27,-1308.58 12416.27,-1308.58"/>
</g>
<!-- layer3_expert1_down -->
<g id="node631" class="node">
<title>layer3_expert1_down</title>
<polygon fill="lightcoral" stroke="black" points="12580.77,-1144.5 12307.77,-1144.5 12307.77,-1076.5 12580.77,-1076.5 12580.77,-1144.5"/>
<text text-anchor="middle" x="12444.27" y="-1129.3" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="12444.27" y="-1114.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="12444.27" y="-1099.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="12444.27" y="-1084.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_expert1_activation&#45;&gt;layer3_expert1_down -->
<g id="edge824" class="edge">
<title>layer3_expert1_activation&#45;&gt;layer3_expert1_down</title>
<path fill="none" stroke="black" d="M12434.02,-1230.32C12434.02,-1230.32 12434.02,-1154.58 12434.02,-1154.58"/>
<polygon fill="black" stroke="black" points="12437.52,-1154.58 12434.02,-1144.58 12430.52,-1154.58 12437.52,-1154.58"/>
</g>
<!-- layer3_route_back_expert1 -->
<g id="node632" class="node">
<title>layer3_route_back_expert1</title>
<polygon fill="lightpink" stroke="black" points="13009.3,-990.5 12190,-990.5 11979.23,-854.5 12798.54,-854.5 13009.3,-990.5"/>
<text text-anchor="middle" x="12494.27" y="-941.3" font-family="Times,serif" font-size="14.00">Route Back Expert 1</text>
<text text-anchor="middle" x="12494.27" y="-926.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="12494.27" y="-911.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12494.27" y="-896.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer3_expert1_down&#45;&gt;layer3_route_back_expert1 -->
<g id="edge825" class="edge">
<title>layer3_expert1_down&#45;&gt;layer3_route_back_expert1</title>
<path fill="none" stroke="black" d="M12444.27,-1076.45C12444.27,-1076.45 12444.27,-1000.56 12444.27,-1000.56"/>
<polygon fill="black" stroke="black" points="12447.77,-1000.56 12444.27,-990.56 12440.77,-1000.56 12447.77,-1000.56"/>
</g>
<!-- layer3_route_back_expert1&#45;&gt;layer3_expert_agg -->
<g id="edge911" class="edge">
<title>layer3_route_back_expert1&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M12494.27,-854.25C12494.27,-797.17 12494.27,-725 12494.27,-725 12494.27,-725 8498.29,-725 8498.29,-725"/>
<polygon fill="black" stroke="black" points="8498.29,-721.5 8488.29,-725 8498.29,-728.5 8498.29,-721.5"/>
</g>
<!-- layer3_expert2_up -->
<g id="node634" class="node">
<title>layer3_expert2_up</title>
<polygon fill="lightcoral" stroke="black" points="13615.27,-1452.5 13333.27,-1452.5 13333.27,-1384.5 13615.27,-1384.5 13615.27,-1452.5"/>
<text text-anchor="middle" x="13474.27" y="-1437.3" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="13474.27" y="-1422.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="13474.27" y="-1407.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="13474.27" y="-1392.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_route_expert2&#45;&gt;layer3_expert2_up -->
<g id="edge828" class="edge">
<title>layer3_route_expert2&#45;&gt;layer3_expert2_up</title>
<path fill="none" stroke="black" d="M13474.27,-1538.36C13474.27,-1538.36 13474.27,-1462.68 13474.27,-1462.68"/>
<polygon fill="black" stroke="black" points="13477.77,-1462.68 13474.27,-1452.68 13470.77,-1462.68 13477.77,-1462.68"/>
</g>
<!-- layer3_expert2_activation -->
<g id="node635" class="node">
<title>layer3_expert2_activation</title>
<polygon fill="lightyellow" stroke="black" points="13631.27,-1298.5 13349.27,-1298.5 13349.27,-1230.5 13631.27,-1230.5 13631.27,-1298.5"/>
<text text-anchor="middle" x="13490.27" y="-1283.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="13490.27" y="-1268.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="13490.27" y="-1253.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="13490.27" y="-1238.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_expert2_up&#45;&gt;layer3_expert2_activation -->
<g id="edge829" class="edge">
<title>layer3_expert2_up&#45;&gt;layer3_expert2_activation</title>
<path fill="none" stroke="black" d="M13482.27,-1384.32C13482.27,-1384.32 13482.27,-1308.58 13482.27,-1308.58"/>
<polygon fill="black" stroke="black" points="13485.77,-1308.58 13482.27,-1298.58 13478.77,-1308.58 13485.77,-1308.58"/>
</g>
<!-- layer3_expert2_down -->
<g id="node636" class="node">
<title>layer3_expert2_down</title>
<polygon fill="lightcoral" stroke="black" points="13657.77,-1144.5 13384.77,-1144.5 13384.77,-1076.5 13657.77,-1076.5 13657.77,-1144.5"/>
<text text-anchor="middle" x="13521.27" y="-1129.3" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="13521.27" y="-1114.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="13521.27" y="-1099.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="13521.27" y="-1084.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_expert2_activation&#45;&gt;layer3_expert2_down -->
<g id="edge830" class="edge">
<title>layer3_expert2_activation&#45;&gt;layer3_expert2_down</title>
<path fill="none" stroke="black" d="M13508.02,-1230.32C13508.02,-1230.32 13508.02,-1154.58 13508.02,-1154.58"/>
<polygon fill="black" stroke="black" points="13511.52,-1154.58 13508.02,-1144.58 13504.52,-1154.58 13511.52,-1154.58"/>
</g>
<!-- layer3_route_back_expert2 -->
<g id="node637" class="node">
<title>layer3_route_back_expert2</title>
<polygon fill="lightpink" stroke="black" points="14098.3,-990.5 13279,-990.5 13068.23,-854.5 13887.54,-854.5 14098.3,-990.5"/>
<text text-anchor="middle" x="13583.27" y="-941.3" font-family="Times,serif" font-size="14.00">Route Back Expert 2</text>
<text text-anchor="middle" x="13583.27" y="-926.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="13583.27" y="-911.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13583.27" y="-896.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_expert2_down&#45;&gt;layer3_route_back_expert2 -->
<g id="edge831" class="edge">
<title>layer3_expert2_down&#45;&gt;layer3_route_back_expert2</title>
<path fill="none" stroke="black" d="M13521.27,-1076.45C13521.27,-1076.45 13521.27,-1000.56 13521.27,-1000.56"/>
<polygon fill="black" stroke="black" points="13524.77,-1000.56 13521.27,-990.56 13517.77,-1000.56 13524.77,-1000.56"/>
</g>
<!-- layer3_route_back_expert2&#45;&gt;layer3_expert_agg -->
<g id="edge912" class="edge">
<title>layer3_route_back_expert2&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M13583.27,-854.27C13583.27,-793.79 13583.27,-715 13583.27,-715 13583.27,-715 8497.68,-715 8497.68,-715"/>
<polygon fill="black" stroke="black" points="8497.68,-711.5 8487.68,-715 8497.68,-718.5 8497.68,-711.5"/>
</g>
<!-- layer3_expert3_up -->
<g id="node639" class="node">
<title>layer3_expert3_up</title>
<polygon fill="lightcoral" stroke="black" points="14682.27,-1452.5 14400.27,-1452.5 14400.27,-1384.5 14682.27,-1384.5 14682.27,-1452.5"/>
<text text-anchor="middle" x="14541.27" y="-1437.3" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="14541.27" y="-1422.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="14541.27" y="-1407.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="14541.27" y="-1392.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_route_expert3&#45;&gt;layer3_expert3_up -->
<g id="edge834" class="edge">
<title>layer3_route_expert3&#45;&gt;layer3_expert3_up</title>
<path fill="none" stroke="black" d="M14541.27,-1538.36C14541.27,-1538.36 14541.27,-1462.68 14541.27,-1462.68"/>
<polygon fill="black" stroke="black" points="14544.77,-1462.68 14541.27,-1452.68 14537.77,-1462.68 14544.77,-1462.68"/>
</g>
<!-- layer3_expert3_activation -->
<g id="node640" class="node">
<title>layer3_expert3_activation</title>
<polygon fill="lightyellow" stroke="black" points="14701.27,-1298.5 14419.27,-1298.5 14419.27,-1230.5 14701.27,-1230.5 14701.27,-1298.5"/>
<text text-anchor="middle" x="14560.27" y="-1283.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14560.27" y="-1268.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="14560.27" y="-1253.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="14560.27" y="-1238.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_expert3_up&#45;&gt;layer3_expert3_activation -->
<g id="edge835" class="edge">
<title>layer3_expert3_up&#45;&gt;layer3_expert3_activation</title>
<path fill="none" stroke="black" d="M14550.77,-1384.32C14550.77,-1384.32 14550.77,-1308.58 14550.77,-1308.58"/>
<polygon fill="black" stroke="black" points="14554.27,-1308.58 14550.77,-1298.58 14547.27,-1308.58 14554.27,-1308.58"/>
</g>
<!-- layer3_expert3_down -->
<g id="node641" class="node">
<title>layer3_expert3_down</title>
<polygon fill="lightcoral" stroke="black" points="14733.77,-1144.5 14460.77,-1144.5 14460.77,-1076.5 14733.77,-1076.5 14733.77,-1144.5"/>
<text text-anchor="middle" x="14597.27" y="-1129.3" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="14597.27" y="-1114.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="14597.27" y="-1099.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="14597.27" y="-1084.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_expert3_activation&#45;&gt;layer3_expert3_down -->
<g id="edge836" class="edge">
<title>layer3_expert3_activation&#45;&gt;layer3_expert3_down</title>
<path fill="none" stroke="black" d="M14581.02,-1230.32C14581.02,-1230.32 14581.02,-1154.58 14581.02,-1154.58"/>
<polygon fill="black" stroke="black" points="14584.52,-1154.58 14581.02,-1144.58 14577.52,-1154.58 14584.52,-1154.58"/>
</g>
<!-- layer3_route_back_expert3 -->
<g id="node642" class="node">
<title>layer3_route_back_expert3</title>
<polygon fill="lightpink" stroke="black" points="15187.3,-990.5 14368,-990.5 14157.23,-854.5 14976.54,-854.5 15187.3,-990.5"/>
<text text-anchor="middle" x="14672.27" y="-941.3" font-family="Times,serif" font-size="14.00">Route Back Expert 3</text>
<text text-anchor="middle" x="14672.27" y="-926.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="14672.27" y="-911.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14672.27" y="-896.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer3_expert3_down&#45;&gt;layer3_route_back_expert3 -->
<g id="edge837" class="edge">
<title>layer3_expert3_down&#45;&gt;layer3_route_back_expert3</title>
<path fill="none" stroke="black" d="M14597.27,-1076.45C14597.27,-1076.45 14597.27,-1000.56 14597.27,-1000.56"/>
<polygon fill="black" stroke="black" points="14600.77,-1000.56 14597.27,-990.56 14593.77,-1000.56 14600.77,-1000.56"/>
</g>
<!-- layer3_route_back_expert3&#45;&gt;layer3_expert_agg -->
<g id="edge913" class="edge">
<title>layer3_route_back_expert3&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M14672.27,-854.26C14672.27,-790.15 14672.27,-704 14672.27,-704 14672.27,-704 8478.73,-704 8478.73,-704"/>
<polygon fill="black" stroke="black" points="8478.73,-700.5 8468.73,-704 8478.73,-707.5 8478.73,-700.5"/>
</g>
<!-- layer3_expert4_up -->
<g id="node644" class="node">
<title>layer3_expert4_up</title>
<polygon fill="lightcoral" stroke="black" points="15749.27,-1452.5 15467.27,-1452.5 15467.27,-1384.5 15749.27,-1384.5 15749.27,-1452.5"/>
<text text-anchor="middle" x="15608.27" y="-1437.3" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="15608.27" y="-1422.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="15608.27" y="-1407.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="15608.27" y="-1392.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_route_expert4&#45;&gt;layer3_expert4_up -->
<g id="edge840" class="edge">
<title>layer3_route_expert4&#45;&gt;layer3_expert4_up</title>
<path fill="none" stroke="black" d="M15608.27,-1538.36C15608.27,-1538.36 15608.27,-1462.68 15608.27,-1462.68"/>
<polygon fill="black" stroke="black" points="15611.77,-1462.68 15608.27,-1452.68 15604.77,-1462.68 15611.77,-1462.68"/>
</g>
<!-- layer3_expert4_activation -->
<g id="node645" class="node">
<title>layer3_expert4_activation</title>
<polygon fill="lightyellow" stroke="black" points="15836.27,-1298.5 15554.27,-1298.5 15554.27,-1230.5 15836.27,-1230.5 15836.27,-1298.5"/>
<text text-anchor="middle" x="15695.27" y="-1283.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="15695.27" y="-1268.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="15695.27" y="-1253.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="15695.27" y="-1238.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_expert4_up&#45;&gt;layer3_expert4_activation -->
<g id="edge841" class="edge">
<title>layer3_expert4_up&#45;&gt;layer3_expert4_activation</title>
<path fill="none" stroke="black" d="M15651.77,-1384.32C15651.77,-1384.32 15651.77,-1308.58 15651.77,-1308.58"/>
<polygon fill="black" stroke="black" points="15655.27,-1308.58 15651.77,-1298.58 15648.27,-1308.58 15655.27,-1308.58"/>
</g>
<!-- layer3_expert4_down -->
<g id="node646" class="node">
<title>layer3_expert4_down</title>
<polygon fill="lightcoral" stroke="black" points="15875.77,-1144.5 15602.77,-1144.5 15602.77,-1076.5 15875.77,-1076.5 15875.77,-1144.5"/>
<text text-anchor="middle" x="15739.27" y="-1129.3" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="15739.27" y="-1114.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="15739.27" y="-1099.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="15739.27" y="-1084.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_expert4_activation&#45;&gt;layer3_expert4_down -->
<g id="edge842" class="edge">
<title>layer3_expert4_activation&#45;&gt;layer3_expert4_down</title>
<path fill="none" stroke="black" d="M15719.52,-1230.32C15719.52,-1230.32 15719.52,-1154.58 15719.52,-1154.58"/>
<polygon fill="black" stroke="black" points="15723.02,-1154.58 15719.52,-1144.58 15716.02,-1154.58 15723.02,-1154.58"/>
</g>
<!-- layer3_route_back_expert4 -->
<g id="node647" class="node">
<title>layer3_route_back_expert4</title>
<polygon fill="lightpink" stroke="black" points="16276.3,-990.5 15457,-990.5 15246.23,-854.5 16065.54,-854.5 16276.3,-990.5"/>
<text text-anchor="middle" x="15761.27" y="-941.3" font-family="Times,serif" font-size="14.00">Route Back Expert 4</text>
<text text-anchor="middle" x="15761.27" y="-926.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="15761.27" y="-911.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15761.27" y="-896.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_expert4_down&#45;&gt;layer3_route_back_expert4 -->
<g id="edge843" class="edge">
<title>layer3_expert4_down&#45;&gt;layer3_route_back_expert4</title>
<path fill="none" stroke="black" d="M15739.27,-1076.45C15739.27,-1076.45 15739.27,-1000.56 15739.27,-1000.56"/>
<polygon fill="black" stroke="black" points="15742.77,-1000.56 15739.27,-990.56 15735.77,-1000.56 15742.77,-1000.56"/>
</g>
<!-- layer3_route_back_expert4&#45;&gt;layer3_expert_agg -->
<g id="edge914" class="edge">
<title>layer3_route_back_expert4&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M15761.27,-854.26C15761.27,-786.61 15761.27,-693 15761.27,-693 15761.27,-693 8437.21,-693 8437.21,-693"/>
<polygon fill="black" stroke="black" points="8437.21,-689.5 8427.21,-693 8437.21,-696.5 8437.21,-689.5"/>
</g>
<!-- layer3_expert5_up -->
<g id="node649" class="node">
<title>layer3_expert5_up</title>
<polygon fill="lightcoral" stroke="black" points="16816.27,-1452.5 16534.27,-1452.5 16534.27,-1384.5 16816.27,-1384.5 16816.27,-1452.5"/>
<text text-anchor="middle" x="16675.27" y="-1437.3" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="16675.27" y="-1422.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="16675.27" y="-1407.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="16675.27" y="-1392.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_route_expert5&#45;&gt;layer3_expert5_up -->
<g id="edge846" class="edge">
<title>layer3_route_expert5&#45;&gt;layer3_expert5_up</title>
<path fill="none" stroke="black" d="M16675.27,-1538.36C16675.27,-1538.36 16675.27,-1462.68 16675.27,-1462.68"/>
<polygon fill="black" stroke="black" points="16678.77,-1462.68 16675.27,-1452.68 16671.77,-1462.68 16678.77,-1462.68"/>
</g>
<!-- layer3_expert5_activation -->
<g id="node650" class="node">
<title>layer3_expert5_activation</title>
<polygon fill="lightyellow" stroke="black" points="16916.27,-1298.5 16634.27,-1298.5 16634.27,-1230.5 16916.27,-1230.5 16916.27,-1298.5"/>
<text text-anchor="middle" x="16775.27" y="-1283.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="16775.27" y="-1268.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="16775.27" y="-1253.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="16775.27" y="-1238.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_expert5_up&#45;&gt;layer3_expert5_activation -->
<g id="edge847" class="edge">
<title>layer3_expert5_up&#45;&gt;layer3_expert5_activation</title>
<path fill="none" stroke="black" d="M16725.27,-1384.32C16725.27,-1384.32 16725.27,-1308.58 16725.27,-1308.58"/>
<polygon fill="black" stroke="black" points="16728.77,-1308.58 16725.27,-1298.58 16721.77,-1308.58 16728.77,-1308.58"/>
</g>
<!-- layer3_expert5_down -->
<g id="node651" class="node">
<title>layer3_expert5_down</title>
<polygon fill="lightcoral" stroke="black" points="16961.77,-1144.5 16688.77,-1144.5 16688.77,-1076.5 16961.77,-1076.5 16961.77,-1144.5"/>
<text text-anchor="middle" x="16825.27" y="-1129.3" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="16825.27" y="-1114.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="16825.27" y="-1099.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="16825.27" y="-1084.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_expert5_activation&#45;&gt;layer3_expert5_down -->
<g id="edge848" class="edge">
<title>layer3_expert5_activation&#45;&gt;layer3_expert5_down</title>
<path fill="none" stroke="black" d="M16802.52,-1230.32C16802.52,-1230.32 16802.52,-1154.58 16802.52,-1154.58"/>
<polygon fill="black" stroke="black" points="16806.02,-1154.58 16802.52,-1144.58 16799.02,-1154.58 16806.02,-1154.58"/>
</g>
<!-- layer3_route_back_expert5 -->
<g id="node652" class="node">
<title>layer3_route_back_expert5</title>
<polygon fill="lightpink" stroke="black" points="17365.3,-990.5 16546,-990.5 16335.23,-854.5 17154.54,-854.5 17365.3,-990.5"/>
<text text-anchor="middle" x="16850.27" y="-941.3" font-family="Times,serif" font-size="14.00">Route Back Expert 5</text>
<text text-anchor="middle" x="16850.27" y="-926.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="16850.27" y="-911.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16850.27" y="-896.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer3_expert5_down&#45;&gt;layer3_route_back_expert5 -->
<g id="edge849" class="edge">
<title>layer3_expert5_down&#45;&gt;layer3_route_back_expert5</title>
<path fill="none" stroke="black" d="M16825.27,-1076.45C16825.27,-1076.45 16825.27,-1000.56 16825.27,-1000.56"/>
<polygon fill="black" stroke="black" points="16828.77,-1000.56 16825.27,-990.56 16821.77,-1000.56 16828.77,-1000.56"/>
</g>
<!-- layer3_route_back_expert5&#45;&gt;layer3_expert_agg -->
<g id="edge915" class="edge">
<title>layer3_route_back_expert5&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M16850.27,-854.19C16850.27,-783.4 16850.27,-683 16850.27,-683 16850.27,-683 8369.07,-683 8369.07,-683"/>
<polygon fill="black" stroke="black" points="8369.07,-679.5 8359.07,-683 8369.07,-686.5 8369.07,-679.5"/>
</g>
<!-- layer3_expert6_up -->
<g id="node654" class="node">
<title>layer3_expert6_up</title>
<polygon fill="lightcoral" stroke="black" points="787.27,-1452.5 505.27,-1452.5 505.27,-1384.5 787.27,-1384.5 787.27,-1452.5"/>
<text text-anchor="middle" x="646.27" y="-1437.3" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="646.27" y="-1422.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="646.27" y="-1407.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="646.27" y="-1392.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_route_expert6&#45;&gt;layer3_expert6_up -->
<g id="edge852" class="edge">
<title>layer3_route_expert6&#45;&gt;layer3_expert6_up</title>
<path fill="none" stroke="black" d="M646.27,-1538.36C646.27,-1538.36 646.27,-1462.68 646.27,-1462.68"/>
<polygon fill="black" stroke="black" points="649.77,-1462.68 646.27,-1452.68 642.77,-1462.68 649.77,-1462.68"/>
</g>
<!-- layer3_expert6_activation -->
<g id="node655" class="node">
<title>layer3_expert6_activation</title>
<polygon fill="lightyellow" stroke="black" points="765.27,-1298.5 483.27,-1298.5 483.27,-1230.5 765.27,-1230.5 765.27,-1298.5"/>
<text text-anchor="middle" x="624.27" y="-1283.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="624.27" y="-1268.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="624.27" y="-1253.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="624.27" y="-1238.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_expert6_up&#45;&gt;layer3_expert6_activation -->
<g id="edge853" class="edge">
<title>layer3_expert6_up&#45;&gt;layer3_expert6_activation</title>
<path fill="none" stroke="black" d="M635.27,-1384.32C635.27,-1384.32 635.27,-1308.58 635.27,-1308.58"/>
<polygon fill="black" stroke="black" points="638.77,-1308.58 635.27,-1298.58 631.77,-1308.58 638.77,-1308.58"/>
</g>
<!-- layer3_expert6_down -->
<g id="node656" class="node">
<title>layer3_expert6_down</title>
<polygon fill="lightcoral" stroke="black" points="673.77,-1144.5 400.77,-1144.5 400.77,-1076.5 673.77,-1076.5 673.77,-1144.5"/>
<text text-anchor="middle" x="537.27" y="-1129.3" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="537.27" y="-1114.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="537.27" y="-1099.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="537.27" y="-1084.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_expert6_activation&#45;&gt;layer3_expert6_down -->
<g id="edge854" class="edge">
<title>layer3_expert6_activation&#45;&gt;layer3_expert6_down</title>
<path fill="none" stroke="black" d="M578.52,-1230.32C578.52,-1230.32 578.52,-1154.58 578.52,-1154.58"/>
<polygon fill="black" stroke="black" points="582.02,-1154.58 578.52,-1144.58 575.02,-1154.58 582.02,-1154.58"/>
</g>
<!-- layer3_route_back_expert6 -->
<g id="node657" class="node">
<title>layer3_route_back_expert6</title>
<polygon fill="lightpink" stroke="black" points="1030.3,-990.5 211,-990.5 0.23,-854.5 819.54,-854.5 1030.3,-990.5"/>
<text text-anchor="middle" x="515.27" y="-941.3" font-family="Times,serif" font-size="14.00">Route Back Expert 6</text>
<text text-anchor="middle" x="515.27" y="-926.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="515.27" y="-911.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="515.27" y="-896.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_expert6_down&#45;&gt;layer3_route_back_expert6 -->
<g id="edge855" class="edge">
<title>layer3_expert6_down&#45;&gt;layer3_route_back_expert6</title>
<path fill="none" stroke="black" d="M537.27,-1076.45C537.27,-1076.45 537.27,-1000.56 537.27,-1000.56"/>
<polygon fill="black" stroke="black" points="540.77,-1000.56 537.27,-990.56 533.77,-1000.56 540.77,-1000.56"/>
</g>
<!-- layer3_route_back_expert6&#45;&gt;layer3_expert_agg -->
<g id="edge916" class="edge">
<title>layer3_route_back_expert6&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M515.27,-854.26C515.27,-786.61 515.27,-693 515.27,-693 515.27,-693 7839.32,-693 7839.32,-693"/>
<polygon fill="black" stroke="black" points="7839.32,-696.5 7849.32,-693 7839.32,-689.5 7839.32,-696.5"/>
</g>
<!-- layer3_expert7_up -->
<g id="node659" class="node">
<title>layer3_expert7_up</title>
<polygon fill="lightcoral" stroke="black" points="1820.27,-1452.5 1538.27,-1452.5 1538.27,-1384.5 1820.27,-1384.5 1820.27,-1452.5"/>
<text text-anchor="middle" x="1679.27" y="-1437.3" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="1679.27" y="-1422.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="1679.27" y="-1407.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="1679.27" y="-1392.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_route_expert7&#45;&gt;layer3_expert7_up -->
<g id="edge858" class="edge">
<title>layer3_route_expert7&#45;&gt;layer3_expert7_up</title>
<path fill="none" stroke="black" d="M1679.27,-1538.36C1679.27,-1538.36 1679.27,-1462.68 1679.27,-1462.68"/>
<polygon fill="black" stroke="black" points="1682.77,-1462.68 1679.27,-1452.68 1675.77,-1462.68 1682.77,-1462.68"/>
</g>
<!-- layer3_expert7_activation -->
<g id="node660" class="node">
<title>layer3_expert7_activation</title>
<polygon fill="lightyellow" stroke="black" points="1801.27,-1298.5 1519.27,-1298.5 1519.27,-1230.5 1801.27,-1230.5 1801.27,-1298.5"/>
<text text-anchor="middle" x="1660.27" y="-1283.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1660.27" y="-1268.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="1660.27" y="-1253.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="1660.27" y="-1238.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_expert7_up&#45;&gt;layer3_expert7_activation -->
<g id="edge859" class="edge">
<title>layer3_expert7_up&#45;&gt;layer3_expert7_activation</title>
<path fill="none" stroke="black" d="M1669.77,-1384.32C1669.77,-1384.32 1669.77,-1308.58 1669.77,-1308.58"/>
<polygon fill="black" stroke="black" points="1673.27,-1308.58 1669.77,-1298.58 1666.27,-1308.58 1673.27,-1308.58"/>
</g>
<!-- layer3_expert7_down -->
<g id="node661" class="node">
<title>layer3_expert7_down</title>
<polygon fill="lightcoral" stroke="black" points="1777.77,-1144.5 1504.77,-1144.5 1504.77,-1076.5 1777.77,-1076.5 1777.77,-1144.5"/>
<text text-anchor="middle" x="1641.27" y="-1129.3" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="1641.27" y="-1114.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="1641.27" y="-1099.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="1641.27" y="-1084.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_expert7_activation&#45;&gt;layer3_expert7_down -->
<g id="edge860" class="edge">
<title>layer3_expert7_activation&#45;&gt;layer3_expert7_down</title>
<path fill="none" stroke="black" d="M1648.52,-1230.32C1648.52,-1230.32 1648.52,-1154.58 1648.52,-1154.58"/>
<polygon fill="black" stroke="black" points="1652.02,-1154.58 1648.52,-1144.58 1645.02,-1154.58 1652.02,-1154.58"/>
</g>
<!-- layer3_route_back_expert7 -->
<g id="node662" class="node">
<title>layer3_route_back_expert7</title>
<polygon fill="lightpink" stroke="black" points="2119.3,-990.5 1300,-990.5 1089.23,-854.5 1908.54,-854.5 2119.3,-990.5"/>
<text text-anchor="middle" x="1604.27" y="-941.3" font-family="Times,serif" font-size="14.00">Route Back Expert 7</text>
<text text-anchor="middle" x="1604.27" y="-926.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="1604.27" y="-911.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1604.27" y="-896.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer3_expert7_down&#45;&gt;layer3_route_back_expert7 -->
<g id="edge861" class="edge">
<title>layer3_expert7_down&#45;&gt;layer3_route_back_expert7</title>
<path fill="none" stroke="black" d="M1641.27,-1076.45C1641.27,-1076.45 1641.27,-1000.56 1641.27,-1000.56"/>
<polygon fill="black" stroke="black" points="1644.77,-1000.56 1641.27,-990.56 1637.77,-1000.56 1644.77,-1000.56"/>
</g>
<!-- layer3_route_back_expert7&#45;&gt;layer3_expert_agg -->
<g id="edge917" class="edge">
<title>layer3_route_back_expert7&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M1604.27,-854.26C1604.27,-790.15 1604.27,-704 1604.27,-704 1604.27,-704 7797.8,-704 7797.8,-704"/>
<polygon fill="black" stroke="black" points="7797.8,-707.5 7807.8,-704 7797.8,-700.5 7797.8,-707.5"/>
</g>
<!-- layer3_expert8_up -->
<g id="node664" class="node">
<title>layer3_expert8_up</title>
<polygon fill="lightcoral" stroke="black" points="2943.27,-1452.5 2661.27,-1452.5 2661.27,-1384.5 2943.27,-1384.5 2943.27,-1452.5"/>
<text text-anchor="middle" x="2802.27" y="-1437.3" font-family="Times,serif" font-size="14.00">Expert 8 Up</text>
<text text-anchor="middle" x="2802.27" y="-1422.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="2802.27" y="-1407.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="2802.27" y="-1392.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_route_expert8&#45;&gt;layer3_expert8_up -->
<g id="edge864" class="edge">
<title>layer3_route_expert8&#45;&gt;layer3_expert8_up</title>
<path fill="none" stroke="black" d="M2802.27,-1538.36C2802.27,-1538.36 2802.27,-1462.68 2802.27,-1462.68"/>
<polygon fill="black" stroke="black" points="2805.77,-1462.68 2802.27,-1452.68 2798.77,-1462.68 2805.77,-1462.68"/>
</g>
<!-- layer3_expert8_activation -->
<g id="node665" class="node">
<title>layer3_expert8_activation</title>
<polygon fill="lightyellow" stroke="black" points="2927.27,-1298.5 2645.27,-1298.5 2645.27,-1230.5 2927.27,-1230.5 2927.27,-1298.5"/>
<text text-anchor="middle" x="2786.27" y="-1283.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2786.27" y="-1268.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="2786.27" y="-1253.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="2786.27" y="-1238.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_expert8_up&#45;&gt;layer3_expert8_activation -->
<g id="edge865" class="edge">
<title>layer3_expert8_up&#45;&gt;layer3_expert8_activation</title>
<path fill="none" stroke="black" d="M2794.27,-1384.32C2794.27,-1384.32 2794.27,-1308.58 2794.27,-1308.58"/>
<polygon fill="black" stroke="black" points="2797.77,-1308.58 2794.27,-1298.58 2790.77,-1308.58 2797.77,-1308.58"/>
</g>
<!-- layer3_expert8_down -->
<g id="node666" class="node">
<title>layer3_expert8_down</title>
<polygon fill="lightcoral" stroke="black" points="2860.77,-1144.5 2587.77,-1144.5 2587.77,-1076.5 2860.77,-1076.5 2860.77,-1144.5"/>
<text text-anchor="middle" x="2724.27" y="-1129.3" font-family="Times,serif" font-size="14.00">Expert 8 Down</text>
<text text-anchor="middle" x="2724.27" y="-1114.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="2724.27" y="-1099.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="2724.27" y="-1084.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_expert8_activation&#45;&gt;layer3_expert8_down -->
<g id="edge866" class="edge">
<title>layer3_expert8_activation&#45;&gt;layer3_expert8_down</title>
<path fill="none" stroke="black" d="M2753.02,-1230.32C2753.02,-1230.32 2753.02,-1154.58 2753.02,-1154.58"/>
<polygon fill="black" stroke="black" points="2756.52,-1154.58 2753.02,-1144.58 2749.52,-1154.58 2756.52,-1154.58"/>
</g>
<!-- layer3_route_back_expert8 -->
<g id="node667" class="node">
<title>layer3_route_back_expert8</title>
<polygon fill="lightpink" stroke="black" points="3208.3,-990.5 2389,-990.5 2178.23,-854.5 2997.54,-854.5 3208.3,-990.5"/>
<text text-anchor="middle" x="2693.27" y="-941.3" font-family="Times,serif" font-size="14.00">Route Back Expert 8</text>
<text text-anchor="middle" x="2693.27" y="-926.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="2693.27" y="-911.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2693.27" y="-896.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_expert8_down&#45;&gt;layer3_route_back_expert8 -->
<g id="edge867" class="edge">
<title>layer3_expert8_down&#45;&gt;layer3_route_back_expert8</title>
<path fill="none" stroke="black" d="M2724.27,-1076.45C2724.27,-1076.45 2724.27,-1000.56 2724.27,-1000.56"/>
<polygon fill="black" stroke="black" points="2727.77,-1000.56 2724.27,-990.56 2720.77,-1000.56 2727.77,-1000.56"/>
</g>
<!-- layer3_route_back_expert8&#45;&gt;layer3_expert_agg -->
<g id="edge918" class="edge">
<title>layer3_route_back_expert8&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M2693.27,-854.27C2693.27,-793.79 2693.27,-715 2693.27,-715 2693.27,-715 7778.85,-715 7778.85,-715"/>
<polygon fill="black" stroke="black" points="7778.85,-718.5 7788.85,-715 7778.85,-711.5 7778.85,-718.5"/>
</g>
<!-- layer3_expert9_up -->
<g id="node669" class="node">
<title>layer3_expert9_up</title>
<polygon fill="lightcoral" stroke="black" points="3973.27,-1452.5 3691.27,-1452.5 3691.27,-1384.5 3973.27,-1384.5 3973.27,-1452.5"/>
<text text-anchor="middle" x="3832.27" y="-1437.3" font-family="Times,serif" font-size="14.00">Expert 9 Up</text>
<text text-anchor="middle" x="3832.27" y="-1422.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="3832.27" y="-1407.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="3832.27" y="-1392.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_route_expert9&#45;&gt;layer3_expert9_up -->
<g id="edge870" class="edge">
<title>layer3_route_expert9&#45;&gt;layer3_expert9_up</title>
<path fill="none" stroke="black" d="M3832.27,-1538.36C3832.27,-1538.36 3832.27,-1462.68 3832.27,-1462.68"/>
<polygon fill="black" stroke="black" points="3835.77,-1462.68 3832.27,-1452.68 3828.77,-1462.68 3835.77,-1462.68"/>
</g>
<!-- layer3_expert9_activation -->
<g id="node670" class="node">
<title>layer3_expert9_activation</title>
<polygon fill="lightyellow" stroke="black" points="3961.27,-1298.5 3679.27,-1298.5 3679.27,-1230.5 3961.27,-1230.5 3961.27,-1298.5"/>
<text text-anchor="middle" x="3820.27" y="-1283.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3820.27" y="-1268.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="3820.27" y="-1253.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="3820.27" y="-1238.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_expert9_up&#45;&gt;layer3_expert9_activation -->
<g id="edge871" class="edge">
<title>layer3_expert9_up&#45;&gt;layer3_expert9_activation</title>
<path fill="none" stroke="black" d="M3826.27,-1384.32C3826.27,-1384.32 3826.27,-1308.58 3826.27,-1308.58"/>
<polygon fill="black" stroke="black" points="3829.77,-1308.58 3826.27,-1298.58 3822.77,-1308.58 3829.77,-1308.58"/>
</g>
<!-- layer3_expert9_down -->
<g id="node671" class="node">
<title>layer3_expert9_down</title>
<polygon fill="lightcoral" stroke="black" points="3943.77,-1144.5 3670.77,-1144.5 3670.77,-1076.5 3943.77,-1076.5 3943.77,-1144.5"/>
<text text-anchor="middle" x="3807.27" y="-1129.3" font-family="Times,serif" font-size="14.00">Expert 9 Down</text>
<text text-anchor="middle" x="3807.27" y="-1114.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="3807.27" y="-1099.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="3807.27" y="-1084.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_expert9_activation&#45;&gt;layer3_expert9_down -->
<g id="edge872" class="edge">
<title>layer3_expert9_activation&#45;&gt;layer3_expert9_down</title>
<path fill="none" stroke="black" d="M3811.52,-1230.32C3811.52,-1230.32 3811.52,-1154.58 3811.52,-1154.58"/>
<polygon fill="black" stroke="black" points="3815.02,-1154.58 3811.52,-1144.58 3808.02,-1154.58 3815.02,-1154.58"/>
</g>
<!-- layer3_route_back_expert9 -->
<g id="node672" class="node">
<title>layer3_route_back_expert9</title>
<polygon fill="lightpink" stroke="black" points="4297.3,-990.5 3478,-990.5 3267.23,-854.5 4086.54,-854.5 4297.3,-990.5"/>
<text text-anchor="middle" x="3782.27" y="-941.3" font-family="Times,serif" font-size="14.00">Route Back Expert 9</text>
<text text-anchor="middle" x="3782.27" y="-926.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="3782.27" y="-911.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3782.27" y="-896.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer3_expert9_down&#45;&gt;layer3_route_back_expert9 -->
<g id="edge873" class="edge">
<title>layer3_expert9_down&#45;&gt;layer3_route_back_expert9</title>
<path fill="none" stroke="black" d="M3807.27,-1076.45C3807.27,-1076.45 3807.27,-1000.56 3807.27,-1000.56"/>
<polygon fill="black" stroke="black" points="3810.77,-1000.56 3807.27,-990.56 3803.77,-1000.56 3810.77,-1000.56"/>
</g>
<!-- layer3_route_back_expert9&#45;&gt;layer3_expert_agg -->
<g id="edge919" class="edge">
<title>layer3_route_back_expert9&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M3838.25,-854.25C3838.25,-797.17 3838.25,-725 3838.25,-725 3838.25,-725 7778.2,-725 7778.2,-725"/>
<polygon fill="black" stroke="black" points="7778.2,-728.5 7788.2,-725 7778.2,-721.5 7778.2,-728.5"/>
</g>
<!-- layer3_expert10_up -->
<g id="node674" class="node">
<title>layer3_expert10_up</title>
<polygon fill="lightcoral" stroke="black" points="5050.27,-1452.5 4768.27,-1452.5 4768.27,-1384.5 5050.27,-1384.5 5050.27,-1452.5"/>
<text text-anchor="middle" x="4909.27" y="-1437.3" font-family="Times,serif" font-size="14.00">Expert 10 Up</text>
<text text-anchor="middle" x="4909.27" y="-1422.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="4909.27" y="-1407.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="4909.27" y="-1392.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_route_expert10&#45;&gt;layer3_expert10_up -->
<g id="edge876" class="edge">
<title>layer3_route_expert10&#45;&gt;layer3_expert10_up</title>
<path fill="none" stroke="black" d="M4909.27,-1538.36C4909.27,-1538.36 4909.27,-1462.68 4909.27,-1462.68"/>
<polygon fill="black" stroke="black" points="4912.77,-1462.68 4909.27,-1452.68 4905.77,-1462.68 4912.77,-1462.68"/>
</g>
<!-- layer3_expert10_activation -->
<g id="node675" class="node">
<title>layer3_expert10_activation</title>
<polygon fill="lightyellow" stroke="black" points="5041.27,-1298.5 4759.27,-1298.5 4759.27,-1230.5 5041.27,-1230.5 5041.27,-1298.5"/>
<text text-anchor="middle" x="4900.27" y="-1283.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="4900.27" y="-1268.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="4900.27" y="-1253.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="4900.27" y="-1238.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_expert10_up&#45;&gt;layer3_expert10_activation -->
<g id="edge877" class="edge">
<title>layer3_expert10_up&#45;&gt;layer3_expert10_activation</title>
<path fill="none" stroke="black" d="M4904.77,-1384.32C4904.77,-1384.32 4904.77,-1308.58 4904.77,-1308.58"/>
<polygon fill="black" stroke="black" points="4908.27,-1308.58 4904.77,-1298.58 4901.27,-1308.58 4908.27,-1308.58"/>
</g>
<!-- layer3_expert10_down -->
<g id="node676" class="node">
<title>layer3_expert10_down</title>
<polygon fill="lightcoral" stroke="black" points="5026.77,-1144.5 4753.77,-1144.5 4753.77,-1076.5 5026.77,-1076.5 5026.77,-1144.5"/>
<text text-anchor="middle" x="4890.27" y="-1129.3" font-family="Times,serif" font-size="14.00">Expert 10 Down</text>
<text text-anchor="middle" x="4890.27" y="-1114.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="4890.27" y="-1099.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="4890.27" y="-1084.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_expert10_activation&#45;&gt;layer3_expert10_down -->
<g id="edge878" class="edge">
<title>layer3_expert10_activation&#45;&gt;layer3_expert10_down</title>
<path fill="none" stroke="black" d="M4893.02,-1230.32C4893.02,-1230.32 4893.02,-1154.58 4893.02,-1154.58"/>
<polygon fill="black" stroke="black" points="4896.52,-1154.58 4893.02,-1144.58 4889.52,-1154.58 4896.52,-1154.58"/>
</g>
<!-- layer3_route_back_expert10 -->
<g id="node677" class="node">
<title>layer3_route_back_expert10</title>
<polygon fill="lightpink" stroke="black" points="5386.3,-990.5 4567,-990.5 4356.23,-854.5 5175.54,-854.5 5386.3,-990.5"/>
<text text-anchor="middle" x="4871.27" y="-941.3" font-family="Times,serif" font-size="14.00">Route Back Expert 10</text>
<text text-anchor="middle" x="4871.27" y="-926.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="4871.27" y="-911.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4871.27" y="-896.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_expert10_down&#45;&gt;layer3_route_back_expert10 -->
<g id="edge879" class="edge">
<title>layer3_expert10_down&#45;&gt;layer3_route_back_expert10</title>
<path fill="none" stroke="black" d="M4890.27,-1076.45C4890.27,-1076.45 4890.27,-1000.56 4890.27,-1000.56"/>
<polygon fill="black" stroke="black" points="4893.77,-1000.56 4890.27,-990.56 4886.77,-1000.56 4893.77,-1000.56"/>
</g>
<!-- layer3_route_back_expert10&#45;&gt;layer3_expert_agg -->
<g id="edge920" class="edge">
<title>layer3_route_back_expert10&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M5029.05,-854.38C5029.05,-801.1 5029.05,-736 5029.05,-736 5029.05,-736 7795.53,-736 7795.53,-736"/>
<polygon fill="black" stroke="black" points="7795.53,-739.5 7805.53,-736 7795.53,-732.5 7795.53,-739.5"/>
</g>
<!-- layer3_expert11_up -->
<g id="node679" class="node">
<title>layer3_expert11_up</title>
<polygon fill="lightcoral" stroke="black" points="6126.27,-1452.5 5844.27,-1452.5 5844.27,-1384.5 6126.27,-1384.5 6126.27,-1452.5"/>
<text text-anchor="middle" x="5985.27" y="-1437.3" font-family="Times,serif" font-size="14.00">Expert 11 Up</text>
<text text-anchor="middle" x="5985.27" y="-1422.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="5985.27" y="-1407.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="5985.27" y="-1392.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_route_expert11&#45;&gt;layer3_expert11_up -->
<g id="edge882" class="edge">
<title>layer3_route_expert11&#45;&gt;layer3_expert11_up</title>
<path fill="none" stroke="black" d="M5985.27,-1538.36C5985.27,-1538.36 5985.27,-1462.68 5985.27,-1462.68"/>
<polygon fill="black" stroke="black" points="5988.77,-1462.68 5985.27,-1452.68 5981.77,-1462.68 5988.77,-1462.68"/>
</g>
<!-- layer3_expert11_activation -->
<g id="node680" class="node">
<title>layer3_expert11_activation</title>
<polygon fill="lightyellow" stroke="black" points="6120.27,-1298.5 5838.27,-1298.5 5838.27,-1230.5 6120.27,-1230.5 6120.27,-1298.5"/>
<text text-anchor="middle" x="5979.27" y="-1283.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="5979.27" y="-1268.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="5979.27" y="-1253.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="5979.27" y="-1238.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_expert11_up&#45;&gt;layer3_expert11_activation -->
<g id="edge883" class="edge">
<title>layer3_expert11_up&#45;&gt;layer3_expert11_activation</title>
<path fill="none" stroke="black" d="M5982.27,-1384.32C5982.27,-1384.32 5982.27,-1308.58 5982.27,-1308.58"/>
<polygon fill="black" stroke="black" points="5985.77,-1308.58 5982.27,-1298.58 5978.77,-1308.58 5985.77,-1308.58"/>
</g>
<!-- layer3_expert11_down -->
<g id="node681" class="node">
<title>layer3_expert11_down</title>
<polygon fill="lightcoral" stroke="black" points="6108.77,-1144.5 5835.77,-1144.5 5835.77,-1076.5 6108.77,-1076.5 6108.77,-1144.5"/>
<text text-anchor="middle" x="5972.27" y="-1129.3" font-family="Times,serif" font-size="14.00">Expert 11 Down</text>
<text text-anchor="middle" x="5972.27" y="-1114.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="5972.27" y="-1099.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="5972.27" y="-1084.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_expert11_activation&#45;&gt;layer3_expert11_down -->
<g id="edge884" class="edge">
<title>layer3_expert11_activation&#45;&gt;layer3_expert11_down</title>
<path fill="none" stroke="black" d="M5973.52,-1230.32C5973.52,-1230.32 5973.52,-1154.58 5973.52,-1154.58"/>
<polygon fill="black" stroke="black" points="5977.02,-1154.58 5973.52,-1144.58 5970.02,-1154.58 5977.02,-1154.58"/>
</g>
<!-- layer3_route_back_expert11 -->
<g id="node682" class="node">
<title>layer3_route_back_expert11</title>
<polygon fill="lightpink" stroke="black" points="6475.3,-990.5 5656,-990.5 5445.23,-854.5 6264.54,-854.5 6475.3,-990.5"/>
<text text-anchor="middle" x="5960.27" y="-941.3" font-family="Times,serif" font-size="14.00">Route Back Expert 11</text>
<text text-anchor="middle" x="5960.27" y="-926.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="5960.27" y="-911.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5960.27" y="-896.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer3_expert11_down&#45;&gt;layer3_route_back_expert11 -->
<g id="edge885" class="edge">
<title>layer3_expert11_down&#45;&gt;layer3_route_back_expert11</title>
<path fill="none" stroke="black" d="M5972.27,-1076.45C5972.27,-1076.45 5972.27,-1000.56 5972.27,-1000.56"/>
<polygon fill="black" stroke="black" points="5975.77,-1000.56 5972.27,-990.56 5968.77,-1000.56 5975.77,-1000.56"/>
</g>
<!-- layer3_route_back_expert11&#45;&gt;layer3_expert_agg -->
<g id="edge921" class="edge">
<title>layer3_route_back_expert11&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M5960.27,-854.4C5960.27,-805.06 5960.27,-747 5960.27,-747 5960.27,-747 7835.38,-747 7835.38,-747"/>
<polygon fill="black" stroke="black" points="7835.38,-750.5 7845.38,-747 7835.38,-743.5 7835.38,-750.5"/>
</g>
<!-- layer3_expert12_up -->
<g id="node684" class="node">
<title>layer3_expert12_up</title>
<polygon fill="lightcoral" stroke="black" points="7203.27,-1452.5 6921.27,-1452.5 6921.27,-1384.5 7203.27,-1384.5 7203.27,-1452.5"/>
<text text-anchor="middle" x="7062.27" y="-1437.3" font-family="Times,serif" font-size="14.00">Expert 12 Up</text>
<text text-anchor="middle" x="7062.27" y="-1422.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="7062.27" y="-1407.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="7062.27" y="-1392.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_route_expert12&#45;&gt;layer3_expert12_up -->
<g id="edge888" class="edge">
<title>layer3_route_expert12&#45;&gt;layer3_expert12_up</title>
<path fill="none" stroke="black" d="M7062.27,-1538.36C7062.27,-1538.36 7062.27,-1462.68 7062.27,-1462.68"/>
<polygon fill="black" stroke="black" points="7065.77,-1462.68 7062.27,-1452.68 7058.77,-1462.68 7065.77,-1462.68"/>
</g>
<!-- layer3_expert12_activation -->
<g id="node685" class="node">
<title>layer3_expert12_activation</title>
<polygon fill="lightyellow" stroke="black" points="7200.27,-1298.5 6918.27,-1298.5 6918.27,-1230.5 7200.27,-1230.5 7200.27,-1298.5"/>
<text text-anchor="middle" x="7059.27" y="-1283.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7059.27" y="-1268.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="7059.27" y="-1253.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="7059.27" y="-1238.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_expert12_up&#45;&gt;layer3_expert12_activation -->
<g id="edge889" class="edge">
<title>layer3_expert12_up&#45;&gt;layer3_expert12_activation</title>
<path fill="none" stroke="black" d="M7060.77,-1384.32C7060.77,-1384.32 7060.77,-1308.58 7060.77,-1308.58"/>
<polygon fill="black" stroke="black" points="7064.27,-1308.58 7060.77,-1298.58 7057.27,-1308.58 7064.27,-1308.58"/>
</g>
<!-- layer3_expert12_down -->
<g id="node686" class="node">
<title>layer3_expert12_down</title>
<polygon fill="lightcoral" stroke="black" points="7191.77,-1144.5 6918.77,-1144.5 6918.77,-1076.5 7191.77,-1076.5 7191.77,-1144.5"/>
<text text-anchor="middle" x="7055.27" y="-1129.3" font-family="Times,serif" font-size="14.00">Expert 12 Down</text>
<text text-anchor="middle" x="7055.27" y="-1114.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="7055.27" y="-1099.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="7055.27" y="-1084.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_expert12_activation&#45;&gt;layer3_expert12_down -->
<g id="edge890" class="edge">
<title>layer3_expert12_activation&#45;&gt;layer3_expert12_down</title>
<path fill="none" stroke="black" d="M7055.27,-1230.32C7055.27,-1230.32 7055.27,-1154.58 7055.27,-1154.58"/>
<polygon fill="black" stroke="black" points="7058.77,-1154.58 7055.27,-1144.58 7051.77,-1154.58 7058.77,-1154.58"/>
</g>
<!-- layer3_route_back_expert12 -->
<g id="node687" class="node">
<title>layer3_route_back_expert12</title>
<polygon fill="lightpink" stroke="black" points="7564.3,-990.5 6745,-990.5 6534.23,-854.5 7353.54,-854.5 7564.3,-990.5"/>
<text text-anchor="middle" x="7049.27" y="-941.3" font-family="Times,serif" font-size="14.00">Route Back Expert 12</text>
<text text-anchor="middle" x="7049.27" y="-926.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="7049.27" y="-911.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7049.27" y="-896.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_expert12_down&#45;&gt;layer3_route_back_expert12 -->
<g id="edge891" class="edge">
<title>layer3_expert12_down&#45;&gt;layer3_route_back_expert12</title>
<path fill="none" stroke="black" d="M7055.27,-1076.45C7055.27,-1076.45 7055.27,-1000.56 7055.27,-1000.56"/>
<polygon fill="black" stroke="black" points="7058.77,-1000.56 7055.27,-990.56 7051.77,-1000.56 7058.77,-1000.56"/>
</g>
<!-- layer3_route_back_expert12&#45;&gt;layer3_expert_agg -->
<g id="edge922" class="edge">
<title>layer3_route_back_expert12&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M7049.27,-854.23C7049.27,-808.64 7049.27,-757 7049.27,-757 7049.27,-757 7899.98,-757 7899.98,-757"/>
<polygon fill="black" stroke="black" points="7899.98,-760.5 7909.98,-757 7899.98,-753.5 7899.98,-760.5"/>
</g>
<!-- layer3_expert13_up -->
<g id="node689" class="node">
<title>layer3_expert13_up</title>
<polygon fill="lightcoral" stroke="black" points="8279.27,-1452.5 7997.27,-1452.5 7997.27,-1384.5 8279.27,-1384.5 8279.27,-1452.5"/>
<text text-anchor="middle" x="8138.27" y="-1437.3" font-family="Times,serif" font-size="14.00">Expert 13 Up</text>
<text text-anchor="middle" x="8138.27" y="-1422.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="8138.27" y="-1407.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="8138.27" y="-1392.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_route_expert13&#45;&gt;layer3_expert13_up -->
<g id="edge894" class="edge">
<title>layer3_route_expert13&#45;&gt;layer3_expert13_up</title>
<path fill="none" stroke="black" d="M8138.27,-1538.36C8138.27,-1538.36 8138.27,-1462.68 8138.27,-1462.68"/>
<polygon fill="black" stroke="black" points="8141.77,-1462.68 8138.27,-1452.68 8134.77,-1462.68 8141.77,-1462.68"/>
</g>
<!-- layer3_expert13_activation -->
<g id="node690" class="node">
<title>layer3_expert13_activation</title>
<polygon fill="lightyellow" stroke="black" points="8279.27,-1298.5 7997.27,-1298.5 7997.27,-1230.5 8279.27,-1230.5 8279.27,-1298.5"/>
<text text-anchor="middle" x="8138.27" y="-1283.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="8138.27" y="-1268.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="8138.27" y="-1253.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="8138.27" y="-1238.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_expert13_up&#45;&gt;layer3_expert13_activation -->
<g id="edge895" class="edge">
<title>layer3_expert13_up&#45;&gt;layer3_expert13_activation</title>
<path fill="none" stroke="black" d="M8138.27,-1384.32C8138.27,-1384.32 8138.27,-1308.58 8138.27,-1308.58"/>
<polygon fill="black" stroke="black" points="8141.77,-1308.58 8138.27,-1298.58 8134.77,-1308.58 8141.77,-1308.58"/>
</g>
<!-- layer3_expert13_down -->
<g id="node691" class="node">
<title>layer3_expert13_down</title>
<polygon fill="lightcoral" stroke="black" points="8274.77,-1144.5 8001.77,-1144.5 8001.77,-1076.5 8274.77,-1076.5 8274.77,-1144.5"/>
<text text-anchor="middle" x="8138.27" y="-1129.3" font-family="Times,serif" font-size="14.00">Expert 13 Down</text>
<text text-anchor="middle" x="8138.27" y="-1114.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="8138.27" y="-1099.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="8138.27" y="-1084.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_expert13_activation&#45;&gt;layer3_expert13_down -->
<g id="edge896" class="edge">
<title>layer3_expert13_activation&#45;&gt;layer3_expert13_down</title>
<path fill="none" stroke="black" d="M8138.27,-1230.32C8138.27,-1230.32 8138.27,-1154.58 8138.27,-1154.58"/>
<polygon fill="black" stroke="black" points="8141.77,-1154.58 8138.27,-1144.58 8134.77,-1154.58 8141.77,-1154.58"/>
</g>
<!-- layer3_route_back_expert13 -->
<g id="node692" class="node">
<title>layer3_route_back_expert13</title>
<polygon fill="lightpink" stroke="black" points="8653.3,-990.5 7834,-990.5 7623.23,-854.5 8442.54,-854.5 8653.3,-990.5"/>
<text text-anchor="middle" x="8138.27" y="-941.3" font-family="Times,serif" font-size="14.00">Route Back Expert 13</text>
<text text-anchor="middle" x="8138.27" y="-926.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="8138.27" y="-911.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8138.27" y="-896.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer3_expert13_down&#45;&gt;layer3_route_back_expert13 -->
<g id="edge897" class="edge">
<title>layer3_expert13_down&#45;&gt;layer3_route_back_expert13</title>
<path fill="none" stroke="black" d="M8138.27,-1076.45C8138.27,-1076.45 8138.27,-1000.56 8138.27,-1000.56"/>
<polygon fill="black" stroke="black" points="8141.77,-1000.56 8138.27,-990.56 8134.77,-1000.56 8141.77,-1000.56"/>
</g>
<!-- layer3_route_back_expert13&#45;&gt;layer3_expert_agg -->
<g id="edge923" class="edge">
<title>layer3_route_back_expert13&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M8138.27,-854.37C8138.27,-854.37 8138.27,-778.8 8138.27,-778.8"/>
<polygon fill="black" stroke="black" points="8141.77,-778.8 8138.27,-768.8 8134.77,-778.8 8141.77,-778.8"/>
</g>
<!-- layer3_expert14_up -->
<g id="node694" class="node">
<title>layer3_expert14_up</title>
<polygon fill="lightcoral" stroke="black" points="9347.27,-1452.5 9065.27,-1452.5 9065.27,-1384.5 9347.27,-1384.5 9347.27,-1452.5"/>
<text text-anchor="middle" x="9206.27" y="-1437.3" font-family="Times,serif" font-size="14.00">Expert 14 Up</text>
<text text-anchor="middle" x="9206.27" y="-1422.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="9206.27" y="-1407.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="9206.27" y="-1392.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_route_expert14&#45;&gt;layer3_expert14_up -->
<g id="edge900" class="edge">
<title>layer3_route_expert14&#45;&gt;layer3_expert14_up</title>
<path fill="none" stroke="black" d="M9206.27,-1538.36C9206.27,-1538.36 9206.27,-1462.68 9206.27,-1462.68"/>
<polygon fill="black" stroke="black" points="9209.77,-1462.68 9206.27,-1452.68 9202.77,-1462.68 9209.77,-1462.68"/>
</g>
<!-- layer3_expert14_activation -->
<g id="node695" class="node">
<title>layer3_expert14_activation</title>
<polygon fill="lightyellow" stroke="black" points="9353.27,-1298.5 9071.27,-1298.5 9071.27,-1230.5 9353.27,-1230.5 9353.27,-1298.5"/>
<text text-anchor="middle" x="9212.27" y="-1283.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="9212.27" y="-1268.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="9212.27" y="-1253.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="9212.27" y="-1238.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_expert14_up&#45;&gt;layer3_expert14_activation -->
<g id="edge901" class="edge">
<title>layer3_expert14_up&#45;&gt;layer3_expert14_activation</title>
<path fill="none" stroke="black" d="M9209.27,-1384.32C9209.27,-1384.32 9209.27,-1308.58 9209.27,-1308.58"/>
<polygon fill="black" stroke="black" points="9212.77,-1308.58 9209.27,-1298.58 9205.77,-1308.58 9212.77,-1308.58"/>
</g>
<!-- layer3_expert14_down -->
<g id="node696" class="node">
<title>layer3_expert14_down</title>
<polygon fill="lightcoral" stroke="black" points="9351.77,-1144.5 9078.77,-1144.5 9078.77,-1076.5 9351.77,-1076.5 9351.77,-1144.5"/>
<text text-anchor="middle" x="9215.27" y="-1129.3" font-family="Times,serif" font-size="14.00">Expert 14 Down</text>
<text text-anchor="middle" x="9215.27" y="-1114.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="9215.27" y="-1099.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="9215.27" y="-1084.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_expert14_activation&#45;&gt;layer3_expert14_down -->
<g id="edge902" class="edge">
<title>layer3_expert14_activation&#45;&gt;layer3_expert14_down</title>
<path fill="none" stroke="black" d="M9215.27,-1230.32C9215.27,-1230.32 9215.27,-1154.58 9215.27,-1154.58"/>
<polygon fill="black" stroke="black" points="9218.77,-1154.58 9215.27,-1144.58 9211.77,-1154.58 9218.77,-1154.58"/>
</g>
<!-- layer3_route_back_expert14 -->
<g id="node697" class="node">
<title>layer3_route_back_expert14</title>
<polygon fill="lightpink" stroke="black" points="9742.3,-990.5 8923,-990.5 8712.23,-854.5 9531.54,-854.5 9742.3,-990.5"/>
<text text-anchor="middle" x="9227.27" y="-941.3" font-family="Times,serif" font-size="14.00">Route Back Expert 14</text>
<text text-anchor="middle" x="9227.27" y="-926.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="9227.27" y="-911.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9227.27" y="-896.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_expert14_down&#45;&gt;layer3_route_back_expert14 -->
<g id="edge903" class="edge">
<title>layer3_expert14_down&#45;&gt;layer3_route_back_expert14</title>
<path fill="none" stroke="black" d="M9215.27,-1076.45C9215.27,-1076.45 9215.27,-1000.56 9215.27,-1000.56"/>
<polygon fill="black" stroke="black" points="9218.77,-1000.56 9215.27,-990.56 9211.77,-1000.56 9218.77,-1000.56"/>
</g>
<!-- layer3_route_back_expert14&#45;&gt;layer3_expert_agg -->
<g id="edge924" class="edge">
<title>layer3_route_back_expert14&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M9227.27,-854.23C9227.27,-808.64 9227.27,-757 9227.27,-757 9227.27,-757 8376.56,-757 8376.56,-757"/>
<polygon fill="black" stroke="black" points="8376.56,-753.5 8366.56,-757 8376.56,-760.5 8376.56,-753.5"/>
</g>
<!-- layer3_expert15_up -->
<g id="node699" class="node">
<title>layer3_expert15_up</title>
<polygon fill="lightcoral" stroke="black" points="10413.27,-1452.5 10131.27,-1452.5 10131.27,-1384.5 10413.27,-1384.5 10413.27,-1452.5"/>
<text text-anchor="middle" x="10272.27" y="-1437.3" font-family="Times,serif" font-size="14.00">Expert 15 Up</text>
<text text-anchor="middle" x="10272.27" y="-1422.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="10272.27" y="-1407.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="10272.27" y="-1392.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_route_expert15&#45;&gt;layer3_expert15_up -->
<g id="edge906" class="edge">
<title>layer3_route_expert15&#45;&gt;layer3_expert15_up</title>
<path fill="none" stroke="black" d="M10272.27,-1538.36C10272.27,-1538.36 10272.27,-1462.68 10272.27,-1462.68"/>
<polygon fill="black" stroke="black" points="10275.77,-1462.68 10272.27,-1452.68 10268.77,-1462.68 10275.77,-1462.68"/>
</g>
<!-- layer3_expert15_activation -->
<g id="node700" class="node">
<title>layer3_expert15_activation</title>
<polygon fill="lightyellow" stroke="black" points="10438.27,-1298.5 10156.27,-1298.5 10156.27,-1230.5 10438.27,-1230.5 10438.27,-1298.5"/>
<text text-anchor="middle" x="10297.27" y="-1283.3" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="10297.27" y="-1268.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="10297.27" y="-1253.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="10297.27" y="-1238.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_expert15_up&#45;&gt;layer3_expert15_activation -->
<g id="edge907" class="edge">
<title>layer3_expert15_up&#45;&gt;layer3_expert15_activation</title>
<path fill="none" stroke="black" d="M10284.77,-1384.32C10284.77,-1384.32 10284.77,-1308.58 10284.77,-1308.58"/>
<polygon fill="black" stroke="black" points="10288.27,-1308.58 10284.77,-1298.58 10281.27,-1308.58 10288.27,-1308.58"/>
</g>
<!-- layer3_expert15_down -->
<g id="node701" class="node">
<title>layer3_expert15_down</title>
<polygon fill="lightcoral" stroke="black" points="10440.77,-1144.5 10167.77,-1144.5 10167.77,-1076.5 10440.77,-1076.5 10440.77,-1144.5"/>
<text text-anchor="middle" x="10304.27" y="-1129.3" font-family="Times,serif" font-size="14.00">Expert 15 Down</text>
<text text-anchor="middle" x="10304.27" y="-1114.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=16384]</text>
<text text-anchor="middle" x="10304.27" y="-1099.3" font-family="Times,serif" font-size="14.00">Output: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="10304.27" y="-1084.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_expert15_activation&#45;&gt;layer3_expert15_down -->
<g id="edge908" class="edge">
<title>layer3_expert15_activation&#45;&gt;layer3_expert15_down</title>
<path fill="none" stroke="black" d="M10303.02,-1230.32C10303.02,-1230.32 10303.02,-1154.58 10303.02,-1154.58"/>
<polygon fill="black" stroke="black" points="10306.52,-1154.58 10303.02,-1144.58 10299.52,-1154.58 10306.52,-1154.58"/>
</g>
<!-- layer3_route_back_expert15 -->
<g id="node702" class="node">
<title>layer3_route_back_expert15</title>
<polygon fill="lightpink" stroke="black" points="10831.3,-990.5 10012,-990.5 9801.23,-854.5 10620.54,-854.5 10831.3,-990.5"/>
<text text-anchor="middle" x="10316.27" y="-941.3" font-family="Times,serif" font-size="14.00">Route Back Expert 15</text>
<text text-anchor="middle" x="10316.27" y="-926.3" font-family="Times,serif" font-size="14.00">Input: [tokens, hidden_dim=4096]</text>
<text text-anchor="middle" x="10316.27" y="-911.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10316.27" y="-896.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer3_expert15_down&#45;&gt;layer3_route_back_expert15 -->
<g id="edge909" class="edge">
<title>layer3_expert15_down&#45;&gt;layer3_route_back_expert15</title>
<path fill="none" stroke="black" d="M10304.27,-1076.45C10304.27,-1076.45 10304.27,-1000.56 10304.27,-1000.56"/>
<polygon fill="black" stroke="black" points="10307.77,-1000.56 10304.27,-990.56 10300.77,-1000.56 10307.77,-1000.56"/>
</g>
<!-- layer3_route_back_expert15&#45;&gt;layer3_expert_agg -->
<g id="edge925" class="edge">
<title>layer3_route_back_expert15&#45;&gt;layer3_expert_agg</title>
<path fill="none" stroke="black" d="M10316.27,-854.4C10316.27,-805.06 10316.27,-747 10316.27,-747 10316.27,-747 8441.15,-747 8441.15,-747"/>
<polygon fill="black" stroke="black" points="8441.15,-743.5 8431.15,-747 8441.15,-750.5 8441.15,-743.5"/>
</g>
<!-- layer3_expert_agg&#45;&gt;layer3_final_residual -->
<g id="edge927" class="edge">
<title>layer3_expert_agg&#45;&gt;layer3_final_residual</title>
<path fill="none" stroke="black" d="M7917.33,-683C7130.82,-683 4513.78,-683 4513.78,-683 4513.78,-683 4513.78,-580.02 4513.78,-580.02"/>
<polygon fill="black" stroke="black" points="4517.28,-580.02 4513.78,-570.02 4510.28,-580.02 4517.28,-580.02"/>
</g>
<!-- final_norm -->
<g id="node705" class="node">
<title>final_norm</title>
<polygon fill="lightyellow" stroke="black" points="4273.77,-404.17 3776.77,-404.17 3776.77,-336.17 4273.77,-336.17 4273.77,-404.17"/>
<text text-anchor="middle" x="4025.27" y="-388.97" font-family="Times,serif" font-size="14.00">Final Layer Norm</text>
<text text-anchor="middle" x="4025.27" y="-373.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4025.27" y="-358.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4025.27" y="-343.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer3_final_residual&#45;&gt;final_norm -->
<g id="edge928" class="edge">
<title>layer3_final_residual&#45;&gt;final_norm</title>
<path fill="none" stroke="black" d="M4025.27,-490.08C4025.27,-490.08 4025.27,-414.2 4025.27,-414.2"/>
<polygon fill="black" stroke="black" points="4028.77,-414.2 4025.27,-404.2 4021.77,-414.2 4028.77,-414.2"/>
</g>
<!-- output_projection -->
<g id="node706" class="node">
<title>output_projection</title>
<polygon fill="lightgreen" stroke="black" points="4290.27,-250.17 3760.27,-250.17 3760.27,-182.17 4290.27,-182.17 4290.27,-250.17"/>
<text text-anchor="middle" x="4025.27" y="-234.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4025.27" y="-219.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4025.27" y="-204.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, vocab_size=vocab_size]</text>
<text text-anchor="middle" x="4025.27" y="-189.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- final_norm&#45;&gt;output_projection -->
<g id="edge929" class="edge">
<title>final_norm&#45;&gt;output_projection</title>
<path fill="none" stroke="black" d="M4025.27,-335.99C4025.27,-335.99 4025.27,-260.25 4025.27,-260.25"/>
<polygon fill="black" stroke="black" points="4028.77,-260.25 4025.27,-250.25 4021.77,-260.25 4028.77,-260.25"/>
</g>
<!-- model_output -->
<g id="node707" class="node">
<title>model_output</title>
<ellipse fill="lightblue" stroke="black" cx="4025.27" cy="-48.08" rx="374.53" ry="48.17"/>
<text text-anchor="middle" x="4025.27" y="-66.88" font-family="Times,serif" font-size="14.00">Model Output</text>
<text text-anchor="middle" x="4025.27" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=batch_size, seq_len=2048, vocab_size=vocab_size]</text>
<text text-anchor="middle" x="4025.27" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=batch_size, seq_len=2048, vocab_size=vocab_size]</text>
<text text-anchor="middle" x="4025.27" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- output_projection&#45;&gt;model_output -->
<g id="edge930" class="edge">
<title>output_projection&#45;&gt;model_output</title>
<path fill="none" stroke="black" d="M4025.27,-182.15C4025.27,-182.15 4025.27,-106.38 4025.27,-106.38"/>
<polygon fill="black" stroke="black" points="4028.77,-106.38 4025.27,-96.38 4021.77,-106.38 4028.77,-106.38"/>
</g>
</g>
</svg>
